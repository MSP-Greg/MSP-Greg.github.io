<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Nokogiri::XML::RelaxNG &mdash; Nokogiri main</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Nokogiri::XML::RelaxNG",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Nokogiri main</a> &raquo; 
      <a href='../../_index.html#alpha_R'>Index (R)</a> &raquo; 
        <a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a> &raquo; 
        <a href="../XML.html" title="Nokogiri::XML (module)">XML</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>RelaxNG&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Nokogiri::XML::RelaxNG</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Schema.html" title="Nokogiri::XML::Schema (class)">Nokogiri::XML::Schema</a></span>
        <ul class='fullTree'>
          <li><a href="../../Object.html" title="Object (class)"><code>::Object</code></a></li>
          <li class='next'><a href="Schema.html" title="Nokogiri::XML::Schema (class)">Nokogiri::XML::Schema</a></li>
          <li class='next'>Nokogiri::XML::RelaxNG</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/lib/nokogiri/xml/relax_ng.rb#L35'>lib/nokogiri/xml/relax_ng.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xml_relax_ng.c#L164'>ext/nokogiri/xml_relax_ng.c</a>,<br/> <a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xml_schema.c#L177'>ext/nokogiri/xml_schema.c</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>RelaxNG</code> is used for validating <a href="../XML.html" title="Nokogiri::XML (module)"><code>::Nokogiri::XML</code></a> against a <code>RelaxNG</code> schema.</p>

<h3 id="label-Synopsis">Synopsis</h3>

<p>Validate an <a href="../XML.html" title="Nokogiri::XML (module)"><code>::Nokogiri::XML</code></a> document against a <code>RelaxNG</code> schema.  Loop over the errors that are returned and print them out:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schema'>schema</span>  <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span><span class='op'>::</span><span class='const'>RelaxNG</span>(<span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='const'>ADDRESS_SCHEMA_FILE</span>))
<span class='id identifier rubyid_doc'>doc</span>     <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='const'>ADDRESS_XML_FILE</span>))

<span class='id identifier rubyid_schema'>schema</span>.<span class='id identifier rubyid_validate'>validate</span>(<span class='id identifier rubyid_doc'>doc</span>).<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_error'>error</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_error'>error</span>.<span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></code></pre>

<p>The list of errors are <a href="SyntaxError.html" title="Nokogiri::XML::SyntaxError (class)"><code>SyntaxError</code></a> objects.</p>

<p>NOTE: <code>RelaxNG</code> input is always treated as TRUSTED documents, meaning that they will cause the underlying parsing libraries to access network resources. This is counter to Nokogiri’s “untrusted by default” security policy, but is a limitation of the underlying libraries.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#from_document-class_method" title="from_document (class method)">.<strong>from_document</strong>(doc)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Create a new <code>RelaxNG</code> schema from the <a href="Document.html" title="Nokogiri::XML::Document (class)"><code>Document</code></a> <code>doc</code></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#read_memory-class_method" title="read_memory (class method)">.<strong>read_memory</strong>(string) → Nokogiri::XML::Schema)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="Document.html#read_memory-class_method" title="Nokogiri::XML::Document.read_memory (method)">Document.read_memory</a>.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Schema.html#from_document-class_method" title="Nokogiri::XML::Schema.from_document (method)">.from_document</a></td>
      <td><div class='inline'><p>Create a new schema parsed from the <code>document</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Schema.html#new-class_method" title="Nokogiri::XML::Schema.new (method)">.new</a></td>
      <td><div class='inline'><p>Create a new <a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a> object using a <code>string_or_io</code> object.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Schema.html#read_memory-class_method" title="Nokogiri::XML::Schema.read_memory (method)">.read_memory</a></td>
      <td><div class='inline'><p>Create a new schema parsed from the contents of <code>string</code></p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="Schema.html#errors-instance_method" title="Nokogiri::XML::Schema#errors (method)">#errors</a></td>
      <td><div class='inline'><p>Errors while parsing the schema file.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="Schema.html#parse_options-instance_method" title="Nokogiri::XML::Schema#parse_options (method)">#parse_options</a></td>
      <td><div class='inline'><p>The <a href="ParseOptions.html" title="Nokogiri::XML::ParseOptions (class)"><code>ParseOptions</code></a> used to parse the schema.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature priv'>
      <a href="#validate_document-instance_method" title="#validate_document (instance method)">#<strong>validate_document</strong>(document)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>

<h3 class='inherited'><a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Schema.html#valid%3F-instance_method" title="Nokogiri::XML::Schema#valid? (method)">#valid?</a></td>
      <td><div class='inline'><p>Returns true if <code>thing</code> is a valid <a href="Document.html" title="Nokogiri::XML::Document (class)"><code>Document</code></a> or file.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Schema.html#validate-instance_method" title="Nokogiri::XML::Schema#validate (method)">#validate</a></td>
      <td><div class='inline'><p>Validate <code>thing</code> against this schema.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Schema.html#validate_document-instance_method" title="Nokogiri::XML::Schema#validate_document (method)">#validate_document</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Schema.html#validate_file-instance_method" title="Nokogiri::XML::Schema#validate_file (method)">#validate_file</a></td>
      <td><div class='inline'><p>Validate a file against this <a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a>.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <p class='notice'>This class inherits a constructor from <a href="Schema.html#new-class_method" title="Nokogiri::XML::Schema.new (method)">Nokogiri::XML::Schema</a></p>
<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="from_document-class_method">
  <h3 class='signature  first'>
    .<strong>from_document</strong>(doc)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Create a new <code>RelaxNG</code> schema from the <a href="Document.html" title="Nokogiri::XML::Document (class)"><code>Document</code></a> <code>doc</code></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xml_relax_ng.c#L142-L158'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='142' data-end='158'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/nokogiri/xml_relax_ng.c', line 142</span></pre>
<pre class='code cpp'>

static VALUE
from_document(int argc, VALUE *argv, VALUE klass)
{
  VALUE rb_document;
  VALUE rb_parse_options;
  xmlDocPtr c_document;
  xmlRelaxNGParserCtxtPtr c_parser_context;

  rb_scan_args(argc, argv, &quot;11&quot;, &amp;rb_document, &amp;rb_parse_options);

  c_document = noko_xml_document_unwrap(rb_document);
  c_document = c_document-&gt;doc; /* In case someone passes us a node. ugh. */

  c_parser_context = xmlRelaxNGNewDocParserCtxt(c_document);

  return xml_relax_ng_parse_schema(klass, c_parser_context, rb_parse_options);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="read_memory-class_method">
  <h3 class='signature '>
    .<strong>read_memory</strong>(string) → Nokogiri::XML::Schema)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="Document.html#read_memory-class_method" title="Nokogiri::XML::Document.read_memory (method)">Document.read_memory</a>. Create a new schema parsed from the contents of <code>string</code></p>
<dl class="rdoc-list label-list"><dt>Parameters
<dd></dd></dl>
<ul><li>
<p><code>string</code>: String containing <a href="../XML.html" title="Nokogiri::XML (module)"><code>::Nokogiri::XML</code></a> to be parsed as a schema</p>
</li></ul>
<dl class="rdoc-list label-list"><dt>Returns
<dd>
<p><a href="Schema.html" title="Nokogiri::XML::Schema (class)"><code>Schema</code></a></p>
</dd></dl>

  </div>
</div>

</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="validate_document-instance_method">
  <h3 class='signature priv first'>
    #<strong>validate_document</strong>(document)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xml_relax_ng.c#L26-L59'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='26' data-end='59'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/nokogiri/xml_relax_ng.c', line 26</span></pre>
<pre class='code cpp'>

static VALUE
validate_document(VALUE self, VALUE document)
{
  xmlDocPtr doc;
  xmlRelaxNGPtr schema;
  VALUE errors;
  xmlRelaxNGValidCtxtPtr valid_ctxt;

  TypedData_Get_Struct(self, xmlRelaxNG, &amp;xml_relax_ng_type, schema);
  doc = noko_xml_document_unwrap(document);

  errors = rb_ary_new();

  valid_ctxt = xmlRelaxNGNewValidCtxt(schema);

  if (NULL == valid_ctxt) {
    /* we have a problem */
    rb_raise(rb_eRuntimeError, &quot;Could not create a validation context&quot;);
  }

#ifdef HAVE_XMLRELAXNGSETVALIDSTRUCTUREDERRORS
  xmlRelaxNGSetValidStructuredErrors(
    valid_ctxt,
    Nokogiri_error_array_pusher,
    (void *)errors
  );
#endif

  xmlRelaxNGValidateDoc(valid_ctxt, doc);

  xmlRelaxNGFreeValidCtxt(valid_ctxt);

  return errors;
}
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>