<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Nokogiri::XSLT::Stylesheet &mdash; Nokogiri main</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Nokogiri::XSLT::Stylesheet",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Nokogiri main</a> &raquo; 
      <a href='../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a> &raquo; 
        <a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Stylesheet&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Nokogiri::XSLT::Stylesheet</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/lib/nokogiri/xslt/stylesheet.rb#L29'>lib/nokogiri/xslt/stylesheet.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xslt_stylesheet.c#L414'>ext/nokogiri/xslt_stylesheet.c</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>A Stylesheet represents an <a href="../XSLT.html" title="Nokogiri::XSLT (module)"><code>::Nokogiri::XSLT</code></a> Stylesheet object.  <code>Stylesheet</code> creation is done through <a href="../../Nokogiri.html#XSLT-class_method" title="Nokogiri.XSLT (method)">Nokogiri.XSLT</a>.  Here is an example of transforming an <a href="../XML/Document.html" title="Nokogiri::XML::Document (class)"><code>::Nokogiri::XML::Document</code></a> with a <code>Stylesheet</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_doc'>doc</span>   <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_file.xml</span><span class='tstring_end'>&#39;</span></span>))
<span class='id identifier rubyid_xslt'>xslt</span>  <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_transformer.xslt</span><span class='tstring_end'>&#39;</span></span>))

<span class='id identifier rubyid_xslt'>xslt</span>.<span class='id identifier rubyid_transform'><a href="#transform-instance_method" title="Nokogiri::XSLT::Stylesheet#transform (method)">transform</a></span>(<span class='id identifier rubyid_doc'>doc</span>) <span class='comment'># =&gt; Nokogiri::XML::Document</span></code></pre>

<p>Many XSLT transformations include serialization behavior to emit a non-XML document. For these cases, please take care to invoke the <a href="#serialize-instance_method" title="Nokogiri::XSLT::Stylesheet#serialize (method)">#serialize</a> method on the result of the transformation:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_doc'>doc</span>   <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_file.xml</span><span class='tstring_end'>&#39;</span></span>))
<span class='id identifier rubyid_xslt'>xslt</span>  <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_transformer.xslt</span><span class='tstring_end'>&#39;</span></span>))
<span class='id identifier rubyid_xslt'>xslt</span>.<span class='id identifier rubyid_serialize'><a href="#serialize-instance_method" title="Nokogiri::XSLT::Stylesheet#serialize (method)">serialize</a></span>(<span class='id identifier rubyid_xslt'>xslt</span>.<span class='id identifier rubyid_transform'><a href="#transform-instance_method" title="Nokogiri::XSLT::Stylesheet#transform (method)">transform</a></span>(<span class='id identifier rubyid_doc'>doc</span>)) <span class='comment'># =&gt; String</span></code></pre>

<p>or use the <a href="#apply_to-instance_method" title="Nokogiri::XSLT::Stylesheet#apply_to (method)">#apply_to</a> method, which is a shortcut for ‘serialize(transform(document))`:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_doc'>doc</span>   <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_file.xml</span><span class='tstring_end'>&#39;</span></span>))
<span class='id identifier rubyid_xslt'>xslt</span>  <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_transformer.xslt</span><span class='tstring_end'>&#39;</span></span>))
<span class='id identifier rubyid_xslt'>xslt</span>.<span class='id identifier rubyid_apply_to'><a href="#apply_to-instance_method" title="Nokogiri::XSLT::Stylesheet#apply_to (method)">apply_to</a></span>(<span class='id identifier rubyid_doc'>doc</span>) <span class='comment'># =&gt; String</span></code></pre>

<p>See <a href="#transform-instance_method" title="Nokogiri::XSLT::Stylesheet#transform (method)">#transform</a> for more information and examples.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#parse_stylesheet_doc-class_method" title="parse_stylesheet_doc (class method)">.<strong>parse_stylesheet_doc</strong>(document)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Parse an <code>Stylesheet</code> from <code>document</code>.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#apply_to-instance_method" title="#apply_to (instance method)">#<strong>apply_to</strong>(document, params = [])  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Apply an <a href="../XSLT.html" title="Nokogiri::XSLT (module)"><code>::Nokogiri::XSLT</code></a> stylesheet to an <a href="../XML/Document.html" title="Nokogiri::XML::Document (class)"><code>::Nokogiri::XML::Document</code></a> and serialize it properly.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#serialize-instance_method" title="#serialize (instance method)">#<strong>serialize</strong>(document)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Serialize <code>document</code> to an xml string, as specified by the <code>method</code> parameter in the <code>Stylesheet</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#transform-instance_method" title="#transform (instance method)">#<strong>transform</strong>(document)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Transform an <a href="../XML/Document.html" title="Nokogiri::XML::Document (class)"><code>::Nokogiri::XML::Document</code></a> as defined by an <code>Stylesheet</code>.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="parse_stylesheet_doc-class_method">
  <h3 class='signature  first'>
    .<strong>parse_stylesheet_doc</strong>(document)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parse an <code>Stylesheet</code> from <code>document</code>.</p>
<dl class="rdoc-list label-list"><dt>Parameters</dt>
<dd></dd></dl>
<ul><li>
<p><code>document</code> (Nokogiri::XML::Document) the document to be parsed.</p>
</li></ul>
<dl class="rdoc-list label-list"><dt>Returns</dt>
<dd>
<p><code>Stylesheet</code></p>
</dd></dl>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xslt_stylesheet.c#L81-L105'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='81' data-end='105'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/nokogiri/xslt_stylesheet.c', line 81</span></pre>
<pre class='code cpp'>

static VALUE
parse_stylesheet_doc(VALUE klass, VALUE xmldocobj)
{
  xmlDocPtr xml, xml_cpy;
  VALUE errstr, exception;
  xsltStylesheetPtr ss ;

  xml = noko_xml_document_unwrap(xmldocobj);

  errstr = rb_str_new(0, 0);
  xsltSetGenericErrorFunc((void *)errstr, xslt_generic_error_handler);

  xml_cpy = xmlCopyDoc(xml, 1); /* 1 =&gt; recursive */
  ss = xsltParseStylesheetDoc(xml_cpy);

  xsltSetGenericErrorFunc(NULL, NULL);

  if (!ss) {
    xmlFreeDoc(xml_cpy);
    exception = rb_exc_new3(rb_eRuntimeError, errstr);
    rb_exc_raise(exception);
  }

  return Nokogiri_wrap_xslt_stylesheet(ss);
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="apply_to-instance_method">
  <h3 class='signature  first'>
    #<strong>apply_to</strong>(document, params = [])  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Apply an <a href="../XSLT.html" title="Nokogiri::XSLT (module)"><code>::Nokogiri::XSLT</code></a> stylesheet to an <a href="../XML/Document.html" title="Nokogiri::XML::Document (class)"><code>::Nokogiri::XML::Document</code></a> and serialize it properly. This method is equivalent to calling <a href="#serialize-instance_method" title="Nokogiri::XSLT::Stylesheet#serialize (method)">#serialize</a> on the result of <a href="#transform-instance_method" title="Nokogiri::XSLT::Stylesheet#transform (method)">#transform</a>.</p>
<dl class="rdoc-list label-list"><dt>Parameters</dt>
<dd></dd></dl>
<ul><li>
<p><code>document</code> is an instance of <a href="../XML/Document.html" title="Nokogiri::XML::Document (class)"><code>::Nokogiri::XML::Document</code></a> to transform</p>
</li><li>
<p><code>params</code> is an array of strings used as <a href="../XSLT.html" title="Nokogiri::XSLT (module)"><code>::Nokogiri::XSLT</code></a> parameters, passed into <a href="#transform-instance_method" title="Nokogiri::XSLT::Stylesheet#transform (method)">#transform</a></p>
</li></ul>
<dl class="rdoc-list label-list"><dt>Returns</dt>
<dd>
<p>A string containing the serialized result of the transformation.</p>
</dd></dl>

<p>See <a href="#transform-instance_method" title="Nokogiri::XSLT::Stylesheet#transform (method)">#transform</a> for more information and examples.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/lib/nokogiri/xslt/stylesheet.rb#L44-L46'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='44' data-end='46'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/nokogiri/xslt/stylesheet.rb', line 44</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_to'>apply_to</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> [])
  <span class='id identifier rubyid_serialize'><a href="#serialize-instance_method" title="Nokogiri::XSLT::Stylesheet#serialize (method)">serialize</a></span>(<span class='id identifier rubyid_transform'><a href="#transform-instance_method" title="Nokogiri::XSLT::Stylesheet#transform (method)">transform</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="serialize-instance_method">
  <h3 class='signature '>
    #<strong>serialize</strong>(document)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Serialize <code>document</code> to an xml string, as specified by the <code>method</code> parameter in the <code>Stylesheet</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xslt_stylesheet.c#L114-L134'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='114' data-end='134'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/nokogiri/xslt_stylesheet.c', line 114</span></pre>
<pre class='code cpp'>

static VALUE
rb_xslt_stylesheet_serialize(VALUE self, VALUE xmlobj)
{
  xmlDocPtr xml ;
  nokogiriXsltStylesheetTuple *wrapper;
  xmlChar *doc_ptr ;
  int doc_len ;
  VALUE rval ;

  xml = noko_xml_document_unwrap(xmlobj);
  TypedData_Get_Struct(
    self,
    nokogiriXsltStylesheetTuple,
    &amp;nokogiri_xslt_stylesheet_tuple_type,
    wrapper
  );
  xsltSaveResultToString(&amp;doc_ptr, &amp;doc_len, xml, wrapper-&gt;ss);
  rval = NOKOGIRI_STR_NEW(doc_ptr, doc_len);
  xmlFree(doc_ptr);
  return rval ;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="transform-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>transform</strong>(document)  </span>
      <span class='overload'>#<strong>transform</strong>(document, params = {})  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Transform an <a href="../XML/Document.html" title="Nokogiri::XML::Document (class)"><code>::Nokogiri::XML::Document</code></a> as defined by an <code>Stylesheet</code>.</p>
<dl class="rdoc-list label-list"><dt>Parameters</dt>
<dd></dd></dl>
<ul><li>
<p><code>document</code> (Nokogiri::XML::Document) the document to be transformed.</p>
</li><li>
<p><code>params</code> (Hash, Array) strings used as <a href="../XSLT.html" title="Nokogiri::XSLT (module)"><code>::Nokogiri::XSLT</code></a> parameters.</p>
</li></ul>
<dl class="rdoc-list label-list"><dt>Returns</dt>
<dd>
<p><a href="../XML/Document.html" title="Nokogiri::XML::Document (class)"><code>::Nokogiri::XML::Document</code></a></p>
</dd></dl>

<p><strong>Example</strong> of basic transformation:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_xslt'>xslt</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;~XSLT</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>&lt;xsl:stylesheet version=&quot;1.0&quot;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>&lt;xsl:param name=&quot;title&quot;/&gt;
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>&lt;xsl:template match=&quot;/&quot;&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  &lt;html&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    &lt;body&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      &lt;h1&gt;&lt;xsl:value-of select=&quot;$title&quot;/&gt;&lt;/h1&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      &lt;ol&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>        &lt;xsl:for-each select=&quot;staff/employee&quot;&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>          &lt;li&gt;&lt;xsl:value-of select=&quot;employeeId&quot;&gt;&lt;/li&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>        &lt;/xsl:for-each&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      &lt;/ol&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    &lt;/body&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  &lt;/html&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>&lt;/xsl:stylesheet&gt;
</span><span class='heredoc_end'>XSLT
</span>
<span class='id identifier rubyid_xml'>xml</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;~XML</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>&lt;?xml version=&quot;1.0&quot;?&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>&lt;staff&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  &lt;employee&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    &lt;employeeId&gt;EMP0001&lt;/employeeId&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    &lt;position&gt;Accountant&lt;/position&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  &lt;/employee&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  &lt;employee&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    &lt;employeeId&gt;EMP0002&lt;/employeeId&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    &lt;position&gt;Developer&lt;/position&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  &lt;/employee&gt;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>&lt;/staff&gt;
</span><span class='heredoc_end'>XML
</span>
<span class='id identifier rubyid_doc'>doc</span> <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span><span class='op'>::</span><span class='const'><a href="../XML/Document.html" title="Nokogiri::XML::Document (class)">Document</a></span>.<span class='id identifier rubyid_parse'><a href="../XML/Document.html#parse-class_method" title="Nokogiri::XML::Document.parse (method)">parse</a></span>(<span class='id identifier rubyid_xml'>xml</span>)
<span class='id identifier rubyid_stylesheet'>stylesheet</span> <span class='op'>=</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span>.<span class='id identifier rubyid_parse'><a href="../XSLT.html#parse-class_method" title="Nokogiri::XSLT.parse (method)">parse</a></span>(<span class='id identifier rubyid_xslt'>xslt</span>)</code></pre>

<p>⚠ Note that the <code>h1</code> element is empty because no param has been provided!</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_stylesheet'>stylesheet</span>.<span class='id identifier rubyid_transform'>transform</span>(<span class='id identifier rubyid_doc'>doc</span>).<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt; &quot;&lt;html&gt;&lt;body&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;h1&gt;&lt;/h1&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0001&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0002&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/body&gt;&lt;/html&gt;\n&quot;</span></code></pre>

<p><strong>Example</strong> of using an input parameter hash:</p>

<p>⚠ The title is populated, but note how we need to quote-escape the value.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_stylesheet'>stylesheet</span>.<span class='id identifier rubyid_transform'>transform</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>title</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;Employee List&#39;</span><span class='tstring_end'>&quot;</span></span> }).<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt; &quot;&lt;html&gt;&lt;body&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;h1&gt;Employee List&lt;/h1&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0001&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0002&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/body&gt;&lt;/html&gt;\n&quot;</span></code></pre>

<p><strong>Example</strong> using the <a href="../XSLT.html#quote_params-class_method" title="Nokogiri::XSLT.quote_params (method)">Nokogiri::XSLT.quote_params</a> helper method to safely quote-escape strings:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_stylesheet'>stylesheet</span>.<span class='id identifier rubyid_transform'>transform</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span>.<span class='id identifier rubyid_quote_params'><a href="../XSLT.html#quote_params-class_method" title="Nokogiri::XSLT.quote_params (method)">quote_params</a></span>({ <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>title</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron&#39;s List</span><span class='tstring_end'>&quot;</span></span> })).<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt; &quot;&lt;html&gt;&lt;body&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;h1&gt;Aaron&#39;s List&lt;/h1&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0001&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0002&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/body&gt;&lt;/html&gt;\n&quot;</span></code></pre>

<p><strong>Example</strong> using an array of <a href="../XSLT.html" title="Nokogiri::XSLT (module)"><code>::Nokogiri::XSLT</code></a> parameters</p>

<p>You can also use an array if you want to.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_stylesheet'>stylesheet</span>.<span class='id identifier rubyid_transform'>transform</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>title</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;Employee List&#39;</span><span class='tstring_end'>&quot;</span></span>]).<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt; &quot;&lt;html&gt;&lt;body&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;h1&gt;Employee List&lt;/h1&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0001&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0002&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/body&gt;&lt;/html&gt;\n&quot;</span></code></pre>

<p>Or pass an array to <a href="../XSLT.html#quote_params-class_method" title="Nokogiri::XSLT.quote_params (method)">Nokogiri::XSLT.quote_params</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_stylesheet'>stylesheet</span>.<span class='id identifier rubyid_transform'>transform</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='const'><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span><span class='op'>::</span><span class='const'><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span>.<span class='id identifier rubyid_quote_params'><a href="../XSLT.html#quote_params-class_method" title="Nokogiri::XSLT.quote_params (method)">quote_params</a></span>([<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>title</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron&#39;s List</span><span class='tstring_end'>&quot;</span></span>])).<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt; &quot;&lt;html&gt;&lt;body&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;h1&gt;Aaron&#39;s List&lt;/h1&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0001&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;li&gt;EMP0002&lt;/li&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/ol&gt;\n&quot; +
</span><span class='comment'>#    &quot;&lt;/body&gt;&lt;/html&gt;\n&quot;</span></code></pre>

<p>See: <a href="../XSLT.html#quote_params-class_method" title="Nokogiri::XSLT.quote_params (method)">Nokogiri::XSLT.quote_params</a></p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/nokogiri/blob/main/ext/nokogiri/xslt_stylesheet.c#L249-L318'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='249' data-end='318'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/nokogiri/xslt_stylesheet.c', line 249</span></pre>
<pre class='code cpp'>

static VALUE
rb_xslt_stylesheet_transform(int argc, VALUE *argv, VALUE self)
{
  VALUE rb_document, rb_param, rb_error_str;
  xmlDocPtr c_document ;
  xmlDocPtr c_result_document ;
  nokogiriXsltStylesheetTuple *wrapper;
  const char **params ;
  long param_len, j ;
  int parse_error_occurred ;
  int defensive_copy_p = 0;

  rb_scan_args(argc, argv, &quot;11&quot;, &amp;rb_document, &amp;rb_param);
  if (NIL_P(rb_param)) { rb_param = rb_ary_new2(0L) ; }
  if (!rb_obj_is_kind_of(rb_document, cNokogiriXmlDocument)) {
    rb_raise(rb_eArgError, &quot;argument must be a Nokogiri::XML::Document&quot;);
  }

  /* handle hashes as arguments. */
  if (T_HASH == TYPE(rb_param)) {
    rb_param = rb_funcall(rb_param, rb_intern(&quot;to_a&quot;), 0);
    rb_param = rb_funcall(rb_param, rb_intern(&quot;flatten&quot;), 0);
  }

  Check_Type(rb_param, T_ARRAY);

  c_document = noko_xml_document_unwrap(rb_document);
  TypedData_Get_Struct(self, nokogiriXsltStylesheetTuple, &amp;nokogiri_xslt_stylesheet_tuple_type, wrapper);

  param_len = RARRAY_LEN(rb_param);
  params = ruby_xcalloc((size_t)param_len + 1, sizeof(char *));
  for (j = 0 ; j &lt; param_len ; j++) {
    VALUE entry = rb_ary_entry(rb_param, j);
    const char *ptr = StringValueCStr(entry);
    params[j] = ptr;
  }
  params[param_len] = 0 ;

  xsltTransformContextPtr c_transform_context = xsltNewTransformContext(wrapper-&gt;ss, c_document);
  if (xsltNeedElemSpaceHandling(c_transform_context) &amp;&amp;
      noko_xml_document_has_wrapped_blank_nodes_p(c_document)) {
    // see https://github.com/sparklemotion/nokogiri/issues/2800
    c_document = xmlCopyDoc(c_document, 1);
    defensive_copy_p = 1;
  }
  xsltFreeTransformContext(c_transform_context);

  rb_error_str = rb_str_new(0, 0);
  xsltSetGenericErrorFunc((void *)rb_error_str, xslt_generic_error_handler);
  xmlSetGenericErrorFunc((void *)rb_error_str, xslt_generic_error_handler);

  c_result_document = xsltApplyStylesheet(wrapper-&gt;ss, c_document, params);

  ruby_xfree(params);
  if (defensive_copy_p) {
    xmlFreeDoc(c_document);
    c_document = NULL;
  }

  xsltSetGenericErrorFunc(NULL, NULL);
  xmlSetGenericErrorFunc(NULL, NULL);

  parse_error_occurred = (Qfalse == rb_funcall(rb_error_str, rb_intern(&quot;empty?&quot;), 0));

  if (parse_error_occurred) {
    rb_exc_raise(rb_exc_new3(rb_eRuntimeError, rb_error_str));
  }

  return noko_xml_document_wrap((VALUE)0, c_result_document) ;
}
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>