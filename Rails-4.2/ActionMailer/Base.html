<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActionMailer::Base &mdash; Rails-4.2.7</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActionMailer::Base",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Rails-4.2.7</a> &raquo; 
          <a href='../_index.html'>Index (B)</a> &raquo; 
        #  <a href="../ActionMailer.html" title="ActionMailer (module)">ActionMailer</a> &raquo; 
          <span class='title'>Base</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: ActionMailer::Base</h1>

<div class="box_info">
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class='inheritName'><a href="../AbstractController/Base.html" title="AbstractController::Base (class)">AbstractController::Base</a></span>
        <ul class='fullTree'>
          <li><a href="../Object.html" title="Object (class)">Object</a></li>
            <li class='next'><a href="../AbstractController/Base.html" title="AbstractController::Base (class)">AbstractController::Base</a></li>
            <li class='next'>ActionMailer::Base</li>
        </ul>
        <a href='#' class='inheritanceTree'>show all</a>
    </dd>
  </dl>

  <dl>
      <dt>Includes:</dt>
      <dd><a href="../AbstractController/AssetPaths.html" title="AbstractController::AssetPaths (module)">AbstractController::AssetPaths</a>, <a href="../AbstractController/Callbacks.html" title="AbstractController::Callbacks (module)">AbstractController::Callbacks</a>, <a href="../AbstractController/Helpers.html" title="AbstractController::Helpers (module)">AbstractController::Helpers</a>, <a href="../AbstractController/Logger.html" title="AbstractController::Logger (module)">AbstractController::Logger</a>, <a href="../AbstractController/Rendering.html" title="AbstractController::Rendering (module)">AbstractController::Rendering</a>, <a href="../AbstractController/Translation.html" title="AbstractController::Translation (module)">AbstractController::Translation</a>, <a href="DeliveryMethods.html" title="ActionMailer::DeliveryMethods (module)">DeliveryMethods</a>, <a href="Previews.html" title="ActionMailer::Previews (module)">Previews</a>, <a href="../ActionView/Layouts.html" title="ActionView::Layouts (module)">ActionView::Layouts</a></dd>
  </dl>


  <dl>
    <dt>Defined in:</dt>
    <dd>actionmailer/lib/action_mailer/base.rb</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Action Mailer allows you to send email from your application using a mailer
model and views.</p>

<h2 id="label-Mailer+Models">Mailer Models</h2>

<p>To use Action Mailer, you need to create a mailer model.</p>

<pre class="code ruby"><code class="ruby">$ rails generate mailer Notifier</code></pre>

<p>The generated model inherits from <code>ApplicationMailer</code> which in
turn inherits from <code>ActionMailer::Base</code>. A mailer model defines
methods used to generate an email message. In these methods, you can setup
variables to be used in the mailer views, options on the mail itself such
as the <code>:from</code> address, and attachments.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>ApplicationMailer</span> <span class='op'>&lt;</span> <span class='const'>ActionMailer</span><span class='op'>::</span><span class='const'>Base</span>
  <span class='id identifier rubyid_default'>default</span> <span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>from@exmaple.com</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_layout'>layout</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailer</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>

<span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='id identifier rubyid_default'>default</span> <span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no-reply@example.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
          <span class='label'>return_path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>system@example.com</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>def</span> <span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='id identifier rubyid_recipient'>recipient</span><span class='rparen'>)</span>
    <span class='ivar'>@account</span> <span class='op'>=</span> <span class='id identifier rubyid_recipient'>recipient</span>
    <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='id identifier rubyid_recipient'>recipient</span><span class='period'>.</span><span class='id identifier rubyid_email_address_with_name'>email_address_with_name</span><span class='comma'>,</span>
         <span class='label'>bcc:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bcc@example.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Order Watcher &lt;watcher@example.com&gt;</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>Within the mailer method, you have access to the following methods:</p>
<ul><li>
<p><code>attachments[]=</code> - Allows you to add attachments to your email
in an intuitive manner; <code>attachments['filename.png'] =
File.read(&#39;path/to/filename.png&#39;)</code></p>
</li><li>
<p><code>attachments.inline[]=</code> - Allows you to add an inline attachment
to your email in the same manner as <code>attachments[]=</code></p>
</li><li>
<p><code>headers[]=</code> - Allows you to specify any header field in your
email such as <code>headers['X-No-Spam'] = &#39;True&#39;</code>. Note that
declaring a header multiple times will add many fields of the same name.
Read #headers doc for more information.</p>
</li><li>
<p><code>headers(hash)</code> - Allows you to specify multiple headers in your
email such as <code>headers({&#39;X-No-Spam&#39; =&gt; &#39;True&#39;,
&#39;In-Reply-To&#39; =&gt; &#39;1234@message.id&#39;})</code></p>
</li><li>
<p><code>mail</code> - Allows you to specify email to be sent.</p>
</li></ul>

<p>The hash passed to the mail method allows you to specify any header that a
<code>Mail::Message</code> will accept (any valid email header including
optional fields).</p>

<p>The mail method, if not passed a block, will inspect your views and send
all the views with the same name as the method, so the above action would
send the <code>welcome.text.erb</code> view file as well as the
<code>welcome.html.erb</code> view file in a
<code>multipart/alternative</code> email.</p>

<p>If you want to explicitly render only certain templates, pass a block:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span>
<span class='kw'>end</span>
</code></pre>

<p>The block syntax is also useful in providing information specific to a
part:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='lparen'>(</span><span class='label'>content_transfer_encoding:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>base64</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span>
<span class='kw'>end</span>
</code></pre>

<p>Or even to render a special view:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>some_other_template</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<h2 id="label-Mailer+views">Mailer views</h2>

<p>Like Action Controller, each mailer class has a corresponding view
directory in which each method of the class looks for a template with its
name.</p>

<p>To define a template to be used with a mailing, create an <code>.erb</code>
file with the same name as the method in your mailer model. For example, in
the mailer defined above, the template at
<code>app/views/notifier/welcome.text.erb</code> would be used to generate
the email.</p>

<p>Variables defined in the methods of your mailer model are accessible as
instance variables in their corresponding view.</p>

<p>Emails by default are sent in plain text, so a sample view for our model
example might look like this:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Hi</span> <span class='op'>&lt;</span><span class='tstring'><span class='tstring_beg'>%=</span><span class='tstring_end'> @account.name %&gt;,
</span></span></code></pre>

<p>You can even use Action View helpers in these views. For example:</p>

<pre class="code ruby"><code class="ruby">You got a new note!
&lt;%= truncate(@note.body, length: 25) %&gt;</code></pre>

<p>If you need to access the subject, from or the recipients in the view, you
can do that through message object:</p>

<pre class="code ruby"><code class="ruby">You got a new note from &lt;%= message.from %&gt;!
&lt;%= truncate(@note.body, length: 25) %&gt;</code></pre>

<h2 id="label-Generating+URLs">Generating URLs</h2>

<p>URLs can be generated in mailer views using <code>url_for</code> or named
routes. Unlike controllers from Action Pack, the mailer instance
doesn&#39;t have any context about the incoming request, so you&#39;ll need
to provide all of the details needed to generate a URL.</p>

<p>When using <code>url_for</code> you&#39;ll need to provide the
<code>:host</code>, <code>:controller</code>, and <code>:action</code>:</p>

<pre class="code ruby"><code class="ruby">&lt;%= url_for(host: &quot;example.com&quot;, controller: &quot;welcome&quot;, action: &quot;greeting&quot;) %&gt;</code></pre>

<p>When using named routes you only need to supply the <code>:host</code>:</p>

<pre class="code ruby"><code class="ruby">&lt;%= users_url(host: &quot;example.com&quot;) %&gt;</code></pre>

<p>You should use the <code>named_route_url</code> style (which generates
absolute URLs) and avoid using the <code>named_route_path</code> style
(which generates relative URLs), since clients reading the mail will have
no concept of a current URL from which to determine a relative path.</p>

<p>It is also possible to set a default host that will be used in all mailers
by setting the <code>:host</code> option as a configuration option in
<code>config/application.rb</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_action_mailer'>action_mailer</span><span class='period'>.</span><span class='id identifier rubyid_default_url_options'>default_url_options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>host:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>example.com</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
</code></pre>

<p>When you decide to set a default <code>:host</code> for your mailers, then
you need to make sure to use the <code>only_path: false</code> option when
using <code>url_for</code>. Since the <code>url_for</code> view helper will
generate relative URLs by default when a <code>:host</code> option
isn&#39;t explicitly provided, passing <code>only_path: false</code> will
ensure that absolute URLs are generated.</p>

<h2 id="label-Sending+mail">Sending mail</h2>

<p>Once a mailer action and template are defined, you can deliver your message
or create it and save it for delivery later:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Notifier</span><span class='period'>.</span><span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span> <span class='comment'># sends the email
</span><span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='const'>Notifier</span><span class='period'>.</span><span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>      <span class='comment'># =&gt; an ActionMailer::MessageDelivery object
</span><span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>                    <span class='comment'># sends the email
</span></code></pre>

<p>The <code>ActionMailer::MessageDelivery</code> class is a wrapper around a
<code>Mail::Message</code> object. If you want direct access to the
<code>Mail::Message</code> object you can call the <code>message</code>
method on the <code>ActionMailer::MessageDelivery</code> object.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Notifier</span><span class='period'>.</span><span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>     <span class='comment'># =&gt; a Mail::Message object
</span></code></pre>

<p>Action Mailer is nicely integrated with Active Job so you can send emails
in the background (example: outside of the request-response cycle, so the
user doesn&#39;t have to wait on it):</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Notifier</span><span class='period'>.</span><span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_later'>deliver_later</span> <span class='comment'># enqueue the email sending to Active Job
</span></code></pre>

<p>You never instantiate your mailer class. Rather, you just call the method
you defined on the class itself.</p>

<h2 id="label-Multipart+Emails">Multipart Emails</h2>

<p>Multipart messages can also be used implicitly because Action Mailer will
automatically detect and use multipart templates, where each template is
named after the name of the action, followed by the content type. Each such
detected template will be added as a separate part to the message.</p>

<p>For example, if the following templates exist:</p>
<ul><li>
<p>signup_notification.text.erb</p>
</li><li>
<p>signup_notification.html.erb</p>
</li><li>
<p>signup_notification.xml.builder</p>
</li><li>
<p>signup_notification.yml.erb</p>
</li></ul>

<p>Each would be rendered and added as a separate part to the message, with
the corresponding content type. The content type for the entire message is
automatically set to <code>multipart/alternative</code>, which indicates
that the email contains multiple different representations of the same
email body. The same instance variables defined in the action are passed to
all email templates.</p>

<p>Implicit template rendering is not performed if any attachments or parts
have been added to the email. This means that you&#39;ll have to manually
add each part to the email and set the content type of the email to
<code>multipart/alternative</code>.</p>

<h2 id="label-Attachments">Attachments</h2>

<p>Sending attachment in emails is easy:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='id identifier rubyid_recipient'>recipient</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_attachments'>attachments</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>free_book.pdf</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>path/to/file.pdf</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='id identifier rubyid_recipient'>recipient</span><span class='comma'>,</span> <span class='label'>subject:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>New account information</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>Which will (if it had both a <code>welcome.text.erb</code> and
<code>welcome.html.erb</code> template in the view directory), send a
complete <code>multipart/mixed</code> email with two parts, the first part
being a <code>multipart/alternative</code> with the text and HTML email
parts inside, and the second being a <code>application/pdf</code> with a
Base64 encoded copy of the file.pdf book with the filename
<code>free_book.pdf</code>.</p>

<p>If you need to send attachments with no content, you need to create an
empty view for it, or add an empty body parameter like this:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='id identifier rubyid_recipient'>recipient</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_attachments'>attachments</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>free_book.pdf</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>path/to/file.pdf</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='id identifier rubyid_recipient'>recipient</span><span class='comma'>,</span> <span class='label'>subject:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>New account information</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<h2 id="label-Inline+Attachments">Inline Attachments</h2>

<p>You can also specify that a file should be displayed inline with other
HTML. This is useful if you want to display a corporate logo or a photo.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='id identifier rubyid_recipient'>recipient</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_attachments'>attachments</span><span class='period'>.</span><span class='id identifier rubyid_inline'>inline</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>photo.png</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>path/to/photo.png</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='id identifier rubyid_recipient'>recipient</span><span class='comma'>,</span> <span class='label'>subject:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Here is what we look like</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>And then to reference the image in the view, you create a
<code>welcome.html.erb</code> file and make a call to
<code>image_tag</code> passing in the attachment you want to display and
then call <code>url</code> on the attachment to get the relative content id
path for the image source:</p>

<pre class="code ruby"><code class="ruby">&lt;h1&gt;Please Don&#39;t Cringe&lt;/h1&gt;

&lt;%= image_tag attachments[&#39;photo.png&#39;].url -%&gt;</code></pre>

<p>As we are using Action View&#39;s <code>image_tag</code> method, you can
pass in any other options you want:</p>

<pre class="code ruby"><code class="ruby">&lt;h1&gt;Please Don&#39;t Cringe&lt;/h1&gt;

&lt;%= image_tag attachments[&#39;photo.png&#39;].url, alt: &#39;Our Photo&#39;, class: &#39;photo&#39; -%&gt;</code></pre>

<h2 id="label-Observing+and+Intercepting+Mails">Observing and Intercepting Mails</h2>

<p>Action Mailer provides hooks into the Mail observer and interceptor
methods. These allow you to register classes that are called during the
mail delivery life cycle.</p>

<p>An observer class must implement the <code>:delivered_email(message)</code>
method which will be called once for every email sent after the email has
been sent.</p>

<p>An interceptor class must implement the
<code>:delivering_email(message)</code> method which will be called before
the email is sent, allowing you to make modifications to the email before
it hits the delivery agents. Your class should make any needed
modifications directly to the passed in <code>Mail::Message</code>
instance.</p>

<h2 id="label-Default+Hash">Default Hash</h2>

<p>Action Mailer provides some intelligent defaults for your emails, these are
usually specified in a default method inside the class definition:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='id identifier rubyid_default'>default</span> <span class='label'>sender:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>system@example.com</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>You can pass in any header value that a <code>Mail::Message</code> accepts.
Out of the box, <code>ActionMailer::Base</code> sets the following:</p>
<ul><li>
<p><code>mime_version: &quot;1.0&quot;</code></p>
</li><li>
<p><code>charset:      &quot;UTF-8&quot;,</code></p>
</li><li>
<p><code>content_type: &quot;text/plain&quot;,</code></p>
</li><li>
<p><code>parts_order:  [ &quot;text/plain&quot;, &quot;text/enriched&quot;,
&quot;text/html&quot; ]</code></p>
</li></ul>

<p><code>parts_order</code> and <code>charset</code> are not actually valid
<code>Mail::Message</code> header fields, but Action Mailer translates them
appropriately and sets the correct values.</p>

<p>As you can pass in any header, you need to either quote the header as a
string, or pass it in as an underscored symbol, so the following will work:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='id identifier rubyid_default'>default</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content-Transfer-Encoding</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>7bit</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
          <span class='label'>content_description:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>This is a description</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>Finally, Action Mailer also supports passing <code>Proc</code> objects into
the default hash, so you can define methods that evaluate as the message is
being generated:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='id identifier rubyid_default'>default</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>X-Special-Header</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_my_method'>my_method</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_private'>private</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_my_method'>my_method</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some complex call</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>Note that the proc is evaluated right at the start of the mail message
generation, so if you set something in the defaults using a proc, and then
set the same thing inside of your mailer method, it will get over written
by the mailer method.</p>

<p>It is also possible to set these default options that will be used in all
mailers through the <code>default_options=</code> configuration in
<code>config/application.rb</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_action_mailer'>action_mailer</span><span class='period'>.</span><span class='id identifier rubyid_default_options'>default_options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no-reply@example.org</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
</code></pre>

<h2 id="label-Callbacks">Callbacks</h2>

<p>You can specify callbacks using before_action and after_action for
configuring your messages. This may be useful, for example, when you want
to add default inline attachments for all messages sent out by a certain
mailer class:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>
  <span class='id identifier rubyid_before_action'>before_action</span> <span class='symbol'>:add_inline_attachment!</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_welcome'>welcome</span>
    <span class='id identifier rubyid_mail'>mail</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_add_inline_attachment!'>add_inline_attachment!</span>
      <span class='id identifier rubyid_attachments'>attachments</span><span class='period'>.</span><span class='id identifier rubyid_inline'>inline</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>footer.jpg</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/path/to/filename.jpg</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>Callbacks in Action Mailer are implemented using
<code>AbstractController::Callbacks</code>, so you can define and configure
callbacks in the same manner that you would use callbacks in classes that
inherit from <code>ActionController::Base</code>.</p>

<p>Note that unless you have a specific reason to do so, you should prefer
using before_action rather than after_action in your Action Mailer classes
so that headers are parsed properly.</p>

<h2 id="label-Previewing+emails">Previewing emails</h2>

<p>You can preview your email templates visually by adding a mailer preview
file to the <code>ActionMailer::Base.preview_path</code>. Since most emails
do something interesting with database data, you&#39;ll need to write some
scenarios to load messages with fake data:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>NotifierPreview</span> <span class='op'>&lt;</span> <span class='const'>ActionMailer</span><span class='op'>::</span><span class='const'>Preview</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_welcome'>welcome</span>
    <span class='const'>Notifier</span><span class='period'>.</span><span class='id identifier rubyid_welcome'>welcome</span><span class='lparen'>(</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>Methods must return a <code>Mail::Message</code> object which can be
generated by calling the mailer method without the additional
<code>deliver_now</code> / <code>deliver_later</code>. The location of the
mailer previews directory can be configured using the
<code>preview_path</code> option which has a default of
<code>test/mailers/previews</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_action_mailer'>action_mailer</span><span class='period'>.</span><span class='id identifier rubyid_preview_path'>preview_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_root'>root</span><span class='embexpr_end'>}</span><span class='tstring_content'>/lib/mailer_previews</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>An overview of all previews is accessible at
<code>http://localhost:3000/rails/mailers</code> on a running development
server instance.</p>

<p>Previews can also be intercepted in a similar manner as deliveries can be
by registering a preview interceptor that has a
<code>previewing_email</code> method:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>CssInlineStyler</span>
  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_previewing_email'>previewing_email</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
    <span class='comment'># inline CSS styles
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_action_mailer'>action_mailer</span><span class='period'>.</span><span class='id identifier rubyid_preview_interceptors'>preview_interceptors</span> <span class='symbol'>:css_inline_styler</span>
</code></pre>

<p>Note that interceptors need to be registered both with
<code>register_interceptor</code> and
<code>register_preview_interceptor</code> if they should operate on both
sending and previewing emails.</p>

<h2 id="label-Configuration+options">Configuration options</h2>

<p>These options are specified on the class level, like
<code>ActionMailer::Base.raise_delivery_errors = true</code></p>
<ul><li>
<p><code>default_options</code> - You can pass this in at a class level as
well as within the class itself as per the above section.</p>
</li><li>
<p><code>logger</code> - the logger is used for generating information on the
mailing run if available. Can be set to <code>nil</code> for no logging.
Compatible with both Ruby&#39;s own <code>Logger</code> and Log4r loggers.</p>
</li><li>
<p><code>smtp_settings</code> - Allows detailed configuration for
<code>:smtp</code> delivery method:</p>
<ul><li>
<p><code>:address</code> - Allows you to use a remote mail server. Just change
it from its default “localhost” setting.</p>
</li><li>
<p><code>:port</code> - On the off chance that your mail server doesn&#39;t
run on port 25, you can change it.</p>
</li><li>
<p><code>:domain</code> - If you need to specify a HELO domain, you can do it
here.</p>
</li><li>
<p><code>:user_name</code> - If your mail server requires authentication, set
the username in this setting.</p>
</li><li>
<p><code>:password</code> - If your mail server requires authentication, set
the password in this setting.</p>
</li><li>
<p><code>:authentication</code> - If your mail server requires authentication,
you need to specify the authentication type here. This is a symbol and one
of <code>:plain</code> (will send the password Base64 encoded),
<code>:login</code> (will send the password Base64 encoded) or
<code>:cram_md5</code> (combines a Challenge/Response mechanism to exchange
information and a cryptographic Message Digest 5 algorithm to hash
important information)</p>
</li><li>
<p><code>:enable_starttls_auto</code> - Detects if STARTTLS is enabled in your
SMTP server and starts to use it. Defaults to <code>true</code>.</p>
</li><li>
<p><code>:openssl_verify_mode</code> - When using TLS, you can set how OpenSSL
checks the certificate. This is really useful if you need to validate a
self-signed and/or a wildcard certificate. You can use the name of an
OpenSSL verify constant (<code>&#39;none&#39;</code>,
<code>&#39;peer&#39;</code>, <code>&#39;client_once&#39;</code>,
<code>&#39;fail_if_no_peer_cert&#39;</code>) or directly the constant
(<code>OpenSSL::SSL::VERIFY_NONE</code>,
<code>OpenSSL::SSL::VERIFY_PEER</code>, …).</p>
</li></ul>
</li><li>
<p><code>sendmail_settings</code> - Allows you to override options for the
<code>:sendmail</code> delivery method.</p>
<ul><li>
<p><code>:location</code> - The location of the sendmail executable. Defaults
to <code>/usr/sbin/sendmail</code>.</p>
</li><li>
<p><code>:arguments</code> - The command line arguments. Defaults to <code>-i
-t</code> with <code>-f sender@address</code> added automatically before
the message is sent.</p>
</li></ul>
</li><li>
<p><code>file_settings</code> - Allows you to override options for the
<code>:file</code> delivery method.</p>
<ul><li>
<p><code>:location</code> - The directory into which emails will be written.
Defaults to the application <code>tmp/mails</code>.</p>
</li></ul>
</li><li>
<p><code>raise_delivery_errors</code> - Whether or not errors should be raised
if the email fails to be delivered.</p>
</li><li>
<p><code>delivery_method</code> - Defines a delivery method. Possible values
are <code>:smtp</code> (default), <code>:sendmail</code>,
<code>:test</code>, and <code>:file</code>. Or you may provide a custom
delivery method object e.g. <code>MyOwnDeliveryMethodClass</code>. See the
Mail gem documentation on the interface you need to implement for a custom
delivery agent.</p>
</li><li>
<p><code>perform_deliveries</code> - Determines whether emails are actually
sent from Action Mailer when you call <code>.deliver</code> on an email
message or on an Action Mailer method. This is on by default but can be
turned off to aid in functional testing.</p>
</li><li>
<p><code>deliveries</code> - Keeps an array of all the emails sent out through
the Action Mailer with <code>delivery_method :test</code>. Most useful for
unit and functional testing.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
</div>
<h2>Defined Under Namespace</h2>

  <p class='children'><strong class='classes'>Classes:</strong>
    <a href="Base/LateAttachmentsProxy.html" title="ActionMailer::Base::LateAttachmentsProxy (class)">LateAttachmentsProxy</a>,
    <a href="Base/NullMail.html" title="ActionMailer::Base::NullMail (class)">NullMail</a>
  </p>

<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='PROTECTED_IVARS-constant'>
      PROTECTED_IVARS =
    </dt>
    <dd>
            <pre class='code'><span class='const'>AbstractController</span><span class='op'>::</span><span class='const'>Rendering</span><span class='op'>::</span><span class='const'>DEFAULT_PROTECTED_INSTANCE_VARIABLES</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='symbol'>:@_action_has_layout</span><span class='rbracket'>]</span></pre>
    </dd>
  </dl>



  
  
  <h3 class="inherited">Constants included
     from <a href="../ActiveSupport/Callbacks.html" title="ActiveSupport::Callbacks (module)">ActiveSupport::Callbacks</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Callbacks.html#CALLBACK_FILTER_TYPES-constant" title="ActiveSupport::Callbacks::CALLBACK_FILTER_TYPES (constant)">ActiveSupport::Callbacks::CALLBACK_FILTER_TYPES</a></p>

  
  
  <h3 class="inherited">Constants included
     from <a href="../AbstractController/Rendering.html" title="AbstractController::Rendering (module)">AbstractController::Rendering</a></h3>
  <p class="inherited"><a href="../AbstractController/Rendering.html#DEFAULT_PROTECTED_INSTANCE_VARIABLES-constant" title="AbstractController::Rendering::DEFAULT_PROTECTED_INSTANCE_VARIABLES (constant)">AbstractController::Rendering::DEFAULT_PROTECTED_INSTANCE_VARIABLES</a></p>

<h2>Class Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#mailer_name-class_method" title=".mailer_name (class method)">.<strong>mailer_name</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the name of current mailer.</p>
</div>
      </span>
    </li>
  </ul>


<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#controller_path-class_method" title=".controller_path (class method)">.<strong>controller_path</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the name of current mailer.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#default-class_method" title=".default (class method)">.<strong>default</strong>(value = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sets the defaults through app configuration:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#default_options%3D-class_method" title=".default_options= (class method)">.<strong>default_options=</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sets the defaults through app configuration:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#deliver_mail-class_method" title=".deliver_mail (class method)">.<strong>deliver_mail</strong>(mail)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Wraps an email delivery inside of <code>ActiveSupport::Notifications</code>
instrumentation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(method_name = nil, *args)  &#x21d2; Base </a>
      </span>
      <span class='note title constructor'>constructor</span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Instantiate a new mailer object.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#receive-class_method" title=".receive (class method)">.<strong>receive</strong>(raw_mail)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Receives a raw email, parses it into an email object, decodes it,
instantiates a new mailer, and passes the email object to the mailer
object&#39;s <code>receive</code> method.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#register_interceptor-class_method" title=".register_interceptor (class method)">.<strong>register_interceptor</strong>(interceptor)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Register an Interceptor which will be called before mail is sent.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#register_interceptors-class_method" title=".register_interceptors (class method)">.<strong>register_interceptors</strong>(*interceptors)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Register one or more Interceptors which will be called before mail is sent.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#register_observer-class_method" title=".register_observer (class method)">.<strong>register_observer</strong>(observer)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Register an Observer which will be notified when mail is delivered.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#register_observers-class_method" title=".register_observers (class method)">.<strong>register_observers</strong>(*observers)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Register one or more Observers which will be notified when mail is
delivered.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#attachments-instance_method" title="#attachments (instance method)">#<strong>attachments</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Allows you to add attachments to an email, like so:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#headers-instance_method" title="#headers (instance method)">#<strong>headers</strong>(args = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Allows you to pass random and unusual headers to the new
<code>Mail::Message</code> object which will add them to itself.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#mail-instance_method" title="#mail (instance method)">#<strong>mail</strong>(headers = {}, &amp;block)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>The main method that creates the message and renders the email templates.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#mailer_name-instance_method" title="#mailer_name (instance method)">#<strong>mailer_name</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the name of the mailer object.</p>
</div>
      </span>
    </li>
  </ul>


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActionView/Layouts.html" title="ActionView::Layouts (module)">ActionView::Layouts</a></h3>
  <p class="inherited"><a href="../ActionView/Layouts.html#_normalize_options-instance_method" title="ActionView::Layouts#_normalize_options (method)">#_normalize_options</a>, <a href="../ActionView/Layouts.html#action_has_layout%3F-instance_method" title="ActionView::Layouts#action_has_layout? (method)">#action_has_layout?</a>, <a href="../ActionView/Layouts.html#initialize-instance_method" title="ActionView::Layouts#initialize (method)">#initialize</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">#append_features</a>, <a href="../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">#class_methods</a>, <a href="../ActiveSupport/Concern.html#extended-class_method" title="ActiveSupport::Concern.extended (method)">.extended</a>, <a href="../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">#included</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActionView/Rendering.html" title="ActionView::Rendering (module)">ActionView::Rendering</a></h3>
  <p class="inherited"><a href="../ActionView/Rendering.html#render_to_body-instance_method" title="ActionView::Rendering#render_to_body (method)">#render_to_body</a>, <a href="../ActionView/Rendering.html#rendered_format-instance_method" title="ActionView::Rendering#rendered_format (method)">#rendered_format</a>, <a href="../ActionView/Rendering.html#view_context-instance_method" title="ActionView::Rendering#view_context (method)">#view_context</a>, <a href="../ActionView/Rendering.html#view_context_class-instance_method" title="ActionView::Rendering#view_context_class (method)">#view_context_class</a>, <a href="../ActionView/Rendering.html#view_renderer-instance_method" title="ActionView::Rendering#view_renderer (method)">#view_renderer</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActionView/ViewPaths.html" title="ActionView::ViewPaths (module)">ActionView::ViewPaths</a></h3>
  <p class="inherited"><a href="../ActionView/ViewPaths.html#_prefixes-instance_method" title="ActionView::ViewPaths#_prefixes (method)">#_prefixes</a>, <a href="../ActionView/ViewPaths.html#append_view_path-instance_method" title="ActionView::ViewPaths#append_view_path (method)">#append_view_path</a>, <a href="../ActionView/ViewPaths.html#details_for_lookup-instance_method" title="ActionView::ViewPaths#details_for_lookup (method)">#details_for_lookup</a>, <a href="../ActionView/ViewPaths.html#lookup_context-instance_method" title="ActionView::ViewPaths#lookup_context (method)">#lookup_context</a>, <a href="../ActionView/ViewPaths.html#prepend_view_path-instance_method" title="ActionView::ViewPaths#prepend_view_path (method)">#prepend_view_path</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../AbstractController/Callbacks.html" title="AbstractController::Callbacks (module)">AbstractController::Callbacks</a></h3>
  <p class="inherited"><a href="../AbstractController/Callbacks.html#process_action-instance_method" title="AbstractController::Callbacks#process_action (method)">#process_action</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/Callbacks.html" title="ActiveSupport::Callbacks (module)">ActiveSupport::Callbacks</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Callbacks.html#run_callbacks-instance_method" title="ActiveSupport::Callbacks#run_callbacks (method)">#run_callbacks</a></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../AbstractController/Translation.html" title="AbstractController::Translation (module)">AbstractController::Translation</a></h3>
  <p class="inherited"><a href="../AbstractController/Translation.html#localize-instance_method" title="AbstractController::Translation#localize (method)">#localize</a>, <a href="../AbstractController/Translation.html#translate-instance_method" title="AbstractController::Translation#translate (method)">#translate</a></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../AbstractController/Rendering.html" title="AbstractController::Rendering (module)">AbstractController::Rendering</a></h3>
  <p class="inherited"><a href="../AbstractController/Rendering.html#_normalize_args-instance_method" title="AbstractController::Rendering#_normalize_args (method)">#_normalize_args</a>, <a href="../AbstractController/Rendering.html#_normalize_options-instance_method" title="AbstractController::Rendering#_normalize_options (method)">#_normalize_options</a>, <a href="../AbstractController/Rendering.html#_normalize_render-instance_method" title="AbstractController::Rendering#_normalize_render (method)">#_normalize_render</a>, <a href="../AbstractController/Rendering.html#_process_format-instance_method" title="AbstractController::Rendering#_process_format (method)">#_process_format</a>, <a href="../AbstractController/Rendering.html#_process_options-instance_method" title="AbstractController::Rendering#_process_options (method)">#_process_options</a>, <a href="../AbstractController/Rendering.html#render-instance_method" title="AbstractController::Rendering#render (method)">#render</a>, <a href="../AbstractController/Rendering.html#render_to_body-instance_method" title="AbstractController::Rendering#render_to_body (method)">#render_to_body</a>, <a href="../AbstractController/Rendering.html#render_to_string-instance_method" title="AbstractController::Rendering#render_to_string (method)">#render_to_string</a>, <a href="../AbstractController/Rendering.html#rendered_format-instance_method" title="AbstractController::Rendering#rendered_format (method)">#rendered_format</a>, <a href="../AbstractController/Rendering.html#view_assigns-instance_method" title="AbstractController::Rendering#view_assigns (method)">#view_assigns</a></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="DeliveryMethods.html" title="ActionMailer::DeliveryMethods (module)">DeliveryMethods</a></h3>
  <p class="inherited"><a href="DeliveryMethods.html#wrap_delivery_behavior%21-instance_method" title="ActionMailer::DeliveryMethods#wrap_delivery_behavior! (method)">#wrap_delivery_behavior!</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <a href="../AbstractController/Base.html" title="AbstractController::Base (class)">AbstractController::Base</a></h3>
  <p class="inherited"><a href="../AbstractController/Base.html#abstract%21-class_method" title="AbstractController::Base.abstract! (method)">.abstract!</a>, <a href="../AbstractController/Base.html#action_methods-instance_method" title="AbstractController::Base#action_methods (method)">#action_methods</a>, <a href="../AbstractController/Base.html#action_methods-class_method" title="AbstractController::Base.action_methods (method)">.action_methods</a>, <a href="../AbstractController/Base.html#available_action%3F-instance_method" title="AbstractController::Base#available_action? (method)">#available_action?</a>, <a href="../AbstractController/Base.html#clear_action_methods%21-class_method" title="AbstractController::Base.clear_action_methods! (method)">.clear_action_methods!</a>, <a href="../AbstractController/Base.html#controller_path-instance_method" title="AbstractController::Base#controller_path (method)">#controller_path</a>, <a href="../AbstractController/Base.html#hidden_actions-class_method" title="AbstractController::Base.hidden_actions (method)">.hidden_actions</a>, <a href="../AbstractController/Base.html#inherited-class_method" title="AbstractController::Base.inherited (method)">.inherited</a>, <a href="../AbstractController/Base.html#internal_methods-class_method" title="AbstractController::Base.internal_methods (method)">.internal_methods</a>, <a href="../AbstractController/Base.html#method_added-class_method" title="AbstractController::Base.method_added (method)">.method_added</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/DescendantsTracker.html" title="ActiveSupport::DescendantsTracker (module)">ActiveSupport::DescendantsTracker</a></h3>
  <p class="inherited"><a href="../ActiveSupport/DescendantsTracker.html#clear-class_method" title="ActiveSupport::DescendantsTracker.clear (method)">.clear</a>, <a href="../ActiveSupport/DescendantsTracker.html#descendants-instance_method" title="ActiveSupport::DescendantsTracker#descendants (method)">#descendants</a>, <a href="../ActiveSupport/DescendantsTracker.html#descendants-class_method" title="ActiveSupport::DescendantsTracker.descendants (method)">.descendants</a>, <a href="../ActiveSupport/DescendantsTracker.html#direct_descendants-instance_method" title="ActiveSupport::DescendantsTracker#direct_descendants (method)">#direct_descendants</a>, <a href="../ActiveSupport/DescendantsTracker.html#direct_descendants-class_method" title="ActiveSupport::DescendantsTracker.direct_descendants (method)">.direct_descendants</a>, <a href="../ActiveSupport/DescendantsTracker.html#inherited-instance_method" title="ActiveSupport::DescendantsTracker#inherited (method)">#inherited</a>, <a href="../ActiveSupport/DescendantsTracker.html#store_inherited-class_method" title="ActiveSupport::DescendantsTracker.store_inherited (method)">.store_inherited</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/Configurable.html" title="ActiveSupport::Configurable (module)">ActiveSupport::Configurable</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Configurable.html#config-instance_method" title="ActiveSupport::Configurable#config (method)">#config</a></p>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(method_name = nil, *args)  &#x21d2; <tt><a href="" title="ActionMailer::Base (class)">Base</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Instantiate a new mailer object. If <code>method_name</code> is not
<code>nil</code>, the mailer will be initialized according to the named
method. If not, the mailer will remain uninitialized (useful when you only
need to invoke the “receive” method, for instance).</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


580
581
582
583
584
585</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 580</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='ivar'>@_mail_was_called</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@_message</span> <span class='op'>=</span> <span class='const'>Mail</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_method_name'>method_name</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section><h2 class='y_details'>Class Attribute Details</h2>
  <section class='method_details first' id="mailer_name-class_method">
  <h3 class='signature first'>
  .<strong>mailer_name</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the name of current mailer. This method is also being used as a
path for a view lookup. If this is an anonymous mailer, this method will
return <code>anonymous</code> instead.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


492
493
494</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 492</span>

<span class='kw'>def</span> <span class='id identifier rubyid_mailer_name'>mailer_name</span>
  <span class='ivar'>@mailer_name</span> <span class='op'>||=</span> <span class='id identifier rubyid_anonymous?'>anonymous?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>anonymous</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_underscore'>underscore</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section><h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="controller_path-class_method">
  <h3 class='signature first'>
  .<strong>controller_path</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the name of current mailer. This method is also being used as a
path for a view lookup. If this is an anonymous mailer, this method will
return <code>anonymous</code> instead.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


497
498
499</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 497</span>

<span class='kw'>def</span> <span class='id identifier rubyid_mailer_name'>mailer_name</span>
  <span class='ivar'>@mailer_name</span> <span class='op'>||=</span> <span class='id identifier rubyid_anonymous?'>anonymous?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>anonymous</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_underscore'>underscore</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="default-class_method">
  <h3 class='signature'>
  .<strong>default</strong>(value = nil)  
  <span class='aliases'>Also known as:
    <span class='names'>
    <span>default_options=</span>
</span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets the defaults through app configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_action_mailer'>action_mailer</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span><span class='lparen'>(</span><span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no-reply@example.org</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p>Aliased by <a href="#default_options%3D-class_method" title="ActionMailer::Base.default_options= (method)">default_options=</a></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


504
505
506
507</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 504</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default'>default</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_default_params'>default_params</span> <span class='op'>=</span> <span class='id identifier rubyid_default_params'>default_params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
  <span class='id identifier rubyid_default_params'>default_params</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="default_options=-class_method">
  <h3 class='signature'>
  .<strong>default_options=</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets the defaults through app configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_action_mailer'>action_mailer</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span><span class='lparen'>(</span><span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no-reply@example.org</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p>Aliased by <a href="#default_options%3D-class_method" title="ActionMailer::Base.default_options= (method)">default_options=</a> Allows to set defaults through app
configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_action_mailer'>action_mailer</span><span class='period'>.</span><span class='id identifier rubyid_default_options'>default_options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no-reply@example.org</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
</code></pre>


  </div>
</div>
<div class='source_code h'>
  <pre class='lines_num'>


511
512
513
514</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 511</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default'>default</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_default_params'>default_params</span> <span class='op'>=</span> <span class='id identifier rubyid_default_params'>default_params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
  <span class='id identifier rubyid_default_params'>default_params</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="deliver_mail-class_method">
  <h3 class='signature'>
  .<strong>deliver_mail</strong>(mail)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Wraps an email delivery inside of <code>ActiveSupport::Notifications</code>
instrumentation.</p>

<p>This method is actually called by the <code>Mail::Message</code> object
itself through a callback when you call <code>:deliver</code> on the
<code>Mail::Message</code>, calling <code>deliver_mail</code> directly and
passing a <code>Mail::Message</code> will do nothing except tell the logger
you sent the email.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


540
541
542
543
544
545</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 540</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deliver_mail'>deliver_mail</span><span class='lparen'>(</span><span class='id identifier rubyid_mail'>mail</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='const'>ActiveSupport</span><span class='op'>::</span><span class='const'>Notifications</span><span class='period'>.</span><span class='id identifier rubyid_instrument'>instrument</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deliver.action_mailer</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_payload'>payload</span><span class='op'>|</span>
    <span class='id identifier rubyid_set_payload_for_mail'>set_payload_for_mail</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='comma'>,</span> <span class='id identifier rubyid_mail'>mail</span><span class='rparen'>)</span>
    <span class='kw'>yield</span> <span class='comment'># Let Mail do the delivery actions
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="receive-class_method">
  <h3 class='signature'>
  .<strong>receive</strong>(raw_mail)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Receives a raw email, parses it into an email object, decodes it,
instantiates a new mailer, and passes the email object to the mailer
object&#39;s <code>receive</code> method.</p>

<p>If you want your mailer to be able to process incoming messages, you&#39;ll
need to implement a <code>receive</code> method that accepts the raw email
string as a parameter:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>MyMailer</span> <span class='op'>&lt;</span> <span class='const'>ActionMailer</span><span class='op'>::</span><span class='const'>Base</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='id identifier rubyid_mail'>mail</span><span class='rparen'>)</span>
    <span class='comment'># ...
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


526
527
528
529
530
531
532</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 526</span>

<span class='kw'>def</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='id identifier rubyid_raw_mail'>raw_mail</span><span class='rparen'>)</span>
  <span class='const'>ActiveSupport</span><span class='op'>::</span><span class='const'>Notifications</span><span class='period'>.</span><span class='id identifier rubyid_instrument'>instrument</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>receive.action_mailer</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_payload'>payload</span><span class='op'>|</span>
    <span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='const'>Mail</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_raw_mail'>raw_mail</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_payload_for_mail'>set_payload_for_mail</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='comma'>,</span> <span class='id identifier rubyid_mail'>mail</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='id identifier rubyid_mail'>mail</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="register_interceptor-class_method">
  <h3 class='signature'>
  .<strong>register_interceptor</strong>(interceptor)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Register an Interceptor which will be called before mail is sent. Either a
class, string or symbol can be passed in as the Interceptor. If a string or
symbol is passed in it will be camelized and constantized.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


479
480
481
482
483
484
485
486
487
488</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 479</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_interceptor'>register_interceptor</span><span class='lparen'>(</span><span class='id identifier rubyid_interceptor'>interceptor</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_delivery_interceptor'>delivery_interceptor</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_interceptor'>interceptor</span>
    <span class='kw'>when</span> <span class='const'>String</span><span class='comma'>,</span> <span class='const'>Symbol</span>
      <span class='id identifier rubyid_interceptor'>interceptor</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_camelize'>camelize</span><span class='period'>.</span><span class='id identifier rubyid_constantize'>constantize</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_interceptor'>interceptor</span>
    <span class='kw'>end</span>

  <span class='const'>Mail</span><span class='period'>.</span><span class='id identifier rubyid_register_interceptor'>register_interceptor</span><span class='lparen'>(</span><span class='id identifier rubyid_delivery_interceptor'>delivery_interceptor</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="register_interceptors-class_method">
  <h3 class='signature'>
  .<strong>register_interceptors</strong>(*interceptors)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Register one or more Interceptors which will be called before mail is sent.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


458
459
460</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 458</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_interceptors'>register_interceptors</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_interceptors'>interceptors</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_interceptors'>interceptors</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_interceptor'>interceptor</span><span class='op'>|</span> <span class='id identifier rubyid_register_interceptor'>register_interceptor</span><span class='lparen'>(</span><span class='id identifier rubyid_interceptor'>interceptor</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="register_observer-class_method">
  <h3 class='signature'>
  .<strong>register_observer</strong>(observer)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Register an Observer which will be notified when mail is delivered. Either
a class, string or symbol can be passed in as the Observer. If a string or
symbol is passed in it will be camelized and constantized.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


465
466
467
468
469
470
471
472
473
474</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 465</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_observer'>register_observer</span><span class='lparen'>(</span><span class='id identifier rubyid_observer'>observer</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_delivery_observer'>delivery_observer</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_observer'>observer</span>
    <span class='kw'>when</span> <span class='const'>String</span><span class='comma'>,</span> <span class='const'>Symbol</span>
      <span class='id identifier rubyid_observer'>observer</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_camelize'>camelize</span><span class='period'>.</span><span class='id identifier rubyid_constantize'>constantize</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_observer'>observer</span>
    <span class='kw'>end</span>

  <span class='const'>Mail</span><span class='period'>.</span><span class='id identifier rubyid_register_observer'>register_observer</span><span class='lparen'>(</span><span class='id identifier rubyid_delivery_observer'>delivery_observer</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="register_observers-class_method">
  <h3 class='signature'>
  .<strong>register_observers</strong>(*observers)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Register one or more Observers which will be notified when mail is
delivered.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


453
454
455</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 453</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_observers'>register_observers</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_observers'>observers</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_observers'>observers</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_observer'>observer</span><span class='op'>|</span> <span class='id identifier rubyid_register_observer'>register_observer</span><span class='lparen'>(</span><span class='id identifier rubyid_observer'>observer</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section><h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="attachments-instance_method">
  <h3 class='signature first'>
  #<strong>attachments</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows you to add attachments to an email, like so:</p>

<pre class="code ruby"><code class="ruby">mail.attachments[&#39;filename.jpg&#39;] = {File.read}(&#39;/path/to/filename.jpg&#39;)</code></pre>

<p>If you do this, then Mail will take the file name and work out the mime
type set the Content-Type, Content-Disposition, Content-Transfer-Encoding
and base64 encode the contents of the attachment all for you.</p>

<p>You can also specify overrides if you want by passing a hash instead of a
string:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_attachments'>attachments</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>filename.jpg</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>mime_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/x-gzip</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                                    <span class='label'>content:</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/path/to/filename.jpg</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span>
</code></pre>

<p>If you want to use a different encoding than Base64, you can pass an
encoding in, but then it is up to you to pass in the content pre-encoded,
and don&#39;t expect Mail to know how to decode this data:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file_content'>file_content</span> <span class='op'>=</span> <span class='const'>SpecialEncode</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/path/to/filename.jpg</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_attachments'>attachments</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>filename.jpg</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>mime_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/x-gzip</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                                    <span class='label'>encoding:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SpecialEncoding</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                                    <span class='label'>content:</span> <span class='id identifier rubyid_file_content'>file_content</span> <span class='rbrace'>}</span>
</code></pre>

<p>You can also search for specific attachments:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># By Filename
</span><span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_attachments'>attachments</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>filename.jpg</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>   <span class='comment'># =&gt; {Mail::Part} object or nil
</span>
<span class='comment'># or by index
</span><span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_attachments'>attachments</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>                <span class='comment'># =&gt; {Mail::Part} (first attachment)
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


691
692
693
694
695
696
697</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 691</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attachments'>attachments</span>
  <span class='kw'>if</span> <span class='ivar'>@_mail_was_called</span>
    <span class='const'>LateAttachmentsProxy</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='ivar'>@_message</span><span class='period'>.</span><span class='id identifier rubyid_attachments'>attachments</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='ivar'>@_message</span><span class='period'>.</span><span class='id identifier rubyid_attachments'>attachments</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="headers-instance_method">
  <h3 class='signature'>
  #<strong>headers</strong>(args = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows you to pass random and unusual headers to the new
<code>Mail::Message</code> object which will add them to itself.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>X-Special-Domain-Specific-Header</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SecretValue</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>You can also pass a hash into headers of header field names and values,
which will then be set on the <code>Mail::Message</code> object:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_headers'>headers</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>X-Special-Domain-Specific-Header</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SecretValue</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>In-Reply-To</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_incoming'>incoming</span><span class='period'>.</span><span class='id identifier rubyid_message_id'>message_id</span>
</code></pre>

<p>The resulting <code>Mail::Message</code> will have the following in its
header:</p>

<pre class="code ruby"><code class="ruby">X-Special-Domain-Specific-Header: SecretValue</code></pre>

<p>Note about replacing already defined headers:</p>
<ul><li>
<p><code>subject</code></p>
</li><li>
<p><code>sender</code></p>
</li><li>
<p><code>from</code></p>
</li><li>
<p><code>to</code></p>
</li><li>
<p><code>cc</code></p>
</li><li>
<p><code>bcc</code></p>
</li><li>
<p><code>reply-to</code></p>
</li><li>
<p><code>orig-date</code></p>
</li><li>
<p><code>message-id</code></p>
</li><li>
<p><code>references</code></p>
</li></ul>

<p>Fields can only appear once in email headers while other fields such as
<code>X-Anything</code> can appear multiple times.</p>

<p>If you want to replace any header which already exists, first set it to
<code>nil</code> in order to reset the value otherwise another field will
be added for the same header.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


653
654
655
656
657
658
659</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 653</span>

<span class='kw'>def</span> <span class='id identifier rubyid_headers'>headers</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>
    <span class='ivar'>@_message</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='ivar'>@_message</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="mail-instance_method">
  <h3 class='signature'>
  #<strong>mail</strong>(headers = {}, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The main method that creates the message and renders the email templates.
There are two ways to call this method, with a block, or without a block.</p>

<p>It accepts a headers hash. This hash allows you to specify the most used
headers in an email message, these are:</p>
<ul><li>
<p><code>:subject</code> - The subject of the message, if this is omitted,
Action Mailer will ask the Rails I18n class for a translated
<code>:subject</code> in the scope of <code>[mailer_scope,
action_name]</code> or if this is missing, will translate the humanized
version of the <code>action_name</code></p>
</li><li>
<p><code>:to</code> - Who the message is destined for, can be a string of
addresses, or an array of addresses.</p>
</li><li>
<p><code>:from</code> - Who the message is from</p>
</li><li>
<p><code>:cc</code> - Who you would like to Carbon-Copy on this email, can be
a string of addresses, or an array of addresses.</p>
</li><li>
<p><code>:bcc</code> - Who you would like to Blind-Carbon-Copy on this email,
can be a string of addresses, or an array of addresses.</p>
</li><li>
<p><code>:reply_to</code> - Who to set the Reply-To header of the email to.</p>
</li><li>
<p><code>:date</code> - The date to say the email was sent on.</p>
</li></ul>

<p>You can set default values for any of the above headers (except
<code>:date</code>) by using the <a href="#default-class_method" title="ActionMailer::Base.default (method)">default</a> class method:</p>

<pre class="code ruby"><code class="ruby">class Notifier &lt; {ActionMailer::Base}
  default from: &#39;no-reply@test.lindsaar.net&#39;,
          bcc: &#39;email_logger@test.lindsaar.net&#39;,
          reply_to: &#39;bounces@test.lindsaar.net&#39;
end</code></pre>

<p>If you need other headers not listed above, you can either pass them in as
part of the headers hash or use the <code>headers['name'] = value</code>
method.</p>

<p>When a <code>:return_path</code> is specified as header, that value will be
used as the &#39;envelope from&#39; address for the Mail message. Setting
this is useful when you want delivery notifications sent to a different
address than the one in <code>:from</code>. Mail will actually use the
<code>:return_path</code> in preference to the <code>:sender</code> in
preference to the <code>:from</code> field for the &#39;envelope from&#39;
value.</p>

<p>If you do not pass a block to the <code>mail</code> method, it will find
all templates in the view paths using by default the mailer name and the
method name that it is being called from, it will then create parts for
each of these templates intelligently, making educated guesses on correct
content type and sequence, and return a fully prepared
<code>Mail::Message</code> ready to call <code>:deliver</code> on to send.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Notifier</span> <span class='op'>&lt;</span> <span class='const'>ActionMailer</span><span class='op'>::</span><span class='const'>Base</span>
  <span class='id identifier rubyid_default'>default</span> <span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no-reply@test.lindsaar.net</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>def</span> <span class='id identifier rubyid_welcome'>welcome</span>
    <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mikel@test.lindsaar.net</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>Will look for all templates at “app/views/notifier” with name “welcome”. If
no welcome template exists, it will raise an <a href="../ActionView/MissingTemplate.html" title="ActionView::MissingTemplate (class)">ActionView::MissingTemplate</a>
error.</p>

<p>However, those can be customized:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>template_path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>notifications</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>template_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>another</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>And now it will look for all templates at “app/views/notifications” with
name “another”.</p>

<p>If you do pass a block, you can render specific templates of your choice:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mikel@test.lindsaar.net</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span>
<span class='kw'>end</span>
</code></pre>

<p>You can even render plain text directly without using a template:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mikel@test.lindsaar.net</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>plain:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello Mikel!</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>html:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;h1&gt;Hello Mikel!&lt;/h1&gt;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_html_safe'>html_safe</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>Which will render a <code>multipart/alternative</code> email with
<code>text/plain</code> and <code>text/html</code> parts.</p>

<p>The block syntax also allows you to customize the part headers if desired:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='label'>to:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mikel@test.lindsaar.net</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='lparen'>(</span><span class='label'>content_transfer_encoding:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>base64</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 800</span>

<span class='kw'>def</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='id identifier rubyid_headers'>headers</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='ivar'>@_message</span> <span class='kw'>if</span> <span class='ivar'>@_mail_was_called</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_headers'>headers</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_block'>block</span>

  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='ivar'>@_message</span>

  <span class='comment'># At the beginning, do not consider class default for content_type
</span>  <span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:content_type</span><span class='rbracket'>]</span>

  <span class='comment'># Call all the procs (if any)
</span>  <span class='id identifier rubyid_default_values'>default_values</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='id identifier rubyid_default_values'>default_values</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Proc</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_instance_eval'>instance_eval</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_v'>v</span>
  <span class='kw'>end</span>

  <span class='comment'># Handle defaults
</span>  <span class='id identifier rubyid_headers'>headers</span> <span class='op'>=</span> <span class='id identifier rubyid_headers'>headers</span><span class='period'>.</span><span class='id identifier rubyid_reverse_merge'>reverse_merge</span><span class='lparen'>(</span><span class='id identifier rubyid_default_values'>default_values</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:subject</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_default_i18n_subject'>default_i18n_subject</span>

  <span class='comment'># Apply charset at the beginning so all fields are properly quoted
</span>  <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_charset'>charset</span> <span class='op'>=</span> <span class='id identifier rubyid_charset'>charset</span> <span class='op'>=</span> <span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:charset</span><span class='rbracket'>]</span>

  <span class='comment'># Set configure delivery behavior
</span>  <span class='id identifier rubyid_wrap_delivery_behavior!'>wrap_delivery_behavior!</span><span class='lparen'>(</span><span class='id identifier rubyid_headers'>headers</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:delivery_method</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:delivery_method_options</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='comment'># Assign all headers except parts_order, content_type and body
</span>  <span class='id identifier rubyid_assignable'>assignable</span> <span class='op'>=</span> <span class='id identifier rubyid_headers'>headers</span><span class='period'>.</span><span class='id identifier rubyid_except'>except</span><span class='lparen'>(</span><span class='symbol'>:parts_order</span><span class='comma'>,</span> <span class='symbol'>:content_type</span><span class='comma'>,</span> <span class='symbol'>:body</span><span class='comma'>,</span> <span class='symbol'>:template_name</span><span class='comma'>,</span> <span class='symbol'>:template_path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assignable'>assignable</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span> <span class='rbrace'>}</span>

  <span class='comment'># Render the templates and blocks
</span>  <span class='id identifier rubyid_responses'>responses</span> <span class='op'>=</span> <span class='id identifier rubyid_collect_responses'>collect_responses</span><span class='lparen'>(</span><span class='id identifier rubyid_headers'>headers</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@_mail_was_called</span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_create_parts_from_responses'>create_parts_from_responses</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_responses'>responses</span><span class='rparen'>)</span>

  <span class='comment'># Setup content type, reapply charset and handle parts order
</span>  <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='id identifier rubyid_set_content_type'>set_content_type</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_content_type'>content_type</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:content_type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_charset'>charset</span>      <span class='op'>=</span> <span class='id identifier rubyid_charset'>charset</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_multipart?'>multipart?</span>
    <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_set_sort_order'>set_sort_order</span><span class='lparen'>(</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:parts_order</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_sort_parts!'>sort_parts!</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_m'>m</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="mailer_name-instance_method">
  <h3 class='signature'>
  #<strong>mailer_name</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the name of the mailer object.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


615
616
617</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionmailer/lib/action_mailer/base.rb', line 615</span>

<span class='kw'>def</span> <span class='id identifier rubyid_mailer_name'>mailer_name</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_mailer_name'>mailer_name</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>
<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.8.7.6 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>