<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::QueryMethods &mdash; Rails-4.2.7</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::QueryMethods",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Rails-4.2.7</a> &raquo; 
          <a href='../_index.html'>Index (Q)</a> &raquo; 
          <a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <span class='title'>QueryMethods</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActiveRecord::QueryMethods</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>

  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <a href="QueryMethods/WhereChain.html" title="ActiveRecord::QueryMethods::WhereChain (class)">WhereChain</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Extended by:</td>
    <td><a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Includes:</td>
    <td><a href="../ActiveModel/ForbiddenAttributesProtection.html" title="ActiveModel::ForbiddenAttributesProtection (module)">ActiveModel::ForbiddenAttributesProtection</a>
    </td>
  </tr>


  <tr>
    <td class='box_1'>Included in:</td>
    <td><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a>
    </td>
  </tr>

  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
activerecord/lib/active_record/relation/query_methods.rb</div>  </td>
  </tr>
</table>

<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='VALID_UNSCOPING_VALUES-constant'>
      VALID_UNSCOPING_VALUES =
    </dt>
    <dd>
            <pre class='code'><span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:where</span><span class='comma'>,</span> <span class='symbol'>:select</span><span class='comma'>,</span> <span class='symbol'>:group</span><span class='comma'>,</span> <span class='symbol'>:order</span><span class='comma'>,</span> <span class='symbol'>:lock</span><span class='comma'>,</span>
<span class='symbol'>:limit</span><span class='comma'>,</span> <span class='symbol'>:offset</span><span class='comma'>,</span> <span class='symbol'>:joins</span><span class='comma'>,</span> <span class='symbol'>:includes</span><span class='comma'>,</span> <span class='symbol'>:from</span><span class='comma'>,</span>
<span class='symbol'>:readonly</span><span class='comma'>,</span> <span class='symbol'>:having</span><span class='rbracket'>]</span><span class='rparen'>)</span></pre>
    </dd>
  </dl>





<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#arel-instance_method" title="#arel (instance method)">#<strong>arel</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the Arel object associated with the relation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create_with-instance_method" title="#create_with (instance method)">#<strong>create_with</strong>(value)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets attributes to be used when creating new records from a relation
object.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#distinct-instance_method" title="#distinct (instance method)">#<strong>distinct</strong>(value = true)  </a>
        (also: #uniq)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Specifies whether the records should be unique or not.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#distinct%21-instance_method" title="#distinct! (instance method)">#<strong>distinct!</strong>(value = true)  </a>
        (also: #uniq!)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Like <a href="#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a>, but modifies relation in place.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#eager_load-instance_method" title="#eager_load (instance method)">#<strong>eager_load</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Forces eager loading by performing a LEFT OUTER JOIN on <code>args</code>:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#extending-instance_method" title="#extending (instance method)">#<strong>extending</strong>(*modules, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Used to extend a scope with additional methods, either through a module or
through a block provided.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#extensions-instance_method" title="#extensions (instance method)">#<strong>extensions</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#from-instance_method" title="#from (instance method)">#<strong>from</strong>(value, subquery_name = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Specifies table from which the records will be fetched.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#group-instance_method" title="#group (instance method)">#<strong>group</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Allows to specify a group attribute:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#having-instance_method" title="#having (instance method)">#<strong>having</strong>(opts, *rest)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Allows to specify a HAVING clause.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#includes-instance_method" title="#includes (instance method)">#<strong>includes</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Specify relationships to be included in the result set.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#joins-instance_method" title="#joins (instance method)">#<strong>joins</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Performs a joins on <code>args</code>:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#limit-instance_method" title="#limit (instance method)">#<strong>limit</strong>(value)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Specifies a limit for the number of records to retrieve.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#lock-instance_method" title="#lock (instance method)">#<strong>lock</strong>(locks = true)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Specifies locking settings (default to <code>true</code>).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#none-instance_method" title="#none (instance method)">#<strong>none</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a chainable relation with zero records.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#offset-instance_method" title="#offset (instance method)">#<strong>offset</strong>(value)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Specifies the number of rows to skip before returning rows.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#order-instance_method" title="#order (instance method)">#<strong>order</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Allows to specify an order attribute:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#preload-instance_method" title="#preload (instance method)">#<strong>preload</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Allows preloading of <code>args</code>, in the same way that
<code>includes</code> does:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#readonly-instance_method" title="#readonly (instance method)">#<strong>readonly</strong>(value = true)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets readonly attributes for the returned relation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#references-instance_method" title="#references (instance method)">#<strong>references</strong>(*table_names)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Use to indicate that the given <code>table_names</code> are referenced by
an SQL string, and should therefore be JOINed in any query rather than
loaded separately.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#reorder-instance_method" title="#reorder (instance method)">#<strong>reorder</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Replaces any existing order defined on the relation with the specified
order.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#reverse_order-instance_method" title="#reverse_order (instance method)">#<strong>reverse_order</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reverse the existing order clause on the relation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rewhere-instance_method" title="#rewhere (instance method)">#<strong>rewhere</strong>(conditions)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Allows you to change a previously set where condition for a given
attribute, instead of appending to that condition.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#select-instance_method" title="#select (instance method)">#<strong>select</strong>(*fields)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Works in two unique ways.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#uniq-instance_method" title="#uniq (instance method)">#<strong>uniq</strong>(value = true)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#uniq%21-instance_method" title="#uniq! (instance method)">#<strong>uniq!</strong>(value = true)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#distinct%21-instance_method" title="ActiveRecord::QueryMethods#distinct! (method)">#distinct!</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#unscope-instance_method" title="#unscope (instance method)">#<strong>unscope</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Removes an unwanted relation that is already defined on a chain of
relations.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#where-instance_method" title="#where (instance method)">#<strong>where</strong>(opts = :chain, *rest)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a new relation, which is the result of filtering the current
relation according to the conditions in the arguments.</p>
</div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">append_features</a>, <a href="../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">class_methods</a>, <a href="../ActiveSupport/Concern.html#extended-class_method" title="ActiveSupport::Concern.extended (method)">.extended</a>, <a href="../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">included</a></p>

  
  
  
  
  
  <h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="arel-instance_method">
  <h3 class='signature first'>
  #<strong>arel</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the Arel object associated with the relation.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


857
858
859</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 857</span>

<span class='kw'>def</span> <span class='id identifier rubyid_arel'>arel</span> <span class='comment'># :nodoc:
</span>  <span class='ivar'>@arel</span> <span class='op'>||=</span> <span class='id identifier rubyid_build_arel'>build_arel</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create_with-instance_method">
  <h3 class='signature'>
  #<strong>create_with</strong>(value)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets attributes to be used when creating new records from a relation
object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Oscar</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &#39;Oscar&#39;
</span>
<span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create_with'>create_with</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DHH</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &#39;DHH&#39;
</span></code></pre>

<p>You can pass <code>nil</code> to <code>create_with</code> to reset
attributes:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create_with'>create_with</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &#39;Oscar&#39;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


726
727
728</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 726</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_with'>create_with</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_create_with!'>create_with!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="distinct-instance_method">
  <h3 class='signature'>
  #<strong>distinct</strong>(value = true)  
  <span class='aliases'>Also known as: <span class='names'><span>uniq</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Specifies whether the records should be unique or not. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
<span class='comment'># =&gt; Might return two records with the same name
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span>
<span class='comment'># =&gt; Returns 1 record per distinct name
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
<span class='comment'># =&gt; You can also remove the uniqueness
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


776
777
778</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 776</span>

<span class='kw'>def</span> <span class='id identifier rubyid_distinct'>distinct</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_distinct!'>distinct!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="distinct!-instance_method">
  <h3 class='signature'>
  #<strong>distinct!</strong>(value = true)  
  <span class='aliases'>Also known as: <span class='names'><span>uniq!</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Like <a href="#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a>, but modifies relation in place.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


782
783
784
785</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 782</span>

<span class='kw'>def</span> <span class='id identifier rubyid_distinct!'>distinct!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_distinct_value'>distinct_value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="eager_load-instance_method">
  <h3 class='signature'>
  #<strong>eager_load</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Forces eager loading by performing a LEFT OUTER JOIN on <code>args</code>:</p>

<pre class="code ruby"><code class="ruby">User.eager_load(:posts)
#=&gt; SELECT &quot;users&quot;.&quot;id&quot; AS t0_r0, &quot;users&quot;.&quot;name&quot; AS t0_r1, ...
FROM &quot;users&quot; LEFT OUTER JOIN &quot;posts&quot; ON &quot;posts&quot;.&quot;user_id&quot; =
&quot;users&quot;.&quot;id&quot;</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


163
164
165
166</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eager_load'>eager_load</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:eager_load</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_eager_load!'>eager_load!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="extending-instance_method">
  <h3 class='signature'>
  #<strong>extending</strong>(*modules, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Used to extend a scope with additional methods, either through a module or
through a block provided.</p>

<p>The object returned is a relation, which can be further extended.</p>

<h3 id="label-Using+a+module">Using a module</h3>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>Pagination</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_number'>number</span><span class='rparen'>)</span>
    <span class='comment'># pagination code goes here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='const'>Pagination</span><span class='rparen'>)</span>
<span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:page</span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>

<p>You can also pass a list of modules:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='const'>Pagination</span><span class='comma'>,</span> <span class='const'>SomethingElse</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Using+a+block">Using a block</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span> <span class='kw'>do</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_number'>number</span><span class='rparen'>)</span>
    <span class='comment'># pagination code goes here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:page</span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>

<p>You can also use a block and a module list:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='const'>Pagination</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_per_page'>per_page</span><span class='lparen'>(</span><span class='id identifier rubyid_number'>number</span><span class='rparen'>)</span>
    <span class='comment'># pagination code goes here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


824
825
826
827
828
829
830</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 824</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_modules'>modules</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_modules'>modules</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>||</span> <span class='id identifier rubyid_block'>block</span>
    <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_extending!'>extending!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_modules'>modules</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="extensions-instance_method">
  <h3 class='signature'>
  #<strong>extensions</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


109</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 109</span>

<span class='kw'>alias</span> <span class='id identifier rubyid_extensions'>extensions</span> <span class='id identifier rubyid_extending_values'>extending_values</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="from-instance_method">
  <h3 class='signature'>
  #<strong>from</strong>(value, subquery_name = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Specifies table from which the records will be fetched. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>posts</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; SELECT title FROM posts
</span></code></pre>

<p>Can accept other relation objects. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_approved'>approved</span><span class='rparen'>)</span>
<span class='comment'># =&gt; SELECT title FROM (SELECT * FROM topics WHERE approved = &#39;t&#39;) subquery
</span>
<span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a.title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_approved'>approved</span><span class='comma'>,</span> <span class='symbol'>:a</span><span class='rparen'>)</span>
<span class='comment'># =&gt; SELECT a.title FROM (SELECT * FROM topics WHERE approved = &#39;t&#39;) a
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


754
755
756</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 754</span>

<span class='kw'>def</span> <span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_subquery_name'>subquery_name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_from!'>from!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_subquery_name'>subquery_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="group-instance_method">
  <h3 class='signature'>
  #<strong>group</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows to specify a group attribute:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; GROUP BY name</span></code></pre>

<p>Returns an array with distinct records based on the <code>group</code>
attribute:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [#&lt;User id: 1, name: &quot;Oscar&quot;&gt;, #&lt;User id: 2, name: &quot;Oscar&quot;&gt;, #&lt;User id: 3, name: &quot;Foo&quot;&gt;
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [#&lt;User id: 3, name: &quot;Foo&quot;, ...&gt;, #&lt;User id: 2, name: &quot;Oscar&quot;, ...&gt;]
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name AS grouped_name, age</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [#&lt;User id: 3, name: &quot;Foo&quot;, age: 21, ...&gt;, #&lt;User id: 2, name: &quot;Oscar&quot;, age: 21, ...&gt;, #&lt;User id: 5, name: &quot;Foo&quot;, age: 23, ...&gt;]</span></code></pre>

<p>Passing in an array of attributes to group by is also supported.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:first_name</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:first_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [#&lt;User id: 1, first_name: &quot;Bill&quot;&gt;, #&lt;User id: 2, first_name: &quot;Earl&quot;&gt;, #&lt;User id: 3, first_name: &quot;Beto&quot;&gt;]</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


286
287
288
289</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 286</span>

<span class='kw'>def</span> <span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:group</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_group!'>group!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="having-instance_method">
  <h3 class='signature'>
  #<strong>having</strong>(opts, *rest)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows to specify a HAVING clause. Note that you can&#39;t use HAVING
without also specifying a GROUP clause.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Order</span><span class='period'>.</span><span class='id identifier rubyid_having'>having</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SUM(price) &gt; 30</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


604
605
606</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 604</span>

<span class='kw'>def</span> <span class='id identifier rubyid_having'>having</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>?</span> <span class='kw'>self</span> <span class='op'>:</span> <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_having!'>having!</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="includes-instance_method">
  <h3 class='signature'>
  #<strong>includes</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Specify relationships to be included in the result set. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:address</span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span>
  <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_city'>city</span>
<span class='kw'>end</span>
</code></pre>

<p>allows you to access the <code>address</code> attribute of the
<code>User</code> model without firing an additional query. This will often
result in a performance improvement over a simple <code>join</code>.</p>

<p>You can also specify multiple relationships, like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:friends</span><span class='rparen'>)</span>
</code></pre>

<p>Loading nested relationships is possible using a Hash:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:address</span><span class='comma'>,</span> <span class='label'>friends:</span> <span class='lbracket'>[</span><span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:followers</span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-conditions">conditions</h3>

<p>If you want to add conditions to your included models you&#39;ll have to
explicitly reference them. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>posts.name = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>Will throw an error, but this will work:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>posts.name = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span>
</code></pre>

<p>Note that <code>includes</code> works with association names while
<code>references</code> needs the actual table name.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


144
145
146
147</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:includes</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_includes!'>includes!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="joins-instance_method">
  <h3 class='signature'>
  #<strong>joins</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Performs a joins on <code>args</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; INNER JOIN &quot;posts&quot; ON &quot;posts&quot;.&quot;user_id&quot; = &quot;users&quot;.&quot;id&quot;</span></code></pre>

<p>You can use strings in order to customize your joins:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LEFT JOIN bookmarks ON bookmarks.bookmarkable_type = &#39;Post&#39; AND bookmarks.user_id = users.id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; LEFT JOIN bookmarks ON bookmarks.bookmarkable_type = &#39;Post&#39; AND bookmarks.user_id = users.id</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


428
429
430
431</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 428</span>

<span class='kw'>def</span> <span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:joins</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_joins!'>joins!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="limit-instance_method">
  <h3 class='signature'>
  #<strong>limit</strong>(value)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Specifies a limit for the number of records to retrieve.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span> <span class='comment'># generated SQL has &#39;LIMIT 10&#39;
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>20</span><span class='rparen'>)</span> <span class='comment'># generated SQL has &#39;LIMIT 20&#39;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


620
621
622</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 620</span>

<span class='kw'>def</span> <span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_limit!'>limit!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="lock-instance_method">
  <h3 class='signature'>
  #<strong>lock</strong>(locks = true)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Specifies locking settings (default to <code>true</code>). For more
information on locking, please see <a href="Locking.html" title="ActiveRecord::Locking (module)">Locking</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


647
648
649</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 647</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lock'>lock</span><span class='lparen'>(</span><span class='id identifier rubyid_locks'>locks</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_lock!'>lock!</span><span class='lparen'>(</span><span class='id identifier rubyid_locks'>locks</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="none-instance_method">
  <h3 class='signature'>
  #<strong>none</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a chainable relation with zero records.</p>

<p>The returned relation implements the Null Object pattern. It is an object
with defined null behavior and always returns an empty array of records
without querying the database.</p>

<p>Any subsequent condition chained to the returned relation will continue
generating an empty relation and will not fire any query to the database.</p>

<p>Used in cases where a method or scope could return zero records but the
result needs to be chainable.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@posts</span> <span class='op'>=</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='period'>.</span><span class='id identifier rubyid_visible_posts'>visible_posts</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># =&gt; the visible_posts method is expected to return a chainable Relation
</span>
<span class='kw'>def</span> <span class='id identifier rubyid_visible_posts'>visible_posts</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_role'>role</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Country Manager</span><span class='tstring_end'>&#39;</span></span>
    <span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>country:</span> <span class='id identifier rubyid_country'>country</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Reviewer</span><span class='tstring_end'>&#39;</span></span>
    <span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_published'>published</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Bad User</span><span class='tstring_end'>&#39;</span></span>
    <span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_none'>none</span> <span class='comment'># It can&#39;t be chained if [] is returned.
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


690
691
692</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 690</span>

<span class='kw'>def</span> <span class='id identifier rubyid_none'>none</span>
  <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1=0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_extending!'>extending!</span><span class='lparen'>(</span><span class='const'>NullRelation</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="offset-instance_method">
  <h3 class='signature'>
  #<strong>offset</strong>(value)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Specifies the number of rows to skip before returning rows.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span> <span class='comment'># generated SQL has &quot;OFFSET 10&quot;
</span></code></pre>

<p>Should be used with order.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name ASC</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


636
637
638</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 636</span>

<span class='kw'>def</span> <span class='id identifier rubyid_offset'>offset</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_offset!'>offset!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="order-instance_method">
  <h3 class='signature'>
  #<strong>order</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows to specify an order attribute:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY &quot;users&quot;.&quot;name&quot; ASC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='label'>email:</span> <span class='symbol'>:desc</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY &quot;users&quot;.&quot;email&quot; DESC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>email:</span> <span class='symbol'>:desc</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY &quot;users&quot;.&quot;name&quot; ASC, &quot;users&quot;.&quot;email&quot; DESC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY name
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY name DESC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name DESC, email</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY name DESC, email</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


317
318
319
320</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 317</span>

<span class='kw'>def</span> <span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:order</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_order!'>order!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="preload-instance_method">
  <h3 class='signature'>
  #<strong>preload</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows preloading of <code>args</code>, in the same way that
<code>includes</code> does:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_preload'>preload</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;user_id&quot; IN (1, 2, 3)</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


177
178
179
180</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_preload'>preload</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:preload</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_preload!'>preload!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="readonly-instance_method">
  <h3 class='signature'>
  #<strong>readonly</strong>(value = true)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets readonly attributes for the returned relation. If value is true
(default), attempting to update a record will result in an error.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_readonly'>readonly</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
<span class='comment'>#=&gt; ActiveRecord::ReadOnlyRecord: ActiveRecord::ReadOnlyRecord</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


704
705
706</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 704</span>

<span class='kw'>def</span> <span class='id identifier rubyid_readonly'>readonly</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_readonly!'>readonly!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="references-instance_method">
  <h3 class='signature'>
  #<strong>references</strong>(*table_names)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Use to indicate that the given <code>table_names</code> are referenced by
an SQL string, and should therefore be JOINed in any query rather than
loaded separately. This method only works in conjunction with
<code>includes</code>. See <a href="#includes-instance_method" title="ActiveRecord::QueryMethods#includes (method)">#includes</a> for more details.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.name = &#39;foo&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; Doesn&#39;t JOIN the posts table, resulting in an error.
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.name = &#39;foo&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span>
<span class='comment'># =&gt; Query now knows the string references posts, so adds a JOIN
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


197
198
199
200</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_table_names'>table_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:references</span><span class='comma'>,</span> <span class='id identifier rubyid_table_names'>table_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_references!'>references!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_table_names'>table_names</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="reorder-instance_method">
  <h3 class='signature'>
  #<strong>reorder</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Replaces any existing order defined on the relation with the specified
order.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># generated SQL has &#39;ORDER BY id ASC&#39;
</span></code></pre>

<p>Subsequent calls to order on the same relation will be appended. For
example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>generates a query with &#39;ORDER BY id ASC, name ASC&#39;.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


338
339
340
341</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 338</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:reorder</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_reorder!'>reorder!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="reverse_order-instance_method">
  <h3 class='signature'>
  #<strong>reverse_order</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reverse the existing order clause on the relation.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse_order'>reverse_order</span> <span class='comment'># generated SQL has &#39;ORDER BY name DESC&#39;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


845
846
847</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 845</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reverse_order'>reverse_order</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_reverse_order!'>reverse_order!</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rewhere-instance_method">
  <h3 class='signature'>
  #<strong>rewhere</strong>(conditions)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows you to change a previously set where condition for a given
attribute, instead of appending to that condition.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>false</span><span class='rparen'>)</span>                       <span class='comment'># =&gt; WHERE `trashed` = 1 AND `trashed` = 0
</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rewhere'>rewhere</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>false</span><span class='rparen'>)</span>                     <span class='comment'># =&gt; WHERE `trashed` = 0
</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>active:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rewhere'>rewhere</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='comment'># =&gt; WHERE `active` = 1 AND `trashed` = 0
</span></code></pre>

<p>This is short-hand for unscope(where: conditions.keys).where(conditions).
Note that unlike reorder, we&#39;re only unscoping the named conditions –
not the entire where statement.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


596
597
598</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 596</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rewhere'>rewhere</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='label'>where:</span> <span class='id identifier rubyid_conditions'>conditions</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="select-instance_method">
  <h3 class='signature'>
  #<strong>select</strong>(*fields)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Works in two unique ways.</p>

<p>First: takes a block so it can be used just like <code>Array#select</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_field'>field</span> <span class='op'>==</span> <span class='id identifier rubyid_value'>value</span> <span class='rbrace'>}</span>
</code></pre>

<p>This will build an array of objects from the database for the scope,
converting them into an array and iterating through them using
<code>Array#select</code>.</p>

<p>Second: Modifies the SELECT statement for the query so that only certain
fields are retrieved:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:field</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;Model id: nil, field: &quot;value&quot;&gt;]
</span></code></pre>

<p>Although in the above example it looks as though this method returns an
array, it actually returns a relation object and can have other query
methods appended to it, such as the other methods in
<a href="" title="ActiveRecord::QueryMethods (module)">ActiveRecord::QueryMethods</a>.</p>

<p>The argument to the method can also be an array of fields.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:field</span><span class='comma'>,</span> <span class='symbol'>:other_field</span><span class='comma'>,</span> <span class='symbol'>:and_one_more</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;Model id: nil, field: &quot;value&quot;, other_field: &quot;value&quot;, and_one_more: &quot;value&quot;&gt;]
</span></code></pre>

<p>You can also use one or more strings, which will be used unchanged as
SELECT fields.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>field AS field_one</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>other_field AS field_two</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;Model id: nil, field: &quot;value&quot;, other_field: &quot;value&quot;&gt;]
</span></code></pre>

<p>If an alias was specified, it will be accessible from the resulting
objects:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>field AS field_one</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_field_one'>field_one</span>
<span class='comment'># =&gt; &quot;value&quot;
</span></code></pre>

<p>Accessing attributes of an object that do not have fields retrieved by a
select except <code>id</code> will throw
<code>ActiveModel::MissingAttributeError</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:field</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_other_field'>other_field</span>
<span class='comment'># =&gt; ActiveModel::MissingAttributeError: missing attribute: other_field
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


249
250
251
252
253
254
255
256</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 249</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_block_args'>block_args</span><span class='op'>|</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_block_args'>block_args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Call this with at least one field</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid__select!'>_select!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="uniq-instance_method">
  <h3 class='signature'>
  #<strong>uniq</strong>(value = true)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="uniq!-instance_method">
  <h3 class='signature'>
  #<strong>uniq!</strong>(value = true)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#distinct%21-instance_method" title="ActiveRecord::QueryMethods#distinct! (method)">#distinct!</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="unscope-instance_method">
  <h3 class='signature'>
  #<strong>unscope</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes an unwanted relation that is already defined on a chain of
relations. This is useful when passing around chains of relations and would
like to modify the relations without reconstructing the entire chain.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='symbol'>:order</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
</code></pre>

<p>The method arguments are symbols which correspond to the names of the
methods which should be unscoped. The valid arguments are given in
VALID_UNSCOPING_VALUES. The method can also be called with multiple
arguments. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='period'>.</span><span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='symbol'>:order</span><span class='comma'>,</span> <span class='symbol'>:select</span><span class='comma'>,</span> <span class='symbol'>:where</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
</code></pre>

<p>One can additionally pass a hash as an argument to unscope specific :where
values. This is done by passing a hash with a single key-value pair. The
key should be :where and the value should be the where value to unscope.
For example:</p>

<pre class="code ruby"><code class="ruby">User.where(name: &quot;John&quot;, active: true).unscope(where: :name)
    == User.where(active: true)</code></pre>

<p>This method is similar to <code>except</code>, but unlike
<code>except</code>, it persists across merges:</p>

<pre class="code ruby"><code class="ruby">User.order(&#39;email&#39;).merge(User.except(:order))
    == User.order(&#39;email&#39;)

User.order(&#39;email&#39;).merge(User.unscope(:order))
    == User.all</code></pre>

<p>This means it can be used in association definitions:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:comments</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_unscope'>unscope</span> <span class='label'>where:</span> <span class='symbol'>:trashed</span> <span class='rbrace'>}</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


388
389
390
391</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 388</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbol'>:unscope</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_unscope!'>unscope!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="where-instance_method">
  <h3 class='signature'>
  #<strong>where</strong>(opts = :chain, *rest)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a new relation, which is the result of filtering the current
relation according to the conditions in the arguments.</p>

<p><a href="#where-instance_method" title="ActiveRecord::QueryMethods#where (method)">#where</a> accepts conditions in one of several formats. In the examples
below, the resulting SQL is given as an illustration; the actual query
generated may be different depending on the database adapter.</p>

<h3 id="label-string">string</h3>

<p>A single string, without additional arguments, is passed to the query
constructor as an SQL fragment, and used in the where clause of the query.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>orders_count = &#39;2&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT * from clients where orders_count = &#39;2&#39;;
</span></code></pre>

<p>Note that building your own string from user input may expose your
application to injection attacks if not done properly. As an alternative,
it is recommended to use one of the following methods.</p>

<h3 id="label-array">array</h3>

<p>If an array is passed, then the first element of the array is treated as a
template, and the remaining elements are inserted into the template to
generate the condition. Active Record takes care of building the query to
avoid injection attacks, and will convert from the ruby type to the
database type where needed. Elements are inserted into the string in the
order in which they appear.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = ? and email = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;
</span></code></pre>

<p>Alternatively, you can use named placeholders in the template, and pass a
hash as the second element of the array. The names in the template are
replaced with the corresponding values from the hash.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = :name and email = :email</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;
</span></code></pre>

<p>This can make for more readable code in complex queries.</p>

<p>Lastly, you can use sprintf-style % escapes in the template. This works
slightly differently than the previous methods; you are responsible for
ensuring that the values in the template are properly quoted. The values
are passed to the connector for quoting, but the caller is responsible for
ensuring they are enclosed in quotes in the resulting SQL. After quoting,
the values are inserted using the same escapes as the Ruby core method
<code>Kernel::sprintf</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = &#39;%s&#39; and email = &#39;%s&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;
</span></code></pre>

<p>If <a href="#where-instance_method" title="ActiveRecord::QueryMethods#where (method)">#where</a> is called with multiple arguments, these are treated as if they
were passed as the elements of a single array.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = :name and email = :email</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;
</span></code></pre>

<p>When using strings to specify conditions, you can use any operator
available from the database. While this provides the most flexibility, you
can also unintentionally introduce dependencies on the underlying database.
If your code is intended for general consumption, test with multiple
database backends.</p>

<h3 id="label-hash">hash</h3>

<p><a href="#where-instance_method" title="ActiveRecord::QueryMethods#where (method)">#where</a> will also accept a hash condition, in which the keys are fields
and the values are values to be searched for.</p>

<p>Fields can be symbols or strings. Values can be single values, arrays, or
ranges.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>name:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alice</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bob</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name IN (&#39;Alice&#39;, &#39;Bob&#39;)
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>created_at:</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_midnight'>midnight</span> <span class='op'>-</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span><span class='rparen'>)</span><span class='op'>..</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_midnight'>midnight</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE (created_at BETWEEN &#39;2012-06-09 07:00:00.000000&#39; AND &#39;2012-06-10 07:00:00.000000&#39;)
</span></code></pre>

<p>In the case of a belongs_to relationship, an association key can be used to
specify the model if an ActiveRecord object is used as the value.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_author'>author</span> <span class='op'>=</span> <span class='const'>Author</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>

<span class='comment'># The following queries will be equivalent:
</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>author:</span> <span class='id identifier rubyid_author'>author</span><span class='rparen'>)</span>
<span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>author_id:</span> <span class='id identifier rubyid_author'>author</span><span class='rparen'>)</span>
</code></pre>

<p>This also works with polymorphic belongs_to relationships:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_treasure'>treasure</span> <span class='op'>=</span> <span class='const'>Treasure</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gold coins</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_treasure'>treasure</span><span class='period'>.</span><span class='id identifier rubyid_price_estimates'>price_estimates</span> <span class='op'>&lt;&lt;</span> <span class='const'>PriceEstimate</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>price:</span> <span class='int'>125</span><span class='rparen'>)</span>

<span class='comment'># The following queries will be equivalent:
</span><span class='const'>PriceEstimate</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>estimate_of:</span> <span class='id identifier rubyid_treasure'>treasure</span><span class='rparen'>)</span>
<span class='const'>PriceEstimate</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>estimate_of_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Treasure</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>estimate_of_id:</span> <span class='id identifier rubyid_treasure'>treasure</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Joins">Joins</h3>

<p>If the relation is the result of a join, you may create a condition which
uses any of the tables in the join. For string and array conditions, use
the table name in the condition.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.created_at &lt; ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
</code></pre>

<p>For hash conditions, you can either use the table name in the key, or use a
sub-hash.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.published</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>posts:</span> <span class='lbrace'>{</span> <span class='label'>published:</span> <span class='kw'>true</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-no+argument">no argument</h3>

<p>If no argument is passed, <a href="#where-instance_method" title="ActiveRecord::QueryMethods#where (method)">#where</a> returns a new instance of WhereChain,
that can be chained with <code>#not</code> to return a new relation that negates the
where clause.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jon</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name != &#39;Jon&#39;
</span></code></pre>

<p>See WhereChain for more details on <code>#not</code>.</p>

<h3 id="label-blank+condition">blank condition</h3>

<p>If the condition is any blank-ish object, then <a href="#where-instance_method" title="ActiveRecord::QueryMethods#where (method)">#where</a> is a no-op and
returns the current relation.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


568
569
570
571
572
573
574
575
576</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 568</span>

<span class='kw'>def</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='symbol'>:chain</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>==</span> <span class='symbol'>:chain</span>
    <span class='const'>WhereChain</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_spawn'>spawn</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='kw'>self</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_where!'>where!</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.0 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>