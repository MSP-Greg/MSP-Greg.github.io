<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::ConnectionAdapters::SchemaStatements &mdash; Rails-4.2.7</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::ConnectionAdapters::SchemaStatements",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Rails-4.2.7</a> &raquo; 
          <a href='../../_index.html'>Index (S)</a> &raquo; 
          <a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <a href="../ConnectionAdapters.html" title="ActiveRecord::ConnectionAdapters (module)">ConnectionAdapters</a> &raquo; 
          <span class='title'>SchemaStatements</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActiveRecord::ConnectionAdapters::SchemaStatements</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>


  <tr>
    <td class='box_1'>Includes:</td>
    <td><a href="TimestampDefaultDeprecation.html" title="ActiveRecord::ConnectionAdapters::TimestampDefaultDeprecation (module)">TimestampDefaultDeprecation</a>, <a href="../Migration/JoinTable.html" title="ActiveRecord::Migration::JoinTable (module)">Migration::JoinTable</a>
    </td>
  </tr>


  <tr>
    <td class='box_1'>Included in:</td>
    <td><a href="AbstractAdapter.html" title="ActiveRecord::ConnectionAdapters::AbstractAdapter (class)">AbstractAdapter</a>
    </td>
  </tr>

  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb</div>  </td>
  </tr>
</table>





<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#add_belongs_to-instance_method" title="#add_belongs_to (instance method)">#<strong>add_belongs_to</strong>(table_name, ref_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#add_reference-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#add_reference (method)">#add_reference</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#add_column-instance_method" title="#add_column (instance method)">#<strong>add_column</strong>(table_name, column_name, type, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Adds a new column to the named table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#add_foreign_key-instance_method" title="#add_foreign_key (instance method)">#<strong>add_foreign_key</strong>(from_table, to_table, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Adds a new foreign key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#add_index-instance_method" title="#add_index (instance method)">#<strong>add_index</strong>(table_name, column_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Adds a new index to the table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#add_reference-instance_method" title="#add_reference (instance method)">#<strong>add_reference</strong>(table_name, ref_name, options = {})  </a>
        (also: #add_belongs_to)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Adds a reference.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#add_timestamps-instance_method" title="#add_timestamps (instance method)">#<strong>add_timestamps</strong>(table_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Adds timestamps (<code>created_at</code> and <code>updated_at</code>)
columns to <code>table_name</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#assume_migrated_upto_version-instance_method" title="#assume_migrated_upto_version (instance method)">#<strong>assume_migrated_upto_version</strong>(version, migrations_paths = ActiveRecord::Migrator.migrations_paths)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#change_column-instance_method" title="#change_column (instance method)">#<strong>change_column</strong>(table_name, column_name, type, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Changes the column&#39;s definition according to the new options.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#change_column_default-instance_method" title="#change_column_default (instance method)">#<strong>change_column_default</strong>(table_name, column_name, default)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets a new default value for a column:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#change_column_null-instance_method" title="#change_column_null (instance method)">#<strong>change_column_null</strong>(table_name, column_name, null, default = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets or removes a <tt>NOT NULL</tt> constraint on a column.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#change_table-instance_method" title="#change_table (instance method)">#<strong>change_table</strong>(table_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>A block for changing columns in <code>table</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#column_exists%3F-instance_method" title="#column_exists? (instance method)">#<strong>column_exists?</strong>(table_name, column_name, type = nil, options = {})  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Checks to see if a column exists in a given table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#columns-instance_method" title="#columns (instance method)">#<strong>columns</strong>(table_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an array of Column objects for the table specified by
<code>table_name</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#columns_for_distinct-instance_method" title="#columns_for_distinct (instance method)">#<strong>columns_for_distinct</strong>(columns, orders)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Given a set of columns and an ORDER BY clause, returns the columns for a
SELECT DISTINCT.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create_join_table-instance_method" title="#create_join_table (instance method)">#<strong>create_join_table</strong>(table_1, table_2, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a new join table with the name created using the lexical order of
the first two arguments.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create_table-instance_method" title="#create_table (instance method)">#<strong>create_table</strong>(table_name, options = {}) {|td| ... } </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a new table with the name <code>table_name</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#data_source_exists%3F-instance_method" title="#data_source_exists? (instance method)">#<strong>data_source_exists?</strong>(name)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Checks to see if the data source <code>name</code> exists on the database.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#data_sources-instance_method" title="#data_sources (instance method)">#<strong>data_sources</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the relation names useable to back Active Record models.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#drop_join_table-instance_method" title="#drop_join_table (instance method)">#<strong>drop_join_table</strong>(table_1, table_2, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Drops the join table specified by the given arguments.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#drop_table-instance_method" title="#drop_table (instance method)">#<strong>drop_table</strong>(table_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Drops a table from the database.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#foreign_keys-instance_method" title="#foreign_keys (instance method)">#<strong>foreign_keys</strong>(table_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an array of foreign keys for the given table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#index_exists%3F-instance_method" title="#index_exists? (instance method)">#<strong>index_exists?</strong>(table_name, column_name, options = {})  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Checks to see if an index exists on a table for a given index definition.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#index_name_exists%3F-instance_method" title="#index_name_exists? (instance method)">#<strong>index_name_exists?</strong>(table_name, index_name, default)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Verifies the existence of an index with a given name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#initialize_schema_migrations_table-instance_method" title="#initialize_schema_migrations_table (instance method)">#<strong>initialize_schema_migrations_table</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Should not be called normally, but this operation is non-destructive.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#native_database_types-instance_method" title="#native_database_types (instance method)">#<strong>native_database_types</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a hash of mappings from the abstract data types to the native
database types.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_belongs_to-instance_method" title="#remove_belongs_to (instance method)">#<strong>remove_belongs_to</strong>(table_name, ref_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#remove_reference-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#remove_reference (method)">#remove_reference</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_column-instance_method" title="#remove_column (instance method)">#<strong>remove_column</strong>(table_name, column_name, type = nil, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Removes the column from the table definition.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_columns-instance_method" title="#remove_columns (instance method)">#<strong>remove_columns</strong>(table_name, *column_names)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Removes the given columns from the table definition.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_foreign_key-instance_method" title="#remove_foreign_key (instance method)">#<strong>remove_foreign_key</strong>(from_table, options_or_to_table = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Removes the given foreign key from the table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_index-instance_method" title="#remove_index (instance method)">#<strong>remove_index</strong>(table_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Removes the given index from the table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_reference-instance_method" title="#remove_reference (instance method)">#<strong>remove_reference</strong>(table_name, ref_name, options = {})  </a>
        (also: #remove_belongs_to)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Removes the reference(s).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_timestamps-instance_method" title="#remove_timestamps (instance method)">#<strong>remove_timestamps</strong>(table_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Removes the timestamp columns (<code>created_at</code> and
<code>updated_at</code>) from the table definition.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rename_column-instance_method" title="#rename_column (instance method)">#<strong>rename_column</strong>(table_name, column_name, new_column_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Renames a column.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rename_index-instance_method" title="#rename_index (instance method)">#<strong>rename_index</strong>(table_name, old_name, new_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Renames an index.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rename_table-instance_method" title="#rename_table (instance method)">#<strong>rename_table</strong>(table_name, new_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Renames a table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#table_alias_for-instance_method" title="#table_alias_for (instance method)">#<strong>table_alias_for</strong>(table_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Truncates a table alias according to the limits of the current adapter.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#table_exists%3F-instance_method" title="#table_exists? (instance method)">#<strong>table_exists?</strong>(table_name)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Checks to see if the table <code>table_name</code> exists on the database.</p>
</div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="TimestampDefaultDeprecation.html" title="ActiveRecord::ConnectionAdapters::TimestampDefaultDeprecation (module)">TimestampDefaultDeprecation</a></h3>
  <p class="inherited"><a href="TimestampDefaultDeprecation.html#emit_warning_if_null_unspecified-instance_method" title="ActiveRecord::ConnectionAdapters::TimestampDefaultDeprecation#emit_warning_if_null_unspecified (method)">#emit_warning_if_null_unspecified</a></p>

  
  
  
  
  
  <h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="add_belongs_to-instance_method">
  <h3 class='signature first'>
  #<strong>add_belongs_to</strong>(table_name, ref_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#add_reference-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#add_reference (method)">#add_reference</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="add_column-instance_method">
  <h3 class='signature'>
  #<strong>add_column</strong>(table_name, column_name, type, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Adds a new column to the named table. See <a href="TableDefinition.html#column-instance_method" title="ActiveRecord::ConnectionAdapters::TableDefinition#column (method)">TableDefinition#column</a> for
details of the options you can use.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


404
405
406
407
408</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 404</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_column'>add_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_at'>at</span> <span class='op'>=</span> <span class='id identifier rubyid_create_alter_table'>create_alter_table</span> <span class='id identifier rubyid_table_name'>table_name</span>
  <span class='id identifier rubyid_at'>at</span><span class='period'>.</span><span class='id identifier rubyid_add_column'>add_column</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_schema_creation'>schema_creation</span><span class='period'>.</span><span class='id identifier rubyid_accept'>accept</span> <span class='id identifier rubyid_at'>at</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="add_foreign_key-instance_method">
  <h3 class='signature'>
  #<strong>add_foreign_key</strong>(from_table, to_table, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Adds a new foreign key. <code>from_table</code> is the table with the key
column, <code>to_table</code> contains the referenced primary key.</p>

<p>The foreign key will be named after the following pattern:
<code>fk_rails_&lt;identifier&gt;</code>. <code>identifier</code> is a 10
character long string which is deterministically generated from the
<code>from_table</code> and <code>column</code>. A custom name can be
specified with the <code>:name</code> option.</p>

<h6 id="label-Creating+a+simple+foreign+key">Creating a simple foreign key</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_foreign_key'>add_foreign_key</span> <span class='symbol'>:articles</span><span class='comma'>,</span> <span class='symbol'>:authors</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">ALTER TABLE &quot;articles&quot; ADD CONSTRAINT articles_author_id_fk FOREIGN KEY (&quot;author_id&quot;) REFERENCES &quot;authors&quot; (&quot;id&quot;)</code></pre>

<h6 id="label-Creating+a+foreign+key+on+a+specific+column">Creating a foreign key on a specific column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_foreign_key'>add_foreign_key</span> <span class='symbol'>:articles</span><span class='comma'>,</span> <span class='symbol'>:users</span><span class='comma'>,</span> <span class='label'>column:</span> <span class='symbol'>:author_id</span><span class='comma'>,</span> <span class='label'>primary_key:</span> <span class='symbol'>:lng_id</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">ALTER TABLE &quot;articles&quot; ADD CONSTRAINT fk_rails_58ca3d3a82 FOREIGN KEY (&quot;author_id&quot;) REFERENCES &quot;users&quot; (&quot;lng_id&quot;)</code></pre>

<h6 id="label-Creating+a+cascading+foreign+key">Creating a cascading foreign key</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_foreign_key'>add_foreign_key</span> <span class='symbol'>:articles</span><span class='comma'>,</span> <span class='symbol'>:authors</span><span class='comma'>,</span> <span class='label'>on_delete:</span> <span class='symbol'>:cascade</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">ALTER TABLE &quot;articles&quot; ADD CONSTRAINT articles_author_id_fk FOREIGN KEY (&quot;author_id&quot;) REFERENCES &quot;authors&quot; (&quot;id&quot;) ON DELETE CASCADE</code></pre>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:column</code>
<dd>
<p>The foreign key column name on <code>from_table</code>. Defaults to
<code>to_table.singularize + &quot;_id&quot;</code></p>
</dd><dt><code>:primary_key</code>
<dd>
<p>The primary key column name on <code>to_table</code>. Defaults to
<code>id</code>.</p>
</dd><dt><code>:name</code>
<dd>
<p>The constraint name. Defaults to <code>fk_rails_&lt;identifier&gt;</code>.</p>
</dd><dt><code>:on_delete</code>
<dd>
<p>Action that happens <code>ON DELETE</code>. Valid values are
<code>:nullify</code>, <code>:cascade:</code> and <code>:restrict</code></p>
</dd><dt><code>:on_update</code>
<dd>
<p>Action that happens <code>ON UPDATE</code>. Valid values are
<code>:nullify</code>, <code>:cascade:</code> and <code>:restrict</code></p>
</dd></dl>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 761</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_foreign_key'>add_foreign_key</span><span class='lparen'>(</span><span class='id identifier rubyid_from_table'>from_table</span><span class='comma'>,</span> <span class='id identifier rubyid_to_table'>to_table</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_supports_foreign_keys?'>supports_foreign_keys?</span>

  <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:column</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_foreign_key_column_for'>foreign_key_column_for</span><span class='lparen'>(</span><span class='id identifier rubyid_to_table'>to_table</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>column:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:column</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>primary_key:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:primary_key</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>name:</span> <span class='id identifier rubyid_foreign_key_name'>foreign_key_name</span><span class='lparen'>(</span><span class='id identifier rubyid_from_table'>from_table</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>on_delete:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:on_delete</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>on_update:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:on_update</span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_at'>at</span> <span class='op'>=</span> <span class='id identifier rubyid_create_alter_table'>create_alter_table</span> <span class='id identifier rubyid_from_table'>from_table</span>
  <span class='id identifier rubyid_at'>at</span><span class='period'>.</span><span class='id identifier rubyid_add_foreign_key'>add_foreign_key</span> <span class='id identifier rubyid_to_table'>to_table</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>

  <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_schema_creation'>schema_creation</span><span class='period'>.</span><span class='id identifier rubyid_accept'>accept</span><span class='lparen'>(</span><span class='id identifier rubyid_at'>at</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="add_index-instance_method">
  <h3 class='signature'>
  #<strong>add_index</strong>(table_name, column_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Adds a new index to the table. <code>column_name</code> can be a single
Symbol, or an Array of Symbols.</p>

<p>The index will be named after the table and the column name(s), unless you
pass <code>:name</code> as an option.</p>

<h6 id="label-Creating+a+simple+index">Creating a simple index</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>CREATE</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_suppliers_name_index'>suppliers_name_index</span> <span class='const'>ON</span> <span class='id identifier rubyid_suppliers'>suppliers</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
</code></pre>

<h6 id="label-Creating+a+unique+index">Creating a unique index</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:branch_id</span><span class='comma'>,</span> <span class='symbol'>:party_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>unique:</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>CREATE</span> <span class='const'>UNIQUE</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_accounts_branch_id_party_id_index'>accounts_branch_id_party_id_index</span> <span class='const'>ON</span> <span class='id identifier rubyid_accounts'>accounts</span><span class='lparen'>(</span><span class='id identifier rubyid_branch_id'>branch_id</span><span class='comma'>,</span> <span class='id identifier rubyid_party_id'>party_id</span><span class='rparen'>)</span>
</code></pre>

<h6 id="label-Creating+a+named+index">Creating a named index</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:branch_id</span><span class='comma'>,</span> <span class='symbol'>:party_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>unique:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>by_branch_party</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>CREATE</span> <span class='const'>UNIQUE</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_by_branch_party'>by_branch_party</span> <span class='const'>ON</span> <span class='id identifier rubyid_accounts'>accounts</span><span class='lparen'>(</span><span class='id identifier rubyid_branch_id'>branch_id</span><span class='comma'>,</span> <span class='id identifier rubyid_party_id'>party_id</span><span class='rparen'>)</span>
</code></pre>

<h6 id="label-Creating+an+index+with+specific+key+length">Creating an index with specific key length</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>by_name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>length:</span> <span class='int'>10</span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>CREATE</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_by_name'>by_name</span> <span class='const'>ON</span> <span class='id identifier rubyid_accounts'>accounts</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='rparen'>)</span>

<span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:surname</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>by_name_surname</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span><span class='label'>name:</span> <span class='int'>10</span><span class='comma'>,</span> <span class='label'>surname:</span> <span class='int'>15</span><span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>CREATE</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_by_name_surname'>by_name_surname</span> <span class='const'>ON</span> <span class='id identifier rubyid_accounts'>accounts</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_surname'>surname</span><span class='lparen'>(</span><span class='int'>15</span><span class='rparen'>)</span><span class='rparen'>)</span>
</code></pre>

<p>Note: SQLite doesn&#39;t support index length.</p>

<h6 id="label-Creating+an+index+with+a+sort+order+-28desc+or+asc-2C+asc+is+the+default-29">Creating an index with a sort order (desc or asc, asc is the default)</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:branch_id</span><span class='comma'>,</span> <span class='symbol'>:party_id</span><span class='comma'>,</span> <span class='symbol'>:surname</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>order:</span> <span class='lbrace'>{</span><span class='label'>branch_id:</span> <span class='symbol'>:desc</span><span class='comma'>,</span> <span class='label'>party_id:</span> <span class='symbol'>:asc</span><span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">CREATE INDEX by_branch_desc_party ON accounts(branch_id DESC, party_id ASC, surname)</code></pre>

<p>Note: MySQL doesn&#39;t yet support index order (it accepts the syntax but
ignores it).</p>

<h6 id="label-Creating+a+partial+index">Creating a partial index</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:branch_id</span><span class='comma'>,</span> <span class='symbol'>:party_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>unique:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>where:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">CREATE UNIQUE INDEX index_accounts_on_branch_id_and_party_id ON accounts(branch_id, party_id) WHERE active</code></pre>

<p>Note: Partial indexes are only supported for PostgreSQL and SQLite 3.8.0+.</p>

<h6 id="label-Creating+an+index+with+a+specific+method">Creating an index with a specific method</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:developers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>using:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>btree</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>CREATE</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_index_developers_on_name'>index_developers_on_name</span> <span class='const'>ON</span> <span class='id identifier rubyid_developers'>developers</span> <span class='const'>USING</span> <span class='id identifier rubyid_btree'>btree</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>-</span><span class='op'>-</span> <span class='const'>PostgreSQL</span>
<span class='const'>CREATE</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_index_developers_on_name'>index_developers_on_name</span> <span class='const'>USING</span> <span class='id identifier rubyid_btree'>btree</span> <span class='const'>ON</span> <span class='id identifier rubyid_developers'>developers</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>-</span><span class='op'>-</span> <span class='const'>MySQL</span>
</code></pre>

<p>Note: only supported by PostgreSQL and MySQL</p>

<h6 id="label-Creating+an+index+with+a+specific+type">Creating an index with a specific type</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='symbol'>:developers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:fulltext</span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>CREATE</span> <span class='const'>FULLTEXT</span> <span class='const'>INDEX</span> <span class='id identifier rubyid_index_developers_on_name'>index_developers_on_name</span> <span class='const'>ON</span> <span class='id identifier rubyid_developers'>developers</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>-</span><span class='op'>-</span> <span class='const'>MySQL</span>
</code></pre>

<p>Note: only supported by MySQL. Supported: <code>:fulltext</code> and
<code>:spatial</code> on MyISAM tables.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


569
570
571
572</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 569</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_index_name'>index_name</span><span class='comma'>,</span> <span class='id identifier rubyid_index_type'>index_type</span><span class='comma'>,</span> <span class='id identifier rubyid_index_columns'>index_columns</span><span class='comma'>,</span> <span class='id identifier rubyid_index_options'>index_options</span> <span class='op'>=</span> <span class='id identifier rubyid_add_index_options'>add_index_options</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CREATE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_index_type'>index_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> INDEX </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_index_name'>index_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> ON </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_index_columns'>index_columns</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_index_options'>index_options</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="add_reference-instance_method">
  <h3 class='signature'>
  #<strong>add_reference</strong>(table_name, ref_name, options = {})  
  <span class='aliases'>Also known as: <span class='names'><span>add_belongs_to</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Adds a reference. The reference column is an integer by default, the
<code>:type</code> option can be used to specify a different type.
Optionally adds a <code>_type</code> column, if <code>:polymorphic</code>
option is provided. <code>add_reference</code> and
<code>add_belongs_to</code> are acceptable.</p>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:type</code>
<dd>
<p>The reference column type. Defaults to <code>:integer</code>.</p>
</dd><dt><code>:index</code>
<dd>
<p>Add an appropriate index. Defaults to false.</p>
</dd><dt><code>:foreign_key</code>
<dd>
<p>Add an appropriate foreign key. Defaults to false.</p>
</dd><dt><code>:polymorphic</code>
<dd>
<p>Wether an additional <code>_type</code> column should be added. Defaults to
false.</p>
</dd></dl>

<h6 id="label-Create+a+user_id+integer+column">Create a user_id integer column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_reference'>add_reference</span><span class='lparen'>(</span><span class='symbol'>:products</span><span class='comma'>,</span> <span class='symbol'>:user</span><span class='rparen'>)</span>
</code></pre>

<h6 id="label-Create+a+user_id+string+column">Create a user_id string column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_reference'>add_reference</span><span class='lparen'>(</span><span class='symbol'>:products</span><span class='comma'>,</span> <span class='symbol'>:user</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:string</span><span class='rparen'>)</span>
</code></pre>

<h6 id="label-Create+supplier_id-2C+supplier_type+columns+and+appropriate+index">Create supplier_id, supplier_type columns and appropriate index</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_reference'>add_reference</span><span class='lparen'>(</span><span class='symbol'>:products</span><span class='comma'>,</span> <span class='symbol'>:supplier</span><span class='comma'>,</span> <span class='label'>polymorphic:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>index:</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 667</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_reference'>add_reference</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_ref_name'>ref_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_polymorphic'>polymorphic</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:polymorphic</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_index_options'>index_options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:index</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:type</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='symbol'>:integer</span>
  <span class='id identifier rubyid_foreign_key_options'>foreign_key_options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:foreign_key</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_polymorphic'>polymorphic</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_foreign_key_options'>foreign_key_options</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot add a foreign key to a polymorphic relation</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_add_column'>add_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ref_name'>ref_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_add_column'>add_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ref_name'>ref_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_type</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='id identifier rubyid_polymorphic'>polymorphic</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_polymorphic'>polymorphic</span> <span class='op'>:</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_polymorphic'>polymorphic</span>
  <span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_polymorphic'>polymorphic</span> <span class='op'>?</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>type</span><span class='words_sep'> </span><span class='tstring_content'>id</span><span class='words_sep'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ref_name'>ref_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_t'>t</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ref_name'>ref_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_index_options'>index_options</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_index_options'>index_options</span> <span class='op'>:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_index_options'>index_options</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_foreign_key_options'>foreign_key_options</span>
    <span class='id identifier rubyid_to_table'>to_table</span> <span class='op'>=</span> <span class='const'>Base</span><span class='period'>.</span><span class='id identifier rubyid_pluralize_table_names'>pluralize_table_names</span> <span class='op'>?</span> <span class='id identifier rubyid_ref_name'>ref_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_pluralize'>pluralize</span> <span class='op'>:</span> <span class='id identifier rubyid_ref_name'>ref_name</span>
    <span class='id identifier rubyid_add_foreign_key'>add_foreign_key</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_to_table'>to_table</span><span class='comma'>,</span> <span class='id identifier rubyid_foreign_key_options'>foreign_key_options</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_foreign_key_options'>foreign_key_options</span> <span class='op'>:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="add_timestamps-instance_method">
  <h3 class='signature'>
  #<strong>add_timestamps</strong>(table_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Adds timestamps (<code>created_at</code> and <code>updated_at</code>)
columns to <code>table_name</code>. Additional options (like <code>null:
false</code>) are forwarded to <a href="#add_column-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#add_column (method)">#add_column</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_add_timestamps'>add_timestamps</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='label'>null:</span> <span class='kw'>false</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


908
909
910
911
912</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 908</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_timestamps'>add_timestamps</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_emit_warning_if_null_unspecified'>emit_warning_if_null_unspecified</span><span class='lparen'>(</span><span class='symbol'>:add_timestamps</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_add_column'>add_column</span> <span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='symbol'>:created_at</span><span class='comma'>,</span> <span class='symbol'>:datetime</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>
  <span class='id identifier rubyid_add_column'>add_column</span> <span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='symbol'>:updated_at</span><span class='comma'>,</span> <span class='symbol'>:datetime</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="assume_migrated_upto_version-instance_method">
  <h3 class='signature'>
  #<strong>assume_migrated_upto_version</strong>(version, migrations_paths = ActiveRecord::Migrator.migrations_paths)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 839</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assume_migrated_upto_version'>assume_migrated_upto_version</span><span class='lparen'>(</span><span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_migrations_paths'>migrations_paths</span> <span class='op'>=</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Migrator</span><span class='period'>.</span><span class='id identifier rubyid_migrations_paths'>migrations_paths</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_migrations_paths'>migrations_paths</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_migrations_paths'>migrations_paths</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='id identifier rubyid_sm_table'>sm_table</span> <span class='op'>=</span> <span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Migrator</span><span class='period'>.</span><span class='id identifier rubyid_schema_migrations_table_name'>schema_migrations_table_name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_migrated'>migrated</span> <span class='op'>=</span> <span class='id identifier rubyid_select_values'>select_values</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT version FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sm_table'>sm_table</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_paths'>paths</span> <span class='op'>=</span> <span class='id identifier rubyid_migrations_paths'>migrations_paths</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_p'>p</span><span class='embexpr_end'>}</span><span class='tstring_content'>/[0-9]*_*.rb</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_versions'>versions</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='lbracket'>[</span><span class='op'>*</span><span class='id identifier rubyid_paths'>paths</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_filename'>filename</span><span class='op'>|</span>
    <span class='id identifier rubyid_filename'>filename</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_migrated'>migrated</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_version'>version</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>INSERT INTO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sm_table'>sm_table</span><span class='embexpr_end'>}</span><span class='tstring_content'> (version) VALUES (&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_version'>version</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_inserted'>inserted</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_versions'>versions</span> <span class='op'>-</span> <span class='id identifier rubyid_migrated'>migrated</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_inserted'>inserted</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Duplicate migration </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Please renumber your migrations to resolve the conflict.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_version'>version</span>
      <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>INSERT INTO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sm_table'>sm_table</span><span class='embexpr_end'>}</span><span class='tstring_content'> (version) VALUES (&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;)</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_inserted'>inserted</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_v'>v</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="change_column-instance_method">
  <h3 class='signature'>
  #<strong>change_column</strong>(table_name, column_name, type, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Changes the column&#39;s definition according to the new options. See
<a href="TableDefinition.html#column-instance_method" title="ActiveRecord::ConnectionAdapters::TableDefinition#column (method)">TableDefinition#column</a> for details of the options you can use.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_column'>change_column</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='id identifier rubyid_change_column'>change_column</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:text</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>NotImplementedError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


438
439
440</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 438</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_column'>change_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>change_column is not implemented</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="change_column_default-instance_method">
  <h3 class='signature'>
  #<strong>change_column_default</strong>(table_name, column_name, default)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets a new default value for a column:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:qualification</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>new</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='symbol'>:authorized</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
</code></pre>

<p>Setting the default to <code>nil</code> effectively drops the default:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='symbol'>:users</span><span class='comma'>,</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>NotImplementedError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


451
452
453</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 451</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>change_column_default is not implemented</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="change_column_null-instance_method">
  <h3 class='signature'>
  #<strong>change_column_null</strong>(table_name, column_name, null, default = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets or removes a <tt>NOT NULL</tt> constraint on a column. The <code>null</code>
flag indicates whether the value can be <code>NULL</code>. For example</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='symbol'>:users</span><span class='comma'>,</span> <span class='symbol'>:nickname</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>
</code></pre>

<p>says nicknames cannot be <code>NULL</code> (adds the constraint), whereas</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='symbol'>:users</span><span class='comma'>,</span> <span class='symbol'>:nickname</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<p>allows them to be <code>NULL</code> (drops the constraint).</p>

<p>The method accepts an optional fourth argument to replace existing <tt>NULL</tt>s
with some other value. Use that one when enabling the constraint if needed,
since otherwise those rows would not be valid.</p>

<p>Please note the fourth argument does not set a column&#39;s default.</p>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>NotImplementedError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


471
472
473</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 471</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_null'>null</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>change_column_null is not implemented</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="change_table-instance_method">
  <h3 class='signature'>
  #<strong>change_table</strong>(table_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>A block for changing columns in <code>table</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># change_table() yields a Table instance
</span><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='int'>60</span>
  <span class='comment'># Other column alterations here
</span><span class='kw'>end</span>
</code></pre>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:bulk</code>
<dd>
<p>Set this to true to make this a bulk alter query, such as</p>

<pre class="code ruby"><code class="ruby">ALTER TABLE `users` ADD COLUMN age INT(11), ADD COLUMN birthdate DATETIME ...</code></pre>

<p>Defaults to false.</p>
</dd></dl>

<h6 id="label-Add+a+column">Add a column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='int'>60</span>
<span class='kw'>end</span>
</code></pre>

<h6 id="label-Add+2+integer+columns">Add 2 integer columns</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_integer'>integer</span> <span class='symbol'>:width</span><span class='comma'>,</span> <span class='symbol'>:height</span><span class='comma'>,</span> <span class='label'>null:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='int'>0</span>
<span class='kw'>end</span>
</code></pre>

<h6 id="label-Add+created_at-2Fupdated_at+columns">Add created_at/updated_at columns</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_timestamps'>timestamps</span>
<span class='kw'>end</span>
</code></pre>

<h6 id="label-Add+a+foreign+key+column">Add a foreign key column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span> <span class='symbol'>:company</span>
<span class='kw'>end</span>
</code></pre>

<p>Creates a <code>company_id(integer)</code> column.</p>

<h6 id="label-Add+a+polymorphic+foreign+key+column">Add a polymorphic foreign key column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_belongs_to'>belongs_to</span> <span class='symbol'>:company</span><span class='comma'>,</span> <span class='label'>polymorphic:</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</code></pre>

<p>Creates <code>company_type(varchar)</code> and
<code>company_id(integer)</code> columns.</p>

<h6 id="label-Remove+a+column">Remove a column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span> <span class='symbol'>:company</span>
<span class='kw'>end</span>
</code></pre>

<h6 id="label-Remove+several+columns">Remove several columns</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span> <span class='symbol'>:company_id</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span> <span class='symbol'>:width</span><span class='comma'>,</span> <span class='symbol'>:height</span>
<span class='kw'>end</span>
</code></pre>

<h6 id="label-Remove+an+index">Remove an index</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_remove_index'>remove_index</span> <span class='symbol'>:company_id</span>
<span class='kw'>end</span>
</code></pre>

<p>See also Table for details on all of the various column transformation.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


371
372
373
374
375
376
377
378
379</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 371</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_table'>change_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_supports_bulk_alter?'>supports_bulk_alter?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:bulk</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_recorder'>recorder</span> <span class='op'>=</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Migration</span><span class='op'>::</span><span class='const'>CommandRecorder</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_update_table_definition'>update_table_definition</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_recorder'>recorder</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_bulk_change_table'>bulk_change_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_recorder'>recorder</span><span class='period'>.</span><span class='id identifier rubyid_commands'>commands</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_update_table_definition'>update_table_definition</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="column_exists?-instance_method">
  <h3 class='signature'>
  #<strong>column_exists?</strong>(table_name, column_name, type = nil, options = {})  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Checks to see if a column exists in a given table.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Check a column exists
</span><span class='id identifier rubyid_column_exists?'>column_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='rparen'>)</span>

<span class='comment'># Check a column exists of a particular type
</span><span class='id identifier rubyid_column_exists?'>column_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='rparen'>)</span>

<span class='comment'># Check a column exists with a specific definition
</span><span class='id identifier rubyid_column_exists?'>column_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='int'>100</span><span class='rparen'>)</span>
<span class='id identifier rubyid_column_exists?'>column_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_column_exists?'>column_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>null:</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='id identifier rubyid_column_exists?'>column_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:tax</span><span class='comma'>,</span> <span class='symbol'>:decimal</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='int'>8</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='int'>2</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


90
91
92
93
94
95
96
97
98
99</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 90</span>

<span class='kw'>def</span> <span class='id identifier rubyid_column_exists?'>column_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_column_name'>column_name</span> <span class='op'>=</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_columns'>columns</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_column_name'>column_name</span> <span class='op'>&amp;&amp;</span>
                                <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_type'>type</span>                     <span class='op'>||</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
                                <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:limit</span><span class='rparen'>)</span>     <span class='op'>||</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span> <span class='op'>==</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
                                <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:precision</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_precision'>precision</span> <span class='op'>==</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
                                <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:scale</span><span class='rparen'>)</span>     <span class='op'>||</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_scale'>scale</span> <span class='op'>==</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:scale</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
                                <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:default</span><span class='rparen'>)</span>   <span class='op'>||</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span> <span class='op'>==</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
                                <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:null</span><span class='rparen'>)</span>      <span class='op'>||</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_null'>null</span> <span class='op'>==</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:null</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="columns-instance_method">
  <h3 class='signature'>
  #<strong>columns</strong>(table_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an array of Column objects for the table specified by
<code>table_name</code>. See the concrete implementation for details on the
expected parameter values.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


74</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 74</span>

<span class='kw'>def</span> <span class='id identifier rubyid_columns'>columns</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="columns_for_distinct-instance_method">
  <h3 class='signature'>
  #<strong>columns_for_distinct</strong>(columns, orders)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Given a set of columns and an ORDER BY clause, returns the columns for a
SELECT DISTINCT. PostgreSQL, MySQL, and Oracle overrides this for custom
DISTINCT syntax - they require the order columns appear in the SELECT.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_columns_for_distinct'>columns_for_distinct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.created_at desc</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


898
899
900</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 898</span>

<span class='kw'>def</span> <span class='id identifier rubyid_columns_for_distinct'>columns_for_distinct</span><span class='lparen'>(</span><span class='id identifier rubyid_columns'>columns</span><span class='comma'>,</span> <span class='id identifier rubyid_orders'>orders</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_columns'>columns</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create_join_table-instance_method">
  <h3 class='signature'>
  #<strong>create_join_table</strong>(table_1, table_2, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a new join table with the name created using the lexical order of
the first two arguments. These arguments can be a String or a Symbol.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Creates a table called &#39;assemblies_parts&#39; with no id.
</span><span class='id identifier rubyid_create_join_table'>create_join_table</span><span class='lparen'>(</span><span class='symbol'>:assemblies</span><span class='comma'>,</span> <span class='symbol'>:parts</span><span class='rparen'>)</span>
</code></pre>

<p>You can pass a <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:table_name</code>
<dd>
<p>Sets the table name overriding the default</p>
</dd><dt><code>:column_options</code>
<dd>
<p>Any extra options you want appended to the columns definition.</p>
</dd><dt><code>:options</code>
<dd>
<p>Any extra options you want appended to the table definition.</p>
</dd><dt><code>:temporary</code>
<dd>
<p>Make a temporary table.</p>
</dd><dt><code>:force</code>
<dd>
<p>Set to true to drop the table before creating it. Defaults to false.</p>
</dd></dl>

<p>Note that <code>create_join_table</code> does not create any indices by
default; you can use its block form to do so yourself:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_create_join_table'>create_join_table</span> <span class='symbol'>:products</span><span class='comma'>,</span> <span class='symbol'>:categories</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span> <span class='symbol'>:product_id</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span> <span class='symbol'>:category_id</span>
<span class='kw'>end</span>
</code></pre>

<h6 id="label-Add+a+backend+specific+option+to+the+generated+SQL+-28MySQL-29">Add a backend specific option to the generated SQL (MySQL)</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_create_join_table'>create_join_table</span><span class='lparen'>(</span><span class='symbol'>:assemblies</span><span class='comma'>,</span> <span class='symbol'>:parts</span><span class='comma'>,</span> <span class='label'>options:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ENGINE=InnoDB DEFAULT CHARSET=utf8</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">CREATE TABLE assemblies_parts (
  assembly_id int NOT NULL,
  part_id int NOT NULL,
) ENGINE=InnoDB DEFAULT CHARSET=utf8</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


275
276
277
278
279
280
281
282
283
284
285
286
287
288</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 275</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_join_table'>create_join_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_1'>table_1</span><span class='comma'>,</span> <span class='id identifier rubyid_table_2'>table_2</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join_table_name'>join_table_name</span> <span class='op'>=</span> <span class='id identifier rubyid_find_join_table_name'>find_join_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_1'>table_1</span><span class='comma'>,</span> <span class='id identifier rubyid_table_2'>table_2</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_column_options'>column_options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:column_options</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_column_options'>column_options</span><span class='period'>.</span><span class='id identifier rubyid_reverse_merge!'>reverse_merge!</span><span class='lparen'>(</span><span class='label'>null:</span> <span class='kw'>false</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_t1_column'>t1_column</span><span class='comma'>,</span> <span class='id identifier rubyid_t2_column'>t2_column</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_table_1'>table_1</span><span class='comma'>,</span> <span class='id identifier rubyid_table_2'>table_2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_singularize'>singularize</span><span class='period'>.</span><span class='id identifier rubyid_foreign_key'>foreign_key</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='id identifier rubyid_join_table_name'>join_table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='kw'>false</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_td'>td</span><span class='op'>|</span>
    <span class='id identifier rubyid_td'>td</span><span class='period'>.</span><span class='id identifier rubyid_integer'>integer</span> <span class='id identifier rubyid_t1_column'>t1_column</span><span class='comma'>,</span> <span class='id identifier rubyid_column_options'>column_options</span>
    <span class='id identifier rubyid_td'>td</span><span class='period'>.</span><span class='id identifier rubyid_integer'>integer</span> <span class='id identifier rubyid_t2_column'>t2_column</span><span class='comma'>,</span> <span class='id identifier rubyid_column_options'>column_options</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_td'>td</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create_table-instance_method">
  <h3 class='signature'>
  #<strong>create_table</strong>(table_name, options = {}) {|td| ... } 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a new table with the name <code>table_name</code>.
<code>table_name</code> may either be a String or a Symbol.</p>

<p>There are two ways to work with <code>create_table</code>. You can use the
block form or the regular form, like this:</p>

<h3 id="label-Block+form">Block form</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># create_table() passes a TableDefinition object to the block.
</span><span class='comment'># This form will not only create the table, but also columns for the
</span><span class='comment'># table.
</span>
<span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='int'>60</span>
  <span class='comment'># Other fields here
</span><span class='kw'>end</span>
</code></pre>

<h3 id="label-Block+form-2C+with+shorthand">Block form, with shorthand</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># You can also use the column types as method calls, rather than calling the column method.
</span><span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='int'>60</span>
  <span class='comment'># Other fields here
</span><span class='kw'>end</span>
</code></pre>

<h3 id="label-Regular+form">Regular form</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># Creates a table called &#39;suppliers&#39; with no columns.
</span><span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span>
<span class='comment'># Add a column to &#39;suppliers&#39;.
</span><span class='id identifier rubyid_add_column'>add_column</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='label'>limit:</span> <span class='int'>60</span><span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:id</code>
<dd>
<p>Whether to automatically add a primary key column. Defaults to true. Join
tables for <code>has_and_belongs_to_many</code> should set it to false.</p>
</dd><dt><code>:primary_key</code>
<dd>
<p>The name of the primary key, if one is to be added automatically. Defaults
to <code>id</code>. If <code>:id</code> is false this option is ignored.</p>

<p>Note that Active Record models will automatically detect their primary key.
This can be avoided by using <code>self.primary_key=</code> on the model to
define the key explicitly.</p>
</dd><dt><code>:options</code>
<dd>
<p>Any extra options you want appended to the table definition.</p>
</dd><dt><code>:temporary</code>
<dd>
<p>Make a temporary table.</p>
</dd><dt><code>:force</code>
<dd>
<p>Set to true to drop the table before creating it. Set to
<code>:cascade</code> to drop dependent objects as well. Defaults to false.</p>
</dd><dt><code>:as</code>
<dd>
<p>SQL to use to generate the table. When this option is used, the block is
ignored, as are the <code>:id</code> and <code>:primary_key</code> options.</p>
</dd></dl>

<h6 id="label-Add+a+backend+specific+option+to+the+generated+SQL+-28MySQL-29">Add a backend specific option to the generated SQL (MySQL)</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='label'>options:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ENGINE=InnoDB DEFAULT CHARSET=utf8</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">CREATE TABLE suppliers (
  id int(11) DEFAULT NULL auto_increment PRIMARY KEY
) ENGINE=InnoDB DEFAULT CHARSET=utf8</code></pre>

<h6 id="label-Rename+the+primary+key+column">Rename the primary key column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='symbol'>:objects</span><span class='comma'>,</span> <span class='label'>primary_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>guid</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='int'>80</span>
<span class='kw'>end</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">CREATE TABLE objects (
  guid int(11) DEFAULT NULL auto_increment PRIMARY KEY,
  name varchar(80)
)</code></pre>

<h6 id="label-Do+not+add+a+primary+key+column">Do not add a primary key column</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='symbol'>:categories_suppliers</span><span class='comma'>,</span> <span class='label'>id:</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='symbol'>:category_id</span><span class='comma'>,</span> <span class='symbol'>:integer</span>
  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='symbol'>:supplier_id</span><span class='comma'>,</span> <span class='symbol'>:integer</span>
<span class='kw'>end</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">CREATE TABLE categories_suppliers (
  category_id int,
  supplier_id int
)</code></pre>

<h6 id="label-Create+a+temporary+table+based+on+a+query">Create a temporary table based on a query</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='symbol'>:long_query</span><span class='comma'>,</span> <span class='label'>temporary:</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='label'>as:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM orders INNER JOIN line_items ON order_id=orders.id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p>generates:</p>

<pre class="code ruby"><code class="ruby">CREATE TEMPORARY TABLE long_query AS
  SELECT * FROM orders INNER JOIN line_items ON order_id=orders.id</code></pre>

<p>See also <a href="TableDefinition.html#column-instance_method" title="ActiveRecord::ConnectionAdapters::TableDefinition#column (method)">TableDefinition#column</a> for details on how to create columns.</p>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(<tt>td</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 205</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_table'>create_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_td'>td</span> <span class='op'>=</span> <span class='id identifier rubyid_create_table_definition'>create_table_definition</span> <span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:temporary</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:options</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:as</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>false</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:as</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_pk'>pk</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:primary_key</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='const'>Base</span><span class='period'>.</span><span class='id identifier rubyid_get_primary_key'>get_primary_key</span> <span class='id identifier rubyid_table_name'>table_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_singularize'>singularize</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_td'>td</span><span class='period'>.</span><span class='id identifier rubyid_primary_key'>primary_key</span> <span class='id identifier rubyid_pk'>pk</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:primary_key</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>
  <span class='kw'>end</span>

  <span class='kw'>yield</span> <span class='id identifier rubyid_td'>td</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:force</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_table_exists?'>table_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_drop_table'>drop_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_schema_creation'>schema_creation</span><span class='period'>.</span><span class='id identifier rubyid_accept'>accept</span> <span class='id identifier rubyid_td'>td</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_supports_indexes_in_create?'>supports_indexes_in_create?</span>
    <span class='id identifier rubyid_td'>td</span><span class='period'>.</span><span class='id identifier rubyid_indexes'>indexes</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_index_options'>index_options</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_index_options'>index_options</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_td'>td</span><span class='period'>.</span><span class='id identifier rubyid_foreign_keys'>foreign_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_other_table_name'>other_table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_foreign_key_options'>foreign_key_options</span><span class='op'>|</span>
    <span class='id identifier rubyid_add_foreign_key'>add_foreign_key</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_table_name'>other_table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_foreign_key_options'>foreign_key_options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="data_source_exists?-instance_method">
  <h3 class='signature'>
  #<strong>data_source_exists?</strong>(name)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the data source <code>name</code> exists on the database.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_data_source_exists?'>data_source_exists?</span><span class='lparen'>(</span><span class='symbol'>:ebooks</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


32
33
34</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data_source_exists?'>data_source_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_data_sources'>data_sources</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="data_sources-instance_method">
  <h3 class='signature'>
  #<strong>data_sources</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the relation names useable to back Active Record models. For most
adapters this means all tables and views.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


24
25
26</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data_sources'>data_sources</span>
  <span class='id identifier rubyid_tables'>tables</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="drop_join_table-instance_method">
  <h3 class='signature'>
  #<strong>drop_join_table</strong>(table_1, table_2, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Drops the join table specified by the given arguments. See
<code>create_join_table</code> for details.</p>

<p>Although this command ignores the block if one is given, it can be helpful
to provide one in a migration&#39;s <code>change</code> method so it can be
reverted. In that case, the block will be used by create_join_table.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


296
297
298
299</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 296</span>

<span class='kw'>def</span> <span class='id identifier rubyid_drop_join_table'>drop_join_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_1'>table_1</span><span class='comma'>,</span> <span class='id identifier rubyid_table_2'>table_2</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join_table_name'>join_table_name</span> <span class='op'>=</span> <span class='id identifier rubyid_find_join_table_name'>find_join_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_1'>table_1</span><span class='comma'>,</span> <span class='id identifier rubyid_table_2'>table_2</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_drop_table'>drop_table</span><span class='lparen'>(</span><span class='id identifier rubyid_join_table_name'>join_table_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="drop_table-instance_method">
  <h3 class='signature'>
  #<strong>drop_table</strong>(table_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Drops a table from the database.</p>
<dl class="rdoc-list label-list"><dt><code>:force</code>
<dd>
<p>Set to <code>:cascade</code> to drop dependent objects as well. Defaults to
false.</p>
</dd></dl>

<p>Although this command ignores most <code>options</code> and the block if
one is given, it can be helpful to provide these in a migration&#39;s
<code>change</code> method so it can be reverted. In that case,
<code>options</code> and the block will be used by create_table.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


398
399
400</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 398</span>

<span class='kw'>def</span> <span class='id identifier rubyid_drop_table'>drop_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="foreign_keys-instance_method">
  <h3 class='signature'>
  #<strong>foreign_keys</strong>(table_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an array of foreign keys for the given table. The foreign keys are
represented as <code>ForeignKeyDefinition</code> objects.</p>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>NotImplementedError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


715
716
717</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 715</span>

<span class='kw'>def</span> <span class='id identifier rubyid_foreign_keys'>foreign_keys</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foreign_keys is not implemented</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="index_exists?-instance_method">
  <h3 class='signature'>
  #<strong>index_exists?</strong>(table_name, column_name, options = {})  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Checks to see if an index exists on a table for a given index definition.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Check an index exists
</span><span class='id identifier rubyid_index_exists?'>index_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:company_id</span><span class='rparen'>)</span>

<span class='comment'># Check an index on multiple columns exists
</span><span class='id identifier rubyid_index_exists?'>index_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:company_id</span><span class='comma'>,</span> <span class='symbol'>:company_type</span><span class='rbracket'>]</span><span class='rparen'>)</span>

<span class='comment'># Check a unique index exists
</span><span class='id identifier rubyid_index_exists?'>index_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:company_id</span><span class='comma'>,</span> <span class='label'>unique:</span> <span class='kw'>true</span><span class='rparen'>)</span>

<span class='comment'># Check an index with a custom name exists
</span><span class='id identifier rubyid_index_exists?'>index_exists?</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:company_id</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>idx_company_id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


61
62
63
64
65
66
67
68
69
70</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 61</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index_exists?'>index_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_column_names'>column_names</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_s</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_index_name'>index_name</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>:</span> <span class='id identifier rubyid_index_name'>index_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='label'>column:</span> <span class='id identifier rubyid_column_names'>column_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_checks'>checks</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_checks'>checks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_index_name'>index_name</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_checks'>checks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_columns'>columns</span> <span class='op'>==</span> <span class='id identifier rubyid_column_names'>column_names</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_checks'>checks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_unique'>unique</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:unique</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_indexes'>indexes</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_checks'>checks</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_check'>check</span><span class='op'>|</span> <span class='id identifier rubyid_check'>check</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="index_name_exists?-instance_method">
  <h3 class='signature'>
  #<strong>index_name_exists?</strong>(table_name, index_name, default)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Verifies the existence of an index with a given name.</p>

<p>The default argument is returned if the underlying implementation does not
define the indexes method, as there&#39;s no way to determine the correct
answer in that case.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


634
635
636
637
638</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 634</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index_name_exists?'>index_name_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_index_name'>index_name</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_default'>default</span> <span class='kw'>unless</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:indexes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_index_name'>index_name</span> <span class='op'>=</span> <span class='id identifier rubyid_index_name'>index_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_indexes'>indexes</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_index_name'>index_name</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="initialize_schema_migrations_table-instance_method">
  <h3 class='signature'>
  #<strong>initialize_schema_migrations_table</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Should not be called normally, but this operation is non-destructive. The
migrations module handles this automatically.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


835
836
837</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 835</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_schema_migrations_table'>initialize_schema_migrations_table</span>
  <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>SchemaMigration</span><span class='period'>.</span><span class='id identifier rubyid_create_table'>create_table</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="native_database_types-instance_method">
  <h3 class='signature'>
  #<strong>native_database_types</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a hash of mappings from the abstract data types to the native
database types. See <a href="TableDefinition.html#column-instance_method" title="ActiveRecord::ConnectionAdapters::TableDefinition#column (method)">TableDefinition#column</a> for details on the recognized
abstract data types.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


13
14
15</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 13</span>

<span class='kw'>def</span> <span class='id identifier rubyid_native_database_types'>native_database_types</span>
  <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="remove_belongs_to-instance_method">
  <h3 class='signature'>
  #<strong>remove_belongs_to</strong>(table_name, ref_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#remove_reference-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#remove_reference (method)">#remove_reference</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="remove_column-instance_method">
  <h3 class='signature'>
  #<strong>remove_column</strong>(table_name, column_name, type = nil, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes the column from the table definition.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_column'>remove_column</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:qualification</span><span class='rparen'>)</span>
</code></pre>

<p>The <code>type</code> and <code>options</code> parameters will be ignored
if present. It can be helpful to provide these in a migration&#39;s
<code>change</code> method so it can be reverted. In that case,
<code>type</code> and <code>options</code> will be used by add_column.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


428
429
430</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 428</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_column'>remove_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> DROP </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="remove_columns-instance_method">
  <h3 class='signature'>
  #<strong>remove_columns</strong>(table_name, *column_names)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes the given columns from the table definition.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_columns'>remove_columns</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:qualification</span><span class='comma'>,</span> <span class='symbol'>:experience</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>ArgumentError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


414
415
416
417
418
419</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_columns'>remove_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_column_names'>column_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You must specify at least one column name. Example: remove_columns(:people, :first_name)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_column_names'>column_names</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_column_names'>column_names</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_column_name'>column_name</span><span class='op'>|</span>
    <span class='id identifier rubyid_remove_column'>remove_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="remove_foreign_key-instance_method">
  <h3 class='signature'>
  #<strong>remove_foreign_key</strong>(from_table, options_or_to_table = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes the given foreign key from the table.</p>

<p>Removes the foreign key on <code>accounts.branch_id</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_foreign_key'>remove_foreign_key</span> <span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='symbol'>:branches</span>
</code></pre>

<p>Removes the foreign key on <code>accounts.owner_id</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_foreign_key'>remove_foreign_key</span> <span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='label'>column:</span> <span class='symbol'>:owner_id</span>
</code></pre>

<p>Removes the foreign key named <code>special_fk_name</code> on the
<code>accounts</code> table.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_foreign_key'>remove_foreign_key</span> <span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='symbol'>:special_fk_name</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 793</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_foreign_key'>remove_foreign_key</span><span class='lparen'>(</span><span class='id identifier rubyid_from_table'>from_table</span><span class='comma'>,</span> <span class='id identifier rubyid_options_or_to_table'>options_or_to_table</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_supports_foreign_keys?'>supports_foreign_keys?</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options_or_to_table'>options_or_to_table</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_options_or_to_table'>options_or_to_table</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>column:</span> <span class='id identifier rubyid_foreign_key_column_for'>foreign_key_column_for</span><span class='lparen'>(</span><span class='id identifier rubyid_options_or_to_table'>options_or_to_table</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_fk_name_to_delete'>fk_name_to_delete</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_fk_to_delete'>fk_to_delete</span> <span class='op'>=</span> <span class='id identifier rubyid_foreign_keys'>foreign_keys</span><span class='lparen'>(</span><span class='id identifier rubyid_from_table'>from_table</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_fk'>fk</span><span class='op'>|</span> <span class='id identifier rubyid_fk'>fk</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='op'>==</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:column</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_fk_to_delete'>fk_to_delete</span>
      <span class='id identifier rubyid_fk_to_delete'>fk_to_delete</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Table &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_from_table'>from_table</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; has no foreign key on column &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:column</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_at'>at</span> <span class='op'>=</span> <span class='id identifier rubyid_create_alter_table'>create_alter_table</span> <span class='id identifier rubyid_from_table'>from_table</span>
  <span class='id identifier rubyid_at'>at</span><span class='period'>.</span><span class='id identifier rubyid_drop_foreign_key'>drop_foreign_key</span> <span class='id identifier rubyid_fk_name_to_delete'>fk_name_to_delete</span>

  <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_schema_creation'>schema_creation</span><span class='period'>.</span><span class='id identifier rubyid_accept'>accept</span><span class='lparen'>(</span><span class='id identifier rubyid_at'>at</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="remove_index-instance_method">
  <h3 class='signature'>
  #<strong>remove_index</strong>(table_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes the given index from the table.</p>

<p>Removes the <code>index_accounts_on_column</code> in the
<code>accounts</code> table.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_index'>remove_index</span> <span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='symbol'>:column</span>
</code></pre>

<p>Removes the index named <code>index_accounts_on_branch_id</code> in the
<code>accounts</code> table.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_index'>remove_index</span> <span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='label'>column:</span> <span class='symbol'>:branch_id</span>
</code></pre>

<p>Removes the index named
<code>index_accounts_on_branch_id_and_party_id</code> in the
<code>accounts</code> table.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_index'>remove_index</span> <span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='label'>column:</span> <span class='lbracket'>[</span><span class='symbol'>:branch_id</span><span class='comma'>,</span> <span class='symbol'>:party_id</span><span class='rbracket'>]</span>
</code></pre>

<p>Removes the index named <code>by_branch_party</code> in the
<code>accounts</code> table.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_index'>remove_index</span> <span class='symbol'>:accounts</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='symbol'>:by_branch_party</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


592
593
594</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 592</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_index'>remove_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_remove_index!'>remove_index!</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_index_name_for_remove'>index_name_for_remove</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="remove_reference-instance_method">
  <h3 class='signature'>
  #<strong>remove_reference</strong>(table_name, ref_name, options = {})  
  <span class='aliases'>Also known as: <span class='names'><span>remove_belongs_to</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes the reference(s). Also removes a <code>type</code> column if one
exists. <code>remove_reference</code>, <code>remove_references</code> and
<code>remove_belongs_to</code> are acceptable.</p>

<h6 id="label-Remove+the+reference">Remove the reference</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_reference'>remove_reference</span><span class='lparen'>(</span><span class='symbol'>:products</span><span class='comma'>,</span> <span class='symbol'>:user</span><span class='comma'>,</span> <span class='label'>index:</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<h6 id="label-Remove+polymorphic+reference">Remove polymorphic reference</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_reference'>remove_reference</span><span class='lparen'>(</span><span class='symbol'>:products</span><span class='comma'>,</span> <span class='symbol'>:supplier</span><span class='comma'>,</span> <span class='label'>polymorphic:</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<h6 id="label-Remove+the+reference+with+a+foreign+key">Remove the reference with a foreign key</h6>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_reference'>remove_reference</span><span class='lparen'>(</span><span class='symbol'>:products</span><span class='comma'>,</span> <span class='symbol'>:user</span><span class='comma'>,</span> <span class='label'>index:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>foreign_key:</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


702
703
704
705
706
707
708
709
710</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 702</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_reference'>remove_reference</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_ref_name'>ref_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:foreign_key</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_to_table'>to_table</span> <span class='op'>=</span> <span class='const'>Base</span><span class='period'>.</span><span class='id identifier rubyid_pluralize_table_names'>pluralize_table_names</span> <span class='op'>?</span> <span class='id identifier rubyid_ref_name'>ref_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_pluralize'>pluralize</span> <span class='op'>:</span> <span class='id identifier rubyid_ref_name'>ref_name</span>
    <span class='id identifier rubyid_remove_foreign_key'>remove_foreign_key</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_to_table'>to_table</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_remove_column'>remove_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ref_name'>ref_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_remove_column'>remove_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ref_name'>ref_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_type</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:polymorphic</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="remove_timestamps-instance_method">
  <h3 class='signature'>
  #<strong>remove_timestamps</strong>(table_name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes the timestamp columns (<code>created_at</code> and
<code>updated_at</code>) from the table definition.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_remove_timestamps'>remove_timestamps</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


918
919
920
921</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 918</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_timestamps'>remove_timestamps</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_remove_column'>remove_column</span> <span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='symbol'>:updated_at</span>
  <span class='id identifier rubyid_remove_column'>remove_column</span> <span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='symbol'>:created_at</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rename_column-instance_method">
  <h3 class='signature'>
  #<strong>rename_column</strong>(table_name, column_name, new_column_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Renames a column.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rename_column'>rename_column</span><span class='lparen'>(</span><span class='symbol'>:suppliers</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>NotImplementedError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


479
480
481</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 479</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rename_column'>rename_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_column_name'>new_column_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rename_column is not implemented</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rename_index-instance_method">
  <h3 class='signature'>
  #<strong>rename_index</strong>(table_name, old_name, new_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Renames an index.</p>

<p>Rename the <code>index_people_on_last_name</code> index to
<code>index_users_on_last_name</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rename_index'>rename_index</span> <span class='symbol'>:people</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index_people_on_last_name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index_users_on_last_name</span><span class='tstring_end'>&#39;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


606
607
608
609
610
611
612
613
614</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 606</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rename_index'>rename_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_validate_index_length!'>validate_index_length!</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>

  <span class='comment'># this is a naive implementation; some DBs may support this more efficiently (Postgres, for instance)
</span>  <span class='id identifier rubyid_old_index_def'>old_index_def</span> <span class='op'>=</span> <span class='id identifier rubyid_indexes'>indexes</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_old_name'>old_name</span> <span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_old_index_def'>old_index_def</span>
  <span class='id identifier rubyid_add_index'>add_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_old_index_def'>old_index_def</span><span class='period'>.</span><span class='id identifier rubyid_columns'>columns</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='comma'>,</span> <span class='label'>unique:</span> <span class='id identifier rubyid_old_index_def'>old_index_def</span><span class='period'>.</span><span class='id identifier rubyid_unique'>unique</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_remove_index'>remove_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rename_table-instance_method">
  <h3 class='signature'>
  #<strong>rename_table</strong>(table_name, new_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Renames a table.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rename_table'>rename_table</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>octopuses</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>octopi</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>NotImplementedError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


385
386
387</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 385</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rename_table'>rename_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rename_table is not implemented</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="table_alias_for-instance_method">
  <h3 class='signature'>
  #<strong>table_alias_for</strong>(table_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Truncates a table alias according to the limits of the current adapter.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


18
19
20</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 18</span>

<span class='kw'>def</span> <span class='id identifier rubyid_table_alias_for'>table_alias_for</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_table_name'>table_name</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_table_alias_length'>table_alias_length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_tr'>tr</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="table_exists?-instance_method">
  <h3 class='signature'>
  #<strong>table_exists?</strong>(table_name)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the table <code>table_name</code> exists on the database.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_table_exists?'>table_exists?</span><span class='lparen'>(</span><span class='symbol'>:developers</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


40
41
42</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb', line 40</span>

<span class='kw'>def</span> <span class='id identifier rubyid_table_exists?'>table_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tables'>tables</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.0 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>