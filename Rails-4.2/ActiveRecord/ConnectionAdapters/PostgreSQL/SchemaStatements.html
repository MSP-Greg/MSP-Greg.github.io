<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::ConnectionAdapters::PostgreSQL::SchemaStatements &mdash; Rails-4.2.7</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::ConnectionAdapters::PostgreSQL::SchemaStatements",
    relpath = '../../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../../index.html'>Home</a> &raquo; 
          <a href='../../../index.html'>Rails-4.2.7</a> &raquo; 
          <a href='../../../_index.html'>Index (S)</a> &raquo; 
          <a href="../../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <a href="../../ConnectionAdapters.html" title="ActiveRecord::ConnectionAdapters (module)">ConnectionAdapters</a> &raquo; 
          <a href="../PostgreSQL.html" title="ActiveRecord::ConnectionAdapters::PostgreSQL (module)">PostgreSQL</a> &raquo; 
          <span class='title'>SchemaStatements</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActiveRecord::ConnectionAdapters::PostgreSQL::SchemaStatements</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>




  <tr>
    <td class='box_1'>Included in:</td>
    <td><a href="../PostgreSQLAdapter.html" title="ActiveRecord::ConnectionAdapters::PostgreSQLAdapter (class)">ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</a>
    </td>
  </tr>

  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L38'>activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb</a></div>  </td>
  </tr>
</table>





<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#change_column-instance_method" title="#change_column (instance method)">#<strong>change_column</strong>(table_name, column_name, type, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Changes the column of a table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#change_column_default-instance_method" title="#change_column_default (instance method)">#<strong>change_column_default</strong>(table_name, column_name, default)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Changes the default value of a table column.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#change_column_null-instance_method" title="#change_column_null (instance method)">#<strong>change_column_null</strong>(table_name, column_name, null, default = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#client_min_messages-instance_method" title="#client_min_messages (instance method)">#<strong>client_min_messages</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current client message level.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#client_min_messages%3D-instance_method" title="#client_min_messages= (instance method)">#<strong>client_min_messages=</strong>(level)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Set the client message level.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#collation-instance_method" title="#collation (instance method)">#<strong>collation</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current database collation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#columns-instance_method" title="#columns (instance method)">#<strong>columns</strong>(table_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the list of all column definitions for a table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#columns_for_distinct-instance_method" title="#columns_for_distinct (instance method)">#<strong>columns_for_distinct</strong>(columns, orders)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>PostgreSQL requires the ORDER BY columns in the select list for distinct
queries, and requires that the ORDER BY include the distinct column.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create_database-instance_method" title="#create_database (instance method)">#<strong>create_database</strong>(name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Create a new PostgreSQL database.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create_schema-instance_method" title="#create_schema (instance method)">#<strong>create_schema</strong>(schema_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a schema for the given schema name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ctype-instance_method" title="#ctype (instance method)">#<strong>ctype</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current database ctype.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#current_database-instance_method" title="#current_database (instance method)">#<strong>current_database</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current database name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#current_schema-instance_method" title="#current_schema (instance method)">#<strong>current_schema</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current schema name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#data_source_exists%3F-instance_method" title="#data_source_exists? (instance method)">#<strong>data_source_exists?</strong>(name)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#table_exists%3F-instance_method" title="ActiveRecord::ConnectionAdapters::PostgreSQL::SchemaStatements#table_exists? (method)">#table_exists?</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#data_sources-instance_method" title="#data_sources (instance method)">#<strong>data_sources</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>:nodoc</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#default_sequence_name-instance_method" title="#default_sequence_name (instance method)">#<strong>default_sequence_name</strong>(table_name, pk = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the sequence name for a table&#39;s primary key or some other
specified key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#drop_database-instance_method" title="#drop_database (instance method)">#<strong>drop_database</strong>(name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Drops a PostgreSQL database.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#drop_schema-instance_method" title="#drop_schema (instance method)">#<strong>drop_schema</strong>(schema_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Drops the schema for the given schema name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#drop_table-instance_method" title="#drop_table (instance method)">#<strong>drop_table</strong>(table_name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#encoding-instance_method" title="#encoding (instance method)">#<strong>encoding</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current database encoding format.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#foreign_keys-instance_method" title="#foreign_keys (instance method)">#<strong>foreign_keys</strong>(table_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#index_name_exists%3F-instance_method" title="#index_name_exists? (instance method)">#<strong>index_name_exists?</strong>(table_name, index_name, default)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#index_name_length-instance_method" title="#index_name_length (instance method)">#<strong>index_name_length</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#indexes-instance_method" title="#indexes (instance method)">#<strong>indexes</strong>(table_name, name = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an array of indexes for the given table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#pk_and_sequence_for-instance_method" title="#pk_and_sequence_for (instance method)">#<strong>pk_and_sequence_for</strong>(table)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a table&#39;s primary key and belonging sequence.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#primary_key-instance_method" title="#primary_key (instance method)">#<strong>primary_key</strong>(table)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns just a table&#39;s primary key</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#recreate_database-instance_method" title="#recreate_database (instance method)">#<strong>recreate_database</strong>(name, options = {})  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Drops the database specified on the <code>name</code> attribute and creates
it again using the provided <code>options</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rename_column-instance_method" title="#rename_column (instance method)">#<strong>rename_column</strong>(table_name, column_name, new_column_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Renames a column in a table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rename_index-instance_method" title="#rename_index (instance method)">#<strong>rename_index</strong>(table_name, old_name, new_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rename_table-instance_method" title="#rename_table (instance method)">#<strong>rename_table</strong>(table_name, new_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Renames a table.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#reset_pk_sequence%21-instance_method" title="#reset_pk_sequence! (instance method)">#<strong>reset_pk_sequence!</strong>(table, pk = nil, sequence = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Resets the sequence of a table&#39;s primary key to the maximum value.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#schema_exists%3F-instance_method" title="#schema_exists? (instance method)">#<strong>schema_exists?</strong>(name)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if schema exists.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#schema_names-instance_method" title="#schema_names (instance method)">#<strong>schema_names</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an array of schema names.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#schema_search_path-instance_method" title="#schema_search_path (instance method)">#<strong>schema_search_path</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the active schema search path.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#schema_search_path%3D-instance_method" title="#schema_search_path= (instance method)">#<strong>schema_search_path=</strong>(schema_csv)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets the schema search path to a string of comma-separated schema names.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#serial_sequence-instance_method" title="#serial_sequence (instance method)">#<strong>serial_sequence</strong>(table, column)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#set_pk_sequence%21-instance_method" title="#set_pk_sequence! (instance method)">#<strong>set_pk_sequence!</strong>(table, value)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets the sequence of a table&#39;s primary key to the specified value.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#table_exists%3F-instance_method" title="#table_exists? (instance method)">#<strong>table_exists?</strong>(name)  &#x21d2; Boolean </a>
        (also: #data_source_exists?)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if table exists.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#tables-instance_method" title="#tables (instance method)">#<strong>tables</strong>(name = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the list of all tables in the schema search path.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#type_to_sql-instance_method" title="#type_to_sql (instance method)">#<strong>type_to_sql</strong>(type, limit = nil, precision = nil, scale = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Maps logical Rails types to PostgreSQL-specific data types.</p>
</div>
      </span>
    </li>
  </ul>


<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="change_column-instance_method">
  <h3 class='signature first'>
  #<strong>change_column</strong>(table_name, column_name, type, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Changes the column of a table.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L438'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


438
439
440
441
442
443
444
445
446
447
448
449
450
451
452</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 438</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_column'>change_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_clear_cache!'>clear_cache!</span>
  <span class='id identifier rubyid_quoted_table_name'>quoted_table_name</span> <span class='op'>=</span> <span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sql_type'>sql_type</span> <span class='op'>=</span> <span class='id identifier rubyid_type_to_sql'>type_to_sql</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:scale</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sql_type'>sql_type</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[]</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:array</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_sql'>sql</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quoted_table_name'>quoted_table_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> ALTER COLUMN </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> TYPE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sql_type'>sql_type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_sql'>sql</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> USING </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:using</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:using</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:cast_as</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_sql'>sql</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> USING CAST(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> AS </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type_to_sql'>type_to_sql</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:cast_as</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:scale</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_sql'>sql</span>

  <span class='id identifier rubyid_change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options_include_default?'>options_include_default?</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:null</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:null</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="change_column_default-instance_method">
  <h3 class='signature'>
  #<strong>change_column_default</strong>(table_name, column_name, default)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Changes the default value of a table column.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L455'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


455
456
457
458
459
460
461
462
463
464
465
466
467
468</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 455</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_clear_cache!'>clear_cache!</span>
  <span class='id identifier rubyid_column'>column</span> <span class='op'>=</span> <span class='id identifier rubyid_column_for'>column_for</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_column'>column</span>

  <span class='id identifier rubyid_alter_column_query'>alter_column_query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> ALTER COLUMN </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> %s</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_default'>default</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='comment'># &lt;tt&gt;DEFAULT NULL&lt;/tt&gt; results in the same behavior as &lt;tt&gt;DROP DEFAULT&lt;/tt&gt;. However, PostgreSQL will
</span>    <span class='comment'># cast the default to the columns type, which leaves us with a default like &quot;default NULL::character varying&quot;.
</span>    <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_alter_column_query'>alter_column_query</span> <span class='op'>%</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP DEFAULT</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_alter_column_query'>alter_column_query</span> <span class='op'>%</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SET DEFAULT </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_default_value'>quote_default_value</span><span class='lparen'>(</span><span class='id identifier rubyid_default'>default</span><span class='comma'>,</span> <span class='id identifier rubyid_column'>column</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="change_column_null-instance_method">
  <h3 class='signature'>
  #<strong>change_column_null</strong>(table_name, column_name, null, default = nil)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L470'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


470
471
472
473
474
475
476
477</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 470</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_null'>null</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_clear_cache!'>clear_cache!</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_null'>null</span> <span class='op'>||</span> <span class='id identifier rubyid_default'>default</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_column'>column</span> <span class='op'>=</span> <span class='id identifier rubyid_column_for'>column_for</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> SET </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_default_value'>quote_default_value</span><span class='lparen'>(</span><span class='id identifier rubyid_default'>default</span><span class='comma'>,</span> <span class='id identifier rubyid_column'>column</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> WHERE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> IS NULL</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_column'>column</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> ALTER </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_null'>null</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DROP</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SET</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> NOT NULL</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="client_min_messages-instance_method">
  <h3 class='signature'>
  #<strong>client_min_messages</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current client message level.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L280'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


280
281
282</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 280</span>

<span class='kw'>def</span> <span class='id identifier rubyid_client_min_messages'>client_min_messages</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHOW client_min_messages</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="client_min_messages=-instance_method">
  <h3 class='signature'>
  #<strong>client_min_messages=</strong>(level)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Set the client message level.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L285'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


285
286
287</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 285</span>

<span class='kw'>def</span> <span class='id identifier rubyid_client_min_messages='>client_min_messages=</span><span class='lparen'>(</span><span class='id identifier rubyid_level'>level</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SET client_min_messages TO &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_level'>level</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="collation-instance_method">
  <h3 class='signature'>
  #<strong>collation</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current database collation.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L228'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


228
229
230
231
232</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 228</span>

<span class='kw'>def</span> <span class='id identifier rubyid_collation'>collation</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='tstring_content'>    SELECT pg_database.datcollate FROM pg_database WHERE pg_database.datname LIKE &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_database'>current_database</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
</span><span class='heredoc_end'>  end_sql
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="columns-instance_method">
  <h3 class='signature'>
  #<strong>columns</strong>(table_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the list of all column definitions for a table.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L195'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


195
196
197
198
199
200
201
202
203</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 195</span>

<span class='kw'>def</span> <span class='id identifier rubyid_columns'>columns</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
  <span class='comment'># Limit, precision, and scale are all handled by the superclass.
</span>  <span class='id identifier rubyid_column_definitions'>column_definitions</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='comma'>,</span> <span class='id identifier rubyid_notnull'>notnull</span><span class='comma'>,</span> <span class='id identifier rubyid_oid'>oid</span><span class='comma'>,</span> <span class='id identifier rubyid_fmod'>fmod</span><span class='op'>|</span>
    <span class='id identifier rubyid_oid'>oid</span> <span class='op'>=</span> <span class='id identifier rubyid_get_oid_type'>get_oid_type</span><span class='lparen'>(</span><span class='id identifier rubyid_oid'>oid</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_fmod'>fmod</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_default_value'>default_value</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_value_from_default'>extract_value_from_default</span><span class='lparen'>(</span><span class='id identifier rubyid_oid'>oid</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_default_function'>default_function</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_default_function'>extract_default_function</span><span class='lparen'>(</span><span class='id identifier rubyid_default_value'>default_value</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_new_column'>new_column</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_default_value'>default_value</span><span class='comma'>,</span> <span class='id identifier rubyid_oid'>oid</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_notnull'>notnull</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>f</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_default_function'>default_function</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="columns_for_distinct-instance_method">
  <h3 class='signature'>
  #<strong>columns_for_distinct</strong>(columns, orders)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>PostgreSQL requires the ORDER BY columns in the select list for distinct
queries, and requires that the ORDER BY include the distinct column.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L582'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


582
583
584
585
586
587
588
589
590
591
592</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 582</span>

<span class='kw'>def</span> <span class='id identifier rubyid_columns_for_distinct'>columns_for_distinct</span><span class='lparen'>(</span><span class='id identifier rubyid_columns'>columns</span><span class='comma'>,</span> <span class='id identifier rubyid_orders'>orders</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_order_columns'>order_columns</span> <span class='op'>=</span> <span class='id identifier rubyid_orders'>orders</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:blank?</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
      <span class='comment'># Convert Arel node to string
</span>      <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_to_sql'>to_sql</span> <span class='kw'>unless</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><a href="../../../String.html" title="String (class)">String</a></span><span class='rparen'>)</span>
      <span class='comment'># Remove any ASC/DESC modifiers
</span>      <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+(?:ASC|DESC)\b</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
       <span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\sNULLS\s(?:FIRST|LAST)\b</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:blank?</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_with_index'>with_index</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_column'>column</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_column'>column</span><span class='embexpr_end'>}</span><span class='tstring_content'> AS alias_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>

  <span class='lbracket'>[</span><span class='kw'>super</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_order_columns'>order_columns</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create_database-instance_method">
  <h3 class='signature'>
  #<strong>create_database</strong>(name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Create a new PostgreSQL database. Options include <code>:owner</code>,
<code>:template</code>, <code>:encoding</code> (defaults to utf8),
<code>:collation</code>, <code>:ctype</code>, <code>:tablespace</code>, and
<code>:connection_limit</code> (note that MySQL uses <code>:charset</code>
while PostgreSQL uses <code>:encoding</code>).</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_create_database'>create_database</span> <span class='id identifier rubyid_config'>config</span><span class='lbracket'>[</span><span class='symbol'>:database</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_config'>config</span>
<span class='id identifier rubyid_create_database'>create_database</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo_development</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>encoding:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unicode</span><span class='tstring_end'>&#39;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L54'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 54</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_database'>create_database</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>encoding:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>utf8</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_symbolize_keys'>symbolize_keys</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_option_string'>option_string</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_memo'>memo</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='op'>|</span>
    <span class='id identifier rubyid_memo'>memo</span> <span class='op'>+=</span> <span class='kw'>case</span> <span class='id identifier rubyid_key'>key</span>
    <span class='kw'>when</span> <span class='symbol'>:owner</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> OWNER = \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:template</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> TEMPLATE = \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:encoding</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> ENCODING = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:collation</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> LC_COLLATE = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:ctype</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> LC_CTYPE = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:tablespace</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> TABLESPACE = \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:connection_limit</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> CONNECTION LIMIT = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CREATE DATABASE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_option_string'>option_string</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create_schema-instance_method">
  <h3 class='signature'>
  #<strong>create_schema</strong>(schema_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a schema for the given schema name.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L253'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


253
254
255</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 253</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_schema'>create_schema</span> <span class='id identifier rubyid_schema_name'>schema_name</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CREATE SCHEMA </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_schema_name'>schema_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="ctype-instance_method">
  <h3 class='signature'>
  #<strong>ctype</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current database ctype.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L235'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


235
236
237
238
239</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 235</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ctype'>ctype</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='tstring_content'>    SELECT pg_database.datctype FROM pg_database WHERE pg_database.datname LIKE &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_database'>current_database</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
</span><span class='heredoc_end'>  end_sql
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="current_database-instance_method">
  <h3 class='signature'>
  #<strong>current_database</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current database name.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L210'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


210
211
212</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 210</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_database'>current_database</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>select current_database()</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="current_schema-instance_method">
  <h3 class='signature'>
  #<strong>current_schema</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current schema name.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L215'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


215
216
217</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 215</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_schema'>current_schema</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SELECT current_schema</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="data_source_exists?-instance_method">
  <h3 class='signature'>
  #<strong>data_source_exists?</strong>(name)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#table_exists%3F-instance_method" title="ActiveRecord::ConnectionAdapters::PostgreSQL::SchemaStatements#table_exists? (method)">#table_exists?</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="data_sources-instance_method">
  <h3 class='signature'>
  #<strong>data_sources</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>:nodoc</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L98'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


98
99
100
101
102
103
104
105
106</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data_sources'>data_sources</span> <span class='comment'># :nodoc
</span>  <span class='id identifier rubyid_select_values'>select_values</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='tstring_content'>    SELECT c.relname
    FROM pg_class c
    LEFT JOIN pg_namespace n ON n.oid = c.relnamespace
    WHERE c.relkind IN (&#39;r&#39;, &#39;v&#39;,&#39;m&#39;) -- (r)elation/table, (v)iew, (m)aterialized view
    AND n.nspname = ANY (current_schemas(false))
</span><span class='heredoc_end'>  SQL
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="default_sequence_name-instance_method">
  <h3 class='signature'>
  #<strong>default_sequence_name</strong>(table_name, pk = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the sequence name for a table&#39;s primary key or some other
specified key.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L290'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


290
291
292
293
294
295
296</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 290</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default_sequence_name'>default_sequence_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_pk'>pk</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_serial_sequence'>serial_sequence</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_pk'>pk</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_result'>result</span>
  <span class='const'><a href="Utils.html" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Utils (module)">Utils</a></span><span class='period'>.</span><span class='id identifier rubyid_extract_schema_qualified_name'><a href="Utils.html#extract_schema_qualified_name-instance_method" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Utils#extract_schema_qualified_name (method)">extract_schema_qualified_name</a></span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>rescue</span> <span class='const'><a href="../../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="../../StatementInvalid.html" title="ActiveRecord::StatementInvalid (class)">StatementInvalid</a></span>
  <span class='const'><a href="../PostgreSQL.html" title="ActiveRecord::ConnectionAdapters::PostgreSQL (module)">PostgreSQL</a></span><span class='op'>::</span><span class='const'><a href="Name.html" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Name (class)">Name</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Name.html#new-class_method" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Name.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table_name'>table_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pk'>pk</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>_seq</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'><a href="Name.html#to_s-instance_method" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Name#to_s (method)">to_s</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="drop_database-instance_method">
  <h3 class='signature'>
  #<strong>drop_database</strong>(name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Drops a PostgreSQL database.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_drop_database'>drop_database</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>matt_development</span><span class='tstring_end'>&#39;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L85'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


85
86
87</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 85</span>

<span class='kw'>def</span> <span class='id identifier rubyid_drop_database'>drop_database</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP DATABASE IF EXISTS </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="drop_schema-instance_method">
  <h3 class='signature'>
  #<strong>drop_schema</strong>(schema_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Drops the schema for the given schema name.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L258'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


258
259
260</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 258</span>

<span class='kw'>def</span> <span class='id identifier rubyid_drop_schema'>drop_schema</span> <span class='id identifier rubyid_schema_name'>schema_name</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP SCHEMA </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_schema_name'>schema_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> CASCADE</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="drop_table-instance_method">
  <h3 class='signature'>
  #<strong>drop_table</strong>(table_name, options = {})  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L126'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


126
127
128</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_drop_table'>drop_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> CASCADE</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:force</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:cascade</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="encoding-instance_method">
  <h3 class='signature'>
  #<strong>encoding</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current database encoding format.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L220'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


220
221
222
223
224
225</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 220</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encoding'>encoding</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='tstring_content'>    SELECT pg_encoding_to_char(pg_database.encoding) FROM pg_database
    WHERE pg_database.datname LIKE &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_database'>current_database</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
</span><span class='heredoc_end'>  end_sql
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="foreign_keys-instance_method">
  <h3 class='signature'>
  #<strong>foreign_keys</strong>(table_name)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L501'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 501</span>

<span class='kw'>def</span> <span class='id identifier rubyid_foreign_keys'>foreign_keys</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fk_info'>fk_info</span> <span class='op'>=</span> <span class='id identifier rubyid_select_all'>select_all</span> <span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='period'>.</span><span class='id identifier rubyid_strip_heredoc'>strip_heredoc</span>
<span class='tstring_content'>    SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
    FROM pg_constraint c
    JOIN pg_class t1 ON c.conrelid = t1.oid
    JOIN pg_class t2 ON c.confrelid = t2.oid
    JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
    JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
    JOIN pg_namespace t3 ON c.connamespace = t3.oid
    WHERE c.contype = &#39;f&#39;
      AND t1.relname = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote'>quote</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>
      AND t3.nspname = ANY (current_schemas(false))
    ORDER BY c.conname
</span><span class='heredoc_end'>  SQL
</span>
  <span class='id identifier rubyid_fk_info'>fk_info</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>column:</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>column</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>name:</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>primary_key:</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>primary_key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:on_delete</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_foreign_key_action'>extract_foreign_key_action</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_delete</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:on_update</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_foreign_key_action'>extract_foreign_key_action</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_update</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='const'><a href="../ForeignKeyDefinition.html" title="ActiveRecord::ConnectionAdapters::ForeignKeyDefinition (class)">ForeignKeyDefinition</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>to_table</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="index_name_exists?-instance_method">
  <h3 class='signature'>
  #<strong>index_name_exists?</strong>(table_name, index_name, default)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L139'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


139
140
141
142
143
144
145
146
147
148
149
150</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index_name_exists?'>index_name_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_index_name'>index_name</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_exec_query'>exec_query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rows'>rows</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>&gt;</span> <span class='int'>0</span>
<span class='tstring_content'>    SELECT COUNT(*)
    FROM pg_class t
    INNER JOIN pg_index d ON t.oid = d.indrelid
    INNER JOIN pg_class i ON d.indexrelid = i.oid
    WHERE i.relkind = &#39;i&#39;
      AND i.relname = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_index_name'>index_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
      AND t.relname = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table_name'>table_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
      AND i.relnamespace IN (SELECT oid FROM pg_namespace WHERE nspname = ANY (current_schemas(false)) )
</span><span class='heredoc_end'>  SQL
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="index_name_length-instance_method">
  <h3 class='signature'>
  #<strong>index_name_length</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L538'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


538
539
540</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 538</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index_name_length'>index_name_length</span>
  <span class='int'>63</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="indexes-instance_method">
  <h3 class='signature'>
  #<strong>indexes</strong>(table_name, name = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an array of indexes for the given table.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L153'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 153</span>

<span class='kw'>def</span> <span class='id identifier rubyid_indexes'>indexes</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
   <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='tstring_content'>     SELECT distinct i.relname, d.indisunique, d.indkey, pg_get_indexdef(d.indexrelid), t.oid
     FROM pg_class t
     INNER JOIN pg_index d ON t.oid = d.indrelid
     INNER JOIN pg_class i ON d.indexrelid = i.oid
     WHERE i.relkind = &#39;i&#39;
       AND d.indisprimary = &#39;f&#39;
       AND t.relname = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table_name'>table_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
       AND i.relnamespace IN (SELECT oid FROM pg_namespace WHERE nspname = ANY (current_schemas(false)) )
    ORDER BY i.relname
</span><span class='heredoc_end'>  SQL
</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_index_name'>index_name</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_unique'>unique</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_indkey'>indkey</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_inddef'>inddef</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_oid'>oid</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_columns'>columns</span> <span class='op'>=</span> <span class='const'><a href="../../../Hash.html" title="Hash (class)">Hash</a></span><span class='lbracket'>[</span><span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbracket'>]</span>
<span class='tstring_content'>    SELECT a.attnum, a.attname
    FROM pg_attribute a
    WHERE a.attrelid = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_oid'>oid</span><span class='embexpr_end'>}</span><span class='tstring_content'>
    AND a.attnum IN (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_indkey'>indkey</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)
</span><span class='heredoc_end'>    SQL
</span>
    <span class='id identifier rubyid_column_names'>column_names</span> <span class='op'>=</span> <span class='id identifier rubyid_columns'>columns</span><span class='period'>.</span><span class='id identifier rubyid_values_at'>values_at</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_indkey'>indkey</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_column_names'>column_names</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='comment'># add info on sort order for columns (only desc order is explicitly specified, asc is the default)
</span>      <span class='id identifier rubyid_desc_order_columns'>desc_order_columns</span> <span class='op'>=</span> <span class='id identifier rubyid_inddef'>inddef</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\w+) DESC</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
      <span class='id identifier rubyid_orders'>orders</span> <span class='op'>=</span> <span class='id identifier rubyid_desc_order_columns'>desc_order_columns</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>?</span> <span class='const'><a href="../../../Hash.html" title="Hash (class)">Hash</a></span><span class='lbracket'>[</span><span class='id identifier rubyid_desc_order_columns'>desc_order_columns</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_order_column'>order_column</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_order_column'>order_column</span><span class='comma'>,</span> <span class='symbol'>:desc</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='id identifier rubyid_where'>where</span> <span class='op'>=</span> <span class='id identifier rubyid_inddef'>inddef</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>WHERE (.+)$</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_using'>using</span> <span class='op'>=</span> <span class='id identifier rubyid_inddef'>inddef</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>USING (.+?) </span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>

      <span class='const'><a href="../IndexDefinition.html" title="ActiveRecord::ConnectionAdapters::IndexDefinition (class)">IndexDefinition</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_index_name'>index_name</span><span class='comma'>,</span> <span class='id identifier rubyid_unique'>unique</span><span class='comma'>,</span> <span class='id identifier rubyid_column_names'>column_names</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_orders'>orders</span><span class='comma'>,</span> <span class='id identifier rubyid_where'>where</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_using'>using</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="pk_and_sequence_for-instance_method">
  <h3 class='signature'>
  #<strong>pk_and_sequence_for</strong>(table)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a table&#39;s primary key and belonging sequence.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L345'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 345</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='comment'># First try looking for a sequence with a dependency on the
</span>  <span class='comment'># given table&#39;s primary key.
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='tstring_content'>    SELECT attr.attname, nsp.nspname, seq.relname
    FROM pg_class      seq,
         pg_attribute  attr,
         pg_depend     dep,
         pg_constraint cons,
         pg_namespace  nsp
    WHERE seq.oid           = dep.objid
      AND seq.relkind       = &#39;S&#39;
      AND attr.attrelid     = dep.refobjid
      AND attr.attnum       = dep.refobjsubid
      AND attr.attrelid     = cons.conrelid
      AND attr.attnum       = cons.conkey[1]
      AND seq.relnamespace  = nsp.oid
      AND cons.contype      = &#39;p&#39;
      AND dep.classid       = &#39;pg_class&#39;::regclass
      AND dep.refobjid      = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;::regclass
</span><span class='heredoc_end'>  end_sql
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='tstring_content'>      SELECT attr.attname, nsp.nspname,
        CASE
          WHEN pg_get_expr(def.adbin, def.adrelid) !~* &#39;nextval&#39; THEN NULL
          WHEN split_part(pg_get_expr(def.adbin, def.adrelid), &#39;&#39;&#39;&#39;, 2) ~ &#39;.&#39; THEN
            substr(split_part(pg_get_expr(def.adbin, def.adrelid), &#39;&#39;&#39;&#39;, 2),
                   strpos(split_part(pg_get_expr(def.adbin, def.adrelid), &#39;&#39;&#39;&#39;, 2), &#39;.&#39;)+1)
          ELSE split_part(pg_get_expr(def.adbin, def.adrelid), &#39;&#39;&#39;&#39;, 2)
        END
      FROM pg_class       t
      JOIN pg_attribute   attr ON (t.oid = attrelid)
      JOIN pg_attrdef     def  ON (adrelid = attrelid AND adnum = attnum)
      JOIN pg_constraint  cons ON (conrelid = adrelid AND adnum = conkey[1])
      JOIN pg_namespace   nsp  ON (t.relnamespace = nsp.oid)
      WHERE t.oid = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;::regclass
        AND cons.contype = &#39;p&#39;
        AND pg_get_expr(def.adbin, def.adrelid) ~* &#39;nextval|uuid_generate&#39;
</span><span class='heredoc_end'>    end_sql
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_pk'>pk</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_pk'>pk</span><span class='comma'>,</span> <span class='const'><a href="../PostgreSQL.html" title="ActiveRecord::ConnectionAdapters::PostgreSQL (module)">PostgreSQL</a></span><span class='op'>::</span><span class='const'><a href="Name.html" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Name (class)">Name</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Name.html#new-class_method" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Name.new (method)">new</a></span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_pk'>pk</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="primary_key-instance_method">
  <h3 class='signature'>
  #<strong>primary_key</strong>(table)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns just a table&#39;s primary key</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L399'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


399
400
401
402
403
404
405
406
407
408
409</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 399</span>

<span class='kw'>def</span> <span class='id identifier rubyid_primary_key'>primary_key</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pks'>pks</span> <span class='op'>=</span> <span class='id identifier rubyid_exec_query'>exec_query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rows'>rows</span>
<span class='tstring_content'>    SELECT attr.attname
    FROM pg_attribute attr
    INNER JOIN pg_constraint cons ON attr.attrelid = cons.conrelid AND attr.attnum = any(cons.conkey)
    WHERE cons.contype = &#39;p&#39;
      AND cons.conrelid = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;::regclass
</span><span class='heredoc_end'>  end_sql
</span>  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_pks'>pks</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='id identifier rubyid_pks'>pks</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="recreate_database-instance_method">
  <h3 class='signature'>
  #<strong>recreate_database</strong>(name, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Drops the database specified on the <code>name</code> attribute and creates
it again using the provided <code>options</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L41'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


41
42
43
44</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 41</span>

<span class='kw'>def</span> <span class='id identifier rubyid_recreate_database'>recreate_database</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_drop_database'>drop_database</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_create_database'>create_database</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rename_column-instance_method">
  <h3 class='signature'>
  #<strong>rename_column</strong>(table_name, column_name, new_column_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Renames a column in a table.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L480'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


480
481
482
483
484</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 480</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rename_column'>rename_column</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_column_name'>new_column_name</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_clear_cache!'>clear_cache!</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> RENAME COLUMN </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_column_name'>column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> TO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_new_column_name'>new_column_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_rename_column_indexes'>rename_column_indexes</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_column_name'>column_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_column_name'>new_column_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rename_index-instance_method">
  <h3 class='signature'>
  #<strong>rename_index</strong>(table_name, old_name, new_name)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L495'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


495
496
497
498
499</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 495</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rename_index'>rename_index</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_validate_index_length!'>validate_index_length!</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER INDEX </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> RENAME TO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rename_table-instance_method">
  <h3 class='signature'>
  #<strong>rename_table</strong>(table_name, new_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Renames a table. Also renames a table&#39;s primary key sequence if the
sequence name exists and matches the Active Record default.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rename_table'>rename_table</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>octopuses</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>octopi</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L417'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


417
418
419
420
421
422
423
424
425
426
427
428
429
430</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 417</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rename_table'>rename_table</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_clear_cache!'>clear_cache!</span>
  <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> RENAME TO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_pk'>pk</span><span class='comma'>,</span> <span class='id identifier rubyid_seq'>seq</span> <span class='op'>=</span> <span class='id identifier rubyid_pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_seq'>seq</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_seq'>seq</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table_name'>table_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pk'>pk</span><span class='embexpr_end'>}</span><span class='tstring_content'>_seq</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_new_seq'>new_seq</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_name'>new_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pk'>pk</span><span class='embexpr_end'>}</span><span class='tstring_content'>_seq</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table_name'>table_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_pkey</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_new_idx'>new_idx</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_name'>new_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_pkey</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_seq'>seq</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> RENAME TO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_new_seq'>new_seq</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER INDEX </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_idx'>idx</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> RENAME TO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_new_idx'>new_idx</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_rename_table_indexes'>rename_table_indexes</span><span class='lparen'>(</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="reset_pk_sequence!-instance_method">
  <h3 class='signature'>
  #<strong>reset_pk_sequence!</strong>(table, pk = nil, sequence = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Resets the sequence of a table&#39;s primary key to the maximum value.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L323'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 323</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_pk_sequence!'>reset_pk_sequence!</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='comma'>,</span> <span class='id identifier rubyid_pk'>pk</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_sequence'>sequence</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_pk'>pk</span> <span class='kw'>and</span> <span class='id identifier rubyid_sequence'>sequence</span>
    <span class='id identifier rubyid_default_pk'>default_pk</span><span class='comma'>,</span> <span class='id identifier rubyid_default_sequence'>default_sequence</span> <span class='op'>=</span> <span class='id identifier rubyid_pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_pk'>pk</span> <span class='op'>||=</span> <span class='id identifier rubyid_default_pk'>default_pk</span>
    <span class='id identifier rubyid_sequence'>sequence</span> <span class='op'>||=</span> <span class='id identifier rubyid_default_sequence'>default_sequence</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@logger</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_pk'>pk</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_sequence'>sequence</span>
    <span class='ivar'>@logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table'>table</span><span class='embexpr_end'>}</span><span class='tstring_content'> has primary key </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pk'>pk</span><span class='embexpr_end'>}</span><span class='tstring_content'> with no default sequence</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_pk'>pk</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sequence'>sequence</span>
    <span class='id identifier rubyid_quoted_sequence'>quoted_sequence</span> <span class='op'>=</span> <span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_sequence'>sequence</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_select_value'>select_value</span> <span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring_content'>      SELECT setval(&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quoted_sequence'>quoted_sequence</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, (SELECT COALESCE(MAX(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_column_name'>quote_column_name</span> <span class='id identifier rubyid_pk'>pk</span><span class='embexpr_end'>}</span><span class='tstring_content'>)+(SELECT increment_by FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quoted_sequence'>quoted_sequence</span><span class='embexpr_end'>}</span><span class='tstring_content'>), (SELECT min_value FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quoted_sequence'>quoted_sequence</span><span class='embexpr_end'>}</span><span class='tstring_content'>)) FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>), false)
</span><span class='heredoc_end'>    end_sql
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="schema_exists?-instance_method">
  <h3 class='signature'>
  #<strong>schema_exists?</strong>(name)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if schema exists.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L131'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


131
132
133
134
135
136
137</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 131</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schema_exists?'>schema_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_exec_query'>exec_query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rows'>rows</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>&gt;</span> <span class='int'>0</span>
<span class='tstring_content'>    SELECT COUNT(*)
    FROM pg_namespace
    WHERE nspname = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
</span><span class='heredoc_end'>  SQL
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="schema_names-instance_method">
  <h3 class='signature'>
  #<strong>schema_names</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an array of schema names.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L242'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


242
243
244
245
246
247
248
249
250</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 242</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schema_names'>schema_names</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
<span class='tstring_content'>    SELECT nspname
      FROM pg_namespace
     WHERE nspname !~ &#39;^pg_.*&#39;
       AND nspname NOT IN (&#39;information_schema&#39;)
     ORDER by nspname;
</span><span class='heredoc_end'>  SQL
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="schema_search_path-instance_method">
  <h3 class='signature'>
  #<strong>schema_search_path</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the active schema search path.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L275'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


275
276
277</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 275</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schema_search_path'>schema_search_path</span>
  <span class='ivar'>@schema_search_path</span> <span class='op'>||=</span> <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHOW search_path</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="schema_search_path=-instance_method">
  <h3 class='signature'>
  #<strong>schema_search_path=</strong>(schema_csv)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets the schema search path to a string of comma-separated schema names.
Names beginning with $ have to be quoted (e.g. $user =&gt;
&#39;$user&#39;). See: <a
href="http://www.postgresql.org/docs/current/static/ddl-schemas.html">www.postgresql.org/docs/current/static/ddl-schemas.html</a></p>

<p>This should be not be called manually but set in database.yml.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L267'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


267
268
269
270
271
272</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 267</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schema_search_path='>schema_search_path=</span><span class='lparen'>(</span><span class='id identifier rubyid_schema_csv'>schema_csv</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_schema_csv'>schema_csv</span>
    <span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SET search_path TO </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_schema_csv'>schema_csv</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='ivar'>@schema_search_path</span> <span class='op'>=</span> <span class='id identifier rubyid_schema_csv'>schema_csv</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="serial_sequence-instance_method">
  <h3 class='signature'>
  #<strong>serial_sequence</strong>(table, column)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L298'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


298
299
300
301
302
303</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 298</span>

<span class='kw'>def</span> <span class='id identifier rubyid_serial_sequence'>serial_sequence</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='comma'>,</span> <span class='id identifier rubyid_column'>column</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_exec_query'>exec_query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-eosql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='tstring_content'>    SELECT pg_get_serial_sequence(&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table'>table</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_column'>column</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;)
</span><span class='heredoc_end'>  eosql
</span>  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_rows'>rows</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="set_pk_sequence!-instance_method">
  <h3 class='signature'>
  #<strong>set_pk_sequence!</strong>(table, value)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets the sequence of a table&#39;s primary key to the specified value.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L306'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


306
307
308
309
310
311
312
313
314
315
316
317
318
319
320</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 306</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_pk_sequence!'>set_pk_sequence!</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_pk'>pk</span><span class='comma'>,</span> <span class='id identifier rubyid_sequence'>sequence</span> <span class='op'>=</span> <span class='id identifier rubyid_pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_pk'>pk</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_sequence'>sequence</span>
      <span class='id identifier rubyid_quoted_sequence'>quoted_sequence</span> <span class='op'>=</span> <span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_sequence'>sequence</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_select_value'>select_value</span> <span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring_content'>      SELECT setval(&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quoted_sequence'>quoted_sequence</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>)
</span><span class='heredoc_end'>      end_sql
</span>    <span class='kw'>else</span>
      <span class='ivar'>@logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table'>table</span><span class='embexpr_end'>}</span><span class='tstring_content'> has primary key </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pk'>pk</span><span class='embexpr_end'>}</span><span class='tstring_content'> with no default sequence</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@logger</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="table_exists?-instance_method">
  <h3 class='signature'>
  #<strong>table_exists?</strong>(name)  &#x21d2; <tt>Boolean</tt> 
  <span class='aliases'>Also known as: <span class='names'><span>data_source_exists?</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if table exists. If the schema is not specified as part of
<code>name</code> then it will only find tables within the current schema
search path (regardless of permissions to access tables in other schemas)</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L111'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


111
112
113
114
115
116
117
118
119
120
121
122
123</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 111</span>

<span class='kw'>def</span> <span class='id identifier rubyid_table_exists?'>table_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='const'><a href="Utils.html" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Utils (module)">Utils</a></span><span class='period'>.</span><span class='id identifier rubyid_extract_schema_qualified_name'><a href="Utils.html#extract_schema_qualified_name-instance_method" title="ActiveRecord::ConnectionAdapters::PostgreSQL::Utils#extract_schema_qualified_name (method)">extract_schema_qualified_name</a></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span>

  <span class='id identifier rubyid_exec_query'>exec_query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rows'>rows</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>&gt;</span> <span class='int'>0</span>
<span class='tstring_content'>      SELECT COUNT(*)
      FROM pg_class c
      LEFT JOIN pg_namespace n ON n.oid = c.relnamespace
      WHERE c.relkind IN (&#39;r&#39;,&#39;v&#39;,&#39;m&#39;) -- (r)elation/table, (v)iew, (m)aterialized view
      AND c.relname = &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;
      AND n.nspname = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_schema'>schema</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_schema'>schema</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ANY (current_schemas(false))</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>
</span><span class='heredoc_end'>  SQL
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="tables-instance_method">
  <h3 class='signature'>
  #<strong>tables</strong>(name = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the list of all tables in the schema search path.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L90'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


90
91
92
93
94
95
96</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 90</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tables'>tables</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SCHEMA</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='tstring_content'>    SELECT tablename
    FROM pg_tables
    WHERE schemaname = ANY (current_schemas(false))
</span><span class='heredoc_end'>  SQL
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="type_to_sql-instance_method">
  <h3 class='signature'>
  #<strong>type_to_sql</strong>(type, limit = nil, precision = nil, scale = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Maps logical Rails types to PostgreSQL-specific data types.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/4-2-stable/activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb#L543'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/connection_adapters/postgresql/schema_statements.rb', line 543</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type_to_sql'>type_to_sql</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_limit'>limit</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_precision'>precision</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_scale'>scale</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>binary</span><span class='tstring_end'>&#39;</span></span>
    <span class='comment'># PostgreSQL doesn&#39;t support limits on binary (bytea) columns.
</span>    <span class='comment'># The hard limit is 1Gb, because of a 32-bit size field, and TOAST.
</span>    <span class='kw'>case</span> <span class='id identifier rubyid_limit'>limit</span>
    <span class='kw'>when</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>0</span><span class='op'>..</span><span class='int'>0x3fffffff</span><span class='semicolon'>;</span> <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>else</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'><a href="../../ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No binary type has byte size </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_limit'>limit</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text</span><span class='tstring_end'>&#39;</span></span>
    <span class='comment'># PostgreSQL doesn&#39;t support limits on text columns.
</span>    <span class='comment'># The hard limit is 1Gb, according to section 8.3 in the manual.
</span>    <span class='kw'>case</span> <span class='id identifier rubyid_limit'>limit</span>
    <span class='kw'>when</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>0</span><span class='op'>..</span><span class='int'>0x3fffffff</span><span class='semicolon'>;</span> <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>else</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'><a href="../../ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The limit on text can be at most 1GB - 1byte.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>integer</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>integer</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_limit'>limit</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_limit'>limit</span>
      <span class='kw'>when</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>smallint</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>when</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>integer</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>when</span> <span class='int'>5</span><span class='op'>..</span><span class='int'>8</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bigint</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>else</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'><a href="../../ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No integer type has byte size </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_limit'>limit</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Use a numeric with scale 0 instead.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>datetime</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>return</span> <span class='kw'>super</span> <span class='kw'>unless</span> <span class='id identifier rubyid_precision'>precision</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_precision'>precision</span>
      <span class='kw'>when</span> <span class='int'>0</span><span class='op'>..</span><span class='int'>6</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timestamp(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_precision'>precision</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>else</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'><a href="../../ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No timestamp type has precision of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_precision'>precision</span><span class='embexpr_end'>}</span><span class='tstring_content'>. The allowed range of precision is from 0 to 6</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>