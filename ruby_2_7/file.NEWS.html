<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: NEWS &mdash; Ruby-2.7.8</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "NEWS",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Ruby-2.7.8</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: NEWS&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="file_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>

<h1 id="label-NEWS+for+Ruby+2.7.0">NEWS for Ruby 2.7.0</h1>

<p>This document is a list of user visible feature changes made between releases except for bug fixes.</p>

<p>Note that each entry is kept so brief that no reason behind or reference information is supplied with.  For a full list of changes with all sufficient information, see the ChangeLog file or Redmine (e.g. <code>https://bugs.ruby-lang.org/issues/$FEATURE_OR_BUG_NUMBER</code>).</p>

<h2 id="label-Changes+since+the+2.6.0+release">Changes since the 2.6.0 release</h2>

<h3 id="label-Language+changes">Language changes</h3>

<h4 id="label-Pattern+matching">Pattern matching</h4>
<ul><li>
<p>Pattern matching is introduced as an experimental feature. [Feature #14912]</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>case</span> [<span class='int'>0</span><span class='comma'>,</span> [<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>]]
<span class='kw'>in</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> [<span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_c'>c</span>]]
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_a'>a</span> <span class='comment'>#=&gt; 0
</span>  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span> <span class='comment'>#=&gt; 1
</span>  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_c'>c</span> <span class='comment'>#=&gt; [2, 3]
</span><span class='kw'>end</span>

<span class='kw'>case</span> {<span class='label'>a:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>1</span>}
<span class='kw'>in</span> {<span class='label'>a:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>x:</span> <span class='int'>1</span>}
  <span class='symbeg'>:</span><span class='id identifier rubyid_unreachable'>unreachable</span>
<span class='kw'>in</span> {<span class='label'>a:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='id identifier rubyid_var'>var</span>}
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_var'>var</span> <span class='comment'>#=&gt; 1
</span><span class='kw'>end</span>

<span class='kw'>case</span> <span class='op'>-</span><span class='int'>1</span>
<span class='kw'>in</span> <span class='int'>0</span> <span class='kw'>then</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unreachable'>unreachable</span>
<span class='kw'>in</span> <span class='int'>1</span> <span class='kw'>then</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unreachable'>unreachable</span>
<span class='kw'>end</span> <span class='comment'>#=&gt; NoMatchingPatternError
</span>
<span class='id identifier rubyid_json'>json</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;END</span>
<span class='tstring_content'>{
  &quot;name&quot;: &quot;Alice&quot;,
  &quot;age&quot;: 30,
  &quot;children&quot;: [{ &quot;name&quot;: &quot;Bob&quot;, &quot;age&quot;: 2 }]
}
</span><span class='heredoc_end'>END
</span>
<span class='const'>JSON</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='id identifier rubyid_json'>json</span><span class='comma'>,</span> <span class='label'>symbolize_names:</span> <span class='kw'>true</span>) <span class='kw'>in</span> {<span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alice</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>children:</span> [{<span class='label'>name:</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>age:</span> <span class='id identifier rubyid_age'>age</span>}]}

<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_name'>name</span> <span class='comment'>#=&gt; &quot;Bob&quot;
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_age'>age</span>  <span class='comment'>#=&gt; 2
</span>
<span class='const'>JSON</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='id identifier rubyid_json'>json</span><span class='comma'>,</span> <span class='label'>symbolize_names:</span> <span class='kw'>true</span>) <span class='kw'>in</span> {<span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alice</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>children:</span> [{<span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Charlie</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>age:</span> <span class='id identifier rubyid_age'>age</span>}]}
<span class='comment'>#=&gt; NoMatchingPatternError</span></code></pre>
</li><li>
<p>See the following slides for more details:</p>
<ul><li>
<p><a href="https://speakerdeck.com/k_tsj/pattern-matching-new-feature-in-ruby-2-dot-7">speakerdeck.com/k_tsj/pattern-matching-new-feature-in-ruby-2-dot-7</a></p>
</li><li>
<p>Note that the slides are slightly obsolete.</p>
</li></ul>
</li><li>
<p>The warning against pattern matching can be suppressed with <a href="#label-Warning+option">-W:no-experimental option</a>.</p>
</li></ul>

<h4 id="label-The+spec+of+keyword+arguments+is+changed+towards+3.0">The spec of keyword arguments is changed towards 3.0</h4>
<ul><li>
<p>Automatic conversion of keyword arguments and positional arguments is deprecated, and conversion will be removed in Ruby 3.  [Feature #14183]</p>
<ul><li>
<p>When a method call passes a Hash at the last argument, and when it passes no keywords, and when the called method accepts keywords, a warning is emitted.  To continue treating the hash as keywords, add a double splat operator to avoid the warning and ensure correct behavior in Ruby 3.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='label'>key:</span> <span class='int'>42</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='label'>key:</span> <span class='int'>42</span>})   <span class='comment'># warned
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span><span class='id identifier rubyid_kw'>kw</span>)<span class='semicolon'>;</span>    <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='label'>key:</span> <span class='int'>42</span>})   <span class='comment'># warned
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='label'>key:</span> <span class='int'>42</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span>{<span class='label'>key:</span> <span class='int'>42</span>}) <span class='comment'># OK
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span><span class='id identifier rubyid_kw'>kw</span>)<span class='semicolon'>;</span>    <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span>{<span class='label'>key:</span> <span class='int'>42</span>}) <span class='comment'># OK</span></code></pre>
</li><li>
<p>When a method call passes keywords to a method that accepts keywords, but it does not pass enough required positional arguments, the keywords are treated as a final required positional argument, and a warning is emitted.  Pass the argument as a hash instead of keywords to avoid the warning and ensure correct behavior in Ruby 3.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kw'>kw</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='label'>key:</span> <span class='int'>42</span>)      <span class='comment'># warned
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='label'>key:</span> <span class='int'>42</span>)   <span class='comment'># warned
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kw'>kw</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='label'>key:</span> <span class='int'>42</span>})    <span class='comment'># OK
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='label'>key:</span> <span class='int'>42</span>}) <span class='comment'># OK</span></code></pre>
</li><li>
<p>When a method accepts specific keywords but not a keyword splat, and a hash or keywords splat is passed to the method that includes both Symbol and non-Symbol keys, the hash will continue to be split, and a warning will be emitted.  You will need to update the calling code to pass separate hashes to ensure correct behavior in Ruby 3.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='op'>=</span>{}<span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>43</span><span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>)   <span class='comment'># warned
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='op'>=</span>{}<span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>43</span><span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>}) <span class='comment'># warned
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='op'>=</span>{}<span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>43</span>}<span class='comma'>,</span> <span class='label'>key:</span> <span class='int'>42</span>) <span class='comment'># OK</span></code></pre>
</li><li>
<p>If a method does not accept keywords, and is called with keywords, the keywords are still treated as a positional hash, with no warning. This behavior will continue to work in Ruby 3.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_opt'>opt</span><span class='op'>=</span>{})<span class='semicolon'>;</span>  <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>( <span class='label'>key:</span> <span class='int'>42</span> )   <span class='comment'># OK</span></code></pre>
</li></ul>
</li><li>
<p>Non-symbols are allowed as keyword argument keys if the method accepts arbitrary keywords. [Feature #14183]</p>
<ul><li>
<p>Non-Symbol keys in a keyword arguments hash were prohibited in 2.6.0, but are now allowed again.  [Bug #15658]</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span><span class='id identifier rubyid_kw'>kw</span>)<span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_kw'>kw</span><span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>str</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>1</span>) <span class='comment'>#=&gt; {&quot;str&quot;=&gt;1}</span></code></pre>
</li></ul>
</li><li>
<p><code>**nil</code> is allowed in method definitions to explicitly mark that the method accepts no keywords. Calling such a method with keywords will result in an ArgumentError. [Feature #14183]</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='op'>**</span><span class='kw'>nil</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='label'>key:</span> <span class='int'>1</span>)       <span class='comment'># ArgumentError
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='op'>**</span><span class='kw'>nil</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span>{<span class='label'>key:</span> <span class='int'>1</span>})   <span class='comment'># ArgumentError
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='op'>**</span><span class='kw'>nil</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>str</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>1</span>)   <span class='comment'># ArgumentError
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='op'>**</span><span class='kw'>nil</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='label'>key:</span> <span class='int'>1</span>})     <span class='comment'># OK
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='op'>**</span><span class='kw'>nil</span>)<span class='semicolon'>;</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>({<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>str</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>1</span>}) <span class='comment'># OK</span></code></pre>
</li><li>
<p>Passing an empty keyword splat to a method that does not accept keywords no longer passes an empty hash, unless the empty hash is necessary for a required parameter, in which case a warning will be emitted.  Remove the double splat to continue passing a positional hash.  [Feature #14183]</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> {}<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>*</span><span class='id identifier rubyid_a'>a</span>) <span class='id identifier rubyid_a'>a</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span><span class='id identifier rubyid_h'>h</span>) <span class='comment'># []
</span><span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> {}<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_a'>a</span>) <span class='id identifier rubyid_a'>a</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>**</span><span class='id identifier rubyid_h'>h</span>)  <span class='comment'># {} and warning
</span><span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> {}<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>*</span><span class='id identifier rubyid_a'>a</span>) <span class='id identifier rubyid_a'>a</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span>)   <span class='comment'># [{}]
</span><span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> {}<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_a'>a</span>) <span class='id identifier rubyid_a'>a</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='id identifier rubyid_h'>h</span>)    <span class='comment'># {}</span></code></pre>
</li><li>
<p>Above warnings can be suppressed also with <a href="#label-Warning+option">-W:no-deprecated option</a>.</p>
</li></ul>

<h4 id="label-Numbered+parameters">Numbered parameters</h4>
<ul><li>
<p>Numbered parameters as default block parameters are introduced.</p>
<dl class="rdoc-list label-list"><dt>Feature #4475
<dd><dl class="rdoc-list label-list"><dt>1, 2, 10].map { _1.to_s(16) }    #=&gt; [“1”, “2”, “a”
<dt>[1, 2], [3, 4]].map { _1 + _2 }  #=&gt; [3, 7
<dd></dd></dl>
</dd></dl>

<p>You can still define a local variable named <code>_1</code> and so on, and that is honored when present, but renders a warning.</p>

<pre class="code ruby"><code class="ruby">_1 = 0            #=&gt; warning: `_1&#39; is reserved for numbered parameter; consider another name
[1].each { p _1 } # prints 0 instead of 1</code></pre>
</li></ul>

<h4 id="label-proc-2Flambda+without+block+is+deprecated">proc/lambda without block is deprecated</h4>
<ul><li>
<p>Proc.new and Kernel#proc with no block in a method called with a block is warned now.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='id identifier rubyid_proc'>proc</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_foo'>foo</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello</span><span class='tstring_end'>&quot;</span></span> } <span class='comment'>#=&gt; warning: Capturing the given block using Kernel#proc is deprecated; use `&amp;block` instead</span></code></pre>

<p>This warning can be suppressed with <a href="#label-Warning+option">-W:no-deprecated option</a>.</p>
</li><li>
<p>Kernel#lambda with no block in a method called with a block raises an exception.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_bar'>bar</span>
  <span class='id identifier rubyid_lambda'>lambda</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_bar'>bar</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello</span><span class='tstring_end'>&quot;</span></span> } <span class='comment'>#=&gt; tried to create Proc object without a block (ArgumentError)</span></code></pre>
</li></ul>

<h4 id="label-Other+miscellaneous+changes">Other miscellaneous changes</h4>
<ul><li>
<p>A beginless range is experimentally introduced.  It might be useful in <code>case</code>, new call-sequence of the <code>Comparable#clamp</code>, constants and DSLs.  [Feature #14799]</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ary'>ary</span>[<span class='op'>..</span><span class='int'>3</span>]  <span class='comment'># identical to ary[0..3]
</span>
<span class='kw'>case</span> <span class='const'>RUBY_VERSION</span>
<span class='kw'>when</span> <span class='op'>...</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2.4</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>then</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EOL</span><span class='tstring_end'>&quot;</span></span>
<span class='comment'># ...
</span><span class='kw'>end</span>

<span class='id identifier rubyid_age'>age</span>.<span class='id identifier rubyid_clamp'>clamp</span>(<span class='op'>..</span><span class='int'>100</span>)

<span class='id identifier rubyid_where'>where</span>(<span class='label'>sales:</span> <span class='op'>..</span><span class='int'>100</span>)</code></pre>
</li><li>
<p>Setting <code>$;</code> to a non-nil value is warned now. [Feature #14240] Use of it in String#split is warned too. This warning can be suppressed with <a href="#label-Warning+option">-W:no-deprecated option</a>.</p>
</li><li>
<p>Setting <code>$,</code> to a non-nil value is warned now. [Feature #14240] Use of it in Array#join is warned too. This warning can be suppressed with <a href="#label-Warning+option">-W:no-deprecated option</a>.</p>
</li><li>
<p>Quoted here-document identifiers must end within the same line.</p>

<pre class="code ruby"><code class="ruby">&lt;&lt;&quot;EOS
&quot; # This had been warned since 2.4; Now it raises a SyntaxError
EOS</code></pre>
</li><li>
<p>The flip-flop syntax deprecation is reverted. [Feature #5400]</p>
</li><li>
<p>Comment lines can be placed between fluent dot now.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_foo'>foo</span>
  <span class='comment'># .bar
</span>  .<span class='id identifier rubyid_baz'>baz</span> <span class='comment'># =&gt; foo.baz</span></code></pre>
</li><li>
<p>Calling a private method with a literal <code>self</code> as the receiver is now allowed. [Feature #11297] [Feature #16123]</p>
</li><li>
<p>Modifier rescue now operates the same for multiple assignment as single assignment. [Bug #8279]</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_raise'>raise</span> <span class='kw'>rescue</span> [<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>]
<span class='comment'># Previously parsed as: (a, b = raise) rescue [1, 2]
</span><span class='comment'># Now parsed as:         a, b = (raise rescue [1, 2])</span></code></pre>
</li><li>
<p><code>yield</code> in singleton class syntax is warned and will be deprecated later. [Feature #15575].</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>class</span> <span class='op'>&lt;&lt;</span> <span class='const'>Object</span>.<span class='id identifier rubyid_new'>new</span>
    <span class='kw'>yield</span> <span class='comment'>#=&gt; warning: `yield&#39; in class syntax will not be supported from Ruby 3.0. [Feature #15575]
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_foo'>foo</span> { <span class='id identifier rubyid_p'>p</span> <span class='symbeg'>:</span><span class='id identifier rubyid_ok'>ok</span> }</code></pre>

<p>This warning can be suppressed with <a href="#label-Warning+option">-W:no-deprecated option</a>.</p>
</li><li>
<p>Argument forwarding by <code>(...)</code> is introduced. [Feature #16253]</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>(<span class='op'>...</span>)
  <span class='id identifier rubyid_bar'>bar</span>(<span class='op'>...</span>)
<span class='kw'>end</span></code></pre>

<p>All arguments to <code>foo</code> are forwarded to <code>bar</code>, including keyword and block arguments. Note that the parentheses are mandatory.  <code>bar ...</code> is parsed as an endless range.</p>
</li><li>
<p>Access and setting of <code>$SAFE</code> is now always warned. <code>$SAFE</code> will become a normal global variable in Ruby 3.0. [Feature #16131]</p>
</li><li>
<p><code>Object#{taint,untaint,trust,untrust}</code> and related functions in the C-API no longer have an effect (all objects are always considered untainted), and are now warned in verbose mode. This warning will be disabled even in non-verbose mode in Ruby 3.0, and the methods and C functions will be removed in Ruby 3.2. [Feature #16131]</p>
</li><li>
<p>Refinements take place at Object#method and Module#instance_method. [Feature #15373]</p>
</li></ul>

<h3 id="label-Command+line+options">Command line options</h3>

<h4 id="label-Warning+option">Warning option</h4>

<p>The <code>-W</code> option has been extended with a following <code>:</code>, to manage categorized warnings.  [Feature #16345] [Feature #16420]</p>
<ul><li>
<p>To suppress deprecation warnings:</p>

<pre class="code ruby"><code class="ruby">$ ruby -e &#39;$; = &quot;&quot;&#39;
-e:1: warning: `$;&#39; is deprecated

$ ruby -W:no-deprecated -e &#39;$; = //&#39;</code></pre>
</li><li>
<p>It works with the <code>RUBYOPT</code> environment variable:</p>

<pre class="code ruby"><code class="ruby">$ RUBYOPT=-W:no-deprecated ruby -e &#39;$; = //&#39;</code></pre>
</li><li>
<p>To suppress experimental feature warnings:</p>

<pre class="code ruby"><code class="ruby">$ ruby -e &#39;0 in a&#39;
-e:1: warning: Pattern matching is experimental, and the behavior may change in future versions of Ruby!

$ ruby -W:no-experimental -e &#39;0 in a&#39;</code></pre>
</li><li>
<p>To suppress both by using <code>RUBYOPT</code>, set space separated values:</p>

<pre class="code ruby"><code class="ruby">$ RUBYOPT=&#39;-W:no-deprecated -W:no-experimental&#39; ruby -e &#39;($; = &quot;&quot;) in a&#39;</code></pre>
</li></ul>

<p>See also Warning in <a href="#label-Core+classes+updates+-28outstanding+ones+only-29">Core classes updates</a>.</p>

<h3 id="label-Core+classes+updates+-28outstanding+ones+only-29">Core classes updates (outstanding ones only)</h3>
<dl class="rdoc-list note-list"><dt>Array
<dd><dl class="rdoc-list note-list"><dt>New methods
<dd><ul><li>
<p>Added Array#intersection. [Feature #16155]</p>
</li><li>
<p>Added Array#minmax, with a faster implementation than Enumerable#minmax. [Bug #15929]</p>
</li></ul>
</dd></dl>
</dd><dt>Comparable
<dd><dl class="rdoc-list note-list"><dt>Modified method
<dd><ul><li>
<p>Comparable#clamp now accepts a Range argument. [Feature #14784]</p>

<pre class="code ruby"><code class="ruby"><span class='op'>-</span><span class='int'>1</span>.<span class='id identifier rubyid_clamp'>clamp</span>(<span class='int'>0</span><span class='op'>..</span><span class='int'>2</span>) <span class='comment'>#=&gt; 0
</span> <span class='int'>1</span>.<span class='id identifier rubyid_clamp'>clamp</span>(<span class='int'>0</span><span class='op'>..</span><span class='int'>2</span>) <span class='comment'>#=&gt; 1
</span> <span class='int'>3</span>.<span class='id identifier rubyid_clamp'>clamp</span>(<span class='int'>0</span><span class='op'>..</span><span class='int'>2</span>) <span class='comment'>#=&gt; 2
</span><span class='comment'># With beginless and endless ranges:
</span><span class='op'>-</span><span class='int'>1</span>.<span class='id identifier rubyid_clamp'>clamp</span>(<span class='int'>0</span><span class='op'>..</span>)  <span class='comment'>#=&gt; 0
</span> <span class='int'>3</span>.<span class='id identifier rubyid_clamp'>clamp</span>(<span class='op'>..</span><span class='int'>2</span>)  <span class='comment'>#=&gt; 2</span></code></pre>
</li></ul>
</dd></dl>
</dd><dt>Complex
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added Complex#&lt;=&gt;. So <code>0 &lt;=&gt; 0i</code> will not raise NoMethodError. [Bug #15857]</p>
</li></ul>
</dd></dl>
</dd><dt>Dir
<dd><dl class="rdoc-list note-list"><dt>Modified methods
<dd><ul><li>
<p>Dir.glob and Dir.[] no longer allow NUL-separated glob pattern. Use Array instead.  [Feature #14643]</p>
</li></ul>
</dd></dl>
</dd><dt>Encoding
<dd><dl class="rdoc-list note-list"><dt>New encoding
<dd><ul><li>
<p>Added new encoding CESU-8. [Feature #15931]</p>
</li></ul>
</dd></dl>
</dd><dt>Enumerable
<dd><dl class="rdoc-list note-list"><dt>New methods
<dd><ul><li>
<p>Added Enumerable#filter_map.  [Feature #15323]</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_filter_map'>filter_map</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_odd?'>odd?</span> <span class='op'>?</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>:</span> <span class='kw'>nil</span> } <span class='comment'>#=&gt; [&quot;1&quot;, &quot;3&quot;]</span></code></pre>
</li><li>
<p>Added Enumerable#tally.  [Feature #11076]</p>

<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>B</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>B</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_tally'>tally</span> <span class='comment'>#=&gt; {&quot;A&quot;=&gt;2, &quot;B&quot;=&gt;2, &quot;C&quot;=&gt;1}</span></code></pre>
</li></ul>
</dd></dl>
</dd><dt>Enumerator
<dd><dl class="rdoc-list note-list"><dt>New methods
<dd><ul><li>
<p>Added Enumerator.produce to generate an Enumerator from any custom data transformation.  [Feature #14781]</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>date</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_dates'>dates</span> <span class='op'>=</span> <span class='const'>Enumerator</span>.<span class='id identifier rubyid_produce'>produce</span>(<span class='const'>Date</span>.<span class='id identifier rubyid_today'>today</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_succ'>succ</span>) <span class='comment'>#=&gt; infinite sequence of dates
</span><span class='id identifier rubyid_dates'>dates</span>.<span class='id identifier rubyid_detect'>detect</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_tuesday?'>tuesday?</span>) <span class='comment'>#=&gt; next Tuesday</span></code></pre>
</li><li>
<p>Added Enumerator::Lazy#eager that generates a non-lazy enumerator from a lazy enumerator.  [Feature #15901]</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>foo</span><span class='words_sep'> </span><span class='tstring_content'>bar</span><span class='words_sep'> </span><span class='tstring_content'>baz</span><span class='tstring_end'>)</span></span>
<span class='id identifier rubyid_e'>e</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_lazy'>lazy</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_upcase'>upcase</span> }.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span> }.<span class='id identifier rubyid_eager'>eager</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_class'>class</span>               <span class='comment'>#=&gt; Enumerator
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span> }  <span class='comment'>#=&gt; [&quot;FOO!?&quot;, &quot;BAR!?&quot;, &quot;BAZ!?&quot;]</span></code></pre>
</li><li>
<p>Added Enumerator::Yielder#to_proc so that a Yielder object can be directly passed to another method as a block argument.  [Feature #15618]</p>
</li></ul>
</dd></dl>
</dd><dt>Fiber
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added Fiber#raise that behaves like Fiber#resume but raises an exception on the resumed fiber.  [Feature #10344]</p>
</li></ul>
</dd></dl>
</dd><dt>File
<dd><dl class="rdoc-list note-list"><dt>Modified method
<dd><ul><li>
<p>File.extname now returns a dot string for names ending with a dot on non-Windows platforms.  [Bug #15267]</p>

<pre class="code ruby"><code class="ruby"><span class='const'>File</span>.<span class='id identifier rubyid_extname'>extname</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo.</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'>#=&gt; &quot;.&quot;</span></code></pre>
</li></ul>
</dd></dl>
</dd><dt>FrozenError
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added FrozenError#receiver to return the frozen object on which modification was attempted.  To set this object when raising FrozenError in Ruby code, FrozenError.new accepts a <code>:receiver</code> option.  [Feature #15751]</p>
</li></ul>
</dd></dl>
</dd><dt>GC
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added GC.compact method for compacting the heap. This function compacts live objects in the heap so that fewer pages may be used, and the heap may be more CoW (copy-on-write) friendly. [Feature #15626]</p>

<p>Details on the algorithm and caveats can be found here: <a href="https://bugs.ruby-lang.org/issues/15626">bugs.ruby-lang.org/issues/15626</a></p>
</li></ul>
</dd></dl>
</dd><dt>IO
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added IO#set_encoding_by_bom to check the BOM and set the external encoding.  [Bug #15210]</p>
</li></ul>
</dd></dl>
</dd><dt>Integer
<dd><dl class="rdoc-list note-list"><dt>Modified method
<dd><ul><li>
<p>Integer#[] now supports range operations.  [Feature #8842]</p>

<pre class="code ruby"><code class="ruby"><span class='int'>0b01001101</span>[<span class='int'>2</span><span class='comma'>,</span> <span class='int'>4</span>]  <span class='comment'>#=&gt; 0b0011
</span><span class='int'>0b01001100</span>[<span class='int'>2</span><span class='op'>..</span><span class='int'>5</span>]  <span class='comment'>#=&gt; 0b0011
</span><span class='int'>0b01001100</span>[<span class='int'>2</span><span class='op'>...</span><span class='int'>6</span>] <span class='comment'>#=&gt; 0b0011
</span><span class='comment'>#   ^^^^</span></code></pre>
</li></ul>
</dd></dl>
</dd><dt>Method
<dd><dl class="rdoc-list note-list"><dt>Modified method
<dd><ul><li>
<p>Method#inspect shows more information. [Feature #14145]</p>
</li></ul>
</dd></dl>
</dd><dt>Module
<dd><dl class="rdoc-list note-list"><dt>New methods
<dd><ul><li>
<p>Added Module#const_source_location to retrieve the location where a constant is defined.  [Feature #10771]</p>
</li><li>
<p>Added Module#ruby2_keywords for marking a method as passing keyword arguments through a regular argument splat, useful when delegating all arguments to another method in a way that can be backwards compatible with older Ruby versions.  [Bug #16154]</p>
</li></ul>
</dd><dt>Modified methods
<dd><ul><li>
<p>Module#autoload? now takes an <code>inherit</code> optional argument, like Module#const_defined?.  [Feature #15777]</p>
</li><li>
<p>Module#name now always returns a frozen String. The returned String is always the same for a given Module. This change is experimental. [Feature #16150]</p>
</li></ul>
</dd></dl>
</dd><dt>NilClass / TrueClass / FalseClass
<dd><dl class="rdoc-list note-list"><dt>Modified methods
<dd><ul><li>
<p>NilClass#to_s, TrueClass#to_s, and FalseClass#to_s now always return a frozen String. The returned String is always the same for each of these values. This change is experimental. [Feature #16150]</p>
</li></ul>
</dd></dl>
</dd><dt>ObjectSpace::WeakMap
<dd><dl class="rdoc-list note-list"><dt>Modified method
<dd><ul><li>
<p>ObjectSpace::WeakMap#[]= now accepts special objects as either key or values.  [Feature #16035]</p>
</li></ul>
</dd></dl>
</dd><dt>Proc
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added Proc#ruby2_keywords for marking the proc as passing keyword arguments through a regular argument splat, useful when delegating all arguments to another method or proc in a way that can be backwards compatible with older Ruby versions.  [Feature #16404]</p>
</li></ul>
</dd></dl>
</dd><dt>Range
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added Range#minmax, with a faster implementation than Enumerable#minmax. It returns a maximum that now corresponds to Range#max. [Bug #15807]</p>
</li></ul>
</dd><dt>Modified method
<dd><ul><li>
<p>Range#=== now uses Range#cover? for String arguments, too (in Ruby 2.6, it was changed from Range#include? for all types except strings). [Bug #15449]</p>
</li></ul>
</dd></dl>
</dd><dt>RubyVM
<dd><dl class="rdoc-list note-list"><dt>Removed method
<dd><ul><li>
<p><code>RubyVM.resolve_feature_path</code> moved to <code>$LOAD_PATH.resolve_feature_path</code>.  [Feature #15903] [Feature #15230]</p>
</li></ul>
</dd></dl>
</dd><dt>String
<dd><dl class="rdoc-list note-list"><dt>Unicode
<dd><ul><li>
<p>Update Unicode version and Emoji version from 11.0.0 to 12.0.0.  [Feature #15321]</p>
</li><li>
<p>Update Unicode version to 12.1.0, adding support for U+32FF SQUARE ERA NAME REIWA.  [Feature #15195]</p>
</li><li>
<p>Update Unicode Emoji version to 12.1. [Feature #16272]</p>
</li></ul>
</dd></dl>
</dd><dt>Symbol
<dd><dl class="rdoc-list note-list"><dt>New methods
<dd><ul><li>
<p>Added Symbol#start_with? and Symbol#end_with? methods.  [Feature #16348]</p>
</li></ul>
</dd></dl>
</dd><dt>Time
<dd><dl class="rdoc-list note-list"><dt>New methods
<dd><ul><li>
<p>Added Time#ceil method.  [Feature #15772]</p>
</li><li>
<p>Added Time#floor method.  [Feature #15653]</p>
</li></ul>
</dd><dt>Modified method
<dd><ul><li>
<p>Time#inspect is separated from Time#to_s and it shows the time’s sub second.  [Feature #15958]</p>
</li></ul>
</dd></dl>
</dd><dt>UnboundMethod
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added UnboundMethod#bind_call method.  [Feature #15955]</p>

<p><code>umethod.bind_call(obj, ...)</code> is semantically equivalent to <code>umethod.bind(obj).call(...)</code>.  This idiom is used in some libraries to call a method that is overridden.  The added method does the same without allocation of an intermediate Method object.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Foo</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_add_1'>add_1</span>(<span class='id identifier rubyid_x'>x</span>)
    <span class='id identifier rubyid_x'>x</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='kw'>class</span> <span class='const'>Bar</span> <span class='op'>&lt;</span> <span class='const'>Foo</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_add_1'>add_1</span>(<span class='id identifier rubyid_x'>x</span>) <span class='comment'># override
</span>    <span class='id identifier rubyid_x'>x</span> <span class='op'>+</span> <span class='int'>2</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='const'>Bar</span>.<span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_obj'>obj</span>.<span class='id identifier rubyid_add_1'>add_1</span>(<span class='int'>1</span>) <span class='comment'>#=&gt; 3
</span><span class='id identifier rubyid_p'>p</span> <span class='const'>Foo</span>.<span class='id identifier rubyid_instance_method'>instance_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_add_1'>add_1</span>).<span class='id identifier rubyid_bind'>bind</span>(<span class='id identifier rubyid_obj'>obj</span>).<span class='id identifier rubyid_call'>call</span>(<span class='int'>1</span>) <span class='comment'>#=&gt; 2
</span><span class='id identifier rubyid_p'>p</span> <span class='const'>Foo</span>.<span class='id identifier rubyid_instance_method'>instance_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_add_1'>add_1</span>).<span class='id identifier rubyid_bind_call'>bind_call</span>(<span class='id identifier rubyid_obj'>obj</span><span class='comma'>,</span> <span class='int'>1</span>) <span class='comment'>#=&gt; 2</span></code></pre>
</li></ul>
</dd></dl>
</dd><dt>Warning
<dd><dl class="rdoc-list note-list"><dt>New methods
<dd><ul><li>
<p>Added Warning.[] and Warning.[]= to manage emitting/suppressing some categories of warnings.  [Feature #16345] [Feature #16420]</p>
</li></ul>
</dd></dl>
</dd><dt>$LOAD_PATH
<dd><dl class="rdoc-list note-list"><dt>New method
<dd><ul><li>
<p>Added <code>$LOAD_PATH.resolve_feature_path</code>.  [Feature #15903] [Feature #15230]</p>
</li></ul>
</dd></dl>
</dd></dl>

<h3 id="label-Stdlib+updates+-28outstanding+ones+only-29">Stdlib updates (outstanding ones only)</h3>
<dl class="rdoc-list note-list"><dt>Bundler
<dd><ul><li>
<p>Upgrade to Bundler 2.1.2. See <a href="https://github.com/bundler/bundler/releases/tag/v2.1.2">github.com/bundler/bundler/releases/tag/v2.1.2</a></p>
</li></ul>
</dd><dt>CGI
<dd><ul><li>
<p>CGI.escapeHTML becomes 2~5x faster when there is at least one escaped character. See <a href="https://github.com/ruby/ruby/pull/2226">github.com/ruby/ruby/pull/2226</a></p>
</li></ul>
</dd><dt>CSV
<dd><ul><li>
<p>Upgrade to 3.1.2. See <a href="https://github.com/ruby/csv/blob/master/NEWS.md">github.com/ruby/csv/blob/master/NEWS.md</a>.</p>
</li></ul>
</dd><dt>Date
<dd><ul><li>
<p>Date.jisx0301, Date#jisx0301, and Date.parse support the new Japanese era.  [Feature #15742]</p>
</li></ul>
</dd><dt>Delegator
<dd><ul><li>
<p>Object#DelegateClass accepts a block and module_evals it in the context of the returned class, similar to Class.new and Struct.new.</p>
</li></ul>
</dd><dt>ERB
<dd><ul><li>
<p>Prohibit marshaling ERB instance.</p>
</li></ul>
</dd><dt>IRB
<dd><ul><li>
<p>Introduce syntax highlighting inspired by the Pry gem to Binding#irb source lines, REPL input, and inspect output of some core-class objects.</p>
</li><li>
<p>Introduce multiline editing mode provided by Reline.</p>
</li><li>
<p>Show documentation when completion.</p>
</li><li>
<p>Enable auto indent and save/load history by default.</p>
</li></ul>
</dd><dt>JSON
<dd><ul><li>
<p>Upgrade to 2.3.0.</p>
</li></ul>
</dd><dt>Net::FTP
<dd><ul><li>
<p>Add Net::FTP#features to check available features, and Net::FTP#option to enable/disable each of them.  [Feature #15964]</p>
</li></ul>
</dd><dt>Net::HTTP
<dd><ul><li>
<p>Add <code>ipaddr</code> optional parameter to Net::HTTP#start to replace the address for the TCP/IP connection. [Feature #5180]</p>
</li></ul>
</dd><dt>Net::IMAP
<dd><ul><li>
<p>Add Server Name Indication (SNI) support.  [Feature #15594]</p>
</li></ul>
</dd><dt>open-uri
<dd><ul><li>
<p>Warn open-uri’s “open” method at Kernel. Use URI.open instead.  [Misc #15893]</p>
</li><li>
<p>The default charset of “text/*” media type is UTF-8 instead of ISO-8859-1.  [Bug #15933]</p>
</li></ul>
</dd><dt>OptionParser
<dd><ul><li>
<p>Now show “Did you mean?” for unknown options.  [Feature #16256]</p>

<p>test.rb:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>optparse</span><span class='tstring_end'>&quot;</span></span>
<span class='const'>OptionParser</span>.<span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_opts'>opts</span><span class='op'>|</span>
  <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_on'>on</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-f</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>) {<span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> }
  <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_on'>on</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--bar</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span>) {<span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> }
  <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_on'>on</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-c</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--baz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span>) {<span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> }
<span class='kw'>end</span>.<span class='id identifier rubyid_parse!'>parse!</span></code></pre>

<p>example:</p>

<pre class="code ruby"><code class="ruby">$ ruby test.rb --baa
Traceback (most recent call last):
test.rb:7:in `&lt;main&gt;&#39;: invalid option: --baa (OptionParser::InvalidOption)
Did you mean?  baz
               bar</code></pre>
</li></ul>
</dd><dt>Pathname
<dd><ul><li>
<p>Pathname.glob now delegates 3 arguments to Dir.glob to accept <code>base</code> keyword. [Feature #14405]</p>
</li></ul>
</dd><dt>Racc
<dd><ul><li>
<p>Merge 1.4.15 from upstream repository and added cli of racc.</p>
</li></ul>
</dd><dt>Reline
<dd><ul><li>
<p>New stdlib that is compatible with the readline stdlib but is implemented in pure Ruby. It also provides a multiline editing mode.</p>
</li></ul>
</dd><dt>REXML
<dd><ul><li>
<p>Upgrade to 3.2.3. See <a href="https://github.com/ruby/rexml/blob/master/NEWS.md">github.com/ruby/rexml/blob/master/NEWS.md</a>.</p>
</li></ul>
</dd><dt>RSS
<dd><ul><li>
<p>Upgrade to RSS 0.2.8. See <a href="https://github.com/ruby/rss/blob/master/NEWS.md">github.com/ruby/rss/blob/master/NEWS.md</a>.</p>
</li></ul>
</dd><dt>RubyGems
<dd><ul><li>
<p>Upgrade to RubyGems 3.1.2.</p>
<ul><li>
<p><a href="https://github.com/rubygems/rubygems/releases/tag/v3.1.0">github.com/rubygems/rubygems/releases/tag/v3.1.0</a></p>
</li><li>
<p><a href="https://github.com/rubygems/rubygems/releases/tag/v3.1.1">github.com/rubygems/rubygems/releases/tag/v3.1.1</a></p>
</li><li>
<p><a href="https://github.com/rubygems/rubygems/releases/tag/v3.1.2">github.com/rubygems/rubygems/releases/tag/v3.1.2</a></p>
</li></ul>
</li></ul>
</dd><dt>StringScanner
<dd><ul><li>
<p>Upgrade to 1.0.3. See <a href="https://github.com/ruby/strscan/blob/master/NEWS.md">github.com/ruby/strscan/blob/master/NEWS.md</a>.</p>
</li></ul>
</dd></dl>

<h3 id="label-Compatibility+issues+-28excluding+feature+bug+fixes-29">Compatibility issues (excluding feature bug fixes)</h3>
<ul><li>
<p>The following libraries are no longer bundled gems. Install corresponding gems to use these features.</p>
<ul><li>
<p>CMath (cmath gem)</p>
</li><li>
<p>Scanf (scanf gem)</p>
</li><li>
<p>Shell (shell gem)</p>
</li><li>
<p>Synchronizer (sync gem)</p>
</li><li>
<p>ThreadsWait (thwait gem)</p>
</li><li>
<p>E2MM (e2mmap gem)</p>
</li></ul>
</li></ul>
<dl class="rdoc-list note-list"><dt>Proc
<dd><ul><li>
<p>The Proc#to_s format was changed. [Feature #16101]</p>
</li></ul>
</dd><dt>Range
<dd><ul><li>
<p>Range#minmax used to iterate on the range to determine the maximum. It now uses the same algorithm as Range#max. In rare cases (e.g. ranges of Floats or Strings), this may yield different results. [Bug #15807]</p>
</li></ul>
</dd></dl>

<h3 id="label-Stdlib+compatibility+issues+-28excluding+feature+bug+fixes-29">Stdlib compatibility issues (excluding feature bug fixes)</h3>
<ul><li>
<p>Promote stdlib to default gems</p>
<ul><li>
<p>The following default gems were published on rubygems.org</p>
<ul><li>
<p>benchmark</p>
</li><li>
<p>cgi</p>
</li><li>
<p>delegate</p>
</li><li>
<p>getoptlong</p>
</li><li>
<p>net-pop</p>
</li><li>
<p>net-smtp</p>
</li><li>
<p>open3</p>
</li><li>
<p>pstore</p>
</li><li>
<p>readline</p>
</li><li>
<p>readline-ext</p>
</li><li>
<p>singleton</p>
</li></ul>
</li><li>
<p>The following default gems were only promoted at ruby-core, but not yet published on rubygems.org.</p>
<ul><li>
<p>monitor</p>
</li><li>
<p>observer</p>
</li><li>
<p>timeout</p>
</li><li>
<p>tracer</p>
</li><li>
<p>uri</p>
</li><li>
<p>yaml</p>
</li></ul>
</li></ul>
</li><li>
<p>The <code>did_you_mean</code> gem has been promoted up to a default gem from a bundled gem</p>
</li></ul>
<dl class="rdoc-list note-list"><dt>pathname
<dd><ul><li>
<p>Kernel#Pathname when called with a Pathname argument now returns the argument instead of creating a new Pathname. This is more similar to other Kernel methods, but can break code that modifies the return value and expects the argument not to be modified.</p>
</li></ul>
</dd><dt>profile.rb, Profiler__
<dd><ul><li>
<p>Removed from standard library. It was unmaintained since Ruby 2.0.0.</p>
</li></ul>
</dd></dl>

<h3 id="label-C+API+updates">C API updates</h3>
<ul><li>
<p>Many <code>*_kw</code> functions have been added for setting whether the final argument being passed should be treated as keywords. You may need to switch to these functions to avoid keyword argument separation warnings, and to ensure correct behavior in Ruby 3.</p>
</li><li>
<p>The <code>:</code> character in rb_scan_args format string is now treated as keyword arguments. Passing a positional hash instead of keyword arguments will emit a deprecation warning.</p>
</li><li>
<p>C API declarations with <code>ANYARGS</code> are changed not to use <code>ANYARGS</code>. See <a href="https://github.com/ruby/ruby/pull/2404">github.com/ruby/ruby/pull/2404</a></p>
</li></ul>

<h3 id="label-Implementation+improvements">Implementation improvements</h3>
<dl class="rdoc-list note-list"><dt>Fiber
<dd><ul><li>
<p>Allow selecting different coroutine implementations by using <code>--with-coroutine=</code>, e.g.</p>

<pre class="code ruby"><code class="ruby">$ ./configure --with-coroutine=ucontext
$ ./configure --with-coroutine=copy</code></pre>
</li><li>
<p>Replace previous stack cache with fiber pool cache. The fiber pool allocates many stacks in a single memory region. Stack allocation becomes O(log N) and fiber creation is amortized O(1). Around 10x performance improvement was measured in micro-benchmarks. <a href="https://github.com/ruby/ruby/pull/2224">github.com/ruby/ruby/pull/2224</a></p>
</li></ul>
</dd><dt>File
<dd><ul><li>
<p>File.realpath now uses realpath(3) on many platforms, which can significantly improve performance. [Feature #15797]</p>
</li></ul>
</dd><dt>Hash
<dd><ul><li>
<p>Change data structure of small Hash objects. [Feature #15602]</p>
</li></ul>
</dd><dt>Monitor
<dd><ul><li>
<p>Monitor class is written in C-extension. [Feature #16255]</p>
</li></ul>
</dd><dt>Thread
<dd><ul><li>
<p>VM stack memory allocation is now combined with native thread stack, improving thread allocation performance and reducing allocation related failures. Around 10x performance improvement was measured in micro-benchmarks.</p>
</li></ul>
</dd><dt>JIT
<dd><ul><li>
<p>JIT-ed code is recompiled to less-optimized code when an optimization assumption is invalidated.</p>
</li><li>
<p>Method inlining is performed when a method is considered as pure. This optimization is still experimental and many methods are NOT considered as pure yet.</p>
</li><li>
<p>The default value of <code>--jit-max-cache</code> is changed from 1,000 to 100.</p>
</li><li>
<p>The default value of <code>--jit-min-calls</code> is changed from 5 to 10,000.</p>
</li></ul>
</dd><dt>RubyVM
<dd><ul><li>
<p>Per-call-site method cache, which has been there since around 1.9, was improved: cache hit rate raised from 89% to 94%. See <a href="https://github.com/ruby/ruby/pull/2583">github.com/ruby/ruby/pull/2583</a></p>
</li></ul>
</dd><dt>RubyVM::InstructionSequence
<dd><ul><li>
<p>RubyVM::InstructionSequence#to_binary method generates compiled binary. The binary size is reduced. [Feature #16163]</p>
</li></ul>
</dd></dl>

<h3 id="label-Miscellaneous+changes">Miscellaneous changes</h3>
<ul><li>
<p>Support for IA64 architecture has been removed. Hardware for testing was difficult to find, native fiber code is difficult to implement, and it added non-trivial complexity to the interpreter. [Feature #15894]</p>
</li><li>
<p>Require compilers to support C99. [Misc #15347]</p>
<ul><li>
<p>Details of our dialect: <a href="https://bugs.ruby-lang.org/projects/ruby-trunk/wiki/C99">bugs.ruby-lang.org/projects/ruby-trunk/wiki/C99</a></p>
</li></ul>
</li><li>
<p>Ruby’s upstream repository is changed from Subversion to Git.</p>
<ul><li>
<p><a href="https://git.ruby-lang.org/ruby.git">git.ruby-lang.org/ruby.git</a></p>
</li><li>
<p>RUBY_REVISION class is changed from Integer to String.</p>
</li><li>
<p>RUBY_DESCRIPTION includes Git revision instead of Subversion’s one.</p>
</li></ul>
</li><li>
<p>Support built-in methods in Ruby with the <code><em>_builtin</em></code> syntax. [Feature #16254]</p>

<p>Some methods are defined in *.rb (such as trace_point.rb). For example, it is easy to define a method which accepts keyword arguments.</p>
</li></ul>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>