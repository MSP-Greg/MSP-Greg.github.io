<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Gem::Ext::Builder &mdash; rubygems  Ruby-2.7.8 pp225</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Gem::Ext::Builder",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../'>Ruby-2.7.8</a> &raquo; 
      <a href='../../'>rubygems</a> &raquo; 
      <a href='../../_index.html#alpha_B'>Index (B)</a> &raquo; 
        <a href="../../Gem.html" title="Gem (module)">Gem</a> &raquo; 
        <a href="../Ext.html" title="Gem::Ext (module)">Ext</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Builder&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Gem::Ext::Builder</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Subclasses:</div>
        <div class='box_22'>
          <a href="CmakeBuilder.html" title="Gem::Ext::CmakeBuilder (class)">CmakeBuilder</a>, <a href="ConfigureBuilder.html" title="Gem::Ext::ConfigureBuilder (class)">ConfigureBuilder</a>, <a href="ExtConfBuilder.html" title="Gem::Ext::ExtConfBuilder (class)">ExtConfBuilder</a>, <a href="RakeBuilder.html" title="Gem::Ext::RakeBuilder (class)">RakeBuilder</a>
        </div>
      </td>
    </tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="../UserInteraction.html" title="Gem::UserInteraction (module)"><code>::Gem::UserInteraction</code></a>,
          <a href="../DefaultUserInteraction.html" title="Gem::DefaultUserInteraction (module)"><code>::Gem::DefaultUserInteraction</code></a>,
          <a href="../Text.html" title="Gem::Text (module)"><code>::Gem::Text</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L10'>lib/rubygems/ext/builder.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='CHDIR_MUTEX-constant' class='summary_signature nodoc'>CHDIR_MUTEX =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The builder shells-out to run various commands after changing the directory.  This means multiple installations cannot be allowed to build extensions in parallel as they may change each other’s directories leading to broken extensions or failed installations.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L20-L20'># File 'lib/rubygems/ext/builder.rb', line 20</a>    <pre class='code ruby'><span class='const'>Mutex</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Gem::Ext::Builder.new (method)">new</a></span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#class_name-class_method" title=".class_name (class method)">.<strong>class_name</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#make-class_method" title=".make (class method)">.<strong>make</strong>(dest_path, results)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(spec, build_args = spec.build_args)  &#x21d2; Builder </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a new extension builder for <code>spec</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#run-class_method" title=".run (class method)">.<strong>run</strong>(command, results, command_name = nil) {|status, results| ... } </a>
    </span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#build_args-instance_method" title="#build_args (instance method)">#<strong>build_args</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited'><a href="../DefaultUserInteraction.html" title="Gem::DefaultUserInteraction (module)"><code>::Gem::DefaultUserInteraction</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../DefaultUserInteraction.html#ui-instance_method" title="Gem::DefaultUserInteraction#ui (method)">#ui</a></td>
      <td><div class='inline'><p>See <a href="../DefaultUserInteraction.html#ui-class_method" title="Gem::DefaultUserInteraction.ui (method)">DefaultUserInteraction.ui</a></p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../DefaultUserInteraction.html#ui=-instance_method" title="Gem::DefaultUserInteraction#ui= (method)">#ui=</a></td>
      <td><div class='inline'><p>See <a href="../DefaultUserInteraction.html#ui=-class_method" title="Gem::DefaultUserInteraction.ui= (method)">DefaultUserInteraction.ui=</a></p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#build_extensions-instance_method" title="#build_extensions (instance method)">#<strong>build_extensions</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Builds extensions.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#build_error-instance_method" title="#build_error (instance method)">#<strong>build_error</strong>(output, backtrace = nil)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Logs the build <code>output</code>, then raises <a href="BuildError.html" title="Gem::Ext::BuildError (class)"><code>BuildError</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#build_extension-instance_method" title="#build_extension (instance method)">#<strong>build_extension</strong>(extension, dest_path)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#builder_for-instance_method" title="#builder_for (instance method)">#<strong>builder_for</strong>(extension)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Chooses the extension builder class for <code>extension</code></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#write_gem_make_out-instance_method" title="#write_gem_make_out (instance method)">#<strong>write_gem_make_out</strong>(output)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Writes <code>output</code> to gem_make.out in the extension install directory.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="../UserInteraction.html" title="Gem::UserInteraction (module)"><code>::Gem::UserInteraction</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#alert-instance_method" title="Gem::UserInteraction#alert (method)">#alert</a></td>
      <td><div class='inline'><p>Displays an alert <code>statement</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#alert_error-instance_method" title="Gem::UserInteraction#alert_error (method)">#alert_error</a></td>
      <td><div class='inline'><p>Displays an error <code>statement</code> to the error output location.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#alert_warning-instance_method" title="Gem::UserInteraction#alert_warning (method)">#alert_warning</a></td>
      <td><div class='inline'><p>Displays a warning <code>statement</code> to the warning output location.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#ask-instance_method" title="Gem::UserInteraction#ask (method)">#ask</a></td>
      <td><div class='inline'><p>Asks a <code>question</code> and returns the answer.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#ask_for_password-instance_method" title="Gem::UserInteraction#ask_for_password (method)">#ask_for_password</a></td>
      <td><div class='inline'><p>Asks for a password with a <code>prompt</code></p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#ask_yes_no-instance_method" title="Gem::UserInteraction#ask_yes_no (method)">#ask_yes_no</a></td>
      <td><div class='inline'><p>Asks a yes or no <code>question</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#choose_from_list-instance_method" title="Gem::UserInteraction#choose_from_list (method)">#choose_from_list</a></td>
      <td><div class='inline'><p>Asks the user to answer <code>question</code> with an answer from the given <code>list</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#say-instance_method" title="Gem::UserInteraction#say (method)">#say</a></td>
      <td><div class='inline'><p>Displays the given <code>statement</code> on the standard output (or equivalent).</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#terminate_interaction-instance_method" title="Gem::UserInteraction#terminate_interaction (method)">#terminate_interaction</a></td>
      <td><div class='inline'><p>Terminates the RubyGems process with the given <code>exit_code</code></p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../UserInteraction.html#verbose-instance_method" title="Gem::UserInteraction#verbose (method)">#verbose</a></td>
      <td><div class='inline'><p>Calls <code>say</code> with <code>msg</code> or the results of the block if really_verbose is true.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../DefaultUserInteraction.html" title="Gem::DefaultUserInteraction (module)"><code>::Gem::DefaultUserInteraction</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../DefaultUserInteraction.html#use_ui-instance_method" title="Gem::DefaultUserInteraction#use_ui (method)">#use_ui</a></td>
      <td><div class='inline'><p>See <a href="../DefaultUserInteraction.html#use_ui-class_method" title="Gem::DefaultUserInteraction.use_ui (method)">DefaultUserInteraction.use_ui</a></p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../Text.html" title="Gem::Text (module)"><code>::Gem::Text</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Text.html#clean_text-instance_method" title="Gem::Text#clean_text (method)">#clean_text</a></td>
      <td><div class='inline'><p>Remove any non-printable characters and make the text suitable for printing.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Text.html#format_text-instance_method" title="Gem::Text#format_text (method)">#format_text</a></td>
      <td><div class='inline'><p>Wraps <code>text</code> to <code>wrap</code> characters and optionally indents by <code>indent</code> characters.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Text.html#levenshtein_distance-instance_method" title="Gem::Text#levenshtein_distance (method)">#levenshtein_distance</a></td>
      <td><div class='inline'><p>This code is based directly on the <a href="../Text.html" title="Gem::Text (module)"><code>::Gem::Text</code></a> gem implementation Returns a value representing the “cost” of transforming str1 into str2.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../Text.html#truncate_text-instance_method" title="Gem::Text#truncate_text (method)">#truncate_text</a>,
        <a class='i_m nodoc' href="../Text.html#min3-instance_method" title="Gem::Text#min3 (method)">#min3</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(spec, build_args = spec.build_args)  &#x21d2; <code>Builder</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new extension builder for <code>spec</code>.  If the <code>spec</code> does not yet have build arguments, saved, set <a href="#build_args-instance_method" title="Gem::Ext::Builder#build_args (method)">#build_args</a> which is an ARGV-style array.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L108-L114'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='108' data-end='114'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 108</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_build_args'><a href="#build_args-instance_method" title="Gem::Ext::Builder#build_args (method)">build_args</a></span> <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span>.<span class='id identifier rubyid_build_args'><a href="#build_args-instance_method" title="Gem::Ext::Builder#build_args (method)">build_args</a></span>)
  <span class='ivar'>@spec</span>       <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span>
  <span class='ivar'>@build_args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_args'><a href="#build_args-instance_method" title="Gem::Ext::Builder#build_args (method)">build_args</a></span>
  <span class='ivar'>@gem_dir</span>    <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span>.<span class='id identifier rubyid_full_gem_path'>full_gem_path</span>

  <span class='ivar'>@ran_rake</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="class_name-class_method">
  <h3 class='signature  first'>
    .<strong>class_name</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L24-L27'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='24' data-end='27'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 24</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_class_name'>class_name</span>
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Ext::(.*)Builder</span><span class='regexp_end'>/</span></span>
  <span class='backref'>$1</span>.<span class='id identifier rubyid_downcase'>downcase</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="make-class_method">
  <h3 class='signature '>
    .<strong>make</strong>(dest_path, results)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L29-L56'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='29' data-end='56'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 29</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_make'>make</span>(<span class='id identifier rubyid_dest_path'>dest_path</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span>)
  <span class='kw'>unless</span> <span class='const'>File</span>.<span class='id identifier rubyid_exist?'>exist?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Makefile</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../InstallError.html" title="Gem::InstallError (class)">InstallError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Makefile not found</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># try to find make program from Ruby configure arguments first
</span>  <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>configure_args</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>with-make-prog\=(\w+)</span><span class='regexp_end'>/</span></span>
  <span class='id identifier rubyid_make_program'>make_program</span> <span class='op'>=</span> <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MAKE</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>||</span> <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>make</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>||</span> <span class='backref'>$1</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_make_program'>make_program</span>
    <span class='id identifier rubyid_make_program'>make_program</span> <span class='op'>=</span> (<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>mswin</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='const'>RUBY_PLATFORM</span>) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nmake</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>make</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_destdir'>destdir</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;DESTDIR=%s&quot;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DESTDIR</span><span class='tstring_end'>&#39;</span></span>]

  [<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>clean</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>install</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_target'>target</span><span class='op'>|</span>
    <span class='comment'># Pass DESTDIR via command line to override what&#39;s in MAKEFLAGS
</span>    <span class='id identifier rubyid_cmd'>cmd</span> <span class='op'>=</span> [
      <span class='id identifier rubyid_make_program'>make_program</span><span class='comma'>,</span>
      <span class='id identifier rubyid_destdir'>destdir</span><span class='comma'>,</span>
      <span class='id identifier rubyid_target'>target</span>
    ].<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_rstrip'>rstrip</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_run'><a href="#run-class_method" title="Gem::Ext::Builder.run (method)">run</a></span>(<span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>make </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_rstrip'>rstrip</span>)
    <span class='kw'>rescue</span> <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../InstallError.html" title="Gem::InstallError (class)">InstallError</a></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='kw'>unless</span> <span class='id identifier rubyid_target'>target</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>clean</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># ignore clean failure
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="run-class_method">
  <h3 class='signature '>
    .<strong>run</strong>(command, results, command_name = nil) {|status, results| ... } 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(<code>status</code>, <code>results</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L58-L101'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='58' data-end='101'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 58</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_run'>run</span>(<span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_command_name'>command_name</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_verbose'>verbose</span> <span class='op'>=</span> <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span>.<span class='id identifier rubyid_configuration'><a href="../../Gem.html#configuration-class_method" title="Gem.configuration (method)">configuration</a></span>.<span class='id identifier rubyid_really_verbose'>really_verbose</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_rubygems_gemdeps'>rubygems_gemdeps</span><span class='comma'>,</span> <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBYGEMS_GEMDEPS</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBYGEMS_GEMDEPS</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_verbose'>verbose</span>
      <span class='id identifier rubyid_puts'>puts</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>current directory: </span><span class='embexpr_beg'>#{</span><span class='const'>Dir</span>.<span class='id identifier rubyid_pwd'>pwd</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
      <span class='id identifier rubyid_p'>p</span>(<span class='id identifier rubyid_command'>command</span>)
    <span class='kw'>end</span>
    <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>current directory: </span><span class='embexpr_beg'>#{</span><span class='const'>Dir</span>.<span class='id identifier rubyid_pwd'>pwd</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> (<span class='id identifier rubyid_command'>command</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_shelljoin'>shelljoin</span>) <span class='op'>?</span> <span class='id identifier rubyid_command'>command</span>.<span class='id identifier rubyid_shelljoin'>shelljoin</span> <span class='op'>:</span> <span class='id identifier rubyid_command'>command</span>)

    <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>open3</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># Set $SOURCE_DATE_EPOCH for the subprocess.
</span>    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> {<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SOURCE_DATE_EPOCH</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span>.<span class='id identifier rubyid_source_date_epoch_string'><a href="../../Gem.html#source_date_epoch_string-class_method" title="Gem.source_date_epoch_string (method)">source_date_epoch_string</a></span>}
    <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'>Open3</span>.<span class='id identifier rubyid_capture2e'>capture2e</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_command'>command</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_verbose'>verbose</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_output'>output</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../InstallError.html" title="Gem::InstallError (class)">InstallError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_command_name'>command_name</span> <span class='op'>||</span> <span class='id identifier rubyid_class_name'><a href="#class_name-class_method" title="Gem::Ext::Builder.class_name (method)">class_name</a></span><span class='embexpr_end'>}</span><span class='tstring_content'> failed</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span>.<span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>ensure</span>
    <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBYGEMS_GEMDEPS</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_rubygems_gemdeps'>rubygems_gemdeps</span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_success?'>success?</span>
    <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Building has failed. See above output for more information on the failure.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_verbose'>verbose</span>
  <span class='kw'>end</span>

  <span class='kw'>yield</span>(<span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span>) <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_success?'>success?</span>
    <span class='id identifier rubyid_exit_reason'>exit_reason</span> <span class='op'>=</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_exited?'>exited?</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, exit code </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_exitstatus'>exitstatus</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_signaled?'>signaled?</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, uncaught signal </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_termsig'>termsig</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../InstallError.html" title="Gem::InstallError (class)">InstallError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_command_name'>command_name</span> <span class='op'>||</span> <span class='id identifier rubyid_class_name'><a href="#class_name-class_method" title="Gem::Ext::Builder.class_name (method)">class_name</a></span><span class='embexpr_end'>}</span><span class='tstring_content'> failed</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_exit_reason'>exit_reason</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="build_args-instance_method">
  <h3 class='signature rw  nodoc first'>
    #<strong>build_args</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L22-L22'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='22' data-end='22'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 22</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_build_args'>build_args</span> <span class='comment'># :nodoc:</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="build_error-instance_method">
  <h3 class='signature nodoc first'>
    #<strong>build_error</strong>(output, backtrace = nil)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Logs the build <code>output</code>, then raises <a href="BuildError.html" title="Gem::Ext::BuildError (class)"><code>BuildError</code></a>.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="BuildError.html" title="Gem::Ext::BuildError (class)">Gem::Ext::BuildError</a>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L138-L151'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='138' data-end='151'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 138</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_error'>build_error</span>(<span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_backtrace'>backtrace</span> <span class='op'>=</span> <span class='kw'>nil</span>) <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_gem_make_out'>gem_make_out</span> <span class='op'>=</span> <span class='id identifier rubyid_write_gem_make_out'><a href="#write_gem_make_out-instance_method" title="Gem::Ext::Builder#write_gem_make_out (method)">write_gem_make_out</a></span> <span class='id identifier rubyid_output'>output</span>

  <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;-EOF</span>
<span class='tstring_content'>ERROR: Failed to build gem native extension.

  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_content'>

Gem files will remain installed in </span><span class='embexpr_beg'>#{</span><span class='ivar'>@gem_dir</span><span class='embexpr_end'>}</span><span class='tstring_content'> for inspection.
Results logged to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_make_out'>gem_make_out</span><span class='embexpr_end'>}</span><span class='tstring_content'>
</span><span class='heredoc_end'>EOF
</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../Ext.html" title="Gem::Ext (module)">Ext</a></span><span class='op'>::</span><span class='const'><a href="BuildError.html" title="Gem::Ext::BuildError (class)">BuildError</a></span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_backtrace'>backtrace</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_extension-instance_method">
  <h3 class='signature nodoc'>
    #<strong>build_extension</strong>(extension, dest_path)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L153-L187'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='153' data-end='187'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 153</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_extension'>build_extension</span>(<span class='id identifier rubyid_extension'>extension</span><span class='comma'>,</span> <span class='id identifier rubyid_dest_path'>dest_path</span>) <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> []

  <span class='id identifier rubyid_builder'>builder</span> <span class='op'>=</span> <span class='id identifier rubyid_builder_for'><a href="#builder_for-instance_method" title="Gem::Ext::Builder#builder_for (method)">builder_for</a></span>(<span class='id identifier rubyid_extension'>extension</span>)

  <span class='id identifier rubyid_extension_dir'>extension_dir</span> <span class='op'>=</span>
    <span class='const'>File</span>.<span class='id identifier rubyid_expand_path'>expand_path</span> <span class='const'>File</span>.<span class='id identifier rubyid_join'>join</span>(<span class='ivar'>@gem_dir</span><span class='comma'>,</span> <span class='const'>File</span>.<span class='id identifier rubyid_dirname'>dirname</span>(<span class='id identifier rubyid_extension'>extension</span>))
  <span class='id identifier rubyid_lib_dir'>lib_dir</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_join'>join</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_full_gem_path'>full_gem_path</span><span class='comma'>,</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_raw_require_paths'>raw_require_paths</span>.<span class='id identifier rubyid_first'>first</span>

  <span class='kw'>begin</span>
    <span class='const'>FileUtils</span>.<span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='id identifier rubyid_dest_path'>dest_path</span>

    <span class='const'><a href="#CHDIR_MUTEX-constant" title="Gem::Ext::Builder::CHDIR_MUTEX (constant)">CHDIR_MUTEX</a></span>.<span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_pwd'>pwd</span> <span class='op'>=</span> <span class='const'>Dir</span>.<span class='id identifier rubyid_getwd'>getwd</span>
      <span class='const'>Dir</span>.<span class='id identifier rubyid_chdir'>chdir</span> <span class='id identifier rubyid_extension_dir'>extension_dir</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span>.<span class='id identifier rubyid_build'>build</span>(<span class='id identifier rubyid_extension'>extension</span><span class='comma'>,</span> <span class='id identifier rubyid_dest_path'>dest_path</span><span class='comma'>,</span>
                                <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='ivar'>@build_args</span><span class='comma'>,</span> <span class='id identifier rubyid_lib_dir'>lib_dir</span>)

        <span class='id identifier rubyid_verbose'>verbose</span> { <span class='id identifier rubyid_results'>results</span>.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>) }
      <span class='kw'>ensure</span>
        <span class='kw'>begin</span>
          <span class='const'>Dir</span>.<span class='id identifier rubyid_chdir'>chdir</span> <span class='id identifier rubyid_pwd'>pwd</span>
        <span class='kw'>rescue</span> <span class='const'>SystemCallError</span>
          <span class='const'>Dir</span>.<span class='id identifier rubyid_chdir'>chdir</span> <span class='id identifier rubyid_dest_path'>dest_path</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_write_gem_make_out'><a href="#write_gem_make_out-instance_method" title="Gem::Ext::Builder#write_gem_make_out (method)">write_gem_make_out</a></span> <span class='id identifier rubyid_results'>results</span>.<span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_message'>message</span>
    <span class='id identifier rubyid_build_error'><a href="#build_error-instance_method" title="Gem::Ext::Builder#build_error (method)">build_error</a></span>(<span class='id identifier rubyid_results'>results</span>.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>)<span class='comma'>,</span> <span class='gvar'>$@</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_extensions-instance_method">
  <h3 class='signature '>
    #<strong>build_extensions</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Builds extensions.  Valid types of extensions are extconf.rb files, configure scripts and rakefiles or mkrf_conf files.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L193-L214'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='193' data-end='214'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 193</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_extensions'>build_extensions</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_extensions'>extensions</span>.<span class='id identifier rubyid_empty?'>empty?</span>

  <span class='kw'>if</span> <span class='ivar'>@build_args</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_say'>say</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Building native extensions. This could take a while...</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_say'>say</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Building native extensions with: &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@build_args</span>.<span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_say'>say</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This could take a while...</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_dest_path'>dest_path</span> <span class='op'>=</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_extension_dir'>extension_dir</span>

  <span class='const'>FileUtils</span>.<span class='id identifier rubyid_rm_f'>rm_f</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_gem_build_complete_path'>gem_build_complete_path</span>

  <span class='ivar'>@spec</span>.<span class='id identifier rubyid_extensions'>extensions</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_extension'>extension</span><span class='op'>|</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='ivar'>@ran_rake</span>

    <span class='id identifier rubyid_build_extension'><a href="#build_extension-instance_method" title="Gem::Ext::Builder#build_extension (method)">build_extension</a></span> <span class='id identifier rubyid_extension'>extension</span><span class='comma'>,</span> <span class='id identifier rubyid_dest_path'>dest_path</span>
  <span class='kw'>end</span>

  <span class='const'>FileUtils</span>.<span class='id identifier rubyid_touch'>touch</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_gem_build_complete_path'>gem_build_complete_path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="builder_for-instance_method">
  <h3 class='signature nodoc'>
    #<strong>builder_for</strong>(extension)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Chooses the extension builder class for <code>extension</code></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L119-L133'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='119' data-end='133'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 119</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_builder_for'>builder_for</span>(<span class='id identifier rubyid_extension'>extension</span>) <span class='comment'># :nodoc:
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_extension'>extension</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>extconf</span><span class='regexp_end'>/</span></span> <span class='kw'>then</span>
    <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../Ext.html" title="Gem::Ext (module)">Ext</a></span><span class='op'>::</span><span class='const'><a href="ExtConfBuilder.html" title="Gem::Ext::ExtConfBuilder (class)">ExtConfBuilder</a></span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>configure</span><span class='regexp_end'>/</span></span> <span class='kw'>then</span>
    <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../Ext.html" title="Gem::Ext (module)">Ext</a></span><span class='op'>::</span><span class='const'><a href="ConfigureBuilder.html" title="Gem::Ext::ConfigureBuilder (class)">ConfigureBuilder</a></span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>rakefile</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>mkrf_conf</span><span class='regexp_end'>/i</span></span> <span class='kw'>then</span>
    <span class='ivar'>@ran_rake</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../Ext.html" title="Gem::Ext (module)">Ext</a></span><span class='op'>::</span><span class='const'><a href="RakeBuilder.html" title="Gem::Ext::RakeBuilder (class)">RakeBuilder</a></span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>CMakeLists.txt</span><span class='regexp_end'>/</span></span> <span class='kw'>then</span>
    <span class='const'><a href="../../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="../Ext.html" title="Gem::Ext (module)">Ext</a></span><span class='op'>::</span><span class='const'><a href="CmakeBuilder.html" title="Gem::Ext::CmakeBuilder (class)">CmakeBuilder</a></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_build_error'><a href="#build_error-instance_method" title="Gem::Ext::Builder#build_error (method)">build_error</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No builder for extension &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_extension'>extension</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="write_gem_make_out-instance_method">
  <h3 class='signature nodoc'>
    #<strong>write_gem_make_out</strong>(output)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Writes <code>output</code> to gem_make.out in the extension install directory.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_7_8/lib/rubygems/ext/builder.rb#L219-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='219' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/ext/builder.rb', line 219</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_write_gem_make_out'>write_gem_make_out</span>(<span class='id identifier rubyid_output'>output</span>) <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_destination'>destination</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_join'>join</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_extension_dir'>extension_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gem_make.out</span><span class='tstring_end'>&#39;</span></span>

  <span class='const'>FileUtils</span>.<span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='ivar'>@spec</span>.<span class='id identifier rubyid_extension_dir'>extension_dir</span>

  <span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_destination'>destination</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_output'>output</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_destination'>destination</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>