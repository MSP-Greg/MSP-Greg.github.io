<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: README &mdash; Capybara master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "README",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Capybara master</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: README&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<h1><a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a></h1>

<p><a href="https://github.com/teamcapybara/capybara/actions/workflows/build.yml"><img src="https://github.com/teamcapybara/capybara/actions/workflows/build.yml/badge.svg" alt="Build Status"></a>
<a href="https://codeclimate.com/github/teamcapybara/capybara"><img src="https://codeclimate.com/github/teamcapybara/capybara.svg" alt="Code Climate"></a>
<a href="https://coveralls.io/github/teamcapybara/capybara?branch=master"><img src="https://coveralls.io/repos/github/teamcapybara/capybara/badge.svg?branch=master" alt="Coverage Status"></a></p>

<p><a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> helps you test web applications by simulating how a real user would
interact with your app. It is agnostic about the driver running your tests and
comes with Rack::Test and Selenium support built in. WebKit is supported
through an external gem.</p>

<h2>Support Capybara</h2>

<p>If you and/or your company find value in <a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> and would like to contribute financially to its ongoing maintenance and development, please visit
<a href="https://www.patreon.com/capybara">Patreon</a></p>

<p><strong>Need help?</strong> Ask on the discussions (please do not open an issue): <a href="https://github.com/orgs/teamcapybara/discussions/categories/q-a">https://github.com/orgs/teamcapybara/discussions/categories/q-a</a></p>

<h2>Table of contents</h2>

<ul>
<li><a href="#key-benefits">Key benefits</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#using-capybara-with-cucumber">Using <a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> with Cucumber</a></li>
<li><a href="#using-capybara-with-rspec">Using <a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> with RSpec</a></li>
<li><a href="#using-capybara-with-testunit">Using <a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> with Test::Unit</a></li>
<li><a href="#using-capybara-with-minitest">Using <a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> with Minitest</a></li>
<li><a href="#using-capybara-with-minitestspec">Using <a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> with Minitest::Spec</a></li>
<li><a href="#drivers">Drivers</a>

<ul>
<li><a href="#selecting-the-driver">Selecting the Driver</a></li>
<li><a href="#racktest">RackTest</a></li>
<li><a href="#selenium">Selenium</a></li>
</ul></li>
<li><a href="#the-dsl">The DSL</a>

<ul>
<li><a href="#navigating">Navigating</a></li>
<li><a href="#clicking-links-and-buttons">Clicking links and buttons</a></li>
<li><a href="#interacting-with-forms">Interacting with forms</a></li>
<li><a href="#querying">Querying</a></li>
<li><a href="#finding">Finding</a></li>
<li><a href="#scoping">Scoping</a></li>
<li><a href="#working-with-windows">Working with windows</a></li>
<li><a href="#scripting">Scripting</a></li>
<li><a href="#modals">Modals</a></li>
<li><a href="#debugging">Debugging</a></li>
</ul></li>
<li><a href="#selectors">Selectors</a>

<ul>
<li><a href="#selectors-name">Name</a></li>
<li><a href="#selectors-locator">Locator</a></li>
<li><a href="#selectors-filters">Filters</a></li>
</ul></li>
<li><a href="#matching">Matching</a>

<ul>
<li><a href="#exactness">Exactness</a></li>
<li><a href="#strategy">Strategy</a></li>
</ul></li>
<li><a href="#transactions-and-database-setup">Transactions and database setup</a></li>
<li><a href="#asynchronous-javascript-ajax-and-friends">Asynchronous JavaScript (Ajax and friends)</a></li>
<li><a href="#using-the-dsl-elsewhere">Using the DSL elsewhere</a></li>
<li><a href="#calling-remote-servers">Calling remote servers</a></li>
<li><a href="#using-sessions">Using sessions</a>

<ul>
<li><a href="#named-sessions">Named sessions</a></li>
<li><a href="#using-sessions-manually">Using sessions manually</a></li>
</ul></li>
<li><a href="#xpath-css-and-selectors">XPath, CSS and selectors</a></li>
<li><a href="#beware-the-xpath--trap">Beware the <a href="XPath.html" title="XPath (module)"><code>XPath</code></a> // trap</a></li>
<li><a href="#configuring-and-adding-drivers">Configuring and adding drivers</a></li>
<li><a href="#gotchas">Gotchas:</a></li>
<li><a href="#threadsafe-mode">&quot;Threadsafe&quot; mode</a></li>
<li><a href="#development">Development</a></li>
</ul>

<h2><a name="key-benefits"></a>Key benefits</h2>

<ul>
<li><strong>No setup</strong> necessary for Rails and Rack application. Works out of the box.</li>
<li><strong>Intuitive API</strong> which mimics the language an actual user would use.</li>
<li><strong>Switch the backend</strong> your tests run against from fast headless mode
to an actual browser with no changes to your tests.</li>
<li><strong>Powerful synchronization</strong> features mean you never have to manually wait
for asynchronous processes to complete.</li>
</ul>

<h2><a name="setup"></a>Setup</h2>

<p><a href="Capybara.html" title="Capybara (module)"><code>Capybara</code></a> requires Ruby 3.0.0 or later. To install, add this line to your
<code>Gemfile</code> and run <code>bundle install</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>If the application that you are testing is a Rails app, add this line to your test helper file:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/rails</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>If the application that you are testing is a Rack app, but not Rails, set Capybara.app to your Rack app:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span> <span class='op'>=</span> <span class='const'>MyRackApp</span></code></pre>

<p>If you need to test JavaScript, or if your app interacts with (or is located at)
a remote URL, you&#39;ll need to <a href="#drivers">use a different driver</a>.  If using Rails 5.0+, but not using the Rails system tests from 5.1, you&#39;ll probably also
want to swap the &quot;server&quot; used to launch your app to Puma in order to match Rails defaults.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_server'><a href="Capybara.html#server-class_method" title="Capybara.server (method)">server</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_puma'>puma</span> <span class='comment'># Until your setup is working
</span><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_server'><a href="Capybara.html#server-class_method" title="Capybara.server (method)">server</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_puma'>puma</span><span class='comma'>,</span> { <span class='label'>Silent:</span> <span class='kw'>true</span> } <span class='comment'># To clean up your test output</span></code></pre>

<h2><a name="using-capybara-with-cucumber"></a>Using Capybara with Cucumber</h2>

<p>The <code>cucumber-rails</code> gem comes with Capybara support built-in. If you
are not using Rails, manually load the <code>capybara/cucumber</code> module:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/cucumber</span><span class='tstring_end'>&#39;</span></span>
<span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span> <span class='op'>=</span> <span class='const'>MyRackApp</span></code></pre>

<p>You can use the Capybara DSL in your steps, like so:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>When</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I sign in</span><span class='regexp_end'>/</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_within'>within</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#session</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user@example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sign in</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<p>You can switch to the <a href="Capybara.html#javascript_driver-class_method" title="Capybara.javascript_driver (method)">Capybara.javascript_driver</a> (<code>:selenium</code>
by default) by tagging scenarios (or features) with <code>@javascript</code>:</p>

<pre class="code ruby"><code class="ruby">@javascript
Scenario: do something Ajaxy
  When I click the Ajax link
  #...</code></pre>

<p>There are also explicit tags for each registered driver set up for you (<code>@selenium</code>, <code>@rack_test</code>, etc).</p>

<h2><a name="using-capybara-with-rspec"></a>Using Capybara with RSpec</h2>

<p>Load RSpec 3.5+ support by adding the following line (typically to your
<code>spec_helper.rb</code> file):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/rspec</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>If you are using Rails, put your Capybara specs in <code>spec/features</code> or <code>spec/system</code> (only works if
<a href="https://rspec.info/features/6-0/rspec-rails/directory-structure/">you have it configured in RSpec</a>)
and if you have your Capybara specs in a different directory, then tag the example groups with
<code>type: :feature</code> or <code>type: :system</code> depending on which type of test you&#39;re writing.</p>

<p>If you are using Rails system specs please see <a href="https://rspec.info/features/6-0/rspec-rails/system-specs/system-specs">their documentation</a>
for selecting the driver you wish to use.</p>

<p>If you are not using Rails, tag all the example groups in which you want to use
Capybara with <code>type: :feature</code>.</p>

<p>You can now write your specs like so:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>the signin process</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_feature'>feature</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_before'>before</span> <span class='symbeg'>:</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span>
    <span class='const'>User</span>.<span class='id identifier rubyid_create'>create</span>(<span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user@example.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>password:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>signs me in</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_visit'>visit</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/sessions/new</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_within'>within</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#session</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user@example.com</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sign in</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_content'>have_content</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Success</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>Use <code>js: true</code> to switch to the <a href="Capybara.html#javascript_driver-class_method" title="Capybara.javascript_driver (method)">Capybara.javascript_driver</a>
(<code>:selenium</code> by default), or provide a <code>:driver</code> option to switch
to one specific driver. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some stuff which requires js</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>js:</span> <span class='kw'>true</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>will use the default js driver</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>will switch to one specific driver</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>driver:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_selenium'>selenium</span>
<span class='kw'>end</span></code></pre>

<p>Capybara also comes with a built in DSL for creating descriptive acceptance tests:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_feature'>feature</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signing in</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_background'>background</span> <span class='kw'>do</span>
    <span class='const'>User</span>.<span class='id identifier rubyid_create'>create</span>(<span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user@example.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>password:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>caplin</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_scenario'>scenario</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signing in with correct credentials</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_visit'>visit</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/sessions/new</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_within'>within</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#session</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user@example.com</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>caplin</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sign in</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_content'>have_content</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Success</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_given'>given</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_other_user'>other_user</span>) { <span class='const'>User</span>.<span class='id identifier rubyid_create'>create</span>(<span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>other@example.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>password:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rous</span><span class='tstring_end'>&#39;</span></span>) }

  <span class='id identifier rubyid_scenario'>scenario</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signing in as another user</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_visit'>visit</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/sessions/new</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_within'>within</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#session</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='id identifier rubyid_other_user'>other_user</span>.<span class='id identifier rubyid_email'>email</span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='id identifier rubyid_other_user'>other_user</span>.<span class='id identifier rubyid_password'>password</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sign in</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_content'>have_content</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Invalid email or password</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p><code>feature</code> is in fact just an alias for <code>describe ..., type: :feature</code>,
<code>background</code> is an alias for <code>before</code>, <code>scenario</code> for <code>it</code>, and
<code>given</code>/<code>given!</code> aliases for <code>let</code>/<code>let!</code>, respectively.</p>

<p>Finally, Capybara matchers are also supported in view specs:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>RSpec</span>.<span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>todos/show.html.erb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_view'>view</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>displays the todo title</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_assign'>assign</span> <span class='symbeg'>:</span><span class='id identifier rubyid_todo'>todo</span><span class='comma'>,</span> <span class='const'>Todo</span>.<span class='id identifier rubyid_new'>new</span>(<span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Buy milk</span><span class='tstring_end'>&quot;</span></span>)

    <span class='id identifier rubyid_render'>render</span>

    <span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_rendered'>rendered</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_css'>have_css</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>header h1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>text:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Buy milk</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p><strong>Note: When you require &#39;capybara/rspec&#39; proxy methods are installed to work around name collisions between Capybara::DSL methods
  <code>all</code>/<code>within</code> and the identically named built-in RSpec matchers. If you opt not to require &#39;capybara/rspec&#39; you can install the proxy methods by requiring &#39;capybara/rspec/matcher_proxies&#39; after requiring RSpec and &#39;capybara/dsl&#39;</strong></p>

<h2><a name="using-capybara-with-testunit"></a>Using Capybara with Test::Unit</h2>

<ul>
<li><p>If you are using <code>Test::Unit</code>, define a base class for your Capybara tests
like so:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/dsl</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>class</span> <span class='const'>CapybaraTestCase</span> <span class='op'>&lt;</span> <span class='const'>Test</span><span class='op'>::</span><span class='const'>Unit</span><span class='op'>::</span><span class='const'>TestCase</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/DSL.html" title="Capybara::DSL (module)">DSL</a></span>

  <span class='kw'>def</span> <span class='id identifier rubyid_teardown'>teardown</span>
    <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_reset_sessions!'><a href="Capybara.html#reset_sessions!-class_method" title="Capybara.reset_sessions! (method)">reset_sessions!</a></span>
    <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_use_default_driver'><a href="Capybara.html#use_default_driver-class_method" title="Capybara.use_default_driver (method)">use_default_driver</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre></li>
</ul>

<h2><a name="using-capybara-with-minitest"></a>Using Capybara with Minitest</h2>

<ul>
<li><p>If you are using Rails system tests please see their documentation for information on selecting the driver you wish to use.</p></li>
<li><p>If you are using Rails, but not using Rails system tests, add the following code in your <code>test_helper.rb</code>
file to make Capybara available in all test cases deriving from
<code>ActionDispatch::IntegrationTest</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/rails</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/minitest</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>class</span> <span class='const'>ActionDispatch</span><span class='op'>::</span><span class='const'>IntegrationTest</span>
  <span class='comment'># Make the Capybara DSL available in all integration tests
</span>  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/DSL.html" title="Capybara::DSL (module)">DSL</a></span>
  <span class='comment'># Make `assert_*` methods behave like Minitest assertions
</span>  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Minitest.html" title="Capybara::Minitest (module)">Minitest</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Minitest/Assertions.html" title="Capybara::Minitest::Assertions (module)">Assertions</a></span>

  <span class='comment'># Reset sessions and driver between tests
</span>  <span class='id identifier rubyid_teardown'>teardown</span> <span class='kw'>do</span>
    <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_reset_sessions!'><a href="Capybara.html#reset_sessions!-class_method" title="Capybara.reset_sessions! (method)">reset_sessions!</a></span>
    <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_use_default_driver'><a href="Capybara.html#use_default_driver-class_method" title="Capybara.use_default_driver (method)">use_default_driver</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre></li>
<li><p>If you are not using Rails, define a base class for your Capybara tests like
so:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/minitest</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>class</span> <span class='const'>CapybaraTestCase</span> <span class='op'>&lt;</span> <span class='const'><a href="Capybara/Minitest.html" title="Capybara::Minitest (module)">Minitest</a></span><span class='op'>::</span><span class='const'>Test</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/DSL.html" title="Capybara::DSL (module)">DSL</a></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Minitest.html" title="Capybara::Minitest (module)">Minitest</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Minitest/Assertions.html" title="Capybara::Minitest::Assertions (module)">Assertions</a></span>

  <span class='kw'>def</span> <span class='id identifier rubyid_teardown'>teardown</span>
    <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_reset_sessions!'><a href="Capybara.html#reset_sessions!-class_method" title="Capybara.reset_sessions! (method)">reset_sessions!</a></span>
    <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_use_default_driver'><a href="Capybara.html#use_default_driver-class_method" title="Capybara.use_default_driver (method)">use_default_driver</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>Remember to call <code>super</code> in any subclasses that override
<code>teardown</code>.</p></li>
</ul>

<p>To switch the driver, set <a href="Capybara.html#current_driver-class_method" title="Capybara.current_driver (method)">Capybara.current_driver</a>. For instance,</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>BlogTest</span> <span class='op'>&lt;</span> <span class='const'>ActionDispatch</span><span class='op'>::</span><span class='const'>IntegrationTest</span>
  <span class='id identifier rubyid_setup'>setup</span> <span class='kw'>do</span>
    <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_current_driver'><a href="Capybara.html#current_driver-class_method" title="Capybara.current_driver (method)">current_driver</a></span> <span class='op'>=</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_javascript_driver'><a href="Capybara.html#javascript_driver-class_method" title="Capybara.javascript_driver (method)">javascript_driver</a></span> <span class='comment'># :selenium by default
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_test'>test</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>shows blog posts</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
    <span class='comment'># ... this test is run with Selenium ...
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<h2><a name="using-capybara-with-minitestspec"></a>Using Capybara with Minitest::Spec</h2>

<p>Follow the above instructions for Minitest and additionally require capybara/minitest/spec</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_must_have_content'>must_have_content</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Important!</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<h2><a name="drivers"></a>Drivers</h2>

<p>Capybara uses the same DSL to drive a variety of browser and headless drivers.</p>

<h3><a name="selecting-the-driver"></a>Selecting the Driver</h3>

<p>By default, Capybara uses the <code>:rack_test</code> driver, which is fast but limited: it
does not support JavaScript, nor is it able to access HTTP resources outside of
your Rack application, such as remote APIs and OAuth services. To get around
these limitations, you can set up a different default driver for your features.
For example, if you&#39;d prefer to run everything in Selenium, you could do:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_default_driver'><a href="Capybara.html#default_driver-class_method" title="Capybara.default_driver (method)">default_driver</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_selenium'>selenium</span> <span class='comment'># :selenium_chrome and :selenium_chrome_headless are also registered</span></code></pre>

<p>However, if you are using RSpec or Cucumber (and your app runs correctly without JS),
you may instead want to consider leaving the faster <code>:rack_test</code> as the <strong>default_driver</strong>, and
marking only those tests that require a JavaScript-capable driver using <code>js: true</code> or
<code>@javascript</code>, respectively.  By default, JavaScript tests are run using the
<code>:selenium</code> driver. You can change this by setting
<a href="Capybara.html#javascript_driver-class_method" title="Capybara.javascript_driver (method)">Capybara.javascript_driver</a>.</p>

<p>You can also change the driver temporarily (typically in the Before/setup and
After/teardown blocks):</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_current_driver'><a href="Capybara.html#current_driver-class_method" title="Capybara.current_driver (method)">current_driver</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_selenium'>selenium</span> <span class='comment'># temporarily select different driver
</span><span class='comment'># tests here
</span><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_use_default_driver'><a href="Capybara.html#use_default_driver-class_method" title="Capybara.use_default_driver (method)">use_default_driver</a></span>       <span class='comment'># switch back to default driver</span></code></pre>

<p><strong>Note</strong>: switching the driver creates a new session, so you may not be able to
switch in the middle of a test.</p>

<h3><a name="racktest"></a>RackTest</h3>

<p>RackTest is Capybara&#39;s default driver. It is written in pure Ruby and does not
have any support for executing JavaScript. Since the RackTest driver interacts
directly with Rack interfaces, it does not require a server to be started.
However, this means that if your application is not a Rack application (Rails,
Sinatra and most other Ruby frameworks are Rack applications) then you cannot
use this driver. Furthermore, you cannot use the RackTest driver to test a
remote application, or to access remote URLs (e.g., redirects to external
sites, external APIs, or OAuth services) that your application might interact
with.</p>

<p><a href="https://github.com/jeroenvandijk/capybara-mechanize">capybara-mechanize</a>
provides a similar driver that can access remote servers.</p>

<p>RackTest can be configured with a set of headers like this:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_register_driver'><a href="Capybara.html#register_driver-class_method" title="Capybara.register_driver (method)">register_driver</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_rack_test'>rack_test</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span><span class='op'>|</span>
  <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/RackTest.html" title="Capybara::RackTest (module)">RackTest</a></span><span class='op'>::</span><span class='const'><a href="Capybara/RackTest/Driver.html" title="Capybara::RackTest::Driver (class)">Driver</a></span>.<span class='id identifier rubyid_new'><a href="Capybara/RackTest/Driver.html#new-class_method" title="Capybara::RackTest::Driver.new (method)">new</a></span>(<span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span><span class='comma'>,</span> <span class='label'>headers:</span> { <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_USER_AGENT</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Capybara</span><span class='tstring_end'>&#39;</span></span> })
<span class='kw'>end</span></code></pre>

<p>See the section on adding and configuring drivers.</p>

<h3><a name="selenium"></a>Selenium</h3>

<p>Capybara supports <a href="https://www.seleniumhq.org/projects/webdriver/">Selenium 3.5+
(Webdriver)</a>.
In order to use Selenium, you&#39;ll need to install the <code>selenium-webdriver</code> gem,
and add it to your Gemfile if you&#39;re using bundler.</p>

<p>Capybara pre-registers a number of named drivers that use Selenium - they are:</p>

<ul>
<li>:selenium                 =&gt; Selenium driving Firefox</li>
<li>:selenium_headless        =&gt; Selenium driving Firefox in a headless configuration</li>
<li>:selenium_chrome          =&gt; Selenium driving Chrome</li>
<li>:selenium_chrome_headless =&gt; Selenium driving Chrome in a headless configuration</li>
</ul>

<p>These should work (with relevant software installation) in a local desktop configuration but you may
need to customize them if using in a CI environment where additional options may need to be passed
to the browsers.  See the section on adding and configuring drivers.</p>

<p><strong>Note</strong>: drivers which run the server in a different thread may not share the
same transaction as your tests, causing data not to be shared between your test
and test server, see <a href="#transactions-and-database-setup">Transactions and database setup</a> below.</p>

<h2><a name="the-dsl"></a>The DSL</h2>

<p><em>A complete reference is available at
<a href="http://rubydoc.info/github/teamcapybara/capybara/master">rubydoc.info</a></em>.</p>

<p><strong>Note: By default Capybara will only locate visible elements. This is because
 a real user would not be able to interact with non-visible elements.</strong></p>

<p><strong>Note</strong>: All searches in Capybara are <em>case sensitive</em>. This is because
Capybara heavily uses XPath, which doesn&#39;t support case insensitivity.</p>

<h3><a name="navigating"></a>Navigating</h3>

<p>You can use the
<tt><a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Session#visit-instance_method">visit</a></tt>
method to navigate to other pages:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_visit'>visit</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/projects</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_visit'>visit</span>(<span class='id identifier rubyid_post_comments_path'>post_comments_path</span>(<span class='id identifier rubyid_post'>post</span>))</code></pre>

<p>The visit method only takes a single parameter, the request method is <strong>always</strong>
GET.</p>

<p>You can get the <a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Session#current_path-instance_method">current path</a>
of the browsing session, and test it using the <a href="http://www.rubydoc.info/github/teamcapybara/capybara/master/Capybara/RSpecMatchers#have_current_path-instance_method"><code>have_current_path</code></a> matcher:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_current_path'>have_current_path</span>(<span class='id identifier rubyid_post_comments_path'>post_comments_path</span>(<span class='id identifier rubyid_post'>post</span>))</code></pre>

<p><strong>Note</strong>: You can also assert the current path by testing the value of
<code>current_path</code> directly. However, using the <code>have_current_path</code> matcher is
safer since it uses Capybara&#39;s <a href="#asynchronous-javascript-ajax-and-friends">waiting behaviour</a>
to ensure that preceding actions (such as a <code>click_link</code>) have completed.</p>

<h3><a name="clicking-links-and-buttons"></a>Clicking links and buttons</h3>

<p><em>Full reference: <a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Actions">Capybara::Node::Actions</a></em></p>

<p>You can interact with the webapp by following links and buttons. Capybara
automatically follows any redirects, and submits forms associated with buttons.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id-of-link</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Link Text</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_click_button'>click_button</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Save</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_click_on'>click_on</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Link Text</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># clicks on either links or buttons
</span><span class='id identifier rubyid_click_on'>click_on</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Button Value</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<h3><a name="interacting-with-forms"></a>Interacting with forms</h3>

<p><em>Full reference: <a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Actions">Capybara::Node::Actions</a></em></p>

<p>There are a number of tools for interacting with form elements:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_fill_in'>fill_in</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>First Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>John</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_fill_in'>fill_in</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Seekrit</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_fill_in'>fill_in</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Description</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Really Long Text...</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_choose'>choose</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A Radio Button</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_check'>check</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A Checkbox</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_uncheck'>uncheck</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A Checkbox</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_attach_file'>attach_file</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Image</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/path/to/image.jpg</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_select'>select</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Option</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>from:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Select Box</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<h3><a name="querying"></a>Querying</h3>

<p><em>Full reference: <a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Matchers">Capybara::Node::Matchers</a></em></p>

<p>Capybara has a rich set of options for querying the page for the existence of
certain elements, and working with and manipulating those elements.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_has_selector?'>has_selector?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>table tr</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_has_selector?'>has_selector?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//table/tr</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_has_xpath?'>has_xpath?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//table/tr</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_has_css?'>has_css?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>table tr.foo</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_has_content?'>has_content?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p><strong>Note:</strong> The negative forms like <code>has_no_selector?</code> are different from <code>not
has_selector?</code>. Read the section on asynchronous JavaScript for an explanation.</p>

<p>You can use these with RSpec&#39;s magic matchers:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_selector'>have_selector</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>table tr</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_selector'>have_selector</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//table/tr</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_xpath'>have_xpath</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//table/tr</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_css'>have_css</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>table tr.foo</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_content'>have_content</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<h3><a name="finding"></a>Finding</h3>

<p><em>Full reference: <a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Finders">Capybara::Node::Finders</a></em></p>

<p>You can also find specific elements, in order to manipulate them:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_find_field'>find_field</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>First Name</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_value'>value</span>
<span class='id identifier rubyid_find_field'>find_field</span>(<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_field</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_value'>value</span>
<span class='id identifier rubyid_find_link'>find_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Hello</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_visible'>visible</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_all'>all</span>).<span class='id identifier rubyid_visible?'>visible?</span>
<span class='id identifier rubyid_find_link'>find_link</span>(<span class='label'>class:</span> [<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_class</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some_other_class</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_visible'>visible</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_all'>all</span>).<span class='id identifier rubyid_visible?'>visible?</span>

<span class='id identifier rubyid_find_button'>find_button</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Send</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_click'>click</span>
<span class='id identifier rubyid_find_button'>find_button</span>(<span class='label'>value:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1234</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_click'>click</span>

<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.//table/tr</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_click'>click</span>
<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#overlay</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_click'>click</span>
<span class='id identifier rubyid_all'>all</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_href'>href</span>] }</code></pre>

<p>If you need to find elements by additional attributes/properties you can also pass a filter block, which will be checked inside the normal waiting behavior.
If you find yourself needing to use this a lot you may be better off adding a <a href="http://www.rubydoc.info/github/teamcapybara/capybara/Capybara#add_selector-class_method">custom selector</a> or <a href="http://www.rubydoc.info/github/teamcapybara/capybara/Capybara#modify_selector-class_method">adding a filter to an existing selector</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_find_field'>find_field</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>First Name</span><span class='tstring_end'>&#39;</span></span>){ <span class='op'>|</span><span class='id identifier rubyid_el'>el</span><span class='op'>|</span> <span class='id identifier rubyid_el'>el</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>data-xyz</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>123</span><span class='tstring_end'>&#39;</span></span> }
<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#img_loading</span><span class='tstring_end'>&quot;</span></span>){ <span class='op'>|</span><span class='id identifier rubyid_img'>img</span><span class='op'>|</span> <span class='id identifier rubyid_img'>img</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>complete</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>==</span> <span class='kw'>true</span> }</code></pre>

<p><strong>Note</strong>: <code>find</code> will wait for an element to appear on the page, as explained in the
Ajax section. If the element does not appear it will raise an error.</p>

<p>These elements all have all the Capybara DSL methods available, so you can restrict them
to specific parts of the page:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#navigation</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Home</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#navigation</span><span class='tstring_end'>&#39;</span></span>)).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_button'>have_button</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sign out</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<h3><a name="scoping"></a>Scoping</h3>

<p>Capybara makes it possible to restrict certain actions, such as interacting with
forms or clicking links and buttons, to within a specific area of the page. For
this purpose you can use the generic
<tt><a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Session#within-instance_method">within</a></tt>
method. Optionally you can specify which kind of selector to use.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_within'>within</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>li#employee</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Jimmy</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>

<span class='id identifier rubyid_within'>within</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.//li[@id=&#39;employee&#39;]</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Jimmy</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<p>There are special methods for restricting the scope to a specific fieldset,
identified by either an id or the text of the fieldset&#39;s legend tag, and to a
specific table, identified by either id or text of the table&#39;s caption tag.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_within_fieldset'>within_fieldset</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Employee</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Jimmy</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>

<span class='id identifier rubyid_within_table'>within_table</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Employee</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Jimmy</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<h3><a name="working-with-windows"></a>Working with windows</h3>

<p>Capybara provides some methods to ease finding and switching windows:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_facebook_window'>facebook_window</span> <span class='op'>=</span> <span class='id identifier rubyid_window_opened_by'>window_opened_by</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Like</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
<span class='id identifier rubyid_within_window'>within_window</span> <span class='id identifier rubyid_facebook_window'>facebook_window</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#login_email</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_set'>set</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a@example.com</span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#login_password</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_set'>set</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>qwerty</span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Submit</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<h3><a name="scripting"></a>Scripting</h3>

<p>In drivers which support it, you can easily execute JavaScript:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_execute_script'>execute_script</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$(&#39;body&#39;).empty()</span><span class='tstring_end'>&quot;</span></span>)</code></pre>

<p>For simple expressions, you can return the result of the script.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_evaluate_script'>evaluate_script</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>4 + 4</span><span class='tstring_end'>&#39;</span></span>)<span class='semicolon'>;</span></code></pre>

<p>For more complicated scripts you&#39;ll need to write them as one expression.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_evaluate_script'>evaluate_script</span>(<span class='heredoc_beg'>&lt;&lt;~JS</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='id identifier rubyid_element'>element</span>)
<span class='ignored_sp'>  </span><span class='tstring_content'>(function(n, el){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var val = parseInt(el.value, 10);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  return n+val;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>})(arguments[0], arguments[1])
</span><span class='heredoc_end'>JS</span></code></pre>

<h3><a name="modals"></a>Modals</h3>

<p>In drivers which support it, you can accept, dismiss and respond to alerts, confirms, and prompts.</p>

<p>You can accept alert messages by wrapping the code that produces an alert in a block:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_accept_alert'>accept_alert</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>optional text or regex</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Show Alert</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span></code></pre>

<p>You can accept or dismiss a confirmation by wrapping it in a block, as well:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_accept_confirm'>accept_confirm</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>optional text</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Show Confirm</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span></code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_dismiss_confirm'>dismiss_confirm</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>optional text</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Show Confirm</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span></code></pre>

<p>You can accept or dismiss prompts as well, and also provide text to fill in for the response:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_accept_prompt'>accept_prompt</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>optional text</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Linus Torvalds</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Show Prompt About Linux</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span></code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_dismiss_prompt'>dismiss_prompt</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>optional text</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Show Prompt About Linux</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span></code></pre>

<p>All modal methods return the message that was presented. So, you can access the prompt message
by assigning the return to a variable:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_accept_prompt'>accept_prompt</span>(<span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Linus Torvalds</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Show Prompt About Linux</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span>
<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_message'>message</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Who is the chief architect of Linux?</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<h3><a name="debugging"></a>Debugging</h3>

<p>It can be useful to take a snapshot of the page as it currently is and take a
look at it:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_save_and_open_page'>save_and_open_page</span></code></pre>

<p>You can also retrieve the current state of the DOM as a string using
<tt><a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Session#html-instance_method">page.html</a></tt>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span></code></pre>

<p>This is mostly useful for debugging. You should avoid testing against the
contents of <code>page.html</code> and use the more expressive finder methods instead.</p>

<p>Finally, in drivers that support it, you can save a screenshot:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_save_screenshot'>save_screenshot</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>screenshot.png</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>Or have it save and automatically open:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_save_and_open_screenshot'>save_and_open_screenshot</span></code></pre>

<p>Screenshots are saved to <code>Capybara.save_path</code>, relative to the app directory.
If you have required <code>capybara/rails</code>, <code>Capybara.save_path</code> will default to
<code>tmp/capybara</code>.</p>

<h2><a name="selectors"></a>Selectors</h2>

<p>Helpers and matchers that accept Selectors share a common method signature that
includes:</p>

<ol>
<li>a positional Name argument</li>
<li>a positional Locator argument</li>
<li>keyword Filter arguments</li>
<li>a predicate Filter block argument</li>
</ol>

<p>These arguments are usually optional in one way or another.</p>

<h3><a name="selectors-name"></a>Name</h3>

<p>The name argument determines the Selector to use. The argument is optional when
a helper explicitly conveys the selector name (for example, <a href="https://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Finders:find_field"><code>find_field</code></a>
uses <code>:field</code>, <a href="https://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Finders:find_link"><code>find_link</code></a> uses <code>:link</code>, etc):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;&#39;
</span>
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_link'>link</span>) <span class='op'>==</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_link'>find_link</span>

<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;input&gt;&#39;
</span>
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_field'>field</span>) <span class='op'>==</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_field'>find_field</span></code></pre>

<h3><a name="selectors-locator"></a>Locator</h3>

<p>The locator argument usually represents information that can most meaningfully
distinguish an element that matches the selector from an element that does not:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;div id=&quot;greeting&quot;&gt;Hello world&lt;/div&gt;&#39;
</span>
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_css'>css</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>div</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_text'>text</span>     <span class='comment'># =&gt; &#39;Hello world&#39;
</span><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//div</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_text'>text</span> <span class='comment'># =&gt; &#39;Hello world&#39;</span></code></pre>

<p>General purpose finder methods like <a href="https://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Finders:find"><code>find</code></a> and <a href="https://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Node/Finders:all"><code>all</code></a> can accept the
locator as their first positional argument when the method can infer the default
value from the <a href="https://rubydoc.info/github/teamcapybara/capybara/master/Capybara%2Econfigure"><a href="Capybara.html#default_selector-class_method" title="Capybara.default_selector (method)">Capybara.default_selector</a></a> configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;div id=&quot;greeting&quot;&gt;Hello world&lt;/div&gt;&#39;
</span>
<span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_default_selector'><a href="Capybara.html#default_selector-class_method" title="Capybara.default_selector (method)">default_selector</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_css'>css</span>

<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>div</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_text'>text</span>     <span class='comment'># =&gt; &#39;Hello world&#39;
</span>
<span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_default_selector'><a href="Capybara.html#default_selector-class_method" title="Capybara.default_selector (method)">default_selector</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span>

<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//div</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_text'>text</span> <span class='comment'># =&gt; &#39;Hello world&#39;</span></code></pre>

<p>The locator argument&#39;s semantics are context-specific, and depend on the
selector. The types of arguments are varied. Some selectors support <code>String</code> or
<code>Regexp</code> arguments, while others like <code>:table_row</code> support <code>Array<String></code> and
<code>Hash&lt;String, String&gt;</code>:</p>

<pre class="code ruby"><code class="ruby">page.html # =&gt; &#39;&lt;label for=&quot;greeting&quot;&gt;Greeting&lt;/label&gt;
                &lt;input id=&quot;greeting&quot; name=&quot;content&quot;&gt;&#39;

# find by the &lt;input&gt; element&#39;s [id] attribute
page.find(:id, &#39;greeting&#39;) == page.find_by_id(&#39;greeting&#39;) # =&gt; true

# find by the &lt;input&gt; element&#39;s [id] attribute
page.find(:field, &#39;greeting&#39;) == page.find_field(&#39;greeting&#39;) # =&gt; true

# find by the &lt;input&gt; element&#39;s [name] attribute
page.find(:field, &#39;content&#39;) == page.find_field(&#39;content&#39;) # =&gt; true

# find by the &lt;label&gt; element&#39;s text
page.find(:field, &#39;Greeting&#39;) == page.find_field(&#39;Greeting&#39;) # =&gt; true

page.html # =&gt; &#39;&lt;table&gt;
                  &lt;tr&gt;
                    &lt;th&gt;A&lt;/th&gt;
                    &lt;th&gt;B&lt;/th&gt;
                  &lt;/tr&gt;
                  &lt;tr&gt;
                    &lt;td&gt;1&lt;/td&gt;
                    &lt;td&gt;2&lt;/td&gt;
                  &lt;/tr&gt;
                &lt;/table&gt;&#39;

# find by &lt;td&gt; content
page.find(:table_row, [&#39;1&#39;, &#39;2&#39;]) == page.find(:css, &#39;tr:last-of-type&#39;) # =&gt; true

# find by &lt;th&gt; content paired with corresponding &lt;td&gt; content
page.find(:table_row, &#39;A&#39; =&gt; &#39;1&#39;) == page.find(:table_row, &#39;B&#39; =&gt; &#39;2&#39;) # =&gt; true</code></pre>

<h3><a name="selectors-filters"></a> Filters</h3>

<p>All filters are optional. The supported set of keys is a mixture of both global
and context-specific filters.The supported types of values depend on the
context:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;&#39;
</span>
<span class='comment'># find by the [href] attribute
</span><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_link'>find_link</span>(<span class='label'>href:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>==</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_link'>find_link</span>(<span class='label'>text:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Home</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; true
</span>
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;div id=&quot;element&quot; data-attribute=&quot;value&quot;&gt;Content&lt;/div&gt;&#39;
</span>
<span class='comment'># find by the [id] attribute
</span><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>element</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>==</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='label'>text:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; true
</span>
<span class='comment'># find by the [data-attribute] attribute
</span><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_element'>element</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>data-attribute</span><span class='label_end'>&#39;:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>value</span><span class='regexp_end'>/</span></span>) <span class='op'>==</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='label'>text:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; true
</span>
<span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;input type=&quot;checkbox&quot;&gt;&#39;
</span>
<span class='comment'># find by the absence of the [checked] attribute
</span><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_field'>find_field</span>(<span class='label'>checked:</span> <span class='kw'>false</span>) <span class='op'>==</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_field'>find_field</span>(<span class='label'>unchecked:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; true</span></code></pre>

<p>The predicate block is always optional. When there are results for a selector
query, the block is called with each item in the result set. When the block
evaluates to true, the item is included from the result set. Otherwise, the item
is excluded:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_html'>html</span> <span class='comment'># =&gt; &#39;&lt;input role=&quot;switch&quot; type=&quot;checkbox&quot; checked&gt;&#39;
</span>
<span class='id identifier rubyid_switch'>switch</span> <span class='op'>=</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_field'>find_field</span> { <span class='op'>|</span><span class='id identifier rubyid_input'>input</span><span class='op'>|</span> <span class='id identifier rubyid_input'>input</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>role</span><span class='tstring_end'>&quot;</span></span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>switch</span><span class='tstring_end'>&quot;</span></span> }
<span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find_field'>find_field</span>(<span class='label'>checked:</span> <span class='kw'>true</span>)

<span class='id identifier rubyid_switch'>switch</span> <span class='op'>==</span> <span class='id identifier rubyid_field'>field</span> <span class='comment'># =&gt; true</span></code></pre>

<h2><a name="matching"></a>Matching</h2>

<p>It is possible to customize how Capybara finds elements. At your disposal
are two options, <code>Capybara.exact</code> and <code>Capybara.match</code>.</p>

<h3><a name="exactness"></a>Exactness</h3>

<p><code>Capybara.exact</code> and the <code>exact</code> option work together with the <code>is</code> expression
inside the XPath gem. When <code>exact</code> is true, all <code>is</code> expressions match exactly,
when it is false, they allow substring matches. Many of the selectors built into
Capybara use the <code>is</code> expression. This way you can specify whether you want to
allow substring matches or not. <code>Capybara.exact</code> is false by default.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># also matches &quot;Password confirmation&quot;
</span><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_exact'>exact</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># does not match &quot;Password confirmation&quot;
</span><span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>exact:</span> <span class='kw'>false</span>) <span class='comment'># can be overridden</span></code></pre>

<h3><a name="strategy"></a>Strategy</h3>

<p>Using <code>Capybara.match</code> and the equivalent <code>match</code> option, you can control how
Capybara behaves when multiple elements all match a query. There are currently
four different strategies built into Capybara:</p>

<ol>
<li><strong>first:</strong> Just picks the first element that matches.</li>
<li><strong>one:</strong> Raises an error if more than one element matches.</li>
<li><strong>smart:</strong> If <code>exact</code> is <code>true</code>, raises an error if more than one element
matches, just like <code>one</code>. If <code>exact</code> is <code>false</code>, it will first try to find
an exact match. An error is raised if more than one element is found. If no
element is found, a new search is performed which allows partial matches. If
that search returns multiple matches, an error is raised.</li>
<li><strong>prefer_exact:</strong> If multiple matches are found, some of which are exact,
and some of which are not, then the first exactly matching element is
returned.</li>
</ol>

<p>The default for <code>Capybara.match</code> is <code>:smart</code>. To emulate the behaviour in
Capybara 2.0.x, set <code>Capybara.match</code> to <code>:one</code>. To emulate the behaviour in
Capybara 1.x, set <code>Capybara.match</code> to <code>:prefer_exact</code>.</p>

<h2><a name="transactions-and-database-setup"></a>Transactions and database setup</h2>

<p><strong>Note:</strong>  Rails 5.1+ &quot;safely&quot; shares the database connection between the app and test threads.  Therefore,
if using Rails 5.1+ you SHOULD be able to ignore this section.</p>

<p>Some Capybara drivers need to run against an actual HTTP server. Capybara takes
care of this and starts one for you in the same process as your test, but on
another thread. Selenium is one of those drivers, whereas RackTest is not.</p>

<p>If you are using a SQL database, it is common to run every test in a
transaction, which is rolled back at the end of the test, rspec-rails does this
by default out of the box for example. Since transactions are usually not
shared across threads, this will cause data you have put into the database in
your test code to be invisible to Capybara.</p>

<p>Cucumber handles this by using truncation instead of transactions, i.e. they
empty out the entire database after each test. You can get the same behaviour
by using a gem such as <a href="https://github.com/DatabaseCleaner/database_cleaner">database_cleaner</a>.</p>

<h2><a name="asynchronous-javascript-ajax-and-friends"></a>Asynchronous JavaScript (Ajax and friends)</h2>

<p>When working with asynchronous JavaScript, you might come across situations
where you are attempting to interact with an element which is not yet present
on the page. Capybara automatically deals with this by waiting for elements
to appear on the page.</p>

<p>When issuing instructions to the DSL such as:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_click_link'>click_link</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_content'>have_content</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>If clicking on the <em>foo</em> link triggers an asynchronous process, such as
an Ajax request, which, when complete will add the <em>bar</em> link to the page,
clicking on the <em>bar</em> link would be expected to fail, since that link doesn&#39;t
exist yet. However, Capybara is smart enough to retry finding the link for a
brief period of time before giving up and throwing an error. The same is true of
the next line, which looks for the content <em>baz</em> on the page; it will retry
looking for that content for a brief time. You can adjust how long this period
is (the default is 2 seconds):</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_default_max_wait_time'><a href="Capybara.html#default_max_wait_time-class_method" title="Capybara.default_max_wait_time (method)">default_max_wait_time</a></span> <span class='op'>=</span> <span class='int'>5</span></code></pre>

<p>Be aware that because of this behaviour, the following two statements are <strong>not</strong>
equivalent, and you should <strong>always</strong> use the latter!</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Given use of a driver where the page is loaded when visit returns
</span><span class='comment'># and that Capybara.predicates_wait is `true`
</span><span class='comment'># consider a page where the `a` tag is removed through AJAX after 1s
</span><span class='id identifier rubyid_visit'>visit</span>(<span class='id identifier rubyid_some_path'>some_path</span>)
<span class='op'>!</span><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_has_xpath?'>has_xpath?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)  <span class='comment'># is false
</span><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_has_no_xpath?'>has_no_xpath?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)  <span class='comment'># is true</span></code></pre>

<p>First expression:</p>

<ul>
<li><code>has_xpath?(&#39;a&#39;)</code> is called right after <code>visit</code> returns. It is <code>true</code> because the link has not yet been removed</li>
<li>Capybara does not wait upon successful predicates/assertions, therefore <strong>has_xpath? returns <code>true</code> immediately</strong></li>
<li>The expression returns <code>false</code> (because it is negated with the leading <code>!</code>)</li>
</ul>

<p>Second expression:</p>

<ul>
<li><code>has_no_xpath?(&#39;a&#39;)</code> is called right after <code>visit</code> returns. It is <code>false</code> because the link has not yet been removed.</li>
<li>Capybara waits upon failed predicates/assertions, therefore <strong>has_no_xpath? does not return <code>false</code> immediately</strong></li>
<li>Capybara will periodically re-check the predicate/assertion up to the <code>default_max_wait_time</code> defined</li>
<li>after 1s, the predicate becomes <code>true</code> (because the link has been removed)</li>
<li>The expression returns <code>true</code></li>
</ul>

<p>Capybara&#39;s RSpec matchers, however, are smart enough to handle either form.
The two following statements are functionally equivalent:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_not_to'>not_to</span> <span class='id identifier rubyid_have_xpath'>have_xpath</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_page'>page</span>).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_no_xpath'>have_no_xpath</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>Capybara&#39;s waiting behaviour is quite advanced, and can deal with situations
such as the following line of code:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_expect'>expect</span>(<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#sidebar</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>h1</span><span class='tstring_end'>&#39;</span></span>)).<span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_content'>have_content</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Something</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>Even if JavaScript causes <code>#sidebar</code> to disappear off the page, Capybara
will automatically reload it and any elements it contains. So if an AJAX
request causes the contents of <code>#sidebar</code> to change, which would update
the text of the <code>h1</code> to &quot;Something&quot;, and this happened, this test would
pass. If you do not want this behaviour, you can set
<code>Capybara.automatic_reload</code> to <code>false</code>.</p>

<h2><a name="using-the-dsl-elsewhere"></a>Using the DSL elsewhere</h2>

<p>You can mix the DSL into any context by including <a href="Capybara/DSL.html" title="Capybara::DSL (module)"><code>DSL</code></a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara/dsl</span><span class='tstring_end'>&#39;</span></span>

<span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_default_driver'><a href="Capybara.html#default_driver-class_method" title="Capybara.default_driver (method)">default_driver</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_webkit'>webkit</span>

<span class='kw'>module</span> <span class='const'>MyModule</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/DSL.html" title="Capybara::DSL (module)">DSL</a></span>

  <span class='kw'>def</span> <span class='id identifier rubyid_login!'>login!</span>
    <span class='id identifier rubyid_within'>within</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.//form[@id=&#39;session&#39;]</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user@example.com</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sign in</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>This enables its use in unsupported testing frameworks, and for general-purpose scripting.</p>

<h2><a name="calling-remote-servers"></a>Calling remote servers</h2>

<p>Normally Capybara expects to be testing an in-process Rack application, but you
can also use it to talk to a web server running anywhere on the internet, by
setting app_host:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_current_driver'><a href="Capybara.html#current_driver-class_method" title="Capybara.current_driver (method)">current_driver</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_selenium'>selenium</span>
<span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_app_host'><a href="Capybara.html#app_host-class_method" title="Capybara.app_host (method)">app_host</a></span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://www.google.com</span><span class='tstring_end'>&#39;</span></span>
<span class='comment'>#...
</span><span class='id identifier rubyid_visit'>visit</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p><strong>Note</strong>: the default driver (<code>:rack_test</code>) does not support running
against a remote server. With drivers that support it, you can also visit any
URL directly:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_visit'>visit</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://www.google.com</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>By default Capybara will try to boot a rack application automatically. You
might want to switch off Capybara&#39;s rack server if you are running against a
remote application:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_run_server'>run_server</span> <span class='op'>=</span> <span class='kw'>false</span></code></pre>

<h2><a name="using-sessions"></a>Using sessions</h2>

<p>Capybara manages named sessions (:default if not specified) allowing multiple sessions using the same driver and test app instance to be interacted with.
A new session will be created using the current driver if a session with the given name using the current driver and test app instance is not found.</p>

<h3>Named sessions</h3>

<p>To perform operations in a different session and then revert to the previous session</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_using_session'><a href="Capybara.html#using_session-class_method" title="Capybara.using_session (method)">using_session</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bob&#39;s session</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
   <span class='comment'>#do something in Bob&#39;s browser session
</span><span class='kw'>end</span>
 <span class='comment'>#reverts to previous session</span></code></pre>

<p>To permanently switch the current session to a different session</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_session_name'><a href="Capybara.html#session_name-class_method" title="Capybara.session_name (method)">session_name</a></span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>some other session</span><span class='tstring_end'>&quot;</span></span></code></pre>

<h3><a name="using-sessions-manually"></a>Using sessions manually</h3>

<p>For ultimate control, you can instantiate and use a
<a href="http://rubydoc.info/github/teamcapybara/capybara/master/Capybara/Session">Session</a>
manually.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capybara</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Session.html" title="Capybara::Session (class)">Session</a></span>.<span class='id identifier rubyid_new'><a href="Capybara/Session.html#new-class_method" title="Capybara::Session.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_webkit'>webkit</span><span class='comma'>,</span> <span class='id identifier rubyid_my_rack_app'>my_rack_app</span>)
<span class='id identifier rubyid_session'>session</span>.<span class='id identifier rubyid_within'>within</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>form#session</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_session'>session</span>.<span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user@example.com</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_session'>session</span>.<span class='id identifier rubyid_fill_in'>fill_in</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Password</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
<span class='id identifier rubyid_session'>session</span>.<span class='id identifier rubyid_click_button'>click_button</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sign in</span><span class='tstring_end'>&#39;</span></span></code></pre>

<h2><a name="xpath-css-and-selectors"></a>XPath, CSS and selectors</h2>

<p>Capybara does not try to guess what kind of selector you are going to give it,
and will always use CSS by default.  If you want to use XPath, you&#39;ll need to
do:</p>

<pre class="code ruby"><code class="ruby">within(:xpath, &#39;.//ul/li&#39;) { ... }
find(:xpath, &#39;.//ul/li&#39;).text
find(:xpath, &#39;.//li[contains(.//a[@href = &quot;#&quot;]/text(), &quot;foo&quot;)]&#39;).value</code></pre>

<p>Alternatively you can set the default selector to XPath:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_default_selector'><a href="Capybara.html#default_selector-class_method" title="Capybara.default_selector (method)">default_selector</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span>
<span class='id identifier rubyid_find'>find</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//ul/li</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_text'>text</span></code></pre>

<p>Capybara provides a number of other built-in selector types. The full list, along
with applicable filters, can be seen at <a href="https://www.rubydoc.info/github/teamcapybara/capybara/Capybara/Selector">built-in selectors</a></p>

<p>Capybara also allows you to add custom selectors, which can be very useful if you
find yourself using the same kinds of selectors very often. The examples below are very
simple, and there are many available features not demonstrated. For more in-depth examples
please see Capybaras built-in selector definitions.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_add_selector'><a href="Capybara.html#add_selector-class_method" title="Capybara.add_selector (method)">add_selector</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_my_attribute'>my_attribute</span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_xpath'>xpath</span> { <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span> <span class='const'><a href="XPath.html" title="XPath (module)">XPath</a></span>.<span class='id identifier rubyid_descendant'>descendant</span>[<span class='const'><a href="XPath.html" title="XPath (module)">XPath</a></span>.<span class='id identifier rubyid_attr'>attr</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_my_attribute'>my_attribute</span>) <span class='op'>==</span> <span class='id identifier rubyid_id'>id</span>.<span class='id identifier rubyid_to_s'>to_s</span>] }
<span class='kw'>end</span>

<span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_add_selector'><a href="Capybara.html#add_selector-class_method" title="Capybara.add_selector (method)">add_selector</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_row'>row</span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_xpath'>xpath</span> { <span class='op'>|</span><span class='id identifier rubyid_num'>num</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.//tbody/tr[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_num'>num</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span> }
<span class='kw'>end</span>

<span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_add_selector'><a href="Capybara.html#add_selector-class_method" title="Capybara.add_selector (method)">add_selector</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_flash_type'>flash_type</span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_css'>css</span> { <span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#flash.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }
<span class='kw'>end</span></code></pre>

<p>The block given to xpath must always return an XPath expression as a String, or
an XPath expression generated through the XPath gem. You can now use these
selectors like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_my_attribute'>my_attribute</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>post_123</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># find element with matching attribute
</span><span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='int'>3</span>) <span class='comment'># find 3rd row in table body
</span><span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_flash_type'>flash_type</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_notice'>notice</span>) <span class='comment'># find element with id of &#39;flash&#39; and class of &#39;notice&#39;</span></code></pre>

<h2><a name="beware-the-xpath--trap"></a>Beware the XPath // trap</h2>

<p>In XPath the expression // means something very specific, and it might not be what
you think. Contrary to common belief, // means &quot;anywhere in the document&quot; not &quot;anywhere
in the current context&quot;. As an example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//body</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_all'>all</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//script</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>You might expect this to find all script tags in the body, but actually, it finds all
script tags in the entire document, not only those in the body! What you&#39;re looking
for is the .// expression which means &quot;any descendant of the current node&quot;:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//body</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_all'>all</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//script</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>The same thing goes for within:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_within'>within</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//body</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_page'>page</span>.<span class='id identifier rubyid_find'>find</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//script</span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_within'>within</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_xpath'>xpath</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.//table/tbody</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span>
  <span class='comment'>#...
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<h2><a name="configuring-and-adding-drivers"></a>Configuring and adding drivers</h2>

<p>Capybara makes it convenient to switch between different drivers. It also exposes
an API to tweak those drivers with whatever settings you want, or to add your own
drivers. This is how to override the selenium driver configuration to use chrome:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_register_driver'><a href="Capybara.html#register_driver-class_method" title="Capybara.register_driver (method)">register_driver</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_selenium'>selenium</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span><span class='op'>|</span>
  <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Selenium.html" title="Capybara::Selenium (module)">Selenium</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Selenium/Driver.html" title="Capybara::Selenium::Driver (class)">Driver</a></span>.<span class='id identifier rubyid_new'><a href="Capybara/Selenium/Driver.html#new-class_method" title="Capybara::Selenium::Driver.new (method)">new</a></span>(<span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_browser'>browser</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_chrome'>chrome</span>)
<span class='kw'>end</span></code></pre>

<p>However, it&#39;s also possible to give this configuration a different name.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Note: Capybara registers this by default
</span><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_register_driver'><a href="Capybara.html#register_driver-class_method" title="Capybara.register_driver (method)">register_driver</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_selenium_chrome'>selenium_chrome</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span><span class='op'>|</span>
  <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Selenium.html" title="Capybara::Selenium (module)">Selenium</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Selenium/Driver.html" title="Capybara::Selenium::Driver (class)">Driver</a></span>.<span class='id identifier rubyid_new'><a href="Capybara/Selenium/Driver.html#new-class_method" title="Capybara::Selenium::Driver.new (method)">new</a></span>(<span class='id identifier rubyid_app'><a href="Capybara.html#app-class_method" title="Capybara.app (method)">app</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_browser'>browser</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_chrome'>chrome</span>)
<span class='kw'>end</span></code></pre>

<p>Then tests can switch between using different browsers effortlessly:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_current_driver'><a href="Capybara.html#current_driver-class_method" title="Capybara.current_driver (method)">current_driver</a></span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_selenium_chrome'>selenium_chrome</span></code></pre>

<p>Whatever is returned from the block should conform to the API described by
Capybara::Driver::Base, it does not however have to inherit from this class.
Gems can use this API to add their own drivers to Capybara.</p>

<p>The <a href="https://github.com/SeleniumHQ/selenium/wiki/Ruby-Bindings">Selenium wiki</a> has
additional info about how the underlying driver can be configured.</p>

<h2><a name="gotchas"></a>Gotchas:</h2>

<ul>
<li><p>Access to session and request is not possible from the test, Access to
response is limited. Some drivers allow access to response headers and HTTP
status code, but this kind of functionality is not provided by some drivers,
such as Selenium.</p></li>
<li><p>Access to Rails specific stuff (such as <code>controller</code>) is unavailable,
since we&#39;re not using Rails&#39; integration testing.</p></li>
<li><p>Freezing time: It&#39;s common practice to mock out the Time so that features
that depend on the current Date work as expected. This can be problematic on
ruby/platform combinations that don&#39;t support access to a monotonic process clock,
since Capybara&#39;s Ajax timing uses the system time, resulting in Capybara
never timing out and just hanging when a failure occurs. It&#39;s still possible to
use gems which allow you to travel in time, rather than freeze time.
One such gem is <a href="https://github.com/travisjeffery/timecop">Timecop</a>.</p></li>
<li><p>When using Rack::Test, beware if attempting to visit absolute URLs. For
example, a session might not be shared between visits to <code>posts_path</code>
and <code>posts_url</code>. If testing an absolute URL in an Action Mailer email,
set <code>default_url_options</code> to match the Rails default of
<code>www.example.com</code>.</p></li>
<li><p>Server errors will only be raised in the session that initiates the server thread. If you
are testing for specific server errors and using multiple sessions make sure to test for the
errors using the initial session (usually :default)</p></li>
<li><p>If WebMock is enabled, you may encounter a &quot;Too many open files&quot;
error. A simple <code>page.find</code> call may cause thousands of HTTP requests
until the timeout occurs. By default, WebMock will cause each of these
requests to spawn a new connection. To work around this problem, you
may need to [enable WebMock&#39;s <code>net_http_connect_on_start: true</code>
parameter]#connecting-on-nethttpstart).</p></li>
</ul>

<h2><a name="threadsafe"></a>&quot;Threadsafe&quot; mode</h2>

<p>In normal mode most of Capybara&#39;s configuration options are global settings which can cause issues
if using multiple sessions and wanting to change a setting for only one of the sessions.  To provide
support for this type of usage Capybara now provides a &quot;threadsafe&quot; mode which can be enabled by setting</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_threadsafe'><a href="Capybara.html#threadsafe-class_method" title="Capybara.threadsafe (method)">threadsafe</a></span> <span class='op'>=</span> <span class='kw'>true</span></code></pre>

<p>This setting can only be changed before any sessions have been created.  In &quot;threadsafe&quot; mode the following
behaviors of Capybara change</p>

<ul>
<li>Most options can now be set on a session.  These can either be set at session creation time or after, and
default to the global options at the time of session creation.  Options which are NOT session specific are
<code>app</code>, <code>reuse_server</code>, <code>default_driver</code>, <code>javascript_driver</code>, and (obviously) <code>threadsafe</code>.  Any drivers and servers
registered through <code>register_driver</code> and <code>register_server</code> are also global.</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_my_session'>my_session</span> <span class='op'>=</span> <span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span><span class='op'>::</span><span class='const'><a href="Capybara/Session.html" title="Capybara::Session (class)">Session</a></span>.<span class='id identifier rubyid_new'><a href="Capybara/Session.html#new-class_method" title="Capybara::Session.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_driver'>driver</span><span class='comma'>,</span> <span class='id identifier rubyid_some_app'>some_app</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_config'><a href="Capybara.html#config-class_method" title="Capybara.config (method)">config</a></span><span class='op'>|</span>
  <span class='id identifier rubyid_config'><a href="Capybara.html#config-class_method" title="Capybara.config (method)">config</a></span>.<span class='id identifier rubyid_automatic_label_click'>automatic_label_click</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='comment'># only set for my_session
</span><span class='kw'>end</span>
<span class='id identifier rubyid_my_session'>my_session</span>.<span class='id identifier rubyid_config'><a href="Capybara.html#config-class_method" title="Capybara.config (method)">config</a></span>.<span class='id identifier rubyid_default_max_wait_time'><a href="Capybara.html#default_max_wait_time-class_method" title="Capybara.default_max_wait_time (method)">default_max_wait_time</a></span> <span class='op'>=</span> <span class='int'>10</span> <span class='comment'># only set for my_session
</span><span class='const'><a href="Capybara.html" title="Capybara (module)">Capybara</a></span>.<span class='id identifier rubyid_default_max_wait_time'><a href="Capybara.html#default_max_wait_time-class_method" title="Capybara.default_max_wait_time (method)">default_max_wait_time</a></span> <span class='op'>=</span> <span class='int'>2</span> <span class='comment'># will not change the default_max_wait in my_session</span></code></pre>

<ul>
<li><code>current_driver</code> and <code>session_name</code> are thread specific.  This means that <code>using_session</code> and
<code>using_driver</code> also only affect the current thread.</li>
</ul>

<h2><a name="development"></a>Development</h2>

<p>To set up a development environment, simply do:</p>

<pre class="code bash"><code class="bash">bundle install
bundle exec rake  # run the test suite with Firefox - requires `geckodriver` to be installed
bundle exec rake spec_chrome # run the test suite with Chrome - require `chromedriver` to be installed
</code></pre>

<p>See
[CONTRIBUTING.md])
for how to send issues and pull requests.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>