<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Capybara::Selenium::Node::Html5Drag &mdash; Capybara master</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Capybara::Selenium::Node::Html5Drag",
    relpath = '../../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../'>Capybara master</a> &raquo; 
      <a href='../../../_index.html#alpha_H'>Index (H)</a> &raquo; 
        <a href="../../../Capybara.html" title="Capybara (module)">Capybara</a> &raquo; 
        <a href="../../Selenium.html" title="Capybara::Selenium (module)">Selenium</a> &raquo; 
        <a href="../Node.html" title="Capybara::Selenium::Node (class)">Node</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Html5Drag&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Capybara::Selenium::Node::Html5Drag</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L4'>lib/capybara/selenium/extensions/html5_drag.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ATTACH_FILE-constant' class='summary_signature'>ATTACH_FILE =</span>
    <br/>
    <a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L86-L95'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 86</a>    <pre class='code ruby'><span class='heredoc_beg'>&lt;&lt;~JS</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>(function(){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var input = document.createElement(&#39;INPUT&#39;);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  input.type = &quot;file&quot;;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  input.id = &quot;_capybara_drop_file&quot;;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  input.multiple = true;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  document.body.appendChild(input);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  return input;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>})()
</span><span class='heredoc_end'>JS</span></pre>
  </li>
  <li>
    <span id='DROP_FILE-constant' class='summary_signature'>DROP_FILE =</span>
    <br/>
    <a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L65-L84'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 65</a>    <pre class='code ruby'><span class='heredoc_beg'>&lt;&lt;~JS</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>var el = arguments[0],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    input = arguments[1],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    files = input.files,
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    dt = new DataTransfer(),
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    opts = { cancelable: true, bubbles: true, dataTransfer: dt };
</span><span class='ignored_sp'>  </span><span class='tstring_content'>input.parentElement.removeChild(input);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>if (dt.items){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  for (var i=0; i&lt;files.length; i++){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    dt.items.add(files[i]);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  }
</span><span class='ignored_sp'>  </span><span class='tstring_content'>} else {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  Object.defineProperty(dt, &quot;files&quot;, {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    value: files,
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    writable: false
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  });
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='ignored_sp'>  </span><span class='tstring_content'>var dropEvent = new DragEvent(&#39;drop&#39;, opts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>el.dispatchEvent(dropEvent);
</span><span class='heredoc_end'>JS</span></pre>
  </li>
  <li>
    <span id='DROP_STRING-constant' class='summary_signature'>DROP_STRING =</span>
    <br/>
    <a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L49-L63'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 49</a>    <pre class='code ruby'><span class='heredoc_beg'>&lt;&lt;~JS</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>var strings = arguments[0],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    el = arguments[1],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    dt = new DataTransfer(),
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    opts = { cancelable: true, bubbles: true, dataTransfer: dt };
</span><span class='ignored_sp'>  </span><span class='tstring_content'>for (var i=0; i &lt; strings.length; i++){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  if (dt.items) {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    dt.items.add(strings[i][&#39;data&#39;], strings[i][&#39;type&#39;]);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  } else {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    dt.setData(strings[i][&#39;type&#39;], strings[i][&#39;data&#39;]);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  }
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='ignored_sp'>  </span><span class='tstring_content'>var dropEvent = new DragEvent(&#39;drop&#39;, opts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>el.dispatchEvent(dropEvent);
</span><span class='heredoc_end'>JS</span></pre>
  </li>
  <li>
    <span id='HTML5_DRAG_DROP_SCRIPT-constant' class='summary_signature'>HTML5_DRAG_DROP_SCRIPT =</span>
    <br/>
    <a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L117-L227'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 117</a>    <pre class='code ruby'><span class='heredoc_beg'>&lt;&lt;~JS</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>function rectCenter(rect){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  return new DOMPoint(
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    (rect.left + rect.right)/2,
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    (rect.top + rect.bottom)/2
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  );
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>function pointOnRect(pt, rect) {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	var rectPt = rectCenter(rect);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	var slope = (rectPt.y - pt.y) / (rectPt.x - pt.x);
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	if (pt.x &lt;= rectPt.x) { // left side
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		var minXy = slope * (rect.left - pt.x) + pt.y;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		if (rect.top &lt;= minXy &amp;&amp; minXy &lt;= rect.bottom)
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      return new DOMPoint(rect.left, minXy);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	if (pt.x &gt;= rectPt.x) { // right side
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		var maxXy = slope * (rect.right - pt.x) + pt.y;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		if (rect.top &lt;= maxXy &amp;&amp; maxXy &lt;= rect.bottom)
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      return new DOMPoint(rect.right, maxXy);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	if (pt.y &lt;= rectPt.y) { // top side
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		var minYx = (rectPt.top - pt.y) / slope + pt.x;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		if (rect.left &lt;= minYx &amp;&amp; minYx &lt;= rect.right)
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      return new DOMPoint(minYx, rect.top);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	if (pt.y &gt;= rectPt.y) { // bottom side
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		var maxYx = (rect.bottom - pt.y) / slope + pt.x;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>		if (rect.left &lt;= maxYx &amp;&amp; maxYx &lt;= rect.right)
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      return new DOMPoint(maxYx, rect.bottom);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>	}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  return new DOMPoint(pt.x,pt.y);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>function dragEnterTarget() {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  target.scrollIntoView({behavior: &#39;instant&#39;, block: &#39;center&#39;, inline: &#39;center&#39;});
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var targetRect = target.getBoundingClientRect();
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var sourceCenter = rectCenter(source.getBoundingClientRect());
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  for (var i = 0; i &lt; drop_modifier_keys.length; i++) {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    key = drop_modifier_keys[i];
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    if (key == &quot;control&quot;){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>      key = &quot;ctrl&quot;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    }
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    opts[key + &#39;Key&#39;] = true;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  }
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragEnterEvent = new DragEvent(&#39;dragenter&#39;, opts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  target.dispatchEvent(dragEnterEvent);
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  // fire 2 dragover events to simulate dragging with a direction
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var entryPoint = pointOnRect(sourceCenter, targetRect)
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragOverOpts = Object.assign({clientX: entryPoint.x, clientY: entryPoint.y}, opts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragOverEvent = new DragEvent(&#39;dragover&#39;, dragOverOpts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  target.dispatchEvent(dragOverEvent);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  window.setTimeout(dragOnTarget, step_delay);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>function dragOnTarget() {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var targetCenter = rectCenter(target.getBoundingClientRect());
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragOverOpts = Object.assign({clientX: targetCenter.x, clientY: targetCenter.y}, opts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragOverEvent = new DragEvent(&#39;dragover&#39;, dragOverOpts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  target.dispatchEvent(dragOverEvent);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  window.setTimeout(dragLeave, step_delay, dragOverEvent.defaultPrevented, dragOverOpts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>function dragLeave(drop, dragOverOpts) {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragLeaveOptions = Object.assign({}, opts, dragOverOpts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragLeaveEvent = new DragEvent(&#39;dragleave&#39;, dragLeaveOptions);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  target.dispatchEvent(dragLeaveEvent);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  if (drop) {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    var dropEvent = new DragEvent(&#39;drop&#39;, dragLeaveOptions);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    target.dispatchEvent(dropEvent);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  }
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  var dragEndEvent = new DragEvent(&#39;dragend&#39;, dragLeaveOptions);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  source.dispatchEvent(dragEndEvent);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  callback.call(true);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>var source = arguments[0],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    target = arguments[1],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    step_delay = arguments[2],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    drop_modifier_keys = arguments[3],
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    callback = arguments[4];
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>var dt = new DataTransfer();
</span><span class='ignored_sp'>  </span><span class='tstring_content'>var opts = { cancelable: true, bubbles: true, dataTransfer: dt };
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>while (source &amp;&amp; !source.draggable) {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  source = source.parentElement;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>if (source.tagName == &#39;A&#39;){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  dt.setData(&#39;text/uri-list&#39;, source.href);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  dt.setData(&#39;text&#39;, source.href);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='ignored_sp'>  </span><span class='tstring_content'>if (source.tagName == &#39;IMG&#39;){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  dt.setData(&#39;text/uri-list&#39;, source.src);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  dt.setData(&#39;text&#39;, source.src);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>var dragEvent = new DragEvent(&#39;dragstart&#39;, opts);
</span><span class='ignored_sp'>  </span><span class='tstring_content'>source.dispatchEvent(dragEvent);
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>window.setTimeout(dragEnterTarget, step_delay);
</span><span class='heredoc_end'>JS</span></pre>
  </li>
  <li>
    <span id='LEGACY_DRAG_CHECK-constant' class='summary_signature'>LEGACY_DRAG_CHECK =</span>
    <br/>
    <a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L104-L115'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 104</a>    <pre class='code ruby'><span class='heredoc_beg'>&lt;&lt;~JS</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>(function(el){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  if ([true, null].indexOf(window.capybara_mousedown_prevented) &gt;= 0){
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    return true;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  }
</span><span class='tstring_content'>
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  do {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>    if (el.draggable) return false;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  } while (el = el.parentElement );
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  return true;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>})(arguments[0])
</span><span class='heredoc_end'>JS</span></pre>
  </li>
  <li>
    <span id='MOUSEDOWN_TRACKER-constant' class='summary_signature'>MOUSEDOWN_TRACKER =</span>
    <br/>
    <a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L97-L102'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 97</a>    <pre class='code ruby'><span class='heredoc_beg'>&lt;&lt;~JS</span>
<span class='ignored_sp'>  </span><span class='tstring_content'>window.capybara_mousedown_prevented = null;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>document.addEventListener(&#39;mousedown&#39;, ev =&gt; {
</span><span class='ignored_sp'>  </span><span class='tstring_content'>  window.capybara_mousedown_prevented = ev.defaultPrevented;
</span><span class='ignored_sp'>  </span><span class='tstring_content'>}, { once: true, passive: true })
</span><span class='heredoc_end'>JS</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#drag_to-instance_method" title="#drag_to (instance method)">#<strong>drag_to</strong>(element, html5: nil, delay: 0.05, drop_modifiers: [])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Implement methods to emulate HTML5 drag and drop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#html5_drop-instance_method" title="#html5_drop (instance method)">#<strong>html5_drop</strong>(*args)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#perform_html5_drag-instance_method" title="#perform_html5_drag (instance method)">#<strong>perform_html5_drag</strong>(element, delay, drop_modifiers)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#perform_legacy_drag-instance_method" title="#perform_legacy_drag (instance method)">#<strong>perform_legacy_drag</strong>(element, drop_modifiers)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="drag_to-instance_method">
  <h3 class='signature  first'>
    #<strong>drag_to</strong>(element, html5: nil, delay: 0.05, drop_modifiers: [])  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Implement methods to emulate HTML5 drag and drop</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L7-L18'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='7' data-end='18'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 7</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_drag_to'>drag_to</span>(<span class='id identifier rubyid_element'>element</span><span class='comma'>,</span> <span class='label'>html5:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>delay:</span> <span class='float'>0.05</span><span class='comma'>,</span> <span class='label'>drop_modifiers:</span> [])
  <span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span> <span class='op'>=</span> <span class='const'>Array</span>(<span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)

  <span class='id identifier rubyid_driver'>driver</span>.<span class='id identifier rubyid_execute_script'>execute_script</span> <span class='const'><a href="#MOUSEDOWN_TRACKER-constant" title="Capybara::Selenium::Node::Html5Drag::MOUSEDOWN_TRACKER (constant)">MOUSEDOWN_TRACKER</a></span>
  <span class='id identifier rubyid_scroll_if_needed'>scroll_if_needed</span> { <span class='id identifier rubyid_browser_action'><a href="../Node.html#browser_action-instance_method" title="Capybara::Selenium::Node#browser_action (method)">browser_action</a></span>.<span class='id identifier rubyid_click_and_hold'>click_and_hold</span>(<span class='id identifier rubyid_native'>native</span>).<span class='id identifier rubyid_perform'>perform</span> }
  <span class='id identifier rubyid_html5'>html5</span> <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_driver'>driver</span>.<span class='id identifier rubyid_evaluate_script'>evaluate_script</span>(<span class='const'><a href="#LEGACY_DRAG_CHECK-constant" title="Capybara::Selenium::Node::Html5Drag::LEGACY_DRAG_CHECK (constant)">LEGACY_DRAG_CHECK</a></span><span class='comma'>,</span> <span class='kw'>self</span>) <span class='kw'>if</span> <span class='id identifier rubyid_html5'>html5</span>.<span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_html5'>html5</span>
    <span class='id identifier rubyid_perform_html5_drag'><a href="#perform_html5_drag-instance_method" title="Capybara::Selenium::Node::Html5Drag#perform_html5_drag (method)">perform_html5_drag</a></span>(<span class='id identifier rubyid_element'>element</span><span class='comma'>,</span> <span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_perform_legacy_drag'><a href="#perform_legacy_drag-instance_method" title="Capybara::Selenium::Node::Html5Drag#perform_legacy_drag (method)">perform_legacy_drag</a></span>(<span class='id identifier rubyid_element'>element</span><span class='comma'>,</span> <span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="html5_drop-instance_method">
  <h3 class='signature priv'>
    #<strong>html5_drop</strong>(*args)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L36-L47'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='36' data-end='47'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 36</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_html5_drop'>html5_drop</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>].<span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>String</span>
    <span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='id identifier rubyid_driver'>driver</span>.<span class='id identifier rubyid_evaluate_script'>evaluate_script</span> <span class='const'><a href="#ATTACH_FILE-constant" title="Capybara::Selenium::Node::Html5Drag::ATTACH_FILE (constant)">ATTACH_FILE</a></span>
    <span class='id identifier rubyid_input'>input</span>.<span class='id identifier rubyid_set_file'><a href="../Node.html#set_file-instance_method" title="Capybara::Selenium::Node#set_file (method)">set_file</a></span>(<span class='id identifier rubyid_args'>args</span>)
    <span class='id identifier rubyid_driver'>driver</span>.<span class='id identifier rubyid_execute_script'>execute_script</span> <span class='const'><a href="#DROP_FILE-constant" title="Capybara::Selenium::Node::Html5Drag::DROP_FILE (constant)">DROP_FILE</a></span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_items'>items</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='id identifier rubyid_arg'>arg</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span>(<span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span>)<span class='op'>|</span> { <span class='label'>type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='label'>data:</span> <span class='id identifier rubyid_data'>data</span> } }
    <span class='kw'>end</span>
    <span class='id identifier rubyid_driver'>driver</span>.<span class='id identifier rubyid_execute_script'>execute_script</span> <span class='const'><a href="#DROP_STRING-constant" title="Capybara::Selenium::Node::Html5Drag::DROP_STRING (constant)">DROP_STRING</a></span><span class='comma'>,</span> <span class='id identifier rubyid_items'>items</span><span class='comma'>,</span> <span class='kw'>self</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="perform_html5_drag-instance_method">
  <h3 class='signature priv'>
    #<strong>perform_html5_drag</strong>(element, delay, drop_modifiers)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L31-L34'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='31' data-end='34'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 31</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_perform_html5_drag'>perform_html5_drag</span>(<span class='id identifier rubyid_element'>element</span><span class='comma'>,</span> <span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)
  <span class='id identifier rubyid_driver'>driver</span>.<span class='id identifier rubyid_evaluate_async_script'>evaluate_async_script</span> <span class='const'><a href="#HTML5_DRAG_DROP_SCRIPT-constant" title="Capybara::Selenium::Node::Html5Drag::HTML5_DRAG_DROP_SCRIPT (constant)">HTML5_DRAG_DROP_SCRIPT</a></span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_element'>element</span><span class='comma'>,</span> <span class='id identifier rubyid_delay'>delay</span> <span class='op'>*</span> <span class='int'>1000</span><span class='comma'>,</span> <span class='id identifier rubyid_normalize_keys'><a href="../Node.html#normalize_keys-instance_method" title="Capybara::Selenium::Node#normalize_keys (method)">normalize_keys</a></span>(<span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)
  <span class='id identifier rubyid_browser_action'><a href="../Node.html#browser_action-instance_method" title="Capybara::Selenium::Node#browser_action (method)">browser_action</a></span>.<span class='id identifier rubyid_release'>release</span>.<span class='id identifier rubyid_perform'>perform</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="perform_legacy_drag-instance_method">
  <h3 class='signature priv'>
    #<strong>perform_legacy_drag</strong>(element, drop_modifiers)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selenium/extensions/html5_drag.rb#L22-L29'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='22' data-end='29'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/capybara/selenium/extensions/html5_drag.rb', line 22</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_perform_legacy_drag'>perform_legacy_drag</span>(<span class='id identifier rubyid_element'>element</span><span class='comma'>,</span> <span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)
  <span class='id identifier rubyid_element'>element</span>.<span class='id identifier rubyid_scroll_if_needed'>scroll_if_needed</span> <span class='kw'>do</span>
    <span class='comment'># browser_action.move_to(element.native).release.perform
</span>    <span class='id identifier rubyid_keys_down'>keys_down</span> <span class='op'>=</span> <span class='id identifier rubyid_modifiers_down'><a href="../Node.html#modifiers_down-instance_method" title="Capybara::Selenium::Node#modifiers_down (method)">modifiers_down</a></span>(<span class='id identifier rubyid_browser_action'><a href="../Node.html#browser_action-instance_method" title="Capybara::Selenium::Node#browser_action (method)">browser_action</a></span><span class='comma'>,</span> <span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)
    <span class='id identifier rubyid_keys_up'>keys_up</span> <span class='op'>=</span> <span class='id identifier rubyid_modifiers_up'><a href="../Node.html#modifiers_up-instance_method" title="Capybara::Selenium::Node#modifiers_up (method)">modifiers_up</a></span>(<span class='id identifier rubyid_keys_down'>keys_down</span>.<span class='id identifier rubyid_move_to'>move_to</span>(<span class='id identifier rubyid_element'>element</span>.<span class='id identifier rubyid_native'>native</span>).<span class='id identifier rubyid_release'>release</span><span class='comma'>,</span> <span class='id identifier rubyid_drop_modifiers'>drop_modifiers</span>)
    <span class='id identifier rubyid_keys_up'>keys_up</span>.<span class='id identifier rubyid_perform'>perform</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>