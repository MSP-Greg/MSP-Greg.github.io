<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongoid::Association::Referenced::HasMany::Proxy &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongoid::Association::Referenced::HasMany::Proxy",
    relpath = '../../../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../../'>Mongoid master</a> &raquo; 
      <a href='../../../../_index.html#alpha_P'>Index (P)</a> &raquo; 
        <a href="../../../../Mongoid.html" title="Mongoid (module)">Mongoid</a> &raquo; 
        <a href="../../../Association.html" title="Mongoid::Association (module)">Association</a> &raquo; 
        <a href="../../Referenced.html" title="Mongoid::Association::Referenced (module)">Referenced</a> &raquo; 
        <a href="../HasMany.html" title="Mongoid::Association::Referenced::HasMany (class)">HasMany</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Proxy&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongoid::Association::Referenced::HasMany::Proxy</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="Proxy/ClassMethods.html" title="Mongoid::Association::Referenced::HasMany::Proxy::ClassMethods (module)"><code>ClassMethods</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Subclasses:</div>
        <div class='box_22'>
          <a href="../HasAndBelongsToMany/Proxy.html" title="Mongoid::Association::Referenced::HasAndBelongsToMany::Proxy (class)">Mongoid::Association::Referenced::HasAndBelongsToMany::Proxy</a>
        </div>
      </td>
    </tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="Proxy/ClassMethods.html" title="Mongoid::Association::Referenced::HasMany::Proxy::ClassMethods (module)"><code>ClassMethods</code></a>,
          Forwardable,
          <a href="../../Many.html" title="Mongoid::Association::Many (class)"><code>::Mongoid::Association::Many</code></a>,
          Forwardable,
          <a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)"><code>::Mongoid::Association::Proxy</code></a>,
          Forwardable
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="../../Many.html" title="Mongoid::Association::Many (class)"><code>::Mongoid::Association::Many</code></a>,
          Enumerable,
          <a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)"><code>::Mongoid::Association::Proxy</code></a>,
          <a href="../../Marshalable.html" title="Mongoid::Association::Marshalable (module)"><code>::Mongoid::Association::Marshalable</code></a>,
          <a href="../../../Threaded/Lifecycle.html" title="Mongoid::Threaded::Lifecycle (module)"><code>::Mongoid::Threaded::Lifecycle</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../../Many.html" title="Mongoid::Association::Many (class)">Mongoid::Association::Many</a></span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)">Mongoid::Association::Proxy</a></li>
          <li class='next'><a href="../../Many.html" title="Mongoid::Association::Many (class)">Mongoid::Association::Many</a></li>
          <li class='next'>Mongoid::Association::Referenced::HasMany::Proxy</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L13'>lib/mongoid/association/referenced/has_many/proxy.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Transparent proxy for has_many associations. An instance of this class is returned when calling the association getter method on the subject document. This class inherits from Mongoid::Association::Proxy and forwards most of its methods to the target of the association, i.e. the array of documents on the opposite-side collection which must be loaded.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
  <h3 class='inherited'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)"><code>::Mongoid::Association::Proxy</code></a> - Inherited</h3>
  <p  class='inherited'>
    <a href="../../Proxy.html#KEEPER_METHODS-constant" title="Mongoid::Association::Proxy::KEEPER_METHODS (constant)">KEEPER_METHODS</a>
  </p>
</div>

<h2 class='h2_sum' id='class_Attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="Proxy/ClassMethods.html" title="Mongoid::Association::Referenced::HasMany::Proxy::ClassMethods (module)"><code>ClassMethods</code></a> - Extended</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ro' href="Proxy/ClassMethods.html#embedded%3F-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy::ClassMethods#embedded? (method)">embedded?</a></td>
      <td><div class='inline'><p>Returns true if the association is an embedded one.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(base, target, association)  &#x21d2; Proxy </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Instantiate a new references_many association.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Proxy/ClassMethods.html" title="Mongoid::Association::Referenced::HasMany::Proxy::ClassMethods (module)"><code>ClassMethods</code></a> - Extended</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Proxy/ClassMethods.html#eager_loader-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy::ClassMethods#eager_loader (method)">eager_loader</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)"><code>::Mongoid::Association::Proxy</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Proxy.html#apply_ordering-class_method" title="Mongoid::Association::Proxy.apply_ordering (method)">.apply_ordering</a></td>
      <td><div class='inline'><p>Apply ordering to the criteria if it was defined on the association.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Proxy.html#new-class_method" title="Mongoid::Association::Proxy.new (method)">.new</a></td>
      <td><div class='inline'><p>Sets the target and the association metadata properties.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro priv'>
      <a href="#persistable%3F-instance_method" title="#persistable? (instance method)">#<strong>persistable?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Are we able to persist this association?</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="../../Many.html" title="Mongoid::Association::Many (class)"><code>::Mongoid::Association::Many</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ro' href="../../Many.html#blank%3F-instance_method" title="Mongoid::Association::Many#blank? (method)">#blank?</a></td>
      <td><div class='inline'><p>Is the association empty?</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro' href="../../Many.html#nil%3F-instance_method" title="Mongoid::Association::Many#nil? (method)">#nil?</a></td>
      <td><div class='inline'><p>This proxy can never be nil.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)"><code>::Mongoid::Association::Proxy</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m rw' href="../../Proxy.html#_association-instance_method" title="Mongoid::Association::Proxy#_association (method)">#_association</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../../Proxy.html#_base-instance_method" title="Mongoid::Association::Proxy#_base (method)">#_base</a></td>
      <td><div class='inline'><p>Model instance for the base of the association.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../../Proxy.html#_target-instance_method" title="Mongoid::Association::Proxy#_target (method)">#_target</a></td>
      <td><div class='inline'><p>Model instance for one to one associations, or array of model instances for one to many associations, for the target of the association.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../../../Threaded/Lifecycle.html" title="Mongoid::Threaded::Lifecycle (module)"><code>::Mongoid::Threaded::Lifecycle</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_assigning-instance_method" title="Mongoid::Threaded::Lifecycle#_assigning (method)">#_assigning</a></td>
      <td><div class='inline'><p>Begin the assignment of attributes.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_assigning%3F-instance_method" title="Mongoid::Threaded::Lifecycle#_assigning? (method)">#_assigning?</a></td>
      <td><div class='inline'><p>Is the current thread in assigning mode?</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_binding-instance_method" title="Mongoid::Threaded::Lifecycle#_binding (method)">#_binding</a></td>
      <td><div class='inline'><p>Execute a block in binding mode.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_binding%3F-instance_method" title="Mongoid::Threaded::Lifecycle#_binding? (method)">#_binding?</a></td>
      <td><div class='inline'><p>Is the current thread in binding mode?</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_building-instance_method" title="Mongoid::Threaded::Lifecycle#_building (method)">#_building</a></td>
      <td><div class='inline'><p>Execute a block in building mode.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_building%3F-instance_method" title="Mongoid::Threaded::Lifecycle#_building? (method)">#_building?</a></td>
      <td><div class='inline'><p>Is the current thread in building mode?</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_creating%3F-instance_method" title="Mongoid::Threaded::Lifecycle#_creating? (method)">#_creating?</a></td>
      <td><div class='inline'><p>Is the current thread in creating mode?</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_loading-instance_method" title="Mongoid::Threaded::Lifecycle#_loading (method)">#_loading</a></td>
      <td><div class='inline'><p>Execute a block in loading mode.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro priv' href="../../../Threaded/Lifecycle.html#_loading%3F-instance_method" title="Mongoid::Threaded::Lifecycle#_loading? (method)">#_loading?</a></td>
      <td><div class='inline'><p>Is the current thread in loading mode?</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#<<-instance_method" title="#&lt;&lt; (instance method)">#<strong>&lt;&lt;</strong>(*args)  &#x21d2; Array&lt;Document&gt; </a>
      (also: #push)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Appends a document or array of documents to the association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#build-instance_method" title="#build (instance method)">#<strong>build</strong>(attributes = {}, type = nil)  &#x21d2; Document </a>
      (also: #new)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Build a new document from the attributes and append it to this association without saving.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#clear-instance_method" title="#clear (instance method)">#<strong>clear</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#purge-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#purge (method)">#purge</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#concat-instance_method" title="#concat (instance method)">#<strong>concat</strong>(documents)  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Appends an array of documents to the association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>(document)  &#x21d2; Document </a>
      (also: #delete_one)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Delete the document from the association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete_all-instance_method" title="#delete_all (instance method)">#<strong>delete_all</strong>(conditions = nil)  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Deletes all related documents from the database given the supplied conditions.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete_one-instance_method" title="#delete_one (instance method)">#<strong>delete_one</strong>(document)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#delete-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete (method)">#delete</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#destroy_all-instance_method" title="#destroy_all (instance method)">#<strong>destroy_all</strong>(conditions = nil)  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Destroys all related documents from the database given the supplied conditions.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong>(&amp;block)  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Iterate over each document in the association and yield to the provided block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#exists%3F-instance_method" title="#exists? (instance method)">#<strong>exists?</strong>(id_or_conditions = :none)  &#x21d2; true | false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Determine if any documents in this association exist in the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#find-instance_method" title="#find (instance method)">#<strong>find</strong>(*args) {|Object| ... } &#x21d2; Document | Array&lt;Document&gt; | nil </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Find the matching document on the association, either based on id or conditions.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-instance_method" title="#new (instance method)">#<strong>new</strong>(attributes = {}, type = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#build-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#build (method)">#build</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#nullify-instance_method" title="#nullify (instance method)">#<strong>nullify</strong>  </a>
      (also: #nullify_all)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Removes all associations between the base document and the target documents by deleting the foreign keys and the references, orphaning the target documents in the process.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#nullify_all-instance_method" title="#nullify_all (instance method)">#<strong>nullify_all</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#nullify-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#nullify (method)">#nullify</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#purge-instance_method" title="#purge (instance method)">#<strong>purge</strong>  &#x21d2; Many </a>
      (also: #clear)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Clear the association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#push-instance_method" title="#push (instance method)">#<strong>push</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#<<-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#&lt;&lt; (method)">#&lt;&lt;</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#substitute-instance_method" title="#substitute (instance method)">#<strong>substitute</strong>(replacement)  &#x21d2; Many </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Substitutes the supplied target documents for the existing documents in the association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unscoped-instance_method" title="#unscoped (instance method)">#<strong>unscoped</strong>  &#x21d2; Criteria </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a criteria for the documents without the default scoping applied.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#already_related%3F-instance_method" title="#already_related? (instance method)">#<strong>already_related?</strong>(document)  &#x21d2; true | false </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the document and the base already have a persisted association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#append-instance_method" title="#append (instance method)">#<strong>append</strong>(document)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Appends the document to the target array, updating the index on the document at the same time.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#binding-instance_method" title="#binding (instance method)">#<strong>binding</strong>  &#x21d2; Binding </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Instantiate the binding associated with this association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#cascade!-instance_method" title="#cascade! (instance method)">#<strong>cascade!</strong>(document)  &#x21d2; true | false </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Perform the necessary cascade operations for documents that just got deleted or nullified.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#collection-instance_method" title="#collection (instance method)">#<strong>collection</strong>  &#x21d2; Collection </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the collection of the association in question.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#criteria-instance_method" title="#criteria (instance method)">#<strong>criteria</strong>  &#x21d2; Criteria </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the criteria object for the target class with its documents set to target.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#method_missing-instance_method" title="#method_missing (instance method)">#<strong>method_missing</strong>  &#x21d2; Criteria | Object </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>If the target array does not respond to the supplied method then try to find a named scope or criteria on the class and send the call there.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#persist_delayed-instance_method" title="#persist_delayed (instance method)">#<strong>persist_delayed</strong>(docs, inserts)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Persist all the delayed batch inserts.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#remove_all-instance_method" title="#remove_all (instance method)">#<strong>remove_all</strong>(conditions = nil, method = :delete_all)  &#x21d2; Integer </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Deletes all related documents from the database given the supplied conditions.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#remove_not_in-instance_method" title="#remove_not_in (instance method)">#<strong>remove_not_in</strong>(ids)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Remove all the documents in the proxy that do not have the provided ids.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#save_or_delay-instance_method" title="#save_or_delay (instance method)">#<strong>save_or_delay</strong>(doc, docs, inserts)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Save a persisted document immediately or delay a new document for batch insert.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#update_or_delete_all-instance_method" title="#update_or_delete_all (instance method)">#<strong>update_or_delete_all</strong>(removed)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>If the association is destructive, the matching documents will be removed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#with_add_callbacks-instance_method" title="#with_add_callbacks (instance method)">#<strong>with_add_callbacks</strong>(document, already_related)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Execute before/after add callbacks around the block unless the objects already have a persisted association.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="../../Many.html" title="Mongoid::Association::Many (class)"><code>::Mongoid::Association::Many</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#cache_version-instance_method" title="Mongoid::Association::Many#cache_version (method)">#cache_version</a></td>
      <td><div class='inline'><p>For compatibility with Rails’ caching.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#create-instance_method" title="Mongoid::Association::Many#create (method)">#create</a></td>
      <td><div class='inline'><p>Creates a new document on the references many association.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#create!-instance_method" title="Mongoid::Association::Many#create! (method)">#create!</a></td>
      <td><div class='inline'><p>Creates a new document on the references many association.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#find_or_create_by-instance_method" title="Mongoid::Association::Many#find_or_create_by (method)">#find_or_create_by</a></td>
      <td><div class='inline'><p>Find the first document given the conditions, or creates a new document with the conditions that were supplied.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#find_or_create_by!-instance_method" title="Mongoid::Association::Many#find_or_create_by! (method)">#find_or_create_by!</a></td>
      <td><div class='inline'><p>Find the first document given the conditions, or creates a new document with the conditions that were supplied.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#find_or_initialize_by-instance_method" title="Mongoid::Association::Many#find_or_initialize_by (method)">#find_or_initialize_by</a></td>
      <td><div class='inline'><p>Find the first <a href="../../../Document.html" title="Mongoid::Document (module)"><code>::Mongoid::Document</code></a> given the conditions, or instantiates a new document with the conditions that were supplied.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#respond_to%3F-instance_method" title="Mongoid::Association::Many#respond_to? (method)">#respond_to?</a></td>
      <td><div class='inline'><p>Since method_missing is overridden we should override this as well.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#scoped-instance_method" title="Mongoid::Association::Many#scoped (method)">#scoped</a></td>
      <td><div class='inline'><p>This is public access to the association’s criteria.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#serializable_hash-instance_method" title="Mongoid::Association::Many#serializable_hash (method)">#serializable_hash</a></td>
      <td><div class='inline'><p>Gets the document as a serializable hash, used by ActiveModel’s JSON and XML serializers.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Many.html#unscoped-instance_method" title="Mongoid::Association::Many#unscoped (method)">#unscoped</a></td>
      <td><div class='inline'><p>Get a criteria for the embedded documents without the default scoping applied.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="../../Many.html#_session-instance_method" title="Mongoid::Association::Many#_session (method)">#_session</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="../../Many.html#analyze_loaded_target-instance_method" title="Mongoid::Association::Many#analyze_loaded_target (method)">#analyze_loaded_target</a></td>
      <td><div class='inline'><p>Return a 2-tuple of the number of elements in the relation, and the largest timestamp value.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="../../Many.html#analyze_unloaded_target-instance_method" title="Mongoid::Association::Many#analyze_unloaded_target (method)">#analyze_unloaded_target</a></td>
      <td><div class='inline'><p>Returns a 2-tuple of the number of elements in the relation, and the largest timestamp value.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="../../Many.html#compute_cache_version-instance_method" title="Mongoid::Association::Many#compute_cache_version (method)">#compute_cache_version</a></td>
      <td><div class='inline'><p>Computes the cache version for the relation using the given timestamp colum; see <code>#cache_version</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="../../Many.html#find_or-instance_method" title="Mongoid::Association::Many#find_or (method)">#find_or</a></td>
      <td><div class='inline'><p>Find the first object given the supplied attributes or create/initialize it.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)"><code>::Mongoid::Association::Proxy</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Proxy.html#extend_proxies-instance_method" title="Mongoid::Association::Proxy#extend_proxies (method)">#extend_proxies</a></td>
      <td><div class='inline'><p>Allow extension to be an array and extend each module.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../../Proxy.html#extend_proxy-instance_method" title="Mongoid::Association::Proxy#extend_proxy (method)">#extend_proxy</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Proxy.html#klass-instance_method" title="Mongoid::Association::Proxy#klass (method)">#klass</a></td>
      <td><div class='inline'><p>Get the class from the association, or return nil if no association present.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Proxy.html#reset_unloaded-instance_method" title="Mongoid::Association::Proxy#reset_unloaded (method)">#reset_unloaded</a></td>
      <td><div class='inline'><p>Resets the criteria inside the association proxy.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Proxy.html#substitutable-instance_method" title="Mongoid::Association::Proxy#substitutable (method)">#substitutable</a></td>
      <td><div class='inline'><p>The default substitutable object for an association proxy is the clone of the target.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../../Marshalable.html" title="Mongoid::Association::Marshalable (module)"><code>::Mongoid::Association::Marshalable</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Marshalable.html#marshal_dump-instance_method" title="Mongoid::Association::Marshalable#marshal_dump (method)">#marshal_dump</a></td>
      <td><div class='inline'><p>Provides the data needed to Marshal.dump an association proxy.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../Marshalable.html#marshal_load-instance_method" title="Mongoid::Association::Marshalable#marshal_load (method)">#marshal_load</a></td>
      <td><div class='inline'><p>Takes the provided data and sets it back on the proxy.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(base, target, association)  &#x21d2; <code>Proxy</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Instantiate a new references_many association. Will set the foreign key and the base on the inverse object.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Create the new association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'><a href="../../Referenced.html" title="Mongoid::Association::Referenced (module)">Referenced</a></span><span class='op'>::</span><span class='const'><a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_association'>association</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>base</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document this association hangs off of.</p>
</div>
  </li>
  <li>
    <span class='name'>target</span>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The target of the association.</p>
</div>
  </li>
  <li>
    <span class='name'>association</span>
    <span class='type'>(<a href="../../Relatable.html" title="Mongoid::Association::Relatable (module)">Mongoid::Association::Relatable</a>)</span>
&mdash;    <div class='inline'>
<p>The association metadata.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L48-L53'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='48' data-end='53'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_association'>association</span>)
  <span class='id identifier rubyid_enum'>enum</span> <span class='op'>=</span> <span class='const'><a href="../HasMany.html" title="Mongoid::Association::Referenced::HasMany (class)">HasMany</a></span><span class='op'>::</span><span class='const'><a href="Enumerable.html" title="Mongoid::Association::Referenced::HasMany::Enumerable (class)">Enumerable</a></span>.<span class='id identifier rubyid_new'><a href="Enumerable.html#new-class_method" title="Mongoid::Association::Referenced::HasMany::Enumerable.new (method)">new</a></span>(<span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='id identifier rubyid_association'>association</span>)
  <span class='kw'>super</span>(<span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='id identifier rubyid_enum'>enum</span><span class='comma'>,</span> <span class='id identifier rubyid_association'>association</span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_raise_mixed'>raise_mixed</span> <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_embedded?'><a href="../HasMany.html#embedded%3F-instance_method" title="Mongoid::Association::Referenced::HasMany#embedded? (method)">embedded?</a></span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_cyclic?'>cyclic?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 id='method_missing_details' class='y_details'>Dynamic Method Handling</h2>
  <p class='notice this'>
    This class handles dynamic methods through the <tt>method_missing</tt> method
</p>
<section class='method_details first' id="method_missing-instance_method">
  <h3 class='signature priv first'>
    #<strong>method_missing</strong>  &#x21d2; <a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a> | <code>Object</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>If the target array does not respond to the supplied method then try to find a named scope or criteria on the class and send the call there.</p>

<p>If the method exists on the array, use the default proxy behavior.</p>

<p>TODO: make sure we are consistently using respond_to_missing</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_anywhere'>anywhere</span> <span class='id identifier rubyid_we'>we</span> <span class='id identifier rubyid_define'>define</span> <span class='id identifier rubyid_method_missing'>method_missing</span>.</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../../../../Symbol.html" title="Symbol (class)">Symbol</a> | <a href="../../../../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the method.</p>
</div>
  </li>
  <li>
    <span class='name'>*args</span>
    <span class='type'>(<code>Object</code>...)</span>
&mdash;    <div class='inline'>
<p>The method args</p>
</div>
  </li>
  <li>
    <span class='name'>&amp;block</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>Optional block to pass.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a> | <code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>A Criteria or return value from the target.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L465-L473'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='465' data-end='473'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 465</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_ruby2_keywords'>ruby2_keywords</span> <span class='kw'>def</span> <span class='id identifier rubyid_method_missing'>method_missing</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='id identifier rubyid_name'>name</span>)
    <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_with_scope'>with_scope</span><span class='comma'>,</span> <span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>.<span class='id identifier rubyid_public_send'>public_send</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="persistable?-instance_method">
  <h3 class='signature ro priv first'>
    #<strong>persistable?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Are we able to persist this association?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Can we persist the association?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_persistable?'>persistable?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the association is persistable.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L502-L504'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='502' data-end='504'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 502</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_persistable?'>persistable?</span>
  <span class='op'>!</span><span class='id identifier rubyid__binding?'>_binding?</span> <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid__creating?'>_creating?</span> <span class='op'>||</span> (<span class='id identifier rubyid__base'>_base</span>.<span class='id identifier rubyid_persisted?'>persisted?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid__building?'>_building?</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="<<-instance_method">
  <h3 class='signature  first'>
    #<strong>&lt;&lt;</strong>(*args)  &#x21d2; <a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
    <span class='aliases'>Also known as: <span class='names'>#push</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Appends a document or array of documents to the association. Will set the parent and update the index in the process.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Append a document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_post'>post</span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Push a document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_push'><a href="#push-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#push (method)">push</a></span>(<span class='id identifier rubyid_post'>post</span>)</code></pre>
        <p class='example_title'><div class='inline'>
<p>Concat with other documents.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_concat'><a href="#concat-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#concat (method)">concat</a></span>([ <span class='id identifier rubyid_post_one'>post_one</span><span class='comma'>,</span> <span class='id identifier rubyid_post_two'>post_two</span> ])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>*args</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>...)</span>
&mdash;    <div class='inline'>
<p>Any number of documents.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The loaded docs.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L70-L79'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='70' data-end='79'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 70</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>&lt;&lt;</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_docs'>docs</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_flatten'>flatten</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_concat'><a href="#concat-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#concat (method)">concat</a></span>(<span class='id identifier rubyid_docs'>docs</span>) <span class='kw'>if</span> <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>

  <span class='kw'>if</span> (<span class='id identifier rubyid_doc'>doc</span> <span class='op'>=</span> <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_first'>first</span>)
    <span class='id identifier rubyid_append'><a href="#append-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#append (method)">append</a></span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_save'>save</span> <span class='kw'>if</span> <span class='id identifier rubyid_persistable?'><a href="#persistable%3F-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#persistable? (method)">persistable?</a></span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid__assigning?'>_assigning?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_validated?'>validated?</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="already_related?-instance_method">
  <h3 class='signature priv'>
    #<strong>already_related?</strong>(document)  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the document and the base already have a persisted association.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the document already related to the base.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_already_related?'>already_related?</span>(<span class='id identifier rubyid_document'>document</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to possibly append to the target.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the document is already related to the base and the association is persisted.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L391-L396'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='391' data-end='396'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 391</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_already_related?'>already_related?</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_persisted?'>persisted?</span> <span class='op'>&amp;&amp;</span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__association'>_association</span> <span class='op'>&amp;&amp;</span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_foreign_key'><a href="../HasMany.html#foreign_key-instance_method" title="Mongoid::Association::Referenced::HasMany#foreign_key (method)">foreign_key</a></span>) <span class='op'>&amp;&amp;</span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid___send__'>__send__</span>(<span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_foreign_key'><a href="../HasMany.html#foreign_key-instance_method" title="Mongoid::Association::Referenced::HasMany#foreign_key (method)">foreign_key</a></span>) <span class='op'>==</span> <span class='id identifier rubyid__base'>_base</span>.<span class='id identifier rubyid__id'>_id</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="append-instance_method">
  <h3 class='signature priv'>
    #<strong>append</strong>(document)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Appends the document to the target array, updating the index on the document at the same time.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Append the document to the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_append'>append</span>(<span class='id identifier rubyid_document'>document</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to append to the target.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L359-L365'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='359' data-end='365'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 359</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_append'>append</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='id identifier rubyid_with_add_callbacks'><a href="#with_add_callbacks-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#with_add_callbacks (method)">with_add_callbacks</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_already_related?'><a href="#already_related%3F-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#already_related? (method)">already_related?</a></span>(<span class='id identifier rubyid_document'>document</span>)) <span class='kw'>do</span>
    <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_push'><a href="#push-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#push (method)">push</a></span>(<span class='id identifier rubyid_document'>document</span>)
    <span class='id identifier rubyid_characterize_one'>characterize_one</span>(<span class='id identifier rubyid_document'>document</span>)
    <span class='id identifier rubyid_bind_one'>bind_one</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="binding-instance_method">
  <h3 class='signature priv'>
    #<strong>binding</strong>  &#x21d2; <a href="Binding.html" title="Mongoid::Association::Referenced::HasMany::Binding (class)">Binding</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Instantiate the binding associated with this association.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the binding.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_binding'>binding</span>([ <span class='id identifier rubyid_address'>address</span> ])</code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Binding.html" title="Mongoid::Association::Referenced::HasMany::Binding (class)">Binding</a>)</span>
&mdash;    <div class='inline'>
<p>The binding.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L404-L406'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='404' data-end='406'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 404</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_binding'>binding</span>
  <span class='const'><a href="../HasMany.html" title="Mongoid::Association::Referenced::HasMany (class)">HasMany</a></span><span class='op'>::</span><span class='const'><a href="Binding.html" title="Mongoid::Association::Referenced::HasMany::Binding (class)">Binding</a></span>.<span class='id identifier rubyid_new'><a href="../../Bindable.html#initialize-instance_method" title="Mongoid::Association::Bindable#initialize (method)">new</a></span>(<span class='id identifier rubyid__base'>_base</span><span class='comma'>,</span> <span class='id identifier rubyid__target'>_target</span><span class='comma'>,</span> <span class='id identifier rubyid__association'>_association</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build-instance_method">
  <h3 class='signature '>
    #<strong>build</strong>(attributes = {}, type = nil)  &#x21d2; <a href="../../../Document.html" title="Mongoid::Document (module)">Document</a> 
    <span class='aliases'>Also known as: <span class='names'>#new</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Build a new document from the attributes and append it to this association without saving.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Build a new document on the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_build'>build</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A new post</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attributes</span>
    <span class='type'>(<a href="../../../../Hash.html" title="Hash (class)">Hash</a>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The attributes of the new document.</p>
</div>
  </li>
  <li>
    <span class='name'>type</span>
    <span class='type'>(<code>Class</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>The optional subclass to build.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The new document.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L115-L123'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='115' data-end='123'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 115</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build'>build</span>(<span class='id identifier rubyid_attributes'>attributes</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_type'><a href="../HasMany.html#type-instance_method" title="Mongoid::Association::Referenced::HasMany#type (method)">type</a></span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='const'><a href="../../../Factory.html" title="Mongoid::Factory (module)">Factory</a></span>.<span class='id identifier rubyid_execute_build'><a href="../../../Factory.html#execute_build-instance_method" title="Mongoid::Factory#execute_build (method)">execute_build</a></span>(<span class='id identifier rubyid_type'><a href="../HasMany.html#type-instance_method" title="Mongoid::Association::Referenced::HasMany#type (method)">type</a></span> <span class='op'>||</span> <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='label'>execute_callbacks:</span> <span class='kw'>false</span>).<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='id identifier rubyid_append'><a href="#append-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#append (method)">append</a></span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_apply_post_processed_defaults'>apply_post_processed_defaults</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_doc'>doc</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_run_pending_callbacks'>run_pending_callbacks</span>
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_run_callbacks'>run_callbacks</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_build'>build</span>) { <span class='id identifier rubyid_doc'>doc</span> }
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cascade!-instance_method">
  <h3 class='signature priv'>
    #<strong>cascade!</strong>(document)  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Perform the necessary cascade operations for documents that just got deleted or nullified.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Cascade the change.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_cascade!'>cascade!</span>(<span class='id identifier rubyid_document'>document</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to cascade on.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the association is destructive.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L438-L449'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='438' data-end='449'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 438</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cascade!'>cascade!</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_persistable?'><a href="#persistable%3F-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#persistable? (method)">persistable?</a></span>

  <span class='kw'>case</span> <span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_dependent'>dependent</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_delete_all'><a href="#delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete_all (method)">delete_all</a></span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_delete'><a href="#delete-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete (method)">delete</a></span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_destroy'>destroy</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_save'>save</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clear-instance_method">
  <h3 class='signature '>
    #<strong>clear</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#purge-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#purge (method)">#purge</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L312-L312'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='312' data-end='312'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 312</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_clear'>clear</span> <span class='id identifier rubyid_purge'><a href="#purge-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#purge (method)">purge</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collection-instance_method">
  <h3 class='signature priv'>
    #<strong>collection</strong>  &#x21d2; <code>Collection</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the collection of the association in question.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the collection of the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_collection'>collection</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Collection</code>)</span>
&mdash;    <div class='inline'>
<p>The collection of the association.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L414-L416'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='414' data-end='416'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 414</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_collection'>collection</span>
  <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_collection'>collection</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="concat-instance_method">
  <h3 class='signature '>
    #<strong>concat</strong>(documents)  &#x21d2; <a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Appends an array of documents to the association. Performs a batch insert of the documents instead of persisting one at a time.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Concat with other documents.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_concat'>concat</span>([ <span class='id identifier rubyid_post_one'>post_one</span><span class='comma'>,</span> <span class='id identifier rubyid_post_two'>post_two</span> ])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>documents</span>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The docs to add.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The documents.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L92-L103'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='92' data-end='103'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 92</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_concat'>concat</span>(<span class='id identifier rubyid_documents'>documents</span>)
  <span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span> <span class='op'>=</span> []<span class='comma'>,</span> []
  <span class='id identifier rubyid_documents'>documents</span>.<span class='id identifier rubyid_each'><a href="#each-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#each (method)">each</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_doc'>doc</span>

    <span class='id identifier rubyid_append'><a href="#append-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#append (method)">append</a></span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid_save_or_delay'><a href="#save_or_delay-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#save_or_delay (method)">save_or_delay</a></span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span>) <span class='kw'>if</span> <span class='id identifier rubyid_persistable?'><a href="#persistable%3F-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#persistable? (method)">persistable?</a></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_persist_delayed'><a href="#persist_delayed-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#persist_delayed (method)">persist_delayed</a></span>(<span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span>)
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="criteria-instance_method">
  <h3 class='signature priv'>
    #<strong>criteria</strong>  &#x21d2; <a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the criteria object for the target class with its documents set to target.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get a criteria for the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_criteria'>criteria</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>)</span>
&mdash;    <div class='inline'>
<p>A new criteria.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L425-L427'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='425' data-end='427'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 425</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_criteria'>criteria</span>
  <span class='ivar'>@criteria</span> <span class='op'>||=</span> <span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_criteria'>criteria</span>(<span class='id identifier rubyid__base'>_base</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete-instance_method">
  <h3 class='signature '>
    #<strong>delete</strong>(document)  &#x21d2; <a href="../../../Document.html" title="Mongoid::Document (module)">Document</a> 
    <span class='aliases'>Also known as: <span class='names'>#delete_one</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Delete the document from the association. This will set the foreign key on the document to nil. If the dependent options on the association are <code>:delete_all</code> or <code>:destroy</code> the appropriate removal will occur.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Delete the document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_post'>post</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to remove.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The matching document.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L137-L148'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='137' data-end='148'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 137</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='id identifier rubyid_execute_callbacks_around'>execute_callbacks_around</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_remove'>remove</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_document'>document</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_doc'>doc</span>
        <span class='id identifier rubyid_unbind_one'>unbind_one</span>(<span class='id identifier rubyid_doc'>doc</span>)
        <span class='id identifier rubyid_cascade!'><a href="#cascade!-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#cascade! (method)">cascade!</a></span>(<span class='id identifier rubyid_doc'>doc</span>) <span class='kw'>unless</span> <span class='id identifier rubyid__assigning?'>_assigning?</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_tap'>tap</span> { <span class='id identifier rubyid_reset_unloaded'>reset_unloaded</span> }
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_all-instance_method">
  <h3 class='signature '>
    #<strong>delete_all</strong>(conditions = nil)  &#x21d2; <a href="../../../../Integer.html" title="Integer (class)">Integer</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Deletes all related documents from the database given the supplied conditions.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Delete all documents in the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_delete_all'>delete_all</span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Conditionally delete all documents in the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_delete_all'>delete_all</span>({ <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Testing</span><span class='tstring_end'>&quot;</span></span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>conditions</span>
    <span class='type'>(<a href="../../../../Hash.html" title="Hash (class)">Hash</a>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>Optional conditions to delete with.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../../Integer.html" title="Integer (class)">Integer</a>)</span>
&mdash;    <div class='inline'>
<p>The number of documents deleted.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L166-L168'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='166' data-end='168'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 166</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_all'>delete_all</span>(<span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_remove_all'><a href="#remove_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#remove_all (method)">remove_all</a></span>(<span class='id identifier rubyid_conditions'>conditions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_delete_all'>delete_all</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_one-instance_method">
  <h3 class='signature '>
    #<strong>delete_one</strong>(document)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#delete-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete (method)">#delete</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L152-L152'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='152' data-end='152'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 152</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_delete_one'>delete_one</span> <span class='id identifier rubyid_delete'><a href="#delete-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete (method)">delete</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="destroy_all-instance_method">
  <h3 class='signature '>
    #<strong>destroy_all</strong>(conditions = nil)  &#x21d2; <a href="../../../../Integer.html" title="Integer (class)">Integer</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Destroys all related documents from the database given the supplied conditions.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Destroy all documents in the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_destroy_all'>destroy_all</span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Conditionally destroy all documents in the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_destroy_all'>destroy_all</span>({ <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Testing</span><span class='tstring_end'>&quot;</span></span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>conditions</span>
    <span class='type'>(<a href="../../../../Hash.html" title="Hash (class)">Hash</a>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>Optional conditions to destroy with.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../../Integer.html" title="Integer (class)">Integer</a>)</span>
&mdash;    <div class='inline'>
<p>The number of documents destroyed.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L182-L184'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='182' data-end='184'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 182</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy_all'>destroy_all</span>(<span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_remove_all'><a href="#remove_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#remove_all (method)">remove_all</a></span>(<span class='id identifier rubyid_conditions'>conditions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy_all'>destroy_all</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="each-instance_method">
  <h3 class='signature '>
    #<strong>each</strong>(&amp;block)  &#x21d2; <a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This will load the entire association into memory.</p>
</div>
  </div>


<p>Iterate over each document in the association and yield to the provided block.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Iterate over the documents.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_post'>post</span><span class='op'>|</span>
  <span class='id identifier rubyid_post'>post</span>.<span class='id identifier rubyid_save'>save</span>
<span class='kw'>end</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The loaded docs.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L197-L203'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='197' data-end='203'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 197</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_each'>each</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
    <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_each'>each</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_to_enum'>to_enum</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="exists?-instance_method">
  <h3 class='signature '>
    #<strong>exists?</strong>(id_or_conditions = :none)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Determine if any documents in this association exist in the database.</p>

<p>If the association contains documents but all of the documents exist only in the application, i.e. have not been persisted to the database, this method returns false.</p>

<p>This method queries the database on each invocation even if the association is already loaded into memory.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Are there persisted documents?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_exists?'>exists?</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>id_or_conditions</span>
    <span class='type'>(<code>:none</code> | <code>nil</code> | <code>false</code> | <a href="../../../../Hash.html" title="Hash (class)">Hash</a> | <code>Object</code>)</span>
    <em class='default'>(defaults to: <tt>:none</tt>)</em>
&mdash;    <div class='inline'>
<p>When <code>:none</code> (the default), returns true if any persisted documents exist in the association. When nil or false, this will always return false. When a <a href="../../../../Hash.html" title="Hash (class)"><code>::Hash</code></a> is given, this queries the documents in the association for those that match the given conditions, and returns true if any match. Any other argument is interpreted as an id, and queries for the existence of documents in the association with a matching _id.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>True is persisted documents exist, false if not.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L227-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='227' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 227</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_exists?'>exists?</span>(<span class='id identifier rubyid_id_or_conditions'>id_or_conditions</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span>)
  <span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>.<span class='id identifier rubyid_exists?'>exists?</span>(<span class='id identifier rubyid_id_or_conditions'>id_or_conditions</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="find-instance_method">
  <h3 class='signature '>
    #<strong>find</strong>(*args) {|Object| ... } &#x21d2; <a href="../../../Document.html" title="Mongoid::Document (module)">Document</a> | <a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt; | <code>nil</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Each argument can be an individual id, an array of ids or a nested array. Each array will be flattened.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This will keep matching documents in memory for iteration later.</p>
</div>
  </div>


<p>Find the matching document on the association, either based on id or conditions.</p>

<p>This method delegates to <a href="../../../Criteria.html#find-instance_method" title="Mongoid::Criteria#find (method)">Criteria#find</a>. If this method is not given a block, it returns one or many documents for the provided _id values.</p>

<p>If this method is given a block, it returns the first document of those found by the current <a href="../../../Criteria.html" title="Mongoid::Criteria (class)"><code>::Mongoid::Criteria</code></a> object for which the block returns a truthy value.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Find by an id.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_find'>find</span>(<span class='const'><a href="../../../../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../../../../BSON/ObjectId.html" title="BSON::ObjectId (class)">ObjectId</a></span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongoid::Association::Referenced::HasMany::Proxy.new (method)">new</a></span>)</code></pre>
        <p class='example_title'><div class='inline'>
<p>Find by multiple ids.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_find'>find</span>([ <span class='const'><a href="../../../../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../../../../BSON/ObjectId.html" title="BSON::ObjectId (class)">ObjectId</a></span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongoid::Association::Referenced::HasMany::Proxy.new (method)">new</a></span><span class='comma'>,</span> <span class='const'><a href="../../../../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../../../../BSON/ObjectId.html" title="BSON::ObjectId (class)">ObjectId</a></span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongoid::Association::Referenced::HasMany::Proxy.new (method)">new</a></span> ])</code></pre>
        <p class='example_title'><div class='inline'>
<p>Finds the first matching document using a block.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_addresses'>addresses</span>.<span class='id identifier rubyid_find'>find</span> { <span class='op'>|</span><span class='id identifier rubyid_addr'>addr</span><span class='op'>|</span> <span class='id identifier rubyid_addr'>addr</span>.<span class='id identifier rubyid_state'>state</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA</span><span class='tstring_end'>&#39;</span></span> }</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>*args</span>
    <span class='type'>([ <code>Object</code> | <a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>&gt; ]...)</span>
&mdash;    <div class='inline'>
<p>The ids.</p>
</div>
  </li>
  <li>
    <span class='name'>&amp;block</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>Optional block to pass.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>Yields each enumerable element to the block.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a> | <a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt; | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>A document or matching documents.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L262-L266'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='262' data-end='266'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 262</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_find'>find</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_matching'>matching</span> <span class='op'>=</span> <span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>.<span class='id identifier rubyid_find'>find</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='const'><a href="../../../../Array.html" title="Array (class)">Array</a></span>(<span class='id identifier rubyid_matching'>matching</span>).<span class='id identifier rubyid_each'><a href="#each-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#each (method)">each</a></span> { <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span> <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_push'><a href="#push-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#push (method)">push</a></span>(<span class='id identifier rubyid_doc'>doc</span>) }
  <span class='id identifier rubyid_matching'>matching</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="new-instance_method">
  <h3 class='signature '>
    #<strong>new</strong>(attributes = {}, type = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#build-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#build (method)">#build</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L125-L125'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='125' data-end='125'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 125</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_build'><a href="#build-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#build (method)">build</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="nullify-instance_method">
  <h3 class='signature '>
    #<strong>nullify</strong>  
    <span class='aliases'>Also known as: <span class='names'>#nullify_all</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Removes all associations between the base document and the target documents by deleting the foreign keys and the references, orphaning the target documents in the process.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Nullify the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_nullify'>nullify</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L274-L280'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='274' data-end='280'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 274</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_nullify'>nullify</span>
  <span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>.<span class='id identifier rubyid_update_all'>update_all</span>(<span class='id identifier rubyid_foreign_key'><a href="../HasMany.html#foreign_key-instance_method" title="Mongoid::Association::Referenced::HasMany#foreign_key (method)">foreign_key</a></span> <span class='op'>=&gt;</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_clear'><a href="#clear-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#clear (method)">clear</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='id identifier rubyid_unbind_one'>unbind_one</span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_changed_attributes'>changed_attributes</span>.<span class='id identifier rubyid_delete'><a href="#delete-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete (method)">delete</a></span>(<span class='id identifier rubyid_foreign_key'><a href="../HasMany.html#foreign_key-instance_method" title="Mongoid::Association::Referenced::HasMany#foreign_key (method)">foreign_key</a></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="nullify_all-instance_method">
  <h3 class='signature '>
    #<strong>nullify_all</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#nullify-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#nullify (method)">#nullify</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L282-L282'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='282' data-end='282'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 282</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_nullify_all'>nullify_all</span> <span class='id identifier rubyid_nullify'><a href="#nullify-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#nullify (method)">nullify</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="persist_delayed-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>persist_delayed</strong>(docs, inserts)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Persist all the delayed batch inserts.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Persist the delayed batch inserts.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_persist_delayed'>persist_delayed</span>([ <span class='id identifier rubyid_doc'>doc</span> ])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>docs</span>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The delayed inserts.</p>
</div>
  </li>
  <li>
    <span class='name'>inserts</span>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../../Hash.html" title="Hash (class)">Hash</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The raw insert document.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L485-L494'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='485' data-end='494'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 485</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_persist_delayed'>persist_delayed</span>(<span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_collection'><a href="#collection-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#collection (method)">collection</a></span>.<span class='id identifier rubyid_insert_many'>insert_many</span>(<span class='id identifier rubyid_inserts'>inserts</span><span class='comma'>,</span> <span class='label'>session:</span> <span class='id identifier rubyid__session'>_session</span>)
  <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_each'><a href="#each-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#each (method)">each</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_new_record'>new_record</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_run_after_callbacks'>run_after_callbacks</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_create'>create</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_save'>save</span>) <span class='kw'>unless</span> <span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_autosave?'>autosave?</span>
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_post_persist'>post_persist</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="purge-instance_method">
  <h3 class='signature '>
    #<strong>purge</strong>  &#x21d2; <a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a> 
    <span class='aliases'>Also known as: <span class='names'>#clear</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Clear the association. Will delete the documents from the db if they are already persisted.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Clear the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_clear'><a href="#clear-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#clear (method)">clear</a></span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a>)</span>
&mdash;    <div class='inline'>
<p>The association emptied.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L291-L310'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='291' data-end='310'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 291</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_nullify'><a href="#nullify-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#nullify (method)">nullify</a></span> <span class='kw'>unless</span> <span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_destructive?'>destructive?</span>

  <span class='id identifier rubyid_after_remove_error'>after_remove_error</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>.<span class='id identifier rubyid_delete_all'><a href="#delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete_all (method)">delete_all</a></span>
  <span class='id identifier rubyid_many'>many</span> <span class='op'>=</span> <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_clear'><a href="#clear-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#clear (method)">clear</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='id identifier rubyid_execute_callback'>execute_callback</span> <span class='symbeg'>:</span><span class='id identifier rubyid_before_remove'>before_remove</span><span class='comma'>,</span> <span class='id identifier rubyid_doc'>doc</span>
    <span class='id identifier rubyid_unbind_one'>unbind_one</span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_destroyed'>destroyed</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_execute_callback'>execute_callback</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_remove'>after_remove</span><span class='comma'>,</span> <span class='id identifier rubyid_doc'>doc</span>
    <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_after_remove_error'>after_remove_error</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_after_remove_error'>after_remove_error</span> <span class='kw'>if</span> <span class='id identifier rubyid_after_remove_error'>after_remove_error</span>

  <span class='id identifier rubyid_many'>many</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="push-instance_method">
  <h3 class='signature '>
    #<strong>push</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#<<-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#&lt;&lt; (method)">#&lt;&lt;</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L81-L81'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='81' data-end='81'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 81</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_push'>push</span> <span class='op'>&lt;&lt;</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="remove_all-instance_method">
  <h3 class='signature priv'>
    #<strong>remove_all</strong>(conditions = nil, method = :delete_all)  &#x21d2; <a href="../../../../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Deletes all related documents from the database given the supplied conditions.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Delete all documents in the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_delete_all'><a href="#delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete_all (method)">delete_all</a></span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Conditionally delete all documents in the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_delete_all'><a href="#delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete_all (method)">delete_all</a></span>({ <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Testing</span><span class='tstring_end'>&quot;</span></span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>conditions</span>
    <span class='type'>(<a href="../../../../Hash.html" title="Hash (class)">Hash</a>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>Optional conditions to delete with.</p>
</div>
  </li>
  <li>
    <span class='name'>method</span>
    <span class='type'>(<a href="../../../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
    <em class='default'>(defaults to: <tt>:delete_all</tt>)</em>
&mdash;    <div class='inline'>
<p>The deletion method to call.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../../Integer.html" title="Integer (class)">Integer</a>)</span>
&mdash;    <div class='inline'>
<p>The number of documents deleted.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L519-L528'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='519' data-end='528'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 519</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_all'>remove_all</span>(<span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_delete_all'><a href="#delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete_all (method)">delete_all</a></span>)
  <span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> <span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>||</span> {}
  <span class='id identifier rubyid_removed'>removed</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='id identifier rubyid_selector'>selector</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>.<span class='id identifier rubyid_selector'>selector</span>))
  <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid__matches?'>_matches?</span>(<span class='id identifier rubyid_selector'>selector</span>).<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span>
      <span class='id identifier rubyid_unbind_one'>unbind_one</span>(<span class='id identifier rubyid_doc'>doc</span>) <span class='kw'>if</span> <span class='id identifier rubyid_b'>b</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_removed'>removed</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="remove_not_in-instance_method">
  <h3 class='signature priv'>
    #<strong>remove_not_in</strong>(ids)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Remove all the documents in the proxy that do not have the provided ids.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Remove all documents without the ids.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_proxy'>proxy</span>.<span class='id identifier rubyid_remove_not_in'>remove_not_in</span>([ <span class='id identifier rubyid_id'>id</span> ])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>ids</span>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The ids.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L537-L549'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='537' data-end='549'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 537</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_not_in'>remove_not_in</span>(<span class='id identifier rubyid_ids'>ids</span>)
  <span class='id identifier rubyid_removed'>removed</span> <span class='op'>=</span> <span class='id identifier rubyid_criteria'><a href="#criteria-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#criteria (method)">criteria</a></span>.<span class='id identifier rubyid_not_in'>not_in</span>(<span class='label'>_id:</span> <span class='id identifier rubyid_ids'>ids</span>)

  <span class='id identifier rubyid_update_or_delete_all'><a href="#update_or_delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#update_or_delete_all (method)">update_or_delete_all</a></span>(<span class='id identifier rubyid_removed'>removed</span>)

  <span class='id identifier rubyid_in_memory'>in_memory</span>.<span class='id identifier rubyid_each'><a href="#each-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#each (method)">each</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_ids'>ids</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid__id'>_id</span>)

    <span class='id identifier rubyid_unbind_one'>unbind_one</span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid__target'>_target</span>.<span class='id identifier rubyid_delete'><a href="#delete-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete (method)">delete</a></span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_destroyed'>destroyed</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_destructive?'>destructive?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="save_or_delay-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>save_or_delay</strong>(doc, docs, inserts)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Save a persisted document immediately or delay a new document for batch insert.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Save or delay the document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_save_or_delay'>save_or_delay</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> [])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>doc</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document.</p>
</div>
  </li>
  <li>
    <span class='name'>inserts</span>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The inserts.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L574-L582'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='574' data-end='582'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 574</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_save_or_delay'>save_or_delay</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_new_record?'>new_record?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_valid?'>valid?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_create'>create</span>)
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_run_before_callbacks'>run_before_callbacks</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_save'>save</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_create'>create</span>)
    <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_push'><a href="#push-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#push (method)">push</a></span>(<span class='id identifier rubyid_doc'>doc</span>)
    <span class='id identifier rubyid_inserts'>inserts</span>.<span class='id identifier rubyid_push'><a href="#push-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#push (method)">push</a></span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_as_attributes'>as_attributes</span>))
  <span class='kw'>else</span>
    <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_save'>save</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="substitute-instance_method">
  <h3 class='signature '>
    #<strong>substitute</strong>(replacement)  &#x21d2; <a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Substitutes the supplied target documents for the existing documents in the association. If the new target is nil, perform the necessary deletion.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Replace the association.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_substitute'>substitute</span>([ <span class='id identifier rubyid_new_post'>new_post</span> ])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>replacement</span>
    <span class='type'>(<a href="../../../../Array.html" title="Array (class)">Array</a>&lt;<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The replacement target.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a>)</span>
&mdash;    <div class='inline'>
<p>The association.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L324-L337'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='324' data-end='337'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 324</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_substitute'>substitute</span>(<span class='id identifier rubyid_replacement'>replacement</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_replacement'>replacement</span>
    <span class='id identifier rubyid_new_docs'>new_docs</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span> <span class='op'>=</span> <span class='id identifier rubyid_replacement'>replacement</span>.<span class='id identifier rubyid_compact'>compact</span><span class='comma'>,</span> []
    <span class='id identifier rubyid_new_ids'>new_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_new_docs'>new_docs</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid__id'>_id</span>)
    <span class='id identifier rubyid_remove_not_in'><a href="#remove_not_in-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#remove_not_in (method)">remove_not_in</a></span>(<span class='id identifier rubyid_new_ids'>new_ids</span>)
    <span class='id identifier rubyid_new_docs'>new_docs</span>.<span class='id identifier rubyid_each'><a href="#each-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#each (method)">each</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
      <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_push'><a href="#push-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#push (method)">push</a></span>(<span class='id identifier rubyid_doc'>doc</span>) <span class='kw'>if</span> <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid_foreign_key'><a href="../HasMany.html#foreign_key-instance_method" title="Mongoid::Association::Referenced::HasMany#foreign_key (method)">foreign_key</a></span>) <span class='op'>!=</span> <span class='id identifier rubyid__base'>_base</span>.<span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_primary_key'>primary_key</span>)
    <span class='kw'>end</span>
    <span class='id identifier rubyid_concat'><a href="#concat-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#concat (method)">concat</a></span>(<span class='id identifier rubyid_docs'>docs</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_purge'><a href="#purge-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#purge (method)">purge</a></span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unscoped-instance_method">
  <h3 class='signature '>
    #<strong>unscoped</strong>  &#x21d2; <a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a criteria for the documents without the default scoping applied.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the unscoped criteria.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_posts'>posts</span>.<span class='id identifier rubyid_unscoped'>unscoped</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>)</span>
&mdash;    <div class='inline'>
<p>The unscoped criteria.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L346-L348'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='346' data-end='348'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 346</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unscoped'>unscoped</span>
  <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_unscoped'>unscoped</span>.<span class='id identifier rubyid_where'>where</span>(<span class='id identifier rubyid_foreign_key'><a href="../HasMany.html#foreign_key-instance_method" title="Mongoid::Association::Referenced::HasMany#foreign_key (method)">foreign_key</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid__base'>_base</span>.<span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_primary_key'>primary_key</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="update_or_delete_all-instance_method">
  <h3 class='signature priv'>
    #<strong>update_or_delete_all</strong>(removed)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>If the association is destructive, the matching documents will be removed. Otherwise, their foreign keys will be set to nil.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>removed</span>
    <span class='type'>(<a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>)</span>
&mdash;    <div class='inline'>
<p>The criteria for the documents to remove.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L556-L562'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='556' data-end='562'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 556</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_update_or_delete_all'>update_or_delete_all</span>(<span class='id identifier rubyid_removed'>removed</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_destructive?'>destructive?</span>
    <span class='id identifier rubyid_removed'>removed</span>.<span class='id identifier rubyid_delete_all'><a href="#delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete_all (method)">delete_all</a></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_removed'>removed</span>.<span class='id identifier rubyid_update_all'>update_all</span>(<span class='id identifier rubyid_foreign_key'><a href="../HasMany.html#foreign_key-instance_method" title="Mongoid::Association::Referenced::HasMany#foreign_key (method)">foreign_key</a></span> <span class='op'>=&gt;</span> <span class='kw'>nil</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="with_add_callbacks-instance_method">
  <h3 class='signature priv'>
    #<strong>with_add_callbacks</strong>(document, already_related)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Execute before/after add callbacks around the block unless the objects already have a persisted association.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Execute before/after add callbacks around the block.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_relation'><a href="../HasMany.html#relation-instance_method" title="Mongoid::Association::Referenced::HasMany#relation (method)">relation</a></span>.<span class='id identifier rubyid_with_add_callbacks'>with_add_callbacks</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='kw'>false</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../../../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to append to the target.</p>
</div>
  </li>
  <li>
    <span class='name'>already_related</span>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the document is already related to the target.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/association/referenced/has_many/proxy.rb#L376-L380'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='376' data-end='380'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/association/referenced/has_many/proxy.rb', line 376</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_with_add_callbacks'>with_add_callbacks</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_already_related'>already_related</span>)
  <span class='id identifier rubyid_execute_callback'>execute_callback</span> <span class='symbeg'>:</span><span class='id identifier rubyid_before_add'>before_add</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span> <span class='kw'>unless</span> <span class='id identifier rubyid_already_related'>already_related</span>
  <span class='kw'>yield</span>
  <span class='id identifier rubyid_execute_callback'>execute_callback</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_add'>after_add</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span> <span class='kw'>unless</span> <span class='id identifier rubyid_already_related'>already_related</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>