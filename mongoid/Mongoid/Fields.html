<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Mongoid::Fields &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongoid::Fields",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongoid master</a> &raquo; 
      <a href='../_index.html#alpha_F'>Index (F)</a> &raquo; 
        <a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Fields&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Mongoid::Fields</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="Fields/ClassMethods.html" title="Mongoid::Fields::ClassMethods (module)"><code>ClassMethods</code></a>,
        <a href="Fields/Validators.html" title="Mongoid::Fields::Validators (module)"><code>Validators</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Fields/Encrypted.html" title="Mongoid::Fields::Encrypted (class)"><code>Encrypted</code></a>,
        <a href="Fields/ForeignKey.html" title="Mongoid::Fields::ForeignKey (class)"><code>ForeignKey</code></a>,
        <a href="Fields/Localized.html" title="Mongoid::Fields::Localized (class)"><code>Localized</code></a>,
        <a href="Fields/Standard.html" title="Mongoid::Fields::Standard (class)"><code>Standard</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="Composable.html" title="Mongoid::Composable (module)"><code>Composable</code></a>,
          <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a>,
          <a href="GlobalDiscriminatorKeyAssignment/InvalidFieldHost.html" title="Mongoid::GlobalDiscriminatorKeyAssignment::InvalidFieldHost (class)"><code>GlobalDiscriminatorKeyAssignment::InvalidFieldHost</code></a>
      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          ActiveSupport::Concern
        </div>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L13'>lib/mongoid/fields.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields/encrypted.rb#L5'>lib/mongoid/fields/encrypted.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields/foreign_key.rb#L5'>lib/mongoid/fields/foreign_key.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields/localized.rb#L5'>lib/mongoid/fields/localized.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields/standard.rb#L5'>lib/mongoid/fields/standard.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields/validators/macro.rb#L5'>lib/mongoid/fields/validators/macro.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>This module defines behavior for fields.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='Boolean-constant' class='summary_signature'>Boolean =</span>
    <br/>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L17-L17'># File 'lib/mongoid/fields.rb', line 17</a>    <pre class='code ruby'><span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="Boolean.html" title="Mongoid::Boolean (class)">Boolean</a></span></pre>
  </li>
  <li>
    <span id='IDS-constant' class='summary_signature nodoc'>IDS =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Constant for all names of the _id field in a document.</p>

<p>This does not include aliases of _id field.</p>

  </div>
</div>
<div class='tags'>
  
</div>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L45-L45'># File 'lib/mongoid/fields.rb', line 45</a>    <pre class='code ruby'>[ <span class='symbeg'>:</span><span class='id identifier rubyid__id'>_id</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_id</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> ].<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='INVALID_BSON_CLASSES-constant' class='summary_signature nodoc'>INVALID_BSON_CLASSES =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><a href="../BSON.html" title="BSON (module)"><code>::BSON</code></a> classes that are not supported as field types</p>

  </div>
</div>
<div class='tags'>
  
</div>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L50-L50'># File 'lib/mongoid/fields.rb', line 50</a>    <pre class='code ruby'>[ <span class='const'><a href="../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../BSON/Decimal128.html" title="BSON::Decimal128 (class)">Decimal128</a></span><span class='comma'>,</span> <span class='const'><a href="../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'>Int32</span><span class='comma'>,</span> <span class='const'><a href="../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'>Int64</span> ].<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='StringifiedSymbol-constant' class='summary_signature'>StringifiedSymbol =</span>
    <br/>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L16-L16'># File 'lib/mongoid/fields.rb', line 16</a>    <pre class='code ruby'><span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="StringifiedSymbol.html" title="Mongoid::StringifiedSymbol (class)">StringifiedSymbol</a></span></pre>
  </li>
  <li>
    <span id='TRANSLATIONS_SFX-constant' class='summary_signature nodoc'>TRANSLATIONS_SFX =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The suffix for generated translated fields.</p>

  </div>
</div>
<div class='tags'>
  
</div>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L55-L55'># File 'lib/mongoid/fields.rb', line 55</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_translations</span><span class='tstring_end'>&#39;</span></span></pre>
  </li>
  <li>
    <span id='TYPE_MAPPINGS-constant' class='summary_signature'>TYPE_MAPPINGS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>For fields defined with symbols use the correct class.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L20-L38'># File 'lib/mongoid/fields.rb', line 20</a>    <pre class='code ruby'>{
  <span class='label'>array:</span> <span class='const'><a href="../Array.html" title="Array (class)">Array</a></span><span class='comma'>,</span>
  <span class='label'>big_decimal:</span> <span class='const'>BigDecimal</span><span class='comma'>,</span>
  <span class='label'>binary:</span> <span class='const'><a href="../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../BSON/Binary.html" title="BSON::Binary (class)">Binary</a></span><span class='comma'>,</span>
  <span class='label'>boolean:</span> <span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="Boolean.html" title="Mongoid::Boolean (class)">Boolean</a></span><span class='comma'>,</span>
  <span class='label'>date:</span> <span class='const'><a href="../Date.html" title="Date (class)">Date</a></span><span class='comma'>,</span>
  <span class='label'>date_time:</span> <span class='const'><a href="../DateTime.html" title="DateTime (class)">DateTime</a></span><span class='comma'>,</span>
  <span class='label'>float:</span> <span class='const'><a href="../Float.html" title="Float (class)">Float</a></span><span class='comma'>,</span>
  <span class='label'>hash:</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span><span class='comma'>,</span>
  <span class='label'>integer:</span> <span class='const'><a href="../Integer.html" title="Integer (class)">Integer</a></span><span class='comma'>,</span>
  <span class='label'>object_id:</span> <span class='const'><a href="../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../BSON/ObjectId.html" title="BSON::ObjectId (class)">ObjectId</a></span><span class='comma'>,</span>
  <span class='label'>range:</span> <span class='const'>Range</span><span class='comma'>,</span>
  <span class='label'>regexp:</span> <span class='const'><a href="../Regexp.html" title="Regexp (class)">Regexp</a></span><span class='comma'>,</span>
  <span class='label'>set:</span> <span class='const'><a href="../Set.html" title="Set (class)">Set</a></span><span class='comma'>,</span>
  <span class='label'>string:</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span><span class='comma'>,</span>
  <span class='label'>stringified_symbol:</span> <span class='const'><a href="#StringifiedSymbol-constant" title="Mongoid::Fields::StringifiedSymbol (constant)">StringifiedSymbol</a></span><span class='comma'>,</span>
  <span class='label'>symbol:</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span><span class='comma'>,</span>
  <span class='label'>time:</span> <span class='const'><a href="../Time.html" title="Time (class)">Time</a></span>
}.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#database_field_name-class_method" title=".database_field_name (class method)">.<strong>database_field_name</strong>(name, relations, aliased_fields, aliased_associations)  &#x21d2; String </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the name of the provided field as it is stored in the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#option-class_method" title=".option (class method)">.<strong>option</strong>(option_name, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Stores the provided block to be run when the option name specified is defined on a field.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#options-class_method" title=".options (class method)">.<strong>options</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return a map of custom option names to their handlers.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#traverse_association_tree-class_method" title=".traverse_association_tree (class method)">.<strong>traverse_association_tree</strong>(key, fields, associations, aliased_associations) {|The, The, Whether| ... } &#x21d2; Field </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Traverse down the association tree and search for the field for the given key.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#using_object_ids%3F-instance_method" title="#using_object_ids? (instance method)">#<strong>using_object_ids?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Is the document using object ids?</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#apply_default-instance_method" title="#apply_default (instance method)">#<strong>apply_default</strong>(name)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Applies a single default value for the given name.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#apply_defaults-instance_method" title="#apply_defaults (instance method)">#<strong>apply_defaults</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Apply all the defaults at once.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#apply_post_processed_defaults-instance_method" title="#apply_post_processed_defaults (instance method)">#<strong>apply_post_processed_defaults</strong>  &#x21d2; Array&lt;String&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Apply all default values to the document which are procs.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#apply_pre_processed_defaults-instance_method" title="#apply_pre_processed_defaults (instance method)">#<strong>apply_pre_processed_defaults</strong>  &#x21d2; Array&lt;String&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Apply all default values to the document which are not procs.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attribute_names-instance_method" title="#attribute_names (instance method)">#<strong>attribute_names</strong>  &#x21d2; Array&lt;String&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns an array of names for the attributes available on this object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#database_field_name-instance_method" title="#database_field_name (instance method)">#<strong>database_field_name</strong>(name)  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the name of the provided field as it is stored in the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#dot_dollar_field%3F-instance_method" title="#dot_dollar_field? (instance method)">#<strong>dot_dollar_field?</strong>(name)  &#x21d2; true | false </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Does this field start with a dollar sign ($) or contain a dot/period (.)?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#lazy_settable%3F-instance_method" title="#lazy_settable? (instance method)">#<strong>lazy_settable?</strong>(field, value)  &#x21d2; true | false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Is the provided field a lazy evaluation?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#validate_writable_field_name!-instance_method" title="#validate_writable_field_name! (instance method)">#<strong>validate_writable_field_name!</strong>(name)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Validate whether or not the field starts with a dollar sign ($) or contains a dot/period (.).</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>DSL Calls</h2>
<section class='method_details first' id="included-dslcall">
<h3 class='signature'><strong>included</strong></h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L129-L150'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 129</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_included'>included</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_aliased_fields'>aliased_fields</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_localized_fields'>localized_fields</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_fields'>fields</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_pre_processed_defaults'>pre_processed_defaults</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_post_processed_defaults'>post_processed_defaults</span>

  <span class='kw'>self</span>.<span class='id identifier rubyid_aliased_fields'>aliased_fields</span> <span class='op'>=</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span> }
  <span class='kw'>self</span>.<span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> {}
  <span class='kw'>self</span>.<span class='id identifier rubyid_localized_fields'>localized_fields</span> <span class='op'>=</span> {}
  <span class='kw'>self</span>.<span class='id identifier rubyid_pre_processed_defaults'>pre_processed_defaults</span> <span class='op'>=</span> []
  <span class='kw'>self</span>.<span class='id identifier rubyid_post_processed_defaults'>post_processed_defaults</span> <span class='op'>=</span> []

  <span class='id identifier rubyid_field'>field</span>(
    <span class='symbeg'>:</span><span class='id identifier rubyid__id'>_id</span><span class='comma'>,</span>
    <span class='label'>default:</span> <span class='tlambda'>-&gt;</span><span class='tlambeg'>{</span> <span class='const'><a href="../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../BSON/ObjectId.html" title="BSON::ObjectId (class)">ObjectId</a></span>.<span class='id identifier rubyid_new'>new</span> }<span class='comma'>,</span>
    <span class='label'>pre_processed:</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='label'>type:</span> <span class='const'><a href="../BSON.html" title="BSON (module)">BSON</a></span><span class='op'>::</span><span class='const'><a href="../BSON/ObjectId.html" title="BSON::ObjectId (class)">ObjectId</a></span>
  )

  <span class='id identifier rubyid_alias_attribute'>alias_attribute</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid__id'>_id</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="database_field_name-class_method">
  <h3 class='signature nodoc first'>
    .<strong>database_field_name</strong>(name, relations, aliased_fields, aliased_associations)  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the name of the provided field as it is stored in the database. Used in determining if the field is aliased or not. Recursively finds aliases for embedded documents and fields, delimited with period “.” character.</p>

<p>Note that this method returns the name of associations as they’re stored in the database, whereas the <code>relations</code> hash uses their in-code aliases. In order to check for membership in the relations hash, you would first have to look up the string returned from this method in the aliased_associations hash.</p>

<p>This method will not expand the alias of a belongs_to association that is not the last item. For example, if we had a School that has_many Students, and the field name passed was (from the Student’s perspective):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_school'>school</span>.<span class='id identifier rubyid__id'>_id</span></code></pre>

<p>The alias for a belongs_to association is that association’s _id field. Therefore, expanding out this association would yield:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_school_id'>school_id</span>.<span class='id identifier rubyid__id'>_id</span></code></pre>

<p>This is not the correct field name, because the intention here was not to get a property of the _id field. The intention was to get a property of the referenced document. Therefore, if a part of the name passed is a belongs_to association that is not the last part of the name, we won’t expand its alias, and return:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_school'>school</span>.<span class='id identifier rubyid__id'>_id</span></code></pre>

<p>If the belongs_to association is the last part of the name, we will pass back the _id field.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a> | <a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The name to get.</p>
</div>
  </li>
  <li>
    <span class='name'>relations</span>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The associations.</p>
</div>
  </li>
  <li>
    <span class='name'>aliased_fields</span>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The aliased fields.</p>
</div>
  </li>
  <li>
    <span class='name'>aliased_associations</span>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The aliased associations.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the field as stored in the database.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L415-L440'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='415' data-end='440'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 415</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_relations'>relations</span><span class='comma'>,</span> <span class='id identifier rubyid_aliased_fields'>aliased_fields</span><span class='comma'>,</span> <span class='id identifier rubyid_aliased_associations'>aliased_associations</span>)
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_present?'>present?</span>

  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_segment'>segment</span><span class='comma'>,</span> <span class='id identifier rubyid_remaining'>remaining</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span>)

  <span class='comment'># Don&#39;t get the alias for the field when a belongs_to association
</span>  <span class='comment'># is not the last item. Therefore, get the alias when one of the
</span>  <span class='comment'># following is true:
</span>  <span class='comment'># 1. This is the last item, i.e. there is no remaining.
</span>  <span class='comment'># 2. It is not an association.
</span>  <span class='comment'># 3. It is not a belongs association
</span>  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_remaining'>remaining</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_relations'>relations</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_segment'>segment</span>) <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_relations'>relations</span>[<span class='id identifier rubyid_segment'>segment</span>].<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Association.html" title="Mongoid::Association (module)">Association</a></span><span class='op'>::</span><span class='const'><a href="Association/Referenced.html" title="Mongoid::Association::Referenced (module)">Referenced</a></span><span class='op'>::</span><span class='const'><a href="Association/Referenced/BelongsTo.html" title="Mongoid::Association::Referenced::BelongsTo (class)">BelongsTo</a></span>)
    <span class='id identifier rubyid_segment'>segment</span> <span class='op'>=</span> <span class='id identifier rubyid_aliased_fields'>aliased_fields</span>[<span class='id identifier rubyid_segment'>segment</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_dup'>dup</span> <span class='op'>||</span> <span class='id identifier rubyid_segment'>segment</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_segment'>segment</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remaining'>remaining</span>

  <span class='id identifier rubyid_relation'>relation</span> <span class='op'>=</span> <span class='id identifier rubyid_relations'>relations</span>[<span class='id identifier rubyid_aliased_associations'>aliased_associations</span>[<span class='id identifier rubyid_segment'>segment</span>] <span class='op'>||</span> <span class='id identifier rubyid_segment'>segment</span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_relation'>relation</span>
    <span class='id identifier rubyid_k'>k</span> <span class='op'>=</span> <span class='id identifier rubyid_relation'>relation</span>.<span class='id identifier rubyid_klass'>klass</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_segment'>segment</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_remaining'>remaining</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span>.<span class='id identifier rubyid_relations'>relations</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span>.<span class='id identifier rubyid_aliased_fields'>aliased_fields</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span>.<span class='id identifier rubyid_aliased_associations'>aliased_associations</span>)<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_segment'>segment</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_remaining'>remaining</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="option-class_method">
  <h3 class='signature '>
    .<strong>option</strong>(option_name, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Stores the provided block to be run when the option name specified is defined on a field.</p>

<p>No assumptions are made about what functionality the handler might perform, so it will always be called if the <code>option_name</code> key is provided in the field definition – even if it is false or nil.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'>Fields</span>.<span class='id identifier rubyid_option'>option</span> <span class='symbeg'>:</span><span class='id identifier rubyid_required'>required</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_model'>model</span><span class='comma'>,</span> <span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
  <span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_validates_presence_of'>validates_presence_of</span> <span class='id identifier rubyid_field'>field</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>option_name</span>
    <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>the option name to match against</p>
</div>
  </li>
  <li>
    <span class='name'>&amp;block</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>the handler to execute when the option is provided.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L298-L300'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='298' data-end='300'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 298</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_option'>option</span>(<span class='id identifier rubyid_option_name'>option_name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_options'><a href="#options-class_method" title="Mongoid::Fields.options (method)">options</a></span>[<span class='id identifier rubyid_option_name'>option_name</span>] <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="options-class_method">
  <h3 class='signature '>
    .<strong>options</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return a map of custom option names to their handlers.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'>Fields</span>.<span class='id identifier rubyid_options'>options</span>
<span class='comment'># =&gt; { :required =&gt; #&lt;Proc:0x00000100976b38&gt; }</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>the option map</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L309-L311'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='309' data-end='311'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 309</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_options'>options</span>
  <span class='ivar'>@options</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="traverse_association_tree-class_method">
  <h3 class='signature nodoc'>
    .<strong>traverse_association_tree</strong>(key, fields, associations, aliased_associations) {|The, The, Whether| ... } &#x21d2; <code>Field</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Traverse down the association tree and search for the field for the given key. To do this, split the key by ‘.’ and for each part (meth) of the key:</p>
<ul><li>
<p>If the meth is a field, yield the meth, field, and is_field as true.</p>
</li><li>
<p>If the meth is an association, update the klass to the association’s klass, and yield the meth, klass, and is_field as false.</p>
</li></ul>

<p>The next iteration will use klass’s fields and associations to continue traversing the tree.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The key used to search the association tree.</p>
</div>
  </li>
  <li>
    <span class='name'>fields</span>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The fields to begin the search with.</p>
</div>
  </li>
  <li>
    <span class='name'>associations</span>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The associations to begin the search with.</p>
</div>
  </li>
  <li>
    <span class='name'>aliased_associations</span>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The aliased associations to begin the search with.</p>
</div>
  </li>
  <li>
    <span class='name'>&amp;block</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>The block.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>The</span>
    <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>current method.</p>
</div>
  </li>
  <li>
    <span class='name'>The</span>
    <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a> | <a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>field or the relation.</p>
</div>
  </li>
  <li>
    <span class='name'>Whether</span>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>the second yield parameter is a field or not.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Field</code>)</span>
&mdash;    <div class='inline'>
<p>The field found for the given key at the end of the search. This will return nil if the last thing found is an association or no field was found for the given key.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L340-L372'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='340' data-end='372'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 340</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_traverse_association_tree'>traverse_association_tree</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_fields'>fields</span><span class='comma'>,</span> <span class='id identifier rubyid_associations'>associations</span><span class='comma'>,</span> <span class='id identifier rubyid_aliased_associations'>aliased_associations</span>)
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_fs'>fs</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>?</span> <span class='id identifier rubyid_fields'>fields</span> <span class='op'>:</span> <span class='id identifier rubyid_klass'>klass</span><span class='op'>&amp;.</span><span class='id identifier rubyid_fields'>fields</span>
    <span class='id identifier rubyid_rs'>rs</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>?</span> <span class='id identifier rubyid_associations'>associations</span> <span class='op'>:</span> <span class='id identifier rubyid_klass'>klass</span><span class='op'>&amp;.</span><span class='id identifier rubyid_relations'>relations</span>
    <span class='id identifier rubyid_as'>as</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>?</span> <span class='id identifier rubyid_aliased_associations'>aliased_associations</span> <span class='op'>:</span> <span class='id identifier rubyid_klass'>klass</span><span class='op'>&amp;.</span><span class='id identifier rubyid_aliased_associations'>aliased_associations</span>

    <span class='comment'># Associations can possibly have two &quot;keys&quot;, their name and their alias.
</span>    <span class='comment'># The fields name is what is used to store it in the klass&#39;s relations
</span>    <span class='comment'># and field hashes, and the alias is what&#39;s used to store that field
</span>    <span class='comment'># in the database. The key inputted to this function is the aliased
</span>    <span class='comment'># key. We can convert them back to their names by looking in the
</span>    <span class='comment'># aliased_associations hash.
</span>    <span class='id identifier rubyid_aliased'>aliased</span> <span class='op'>=</span> <span class='id identifier rubyid_meth'>meth</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_as'>as</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_as'>as</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='kw'>nil</span>)
      <span class='id identifier rubyid_aliased'>aliased</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_to_s'>to_s</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_fs'>fs</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_fs'>fs</span>[<span class='id identifier rubyid_aliased'>aliased</span>]
      <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span>
      <span class='kw'>yield</span>(<span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='comma'>,</span> <span class='kw'>true</span>) <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_rs'>rs</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rel'>rel</span> <span class='op'>=</span> <span class='id identifier rubyid_rs'>rs</span>[<span class='id identifier rubyid_aliased'>aliased</span>]
      <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_rel'>rel</span>.<span class='id identifier rubyid_klass'>klass</span>
      <span class='kw'>yield</span>(<span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_rel'>rel</span><span class='comma'>,</span> <span class='kw'>false</span>) <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>else</span>
      <span class='kw'>yield</span>(<span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>false</span>) <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_field'>field</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="using_object_ids?-instance_method">
  <h3 class='signature ro first'>
    #<strong>using_object_ids?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Refactored from using delegate for class load performance.</p>
</div>
  </div>


<p>Is the document using object ids?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the document using object ids?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_using_object_ids?'>using_object_ids?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Using object ids.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L252-L254'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='252' data-end='254'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 252</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_using_object_ids?'>using_object_ids?</span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_using_object_ids?'>using_object_ids?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="apply_default-instance_method">
  <h3 class='signature  first'>
    #<strong>apply_default</strong>(name)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Applies a single default value for the given name.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Apply a single default.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_apply_default'>apply_default</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the field.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L183-L193'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='183' data-end='193'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 183</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_default'>apply_default</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>unless</span> <span class='id identifier rubyid_attributes'>attributes</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_name'>name</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span>[<span class='id identifier rubyid_name'>name</span>]
      <span class='id identifier rubyid_default'>default</span> <span class='op'>=</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_eval_default'>eval_default</span>(<span class='kw'>self</span>)
      <span class='kw'>unless</span> <span class='id identifier rubyid_default'>default</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_lazy?'>lazy?</span>
        <span class='id identifier rubyid_attribute_will_change!'>attribute_will_change!</span>(<span class='id identifier rubyid_name'>name</span>)
        <span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_name'>name</span>] <span class='op'>=</span> <span class='id identifier rubyid_default'>default</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="apply_defaults-instance_method">
  <h3 class='signature '>
    #<strong>apply_defaults</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Apply all the defaults at once.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Apply all the defaults.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_apply_defaults'>apply_defaults</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L199-L203'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='199' data-end='203'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 199</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_defaults'>apply_defaults</span>
  <span class='id identifier rubyid_pending_callbacks'>pending_callbacks</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_apply_defaults'>apply_defaults</span>)
  <span class='id identifier rubyid_apply_pre_processed_defaults'><a href="#apply_pre_processed_defaults-instance_method" title="Mongoid::Fields#apply_pre_processed_defaults (method)">apply_pre_processed_defaults</a></span>
  <span class='id identifier rubyid_apply_post_processed_defaults'><a href="#apply_post_processed_defaults-instance_method" title="Mongoid::Fields#apply_post_processed_defaults (method)">apply_post_processed_defaults</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="apply_post_processed_defaults-instance_method">
  <h3 class='signature '>
    #<strong>apply_post_processed_defaults</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Apply all default values to the document which are procs.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Apply all the proc defaults.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_apply_post_processed_defaults'>apply_post_processed_defaults</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The names of the proc defaults.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L170-L175'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='170' data-end='175'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 170</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_post_processed_defaults'>apply_post_processed_defaults</span>
  <span class='id identifier rubyid_pending_callbacks'>pending_callbacks</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_apply_post_processed_defaults'>apply_post_processed_defaults</span>)
  <span class='id identifier rubyid_post_processed_defaults'>post_processed_defaults</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='id identifier rubyid_apply_default'><a href="#apply_default-instance_method" title="Mongoid::Fields#apply_default (method)">apply_default</a></span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="apply_pre_processed_defaults-instance_method">
  <h3 class='signature '>
    #<strong>apply_pre_processed_defaults</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Apply all default values to the document which are not procs.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Apply all the non-proc defaults.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_apply_pre_processed_defaults'>apply_pre_processed_defaults</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The names of the non-proc defaults.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L158-L162'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='158' data-end='162'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 158</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_pre_processed_defaults'>apply_pre_processed_defaults</span>
  <span class='id identifier rubyid_pre_processed_defaults'>pre_processed_defaults</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='id identifier rubyid_apply_default'><a href="#apply_default-instance_method" title="Mongoid::Fields#apply_default (method)">apply_default</a></span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attribute_names-instance_method">
  <h3 class='signature '>
    #<strong>attribute_names</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns an array of names for the attributes available on this object.</p>

<p>Provides the field names in an ORM-agnostic way. <a href="../Rails.html" title="Rails (module)"><code>::Rails</code></a> v3.1+ uses this method to automatically wrap params in JSON requests.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the field names</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_attribute_names'>attribute_names</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The field names</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L214-L216'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='214' data-end='216'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 214</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_names'>attribute_names</span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_attribute_names'>attribute_names</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="database_field_name-instance_method">
  <h3 class='signature '>
    #<strong>database_field_name</strong>(name)  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the name of the provided field as it is stored in the database. Used in determining if the field is aliased or not.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the database field name.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_authorization'>authorization</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a> | <a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The name to get.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the field as it’s stored in the db.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L227-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='227' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 227</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_name'>name</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="dot_dollar_field?-instance_method">
  <h3 class='signature nodoc'>
    #<strong>dot_dollar_field?</strong>(name)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Does this field start with a dollar sign ($) or contain a dot/period (.)?</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The field name.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If this field is dotted or dollared.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L263-L266'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='263' data-end='266'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 263</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_dot_dollar_field?'>dot_dollar_field?</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_aliased_fields'>aliased_fields</span>[<span class='id identifier rubyid_name'>name</span>] <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_fields'>fields</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_n'>n</span>) <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_n'>n</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_n'>n</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$</span><span class='tstring_end'>&#39;</span></span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="lazy_settable?-instance_method">
  <h3 class='signature '>
    #<strong>lazy_settable?</strong>(field, value)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is the provided field a lazy evaluation?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>If the field is lazy settable.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_lazy_settable?'>lazy_settable?</span>(<span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='kw'>nil</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>field</span>
    <span class='type'>(<code>Field</code>)</span>
&mdash;    <div class='inline'>
<p>The field.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The current value.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If we set the field lazily.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L240-L242'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='240' data-end='242'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 240</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_lazy_settable?'>lazy_settable?</span>(<span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='op'>!</span><span class='id identifier rubyid_frozen?'>frozen?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_lazy?'>lazy?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validate_writable_field_name!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>validate_writable_field_name!</strong>(name)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Validate whether or not the field starts with a dollar sign ($) or contains a dot/period (.).</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The field name.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>InvalidDotDollarAssignment</code>)</span>
&mdash;    <div class='inline'>
<p>If contains dots or starts with a dollar.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/fields.rb#L276-L280'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='276' data-end='280'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/fields.rb', line 276</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_writable_field_name!'>validate_writable_field_name!</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_dot_dollar_field?'><a href="#dot_dollar_field%3F-instance_method" title="Mongoid::Fields#dot_dollar_field? (method)">dot_dollar_field?</a></span>(<span class='id identifier rubyid_name'>name</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Errors.html" title="Mongoid::Errors (module)">Errors</a></span><span class='op'>::</span><span class='const'><a href="Errors/InvalidDotDollarAssignment.html" title="Mongoid::Errors::InvalidDotDollarAssignment (class)">InvalidDotDollarAssignment</a></span>.<span class='id identifier rubyid_new'><a href="Errors/InvalidDotDollarAssignment.html#new-class_method" title="Mongoid::Errors::InvalidDotDollarAssignment.new (method)">new</a></span>(<span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>