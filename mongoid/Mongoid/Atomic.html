<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Mongoid::Atomic &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongoid::Atomic",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongoid master</a> &raquo; 
      <a href='../_index.html#alpha_A'>Index (A)</a> &raquo; 
        <a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Atomic&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Mongoid::Atomic</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="Atomic/Paths.html" title="Mongoid::Atomic::Paths (module)"><code>Paths</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Atomic/Modifiers.html" title="Mongoid::Atomic::Modifiers (class)"><code>Modifiers</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="Composable.html" title="Mongoid::Composable (module)"><code>Composable</code></a>,
          <a href="Contextual/Mongo.html" title="Mongoid::Contextual::Mongo (class)"><code>Contextual::Mongo</code></a>,
          <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a>,
          <a href="GlobalDiscriminatorKeyAssignment/InvalidFieldHost.html" title="Mongoid::GlobalDiscriminatorKeyAssignment::InvalidFieldHost (class)"><code>GlobalDiscriminatorKeyAssignment::InvalidFieldHost</code></a>
      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          ActiveSupport::Concern
        </div>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L9'>lib/mongoid/atomic.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic/modifiers.rb#L5'>lib/mongoid/atomic/modifiers.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic/paths/embedded.rb#L8'>lib/mongoid/atomic/paths/embedded.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic/paths/root.rb#L5'>lib/mongoid/atomic/paths/root.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic/paths/embedded/many.rb#L5'>lib/mongoid/atomic/paths/embedded/many.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic/paths/embedded/one.rb#L5'>lib/mongoid/atomic/paths/embedded/one.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>This module contains the logic for supporting atomic operations against the database.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='UPDATES-constant' class='summary_signature'>UPDATES =</span>
    <br/>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L12-L20'># File 'lib/mongoid/atomic.rb', line 12</a>    <pre class='code ruby'><span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>atomic_array_pushes</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>atomic_array_pulls</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>atomic_array_add_to_sets</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>atomic_pulls</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>delayed_atomic_sets</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>delayed_atomic_pulls</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>delayed_atomic_unsets</span><span class='words_sep'>
</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#_updates-instance_method" title="#_updates (instance method)">#<strong>_updates</strong>(_use_indexes = false)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#atomic_updates-instance_method" title="Mongoid::Atomic#atomic_updates (method)">#atomic_updates</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_atomic_pull-instance_method" title="#add_atomic_pull (instance method)">#<strong>add_atomic_pull</strong>(document)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Add the document as an atomic pull.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_atomic_unset-instance_method" title="#add_atomic_unset (instance method)">#<strong>add_atomic_unset</strong>(document)  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Add an atomic unset for the document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_array_add_to_sets-instance_method" title="#atomic_array_add_to_sets (instance method)">#<strong>atomic_array_add_to_sets</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>For array fields these are the unique adds that need to happen.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_array_pulls-instance_method" title="#atomic_array_pulls (instance method)">#<strong>atomic_array_pulls</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>For array fields these are the pulls that need to happen.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_array_pushes-instance_method" title="#atomic_array_pushes (instance method)">#<strong>atomic_array_pushes</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>For array fields these are the pushes that need to happen.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_attribute_name-instance_method" title="#atomic_attribute_name (instance method)">#<strong>atomic_attribute_name</strong>(name)  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns path of the attribute for modification.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_delete_modifier-instance_method" title="#atomic_delete_modifier (instance method)">#<strong>atomic_delete_modifier</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the removal modifier for the document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_insert_modifier-instance_method" title="#atomic_insert_modifier (instance method)">#<strong>atomic_insert_modifier</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the insertion modifier for the document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_path-instance_method" title="#atomic_path (instance method)">#<strong>atomic_path</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return the path to this <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a> in JSON notation, used for atomic updates via $set in MongoDB.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_paths-instance_method" title="#atomic_paths (instance method)">#<strong>atomic_paths</strong>  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the atomic paths utility for this document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_position-instance_method" title="#atomic_position (instance method)">#<strong>atomic_position</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the positional operator of this document for modification.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_pulls-instance_method" title="#atomic_pulls (instance method)">#<strong>atomic_pulls</strong>  &#x21d2; Array&lt;Hash&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the attributes that need to be pulled.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_pushes-instance_method" title="#atomic_pushes (instance method)">#<strong>atomic_pushes</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the push attributes that need to occur.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_sets-instance_method" title="#atomic_sets (instance method)">#<strong>atomic_sets</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the attributes that need to be set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_unsets-instance_method" title="#atomic_unsets (instance method)">#<strong>atomic_unsets</strong>  &#x21d2; Array&lt;Hash&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the attributes that need to be unset.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#atomic_updates-instance_method" title="#atomic_updates (instance method)">#<strong>atomic_updates</strong>(_use_indexes = false)  &#x21d2; Hash </a>
      (also: #_updates)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the atomic updates that need to happen for the current <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delayed_atomic_pulls-instance_method" title="#delayed_atomic_pulls (instance method)">#<strong>delayed_atomic_pulls</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a hash of atomic pulls that are pending.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delayed_atomic_sets-instance_method" title="#delayed_atomic_sets (instance method)">#<strong>delayed_atomic_sets</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the atomic sets that have had their saves delayed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delayed_atomic_unsets-instance_method" title="#delayed_atomic_unsets (instance method)">#<strong>delayed_atomic_unsets</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the delayed atomic unsets.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#flag_as_destroyed-instance_method" title="#flag_as_destroyed (instance method)">#<strong>flag_as_destroyed</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Flag the document as destroyed and return the atomic path.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#flagged_destroys-instance_method" title="#flagged_destroys (instance method)">#<strong>flagged_destroys</strong>  &#x21d2; Array&lt;Proc&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the flagged destroys.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_flagged_destroys-instance_method" title="#process_flagged_destroys (instance method)">#<strong>process_flagged_destroys</strong>  &#x21d2; Array </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Process all the pending flagged destroys from nested attributes.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#generate_atomic_updates-instance_method" title="#generate_atomic_updates (instance method)">#<strong>generate_atomic_updates</strong>(mods, doc)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Generates the atomic updates in the correct order.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#reset_atomic_updates!-instance_method" title="#reset_atomic_updates! (instance method)">#<strong>reset_atomic_updates!</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Clears all pending atomic updates.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>DSL Calls</h2>
<section class='method_details first' id="included-dslcall">
<h3 class='signature'><strong>included</strong></h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L22-L26'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


22
23
24
25
26</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 22</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_included'>included</span> <span class='kw'>do</span>
  <span class='comment'># When MongoDB finally fully implements the positional operator, we can
</span>  <span class='comment'># get rid of all indexing related code in Mongoid.
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid__index'>_index</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="_updates-instance_method">
  <h3 class='signature  first'>
    #<strong>_updates</strong>(_use_indexes = false)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#atomic_updates-instance_method" title="Mongoid::Atomic#atomic_updates (method)">#atomic_updates</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L129-L129'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='129' data-end='129'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 129</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid__updates'>_updates</span> <span class='id identifier rubyid_atomic_updates'><a href="#atomic_updates-instance_method" title="Mongoid::Atomic#atomic_updates (method)">atomic_updates</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_atomic_pull-instance_method">
  <h3 class='signature '>
    #<strong>add_atomic_pull</strong>(document)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Add the document as an atomic pull.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Add the atomic pull.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_add_atomic_pull'>add_atomic_pull</span>(<span class='id identifier rubyid_address'>address</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The embedded document to pull.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L34-L39'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='34' data-end='39'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 34</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_atomic_pull'>add_atomic_pull</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_flagged_for_destroy'>flagged_for_destroy</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_association_name'>association_name</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_delayed_atomic_pulls'><a href="#delayed_atomic_pulls-instance_method" title="Mongoid::Atomic#delayed_atomic_pulls (method)">delayed_atomic_pulls</a></span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>||=</span> []
  <span class='id identifier rubyid_delayed_atomic_pulls'><a href="#delayed_atomic_pulls-instance_method" title="Mongoid::Atomic#delayed_atomic_pulls (method)">delayed_atomic_pulls</a></span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_document'>document</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_atomic_unset-instance_method">
  <h3 class='signature '>
    #<strong>add_atomic_unset</strong>(document)  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Add an atomic unset for the document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Add an atomic unset.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_add_atomic_unset'>add_atomic_unset</span>(<span class='id identifier rubyid_doc'>doc</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The child document.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The children.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L49-L54'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='49' data-end='54'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 49</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_atomic_unset'>add_atomic_unset</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_flagged_for_destroy'>flagged_for_destroy</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_association_name'>association_name</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_delayed_atomic_unsets'><a href="#delayed_atomic_unsets-instance_method" title="Mongoid::Atomic#delayed_atomic_unsets (method)">delayed_atomic_unsets</a></span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>||=</span> []
  <span class='id identifier rubyid_delayed_atomic_unsets'><a href="#delayed_atomic_unsets-instance_method" title="Mongoid::Atomic#delayed_atomic_unsets (method)">delayed_atomic_unsets</a></span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_document'>document</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_array_add_to_sets-instance_method">
  <h3 class='signature '>
    #<strong>atomic_array_add_to_sets</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>For array fields these are the unique adds that need to happen.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the array unique adds.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_array_add_to_sets'>atomic_array_add_to_sets</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The array add_to_sets.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L92-L94'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='92' data-end='94'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 92</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_array_add_to_sets'>atomic_array_add_to_sets</span>
  <span class='ivar'>@atomic_array_add_to_sets</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_array_pulls-instance_method">
  <h3 class='signature '>
    #<strong>atomic_array_pulls</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>For array fields these are the pulls that need to happen.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the array pulls.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_array_pulls'>atomic_array_pulls</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The array pulls.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L82-L84'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='82' data-end='84'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 82</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_array_pulls'>atomic_array_pulls</span>
  <span class='ivar'>@atomic_array_pulls</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_array_pushes-instance_method">
  <h3 class='signature '>
    #<strong>atomic_array_pushes</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>For array fields these are the pushes that need to happen.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the array pushes.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_array_pushes'>atomic_array_pushes</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The array pushes.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L72-L74'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='72' data-end='74'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 72</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_array_pushes'>atomic_array_pushes</span>
  <span class='ivar'>@atomic_array_pushes</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_attribute_name-instance_method">
  <h3 class='signature '>
    #<strong>atomic_attribute_name</strong>(name)  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns path of the attribute for modification</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get path of the attribute</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_address'>address</span>.<span class='id identifier rubyid_atomic_attribute_name'>atomic_attribute_name</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_city'>city</span>)</code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The path to the document attribute in the database</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L62-L64'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='62' data-end='64'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 62</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_attribute_name'>atomic_attribute_name</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_embedded?'>embedded?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_atomic_position'><a href="#atomic_position-instance_method" title="Mongoid::Atomic#atomic_position (method)">atomic_position</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_delete_modifier-instance_method">
  <h3 class='signature '>
    #<strong>atomic_delete_modifier</strong>  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the removal modifier for the document. Will be nil on root documents, $unset on embeds_one, $set on embeds_many.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the removal operator.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_atomic_delete_modifier'>atomic_delete_modifier</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The pull or unset operation.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L139-L141'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='139' data-end='141'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 139</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_delete_modifier'>atomic_delete_modifier</span>
  <span class='id identifier rubyid_atomic_paths'><a href="#atomic_paths-instance_method" title="Mongoid::Atomic#atomic_paths (method)">atomic_paths</a></span>.<span class='id identifier rubyid_delete_modifier'>delete_modifier</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_insert_modifier-instance_method">
  <h3 class='signature '>
    #<strong>atomic_insert_modifier</strong>  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the insertion modifier for the document. Will be nil on root documents, $set on embeds_one, $push on embeds_many.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the insert operation.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_atomic_insert_modifier'>atomic_insert_modifier</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The pull or set operator.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L150-L152'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='150' data-end='152'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 150</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_insert_modifier'>atomic_insert_modifier</span>
  <span class='id identifier rubyid_atomic_paths'><a href="#atomic_paths-instance_method" title="Mongoid::Atomic#atomic_paths (method)">atomic_paths</a></span>.<span class='id identifier rubyid_insert_modifier'>insert_modifier</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_path-instance_method">
  <h3 class='signature '>
    #<strong>atomic_path</strong>  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return the path to this <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a> in JSON notation, used for atomic updates via $set in MongoDB.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the path to this document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_address'>address</span>.<span class='id identifier rubyid_atomic_path'>atomic_path</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The path to the document in the database.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L161-L163'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='161' data-end='163'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 161</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_path'>atomic_path</span>
  <span class='id identifier rubyid_atomic_paths'><a href="#atomic_paths-instance_method" title="Mongoid::Atomic#atomic_paths (method)">atomic_paths</a></span>.<span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_paths-instance_method">
  <h3 class='signature '>
    #<strong>atomic_paths</strong>  &#x21d2; <code>Object</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the atomic paths utility for this document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the atomic paths.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_atomic_paths'>atomic_paths</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The associated path.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L181-L191'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='181' data-end='191'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 181</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_paths'>atomic_paths</span>
  <span class='kw'>return</span> <span class='ivar'>@atomic_paths</span> <span class='kw'>if</span> <span class='ivar'>@atomic_paths</span>

  <span class='id identifier rubyid_paths'>paths</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid__association'>_association</span>
            <span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_path'>path</span>(<span class='kw'>self</span>)
          <span class='kw'>else</span>
            <span class='const'>Atomic</span><span class='op'>::</span><span class='const'><a href="Atomic/Paths.html" title="Mongoid::Atomic::Paths (module)">Paths</a></span><span class='op'>::</span><span class='const'><a href="Atomic/Paths/Root.html" title="Mongoid::Atomic::Paths::Root (class)">Root</a></span>.<span class='id identifier rubyid_new'><a href="Atomic/Paths/Root.html#new-class_method" title="Mongoid::Atomic::Paths::Root.new (method)">new</a></span>(<span class='kw'>self</span>)
          <span class='kw'>end</span>

  <span class='id identifier rubyid_paths'>paths</span>.<span class='id identifier rubyid_tap'>tap</span> { <span class='ivar'>@atomic_paths</span> <span class='op'>=</span> <span class='id identifier rubyid_paths'>paths</span> <span class='kw'>unless</span> <span class='id identifier rubyid_new_record?'>new_record?</span> }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_position-instance_method">
  <h3 class='signature '>
    #<strong>atomic_position</strong>  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the positional operator of this document for modification.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the positional operator.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_address'>address</span>.<span class='id identifier rubyid_atomic_position'>atomic_position</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The positional operator with indexes.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L171-L173'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='171' data-end='173'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 171</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_position'>atomic_position</span>
  <span class='id identifier rubyid_atomic_paths'><a href="#atomic_paths-instance_method" title="Mongoid::Atomic#atomic_paths (method)">atomic_paths</a></span>.<span class='id identifier rubyid_position'>position</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_pulls-instance_method">
  <h3 class='signature '>
    #<strong>atomic_pulls</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../Hash.html" title="Hash (class)">Hash</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all the attributes that need to be pulled.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the pulls.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_pulls'>atomic_pulls</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../Hash.html" title="Hash (class)">Hash</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The $pullAll operations.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L199-L210'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='199' data-end='210'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 199</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_pulls'>atomic_pulls</span>
  <span class='id identifier rubyid_pulls'>pulls</span> <span class='op'>=</span> {}
  <span class='id identifier rubyid_delayed_atomic_pulls'><a href="#delayed_atomic_pulls-instance_method" title="Mongoid::Atomic#delayed_atomic_pulls (method)">delayed_atomic_pulls</a></span>.<span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='op'>|</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_ids'>ids</span> <span class='op'>=</span> <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
      <span class='id identifier rubyid_path'>path</span> <span class='op'>||=</span> <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_flag_as_destroyed'><a href="#flag_as_destroyed-instance_method" title="Mongoid::Atomic#flag_as_destroyed (method)">flag_as_destroyed</a></span>
      <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid__id'>_id</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_pulls'>pulls</span>[<span class='id identifier rubyid_path'>path</span>] <span class='op'>=</span> { <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_id</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> { <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$in</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ids'>ids</span> } } <span class='kw'>and</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_pulls'>pulls</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_pushes-instance_method">
  <h3 class='signature '>
    #<strong>atomic_pushes</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all the push attributes that need to occur.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the pushes.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_pushes'>atomic_pushes</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The $push and $each operations.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L218-L220'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='218' data-end='220'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 218</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_pushes'>atomic_pushes</span>
  <span class='id identifier rubyid_pushable?'>pushable?</span> <span class='op'>?</span> { <span class='id identifier rubyid_atomic_position'><a href="#atomic_position-instance_method" title="Mongoid::Atomic#atomic_position (method)">atomic_position</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_as_attributes'>as_attributes</span> } <span class='op'>:</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_sets-instance_method">
  <h3 class='signature '>
    #<strong>atomic_sets</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all the attributes that need to be set.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the sets.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_sets'>atomic_sets</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The $set operations.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L228-L236'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='228' data-end='236'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 228</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_sets'>atomic_sets</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_updateable?'>updateable?</span>
    <span class='id identifier rubyid_setters'>setters</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_settable?'>settable?</span>
    { <span class='id identifier rubyid_atomic_path'><a href="#atomic_path-instance_method" title="Mongoid::Atomic#atomic_path (method)">atomic_path</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_as_attributes'>as_attributes</span> }
  <span class='kw'>else</span>
    {}
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_unsets-instance_method">
  <h3 class='signature '>
    #<strong>atomic_unsets</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../Hash.html" title="Hash (class)">Hash</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all the attributes that need to be unset.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the unsets.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_unsets'>atomic_unsets</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../Hash.html" title="Hash (class)">Hash</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The $unset operations.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L244-L254'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='244' data-end='254'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 244</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_unsets'>atomic_unsets</span>
  <span class='id identifier rubyid_unsets'>unsets</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_delayed_atomic_unsets'><a href="#delayed_atomic_unsets-instance_method" title="Mongoid::Atomic#delayed_atomic_unsets (method)">delayed_atomic_unsets</a></span>.<span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='op'>|</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_docs'>docs</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
      <span class='id identifier rubyid_path'>path</span> <span class='op'>||=</span> <span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_flag_as_destroyed'><a href="#flag_as_destroyed-instance_method" title="Mongoid::Atomic#flag_as_destroyed (method)">flag_as_destroyed</a></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_unsets'>unsets</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_path'>path</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_unsets'>unsets</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="atomic_updates-instance_method">
  <h3 class='signature '>
    #<strong>atomic_updates</strong>(_use_indexes = false)  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
    <span class='aliases'>Also known as: <span class='names'>#_updates</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>MongoDB does not allow “conflicting modifications” to be performed in a single operation. Conflicting modifications are detected by the ‘haveConflictingMod’ function in MongoDB. Examination of the code suggests that two modifications (a $set and a $push with $each, for example) conflict if:</p>

<pre class="code ruby"><code class="ruby">(<span class='int'>1</span>) <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_key'>key</span> <span class='id identifier rubyid_paths'>paths</span> <span class='id identifier rubyid_being'>being</span> <span class='id identifier rubyid_modified'>modified</span> <span class='id identifier rubyid_are'>are</span> <span class='id identifier rubyid_equal'>equal</span>.
(<span class='int'>2</span>) <span class='id identifier rubyid_one'>one</span> <span class='id identifier rubyid_key'>key</span> <span class='id identifier rubyid_path'>path</span> <span class='id identifier rubyid_is'>is</span> <span class='id identifier rubyid_a'>a</span> <span class='id identifier rubyid_prefix'>prefix</span> <span class='id identifier rubyid_of'>of</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_other'>other</span>.</code></pre>

<p>So a $set of ‘addresses.0.street’ will conflict with a $push and $each to ‘addresses’, and we will need to split our update into two pieces. We do not, however, attempt to match MongoDB’s logic exactly. Instead, we assume that two updates conflict if the first component of the two key paths matches.</p>
</div>
  </div>


<p>Get all the atomic updates that need to happen for the current <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a>. This includes all changes that need to happen in the entire hierarchy that exists below where the save call was made.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the updates that need to occur.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_atomic_updates'>atomic_updates</span>(<span class='id identifier rubyid_children'>children</span>)</code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The updates and their modifiers.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L119-L128'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='119' data-end='128'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 119</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_atomic_updates'>atomic_updates</span>(<span class='id identifier rubyid__use_indexes'>_use_indexes</span> <span class='op'>=</span> <span class='kw'>false</span>)
  <span class='id identifier rubyid_process_flagged_destroys'><a href="#process_flagged_destroys-instance_method" title="Mongoid::Atomic#process_flagged_destroys (method)">process_flagged_destroys</a></span>
  <span class='id identifier rubyid_mods'>mods</span> <span class='op'>=</span> <span class='const'><a href="Atomic/Modifiers.html" title="Mongoid::Atomic::Modifiers (class)">Modifiers</a></span>.<span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_generate_atomic_updates'><a href="#generate_atomic_updates-instance_method" title="Mongoid::Atomic#generate_atomic_updates (method)">generate_atomic_updates</a></span>(<span class='id identifier rubyid_mods'>mods</span><span class='comma'>,</span> <span class='kw'>self</span>)
  <span class='id identifier rubyid__descendants'>_descendants</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span>
    <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid_process_flagged_destroys'><a href="#process_flagged_destroys-instance_method" title="Mongoid::Atomic#process_flagged_destroys (method)">process_flagged_destroys</a></span>
    <span class='id identifier rubyid_generate_atomic_updates'><a href="#generate_atomic_updates-instance_method" title="Mongoid::Atomic#generate_atomic_updates (method)">generate_atomic_updates</a></span>(<span class='id identifier rubyid_mods'>mods</span><span class='comma'>,</span> <span class='id identifier rubyid_child'>child</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_mods'>mods</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delayed_atomic_pulls-instance_method">
  <h3 class='signature '>
    #<strong>delayed_atomic_pulls</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a hash of atomic pulls that are pending.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the atomic pulls.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_delayed_atomic_pulls'>delayed_atomic_pulls</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>name/document pairs.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L272-L274'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='272' data-end='274'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 272</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delayed_atomic_pulls'>delayed_atomic_pulls</span>
  <span class='ivar'>@delayed_atomic_pulls</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delayed_atomic_sets-instance_method">
  <h3 class='signature '>
    #<strong>delayed_atomic_sets</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all the atomic sets that have had their saves delayed.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the delayed atomic sets.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_delayed_atomic_sets'>delayed_atomic_sets</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The delayed $sets.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L262-L264'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='262' data-end='264'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 262</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delayed_atomic_sets'>delayed_atomic_sets</span>
  <span class='ivar'>@delayed_atomic_sets</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delayed_atomic_unsets-instance_method">
  <h3 class='signature '>
    #<strong>delayed_atomic_unsets</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the delayed atomic unsets.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the delayed atomic unsets.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_delayed_atomic_unsets'>delayed_atomic_unsets</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>The atomic unsets</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L282-L284'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='282' data-end='284'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 282</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delayed_atomic_unsets'>delayed_atomic_unsets</span>
  <span class='ivar'>@delayed_atomic_unsets</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="flag_as_destroyed-instance_method">
  <h3 class='signature '>
    #<strong>flag_as_destroyed</strong>  &#x21d2; <a href="../String.html" title="String (class)">String</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Flag the document as destroyed and return the atomic path.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Flag destroyed and return path.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_flag_as_destroyed'>flag_as_destroyed</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The atomic path.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L292-L296'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='292' data-end='296'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 292</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_flag_as_destroyed'>flag_as_destroyed</span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_destroyed'>destroyed</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_flagged_for_destroy'>flagged_for_destroy</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_atomic_path'><a href="#atomic_path-instance_method" title="Mongoid::Atomic#atomic_path (method)">atomic_path</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="flagged_destroys-instance_method">
  <h3 class='signature '>
    #<strong>flagged_destroys</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Proc</code>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the flagged destroys.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the flagged destroy.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_flagged_destroys'>flagged_destroys</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Proc</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The flagged destroys.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L304-L306'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='304' data-end='306'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 304</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_flagged_destroys'>flagged_destroys</span>
  <span class='ivar'>@flagged_destroys</span> <span class='op'>||=</span> []
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="generate_atomic_updates-instance_method">
  <h3 class='signature priv'>
    #<strong>generate_atomic_updates</strong>(mods, doc)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Generates the atomic updates in the correct order.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Generate the updates.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_generate_atomic_updates'>generate_atomic_updates</span>(<span class='id identifier rubyid_mods'>mods</span><span class='comma'>,</span> <span class='id identifier rubyid_doc'>doc</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>mods</span>
    <span class='type'>(<a href="Atomic/Modifiers.html" title="Mongoid::Atomic::Modifiers (class)">Modifiers</a>)</span>
&mdash;    <div class='inline'>
<p>The atomic modifications.</p>
</div>
  </li>
  <li>
    <span class='name'>doc</span>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to update for.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L337-L346'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='337' data-end='346'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 337</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_atomic_updates'>generate_atomic_updates</span>(<span class='id identifier rubyid_mods'>mods</span><span class='comma'>,</span> <span class='id identifier rubyid_doc'>doc</span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_unset'>unset</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_atomic_unsets'><a href="#atomic_unsets-instance_method" title="Mongoid::Atomic#atomic_unsets (method)">atomic_unsets</a></span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_pull'>pull</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_atomic_pulls'><a href="#atomic_pulls-instance_method" title="Mongoid::Atomic#atomic_pulls (method)">atomic_pulls</a></span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_set'>set</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_atomic_sets'><a href="#atomic_sets-instance_method" title="Mongoid::Atomic#atomic_sets (method)">atomic_sets</a></span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_set'>set</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_delayed_atomic_sets'><a href="#delayed_atomic_sets-instance_method" title="Mongoid::Atomic#delayed_atomic_sets (method)">delayed_atomic_sets</a></span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_atomic_pushes'><a href="#atomic_pushes-instance_method" title="Mongoid::Atomic#atomic_pushes (method)">atomic_pushes</a></span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_atomic_array_pushes'><a href="#atomic_array_pushes-instance_method" title="Mongoid::Atomic#atomic_array_pushes (method)">atomic_array_pushes</a></span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_add_to_set'>add_to_set</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_atomic_array_add_to_sets'><a href="#atomic_array_add_to_sets-instance_method" title="Mongoid::Atomic#atomic_array_add_to_sets (method)">atomic_array_add_to_sets</a></span>)
  <span class='id identifier rubyid_mods'>mods</span>.<span class='id identifier rubyid_pull_all'>pull_all</span>(<span class='id identifier rubyid_doc'>doc</span>.<span class='id identifier rubyid_atomic_array_pulls'><a href="#atomic_array_pulls-instance_method" title="Mongoid::Atomic#atomic_array_pulls (method)">atomic_array_pulls</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_flagged_destroys-instance_method">
  <h3 class='signature '>
    #<strong>process_flagged_destroys</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Process all the pending flagged destroys from nested attributes.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Process all the pending flagged destroys.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_process_flagged_destroys'>process_flagged_destroys</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>)</span>
&mdash;    <div class='inline'>
<p>The cleared array.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L314-L319'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='314' data-end='319'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 314</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_flagged_destroys'>process_flagged_destroys</span>
  <span class='id identifier rubyid__assigning'>_assigning</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_flagged_destroys'><a href="#flagged_destroys-instance_method" title="Mongoid::Atomic#flagged_destroys (method)">flagged_destroys</a></span>.<span class='id identifier rubyid_each'>each</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_call'>call</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_flagged_destroys'><a href="#flagged_destroys-instance_method" title="Mongoid::Atomic#flagged_destroys (method)">flagged_destroys</a></span>.<span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_atomic_updates!-instance_method">
  <h3 class='signature priv'>
    #<strong>reset_atomic_updates!</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Clears all pending atomic updates.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/atomic.rb#L324-L328'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='324' data-end='328'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/atomic.rb', line 324</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_atomic_updates!'>reset_atomic_updates!</span>
  <span class='const'>Atomic</span><span class='op'>::</span><span class='const'><a href="#UPDATES-constant" title="Mongoid::Atomic::UPDATES (constant)">UPDATES</a></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_update'>update</span><span class='op'>|</span>
    <span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid_update'>update</span>).<span class='id identifier rubyid_clear'>clear</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>