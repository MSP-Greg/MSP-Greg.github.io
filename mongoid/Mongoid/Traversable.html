<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Mongoid::Traversable &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongoid::Traversable",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongoid master</a> &raquo; 
      <a href='../_index.html#alpha_T'>Index (T)</a> &raquo; 
        <a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Traversable&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Mongoid::Traversable</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="Traversable/ClassMethods.html" title="Mongoid::Traversable::ClassMethods (module)"><code>ClassMethods</code></a>,
        <a href="Traversable/DiscriminatorAssignment.html" title="Mongoid::Traversable::DiscriminatorAssignment (module)"><code>DiscriminatorAssignment</code></a>,
        <a href="Traversable/DiscriminatorRetrieval.html" title="Mongoid::Traversable::DiscriminatorRetrieval (module)"><code>DiscriminatorRetrieval</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="Composable.html" title="Mongoid::Composable (module)"><code>Composable</code></a>,
          <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a>,
          <a href="GlobalDiscriminatorKeyAssignment/InvalidFieldHost.html" title="Mongoid::GlobalDiscriminatorKeyAssignment::InvalidFieldHost (class)"><code>GlobalDiscriminatorKeyAssignment::InvalidFieldHost</code></a>
      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          ActiveSupport::Concern
        </div>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L9'>lib/mongoid/traversable.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Mixin module included in <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a> to provide behavior around traversing the document graph.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#__redefine-class_method" title=".__redefine (class method)">.<strong>__redefine</strong>(owner, name, value)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#_parent-instance_method" title="#_parent (instance method)">#<strong>_parent</strong>  &#x21d2; Mongoid::Document | nil </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Retrieves the parent document of this document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#_parent=-instance_method" title="#_parent= (instance method)">#<strong>_parent=</strong>(document)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the parent document of this document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#_root-instance_method" title="#_root (instance method)">#<strong>_root</strong>  &#x21d2; Document </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Return the root document in the object graph.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#_root%3F-instance_method" title="#_root? (instance method)">#<strong>_root?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Is this document the root document of the hierarchy?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#hereditary%3F-instance_method" title="#hereditary? (instance method)">#<strong>hereditary?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Determines if the document is a subclass of another document.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#_children-instance_method" title="#_children (instance method)">#<strong>_children</strong>(reset: false)  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all child <code>Documents</code> to this <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#_descendants-instance_method" title="#_descendants (instance method)">#<strong>_descendants</strong>(reset: false)  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all descendant <code>Documents</code> of this <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a> recursively.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#_reset_memoized_descendants!-instance_method" title="#_reset_memoized_descendants! (instance method)">#<strong>_reset_memoized_descendants!</strong>  &#x21d2; nil </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Resets the memoized descendants on the object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#collect_children-instance_method" title="#collect_children (instance method)">#<strong>collect_children</strong>  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Collect all the children of this document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#collect_descendants-instance_method" title="#collect_descendants (instance method)">#<strong>collect_descendants</strong>  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Collect all the descendants of this document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#flag_descendants_persisted-instance_method" title="#flag_descendants_persisted (instance method)">#<strong>flag_descendants_persisted</strong>  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Marks all descendants as being persisted.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#parentize-instance_method" title="#parentize (instance method)">#<strong>parentize</strong>(document)  &#x21d2; Document </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets up a child/parent association.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#remove_child-instance_method" title="#remove_child (instance method)">#<strong>remove_child</strong>(child)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Remove a child document from this parent.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reset_persisted_descendants-instance_method" title="#reset_persisted_descendants (instance method)">#<strong>reset_persisted_descendants</strong>  &#x21d2; Array&lt;Document&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>After descendants are persisted we can call this to move all their changes and flag them as persisted in one call.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>DSL Calls</h2>
<section class='method_details first' id="included-dslcall">
<h3 class='signature'><strong>included</strong></h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L190-L230'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 190</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_included'>included</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_discriminator_key'>discriminator_key</span><span class='comma'>,</span> <span class='label'>instance_accessor:</span> <span class='kw'>false</span>
  <span class='kw'>class</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='comment'># The class attribute declaration above creates a default getter which we override with our custom method.
</span>    <span class='id identifier rubyid_remove_method'>remove_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_discriminator_key'>discriminator_key</span>
    <span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_discriminator_key'>discriminator_key</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='op'>::</span><span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span>
    <span class='id identifier rubyid_prepend'>prepend</span> <span class='const'><a href="Traversable/DiscriminatorAssignment.html" title="Mongoid::Traversable::DiscriminatorAssignment (module)">DiscriminatorAssignment</a></span>
    <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="Traversable/DiscriminatorRetrieval.html" title="Mongoid::Traversable::DiscriminatorRetrieval (module)">DiscriminatorRetrieval</a></span>

    <span class='comment'># @api private
</span>    <span class='comment'>#
</span>    <span class='comment'># @return [ Hash&lt;String, Class&gt; ] The current mapping of discriminator_values to classes
</span>    <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_discriminator_mapping'>discriminator_mapping</span>
  <span class='kw'>end</span>

  <span class='comment'># Add a discriminator mapping to the parent class. This mapping is used when
</span>  <span class='comment'># receiving a document to identify its class.
</span>  <span class='comment'>#
</span>  <span class='comment'># @param [ String ] value The discriminator_value that was just set
</span>  <span class='comment'># @param [ Class ] The class the discriminator_value was set on
</span>  <span class='comment'>#
</span>  <span class='comment'># @api private
</span>  <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_add_discriminator_mapping'>add_discriminator_mapping</span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='kw'>self</span>)
    <span class='kw'>self</span>.<span class='id identifier rubyid_discriminator_mapping'>discriminator_mapping</span> <span class='op'>||=</span> {}
    <span class='kw'>self</span>.<span class='id identifier rubyid_discriminator_mapping'>discriminator_mapping</span>[<span class='id identifier rubyid_value'>value</span>] <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>
    <span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_add_discriminator_mapping'>add_discriminator_mapping</span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_klass'>klass</span>) <span class='kw'>if</span> <span class='id identifier rubyid_hereditary?'><a href="#hereditary%3F-instance_method" title="Mongoid::Traversable#hereditary? (method)">hereditary?</a></span>
  <span class='kw'>end</span>

  <span class='comment'># Get the discriminator mapping from the parent class. This method returns nil if there
</span>  <span class='comment'># is no mapping for the given value.
</span>  <span class='comment'>#
</span>  <span class='comment'># @param [ String ] value The discriminator_value to retrieve
</span>  <span class='comment'>#
</span>  <span class='comment'># @return [ Class | nil ] klass The class corresponding to the given discriminator_value. If
</span>  <span class='comment'>#                               the value is not in the mapping, this method returns nil.
</span>  <span class='comment'>#
</span>  <span class='comment'># @api private
</span>  <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_get_discriminator_mapping'>get_discriminator_mapping</span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>self</span>.<span class='id identifier rubyid_discriminator_mapping'>discriminator_mapping</span>[<span class='id identifier rubyid_value'>value</span>] <span class='kw'>if</span> <span class='kw'>self</span>.<span class='id identifier rubyid_discriminator_mapping'>discriminator_mapping</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="__redefine-class_method">
  <h3 class='signature nodoc first'>
    .<strong>__redefine</strong>(owner, name, value)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L17-L32'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='17' data-end='32'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 17</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid___redefine'>__redefine</span>(<span class='id identifier rubyid_owner'>owner</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_singleton_class?'>singleton_class?</span>
    <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_redefine_method'>redefine_method</span>(<span class='id identifier rubyid_name'>name</span>) { <span class='id identifier rubyid_value'>value</span> }
    <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_public'>public</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_redefine_singleton_method'>redefine_singleton_method</span>(<span class='id identifier rubyid_name'>name</span>) { <span class='id identifier rubyid_value'>value</span> }
  <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_singleton_class'>singleton_class</span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_public'>public</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_redefine_singleton_method'>redefine_singleton_method</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_new_value'>new_value</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_equal?'>equal?</span>(<span class='kw'>self</span>)
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_new_value'>new_value</span>
    <span class='kw'>else</span>
      <span class='op'>::</span><span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'>Traversable</span>.<span class='id identifier rubyid_redefine'>redefine</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_value'>new_value</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_owner'>owner</span>.<span class='id identifier rubyid_singleton_class'>singleton_class</span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_public'>public</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="_parent-instance_method">
  <h3 class='signature rw  nodoc first'>
    #<strong>_parent</strong>  &#x21d2; <a href="Document.html" title="Mongoid::Document (module)">Mongoid::Document</a> | <code>nil</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Retrieves the parent document of this document.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Mongoid::Document</a> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>the parent document</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L109-L111'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='109' data-end='111'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 109</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__parent'>_parent</span>
  <span class='ivar'>@__parent</span> <span class='op'>||</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_parent=-instance_method">
  <h3 class='signature rw  nodoc'>
    #<strong>_parent=</strong>(document)   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the parent document of this document.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Mongoid::Document</a> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>the document to set as the parent document.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L121-L123'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='121' data-end='123'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 121</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__parent='>_parent=</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='ivar'>@__parent</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_root-instance_method">
  <h3 class='signature ro'>
    #<strong>_root</strong>  &#x21d2; <a href="Document.html" title="Mongoid::Document (module)">Document</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return the root document in the object graph. If the current document is the root object in the graph it will return self.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the root document in the hierarchy.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__root'>_root</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The root document in the hierarchy.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L400-L404'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='400' data-end='404'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 400</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__root'>_root</span>
  <span class='id identifier rubyid_object'>object</span> <span class='op'>=</span> <span class='kw'>self</span>
  <span class='id identifier rubyid_object'>object</span> <span class='op'>=</span> <span class='id identifier rubyid_object'>object</span>.<span class='id identifier rubyid__parent'><a href="#_parent-instance_method" title="Mongoid::Traversable#_parent (method)">_parent</a></span> <span class='kw'>while</span> <span class='id identifier rubyid_object'>object</span>.<span class='id identifier rubyid__parent'><a href="#_parent-instance_method" title="Mongoid::Traversable#_parent (method)">_parent</a></span>
  <span class='id identifier rubyid_object'>object</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_root?-instance_method">
  <h3 class='signature ro'>
    #<strong>_root?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is this document the root document of the hierarchy?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the document the root?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__root?'>_root?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the document is the root.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L412-L414'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='412' data-end='414'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 412</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__root?'>_root?</span>
  <span class='id identifier rubyid__parent'><a href="#_parent-instance_method" title="Mongoid::Traversable#_parent (method)">_parent</a></span> <span class='op'>?</span> <span class='kw'>false</span> <span class='op'>:</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="hereditary?-instance_method">
  <h3 class='signature ro'>
    #<strong>hereditary?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Determines if the document is a subclass of another document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Check if the document is a subclass</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'>Square</span>.<span class='id identifier rubyid_new'>new</span>.<span class='id identifier rubyid_hereditary?'>hereditary?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>True if hereditary, false if not.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L332-L334'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='332' data-end='334'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 332</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_hereditary?'>hereditary?</span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_hereditary?'>hereditary?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="_children-instance_method">
  <h3 class='signature nodoc first'>
    #<strong>_children</strong>(reset: false)  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all child <code>Documents</code> to this <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a></p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>All child documents in the hierarchy.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L237-L248'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='237' data-end='248'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 237</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__children'>_children</span>(<span class='label'>reset:</span> <span class='kw'>false</span>)
  <span class='comment'># See discussion above for the `_parent` method, as to why the variable
</span>  <span class='comment'># here needs to have two underscores.
</span>  <span class='comment'>#
</span>  <span class='comment'># rubocop:disable Naming/MemoizedInstanceVariableName
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_reset'>reset</span>
    <span class='ivar'>@__children</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='ivar'>@__children</span> <span class='op'>||=</span> <span class='id identifier rubyid_collect_children'><a href="#collect_children-instance_method" title="Mongoid::Traversable#collect_children (method)">collect_children</a></span>
  <span class='kw'>end</span>
  <span class='comment'># rubocop:enable Naming/MemoizedInstanceVariableName
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_descendants-instance_method">
  <h3 class='signature nodoc'>
    #<strong>_descendants</strong>(reset: false)  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all descendant <code>Documents</code> of this <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a> recursively. This is used when calling update persistence operations from the root document, where changes in the entire tree need to be determined. Note that persistence from the embedded documents will always be preferred, since they are optimized calls… This operation can get expensive in domains with large hierarchies.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>All descendant documents in the hierarchy.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L260-L271'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='260' data-end='271'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 260</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__descendants'>_descendants</span>(<span class='label'>reset:</span> <span class='kw'>false</span>)
  <span class='comment'># See discussion above for the `_parent` method, as to why the variable
</span>  <span class='comment'># here needs to have two underscores.
</span>  <span class='comment'>#
</span>  <span class='comment'># rubocop:disable Naming/MemoizedInstanceVariableName
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_reset'>reset</span>
    <span class='ivar'>@__descendants</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='ivar'>@__descendants</span> <span class='op'>||=</span> <span class='id identifier rubyid_collect_descendants'><a href="#collect_descendants-instance_method" title="Mongoid::Traversable#collect_descendants (method)">collect_descendants</a></span>
  <span class='kw'>end</span>
  <span class='comment'># rubocop:enable Naming/MemoizedInstanceVariableName
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_reset_memoized_descendants!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>_reset_memoized_descendants!</strong>  &#x21d2; <code>nil</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Resets the memoized descendants on the object. Called internally when an embedded array changes size.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>nil.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L387-L391'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='387' data-end='391'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 387</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__reset_memoized_descendants!'>_reset_memoized_descendants!</span>
  <span class='id identifier rubyid__parent'><a href="#_parent-instance_method" title="Mongoid::Traversable#_parent (method)">_parent</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid__reset_memoized_descendants!'>_reset_memoized_descendants!</span>
  <span class='id identifier rubyid__children'><a href="#_children-instance_method" title="Mongoid::Traversable#_children (method)">_children</a></span> <span class='label'>reset:</span> <span class='kw'>true</span>
  <span class='id identifier rubyid__descendants'><a href="#_descendants-instance_method" title="Mongoid::Traversable#_descendants (method)">_descendants</a></span> <span class='label'>reset:</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collect_children-instance_method">
  <h3 class='signature nodoc'>
    #<strong>collect_children</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Collect all the children of this document.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The children.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L278-L287'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='278' data-end='287'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 278</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_collect_children'>collect_children</span>
  [].<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_children'>children</span><span class='op'>|</span>
    <span class='id identifier rubyid_embedded_relations'>embedded_relations</span>.<span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid__association'>_association</span><span class='op'>|</span>
      <span class='id identifier rubyid_without_autobuild'>without_autobuild</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_child'>child</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid_name'>name</span>)
        <span class='id identifier rubyid_children'>children</span>.<span class='id identifier rubyid_concat'>concat</span>(<span class='const'><a href="../Array.html" title="Array (class)">Array</a></span>.<span class='id identifier rubyid_wrap'>wrap</span>(<span class='id identifier rubyid_child'>child</span>)) <span class='kw'>if</span> <span class='id identifier rubyid_child'>child</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collect_descendants-instance_method">
  <h3 class='signature nodoc'>
    #<strong>collect_descendants</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Collect all the descendants of this document.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The descendants.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L294-L315'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='294' data-end='315'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 294</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_collect_descendants'>collect_descendants</span>
  <span class='id identifier rubyid_children'>children</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_to_expand'>to_expand</span> <span class='op'>=</span> <span class='id identifier rubyid__children'><a href="#_children-instance_method" title="Mongoid::Traversable#_children (method)">_children</a></span>
  <span class='id identifier rubyid_expanded'>expanded</span> <span class='op'>=</span> {}

  <span class='kw'>until</span> <span class='id identifier rubyid_to_expand'>to_expand</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_expanding'>expanding</span> <span class='op'>=</span> <span class='id identifier rubyid_to_expand'>to_expand</span>
    <span class='id identifier rubyid_to_expand'>to_expand</span> <span class='op'>=</span> []
    <span class='id identifier rubyid_expanding'>expanding</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_expanded'>expanded</span>[<span class='id identifier rubyid_child'>child</span>]

      <span class='comment'># Don&#39;t mark expanded if _id is nil, since documents are compared by
</span>      <span class='comment'># their _ids, multiple embedded documents with nil ids will compare
</span>      <span class='comment'># equally, and some documents will not be expanded.
</span>      <span class='id identifier rubyid_expanded'>expanded</span>[<span class='id identifier rubyid_child'>child</span>] <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid__id'>_id</span>
      <span class='id identifier rubyid_children'>children</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_child'>child</span>
      <span class='id identifier rubyid_to_expand'>to_expand</span> <span class='op'>+=</span> <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid__children'><a href="#_children-instance_method" title="Mongoid::Traversable#_children (method)">_children</a></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_children'>children</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="flag_descendants_persisted-instance_method">
  <h3 class='signature '>
    #<strong>flag_descendants_persisted</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Marks all descendants as being persisted.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The flagged descendants.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L320-L324'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='320' data-end='324'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 320</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_flag_descendants_persisted'>flag_descendants_persisted</span>
  <span class='id identifier rubyid__descendants'><a href="#_descendants-instance_method" title="Mongoid::Traversable#_descendants (method)">_descendants</a></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span>
    <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid_new_record'>new_record</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parentize-instance_method">
  <h3 class='signature '>
    #<strong>parentize</strong>(document)  &#x21d2; <a href="Document.html" title="Mongoid::Document (module)">Document</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets up a child/parent association. This is used for newly created objects so they can be properly added to the graph.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p><a href="../Set.html" title="Set (class)"><code>::Set</code></a> the parent document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_parentize'>parentize</span>(<span class='id identifier rubyid_parent'>parent</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The parent document.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The parent document.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L345-L347'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='345' data-end='347'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 345</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parentize'>parentize</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid__parent'><a href="#_parent-instance_method" title="Mongoid::Traversable#_parent (method)">_parent</a></span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="remove_child-instance_method">
  <h3 class='signature '>
    #<strong>remove_child</strong>(child)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Remove a child document from this parent. If an embeds one then set to nil, otherwise remove from the embeds many.</p>

<p>This is called from the <code>RemoveEmbedded</code> persistence command.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Remove the child.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_remove_child'>remove_child</span>(<span class='id identifier rubyid_child'>child</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>child</span>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The child (embedded) document to remove.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L358-L367'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='358' data-end='367'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 358</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_child'>remove_child</span>(<span class='id identifier rubyid_child'>child</span>)
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid_association_name'>association_name</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid_embedded_one?'>embedded_one?</span>
    <span class='id identifier rubyid_attributes'>attributes</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid__association'>_association</span>.<span class='id identifier rubyid_store_as'>store_as</span>)
    <span class='id identifier rubyid_remove_ivar'>remove_ivar</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_relation'>relation</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid_name'>name</span>)
    <span class='id identifier rubyid_relation'>relation</span>.<span class='id identifier rubyid__remove'>_remove</span>(<span class='id identifier rubyid_child'>child</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_persisted_descendants-instance_method">
  <h3 class='signature '>
    #<strong>reset_persisted_descendants</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>After descendants are persisted we can call this to move all their changes and flag them as persisted in one call.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="Document.html" title="Mongoid::Document (module)">Document</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The descendants.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/traversable.rb#L373-L379'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='373' data-end='379'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/traversable.rb', line 373</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_persisted_descendants'>reset_persisted_descendants</span>
  <span class='id identifier rubyid__descendants'><a href="#_descendants-instance_method" title="Mongoid::Traversable#_descendants (method)">_descendants</a></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span>
    <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid_move_changes'>move_changes</span>
    <span class='id identifier rubyid_child'>child</span>.<span class='id identifier rubyid_new_record'>new_record</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid__reset_memoized_descendants!'><a href="#_reset_memoized_descendants!-instance_method" title="Mongoid::Traversable#_reset_memoized_descendants! (method)">_reset_memoized_descendants!</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>