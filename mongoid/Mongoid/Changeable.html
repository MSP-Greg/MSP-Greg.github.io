<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Mongoid::Changeable &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongoid::Changeable",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongoid master</a> &raquo; 
      <a href='../_index.html#alpha_C'>Index (C)</a> &raquo; 
        <a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Changeable&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Mongoid::Changeable</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="Changeable/ClassMethods.html" title="Mongoid::Changeable::ClassMethods (module)"><code>ClassMethods</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Changeable/Anything.html" title="Mongoid::Changeable::Anything (class)"><code>Anything</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="Composable.html" title="Mongoid::Composable (module)"><code>Composable</code></a>,
          <a href="Document.html" title="Mongoid::Document (module)"><code>Document</code></a>,
          <a href="GlobalDiscriminatorKeyAssignment/InvalidFieldHost.html" title="Mongoid::GlobalDiscriminatorKeyAssignment::InvalidFieldHost (class)"><code>GlobalDiscriminatorKeyAssignment::InvalidFieldHost</code></a>
      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          ActiveSupport::Concern
        </div>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L5'>lib/mongoid/changeable.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Defines behavior for dirty tracking.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ATTRIBUTE_UNCHANGED-constant' class='summary_signature'>ATTRIBUTE_UNCHANGED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>a singleton object to represent an optional <code>to</code> or <code>from</code> value that was not explicitly provided to #attribute_changed?</p>

  </div>
</div>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L254-L254'># File 'lib/mongoid/changeable.rb', line 254</a>    <pre class='code ruby'><span class='const'><a href="Changeable/Anything.html" title="Mongoid::Changeable::Anything (class)">Anything</a></span>.<span class='id identifier rubyid_new'>new</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#changed-instance_method" title="#changed (instance method)">#<strong>changed</strong>  &#x21d2; Array&lt;String&gt; </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the changed attributes for the document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#changed%3F-instance_method" title="#changed? (instance method)">#<strong>changed?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Has the document changed?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#children_changed%3F-instance_method" title="#children_changed? (instance method)">#<strong>children_changed?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Have any children (embedded documents) of this document changed?</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#attribute_before_last_save-instance_method" title="#attribute_before_last_save (instance method)">#<strong>attribute_before_last_save</strong>(attr)  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the original value of an attribute before the last save.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attribute_changed%3F-instance_method" title="#attribute_changed? (instance method)">#<strong>attribute_changed?</strong>(attr, from: ATTRIBUTE_UNCHANGED, to: ATTRIBUTE_UNCHANGED)  &#x21d2; true | false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Determine if a specific attribute has changed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attribute_changed_from_default%3F-instance_method" title="#attribute_changed_from_default? (instance method)">#<strong>attribute_changed_from_default?</strong>(attr)  &#x21d2; true | false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get whether or not the field has a different value from the default.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attribute_previously_was-instance_method" title="#attribute_previously_was (instance method)">#<strong>attribute_previously_was</strong>(attr)  &#x21d2; Object | nil </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the previous attribute value that was changed before the document was saved.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attribute_was-instance_method" title="#attribute_was (instance method)">#<strong>attribute_was</strong>(attr)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the previous value for the attribute.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attribute_will_change!-instance_method" title="#attribute_will_change! (instance method)">#<strong>attribute_will_change!</strong>(attr)  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Flag an attribute as going to change.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#changed_attributes-instance_method" title="#changed_attributes (instance method)">#<strong>changed_attributes</strong>  &#x21d2; Hash&lt;String, Object&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the attribute changes.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#changes-instance_method" title="#changes (instance method)">#<strong>changes</strong>  &#x21d2; Hash&lt;String, Array&lt;Object, Object&gt; ] The changes. </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the changes for the document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#children_may_have_changed!-instance_method" title="#children_may_have_changed! (instance method)">#<strong>children_may_have_changed!</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Indicates that the children of this document may have changed, and ought to be checked when the document is validated.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#move_changes-instance_method" title="#move_changes (instance method)">#<strong>move_changes</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Call this method after save, so the changes can be properly switched.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#post_persist-instance_method" title="#post_persist (instance method)">#<strong>post_persist</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Things that need to execute after a document has been persisted.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#previous_changes-instance_method" title="#previous_changes (instance method)">#<strong>previous_changes</strong>  &#x21d2; Hash&lt;String, Array&lt;Object, Object&gt; ] The previous changes. </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the previous changes on the document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#remove_change-instance_method" title="#remove_change (instance method)">#<strong>remove_change</strong>(name)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Remove a change from the dirty attributes hash.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reset_attribute!-instance_method" title="#reset_attribute! (instance method)">#<strong>reset_attribute!</strong>(attr)  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Set.html" title="Set (class)"><code>::Set</code></a> the attribute back to its old value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reset_attribute_to_default!-instance_method" title="#reset_attribute_to_default! (instance method)">#<strong>reset_attribute_to_default!</strong>(attr)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reset_attributes_before_type_cast-instance_method" title="#reset_attributes_before_type_cast (instance method)">#<strong>reset_attributes_before_type_cast</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#saved_change_to_attribute-instance_method" title="#saved_change_to_attribute (instance method)">#<strong>saved_change_to_attribute</strong>(attr)  &#x21d2; Array&lt;Object&gt; | nil </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the change to an attribute during the last save.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#saved_change_to_attribute%3F-instance_method" title="#saved_change_to_attribute? (instance method)">#<strong>saved_change_to_attribute?</strong>(attr, from: Utils::PLACEHOLDER, to: Utils::PLACEHOLDER)  &#x21d2; true | false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns whether this attribute changed during the last save.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#setters-instance_method" title="#setters (instance method)">#<strong>setters</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Gets all the new values for each of the changed fields, to be passed to a MongoDB $set modifier.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#will_save_change_to_attribute%3F-instance_method" title="#will_save_change_to_attribute? (instance method)">#<strong>will_save_change_to_attribute?</strong>(attr, **kwargs)  &#x21d2; true | false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns whether this attribute change the next time we save.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#attribute_change-instance_method" title="#attribute_change (instance method)">#<strong>attribute_change</strong>(attr)  &#x21d2; Array&lt;Object&gt; </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the old and new value for the provided attribute.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#attributes_before_last_save-instance_method" title="#attributes_before_last_save (instance method)">#<strong>attributes_before_last_save</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#changes_before_last_save-instance_method" title="#changes_before_last_save (instance method)">#<strong>changes_before_last_save</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#previous_attributes-instance_method" title="#previous_attributes (instance method)">#<strong>previous_attributes</strong>  &#x21d2; Hash </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get attributes of the document before the document was saved.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="changed-instance_method">
  <h3 class='signature ro first'>
    #<strong>changed</strong>  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt;  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the changed attributes for the document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the changed attributes.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_changed'>changed</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The changed attributes.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L14-L16'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='14' data-end='16'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 14</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_changed'>changed</span>
  <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>.<span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_select'>select</span> { <span class='op'>|</span><span class='id identifier rubyid_attr'>attr</span><span class='op'>|</span> <span class='id identifier rubyid_attribute_change'><a href="#attribute_change-instance_method" title="Mongoid::Changeable#attribute_change (method)">attribute_change</a></span>(<span class='id identifier rubyid_attr'>attr</span>) }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="changed?-instance_method">
  <h3 class='signature ro'>
    #<strong>changed?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Has the document changed?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Has the document changed?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_changed?'>changed?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the document is changed.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L32-L34'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='32' data-end='34'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 32</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_changed?'>changed?</span>
  <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>.<span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_any?'>any?</span> { <span class='op'>|</span><span class='id identifier rubyid_val'>val</span><span class='op'>|</span> <span class='id identifier rubyid_val'>val</span> } <span class='op'>||</span> <span class='id identifier rubyid_children_changed?'><a href="#children_changed%3F-instance_method" title="Mongoid::Changeable#children_changed? (method)">children_changed?</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="children_changed?-instance_method">
  <h3 class='signature ro'>
    #<strong>children_changed?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This intentionally only considers children and not descendants.</p>
</div>
  </div>


<p>Have any children (embedded documents) of this document changed?</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If any children have changed.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L41-L43'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='41' data-end='43'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 41</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_children_changed?'>children_changed?</span>
  <span class='ivar'>@children_may_have_changed</span> <span class='op'>||</span> <span class='id identifier rubyid__children'>_children</span>.<span class='id identifier rubyid_any?'>any?</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_changed?'><a href="#changed%3F-instance_method" title="Mongoid::Changeable#changed? (method)">changed?</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="attribute_before_last_save-instance_method">
  <h3 class='signature  first'>
    #<strong>attribute_before_last_save</strong>(attr)  &#x21d2; <code>Object</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the original value of an attribute before the last save.</p>

<p>This method is useful in after callbacks to get the original value of</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_an'>an</span> <span class='id identifier rubyid_attribute'>attribute</span> <span class='id identifier rubyid_before'>before</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_save'>save</span> <span class='id identifier rubyid_that'>that</span> <span class='id identifier rubyid_triggered'>triggered</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_callbacks'>callbacks</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_run'>run</span>.</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a> | <a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>Value of the attribute before the last save.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L150-L153'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='150' data-end='153'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 150</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_before_last_save'>attribute_before_last_save</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attributes_before_last_save'><a href="#attributes_before_last_save-instance_method" title="Mongoid::Changeable#attributes_before_last_save (method)">attributes_before_last_save</a></span>[<span class='id identifier rubyid_attr'>attr</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attribute_change-instance_method">
  <h3 class='signature priv'>
    #<strong>attribute_change</strong>(attr)  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>&gt;  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the old and new value for the provided attribute.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the attribute change.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_attribute_change'>attribute_change</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The old and new values.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L228-L231'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='228' data-end='231'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 228</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_change'>attribute_change</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  [ <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>[<span class='id identifier rubyid_attr'>attr</span>]<span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_attr'>attr</span>] ] <span class='kw'>if</span> <span class='id identifier rubyid_attribute_changed?'><a href="#attribute_changed%3F-instance_method" title="Mongoid::Changeable#attribute_changed? (method)">attribute_changed?</a></span>(<span class='id identifier rubyid_attr'>attr</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attribute_changed?-instance_method">
  <h3 class='signature '>
    #<strong>attribute_changed?</strong>(attr, from: ATTRIBUTE_UNCHANGED, to: ATTRIBUTE_UNCHANGED)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Determine if a specific attribute has changed.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Has the attribute changed?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_attribute_changed?'>attribute_changed?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
  <li>
    <span class='name'>from</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The object the attribute was changed from (optional).</p>
</div>
  </li>
  <li>
    <span class='name'>to</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The object the attribute was changed to (optional).</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the attribute has changed.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L266-L274'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='266' data-end='274'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 266</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_changed?'>attribute_changed?</span>(<span class='id identifier rubyid_attr'>attr</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='const'><a href="#ATTRIBUTE_UNCHANGED-constant" title="Mongoid::Changeable::ATTRIBUTE_UNCHANGED (constant)">ATTRIBUTE_UNCHANGED</a></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='const'><a href="#ATTRIBUTE_UNCHANGED-constant" title="Mongoid::Changeable::ATTRIBUTE_UNCHANGED (constant)">ATTRIBUTE_UNCHANGED</a></span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>[<span class='id identifier rubyid_attr'>attr</span>] <span class='op'>==</span> <span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_attr'>attr</span>]
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_from'>from</span> <span class='op'>!=</span> <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>[<span class='id identifier rubyid_attr'>attr</span>]
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_to'>to</span> <span class='op'>!=</span> <span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_attr'>attr</span>]

  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attribute_changed_from_default?-instance_method">
  <h3 class='signature '>
    #<strong>attribute_changed_from_default?</strong>(attr)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get whether or not the field has a different value from the default.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the field different from the default?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_attribute_changed_from_default?'>attribute_changed_from_default?</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the attribute differs.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L284-L288'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='284' data-end='288'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 284</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_changed_from_default?'>attribute_changed_from_default?</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> (<span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span>[<span class='id identifier rubyid_attr'>attr</span>])

  <span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_attr'>attr</span>] <span class='op'>!=</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_eval_default'>eval_default</span>(<span class='kw'>self</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attribute_previously_was-instance_method">
  <h3 class='signature '>
    #<strong>attribute_previously_was</strong>(attr)  &#x21d2; <code>Object</code> | <code>nil</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the previous attribute value that was changed before the document was saved.</p>

<p>It the document has not been saved yet, or was just loaded from database, this method returns nil for all attributes.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The attribute name.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>Attribute value before the document was saved, or nil if the document has not been saved yet.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L311-L318'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='311' data-end='318'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 311</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_previously_was'>attribute_previously_was</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_previous_changes'><a href="#previous_changes-instance_method" title="Mongoid::Changeable#previous_changes (method)">previous_changes</a></span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_attr'>attr</span>)
    <span class='id identifier rubyid_previous_changes'><a href="#previous_changes-instance_method" title="Mongoid::Changeable#previous_changes (method)">previous_changes</a></span>[<span class='id identifier rubyid_attr'>attr</span>].<span class='id identifier rubyid_first'>first</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_previous_attributes'><a href="#previous_attributes-instance_method" title="Mongoid::Changeable#previous_attributes (method)">previous_attributes</a></span>[<span class='id identifier rubyid_attr'>attr</span>]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attribute_was-instance_method">
  <h3 class='signature '>
    #<strong>attribute_was</strong>(attr)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the previous value for the attribute.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the previous value.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_attribute_was'>attribute_was</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The attribute name.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L296-L299'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='296' data-end='299'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 296</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_was'>attribute_was</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attribute_changed?'><a href="#attribute_changed%3F-instance_method" title="Mongoid::Changeable#attribute_changed? (method)">attribute_changed?</a></span>(<span class='id identifier rubyid_attr'>attr</span>) <span class='op'>?</span> <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>[<span class='id identifier rubyid_attr'>attr</span>] <span class='op'>:</span> <span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_attr'>attr</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attribute_will_change!-instance_method">
  <h3 class='signature '>
    #<strong>attribute_will_change!</strong>(attr)  &#x21d2; <code>Object</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Flag an attribute as going to change.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Flag the attribute.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_attribute_will_change!'>attribute_will_change!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The old value.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L328-L332'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='328' data-end='332'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 328</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attribute_will_change!'>attribute_will_change!</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_attr'>attr</span>)

  <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>[<span class='id identifier rubyid_attr'>attr</span>] <span class='op'>=</span> <span class='id identifier rubyid_read_raw_attribute'>read_raw_attribute</span>(<span class='id identifier rubyid_attr'>attr</span>).<span class='id identifier rubyid___deep_copy__'>__deep_copy__</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attributes_before_last_save-instance_method">
  <h3 class='signature priv'>
    #<strong>attributes_before_last_save</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L216-L218'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='216' data-end='218'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 216</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attributes_before_last_save'>attributes_before_last_save</span>
  <span class='ivar'>@attributes_before_last_save</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="changed_attributes-instance_method">
  <h3 class='signature '>
    #<strong>changed_attributes</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../String.html" title="String (class)">String</a>, <code>Object</code>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the attribute changes.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the attribute changes.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_changed_attributes'>changed_attributes</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../String.html" title="String (class)">String</a>, <code>Object</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The attribute changes.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L51-L53'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='51' data-end='53'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_changed_attributes'>changed_attributes</span>
  <span class='ivar'>@changed_attributes</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="changes-instance_method">
  <h3 class='signature '>
    #<strong>changes</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../String.html" title="String (class)">String</a>, <a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>, <code>Object</code>&gt; ] <code>The</code> changes. 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get all the changes for the document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get all the changes.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_changes'>changes</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../String.html" title="String (class)">String</a>, <a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>, <code>Object</code>&gt; ] <code>The</code> changes.)</span>
&mdash;    <div class='inline'>
<p>Hash&lt;String, Array&lt;Object, Object&gt; ] The changes.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L61-L66'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='61' data-end='66'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 61</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_changes'>changes</span>
  <span class='id identifier rubyid_changed'><a href="#changed-instance_method" title="Mongoid::Changeable#changed (method)">changed</a></span>.<span class='id identifier rubyid_each_with_object'>each_with_object</span>({}) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_attr'>attr</span><span class='comma'>,</span> <span class='id identifier rubyid_changes'>changes</span><span class='op'>|</span>
    <span class='id identifier rubyid_change'>change</span> <span class='op'>=</span> <span class='id identifier rubyid_attribute_change'><a href="#attribute_change-instance_method" title="Mongoid::Changeable#attribute_change (method)">attribute_change</a></span>(<span class='id identifier rubyid_attr'>attr</span>)
    <span class='id identifier rubyid_changes'>changes</span>[<span class='id identifier rubyid_attr'>attr</span>] <span class='op'>=</span> <span class='id identifier rubyid_change'>change</span> <span class='kw'>if</span> <span class='id identifier rubyid_change'>change</span>
  <span class='kw'>end</span>.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="changes_before_last_save-instance_method">
  <h3 class='signature priv'>
    #<strong>changes_before_last_save</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L212-L214'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='212' data-end='214'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 212</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_changes_before_last_save'>changes_before_last_save</span>
  <span class='ivar'>@changes_before_last_save</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="children_may_have_changed!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>children_may_have_changed!</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Indicates that the children of this document may have changed, and ought to be checked when the document is validated.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L22-L24'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='22' data-end='24'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 22</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_children_may_have_changed!'>children_may_have_changed!</span>
  <span class='ivar'>@children_may_have_changed</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="move_changes-instance_method">
  <h3 class='signature '>
    #<strong>move_changes</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Call this method after save, so the changes can be properly switched.</p>

<p>This will unset the memoized children array, set new record flag to false, set the document as validated, and move the dirty changes.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Move the changes to previous.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_move_changes'>move_changes</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L75-L83'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='75' data-end='83'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 75</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_move_changes'>move_changes</span>
  <span class='ivar'>@changes_before_last_save</span> <span class='op'>=</span> <span class='ivar'>@previous_changes</span>
  <span class='ivar'>@previous_changes</span> <span class='op'>=</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>
  <span class='ivar'>@attributes_before_last_save</span> <span class='op'>=</span> <span class='ivar'>@previous_attributes</span>
  <span class='ivar'>@previous_attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_attributes'>attributes</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='ivar'>@children_may_have_changed</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_reset_atomic_updates!'>reset_atomic_updates!</span>
  <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>.<span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="post_persist-instance_method">
  <h3 class='signature '>
    #<strong>post_persist</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Things that need to execute after a document has been persisted.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Handle post persistence.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_post_persist'>post_persist</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L89-L93'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='89' data-end='93'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 89</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_post_persist'>post_persist</span>
  <span class='id identifier rubyid_reset_persisted_descendants'>reset_persisted_descendants</span>
  <span class='id identifier rubyid_reset_attributes_before_type_cast'><a href="#reset_attributes_before_type_cast-instance_method" title="Mongoid::Changeable#reset_attributes_before_type_cast (method)">reset_attributes_before_type_cast</a></span>
  <span class='id identifier rubyid_move_changes'><a href="#move_changes-instance_method" title="Mongoid::Changeable#move_changes (method)">move_changes</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="previous_attributes-instance_method">
  <h3 class='signature priv'>
    #<strong>previous_attributes</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get attributes of the document before the document was saved.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>Previous attributes</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L208-L210'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='208' data-end='210'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 208</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_previous_attributes'>previous_attributes</span>
  <span class='ivar'>@previous_attributes</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="previous_changes-instance_method">
  <h3 class='signature '>
    #<strong>previous_changes</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../String.html" title="String (class)">String</a>, <a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>, <code>Object</code>&gt; ] <code>The</code> <code>previous</code> <a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a>. 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the previous changes on the document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the previous changes.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_previous_changes'>previous_changes</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../String.html" title="String (class)">String</a>, <a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>, <code>Object</code>&gt; ] <code>The</code> <code>previous</code> <a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a>.)</span>
&mdash;    <div class='inline'>
<p>Hash&lt;String, Array&lt;Object, Object&gt; ] The previous changes.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L101-L103'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='101' data-end='103'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 101</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_previous_changes'>previous_changes</span>
  <span class='ivar'>@previous_changes</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="remove_change-instance_method">
  <h3 class='signature '>
    #<strong>remove_change</strong>(name)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Remove a change from the dirty attributes hash. Used by the single field atomic updaters.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Remove a flagged change.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_remove_change'>remove_change</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_field'>field</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a> | <a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the field.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L112-L114'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='112' data-end='114'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 112</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_change'>remove_change</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_to_s'>to_s</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_attribute!-instance_method">
  <h3 class='signature '>
    #<strong>reset_attribute!</strong>(attr)  &#x21d2; <code>Object</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Set.html" title="Set (class)"><code>::Set</code></a> the attribute back to its old value.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Reset the attribute.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_model'>model</span>.<span class='id identifier rubyid_reset_attribute!'>reset_attribute!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The old value.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L342-L345'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='342' data-end='345'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 342</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_attribute!'>reset_attribute!</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_attr'>attr</span>] <span class='op'>=</span> <span class='id identifier rubyid_changed_attributes'><a href="#changed_attributes-instance_method" title="Mongoid::Changeable#changed_attributes (method)">changed_attributes</a></span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_attr'>attr</span>) <span class='kw'>if</span> <span class='id identifier rubyid_attribute_changed?'><a href="#attribute_changed%3F-instance_method" title="Mongoid::Changeable#attribute_changed? (method)">attribute_changed?</a></span>(<span class='id identifier rubyid_attr'>attr</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_attribute_to_default!-instance_method">
  <h3 class='signature '>
    #<strong>reset_attribute_to_default!</strong>(attr)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L347-L354'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='347' data-end='354'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 347</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_attribute_to_default!'>reset_attribute_to_default!</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='kw'>if</span> (<span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span>[<span class='id identifier rubyid_attr'>attr</span>])
    <span class='id identifier rubyid___send__'>__send__</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attr'>attr</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_eval_default'>eval_default</span>(<span class='kw'>self</span>))
  <span class='kw'>else</span>
    <span class='id identifier rubyid___send__'>__send__</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attr'>attr</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>nil</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_attributes_before_type_cast-instance_method">
  <h3 class='signature '>
    #<strong>reset_attributes_before_type_cast</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L356-L358'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='356' data-end='358'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 356</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_attributes_before_type_cast'>reset_attributes_before_type_cast</span>
  <span class='ivar'>@attributes_before_type_cast</span> <span class='op'>=</span> <span class='ivar'>@attributes</span>.<span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="saved_change_to_attribute-instance_method">
  <h3 class='signature '>
    #<strong>saved_change_to_attribute</strong>(attr)  &#x21d2; <a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>&gt; | <code>nil</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the change to an attribute during the last save.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a> | <a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>&gt; | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>If the attribute was changed, returns an array containing the original value and the saved value, otherwise nil.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L161-L164'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='161' data-end='164'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 161</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_saved_change_to_attribute'>saved_change_to_attribute</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='id identifier rubyid_previous_changes'><a href="#previous_changes-instance_method" title="Mongoid::Changeable#previous_changes (method)">previous_changes</a></span>[<span class='id identifier rubyid_attr'>attr</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="saved_change_to_attribute?-instance_method">
  <h3 class='signature '>
    #<strong>saved_change_to_attribute?</strong>(attr, from: Utils::PLACEHOLDER, to: Utils::PLACEHOLDER)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns whether this attribute changed during the last save.</p>

<p>This method is useful in after callbacks, to see the change</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>in</span> <span class='id identifier rubyid_an'>an</span> <span class='id identifier rubyid_attribute'>attribute</span> <span class='id identifier rubyid_during'>during</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_save'>save</span> <span class='id identifier rubyid_that'>that</span> <span class='id identifier rubyid_triggered'>triggered</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_callbacks'>callbacks</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_run'>run</span>.</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
  <li>
    <span class='name'>from</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The object the attribute was changed from (optional).</p>
</div>
  </li>
  <li>
    <span class='name'>to</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The object the attribute was changed to (optional).</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the attribute has changed during the last save.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L176-L185'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='176' data-end='185'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 176</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_saved_change_to_attribute?'>saved_change_to_attribute?</span>(<span class='id identifier rubyid_attr'>attr</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='const'><a href="Utils.html" title="Mongoid::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils.html#PLACEHOLDER-constant" title="Mongoid::Utils::PLACEHOLDER (constant)">PLACEHOLDER</a></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='const'><a href="Utils.html" title="Mongoid::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils.html#PLACEHOLDER-constant" title="Mongoid::Utils::PLACEHOLDER (constant)">PLACEHOLDER</a></span>)
  <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span> <span class='op'>=</span> <span class='id identifier rubyid_saved_change_to_attribute'><a href="#saved_change_to_attribute-instance_method" title="Mongoid::Changeable#saved_change_to_attribute (method)">saved_change_to_attribute</a></span>(<span class='id identifier rubyid_attr'>attr</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../Array.html" title="Array (class)">Array</a></span>)

  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='const'><a href="Utils.html" title="Mongoid::Utils (module)">Utils</a></span>.<span class='id identifier rubyid_placeholder?'><a href="Utils.html#placeholder%3F-instance_method" title="Mongoid::Utils#placeholder? (method)">placeholder?</a></span>(<span class='id identifier rubyid_from'>from</span>) <span class='op'>&amp;&amp;</span> <span class='const'><a href="Utils.html" title="Mongoid::Utils (module)">Utils</a></span>.<span class='id identifier rubyid_placeholder?'><a href="Utils.html#placeholder%3F-instance_method" title="Mongoid::Utils#placeholder? (method)">placeholder?</a></span>(<span class='id identifier rubyid_to'>to</span>)
  <span class='kw'>return</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>.<span class='id identifier rubyid_first'>first</span> <span class='op'>==</span> <span class='id identifier rubyid_from'>from</span> <span class='kw'>if</span> <span class='const'><a href="Utils.html" title="Mongoid::Utils (module)">Utils</a></span>.<span class='id identifier rubyid_placeholder?'><a href="Utils.html#placeholder%3F-instance_method" title="Mongoid::Utils#placeholder? (method)">placeholder?</a></span>(<span class='id identifier rubyid_to'>to</span>)
  <span class='kw'>return</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>.<span class='id identifier rubyid_last'>last</span> <span class='op'>==</span> <span class='id identifier rubyid_to'>to</span> <span class='kw'>if</span> <span class='const'><a href="Utils.html" title="Mongoid::Utils (module)">Utils</a></span>.<span class='id identifier rubyid_placeholder?'><a href="Utils.html#placeholder%3F-instance_method" title="Mongoid::Utils#placeholder? (method)">placeholder?</a></span>(<span class='id identifier rubyid_from'>from</span>)

  <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>.<span class='id identifier rubyid_first'>first</span> <span class='op'>==</span> <span class='id identifier rubyid_from'>from</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>.<span class='id identifier rubyid_last'>last</span> <span class='op'>==</span> <span class='id identifier rubyid_to'>to</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="setters-instance_method">
  <h3 class='signature '>
    #<strong>setters</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Gets all the new values for each of the changed fields, to be passed to a MongoDB $set modifier.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the setters for the atomic updates.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_person'>person</span> <span class='op'>=</span> <span class='const'>Person</span>.<span class='id identifier rubyid_new'>new</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sir</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Madam</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_person'>person</span>.<span class='id identifier rubyid_setters'>setters</span> <span class='comment'># returns { &quot;title&quot; =&gt; &quot;Madam&quot; }</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>)</span>
&mdash;    <div class='inline'>
<p>A <a href="../Hash.html" title="Hash (class)"><code>::Hash</code></a> of atomic setters.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L125-L140'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='125' data-end='140'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 125</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_setters'>setters</span>
  <span class='id identifier rubyid_mods'>mods</span> <span class='op'>=</span> {}
  <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>.<span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>

    <span class='id identifier rubyid_old'>old</span><span class='comma'>,</span> <span class='id identifier rubyid_new'>new</span> <span class='op'>=</span> <span class='id identifier rubyid_changes'><a href="#changes-instance_method" title="Mongoid::Changeable#changes (method)">changes</a></span>
    <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span>[<span class='id identifier rubyid_name'>name</span>]
    <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_atomic_attribute_name'>atomic_attribute_name</span>(<span class='id identifier rubyid_name'>name</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_field'>field</span><span class='op'>&amp;.</span><span class='id identifier rubyid_resizable?'>resizable?</span>
      <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_add_atomic_changes'>add_atomic_changes</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_mods'>mods</span><span class='comma'>,</span> <span class='id identifier rubyid_new'>new</span><span class='comma'>,</span> <span class='id identifier rubyid_old'>old</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_mods'>mods</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span> <span class='kw'>unless</span> <span class='id identifier rubyid_atomic_unsets'>atomic_unsets</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_key'>key</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_mods'>mods</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="will_save_change_to_attribute?-instance_method">
  <h3 class='signature '>
    #<strong>will_save_change_to_attribute?</strong>(attr, **kwargs)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns whether this attribute change the next time we save.</p>

<p>This method is useful in validations and before callbacks to determine</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>if</span> <span class='id identifier rubyid_the'>the</span> <span class='kw'>next</span> <span class='id identifier rubyid_call'>call</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_save'>save</span> <span class='id identifier rubyid_will'>will</span> <span class='id identifier rubyid_change'>change</span> <span class='id identifier rubyid_a'>a</span> <span class='id identifier rubyid_particular'>particular</span> <span class='id identifier rubyid_attribute'>attribute</span>.</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>attr</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
  <li>
    <span class='name'>**kwargs</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>The optional keyword arguments.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the attribute change the next time we save.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/changeable.rb#L199-L201'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='199' data-end='201'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/changeable.rb', line 199</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_will_save_change_to_attribute?'>will_save_change_to_attribute?</span>(<span class='id identifier rubyid_attr'>attr</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kwargs'>kwargs</span>)
  <span class='id identifier rubyid_attribute_changed?'><a href="#attribute_changed%3F-instance_method" title="Mongoid::Changeable#attribute_changed? (method)">attribute_changed?</a></span>(<span class='id identifier rubyid_attr'>attr</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kwargs'>kwargs</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>