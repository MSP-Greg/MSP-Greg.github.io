<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongoid::Validatable::UniquenessValidator &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongoid::Validatable::UniquenessValidator",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Mongoid master</a> &raquo; 
      <a href='../../_index.html#alpha_U'>Index (U)</a> &raquo; 
        <a href="../../Mongoid.html" title="Mongoid (module)">Mongoid</a> &raquo; 
        <a href="../Validatable.html" title="Mongoid::Validatable (module)">Validatable</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>UniquenessValidator&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongoid::Validatable::UniquenessValidator</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          ActiveModel::EachValidator
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Queryable.html" title="Mongoid::Validatable::Queryable (module)"><code>Queryable</code></a>,
          ActiveModel::EachValidator
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>ActiveModel::EachValidator</span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'>ActiveModel::EachValidator</li>
          <li class='next'>Mongoid::Validatable::UniquenessValidator</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L28'>lib/mongoid/validatable/uniqueness.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Validates whether or not a field is unique against the documents in the database.</p>

<p>It is also possible to limit the uniqueness constraint to a set of documents matching certain conditions:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Person</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="../../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="../Document.html" title="Mongoid::Document (module)">Document</a></span>
  <span class='id identifier rubyid_field'>field</span> <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span>
  <span class='id identifier rubyid_field'>field</span> <span class='symbeg'>:</span><span class='id identifier rubyid_active'>active</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'><a href="../Boolean.html" title="Mongoid::Boolean (class)">Boolean</a></span>

  <span class='id identifier rubyid_validates_uniqueness_of'>validates_uniqueness_of</span> <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='label'>conditions:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span><span class='id identifier rubyid_where'>where</span>(<span class='label'>active:</span> <span class='kw'>true</span>)}
<span class='kw'>end</span></code></pre>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Define the uniqueness validator.</p>
</div></p>
      <pre class='example code "#{object.source_type}"'><code><span class='kw'>class</span> <span class='const'>Person</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><a href="../../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="../Document.html" title="Mongoid::Document (module)">Document</a></span>
  <span class='id identifier rubyid_field'>field</span> <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span>

  <span class='id identifier rubyid_validates_uniqueness_of'>validates_uniqueness_of</span> <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
</div>
<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro priv nodoc'>
      <a href="#case_sensitive%3F-instance_method" title="#case_sensitive? (instance method)">#<strong>case_sensitive?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Should the uniqueness validation be case sensitive?</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#validate_each-instance_method" title="#validate_each (instance method)">#<strong>validate_each</strong>(document, attribute, value)  &#x21d2; Errors </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Validate the document for uniqueness violations.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#add_error-instance_method" title="#add_error (instance method)">#<strong>add_error</strong>(document, attribute, value)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Add the error to the document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#create_criteria-instance_method" title="#create_criteria (instance method)">#<strong>create_criteria</strong>(base, document, attribute, value)  &#x21d2; Criteria </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Create the validation criteria.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#criterion-instance_method" title="#criterion (instance method)">#<strong>criterion</strong>(document, attribute, value)  &#x21d2; Criteria </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the default criteria for checking uniqueness.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#filter-instance_method" title="#filter (instance method)">#<strong>filter</strong>(value)  &#x21d2; Object | Regexp </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Filter the value based on whether the check is case sensitive or not.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#localized%3F-instance_method" title="#localized? (instance method)">#<strong>localized?</strong>(document, attribute)  &#x21d2; true | false </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Is the attribute localized?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#scope-instance_method" title="#scope (instance method)">#<strong>scope</strong>(criteria, document, _attribute)  &#x21d2; Criteria </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Scope the criteria to the scope options provided.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#scope_value_changed%3F-instance_method" title="#scope_value_changed? (instance method)">#<strong>scope_value_changed?</strong>(document)  &#x21d2; true | false </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Scope reference has changed?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#skip_validation%3F-instance_method" title="#skip_validation? (instance method)">#<strong>skip_validation?</strong>(document)  &#x21d2; true | false </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Should validation be skipped?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#to_validate-instance_method" title="#to_validate (instance method)">#<strong>to_validate</strong>(document, attribute, value)  &#x21d2; Array&lt;Object, Object&gt; </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the name of the field and the value to validate.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#validate_embedded-instance_method" title="#validate_embedded (instance method)">#<strong>validate_embedded</strong>(document, attribute, value)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Validate an embedded document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#validate_root-instance_method" title="#validate_root (instance method)">#<strong>validate_root</strong>(document, attribute, value)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Validate a root document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#validation_required%3F-instance_method" title="#validation_required? (instance method)">#<strong>validation_required?</strong>(document, attribute)  &#x21d2; true | false </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Are we required to validate the document?</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="Queryable.html" title="Mongoid::Validatable::Queryable (module)"><code>Queryable</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Queryable.html#with_query-instance_method" title="Mongoid::Validatable::Queryable#with_query (method)">#with_query</a></td>
      <td><div class='inline'><p>Wrap the validation inside the an execution block that alert’s the client not to clear its persistence options.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="case_sensitive?-instance_method">
  <h3 class='signature ro priv  nodoc first'>
    #<strong>case_sensitive?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Should the uniqueness validation be case sensitive?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the validation case sensitive?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_case_sensitive?'>case_sensitive?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the validation is case sensitive.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L79-L81'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='79' data-end='81'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 79</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_case_sensitive?'>case_sensitive?</span>
  <span class='op'>!</span>(<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_case_sensitive'>case_sensitive</span>] <span class='op'>==</span> <span class='kw'>false</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="add_error-instance_method">
  <h3 class='signature priv  nodoc first'>
    #<strong>add_error</strong>(document, attribute, value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Add the error to the document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Add the error.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_add_error'>add_error</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to validate.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value of the object.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L65-L69'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='65' data-end='69'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 65</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_error'>add_error</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_errors'>errors</span>.<span class='id identifier rubyid_add'>add</span>(
    <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_taken'>taken</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_except'>except</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_case_sensitive'>case_sensitive</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_scope'><a href="#scope-instance_method" title="Mongoid::Validatable::UniquenessValidator#scope (method)">scope</a></span>).<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>value:</span> <span class='id identifier rubyid_value'>value</span>)
  )
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_criteria-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>create_criteria</strong>(base, document, attribute, value)  &#x21d2; <a href="../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Create the validation criteria.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Create the criteria.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_create_criteria'>create_criteria</span>(<span class='const'>User</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>syd</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>base</span>
    <span class='type'>(<code>Class</code> | <code>Proxy</code>)</span>
&mdash;    <div class='inline'>
<p>The base to execute the criteria from.</p>
</div>
  </li>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to validate.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value of the object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>)</span>
&mdash;    <div class='inline'>
<p>The criteria.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L96-L114'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='96' data-end='114'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 96</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create_criteria'>create_criteria</span>(<span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_criteria'>criteria</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'><a href="#scope-instance_method" title="Mongoid::Validatable::UniquenessValidator#scope (method)">scope</a></span>(<span class='id identifier rubyid_base'>base</span>.<span class='id identifier rubyid_unscoped'>unscoped</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span>)
  <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_fields'>fields</span>[<span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attribute'>attribute</span>)]

  <span class='comment'># In the past, we were calling value.mongoize in all cases, which
</span>  <span class='comment'># would call Object&#39;s mongoize method. This is a problem for StringifiedSymbol,
</span>  <span class='comment'># because a Symbol should mongoize to a String, but calling .mongoize
</span>  <span class='comment'># on a Symbol mongoizes it to a Symbol.
</span>  <span class='comment'># Therefore, we call the field&#39;s mongoize in all cases except when the
</span>  <span class='comment'># field is localized, because by the time we arrive at this code, the
</span>  <span class='comment'># value is already in the form of { lang =&gt; translation } and calling
</span>  <span class='comment'># the field&#39;s mongoize will nest that further into { lang =&gt;
</span>  <span class='comment'># &quot;\{ lang =&gt; translation \}&quot;} (assuming the field type is a string).
</span>  <span class='comment'># Therefore, we call Object&#39;s mongoize method so it returns the hash as
</span>  <span class='comment'># it is.
</span>  <span class='id identifier rubyid_mongoized'>mongoized</span> <span class='op'>=</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_try'>try</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_localized?'><a href="#localized%3F-instance_method" title="Mongoid::Validatable::UniquenessValidator#localized? (method)">localized?</a></span>) <span class='op'>?</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_mongoize'>mongoize</span> <span class='op'>:</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_mongoize'>mongoize</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_criteria'>criteria</span>.<span class='id identifier rubyid_selector'>selector</span>.<span class='id identifier rubyid_update'>update</span>(<span class='id identifier rubyid_criterion'><a href="#criterion-instance_method" title="Mongoid::Validatable::UniquenessValidator#criterion (method)">criterion</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_mongoized'>mongoized</span>))
  <span class='id identifier rubyid_criteria'>criteria</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="criterion-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>criterion</strong>(document, attribute, value)  &#x21d2; <a href="../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the default criteria for checking uniqueness.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the criteria.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_criterion'>criterion</span>(<span class='id identifier rubyid_person'>person</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sir</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to validate.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the attribute.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value of the object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>)</span>
&mdash;    <div class='inline'>
<p>The uniqueness criteria.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L128-L142'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='128' data-end='142'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 128</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_criterion'>criterion</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attribute'>attribute</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_localized?'><a href="#localized%3F-instance_method" title="Mongoid::Validatable::UniquenessValidator#localized? (method)">localized?</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_field'>field</span>)
    <span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>=</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>||</span> {}).<span class='id identifier rubyid_inject'>inject</span>([]) { <span class='op'>|</span><span class='id identifier rubyid_acc'>acc</span><span class='comma'>,</span> (<span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span>)<span class='op'>|</span> <span class='id identifier rubyid_acc'>acc</span> <span class='op'>&lt;&lt;</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_field'>field</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_filter'><a href="#filter-instance_method" title="Mongoid::Validatable::UniquenessValidator#filter (method)">filter</a></span>(<span class='id identifier rubyid_v'>v</span>) }}
    <span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$or</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_conditions'>conditions</span> }
  <span class='kw'>else</span>
    <span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> { <span class='id identifier rubyid_field'>field</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_filter'><a href="#filter-instance_method" title="Mongoid::Validatable::UniquenessValidator#filter (method)">filter</a></span>(<span class='id identifier rubyid_value'>value</span>) }
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_persisted?'>persisted?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_embedded?'>embedded?</span>
    <span class='id identifier rubyid_selector'>selector</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='label'>_id:</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$ne</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__id'>_id</span> })
  <span class='kw'>end</span>
  <span class='id identifier rubyid_selector'>selector</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="filter-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>filter</strong>(value)  &#x21d2; <code>Object</code> | <a href="../../Regexp.html" title="Regexp (class)">Regexp</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Filter the value based on whether the check is case sensitive or not.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Filter the value.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_filter'>filter</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testing</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value to filter.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code> | <a href="../../Regexp.html" title="Regexp (class)">Regexp</a>)</span>
&mdash;    <div class='inline'>
<p>The value, filtered or not.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L154-L156'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='154' data-end='156'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 154</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_filter'>filter</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='op'>!</span><span class='id identifier rubyid_case_sensitive?'><a href="#case_sensitive%3F-instance_method" title="Mongoid::Validatable::UniquenessValidator#case_sensitive? (method)">case_sensitive?</a></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>?</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A</span><span class='embexpr_beg'>#{</span><span class='const'><a href="../../Regexp.html" title="Regexp (class)">Regexp</a></span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_s'>to_s</span>)<span class='embexpr_end'>}</span><span class='tstring_content'>\z</span><span class='regexp_end'>/i</span></span> <span class='op'>:</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="localized?-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>localized?</strong>(document, attribute)  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is the attribute localized?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the attribute localized?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_localized?'>localized?</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_field'>field</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document getting validated.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The attribute to validate.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the attribute is localized.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L300-L302'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='300' data-end='302'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 300</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_localized?'>localized?</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span>)
  <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_fields'>fields</span>[<span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_attribute'>attribute</span>)].<span class='id identifier rubyid_try'>try</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_localized?'>localized?</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="scope-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>scope</strong>(criteria, document, _attribute)  &#x21d2; <a href="../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Scope the criteria to the scope options provided.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Scope the criteria.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_scope'>scope</span>(<span class='id identifier rubyid_criteria'>criteria</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>criteria</span>
    <span class='type'>(<a href="../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>)</span>
&mdash;    <div class='inline'>
<p>The criteria to scope.</p>
</div>
  </li>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document being validated.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a>)</span>
&mdash;    <div class='inline'>
<p>The scoped criteria.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L169-L175'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='169' data-end='175'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 169</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_scope'>scope</span>(<span class='id identifier rubyid_criteria'>criteria</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid__attribute'>_attribute</span>)
  <span class='const'><a href="../../Array.html" title="Array (class)">Array</a></span>.<span class='id identifier rubyid_wrap'>wrap</span>(<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_scope'>scope</span>]).<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_database_field_name'>database_field_name</span>(<span class='id identifier rubyid_item'>item</span>)
    <span class='id identifier rubyid_criteria'>criteria</span> <span class='op'>=</span> <span class='id identifier rubyid_criteria'>criteria</span>.<span class='id identifier rubyid_where'>where</span>(<span class='id identifier rubyid_item'>item</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_attributes'>attributes</span>[<span class='id identifier rubyid_name'>name</span>])
  <span class='kw'>end</span>
  <span class='id identifier rubyid_criteria'>criteria</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="scope_value_changed?-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>scope_value_changed?</strong>(document)  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Scope reference has changed?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Has scope reference changed?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_scope_value_changed?'>scope_value_changed?</span>(<span class='id identifier rubyid_doc'>doc</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The embedded document.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the scope reference has changed.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L201-L205'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='201' data-end='205'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 201</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_scope_value_changed?'>scope_value_changed?</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='const'><a href="../../Array.html" title="Array (class)">Array</a></span>.<span class='id identifier rubyid_wrap'>wrap</span>(<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_scope'><a href="#scope-instance_method" title="Mongoid::Validatable::UniquenessValidator#scope (method)">scope</a></span>]).<span class='id identifier rubyid_any?'>any?</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_send'>send</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attribute_changed?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_to_s'>to_s</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="skip_validation?-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>skip_validation?</strong>(document)  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Should validation be skipped?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Should the validation be skipped?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_skip_validation?'>skip_validation?</span>(<span class='id identifier rubyid_doc'>doc</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The embedded document.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the validation should be skipped.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L187-L189'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='187' data-end='189'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 187</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_skip_validation?'>skip_validation?</span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='op'>!</span><span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__parent'>_parent</span> <span class='op'>||</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_embedded_one?'>embedded_one?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_validate-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>to_validate</strong>(document, attribute, value)  &#x21d2; <a href="../../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>, <code>Object</code>&gt;  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the name of the field and the value to validate. This is for the case when we validate an association via the association name and not the key, we need to send the key name and value to the db, not the association object.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the name and key to validate.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_to_validate'>to_validate</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_parent'>parent</span><span class='comma'>,</span> <span class='const'>Parent</span>.<span class='id identifier rubyid_new'>new</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The doc getting validated.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The attribute getting validated.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value of the attribute.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../../Array.html" title="Array (class)">Array</a>&lt;<code>Object</code>, <code>Object</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The field and value.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L222-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='222' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 222</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_to_validate'>to_validate</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_association'>association</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_relations'>relations</span>[<span class='id identifier rubyid_attribute'>attribute</span>.<span class='id identifier rubyid_to_s'>to_s</span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_association'>association</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_association'>association</span>.<span class='id identifier rubyid_stores_foreign_key?'>stores_foreign_key?</span>
    [ <span class='id identifier rubyid_association'>association</span>.<span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid__id'>_id</span> ]
  <span class='kw'>else</span>
    [ <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> ]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validate_each-instance_method">
  <h3 class='signature '>
    #<strong>validate_each</strong>(document, attribute, value)  &#x21d2; <a href="../Errors.html" title="Mongoid::Errors (module)">Errors</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Validate the document for uniqueness violations.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Validate the document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validate_each'>validate_each</span>(<span class='id identifier rubyid_person'>person</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sir</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document to validate.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The field to validate on.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value of the field.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Errors.html" title="Mongoid::Errors (module)">Errors</a>)</span>
&mdash;    <div class='inline'>
<p>The errors.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L41-L51'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='41' data-end='51'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 41</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_each'>validate_each</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_with_query'>with_query</span>(<span class='id identifier rubyid_document'>document</span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_attrib'>attrib</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_to_validate'><a href="#to_validate-instance_method" title="Mongoid::Validatable::UniquenessValidator#to_validate (method)">to_validate</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_validation_required?'><a href="#validation_required%3F-instance_method" title="Mongoid::Validatable::UniquenessValidator#validation_required? (method)">validation_required?</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attrib'>attrib</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_embedded?'>embedded?</span>
      <span class='id identifier rubyid_validate_embedded'><a href="#validate_embedded-instance_method" title="Mongoid::Validatable::UniquenessValidator#validate_embedded (method)">validate_embedded</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attrib'>attrib</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_validate_root'><a href="#validate_root-instance_method" title="Mongoid::Validatable::UniquenessValidator#validate_root (method)">validate_root</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attrib'>attrib</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validate_embedded-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>validate_embedded</strong>(document, attribute, value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Validate an embedded document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Validate the embedded document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_validate_embedded'>validate_embedded</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The attribute name.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L241-L248'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='241' data-end='248'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 241</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_embedded'>validate_embedded</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_skip_validation?'><a href="#skip_validation%3F-instance_method" title="Mongoid::Validatable::UniquenessValidator#skip_validation? (method)">skip_validation?</a></span>(<span class='id identifier rubyid_document'>document</span>)
  <span class='id identifier rubyid_relation'>relation</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid__parent'>_parent</span>.<span class='id identifier rubyid_send'>send</span>(<span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_association_name'>association_name</span>)
  <span class='id identifier rubyid_criteria'>criteria</span> <span class='op'>=</span> <span class='id identifier rubyid_create_criteria'><a href="#create_criteria-instance_method" title="Mongoid::Validatable::UniquenessValidator#create_criteria (method)">create_criteria</a></span>(<span class='id identifier rubyid_relation'>relation</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_criteria'>criteria</span> <span class='op'>=</span> <span class='id identifier rubyid_criteria'>criteria</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_conditions'>conditions</span>].<span class='id identifier rubyid_call'>call</span>) <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_conditions'>conditions</span>]
  <span class='id identifier rubyid_criteria'>criteria</span> <span class='op'>=</span> <span class='id identifier rubyid_criteria'>criteria</span>.<span class='id identifier rubyid_read'>read</span>(<span class='label'>mode:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_primary'>primary</span>).<span class='id identifier rubyid_limit'>limit</span>(<span class='int'>2</span>)
  <span class='id identifier rubyid_add_error'><a href="#add_error-instance_method" title="Mongoid::Validatable::UniquenessValidator#add_error (method)">add_error</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>) <span class='kw'>if</span> <span class='id identifier rubyid_criteria'>criteria</span>.<span class='id identifier rubyid_count'>count</span> <span class='op'>&gt;</span> <span class='int'>1</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validate_root-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>validate_root</strong>(document, attribute, value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Validate a root document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Validate the root document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_validate_root'>validate_root</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The attribute name.</p>
</div>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The value.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L260-L272'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='260' data-end='272'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 260</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_root'>validate_root</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_class'>class</span>

  <span class='kw'>while</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_validators'>validators</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_validators'>validators</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='kw'>self</span>)
    <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_criteria'>criteria</span> <span class='op'>=</span> <span class='id identifier rubyid_create_criteria'><a href="#create_criteria-instance_method" title="Mongoid::Validatable::UniquenessValidator#create_criteria (method)">create_criteria</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_criteria'>criteria</span> <span class='op'>=</span> <span class='id identifier rubyid_criteria'>criteria</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_conditions'>conditions</span>].<span class='id identifier rubyid_call'>call</span>) <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_conditions'>conditions</span>]

  <span class='kw'>if</span> <span class='id identifier rubyid_criteria'>criteria</span>.<span class='id identifier rubyid_read'>read</span>(<span class='label'>mode:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_primary'>primary</span>).<span class='id identifier rubyid_exists?'>exists?</span>
    <span class='id identifier rubyid_add_error'><a href="#add_error-instance_method" title="Mongoid::Validatable::UniquenessValidator#add_error (method)">add_error</a></span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validation_required?-instance_method">
  <h3 class='signature priv'>
    #<strong>validation_required?</strong>(document, attribute)  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Are we required to validate the document?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is validation needed?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_validator'>validator</span>.<span class='id identifier rubyid_validation_required?'>validation_required?</span>(<span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_field'>field</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<a href="../Document.html" title="Mongoid::Document (module)">Document</a>)</span>
&mdash;    <div class='inline'>
<p>The document getting validated.</p>
</div>
  </li>
  <li>
    <span class='name'>attribute</span>
    <span class='type'>(<a href="../../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The attribute to validate.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If we need to validate.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/validatable/uniqueness.rb#L283-L287'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='283' data-end='287'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/validatable/uniqueness.rb', line 283</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validation_required?'>validation_required?</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span>)
  <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_new_record?'>new_record?</span> <span class='op'>||</span>
    <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_send'>send</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attribute_changed?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span>.<span class='id identifier rubyid_to_s'>to_s</span>) <span class='op'>||</span>
    <span class='id identifier rubyid_scope_value_changed?'><a href="#scope_value_changed%3F-instance_method" title="Mongoid::Validatable::UniquenessValidator#scope_value_changed? (method)">scope_value_changed?</a></span>(<span class='id identifier rubyid_document'>document</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>