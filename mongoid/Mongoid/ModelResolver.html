<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongoid::ModelResolver &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongoid::ModelResolver",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongoid master</a> &raquo; 
      <a href='../_index.html#alpha_M'>Index (M)</a> &raquo; 
        <a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>ModelResolver&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongoid::ModelResolver</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          Forwardable
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L14'>lib/mongoid/model_resolver.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>The default class for resolving model classes based on discriminant keys. Given a key, it will return the corresponding model class, if any. By default, it looks for classes with names that match the given keys, but additional mappings may be provided.</p>

<p>It is also possible to instantiate multiple resolvers—and even implement your own—so that different sets of classes can use independent resolution mechanics.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='INSTANCE_MUTEX-constant' class='summary_signature nodoc'>INSTANCE_MUTEX =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The mutex instance used to make the <a href="#instance-class_method" title="Mongoid::ModelResolver.instance (method)">.instance</a> method thread-safe.</p>

  </div>
</div>
<div class='tags'>
  
</div>
    <a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L18-L18'># File 'lib/mongoid/model_resolver.rb', line 18</a>    <pre class='code ruby'><span class='const'>Mutex</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongoid::ModelResolver.new (method)">new</a></span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#instance-class_method" title=".instance (class method)">.<strong>instance</strong>  &#x21d2; Mongoid::ModelResolver </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the default instance of the <code>ModelResolver</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>  &#x21d2; ModelResolver </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Instantiates a new <code>ModelResolver</code> instance.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#register_resolver-class_method" title=".register_resolver (class method)">.<strong>register_resolver</strong>(resolver, name)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Register the given resolver under the given name.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#resolver-class_method" title=".resolver (class method)">.<strong>resolver</strong>(identifier_or_object = :default)  &#x21d2; Mongoid::ModelResolver::Interface </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the resolver instance that corresponds to the argument.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#resolvers-class_method" title=".resolvers (class method)">.<strong>resolvers</strong>  &#x21d2; Hash&lt;Symbol =&gt; Mongoid::ModelResolver::Interface&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the map of registered resolvers.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#register-instance_method" title="#register (instance method)">#<strong>register</strong>(klass, *keys)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Registers the given model class with the given keys.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>  &#x21d2; <code>ModelResolver</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Instantiates a new <code>ModelResolver</code> instance.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L75-L78'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='75' data-end='78'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/model_resolver.rb', line 75</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@key_to_model</span> <span class='op'>=</span> {}
  <span class='ivar'>@model_to_keys</span> <span class='op'>=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="instance-class_method">
  <h3 class='signature  first'>
    .<strong>instance</strong>  &#x21d2; <code>ModelResolver</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the default instance of the <code>ModelResolver</code>.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>ModelResolver</code>)</span>
&mdash;    <div class='inline'>
<p>the default <code>ModelResolver</code> instance.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L27-L29'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='27' data-end='29'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/model_resolver.rb', line 27</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_instance'>instance</span>
  <span class='ivar'>@instance</span> <span class='op'>||=</span> <span class='const'><a href="#INSTANCE_MUTEX-constant" title="Mongoid::ModelResolver::INSTANCE_MUTEX (constant)">INSTANCE_MUTEX</a></span>.<span class='id identifier rubyid_synchronize'>synchronize</span> { <span class='ivar'>@instance</span> <span class='op'>||=</span> <span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongoid::ModelResolver.new (method)">new</a></span> }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="register_resolver-class_method">
  <h3 class='signature '>
    .<strong>register_resolver</strong>(resolver, name)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Register the given resolver under the given name.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>resolver</span>
    <span class='type'>(<code>Mongoid::ModelResolver::Interface</code>)</span>
&mdash;    <div class='inline'>
<p>the resolver to register.</p>
</div>
  </li>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<a href="../String.html" title="String (class)">String</a> | <a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>the identifier to use to register the resolver.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L68-L71'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='68' data-end='71'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/model_resolver.rb', line 68</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_register_resolver'>register_resolver</span>(<span class='id identifier rubyid_resolver'><a href="#resolver-class_method" title="Mongoid::ModelResolver.resolver (method)">resolver</a></span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_resolvers'><a href="#resolvers-class_method" title="Mongoid::ModelResolver.resolvers (method)">resolvers</a></span>[<span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>] <span class='op'>=</span> <span class='id identifier rubyid_resolver'><a href="#resolver-class_method" title="Mongoid::ModelResolver.resolver (method)">resolver</a></span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="resolver-class_method">
  <h3 class='signature '>
    .<strong>resolver</strong>(identifier_or_object = :default)  &#x21d2; <code>Mongoid::ModelResolver::Interface</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the resolver instance that corresponds to the argument.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>identifier_or_object</span>
    <span class='type'>(<code>nil</code> | <code>true</code> | <code>false</code> <a href="../Symbol.html" title="Symbol (class)">Symbol</a> | <a href="../String.html" title="String (class)">String</a> | <code>Mongoid::ModelResolver::Interface</code>)</span>
    <em class='default'>(defaults to: <tt>:default</tt>)</em>
&mdash;    <div class='inline'>
<p>When nil or false, returns nil. When true or <code>:default</code>, corresponds to the default resolver. When any other symbol or string, corresponds to the registered resolver with that identifier. Otherwise, it must be a resolver instance itself.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Mongoid::ModelResolver::Interface</code>)</span>
&mdash;    <div class='inline'>
<p>the resolver instance corresponding to the given argument.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>Mongoid::Errors::UnrecognizedResolver if the given identifier is a symbol or string and it does not match any registered resolver.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L52-L62'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='52' data-end='62'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/model_resolver.rb', line 52</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_resolver'>resolver</span>(<span class='id identifier rubyid_identifier_or_object'>identifier_or_object</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_default'>default</span>)
  <span class='kw'>case</span> <span class='id identifier rubyid_identifier_or_object'>identifier_or_object</span>
  <span class='kw'>when</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>false</span> <span class='kw'>then</span> <span class='kw'>nil</span>
  <span class='kw'>when</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_default'>default</span> <span class='kw'>then</span> <span class='id identifier rubyid_instance'><a href="#instance-class_method" title="Mongoid::ModelResolver.instance (method)">instance</a></span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span><span class='comma'>,</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span>
    <span class='id identifier rubyid_resolvers'><a href="#resolvers-class_method" title="Mongoid::ModelResolver.resolvers (method)">resolvers</a></span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_identifier_or_object'>identifier_or_object</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="Errors.html" title="Mongoid::Errors (module)">Errors</a></span><span class='op'>::</span><span class='const'><a href="Errors/UnrecognizedResolver.html" title="Mongoid::Errors::UnrecognizedResolver (class)">UnrecognizedResolver</a></span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span> <span class='id identifier rubyid_identifier_or_object'>identifier_or_object</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="resolvers-class_method">
  <h3 class='signature '>
    .<strong>resolvers</strong>  &#x21d2; <a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../Symbol.html" title="Symbol (class)">Symbol</a> =&gt; <code>Mongoid::ModelResolver::Interface</code>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the map of registered resolvers. The default resolver is not included here.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Hash.html" title="Hash (class)">Hash</a>&lt;<a href="../Symbol.html" title="Symbol (class)">Symbol</a> =&gt; <code>Mongoid::ModelResolver::Interface</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>the hash of resolver instances, mapped by symbol identifier.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L36-L38'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='36' data-end='38'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/model_resolver.rb', line 36</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_resolvers'>resolvers</span>
  <span class='ivar'>@resolvers</span> <span class='op'>||=</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="register-instance_method">
  <h3 class='signature  first'>
    #<strong>register</strong>(klass, *keys)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Registers the given model class with the given keys. In addition to the given keys, the class name itself will be included as a key to identify the class. Keys are given in priority order, with highest priority keys first and lowest last. The class name, if not given explicitly, is always given lowest priority.</p>

<p>If called more than once, newer keys have higher priority than older keys. All duplicate keys will be removed.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>klass</span>
    <span class='type'>(<a href="Document.html" title="Mongoid::Document (module)">Mongoid::Document</a>)</span>
&mdash;    <div class='inline'>
<p>the document class to register</p>
</div>
  </li>
  <li>
    <span class='name'>*keys</span>
    <span class='type'>(<a href="../Array.html" title="Array (class)">Array</a>&lt;<a href="../String.html" title="String (class)">String</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>the list of keys to use as an alias (optional)</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/model_resolver.rb#L90-L101'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='90' data-end='101'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/model_resolver.rb', line 90</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_register'>register</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_keys'>keys</span>)
  <span class='id identifier rubyid_default_key'>default_key</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_name'>name</span>

  <span class='ivar'>@model_to_keys</span>[<span class='id identifier rubyid_klass'>klass</span>] <span class='op'>=</span> [ <span class='op'>*</span><span class='id identifier rubyid_keys'>keys</span><span class='comma'>,</span> <span class='op'>*</span><span class='ivar'>@model_to_keys</span>[<span class='id identifier rubyid_klass'>klass</span>]<span class='comma'>,</span> <span class='id identifier rubyid_default_key'>default_key</span> ].<span class='id identifier rubyid_uniq'>uniq</span>
  <span class='ivar'>@key_to_model</span>[<span class='id identifier rubyid_default_key'>default_key</span>] <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>

  <span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
    <span class='ivar'>@key_to_model</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>