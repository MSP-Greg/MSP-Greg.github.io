<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Top Level Namespace &mdash; Mongoid master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Mongoid master</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Top Level Namespace&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Top Level Namespace</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="ActiveSupport.html" title="ActiveSupport (module)"><code>ActiveSupport</code></a>,
        <a href="BSON.html" title="BSON (module)"><code>BSON</code></a>,
        <a href="Mongoid.html" title="Mongoid (module)"><code>Mongoid</code></a>,
        <a href="Rails.html" title="Rails (module)"><code>Rails</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Array.html" title="Array (class)"><code>Array</code></a>,
        <a href="Date.html" title="Date (class)"><code>Date</code></a>,
        <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a>,
        <a href="Float.html" title="Float (class)"><code>Float</code></a>,
        <a href="Hash.html" title="Hash (class)"><code>Hash</code></a>,
        <a href="Integer.html" title="Integer (class)"><code>Integer</code></a>,
        <a href="Regexp.html" title="Regexp (class)"><code>Regexp</code></a>,
        <a href="Set.html" title="Set (class)"><code>Set</code></a>,
        <a href="String.html" title="String (class)"><code>String</code></a>,
        <a href="Symbol.html" title="Symbol (class)"><code>Symbol</code></a>,
        <a href="Time.html" title="Time (class)"><code>Time</code></a>      </div>
    </td></tr>
  </tbody>
</table>
</div>
<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#check_if_transactions_might_be_available!-instance_method" title="#check_if_transactions_might_be_available! (instance method)">#<strong>check_if_transactions_might_be_available!</strong>(client)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This method raises an error if the cluster the client is connected to does not support transactions in any case.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#start_sandbox-instance_method" title="#start_sandbox (instance method)">#<strong>start_sandbox</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Prepares console sandbox mode.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#start_sandbox_transaction-instance_method" title="#start_sandbox_transaction (instance method)">#<strong>start_sandbox_transaction</strong>(client)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Starts a transaction that should include all the operations inside the sandboxed console session.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="check_if_transactions_might_be_available!-instance_method">
  <h3 class='signature  first'>
    #<strong>check_if_transactions_might_be_available!</strong>(client)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>This method raises an error if the cluster the client is connected to does not support transactions in any case. At the moment this is the case of the standalone topology.</p>

<p>Please note that if this method did not raise, it does not guarantee that transactions are available for the cluster.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>client</span>
    <span class='type'>(<code>Mongo::Client</code>)</span>
&mdash;    <div class='inline'>
<p>Client connected to a cluster to be tested.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="Mongoid/Errors/TransactionsNotSupported.html" title="Mongoid::Errors::TransactionsNotSupported (class)">Mongoid::Errors::TransactionsNotSupported</a>)</span>
&mdash;    <div class='inline'>
<p>If the cluster definitely does not support transactions.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/railties/console_sandbox.rb#L16-L20'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='16' data-end='20'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/railties/console_sandbox.rb', line 16</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_check_if_transactions_might_be_available!'>check_if_transactions_might_be_available!</span>(<span class='id identifier rubyid_client'>client</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_client'>client</span>.<span class='id identifier rubyid_cluster'>cluster</span>.<span class='id identifier rubyid_single?'>single?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="Mongoid/Errors.html" title="Mongoid::Errors (module)">Errors</a></span><span class='op'>::</span><span class='const'><a href="Mongoid/Errors/TransactionsNotSupported.html" title="Mongoid::Errors::TransactionsNotSupported (class)">TransactionsNotSupported</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_sandbox-instance_method">
  <h3 class='signature '>
    #<strong>start_sandbox</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Prepares console sandbox mode. This method should be called when a user starts rails console with ‘–sandbox’ flag.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/railties/console_sandbox.rb#L36-L41'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='36' data-end='41'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/railties/console_sandbox.rb', line 36</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_start_sandbox'>start_sandbox</span>
  <span class='const'><a href="Mongoid.html" title="Mongoid (module)">Mongoid</a></span>.<span class='id identifier rubyid_persistence_context'><a href="Mongoid.html#persistence_context-instance_method" title="Mongoid#persistence_context (method)">persistence_context</a></span>.<span class='id identifier rubyid_client'>client</span>.<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_check_if_transactions_might_be_available!'><a href="#check_if_transactions_might_be_available!-instance_method" title="#check_if_transactions_might_be_available! (method)">check_if_transactions_might_be_available!</a></span>(<span class='id identifier rubyid_client'>client</span>)
    <span class='id identifier rubyid_start_sandbox_transaction'><a href="#start_sandbox_transaction-instance_method" title="#start_sandbox_transaction (method)">start_sandbox_transaction</a></span>(<span class='id identifier rubyid_client'>client</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_sandbox_transaction-instance_method">
  <h3 class='signature '>
    #<strong>start_sandbox_transaction</strong>(client)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Starts a transaction that should include all the operations inside the sandboxed console session. This transaction should not be ever committed. When a user end the console session, the client will disconnect, and the transaction will be automatically aborted therefore.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>client</span>
    <span class='type'>(<code>Mongo::Client</code>)</span>
&mdash;    <div class='inline'>
<p>Client to start the transaction.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongoid/blob/master/lib/mongoid/railties/console_sandbox.rb#L28-L32'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='28' data-end='32'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongoid/railties/console_sandbox.rb', line 28</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_start_sandbox_transaction'>start_sandbox_transaction</span>(<span class='id identifier rubyid_client'>client</span>)
  <span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span>.<span class='id identifier rubyid_start_session'>start_session</span>
  <span class='op'>::</span><span class='const'><a href="Mongoid.html" title="Mongoid (module)">Mongoid</a></span><span class='op'>::</span><span class='const'><a href="Mongoid/Threaded.html" title="Mongoid::Threaded (module)">Threaded</a></span>.<span class='id identifier rubyid_set_session'><a href="Mongoid/Threaded.html#set_session-instance_method" title="Mongoid::Threaded#set_session (method)">set_session</a></span>(<span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='label'>client:</span> <span class='id identifier rubyid_client'>client</span>)
  <span class='id identifier rubyid_session'>session</span>.<span class='id identifier rubyid_start_transaction'>start_transaction</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>