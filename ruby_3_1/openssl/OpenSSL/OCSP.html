<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: OpenSSL::OCSP &mdash; openssl  Ruby-3.1.7 p261</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL::OCSP",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Ruby-3.1.7</a> &raquo; 
      <a href='../'>openssl</a> &raquo; 
      <a href='../_index.html#alpha_O'>Index (O)</a> &raquo; 
        <a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>OCSP&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: OpenSSL::OCSP</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="OCSP/BasicResponse.html" title="OpenSSL::OCSP::BasicResponse (class)"><code>BasicResponse</code></a>,
        <a href="OCSP/CertificateId.html" title="OpenSSL::OCSP::CertificateId (class)"><code>CertificateId</code></a>,
        <a href="OCSP/Request.html" title="OpenSSL::OCSP::Request (class)"><code>Request</code></a>,
        <a href="OCSP/Response.html" title="OpenSSL::OCSP::Response (class)"><code>Response</code></a>,
        <a href="OCSP/SingleResponse.html" title="OpenSSL::OCSP::SingleResponse (class)"><code>SingleResponse</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Exceptions:</div>
      <div class='box_11'>
          <a href="OCSP/OCSPError.html" title="OpenSSL::OCSP::OCSPError (class)"><code>OCSPError</code></a>      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1761'>ext/openssl/ossl_ocsp.c</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>OCSP</code> implements Online Certificate Status Protocol requests and responses.</p>

<p>Creating and sending an <code>OCSP</code> request requires a subject certificate that contains an <code>OCSP</code> URL in an authorityInfoAccess extension and the issuer certificate for the subject certificate.  First, load the issuer and subject certificates:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="X509/Certificate.html" title="OpenSSL::X509::Certificate (class)">Certificate</a></span>.<span class='id identifier rubyid_new'><a href="X509/Certificate.html#new-class_method" title="OpenSSL::X509::Certificate.new (method)">new</a></span> <span class='id identifier rubyid_subject_pem'>subject_pem</span>
<span class='id identifier rubyid_issuer'>issuer</span>  <span class='op'>=</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="X509/Certificate.html" title="OpenSSL::X509::Certificate (class)">Certificate</a></span>.<span class='id identifier rubyid_new'><a href="X509/Certificate.html#new-class_method" title="OpenSSL::X509::Certificate.new (method)">new</a></span> <span class='id identifier rubyid_issuer_pem'>issuer_pem</span></code></pre>

<p>To create the request we need to create a certificate ID for the subject certificate so the CA knows which certificate we are asking about:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_new'><a href="Digest.html#new-class_method" title="OpenSSL::Digest.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA1</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_certificate_id'>certificate_id</span> <span class='op'>=</span>
  <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'>OCSP</span><span class='op'>::</span><span class='const'><a href="OCSP/CertificateId.html" title="OpenSSL::OCSP::CertificateId (class)">CertificateId</a></span>.<span class='id identifier rubyid_new'><a href="OCSP/CertificateId.html#new-class_method" title="OpenSSL::OCSP::CertificateId.new (method)">new</a></span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_issuer'>issuer</span><span class='comma'>,</span> <span class='id identifier rubyid_digest'>digest</span></code></pre>

<p>Then create a request and add the certificate ID to it:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'>OCSP</span><span class='op'>::</span><span class='const'><a href="OCSP/Request.html" title="OpenSSL::OCSP::Request (class)">Request</a></span>.<span class='id identifier rubyid_new'><a href="OCSP/Request.html#new-class_method" title="OpenSSL::OCSP::Request.new (method)">new</a></span>
<span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_add_certid'>add_certid</span> <span class='id identifier rubyid_certificate_id'>certificate_id</span></code></pre>

<p>Adding a nonce to the request protects against replay attacks but not all CA process the nonce.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_add_nonce'>add_nonce</span></code></pre>

<p>To submit the request to the CA for verification we need to extract the <code>OCSP</code> URI from the subject certificate:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ocsp_uris'>ocsp_uris</span> <span class='op'>=</span> <span class='id identifier rubyid_subject'>subject</span>.<span class='id identifier rubyid_ocsp_uris'>ocsp_uris</span>

<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uri</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_ocsp_uri'>ocsp_uri</span> <span class='op'>=</span> <span class='const'>URI</span> <span class='id identifier rubyid_ocsp_uris'>ocsp_uris</span>[<span class='int'>0</span>]</code></pre>

<p>To submit the request we’ll POST the request to the <code>OCSP</code> URI (per RFC 2560).  Note that we only handle HTTP requests and don’t handle any redirects in this example, so this is insufficient for serious use.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>net/http</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>http_response =</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span>.<span class='id identifier rubyid_start'>start</span> <span class='id identifier rubyid_ocsp_uri'>ocsp_uri</span>.<span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_ocsp'>ocsp</span>.<span class='id identifier rubyid_port'>port</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_http'>http</span><span class='op'>|</span></code></pre>

<p>http.post ocsp_uri.path, request.to_der,</p>

<pre class="code ruby"><code class="ruby">              <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-type</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/ocsp-request</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>

<span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'>OCSP</span><span class='op'>::</span><span class='const'><a href="OCSP/Response.html" title="OpenSSL::OCSP::Response (class)">Response</a></span>.<span class='id identifier rubyid_new'><a href="OCSP/Response.html#new-class_method" title="OpenSSL::OCSP::Response.new (method)">new</a></span> <span class='id identifier rubyid_http_response'>http_response</span>.<span class='id identifier rubyid_body'>body</span>
<span class='id identifier rubyid_response_basic'>response_basic</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_basic'>basic</span></code></pre>

<p>First we check if the response has a valid signature.  Without a valid signature we cannot trust it.  If you get a failure here you may be missing a system certificate store or may be missing the intermediate certificates.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="X509/Store.html" title="OpenSSL::X509::Store (class)">Store</a></span>.<span class='id identifier rubyid_new'><a href="X509/Store.html#new-class_method" title="OpenSSL::X509::Store.new (method)">new</a></span>
<span class='id identifier rubyid_store'>store</span>.<span class='id identifier rubyid_set_default_paths'>set_default_paths</span>

<span class='kw'>unless</span> <span class='id identifier rubyid_response_basic'>response_basic</span>.<span class='id identifier rubyid_verify'>verify</span> []<span class='comma'>,</span> <span class='id identifier rubyid_store'>store</span> <span class='kw'>then</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>response is not signed by a trusted certificate</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<p>The response contains the status information (success/fail).  We can display the status as a string:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_status_string'>status_string</span> <span class='comment'>#=&gt; successful</span></code></pre>

<p>Next we need to know the response details to determine if the response matches our request.  First we check the nonce.  Again, not all CAs support a nonce.  See <a href="OCSP/Request.html#check_nonce-instance_method" title="OpenSSL::OCSP::Request#check_nonce (method)">Request#check_nonce</a> for the meanings of the return values.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_check_nonce'>check_nonce</span> <span class='id identifier rubyid_basic_response'>basic_response</span> <span class='comment'>#=&gt; value from -1 to 3</span></code></pre>

<p>Then extract the status information for the certificate from the basic response.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_single_response'>single_response</span> <span class='op'>=</span> <span class='id identifier rubyid_basic_response'>basic_response</span>.<span class='id identifier rubyid_find_response'>find_response</span>(<span class='id identifier rubyid_certificate_id'>certificate_id</span>)

<span class='kw'>unless</span> <span class='id identifier rubyid_single_response'>single_response</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basic_response does not have the status for the certificate</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<p>Then check the validity. A status issued in the future must be rejected.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>unless</span> <span class='id identifier rubyid_single_response'>single_response</span>.<span class='id identifier rubyid_check_validity'>check_validity</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>this_update is in the future or next_update time has passed</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>

<span class='kw'>case</span> <span class='id identifier rubyid_single_response'>single_response</span>.<span class='id identifier rubyid_cert_status'>cert_status</span>
<span class='kw'>when</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'>OCSP</span><span class='op'>::</span><span class='const'><a href="#V_CERTSTATUS_GOOD-constant" title="OpenSSL::OCSP::V_CERTSTATUS_GOOD (constant)">V_CERTSTATUS_GOOD</a></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>certificate is still valid</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>when</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'>OCSP</span><span class='op'>::</span><span class='const'><a href="#V_CERTSTATUS_REVOKED-constant" title="OpenSSL::OCSP::V_CERTSTATUS_REVOKED (constant)">V_CERTSTATUS_REVOKED</a></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>certificate has been revoked at </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_single_response'>single_response</span>.<span class='id identifier rubyid_revocation_time'>revocation_time</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>when</span> <span class='const'><a href="../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'>OCSP</span><span class='op'>::</span><span class='const'><a href="#V_CERTSTATUS_UNKNOWN-constant" title="OpenSSL::OCSP::V_CERTSTATUS_UNKNOWN (constant)">V_CERTSTATUS_UNKNOWN</a></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>responder doesn</span><span class='tstring_end'>&#39;</span></span><span class='id identifier rubyid_t'>t</span> <span class='id identifier rubyid_know'>know</span> <span class='id identifier rubyid_about'>about</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>
end</span></code></pre>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='NOCASIGN-constant' class='summary_signature'>NOCASIGN =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>(This flag is not used by <a href="../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> 1.0.1g)</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1925'># File 'ext/openssl/ossl_ocsp.c', line 1925</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOCASIGN</span>)</pre>
  </li>
  <li>
    <span id='NOCERTS-constant' class='summary_signature'>NOCERTS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not include certificates in the response</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1907'># File 'ext/openssl/ossl_ocsp.c', line 1907</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOCERTS</span>)</pre>
  </li>
  <li>
    <span id='NOCHAIN-constant' class='summary_signature'>NOCHAIN =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not verify the certificate chain on the response</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1916'># File 'ext/openssl/ossl_ocsp.c', line 1916</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOCHAIN</span>)</pre>
  </li>
  <li>
    <span id='NOCHECKS-constant' class='summary_signature'>NOCHECKS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not make additional signing certificate checks</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1931'># File 'ext/openssl/ossl_ocsp.c', line 1931</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOCHECKS</span>)</pre>
  </li>
  <li>
    <span id='NODELEGATED-constant' class='summary_signature'>NODELEGATED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>(This flag is not used by <a href="../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> 1.0.1g)</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1928'># File 'ext/openssl/ossl_ocsp.c', line 1928</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NODELEGATED</span>)</pre>
  </li>
  <li>
    <span id='NOEXPLICIT-constant' class='summary_signature'>NOEXPLICIT =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not check trust</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1922'># File 'ext/openssl/ossl_ocsp.c', line 1922</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOEXPLICIT</span>)</pre>
  </li>
  <li>
    <span id='NOINTERN-constant' class='summary_signature'>NOINTERN =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not search certificates contained in the response for a signer</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1910'># File 'ext/openssl/ossl_ocsp.c', line 1910</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOINTERN</span>)</pre>
  </li>
  <li>
    <span id='NOSIGS-constant' class='summary_signature'>NOSIGS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not check the signature on the response</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1913'># File 'ext/openssl/ossl_ocsp.c', line 1913</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOSIGS</span>)</pre>
  </li>
  <li>
    <span id='NOTIME-constant' class='summary_signature'>NOTIME =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not include producedAt time in response</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1940'># File 'ext/openssl/ossl_ocsp.c', line 1940</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOTIME</span>)</pre>
  </li>
  <li>
    <span id='NOVERIFY-constant' class='summary_signature'>NOVERIFY =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not verify the response at all</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1919'># File 'ext/openssl/ossl_ocsp.c', line 1919</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_NOVERIFY</span>)</pre>
  </li>
  <li>
    <span id='RESPID_KEY-constant' class='summary_signature'>RESPID_KEY =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Identify the response by signing the certificate key ID</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1937'># File 'ext/openssl/ossl_ocsp.c', line 1937</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_RESPID_KEY</span>)</pre>
  </li>
  <li>
    <span id='RESPONSE_STATUS_INTERNALERROR-constant' class='summary_signature'>RESPONSE_STATUS_INTERNALERROR =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Internal error in issuer</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1861'># File 'ext/openssl/ossl_ocsp.c', line 1861</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_RESPONSE_STATUS_INTERNALERROR</span>)</pre>
  </li>
  <li>
    <span id='RESPONSE_STATUS_MALFORMEDREQUEST-constant' class='summary_signature'>RESPONSE_STATUS_MALFORMEDREQUEST =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Illegal confirmation request</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1864'># File 'ext/openssl/ossl_ocsp.c', line 1864</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_RESPONSE_STATUS_MALFORMEDREQUEST</span>)</pre>
  </li>
  <li>
    <span id='RESPONSE_STATUS_SIGREQUIRED-constant' class='summary_signature'>RESPONSE_STATUS_SIGREQUIRED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>You must sign the request and resubmit</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1870'># File 'ext/openssl/ossl_ocsp.c', line 1870</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_RESPONSE_STATUS_SIGREQUIRED</span>)</pre>
  </li>
  <li>
    <span id='RESPONSE_STATUS_SUCCESSFUL-constant' class='summary_signature'>RESPONSE_STATUS_SUCCESSFUL =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><a href="OCSP/Response.html" title="OpenSSL::OCSP::Response (class)"><code>OCSP::Response</code></a> has valid confirmations</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1873'># File 'ext/openssl/ossl_ocsp.c', line 1873</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_RESPONSE_STATUS_SUCCESSFUL</span>)</pre>
  </li>
  <li>
    <span id='RESPONSE_STATUS_TRYLATER-constant' class='summary_signature'>RESPONSE_STATUS_TRYLATER =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Try again later</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1876'># File 'ext/openssl/ossl_ocsp.c', line 1876</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_RESPONSE_STATUS_TRYLATER</span>)</pre>
  </li>
  <li>
    <span id='RESPONSE_STATUS_UNAUTHORIZED-constant' class='summary_signature'>RESPONSE_STATUS_UNAUTHORIZED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Your request is unauthorized.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1901'># File 'ext/openssl/ossl_ocsp.c', line 1901</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_RESPONSE_STATUS_UNAUTHORIZED</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_AFFILIATIONCHANGED-constant' class='summary_signature'>REVOKED_STATUS_AFFILIATIONCHANGED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate subject’s name or other information changed</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1879'># File 'ext/openssl/ossl_ocsp.c', line 1879</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_AFFILIATIONCHANGED</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_CACOMPROMISE-constant' class='summary_signature'>REVOKED_STATUS_CACOMPROMISE =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>This CA certificate was revoked due to a key compromise</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1882'># File 'ext/openssl/ossl_ocsp.c', line 1882</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_CACOMPROMISE</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_CERTIFICATEHOLD-constant' class='summary_signature'>REVOKED_STATUS_CERTIFICATEHOLD =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate is on hold</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1885'># File 'ext/openssl/ossl_ocsp.c', line 1885</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_CERTIFICATEHOLD</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_CESSATIONOFOPERATION-constant' class='summary_signature'>REVOKED_STATUS_CESSATIONOFOPERATION =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate is no longer needed</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1888'># File 'ext/openssl/ossl_ocsp.c', line 1888</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_CESSATIONOFOPERATION</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_KEYCOMPROMISE-constant' class='summary_signature'>REVOKED_STATUS_KEYCOMPROMISE =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate was revoked due to a key compromise</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1891'># File 'ext/openssl/ossl_ocsp.c', line 1891</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_KEYCOMPROMISE</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_NOSTATUS-constant' class='summary_signature'>REVOKED_STATUS_NOSTATUS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate was revoked for an unknown reason</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1867'># File 'ext/openssl/ossl_ocsp.c', line 1867</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_NOSTATUS</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_REMOVEFROMCRL-constant' class='summary_signature'>REVOKED_STATUS_REMOVEFROMCRL =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate was previously on hold and should now be removed from the CRL</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1895'># File 'ext/openssl/ossl_ocsp.c', line 1895</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_REMOVEFROMCRL</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_SUPERSEDED-constant' class='summary_signature'>REVOKED_STATUS_SUPERSEDED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate was superseded by a new certificate</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1898'># File 'ext/openssl/ossl_ocsp.c', line 1898</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_SUPERSEDED</span>)</pre>
  </li>
  <li>
    <span id='REVOKED_STATUS_UNSPECIFIED-constant' class='summary_signature'>REVOKED_STATUS_UNSPECIFIED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The certificate was revoked for an unspecified reason</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1904'># File 'ext/openssl/ossl_ocsp.c', line 1904</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_REVOKED_STATUS_UNSPECIFIED</span>)</pre>
  </li>
  <li>
    <span id='TRUSTOTHER-constant' class='summary_signature'>TRUSTOTHER =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Do not verify additional certificates</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1934'># File 'ext/openssl/ossl_ocsp.c', line 1934</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>OCSP_TRUSTOTHER</span>)</pre>
  </li>
  <li>
    <span id='V_CERTSTATUS_GOOD-constant' class='summary_signature'>V_CERTSTATUS_GOOD =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Indicates the certificate is not revoked but does not necessarily mean the certificate was issued or that this response is within the certificate’s validity interval</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1945'># File 'ext/openssl/ossl_ocsp.c', line 1945</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>V_OCSP_CERTSTATUS_GOOD</span>)</pre>
  </li>
  <li>
    <span id='V_CERTSTATUS_REVOKED-constant' class='summary_signature'>V_CERTSTATUS_REVOKED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Indicates the certificate has been revoked either permanently or temporarily (on hold).</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1948'># File 'ext/openssl/ossl_ocsp.c', line 1948</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>V_OCSP_CERTSTATUS_REVOKED</span>)</pre>
  </li>
  <li>
    <span id='V_CERTSTATUS_UNKNOWN-constant' class='summary_signature'>V_CERTSTATUS_UNKNOWN =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Indicates the responder does not know about the certificate being requested.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1952'># File 'ext/openssl/ossl_ocsp.c', line 1952</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>V_OCSP_CERTSTATUS_UNKNOWN</span>)</pre>
  </li>
  <li>
    <span id='V_RESPID_KEY-constant' class='summary_signature'>V_RESPID_KEY =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The responder ID is based on the public key.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1958'># File 'ext/openssl/ossl_ocsp.c', line 1958</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>V_OCSP_RESPID_KEY</span>)</pre>
  </li>
  <li>
    <span id='V_RESPID_NAME-constant' class='summary_signature'>V_RESPID_NAME =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The responder ID is based on the key name.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_7/ext/openssl/ossl_ocsp.c#L1955'># File 'ext/openssl/ossl_ocsp.c', line 1955</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>V_OCSP_RESPID_NAME</span>)</pre>
  </li>
</ul>
</div>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>