<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: RubyVM::YJIT &mdash; Core Ruby-3.1.4 pp223</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "RubyVM::YJIT",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Ruby-3.1.4</a> &raquo; 
      <a href='../'>Core</a> &raquo; 
      <a href='../_index.html#alpha_Y'>Index (Y)</a> &raquo; 
        <a href="../RubyVM.html" title="RubyVM (class)">RubyVM</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>YJIT&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: RubyVM::YJIT</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="YJIT/Block.html" title="RubyVM::YJIT::Block (class)"><code>Block</code></a>,
        <a href="YJIT/Disasm.html" title="RubyVM::YJIT::Disasm (class)"><code>Disasm</code></a>      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L11'>yjit.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit_iface.c#L1275'>yjit_iface.c</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>This module allows for introspection of <code>YJIT</code>, CRuby’s experimental in-process just-in-time compiler. This module exists only to help develop <code>YJIT</code>, as such, everything in the module is highly implementation specific and comes with no API stability guarantee whatsoever.</p>

<p>This module may not exist if <code>YJIT</code> does not support the particular platform for which CRuby is built. There is also no API stability guarantee as to in what situations this module is defined.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#enabled%3F-class_method" title=".enabled? (class method)">.<strong>enabled?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#stats_enabled%3F-class_method" title=".stats_enabled? (class method)">.<strong>stats_enabled?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#comments_for-class_method" title=".comments_for (class method)">.<strong>comments_for</strong>(start_address, end_address)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#disasm-class_method" title=".disasm (class method)">.<strong>disasm</strong>(iseq, tty: $stdout &amp;&amp; $stdout.tty?)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#disasm_block-class_method" title=".disasm_block (class method)">.<strong>disasm_block</strong>(cs, block, highlight)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#graphviz_for-class_method" title=".graphviz_for (class method)">.<strong>graphviz_for</strong>(iseq)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reset_stats!-class_method" title=".reset_stats! (class method)">.<strong>reset_stats!</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Discard statistics collected for –yjit-stats.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#runtime_stats-class_method" title=".runtime_stats (class method)">.<strong>runtime_stats</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return a hash for statistics generated for the –yjit-stats command line option.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#simulate_oom!-class_method" title=".simulate_oom! (class method)">.<strong>simulate_oom!</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#blocks_for-class_method" title=".blocks_for (class method)">.<strong>blocks_for</strong>(rb_iseq)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#_print_stats-class_method" title="._print_stats (class method)">.<strong>_print_stats</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Format and print out counters.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#print_counters-class_method" title=".print_counters (class method)">.<strong>print_counters</strong>(counters, prefix:, prompt:)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#print_sorted_exit_counts-class_method" title=".print_sorted_exit_counts (class method)">.<strong>print_sorted_exit_counts</strong>(stats, prefix:, how_many: 20, left_pad: 4)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#total_exit_count-class_method" title=".total_exit_count (class method)">.<strong>total_exit_count</strong>(stats, prefix: &quot;exit_&quot;)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->
<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="enabled?-class_method">
  <h3 class='signature ro first'>
    .<strong>enabled?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L151-L153'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='151' data-end='153'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 151</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_enabled?'>enabled?</span>
  <span class='const'>Primitive</span>.<span class='id identifier rubyid_cexpr!'>cexpr!</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rb_yjit_enabled_p() ? Qtrue : Qfalse</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stats_enabled?-class_method">
  <h3 class='signature ro'>
    .<strong>stats_enabled?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L147-L149'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='147' data-end='149'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 147</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_stats_enabled?'>stats_enabled?</span>
  <span class='const'>Primitive</span>.<span class='id identifier rubyid_yjit_stats_enabled_p'>yjit_stats_enabled_p</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="_print_stats-class_method">
  <h3 class='signature priv first'>
    .<strong>_print_stats</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Format and print out counters</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L168-L220'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='168' data-end='220'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 168</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__print_stats'>_print_stats</span>
  <span class='id identifier rubyid_stats'>stats</span> <span class='op'>=</span> <span class='id identifier rubyid_runtime_stats'><a href="#runtime_stats-class_method" title="RubyVM::YJIT.runtime_stats (method)">runtime_stats</a></span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_stats'>stats</span>

  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>***YJIT: Printing YJIT statistics on exit***</span><span class='tstring_end'>&quot;</span></span>)

  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>send_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>method call exit reasons: </span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>invokesuper_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>invokesuper exit reasons: </span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>leave_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>leave exit reasons: </span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gbpp_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>getblockparamproxy exit reasons: </span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>getivar_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>getinstancevariable exit reasons:</span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>setivar_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>setinstancevariable exit reasons:</span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>oaref_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>opt_aref exit reasons: </span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>expandarray_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>expandarray exit reasons: </span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>opt_getinlinecache_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>opt_getinlinecache exit reasons: </span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_print_counters'><a href="#print_counters-class_method" title="RubyVM::YJIT.print_counters (method)">print_counters</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>invalidate_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>prompt:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>invalidation reasons: </span><span class='tstring_end'>&#39;</span></span>)

  <span class='id identifier rubyid_side_exits'>side_exits</span> <span class='op'>=</span> <span class='id identifier rubyid_total_exit_count'><a href="#total_exit_count-class_method" title="RubyVM::YJIT.total_exit_count (method)">total_exit_count</a></span>(<span class='id identifier rubyid_stats'>stats</span>)
  <span class='id identifier rubyid_total_exits'>total_exits</span> <span class='op'>=</span> <span class='id identifier rubyid_side_exits'>side_exits</span> <span class='op'>+</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_leave_interp_return'>leave_interp_return</span>]

  <span class='comment'># Number of instructions that finish executing in YJIT.
</span>  <span class='comment'># See :count-placement: about the subtraction.
</span>  <span class='id identifier rubyid_retired_in_yjit'>retired_in_yjit</span> <span class='op'>=</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_exec_instruction'>exec_instruction</span>] <span class='op'>-</span> <span class='id identifier rubyid_side_exits'>side_exits</span>

  <span class='comment'># Average length of instruction sequences executed by YJIT
</span>  <span class='id identifier rubyid_avg_len_in_yjit'>avg_len_in_yjit</span> <span class='op'>=</span> <span class='id identifier rubyid_retired_in_yjit'>retired_in_yjit</span>.<span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_total_exits'>total_exits</span>

  <span class='comment'># Proportion of instructions that retire in YJIT
</span>  <span class='id identifier rubyid_total_insns_count'>total_insns_count</span> <span class='op'>=</span> <span class='id identifier rubyid_retired_in_yjit'>retired_in_yjit</span> <span class='op'>+</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_vm_insns_count'>vm_insns_count</span>]
  <span class='id identifier rubyid_yjit_ratio_pct'>yjit_ratio_pct</span> <span class='op'>=</span> <span class='float'>100.0</span> <span class='op'>*</span> <span class='id identifier rubyid_retired_in_yjit'>retired_in_yjit</span>.<span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_total_insns_count'>total_insns_count</span>

  <span class='comment'># Number of failed compiler invocations
</span>  <span class='id identifier rubyid_compilation_failure'>compilation_failure</span> <span class='op'>=</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_compilation_failure'>compilation_failure</span>]

  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bindings_allocations:  </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_binding_allocations'>binding_allocations</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bindings_set:          </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_binding_set'>binding_set</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>compilation_failure:   </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_compilation_failure'>compilation_failure</span>) <span class='kw'>if</span> <span class='id identifier rubyid_compilation_failure'>compilation_failure</span> <span class='op'>!=</span> <span class='int'>0</span>
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>compiled_iseq_count:   </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_compiled_iseq_count'>compiled_iseq_count</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>compiled_block_count:  </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_compiled_block_count'>compiled_block_count</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalidation_count:    </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_invalidation_count'>invalidation_count</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>constant_state_bumps:  </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_constant_state_bumps'>constant_state_bumps</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>inline_code_size:      </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_inline_code_size'>inline_code_size</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>outlined_code_size:    </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_outlined_code_size'>outlined_code_size</span>])

  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>total_exit_count:      </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_total_exits'>total_exits</span>)
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>total_insns_count:     </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_total_insns_count'>total_insns_count</span>)
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>vm_insns_count:        </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_vm_insns_count'>vm_insns_count</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>yjit_insns_count:      </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_stats'>stats</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_exec_instruction'>exec_instruction</span>])
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ratio_in_yjit:         </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%9.1f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_yjit_ratio_pct'>yjit_ratio_pct</span>) <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%</span><span class='tstring_end'>&quot;</span></span>
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>avg_len_in_yjit:       </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> (<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10.1f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_avg_len_in_yjit'>avg_len_in_yjit</span>)

  <span class='id identifier rubyid_print_sorted_exit_counts'><a href="#print_sorted_exit_counts-class_method" title="RubyVM::YJIT.print_sorted_exit_counts (method)">print_sorted_exit_counts</a></span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exit_</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="blocks_for-class_method">
  <h3 class='signature private'>
    .<strong>blocks_for</strong>(rb_iseq)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit_iface.c#L507-L530'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='507' data-end='530'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit_iface.c', line 507</span></pre>
<pre class='code cpp'>

static VALUE
yjit_blocks_for(VALUE mod, VALUE rb_iseq)
{
    if (CLASS_OF(rb_iseq) != rb_cISeq) {
        return rb_ary_new();
    }

    const rb_iseq_t *iseq = rb_iseqw_to_iseq(rb_iseq);

    VALUE all_versions = rb_ary_new();
    rb_darray_for(iseq-&gt;body-&gt;yjit_blocks, version_array_idx) {
        rb_yjit_block_array_t versions = rb_darray_get(iseq-&gt;body-&gt;yjit_blocks, version_array_idx);

        rb_darray_for(versions, block_idx) {
            block_t *block = rb_darray_get(versions, block_idx);

            // FIXME: The object craeted here can outlive the block itself
            VALUE rb_block = TypedData_Wrap_Struct(cYjitBlock, &amp;yjit_block_type, block);
            rb_ary_push(all_versions, rb_block);
        }
    }

    return all_versions;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="comments_for-class_method">
  <h3 class='signature '>
    .<strong>comments_for</strong>(start_address, end_address)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L65-L67'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='65' data-end='67'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 65</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_comments_for'>comments_for</span>(<span class='id identifier rubyid_start_address'>start_address</span><span class='comma'>,</span> <span class='id identifier rubyid_end_address'>end_address</span>)
  <span class='const'>Primitive</span>.<span class='id identifier rubyid_comments_for'>comments_for</span>(<span class='id identifier rubyid_start_address'>start_address</span><span class='comma'>,</span> <span class='id identifier rubyid_end_address'>end_address</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disasm-class_method">
  <h3 class='signature '>
    .<strong>disasm</strong>(iseq, tty: $stdout &amp;&amp; $stdout.tty?)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L13-L63'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='13' data-end='63'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 13</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_disasm'>disasm</span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='label'>tty:</span> <span class='gvar'>$stdout</span> <span class='op'>&amp;&amp;</span> <span class='gvar'>$stdout</span>.<span class='id identifier rubyid_tty?'>tty?</span>)
  <span class='id identifier rubyid_iseq'>iseq</span> <span class='op'>=</span> <span class='const'><a href="../RubyVM.html" title="RubyVM (class)">RubyVM</a></span><span class='op'>::</span><span class='const'><a href="InstructionSequence.html" title="RubyVM::InstructionSequence (class)">InstructionSequence</a></span>.<span class='id identifier rubyid_of'><a href="InstructionSequence.html#of-class_method" title="RubyVM::InstructionSequence.of (method)">of</a></span>(<span class='id identifier rubyid_iseq'>iseq</span>)

  <span class='id identifier rubyid_blocks'>blocks</span> <span class='op'>=</span> <span class='id identifier rubyid_blocks_for'><a href="#blocks_for-class_method" title="RubyVM::YJIT.blocks_for (method)">blocks_for</a></span>(<span class='id identifier rubyid_iseq'>iseq</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_blocks'>blocks</span>.<span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>.<span class='id identifier rubyid_new'><a href="../String.html#new-class_method" title="String.new (method)">new</a></span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_disasm'>disasm</span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Sort the blocks by increasing addresses
</span>  <span class='id identifier rubyid_sorted_blocks'>sorted_blocks</span> <span class='op'>=</span> <span class='id identifier rubyid_blocks'>blocks</span>.<span class='id identifier rubyid_sort_by'>sort_by</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span>)

  <span class='id identifier rubyid_highlight'>highlight</span> <span class='op'>=</span> <span class='tlambda'>-&gt;</span>(<span class='id identifier rubyid_str'>str</span>) <span class='tlambeg'>{</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_tty'>tty</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x1b[1m</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str'>str</span><span class='embexpr_end'>}</span><span class='tstring_content'>\x1b[0m</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_str'>str</span>
    <span class='kw'>end</span>
  }

  <span class='id identifier rubyid_cs'>cs</span> <span class='op'>=</span> <span class='const'><a href="YJIT/Disasm.html" title="RubyVM::YJIT::Disasm (class)">Disasm</a></span>.<span class='id identifier rubyid_new'><a href="../BasicObject.html#new-class_method" title="BasicObject.new (method)">new</a></span>
  <span class='id identifier rubyid_sorted_blocks'>sorted_blocks</span>.<span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>== BLOCK </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_blocks'>blocks</span>.<span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_code'>code</span>.<span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> BYTES, ISEQ RANGE [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_iseq_start_index'>iseq_start_index</span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_iseq_end_index'>iseq_end_index</span><span class='embexpr_end'>}</span><span class='tstring_content'>) </span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_ljust'>ljust</span>(<span class='int'>80</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>

    <span class='id identifier rubyid_comments'>comments</span> <span class='op'>=</span> <span class='id identifier rubyid_comments_for'><a href="#comments_for-class_method" title="RubyVM::YJIT.comments_for (method)">comments_for</a></span>(<span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_address'>address</span> <span class='op'>+</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_code'>code</span>.<span class='id identifier rubyid_length'>length</span>)
    <span class='id identifier rubyid_comment_idx'>comment_idx</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_cs'>cs</span>.<span class='id identifier rubyid_disasm'>disasm</span>(<span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_address'>address</span>).<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
      <span class='kw'>while</span> (<span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='id identifier rubyid_comments'>comments</span>[<span class='id identifier rubyid_comment_idx'>comment_idx</span>]) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_comment'>comment</span>.<span class='id identifier rubyid_address'>address</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_address'>address</span>
        <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  ; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_highlight'>highlight</span>.<span class='id identifier rubyid_call'>call</span>(<span class='id identifier rubyid_comment'>comment</span>.<span class='id identifier rubyid_comment'>comment</span>)<span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_comment_idx'>comment_idx</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_sprintf'>sprintf</span>(
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  %&lt;address&gt;08x:  %&lt;instruction&gt;s\t%&lt;details&gt;s\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='label'>address:</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_address'>address</span><span class='comma'>,</span>
        <span class='label'>instruction:</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_mnemonic'>mnemonic</span><span class='comma'>,</span>
        <span class='label'>details:</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_op_str'>op_str</span>
      )
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_block_sizes'>block_sizes</span> <span class='op'>=</span> <span class='id identifier rubyid_blocks'>blocks</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_block'>block</span><span class='op'>|</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_code'>code</span>.<span class='id identifier rubyid_length'>length</span> }
  <span class='id identifier rubyid_total_bytes'>total_bytes</span> <span class='op'>=</span> <span class='id identifier rubyid_block_sizes'>block_sizes</span>.<span class='id identifier rubyid_sum'>sum</span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Total code size: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_total_bytes'>total_bytes</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disasm_block-class_method">
  <h3 class='signature '>
    .<strong>disasm_block</strong>(cs, block, highlight)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L113-L131'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='113' data-end='131'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 113</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_disasm_block'>disasm_block</span>(<span class='id identifier rubyid_cs'>cs</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_highlight'>highlight</span>)
  <span class='id identifier rubyid_comments'>comments</span> <span class='op'>=</span> <span class='id identifier rubyid_comments_for'><a href="#comments_for-class_method" title="RubyVM::YJIT.comments_for (method)">comments_for</a></span>(<span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_address'>address</span> <span class='op'>+</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_code'>code</span>.<span class='id identifier rubyid_length'>length</span>)
  <span class='id identifier rubyid_comment_idx'>comment_idx</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_cs'>cs</span>.<span class='id identifier rubyid_disasm'><a href="#disasm-class_method" title="RubyVM::YJIT.disasm (method)">disasm</a></span>(<span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_address'>address</span>).<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>while</span> (<span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='id identifier rubyid_comments'>comments</span>[<span class='id identifier rubyid_comment_idx'>comment_idx</span>]) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_comment'>comment</span>.<span class='id identifier rubyid_address'>address</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_address'>address</span>
      <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  ; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_highlight'>highlight</span>.<span class='id identifier rubyid_call'>call</span>(<span class='id identifier rubyid_comment'>comment</span>.<span class='id identifier rubyid_comment'>comment</span>)<span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_comment_idx'>comment_idx</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_sprintf'>sprintf</span>(
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  %&lt;address&gt;08x:  %&lt;instruction&gt;s\t%&lt;details&gt;s\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='label'>address:</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_address'>address</span><span class='comma'>,</span>
      <span class='label'>instruction:</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_mnemonic'>mnemonic</span><span class='comma'>,</span>
      <span class='label'>details:</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_op_str'>op_str</span>
    )
  <span class='kw'>end</span>
  <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="graphviz_for-class_method">
  <h3 class='signature '>
    .<strong>graphviz_for</strong>(iseq)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L69-L111'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='69' data-end='111'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 69</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_graphviz_for'>graphviz_for</span>(<span class='id identifier rubyid_iseq'>iseq</span>)
  <span class='id identifier rubyid_iseq'>iseq</span> <span class='op'>=</span> <span class='const'><a href="../RubyVM.html" title="RubyVM (class)">RubyVM</a></span><span class='op'>::</span><span class='const'><a href="InstructionSequence.html" title="RubyVM::InstructionSequence (class)">InstructionSequence</a></span>.<span class='id identifier rubyid_of'><a href="InstructionSequence.html#of-class_method" title="RubyVM::InstructionSequence.of (method)">of</a></span>(<span class='id identifier rubyid_iseq'>iseq</span>)
  <span class='id identifier rubyid_cs'>cs</span> <span class='op'>=</span> <span class='const'><a href="YJIT/Disasm.html" title="RubyVM::YJIT::Disasm (class)">Disasm</a></span>.<span class='id identifier rubyid_new'><a href="../BasicObject.html#new-class_method" title="BasicObject.new (method)">new</a></span>

  <span class='id identifier rubyid_highlight'>highlight</span> <span class='op'>=</span> <span class='tlambda'>-&gt;</span>(<span class='id identifier rubyid_comment'>comment</span>) <span class='tlambeg'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;b&gt;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_comment'>comment</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/b&gt;</span><span class='tstring_end'>&quot;</span></span> }
  <span class='id identifier rubyid_linebreak'>linebreak</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;br align=\&quot;left\&quot;/&gt;\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>=</span> <span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_blocks'>blocks</span> <span class='op'>=</span> <span class='id identifier rubyid_blocks_for'><a href="#blocks_for-class_method" title="RubyVM::YJIT.blocks_for (method)">blocks_for</a></span>(<span class='id identifier rubyid_iseq'>iseq</span>).<span class='id identifier rubyid_sort_by'>sort_by</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span>)
  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>digraph g {\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Write the iseq info as a legend
</span>  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  legend [shape=record fontsize=\&quot;30\&quot; fillcolor=\&quot;lightgrey\&quot; style=\&quot;filled\&quot;];\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  legend [label=\&quot;{ Instruction Disassembly For: | {</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_base_label'>base_label</span><span class='embexpr_end'>}</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_first_lineno'>first_lineno</span><span class='embexpr_end'>}</span><span class='tstring_content'>}}\&quot;];\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Subgraph contains disassembly
</span>  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  subgraph disasm {\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  node [shape=record fontname=\&quot;courier\&quot;];\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  edge [fontname=\&quot;courier\&quot; penwidth=3];\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_blocks'>blocks</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_block'>block</span><span class='op'>|</span>
    <span class='id identifier rubyid_disasm'><a href="#disasm-class_method" title="RubyVM::YJIT.disasm (method)">disasm</a></span> <span class='op'>=</span> <span class='id identifier rubyid_disasm_block'><a href="#disasm_block-class_method" title="RubyVM::YJIT.disasm_block (method)">disasm_block</a></span>(<span class='id identifier rubyid_cs'>cs</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_highlight'>highlight</span>)

    <span class='comment'># convert newlines to breaks that graphviz understands
</span>    <span class='id identifier rubyid_disasm'><a href="#disasm-class_method" title="RubyVM::YJIT.disasm (method)">disasm</a></span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\n</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='id identifier rubyid_linebreak'>linebreak</span>)

    <span class='comment'># strip leading whitespace
</span>    <span class='id identifier rubyid_disasm'><a href="#disasm-class_method" title="RubyVM::YJIT.disasm (method)">disasm</a></span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)

    <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> [label=&lt;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_disasm'><a href="#disasm-class_method" title="RubyVM::YJIT.disasm (method)">disasm</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;];\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_outgoing_ids'>outgoing_ids</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>
      <span class='id identifier rubyid_next_block'>next_block</span> <span class='op'>=</span> <span class='id identifier rubyid_blocks'>blocks</span>.<span class='id identifier rubyid_bsearch'>bsearch</span> { <span class='op'>|</span><span class='id identifier rubyid_nb'>nb</span><span class='op'>|</span> <span class='id identifier rubyid_id'>id</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_nb'>nb</span>.<span class='id identifier rubyid_id'>id</span> }
      <span class='kw'>if</span> <span class='id identifier rubyid_next_block'>next_block</span>.<span class='id identifier rubyid_address'>address</span> <span class='op'>==</span> (<span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_address'>address</span> <span class='op'>+</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_code'>code</span>.<span class='id identifier rubyid_length'>length</span>)
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> -&gt; b</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>[label=\&quot;Fall\&quot;];</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>else</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> -&gt; b</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>[label=\&quot;Jump\&quot; style=dashed];</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    }.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  }</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_buff'>buff</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_buff'>buff</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="print_counters-class_method">
  <h3 class='signature priv'>
    .<strong>print_counters</strong>(counters, prefix:, prompt:)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L257-L277'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='257' data-end='277'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 257</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_print_counters'>print_counters</span>(<span class='id identifier rubyid_counters'>counters</span><span class='comma'>,</span> <span class='label'>prefix:</span><span class='comma'>,</span> <span class='label'>prompt:</span>)
  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span>(<span class='id identifier rubyid_prompt'>prompt</span>)
  <span class='id identifier rubyid_counters'>counters</span> <span class='op'>=</span> <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_filter'>filter</span> { <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='id identifier rubyid_prefix'>prefix</span>) }
  <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_filter!'>filter!</span> { <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>!=</span> <span class='int'>0</span> }
  <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_transform_keys!'>transform_keys!</span> { <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_delete_prefix'>delete_prefix</span>(<span class='id identifier rubyid_prefix'>prefix</span>) }

  <span class='kw'>if</span> <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>    (all relevant counters are zero)</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_counters'>counters</span> <span class='op'>=</span> <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_to_a'>to_a</span>
  <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_sort_by!'>sort_by!</span> { <span class='op'>|</span>(<span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_counter_value'>counter_value</span>)<span class='op'>|</span> <span class='id identifier rubyid_counter_value'>counter_value</span> }
  <span class='id identifier rubyid_longest_name_length'>longest_name_length</span> <span class='op'>=</span> <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_max_by'>max_by</span> { <span class='op'>|</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span>)<span class='op'>|</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_length'>length</span> }.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_length'>length</span>
  <span class='id identifier rubyid_total'>total</span> <span class='op'>=</span> <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_sum'>sum</span> { <span class='op'>|</span>(<span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_counter_value'>counter_value</span>)<span class='op'>|</span> <span class='id identifier rubyid_counter_value'>counter_value</span> }

  <span class='id identifier rubyid_counters'>counters</span>.<span class='id identifier rubyid_reverse_each'>reverse_each</span> <span class='kw'>do</span> <span class='op'>|</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)<span class='op'>|</span>
    <span class='id identifier rubyid_percentage'>percentage</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_fdiv'>fdiv</span>(<span class='id identifier rubyid_total'>total</span>) <span class='op'>*</span> <span class='int'>100</span>
    <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_printf'>printf</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>    %*s %10d (%4.1f%%)\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_longest_name_length'>longest_name_length</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_percentage'>percentage</span>)<span class='semicolon'>;</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="print_sorted_exit_counts-class_method">
  <h3 class='signature priv'>
    .<strong>print_sorted_exit_counts</strong>(stats, prefix:, how_many: 20, left_pad: 4)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L222-L247'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='222' data-end='247'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 222</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_print_sorted_exit_counts'>print_sorted_exit_counts</span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span><span class='comma'>,</span> <span class='label'>how_many:</span> <span class='int'>20</span><span class='comma'>,</span> <span class='label'>left_pad:</span> <span class='int'>4</span>)
  <span class='id identifier rubyid_exits'>exits</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_stats'>stats</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='id identifier rubyid_prefix'>prefix</span>)
      <span class='id identifier rubyid_exits'>exits</span>.<span class='id identifier rubyid_push'>push</span> [<span class='id identifier rubyid_k'>k</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_delete_prefix'>delete_prefix</span>(<span class='id identifier rubyid_prefix'>prefix</span>)<span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>]
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_exits'>exits</span> <span class='op'>=</span> <span class='id identifier rubyid_exits'>exits</span>.<span class='id identifier rubyid_sort_by'>sort_by</span> { <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='op'>|</span> <span class='op'>-</span><span class='id identifier rubyid_count'>count</span> }[<span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_how_many'>how_many</span>]
  <span class='id identifier rubyid_total_exits'>total_exits</span> <span class='op'>=</span> <span class='id identifier rubyid_total_exit_count'><a href="#total_exit_count-class_method" title="RubyVM::YJIT.total_exit_count (method)">total_exit_count</a></span>(<span class='id identifier rubyid_stats'>stats</span>)

  <span class='id identifier rubyid_top_n_total'>top_n_total</span> <span class='op'>=</span> <span class='id identifier rubyid_exits'>exits</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='op'>|</span> <span class='id identifier rubyid_count'>count</span> }.<span class='id identifier rubyid_sum'>sum</span>
  <span class='id identifier rubyid_top_n_exit_pct'>top_n_exit_pct</span> <span class='op'>=</span> <span class='float'>100.0</span> <span class='op'>*</span> <span class='id identifier rubyid_top_n_total'>top_n_total</span> <span class='op'>/</span> <span class='id identifier rubyid_total_exits'>total_exits</span>

  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Top-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_how_many'>how_many</span><span class='embexpr_end'>}</span><span class='tstring_content'> most frequent exit ops (</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.1f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_top_n_exit_pct'>top_n_exit_pct</span><span class='embexpr_end'>}</span><span class='tstring_content'>% of exits):</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_longest_insn_name_len'>longest_insn_name_len</span> <span class='op'>=</span> <span class='id identifier rubyid_exits'>exits</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='op'>|</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_length'>length</span> }.<span class='id identifier rubyid_max'>max</span>
  <span class='id identifier rubyid_exits'>exits</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='op'>|</span>
    <span class='id identifier rubyid_padding'>padding</span> <span class='op'>=</span> <span class='id identifier rubyid_longest_insn_name_len'>longest_insn_name_len</span> <span class='op'>+</span> <span class='id identifier rubyid_left_pad'>left_pad</span>
    <span class='id identifier rubyid_padded_name'>padded_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_padding'>padding</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_padded_count'>padded_count</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%10d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_count'>count</span>
    <span class='id identifier rubyid_percent'>percent</span> <span class='op'>=</span> <span class='float'>100.0</span> <span class='op'>*</span> <span class='id identifier rubyid_count'>count</span> <span class='op'>/</span> <span class='id identifier rubyid_total_exits'>total_exits</span>
    <span class='id identifier rubyid_formatted_percent'>formatted_percent</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.1f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_percent'>percent</span>
    <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_padded_name'>padded_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_padded_count'>padded_count</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_formatted_percent'>formatted_percent</span><span class='embexpr_end'>}</span><span class='tstring_content'>%)</span><span class='tstring_end'>&quot;</span></span> )
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_stats!-class_method">
  <h3 class='signature '>
    .<strong>reset_stats!</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Discard statistics collected for –yjit-stats.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L142-L145'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='142' data-end='145'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 142</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_reset_stats!'>reset_stats!</span>
  <span class='comment'># defined in yjit_iface.c
</span>  <span class='const'>Primitive</span>.<span class='id identifier rubyid_reset_stats_bang'>reset_stats_bang</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="runtime_stats-class_method">
  <h3 class='signature '>
    .<strong>runtime_stats</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return a hash for statistics generated for the –yjit-stats command line option. Return nil when option is not passed or unavailable.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L136-L139'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='136' data-end='139'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 136</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_runtime_stats'>runtime_stats</span>
  <span class='comment'># defined in yjit_iface.c
</span>  <span class='const'>Primitive</span>.<span class='id identifier rubyid_get_yjit_stats'>get_yjit_stats</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="simulate_oom!-class_method">
  <h3 class='signature '>
    .<strong>simulate_oom!</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L155-L157'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='155' data-end='157'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 155</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_simulate_oom!'>simulate_oom!</span>
  <span class='const'>Primitive</span>.<span class='id identifier rubyid_simulate_oom_bang'>simulate_oom_bang</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="total_exit_count-class_method">
  <h3 class='signature priv'>
    .<strong>total_exit_count</strong>(stats, prefix: &quot;exit_&quot;)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_4/yjit.rb#L249-L255'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='249' data-end='255'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'yjit.rb', line 249</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_total_exit_count'>total_exit_count</span>(<span class='id identifier rubyid_stats'>stats</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exit_</span><span class='tstring_end'>&quot;</span></span>)
  <span class='id identifier rubyid_total'>total</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_stats'>stats</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='id identifier rubyid_total'>total</span> <span class='op'>+=</span> <span class='id identifier rubyid_v'>v</span> <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='id identifier rubyid_prefix'>prefix</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_total'>total</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>