<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: WIN32OLE_EVENT &mdash; win32ole</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "WIN32OLE_EVENT",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-3.1.5</a> &raquo; 
      <a href='.'>win32ole</a> &raquo; 
      <a href='_index.html#alpha_W'>Index (W)</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>WIN32OLE_EVENT&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: WIN32OLE_EVENT</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1267'>ext/win32ole/win32ole_event.c</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L8'>ext/win32ole/win32ole_event.c</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>WIN32OLE_EVENT</code> objects controls OLE event.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#message_loop-class_method" title="message_loop (class method)">.<strong>message_loop</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Translates and dispatches Windows message.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(ole, event) # = &gt; WIN32OLE_EVENT object.))  </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns OLE event object.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#handler-instance_method" title="#handler (instance method)">#<strong>handler</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns handler object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#handler=-instance_method" title="#handler= (instance method)">#<strong>handler=</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>sets event handler object.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#off_event-instance_method" title="#off_event (instance method)">#<strong>off_event</strong>([event])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>removes the callback of event.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_event-instance_method" title="#on_event (instance method)">#<strong>on_event</strong>([event])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Defines the callback event.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_event_with_outargs-instance_method" title="#on_event_with_outargs (instance method)">#<strong>on_event_with_outargs</strong>([event])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Defines the callback of event.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unadvise-instance_method" title="#unadvise (instance method)">#<strong>unadvise</strong>  &#x21d2; nil </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>disconnects OLE server.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(ole, event) # = &gt; WIN32OLE_EVENT object.))    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns OLE event object. The first argument specifies <a href="WIN32OLE.html" title="WIN32OLE (class)"><code>::WIN32OLE</code></a> object. The second argument specifies OLE event name.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ie'>ie</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span>.<span class='id identifier rubyid_new'><a href="WIN32OLE.html#new-class_method" title="WIN32OLE.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>InternetExplorer.Application</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_ev'>ev</span> <span class='op'>=</span> <span class='const'>WIN32OLE_EVENT</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_ie'>ie</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DWebBrowserEvents</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L985-L993'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='985' data-end='993'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 985</span></pre>
<pre class='code cpp'>

static VALUE
fev_initialize(int argc, VALUE *argv, VALUE self)
{
    ev_advise(argc, argv, self);
    evs_push(self);
    rb_ivar_set(self, id_events, rb_ary_new());
    fev_set_handler(self, Qnil);
    return self;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="message_loop-class_method">
  <h3 class='signature  first'>
    .<strong>message_loop</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Translates and dispatches Windows message.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1011-L1016'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1011' data-end='1016'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 1011</span></pre>
<pre class='code cpp'>

static VALUE
fev_s_msg_loop(VALUE klass)
{
    ole_msg_loop();
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="handler-instance_method">
  <h3 class='signature rw first'>
    #<strong>handler</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns handler object.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1254-L1258'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1254' data-end='1258'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 1254</span></pre>
<pre class='code cpp'>

static VALUE
fev_get_handler(VALUE self)
{
    return rb_ivar_get(self, rb_intern(&quot;handler&quot;));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="handler=-instance_method">
  <h3 class='signature rw'>
    #<strong>handler=</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets event handler object. If handler object has onXXX method according to XXX event, then onXXX method is called when XXX event occurs.</p>

<p>If handler object has method_missing and there is no method according to the event, then method_missing called and 1-st argument is event name.</p>

<p>If handler object has onXXX method and there is block defined by <a href="#on_event-instance_method" title="WIN32OLE_EVENT#on_event (method)">#on_event</a>(‘XXX’){}, then block is executed but handler object method is not called when XXX event occurs.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Handler</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_onStatusTextChange'>onStatusTextChange</span>(<span class='id identifier rubyid_text'>text</span>)
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>StatusTextChanged</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_onPropertyChange'>onPropertyChange</span>(<span class='id identifier rubyid_prop'>prop</span>)
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PropertyChanged</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_method_missing'>method_missing</span>(<span class='id identifier rubyid_ev'>ev</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_arg'>arg</span>)
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>other event </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ev'>ev</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_handler'><a href="#handler-instance_method" title="WIN32OLE_EVENT#handler (method)">handler</a></span> <span class='op'>=</span> <span class='const'>Handler</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_EVENT.new (method)">new</a></span>
<span class='id identifier rubyid_ie'>ie</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span>.<span class='id identifier rubyid_new'><a href="WIN32OLE.html#new-class_method" title="WIN32OLE.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>InternetExplorer.Application</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_ev'>ev</span> <span class='op'>=</span> <span class='const'>WIN32OLE_EVENT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_EVENT.new (method)">new</a></span>(<span class='id identifier rubyid_ie'>ie</span>)
<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event'><a href="#on_event-instance_method" title="WIN32OLE_EVENT#on_event (method)">on_event</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>StatusTextChange</span><span class='tstring_end'>&quot;</span></span>) {<span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>this block executed.</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>handler.onStatusTextChange method is not called.</span><span class='tstring_end'>&quot;</span></span>
}
<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_handler'><a href="#handler-instance_method" title="WIN32OLE_EVENT#handler (method)">handler</a></span> <span class='op'>=</span> <span class='id identifier rubyid_handler'><a href="#handler-instance_method" title="WIN32OLE_EVENT#handler (method)">handler</a></span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1241-L1245'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1241' data-end='1245'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 1241</span></pre>
<pre class='code cpp'>

static VALUE
fev_set_handler(VALUE self, VALUE val)
{
    return rb_ivar_set(self, rb_intern(&quot;handler&quot;), val);
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="off_event-instance_method">
  <h3 class='signature  first'>
    #<strong>off_event</strong>([event])    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>removes the callback of event.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ie'>ie</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span>.<span class='id identifier rubyid_new'><a href="WIN32OLE.html#new-class_method" title="WIN32OLE.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>InternetExplorer.Application</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_ev'>ev</span> <span class='op'>=</span> <span class='const'>WIN32OLE_EVENT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_EVENT.new (method)">new</a></span>(<span class='id identifier rubyid_ie'>ie</span>)
<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event'><a href="#on_event-instance_method" title="WIN32OLE_EVENT#on_event (method)">on_event</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BeforeNavigate2</span><span class='tstring_end'>&#39;</span></span>) {<span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
  <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_last'>last</span>[<span class='int'>6</span>] <span class='op'>=</span> <span class='kw'>true</span>
}
  <span class='comment'>#...
</span><span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_off_event'>off_event</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BeforeNavigate2</span><span class='tstring_end'>&#39;</span></span>)
  <span class='comment'>#...</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1123-L1144'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1123' data-end='1144'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 1123</span></pre>
<pre class='code cpp'>

static VALUE
fev_off_event(int argc, VALUE *argv, VALUE self)
{
    VALUE event = Qnil;
    VALUE events;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;event);
    if(!NIL_P(event)) {
        if(!RB_TYPE_P(event, T_STRING) &amp;&amp; !RB_TYPE_P(event, T_SYMBOL)) {
            rb_raise(rb_eTypeError, &quot;wrong argument type (expected String or Symbol)&quot;);
        }
        if (RB_TYPE_P(event, T_SYMBOL)) {
            event = rb_sym2str(event);
        }
    }
    events = rb_ivar_get(self, id_events);
    if (NIL_P(events)) {
        return Qnil;
    }
    ole_delete_event(events, event);
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_event-instance_method">
  <h3 class='signature '>
    #<strong>on_event</strong>([event])    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Defines the callback event. If argument is omitted, this method defines the callback of all events. If you want to modify reference argument in callback, return hash in callback. If you want to return value to OLE server as result of callback use ‘return’ or <code>:return</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ie'>ie</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span>.<span class='id identifier rubyid_new'><a href="WIN32OLE.html#new-class_method" title="WIN32OLE.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>InternetExplorer.Application</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_ev'>ev</span> <span class='op'>=</span> <span class='const'>WIN32OLE_EVENT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_EVENT.new (method)">new</a></span>(<span class='id identifier rubyid_ie'>ie</span>)
<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event'>on_event</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NavigateComplete</span><span class='tstring_end'>&quot;</span></span>) {<span class='op'>|</span><span class='id identifier rubyid_url'>url</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_url'>url</span>}
<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event'>on_event</span>() {<span class='op'>|</span><span class='id identifier rubyid_ev'>ev</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ev'>ev</span><span class='embexpr_end'>}</span><span class='tstring_content'> fired</span><span class='tstring_end'>&quot;</span></span>}

<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event'>on_event</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BeforeNavigate2</span><span class='tstring_end'>&quot;</span></span>) {<span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
  <span class='comment'>#...
</span>  <span class='comment'># set true to BeforeNavigate reference argument `Cancel&#39;.
</span>  <span class='comment'># Cancel is 7-th argument of BeforeNavigate,
</span>  <span class='comment'># so you can use 6 as key of hash instead of &#39;Cancel&#39;.
</span>  <span class='comment'># The argument is counted from 0.
</span>  <span class='comment'># The hash key of 0 means first argument.)
</span>  {<span class='symbeg'>:</span><span class='const'>Cancel</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>}  <span class='comment'># or {&#39;Cancel&#39; =&gt; true} or {6 =&gt; true}
</span>}

<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event'>on_event</span>(<span class='op'>...</span>) {<span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
  {<span class='symbeg'>:</span><span class='kw'>return</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_xxx'>xxx</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_yyy'>yyy</span>}
}</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1082-L1086'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1082' data-end='1086'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 1082</span></pre>
<pre class='code cpp'>

static VALUE
fev_on_event(int argc, VALUE *argv, VALUE self)
{
    return ev_on_event(argc, argv, self, Qfalse);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_event_with_outargs-instance_method">
  <h3 class='signature '>
    #<strong>on_event_with_outargs</strong>([event])    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Defines the callback of event. If you want modify argument in callback, you could use this method instead of <a href="#on_event-instance_method" title="WIN32OLE_EVENT#on_event (method)">#on_event</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ie'>ie</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span>.<span class='id identifier rubyid_new'><a href="WIN32OLE.html#new-class_method" title="WIN32OLE.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>InternetExplorer.Application</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_ev'>ev</span> <span class='op'>=</span> <span class='const'>WIN32OLE_EVENT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_EVENT.new (method)">new</a></span>(<span class='id identifier rubyid_ie'>ie</span>)
<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event_with_outargs'>on_event_with_outargs</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BeforeNavigate2</span><span class='tstring_end'>&#39;</span></span>) {<span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
  <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_last'>last</span>[<span class='int'>6</span>] <span class='op'>=</span> <span class='kw'>true</span>
}</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1102-L1106'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1102' data-end='1106'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 1102</span></pre>
<pre class='code cpp'>

static VALUE
fev_on_event_with_outargs(int argc, VALUE *argv, VALUE self)
{
    return ev_on_event(argc, argv, self, Qtrue);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unadvise-instance_method">
  <h3 class='signature '>
    #<strong>unadvise</strong>  &#x21d2; <code>nil</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>disconnects OLE server. If this method called, then the <code>WIN32OLE_EVENT</code> object does not receive the OLE server event any more. This method is trial implementation.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ie'>ie</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span>.<span class='id identifier rubyid_new'><a href="WIN32OLE.html#new-class_method" title="WIN32OLE.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>InternetExplorer.Application</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_ev'>ev</span> <span class='op'>=</span> <span class='const'>WIN32OLE_EVENT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_EVENT.new (method)">new</a></span>(<span class='id identifier rubyid_ie'>ie</span>)
<span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_on_event'><a href="#on_event-instance_method" title="WIN32OLE_EVENT#on_event (method)">on_event</a></span>() {<span class='op'>...</span>}
   <span class='comment'>#...
</span><span class='id identifier rubyid_ev'>ev</span>.<span class='id identifier rubyid_unadvise'>unadvise</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_1_5/ext/win32ole/win32ole_event.c#L1161-L1175'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1161' data-end='1175'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole_event.c', line 1161</span></pre>
<pre class='code cpp'>

static VALUE
fev_unadvise(VALUE self)
{
    struct oleeventdata *poleev;
    TypedData_Get_Struct(self, struct oleeventdata, &amp;oleevent_datatype, poleev);
    if (poleev-&gt;pConnectionPoint) {
        ole_msg_loop();
        evs_delete(poleev-&gt;event_id);
        poleev-&gt;pConnectionPoint-&gt;lpVtbl-&gt;Unadvise(poleev-&gt;pConnectionPoint, poleev-&gt;dwCookie);
        OLE_RELEASE(poleev-&gt;pConnectionPoint);
        poleev-&gt;pConnectionPoint = NULL;
    }
    OLE_FREE(poleev-&gt;pDispatch);
    return Qnil;
}
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>