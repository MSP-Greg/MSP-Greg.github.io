<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Cops Security &mdash; RuboCop master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "cops_security",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>RuboCop master</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Cops Security&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<div class="sect1">
<h2 id="securitycompoundhash">Security/CompoundHash</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.28</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.51</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for implementations of the <code>hash</code> method which combine
values using custom logic instead of delegating to <code>Array#hash</code>.</p>
</div>
<div class="paragraph">
<p>Manually combining hashes is error prone and hard to follow, especially
when there are many values. Poor implementations may also introduce
performance or security concerns if they are prone to collisions.
Delegating to <code>Array#hash</code> is clearer and safer, although it might be slower
depending on the use case.</p>
</div>
<div class="sect2">
<h3 id="safety-securitycompoundhash">Safety</h3>
<div class="paragraph">
<p>This cop may be unsafe if the application logic depends on the hash
value, however this is inadvisable anyway.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-securitycompoundhash">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_hash'>hash</span>
  <span class='ivar'>@foo</span> <span class='op'>^</span> <span class='ivar'>@bar</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_hash'>hash</span>
  [<span class='ivar'>@foo</span><span class='comma'>,</span> <span class='ivar'>@bar</span>].<span class='id identifier rubyid_hash'>hash</span>
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securityeval">Security/Eval</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of <code>Kernel#eval</code> and <code>Binding#eval</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-securityeval">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>
<span class='id identifier rubyid_eval'>eval</span>(<span class='id identifier rubyid_something'>something</span>)
<span class='id identifier rubyid_binding'>binding</span>.<span class='id identifier rubyid_eval'>eval</span>(<span class='id identifier rubyid_something'>something</span>)
<span class='const'>Kernel</span>.<span class='id identifier rubyid_eval'>eval</span>(<span class='id identifier rubyid_something'>something</span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securityiomethods">Security/IoMethods</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the first argument to <code>IO.read</code>, <code>IO.binread</code>, <code>IO.write</code>, <code>IO.binwrite</code>,
<code>IO.foreach</code>, and <code>IO.readlines</code>.</p>
</div>
<div class="paragraph">
<p>If argument starts with a pipe character (<code>'|'</code>) and the receiver is the <code>IO</code> class,
a subprocess is created in the same way as <code>Kernel#open</code>, and its output is returned.
<code>Kernel#open</code> may allow unintentional command injection, which is the reason these
<code>IO</code> methods are a security risk.
Consider to use <code>File.read</code> to disable the behavior of subprocess invocation.</p>
</div>
<div class="sect2">
<h3 id="safety-securityiomethods">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because false positive will occur if the variable passed as
the first argument is a command that is not a file path.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-securityiomethods">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>IO</span>.<span class='id identifier rubyid_read'>read</span>(<span class='id identifier rubyid_path'>path</span>)
<span class='const'>IO</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>path</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='id identifier rubyid_path'>path</span>)
<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>path</span><span class='tstring_end'>&#39;</span></span>)
<span class='const'>IO</span>.<span class='id identifier rubyid_read'>read</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>| command</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># Allow intentional command invocation.</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securityjsonload">Security/JSONLoad</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.43</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.22</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of JSON class methods which have potential
security issues.</p>
</div>
<div class="paragraph">
<p><code>JSON.load</code> and similar methods allow deserialization of arbitrary ruby objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>json/add/string</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>JSON</span>.<span class='id identifier rubyid_load'>load</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{ &quot;json_class&quot;: &quot;String&quot;, &quot;raw&quot;: [72, 101, 108, 108, 111] }</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_pp'>pp</span> <span class='id identifier rubyid_result'>result</span> <span class='comment'># =&gt; &quot;Hello&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Never use <code>JSON.load</code> for untrusted user input. Prefer <code>JSON.parse</code> unless you have
a concrete use-case for <code>JSON.load</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Starting with <code>json</code> gem version 2.8.0, triggering this behavior without explicitly
passing the <code>create_additions</code> keyword argument emits a deprecation warning, with the
goal of being secure by default in the next major version 3.0.0.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="safety-securityjsonload">Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it&#8217;s potentially dangerous.
If using a stream, like <code>JSON.load(open('file'))</code>, you will need to call
<code>#read</code> manually, like <code>JSON.parse(open('file').read)</code>.
Other similar issues may apply.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-securityjsonload">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>JSON</span>.<span class='id identifier rubyid_load'>load</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&#39;</span></span>)
<span class='const'>JSON</span>.<span class='id identifier rubyid_restore'>restore</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='const'>JSON</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&#39;</span></span>)
<span class='const'>JSON</span>.<span class='id identifier rubyid_unsafe_load'>unsafe_load</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good - explicit use of `create_additions` option
</span><span class='const'>JSON</span>.<span class='id identifier rubyid_load'>load</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>create_additions:</span> <span class='kw'>true</span>)
<span class='const'>JSON</span>.<span class='id identifier rubyid_load'>load</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>create_additions:</span> <span class='kw'>false</span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-securityjsonload">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://ruby-doc.org/stdlib-2.7.0/libdoc/json/rdoc/JSON.html#method-i-load" class="bare">https://ruby-doc.org/stdlib-2.7.0/libdoc/json/rdoc/JSON.html#method-i-load</a></p>
</li>
<li>
<p><a href="https://bugs.ruby-lang.org/issues/19528" class="bare">https://bugs.ruby-lang.org/issues/19528</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securitymarshalload">Security/MarshalLoad</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of Marshal class methods which have
potential security issues leading to remote code execution when
loading from an untrusted source.</p>
</div>
<div class="sect2">
<h3 id="examples-securitymarshalload">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>Marshal</span>.<span class='id identifier rubyid_load'>load</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&quot;</span></span>)
<span class='const'>Marshal</span>.<span class='id identifier rubyid_restore'>restore</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&quot;</span></span>)

<span class='comment'># good
</span><span class='const'>Marshal</span>.<span class='id identifier rubyid_dump'>dump</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{}</span><span class='tstring_end'>&quot;</span></span>)

<span class='comment'># okish - deep copy hack
</span><span class='const'>Marshal</span>.<span class='id identifier rubyid_load'>load</span>(<span class='const'>Marshal</span>.<span class='id identifier rubyid_dump'>dump</span>({}))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-securitymarshalload">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://ruby-doc.org/core-2.7.0/Marshal.html#module-Marshal-label-Security+considerations" class="bare">https://ruby-doc.org/core-2.7.0/Marshal.html#module-Marshal-label-Security+considerations</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securityopen">Security/Open</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of <code>Kernel#open</code> and <code>URI.open</code> with dynamic
data.</p>
</div>
<div class="paragraph">
<p><code>Kernel#open</code> and <code>URI.open</code> enable not only file access but also process
invocation by prefixing a pipe symbol (e.g., <code>open("| ls")</code>).
So, it may lead to a serious security risk by using variable input to
the argument of <code>Kernel#open</code> and <code>URI.open</code>. It would be better to use
<code>File.open</code>, <code>IO.popen</code> or <code>URI.parse#open</code> explicitly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>open</code> and <code>URI.open</code> with literal strings are not flagged by this
cop.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="safety-securityopen">Safety</h3>
<div class="paragraph">
<p>This cop could register false positives if <code>open</code> is redefined
in a class and then used without a receiver in that class.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-securityopen">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid_something'>something</span>)
<span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>| </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_something'>something</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>| foo</span><span class='tstring_end'>&quot;</span></span>)
<span class='const'>URI</span>.<span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid_something'>something</span>)

<span class='comment'># good
</span><span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid_something'>something</span>)
<span class='const'>IO</span>.<span class='id identifier rubyid_popen'>popen</span>(<span class='id identifier rubyid_something'>something</span>)
<span class='const'>URI</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='id identifier rubyid_something'>something</span>).<span class='id identifier rubyid_open'>open</span>

<span class='comment'># good (literal strings)
</span><span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo.text</span><span class='tstring_end'>&quot;</span></span>)
<span class='const'>URI</span>.<span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://example.com</span><span class='tstring_end'>&quot;</span></span>)
<span class='const'>URI</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='id identifier rubyid_url'>url</span>).<span class='id identifier rubyid_open'>open</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securityyamlload">Security/YAMLLoad</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version &#8656; 3.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of YAML class methods which have
potential security issues leading to remote code execution when
loading from an untrusted source.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ruby 3.1+ (Psych 4) uses <code>Psych.load</code> as <code>Psych.safe_load</code> by default.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="safety-securityyamlload">Safety</h3>
<div class="paragraph">
<p>The behavior of the code might change depending on what was
in the YAML payload, since <code>YAML.safe_load</code> is more restrictive.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-securityyamlload">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>YAML</span>.<span class='id identifier rubyid_load'>load</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--- !ruby/object:Foo {}</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># Psych 3 is unsafe by default
</span>
<span class='comment'># good
</span><span class='const'>YAML</span>.<span class='id identifier rubyid_safe_load'>safe_load</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--- !ruby/object:Foo {}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> [<span class='const'>Foo</span>])                    <span class='comment'># Ruby 2.5  (Psych 3)
</span><span class='const'>YAML</span>.<span class='id identifier rubyid_safe_load'>safe_load</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--- !ruby/object:Foo {}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>permitted_classes:</span> [<span class='const'>Foo</span>]) <span class='comment'># Ruby 3.0- (Psych 3)
</span><span class='const'>YAML</span>.<span class='id identifier rubyid_load'>load</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--- !ruby/object:Foo {}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>permitted_classes:</span> [<span class='const'>Foo</span>])      <span class='comment'># Ruby 3.1+ (Psych 4)
</span><span class='const'>YAML</span>.<span class='id identifier rubyid_dump'>dump</span>(<span class='id identifier rubyid_foo'>foo</span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-securityyamlload">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://ruby-doc.org/stdlib-2.7.0/libdoc/yaml/rdoc/YAML.html#module-YAML-label-Security" class="bare">https://ruby-doc.org/stdlib-2.7.0/libdoc/yaml/rdoc/YAML.html#module-YAML-label-Security</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>