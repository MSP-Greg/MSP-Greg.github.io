<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActionController::MimeResponds &mdash; Rails-5.0.0</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActionController::MimeResponds",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Rails-5.0.0</a> &raquo; 
          <a href='../_index.html'>Index (M)</a> &raquo; 
          <a href="../ActionController.html" title="ActionController (module)">ActionController</a> &raquo; 
          <span class='title'>MimeResponds</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActionController::MimeResponds</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>

  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <a href="MimeResponds/Collector.html" title="ActionController::MimeResponds::Collector (class)">Collector</a>
    </td>
  </tr>




  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
actionpack/lib/action_controller/metal/mime_responds.rb</div>  </td>
  </tr>
</table>





<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#respond_to-instance_method" title="#respond_to (instance method)">#<strong>respond_to</strong>(*mimes) {|collector| ... } </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Without web-service support, an action which collects the data for
displaying a list of people might look something like this:</p>
</div>
      </span>
    </li>
  </ul>


<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="respond_to-instance_method">
  <h3 class='signature first'>
  #<strong>respond_to</strong>(*mimes) {|collector| ... } 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Without web-service support, an action which collects the data for
displaying a list of people might look something like this:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_index'>index</span>
  <span class='ivar'>@people</span> <span class='op'>=</span> <span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
<span class='kw'>end</span>
</code></pre>

<p>That action implicitly responds to all formats, but formats can also be
whitelisted:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_index'>index</span>
  <span class='ivar'>@people</span> <span class='op'>=</span> <span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='symbol'>:html</span><span class='comma'>,</span> <span class='symbol'>:js</span>
<span class='kw'>end</span>
</code></pre>

<p>Here&#39;s the same action, with web-service support baked in:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_index'>index</span>
  <span class='ivar'>@people</span> <span class='op'>=</span> <span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>

  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_xml'>xml</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>xml:</span> <span class='ivar'>@people</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>What that says is, “if the client wants HTML or JS in response to this
action, just respond as we would have before, but if the client wants XML,
return them the list of people in XML format.” (Rails determines the
desired response format from the HTTP Accept header submitted by the
client.)</p>

<p>Supposing you have an action that adds a new person, optionally creating
their company (by name) if it does not already exist, without web-services,
it might look like this:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span>
  <span class='ivar'>@company</span> <span class='op'>=</span> <span class='const'>Company</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:company</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@person</span>  <span class='op'>=</span> <span class='ivar'>@company</span><span class='period'>.</span><span class='id identifier rubyid_people'>people</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:person</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_redirect_to'>redirect_to</span><span class='lparen'>(</span><span class='id identifier rubyid_person_list_url'>person_list_url</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</code></pre>

<p>Here&#39;s the same action, with web-service support baked in:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span>
  <span class='id identifier rubyid_company'>company</span>  <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:person</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:company</span><span class='rparen'>)</span>
  <span class='ivar'>@company</span> <span class='op'>=</span> <span class='const'>Company</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_company'>company</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@person</span>  <span class='op'>=</span> <span class='ivar'>@company</span><span class='period'>.</span><span class='id identifier rubyid_people'>people</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:person</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_redirect_to'>redirect_to</span><span class='lparen'>(</span><span class='id identifier rubyid_person_list_url'>person_list_url</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_xml'>xml</span>  <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>xml:</span> <span class='ivar'>@person</span><span class='period'>.</span><span class='id identifier rubyid_to_xml'>to_xml</span><span class='lparen'>(</span><span class='label'>include:</span> <span class='ivar'>@company</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>If the client wants HTML, we just redirect them back to the person list. If
they want JavaScript, then it is an Ajax request and we render the
JavaScript template associated with this action. Lastly, if the client
wants XML, we render the created person as XML, but with a twist: we also
include the person&#39;s company in the rendered XML, so you get something
like this:</p>

<pre class="code ruby"><code class="ruby">&lt;person&gt;
  &lt;id&gt;...&lt;/id&gt;
  #...
  &lt;company&gt;
    &lt;id&gt;...&lt;/id&gt;
    &lt;name&gt;...&lt;/name&gt;
    #...
  &lt;/company&gt;
&lt;/person&gt;</code></pre>

<p>Note, however, the extra bit at the top of that action:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_company'>company</span>  <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:person</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:company</span><span class='rparen'>)</span>
<span class='ivar'>@company</span> <span class='op'>=</span> <span class='const'>Company</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_company'>company</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>

<p>This is because the incoming XML document (if a web-service request is in
process) can only contain a single root-node. So, we have to rearrange
things so that the request looks like this (url-encoded):</p>

<pre class="code ruby"><code class="ruby">person[name]=...&amp;person[company][name]=...&amp;...</code></pre>

<p>And, like this (xml-encoded):</p>

<pre class="code ruby"><code class="ruby">&lt;person&gt;
  &lt;name&gt;...&lt;/name&gt;
  &lt;company&gt;
    &lt;name&gt;...&lt;/name&gt;
  &lt;/company&gt;
&lt;/person&gt;</code></pre>

<p>In other words, we make the request so that it operates on a single
entity&#39;s person. Then, in the action, we extract the company data from
the request, find or create the company, and then create the new person
with the remaining data.</p>

<p>Note that you can define your own XML parameter parser which would allow
you to describe multiple entities in a single request (i.e., by wrapping
them all in a single root node), but if you just go with the flow and
accept Rails&#39; defaults, life will be much easier.</p>

<p>If you need to use a MIME type which isn&#39;t supported by default, you
can register your own handlers in
<code>config/initializers/mime_types.rb</code> as follows.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Mime</span><span class='op'>::</span><span class='const'>Type</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>image/jpg</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:jpg</span>
</code></pre>

<p>Respond to also allows you to specify a common block for different formats
by using <code>any</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_index'>index</span>
  <span class='ivar'>@people</span> <span class='op'>=</span> <span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>

  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_any'>any</span><span class='lparen'>(</span><span class='symbol'>:xml</span><span class='comma'>,</span> <span class='symbol'>:json</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span> <span class='op'>=&gt;</span> <span class='ivar'>@people</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>In the example above, if the format is xml, it will render:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_render'>render</span> <span class='label'>xml:</span> <span class='ivar'>@people</span>
</code></pre>

<p>Or if the format is json:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='ivar'>@people</span>
</code></pre>

<p>Formats can have different variants.</p>

<p>The request variant is a specialization of the request format, like
<code>:tablet</code>, <code>:phone</code>, or <code>:desktop</code>.</p>

<p>We often want to render different html/json/xml templates for phones,
tablets, and desktop browsers. Variants make it easy.</p>

<p>You can set the variant in a <code>before_action</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_variant'>variant</span> <span class='op'>=</span> <span class='symbol'>:tablet</span> <span class='kw'>if</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_user_agent'>user_agent</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>iPad</span><span class='regexp_end'>/</span></span>
</code></pre>

<p>Respond to variants in the action just like you respond to formats:</p>

<pre class="code ruby"><code class="ruby">respond_to do |format|
  format.html do |variant|
    variant.tablet # renders app/views/projects/show.html+tablet.erb
    variant.phone { extra_setup; render ... }
    variant.none  { special_setup } # executed only if there is no variant set
  end
end</code></pre>

<p>Provide separate templates for each format and variant:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_app'>app</span><span class='op'>/</span><span class='id identifier rubyid_views'>views</span><span class='op'>/</span><span class='id identifier rubyid_projects'>projects</span><span class='op'>/</span><span class='id identifier rubyid_show'>show</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='period'>.</span><span class='id identifier rubyid_erb'>erb</span>
<span class='id identifier rubyid_app'>app</span><span class='op'>/</span><span class='id identifier rubyid_views'>views</span><span class='op'>/</span><span class='id identifier rubyid_projects'>projects</span><span class='op'>/</span><span class='id identifier rubyid_show'>show</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='op'>+</span><span class='id identifier rubyid_tablet'>tablet</span><span class='period'>.</span><span class='id identifier rubyid_erb'>erb</span>
<span class='id identifier rubyid_app'>app</span><span class='op'>/</span><span class='id identifier rubyid_views'>views</span><span class='op'>/</span><span class='id identifier rubyid_projects'>projects</span><span class='op'>/</span><span class='id identifier rubyid_show'>show</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='op'>+</span><span class='id identifier rubyid_phone'>phone</span><span class='period'>.</span><span class='id identifier rubyid_erb'>erb</span>
</code></pre>

<p>When you&#39;re not sharing any code within the format, you can simplify
defining variants using the inline syntax:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>         <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trash</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='period'>.</span><span class='id identifier rubyid_phone'>phone</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_progress_path'>progress_path</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='period'>.</span><span class='id identifier rubyid_none'>none</span>  <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trash</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>Variants also support common <code>any</code>/<code>all</code> block that
formats have.</p>

<p>It works for both inline:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='period'>.</span><span class='id identifier rubyid_any'>any</span>   <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>html:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>any</span><span class='tstring_end'>&quot;</span></span>   <span class='rbrace'>}</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='period'>.</span><span class='id identifier rubyid_phone'>phone</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>html:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>phone</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>and block syntax:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variant'>variant</span><span class='op'>|</span>
    <span class='id identifier rubyid_variant'>variant</span><span class='period'>.</span><span class='id identifier rubyid_any'>any</span><span class='lparen'>(</span><span class='symbol'>:tablet</span><span class='comma'>,</span> <span class='symbol'>:phablet</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>html:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>any</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_variant'>variant</span><span class='period'>.</span><span class='id identifier rubyid_phone'>phone</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='label'>html:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>phone</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>You can also set an array of variants:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_variant'>variant</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='symbol'>:tablet</span><span class='comma'>,</span> <span class='symbol'>:phone</span><span class='rbracket'>]</span>
</code></pre>

<p>which will work similarly to formats and MIME types negotiation. If there
will be no <code>:tablet</code> variant declared, <code>:phone</code>
variant will be picked:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='period'>.</span><span class='id identifier rubyid_none'>none</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span><span class='period'>.</span><span class='id identifier rubyid_phone'>phone</span> <span class='comment'># this gets rendered
</span><span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(<tt>collector</tt>)</span>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>ArgumentError</tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


191
192
193
194
195
196
197
198
199
200
201
202
203
204
205</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'actionpack/lib/action_controller/metal/mime_responds.rb', line 191</span>

<span class='kw'>def</span> <span class='id identifier rubyid_respond_to'>respond_to</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_mimes'>mimes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>respond_to takes either types or a block, never both</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_mimes'>mimes</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='id identifier rubyid_collector'>collector</span> <span class='op'>=</span> <span class='const'>Collector</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_mimes'>mimes</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_variant'>variant</span><span class='rparen'>)</span>
  <span class='kw'>yield</span> <span class='id identifier rubyid_collector'>collector</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_format'>format</span> <span class='op'>=</span> <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_negotiate_format'>negotiate_format</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__process_format'>_process_format</span><span class='lparen'>(</span><span class='id identifier rubyid_format'>format</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__set_rendered_content_type'>_set_rendered_content_type</span> <span class='id identifier rubyid_format'>format</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_response'>response</span>
    <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span> <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ActionController</span><span class='op'>::</span><span class='const'>UnknownFormat</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.0 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>