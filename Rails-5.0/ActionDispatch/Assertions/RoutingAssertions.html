<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActionDispatch::Assertions::RoutingAssertions &mdash; Rails-5.0.0</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActionDispatch::Assertions::RoutingAssertions",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Rails-5.0.0</a> &raquo; 
          <a href='../../_index.html'>Index (R)</a> &raquo; 
          <a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a> &raquo; 
          <a href="../Assertions.html" title="ActionDispatch::Assertions (module)">Assertions</a> &raquo; 
          <span class='title'>RoutingAssertions</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActionDispatch::Assertions::RoutingAssertions</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>




  <tr>
    <td class='box_1'>Included in:</td>
    <td><a href="../Assertions.html" title="ActionDispatch::Assertions (module)">ActionDispatch::Assertions</a>
    </td>
  </tr>

  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
actionpack/lib/action_dispatch/testing/assertions/routing.rb</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Suite of assertions to test routes generated by Rails and the handling of
requests made to them.</p>


  </div>
</div>
<div class="tags">
  
</div>




<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#assert_generates-instance_method" title="#assert_generates (instance method)">#<strong>assert_generates</strong>(expected_path, options, defaults = {}, extras = {}, message = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Asserts that the provided options can be used to generate the provided
path.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#assert_recognizes-instance_method" title="#assert_recognizes (instance method)">#<strong>assert_recognizes</strong>(expected_options, path, extras = {}, msg = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Asserts that the routing of the given <code>path</code> was handled
correctly and that the parsed options (given in the
<code>expected_options</code> hash) match <code>path</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#assert_routing-instance_method" title="#assert_routing (instance method)">#<strong>assert_routing</strong>(path, options, defaults = {}, extras = {}, message = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Asserts that path and options match both ways; in other words, it verifies
that <code>path</code> generates <code>options</code> and then that
<code>options</code> generates <code>path</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#method_missing-instance_method" title="#method_missing (instance method)">#<strong>method_missing</strong>(selector, *args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>ROUTES TODO: These assertions should really work in an integration context</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#with_routing-instance_method" title="#with_routing (instance method)">#<strong>with_routing</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>A helper to make it easier to test different route configurations.</p>
</div>
      </span>
    </li>
  </ul>


<h2 id='method_missing_details' class='y_details'>Dynamic Method Handling</h2>
  <p class='notice this'>
    This class handles dynamic methods through the <tt>method_missing</tt> method
  </p>
<section class='method_details first' id="method_missing-instance_method">
  <h3 class='signature first'>
  #<strong>method_missing</strong>(selector, *args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>ROUTES TODO: These assertions should really work in an integration context</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


168
169
170
171
172
173
174</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 168</span>

<span class='kw'>def</span> <span class='id identifier rubyid_method_missing'>method_missing</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@controller</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@controller</span> <span class='op'>&amp;&amp;</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@routes</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@routes</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@routes</span><span class='period'>.</span><span class='id identifier rubyid_named_routes'>named_routes</span><span class='period'>.</span><span class='id identifier rubyid_route_defined?'>route_defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span><span class='rparen'>)</span>
    <span class='ivar'>@controller</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="assert_generates-instance_method">
  <h3 class='signature first'>
  #<strong>assert_generates</strong>(expected_path, options, defaults = {}, extras = {}, message = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Asserts that the provided options can be used to generate the provided
path. This is the inverse of <code>assert_recognizes</code>. The
<code>extras</code> parameter is used to tell the request the names and
values of additional request parameters that would be in a query string.
The <code>message</code> parameter allows you to specify a custom error
message for assertion failures.</p>

<p>The <code>defaults</code> parameter is unused.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts that the default action is generated for a route with no action
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>index</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># Tests that the list action is properly routed
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/items/list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>list</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># Tests the generation of a route with a parameter
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/items/list/1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>

<span class='comment'># Asserts that the generated route gives us our custom route
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>changesets/12</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>scm</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>show_diff</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>revision:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>12</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 78</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_generates'>assert_generates</span><span class='lparen'>(</span><span class='id identifier rubyid_expected_path'>expected_path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_expected_path'>expected_path</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>://</span><span class='regexp_end'>}</span></span>
    <span class='id identifier rubyid_fail_on'>fail_on</span><span class='lparen'>(</span><span class='const'>URI</span><span class='op'>::</span><span class='const'>InvalidURIError</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_expected_path'>expected_path</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_expected_path'>expected_path</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_expected_path'>expected_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_expected_path'>expected_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_expected_path'>expected_path</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='comment'># Load routes.rb if it hasn&#39;t been loaded.
</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_clone'>clone</span>
  <span class='id identifier rubyid_generated_path'>generated_path</span><span class='comma'>,</span> <span class='id identifier rubyid_query_string_keys'>query_string_keys</span> <span class='op'>=</span> <span class='ivar'>@routes</span><span class='period'>.</span><span class='id identifier rubyid_generate_extras'>generate_extras</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_found_extras'>found_extras</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='op'>!</span> <span class='id identifier rubyid_query_string_keys'>query_string_keys</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>||</span> <span class='id identifier rubyid_sprintf'>sprintf</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>found extras &lt;%s&gt;, not &lt;%s&gt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_found_extras'>found_extras</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_found_extras'>found_extras</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>||</span> <span class='id identifier rubyid_sprintf'>sprintf</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The generated path &lt;%s&gt; did not match &lt;%s&gt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_generated_path'>generated_path</span><span class='comma'>,</span>
      <span class='id identifier rubyid_expected_path'>expected_path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='id identifier rubyid_expected_path'>expected_path</span><span class='comma'>,</span> <span class='id identifier rubyid_generated_path'>generated_path</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="assert_recognizes-instance_method">
  <h3 class='signature'>
  #<strong>assert_recognizes</strong>(expected_options, path, extras = {}, msg = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Asserts that the routing of the given <code>path</code> was handled
correctly and that the parsed options (given in the
<code>expected_options</code> hash) match <code>path</code>. Basically, it
asserts that Rails recognizes the route given by
<code>expected_options</code>.</p>

<p>Pass a hash in the second argument (<code>path</code>) to specify the
request method. This is useful for routes requiring a specific HTTP method.
The hash should contain a :path with the incoming request path and a
:method containing the required HTTP verb.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts that POSTing to /items will call the create action on ItemsController
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>create</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='label'>path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>method:</span> <span class='symbol'>:post</span><span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>

<p>You can also pass in <code>extras</code> with a hash containing URL
parameters that would normally be in the query string. This can be used to
assert that values in the query string will end up in the params hash
correctly. To test query strings you must use the extras argument,
appending the query string on the path directly will not work. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts that a path of &#39;/items/list/1?view=print&#39; returns the correct options
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>list</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>view:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>print</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items/list/1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>view:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>print</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>

<p>The <code>message</code> parameter allows you to pass in an error message
that is displayed upon failure.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Check the default route (i.e., the index action)
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Test a specific action
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>list</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items/list</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Test an action with a parameter
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>destroy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items/destroy/1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Test a custom route
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>show</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view/item1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 40</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='id identifier rubyid_expected_options'>expected_options</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span><span class='lbracket'>[</span><span class='symbol'>:method</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>all</span><span class='tstring_end'>&quot;</span></span>
    <span class='lbracket'>[</span><span class='symbol'>:get</span><span class='comma'>,</span> <span class='symbol'>:post</span><span class='comma'>,</span> <span class='symbol'>:put</span><span class='comma'>,</span> <span class='symbol'>:delete</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_method'>method</span><span class='op'>|</span>
      <span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='id identifier rubyid_expected_options'>expected_options</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>method:</span> <span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='id identifier rubyid_recognized_request_for'>recognized_request_for</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_expected_options'>expected_options</span> <span class='op'>=</span> <span class='id identifier rubyid_expected_options'>expected_options</span><span class='period'>.</span><span class='id identifier rubyid_clone'>clone</span>

    <span class='id identifier rubyid_expected_options'>expected_options</span><span class='period'>.</span><span class='id identifier rubyid_stringify_keys!'>stringify_keys!</span>

    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_sprintf'>sprintf</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The recognized options &lt;%s&gt; did not match &lt;%s&gt;, difference:</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
              <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_path_parameters'>path_parameters</span><span class='comma'>,</span> <span class='id identifier rubyid_expected_options'>expected_options</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='id identifier rubyid_expected_options'>expected_options</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_path_parameters'>path_parameters</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="assert_routing-instance_method">
  <h3 class='signature'>
  #<strong>assert_routing</strong>(path, options, defaults = {}, extras = {}, message = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Asserts that path and options match both ways; in other words, it verifies
that <code>path</code> generates <code>options</code> and then that
<code>options</code> generates <code>path</code>. This essentially combines
<code>assert_recognizes</code> and <code>assert_generates</code> into one
step.</p>

<p>The <code>extras</code> hash allows you to specify options that would
normally be provided as a query string to the action. The
<code>message</code> parameter allows you to specify a custom error message
to display upon failure.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts a basic route: a controller with the default action (index)
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>home</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Test a route generated with a specific controller, action, and parameter (id)
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/entries/show/23</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>entries</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>show</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='int'>23</span>

<span class='comment'># Asserts a basic route (controller + default action), with an error message if it fails
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/store</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>store</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Route for store index not generated properly</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Tests a route, providing a defaults hash
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>controller/action/9</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>9</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>item:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>square</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>controller</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>action</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='label'>item:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>square</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>

<span class='comment'># Tests a route with an HTTP method
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>method:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>put</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/product/321</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>product</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>update</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>321</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


122
123
124
125
126
127
128
129
130
131
132</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 122</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_routing'>assert_routing</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_controller'>controller</span><span class='comma'>,</span> <span class='id identifier rubyid_default_controller'>default_controller</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:controller</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span><span class='lbracket'>[</span><span class='symbol'>:controller</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_controller'>controller</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_controller'>controller</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='CHAR'>?/</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_default_controller'>default_controller</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_default_controller'>default_controller</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='CHAR'>?/</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:controller</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_controller'>controller</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_generate_options'>generate_options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='id identifier rubyid_defaults'>defaults</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_assert_generates'>assert_generates</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_path'>path</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_generate_options'>generate_options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="with_routing-instance_method">
  <h3 class='signature'>
  #<strong>with_routing</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>A helper to make it easier to test different route configurations. This
method temporarily replaces @routes with a new RouteSet instance.</p>

<p>The new instance is yielded to the passed block. Typically the block will
create some routes using <code>set.draw { match ... }</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_with_routing'>with_routing</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_set'>set</span><span class='op'>|</span>
  <span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:users</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/users</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_users_path'>users_path</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 148</span>

<span class='kw'>def</span> <span class='id identifier rubyid_with_routing'>with_routing</span>
  <span class='id identifier rubyid_old_routes'>old_routes</span><span class='comma'>,</span> <span class='ivar'>@routes</span> <span class='op'>=</span> <span class='ivar'>@routes</span><span class='comma'>,</span> <span class='const'>ActionDispatch</span><span class='op'>::</span><span class='const'>Routing</span><span class='op'>::</span><span class='const'>RouteSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@controller</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@controller</span>
    <span class='id identifier rubyid_old_controller'>old_controller</span><span class='comma'>,</span> <span class='ivar'>@controller</span> <span class='op'>=</span> <span class='ivar'>@controller</span><span class='comma'>,</span> <span class='ivar'>@controller</span><span class='period'>.</span><span class='id identifier rubyid_clone'>clone</span>
    <span class='id identifier rubyid__routes'>_routes</span> <span class='op'>=</span> <span class='ivar'>@routes</span>

    <span class='ivar'>@controller</span><span class='period'>.</span><span class='id identifier rubyid_singleton_class'>singleton_class</span><span class='period'>.</span><span class='id identifier rubyid_include'>include</span><span class='lparen'>(</span><span class='id identifier rubyid__routes'>_routes</span><span class='period'>.</span><span class='id identifier rubyid_url_helpers'>url_helpers</span><span class='rparen'>)</span>
    <span class='ivar'>@controller</span><span class='period'>.</span><span class='id identifier rubyid_view_context_class'>view_context_class</span> <span class='op'>=</span> <span class='const'>Class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='ivar'>@controller</span><span class='period'>.</span><span class='id identifier rubyid_view_context_class'>view_context_class</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid__routes'>_routes</span><span class='period'>.</span><span class='id identifier rubyid_url_helpers'>url_helpers</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>yield</span> <span class='ivar'>@routes</span>
<span class='kw'>ensure</span>
  <span class='ivar'>@routes</span> <span class='op'>=</span> <span class='id identifier rubyid_old_routes'>old_routes</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@controller</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@controller</span>
    <span class='ivar'>@controller</span> <span class='op'>=</span> <span class='id identifier rubyid_old_controller'>old_controller</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.0 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>