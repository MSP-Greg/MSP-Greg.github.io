<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActionDispatch::Session::CookieStore &mdash; Rails-5.0.0</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActionDispatch::Session::CookieStore",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Rails-5.0.0</a> &raquo; 
          <a href='../../_index.html'>Index (C)</a> &raquo; 
        #  <a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a> &raquo; 
        #  <a href="../Session.html" title="ActionDispatch::Session (module)">Session</a> &raquo; 
          <span class='title'>CookieStore</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: ActionDispatch::Session::CookieStore</h1>

<div class="box_info">
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class='inheritName'><a href="AbstractStore.html" title="ActionDispatch::Session::AbstractStore (class)">AbstractStore</a></span>
        <ul class='fullTree'>
          <li><a href="../../Object.html" title="Object (class)">Object</a></li>
            <li class='next'>Rack::Session::Abstract::Persisted</li>
            <li class='next'><a href="AbstractStore.html" title="ActionDispatch::Session::AbstractStore (class)">AbstractStore</a></li>
            <li class='next'>ActionDispatch::Session::CookieStore</li>
        </ul>
        <a href='#' class='inheritanceTree'>show all</a>
    </dd>
  </dl>



  <dl>
    <dt>Defined in:</dt>
    <dd>actionpack/lib/action_dispatch/middleware/session/cookie_store.rb</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This cookie-based session store is the Rails default. It is dramatically
faster than the alternatives.</p>

<p>Sessions typically contain at most a user_id and flash message; both fit
within the 4K cookie size limit. A CookieOverflow exception is raised if
you attempt to store more than 4K of data.</p>

<p>The cookie jar used for storage is automatically configured to be the best
possible option given your application&#39;s configuration.</p>

<p>If you only have secret_token set, your cookies will be signed, but not
encrypted. This means a user cannot alter their <code>user_id</code>
without knowing your app&#39;s secret key, but can easily read their
<code>user_id</code>. This was the default for Rails 3 apps.</p>

<p>If you have secret_key_base set, your cookies will be encrypted. This goes
a step further than signed cookies in that encrypted cookies cannot be
altered or read by users. This is the default starting in Rails 4.</p>

<p>If you have both secret_token and secret_key_base set, your cookies will be
encrypted, and signed cookies generated by Rails 3 will be transparently
read and encrypted to provide a smooth upgrade path.</p>

<p>Configure your session store in config/initializers/session_store.rb:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_session_store'>session_store</span> <span class='symbol'>:cookie_store</span><span class='comma'>,</span> <span class='label'>key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_your_app_session</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>Configure your secret key in config/secrets.yml:</p>

<pre class="code ruby"><code class="ruby">development:
  secret_key_base: &#39;secret key&#39;</code></pre>

<p>To generate a secret key for an existing application, run `rails secret`.</p>

<p>If you are upgrading an existing Rails 3 app, you should leave your
existing secret_token in place and simply add the new secret_key_base. Note
that you should wait to set secret_key_base until you have 100% of your
userbase on Rails 4 and are reasonably sure you will not need to rollback
to Rails 3. This is because cookies signed based on the new secret_key_base
in Rails 4 are not backwards compatible with Rails 3. You are free to leave
your existing secret_token in place, not set the new secret_key_base, and
ignore the deprecation warnings until you are reasonably sure that your
upgrade is otherwise complete. Additionally, you should take care to make
sure you are not relying on the ability to decode signed cookies generated
by your app in external applications or JavaScript before upgrading.</p>

<p>Note that changing the secret key will invalidate all existing sessions!</p>

<p>Because CookieStore extends <code>Rack::Session::Abstract::Persisted</code>, many of
the options described there can be used to customize the session cookie
that is generated. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_session_store'>session_store</span> <span class='symbol'>:cookie_store</span><span class='comma'>,</span> <span class='label'>expire_after:</span> <span class='int'>14</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span>
</code></pre>

<p>would set the session cookie to expire automatically 14 days after
creation. Other useful options include <code>:key</code>,
<code>:secure</code> and <code>:httponly</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>




<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(app, options = {})  &#x21d2; CookieStore </a>
      </span>
      <span class='note title constructor'>constructor</span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>A new instance of CookieStore</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#delete_session-instance_method" title="#delete_session (instance method)">#<strong>delete_session</strong>(req, session_id, options)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#load_session-instance_method" title="#load_session (instance method)">#<strong>load_session</strong>(req)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
  </ul>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="SessionObject.html" title="ActionDispatch::Session::SessionObject (module)">SessionObject</a></h3>
  <p class="inherited"><a href="SessionObject.html#loaded_session%3F-instance_method" title="ActionDispatch::Session::SessionObject#loaded_session? (method)">#loaded_session?</a>, <a href="SessionObject.html#prepare_session-instance_method" title="ActionDispatch::Session::SessionObject#prepare_session (method)">#prepare_session</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="StaleSessionCheck.html" title="ActionDispatch::Session::StaleSessionCheck (module)">StaleSessionCheck</a></h3>
  <p class="inherited"><a href="StaleSessionCheck.html#stale_session_check%21-instance_method" title="ActionDispatch::Session::StaleSessionCheck#stale_session_check! (method)">#stale_session_check!</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Compatibility.html" title="ActionDispatch::Session::Compatibility (module)">Compatibility</a></h3>
  <p class="inherited"><a href="Compatibility.html#generate_sid-instance_method" title="ActionDispatch::Session::Compatibility#generate_sid (method)">#generate_sid</a>, <a href="Compatibility.html#initialize-instance_method" title="ActionDispatch::Session::Compatibility#initialize (method)">#initialize</a></p>

  <h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(app, options = {})  &#x21d2; <tt><a href="" title="ActionDispatch::Session::CookieStore (class)">CookieStore</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


66
67
68</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionpack/lib/action_dispatch/middleware/session/cookie_store.rb', line 66</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='symbol'>:cookie_only</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section><h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="delete_session-instance_method">
  <h3 class='signature first'>
  #<strong>delete_session</strong>(req, session_id, options)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


70
71
72
73
74
75</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionpack/lib/action_dispatch/middleware/session/cookie_store.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_session'>delete_session</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_session_id'>session_id</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new_sid'>new_sid</span> <span class='op'>=</span> <span class='id identifier rubyid_generate_sid'>generate_sid</span> <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:drop</span><span class='rbracket'>]</span>
  <span class='comment'># Reset hash and Assign the new session id
</span>  <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_set_header'>set_header</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>action_dispatch.request.unsigned_session_cookie</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_new_sid'>new_sid</span> <span class='op'>?</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>session_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_new_sid'>new_sid</span> <span class='rbrace'>}</span> <span class='op'>:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new_sid'>new_sid</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="load_session-instance_method">
  <h3 class='signature'>
  #<strong>load_session</strong>(req)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


77
78
79
80
81
82
83</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'actionpack/lib/action_dispatch/middleware/session/cookie_store.rb', line 77</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_session'>load_session</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_stale_session_check!'>stale_session_check!</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_unpacked_cookie_data'>unpacked_cookie_data</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_persistent_session_id!'>persistent_session_id!</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>session_id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>
<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.8.7.6 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>