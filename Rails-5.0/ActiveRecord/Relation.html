<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActiveRecord::Relation &mdash; Rails-5.0.0</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::Relation",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Rails-5.0.0</a> &raquo; 
          <a href='../_index.html'>Index (R)</a> &raquo; 
          <a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <span class='title'>Relation</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: ActiveRecord::Relation</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'><a href="../Object.html" title="Object (class)">Object</a></span>
      <ul class='fullTree'>
        <li><a href="../Object.html" title="Object (class)">Object</a></li>
        <li class='next'>ActiveRecord::Relation</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Child Modules:</td>
    <td>
      <a href="Relation/RecordFetchWarning.html" title="ActiveRecord::Relation::RecordFetchWarning (module)">RecordFetchWarning</a>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <a href="Relation/FromClause.html" title="ActiveRecord::Relation::FromClause (class)">FromClause</a>,
    <a href="Relation/HashMerger.html" title="ActiveRecord::Relation::HashMerger (class)">HashMerger</a>,
    <a href="Relation/Merger.html" title="ActiveRecord::Relation::Merger (class)">Merger</a>,
    <a href="Relation/QueryAttribute.html" title="ActiveRecord::Relation::QueryAttribute (class)">QueryAttribute</a>,
    <a href="Relation/WhereClause.html" title="ActiveRecord::Relation::WhereClause (class)">WhereClause</a>,
    <a href="Relation/WhereClauseFactory.html" title="ActiveRecord::Relation::WhereClauseFactory (class)">WhereClauseFactory</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Includes:</td>
    <td><a href="Batches.html" title="ActiveRecord::Batches (module)">Batches</a>, <a href="Calculations.html" title="ActiveRecord::Calculations (module)">Calculations</a>, <a href="Delegation.html" title="ActiveRecord::Delegation (module)">Delegation</a>, <a href="Explain.html" title="ActiveRecord::Explain (module)">Explain</a>, <a href="FinderMethods.html" title="ActiveRecord::FinderMethods (module)">FinderMethods</a>, <a href="QueryMethods.html" title="ActiveRecord::QueryMethods (module)">QueryMethods</a>, <a href="SpawnMethods.html" title="ActiveRecord::SpawnMethods (module)">SpawnMethods</a>, <a href="../Enumerable.html" title="Enumerable (module)">Enumerable</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Direct Subclasses:</td>
    <td>
      <a href="AssociationRelation.html" title="ActiveRecord::AssociationRelation (class)">AssociationRelation</a>, <a href="Associations/CollectionProxy.html" title="ActiveRecord::Associations::CollectionProxy (class)">Associations::CollectionProxy</a>
    </td>
  </tr>


  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
<a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L3'>activerecord/lib/active_record/relation.rb</a><span class='defines'>,<br /><a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/from_clause.rb#L2'>activerecord/lib/active_record/relation/from_clause.rb</a>,<br/> <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/merger.rb#L4'>activerecord/lib/active_record/relation/merger.rb</a>,<br/> <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_attribute.rb#L4'>activerecord/lib/active_record/relation/query_attribute.rb</a>,<br/> <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/record_fetch_warning.rb#L2'>activerecord/lib/active_record/relation/record_fetch_warning.rb</a>,<br/> <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/where_clause.rb#L2'>activerecord/lib/active_record/relation/where_clause.rb</a>,<br/> <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/where_clause_factory.rb#L2'>activerecord/lib/active_record/relation/where_clause_factory.rb</a></span>
</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<h2 id="label-Active+Record+Relation">Active Record Relation</h2>


  </div>
</div>
<div class="tags">
  
</div>
<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='CLAUSE_METHODS-constant'>
      CLAUSE_METHODS =
    </dt>
    <dd>
            <pre class='code'><span class='lbracket'>[</span><span class='symbol'>:where</span><span class='comma'>,</span> <span class='symbol'>:having</span><span class='comma'>,</span> <span class='symbol'>:from</span><span class='rbracket'>]</span></pre>
    </dd>
    <dt id='INVALID_METHODS_FOR_DELETE_ALL-constant'>
      INVALID_METHODS_FOR_DELETE_ALL =
    </dt>
    <dd>
            <pre class='code'><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='comma'>,</span> <span class='symbol'>:distinct</span><span class='comma'>,</span> <span class='symbol'>:offset</span><span class='comma'>,</span> <span class='symbol'>:group</span><span class='comma'>,</span> <span class='symbol'>:having</span><span class='rbracket'>]</span></pre>
    </dd>
    <dt id='MULTI_VALUE_METHODS-constant'>
      MULTI_VALUE_METHODS =
    </dt>
    <dd>
            <pre class='code'><span class='lbracket'>[</span><span class='symbol'>:includes</span><span class='comma'>,</span> <span class='symbol'>:eager_load</span><span class='comma'>,</span> <span class='symbol'>:preload</span><span class='comma'>,</span> <span class='symbol'>:select</span><span class='comma'>,</span> <span class='symbol'>:group</span><span class='comma'>,</span>
<span class='symbol'>:order</span><span class='comma'>,</span> <span class='symbol'>:joins</span><span class='comma'>,</span> <span class='symbol'>:left_joins</span><span class='comma'>,</span> <span class='symbol'>:left_outer_joins</span><span class='comma'>,</span> <span class='symbol'>:references</span><span class='comma'>,</span>
<span class='symbol'>:extending</span><span class='comma'>,</span> <span class='symbol'>:unscope</span><span class='rbracket'>]</span></pre>
    </dd>
    <dt id='SINGLE_VALUE_METHODS-constant'>
      SINGLE_VALUE_METHODS =
    </dt>
    <dd>
            <pre class='code'><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='comma'>,</span> <span class='symbol'>:offset</span><span class='comma'>,</span> <span class='symbol'>:lock</span><span class='comma'>,</span> <span class='symbol'>:readonly</span><span class='comma'>,</span> <span class='symbol'>:reordering</span><span class='comma'>,</span>
<span class='symbol'>:reverse_order</span><span class='comma'>,</span> <span class='symbol'>:distinct</span><span class='comma'>,</span> <span class='symbol'>:create_with</span><span class='rbracket'>]</span></pre>
    </dd>
    <dt id='VALUE_METHODS-constant'>
      VALUE_METHODS =
    </dt>
    <dd>
            <pre class='code'><span class='const'><a href="#MULTI_VALUE_METHODS-constant" title="ActiveRecord::Relation::MULTI_VALUE_METHODS (constant)">MULTI_VALUE_METHODS</a></span> <span class='op'>+</span> <span class='const'><a href="#SINGLE_VALUE_METHODS-constant" title="ActiveRecord::Relation::SINGLE_VALUE_METHODS (constant)">SINGLE_VALUE_METHODS</a></span> <span class='op'>+</span> <span class='const'><a href="#CLAUSE_METHODS-constant" title="ActiveRecord::Relation::CLAUSE_METHODS (constant)">CLAUSE_METHODS</a></span></pre>
    </dd>
  </dl>



  
  
  <h3 class="inherited">Constants included
     from <a href="FinderMethods.html" title="ActiveRecord::FinderMethods (module)">FinderMethods</a></h3>
  <p class="inherited"><a href="FinderMethods.html#ONE_AS_ONE-constant" title="ActiveRecord::FinderMethods::ONE_AS_ONE (constant)">FinderMethods::ONE_AS_ONE</a></p>

  
  
  <h3 class="inherited">Constants included
     from <a href="QueryMethods.html" title="ActiveRecord::QueryMethods (module)">QueryMethods</a></h3>
  <p class="inherited"><a href="QueryMethods.html#FROZEN_EMPTY_ARRAY-constant" title="ActiveRecord::QueryMethods::FROZEN_EMPTY_ARRAY (constant)">QueryMethods::FROZEN_EMPTY_ARRAY</a>, <a href="QueryMethods.html#FROZEN_EMPTY_HASH-constant" title="ActiveRecord::QueryMethods::FROZEN_EMPTY_HASH (constant)">QueryMethods::FROZEN_EMPTY_HASH</a>, <a href="QueryMethods.html#VALID_UNSCOPING_VALUES-constant" title="ActiveRecord::QueryMethods::VALID_UNSCOPING_VALUES (constant)">QueryMethods::VALID_UNSCOPING_VALUES</a></p>

  
  
  <h3 class="inherited">Constants included
     from <a href="Batches.html" title="ActiveRecord::Batches (module)">Batches</a></h3>
  <p class="inherited"><a href="Batches.html#ORDER_IGNORE_MESSAGE-constant" title="ActiveRecord::Batches::ORDER_IGNORE_MESSAGE (constant)">Batches::ORDER_IGNORE_MESSAGE</a></p>

<h2>Instance Attribute Summary <small><a href='#' class='summary_toggle'>collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#klass-instance_method" title="#klass (instance method)">#<strong>klass</strong>  </a>
        (also: #model)
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#loaded-instance_method" title="#loaded (instance method)">#<strong>loaded</strong>  </a>
        (also: #loaded?)
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#loaded%3F-instance_method" title="#loaded? (instance method)">#<strong>loaded?</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#loaded-instance_method" title="ActiveRecord::Relation#loaded (method)">#loaded</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#model-instance_method" title="#model (instance method)">#<strong>model</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#klass-instance_method" title="ActiveRecord::Relation#klass (method)">#klass</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#predicate_builder-instance_method" title="#predicate_builder (instance method)">#<strong>predicate_builder</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#table-instance_method" title="#table (instance method)">#<strong>table</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
  </ul>


<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(klass, table, predicate_builder, values = {})  &#x21d2; Relation </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>a new instance of Relation</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#%3D%3D-instance_method" title="#== (instance method)">#<strong>==</strong>(other)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Compares two relations for equality.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#any%3F-instance_method" title="#any? (instance method)">#<strong>any?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if there are any records.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#blank%3F-instance_method" title="#blank? (instance method)">#<strong>blank?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if relation is blank.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#build-instance_method" title="#build (instance method)">#<strong>build</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#new-instance_method" title="ActiveRecord::Relation#new (method)">#new</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#cache_key-instance_method" title="#cache_key (instance method)">#<strong>cache_key</strong>(timestamp_column = :updated_at)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a cache key that can be used to identify the records fetched by
this query.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create-instance_method" title="#create (instance method)">#<strong>create</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Tries to create a new record with the same scoped attributes defined in the
relation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create%21-instance_method" title="#create! (instance method)">#<strong>create!</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Similar to <a href="#create-instance_method" title="ActiveRecord::Relation#create (method)">#create</a>, but calls
<a href="#create%21-instance_method" title="ActiveRecord::Relation#create! (method)">#create!</a>[Persistence::ClassMethods#create!] on the base class.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>(id_or_array)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Deletes the row with a primary key matching the <code>id</code> argument,
using a SQL <code>DELETE</code> statement, and returns the number of rows
deleted.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#delete_all-instance_method" title="#delete_all (instance method)">#<strong>delete_all</strong>(conditions = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Deletes the records without instantiating the records first, and hence not
calling the <a href="#destroy-instance_method" title="ActiveRecord::Relation#destroy (method)">#destroy</a>[Persistence#destroy] method nor invoking callbacks.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#destroy-instance_method" title="#destroy (instance method)">#<strong>destroy</strong>(id)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Destroy an object (or multiple objects) that has the given id.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#destroy_all-instance_method" title="#destroy_all (instance method)">#<strong>destroy_all</strong>(conditions = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Destroys the records by instantiating each record and calling its
<a href="#destroy-instance_method" title="ActiveRecord::Relation#destroy (method)">#destroy</a>[Persistence#destroy] method.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#eager_loading%3F-instance_method" title="#eager_loading? (instance method)">#<strong>eager_loading?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if relation needs eager loading.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#empty%3F-instance_method" title="#empty? (instance method)">#<strong>empty?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if there are no records.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#encode_with-instance_method" title="#encode_with (instance method)">#<strong>encode_with</strong>(coder)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Serializes the relation objects Array.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#explain-instance_method" title="#explain (instance method)">#<strong>explain</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Runs EXPLAIN on the query or queries triggered by this relation and returns
the result as a string.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#find_or_create_by-instance_method" title="#find_or_create_by (instance method)">#<strong>find_or_create_by</strong>(attributes, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Finds the first record with the given attributes, or creates a record with
the attributes if one is not found:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#find_or_create_by%21-instance_method" title="#find_or_create_by! (instance method)">#<strong>find_or_create_by!</strong>(attributes, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Like <a href="#find_or_create_by-instance_method" title="ActiveRecord::Relation#find_or_create_by (method)">#find_or_create_by</a>, but calls
<a href="#create%21-instance_method" title="ActiveRecord::Relation#create! (method)">#create!</a>[Persistence::ClassMethods#create!] so an exception is raised if
the created record is invalid.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#find_or_initialize_by-instance_method" title="#find_or_initialize_by (instance method)">#<strong>find_or_initialize_by</strong>(attributes, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Like <a href="#find_or_create_by-instance_method" title="ActiveRecord::Relation#find_or_create_by (method)">#find_or_create_by</a>, but calls <a href="#new-class_method" title="ActiveRecord::Relation.new (method)">Relation.new</a>[Core#new] instead of
<a href="#create-instance_method" title="ActiveRecord::Relation#create (method)">#create</a>[Persistence::ClassMethods#create].</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#initialize_copy-instance_method" title="#initialize_copy (instance method)">#<strong>initialize_copy</strong>(other)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#joined_includes_values-instance_method" title="#joined_includes_values (instance method)">#<strong>joined_includes_values</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Joins that are also marked for preloading.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#load-instance_method" title="#load (instance method)">#<strong>load</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Causes the records to be loaded from the database if they have not been
loaded already.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#many%3F-instance_method" title="#many? (instance method)">#<strong>many?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if there is more than one record.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-instance_method" title="#new (instance method)">#<strong>new</strong>(*args, &amp;block)  </a>
        (also: #build)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Initializes new record from relation while maintaining the current scope.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#none%3F-instance_method" title="#none? (instance method)">#<strong>none?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if there are no records.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#one%3F-instance_method" title="#one? (instance method)">#<strong>one?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if there is exactly one record.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#pretty_print-instance_method" title="#pretty_print (instance method)">#<strong>pretty_print</strong>(q)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#reload-instance_method" title="#reload (instance method)">#<strong>reload</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Forces reloading of relation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#reset-instance_method" title="#reset (instance method)">#<strong>reset</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#scope_for_create-instance_method" title="#scope_for_create (instance method)">#<strong>scope_for_create</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#scoping-instance_method" title="#scoping (instance method)">#<strong>scoping</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Scope all queries to the current scope.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#size-instance_method" title="#size (instance method)">#<strong>size</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns size of the records.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_a-instance_method" title="#to_a (instance method)">#<strong>to_a</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Converts relation objects to Array.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_sql-instance_method" title="#to_sql (instance method)">#<strong>to_sql</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns sql statement for the relation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#uniq_value-instance_method" title="#uniq_value (instance method)">#<strong>uniq_value</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p><a href="QueryMethods.html#uniq-instance_method" title="ActiveRecord::QueryMethods#uniq (method)">QueryMethods#uniq</a>[QueryMethods#uniq] and <a href="QueryMethods.html#uniq%21-instance_method" title="ActiveRecord::QueryMethods#uniq! (method)">QueryMethods#uniq!</a>[QueryMethods#uniq!] are silently
deprecated.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update-instance_method" title="#update (instance method)">#<strong>update</strong>(id = :all, attributes)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Updates an object (or multiple objects) and saves it to the database, if
validations pass.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update_all-instance_method" title="#update_all (instance method)">#<strong>update_all</strong>(updates)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Updates all records in the current relation with details given.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#values-instance_method" title="#values (instance method)">#<strong>values</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#where_values_hash-instance_method" title="#where_values_hash (instance method)">#<strong>where_values_hash</strong>(relation_table_name = table_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a hash of where conditions.</p>
</div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="FinderMethods.html" title="ActiveRecord::FinderMethods (module)">FinderMethods</a></h3>
  <p class="inherited"><a href="FinderMethods.html#exists%3F-instance_method" title="ActiveRecord::FinderMethods#exists? (method)">#exists?</a>, <a href="FinderMethods.html#fifth-instance_method" title="ActiveRecord::FinderMethods#fifth (method)">#fifth</a>, <a href="FinderMethods.html#fifth%21-instance_method" title="ActiveRecord::FinderMethods#fifth! (method)">#fifth!</a>, <a href="FinderMethods.html#find-instance_method" title="ActiveRecord::FinderMethods#find (method)">#find</a>, <a href="FinderMethods.html#find_by-instance_method" title="ActiveRecord::FinderMethods#find_by (method)">#find_by</a>, <a href="FinderMethods.html#find_by%21-instance_method" title="ActiveRecord::FinderMethods#find_by! (method)">#find_by!</a>, <a href="FinderMethods.html#first-instance_method" title="ActiveRecord::FinderMethods#first (method)">#first</a>, <a href="FinderMethods.html#first%21-instance_method" title="ActiveRecord::FinderMethods#first! (method)">#first!</a>, <a href="FinderMethods.html#forty_two-instance_method" title="ActiveRecord::FinderMethods#forty_two (method)">#forty_two</a>, <a href="FinderMethods.html#forty_two%21-instance_method" title="ActiveRecord::FinderMethods#forty_two! (method)">#forty_two!</a>, <a href="FinderMethods.html#fourth-instance_method" title="ActiveRecord::FinderMethods#fourth (method)">#fourth</a>, <a href="FinderMethods.html#fourth%21-instance_method" title="ActiveRecord::FinderMethods#fourth! (method)">#fourth!</a>, <a href="FinderMethods.html#last-instance_method" title="ActiveRecord::FinderMethods#last (method)">#last</a>, <a href="FinderMethods.html#last%21-instance_method" title="ActiveRecord::FinderMethods#last! (method)">#last!</a>, <a href="FinderMethods.html#raise_record_not_found_exception%21-instance_method" title="ActiveRecord::FinderMethods#raise_record_not_found_exception! (method)">#raise_record_not_found_exception!</a>, <a href="FinderMethods.html#second-instance_method" title="ActiveRecord::FinderMethods#second (method)">#second</a>, <a href="FinderMethods.html#second%21-instance_method" title="ActiveRecord::FinderMethods#second! (method)">#second!</a>, <a href="FinderMethods.html#second_to_last-instance_method" title="ActiveRecord::FinderMethods#second_to_last (method)">#second_to_last</a>, <a href="FinderMethods.html#second_to_last%21-instance_method" title="ActiveRecord::FinderMethods#second_to_last! (method)">#second_to_last!</a>, <a href="FinderMethods.html#take-instance_method" title="ActiveRecord::FinderMethods#take (method)">#take</a>, <a href="FinderMethods.html#take%21-instance_method" title="ActiveRecord::FinderMethods#take! (method)">#take!</a>, <a href="FinderMethods.html#third-instance_method" title="ActiveRecord::FinderMethods#third (method)">#third</a>, <a href="FinderMethods.html#third%21-instance_method" title="ActiveRecord::FinderMethods#third! (method)">#third!</a>, <a href="FinderMethods.html#third_to_last-instance_method" title="ActiveRecord::FinderMethods#third_to_last (method)">#third_to_last</a>, <a href="FinderMethods.html#third_to_last%21-instance_method" title="ActiveRecord::FinderMethods#third_to_last! (method)">#third_to_last!</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Calculations.html" title="ActiveRecord::Calculations (module)">Calculations</a></h3>
  <p class="inherited"><a href="Calculations.html#average-instance_method" title="ActiveRecord::Calculations#average (method)">#average</a>, <a href="Calculations.html#calculate-instance_method" title="ActiveRecord::Calculations#calculate (method)">#calculate</a>, <a href="Calculations.html#count-instance_method" title="ActiveRecord::Calculations#count (method)">#count</a>, <a href="Calculations.html#ids-instance_method" title="ActiveRecord::Calculations#ids (method)">#ids</a>, <a href="Calculations.html#maximum-instance_method" title="ActiveRecord::Calculations#maximum (method)">#maximum</a>, <a href="Calculations.html#minimum-instance_method" title="ActiveRecord::Calculations#minimum (method)">#minimum</a>, <a href="Calculations.html#pluck-instance_method" title="ActiveRecord::Calculations#pluck (method)">#pluck</a>, <a href="Calculations.html#sum-instance_method" title="ActiveRecord::Calculations#sum (method)">#sum</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="SpawnMethods.html" title="ActiveRecord::SpawnMethods (module)">SpawnMethods</a></h3>
  <p class="inherited"><a href="SpawnMethods.html#except-instance_method" title="ActiveRecord::SpawnMethods#except (method)">#except</a>, <a href="SpawnMethods.html#merge-instance_method" title="ActiveRecord::SpawnMethods#merge (method)">#merge</a>, <a href="SpawnMethods.html#merge%21-instance_method" title="ActiveRecord::SpawnMethods#merge! (method)">#merge!</a>, <a href="SpawnMethods.html#only-instance_method" title="ActiveRecord::SpawnMethods#only (method)">#only</a>, <a href="SpawnMethods.html#spawn-instance_method" title="ActiveRecord::SpawnMethods#spawn (method)">#spawn</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="QueryMethods.html" title="ActiveRecord::QueryMethods (module)">QueryMethods</a></h3>
  <p class="inherited"><a href="QueryMethods.html#_select%21-instance_method" title="ActiveRecord::QueryMethods#_select! (method)">#_select!</a>, <a href="QueryMethods.html#arel-instance_method" title="ActiveRecord::QueryMethods#arel (method)">#arel</a>, <a href="QueryMethods.html#bound_attributes-instance_method" title="ActiveRecord::QueryMethods#bound_attributes (method)">#bound_attributes</a>, <a href="QueryMethods.html#create_with-instance_method" title="ActiveRecord::QueryMethods#create_with (method)">#create_with</a>, <a href="QueryMethods.html#create_with%21-instance_method" title="ActiveRecord::QueryMethods#create_with! (method)">#create_with!</a>, <a href="QueryMethods.html#create_with_value-instance_method" title="ActiveRecord::QueryMethods#create_with_value (method)">#create_with_value</a>, <a href="QueryMethods.html#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a>, <a href="QueryMethods.html#distinct%21-instance_method" title="ActiveRecord::QueryMethods#distinct! (method)">#distinct!</a>, <a href="QueryMethods.html#eager_load-instance_method" title="ActiveRecord::QueryMethods#eager_load (method)">#eager_load</a>, <a href="QueryMethods.html#eager_load%21-instance_method" title="ActiveRecord::QueryMethods#eager_load! (method)">#eager_load!</a>, <a href="QueryMethods.html#extending-instance_method" title="ActiveRecord::QueryMethods#extending (method)">#extending</a>, <a href="QueryMethods.html#extending%21-instance_method" title="ActiveRecord::QueryMethods#extending! (method)">#extending!</a>, <a href="QueryMethods.html#from-instance_method" title="ActiveRecord::QueryMethods#from (method)">#from</a>, <a href="QueryMethods.html#from%21-instance_method" title="ActiveRecord::QueryMethods#from! (method)">#from!</a>, <a href="QueryMethods.html#group-instance_method" title="ActiveRecord::QueryMethods#group (method)">#group</a>, <a href="QueryMethods.html#group%21-instance_method" title="ActiveRecord::QueryMethods#group! (method)">#group!</a>, <a href="QueryMethods.html#having-instance_method" title="ActiveRecord::QueryMethods#having (method)">#having</a>, <a href="QueryMethods.html#having%21-instance_method" title="ActiveRecord::QueryMethods#having! (method)">#having!</a>, <a href="QueryMethods.html#includes-instance_method" title="ActiveRecord::QueryMethods#includes (method)">#includes</a>, <a href="QueryMethods.html#includes%21-instance_method" title="ActiveRecord::QueryMethods#includes! (method)">#includes!</a>, <a href="QueryMethods.html#joins-instance_method" title="ActiveRecord::QueryMethods#joins (method)">#joins</a>, <a href="QueryMethods.html#joins%21-instance_method" title="ActiveRecord::QueryMethods#joins! (method)">#joins!</a>, <a href="QueryMethods.html#left_outer_joins-instance_method" title="ActiveRecord::QueryMethods#left_outer_joins (method)">#left_outer_joins</a>, <a href="QueryMethods.html#left_outer_joins%21-instance_method" title="ActiveRecord::QueryMethods#left_outer_joins! (method)">#left_outer_joins!</a>, <a href="QueryMethods.html#limit-instance_method" title="ActiveRecord::QueryMethods#limit (method)">#limit</a>, <a href="QueryMethods.html#limit%21-instance_method" title="ActiveRecord::QueryMethods#limit! (method)">#limit!</a>, <a href="QueryMethods.html#lock-instance_method" title="ActiveRecord::QueryMethods#lock (method)">#lock</a>, <a href="QueryMethods.html#lock%21-instance_method" title="ActiveRecord::QueryMethods#lock! (method)">#lock!</a>, <a href="QueryMethods.html#none-instance_method" title="ActiveRecord::QueryMethods#none (method)">#none</a>, <a href="QueryMethods.html#none%21-instance_method" title="ActiveRecord::QueryMethods#none! (method)">#none!</a>, <a href="QueryMethods.html#offset-instance_method" title="ActiveRecord::QueryMethods#offset (method)">#offset</a>, <a href="QueryMethods.html#offset%21-instance_method" title="ActiveRecord::QueryMethods#offset! (method)">#offset!</a>, <a href="QueryMethods.html#or-instance_method" title="ActiveRecord::QueryMethods#or (method)">#or</a>, <a href="QueryMethods.html#or%21-instance_method" title="ActiveRecord::QueryMethods#or! (method)">#or!</a>, <a href="QueryMethods.html#order-instance_method" title="ActiveRecord::QueryMethods#order (method)">#order</a>, <a href="QueryMethods.html#order%21-instance_method" title="ActiveRecord::QueryMethods#order! (method)">#order!</a>, <a href="QueryMethods.html#preload-instance_method" title="ActiveRecord::QueryMethods#preload (method)">#preload</a>, <a href="QueryMethods.html#preload%21-instance_method" title="ActiveRecord::QueryMethods#preload! (method)">#preload!</a>, <a href="QueryMethods.html#readonly-instance_method" title="ActiveRecord::QueryMethods#readonly (method)">#readonly</a>, <a href="QueryMethods.html#readonly%21-instance_method" title="ActiveRecord::QueryMethods#readonly! (method)">#readonly!</a>, <a href="QueryMethods.html#references-instance_method" title="ActiveRecord::QueryMethods#references (method)">#references</a>, <a href="QueryMethods.html#references%21-instance_method" title="ActiveRecord::QueryMethods#references! (method)">#references!</a>, <a href="QueryMethods.html#reorder-instance_method" title="ActiveRecord::QueryMethods#reorder (method)">#reorder</a>, <a href="QueryMethods.html#reorder%21-instance_method" title="ActiveRecord::QueryMethods#reorder! (method)">#reorder!</a>, <a href="QueryMethods.html#reverse_order-instance_method" title="ActiveRecord::QueryMethods#reverse_order (method)">#reverse_order</a>, <a href="QueryMethods.html#reverse_order%21-instance_method" title="ActiveRecord::QueryMethods#reverse_order! (method)">#reverse_order!</a>, <a href="QueryMethods.html#rewhere-instance_method" title="ActiveRecord::QueryMethods#rewhere (method)">#rewhere</a>, <a href="QueryMethods.html#select-instance_method" title="ActiveRecord::QueryMethods#select (method)">#select</a>, <a href="QueryMethods.html#unscope-instance_method" title="ActiveRecord::QueryMethods#unscope (method)">#unscope</a>, <a href="QueryMethods.html#unscope%21-instance_method" title="ActiveRecord::QueryMethods#unscope! (method)">#unscope!</a>, <a href="QueryMethods.html#where-instance_method" title="ActiveRecord::QueryMethods#where (method)">#where</a>, <a href="QueryMethods.html#where%21-instance_method" title="ActiveRecord::QueryMethods#where! (method)">#where!</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">#append_features</a>, <a href="../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">#class_methods</a>, <a href="../ActiveSupport/Concern.html#extended-class_method" title="ActiveSupport::Concern.extended (method)">.extended</a>, <a href="../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">#included</a></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Batches.html" title="ActiveRecord::Batches (module)">Batches</a></h3>
  <p class="inherited"><a href="Batches.html#find_each-instance_method" title="ActiveRecord::Batches#find_each (method)">#find_each</a>, <a href="Batches.html#find_in_batches-instance_method" title="ActiveRecord::Batches#find_in_batches (method)">#find_in_batches</a>, <a href="Batches.html#in_batches-instance_method" title="ActiveRecord::Batches#in_batches (method)">#in_batches</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Explain.html" title="ActiveRecord::Explain (module)">Explain</a></h3>
  <p class="inherited"><a href="Explain.html#collecting_queries_for_explain-instance_method" title="ActiveRecord::Explain#collecting_queries_for_explain (method)">#collecting_queries_for_explain</a>, <a href="Explain.html#exec_explain-instance_method" title="ActiveRecord::Explain#exec_explain (method)">#exec_explain</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Delegation.html" title="ActiveRecord::Delegation (module)">Delegation</a></h3>
  <p class="inherited"><a href="Delegation.html#respond_to%3F-instance_method" title="ActiveRecord::Delegation#respond_to? (method)">#respond_to?</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../Enumerable.html" title="Enumerable (module)">Enumerable</a></h3>
  <p class="inherited"><a href="../Enumerable.html#exclude%3F-instance_method" title="Enumerable#exclude? (method)">#exclude?</a>, <a href="../Enumerable.html#index_by-instance_method" title="Enumerable#index_by (method)">#index_by</a>, <a href="../Enumerable.html#pluck-instance_method" title="Enumerable#pluck (method)">#pluck</a>, <a href="../Enumerable.html#sum-instance_method" title="Enumerable#sum (method)">#sum</a>, <a href="../Enumerable.html#without-instance_method" title="Enumerable#without (method)">#without</a></p>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(klass, table, predicate_builder, values = {})  &#x21d2; <tt><a href="" title="ActiveRecord::Relation (class)">Relation</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>a new instance of Relation</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L22'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


22
23
24
25
26
27
28
29</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 22</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_table'>table</span><span class='comma'>,</span> <span class='id identifier rubyid_predicate_builder'>predicate_builder</span><span class='comma'>,</span> <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@klass</span>  <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>
  <span class='ivar'>@table</span>  <span class='op'>=</span> <span class='id identifier rubyid_table'>table</span>
  <span class='ivar'>@values</span> <span class='op'>=</span> <span class='id identifier rubyid_values'>values</span>
  <span class='ivar'>@offsets</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@loaded</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@predicate_builder</span> <span class='op'>=</span> <span class='id identifier rubyid_predicate_builder'>predicate_builder</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 id='method_missing_details' class='y_details'>Dynamic Method Handling</h2>
  <p class='notice super'>
    This class handles dynamic methods through the <tt>method_missing</tt> method
      in the class ActiveRecord::Delegation
  </p>

<h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="klass-instance_method">
  <h3 class='signature first'>
  #<strong>klass</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
  <span class='aliases'>Also known as: <span class='names'><span>model</span></span>
  </span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L18'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


18</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 18</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:table</span><span class='comma'>,</span> <span class='symbol'>:klass</span><span class='comma'>,</span> <span class='symbol'>:loaded</span><span class='comma'>,</span> <span class='symbol'>:predicate_builder</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="loaded-instance_method">
  <h3 class='signature'>
  #<strong>loaded</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
  <span class='aliases'>Also known as: <span class='names'><span>loaded?</span></span>
  </span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L18'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


18</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 18</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:table</span><span class='comma'>,</span> <span class='symbol'>:klass</span><span class='comma'>,</span> <span class='symbol'>:loaded</span><span class='comma'>,</span> <span class='symbol'>:predicate_builder</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="loaded?-instance_method">
  <h3 class='signature'>
  #<strong>loaded?</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#loaded-instance_method" title="ActiveRecord::Relation#loaded (method)">#loaded</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="model-instance_method">
  <h3 class='signature'>
  #<strong>model</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#klass-instance_method" title="ActiveRecord::Relation#klass (method)">#klass</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="predicate_builder-instance_method">
  <h3 class='signature'>
  #<strong>predicate_builder</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L18'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


18</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 18</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:table</span><span class='comma'>,</span> <span class='symbol'>:klass</span><span class='comma'>,</span> <span class='symbol'>:loaded</span><span class='comma'>,</span> <span class='symbol'>:predicate_builder</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="table-instance_method">
  <h3 class='signature'>
  #<strong>table</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L18'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


18</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 18</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:table</span><span class='comma'>,</span> <span class='symbol'>:klass</span><span class='comma'>,</span> <span class='symbol'>:loaded</span><span class='comma'>,</span> <span class='symbol'>:predicate_builder</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="==-instance_method">
  <h3 class='signature first'>
  #<strong>==</strong>(other)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Compares two relations for equality.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L648'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


648
649
650
651
652
653
654
655
656
657</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 648</span>

<span class='kw'>def</span> <span class='op'>==</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_other'>other</span>
  <span class='kw'>when</span> <span class='const'><a href="Associations.html" title="ActiveRecord::Associations (module)">Associations</a></span><span class='op'>::</span><span class='const'><a href="Associations/CollectionProxy.html" title="ActiveRecord::Associations::CollectionProxy (class)">CollectionProxy</a></span><span class='comma'>,</span> <span class='const'><a href="AssociationRelation.html" title="ActiveRecord::AssociationRelation (class)">AssociationRelation</a></span>
    <span class='kw'>self</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_records'>records</span>
  <span class='kw'>when</span> <span class='const'><a href="" title="ActiveRecord::Relation (class)">Relation</a></span>
    <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_to_sql'>to_sql</span> <span class='op'>==</span> <span class='id identifier rubyid_to_sql'>to_sql</span>
  <span class='kw'>when</span> <span class='const'><a href="../Array.html" title="Array (class)">Array</a></span>
    <span class='id identifier rubyid_records'>records</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="any?-instance_method">
  <h3 class='signature'>
  #<strong>any?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if there are any records.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L290'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


290
291
292
293</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 290</span>

<span class='kw'>def</span> <span class='id identifier rubyid_any?'>any?</span>
  <span class='kw'>return</span> <span class='kw'>super</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='op'>!</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="blank?-instance_method">
  <h3 class='signature'>
  #<strong>blank?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if relation is blank.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L664'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


664
665
666</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 664</span>

<span class='kw'>def</span> <span class='id identifier rubyid_blank?'>blank?</span>
  <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="build-instance_method">
  <h3 class='signature'>
  #<strong>build</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#new-instance_method" title="ActiveRecord::Relation#new (method)">#new</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="cache_key-instance_method">
  <h3 class='signature'>
  #<strong>cache_key</strong>(timestamp_column = :updated_at)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a cache key that can be used to identify the records fetched by
this query. The cache key is built with a fingerprint of the sql query, the
number of records matched by the query and a timestamp of the last updated
record. When a new record comes to match the query, or any of the existing
records is updated or deleted, the cache key changes.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Product</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name like ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%Cosmic Encounter%</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cache_key'>cache_key</span>
<span class='comment'># =&gt; &quot;products/query-1850ab3d302391b85b8693e941286659-1-20150714212553907087000&quot;
</span></code></pre>

<p>If the collection is loaded, the method will iterate through the records to
generate the timestamp, otherwise it will trigger one SQL query like:</p>

<pre class="code ruby"><code class="ruby">SELECT COUNT(*), MAX(&quot;products&quot;.&quot;updated_at&quot;) FROM &quot;products&quot; WHERE (name like &#39;%Cosmic Encounter%&#39;)</code></pre>

<p>You can also pass a custom timestamp column to fetch the timestamp of the
last updated record.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Product</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name like ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%Game%</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cache_key'>cache_key</span><span class='lparen'>(</span><span class='symbol'>:last_reviewed_at</span><span class='rparen'>)</span>
</code></pre>

<p>You can customize the strategy to generate the key on a per model basis
overriding Base#collection_cache_key.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L328'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


328
329
330
331</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 328</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cache_key'>cache_key</span><span class='lparen'>(</span><span class='id identifier rubyid_timestamp_column'>timestamp_column</span> <span class='op'>=</span> <span class='symbol'>:updated_at</span><span class='rparen'>)</span>
  <span class='ivar'>@cache_keys</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@cache_keys</span><span class='lbracket'>[</span><span class='id identifier rubyid_timestamp_column'>timestamp_column</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_collection_cache_key'>collection_cache_key</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_timestamp_column'>timestamp_column</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create-instance_method">
  <h3 class='signature'>
  #<strong>create</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Tries to create a new record with the same scoped attributes defined in the
relation. Returns the initialized object if validation fails.</p>

<p>Expects arguments in the same format as
Base.create[Persistence::ClassMethods#create].</p>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Oscar</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='comment'># =&gt; #&lt;User id: 3, name: &quot;Oscar&quot;, ...&gt;
</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fxn</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='comment'># =&gt; #&lt;User id: 4, name: &quot;fxn&quot;, ...&gt;
</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tenderlove</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='comment'># =&gt; #&lt;User id: 5, name: &quot;tenderlove&quot;, ...&gt;
</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># validation on name
</span><span class='comment'># =&gt; #&lt;User id: nil, name: nil, ...&gt;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L147'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


147
148
149</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scoping'>scoping</span> <span class='lbrace'>{</span> <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create!-instance_method">
  <h3 class='signature'>
  #<strong>create!</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Similar to <a href="#create-instance_method" title="ActiveRecord::Relation#create (method)">#create</a>, but calls
<a href="#create%21-instance_method" title="ActiveRecord::Relation#create! (method)">#create!</a>[Persistence::ClassMethods#create!] on the base class. Raises an
exception if a validation error occurs.</p>

<p>Expects arguments in the same format as
Base.create![Persistence::ClassMethods#create!].</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L157'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


157
158
159</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scoping'>scoping</span> <span class='lbrace'>{</span> <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="delete-instance_method">
  <h3 class='signature'>
  #<strong>delete</strong>(id_or_array)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Deletes the row with a primary key matching the <code>id</code> argument,
using a SQL <code>DELETE</code> statement, and returns the number of rows
deleted. Active Record objects are not instantiated, so the object&#39;s
callbacks are not executed, including any <code>:dependent</code>
association options.</p>

<p>You can delete multiple rows at once by passing an Array of
<code>id</code>s.</p>

<p>Note: Although it is often much faster than the alternative, <a href="#destroy-instance_method" title="ActiveRecord::Relation#destroy (method)">#destroy</a>,
skipping callbacks might bypass business logic in your application that
ensures referential integrity or performs other essential jobs.</p>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='comment'># Delete a single row
</span><span class='const'>Todo</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>

<span class='comment'># Delete multiple rows
</span><span class='const'>Todo</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='comma'>,</span><span class='int'>4</span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L562'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


562
563
564</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 562</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id_or_array'>id_or_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_primary_key'>primary_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_id_or_array'>id_or_array</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete_all'>delete_all</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="delete_all-instance_method">
  <h3 class='signature'>
  #<strong>delete_all</strong>(conditions = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Deletes the records without instantiating the records first, and hence not
calling the <a href="#destroy-instance_method" title="ActiveRecord::Relation#destroy (method)">#destroy</a>[Persistence#destroy] method nor invoking callbacks.
This is a single SQL DELETE statement that goes straight to the database,
much more efficient than <a href="#destroy_all-instance_method" title="ActiveRecord::Relation#destroy_all (method)">#destroy_all</a>. Be careful with relations though,
in particular <code>:dependent</code> rules defined on associations are not
honored. Returns the number of rows affected.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>person_id:</span> <span class='int'>5</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>category:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Something</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Else</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete_all'>delete_all</span>
</code></pre>

<p>Both calls delete the affected posts all at once with a single DELETE
statement. If you need to destroy dependent associations or call your
<code>before_*</code> or <code>after_destroy</code> callbacks, use the
<a href="#destroy_all-instance_method" title="ActiveRecord::Relation#destroy_all (method)">#destroy_all</a> method instead.</p>

<p>If an invalid method is supplied, <a href="#delete_all-instance_method" title="ActiveRecord::Relation#delete_all (method)">#delete_all</a> raises an
ActiveRecordError:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete_all'>delete_all</span>
<span class='comment'># =&gt; ActiveRecord::ActiveRecordError: delete_all doesn&#39;t support limit
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L506'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 506</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_all'>delete_all</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_invalid_methods'>invalid_methods</span> <span class='op'>=</span> <span class='const'><a href="#INVALID_METHODS_FOR_DELETE_ALL-constant" title="ActiveRecord::Relation::INVALID_METHODS_FOR_DELETE_ALL (constant)">INVALID_METHODS_FOR_DELETE_ALL</a></span><span class='period'>.</span><span class='id identifier rubyid_select'><a href="QueryMethods.html#select-instance_method" title="ActiveRecord::QueryMethods#select (method)">select</a></span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_method'>method</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='const'><a href="#MULTI_VALUE_METHODS-constant" title="ActiveRecord::Relation::MULTI_VALUE_METHODS (constant)">MULTI_VALUE_METHODS</a></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_method'>method</span><span class='embexpr_end'>}</span><span class='tstring_content'>_values</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='kw'>elsif</span> <span class='const'><a href="#SINGLE_VALUE_METHODS-constant" title="ActiveRecord::Relation::SINGLE_VALUE_METHODS (constant)">SINGLE_VALUE_METHODS</a></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_method'>method</span><span class='embexpr_end'>}</span><span class='tstring_content'>_value</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='const'><a href="#CLAUSE_METHODS-constant" title="ActiveRecord::Relation::CLAUSE_METHODS (constant)">CLAUSE_METHODS</a></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_method'>method</span><span class='embexpr_end'>}</span><span class='tstring_content'>_clause</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_invalid_methods'>invalid_methods</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>delete_all doesn&#39;t support </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_invalid_methods'>invalid_methods</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_conditions'>conditions</span>
    <span class='const'><a href="../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)">Deprecation</a></span><span class='period'>.</span><span class='id identifier rubyid_warn'><a href="../ActiveSupport/Deprecation/Reporting.html#warn-instance_method" title="ActiveSupport::Deprecation::Reporting#warn (method)">warn</a></span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-MESSAGE</span><span class='period'>.</span><span class='id identifier rubyid_squish'>squish</span><span class='rparen'>)</span>
<span class='tstring_content'>      Passing conditions to delete_all is deprecated and will be removed in Rails 5.1.
      To achieve the same use where(conditions).delete_all.
</span><span class='heredoc_end'>    MESSAGE
</span>    <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete_all'>delete_all</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_stmt'>stmt</span> <span class='op'>=</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>DeleteManager</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_joins_values'>joins_values</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
      <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_join_to_delete'>join_to_delete</span><span class='lparen'>(</span><span class='id identifier rubyid_stmt'>stmt</span><span class='comma'>,</span> <span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_wheres'>wheres</span> <span class='op'>=</span> <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_constraints'>constraints</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_affected'>affected</span> <span class='op'>=</span> <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_stmt'>stmt</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SQL</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bound_attributes'>bound_attributes</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_reset'>reset</span>
    <span class='id identifier rubyid_affected'>affected</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="destroy-instance_method">
  <h3 class='signature'>
  #<strong>destroy</strong>(id)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Destroy an object (or multiple objects) that has the given id. The object
is instantiated first, therefore all callbacks and filters are fired off
before the object is deleted. This method is less efficient than <a href="#delete-instance_method" title="ActiveRecord::Relation#delete (method)">#delete</a>
but allows cleanup methods and other actions to be run.</p>

<p>This essentially finds the object (or multiple objects) with the given id,
creates a new object from the attributes, and then calls destroy on it.</p>

<h6 id="label-Parameters-3A">Parameters:</h6>
<ul><li>
<p><code>id</code> - Can be either an Integer or an Array of Integers.</p>
</li></ul>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='comment'># Destroy a single object
</span><span class='const'>Todo</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>

<span class='comment'># Destroy multiple objects
</span><span class='id identifier rubyid_todos'>todos</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span>
<span class='const'>Todo</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='id identifier rubyid_todos'>todos</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L480'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


480
481
482
483
484
485
486</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 480</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><a href="../Array.html" title="Array (class)">Array</a></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_one_id'>one_id</span><span class='op'>|</span> <span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='id identifier rubyid_one_id'>one_id</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="destroy_all-instance_method">
  <h3 class='signature'>
  #<strong>destroy_all</strong>(conditions = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Destroys the records by instantiating each record and calling its
<a href="#destroy-instance_method" title="ActiveRecord::Relation#destroy (method)">#destroy</a>[Persistence#destroy] method. Each object&#39;s callbacks are
executed (including <code>:dependent</code> association options). Returns
the collection of objects that were destroyed; each will be frozen, to
reflect that no changes should be made (since they can&#39;t be persisted).</p>

<p>Note: Instantiation, callback execution, and deletion of each record can be
time consuming when you&#39;re removing many records at once. It generates
at least one SQL <code>DELETE</code> query per record (or possibly more, to
enforce your callbacks). If you want to delete many rows quickly, without
concern for their associations or callbacks, use <a href="#delete_all-instance_method" title="ActiveRecord::Relation#delete_all (method)">#delete_all</a> instead.</p>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>age:</span> <span class='int'>0</span><span class='op'>..</span><span class='int'>18</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_destroy_all'>destroy_all</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L449'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


449
450
451
452
453
454
455
456
457
458
459</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 449</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy_all'>destroy_all</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_conditions'>conditions</span>
    <span class='const'><a href="../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)">Deprecation</a></span><span class='period'>.</span><span class='id identifier rubyid_warn'><a href="../ActiveSupport/Deprecation/Reporting.html#warn-instance_method" title="ActiveSupport::Deprecation::Reporting#warn (method)">warn</a></span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-MESSAGE</span><span class='period'>.</span><span class='id identifier rubyid_squish'>squish</span><span class='rparen'>)</span>
<span class='tstring_content'>      Passing conditions to destroy_all is deprecated and will be removed in Rails 5.1.
      To achieve the same use where(conditions).destroy_all.
</span><span class='heredoc_end'>    MESSAGE
</span>    <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_destroy_all'>destroy_all</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:destroy</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_reset'>reset</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="eager_loading?-instance_method">
  <h3 class='signature'>
  #<strong>eager_loading?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if relation needs eager loading.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L624'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


624
625
626
627
628</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 624</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eager_loading?'>eager_loading?</span>
  <span class='ivar'>@should_eager_load</span> <span class='op'>||=</span>
    <span class='id identifier rubyid_eager_load_values'>eager_load_values</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>||</span>
    <span class='id identifier rubyid_includes_values'>includes_values</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_joined_includes_values'>joined_includes_values</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>||</span> <span class='id identifier rubyid_references_eager_loaded_tables?'>references_eager_loaded_tables?</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="empty?-instance_method">
  <h3 class='signature'>
  #<strong>empty?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if there are no records.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L277'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


277
278
279
280
281</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 277</span>

<span class='kw'>def</span> <span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>return</span> <span class='ivar'>@records</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>if</span> <span class='id identifier rubyid_loaded?'>loaded?</span>

  <span class='id identifier rubyid_limit_value'>limit_value</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_exists?'>exists?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="encode_with-instance_method">
  <h3 class='signature'>
  #<strong>encode_with</strong>(coder)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Serializes the relation objects Array.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L263'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


263
264
265</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 263</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encode_with'>encode_with</span><span class='lparen'>(</span><span class='id identifier rubyid_coder'>coder</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_coder'>coder</span><span class='period'>.</span><span class='id identifier rubyid_represent_seq'>represent_seq</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_records'>records</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="explain-instance_method">
  <h3 class='signature'>
  #<strong>explain</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Runs EXPLAIN on the query or queries triggered by this relation and returns
the result as a string. The string is formatted imitating the ones printed
by the database shell.</p>

<p>Note that this method actually runs the queries, since the results of some
are needed by the next ones when eager loading is going on.</p>

<p>Please see further details in the <code>Active</code>[<a
href="http://guides.rubyonrails.org/active_record_querying.html#running-explain">guides.rubyonrails.org/active_record_querying.html#running-explain</a>].</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L247'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


247
248
249
250</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 247</span>

<span class='kw'>def</span> <span class='id identifier rubyid_explain'>explain</span>
  <span class='comment'>#TODO: Fix for binds.
</span>  <span class='id identifier rubyid_exec_explain'>exec_explain</span><span class='lparen'>(</span><span class='id identifier rubyid_collecting_queries_for_explain'>collecting_queries_for_explain</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_exec_queries'>exec_queries</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="find_or_create_by-instance_method">
  <h3 class='signature'>
  #<strong>find_or_create_by</strong>(attributes, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Finds the first record with the given attributes, or creates a record with
the attributes if one is not found:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Find the first user named &quot;Penélope&quot; or create a new one.
</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>first_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Penélope</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;User id: 1, first_name: &quot;Penélope&quot;, last_name: nil&gt;
</span>
<span class='comment'># Find the first user named &quot;Penélope&quot; or create a new one.
</span><span class='comment'># We already have one so the existing record will be returned.
</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>first_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Penélope</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;User id: 1, first_name: &quot;Penélope&quot;, last_name: nil&gt;
</span>
<span class='comment'># Find the first user named &quot;Scarlett&quot; or create a new one with
</span><span class='comment'># a particular last name.
</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_create_with'>create_with</span><span class='lparen'>(</span><span class='label'>last_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Johansson</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>first_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Scarlett</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;User id: 2, first_name: &quot;Scarlett&quot;, last_name: &quot;Johansson&quot;&gt;
</span></code></pre>

<p>This method accepts a block, which is passed down to <a href="#create-instance_method" title="ActiveRecord::Relation#create (method)">#create</a>. The last
example above can be alternatively written this way:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Find the first user named &quot;Scarlett&quot; or create a new one with a
</span><span class='comment'># different last name.
</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>first_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Scarlett</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span>
  <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_last_name'>last_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Johansson</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
<span class='comment'># =&gt; #&lt;User id: 2, first_name: &quot;Scarlett&quot;, last_name: &quot;Johansson&quot;&gt;
</span></code></pre>

<p>This method always returns a record, but if creation was attempted and
failed due to validation errors it won&#39;t be persisted, you get what
<a href="#create-instance_method" title="ActiveRecord::Relation#create (method)">#create</a> returns in such situation.</p>

<p>Please note *this method is not atomic*, it runs first a SELECT, and if
there are no results an INSERT is attempted. If there are other threads or
processes there is a race condition between both calls and it could be the
case that you end up with two similar records.</p>

<p>Whether that is a problem or not depends on the logic of the application,
but in the particular case in which rows have a UNIQUE constraint an
exception may be raised, just retry:</p>

<pre class="code ruby"><code class="ruby">begin
  CreditAccount.transaction(requires_new: true) do
    CreditAccount.find_or_create_by(user_id: user.id)
  end
rescue {ActiveRecord::RecordNotUnique}
  retry
end</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L221'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


221
222
223</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 221</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="find_or_create_by!-instance_method">
  <h3 class='signature'>
  #<strong>find_or_create_by!</strong>(attributes, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Like <a href="#find_or_create_by-instance_method" title="ActiveRecord::Relation#find_or_create_by (method)">#find_or_create_by</a>, but calls
<a href="#create%21-instance_method" title="ActiveRecord::Relation#create! (method)">#create!</a>[Persistence::ClassMethods#create!] so an exception is raised if
the created record is invalid.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L228'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


228
229
230</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 228</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_or_create_by!'>find_or_create_by!</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="find_or_initialize_by-instance_method">
  <h3 class='signature'>
  #<strong>find_or_initialize_by</strong>(attributes, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Like <a href="#find_or_create_by-instance_method" title="ActiveRecord::Relation#find_or_create_by (method)">#find_or_create_by</a>, but calls <a href="#new-class_method" title="ActiveRecord::Relation.new (method)">new</a>[Core#new] instead of
<a href="#create-instance_method" title="ActiveRecord::Relation#create (method)">#create</a>[Persistence::ClassMethods#create].</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L234'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


234
235
236</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 234</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_or_initialize_by'>find_or_initialize_by</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="initialize_copy-instance_method">
  <h3 class='signature'>
  #<strong>initialize_copy</strong>(other)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L31'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


31
32
33
34
35
36</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 31</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_copy'>initialize_copy</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='comment'># This method is a hot spot, so for now, use Hash[] to dup the hash.
</span>  <span class='comment'>#   https://bugs.ruby-lang.org/issues/7166
</span>  <span class='ivar'>@values</span>        <span class='op'>=</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span><span class='lbracket'>[</span><span class='ivar'>@values</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_reset'>reset</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="inspect-instance_method">
  <h3 class='signature'>
  #<strong>inspect</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L672'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


672
673
674
675
676
677</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 672</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='id identifier rubyid_entries'>entries</span> <span class='op'>=</span> <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_take'>take</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_limit_value'>limit_value</span><span class='comma'>,</span> <span class='int'>11</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_entries'>entries</span><span class='lbracket'>[</span><span class='int'>10</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>...</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>11</span>

  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>]&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="joined_includes_values-instance_method">
  <h3 class='signature'>
  #<strong>joined_includes_values</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Joins that are also marked for preloading. In which case we should just
eager load them. Note that this is a naive implementation because we could
have strings and symbols which represent the same association, but that
aren&#39;t matched by this. Also, we could have nested hashes which
partially match, e.g. { a: :b } &amp; { a: [:b, :c] }</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L634'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


634
635
636</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 634</span>

<span class='kw'>def</span> <span class='id identifier rubyid_joined_includes_values'>joined_includes_values</span>
  <span class='id identifier rubyid_includes_values'>includes_values</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_joins_values'>joins_values</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="load-instance_method">
  <h3 class='signature'>
  #<strong>load</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Causes the records to be loaded from the database if they have not been
loaded already. You can use this if for some reason you need to explicitly
load some records before actually using them. The return value is the
relation itself, not the records.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>published:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span> <span class='comment'># =&gt; #&lt;ActiveRecord::Relation&gt;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L572'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


572
573
574
575
576</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 572</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load'>load</span>
  <span class='id identifier rubyid_exec_queries'>exec_queries</span> <span class='kw'>unless</span> <span class='id identifier rubyid_loaded?'>loaded?</span>

  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="many?-instance_method">
  <h3 class='signature'>
  #<strong>many?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if there is more than one record.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L302'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


302
303
304
305</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 302</span>

<span class='kw'>def</span> <span class='id identifier rubyid_many?'>many?</span>
  <span class='kw'>return</span> <span class='kw'>super</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='id identifier rubyid_limit_value'>limit_value</span> <span class='op'>?</span> <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_many?'>many?</span> <span class='op'>:</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="new-instance_method">
  <h3 class='signature'>
  #<strong>new</strong>(*args, &amp;block)  
  <span class='aliases'>Also known as: <span class='names'><span>build</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Initializes new record from relation while maintaining the current scope.</p>

<p>Expects arguments in the same format as Base.new[Core.new].</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DHH</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='comment'># =&gt; #&lt;User id: nil, name: &quot;DHH&quot;, created_at: nil, updated_at: nil&gt;
</span></code></pre>

<p>You can also pass a block to new with the new record as argument:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Oscar</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; Oscar
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L122'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


122
123
124</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 122</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scoping'>scoping</span> <span class='lbrace'>{</span> <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="none?-instance_method">
  <h3 class='signature'>
  #<strong>none?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if there are no records.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L284'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


284
285
286
287</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 284</span>

<span class='kw'>def</span> <span class='id identifier rubyid_none?'>none?</span>
  <span class='kw'>return</span> <span class='kw'>super</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="one?-instance_method">
  <h3 class='signature'>
  #<strong>one?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if there is exactly one record.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L296'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


296
297
298
299</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 296</span>

<span class='kw'>def</span> <span class='id identifier rubyid_one?'>one?</span>
  <span class='kw'>return</span> <span class='kw'>super</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='id identifier rubyid_limit_value'>limit_value</span> <span class='op'>?</span> <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_one?'>one?</span> <span class='op'>:</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="pretty_print-instance_method">
  <h3 class='signature'>
  #<strong>pretty_print</strong>(q)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L659'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


659
660
661</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 659</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pretty_print'>pretty_print</span><span class='lparen'>(</span><span class='id identifier rubyid_q'>q</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_q'>q</span><span class='period'>.</span><span class='id identifier rubyid_pp'>pp</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_records'>records</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="reload-instance_method">
  <h3 class='signature'>
  #<strong>reload</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Forces reloading of relation.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L579'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


579
580
581
582</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 579</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reload'>reload</span>
  <span class='id identifier rubyid_reset'>reset</span>
  <span class='id identifier rubyid_load'>load</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="reset-instance_method">
  <h3 class='signature'>
  #<strong>reset</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L584'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


584
585
586
587
588
589
590</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 584</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset'>reset</span>
  <span class='ivar'>@last</span> <span class='op'>=</span> <span class='ivar'>@to_sql</span> <span class='op'>=</span> <span class='ivar'>@order_clause</span> <span class='op'>=</span> <span class='ivar'>@scope_for_create</span> <span class='op'>=</span> <span class='ivar'>@arel</span> <span class='op'>=</span> <span class='ivar'>@loaded</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@should_eager_load</span> <span class='op'>=</span> <span class='ivar'>@join_dependency</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@records</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='ivar'>@offsets</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="scope_for_create-instance_method">
  <h3 class='signature'>
  #<strong>scope_for_create</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L619'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


619
620
621</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 619</span>

<span class='kw'>def</span> <span class='id identifier rubyid_scope_for_create'>scope_for_create</span>
  <span class='ivar'>@scope_for_create</span> <span class='op'>||=</span> <span class='id identifier rubyid_where_values_hash'>where_values_hash</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_create_with_value'>create_with_value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="scoping-instance_method">
  <h3 class='signature'>
  #<strong>scoping</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Scope all queries to the current scope.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Comment</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>post_id:</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_scoping'>scoping</span> <span class='kw'>do</span>
  <span class='const'>Comment</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span>
<span class='comment'># =&gt; SELECT &quot;comments&quot;.* FROM &quot;comments&quot; WHERE &quot;comments&quot;.&quot;post_id&quot; = 1 ORDER BY &quot;comments&quot;.&quot;id&quot; ASC LIMIT 1
</span></code></pre>

<p>Please check unscoped if you want to remove all previous scopes (including
the default_scope) during the execution of a block.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L342'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


342
343
344
345
346
347</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 342</span>

<span class='kw'>def</span> <span class='id identifier rubyid_scoping'>scoping</span>
  <span class='id identifier rubyid_previous'>previous</span><span class='comma'>,</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_current_scope'>current_scope</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_current_scope'>current_scope</span><span class='comma'>,</span> <span class='kw'>self</span>
  <span class='kw'>yield</span>
<span class='kw'>ensure</span>
  <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_current_scope'>current_scope</span> <span class='op'>=</span> <span class='id identifier rubyid_previous'>previous</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="size-instance_method">
  <h3 class='signature'>
  #<strong>size</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns size of the records.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L272'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


272
273
274</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 272</span>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_loaded?'>loaded?</span> <span class='op'>?</span> <span class='ivar'>@records</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>:</span> <span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="to_a-instance_method">
  <h3 class='signature'>
  #<strong>to_a</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Converts relation objects to Array.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L253'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


253
254
255</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 253</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_a'>to_a</span>
  <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="to_sql-instance_method">
  <h3 class='signature'>
  #<strong>to_sql</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns sql statement for the relation.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Oscar</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_sql'>to_sql</span>
<span class='comment'># =&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot;  WHERE &quot;users&quot;.&quot;name&quot; = &#39;Oscar&#39;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L596'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


596
597
598
599
600
601
602
603
604
605
606
607
608
609</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 596</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_sql'>to_sql</span>
  <span class='ivar'>@to_sql</span> <span class='op'>||=</span> <span class='kw'>begin</span>
                <span class='id identifier rubyid_relation'>relation</span> <span class='op'>=</span> <span class='kw'>self</span>

                <span class='kw'>if</span> <span class='id identifier rubyid_eager_loading?'>eager_loading?</span>
                  <span class='id identifier rubyid_find_with_associations'>find_with_associations</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_rel'>rel</span><span class='op'>|</span> <span class='id identifier rubyid_relation'>relation</span> <span class='op'>=</span> <span class='id identifier rubyid_rel'>rel</span> <span class='rbrace'>}</span>
                <span class='kw'>end</span>

                <span class='id identifier rubyid_conn'>conn</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_connection'>connection</span>
                <span class='id identifier rubyid_conn'>conn</span><span class='period'>.</span><span class='id identifier rubyid_unprepared_statement'>unprepared_statement</span> <span class='lbrace'>{</span>
                  <span class='id identifier rubyid_conn'>conn</span><span class='period'>.</span><span class='id identifier rubyid_to_sql'>to_sql</span><span class='lparen'>(</span><span class='id identifier rubyid_relation'>relation</span><span class='period'>.</span><span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_relation'>relation</span><span class='period'>.</span><span class='id identifier rubyid_bound_attributes'>bound_attributes</span><span class='rparen'>)</span>
                <span class='rbrace'>}</span>
              <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="uniq_value-instance_method">
  <h3 class='signature'>
  #<strong>uniq_value</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p><a href="QueryMethods.html#uniq-instance_method" title="ActiveRecord::QueryMethods#uniq (method)">QueryMethods#uniq</a>[QueryMethods#uniq] and <a href="QueryMethods.html#uniq%21-instance_method" title="ActiveRecord::QueryMethods#uniq! (method)">QueryMethods#uniq!</a>[QueryMethods#uniq!] are silently
deprecated. <a href="#uniq_value-instance_method" title="ActiveRecord::Relation#uniq_value (method)">#uniq_value</a> delegates to <code>#distinct_value</code> to maintain
backwards compatibility. Use <code>#distinct_value</code> instead.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L642'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


642
643
644</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 642</span>

<span class='kw'>def</span> <span class='id identifier rubyid_uniq_value'>uniq_value</span>
  <span class='id identifier rubyid_distinct_value'>distinct_value</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update-instance_method">
  <h3 class='signature'>
  #<strong>update</strong>(id = :all, attributes)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Updates an object (or multiple objects) and saves it to the database, if
validations pass. The resulting object is returned whether the object was
saved successfully to the database or not.</p>

<h6 id="label-Parameters-3A">Parameters:</h6>
<ul><li>
<p><code>id</code> - This should be the id or an array of ids to be updated.</p>
</li><li>
<p><code>attributes</code> - This should be a hash of attributes or an array
of hashes.</p>
</li></ul>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='comment'># Updates one record
</span><span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='int'>15</span><span class='comma'>,</span> <span class='label'>user_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Samuel</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>group:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>expert</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Updates multiple records
</span><span class='id identifier rubyid_people'>people</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='int'>1</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>first_name</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='int'>2</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>first_name</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jeremy</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
<span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_people'>people</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='comma'>,</span> <span class='id identifier rubyid_people'>people</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='rparen'>)</span>

<span class='comment'># Updates multiple records from the result of a relation
</span><span class='id identifier rubyid_people'>people</span> <span class='op'>=</span> <span class='const'>Person</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>expert</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_people'>people</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='label'>group:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>masters</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>Note: Updating a large number of records will run an UPDATE query for each
record, which may cause a performance issue. So if it is not needed to run
callbacks for each update, it is preferred to use <a href="#update_all-instance_method" title="ActiveRecord::Relation#update_all (method)">#update_all</a> for
updating all records using a single query.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L414'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><a href="../Array.html" title="Array (class)">Array</a></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_with_index'>with_index</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_one_id'>one_id</span><span class='comma'>,</span> <span class='id identifier rubyid_idx'>idx</span><span class='op'>|</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_one_id'>one_id</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='symbol'>:all</span>
    <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span> <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="Base.html" title="ActiveRecord::Base (class)">Base</a></span> <span class='op'>===</span> <span class='id identifier rubyid_id'>id</span>
      <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
      <span class='const'><a href="../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)">Deprecation</a></span><span class='period'>.</span><span class='id identifier rubyid_warn'><a href="../ActiveSupport/Deprecation/Reporting.html#warn-instance_method" title="ActiveSupport::Deprecation::Reporting#warn (method)">warn</a></span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-MSG</span><span class='period'>.</span><span class='id identifier rubyid_squish'>squish</span><span class='rparen'>)</span>
<span class='tstring_content'>        You are passing an instance of ActiveRecord::Base to `update`.
        Please pass the id of the object by calling `.id`.
</span><span class='heredoc_end'>      MSG
</span>    <span class='kw'>end</span>
    <span class='id identifier rubyid_object'>object</span> <span class='op'>=</span> <span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_object'>object</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update_all-instance_method">
  <h3 class='signature'>
  #<strong>update_all</strong>(updates)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Updates all records in the current relation with details given. This method
constructs a single SQL UPDATE statement and sends it straight to the
database. It does not instantiate the involved models and it does not
trigger Active Record callbacks or validations. However, values passed to
<a href="#update_all-instance_method" title="ActiveRecord::Relation#update_all (method)">#update_all</a> will still go through Active Record&#39;s normal type casting
and serialization.</p>

<h6 id="label-Parameters-3A">Parameters:</h6>
<ul><li>
<p><code>updates</code> - A string, array, or hash representing the SET part
of an SQL statement.</p>
</li></ul>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='comment'># Update all customers with the given attributes
</span><span class='const'>Customer</span><span class='period'>.</span><span class='id identifier rubyid_update_all'>update_all</span> <span class='label'>wants_email:</span> <span class='kw'>true</span>

<span class='comment'># Update all books with &#39;Rails&#39; in their title
</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>title LIKE ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%Rails%</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_update_all'>update_all</span><span class='lparen'>(</span><span class='label'>author:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>David</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Update all books that match conditions, but limit it to 5 ordered by date
</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>title LIKE ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%Rails%</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbol'>:created_at</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>5</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_update_all'>update_all</span><span class='lparen'>(</span><span class='label'>author:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>David</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt>ArgumentError</tt>)</span>
  </li>
</ul>

</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L368'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 368</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_all'>update_all</span><span class='lparen'>(</span><span class='id identifier rubyid_updates'>updates</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Empty list of attributes to change</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_updates'>updates</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>

  <span class='id identifier rubyid_stmt'>stmt</span> <span class='op'>=</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>UpdateManager</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span> <span class='const'>Arel</span><span class='period'>.</span><span class='id identifier rubyid_sql'>sql</span><span class='lparen'>(</span><span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:sanitize_sql_for_assignment</span><span class='comma'>,</span> <span class='id identifier rubyid_updates'>updates</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_table'>table</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_joins_values'>joins_values</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_join_to_update'>join_to_update</span><span class='lparen'>(</span><span class='id identifier rubyid_stmt'>stmt</span><span class='comma'>,</span> <span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_take'>take</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_orders'>orders</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_stmt'>stmt</span><span class='period'>.</span><span class='id identifier rubyid_wheres'>wheres</span> <span class='op'>=</span> <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_constraints'>constraints</span>
  <span class='kw'>end</span>

  <span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='id identifier rubyid_stmt'>stmt</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SQL</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bound_attributes'>bound_attributes</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="values-instance_method">
  <h3 class='signature'>
  #<strong>values</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L668'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


668
669
670</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 668</span>

<span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
  <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span><span class='lbracket'>[</span><span class='ivar'>@values</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="where_values_hash-instance_method">
  <h3 class='signature'>
  #<strong>where_values_hash</strong>(relation_table_name = table_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a hash of where conditions.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Oscar</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where_values_hash'>where_values_hash</span>
<span class='comment'># =&gt; {name: &quot;Oscar&quot;}
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L615'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


615
616
617</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/relation.rb', line 615</span>

<span class='kw'>def</span> <span class='id identifier rubyid_where_values_hash'>where_values_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_relation_table_name'>relation_table_name</span> <span class='op'>=</span> <span class='id identifier rubyid_table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_where_clause'>where_clause</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span><span class='lparen'>(</span><span class='id identifier rubyid_relation_table_name'>relation_table_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>