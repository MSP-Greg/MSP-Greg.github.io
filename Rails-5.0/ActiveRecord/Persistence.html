<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::Persistence &mdash; Rails-5.0.0</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::Persistence",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Rails-5.0.0</a> &raquo; 
          <a href='../_index.html'>Index (P)</a> &raquo; 
          <a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <span class='title'>Persistence</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActiveRecord::Persistence</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>

  <tr>
    <td class='box_1'>Child Modules:</td>
    <td>
      <a href="Persistence/ClassMethods.html" title="ActiveRecord::Persistence::ClassMethods (module)">ClassMethods</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Extended by:</td>
    <td><a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a>
    </td>
  </tr>


  <tr>
    <td class='box_1'>Included in:</td>
    <td><a href="Base.html" title="ActiveRecord::Base (class)">Base</a>
    </td>
  </tr>

  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
activerecord/lib/active_record/persistence.rb</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<h2 id="label-Active+Record+Persistence">Active Record Persistence</h2>


  </div>
</div>
<div class="tags">
  
</div>




<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#becomes-instance_method" title="#becomes (instance method)">#<strong>becomes</strong>(klass)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an instance of the specified <code>klass</code> with the attributes
of the current record.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#becomes%21-instance_method" title="#becomes! (instance method)">#<strong>becomes!</strong>(klass)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Wrapper around <a href="#becomes-instance_method" title="ActiveRecord::Persistence#becomes (method)">#becomes</a> that also changes the instance&#39;s sti column
value.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#decrement-instance_method" title="#decrement (instance method)">#<strong>decrement</strong>(attribute, by = 1)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Initializes <code>attribute</code> to zero if <code>nil</code> and
subtracts the value passed as <code>by</code> (default is 1).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#decrement%21-instance_method" title="#decrement! (instance method)">#<strong>decrement!</strong>(attribute, by = 1)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Wrapper around <a href="#decrement-instance_method" title="ActiveRecord::Persistence#decrement (method)">#decrement</a> that saves the record.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#39;t be persisted).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#destroy-instance_method" title="#destroy (instance method)">#<strong>destroy</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#39;t be persisted).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#destroy%21-instance_method" title="#destroy! (instance method)">#<strong>destroy!</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#39;t be persisted).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#destroyed%3F-instance_method" title="#destroyed? (instance method)">#<strong>destroyed?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if this object has been destroyed, otherwise returns false.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#increment-instance_method" title="#increment (instance method)">#<strong>increment</strong>(attribute, by = 1)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Initializes <code>attribute</code> to zero if <code>nil</code> and adds the
value passed as <code>by</code> (default is 1).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#increment%21-instance_method" title="#increment! (instance method)">#<strong>increment!</strong>(attribute, by = 1)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Wrapper around <a href="#increment-instance_method" title="ActiveRecord::Persistence#increment (method)">#increment</a> that saves the record.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new_record%3F-instance_method" title="#new_record? (instance method)">#<strong>new_record?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if this object hasn&#39;t been saved yet – that is, a record
for the object doesn&#39;t exist in the database yet; otherwise, returns
false.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#persisted%3F-instance_method" title="#persisted? (instance method)">#<strong>persisted?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if the record is persisted, i.e. it&#39;s not a new record and
it was not destroyed, otherwise returns false.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#reload-instance_method" title="#reload (instance method)">#<strong>reload</strong>(options = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reloads the record from the database.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#save-instance_method" title="#save (instance method)">#<strong>save</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Saves the model.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#save%21-instance_method" title="#save! (instance method)">#<strong>save!</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Saves the model.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#toggle-instance_method" title="#toggle (instance method)">#<strong>toggle</strong>(attribute)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Assigns to <code>attribute</code> the boolean opposite of
<code>attribute?</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#toggle%21-instance_method" title="#toggle! (instance method)">#<strong>toggle!</strong>(attribute)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Wrapper around <a href="#toggle-instance_method" title="ActiveRecord::Persistence#toggle (method)">#toggle</a> that saves the record.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#touch-instance_method" title="#touch (instance method)">#<strong>touch</strong>(*names, time: nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Saves the record with the updated_at/on attributes set to the current time
or the time specified.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update-instance_method" title="#update (instance method)">#<strong>update</strong>(attributes)  </a>
        (also: #update_attributes)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Updates the attributes of the model from the passed-in hash and saves the
record, all wrapped in a transaction.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update%21-instance_method" title="#update! (instance method)">#<strong>update!</strong>(attributes)  </a>
        (also: #update_attributes!)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Updates its receiver just like <a href="#update-instance_method" title="ActiveRecord::Persistence#update (method)">#update</a> but calls <a href="#save%21-instance_method" title="ActiveRecord::Persistence#save! (method)">#save!</a> instead of
<code>save</code>, so an exception is raised if the record is invalid and
saving will fail.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update_attribute-instance_method" title="#update_attribute (instance method)">#<strong>update_attribute</strong>(name, value)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Updates a single attribute and saves the record.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update_attributes-instance_method" title="#update_attributes (instance method)">#<strong>update_attributes</strong>(attributes)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#update-instance_method" title="ActiveRecord::Persistence#update (method)">#update</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update_attributes%21-instance_method" title="#update_attributes! (instance method)">#<strong>update_attributes!</strong>(attributes)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#update%21-instance_method" title="ActiveRecord::Persistence#update! (method)">#update!</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update_column-instance_method" title="#update_column (instance method)">#<strong>update_column</strong>(name, value)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Equivalent to <code>update_columns(name =&gt; value)</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update_columns-instance_method" title="#update_columns (instance method)">#<strong>update_columns</strong>(attributes)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Updates the attributes directly in the database issuing an UPDATE SQL
statement and sets them in the receiver:</p>
</div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">append_features</a>, <a href="../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">class_methods</a>, <a href="../ActiveSupport/Concern.html#extended-class_method" title="ActiveSupport::Concern.extended (method)">.extended</a>, <a href="../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">included</a></p>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="becomes-instance_method">
  <h3 class='signature first'>
  #<strong>becomes</strong>(klass)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an instance of the specified <code>klass</code> with the attributes
of the current record. This is mostly useful in relation to single-table
inheritance structures where you want a subclass to appear as the
superclass. This can be used along with record identification in Action
Pack to allow, say, <code>Client &lt; Company</code> to do something like
render <code>partial: @client.becomes(Company)</code> to render that
instance using the companies/company partial instead of clients/client.</p>

<p>Note: The new instance will share a link to the same attributes as the
original class. Therefore the sti column value will still be the same. Any
change to the attributes on either instance will affect both instances. If
you want to change the sti column as well, use <a href="#becomes%21-instance_method" title="ActiveRecord::Persistence#becomes! (method)">#becomes!</a> instead.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


212
213
214
215
216
217
218
219
220
221</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_becomes'>becomes</span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_became'>became</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@attributes</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@attributes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@mutation_tracker</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@mutation_tracker</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@mutation_tracker</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@changed_attributes</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_attributes_changed_by_setter'>attributes_changed_by_setter</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@new_record</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_new_record?'>new_record?</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@destroyed</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_destroyed?'>destroyed?</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span><span class='period'>.</span><span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_copy!'>copy!</span><span class='lparen'>(</span><span class='id identifier rubyid_errors'>errors</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="becomes!-instance_method">
  <h3 class='signature'>
  #<strong>becomes!</strong>(klass)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Wrapper around <a href="#becomes-instance_method" title="ActiveRecord::Persistence#becomes (method)">#becomes</a> that also changes the instance&#39;s sti column
value. This is especially useful if you want to persist the changed class
in your database.</p>

<p>Note: The old instance&#39;s sti column value will be changed too, as both
objects share the same set of attributes.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


229
230
231
232
233
234
235
236
237</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 229</span>

<span class='kw'>def</span> <span class='id identifier rubyid_becomes!'>becomes!</span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span> <span class='op'>=</span> <span class='id identifier rubyid_becomes'>becomes</span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sti_type'>sti_type</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_descends_from_active_record?'>descends_from_active_record?</span>
    <span class='id identifier rubyid_sti_type'>sti_type</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_sti_name'>sti_name</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_became'>became</span><span class='period'>.</span><span class='id identifier rubyid_public_send'>public_send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_sti_type'>sti_type</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_became'>became</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="decrement-instance_method">
  <h3 class='signature'>
  #<strong>decrement</strong>(attribute, by = 1)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Initializes <code>attribute</code> to zero if <code>nil</code> and
subtracts the value passed as <code>by</code> (default is 1). The decrement
is performed directly on the underlying attribute, no setter is invoked.
Only makes sense for number-based attributes. Returns <code>self</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


347
348
349</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 347</span>

<span class='kw'>def</span> <span class='id identifier rubyid_decrement'>decrement</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='op'>-</span><span class='id identifier rubyid_by'>by</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="decrement!-instance_method">
  <h3 class='signature'>
  #<strong>decrement!</strong>(attribute, by = 1)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Wrapper around <a href="#decrement-instance_method" title="ActiveRecord::Persistence#decrement (method)">#decrement</a> that saves the record. This method differs from
its non-bang version in the sense that it passes through the attribute
setter. Saving is not subjected to validation checks. Returns
<code>true</code> if the record could be saved.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


355
356
357</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 355</span>

<span class='kw'>def</span> <span class='id identifier rubyid_decrement!'>decrement!</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_increment!'>increment!</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='op'>-</span><span class='id identifier rubyid_by'>by</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="delete-instance_method">
  <h3 class='signature'>
  #<strong>delete</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#39;t be persisted). Returns
the frozen instance.</p>

<p>The row is simply removed with an SQL <code>DELETE</code> statement on the
record&#39;s primary key, and no callbacks are executed.</p>

<p>Note that this will also delete records marked as
<code>#readonly?</code>[Core#readonly?].</p>

<p>To enforce the object&#39;s <code>before_destroy</code> and
<code>after_destroy</code> callbacks or any <code>:dependent</code>
association options, use <code>#destroy</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


167
168
169
170
171</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 167</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_persisted?'>persisted?</span>
  <span class='ivar'>@destroyed</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="destroy-instance_method">
  <h3 class='signature'>
  #<strong>destroy</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#39;t be persisted).</p>

<p>There&#39;s a series of callbacks associated with <a href="#destroy-instance_method" title="ActiveRecord::Persistence#destroy (method)">#destroy</a>. If the
<code>before_destroy</code> callback throws <code>:abort</code> the action
is cancelled and <a href="#destroy-instance_method" title="ActiveRecord::Persistence#destroy (method)">#destroy</a> returns <code>false</code>. See
<a href="Callbacks.html" title="ActiveRecord::Callbacks (module)">Callbacks</a> for further details.</p>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt><a href="ReadOnlyRecord.html" title="ActiveRecord::ReadOnlyRecord (class)">ReadOnlyRecord</a></tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


180
181
182
183
184
185
186
187</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 180</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy'>destroy</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ReadOnlyRecord</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'> is marked as readonly</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_readonly?'>readonly?</span>
  <span class='id identifier rubyid_destroy_associations'>destroy_associations</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_add_transaction_record'>add_transaction_record</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_destroy_row'>destroy_row</span> <span class='kw'>if</span> <span class='id identifier rubyid_persisted?'>persisted?</span>
  <span class='ivar'>@destroyed</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="destroy!-instance_method">
  <h3 class='signature'>
  #<strong>destroy!</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#39;t be persisted).</p>

<p>There&#39;s a series of callbacks associated with <a href="#destroy%21-instance_method" title="ActiveRecord::Persistence#destroy! (method)">#destroy!</a>. If the
<code>before_destroy</code> callback throws <code>:abort</code> the action
is cancelled and <a href="#destroy%21-instance_method" title="ActiveRecord::Persistence#destroy! (method)">#destroy!</a> raises <a href="RecordNotDestroyed.html" title="ActiveRecord::RecordNotDestroyed (class)">RecordNotDestroyed</a>. See
<a href="Callbacks.html" title="ActiveRecord::Callbacks (module)">Callbacks</a> for further details.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


196
197
198</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 196</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy!'>destroy!</span>
  <span class='id identifier rubyid_destroy'>destroy</span> <span class='op'>||</span> <span class='id identifier rubyid__raise_record_not_destroyed'>_raise_record_not_destroyed</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="destroyed?-instance_method">
  <h3 class='signature'>
  #<strong>destroyed?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if this object has been destroyed, otherwise returns false.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


91
92
93
94</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 91</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroyed?'>destroyed?</span>
  <span class='id identifier rubyid_sync_with_transaction_state'>sync_with_transaction_state</span>
  <span class='ivar'>@destroyed</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="increment-instance_method">
  <h3 class='signature'>
  #<strong>increment</strong>(attribute, by = 1)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Initializes <code>attribute</code> to zero if <code>nil</code> and adds the
value passed as <code>by</code> (default is 1). The increment is performed
directly on the underlying attribute, no setter is invoked. Only makes
sense for number-based attributes. Returns <code>self</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


326
327
328
329
330</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 326</span>

<span class='kw'>def</span> <span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='id identifier rubyid_by'>by</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="increment!-instance_method">
  <h3 class='signature'>
  #<strong>increment!</strong>(attribute, by = 1)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Wrapper around <a href="#increment-instance_method" title="ActiveRecord::Persistence#increment (method)">#increment</a> that saves the record. This method differs from
its non-bang version in that it passes through the attribute setter. Saving
is not subjected to validation checks. Returns <code>true</code> if the
record could be saved.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


336
337
338
339
340
341
342</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 336</span>

<span class='kw'>def</span> <span class='id identifier rubyid_increment!'>increment!</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_by'>by</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_change'>change</span> <span class='op'>=</span> <span class='id identifier rubyid_public_send'>public_send</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_attribute_was'>attribute_was</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_update_counters'>update_counters</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_attribute'>attribute</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_change'>change</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_clear_attribute_change'>clear_attribute_change</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rparen'>)</span> <span class='comment'># eww
</span>  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="new_record?-instance_method">
  <h3 class='signature'>
  #<strong>new_record?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if this object hasn&#39;t been saved yet – that is, a record
for the object doesn&#39;t exist in the database yet; otherwise, returns
false.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


85
86
87
88</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 85</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new_record?'>new_record?</span>
  <span class='id identifier rubyid_sync_with_transaction_state'>sync_with_transaction_state</span>
  <span class='ivar'>@new_record</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="persisted?-instance_method">
  <h3 class='signature'>
  #<strong>persisted?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if the record is persisted, i.e. it&#39;s not a new record and
it was not destroyed, otherwise returns false.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


98
99
100
101</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_persisted?'>persisted?</span>
  <span class='id identifier rubyid_sync_with_transaction_state'>sync_with_transaction_state</span>
  <span class='op'>!</span><span class='lparen'>(</span><span class='ivar'>@new_record</span> <span class='op'>||</span> <span class='ivar'>@destroyed</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="reload-instance_method">
  <h3 class='signature'>
  #<strong>reload</strong>(options = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reloads the record from the database.</p>

<p>This method finds record by its primary key (which could be assigned
manually) and modifies the receiver in-place:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_account'>account</span> <span class='op'>=</span> <span class='const'>Account</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='comment'># =&gt; #&lt;Account id: nil, email: nil&gt;
</span><span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_reload'>reload</span>
<span class='comment'># Account Load (1.2ms)  SELECT &quot;accounts&quot;.* FROM &quot;accounts&quot; WHERE &quot;accounts&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
</span><span class='comment'># =&gt; #&lt;Account id: 1, email: &#39;account@example.com&#39;&gt;
</span></code></pre>

<p>Attributes are reloaded from the database, and caches busted, in particular
the associations cache and the QueryCache.</p>

<p>If the record no longer exists in the database
<a href="RecordNotFound.html" title="ActiveRecord::RecordNotFound (class)">RecordNotFound</a> is raised. Otherwise, in addition to the
in-place modification the method returns <code>self</code> for convenience.</p>

<p>The optional <code>:lock</code> flag option allows you to lock the reloaded
record:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_reload'>reload</span><span class='lparen'>(</span><span class='label'>lock:</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='comment'># reload with pessimistic locking
</span></code></pre>

<p>Reloading is commonly used in test suites to test something is actually
written to the database, or when some action modifies the corresponding row
in the database but not the object in memory:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_deposit!'>deposit!</span><span class='lparen'>(</span><span class='int'>25</span><span class='rparen'>)</span>
<span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='int'>25</span><span class='comma'>,</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_credit'>credit</span>        <span class='comment'># check it is updated in memory
</span><span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='int'>25</span><span class='comma'>,</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_reload'>reload</span><span class='period'>.</span><span class='id identifier rubyid_credit'>credit</span> <span class='comment'># check it is also persisted
</span></code></pre>

<p>Another common use case is optimistic locking handling:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_with_optimistic_retry'>with_optimistic_retry</span>
  <span class='kw'>begin</span>
    <span class='kw'>yield</span>
  <span class='kw'>rescue</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>StaleObjectError</span>
    <span class='kw'>begin</span>
      <span class='comment'># Reload lock_version in particular.
</span>      <span class='id identifier rubyid_reload'>reload</span>
    <span class='kw'>rescue</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>RecordNotFound</span>
      <span class='comment'># If the record is gone there is nothing to do.
</span>    <span class='kw'>else</span>
      <span class='kw'>retry</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


432
433
434
435
436
437
438
439
440
441
442
443
444
445</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 432</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reload'>reload</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_clear_query_cache'>clear_query_cache</span>

  <span class='id identifier rubyid_fresh_object'>fresh_object</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:lock</span><span class='rbracket'>]</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_unscoped'>unscoped</span> <span class='lbrace'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_lock'>lock</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:lock</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_unscoped'>unscoped</span> <span class='lbrace'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>

  <span class='ivar'>@attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_fresh_object'>fresh_object</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@attributes</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@new_record</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="save-instance_method">
  <h3 class='signature'>
  #<strong>save</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Saves the model.</p>

<p>If the model is new, a record gets created in the database, otherwise the
existing record gets updated.</p>

<p>By default, save always runs validations. If any of them fail the action is
cancelled and <a href="#save-instance_method" title="ActiveRecord::Persistence#save (method)">#save</a> returns <code>false</code>, and the record won&#39;t
be saved. However, if you supply validate: false, validations are bypassed
altogether. See <a href="Validations.html" title="ActiveRecord::Validations (module)">Validations</a> for more information.</p>

<p>By default, <a href="#save-instance_method" title="ActiveRecord::Persistence#save (method)">#save</a> also sets the
<code>updated_at</code>/<code>updated_on</code> attributes to the current
time. However, if you supply <code>touch: false</code>, these timestamps
will not be updated.</p>

<p>There&#39;s a series of callbacks associated with <a href="#save-instance_method" title="ActiveRecord::Persistence#save (method)">#save</a>. If any of the
<code>before_*</code> callbacks throws <code>:abort</code> the action is
cancelled and <a href="#save-instance_method" title="ActiveRecord::Persistence#save (method)">#save</a> returns <code>false</code>. See
<a href="Callbacks.html" title="ActiveRecord::Callbacks (module)">Callbacks</a> for further details.</p>

<p>Attributes marked as readonly are silently ignored if the record is being
updated.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


124
125
126
127
128</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_create_or_update'>create_or_update</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>RecordInvalid</span>
  <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="save!-instance_method">
  <h3 class='signature'>
  #<strong>save!</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Saves the model.</p>

<p>If the model is new, a record gets created in the database, otherwise the
existing record gets updated.</p>

<p>By default, <a href="#save%21-instance_method" title="ActiveRecord::Persistence#save! (method)">#save!</a> always runs validations. If any of them fail
<a href="RecordInvalid.html" title="ActiveRecord::RecordInvalid (class)">RecordInvalid</a> gets raised, and the record won&#39;t be
saved. However, if you supply validate: false, validations are bypassed
altogether. See <a href="Validations.html" title="ActiveRecord::Validations (module)">Validations</a> for more information.</p>

<p>By default, <a href="#save%21-instance_method" title="ActiveRecord::Persistence#save! (method)">#save!</a> also sets the
<code>updated_at</code>/<code>updated_on</code> attributes to the current
time. However, if you supply <code>touch: false</code>, these timestamps
will not be updated.</p>

<p>There&#39;s a series of callbacks associated with <a href="#save%21-instance_method" title="ActiveRecord::Persistence#save! (method)">#save!</a>. If any of the
<code>before_*</code> callbacks throws <code>:abort</code> the action is
cancelled and <a href="#save%21-instance_method" title="ActiveRecord::Persistence#save! (method)">#save!</a> raises <a href="RecordNotSaved.html" title="ActiveRecord::RecordNotSaved (class)">RecordNotSaved</a>. See
<a href="Callbacks.html" title="ActiveRecord::Callbacks (module)">Callbacks</a> for further details.</p>

<p>Attributes marked as readonly are silently ignored if the record is being
updated.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


151
152
153</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save!'>save!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_create_or_update'>create_or_update</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'>RecordNotSaved</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to save the record</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="toggle-instance_method">
  <h3 class='signature'>
  #<strong>toggle</strong>(attribute)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Assigns to <code>attribute</code> the boolean opposite of
<code>attribute?</code>. So if the predicate returns <code>true</code> the
attribute will become <code>false</code>. This method toggles directly the
underlying value without calling any setter. Returns <code>self</code>.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_banned?'>banned?</span> <span class='comment'># =&gt; false
</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_toggle'>toggle</span><span class='lparen'>(</span><span class='symbol'>:banned</span><span class='rparen'>)</span>
<span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_banned?'>banned?</span> <span class='comment'># =&gt; true
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


371
372
373
374</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 371</span>

<span class='kw'>def</span> <span class='id identifier rubyid_toggle'>toggle</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_public_send'>public_send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="toggle!-instance_method">
  <h3 class='signature'>
  #<strong>toggle!</strong>(attribute)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Wrapper around <a href="#toggle-instance_method" title="ActiveRecord::Persistence#toggle (method)">#toggle</a> that saves the record. This method differs from
its non-bang version in the sense that it passes through the attribute
setter. Saving is not subjected to validation checks. Returns
<code>true</code> if the record could be saved.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


380
381
382</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 380</span>

<span class='kw'>def</span> <span class='id identifier rubyid_toggle!'>toggle!</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_toggle'>toggle</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="touch-instance_method">
  <h3 class='signature'>
  #<strong>touch</strong>(*names, time: nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Saves the record with the updated_at/on attributes set to the current time
or the time specified. Please note that no validation is performed and only
the <code>after_touch</code>, <code>after_commit</code> and
<code>after_rollback</code> callbacks are executed.</p>

<p>This method can be passed attribute names and an optional time argument. If
attribute names are passed, they are updated along with updated_at/on
attributes. If no time argument is passed, the current time is used as
default.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_product'>product</span><span class='period'>.</span><span class='id identifier rubyid_touch'>touch</span>                         <span class='comment'># updates updated_at/on with current time
</span><span class='id identifier rubyid_product'>product</span><span class='period'>.</span><span class='id identifier rubyid_touch'>touch</span><span class='lparen'>(</span><span class='label'>time:</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2015</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>16</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='comment'># updates updated_at/on with specified time
</span><span class='id identifier rubyid_product'>product</span><span class='period'>.</span><span class='id identifier rubyid_touch'>touch</span><span class='lparen'>(</span><span class='symbol'>:designed_at</span><span class='rparen'>)</span>           <span class='comment'># updates the designed_at attribute and updated_at/on
</span><span class='id identifier rubyid_product'>product</span><span class='period'>.</span><span class='id identifier rubyid_touch'>touch</span><span class='lparen'>(</span><span class='symbol'>:started_at</span><span class='comma'>,</span> <span class='symbol'>:ended_at</span><span class='rparen'>)</span> <span class='comment'># updates started_at, ended_at and updated_at/on attributes
</span></code></pre>

<p>If used along with <code>belongs_to</code>[Associations::ClassMethods#belongs_to] then
<code>touch</code> will invoke <code>touch</code> method on associated
object.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Brake</span> <span class='op'>&lt;</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span>
  <span class='id identifier rubyid_belongs_to'>belongs_to</span> <span class='symbol'>:car</span><span class='comma'>,</span> <span class='label'>touch:</span> <span class='kw'>true</span>
<span class='kw'>end</span>

<span class='kw'>class</span> <span class='const'>Car</span> <span class='op'>&lt;</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span>
  <span class='id identifier rubyid_belongs_to'>belongs_to</span> <span class='symbol'>:corporation</span><span class='comma'>,</span> <span class='label'>touch:</span> <span class='kw'>true</span>
<span class='kw'>end</span>

<span class='comment'># triggers @brake.car.touch and @brake.car.corporation.touch
</span><span class='ivar'>@brake</span><span class='period'>.</span><span class='id identifier rubyid_touch'>touch</span>
</code></pre>

<p>Note that <code>touch</code> must be used on a persisted object, or else an
ActiveRecordError will be thrown. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ball'>ball</span> <span class='op'>=</span> <span class='const'>Ball</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_ball'>ball</span><span class='period'>.</span><span class='id identifier rubyid_touch'>touch</span><span class='lparen'>(</span><span class='symbol'>:updated_at</span><span class='rparen'>)</span>   <span class='comment'># =&gt; raises ActiveRecordError
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 481</span>

<span class='kw'>def</span> <span class='id identifier rubyid_touch'>touch</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_names'>names</span><span class='comma'>,</span> <span class='label'>time:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_persisted?'>persisted?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ActiveRecordError</span><span class='comma'>,</span> <span class='heredoc_beg'>&lt;&lt;-MSG</span><span class='period'>.</span><span class='id identifier rubyid_squish'>squish</span>
<span class='tstring_content'>      cannot touch on a new or destroyed record object. Consider using
      persisted?, new_record?, or destroyed? before touching
</span><span class='heredoc_end'>    MSG
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_time'>time</span> <span class='op'>||=</span> <span class='id identifier rubyid_current_time_from_proper_timezone'>current_time_from_proper_timezone</span>
  <span class='id identifier rubyid_attributes'>attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_timestamp_attributes_for_update_in_model'>timestamp_attributes_for_update_in_model</span>
  <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_names'>names</span><span class='rparen'>)</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_changes'>changes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_column'>column</span><span class='op'>|</span>
      <span class='id identifier rubyid_column'>column</span> <span class='op'>=</span> <span class='id identifier rubyid_column'>column</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='id identifier rubyid_changes'>changes</span><span class='lbracket'>[</span><span class='id identifier rubyid_column'>column</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_write_attribute'>write_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_column'>column</span><span class='comma'>,</span> <span class='id identifier rubyid_time'>time</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_clear_attribute_changes'>clear_attribute_changes</span><span class='lparen'>(</span><span class='id identifier rubyid_changes'>changes</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_primary_key'>primary_key</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_primary_key'>primary_key</span>
    <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_unscoped'>unscoped</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_primary_key'>primary_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid__read_attribute'>_read_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_locking_enabled?'>locking_enabled?</span>
      <span class='id identifier rubyid_locking_column'>locking_column</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_locking_column'>locking_column</span>
      <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_locking_column'>locking_column</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid__read_attribute'>_read_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_locking_column'>locking_column</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_changes'>changes</span><span class='lbracket'>[</span><span class='id identifier rubyid_locking_column'>locking_column</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_increment_lock'>increment_lock</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_update_all'>update_all</span><span class='lparen'>(</span><span class='id identifier rubyid_changes'>changes</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>1</span>

    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_result'>result</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_locking_enabled?'>locking_enabled?</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>StaleObjectError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>touch</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>else</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update-instance_method">
  <h3 class='signature'>
  #<strong>update</strong>(attributes)  
  <span class='aliases'>Also known as: <span class='names'><span>update_attributes</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Updates the attributes of the model from the passed-in hash and saves the
record, all wrapped in a transaction. If the object is invalid, the saving
will fail and false will be returned.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


261
262
263
264
265
266
267
268</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 261</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='comment'># The following transaction covers any possible database side-effects of the
</span>  <span class='comment'># attributes assignment. For example, setting the IDs of a child collection.
</span>  <span class='id identifier rubyid_with_transaction_returning_status'>with_transaction_returning_status</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_assign_attributes'>assign_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_save'>save</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update!-instance_method">
  <h3 class='signature'>
  #<strong>update!</strong>(attributes)  
  <span class='aliases'>Also known as: <span class='names'><span>update_attributes!</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Updates its receiver just like <a href="#update-instance_method" title="ActiveRecord::Persistence#update (method)">#update</a> but calls <a href="#save%21-instance_method" title="ActiveRecord::Persistence#save! (method)">#save!</a> instead of
<code>save</code>, so an exception is raised if the record is invalid and
saving will fail.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


274
275
276
277
278
279
280
281</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 274</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update!'>update!</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='comment'># The following transaction covers any possible database side-effects of the
</span>  <span class='comment'># attributes assignment. For example, setting the IDs of a child collection.
</span>  <span class='id identifier rubyid_with_transaction_returning_status'>with_transaction_returning_status</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_assign_attributes'>assign_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_save!'>save!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update_attribute-instance_method">
  <h3 class='signature'>
  #<strong>update_attribute</strong>(name, value)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Updates a single attribute and saves the record. This is especially useful
for boolean flags on existing records. Also note that</p>
<ul><li>
<p>Validation is skipped.</p>
</li><li>
<p>Callbacks are invoked.</p>
</li><li>
<p>updated_at/updated_on column is updated if that column is available.</p>
</li><li>
<p>Updates all the attributes that are dirty in this object.</p>
</li></ul>

<p>This method raises an <a href="ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a>  if the attribute
is marked as readonly.</p>

<p>Also see <a href="#update_column-instance_method" title="ActiveRecord::Persistence#update_column (method)">#update_column</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


251
252
253
254
255
256</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 251</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_verify_readonly_attribute'>verify_readonly_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_public_send'>public_send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='label'>validate:</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_changed?'>changed?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update_attributes-instance_method">
  <h3 class='signature'>
  #<strong>update_attributes</strong>(attributes)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#update-instance_method" title="ActiveRecord::Persistence#update (method)">#update</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="update_attributes!-instance_method">
  <h3 class='signature'>
  #<strong>update_attributes!</strong>(attributes)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#update%21-instance_method" title="ActiveRecord::Persistence#update! (method)">#update!</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="update_column-instance_method">
  <h3 class='signature'>
  #<strong>update_column</strong>(name, value)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Equivalent to <code>update_columns(name =&gt; value)</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


286
287
288</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 286</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_column'>update_column</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_update_columns'>update_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update_columns-instance_method">
  <h3 class='signature'>
  #<strong>update_columns</strong>(attributes)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Updates the attributes directly in the database issuing an UPDATE SQL
statement and sets them in the receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_update_columns'>update_columns</span><span class='lparen'>(</span><span class='label'>last_request_at:</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='rparen'>)</span>
</code></pre>

<p>This is the fastest way to update attributes because it goes straight to
the database, but take into account that in consequence the regular update
procedures are totally bypassed. In particular:</p>
<ul><li>
<p>Validations are skipped.</p>
</li><li>
<p>Callbacks are skipped.</p>
</li><li>
<p><code>updated_at</code>/<code>updated_on</code> are not updated.</p>
</li><li>
<p>However, attributes are serialized with the same rules as
<a href="Relation.html#update_all-instance_method" title="ActiveRecord::Relation#update_all (method)">Relation#update_all</a></p>
</li></ul>

<p>This method raises an <a href="ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a> when called on new
objects, or when at least one of the attributes is marked as readonly.</p>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt><a href="ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></tt>)</span>
  </li>
</ul>

</div><div class='source_code h'>
  <pre class='lines_num'>


306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'activerecord/lib/active_record/persistence.rb', line 306</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_columns'>update_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ActiveRecordError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cannot update a new record</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_new_record?'>new_record?</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ActiveRecordError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cannot update a destroyed record</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_destroyed?'>destroyed?</span>

  <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_each_key'>each_key</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
    <span class='id identifier rubyid_verify_readonly_attribute'>verify_readonly_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_updated_count'>updated_count</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_unscoped'>unscoped</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_primary_key'>primary_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_update_all'>update_all</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='id identifier rubyid_raw_write_attribute'>raw_write_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_updated_count'>updated_count</span> <span class='op'>==</span> <span class='int'>1</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.0 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>