<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Rack::Utils &mdash; Rack main</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Rack::Utils",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Rack main</a> &raquo; 
      <a href='../_index.html#alpha_U'>Index (U)</a> &raquo; 
        <a href="../Rack.html" title="Rack (module)">Rack</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Utils&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Rack::Utils</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Utils/Context.html" title="Rack::Utils::Context (class)"><code>Context</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="ContentLength.html" title="Rack::ContentLength (class)"><code>ContentLength</code></a>,
          <a href="ContentType.html" title="Rack::ContentType (class)"><code>ContentType</code></a>
      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L20'>lib/rack/utils.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>Utils</code> contains a grab-bag of useful methods for writing web applications adopted from all kinds of Ruby libraries.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='COMMON_SEP-constant' class='summary_signature'>COMMON_SEP =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L25-L25'># File 'lib/rack/utils.rb', line 25</a>    <pre class='code ruby'><span class='const'><a href="QueryParser.html" title="Rack::QueryParser (class)">QueryParser</a></span><span class='op'>::</span><span class='const'><a href="QueryParser.html#COMMON_SEP-constant" title="Rack::QueryParser::COMMON_SEP (constant)">COMMON_SEP</a></span></pre>
  </li>
  <li>
    <span id='DEFAULT_SEP-constant' class='summary_signature'>DEFAULT_SEP =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L24-L24'># File 'lib/rack/utils.rb', line 24</a>    <pre class='code ruby'><span class='const'><a href="QueryParser.html" title="Rack::QueryParser (class)">QueryParser</a></span><span class='op'>::</span><span class='const'><a href="QueryParser.html#DEFAULT_SEP-constant" title="Rack::QueryParser::DEFAULT_SEP (constant)">DEFAULT_SEP</a></span></pre>
  </li>
  <li>
    <span id='HTTP_STATUS_CODES-constant' class='summary_signature'>HTTP_STATUS_CODES =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Every standard HTTP code mapped to the appropriate message. Generated with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_curl'>curl</span> <span class='op'>-</span><span class='id identifier rubyid_s'>s</span> <span class='label'>https:</span><span class='tstring'><span class='regexp_beg'>/</span><span class='regexp_end'>/www</span></span>.<span class='id identifier rubyid_iana'>iana</span>.<span class='id identifier rubyid_org'>org</span><span class='op'>/</span><span class='id identifier rubyid_assignments'>assignments</span><span class='op'>/</span><span class='id identifier rubyid_http'>http</span><span class='op'>-</span><span class='id identifier rubyid_status'>status</span><span class='op'>-</span><span class='id identifier rubyid_codes'>codes</span><span class='op'>/</span><span class='id identifier rubyid_http'>http</span><span class='op'>-</span><span class='id identifier rubyid_status'>status</span><span class='op'>-</span><span class='id identifier rubyid_codes'>codes</span><span class='op'>-</span><span class='int'>1</span>.<span class='id identifier rubyid_csv'>csv</span> \
  <span class='op'>|</span> <span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>-</span><span class='id identifier rubyid_rcsv'>rcsv</span> <span class='op'>-</span><span class='id identifier rubyid_e'>e</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>puts CSV.parse(STDIN, headers: true) \
  .reject {|v| v[&#39;Description&#39;] == &#39;Unassigned&#39; or v[&#39;Description&#39;].include? &#39;(&#39; } \
  .map {|v| %Q/</span><span class='embexpr_beg'>#{</span><span class='tstring_content'>v[&#39;Value&#39;]} =&gt; &#39;</span><span class='embexpr_beg'>#{</span><span class='tstring_content'>v[&#39;Description&#39;]}&#39;/ }.join(&#39;,&#39;+?\n)</span><span class='tstring_end'>&quot;</span></span></code></pre>

  </div>
</div>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L481-L542'># File 'lib/rack/utils.rb', line 481</a>    <pre class='code ruby'>{
  <span class='int'>100</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Continue</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>101</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Switching Protocols</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>102</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Processing</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>103</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Early Hints</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>200</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OK</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>201</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Created</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>202</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Accepted</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>203</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Non-Authoritative Information</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>204</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>No Content</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>205</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Reset Content</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>206</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Partial Content</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>207</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Multi-Status</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>208</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Already Reported</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>226</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IM Used</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>300</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Multiple Choices</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>301</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Moved Permanently</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>302</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Found</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>303</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>See Other</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>304</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Not Modified</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>305</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Use Proxy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>307</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Temporary Redirect</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>308</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Permanent Redirect</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>400</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Bad Request</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>401</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unauthorized</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>402</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payment Required</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>403</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Forbidden</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>404</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Not Found</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>405</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Method Not Allowed</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>406</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Not Acceptable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>407</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Proxy Authentication Required</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>408</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Request Timeout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>409</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Conflict</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>410</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Gone</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>411</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Length Required</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>412</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Precondition Failed</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>413</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content Too Large</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>414</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>URI Too Long</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>415</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unsupported Media Type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>416</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Range Not Satisfiable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>417</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Expectation Failed</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>421</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Misdirected Request</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>422</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unprocessable Content</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>423</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Locked</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>424</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Failed Dependency</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>425</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Too Early</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>426</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Upgrade Required</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>428</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Precondition Required</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>429</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Too Many Requests</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>431</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Request Header Fields Too Large</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>451</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unavailable For Legal Reasons</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>500</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Internal Server Error</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>501</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Not Implemented</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>502</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Bad Gateway</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>503</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Service Unavailable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>504</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Gateway Timeout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>505</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP Version Not Supported</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>506</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Variant Also Negotiates</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>507</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Insufficient Storage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>508</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Loop Detected</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>511</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Network Authentication Required</span><span class='tstring_end'>&#39;</span></span>
}</pre>
  </li>
  <li>
    <span id='InvalidParameterError-constant' class='summary_signature'>InvalidParameterError =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L22-L22'># File 'lib/rack/utils.rb', line 22</a>    <pre class='code ruby'><span class='const'><a href="QueryParser.html" title="Rack::QueryParser (class)">QueryParser</a></span><span class='op'>::</span><span class='const'><a href="QueryParser/InvalidParameterError.html" title="Rack::QueryParser::InvalidParameterError (class)">InvalidParameterError</a></span></pre>
  </li>
  <li>
    <span id='KeySpaceConstrainedParams-constant' class='summary_signature'>KeySpaceConstrainedParams =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L26-L26'># File 'lib/rack/utils.rb', line 26</a>    <pre class='code ruby'><span class='const'><a href="QueryParser.html" title="Rack::QueryParser (class)">QueryParser</a></span><span class='op'>::</span><span class='const'><a href="QueryParser/Params.html" title="Rack::QueryParser::Params (class)">Params</a></span></pre>
  </li>
  <li>
    <span id='NULL_BYTE-constant' class='summary_signature'>NULL_BYTE =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L598-L598'># File 'lib/rack/utils.rb', line 598</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\0</span><span class='tstring_end'>&quot;</span></span></pre>
  </li>
  <li>
    <span id='OBSOLETE_SYMBOLS_TO_STATUS_CODES-constant' class='summary_signature priv'>OBSOLETE_SYMBOLS_TO_STATUS_CODES =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L551-L556'># File 'lib/rack/utils.rb', line 551</a>    <pre class='code ruby'>{
  <span class='label'>payload_too_large:</span> <span class='int'>413</span><span class='comma'>,</span>
  <span class='label'>unprocessable_entity:</span> <span class='int'>422</span><span class='comma'>,</span>
  <span class='label'>bandwidth_limit_exceeded:</span> <span class='int'>509</span><span class='comma'>,</span>
  <span class='label'>not_extended:</span> <span class='int'>510</span>
}.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='OBSOLETE_SYMBOL_MAPPINGS-constant' class='summary_signature priv'>OBSOLETE_SYMBOL_MAPPINGS =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L559-L562'># File 'lib/rack/utils.rb', line 559</a>    <pre class='code ruby'>{
  <span class='label'>payload_too_large:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_content_too_large'>content_too_large</span><span class='comma'>,</span>
  <span class='label'>unprocessable_entity:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unprocessable_content'>unprocessable_content</span>
}.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='PATH_SEPS-constant' class='summary_signature'>PATH_SEPS =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L581-L581'># File 'lib/rack/utils.rb', line 581</a>    <pre class='code ruby'><span class='const'>Regexp</span>.<span class='id identifier rubyid_union'>union</span>(<span class='op'>*</span>[<span class='op'>::</span><span class='const'>File</span><span class='op'>::</span><span class='const'>SEPARATOR</span><span class='comma'>,</span> <span class='op'>::</span><span class='const'>File</span><span class='op'>::</span><span class='const'>ALT_SEPARATOR</span>].<span class='id identifier rubyid_compact'>compact</span>)</pre>
  </li>
  <li>
    <span id='ParameterTypeError-constant' class='summary_signature'>ParameterTypeError =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L21-L21'># File 'lib/rack/utils.rb', line 21</a>    <pre class='code ruby'><span class='const'><a href="QueryParser.html" title="Rack::QueryParser (class)">QueryParser</a></span><span class='op'>::</span><span class='const'><a href="QueryParser/ParameterTypeError.html" title="Rack::QueryParser::ParameterTypeError (class)">ParameterTypeError</a></span></pre>
  </li>
  <li>
    <span id='ParamsTooDeepError-constant' class='summary_signature'>ParamsTooDeepError =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L23-L23'># File 'lib/rack/utils.rb', line 23</a>    <pre class='code ruby'><span class='const'><a href="QueryParser.html" title="Rack::QueryParser (class)">QueryParser</a></span><span class='op'>::</span><span class='const'><a href="QueryParser/ParamsTooDeepError.html" title="Rack::QueryParser::ParamsTooDeepError (class)">ParamsTooDeepError</a></span></pre>
  </li>
  <li>
    <span id='STATUS_WITH_NO_ENTITY_BODY-constant' class='summary_signature'>STATUS_WITH_NO_ENTITY_BODY =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Responses with HTTP status codes that should not have an entity body</p>

  </div>
</div>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L545-L545'># File 'lib/rack/utils.rb', line 545</a>    <pre class='code ruby'></pre>
  </li>
  <li>
    <span id='SYMBOL_TO_STATUS_CODE-constant' class='summary_signature'>SYMBOL_TO_STATUS_CODE =</span>
    <br/>
    <a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L547-L547'># File 'lib/rack/utils.rb', line 547</a>    <pre class='code ruby'></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#default_query_parser-class_method" title=".default_query_parser (class method)">.<strong>default_query_parser</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#multipart_file_limit-class_method" title=".multipart_file_limit (class method)">.<strong>multipart_file_limit</strong>  </a>
      (also: .multipart_part_limit)
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#multipart_part_limit-class_method" title=".multipart_part_limit (class method)">.<strong>multipart_part_limit</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#multipart_file_limit-class_method" title="Rack::Utils.multipart_file_limit (method)">.multipart_file_limit</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#multipart_total_part_limit-class_method" title=".multipart_total_part_limit (class method)">.<strong>multipart_total_part_limit</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#param_depth_limit-class_method" title=".param_depth_limit (class method)">.<strong>param_depth_limit</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#param_depth_limit=-class_method" title=".param_depth_limit= (class method)">.<strong>param_depth_limit=</strong>(v)  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
</ul>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature mf'>
      <a href="#best_q_match-class_method" title=".best_q_match (class method)">.<strong>best_q_match</strong>(q_value_header, available_mimes)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Return best accept value to use, based on the algorithm in RFC 2616 Section 14.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#build_nested_query-class_method" title=".build_nested_query (class method)">.<strong>build_nested_query</strong>(value, prefix = nil)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#build_query-class_method" title=".build_query (class method)">.<strong>build_query</strong>(params)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#byte_ranges-class_method" title=".byte_ranges (class method)">.<strong>byte_ranges</strong>(env, size)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parses the “Range:” header, if present, into an array of Range objects.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#clean_path_info-class_method" title=".clean_path_info (class method)">.<strong>clean_path_info</strong>(path_info)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#clock_time-class_method" title=".clock_time (class method)">.<strong>clock_time</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>:nocov:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#delete_cookie_header!-class_method" title=".delete_cookie_header! (class method)">.<strong>delete_cookie_header!</strong>(headers, key, value = {})  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#delete_set_cookie_header-class_method" title="delete_set_cookie_header (class method)">.<strong>delete_set_cookie_header</strong>(key, value = {})  &#x21d2; encoded string </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Generate an encoded string based on the given <code>key</code> and <code>value</code> using set_cookie_header for the purpose of causing the specified cookie to be deleted.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#delete_set_cookie_header!-class_method" title="delete_set_cookie_header! (class method)">.<strong>delete_set_cookie_header!</strong>(header, key, value = {})  &#x21d2; header value </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Set an expired cookie in the specified headers with the given cookie <code>key</code> and <code>value</code> using delete_set_cookie_header.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#escape-class_method" title=".escape (class method)">.<strong>escape</strong>(s)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>URI escapes.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#escape_path-class_method" title=".escape_path (class method)">.<strong>escape_path</strong>(s)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Like URI escaping, but with %20 instead of +.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#forwarded_values-class_method" title=".forwarded_values (class method)">.<strong>forwarded_values</strong>(forwarded_header)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_byte_ranges-class_method" title=".get_byte_ranges (class method)">.<strong>get_byte_ranges</strong>(http_range, size)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#parse_cookies-class_method" title="parse_cookies (class method)">.<strong>parse_cookies</strong>(env)  &#x21d2; Hash </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parse cookies from the provided request environment using parse_cookies_header.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#parse_cookies_header-class_method" title="parse_cookies_header (class method)">.<strong>parse_cookies_header</strong>(value)  &#x21d2; Hash </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parse cookies from the provided header <code>value</code> according to RFC6265.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#parse_nested_query-class_method" title=".parse_nested_query (class method)">.<strong>parse_nested_query</strong>(qs, d = nil)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#parse_query-class_method" title=".parse_query (class method)">.<strong>parse_query</strong>(qs, d = nil, &amp;unescaper)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#q_values-class_method" title=".q_values (class method)">.<strong>q_values</strong>(q_value_header)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#rfc2822-class_method" title=".rfc2822 (class method)">.<strong>rfc2822</strong>(time)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#secure_compare-class_method" title=".secure_compare (class method)">.<strong>secure_compare</strong>(a, b)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Constant time string comparison.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#select_best_encoding-class_method" title=".select_best_encoding (class method)">.<strong>select_best_encoding</strong>(available_encodings, accept_encoding)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_cookie_header-class_method" title="set_cookie_header (class method)">.<strong>set_cookie_header</strong>(key, value)  &#x21d2; encoded string </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Generate an encoded string using the provided <code>key</code> and <code>value</code> suitable for the <code>set-cookie</code> header according to RFC6265.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_cookie_header!-class_method" title="set_cookie_header! (class method)">.<strong>set_cookie_header!</strong>(headers, key, value)  &#x21d2; header value </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Append a cookie in the specified headers with the given cookie <code>key</code> and <code>value</code> using set_cookie_header.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#status_code-class_method" title=".status_code (class method)">.<strong>status_code</strong>(status)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#unescape-class_method" title=".unescape (class method)">.<strong>unescape</strong>(s, encoding = Encoding::UTF_8)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Unescapes a URI escaped string with <code>encoding</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#unescape_path-class_method" title=".unescape_path (class method)">.<strong>unescape_path</strong>(s)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Unescapes the <strong>path</strong> component of a URI.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#valid_path%3F-class_method" title=".valid_path? (class method)">.<strong>valid_path?</strong>(path)  &#x21d2; Boolean </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->
<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="default_query_parser-class_method">
  <h3 class='signature rw first'>
    .<strong>default_query_parser</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L29-L29'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='29' data-end='29'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 29</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_default_query_parser'>default_query_parser</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="multipart_file_limit-class_method">
  <h3 class='signature rw'>
    .<strong>multipart_file_limit</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>.multipart_part_limit</span></span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L64-L64'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='64' data-end='64'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 64</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_multipart_file_limit'>multipart_file_limit</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="multipart_part_limit-class_method">
  <h3 class='signature rw'>
    .<strong>multipart_part_limit</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#multipart_file_limit-class_method" title="Rack::Utils.multipart_file_limit (method)">.multipart_file_limit</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L68-L68'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='68' data-end='68'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 68</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_multipart_part_limit'>multipart_part_limit</span> <span class='id identifier rubyid_multipart_file_limit'><a href="#multipart_file_limit-class_method" title="Rack::Utils.multipart_file_limit (method)">multipart_file_limit</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="multipart_total_part_limit-class_method">
  <h3 class='signature rw'>
    .<strong>multipart_total_part_limit</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L62-L62'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='62' data-end='62'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 62</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_multipart_total_part_limit'>multipart_total_part_limit</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="param_depth_limit-class_method">
  <h3 class='signature rw'>
    .<strong>param_depth_limit</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L81-L83'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='81' data-end='83'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 81</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_param_depth_limit'>param_depth_limit</span>
  <span class='id identifier rubyid_default_query_parser'><a href="#default_query_parser-class_method" title="Rack::Utils.default_query_parser (method)">default_query_parser</a></span>.<span class='id identifier rubyid_param_depth_limit'>param_depth_limit</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="param_depth_limit=-class_method">
  <h3 class='signature rw'>
    .<strong>param_depth_limit=</strong>(v)   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L85-L87'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='85' data-end='87'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 85</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_param_depth_limit='>param_depth_limit=</span>(<span class='id identifier rubyid_v'>v</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid_default_query_parser'><a href="#default_query_parser-class_method" title="Rack::Utils.default_query_parser (method)">default_query_parser</a></span> <span class='op'>=</span> <span class='kw'>self</span>.<span class='id identifier rubyid_default_query_parser'><a href="#default_query_parser-class_method" title="Rack::Utils.default_query_parser (method)">default_query_parser</a></span>.<span class='id identifier rubyid_new_depth_limit'>new_depth_limit</span>(<span class='id identifier rubyid_v'>v</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="best_q_match-class_method">
  <h3 class='signature private first'>
    .<strong>best_q_match</strong>(q_value_header, available_mimes)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return best accept value to use, based on the algorithm in RFC 2616 Section 14.  If there are multiple best matches (same specificity and quality), the value returned is arbitrary.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L166-L177'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='166' data-end='177'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 166</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_best_q_match'>best_q_match</span>(<span class='id identifier rubyid_q_value_header'>q_value_header</span><span class='comma'>,</span> <span class='id identifier rubyid_available_mimes'>available_mimes</span>)
  <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_q_values'><a href="#q_values-class_method" title="Rack::Utils.q_values (method)">q_values</a></span>(<span class='id identifier rubyid_q_value_header'>q_value_header</span>)

  <span class='id identifier rubyid_matches'>matches</span> <span class='op'>=</span> <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_req_mime'>req_mime</span><span class='comma'>,</span> <span class='id identifier rubyid_quality'>quality</span><span class='op'>|</span>
    <span class='id identifier rubyid_match'>match</span> <span class='op'>=</span> <span class='id identifier rubyid_available_mimes'>available_mimes</span>.<span class='id identifier rubyid_find'>find</span> { <span class='op'>|</span><span class='id identifier rubyid_am'>am</span><span class='op'>|</span> <span class='const'><a href="../Rack.html" title="Rack (module)">Rack</a></span><span class='op'>::</span><span class='const'><a href="Mime.html" title="Rack::Mime (module)">Mime</a></span>.<span class='id identifier rubyid_match?'><a href="Mime.html#match%3F-class_method" title="Rack::Mime.match? (method)">match?</a></span>(<span class='id identifier rubyid_am'>am</span><span class='comma'>,</span> <span class='id identifier rubyid_req_mime'>req_mime</span>) }
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_match'>match</span>
    [<span class='id identifier rubyid_match'>match</span><span class='comma'>,</span> <span class='id identifier rubyid_quality'>quality</span>]
  <span class='kw'>end</span>.<span class='id identifier rubyid_compact'>compact</span>.<span class='id identifier rubyid_sort_by'>sort_by</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_match'>match</span><span class='comma'>,</span> <span class='id identifier rubyid_quality'>quality</span><span class='op'>|</span>
    (<span class='id identifier rubyid_match'>match</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span>).<span class='id identifier rubyid_count'>count</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>*</span> <span class='op'>-</span><span class='int'>10</span>) <span class='op'>+</span> <span class='id identifier rubyid_quality'>quality</span>
  <span class='kw'>end</span>.<span class='id identifier rubyid_last'>last</span>
  <span class='id identifier rubyid_matches'>matches</span><span class='op'>&amp;.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_nested_query-class_method">
  <h3 class='signature private'>
    .<strong>build_nested_query</strong>(value, prefix = nil)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L119-L135'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='119' data-end='135'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 119</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_nested_query'>build_nested_query</span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_prefix'>prefix</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='kw'>case</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>when</span> <span class='const'>Array</span>
    <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='id identifier rubyid_build_nested_query'>build_nested_query</span>(<span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prefix'>prefix</span><span class='embexpr_end'>}</span><span class='tstring_content'>[]</span><span class='tstring_end'>&quot;</span></span>)
    }.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>when</span> <span class='const'>Hash</span>
    <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='id identifier rubyid_build_nested_query'>build_nested_query</span>(<span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='id identifier rubyid_prefix'>prefix</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prefix'>prefix</span><span class='embexpr_end'>}</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_k'>k</span>)
    }.<span class='id identifier rubyid_delete_if'>delete_if</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_empty?'>empty?</span>).<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&amp;</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>when</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_prefix'>prefix</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value must be a Hash</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_prefix'>prefix</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_prefix'>prefix</span>)<span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_value'>value</span>)<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_query-class_method">
  <h3 class='signature private'>
    .<strong>build_query</strong>(params)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L109-L117'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='109' data-end='117'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 109</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_query'>build_query</span>(<span class='id identifier rubyid_params'>params</span>)
  <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span>.<span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>Array</span>
      <span class='id identifier rubyid_build_query'>build_query</span>(<span class='id identifier rubyid_v'>v</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> [<span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span>] })
    <span class='kw'>else</span>
      <span class='id identifier rubyid_v'>v</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_k'>k</span>) <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_k'>k</span>)<span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_v'>v</span>)<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  }.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="byte_ranges-class_method">
  <h3 class='signature private'>
    .<strong>byte_ranges</strong>(env, size)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parses the “Range:” header, if present, into an array of Range objects. Returns nil if the header is missing or syntactically invalid. Returns an empty array if none of the ranges are satisfiable.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L385-L387'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='385' data-end='387'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 385</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_byte_ranges'>byte_ranges</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span>)
  <span class='id identifier rubyid_get_byte_ranges'><a href="#get_byte_ranges-class_method" title="Rack::Utils.get_byte_ranges (method)">get_byte_ranges</a></span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_RANGE</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clean_path_info-class_method">
  <h3 class='signature private'>
    .<strong>clean_path_info</strong>(path_info)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L583-L596'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='583' data-end='596'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 583</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clean_path_info'>clean_path_info</span>(<span class='id identifier rubyid_path_info'>path_info</span>)
  <span class='id identifier rubyid_parts'>parts</span> <span class='op'>=</span> <span class='id identifier rubyid_path_info'>path_info</span>.<span class='id identifier rubyid_split'>split</span> <span class='const'><a href="#PATH_SEPS-constant" title="Rack::Utils::PATH_SEPS (constant)">PATH_SEPS</a></span>

  <span class='id identifier rubyid_clean'>clean</span> <span class='op'>=</span> []

  <span class='id identifier rubyid_parts'>parts</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_part'>part</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_part'>part</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='id identifier rubyid_part'>part</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_part'>part</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='id identifier rubyid_clean'>clean</span>.<span class='id identifier rubyid_pop'>pop</span> <span class='op'>:</span> <span class='id identifier rubyid_clean'>clean</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_part'>part</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_clean_path'>clean_path</span> <span class='op'>=</span> <span class='id identifier rubyid_clean'>clean</span>.<span class='id identifier rubyid_join'>join</span>(<span class='op'>::</span><span class='const'>File</span><span class='op'>::</span><span class='const'>SEPARATOR</span>)
  <span class='id identifier rubyid_clean_path'>clean_path</span>.<span class='id identifier rubyid_prepend'>prepend</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='id identifier rubyid_parts'>parts</span>.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_clean_path'>clean_path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clock_time-class_method">
  <h3 class='signature private'>
    .<strong>clock_time</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>:nocov:</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L95-L97'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='95' data-end='97'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 95</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clock_time'>clock_time</span>
  <span class='const'>Process</span>.<span class='id identifier rubyid_clock_gettime'>clock_gettime</span>(<span class='const'>Process</span><span class='op'>::</span><span class='const'>CLOCK_MONOTONIC</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_cookie_header!-class_method">
  <h3 class='signature private'>
    .<strong>delete_cookie_header!</strong>(headers, key, value = {})   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L343-L347'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='343' data-end='347'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 343</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_cookie_header!'>delete_cookie_header!</span>(<span class='id identifier rubyid_headers'>headers</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_headers'>headers</span>[<span class='const'><a href="../Rack.html#SET_COOKIE-constant" title="Rack::SET_COOKIE (constant)">SET_COOKIE</a></span>] <span class='op'>=</span> <span class='id identifier rubyid_delete_set_cookie_header!'><a href="#delete_set_cookie_header!-class_method" title="Rack::Utils.delete_set_cookie_header! (method)">delete_set_cookie_header!</a></span>(<span class='id identifier rubyid_headers'>headers</span>[<span class='const'><a href="../Rack.html#SET_COOKIE-constant" title="Rack::SET_COOKIE (constant)">SET_COOKIE</a></span>]<span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)

  <span class='kw'>return</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_set_cookie_header-class_method">
  <h3 class='signature private'>
    .<strong>delete_set_cookie_header</strong>(key, value = {})  &#x21d2; <code>encoded</code> <code>string</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Generate an encoded string based on the given <code>key</code> and <code>value</code> using set_cookie_header for the purpose of causing the specified cookie to be deleted. The <code>value</code> may be an instance of <code>Hash</code> and can include attributes as outlined by set_cookie_header. The encoded cookie will have a <code>max_age</code> of 0 seconds, an <code>expires</code> date in the past and an empty <code>value</code>. When used with the <code>set-cookie</code> header, it will cause the client to <strong>remove</strong> any matching cookie.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_delete_set_cookie_header'>delete_set_cookie_header</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>myname</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;myname=; max-age=0; expires=Thu, 01 Jan 1970 00:00:00 GMT&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L339-L341'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='339' data-end='341'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 339</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_set_cookie_header'>delete_set_cookie_header</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_set_cookie_header'><a href="#set_cookie_header-class_method" title="Rack::Utils.set_cookie_header (method)">set_cookie_header</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>max_age:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>expires:</span> <span class='const'>Time</span>.<span class='id identifier rubyid_at'>at</span>(<span class='int'>0</span>)<span class='comma'>,</span> <span class='label'>value:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_set_cookie_header!-class_method">
  <h3 class='signature private'>
    .<strong>delete_set_cookie_header!</strong>(header, key, value = {})  &#x21d2; <code>header</code> <code>value</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Set an expired cookie in the specified headers with the given cookie <code>key</code> and <code>value</code> using delete_set_cookie_header. This causes the client to immediately delete the specified cookie.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_delete_set_cookie_header!'>delete_set_cookie_header!</span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mycookie</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;mycookie=; max-age=0; expires=Thu, 01 Jan 1970 00:00:00 GMT&quot;</span></code></pre>

<p>If the header is non-nil, it will be modified in place.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_header'>header</span> <span class='op'>=</span> []
<span class='id identifier rubyid_delete_set_cookie_header!'>delete_set_cookie_header!</span>(<span class='id identifier rubyid_header'>header</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mycookie</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; [&quot;mycookie=; max-age=0; expires=Thu, 01 Jan 1970 00:00:00 GMT&quot;]
</span><span class='id identifier rubyid_header'>header</span>
<span class='comment'># =&gt; [&quot;mycookie=; max-age=0; expires=Thu, 01 Jan 1970 00:00:00 GMT&quot;]</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L367-L376'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='367' data-end='376'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 367</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_set_cookie_header!'>delete_set_cookie_header!</span>(<span class='id identifier rubyid_header'>header</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> {})
  <span class='kw'>if</span> <span class='id identifier rubyid_header'>header</span>
    <span class='id identifier rubyid_header'>header</span> <span class='op'>=</span> <span class='const'>Array</span>(<span class='id identifier rubyid_header'>header</span>)
    <span class='id identifier rubyid_header'>header</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_delete_set_cookie_header'><a href="#delete_set_cookie_header-class_method" title="Rack::Utils.delete_set_cookie_header (method)">delete_set_cookie_header</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_header'>header</span> <span class='op'>=</span> <span class='id identifier rubyid_delete_set_cookie_header'><a href="#delete_set_cookie_header-class_method" title="Rack::Utils.delete_set_cookie_header (method)">delete_set_cookie_header</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_header'>header</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="escape-class_method">
  <h3 class='signature private'>
    .<strong>escape</strong>(s)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>URI escapes. (CGI style space to +)</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L39-L41'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='39' data-end='41'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 39</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_escape'>escape</span>(<span class='id identifier rubyid_s'>s</span>)
  <span class='const'>URI</span>.<span class='id identifier rubyid_encode_www_form_component'>encode_www_form_component</span>(<span class='id identifier rubyid_s'>s</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="escape_path-class_method">
  <h3 class='signature private'>
    .<strong>escape_path</strong>(s)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Like URI escaping, but with %20 instead of +. Strictly speaking this is true URI escaping.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L45-L47'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='45' data-end='47'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 45</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_escape_path'>escape_path</span>(<span class='id identifier rubyid_s'>s</span>)
  <span class='op'>::</span><span class='const'>URI</span><span class='op'>::</span><span class='const'>DEFAULT_PARSER</span>.<span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span> <span class='id identifier rubyid_s'>s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="forwarded_values-class_method">
  <h3 class='signature private'>
    .<strong>forwarded_values</strong>(forwarded_header)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L148-L159'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='148' data-end='159'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 148</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_forwarded_values'>forwarded_values</span>(<span class='id identifier rubyid_forwarded_header'>forwarded_header</span>)
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_forwarded_header'>forwarded_header</span>
  <span class='id identifier rubyid_forwarded_header'>forwarded_header</span> <span class='op'>=</span> <span class='id identifier rubyid_forwarded_header'>forwarded_header</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>;</span><span class='tstring_end'>&quot;</span></span>)

  <span class='id identifier rubyid_forwarded_header'>forwarded_header</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_each_with_object'>each_with_object</span>({}) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_values'>values</span><span class='op'>|</span>
    <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span>
      <span class='id identifier rubyid_pair'>pair</span> <span class='op'>=</span> <span class='id identifier rubyid_pair'>pair</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_strip'>strip</span>).<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=</span><span class='tstring_end'>&#39;</span></span>)
      <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_pair'>pair</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A(by|for|host|proto)=&quot;?([^&quot;]+)&quot;?\Z</span><span class='regexp_end'>/i</span></span>
      (<span class='id identifier rubyid_values'>values</span>[<span class='backref'>$1</span>.<span class='id identifier rubyid_downcase'>downcase</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>] <span class='op'>||=</span> []) <span class='op'>&lt;&lt;</span> <span class='backref'>$2</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_byte_ranges-class_method">
  <h3 class='signature private'>
    .<strong>get_byte_ranges</strong>(http_range, size)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L389-L421'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='389' data-end='421'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 389</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_byte_ranges'>get_byte_ranges</span>(<span class='id identifier rubyid_http_range'>http_range</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span>)
  <span class='comment'># See &lt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35&gt;
</span>  <span class='comment'># Ignore Range when file size is 0 to avoid a 416 error.
</span>  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span>.<span class='id identifier rubyid_zero?'>zero?</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_http_range'>http_range</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_http_range'>http_range</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bytes=([^;]+)</span><span class='regexp_end'>/</span></span>
  <span class='id identifier rubyid_ranges'>ranges</span> <span class='op'>=</span> []
  <span class='backref'>$1</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,\s*</span><span class='regexp_end'>/</span></span>).<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_range_spec'>range_spec</span><span class='op'>|</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_range_spec'>range_spec</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span>)
    <span class='id identifier rubyid_range'>range</span> <span class='op'>=</span> <span class='id identifier rubyid_range_spec'>range_spec</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span>)
    <span class='id identifier rubyid_r0'>r0</span><span class='comma'>,</span> <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_range'>range</span>[<span class='int'>0</span>]<span class='comma'>,</span> <span class='id identifier rubyid_range'>range</span>[<span class='int'>1</span>]
    <span class='kw'>if</span> <span class='id identifier rubyid_r0'>r0</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_r0'>r0</span>.<span class='id identifier rubyid_empty?'>empty?</span>
      <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_r1'>r1</span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='comment'># suffix-byte-range-spec, represents trailing suffix of file
</span>      <span class='id identifier rubyid_r0'>r0</span> <span class='op'>=</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_r1'>r1</span>.<span class='id identifier rubyid_to_i'>to_i</span>
      <span class='id identifier rubyid_r0'>r0</span> <span class='op'>=</span> <span class='int'>0</span>  <span class='kw'>if</span> <span class='id identifier rubyid_r0'>r0</span> <span class='op'>&lt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_r0'>r0</span> <span class='op'>=</span> <span class='id identifier rubyid_r0'>r0</span>.<span class='id identifier rubyid_to_i'>to_i</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_r1'>r1</span>.<span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_r1'>r1</span>.<span class='id identifier rubyid_to_i'>to_i</span>
        <span class='kw'>return</span> <span class='kw'>nil</span>  <span class='kw'>if</span> <span class='id identifier rubyid_r1'>r1</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_r0'>r0</span>  <span class='comment'># backwards range is syntactically invalid
</span>        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span>  <span class='kw'>if</span> <span class='id identifier rubyid_r1'>r1</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_size'>size</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_ranges'>ranges</span> <span class='op'>&lt;&lt;</span> (<span class='id identifier rubyid_r0'>r0</span><span class='op'>..</span><span class='id identifier rubyid_r1'>r1</span>)  <span class='kw'>if</span> <span class='id identifier rubyid_r0'>r0</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_r1'>r1</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> [] <span class='kw'>if</span> <span class='id identifier rubyid_ranges'>ranges</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_size'>size</span>).<span class='id identifier rubyid_sum'>sum</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_size'>size</span>

  <span class='id identifier rubyid_ranges'>ranges</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_cookies-class_method">
  <h3 class='signature private'>
    .<strong>parse_cookies</strong>(env)  &#x21d2; <code>Hash</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parse cookies from the provided request environment using parse_cookies_header. Returns a map of cookie <code>key</code> to cookie <code>value</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_parse_cookies'>parse_cookies</span>({<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_COOKIE</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>myname=myvalue</span><span class='tstring_end'>&#39;</span></span>})
<span class='comment'># =&gt; {&#39;myname&#39; =&gt; &#39;myvalue&#39;}</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L243-L245'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='243' data-end='245'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 243</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_cookies'>parse_cookies</span>(<span class='id identifier rubyid_env'>env</span>)
  <span class='id identifier rubyid_parse_cookies_header'><a href="#parse_cookies_header-class_method" title="Rack::Utils.parse_cookies_header (method)">parse_cookies_header</a></span> <span class='id identifier rubyid_env'>env</span>[<span class='const'><a href="../Rack.html#HTTP_COOKIE-constant" title="Rack::HTTP_COOKIE (constant)">HTTP_COOKIE</a></span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_cookies_header-class_method">
  <h3 class='signature private'>
    .<strong>parse_cookies_header</strong>(value)  &#x21d2; <code>Hash</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parse cookies from the provided header <code>value</code> according to RFC6265. The syntax for cookie headers only supports semicolons. Returns a map of cookie <code>key</code> to cookie <code>value</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_parse_cookies_header'>parse_cookies_header</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>myname=myvalue; max-age=0</span><span class='tstring_end'>&#39;</span></span>)
<span class='comment'># =&gt; {&quot;myname&quot;=&gt;&quot;myvalue&quot;, &quot;max-age&quot;=&gt;&quot;0&quot;}</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L224-L232'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='224' data-end='232'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 224</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_cookies_header'>parse_cookies_header</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>return</span> {} <span class='kw'>unless</span> <span class='id identifier rubyid_value'>value</span>

  <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>; *</span><span class='regexp_end'>/n</span></span>).<span class='id identifier rubyid_each_with_object'>each_with_object</span>({}) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cookie'>cookie</span><span class='comma'>,</span> <span class='id identifier rubyid_cookies'>cookies</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_cookie'>cookie</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_cookie'>cookie</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span>)
    <span class='id identifier rubyid_cookies'>cookies</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> (<span class='id identifier rubyid_unescape'><a href="#unescape-class_method" title="Rack::Utils.unescape (method)">unescape</a></span>(<span class='id identifier rubyid_value'>value</span>) <span class='kw'>rescue</span> <span class='id identifier rubyid_value'>value</span>) <span class='kw'>unless</span> <span class='id identifier rubyid_cookies'>cookies</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_key'>key</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_nested_query-class_method">
  <h3 class='signature private'>
    .<strong>parse_nested_query</strong>(qs, d = nil)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L105-L107'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='105' data-end='107'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 105</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_nested_query'>parse_nested_query</span>(<span class='id identifier rubyid_qs'>qs</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='const'><a href="../Rack.html" title="Rack (module)">Rack</a></span><span class='op'>::</span><span class='const'>Utils</span>.<span class='id identifier rubyid_default_query_parser'><a href="#default_query_parser-class_method" title="Rack::Utils.default_query_parser (method)">default_query_parser</a></span>.<span class='id identifier rubyid_parse_nested_query'>parse_nested_query</span>(<span class='id identifier rubyid_qs'>qs</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_query-class_method">
  <h3 class='signature private'>
    .<strong>parse_query</strong>(qs, d = nil, &amp;unescaper)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L101-L103'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='101' data-end='103'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 101</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_query'>parse_query</span>(<span class='id identifier rubyid_qs'>qs</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_unescaper'>unescaper</span>)
  <span class='const'><a href="../Rack.html" title="Rack (module)">Rack</a></span><span class='op'>::</span><span class='const'>Utils</span>.<span class='id identifier rubyid_default_query_parser'><a href="#default_query_parser-class_method" title="Rack::Utils.default_query_parser (method)">default_query_parser</a></span>.<span class='id identifier rubyid_parse_query'>parse_query</span>(<span class='id identifier rubyid_qs'>qs</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_unescaper'>unescaper</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="q_values-class_method">
  <h3 class='signature private'>
    .<strong>q_values</strong>(q_value_header)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L137-L146'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='137' data-end='146'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 137</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_q_values'>q_values</span>(<span class='id identifier rubyid_q_value_header'>q_value_header</span>)
  <span class='id identifier rubyid_q_value_header'>q_value_header</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_part'>part</span><span class='op'>|</span>
    <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_parameters'>parameters</span> <span class='op'>=</span> <span class='id identifier rubyid_part'>part</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span>).<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_strip'>strip</span>)
    <span class='id identifier rubyid_quality'>quality</span> <span class='op'>=</span> <span class='float'>1.0</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_parameters'>parameters</span> <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_md'>md</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aq=([\d.]+)</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='id identifier rubyid_parameters'>parameters</span>))
      <span class='id identifier rubyid_quality'>quality</span> <span class='op'>=</span> <span class='id identifier rubyid_md'>md</span>[<span class='int'>1</span>].<span class='id identifier rubyid_to_f'>to_f</span>
    <span class='kw'>end</span>
    [<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_quality'>quality</span>]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rfc2822-class_method">
  <h3 class='signature private'>
    .<strong>rfc2822</strong>(time)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L378-L380'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='378' data-end='380'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 378</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_rfc2822'>rfc2822</span>(<span class='id identifier rubyid_time'>time</span>)
  <span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_rfc2822'>rfc2822</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="secure_compare-class_method">
  <h3 class='signature private'>
    .<strong>secure_compare</strong>(a, b)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Constant time string comparison.</p>

<p>NOTE: the values compared should be of fixed length, such as strings that have already been processed by HMAC. This should not be used on variable length plaintext strings because it could leak length info via timing attacks.</p>

<p>See additional method definition at line 431.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L438-L442'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='438' data-end='442'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 438</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_secure_compare'>secure_compare</span>(<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='op'>==</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_bytesize'>bytesize</span>

  <span class='const'>OpenSSL</span>.<span class='id identifier rubyid_fixed_length_secure_compare'>fixed_length_secure_compare</span>(<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="select_best_encoding-class_method">
  <h3 class='signature private'>
    .<strong>select_best_encoding</strong>(available_encodings, accept_encoding)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L182-L212'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='182' data-end='212'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 182</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_select_best_encoding'>select_best_encoding</span>(<span class='id identifier rubyid_available_encodings'>available_encodings</span><span class='comma'>,</span> <span class='id identifier rubyid_accept_encoding'>accept_encoding</span>)
  <span class='comment'># http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
</span>
  <span class='id identifier rubyid_expanded_accept_encoding'>expanded_accept_encoding</span> <span class='op'>=</span> []

  <span class='id identifier rubyid_accept_encoding'>accept_encoding</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='op'>|</span>
    <span class='id identifier rubyid_preference'>preference</span> <span class='op'>=</span> <span class='id identifier rubyid_available_encodings'>available_encodings</span>.<span class='id identifier rubyid_index'>index</span>(<span class='id identifier rubyid_m'>m</span>) <span class='op'>||</span> <span class='id identifier rubyid_available_encodings'>available_encodings</span>.<span class='id identifier rubyid_size'>size</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span>
      (<span class='id identifier rubyid_available_encodings'>available_encodings</span> <span class='op'>-</span> <span class='id identifier rubyid_accept_encoding'>accept_encoding</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_first'>first</span>)).<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m2'>m2</span><span class='op'>|</span>
        <span class='id identifier rubyid_expanded_accept_encoding'>expanded_accept_encoding</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_m2'>m2</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_preference'>preference</span>]
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_expanded_accept_encoding'>expanded_accept_encoding</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_preference'>preference</span>]
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_encoding_candidates'>encoding_candidates</span> <span class='op'>=</span> <span class='id identifier rubyid_expanded_accept_encoding'>expanded_accept_encoding</span>
    .<span class='id identifier rubyid_sort_by'>sort_by</span> { <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_p'>p</span><span class='op'>|</span> [<span class='op'>-</span><span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_p'>p</span>] }
    .<span class='id identifier rubyid_map!'>map!</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_first'>first</span>)

  <span class='kw'>unless</span> <span class='id identifier rubyid_encoding_candidates'>encoding_candidates</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_encoding_candidates'>encoding_candidates</span>.<span class='id identifier rubyid_push'>push</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_expanded_accept_encoding'>expanded_accept_encoding</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='op'>|</span>
    <span class='id identifier rubyid_encoding_candidates'>encoding_candidates</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_m'>m</span>) <span class='kw'>if</span> <span class='id identifier rubyid_q'>q</span> <span class='op'>==</span> <span class='float'>0.0</span>
  <span class='kw'>end</span>

  (<span class='id identifier rubyid_encoding_candidates'>encoding_candidates</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_available_encodings'>available_encodings</span>)[<span class='int'>0</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_cookie_header-class_method">
  <h3 class='signature private'>
    .<strong>set_cookie_header</strong>(key, value)  &#x21d2; <code>encoded</code> <code>string</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Generate an encoded string using the provided <code>key</code> and <code>value</code> suitable for the <code>set-cookie</code> header according to RFC6265. The <code>value</code> may be an instance of either <code>String</code> or <code>Hash</code>.</p>

<p>If the cookie <code>value</code> is an instance of <code>Hash</code>, it considers the following cookie attribute keys: <code>domain</code>, <code>max_age</code>, <code>expires</code> (must be instance of <code>Time</code>), <code>secure</code>, <code>http_only</code>, <code>same_site</code> and <code>value</code>. For more details about the interpretation of these fields, consult [RFC6265 Section 5.2](<a href="https://datatracker.ietf.org/doc/html/rfc6265#section-5.2">datatracker.ietf.org/doc/html/rfc6265#section-5.2</a>).</p>

<p>An extra cookie attribute <code>escape_key</code> can be provided to control whether or not the cookie key is URL encoded. If explicitly set to <code>false</code>, the cookie key name will not be url encoded (escaped). The default is <code>true</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_set_cookie_header'>set_cookie_header</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>myname</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>myvalue</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;myname=myvalue&quot;
</span>
<span class='id identifier rubyid_set_cookie_header'>set_cookie_header</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>myname</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> {<span class='label'>value:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>myvalue</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>max_age:</span> <span class='int'>10</span>})
<span class='comment'># =&gt; &quot;myname=myvalue; max-age=10&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L270-L303'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='270' data-end='303'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 270</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_cookie_header'>set_cookie_header</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>case</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>when</span> <span class='const'>Hash</span>
    <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_key'>key</span>) <span class='kw'>unless</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_escape_key'>escape_key</span>] <span class='op'>==</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_domain'>domain</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; domain=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_domain'>domain</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>   <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_domain'>domain</span>]
    <span class='id identifier rubyid_path'>path</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; path=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_path'>path</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>       <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_path'>path</span>]
    <span class='id identifier rubyid_max_age'>max_age</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; max-age=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_max_age'>max_age</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_max_age'>max_age</span>]
    <span class='id identifier rubyid_expires'>expires</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; expires=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_expires'>expires</span>].<span class='id identifier rubyid_httpdate'>httpdate</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_expires'>expires</span>]
    <span class='id identifier rubyid_secure'>secure</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; secure</span><span class='tstring_end'>&quot;</span></span>  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_secure'>secure</span>]
    <span class='id identifier rubyid_httponly'>httponly</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; httponly</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> (<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_httponly'>httponly</span>) <span class='op'>?</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_httponly'>httponly</span>] <span class='op'>:</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_http_only'>http_only</span>])
    <span class='id identifier rubyid_same_site'>same_site</span> <span class='op'>=</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_same_site'>same_site</span>]
      <span class='kw'>when</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>nil</span>
        <span class='kw'>nil</span>
      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>None</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>None</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>; samesite=none</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_lax'>lax</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Lax</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>Lax</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>; samesite=lax</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>when</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_strict'>strict</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Strict</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>Strict</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>; samesite=strict</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid :same_site value: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_same_site'>same_site</span>].<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='id identifier rubyid_partitioned'>partitioned</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; partitioned</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_partitioned'>partitioned</span>]
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>]
  <span class='kw'>else</span>
    <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span>(<span class='id identifier rubyid_key'>key</span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> [<span class='id identifier rubyid_value'>value</span>] <span class='kw'>unless</span> <span class='const'>Array</span> <span class='op'>===</span> <span class='id identifier rubyid_value'>value</span>

  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_escape'><a href="#escape-class_method" title="Rack::Utils.escape (method)">escape</a></span> <span class='id identifier rubyid_v'>v</span> }.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&amp;</span><span class='tstring_end'>&#39;</span></span>)<span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_domain'>domain</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_age'>max_age</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_expires'>expires</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_secure'>secure</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_httponly'>httponly</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_same_site'>same_site</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitioned'>partitioned</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_cookie_header!-class_method">
  <h3 class='signature private'>
    .<strong>set_cookie_header!</strong>(headers, key, value)  &#x21d2; <code>header</code> <code>value</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Append a cookie in the specified headers with the given cookie <code>key</code> and <code>value</code> using set_cookie_header.</p>

<p>If the headers already contains a <code>set-cookie</code> key, it will be converted to an <code>Array</code> if not already, and appended to.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L313-L323'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='313' data-end='323'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 313</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_cookie_header!'>set_cookie_header!</span>(<span class='id identifier rubyid_headers'>headers</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_header'>header</span> <span class='op'>=</span> <span class='id identifier rubyid_headers'>headers</span>[<span class='const'><a href="../Rack.html#SET_COOKIE-constant" title="Rack::SET_COOKIE (constant)">SET_COOKIE</a></span>]
    <span class='kw'>if</span> <span class='id identifier rubyid_header'>header</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Array</span>)
      <span class='id identifier rubyid_header'>header</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_set_cookie_header'><a href="#set_cookie_header-class_method" title="Rack::Utils.set_cookie_header (method)">set_cookie_header</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_headers'>headers</span>[<span class='const'><a href="../Rack.html#SET_COOKIE-constant" title="Rack::SET_COOKIE (constant)">SET_COOKIE</a></span>] <span class='op'>=</span> [<span class='id identifier rubyid_header'>header</span><span class='comma'>,</span> <span class='id identifier rubyid_set_cookie_header'><a href="#set_cookie_header-class_method" title="Rack::Utils.set_cookie_header (method)">set_cookie_header</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)]
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_headers'>headers</span>[<span class='const'><a href="../Rack.html#SET_COOKIE-constant" title="Rack::SET_COOKIE (constant)">SET_COOKIE</a></span>] <span class='op'>=</span> <span class='id identifier rubyid_set_cookie_header'><a href="#set_cookie_header-class_method" title="Rack::Utils.set_cookie_header (method)">set_cookie_header</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="status_code-class_method">
  <h3 class='signature private'>
    .<strong>status_code</strong>(status)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L565-L579'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='565' data-end='579'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 565</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_status_code'>status_code</span>(<span class='id identifier rubyid_status'>status</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Symbol</span>)
    <span class='const'><a href="#SYMBOL_TO_STATUS_CODE-constant" title="Rack::Utils::SYMBOL_TO_STATUS_CODE (constant)">SYMBOL_TO_STATUS_CODE</a></span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_status'>status</span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_fallback_code'>fallback_code</span> <span class='op'>=</span> <span class='const'><a href="#OBSOLETE_SYMBOLS_TO_STATUS_CODES-constant" title="Rack::Utils::OBSOLETE_SYMBOLS_TO_STATUS_CODES (constant)">OBSOLETE_SYMBOLS_TO_STATUS_CODES</a></span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_status'>status</span>) { <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unrecognized status code </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }
      <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Status code </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is deprecated and will be removed in a future version of Rack.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_canonical_symbol'>canonical_symbol</span> <span class='op'>=</span> <span class='const'><a href="#OBSOLETE_SYMBOL_MAPPINGS-constant" title="Rack::Utils::OBSOLETE_SYMBOL_MAPPINGS (constant)">OBSOLETE_SYMBOL_MAPPINGS</a></span>[<span class='id identifier rubyid_status'>status</span>]
        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_content'> Please use </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_canonical_symbol'>canonical_symbol</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> instead.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_warn'>warn</span> <span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='label'>uplevel:</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fallback_code'>fallback_code</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unescape-class_method">
  <h3 class='signature private'>
    .<strong>unescape</strong>(s, encoding = Encoding::UTF_8)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Unescapes a URI escaped string with <code>encoding</code>. <code>encoding</code> will be the target encoding of the string returned, and it defaults to UTF-8</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L57-L59'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='57' data-end='59'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 57</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unescape'>unescape</span>(<span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_encoding'>encoding</span> <span class='op'>=</span> <span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_8</span>)
  <span class='const'>URI</span>.<span class='id identifier rubyid_decode_www_form_component'>decode_www_form_component</span>(<span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_encoding'>encoding</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unescape_path-class_method">
  <h3 class='signature private'>
    .<strong>unescape_path</strong>(s)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Unescapes the <strong>path</strong> component of a URI.  See <a href="#unescape-class_method" title="Rack::Utils.unescape (method)">.unescape</a> for unescaping query parameters or form components.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L51-L53'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='51' data-end='53'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unescape_path'>unescape_path</span>(<span class='id identifier rubyid_s'>s</span>)
  <span class='op'>::</span><span class='const'>URI</span><span class='op'>::</span><span class='const'>DEFAULT_PARSER</span>.<span class='id identifier rubyid_unescape'><a href="#unescape-class_method" title="Rack::Utils.unescape (method)">unescape</a></span> <span class='id identifier rubyid_s'>s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="valid_path?-class_method">
  <h3 class='signature private'>
    .<strong>valid_path?</strong>(path)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rack/rack/blob/main/lib/rack/utils.rb#L600-L602'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='600' data-end='602'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rack/utils.rb', line 600</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_valid_path?'>valid_path?</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_valid_encoding?'>valid_encoding?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='const'><a href="#NULL_BYTE-constant" title="Rack::Utils::NULL_BYTE (constant)">NULL_BYTE</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>