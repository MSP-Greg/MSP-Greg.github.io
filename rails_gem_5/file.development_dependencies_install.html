<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Development Dependencies Install &mdash; Rails 5.2.8.1</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "development_dependencies_install",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Rails 5.2.8.1</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Development Dependencies Install&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="http://guides.rubyonrails.org">http://guides.rubyonrails.org</a>.</strong></p>
<h1>Development Dependencies Install</h1>
<p>This guide covers how to setup an environment for Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> core development.</p>
<p>After reading this guide, you will know:</p>
<ul>
<li>How to set up your machine for <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> development</li>
<li>How to run specific groups of unit tests from the <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> test suite</li>
<li>How the Active Record portion of the <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> test suite operates</li>
</ul>
<hr />
<h2>The Easy Way</h2>
<p>The easiest and recommended way to get a development environment ready to hack is to use the <a href="https://github.com/rails/rails-dev-box" target="_parent" title="{Rails">{Rails</a> development box}.</p>
<h2>The Hard Way</h2>
<p>In case you can't use the <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> development box, see the steps below to manually
build a development box for Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> core development.</p>
<h3>Install Git</h3>
<p>Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> uses Git for source code control. The <a href="https://git-scm.com/" target="_parent" title="Git homepage">Git homepage</a> has installation instructions. There are a variety of resources on the net that will help you get familiar with Git:</p>
<ul>
<li><a href="https://try.github.io/" target="_parent" title="Try Git course">Try Git course</a> is an interactive course that will teach you the basics.</li>
<li>The <a href="https://git-scm.com/documentation" target="_parent" title="official Documentation">official Documentation</a> is pretty comprehensive and also contains some videos with the basics of Git.</li>
<li><a href="https://schacon.github.io/git/everyday.html" target="_parent" title="Everyday Git">Everyday Git</a> will teach you just enough about Git to get by.</li>
<li><a href="https://help.github.com/" target="_parent" title="GitHub">GitHub</a> offers links to a variety of Git resources.</li>
<li><a href="https://git-scm.com/book" target="_parent" title="Pro Git">Pro Git</a> is an entire book about Git with a Creative Commons license.</li>
</ul>
<h3>Clone the Ruby on Rails Repository</h3>
<p>Navigate to the folder where you want the Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> source code (it will create its own <code>rails</code> subdirectory) and run:</p>
<pre class="code bash"><code class="bash">$ git clone https://github.com/rails/rails.git
$ cd rails
</code></pre>
<h3>Set up and Run the Tests</h3>
<p>The test suite must pass with any submitted code. No matter whether you are writing a new patch, or evaluating someone else's, you need to be able to run the tests.</p>
<p>Install first SQLite3 and its development files for the <code>sqlite3</code> gem. On macOS
users are done with:</p>
<pre class="code bash"><code class="bash">$ brew install sqlite3
</code></pre>
<p>In Ubuntu you're done with just:</p>
<pre class="code bash"><code class="bash">$ sudo apt-get install sqlite3 libsqlite3-dev
</code></pre>
<p>If you are on Fedora or CentOS, you're done with</p>
<pre class="code bash"><code class="bash">$ sudo yum install libsqlite3x libsqlite3x-devel
</code></pre>
<p>If you are on Arch Linux, you will need to run:</p>
<pre class="code bash"><code class="bash">$ sudo pacman -S sqlite
</code></pre>
<p>For FreeBSD users, you're done with:</p>
<pre class="code bash"><code class="bash"># pkg install sqlite3
</code></pre>
<p>Or compile the <code>databases/sqlite3</code> port.</p>
<p>Get a recent version of <a href="https://bundler.io/" target="_parent" title="Bundler">Bundler</a></p>
<pre class="code bash"><code class="bash">$ gem install bundler
$ gem update bundler
</code></pre>
<p>and run:</p>
<pre class="code bash"><code class="bash">$ bundle install --without db
</code></pre>
<p>This command will install all dependencies except the MySQL and PostgreSQL Ruby drivers. We will come back to these soon.</p>
<p>NOTE: If you would like to run the tests that use memcached, you need to ensure that you have it installed and running.</p>
<p>You can use <a href="https://brew.sh/" target="_parent" title="Homebrew">Homebrew</a> to install memcached on macOS:</p>
<pre class="code bash"><code class="bash">$ brew install memcached
</code></pre>
<p>On Ubuntu you can install it with apt-get:</p>
<pre class="code bash"><code class="bash">$ sudo apt-get install memcached
</code></pre>
<p>Or use yum on Fedora or CentOS:</p>
<pre class="code bash"><code class="bash">$ sudo yum install memcached
</code></pre>
<p>If you are running on Arch Linux:</p>
<pre class="code bash"><code class="bash">$ sudo pacman -S memcached
</code></pre>
<p>For FreeBSD users, you're done with:</p>
<pre class="code bash"><code class="bash"># pkg install memcached
</code></pre>
<p>Alternatively, you can compile the <code>databases/memcached</code> port.</p>
<p>With the dependencies now installed, you can run the test suite with:</p>
<pre class="code bash"><code class="bash">$ bundle exec rake test
</code></pre>
<p>You can also run tests for a specific component, like Action Pack, by going into its directory and executing the same command:</p>
<pre class="code bash"><code class="bash">$ cd actionpack
$ bundle exec rake test
</code></pre>
<p>If you want to run the tests located in a specific directory use the <code>TEST_DIR</code> environment variable. For example, this will run the tests in the <code>railties/test/generators</code> directory only:</p>
<pre class="code bash"><code class="bash">$ cd railties
$ TEST_DIR=generators bundle exec rake test
</code></pre>
<p>You can run the tests for a particular file by using:</p>
<pre class="code bash"><code class="bash">$ cd actionpack
$ bundle exec ruby -Itest test/template/form_helper_test.rb
</code></pre>
<p>Or, you can run a single test in a particular file:</p>
<pre class="code bash"><code class="bash">$ cd actionpack
$ bundle exec ruby -Itest path/to/test.rb -n test_name
</code></pre>
<h3>Railties Setup</h3>
<p>Some Railties tests depend on a JavaScript runtime environment, such as having <a href="https://nodejs.org/" target="_parent" title="Node.js">Node.js</a> installed.</p>
<h3>Active Record Setup</h3>
<p>Active Record's test suite runs three times: once for SQLite3, once for MySQL, and once for PostgreSQL. We are going to see now how to set up the environment for them.</p>
<p>WARNING: If you're working with Active Record code, you <em>must</em> ensure that the tests pass for at least MySQL, PostgreSQL, and SQLite3. Subtle differences between the various adapters have been behind the rejection of many patches that looked OK when tested only against MySQL.</p>
<h4>Database Configuration</h4>
<p>The Active Record test suite requires a custom config file: <code>activerecord/test/config.yml</code>. An example is provided in <code>activerecord/test/config.example.yml</code> which can be copied and used as needed for your environment.</p>
<h4>MySQL and PostgreSQL</h4>
<p>To be able to run the suite for MySQL and PostgreSQL we need their gems. Install
first the servers, their client libraries, and their development files.</p>
<p>On macOS, you can run:</p>
<pre class="code bash"><code class="bash">$ brew install mysql
$ brew install postgresql
</code></pre>
<p>Follow the instructions given by Homebrew to start these.</p>
<p>On Ubuntu, just run:</p>
<pre class="code bash"><code class="bash">$ sudo apt-get install mysql-server libmysqlclient-dev
$ sudo apt-get install postgresql postgresql-client postgresql-contrib libpq-dev
</code></pre>
<p>On Fedora or CentOS, just run:</p>
<pre class="code bash"><code class="bash">$ sudo yum install mysql-server mysql-devel
$ sudo yum install postgresql-server postgresql-devel
</code></pre>
<p>If you are running Arch Linux, MySQL isn't supported anymore so you will need to
use MariaDB instead (see <a href="https://www.archlinux.org/news/mariadb-replaces-mysql-in-repositories/" target="_parent" title="this announcement">this announcement</a>):</p>
<pre class="code bash"><code class="bash">$ sudo pacman -S mariadb libmariadbclient mariadb-clients
$ sudo pacman -S postgresql postgresql-libs
</code></pre>
<p>FreeBSD users will have to run the following:</p>
<pre class="code bash"><code class="bash"># pkg install mysql56-client mysql56-server
# pkg install postgresql94-client postgresql94-server
</code></pre>
<p>Or install them through ports (they are located under the <code>databases</code> folder).
If you run into troubles during the installation of MySQL, please see
<a href="http://dev.mysql.com/doc/refman/5.1/en/freebsd-installation.html" target="_parent" title="the MySQL documentation">the MySQL documentation</a>.</p>
<p>After that, run:</p>
<pre class="code bash"><code class="bash">$ rm .bundle/config
$ bundle install
</code></pre>
<p>First, we need to delete <code>.bundle/config</code> because Bundler remembers in that file that we didn't want to install the &quot;db&quot; group (alternatively you can edit the file).</p>
<p>In order to be able to run the test suite against MySQL you need to create a user named <code>rails</code> with privileges on the test databases:</p>
<pre class="code bash"><code class="bash">$ mysql -uroot -p

mysql&gt; CREATE USER &#39;rails&#39;@&#39;localhost&#39;;
mysql&gt; GRANT ALL PRIVILEGES ON activerecord_unittest.*
       to &#39;rails&#39;@&#39;localhost&#39;;
mysql&gt; GRANT ALL PRIVILEGES ON activerecord_unittest2.*
       to &#39;rails&#39;@&#39;localhost&#39;;
mysql&gt; GRANT ALL PRIVILEGES ON inexistent_activerecord_unittest.*
       to &#39;rails&#39;@&#39;localhost&#39;;
</code></pre>
<p>and create the test databases:</p>
<pre class="code bash"><code class="bash">$ cd activerecord
$ bundle exec rake db:mysql:build
</code></pre>
<p>PostgreSQL's authentication works differently. To setup the development environment
with your development account, on Linux or BSD, you just have to run:</p>
<pre class="code bash"><code class="bash">$ sudo -u postgres createuser --superuser $USER
</code></pre>
<p>and for macOS:</p>
<pre class="code bash"><code class="bash">$ createuser --superuser $USER
</code></pre>
<p>Then, you need to create the test databases with:</p>
<pre class="code bash"><code class="bash">$ cd activerecord
$ bundle exec rake db:postgresql:build
</code></pre>
<p>It is possible to build databases for both PostgreSQL and MySQL with:</p>
<pre class="code bash"><code class="bash">$ cd activerecord
$ bundle exec rake db:create
</code></pre>
<p>You can cleanup the databases using:</p>
<pre class="code bash"><code class="bash">$ cd activerecord
$ bundle exec rake db:drop
</code></pre>
<p>NOTE: Using the Rake task to create the test databases ensures they have the correct character set and collation.</p>
<p>NOTE: You'll see the following warning (or localized warning) during activating HStore extension in PostgreSQL 9.1.x or earlier: &quot;WARNING: =&gt; is deprecated as an operator&quot;.</p>
<p>If you're using another database, check the file <code>activerecord/test/config.yml</code> or <code>activerecord/test/config.example.yml</code> for default connection information. You can edit <code>activerecord/test/config.yml</code> to provide different credentials on your machine if you must, but obviously you should not push any such changes back to Rails.</p>
<h3>Action Cable Setup</h3>
<p>Action Cable uses Redis as its default subscriptions adapter (<a href="action_cable_overview.html#broadcasting">read more</a>). Thus, in order to have Action Cable's tests passing you need to install and have Redis running.</p>
<h4>Install Redis From Source</h4>
<p>Redis' documentation discourage installations with package managers as those are usually outdated. Installing from source and bringing the server up is straight forward and well documented on <a href="https://redis.io/download#installation" target="_parent" title="Redis&#39; documentation">Redis' documentation</a>.</p>
<h4>Install Redis From Package Manager</h4>
<p>On macOS, you can run:</p>
<pre class="code bash"><code class="bash">$ brew install redis
</code></pre>
<p>Follow the instructions given by Homebrew to start these.</p>
<p>On Ubuntu, just run:</p>
<pre class="code bash"><code class="bash">$ sudo apt-get install redis-server
</code></pre>
<p>On Fedora or CentOS (requires EPEL enabled), just run:</p>
<pre class="code bash"><code class="bash">$ sudo yum install redis
</code></pre>
<p>If you are running Arch Linux, just run:</p>
<pre class="code bash"><code class="bash">$ sudo pacman -S redis
$ sudo systemctl start redis
</code></pre>
<p>FreeBSD users will have to run the following:</p>
<pre class="code bash"><code class="bash"># portmaster databases/redis
</code></pre>
<h3>Active Storage Setup</h3>
<p>When working on Active Storage, it is important to note that you need to
install its JavaScript dependencies while working on that section of the
codebase. In order to install these dependencies, it is necessary to
have Yarn, a Node.js package manager, available on your system. A
prerequisite for installing this package manager is that
<a href="https://nodejs.org" target="_parent" title="Node.js">Node.js</a> is installed.</p>
<p>On macOS, you can run:</p>
<pre class="code bash"><code class="bash">brew install yarn
</code></pre>
<p>On Ubuntu, you can run:</p>
<pre class="code bash"><code class="bash">curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
echo &quot;deb https://dl.yarnpkg.com/debian/ stable main&quot; | sudo tee /etc/apt/sources.list.d/yarn.list

sudo apt-get update &amp;&amp; sudo apt-get install yarn
</code></pre>
<p>On Fedora or CentOS, just run:</p>
<pre class="code bash"><code class="bash">sudo wget https://dl.yarnpkg.com/rpm/yarn.repo -O /etc/yum.repos.d/yarn.repo

sudo yum install yarn
</code></pre>
<p>Finally, after installing Yarn, you will need to run the following
command inside of the <code>activestorage</code> directory to install the dependencies:</p>
<pre class="code bash"><code class="bash">yarn install
</code></pre>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>