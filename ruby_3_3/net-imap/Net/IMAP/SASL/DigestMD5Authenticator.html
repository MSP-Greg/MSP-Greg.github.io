<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Net::IMAP::SASL::DigestMD5Authenticator &mdash; net-imap  Ruby-3.3.10 p183</title>

<link rel='stylesheet'  type='text/css' href='../../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Net::IMAP::SASL::DigestMD5Authenticator",
    relpath = '../../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../../'>Ruby-3.3.10</a> &raquo; 
      <a href='../../../'>net-imap</a> &raquo; 
      <a href='../../../_index.html#alpha_D'>Index (D)</a> &raquo; 
        <a href="../../../Net.html" title="Net (module)">Net</a> &raquo; 
        <a href="../../IMAP.html" title="Net::IMAP (class)">IMAP</a> &raquo; 
        <a href="../SASL.html" title="Net::IMAP::SASL (module)">SASL</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>DigestMD5Authenticator&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Net::IMAP::SASL::DigestMD5Authenticator</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L11'>lib/net/imap/sasl/digest_md5_authenticator.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../../IMAP.html" title="Net::IMAP (class)"><code>::Net::IMAP</code></a> authenticator for the “‘DIGEST-MD5`” <a href="../SASL.html" title="Net::IMAP::SASL (module)"><code>::Net::IMAP::SASL</code></a> mechanism type, specified in <a href="https://tools.ietf.org/html/rfc2831">RFC-2831</a>.  See <a href="../../IMAP.html#authenticate-instance_method" title="Net::IMAP#authenticate (method)">Net::IMAP#authenticate</a>.</p>

<h3 id="label-Deprecated">Deprecated</h3>

<p>“<code>DIGEST-MD5</code>” has been deprecated by <a href="https://tools.ietf.org/html/rfc6331">RFC-6331</a> and should not be relied on for security.  It is included for compatibility with existing servers.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='STAGE_DONE-constant' class='summary_signature priv'>STAGE_DONE =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L14-L14'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 14</a>    <pre class='code ruby'><span class='symbeg'>:</span><span class='id identifier rubyid_stage_done'>stage_done</span></pre>
  </li>
  <li>
    <span id='STAGE_ONE-constant' class='summary_signature priv'>STAGE_ONE =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L12-L12'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 12</a>    <pre class='code ruby'><span class='symbeg'>:</span><span class='id identifier rubyid_stage_one'>stage_one</span></pre>
  </li>
  <li>
    <span id='STAGE_TWO-constant' class='summary_signature priv'>STAGE_TWO =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L13-L13'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 13</a>    <pre class='code ruby'><span class='symbeg'>:</span><span class='id identifier rubyid_stage_two'>stage_two</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(username, password, authzid = nil, **options)  &#x21d2; authenticator </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates an Authenticator for the “<code>DIGEST-MD5</code>” <a href="../SASL.html" title="Net::IMAP::SASL (module)"><code>::Net::IMAP::SASL</code></a> mechanism.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#authcid-instance_method" title="#authcid (instance method)">#<strong>authcid</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">#username</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#authzid-instance_method" title="#authzid (instance method)">#<strong>authzid</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Authorization identity: an identity to act as or on behalf of.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#done%3F-instance_method" title="#done? (instance method)">#<strong>done?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#initial_response%3F-instance_method" title="#initial_response? (instance method)">#<strong>initial_response?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#password-instance_method" title="#password (instance method)">#<strong>password</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>A password or passphrase that matches the <a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">#username</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#username-instance_method" title="#username (instance method)">#<strong>username</strong>  </a>
      (also: #authcid)
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Authentication identity: the identity that matches the <a href="#password-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#password (method)">#password</a>.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#process-instance_method" title="#process (instance method)">#<strong>process</strong>(challenge)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Responds to server challenge in two stages.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#nc-instance_method" title="#nc (instance method)">#<strong>nc</strong>(nonce)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#qdval-instance_method" title="#qdval (instance method)">#<strong>qdval</strong>(k, v)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>some responses need quoting.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    <div class='inline-block'>
      <span class='overload'>.<strong>new</strong>(username, password, authzid = nil, **options)  &#x21d2; <a href="../SASL.html#authenticator-class_method" title="Net::IMAP::SASL.authenticator (method)">authenticator</a> </span>
      <span class='overload'>.<strong>new</strong>(username:, password:, authzid:  nil, **options)  &#x21d2; <a href="../SASL.html#authenticator-class_method" title="Net::IMAP::SASL.authenticator (method)">authenticator</a> </span>
      <span class='overload'>.<strong>new</strong>(authcid:, password:, authzid:  nil, **options)  &#x21d2; <a href="../SASL.html#authenticator-class_method" title="Net::IMAP::SASL.authenticator (method)">authenticator</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates an Authenticator for the “<code>DIGEST-MD5</code>” <a href="../SASL.html" title="Net::IMAP::SASL (module)"><code>::Net::IMAP::SASL</code></a> mechanism.</p>

<p>Called by <a href="../../IMAP.html#authenticate-instance_method" title="Net::IMAP#authenticate (method)">Net::IMAP#authenticate</a> and similar methods on other clients.</p>

<h4 id="label-Parameters">Parameters</h4>
<ul><li>
<p><a href="#authcid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authcid (method)">#authcid</a>  ― Authentication identity that is associated with <a href="#password-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#password (method)">#password</a>.</p>

<p>#username ― An alias for <a href="#authcid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authcid (method)">#authcid</a>.</p>
</li><li>
<p><a href="#password-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#password (method)">#password</a> ― A password or passphrase associated with this <a href="#authcid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authcid (method)">#authcid</a>.</p>
</li><li>
<p><em>optional</em> <a href="#authzid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authzid (method)">#authzid</a>  ― Authorization identity to act as or on behalf of.</p>

<p>When <a href="#authzid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authzid (method)">#authzid</a> is not set, the server should derive the authorization identity from the authentication identity.</p>
</li><li>
<p><em>optional</em> <code>warn_deprecation</code> — Set to <code>false</code> to silence the warning.</p>
</li></ul>

<p>Any other keyword arguments are silently ignored.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L70-L86'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='70' data-end='86'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 70</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'><a href="../DeprecatedClientOptions.html#initialize-instance_method" title="Net::IMAP::DeprecatedClientOptions#initialize (method)">initialize</a></span>(<span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_pass'>pass</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_authz'>authz</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span>
               <span class='label'>username:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>password:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>authzid:</span> <span class='kw'>nil</span><span class='comma'>,</span>
               <span class='label'>authcid:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>secret:</span> <span class='kw'>nil</span><span class='comma'>,</span>
               <span class='label'>warn_deprecation:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>**</span>)
  <span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">username</a></span> <span class='op'>=</span> <span class='id identifier rubyid_authcid'><a href="#authcid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authcid (method)">authcid</a></span> <span class='op'>||</span> <span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">username</a></span> <span class='op'>||</span> <span class='id identifier rubyid_user'>user</span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>missing username (authcid)</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_password'><a href="#password-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#password (method)">password</a></span> <span class='op'>||=</span> <span class='id identifier rubyid_secret'>secret</span> <span class='op'>||</span> <span class='id identifier rubyid_pass'>pass</span> <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>missing password</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_authzid'><a href="#authzid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authzid (method)">authzid</a></span>  <span class='op'>||=</span> <span class='id identifier rubyid_authz'>authz</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_warn_deprecation'>warn_deprecation</span>
    <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>WARNING: DIGEST-MD5 SASL mechanism was deprecated by RFC6331.</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># TODO: recommend SCRAM instead.
</span>  <span class='kw'>end</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>digest/md5</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>strscan</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@username</span><span class='comma'>,</span> <span class='ivar'>@password</span><span class='comma'>,</span> <span class='ivar'>@authzid</span> <span class='op'>=</span> <span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">username</a></span><span class='comma'>,</span> <span class='id identifier rubyid_password'><a href="#password-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#password (method)">password</a></span><span class='comma'>,</span> <span class='id identifier rubyid_authzid'><a href="#authzid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authzid (method)">authzid</a></span>
  <span class='ivar'>@nc</span><span class='comma'>,</span> <span class='ivar'>@stage</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='const'><a href="#STAGE_ONE-constant" title="Net::IMAP::SASL::DigestMD5Authenticator::STAGE_ONE (constant)">STAGE_ONE</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="authcid-instance_method">
  <h3 class='signature ro first'>
    #<strong>authcid</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">#username</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L25-L25'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='25' data-end='25'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 25</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_authcid'>authcid</span> <span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">username</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="authzid-instance_method">
  <h3 class='signature ro'>
    #<strong>authzid</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Authorization identity: an identity to act as or on behalf of.  The identity form is application protocol specific.  If not provided or left blank, the server derives an authorization identity from the authentication identity. The server is responsible for verifying the client’s credentials and verifying that the identity it associates with the client’s authentication identity is allowed to act as (or on behalf of) the authorization identity.</p>

<p>For example, an administrator or superuser might take on another role:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_imap'>imap</span>.<span class='id identifier rubyid_authenticate'><a href="../../IMAP.html#authenticate-instance_method" title="Net::IMAP#authenticate (method)">authenticate</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DIGEST-MD5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>root</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='tlambeg'>{</span><span class='id identifier rubyid_passwd'>passwd</span>}<span class='comma'>,</span> <span class='label'>authzid:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user</span><span class='tstring_end'>&quot;</span></span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L43-L43'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='43' data-end='43'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 43</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_authzid'>authzid</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="done?-instance_method">
  <h3 class='signature ro'>
    #<strong>done?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L156-L156'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='156' data-end='156'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 156</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_done?'>done?</span><span class='semicolon'>;</span> <span class='ivar'>@stage</span> <span class='op'>==</span> <span class='const'><a href="#STAGE_DONE-constant" title="Net::IMAP::SASL::DigestMD5Authenticator::STAGE_DONE (constant)">STAGE_DONE</a></span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initial_response?-instance_method">
  <h3 class='signature ro'>
    #<strong>initial_response?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L88-L88'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='88' data-end='88'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 88</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initial_response?'>initial_response?</span><span class='semicolon'>;</span> <span class='kw'>false</span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="password-instance_method">
  <h3 class='signature ro'>
    #<strong>password</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A password or passphrase that matches the <a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">#username</a>.</p>

<p>The <code>password</code> will be used to create the response digest.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L30-L30'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='30' data-end='30'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 30</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_password'>password</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="username-instance_method">
  <h3 class='signature ro'>
    #<strong>username</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>#authcid</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Authentication identity: the identity that matches the <a href="#password-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#password (method)">#password</a>.</p>

<p><a href="https://tools.ietf.org/html/rfc2831">RFC-2831</a> uses the term <code>username</code>. “Authentication identity” is the generic term used by <a href="https://tools.ietf.org/html/rfc4422">RFC-4422</a>. <a href="https://tools.ietf.org/html/rfc4616">RFC-4616</a> and many later RFCs abbreviate this to <a href="#authcid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authcid (method)">#authcid</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L24-L24'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='24' data-end='24'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 24</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_username'>username</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="nc-instance_method">
  <h3 class='signature priv first'>
    #<strong>nc</strong>(nonce)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L160-L167'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='160' data-end='167'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 160</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_nc'>nc</span>(<span class='id identifier rubyid_nonce'>nonce</span>)
  <span class='kw'>if</span> <span class='ivar'>@nc</span>.<span class='id identifier rubyid_has_key?'>has_key?</span> <span class='id identifier rubyid_nonce'>nonce</span>
    <span class='ivar'>@nc</span>[<span class='id identifier rubyid_nonce'>nonce</span>] <span class='op'>=</span> <span class='ivar'>@nc</span>[<span class='id identifier rubyid_nonce'>nonce</span>] <span class='op'>+</span> <span class='int'>1</span>
  <span class='kw'>else</span>
    <span class='ivar'>@nc</span>[<span class='id identifier rubyid_nonce'>nonce</span>] <span class='op'>=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='ivar'>@nc</span>[<span class='id identifier rubyid_nonce'>nonce</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process-instance_method">
  <h3 class='signature '>
    #<strong>process</strong>(challenge)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Responds to server challenge in two stages.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L91-L154'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='91' data-end='154'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 91</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process'>process</span>(<span class='id identifier rubyid_challenge'>challenge</span>)
  <span class='kw'>case</span> <span class='ivar'>@stage</span>
  <span class='kw'>when</span> <span class='const'><a href="#STAGE_ONE-constant" title="Net::IMAP::SASL::DigestMD5Authenticator::STAGE_ONE (constant)">STAGE_ONE</a></span>
    <span class='ivar'>@stage</span> <span class='op'>=</span> <span class='const'><a href="#STAGE_TWO-constant" title="Net::IMAP::SASL::DigestMD5Authenticator::STAGE_TWO (constant)">STAGE_TWO</a></span>
    <span class='id identifier rubyid_sparams'>sparams</span> <span class='op'>=</span> {}
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'>StringScanner</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Net::IMAP::SASL::DigestMD5Authenticator.new (method)">new</a></span>(<span class='id identifier rubyid_challenge'>challenge</span>)
    <span class='kw'>while</span> <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(?:\s*,)?\s*(\w)=(&quot;(?:[^\\&quot;]|\\.)*&quot;|[^,])\s*</span><span class='regexp_end'>/</span></span>)
      <span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>[<span class='int'>1</span>]<span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span>[<span class='int'>2</span>]
      <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^&quot;(.*)&quot;$</span><span class='regexp_end'>/</span></span>
        <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='backref'>$1</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span>
          <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>)
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_sparams'>sparams</span>[<span class='id identifier rubyid_k'>k</span>] <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../../Net.html" title="Net (module)">Net</a></span><span class='op'>::</span><span class='const'><a href="../../IMAP.html" title="Net::IMAP (class)">IMAP</a></span><span class='op'>::</span><span class='const'><a href="../DataFormatError.html" title="Net::IMAP::DataFormatError (class)">DataFormatError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bad Challenge: &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_challenge'>challenge</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_eos?'>eos?</span> <span class='kw'>and</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>qop</span><span class='tstring_end'>&#39;</span></span>]
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../../Net.html" title="Net (module)">Net</a></span><span class='op'>::</span><span class='const'><a href="../../IMAP.html" title="Net::IMAP (class)">IMAP</a></span><span class='op'>::</span><span class='const'><a href="../Error.html" title="Net::IMAP::Error (class)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Server does not support auth (qop = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>qop</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>)<span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>qop</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>auth</span><span class='tstring_end'>&quot;</span></span>)

    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> {
      <span class='symbeg'>:</span><span class='id identifier rubyid_nonce'>nonce</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nonce</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">username</a></span> <span class='op'>=&gt;</span> <span class='ivar'>@username</span><span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_realm'>realm</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>realm</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_cnonce'>cnonce</span> <span class='op'>=&gt;</span> <span class='const'>Digest</span><span class='op'>::</span><span class='const'>MD5</span>.<span class='id identifier rubyid_hexdigest'>hexdigest</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.15f:%.15f:%d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_to_f'>to_f</span><span class='comma'>,</span> <span class='id identifier rubyid_rand'>rand</span><span class='comma'>,</span> <span class='const'>Process</span>.<span class='id identifier rubyid_pid'>pid</span>.<span class='id identifier rubyid_to_s'>to_s</span>])<span class='comma'>,</span>
      <span class='symbeg'>:&#39;</span><span class='tstring_content'>digest-uri</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>imap/</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>realm</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_qop'>qop</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>auth</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_maxbuf'>maxbuf</span> <span class='op'>=&gt;</span> <span class='int'>65535</span><span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_nc'><a href="#nc-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#nc (method)">nc</a></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%08d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_nc'><a href="#nc-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#nc (method)">nc</a></span>(<span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nonce</span><span class='tstring_end'>&#39;</span></span>])<span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_charset'>charset</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>charset</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span>
    }

    <span class='id identifier rubyid_response'>response</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_authzid'><a href="#authzid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authzid (method)">authzid</a></span>] <span class='op'>=</span> <span class='ivar'>@authzid</span> <span class='kw'>unless</span> <span class='ivar'>@authzid</span>.<span class='id identifier rubyid_nil?'>nil?</span>

    <span class='comment'># now, the real thing
</span>    <span class='id identifier rubyid_a0'>a0</span> <span class='op'>=</span> <span class='const'>Digest</span><span class='op'>::</span><span class='const'>MD5</span>.<span class='id identifier rubyid_digest'>digest</span>( [ <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_values_at'>values_at</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#username (method)">username</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_realm'>realm</span>)<span class='comma'>,</span> <span class='ivar'>@password</span> ].<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span>) )

    <span class='id identifier rubyid_a1'>a1</span> <span class='op'>=</span> [ <span class='id identifier rubyid_a0'>a0</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_values_at'>values_at</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_nonce'>nonce</span><span class='comma'>,</span><span class='symbeg'>:</span><span class='id identifier rubyid_cnonce'>cnonce</span>) ].<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span>)
    <span class='id identifier rubyid_a1'>a1</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_response'>response</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_authzid'><a href="#authzid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authzid (method)">authzid</a></span>] <span class='kw'>unless</span> <span class='id identifier rubyid_response'>response</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_authzid'><a href="#authzid-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#authzid (method)">authzid</a></span>].<span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_a2'>a2</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AUTHENTICATE:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_response'>response</span>[<span class='symbeg'>:&#39;</span><span class='tstring_content'>digest-uri</span><span class='tstring_end'>&#39;</span></span>]
    <span class='id identifier rubyid_a2'>a2</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:00000000000000000000000000000000</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_qop'>qop</span>] <span class='kw'>and</span> <span class='id identifier rubyid_response'>response</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_qop'>qop</span>] <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^auth-(?:conf|int)$</span><span class='regexp_end'>/</span></span>

    <span class='id identifier rubyid_response'>response</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_response'>response</span>] <span class='op'>=</span> <span class='const'>Digest</span><span class='op'>::</span><span class='const'>MD5</span>.<span class='id identifier rubyid_hexdigest'>hexdigest</span>(
      [
        <span class='const'>Digest</span><span class='op'>::</span><span class='const'>MD5</span>.<span class='id identifier rubyid_hexdigest'>hexdigest</span>(<span class='id identifier rubyid_a1'>a1</span>)<span class='comma'>,</span>
        <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_values_at'>values_at</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_nonce'>nonce</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_nc'><a href="#nc-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#nc (method)">nc</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_cnonce'>cnonce</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_qop'>qop</span>)<span class='comma'>,</span>
        <span class='const'>Digest</span><span class='op'>::</span><span class='const'>MD5</span>.<span class='id identifier rubyid_hexdigest'>hexdigest</span>(<span class='id identifier rubyid_a2'>a2</span>)
      ].<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span>)
    )

    <span class='kw'>return</span> <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span> <span class='id identifier rubyid_qdval'><a href="#qdval-instance_method" title="Net::IMAP::SASL::DigestMD5Authenticator#qdval (method)">qdval</a></span>(<span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span>[<span class='id identifier rubyid_key'>key</span>]) }.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>when</span> <span class='const'><a href="#STAGE_TWO-constant" title="Net::IMAP::SASL::DigestMD5Authenticator::STAGE_TWO (constant)">STAGE_TWO</a></span>
    <span class='ivar'>@stage</span> <span class='op'>=</span> <span class='const'><a href="#STAGE_DONE-constant" title="Net::IMAP::SASL::DigestMD5Authenticator::STAGE_DONE (constant)">STAGE_DONE</a></span>
    <span class='comment'># if at the second stage, return an empty string
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_challenge'>challenge</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>rspauth=</span><span class='regexp_end'>/</span></span>
      <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../ResponseParseError.html" title="Net::IMAP::ResponseParseError (class)">ResponseParseError</a></span><span class='comma'>,</span> <span class='id identifier rubyid_challenge'>challenge</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../ResponseParseError.html" title="Net::IMAP::ResponseParseError (class)">ResponseParseError</a></span><span class='comma'>,</span> <span class='id identifier rubyid_challenge'>challenge</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="qdval-instance_method">
  <h3 class='signature priv'>
    #<strong>qdval</strong>(k, v)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>some responses need quoting</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.21/lib/net/imap/sasl/digest_md5_authenticator.rb#L170-L178'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='170' data-end='178'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/digest_md5_authenticator.rb', line 170</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_qdval'>qdval</span>(<span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_v'>v</span>.<span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>if</span> <span class='qwords'><span class='qwords_beg'>%w&quot;</span><span class='tstring_content'>username</span><span class='words_sep'> </span><span class='tstring_content'>authzid</span><span class='words_sep'> </span><span class='tstring_content'>realm</span><span class='words_sep'> </span><span class='tstring_content'>nonce</span><span class='words_sep'> </span><span class='tstring_content'>cnonce</span><span class='words_sep'> </span><span class='tstring_content'>digest-uri</span><span class='words_sep'> </span><span class='tstring_content'>qop</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span>
    <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>([\\&quot;])</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\1</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%s=&quot;%s&quot;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>]
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%s=%s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>