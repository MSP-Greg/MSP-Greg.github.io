<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Process::UID &mdash; Core Ruby-3.3.1 p55</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Process::UID",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Ruby-3.3.1</a> &raquo; 
      <a href='../'>Core</a> &raquo; 
      <a href='../_index.html#alpha_U'>Index (U)</a> &raquo; 
        <a href="../Process.html" title="Process (module)">Process</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>UID&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Process::UID</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L9530'>process.c</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>The <code>UID</code> module contains a collection of module functions which can be used to portably get, set, and switch the current process’s real, effective, and saved user IDs.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#eid-class_method" title="eid (class method)">.<strong>eid</strong>  &#x21d2; Integer </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="../Process.html#euid-class_method" title="Process.euid (method)">euid</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#re_exchangeable%3F-class_method" title="re_exchangeable? (class method)">.<strong>re_exchangeable?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns <code>true</code> if the real and effective user IDs of a process may be exchanged on the current platform.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#rid-class_method" title="rid (class method)">.<strong>rid</strong>  &#x21d2; Integer </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="../Process.html#uid-class_method" title="Process.uid (method)">uid</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#sid_available%3F-class_method" title="sid_available? (class method)">.<strong>sid_available?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns <code>true</code> if the current platform has saved user ID functionality.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature mf'>
      <a href="#change_privilege-class_method" title="change_privilege (class method)">.<strong>change_privilege</strong>(user)  &#x21d2; Integer </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Change the current process’s real and effective user ID to that specified by <em>user</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#from_name-class_method" title="from_name (class method)">.<strong>from_name</strong>(name)  &#x21d2; UID </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the user ID by the <em>name</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#grant_privilege-class_method" title="grant_privilege (class method)">.<strong>grant_privilege</strong>(user)  &#x21d2; Integer </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the effective user ID, and if possible, the saved user ID of the process to the given <em>user</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#re_exchange-class_method" title="re_exchange (class method)">.<strong>re_exchange</strong>  &#x21d2; Integer </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Exchange real and effective user IDs and return the new effective user ID.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#switch-class_method" title="switch (class method)">.<strong>switch</strong>  &#x21d2; Integer </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Switch the effective and real user IDs of the current process.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->
<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="eid-class_method">
  <h3 class='signature ro  private first'>
    .<strong>eid</strong>  &#x21d2; <a href="../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="../Process.html#euid-class_method" title="Process.euid (method)">Process.euid</a>.</p>

  </div>
</div>

</section>

<section class='method_details' id="re_exchangeable?-class_method">
  <h3 class='signature ro  private'>
    .<strong>re_exchangeable?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns <code>true</code> if the real and effective user IDs of a process may be exchanged on the current platform.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L7491-L7501'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='7491' data-end='7501'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'process.c', line 7491</span></pre>
<pre class='code cpp'>

static VALUE
p_uid_exchangeable(VALUE _)
{
#if defined(HAVE_SETRESUID)
    return Qtrue;
#elif defined(HAVE_SETREUID) &amp;&amp; !defined(OBSOLETE_SETREUID)
    return Qtrue;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rid-class_method">
  <h3 class='signature ro  private'>
    .<strong>rid</strong>  &#x21d2; <a href="../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="../Process.html#uid-class_method" title="Process.uid (method)">Process.uid</a>.</p>

  </div>
</div>

</section>

<section class='method_details' id="sid_available?-class_method">
  <h3 class='signature ro  private'>
    .<strong>sid_available?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns <code>true</code> if the current platform has saved user ID functionality.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L7616-L7624'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='7616' data-end='7624'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'process.c', line 7616</span></pre>
<pre class='code cpp'>

static VALUE
p_uid_have_saved_id(VALUE _)
{
#if defined(HAVE_SETRESUID) || defined(HAVE_SETEUID) || defined(_POSIX_SAVED_IDS)
    return Qtrue;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="change_privilege-class_method">
  <h3 class='signature private first'>
    .<strong>change_privilege</strong>(user)  &#x21d2; <a href="../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Change the current process’s real and effective user ID to that specified by <em>user</em>. Returns the new user ID. Not available on all platforms.</p>

<pre class="code ruby"><code class="ruby">[<span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_uid'><a href="../Process.html#uid-class_method" title="Process.uid (method)">uid</a></span><span class='comma'>,</span> <span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_euid'><a href="../Process.html#euid-class_method" title="Process.euid (method)">euid</a></span>]          <span class='comment'>#=&gt; [0, 0]
</span><span class='const'><a href="../Process.html" title="Process (module)">Process</a></span><span class='op'>::</span><span class='const'>UID</span>.<span class='id identifier rubyid_change_privilege'>change_privilege</span>(<span class='int'>31</span>)    <span class='comment'>#=&gt; 31
</span>[<span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_uid'><a href="../Process.html#uid-class_method" title="Process.uid (method)">uid</a></span><span class='comma'>,</span> <span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_euid'><a href="../Process.html#euid-class_method" title="Process.euid (method)">euid</a></span>]          <span class='comment'>#=&gt; [31, 31]</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L6355-L6507'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='6355' data-end='6507'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'process.c', line 6355</span></pre>
<pre class='code cpp'>

static VALUE
p_uid_change_privilege(VALUE obj, VALUE id)
{
    rb_uid_t uid;

    check_uid_switch();

    uid = OBJ2UID(id);

    if (geteuid() == 0) { /* root-user */
#if defined(HAVE_SETRESUID)
        if (setresuid(uid, uid, uid) &lt; 0) rb_sys_fail(0);
        SAVED_USER_ID = uid;
#elif defined(HAVE_SETUID)
        if (setuid(uid) &lt; 0) rb_sys_fail(0);
        SAVED_USER_ID = uid;
#elif defined(HAVE_SETREUID) &amp;&amp; !defined(OBSOLETE_SETREUID)
        if (getuid() == uid) {
            if (SAVED_USER_ID == uid) {
                if (setreuid(-1, uid) &lt; 0) rb_sys_fail(0);
            }
            else {
                if (uid == 0) { /* (r,e,s) == (root, root, x) */
                    if (setreuid(-1, SAVED_USER_ID) &lt; 0) rb_sys_fail(0);
                    if (setreuid(SAVED_USER_ID, 0) &lt; 0) rb_sys_fail(0);
                    SAVED_USER_ID = 0; /* (r,e,s) == (x, root, root) */
                    if (setreuid(uid, uid) &lt; 0) rb_sys_fail(0);
                    SAVED_USER_ID = uid;
                }
                else {
                    if (setreuid(0, -1) &lt; 0) rb_sys_fail(0);
                    SAVED_USER_ID = 0;
                    if (setreuid(uid, uid) &lt; 0) rb_sys_fail(0);
                    SAVED_USER_ID = uid;
                }
            }
        }
        else {
            if (setreuid(uid, uid) &lt; 0) rb_sys_fail(0);
            SAVED_USER_ID = uid;
        }
#elif defined(HAVE_SETRUID) &amp;&amp; defined(HAVE_SETEUID)
        if (getuid() == uid) {
            if (SAVED_USER_ID == uid) {
                if (seteuid(uid) &lt; 0) rb_sys_fail(0);
            }
            else {
                if (uid == 0) {
                    if (setruid(SAVED_USER_ID) &lt; 0) rb_sys_fail(0);
                    SAVED_USER_ID = 0;
                    if (setruid(0) &lt; 0) rb_sys_fail(0);
                }
                else {
                    if (setruid(0) &lt; 0) rb_sys_fail(0);
                    SAVED_USER_ID = 0;
                    if (seteuid(uid) &lt; 0) rb_sys_fail(0);
                    if (setruid(uid) &lt; 0) rb_sys_fail(0);
                    SAVED_USER_ID = uid;
                }
            }
        }
        else {
            if (seteuid(uid) &lt; 0) rb_sys_fail(0);
            if (setruid(uid) &lt; 0) rb_sys_fail(0);
            SAVED_USER_ID = uid;
        }
#else
        (void)uid;
        rb_notimplement();
#endif
    }
    else { /* unprivileged user */
#if defined(HAVE_SETRESUID)
        if (setresuid((getuid() == uid)? (rb_uid_t)-1: uid,
                      (geteuid() == uid)? (rb_uid_t)-1: uid,
                      (SAVED_USER_ID == uid)? (rb_uid_t)-1: uid) &lt; 0) rb_sys_fail(0);
        SAVED_USER_ID = uid;
#elif defined(HAVE_SETREUID) &amp;&amp; !defined(OBSOLETE_SETREUID)
        if (SAVED_USER_ID == uid) {
            if (setreuid((getuid() == uid)? (rb_uid_t)-1: uid,
                         (geteuid() == uid)? (rb_uid_t)-1: uid) &lt; 0)
                rb_sys_fail(0);
        }
        else if (getuid() != uid) {
            if (setreuid(uid, (geteuid() == uid)? (rb_uid_t)-1: uid) &lt; 0)
                rb_sys_fail(0);
            SAVED_USER_ID = uid;
        }
        else if (/* getuid() == uid &amp;&amp; */ geteuid() != uid) {
            if (setreuid(geteuid(), uid) &lt; 0) rb_sys_fail(0);
            SAVED_USER_ID = uid;
            if (setreuid(uid, -1) &lt; 0) rb_sys_fail(0);
        }
        else { /* getuid() == uid &amp;&amp; geteuid() == uid */
            if (setreuid(-1, SAVED_USER_ID) &lt; 0) rb_sys_fail(0);
            if (setreuid(SAVED_USER_ID, uid) &lt; 0) rb_sys_fail(0);
            SAVED_USER_ID = uid;
            if (setreuid(uid, -1) &lt; 0) rb_sys_fail(0);
        }
#elif defined(HAVE_SETRUID) &amp;&amp; defined(HAVE_SETEUID)
        if (SAVED_USER_ID == uid) {
            if (geteuid() != uid &amp;&amp; seteuid(uid) &lt; 0) rb_sys_fail(0);
            if (getuid() != uid &amp;&amp; setruid(uid) &lt; 0) rb_sys_fail(0);
        }
        else if (/* SAVED_USER_ID != uid &amp;&amp; */ geteuid() == uid) {
            if (getuid() != uid) {
                if (setruid(uid) &lt; 0) rb_sys_fail(0);
                SAVED_USER_ID = uid;
            }
            else {
                if (setruid(SAVED_USER_ID) &lt; 0) rb_sys_fail(0);
                SAVED_USER_ID = uid;
                if (setruid(uid) &lt; 0) rb_sys_fail(0);
            }
        }
        else if (/* geteuid() != uid &amp;&amp; */ getuid() == uid) {
            if (seteuid(uid) &lt; 0) rb_sys_fail(0);
            if (setruid(SAVED_USER_ID) &lt; 0) rb_sys_fail(0);
            SAVED_USER_ID = uid;
            if (setruid(uid) &lt; 0) rb_sys_fail(0);
        }
        else {
            rb_syserr_fail(EPERM, 0);
        }
#elif defined HAVE_44BSD_SETUID
        if (getuid() == uid) {
            /* (r,e,s)==(uid,?,?) ==&gt; (uid,uid,uid) */
            if (setuid(uid) &lt; 0) rb_sys_fail(0);
            SAVED_USER_ID = uid;
        }
        else {
            rb_syserr_fail(EPERM, 0);
        }
#elif defined HAVE_SETEUID
        if (getuid() == uid &amp;&amp; SAVED_USER_ID == uid) {
            if (seteuid(uid) &lt; 0) rb_sys_fail(0);
        }
        else {
            rb_syserr_fail(EPERM, 0);
        }
#elif defined HAVE_SETUID
        if (getuid() == uid &amp;&amp; SAVED_USER_ID == uid) {
            if (setuid(uid) &lt; 0) rb_sys_fail(0);
        }
        else {
            rb_syserr_fail(EPERM, 0);
        }
#else
        rb_notimplement();
#endif
    }
    return id;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="from_name-class_method">
  <h3 class='signature private'>
    .<strong>from_name</strong>(name)  &#x21d2; <code>UID</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the user ID by the <em>name</em>. If the user is not found, <a href="../ArgumentError.html" title="ArgumentError (class)"><code>::ArgumentError</code></a> will be raised.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="../Process.html" title="Process (module)">Process</a></span><span class='op'>::</span><span class='const'>UID</span>.<span class='id identifier rubyid_from_name'>from_name</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>root</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'>#=&gt; 0
</span><span class='const'><a href="../Process.html" title="Process (module)">Process</a></span><span class='op'>::</span><span class='const'>UID</span>.<span class='id identifier rubyid_from_name'>from_name</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>nosuchuser</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'>#=&gt; can&#39;t find user for nosuchuser (ArgumentError)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L6040-L6044'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='6040' data-end='6044'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'process.c', line 6040</span></pre>
<pre class='code cpp'>

static VALUE
p_uid_from_name(VALUE self, VALUE id)
{
    return UIDT2NUM(OBJ2UID(id));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="grant_privilege-class_method">
  <h3 class='signature private'>
    <div class='inline-block'>
      <span class='overload'>.<strong>grant_privilege</strong>(user)  &#x21d2; <a href="../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span></span>
      <span class='overload'>.<strong>eid=</strong>(user)  &#x21d2; <a href="../Integer.html" title="Integer (class)">Integer</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Set the effective user ID, and if possible, the saved user ID of the process to the given <em>user</em>. Returns the new effective user ID. Not available on all platforms.</p>

<pre class="code ruby"><code class="ruby">[<span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_uid'><a href="../Process.html#uid-class_method" title="Process.uid (method)">uid</a></span><span class='comma'>,</span> <span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_euid'><a href="../Process.html#euid-class_method" title="Process.euid (method)">euid</a></span>]          <span class='comment'>#=&gt; [0, 0]
</span><span class='const'><a href="../Process.html" title="Process (module)">Process</a></span><span class='op'>::</span><span class='const'>UID</span>.<span class='id identifier rubyid_grant_privilege'>grant_privilege</span>(<span class='int'>31</span>)     <span class='comment'>#=&gt; 31
</span>[<span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_uid'><a href="../Process.html#uid-class_method" title="Process.uid (method)">uid</a></span><span class='comma'>,</span> <span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_euid'><a href="../Process.html#euid-class_method" title="Process.euid (method)">euid</a></span>]          <span class='comment'>#=&gt; [0, 31]</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L7342-L7347'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='7342' data-end='7347'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'process.c', line 7342</span></pre>
<pre class='code cpp'>

static VALUE
p_uid_grant_privilege(VALUE obj, VALUE id)
{
    rb_seteuid_core(OBJ2UID(id));
    return id;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="re_exchange-class_method">
  <h3 class='signature private'>
    .<strong>re_exchange</strong>  &#x21d2; <a href="../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Exchange real and effective user IDs and return the new effective user ID. Not available on all platforms.</p>

<pre class="code ruby"><code class="ruby">[<span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_uid'><a href="../Process.html#uid-class_method" title="Process.uid (method)">uid</a></span><span class='comma'>,</span> <span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_euid'><a href="../Process.html#euid-class_method" title="Process.euid (method)">euid</a></span>]   <span class='comment'>#=&gt; [0, 31]
</span><span class='const'><a href="../Process.html" title="Process (module)">Process</a></span><span class='op'>::</span><span class='const'>UID</span>.<span class='id identifier rubyid_re_exchange'>re_exchange</span>      <span class='comment'>#=&gt; 0
</span>[<span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_uid'><a href="../Process.html#uid-class_method" title="Process.uid (method)">uid</a></span><span class='comma'>,</span> <span class='const'><a href="../Process.html" title="Process (module)">Process</a></span>.<span class='id identifier rubyid_euid'><a href="../Process.html#euid-class_method" title="Process.euid (method)">euid</a></span>]   <span class='comment'>#=&gt; [31, 0]</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L7516-L7541'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='7516' data-end='7541'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'process.c', line 7516</span></pre>
<pre class='code cpp'>

static VALUE
p_uid_exchange(VALUE obj)
{
    rb_uid_t uid;
#if defined(HAVE_SETRESUID) || (defined(HAVE_SETREUID) &amp;&amp; !defined(OBSOLETE_SETREUID))
    rb_uid_t euid;
#endif

    check_uid_switch();

    uid = getuid();
#if defined(HAVE_SETRESUID) || (defined(HAVE_SETREUID) &amp;&amp; !defined(OBSOLETE_SETREUID))
    euid = geteuid();
#endif

#if defined(HAVE_SETRESUID)
    if (setresuid(euid, uid, uid) &lt; 0) rb_sys_fail(0);
    SAVED_USER_ID = uid;
#elif defined(HAVE_SETREUID) &amp;&amp; !defined(OBSOLETE_SETREUID)
    if (setreuid(euid,uid) &lt; 0) rb_sys_fail(0);
    SAVED_USER_ID = uid;
#else
    rb_notimplement();
#endif
    return UIDT2NUM(uid);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="switch-class_method">
  <h3 class='signature private'>
    <div class='inline-block'>
      <span class='overload'>.<strong>switch</strong>  &#x21d2; <a href="../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span></span>
      <span class='overload'>.<strong>switch</strong>  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Switch the effective and real user IDs of the current process. If a <em>block</em> is given, the user IDs will be switched back after the block is executed. Returns the new effective user ID if called without a block, and the return value of the block if one is given.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_3_1/process.c#L7651-L7686'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='7651' data-end='7686'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'process.c', line 7651</span></pre>
<pre class='code cpp'>

static VALUE
p_uid_switch(VALUE obj)
{
    rb_uid_t uid, euid;

    check_uid_switch();

    uid = getuid();
    euid = geteuid();

    if (uid != euid) {
        proc_seteuid(uid);
        if (rb_block_given_p()) {
            under_uid_switch = 1;
            return rb_ensure(rb_yield, Qnil, p_uid_sw_ensure, SAVED_USER_ID);
        }
        else {
            return UIDT2NUM(euid);
        }
    }
    else if (euid != SAVED_USER_ID) {
        proc_seteuid(SAVED_USER_ID);
        if (rb_block_given_p()) {
            under_uid_switch = 1;
            return rb_ensure(rb_yield, Qnil, p_uid_sw_ensure, euid);
        }
        else {
            return UIDT2NUM(uid);
        }
    }
    else {
        rb_syserr_fail(EPERM, 0);
    }

    UNREACHABLE_RETURN(Qnil);
}
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>