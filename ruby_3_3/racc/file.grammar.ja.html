<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Grammar.ja &mdash; racc  Ruby-3.3.10 p183</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "grammar.ja",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-3.3.10</a> &raquo; 
      <a href='.'>racc</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Grammar.ja&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>

<h1 id="label-E8-A6-8F-E5-89-87-E3-83-95-E3-82-A1-E3-82-A4-E3-83-AB-E6-96-87-E6-B3-95-E3-83-AA-E3-83-95-E3-82-A1-E3-83-AC-E3-83-B3-E3-82-B9">規則ファイル文法リファレンス</h1>

<h2 id="label-E6-96-87-E6-B3-95-E3-81-AB-E9-96-A2-E3-81-99-E3-82-8B-E5-89-8D-E3-83-90-E3-83-BC-E3-82-B8-E3-83-A7-E3-83-B3-E3-81-A8-E3-81-AE-E9-9D-9E-E4-BA-92-E6-8F-9B">文法に関する前バージョンとの非互換</h2>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> (<span class='float'>1.2</span>) <span class='id identifier rubyid_ユーザーコードを連結する時、外部ファイルよりも'>ユーザーコードを連結する時、外部ファイルよりも</span>
          <span class='id identifier rubyid_埋めこんであるコードを先に連結します。'>埋めこんであるコードを先に連結します。</span>
<span class='op'>*</span> (<span class='float'>1.1</span>) <span class='id identifier rubyid_新しいディレクティブ'>新しいディレクティブ</span> <span class='id identifier rubyid_options'>options</span> <span class='id identifier rubyid_が追加されました。'>が追加されました。</span>
<span class='op'>*</span> (<span class='float'>1.1</span>) <span class='id identifier rubyid_予約語'>予約語</span> <span class='id identifier rubyid_token'>token</span> <span class='id identifier rubyid_の意味が変更になりました。'>の意味が変更になりました。</span>
<span class='op'>*</span> (<span class='float'>0.14</span>) <span class='id identifier rubyid_ルールの最後のセミコロンが省略可能になりました。'>ルールの最後のセミコロンが省略可能になりました。</span>
         <span class='id identifier rubyid_また、token'>また、token</span> <span class='id identifier rubyid_prechigh'>prechigh</span> <span class='id identifier rubyid_などが予約語でなくなりました。'>などが予約語でなくなりました。</span>
<span class='op'>*</span> (<span class='float'>10.2</span>) <span class='id identifier rubyid_prepare'>prepare</span> <span class='id identifier rubyid_が'>が</span> <span class='id identifier rubyid_header'>header</span> <span class='id identifier rubyid_に'>に</span> <span class='id identifier rubyid_driver'>driver</span> <span class='id identifier rubyid_が'>が</span> <span class='id identifier rubyid_footer'>footer</span> <span class='id identifier rubyid_になりました。'>になりました。</span>
         <span class='id identifier rubyid_今はそのままでも使えますが、2'>今はそのままでも使えますが、2</span> <span class='id identifier rubyid_からは対応しません。'>からは対応しません。</span>
<span class='op'>*</span> (<span class='float'>0.10</span>) <span class='kw'>class</span> <span class='id identifier rubyid_に対応する'>に対応する</span> <span class='kw'>end</span> <span class='id identifier rubyid_がなくなりました。'>がなくなりました。</span>
<span class='op'>*</span> (<span class='float'>0.9</span>) <span class='id identifier rubyid_ダサダサのピリオド方式をやめて'>ダサダサのピリオド方式をやめて</span> { <span class='id identifier rubyid_と'>と</span> } <span class='id identifier rubyid_で囲むようにしました。'>で囲むようにしました。</span></code></pre>

<h2 id="label-E5-85-A8-E4-BD-93-E3-81-AE-E6-A7-8B-E9-80-A0">全体の構造</h2>

<p>トップレベルは、規則部とユーザーコード部に分けられます。ユーザーコード部はクラス定義の後に来なければいけません。</p>

<h3 id="label-E3-82-B3-E3-83-A1-E3-83-B3-E3-83-88">コメント</h3>

<p>文法ファイルには、一部例外を除いて、ほとんどどこにでもコメントを書くことができます。コメントは、Rubyの #.….(行末) スタイルと、Cの /<strong>.…..</strong>/ スタイルを使うことができます。</p>

<h3 id="label-E8-A6-8F-E5-89-87-E9-83-A8">規則部</h3>

<p>規則部は以下のような形をしています。– class クラス名 [&lt; スーパークラス]</p>

<pre class="code ruby"><code class="ruby">[<span class='id identifier rubyid_演算子順位'>演算子順位</span>]
[<span class='id identifier rubyid_トークン宣言'>トークン宣言</span>]
[<span class='id identifier rubyid_オプション'>オプション</span>]
[<span class='id identifier rubyid_expect'>expect</span>]
[<span class='id identifier rubyid_トークンシンボル値おきかえ'>トークンシンボル値おきかえ</span>]
[<span class='id identifier rubyid_スタート規則'>スタート規則</span>]</code></pre>

<p>rule</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_文法記述'>文法記述</span></code></pre>

<p>– “クラス名”はここで定義するパーサクラスの名前です。これはそのままRubyのクラス名になります。</p>

<p>また M::C のように「::」を使った名前を使うと、クラス定義をモジュール M の中にネストさせます。つまり class M::C ならば– module M</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span> <span class='op'>&lt;</span> <span class='const'><a href="Racc.html" title="Racc (module)">Racc</a></span><span class='op'>::</span><span class='const'><a href="Racc/Parser.html" title="Racc::Parser (class)">Parser</a></span>
  <span class='id identifier rubyid_いろいろ'>いろいろ</span>
<span class='kw'>end</span></code></pre>

<p>end – のように出力します。</p>

<p>さらに、Ruby と同じ構文でスーパークラスを指定できます。ただしこの指定をするとパーサの動作に重大な影響を与えるので、特に必要がない限り指定してはいけません。これは将来の拡張のために用意したもので、現在指定する必然性はあまりありません。</p>

<h3 id="label-E6-96-87-E6-B3-95-E3-81-AE-E8-A8-98-E8-BF-B0">文法の記述</h3>

<p>racc で生成するパーサが理解できる文法を記述します。文法は、予約語 rule と end の間に、以下のような書式で書きます。– トークン: トークンの並び アクション</p>

<p>トークン: トークンの並び アクション</p>

<pre class="code ruby"><code class="ruby"><span class='op'>|</span> <span class='id identifier rubyid_トークンの並び'>トークンの並び</span> <span class='id identifier rubyid_アクション'>アクション</span>
<span class='op'>|</span> <span class='id identifier rubyid_トークンの並び'>トークンの並び</span> <span class='id identifier rubyid_アクション'>アクション</span>
     (<span class='id identifier rubyid_必要なだけ同じようにつづける'>必要なだけ同じようにつづける</span>)</code></pre>

<p>– アクションは { } で囲みます。アクションでは Ruby の文はほとんど使えますが、一部だけは非対応です。対応していないものは以下のとおり。</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='id identifier rubyid_ヒアドキュメント'>ヒアドキュメント</span>
<span class='op'>*</span> <span class='op'>=</span><span class='kw'>begin</span> <span class='op'>...</span> <span class='op'>=</span><span class='kw'>end</span> <span class='id identifier rubyid_型コメント'>型コメント</span>
<span class='op'>*</span> <span class='id identifier rubyid_スペースで始まる正規表現'>スペースで始まる正規表現</span>
<span class='op'>*</span> <span class='id identifier rubyid_ごくまれに'>ごくまれに</span> <span class='op'>%</span> <span class='id identifier rubyid_の演算。普通に演算子のまわりにスペースを入れていれば問題なし'>の演算。普通に演算子のまわりにスペースを入れていれば問題なし</span></code></pre>

<p>このあたりに関しては完全な対応はまず無理です。あきらめてください。</p>

<p>左辺の値($$)は、オプションによって返し方がかわります。まずデフォルトではローカル変数 result (そのデフォルト値は <a href="0">val</a>)が 左辺値を表し、アクションブロックを抜けた時の result の値が左辺値になります。または明示的に return で返した場合もこの値になります。一方、options で no_result_var を指定した場合、左辺値はアクションブロックの最後の文の値になります (Ruby のメソッドと同じ)。</p>

<p>どちらの場合でもアクションは省略でき、省略した場合の左辺値は常に <a href="0">val</a> です。</p>

<p>以下に文法記述の全体の例をしめします。– rule</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_goal'>goal</span><span class='op'>:</span> <span class='kw'>def</span> <span class='id identifier rubyid_ruls'>ruls</span> <span class='id identifier rubyid_source'>source</span>
      {
        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
      }

<span class='kw'>def</span> <span class='op'>:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>* none *</span><span class='regexp_end'>/</span></span>
      {
        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> []
      }
    <span class='op'>|</span> <span class='kw'>def</span> <span class='id identifier rubyid_startdesig'>startdesig</span>
      {
        <span class='id identifier rubyid_result'>result</span>[<span class='int'>0</span>] <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>[<span class='int'>1</span>]
      }
    <span class='op'>|</span> <span class='kw'>def</span>
        <span class='id identifier rubyid_precrule'>precrule</span>   <span class='comment'># これは上の行の続き
</span>      {
        <span class='id identifier rubyid_result'>result</span>[<span class='int'>1</span>] <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>[<span class='int'>1</span>]
      }</code></pre>

<p>(略) – アクション内では特別な意味をもった変数がいくつか使えます。そのような変数を以下に示します。括弧の中は yacc での表記です。</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='id identifier rubyid_result'>result</span> (<span class='gvar'>$$</span>)</code></pre>

<p>左辺の値。初期値は <a href="0">val</a> です。</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='id identifier rubyid_val'>val</span> (<span class='backref'>$1</span><span class='comma'>,</span><span class='backref'>$2</span><span class='comma'>,</span><span class='backref'>$3</span><span class='id identifier rubyid_…'>…</span>)</code></pre>

<p>右辺の記号の値の配列。Ruby の配列なので当然インデックスはゼロから始まります。この配列は毎回作られるので自由に変更したり捨てたりして構いません。</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='id identifier rubyid__values'>_values</span> (<span class='op'>...</span><span class='comma'>,</span><span class='gvar'>$-2</span><span class='comma'>,</span><span class='gvar'>$-1</span><span class='comma'>,</span><span class='gvar'>$0</span>)</code></pre>

<p>値スタック。Racc コアが使っているオブジェクトがそのまま渡されます。この変数の意味がわかる人以外は<em>絶対に</em>変更してはいけません。</p>

<p>またアクションの特別な形式に、埋めこみアクションというものがあります。これはトークン列の途中の好きなところに記述することができます。以下に埋めこみアクションの例を示します。– target: A B { puts ‘test test’ } C D { normal action } – このように記述すると A B を検出した時点で puts が実行されます。また、埋めこみアクションはそれ自体が値を持ちます。つまり、以下の例において– target: A { result = 1 } B { p <a href="1">val</a> } – 最後にある p <a href="1">val</a> は埋めこみアクションの値 1 を表示します。B の値ではありません。</p>

<p>意味的には、埋めこみアクションは空の規則を持つ非終端記号を追加することと全く同じ働きをします。つまり、上の例は次のコードと完全に同じ意味です。– target  : A nonterm B { p <a href="1">val</a> } nonterm : /* 空の規則 */ { result = 1 } –</p>

<h3 id="label-E6-BC-94-E7-AE-97-E5-AD-90-E5-84-AA-E5-85-88-E9-A0-86-E4-BD-8D">演算子優先順位</h3>

<p>あるトークン上でシフト・還元衝突がおこったとき、そのトークンに演算子優先順位が設定してあると衝突を解消できる場合があります。そのようなものとして特に有名なのは数式の演算子と if…else 構文です。</p>

<p>優先順位で解決できる文法は、うまく文法をくみかえてやれば優先順位なしでも同じ効果を得ることができます。しかしたいていの場合は優先順位を設定して解決するほうが文法を簡単にできます。</p>

<p>シフト・還元衝突がおこったとき、Racc はまずその規則に順位が設定されているか調べます。規則の順位は、その規則で一番うしろにある終端トークンの優先順位です。たとえば– target: TERM_A nonterm_a TERM_B nonterm_b – のような規則の順位はTERM_Bの優先順位になります。もしTERM_Bに優先順位が設定されていなかったら、優先順位で衝突を解決することはできないと判断し、「Shift/Reduce conflict」を報告します。</p>

<p>演算子の優先順位はつぎのように書いて定義します。– prechigh</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_nonassoc'>nonassoc</span> <span class='const'>PLUSPLUS</span>
<span class='id identifier rubyid_left'>left</span>     <span class='const'>MULTI</span> <span class='const'>DIVIDE</span>
<span class='id identifier rubyid_left'>left</span>     <span class='const'>PLUS</span> <span class='const'>MINUS</span>
<span class='id identifier rubyid_right'>right</span>    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>preclow – prechigh に近い行にあるほど優先順位の高いトークンです。上下をまるごとさかさまにして preclow…prechigh の順番に書くこともできます。left などは必ず行の最初になければいけません。</p>

<p>left right nonassoc はそれぞれ「結合性」を表します。結合性によって、同じ順位の演算子の規則が衝突した場合にシフト還元のどちらをとるかが決まります。たとえば– a - b - c – が– (a - b) - c – になるのが左結合 (left) です。四則演算は普通これです。一方– a - (b - c) – になるのが右結合 (right) です。代入のクオートは普通 right です。またこのように演算子が重なるのはエラーである場合、非結合 (nonassoc) です。C 言語の ++ や単項のマイナスなどがこれにあたります。</p>

<p>ところで、説明したとおり通常は還元する規則の最後のトークンが順位を決めるのですが、ある規則に限ってそのトークンとは違う順位にしたいこともあります。例えば符号反転のマイナスは引き算のマイナスより順位を高くしないといけません。このような場合 yacc では %prec を使います。racc ではイコール記号を使って同じことをできます。– prechigh</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_nonassoc'>nonassoc</span> <span class='const'>UMINUS</span>
<span class='id identifier rubyid_left'>left</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_left'>left</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>+</span><span class='tstring_end'>&#39;</span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>preclow (略) exp: exp ‘*’ exp</p>

<pre class="code ruby"><code class="ruby"><span class='op'>|</span> <span class='id identifier rubyid_exp'>exp</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span> <span class='id identifier rubyid_exp'>exp</span>
<span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span> <span class='id identifier rubyid_exp'>exp</span>     <span class='op'>=</span> <span class='const'>UMINUS</span>    <span class='comment'># ここだけ順位を上げる</span></code></pre>

<p>– このように記述すると、‘-’ exp の規則の順位が UMINUS の順位になります。こうすることで符号反転の ‘-’ は ‘*’ よりも順位が高くなるので、意図どおりになります。</p>

<h3 id="label-E3-83-88-E3-83-BC-E3-82-AF-E3-83-B3-E5-AE-A3-E8-A8-80">トークン宣言</h3>

<p>トークン(終端記号)のつづりを間違えるというのはよくあることですが、発見するのはなかなか難しいものです。1.1.5 からはトークンを明示的に宣言することで、宣言にないトークン / 宣言にだけあるトークンに対して警告が出るようになりました。yacc の %token と似ていますが最大の違いはracc では必須ではなく、しかもエラーにならず警告だけ、という点です。</p>

<p>トークン宣言は以下のように書きます。– token A B C D</p>

<pre class="code ruby"><code class="ruby"><span class='const'>E</span> <span class='const'>F</span> <span class='const'>G</span> <span class='const'>H</span></code></pre>

<p>– トークンのリストを複数行にわたって書けることに注目してください。racc では一般に「予約語」は行の先頭に来た時だけ予約語とみなされるのでprechigh などもシンボルとして使えます。ただし深淵な理由から end だけはどうやっても予約語になってしまいます。</p>

<h3 id="label-E3-82-AA-E3-83-97-E3-82-B7-E3-83-A7-E3-83-B3">オプション</h3>

<p>racc のコマンドラインオプションの一部をファイル中にデフォルト値として記述することができます。– options オプション オプション …– 現在ここで使えるのは</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='id identifier rubyid_omit_action_call'>omit_action_call</span></code></pre>

<p>空のアクション呼び出しを省略する</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='id identifier rubyid_result_var'>result_var</span></code></pre>

<p>変数 result を使う</p>

<p>です。それぞれ no_ を頭につけることで意味を反転できます。</p>

<h3 id="label-expect">expect</h3>

<p>実用になるパーサはたいてい無害な shift/reduce conflict を含みます。しかし文法ファイルを書いた本人はそれを知っているからいいですが、ユーザが文法ファイルを処理した時に「conflict」と表示されたら不安に思うでしょう。そのような場合、以下のように書いておくとshift/reduce conflict のメッセージを抑制できます。– expect 3 – この場合 shift/reduce conflict はぴったり三つでなければいけません。三つでない場合はやはり表示が出ます (ゼロでも出ます)。また reduce/reduce conflict の表示は抑制できません。</p>

<h3 id="label-E3-83-88-E3-83-BC-E3-82-AF-E3-83-B3-E3-82-B7-E3-83-B3-E3-83-9C-E3-83-AB-E5-80-A4-E3-81-AE-E5-A4-89-E6-9B-B4">トークンシンボル値の変更</h3>

<p>トークンシンボルを表す値は、デフォルトでは</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='id identifier rubyid_文法中、引用符でかこまれていないもの'>文法中、引用符でかこまれていないもの</span> (<span class='const'>RULEとかXENDとか</span>)
  <span class='id identifier rubyid_→その名前の文字列を'>→その名前の文字列を</span> <span class='id identifier rubyid_intern'>intern</span> <span class='id identifier rubyid_して得られるシンボル'>して得られるシンボル</span> (<span class='float'>1.4</span> <span class='id identifier rubyid_では'>では</span> <span class='const'>Fixnum</span>)
<span class='op'>*</span> <span class='id identifier rubyid_引用符でかこまれているもの'>引用符でかこまれているもの</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='id identifier rubyid_とか'>とか</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='id identifier rubyid_とか'>とか</span>)
  <span class='id identifier rubyid_→その文字列そのまま'>→その文字列そのまま</span></code></pre>

<p>となっていますが、たとえば他の形式のスキャナがすでに存在する場合などは、これにあわせなければならず、このままでは不便です。このような場合には、convert 節を加えることで、トークンシンボルを表す値を変えることができます。以下がその例です。– convert</p>

<pre class="code ruby"><code class="ruby"><span class='const'>PLUS</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PlusClass</span><span class='tstring_end'>&#39;</span></span>      <span class='comment'>#→ PlusClass
</span><span class='const'>MIN</span>  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinusClass</span><span class='tstring_end'>&#39;</span></span>     <span class='comment'>#→ MinusClass</span></code></pre>

<p>end – デフォルトではトークンシンボル PLUS に対してはトークンシンボル値は<code>:PLUS</code> ですが、上のような記述がある場合は PlusClass になります。変換後の値は false・nil 以外ならなんでも使えます。</p>

<p>変換後の値として文字列を使うときは、次のように引用符を重ねる必要があります。– convert</p>

<pre class="code ruby"><code class="ruby"><span class='const'>PLUS</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;plus&quot;</span><span class='tstring_end'>&#39;</span></span>       <span class='comment'>#→ &quot;plus&quot;</span></code></pre>

<p>end – また、「‘」を使っても生成された Ruby のコード上では「“」になるので注意してください。バックスラッシュによるクオートは有効ですが、バックスラッシュは消えずにそのまま残ります。– PLUS ’”plusn“‘          #→ ”plusn“ MIN  ”&quot;minus#<code>val</code>&quot;“   #→ &quot;minus#<code>val</code>&quot; –</p>

<h3 id="label-E3-82-B9-E3-82-BF-E3-83-BC-E3-83-88-E8-A6-8F-E5-89-87">スタート規則</h3>

<p>パーサをつくるためには、どの規則が「最初の」規則か、ということを <a href="Racc.html" title="Racc (module)"><code>Racc</code></a> におしえてやらなければいけません。それを明示的に書くのがスタート規則です。スタート規則は次のように書きます。– start real_target – start は行の最初にこなければいけません。このように書くと、ファイルで一番最初に出てくる real_target の規則をスタート規則として使います。省略した場合は、ファイルの最初の規則がスタート規則になります。普通は最初の規則を一番上にかくほうが書きやすく、わかりやすくなりますから、この記法はあまりつかう必要はないでしょう。</p>

<h3 id="label-E3-83-A6-E3-83-BC-E3-82-B6-E3-83-BC-E3-82-B3-E3-83-BC-E3-83-89-E9-83-A8">ユーザーコード部</h3>

<p>ユーザーコードは、パーサクラスが書きこまれるファイルに、アクションの他にもコードを含めたい時に使います。このようなものは書きこまれる場所に応じて三つ存在し、パーサクラスの定義の前がheader、クラスの定義中(の冒頭)が inner、定義の後が footer です。ユーザコードとして書いたものは全く手を加えずにそのまま連結されます。</p>

<p>ユーザーコード部の書式は以下の通りです。– —- 識別子</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ruby'>ruby</span> <span class='id identifier rubyid_の文'>の文</span>
<span class='id identifier rubyid_ruby'>ruby</span> <span class='id identifier rubyid_の文'>の文</span>
<span class='id identifier rubyid_ruby'>ruby</span> <span class='id identifier rubyid_の文'>の文</span></code></pre>

<p>—- 識別子</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ruby'>ruby</span> <span class='id identifier rubyid_の文'>の文</span>
   <span class='symbeg'>:</span></code></pre>

<p>– 行の先頭から四つ以上連続した「-」(マイナス)があるとユーザーコードとみなされます。識別子は一つの単語で、そのあとには「=」以外なら何を書いてもかまいません。</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>