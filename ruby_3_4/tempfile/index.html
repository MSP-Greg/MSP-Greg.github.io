<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Tempfile &mdash; tempfile  Ruby-3.4.7 p58</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Tempfile",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-3.4.7</a> &raquo; 
      <a href='.'>tempfile</a> &raquo; 
      <a href='_index.html#alpha_T'>Index (T)</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Tempfile&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Tempfile</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a class='nodoc' href="Tempfile/PathAttr.html" title="Tempfile::PathAttr (module)"><code>PathAttr</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a class='nodoc' href="Tempfile/FinalizerManager.html" title="Tempfile::FinalizerManager (class)"><code>FinalizerManager</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          File
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          File
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>File</span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'>File</li>
          <li class='next'>Tempfile</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L157'>lib/tempfile.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>A utility class for managing temporary files.</p>

<p>There are two kind of methods of creating a temporary file:</p>
<ul><li>
<p><a href="#create-class_method" title="Tempfile.create (method)">.create</a> (recommended)</p>
</li><li>
<p><a href="#new-class_method" title="Tempfile.new (method)">.new</a> and <a href="#open-class_method" title="Tempfile.open (method)">.open</a> (mostly for backward compatibility, not recommended)</p>
</li></ul>

<p><a href="#create-class_method" title="Tempfile.create (method)">.create</a> creates a usual File object. The timing of file deletion is predictable. Also, it supports open-and-unlink technique which removes the temporary file immediately after creation.</p>

<p><a href="#new-class_method" title="Tempfile.new (method)">.new</a> and <a href="#open-class_method" title="Tempfile.open (method)">.open</a> creates a Tempfile object. The created file is removed by the GC (finalizer). The timing of file deletion is not predictable.</p>

<h3 id="label-Synopsis">Synopsis</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tempfile</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Tempfile.create with a block
</span><span class='comment'># The filename are choosen automatically.
</span><span class='comment'># (You can specify the prefix and suffix of the filename by an optional argument.)
</span><span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'><a href="#create-class_method" title="Tempfile.create (method)">create</a></span> {<span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_rewind'>rewind</span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_read'>read</span>                <span class='comment'># =&gt; &quot;foo\n&quot;
</span>}                       <span class='comment'># The file is removed at block exit.
</span>
<span class='comment'># Tempfile.create without a block
</span><span class='comment'># You need to unlink the file in non-block form.
</span><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'><a href="#create-class_method" title="Tempfile.create (method)">create</a></span>
<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
<span class='const'>File</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)     <span class='comment'># You need to unlink the file.
</span>
<span class='comment'># Tempfile.create(anonymous: true) without a block
</span><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'><a href="#create-class_method" title="Tempfile.create (method)">create</a></span>(<span class='label'>anonymous:</span> <span class='kw'>true</span>)
<span class='comment'># The file is already removed because anonymous.
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>                  <span class='comment'># =&gt; &quot;/tmp/&quot;  (no filename since no file)
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_rewind'>rewind</span>
<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_read'>read</span>                  <span class='comment'># =&gt; &quot;foo\n&quot;
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>

<span class='comment'># Tempfile.create(anonymous: true) with a block
</span><span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'><a href="#create-class_method" title="Tempfile.create (method)">create</a></span>(<span class='label'>anonymous:</span> <span class='kw'>true</span>) {<span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='comment'># The file is already removed because anonymous.
</span>  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>                <span class='comment'># =&gt; &quot;/tmp/&quot;  (no filename since no file)
</span>  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_rewind'>rewind</span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_read'>read</span>                <span class='comment'># =&gt; &quot;foo\n&quot;
</span>}

<span class='comment'># Not recommended: Tempfile.new without a block
</span><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Tempfile.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>      <span class='comment'># =&gt; A unique filename in the OS&#39;s temp directory,
</span>               <span class='comment'>#    e.g.: &quot;/tmp/foo.24722.0&quot;
</span>               <span class='comment'>#    This filename contains &#39;foo&#39; in its basename.
</span><span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_write'>write</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello world</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_rewind'>rewind</span>
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_read'>read</span>      <span class='comment'># =&gt; &quot;hello world&quot;
</span><span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span>    <span class='comment'># deletes the temp file</span></code></pre>

<h3 id="label-About+-7BTempfile.new-7D+and+-7BTempfile.open-7D">About <a href="#new-class_method" title="Tempfile.new (method)">.new</a> and <a href="#open-class_method" title="Tempfile.open (method)">.open</a></h3>

<p>This section does not apply to <a href="#create-class_method" title="Tempfile.create (method)">.create</a> because it returns a File object (not a <code>Tempfile</code> object).</p>

<p>When you create a <code>Tempfile</code> object, it will create a temporary file with a unique filename. A Tempfile objects behaves just like a File object, and you can perform all the usual file operations on it: reading data, writing data, changing its permissions, etc. So although this class does not explicitly document all instance methods supported by File, you can in fact call any File instance method on a <code>Tempfile</code> object.</p>

<p>A Tempfile object has a finalizer to remove the temporary file. This means that the temporary file is removed via GC. This can cause several problems:</p>
<ul><li>
<p>Long GC intervals and conservative GC can accumulate temporary files that are not removed.</p>
</li><li>
<p>Temporary files are not removed if Ruby exits abnormally (such as SIGKILL, SEGV).</p>
</li></ul>

<p>There are legacy good practices for <a href="#new-class_method" title="Tempfile.new (method)">.new</a> and <a href="#open-class_method" title="Tempfile.open (method)">.open</a> as follows.</p>

<h4 id="label-Explicit+close">Explicit close</h4>

<p>When a <code>Tempfile</code> object is garbage collected, or when the Ruby interpreter exits, its associated temporary file is automatically deleted. This means that it’s unnecessary to explicitly delete a <code>Tempfile</code> after use, though it’s a good practice to do so: not explicitly deleting unused Tempfiles can potentially leave behind a large number of temp files on the filesystem until they’re garbage collected. The existence of these temp files can make it harder to determine a new <code>Tempfile</code> filename.</p>

<p>Therefore, one should always call <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a> or close in an ensure block, like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Tempfile.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>begin</span>
   <span class='comment'># ...do something with file...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
   <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span>   <span class='comment'># deletes the temp file
</span><span class='kw'>end</span></code></pre>

<p><a href="#create-class_method" title="Tempfile.create (method)">.create</a> { … } exists for this purpose and is more convenient to use. Note that <a href="#create-class_method" title="Tempfile.create (method)">.create</a> returns a File instance instead of a <code>Tempfile</code>, which also avoids the overhead and complications of delegation.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'><a href="#create-class_method" title="Tempfile.create (method)">create</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
   <span class='comment'># ...do something with file...
</span><span class='kw'>end</span></code></pre>

<h4 id="label-Unlink+after+creation">Unlink after creation</h4>

<p>On POSIX systems, it’s possible to unlink a file right after creating it, and before closing it. This removes the filesystem entry without closing the file handle, so it ensures that only the processes that already had the file handle open can access the file’s contents. It’s strongly recommended that you do this if you do not want any other processes to be able to read from or write to the <code>Tempfile</code>, and you do not need to know the Tempfile’s filename either.</p>

<p>Also, this guarantees the temporary file is removed even if Ruby exits abnormally. The OS reclaims the storage for the temporary file when the file is closed or the Ruby process exits (normally or abnormally).</p>

<p>For example, a practical use case for unlink-after-creation would be this: you need a large byte buffer that’s too large to comfortably fit in RAM, e.g. when you’re writing a web server and you want to buffer the client’s file upload data.</p>

<p><code>Tempfile.create(anonymous: true)</code> supports this behavior. It also works on Windows.</p>

<h3 id="label-Minor+notes">Minor notes</h3>

<p>Tempfile’s filename picking method is both thread-safe and inter-process-safe: it guarantees that no other threads or processes will pick the same filename.</p>

<p><code>Tempfile</code> itself however may not be entirely thread-safe. If you access the same <code>Tempfile</code> object from multiple threads then you should protect it with a mutex.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='VERSION-constant' class='summary_signature'>VERSION =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The version</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L160-L160'># File 'lib/tempfile.rb', line 160</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.3.1</span><span class='tstring_end'>&quot;</span></span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#create-class_method" title=".create (class method)">.<strong>create</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, anonymous: false, **options, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a file in the underlying file system; returns a new File object based on that file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_anonymous-class_method" title=".create_anonymous (class method)">.<strong>create_anonymous</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, **options, &amp;block)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_with_filename-class_method" title=".create_with_filename (class method)">.<strong>create_with_filename</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, **options)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, **options)  &#x21d2; Tempfile </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a file in the underlying file system; returns a new Tempfile object based on that file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#open-class_method" title=".open (class method)">.<strong>open</strong>(*args, **kw)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a new <code>Tempfile</code>.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro prot nodoc'>
      <a href="#finalizer_manager-instance_method" title="#finalizer_manager (instance method)">#<strong>finalizer_manager</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title protected'>protected</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro prot nodoc'>
      <a href="#mode-instance_method" title="#mode (instance method)">#<strong>mode</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title protected'>protected</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro prot nodoc'>
      <a href="#opts-instance_method" title="#opts (instance method)">#<strong>opts</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title protected'>protected</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro prot nodoc'>
      <a href="#unlinked-instance_method" title="#unlinked (instance method)">#<strong>unlinked</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title protected'>protected</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>(unlink_now = false)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Closes the file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#close!-instance_method" title="#close! (instance method)">#<strong>close!</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Closes and unlinks (deletes) the file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#length-instance_method" title="#length (instance method)">#<strong>length</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#size-instance_method" title="Tempfile#size (method)">#size</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#open-instance_method" title="#open (instance method)">#<strong>open</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Opens or reopens the file with mode “r+”.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#path-instance_method" title="#path (instance method)">#<strong>path</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the full path name of the temporary file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#size-instance_method" title="#size (instance method)">#<strong>size</strong>  </a>
      (also: #length)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the size of the temporary file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unlink-instance_method" title="#unlink (instance method)">#<strong>unlink</strong>  </a>
      (also: #delete)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Unlinks (deletes) the file from the filesystem.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#initialize_clone-instance_method" title="#initialize_clone (instance method)">#<strong>initialize_clone</strong>(other)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#initialize_dup-instance_method" title="#initialize_dup (instance method)">#<strong>initialize_dup</strong>(other)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  </a>
      (also: #to_s)
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#inspect-instance_method" title="Tempfile#inspect (method)">#inspect</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature prot nodoc'>
      <a href="#_close-instance_method" title="#_close (instance method)">#<strong>_close</strong>  </a>
    </span>
    <span class='note title protected'>protected</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#initialize_copy_iv-instance_method" title="#initialize_copy_iv (instance method)">#<strong>initialize_copy_iv</strong>(other)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, **options)  &#x21d2; <code>Tempfile</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a file in the underlying file system; returns a new Tempfile object based on that file.</p>

<p>If possible, consider instead using <a href="#create-class_method" title="Tempfile.create (method)">.create</a>, which:</p>
<ul><li>
<p>Avoids the performance cost of delegation, incurred when Tempfile.new calls its superclass <code>DelegateClass(File)</code>.</p>
</li><li>
<p>Does not rely on a finalizer to close and unlink the file, which can be unreliable.</p>
</li></ul>

<p>Creates and returns file whose:</p>
<ul><li>
<p>Class is Tempfile (not File, as in <a href="#create-class_method" title="Tempfile.create (method)">.create</a>).</p>
</li><li>
<p>Directory is the system temporary directory (system-dependent).</p>
</li><li>
<p>Generated filename is unique in that directory.</p>
</li><li>
<p>Permissions are <code>0600</code>; see <a href="File.html#label-File+Permissions" title="File Permissions">File Permissions</a>.</p>
</li><li>
<p>Mode is <code>&#39;w+&#39;</code> (read/write mode, positioned at the end).</p>
</li></ul>

<p>The underlying file is removed when the Tempfile object dies and is reclaimed by the garbage collector.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'>new</span> <span class='comment'># =&gt; #&lt;Tempfile:/tmp/20220505-17839-1s0kt30&gt;
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_class'>class</span>               <span class='comment'># =&gt; Tempfile
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>                <span class='comment'># =&gt; &quot;/tmp/20220505-17839-1s0kt30&quot;
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_stat'>stat</span>.<span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span>.<span class='id identifier rubyid_to_s'><a href="#to_s-instance_method" title="Tempfile#to_s (method)">to_s</a></span>(<span class='int'>8</span>)   <span class='comment'># =&gt; &quot;100600&quot;
</span><span class='const'>File</span>.<span class='id identifier rubyid_exist?'>exist?</span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)   <span class='comment'># =&gt; true
</span><span class='const'>File</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)   <span class='comment'>#
</span><span class='const'>File</span>.<span class='id identifier rubyid_exist?'>exist?</span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)   <span class='comment'># =&gt; false</span></code></pre>

<p>Argument <code>basename</code>, if given, may be one of:</p>
<ul><li>
<p>A string: the generated filename begins with <code>basename</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; #&lt;Tempfile:/tmp/foo20220505-17839-1whk2f&gt;</span></code></pre>
</li><li>
<p>An array of two strings <code>[prefix, suffix]</code>: the generated filename begins with <code>prefix</code> and ends with <code>suffix</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'>new</span>(<span class='qwords'><span class='qwords_beg'>%w/</span><span class='tstring_content'>foo</span><span class='words_sep'> </span><span class='tstring_content'>.jpg</span><span class='tstring_end'>/</span></span>) <span class='comment'># =&gt; #&lt;Tempfile:/tmp/foo20220505-17839-58xtfi.jpg&gt;</span></code></pre>
</li></ul>

<p>With arguments <code>basename</code> and <code>tmpdir</code>, the file is created in directory <code>tmpdir</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; #&lt;Tempfile:./foo20220505-17839-xfstr8&gt;</span></code></pre>

<p>Keyword arguments <a href="#mode-instance_method" title="Tempfile#mode (method)">#mode</a> and <code>options</code> are passed directly to method <code>File.open</code>:</p>
<ul><li>
<p>The value given with <a href="#mode-instance_method" title="Tempfile#mode (method)">#mode</a> must be an integer, and may be expressed as the logical OR of constants defined in <code>File::Constants</code>.</p>
</li><li>
<p>For <code>options</code>, see <a href="IO.html#label-Open+Options" title="Open Options">Open Options</a>.</p>
</li></ul>

<p>Related: <a href="#create-class_method" title="Tempfile.create (method)">.create</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L219-L235'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='219' data-end='235'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 219</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_basename'>basename</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tempfile.new doesn&#39;t call the given block.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>uplevel:</span> <span class='int'>1</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='ivar'>@unlinked</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@mode</span> <span class='op'>=</span> <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>RDWR</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>CREAT</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>EXCL</span>
  <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='op'>::</span><span class='const'>Dir</span><span class='op'>::</span><span class='const'>Tmpname</span>.<span class='id identifier rubyid_create'><a href="#create-class_method" title="Tempfile.create (method)">create</a></span>(<span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span><span class='op'>|</span>
    <span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_perm'>perm</span>] <span class='op'>=</span> <span class='int'>0600</span>
    <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_open'><a href="#open-class_method" title="Tempfile.open (method)">open</a></span>(<span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='ivar'>@mode</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span>)
    <span class='ivar'>@opts</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span>.<span class='id identifier rubyid_freeze'>freeze</span>
  <span class='kw'>end</span>

  <span class='kw'>super</span>(<span class='id identifier rubyid_tmpfile'>tmpfile</span>)

  <span class='ivar'>@finalizer_manager</span> <span class='op'>=</span> <span class='const'><a href="Tempfile/FinalizerManager.html" title="Tempfile::FinalizerManager (class)">FinalizerManager</a></span>.<span class='id identifier rubyid_new'><a href="Tempfile/FinalizerManager.html#new-class_method" title="Tempfile::FinalizerManager.new (method)">new</a></span>(<span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)
  <span class='ivar'>@finalizer_manager</span>.<span class='id identifier rubyid_register'>register</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid___getobj__'>__getobj__</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="create-class_method">
  <h3 class='signature  first'>
    .<strong>create</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, anonymous: false, **options, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a file in the underlying file system; returns a new File object based on that file.</p>

<p>With no block given and no arguments, creates and returns file whose:</p>
<ul><li>
<p>Class is <code>File</code> (not Tempfile).</p>
</li><li>
<p>Directory is the system temporary directory (system-dependent).</p>
</li><li>
<p>Generated filename is unique in that directory.</p>
</li><li>
<p>Permissions are <code>0600</code>; see <a href="File.html#label-File+Permissions" title="File Permissions">File Permissions</a>.</p>
</li><li>
<p>Mode is <code>&#39;w+&#39;</code> (read/write mode, positioned at the end).</p>
</li></ul>

<p>The temporary file removal depends on the keyword argument <code>anonymous</code> and whether a block is given or not. See the description about the <code>anonymous</code> keyword argument later.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span>     <span class='comment'># =&gt; #&lt;File:/tmp/20220505-9795-17ky6f6&gt;
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_class'>class</span>                 <span class='comment'># =&gt; File
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>                  <span class='comment'># =&gt; &quot;/tmp/20220505-9795-17ky6f6&quot;
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_stat'>stat</span>.<span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span>.<span class='id identifier rubyid_to_s'><a href="#to_s-instance_method" title="Tempfile#to_s (method)">to_s</a></span>(<span class='int'>8</span>)     <span class='comment'># =&gt; &quot;100600&quot;
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
<span class='const'>File</span>.<span class='id identifier rubyid_exist?'>exist?</span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)     <span class='comment'># =&gt; true
</span><span class='const'>File</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)
<span class='const'>File</span>.<span class='id identifier rubyid_exist?'>exist?</span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)     <span class='comment'># =&gt; false
</span>
<span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span> {<span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_rewind'>rewind</span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_read'>read</span>                <span class='comment'># =&gt; &quot;foo\n&quot;
</span>  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>                <span class='comment'># =&gt; &quot;/tmp/20240524-380207-oma0ny&quot;
</span>  <span class='const'>File</span>.<span class='id identifier rubyid_exist?'>exist?</span>(<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)   <span class='comment'># =&gt; true
</span>}                       <span class='comment'># The file is removed at block exit.
</span>
<span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span>(<span class='label'>anonymous:</span> <span class='kw'>true</span>)
<span class='comment'># The file is already removed because anonymous
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>                  <span class='comment'># =&gt; &quot;/tmp/&quot;  (no filename since no file)
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_rewind'>rewind</span>
<span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_read'>read</span>                  <span class='comment'># =&gt; &quot;foo\n&quot;
</span><span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>

<span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span>(<span class='label'>anonymous:</span> <span class='kw'>true</span>) {<span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='comment'># The file is already removed because anonymous
</span>  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>                <span class='comment'># =&gt; &quot;/tmp/&quot;  (no filename since no file)
</span>  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_rewind'>rewind</span>
  <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_read'>read</span>                <span class='comment'># =&gt; &quot;foo\n&quot;
</span>}</code></pre>

<p>The argument <code>basename</code>, if given, may be one of the following:</p>
<ul><li>
<p>A string: the generated filename begins with <code>basename</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; #&lt;File:/tmp/foo20220505-9795-1gok8l9&gt;</span></code></pre>
</li><li>
<p>An array of two strings <code>[prefix, suffix]</code>: the generated filename begins with <code>prefix</code> and ends with <code>suffix</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span>(<span class='qwords'><span class='qwords_beg'>%w/</span><span class='tstring_content'>foo</span><span class='words_sep'> </span><span class='tstring_content'>.jpg</span><span class='tstring_end'>/</span></span>) <span class='comment'># =&gt; #&lt;File:/tmp/foo20220505-17839-tnjchh.jpg&gt;</span></code></pre>
</li></ul>

<p>With arguments <code>basename</code> and <code>tmpdir</code>, the file is created in the directory <code>tmpdir</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; #&lt;File:./foo20220505-9795-1emu6g8&gt;</span></code></pre>

<p>Keyword arguments <a href="#mode-instance_method" title="Tempfile#mode (method)">#mode</a> and <code>options</code> are passed directly to the method <code>File.open</code>:</p>
<ul><li>
<p>The value given for <a href="#mode-instance_method" title="Tempfile#mode (method)">#mode</a> must be an integer and may be expressed as the logical OR of constants defined in <code>File::Constants</code>.</p>
</li><li>
<p>For <code>options</code>, see <a href="IO.html#label-Open+Options" title="Open Options">Open Options</a>.</p>
</li></ul>

<p>The keyword argument <code>anonymous</code> specifies when the file is removed.</p>
<ul><li>
<p><code>anonymous=false</code> (default) without a block: the file is not removed.</p>
</li><li>
<p><code>anonymous=false</code> (default) with a block: the file is removed after the block exits.</p>
</li><li>
<p><code>anonymous=true</code> without a block: the file is removed before returning.</p>
</li><li>
<p><code>anonymous=true</code> with a block: the file is removed before the block is called.</p>
</li></ul>

<p>In the first case (<code>anonymous=false</code> without a block), the file is not removed automatically. It should be explicitly closed. It can be used to rename to the desired filename. If the file is not needed, it should be explicitly removed.</p>

<p>The <code>File#path</code> method of the created file object returns the temporary directory with a trailing slash when <code>anonymous</code> is true.</p>

<p>When a block is given, it creates the file as described above, passes it to the block, and returns the block’s value. Before the returning, the file object is closed and the underlying file is removed:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span> {<span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span> } <span class='comment'># =&gt; &quot;/tmp/20220505-9795-rkists&quot;</span></code></pre>

<p>Implementation note:</p>

<p>The keyword argument <code>anonymous=true</code> is implemented using FILE_SHARE_DELETE on Windows. O_TMPFILE is used on Linux.</p>

<p>Related: <a href="#new-class_method" title="Tempfile.new (method)">.new</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L558-L564'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='558' data-end='564'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 558</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_create'>create</span>(<span class='id identifier rubyid_basename'>basename</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>anonymous:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_anonymous'>anonymous</span>
    <span class='id identifier rubyid_create_anonymous'><a href="#create_anonymous-class_method" title="Tempfile.create_anonymous (method)">create_anonymous</a></span>(<span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_create_with_filename'><a href="#create_with_filename-class_method" title="Tempfile.create_with_filename (method)">create_with_filename</a></span>(<span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_anonymous-class_method">
  <h3 class='signature '>
    .<strong>create_anonymous</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, **options, &amp;block)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L606-L639'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='606' data-end='639'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 606</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_private'>private</span> <span class='kw'>def</span> <span class='id identifier rubyid_create_anonymous'>create_anonymous</span>(<span class='id identifier rubyid_basename'>basename</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_tmpdir'>tmpdir</span> <span class='op'>=</span> <span class='const'>Dir</span>.<span class='id identifier rubyid_tmpdir'>tmpdir</span>() <span class='kw'>if</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span>.<span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='const'>File</span><span class='op'>::</span><span class='const'>TMPFILE</span>) <span class='comment'># O_TMPFILE since Linux 3.11
</span>    <span class='kw'>begin</span>
      <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_open'><a href="#open-class_method" title="Tempfile.open (method)">open</a></span>(<span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>RDWR</span> <span class='op'>|</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>TMPFILE</span><span class='comma'>,</span> <span class='int'>0600</span>)
    <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EISDIR</span><span class='comma'>,</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span><span class='comma'>,</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EOPNOTSUPP</span>
      <span class='comment'># kernel or the filesystem does not support O_TMPFILE
</span>      <span class='comment'># fallback to create-and-unlink
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span> <span class='op'>|=</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>SHARE_DELETE</span> <span class='op'>|</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>BINARY</span> <span class='comment'># Windows needs them to unlink the opened file.
</span>    <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='id identifier rubyid_create_with_filename'><a href="#create_with_filename-class_method" title="Tempfile.create_with_filename (method)">create_with_filename</a></span>(<span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
    <span class='const'>File</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span>(<span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)
    <span class='id identifier rubyid_tmppath'>tmppath</span> <span class='op'>=</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_join'>join</span>(<span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>unless</span> <span class='id identifier rubyid_tmppath'>tmppath</span> <span class='op'>==</span> <span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>
    <span class='comment'># clear path.
</span>    <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_autoclose'>autoclose</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Tempfile.new (method)">new</a></span>(<span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_fileno'>fileno</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>RDWR</span><span class='comma'>,</span> <span class='label'>path:</span> <span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)
    <span class='const'><a href="Tempfile/PathAttr.html" title="Tempfile::PathAttr (module)">PathAttr</a></span>.<span class='id identifier rubyid_set_path'><a href="Tempfile/PathAttr.html#set_path-class_method" title="Tempfile::PathAttr.set_path (method)">set_path</a></span>(<span class='id identifier rubyid_tmpfile'>tmpfile</span><span class='comma'>,</span> <span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>) <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='const'><a href="Tempfile/PathAttr.html" title="Tempfile::PathAttr (module)">PathAttr</a></span>)
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tmpfile'>tmpfile</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_with_filename-class_method">
  <h3 class='signature '>
    .<strong>create_with_filename</strong>(basename = &quot;&quot;, tmpdir = nil, mode: 0, **options)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L567-L594'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='567' data-end='594'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 567</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_private'>private</span> <span class='kw'>def</span> <span class='id identifier rubyid_create_with_filename'>create_with_filename</span>(<span class='id identifier rubyid_basename'>basename</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='const'>Dir</span><span class='op'>::</span><span class='const'>Tmpname</span>.<span class='id identifier rubyid_create'><a href="#create-class_method" title="Tempfile.create (method)">create</a></span>(<span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span><span class='op'>|</span>
    <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span> <span class='op'>|=</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>RDWR</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>CREAT</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>EXCL</span>
    <span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_perm'>perm</span>] <span class='op'>=</span> <span class='int'>0600</span>
    <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_open'><a href="#open-class_method" title="Tempfile.open (method)">open</a></span>(<span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span>)
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>
    <span class='kw'>ensure</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_closed?'>closed?</span>
        <span class='kw'>if</span> <span class='const'>File</span>.<span class='id identifier rubyid_identical?'>identical?</span>(<span class='id identifier rubyid_tmpfile'>tmpfile</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)
          <span class='id identifier rubyid_unlinked'><a href="#unlinked-instance_method" title="Tempfile#unlinked (method)">unlinked</a></span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
      <span class='kw'>end</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_unlinked'><a href="#unlinked-instance_method" title="Tempfile#unlinked (method)">unlinked</a></span>
        <span class='kw'>begin</span>
          <span class='const'>File</span>.<span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>
        <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tmpfile'>tmpfile</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="open-class_method">
  <h3 class='signature '>
    .<strong>open</strong>(*args, **kw)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new <code>Tempfile</code>.</p>

<p>This method is not recommended and exists mostly for backward compatibility. Please use <a href="#create-class_method" title="Tempfile.create (method)">.create</a> instead, which avoids the cost of delegation, does not rely on a finalizer, and also unlinks the file when given a block.</p>

<p><code>open</code> is still appropriate if you need the <code>Tempfile</code> to be unlinked by a finalizer and you cannot explicitly know where in the program the <code>Tempfile</code> can be unlinked safely.</p>

<p>If no block is given, this is a synonym for <a href="#new-class_method" title="Tempfile.new (method)">.new</a>.</p>

<p>If a block is given, then a <code>Tempfile</code> object will be constructed, and the block is run with the <code>Tempfile</code> object as argument. The Tempfile object will be automatically closed after the block terminates. However, the file will <strong>not</strong> be unlinked and needs to be manually unlinked with <a href="#close!-instance_method" title="Tempfile#close! (method)">#close!</a> or <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a>. The finalizer will try to unlink but should not be relied upon as it can keep the file on the disk much longer than intended. For instance, on CRuby, finalizers can be delayed due to conservative stack scanning and references left in unused memory.</p>

<p>The call returns the value of the block.</p>

<p>In any case, all arguments (<code>*args</code>) will be passed to <a href="#new-class_method" title="Tempfile.new (method)">.new</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span>.<span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home/temp</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
   <span class='comment'># ... do something with f ...
</span><span class='kw'>end</span>

<span class='comment'># Equivalent:
</span><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home/temp</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>begin</span>
   <span class='comment'># ... do something with f ...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_f'>f</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L439-L451'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='439' data-end='451'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 439</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_open'>open</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kw'>kw</span>)
  <span class='id identifier rubyid_tempfile'>tempfile</span> <span class='op'>=</span> <span class='id identifier rubyid_new'><a href="#new-class_method" title="Tempfile.new (method)">new</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kw'>kw</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span>(<span class='id identifier rubyid_tempfile'>tempfile</span>)
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_tempfile'>tempfile</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tempfile'>tempfile</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="finalizer_manager-instance_method">
  <h3 class='signature ro prot  nodoc first'>
    #<strong>finalizer_manager</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='prot'>protected</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L368-L368'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='368' data-end='368'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 368</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unlinked'><a href="#unlinked-instance_method" title="Tempfile#unlinked (method)">unlinked</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_finalizer_manager'>finalizer_manager</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="mode-instance_method">
  <h3 class='signature ro prot  nodoc'>
    #<strong>mode</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='prot'>protected</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L368-L368'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='368' data-end='368'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 368</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unlinked'><a href="#unlinked-instance_method" title="Tempfile#unlinked (method)">unlinked</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_mode'>mode</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_finalizer_manager'><a href="#finalizer_manager-instance_method" title="Tempfile#finalizer_manager (method)">finalizer_manager</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="opts-instance_method">
  <h3 class='signature ro prot  nodoc'>
    #<strong>opts</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='prot'>protected</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L368-L368'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='368' data-end='368'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 368</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unlinked'><a href="#unlinked-instance_method" title="Tempfile#unlinked (method)">unlinked</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_finalizer_manager'><a href="#finalizer_manager-instance_method" title="Tempfile#finalizer_manager (method)">finalizer_manager</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unlinked-instance_method">
  <h3 class='signature ro prot  nodoc'>
    #<strong>unlinked</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='prot'>protected</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L368-L368'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='368' data-end='368'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 368</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unlinked'>unlinked</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_finalizer_manager'><a href="#finalizer_manager-instance_method" title="Tempfile#finalizer_manager (method)">finalizer_manager</a></span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="_close-instance_method">
  <h3 class='signature prot  nodoc first'>
    #<strong>_close</strong>   <span class="extras">(<span class='prot'>protected</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L268-L270'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='268' data-end='270'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 268</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__close'>_close</span>    <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close-instance_method">
  <h3 class='signature '>
    #<strong>close</strong>(unlink_now = false)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Closes the file. If <code>unlink_now</code> is true, then the file will be unlinked (deleted) after closing. Of course, you can choose to later call <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a> if you do not unlink it now.</p>

<p>If you don’t explicitly unlink the temporary file, the removal will be delayed until the object is finalized.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L279-L282'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='279' data-end='282'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 279</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>(<span class='id identifier rubyid_unlink_now'>unlink_now</span><span class='op'>=</span><span class='kw'>false</span>)
  <span class='id identifier rubyid__close'><a href="#_close-instance_method" title="Tempfile#_close (method)">_close</a></span>
  <span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_unlink_now'>unlink_now</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close!-instance_method">
  <h3 class='signature '>
    #<strong>close!</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Closes and unlinks (deletes) the file. Has the same effect as called <code>close(true)</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L286-L288'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='286' data-end='288'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 286</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_close!'>close!</span>
  <span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>(<span class='kw'>true</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete-instance_method">
  <h3 class='signature '>
    #<strong>delete</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L337-L337'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='337' data-end='337'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 337</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_unlink'><a href="#unlink-instance_method" title="Tempfile#unlink (method)">unlink</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initialize_clone-instance_method">
  <h3 class='signature nodoc'>
    #<strong>initialize_clone</strong>(other)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L243-L247'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='243' data-end='247'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 243</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_clone'>initialize_clone</span>(<span class='id identifier rubyid_other'>other</span>) <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_initialize_copy_iv'><a href="#initialize_copy_iv-instance_method" title="Tempfile#initialize_copy_iv (method)">initialize_copy_iv</a></span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='kw'>super</span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='ivar'>@finalizer_manager</span>.<span class='id identifier rubyid_register'>register</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid___getobj__'>__getobj__</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initialize_copy_iv-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>initialize_copy_iv</strong>(other)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L249-L254'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='249' data-end='254'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 249</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_private'>private</span> <span class='kw'>def</span> <span class='id identifier rubyid_initialize_copy_iv'>initialize_copy_iv</span>(<span class='id identifier rubyid_other'>other</span>) <span class='comment'># :nodoc:
</span>  <span class='ivar'>@unlinked</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_unlinked'><a href="#unlinked-instance_method" title="Tempfile#unlinked (method)">unlinked</a></span>
  <span class='ivar'>@mode</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span>
  <span class='ivar'>@opts</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_opts'><a href="#opts-instance_method" title="Tempfile#opts (method)">opts</a></span>
  <span class='ivar'>@finalizer_manager</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_finalizer_manager'><a href="#finalizer_manager-instance_method" title="Tempfile#finalizer_manager (method)">finalizer_manager</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initialize_dup-instance_method">
  <h3 class='signature nodoc'>
    #<strong>initialize_dup</strong>(other)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L237-L241'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='237' data-end='241'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 237</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_dup'>initialize_dup</span>(<span class='id identifier rubyid_other'>other</span>) <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_initialize_copy_iv'><a href="#initialize_copy_iv-instance_method" title="Tempfile#initialize_copy_iv (method)">initialize_copy_iv</a></span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='kw'>super</span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='ivar'>@finalizer_manager</span>.<span class='id identifier rubyid_register'>register</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid___getobj__'>__getobj__</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature nodoc'>
    #<strong>inspect</strong>  
    <span class='aliases'>Also known as: <span class='names'>#to_s</span></span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L357-L363'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='357' data-end='363'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 357</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='kw'>if</span> <span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_closed?'>closed?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span><span class='embexpr_end'>}</span><span class='tstring_content'> (closed)&gt;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="length-instance_method">
  <h3 class='signature '>
    #<strong>length</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#size-instance_method" title="Tempfile#size (method)">#size</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L354-L354'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='354' data-end='354'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 354</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_length'>length</span> <span class='id identifier rubyid_size'><a href="#size-instance_method" title="Tempfile#size (method)">size</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="open-instance_method">
  <h3 class='signature '>
    #<strong>open</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Opens or reopens the file with mode “r+”.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L257-L266'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='257' data-end='266'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 257</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_open'>open</span>
  <span class='id identifier rubyid__close'><a href="#_close-instance_method" title="Tempfile#_close (method)">_close</a></span>

  <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span> <span class='op'>=</span> <span class='ivar'>@mode</span> <span class='op'>&amp;</span> <span class='op'>~</span>(<span class='const'>File</span><span class='op'>::</span><span class='const'>CREAT</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>EXCL</span>)
  <span class='id identifier rubyid___setobj__'>__setobj__</span>(<span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span><span class='comma'>,</span> <span class='id identifier rubyid_mode'><a href="#mode-instance_method" title="Tempfile#mode (method)">mode</a></span><span class='comma'>,</span> <span class='op'>**</span><span class='ivar'>@opts</span>))

  <span class='ivar'>@finalizer_manager</span>.<span class='id identifier rubyid_register'>register</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid___getobj__'>__getobj__</span>)

  <span class='id identifier rubyid___getobj__'>__getobj__</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="path-instance_method">
  <h3 class='signature '>
    #<strong>path</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the full path name of the temporary file. This will be nil if <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a> has been called.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L341-L343'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='341' data-end='343'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 341</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_path'>path</span>
  <span class='ivar'>@unlinked</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="size-instance_method">
  <h3 class='signature '>
    #<strong>size</strong>  
    <span class='aliases'>Also known as: <span class='names'>#length</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the size of the temporary file.  As a side effect, the IO buffer is flushed before determining the size.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L347-L353'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='347' data-end='353'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 347</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_closed?'>closed?</span>
    <span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_size'>size</span> <span class='comment'># File#size calls rb_io_flush_raw()
</span>  <span class='kw'>else</span>
    <span class='const'>File</span>.<span class='id identifier rubyid_size'>size</span>(<span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_s-instance_method">
  <h3 class='signature nodoc'>
    #<strong>to_s</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#inspect-instance_method" title="Tempfile#inspect (method)">#inspect</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L364-L364'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='364' data-end='364'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 364</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_to_s'>to_s</span> <span class='id identifier rubyid_inspect'><a href="#inspect-instance_method" title="Tempfile#inspect (method)">inspect</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unlink-instance_method">
  <h3 class='signature '>
    #<strong>unlink</strong>  
    <span class='aliases'>Also known as: <span class='names'>#delete</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Unlinks (deletes) the file from the filesystem. One should always unlink the file after using it, as is explained in the “Explicit close” good practice section in the <code>Tempfile</code> overview:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Tempfile.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>begin</span>
   <span class='comment'># ...do something with file...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="Tempfile#close (method)">close</a></span>
   <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_unlink'>unlink</span>   <span class='comment'># deletes the temp file
</span><span class='kw'>end</span></code></pre>

<h4 id="label-Unlink-before-close">Unlink-before-close</h4>

<p>On POSIX systems it’s possible to unlink a file before closing it. This practice is explained in detail in the <code>Tempfile</code> overview (section “Unlink after creation”); please refer there for more information.</p>

<p>However, unlink-before-close may not be supported on non-POSIX operating systems. Microsoft Windows is the most notable case: unlinking a non-closed file will result in an error, which this method will silently ignore. If you want to practice unlink-before-close whenever possible, then you should write code like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Tempfile.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_unlink'>unlink</span>   <span class='comment'># On Windows this silently fails.
</span><span class='kw'>begin</span>
   <span class='comment'># ... do something with file ...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_close!'><a href="#close!-instance_method" title="Tempfile#close! (method)">close!</a></span>   <span class='comment'># Closes the file handle. If the file wasn&#39;t unlinked
</span>                 <span class='comment'># because #unlink failed, then this method will attempt
</span>                 <span class='comment'># to do so again.
</span><span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/tempfile.rb#L323-L336'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='323' data-end='336'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/tempfile.rb', line 323</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unlink'>unlink</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@unlinked</span>
  <span class='kw'>begin</span>
    <span class='const'>File</span>.<span class='id identifier rubyid_unlink'>unlink</span>(<span class='id identifier rubyid___getobj__'>__getobj__</span>.<span class='id identifier rubyid_path'><a href="#path-instance_method" title="Tempfile#path (method)">path</a></span>)
  <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span>
  <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EACCES</span>
    <span class='comment'># may not be able to unlink on Windows; just ignore
</span>    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='ivar'>@finalizer_manager</span>.<span class='id identifier rubyid_unlinked'><a href="#unlinked-instance_method" title="Tempfile#unlinked (method)">unlinked</a></span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='ivar'>@unlinked</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>