<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Prism::Translation::Parser::Lexer &mdash; prism  Ruby-3.4.7 p58</title>

<link rel='stylesheet'  type='text/css' href='../../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Prism::Translation::Parser::Lexer",
    relpath = '../../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../../'>Ruby-3.4.7</a> &raquo; 
      <a href='../../../'>prism</a> &raquo; 
      <a href='../../../_index.html#alpha_L'>Index (L)</a> &raquo; 
        <a href="../../../Prism.html" title="Prism (module)">Prism</a> &raquo; 
        <a href="../../Translation.html" title="Prism::Translation (module)">Translation</a> &raquo; 
        <a href="../Parser.html" title="Prism::Translation::Parser (class)">Parser</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Lexer&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Prism::Translation::Parser::Lexer</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Lexer/HeredocData.html" title="Prism::Translation::Parser::Lexer::HeredocData (class)"><code>HeredocData</code></a>      </div>
    </td></tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L13'>lib/prism/translation/parser/lexer.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Accepts a list of prism tokens and converts them into the expected format for the parser gem.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='COMMENT_CONTINUATION_TYPES-constant' class='summary_signature priv'>COMMENT_CONTINUATION_TYPES =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Types of tokens that are allowed to continue a method call with comments in-between. For these, the parser gem doesnâ€™t emit a newline token after the last comment.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L211-L211'># File 'lib/prism/translation/parser/lexer.rb', line 211</a>    <pre class='code ruby'><span class='const'>Set</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Prism::Translation::Parser::Lexer.new (method)">new</a></span>([<span class='symbeg'>:</span><span class='const'>COMMENT</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>AMPERSAND_DOT</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>DOT</span>])</pre>
  </li>
  <li>
    <span id='DELIMITER_SYMETRY-constant' class='summary_signature priv'>DELIMITER_SYMETRY =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>When one of these delimiters is encountered, then the other one is allowed to be escaped as well.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L666-L666'># File 'lib/prism/translation/parser/lexer.rb', line 666</a>    <pre class='code ruby'>{ <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span> }.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='ESCAPES-constant' class='summary_signature priv'>ESCAPES =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Escape sequences that have special and should appear unescaped in the resulting string.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L657-L661'># File 'lib/prism/translation/parser/lexer.rb', line 657</a>    <pre class='code ruby'>{
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>e</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\e</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\f</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\s</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\v</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>
}.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='EXPR_BEG-constant' class='summary_signature priv nodoc'>EXPR_BEG =</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>These constants represent flags in our lex state. We really, really donâ€™t want to be using them and we really, really donâ€™t want to be exposing them as part of our public API. Unfortunately, we donâ€™t have another way of matching the exact tokens that the parser gem expects without them. We should find another way to do this, but in the meantime weâ€™ll hide them from the documentation and mark them as private constants.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L193-L193'># File 'lib/prism/translation/parser/lexer.rb', line 193</a>    <pre class='code ruby'><span class='int'>0x1</span></pre>
  </li>
  <li>
    <span id='EXPR_LABEL-constant' class='summary_signature priv nodoc'>EXPR_LABEL =</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L194-L194'># File 'lib/prism/translation/parser/lexer.rb', line 194</a>    <pre class='code ruby'><span class='int'>0x400</span></pre>
  </li>
  <li>
    <span id='LAMBDA_TOKEN_TYPES-constant' class='summary_signature priv'>LAMBDA_TOKEN_TYPES =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>It is used to determine whether <code>do</code> is of the token type <code>kDO</code> or <code>kDO_LAMBDA</code>.</p>

<p>NOTE: In edge cases like <code>-&gt; (foo = -&gt; (bar) {}) do end</code>, please note that <code>kDO</code> is still returned instead of <code>kDO_LAMBDA</code>, which is expected: <a href="https://github.com/ruby/prism/pull/3046">github.com/ruby/prism/pull/3046</a></p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L200-L200'># File 'lib/prism/translation/parser/lexer.rb', line 200</a>    <pre class='code ruby'><span class='const'>Set</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Prism::Translation::Parser::Lexer.new (method)">new</a></span>([<span class='symbeg'>:</span><span class='id identifier rubyid_kDO_LAMBDA'>kDO_LAMBDA</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLAMBDA'>tLAMBDA</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLAMBEG'>tLAMBEG</span>])</pre>
  </li>
  <li>
    <span id='LPAREN_CONVERSION_TOKEN_TYPES-constant' class='summary_signature priv'>LPAREN_CONVERSION_TOKEN_TYPES =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The <code>PARENTHESIS_LEFT</code> token in <a href="../../../Prism.html" title="Prism (module)"><code>::Prism</code></a> is classified as either <code>tLPAREN</code> or <code>tLPAREN2</code> in the <a href="../Parser.html" title="Prism::Translation::Parser (class)"><code>::Prism::Translation::Parser</code></a> gem. The following token types are listed as those classified as <code>tLPAREN</code>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L204-L207'># File 'lib/prism/translation/parser/lexer.rb', line 204</a>    <pre class='code ruby'><span class='const'>Set</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Prism::Translation::Parser::Lexer.new (method)">new</a></span>([
  <span class='symbeg'>:</span><span class='id identifier rubyid_kBREAK'>kBREAK</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCARET'>tCARET</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kCASE'>kCASE</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDIVIDE'>tDIVIDE</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kFOR'>kFOR</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kIF'>kIF</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kNEXT'>kNEXT</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kRETURN'>kRETURN</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kUNTIL'>kUNTIL</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kWHILE'>kWHILE</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tAMPER'>tAMPER</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tANDOP'>tANDOP</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tBANG'>tBANG</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOMMA'>tCOMMA</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDOT2'>tDOT2</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDOT3'>tDOT3</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_tEQL'>tEQL</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLPAREN'>tLPAREN</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLPAREN2'>tLPAREN2</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLPAREN_ARG'>tLPAREN_ARG</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLSHFT'>tLSHFT</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tNL'>tNL</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOROP'>tOROP</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tPIPE'>tPIPE</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSEMI'>tSEMI</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_DBEG'>tSTRING_DBEG</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tUMINUS'>tUMINUS</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tUPLUS'>tUPLUS</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLCURLY'>tLCURLY</span>
])</pre>
  </li>
  <li>
    <span id='REGEXP_META_CHARACTERS-constant' class='summary_signature priv'>REGEXP_META_CHARACTERS =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><a href="https://github.com/whitequark/parser/blob/v3.3.6.0/lib/parser/lexer-strings.rl#L14">github.com/whitequark/parser/blob/v3.3.6.0/lib/parser/lexer-strings.rl#L14</a></p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L671-L671'># File 'lib/prism/translation/parser/lexer.rb', line 671</a>    <pre class='code ruby'>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>^</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>}</span><span class='tstring_end'>&quot;</span></span>]</pre>
  </li>
  <li>
    <span id='Range-constant' class='summary_signature priv nodoc'>Range =</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L237-L237'># File 'lib/prism/translation/parser/lexer.rb', line 237</a>    <pre class='code ruby'><span class='op'>::</span><span class='const'><a href="../Parser.html" title="Prism::Translation::Parser (class)">Parser</a></span><span class='op'>::</span><span class='const'><a href="../../Source.html" title="Prism::Source (class)">Source</a></span><span class='op'>::</span><span class='const'><a href="#Range-constant" title="Prism::Translation::Parser::Lexer::Range (constant)">Range</a></span></pre>
  </li>
  <li>
    <span id='TYPES-constant' class='summary_signature priv'>TYPES =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The direct translating of types between the two lexers.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L19-L184'># File 'lib/prism/translation/parser/lexer.rb', line 19</a>    <pre class='code ruby'>{
  <span class='comment'># These tokens should never appear in the output of the lexer.
</span>  <span class='label'>MISSING:</span> <span class='kw'>nil</span><span class='comma'>,</span>
  <span class='label'>NOT_PROVIDED:</span> <span class='kw'>nil</span><span class='comma'>,</span>
  <span class='label'>EMBDOC_END:</span> <span class='kw'>nil</span><span class='comma'>,</span>
  <span class='label'>EMBDOC_LINE:</span> <span class='kw'>nil</span><span class='comma'>,</span>

  <span class='comment'># These tokens have more or less direct mappings.
</span>  <span class='label'>AMPERSAND:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tAMPER2'>tAMPER2</span><span class='comma'>,</span>
  <span class='label'>AMPERSAND_AMPERSAND:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tANDOP'>tANDOP</span><span class='comma'>,</span>
  <span class='label'>AMPERSAND_AMPERSAND_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>AMPERSAND_DOT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tANDDOT'>tANDDOT</span><span class='comma'>,</span>
  <span class='label'>AMPERSAND_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>BACK_REFERENCE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tBACK_REF'>tBACK_REF</span><span class='comma'>,</span>
  <span class='label'>BACKTICK:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tXSTRING_BEG'>tXSTRING_BEG</span><span class='comma'>,</span>
  <span class='label'>BANG:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tBANG'>tBANG</span><span class='comma'>,</span>
  <span class='label'>BANG_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tNEQ'>tNEQ</span><span class='comma'>,</span>
  <span class='label'>BANG_TILDE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tNMATCH'>tNMATCH</span><span class='comma'>,</span>
  <span class='label'>BRACE_LEFT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLCURLY'>tLCURLY</span><span class='comma'>,</span>
  <span class='label'>BRACE_RIGHT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tRCURLY'>tRCURLY</span><span class='comma'>,</span>
  <span class='label'>BRACKET_LEFT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLBRACK2'>tLBRACK2</span><span class='comma'>,</span>
  <span class='label'>BRACKET_LEFT_ARRAY:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLBRACK'>tLBRACK</span><span class='comma'>,</span>
  <span class='label'>BRACKET_LEFT_RIGHT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tAREF'>tAREF</span><span class='comma'>,</span>
  <span class='label'>BRACKET_LEFT_RIGHT_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tASET'>tASET</span><span class='comma'>,</span>
  <span class='label'>BRACKET_RIGHT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tRBRACK'>tRBRACK</span><span class='comma'>,</span>
  <span class='label'>CARET:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCARET'>tCARET</span><span class='comma'>,</span>
  <span class='label'>CARET_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>CHARACTER_LITERAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCHARACTER'>tCHARACTER</span><span class='comma'>,</span>
  <span class='label'>CLASS_VARIABLE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCVAR'>tCVAR</span><span class='comma'>,</span>
  <span class='label'>COLON:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOLON'>tCOLON</span><span class='comma'>,</span>
  <span class='label'>COLON_COLON:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOLON2'>tCOLON2</span><span class='comma'>,</span>
  <span class='label'>COMMA:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOMMA'>tCOMMA</span><span class='comma'>,</span>
  <span class='label'>COMMENT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOMMENT'>tCOMMENT</span><span class='comma'>,</span>
  <span class='label'>CONSTANT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCONSTANT'>tCONSTANT</span><span class='comma'>,</span>
  <span class='label'>DOT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDOT'>tDOT</span><span class='comma'>,</span>
  <span class='label'>DOT_DOT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDOT2'>tDOT2</span><span class='comma'>,</span>
  <span class='label'>DOT_DOT_DOT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDOT3'>tDOT3</span><span class='comma'>,</span>
  <span class='label'>EMBDOC_BEGIN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOMMENT'>tCOMMENT</span><span class='comma'>,</span>
  <span class='label'>EMBEXPR_BEGIN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_DBEG'>tSTRING_DBEG</span><span class='comma'>,</span>
  <span class='label'>EMBEXPR_END:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_DEND'>tSTRING_DEND</span><span class='comma'>,</span>
  <span class='label'>EMBVAR:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_DVAR'>tSTRING_DVAR</span><span class='comma'>,</span>
  <span class='label'>EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tEQL'>tEQL</span><span class='comma'>,</span>
  <span class='label'>EQUAL_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tEQ'>tEQ</span><span class='comma'>,</span>
  <span class='label'>EQUAL_EQUAL_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tEQQ'>tEQQ</span><span class='comma'>,</span>
  <span class='label'>EQUAL_GREATER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tASSOC'>tASSOC</span><span class='comma'>,</span>
  <span class='label'>EQUAL_TILDE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tMATCH'>tMATCH</span><span class='comma'>,</span>
  <span class='label'>FLOAT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tFLOAT'>tFLOAT</span><span class='comma'>,</span>
  <span class='label'>FLOAT_IMAGINARY:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIMAGINARY'>tIMAGINARY</span><span class='comma'>,</span>
  <span class='label'>FLOAT_RATIONAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tRATIONAL'>tRATIONAL</span><span class='comma'>,</span>
  <span class='label'>FLOAT_RATIONAL_IMAGINARY:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIMAGINARY'>tIMAGINARY</span><span class='comma'>,</span>
  <span class='label'>GLOBAL_VARIABLE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tGVAR'>tGVAR</span><span class='comma'>,</span>
  <span class='label'>GREATER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tGT'>tGT</span><span class='comma'>,</span>
  <span class='label'>GREATER_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tGEQ'>tGEQ</span><span class='comma'>,</span>
  <span class='label'>GREATER_GREATER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tRSHFT'>tRSHFT</span><span class='comma'>,</span>
  <span class='label'>GREATER_GREATER_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>HEREDOC_START:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_BEG'>tSTRING_BEG</span><span class='comma'>,</span>
  <span class='label'>HEREDOC_END:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_END'>tSTRING_END</span><span class='comma'>,</span>
  <span class='label'>IDENTIFIER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIDENTIFIER'>tIDENTIFIER</span><span class='comma'>,</span>
  <span class='label'>INSTANCE_VARIABLE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIVAR'>tIVAR</span><span class='comma'>,</span>
  <span class='label'>INTEGER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tINTEGER'>tINTEGER</span><span class='comma'>,</span>
  <span class='label'>INTEGER_IMAGINARY:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIMAGINARY'>tIMAGINARY</span><span class='comma'>,</span>
  <span class='label'>INTEGER_RATIONAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tRATIONAL'>tRATIONAL</span><span class='comma'>,</span>
  <span class='label'>INTEGER_RATIONAL_IMAGINARY:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIMAGINARY'>tIMAGINARY</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_ALIAS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kALIAS'>kALIAS</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_AND:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kAND'>kAND</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_BEGIN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kBEGIN'>kBEGIN</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_BEGIN_UPCASE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_klBEGIN'>klBEGIN</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_BREAK:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kBREAK'>kBREAK</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_CASE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kCASE'>kCASE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_CLASS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kCLASS'>kCLASS</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_DEF:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kDEF'>kDEF</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_DEFINED:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kDEFINED'>kDEFINED</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_DO:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kDO'>kDO</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_DO_LOOP:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kDO_COND'>kDO_COND</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_END:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kEND'>kEND</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_END_UPCASE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_klEND'>klEND</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_ENSURE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kENSURE'>kENSURE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_ELSE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kELSE'>kELSE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_ELSIF:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kELSIF'>kELSIF</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_FALSE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kFALSE'>kFALSE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_FOR:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kFOR'>kFOR</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_IF:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kIF'>kIF</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_IF_MODIFIER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kIF_MOD'>kIF_MOD</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_IN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kIN'>kIN</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_MODULE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kMODULE'>kMODULE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_NEXT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kNEXT'>kNEXT</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_NIL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kNIL'>kNIL</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_NOT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kNOT'>kNOT</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_OR:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kOR'>kOR</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_REDO:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kREDO'>kREDO</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_RESCUE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kRESCUE'>kRESCUE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_RESCUE_MODIFIER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kRESCUE_MOD'>kRESCUE_MOD</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_RETRY:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kRETRY'>kRETRY</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_RETURN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kRETURN'>kRETURN</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_SELF:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kSELF'>kSELF</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_SUPER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kSUPER'>kSUPER</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_THEN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kTHEN'>kTHEN</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_TRUE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kTRUE'>kTRUE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_UNDEF:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kUNDEF'>kUNDEF</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_UNLESS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kUNLESS'>kUNLESS</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_UNLESS_MODIFIER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kUNLESS_MOD'>kUNLESS_MOD</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_UNTIL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kUNTIL'>kUNTIL</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_UNTIL_MODIFIER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kUNTIL_MOD'>kUNTIL_MOD</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_WHEN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kWHEN'>kWHEN</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_WHILE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kWHILE'>kWHILE</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_WHILE_MODIFIER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kWHILE_MOD'>kWHILE_MOD</span><span class='comma'>,</span>
  <span class='label'>KEYWORD_YIELD:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kYIELD'>kYIELD</span><span class='comma'>,</span>
  <span class='label'>KEYWORD___ENCODING__:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_k__ENCODING__'>k__ENCODING__</span><span class='comma'>,</span>
  <span class='label'>KEYWORD___FILE__:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_k__FILE__'>k__FILE__</span><span class='comma'>,</span>
  <span class='label'>KEYWORD___LINE__:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_k__LINE__'>k__LINE__</span><span class='comma'>,</span>
  <span class='label'>LABEL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLABEL'>tLABEL</span><span class='comma'>,</span>
  <span class='label'>LABEL_END:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLABEL_END'>tLABEL_END</span><span class='comma'>,</span>
  <span class='label'>LAMBDA_BEGIN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLAMBEG'>tLAMBEG</span><span class='comma'>,</span>
  <span class='label'>LESS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLT'>tLT</span><span class='comma'>,</span>
  <span class='label'>LESS_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLEQ'>tLEQ</span><span class='comma'>,</span>
  <span class='label'>LESS_EQUAL_GREATER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCMP'>tCMP</span><span class='comma'>,</span>
  <span class='label'>LESS_LESS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLSHFT'>tLSHFT</span><span class='comma'>,</span>
  <span class='label'>LESS_LESS_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>METHOD_NAME:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tFID'>tFID</span><span class='comma'>,</span>
  <span class='label'>MINUS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tMINUS'>tMINUS</span><span class='comma'>,</span>
  <span class='label'>MINUS_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>MINUS_GREATER:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLAMBDA'>tLAMBDA</span><span class='comma'>,</span>
  <span class='label'>NEWLINE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tNL'>tNL</span><span class='comma'>,</span>
  <span class='label'>NUMBERED_REFERENCE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tNTH_REF'>tNTH_REF</span><span class='comma'>,</span>
  <span class='label'>PARENTHESIS_LEFT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLPAREN2'>tLPAREN2</span><span class='comma'>,</span>
  <span class='label'>PARENTHESIS_LEFT_PARENTHESES:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLPAREN_ARG'>tLPAREN_ARG</span><span class='comma'>,</span>
  <span class='label'>PARENTHESIS_RIGHT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tRPAREN'>tRPAREN</span><span class='comma'>,</span>
  <span class='label'>PERCENT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tPERCENT'>tPERCENT</span><span class='comma'>,</span>
  <span class='label'>PERCENT_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>PERCENT_LOWER_I:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tQSYMBOLS_BEG'>tQSYMBOLS_BEG</span><span class='comma'>,</span>
  <span class='label'>PERCENT_LOWER_W:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tQWORDS_BEG'>tQWORDS_BEG</span><span class='comma'>,</span>
  <span class='label'>PERCENT_UPPER_I:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSYMBOLS_BEG'>tSYMBOLS_BEG</span><span class='comma'>,</span>
  <span class='label'>PERCENT_UPPER_W:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tWORDS_BEG'>tWORDS_BEG</span><span class='comma'>,</span>
  <span class='label'>PERCENT_LOWER_X:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tXSTRING_BEG'>tXSTRING_BEG</span><span class='comma'>,</span>
  <span class='label'>PLUS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tPLUS'>tPLUS</span><span class='comma'>,</span>
  <span class='label'>PLUS_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>PIPE_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>PIPE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tPIPE'>tPIPE</span><span class='comma'>,</span>
  <span class='label'>PIPE_PIPE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOROP'>tOROP</span><span class='comma'>,</span>
  <span class='label'>PIPE_PIPE_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>QUESTION_MARK:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tEH'>tEH</span><span class='comma'>,</span>
  <span class='label'>REGEXP_BEGIN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tREGEXP_BEG'>tREGEXP_BEG</span><span class='comma'>,</span>
  <span class='label'>REGEXP_END:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_END'>tSTRING_END</span><span class='comma'>,</span>
  <span class='label'>SEMICOLON:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSEMI'>tSEMI</span><span class='comma'>,</span>
  <span class='label'>SLASH:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDIVIDE'>tDIVIDE</span><span class='comma'>,</span>
  <span class='label'>SLASH_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>STAR:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTAR2'>tSTAR2</span><span class='comma'>,</span>
  <span class='label'>STAR_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>STAR_STAR:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tPOW'>tPOW</span><span class='comma'>,</span>
  <span class='label'>STAR_STAR_EQUAL:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span><span class='comma'>,</span>
  <span class='label'>STRING_BEGIN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_BEG'>tSTRING_BEG</span><span class='comma'>,</span>
  <span class='label'>STRING_CONTENT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_CONTENT'>tSTRING_CONTENT</span><span class='comma'>,</span>
  <span class='label'>STRING_END:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_END'>tSTRING_END</span><span class='comma'>,</span>
  <span class='label'>SYMBOL_BEGIN:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSYMBEG'>tSYMBEG</span><span class='comma'>,</span>
  <span class='label'>TILDE:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tTILDE'>tTILDE</span><span class='comma'>,</span>
  <span class='label'>UAMPERSAND:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tAMPER'>tAMPER</span><span class='comma'>,</span>
  <span class='label'>UCOLON_COLON:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOLON3'>tCOLON3</span><span class='comma'>,</span>
  <span class='label'>UDOT_DOT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tBDOT2'>tBDOT2</span><span class='comma'>,</span>
  <span class='label'>UDOT_DOT_DOT:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tBDOT3'>tBDOT3</span><span class='comma'>,</span>
  <span class='label'>UMINUS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tUMINUS'>tUMINUS</span><span class='comma'>,</span>
  <span class='label'>UMINUS_NUM:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tUNARY_NUM'>tUNARY_NUM</span><span class='comma'>,</span>
  <span class='label'>UPLUS:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tUPLUS'>tUPLUS</span><span class='comma'>,</span>
  <span class='label'>USTAR:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTAR'>tSTAR</span><span class='comma'>,</span>
  <span class='label'>USTAR_STAR:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tDSTAR'>tDSTAR</span><span class='comma'>,</span>
  <span class='label'>WORDS_SEP:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSPACE'>tSPACE</span>
}</pre>
  </li>
  <li>
    <span id='TYPES_ALWAYS_SKIP-constant' class='summary_signature priv'>TYPES_ALWAYS_SKIP =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>These tokens are always skipped</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L15-L15'># File 'lib/prism/translation/parser/lexer.rb', line 15</a>    <pre class='code ruby'><span class='const'>Set</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Prism::Translation::Parser::Lexer.new (method)">new</a></span>(<span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>IGNORED_NEWLINE</span><span class='words_sep'> </span><span class='tstring_content'>__END__</span><span class='words_sep'> </span><span class='tstring_content'>EOF</span><span class='tstring_end'>]</span></span>)</pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(source_buffer, lexed, offset_cache)  &#x21d2; Lexer </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Initialize the lexer with the given source buffer, prism tokens, and offset cache.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#lexed-instance_method" title="#lexed (instance method)">#<strong>lexed</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>An array of tuples that contain prism tokens and their associated lex state when they were lexed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#offset_cache-instance_method" title="#offset_cache (instance method)">#<strong>offset_cache</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>A hash that maps offsets in bytes to offsets in characters.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#source_buffer-instance_method" title="#source_buffer (instance method)">#<strong>source_buffer</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>The <code>Parser::Source::Buffer</code> that the tokens were lexed from.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#to_a-instance_method" title="#to_a (instance method)">#<strong>to_a</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Convert the prism tokens into the expected format for the parser gem.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#calculate_heredoc_whitespace-instance_method" title="#calculate_heredoc_whitespace (instance method)">#<strong>calculate_heredoc_whitespace</strong>(heredoc_token_index)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Wonky heredoc tab/spaces rules.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#escape_build-instance_method" title="#escape_build (instance method)">#<strong>escape_build</strong>(value, control, meta)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Escape a byte value, given the control and meta flags.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#escape_read-instance_method" title="#escape_read (instance method)">#<strong>escape_read</strong>(result, scanner, control, meta)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Read an escape out of the string scanner, given the control and meta flags, and push the unescaped value into the result.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#interpolation%3F-instance_method" title="#interpolation? (instance method)">#<strong>interpolation?</strong>(quote)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Determine if characters preceeded by a backslash should be escaped or not.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_complex-instance_method" title="#parse_complex (instance method)">#<strong>parse_complex</strong>(value)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parse a complex from the string representation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_float-instance_method" title="#parse_float (instance method)">#<strong>parse_float</strong>(value)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parse a float from the string representation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_integer-instance_method" title="#parse_integer (instance method)">#<strong>parse_integer</strong>(value)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parse an integer from the string representation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_rational-instance_method" title="#parse_rational (instance method)">#<strong>parse_rational</strong>(value)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parse a rational from the string representation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#percent_array%3F-instance_method" title="#percent_array? (instance method)">#<strong>percent_array?</strong>(quote)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Determine if the string is part of a %-style array.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#percent_array_leading_whitespace-instance_method" title="#percent_array_leading_whitespace (instance method)">#<strong>percent_array_leading_whitespace</strong>(string)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>For %-arrays whitespace, the parser gem only considers whitespace before the newline.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#percent_array_unescape-instance_method" title="#percent_array_unescape (instance method)">#<strong>percent_array_unescape</strong>(string)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>In a percent array, certain whitespace can be preceeded with a backslash, causing the following characters to be part of the previous element.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#range-instance_method" title="#range (instance method)">#<strong>range</strong>(start_offset, end_offset)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a new parser range, taking prisms byte offsets into account.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#regexp%3F-instance_method" title="#regexp? (instance method)">#<strong>regexp?</strong>(quote)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Regexp allow interpolation but are handled differently during unescaping.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#simplify_string%3F-instance_method" title="#simplify_string? (instance method)">#<strong>simplify_string?</strong>(value, quote)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Certain strings are merged into a single string token.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#trim_heredoc_whitespace-instance_method" title="#trim_heredoc_whitespace (instance method)">#<strong>trim_heredoc_whitespace</strong>(string, heredoc)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Wonky heredoc tab/spaces rules.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#unescape_string-instance_method" title="#unescape_string (instance method)">#<strong>unescape_string</strong>(string, quote)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Apply Ruby string escaping rules.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(source_buffer, lexed, offset_cache)  &#x21d2; <code>Lexer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Initialize the lexer with the given source buffer, prism tokens, and offset cache.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L231-L235'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='231' data-end='235'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 231</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_source_buffer'><a href="#source_buffer-instance_method" title="Prism::Translation::Parser::Lexer#source_buffer (method)">source_buffer</a></span><span class='comma'>,</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span><span class='comma'>,</span> <span class='id identifier rubyid_offset_cache'><a href="#offset_cache-instance_method" title="Prism::Translation::Parser::Lexer#offset_cache (method)">offset_cache</a></span>)
  <span class='ivar'>@source_buffer</span> <span class='op'>=</span> <span class='id identifier rubyid_source_buffer'><a href="#source_buffer-instance_method" title="Prism::Translation::Parser::Lexer#source_buffer (method)">source_buffer</a></span>
  <span class='ivar'>@lexed</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>
  <span class='ivar'>@offset_cache</span> <span class='op'>=</span> <span class='id identifier rubyid_offset_cache'><a href="#offset_cache-instance_method" title="Prism::Translation::Parser::Lexer#offset_cache (method)">offset_cache</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="lexed-instance_method">
  <h3 class='signature ro first'>
    #<strong>lexed</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>An array of tuples that contain prism tokens and their associated lex state when they were lexed.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L224-L224'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='224' data-end='224'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 224</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_lexed'>lexed</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="offset_cache-instance_method">
  <h3 class='signature ro'>
    #<strong>offset_cache</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A hash that maps offsets in bytes to offsets in characters.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L227-L227'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='227' data-end='227'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 227</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_offset_cache'>offset_cache</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="source_buffer-instance_method">
  <h3 class='signature ro'>
    #<strong>source_buffer</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The <code>Parser::Source::Buffer</code> that the tokens were lexed from.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L220-L220'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='220' data-end='220'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 220</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_source_buffer'>source_buffer</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="calculate_heredoc_whitespace-instance_method">
  <h3 class='signature priv first'>
    #<strong>calculate_heredoc_whitespace</strong>(heredoc_token_index)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Wonky heredoc tab/spaces rules. <a href="https://github.com/ruby/prism/blob/v1.3.0/src/prism.c#L10548-L10558">github.com/ruby/prism/blob/v1.3.0/src/prism.c#L10548-L10558</a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L593-L636'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='593' data-end='636'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 593</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_calculate_heredoc_whitespace'>calculate_heredoc_whitespace</span>(<span class='id identifier rubyid_heredoc_token_index'>heredoc_token_index</span>)
  <span class='id identifier rubyid_next_token_index'>next_token_index</span> <span class='op'>=</span> <span class='id identifier rubyid_heredoc_token_index'>heredoc_token_index</span>
  <span class='id identifier rubyid_nesting_level'>nesting_level</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_previous_line'>previous_line</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>Float</span><span class='op'>::</span><span class='const'>MAX</span>

  <span class='kw'>while</span> (<span class='id identifier rubyid_next_token'>next_token</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_next_token_index'>next_token_index</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_first'>first</span>)
    <span class='id identifier rubyid_next_token_index'>next_token_index</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_next_next_token'>next_next_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_next_token_index'>next_token_index</span>]
    <span class='id identifier rubyid_first_token_on_line'>first_token_on_line</span> <span class='op'>=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_column'>start_column</span> <span class='op'>==</span> <span class='int'>0</span>

    <span class='comment'># String content inside nested heredocs and interpolation is ignored
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>HEREDOC_START</span> <span class='op'>||</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>EMBEXPR_BEGIN</span>
      <span class='comment'># When interpolation is the first token of a line there is no string
</span>      <span class='comment'># content to check against. There will be no common whitespace.
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_nesting_level'>nesting_level</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_first_token_on_line'>first_token_on_line</span>
        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_nesting_level'>nesting_level</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>HEREDOC_END</span> <span class='op'>||</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>EMBEXPR_END</span>
      <span class='id identifier rubyid_nesting_level'>nesting_level</span> <span class='op'>-=</span> <span class='int'>1</span>
      <span class='comment'># When we encountered the matching heredoc end, we can exit
</span>      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_nesting_level'>nesting_level</span> <span class='op'>==</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>STRING_CONTENT</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_nesting_level'>nesting_level</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_first_token_on_line'>first_token_on_line</span>
      <span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_value'>value</span>[<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\s*</span><span class='regexp_end'>/</span></span>].<span class='id identifier rubyid_each_char'>each_char</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_char'>char</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_char'>char</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>=</span> (<span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>/</span> <span class='int'>8</span> <span class='op'>+</span> <span class='int'>1</span>) <span class='op'>*</span> <span class='int'>8</span><span class='semicolon'>;</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_is_first_token_on_line'>is_first_token_on_line</span> <span class='op'>=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_line'>start_line</span> <span class='op'>!=</span> <span class='id identifier rubyid_previous_line'>previous_line</span>
      <span class='comment'># Whitespace is significant if followed by interpolation
</span>      <span class='id identifier rubyid_whitespace_only'>whitespace_only</span> <span class='op'>=</span> <span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>==</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_next_token'>next_next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_location'>location</span><span class='op'>&amp;.</span><span class='id identifier rubyid_start_line'>start_line</span> <span class='op'>!=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_line'>start_line</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_is_first_token_on_line'>is_first_token_on_line</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_whitespace_only'>whitespace_only</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_result'>result</span>
        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_common_whitespace'>common_whitespace</span>
        <span class='id identifier rubyid_previous_line'>previous_line</span> <span class='op'>=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_line'>start_line</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="escape_build-instance_method">
  <h3 class='signature priv'>
    #<strong>escape_build</strong>(value, control, meta)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Escape a byte value, given the control and meta flags.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L735-L739'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='735' data-end='739'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 735</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_escape_build'>escape_build</span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_control'>control</span><span class='comma'>,</span> <span class='id identifier rubyid_meta'>meta</span>)
  <span class='id identifier rubyid_value'>value</span> <span class='op'>&amp;=</span> <span class='int'>0x9f</span> <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span>
  <span class='id identifier rubyid_value'>value</span> <span class='op'>|=</span> <span class='int'>0x80</span> <span class='kw'>if</span> <span class='id identifier rubyid_meta'>meta</span>
  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="escape_read-instance_method">
  <h3 class='signature priv'>
    #<strong>escape_read</strong>(result, scanner, control, meta)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Read an escape out of the string scanner, given the control and meta flags, and push the unescaped value into the result.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L743-L780'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='743' data-end='780'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 743</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_escape_read'>escape_read</span>(<span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_scanner'>scanner</span><span class='comma'>,</span> <span class='id identifier rubyid_control'>control</span><span class='comma'>,</span> <span class='id identifier rubyid_meta'>meta</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_skip'>skip</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>)
    <span class='comment'># Line continuation
</span>  <span class='kw'>elsif</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='const'><a href="#ESCAPES-constant" title="Prism::Translation::Parser::Lexer::ESCAPES (constant)">ESCAPES</a></span>[<span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_peek'>peek</span>(<span class='int'>1</span>)])
    <span class='comment'># Simple single-character escape sequences like \n
</span>    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_pos'>pos</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>elsif</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[0-7]{1,3}</span><span class='regexp_end'>/</span></span>))
    <span class='comment'># \nnn
</span>    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_escape_build'><a href="#escape_build-instance_method" title="Prism::Translation::Parser::Lexer#escape_build (method)">escape_build</a></span>(<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_i'>to_i</span>(<span class='int'>8</span>)<span class='comma'>,</span> <span class='id identifier rubyid_control'>control</span><span class='comma'>,</span> <span class='id identifier rubyid_meta'>meta</span>))
  <span class='kw'>elsif</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>x[0-9a-fA-F]{1,2}</span><span class='regexp_end'>/</span></span>))
    <span class='comment'># \xnn
</span>    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_escape_build'><a href="#escape_build-instance_method" title="Prism::Translation::Parser::Lexer#escape_build (method)">escape_build</a></span>(<span class='id identifier rubyid_value'>value</span>[<span class='int'>1</span><span class='op'>..</span>].<span class='id identifier rubyid_to_i'>to_i</span>(<span class='int'>16</span>)<span class='comma'>,</span> <span class='id identifier rubyid_control'>control</span><span class='comma'>,</span> <span class='id identifier rubyid_meta'>meta</span>))
  <span class='kw'>elsif</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>u[0-9a-fA-F]{4}</span><span class='regexp_end'>/</span></span>))
    <span class='comment'># \unnnn
</span>    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_value'>value</span>[<span class='int'>1</span><span class='op'>..</span>].<span class='id identifier rubyid_hex'>hex</span>.<span class='id identifier rubyid_chr'>chr</span>(<span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_8</span>))
  <span class='kw'>elsif</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_skip'>skip</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>u{}</span><span class='tstring_end'>&quot;</span></span>)
    <span class='comment'># https://github.com/whitequark/parser/issues/856
</span>  <span class='kw'>elsif</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>u{.*?}</span><span class='regexp_end'>/</span></span>))
    <span class='comment'># \u{nnnn ...}
</span>    <span class='id identifier rubyid_value'>value</span>[<span class='int'>2</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span>].<span class='id identifier rubyid_split'>split</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_unicode'>unicode</span><span class='op'>|</span>
      <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_unicode'>unicode</span>.<span class='id identifier rubyid_hex'>hex</span>.<span class='id identifier rubyid_chr'>chr</span>(<span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_8</span>))
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>c\\?(?=[[:print:]])|C-\\?(?=[[:print:]])</span><span class='regexp_end'>/</span></span>))
    <span class='comment'># \cx or \C-x where x is an ASCII printable character
</span>    <span class='id identifier rubyid_escape_read'>escape_read</span>(<span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_scanner'>scanner</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='id identifier rubyid_meta'>meta</span>)
  <span class='kw'>elsif</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>M-\\?(?=[[:print:]])</span><span class='regexp_end'>/</span></span>))
    <span class='comment'># \M-x where x is an ASCII printable character
</span>    <span class='id identifier rubyid_escape_read'>escape_read</span>(<span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_scanner'>scanner</span><span class='comma'>,</span> <span class='id identifier rubyid_control'>control</span><span class='comma'>,</span> <span class='kw'>true</span>)
  <span class='kw'>elsif</span> (<span class='id identifier rubyid_byte'>byte</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_scan_byte'>scan_byte</span>)
    <span class='comment'># Something else after an escape.
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_byte'>byte</span> <span class='op'>==</span> <span class='int'>0x3f</span> <span class='comment'># ASCII &#39;?&#39;
</span>      <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_escape_build'><a href="#escape_build-instance_method" title="Prism::Translation::Parser::Lexer#escape_build (method)">escape_build</a></span>(<span class='int'>0x7f</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_meta'>meta</span>))
    <span class='kw'>else</span>
      <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_escape_build'><a href="#escape_build-instance_method" title="Prism::Translation::Parser::Lexer#escape_build (method)">escape_build</a></span>(<span class='id identifier rubyid_byte'>byte</span><span class='comma'>,</span> <span class='id identifier rubyid_control'>control</span><span class='comma'>,</span> <span class='id identifier rubyid_meta'>meta</span>))
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="interpolation?-instance_method">
  <h3 class='signature priv'>
    #<strong>interpolation?</strong>(quote)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Determine if characters preceeded by a backslash should be escaped or not</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L804-L806'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='804' data-end='806'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 804</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_interpolation?'>interpolation?</span>(<span class='id identifier rubyid_quote'>quote</span>)
  <span class='op'>!</span><span class='id identifier rubyid_quote'>quote</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_quote'>quote</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%q</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%w</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%i</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%s</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_complex-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_complex</strong>(value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parse a complex from the string representation.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L564-L576'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='564' data-end='576'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 564</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_complex'>parse_complex</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_chomp!'>chomp!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>i</span><span class='tstring_end'>&quot;</span></span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span>)
    <span class='const'>Complex</span>(<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_parse_rational'><a href="#parse_rational-instance_method" title="Prism::Translation::Parser::Lexer#parse_rational (method)">parse_rational</a></span>(<span class='id identifier rubyid_value'>value</span>))
  <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>0[BbOoDdXx]</span><span class='regexp_end'>/</span></span>)
    <span class='const'>Complex</span>(<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_parse_integer'><a href="#parse_integer-instance_method" title="Prism::Translation::Parser::Lexer#parse_integer (method)">parse_integer</a></span>(<span class='id identifier rubyid_value'>value</span>))
  <span class='kw'>else</span>
    <span class='const'>Complex</span>(<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
  <span class='imaginary'>0i</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_float-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_float</strong>(value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parse a float from the string representation.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L557-L561'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='557' data-end='561'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 557</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_float'>parse_float</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='const'>Float</span>(<span class='id identifier rubyid_value'>value</span>)
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
  <span class='float'>0.0</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_integer-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_integer</strong>(value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parse an integer from the string representation.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L550-L554'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='550' data-end='554'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 550</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_integer'>parse_integer</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='const'>Integer</span>(<span class='id identifier rubyid_value'>value</span>)
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
  <span class='int'>0</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_rational-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_rational</strong>(value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parse a rational from the string representation.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L579-L589'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='579' data-end='589'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 579</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_rational'>parse_rational</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_chomp!'>chomp!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>0[BbOoDdXx]</span><span class='regexp_end'>/</span></span>)
    <span class='const'>Rational</span>(<span class='id identifier rubyid_parse_integer'><a href="#parse_integer-instance_method" title="Prism::Translation::Parser::Lexer#parse_integer (method)">parse_integer</a></span>(<span class='id identifier rubyid_value'>value</span>))
  <span class='kw'>else</span>
    <span class='const'>Rational</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
  <span class='rational'>0r</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="percent_array?-instance_method">
  <h3 class='signature priv'>
    #<strong>percent_array?</strong>(quote)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Determine if the string is part of a %-style array.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L814-L816'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='814' data-end='816'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 814</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_percent_array?'>percent_array?</span>(<span class='id identifier rubyid_quote'>quote</span>)
  <span class='id identifier rubyid_quote'>quote</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%w</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%W</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%i</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%I</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="percent_array_leading_whitespace-instance_method">
  <h3 class='signature priv'>
    #<strong>percent_array_leading_whitespace</strong>(string)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>For %-arrays whitespace, the parser gem only considers whitespace before the newline.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L792-L801'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='792' data-end='801'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 792</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_percent_array_leading_whitespace'>percent_array_leading_whitespace</span>(<span class='id identifier rubyid_string'>string</span>)
  <span class='kw'>return</span> <span class='int'>1</span> <span class='kw'>if</span> <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>)

  <span class='id identifier rubyid_leading_whitespace'>leading_whitespace</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_each_char'>each_char</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_leading_whitespace'>leading_whitespace</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_leading_whitespace'>leading_whitespace</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="percent_array_unescape-instance_method">
  <h3 class='signature priv'>
    #<strong>percent_array_unescape</strong>(string)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>In a percent array, certain whitespace can be preceeded with a backslash, causing the following characters to be part of the previous element.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L784-L789'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='784' data-end='789'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 784</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_percent_array_unescape'>percent_array_unescape</span>(<span class='id identifier rubyid_string'>string</span>)
  <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\\)+[ \f\n\r\t\v]</span><span class='regexp_end'>/</span></span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_full_match'>full_match</span><span class='op'>|</span>
    <span class='id identifier rubyid_full_match'>full_match</span>.<span class='id identifier rubyid_delete_prefix!'>delete_prefix!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>if</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_last_match'>last_match</span>[<span class='int'>1</span>].<span class='id identifier rubyid_length'>length</span>.<span class='id identifier rubyid_odd?'>odd?</span>
    <span class='id identifier rubyid_full_match'>full_match</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="range-instance_method">
  <h3 class='signature priv'>
    #<strong>range</strong>(start_offset, end_offset)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new parser range, taking prisms byte offsets into account</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L545-L547'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='545' data-end='547'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 545</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_range'>range</span>(<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_end_offset'>end_offset</span>)
  <span class='const'><a href="#Range-constant" title="Prism::Translation::Parser::Lexer::Range (constant)">Range</a></span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Prism::Translation::Parser::Lexer.new (method)">new</a></span>(<span class='id identifier rubyid_source_buffer'><a href="#source_buffer-instance_method" title="Prism::Translation::Parser::Lexer#source_buffer (method)">source_buffer</a></span><span class='comma'>,</span> <span class='id identifier rubyid_offset_cache'><a href="#offset_cache-instance_method" title="Prism::Translation::Parser::Lexer#offset_cache (method)">offset_cache</a></span>[<span class='id identifier rubyid_start_offset'>start_offset</span>]<span class='comma'>,</span> <span class='id identifier rubyid_offset_cache'><a href="#offset_cache-instance_method" title="Prism::Translation::Parser::Lexer#offset_cache (method)">offset_cache</a></span>[<span class='id identifier rubyid_end_offset'>end_offset</span>])
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="regexp?-instance_method">
  <h3 class='signature priv'>
    #<strong>regexp?</strong>(quote)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Regexp allow interpolation but are handled differently during unescaping</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L809-L811'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='809' data-end='811'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 809</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_regexp?'>regexp?</span>(<span class='id identifier rubyid_quote'>quote</span>)
  <span class='id identifier rubyid_quote'>quote</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_quote'>quote</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%r</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="simplify_string?-instance_method">
  <h3 class='signature priv'>
    #<strong>simplify_string?</strong>(value, quote)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Certain strings are merged into a single string token.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L718-L732'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='718' data-end='732'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 718</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_simplify_string?'>simplify_string?</span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_quote'>quote</span>)
  <span class='kw'>case</span> <span class='id identifier rubyid_quote'>quote</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># Only simplify &#39;foo&#39;
</span>    <span class='op'>!</span><span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;</span><span class='tstring_end'>&#39;</span></span>
    <span class='comment'># Simplify when every line ends with a line continuation, or it is the last line
</span>    <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_lines'>lines</span>.<span class='id identifier rubyid_all?'>all?</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
      <span class='op'>!</span><span class='id identifier rubyid_line'>line</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_line'>line</span>[<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\\*)$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='int'>1</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_length'>length</span><span class='op'>&amp;.</span><span class='id identifier rubyid_odd?'>odd?</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># %q and similar are never simplified
</span>    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_a-instance_method">
  <h3 class='signature '>
    #<strong>to_a</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Convert the prism tokens into the expected format for the parser gem.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L241-L540'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='241' data-end='540'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 241</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_to_a'>to_a</span>
  <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>=</span> []

  <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>.<span class='id identifier rubyid_length'>length</span>

  <span class='id identifier rubyid_heredoc_stack'>heredoc_stack</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_quote_stack'>quote_stack</span> <span class='op'>=</span> []

  <span class='comment'># The parser gem emits the newline tokens for comments out of order. This saves
</span>  <span class='comment'># that token location to emit at a later time to properly line everything up.
</span>  <span class='comment'># https://github.com/whitequark/parser/issues/1025
</span>  <span class='id identifier rubyid_comment_newline_location'>comment_newline_location</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='kw'>while</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_length'>length</span>
    <span class='id identifier rubyid_token'>token</span><span class='comma'>,</span> <span class='id identifier rubyid_state'>state</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]
    <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='const'><a href="#TYPES_ALWAYS_SKIP-constant" title="Prism::Translation::Parser::Lexer::TYPES_ALWAYS_SKIP (constant)">TYPES_ALWAYS_SKIP</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span>)

    <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='const'><a href="#TYPES-constant" title="Prism::Translation::Parser::Lexer::TYPES (constant)">TYPES</a></span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span>)
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_value'>value</span>
    <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)

    <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kDO'>kDO</span>
      <span class='id identifier rubyid_nearest_lambda_token'>nearest_lambda_token</span> <span class='op'>=</span> <span class='id identifier rubyid_tokens'>tokens</span>.<span class='id identifier rubyid_reverse_each'>reverse_each</span>.<span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_token'>token</span><span class='op'>|</span>
        <span class='const'><a href="#LAMBDA_TOKEN_TYPES-constant" title="Prism::Translation::Parser::Lexer::LAMBDA_TOKEN_TYPES (constant)">LAMBDA_TOKEN_TYPES</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_first'>first</span>)
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_nearest_lambda_token'>nearest_lambda_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLAMBDA'>tLAMBDA</span>
        <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kDO_LAMBDA'>kDO_LAMBDA</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCHARACTER'>tCHARACTER</span>
      <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_delete_prefix!'>delete_prefix!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span>)
      <span class='comment'># Character literals behave similar to double-quoted strings. We can use the same escaping mechanism.
</span>      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_unescape_string'><a href="#unescape_string-instance_method" title="Prism::Translation::Parser::Lexer#unescape_string (method)">unescape_string</a></span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tCOMMENT'>tCOMMENT</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>EMBDOC_BEGIN</span>

        <span class='kw'>while</span> <span class='op'>!</span>((<span class='id identifier rubyid_next_token'>next_token</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_first'>first</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>EMBDOC_END</span>) <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_index'>index</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='int'>1</span>)
          <span class='id identifier rubyid_value'>value</span> <span class='op'>+=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_value'>value</span>
          <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_value'>value</span> <span class='op'>+=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_value'>value</span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)
        <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_is_at_eol'>is_at_eol</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_chomp!'>chomp!</span>.<span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span> <span class='op'>+</span> (<span class='id identifier rubyid_is_at_eol'>is_at_eol</span> <span class='op'>?</span> <span class='int'>0</span> <span class='op'>:</span> <span class='op'>-</span><span class='int'>1</span>))

        <span class='id identifier rubyid_prev_token'>prev_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span> <span class='op'>-</span> <span class='int'>2</span>] <span class='kw'>if</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>-</span> <span class='int'>2</span> <span class='op'>&gt;=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_next_token'>next_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]

        <span class='id identifier rubyid_is_inline_comment'>is_inline_comment</span> <span class='op'>=</span> <span class='id identifier rubyid_prev_token'>prev_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_location'>location</span><span class='op'>&amp;.</span><span class='id identifier rubyid_start_line'>start_line</span> <span class='op'>==</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_line'>start_line</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_is_inline_comment'>is_inline_comment</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_is_at_eol'>is_at_eol</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='const'><a href="#COMMENT_CONTINUATION_TYPES-constant" title="Prism::Translation::Parser::Lexer::COMMENT_CONTINUATION_TYPES (constant)">COMMENT_CONTINUATION_TYPES</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_next_token'>next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span>)
          <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tCOMMENT'>tCOMMENT</span><span class='comma'>,</span> [<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_location'>location</span>]]

          <span class='id identifier rubyid_nl_location'>nl_location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span> <span class='op'>-</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)
          <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tNL'>tNL</span><span class='comma'>,</span> [<span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_nl_location'>nl_location</span>]]
          <span class='kw'>next</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_is_inline_comment'>is_inline_comment</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>COMMENT</span>
          <span class='id identifier rubyid_comment_newline_location'>comment_newline_location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span> <span class='op'>-</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)
        <span class='kw'>elsif</span> <span class='id identifier rubyid_comment_newline_location'>comment_newline_location</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='const'><a href="#COMMENT_CONTINUATION_TYPES-constant" title="Prism::Translation::Parser::Lexer::COMMENT_CONTINUATION_TYPES (constant)">COMMENT_CONTINUATION_TYPES</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_next_token'>next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span>)
          <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tCOMMENT'>tCOMMENT</span><span class='comma'>,</span> [<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_location'>location</span>]]
          <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tNL'>tNL</span><span class='comma'>,</span> [<span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_comment_newline_location'>comment_newline_location</span>]]
          <span class='id identifier rubyid_comment_newline_location'>comment_newline_location</span> <span class='op'>=</span> <span class='kw'>nil</span>
          <span class='kw'>next</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tNL'>tNL</span>
      <span class='id identifier rubyid_next_token'>next_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]
      <span class='comment'># Newlines after comments are emitted out of order.
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_next_token'>next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>COMMENT</span>
        <span class='id identifier rubyid_comment_newline_location'>comment_newline_location</span> <span class='op'>=</span> <span class='id identifier rubyid_location'>location</span>
        <span class='kw'>next</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tFLOAT'>tFLOAT</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_float'><a href="#parse_float-instance_method" title="Prism::Translation::Parser::Lexer#parse_float (method)">parse_float</a></span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIMAGINARY'>tIMAGINARY</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_complex'><a href="#parse_complex-instance_method" title="Prism::Translation::Parser::Lexer#parse_complex (method)">parse_complex</a></span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tINTEGER'>tINTEGER</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span>)
        <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tUNARY_NUM'>tUNARY_NUM</span><span class='comma'>,</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>+</span> <span class='int'>1</span>)]]
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>+</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)
      <span class='kw'>end</span>

      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_integer'><a href="#parse_integer-instance_method" title="Prism::Translation::Parser::Lexer#parse_integer (method)">parse_integer</a></span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLABEL'>tLABEL</span>
      <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_chomp!'>chomp!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLABEL_END'>tLABEL_END</span>
      <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_chomp!'>chomp!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLCURLY'>tLCURLY</span>
      <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLBRACE'>tLBRACE</span> <span class='kw'>if</span> <span class='id identifier rubyid_state'>state</span> <span class='op'>==</span> <span class='const'><a href="#EXPR_BEG-constant" title="Prism::Translation::Parser::Lexer::EXPR_BEG (constant)">EXPR_BEG</a></span> <span class='op'>|</span> <span class='const'><a href="#EXPR_LABEL-constant" title="Prism::Translation::Parser::Lexer::EXPR_LABEL (constant)">EXPR_LABEL</a></span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLPAREN2'>tLPAREN2</span>
      <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tLPAREN'>tLPAREN</span> <span class='kw'>if</span> <span class='id identifier rubyid_tokens'>tokens</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='const'><a href="#LPAREN_CONVERSION_TOKEN_TYPES-constant" title="Prism::Translation::Parser::Lexer::LPAREN_CONVERSION_TOKEN_TYPES (constant)">LPAREN_CONVERSION_TOKEN_TYPES</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_tokens'>tokens</span>.<span class='id identifier rubyid_dig'>dig</span>(<span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span>))
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tNTH_REF'>tNTH_REF</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_integer'><a href="#parse_integer-instance_method" title="Prism::Translation::Parser::Lexer#parse_integer (method)">parse_integer</a></span>(<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_delete_prefix'>delete_prefix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$</span><span class='tstring_end'>&quot;</span></span>))
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tOP_ASGN'>tOP_ASGN</span>
      <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_chomp!'>chomp!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tRATIONAL'>tRATIONAL</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_rational'><a href="#parse_rational-instance_method" title="Prism::Translation::Parser::Lexer#parse_rational (method)">parse_rational</a></span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSPACE'>tSPACE</span>
      <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_percent_array_leading_whitespace'><a href="#percent_array_leading_whitespace-instance_method" title="Prism::Translation::Parser::Lexer#percent_array_leading_whitespace (method)">percent_array_leading_whitespace</a></span>(<span class='id identifier rubyid_value'>value</span>))
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_BEG'>tSTRING_BEG</span>
      <span class='id identifier rubyid_next_token'>next_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]
      <span class='id identifier rubyid_next_next_token'>next_next_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span> <span class='op'>+</span> <span class='int'>1</span>]
      <span class='id identifier rubyid_basic_quotes'>basic_quotes</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>

      <span class='kw'>if</span> <span class='id identifier rubyid_basic_quotes'>basic_quotes</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>STRING_END</span>
        <span class='id identifier rubyid_next_location'>next_location</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_join'>join</span>(<span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_location'>location</span>)
        <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING'>tSTRING</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_next_location'>next_location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_next_location'>next_location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)
        <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%</span><span class='tstring_end'>&quot;</span></span>)
        <span class='kw'>if</span> <span class='id identifier rubyid_next_token'>next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>STRING_CONTENT</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_next_token'>next_next_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>STRING_END</span>
          <span class='id identifier rubyid_string_value'>string_value</span> <span class='op'>=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_value'>value</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_simplify_string?'><a href="#simplify_string%3F-instance_method" title="Prism::Translation::Parser::Lexer#simplify_string? (method)">simplify_string?</a></span>(<span class='id identifier rubyid_string_value'>string_value</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
            <span class='id identifier rubyid_next_location'>next_location</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_join'>join</span>(<span class='id identifier rubyid_next_next_token'>next_next_token</span>.<span class='id identifier rubyid_location'>location</span>)
            <span class='kw'>if</span> <span class='id identifier rubyid_percent_array?'><a href="#percent_array%3F-instance_method" title="Prism::Translation::Parser::Lexer#percent_array? (method)">percent_array?</a></span>(<span class='id identifier rubyid_value'>value</span>)
              <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_percent_array_unescape'><a href="#percent_array_unescape-instance_method" title="Prism::Translation::Parser::Lexer#percent_array_unescape (method)">percent_array_unescape</a></span>(<span class='id identifier rubyid_string_value'>string_value</span>)
            <span class='kw'>else</span>
              <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_unescape_string'><a href="#unescape_string-instance_method" title="Prism::Translation::Parser::Lexer#unescape_string (method)">unescape_string</a></span>(<span class='id identifier rubyid_string_value'>string_value</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
            <span class='kw'>end</span>
            <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING'>tSTRING</span>
            <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_next_location'>next_location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_next_location'>next_location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)
            <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>2</span>
            <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> [<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_location'>location</span>]]

            <span class='kw'>next</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_value'>value</span>)
      <span class='kw'>elsif</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>HEREDOC_START</span>
        <span class='id identifier rubyid_quote'>quote</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>2</span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>2</span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>~</span><span class='tstring_end'>&quot;</span></span> <span class='op'>?</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>3</span>] <span class='op'>:</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>2</span>]
        <span class='id identifier rubyid_heredoc_type'>heredoc_type</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>2</span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>2</span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>~</span><span class='tstring_end'>&quot;</span></span> <span class='op'>?</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>2</span>] <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_heredoc'>heredoc</span> <span class='op'>=</span> <span class='const'><a href="Lexer/HeredocData.html" title="Prism::Translation::Parser::Lexer::HeredocData (class)">HeredocData</a></span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Prism::Translation::Parser::Lexer.new (method)">new</a></span>(
          <span class='label'>identifier:</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>&lt;&lt;[-~]?[&quot;&#39;`]?(?&lt;heredoc_identifier&gt;.*?)[&quot;&#39;`]?\z</span><span class='regexp_end'>/</span></span>)[<span class='symbeg'>:</span><span class='id identifier rubyid_heredoc_identifier'>heredoc_identifier</span>]<span class='comma'>,</span>
          <span class='label'>common_whitespace:</span> <span class='int'>0</span><span class='comma'>,</span>
        )

        <span class='kw'>if</span> <span class='id identifier rubyid_quote'>quote</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tXSTRING_BEG'>tXSTRING_BEG</span>
        <span class='kw'>end</span>

        <span class='comment'># The parser gem trims whitespace from squiggly heredocs. We must record
</span>        <span class='comment'># the most common whitespace to later remove.
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_heredoc_type'>heredoc_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>~</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_heredoc_type'>heredoc_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_heredoc'>heredoc</span>.<span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>=</span> <span class='id identifier rubyid_calculate_heredoc_whitespace'><a href="#calculate_heredoc_whitespace-instance_method" title="Prism::Translation::Parser::Lexer#calculate_heredoc_whitespace (method)">calculate_heredoc_whitespace</a></span>(<span class='id identifier rubyid_index'>index</span>)
        <span class='kw'>end</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_quote'>quote</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_quote'>quote</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_quote'>quote</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;&lt;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quote'>quote</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;&lt;&quot;</span><span class='tstring_end'>&#39;</span></span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_heredoc_stack'>heredoc_stack</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_heredoc'>heredoc</span>)
        <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_value'>value</span>)
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_CONTENT'>tSTRING_CONTENT</span>
      <span class='id identifier rubyid_is_percent_array'>is_percent_array</span> <span class='op'>=</span> <span class='id identifier rubyid_percent_array?'><a href="#percent_array%3F-instance_method" title="Prism::Translation::Parser::Lexer#percent_array? (method)">percent_array?</a></span>(<span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_last'>last</span>)

      <span class='kw'>if</span> (<span class='id identifier rubyid_lines'>lines</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_lines'>lines</span>).<span class='id identifier rubyid_one?'>one?</span>
        <span class='comment'># Prism usually emits a single token for strings with line continuations.
</span>        <span class='comment'># For squiggly heredocs they are not joined so we do that manually here.
</span>        <span class='id identifier rubyid_current_string'>current_string</span> <span class='op'>=</span> <span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_current_length'>current_length</span> <span class='op'>=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span>
        <span class='kw'>while</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>STRING_CONTENT</span>
          <span class='id identifier rubyid_current_length'>current_length</span> <span class='op'>+=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_bytesize'>bytesize</span>
          <span class='comment'># Heredoc interpolation can have multiple STRING_CONTENT nodes on the same line.
</span>          <span class='id identifier rubyid_prev_token'>prev_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span> <span class='op'>-</span> <span class='int'>2</span>] <span class='kw'>if</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>-</span> <span class='int'>2</span> <span class='op'>&gt;=</span> <span class='int'>0</span>
          <span class='id identifier rubyid_is_first_token_on_line'>is_first_token_on_line</span> <span class='op'>=</span> <span class='id identifier rubyid_prev_token'>prev_token</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_line'>start_line</span> <span class='op'>!=</span> <span class='id identifier rubyid_prev_token'>prev_token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_line'>start_line</span>
          <span class='comment'># The parser gem only removes indentation when the heredoc is not nested
</span>          <span class='id identifier rubyid_not_nested'>not_nested</span> <span class='op'>=</span> <span class='id identifier rubyid_heredoc_stack'>heredoc_stack</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_is_percent_array'>is_percent_array</span>
            <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_percent_array_unescape'><a href="#percent_array_unescape-instance_method" title="Prism::Translation::Parser::Lexer#percent_array_unescape (method)">percent_array_unescape</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_value'>value</span>)
          <span class='kw'>elsif</span> <span class='id identifier rubyid_is_first_token_on_line'>is_first_token_on_line</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_not_nested'>not_nested</span> <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_current_heredoc'>current_heredoc</span> <span class='op'>=</span> <span class='id identifier rubyid_heredoc_stack'>heredoc_stack</span>.<span class='id identifier rubyid_last'>last</span>).<span class='id identifier rubyid_common_whitespace'>common_whitespace</span> <span class='op'>&gt;</span> <span class='int'>0</span>
            <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_trim_heredoc_whitespace'><a href="#trim_heredoc_whitespace-instance_method" title="Prism::Translation::Parser::Lexer#trim_heredoc_whitespace (method)">trim_heredoc_whitespace</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_current_heredoc'>current_heredoc</span>)
          <span class='kw'>end</span>

          <span class='id identifier rubyid_current_string'>current_string</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_unescape_string'><a href="#unescape_string-instance_method" title="Prism::Translation::Parser::Lexer#unescape_string (method)">unescape_string</a></span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_last'>last</span>)
          <span class='id identifier rubyid_relevant_backslash_count'>relevant_backslash_count</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%W</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%I</span><span class='tstring_end'>&quot;</span></span>)
                                       <span class='int'>0</span> <span class='comment'># the last backslash escapes the newline
</span>                                     <span class='kw'>else</span>
                                       <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_value'>value</span>[<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\\{1,})\n</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='int'>1</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>||</span> <span class='int'>0</span>
                                     <span class='kw'>end</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_relevant_backslash_count'>relevant_backslash_count</span>.<span class='id identifier rubyid_even?'>even?</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_interpolation?'><a href="#interpolation%3F-instance_method" title="Prism::Translation::Parser::Lexer#interpolation? (method)">interpolation?</a></span>(<span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_last'>last</span>)
            <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_CONTENT'>tSTRING_CONTENT</span><span class='comma'>,</span> [<span class='id identifier rubyid_current_string'>current_string</span><span class='comma'>,</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_current_length'>current_length</span>)]]
            <span class='kw'>break</span>
          <span class='kw'>end</span>
          <span class='id identifier rubyid_token'>token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]
          <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='comment'># When the parser gem encounters a line continuation inside of a multiline string,
</span>        <span class='comment'># it emits a single string node. The backslash (and remaining newline) is removed.
</span>        <span class='id identifier rubyid_current_line'>current_line</span> <span class='op'>=</span> <span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_adjustment'>adjustment</span> <span class='op'>=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span>
        <span class='id identifier rubyid_emit'>emit</span> <span class='op'>=</span> <span class='kw'>false</span>

        <span class='id identifier rubyid_lines'>lines</span>.<span class='id identifier rubyid_each'>each</span>.<span class='id identifier rubyid_with_index'>with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span>
          <span class='id identifier rubyid_chomped_line'>chomped_line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span>.<span class='id identifier rubyid_chomp'>chomp</span>
          <span class='id identifier rubyid_backslash_count'>backslash_count</span> <span class='op'>=</span> <span class='id identifier rubyid_chomped_line'>chomped_line</span>[<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\\{1,}\z</span><span class='regexp_end'>/</span></span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>||</span> <span class='int'>0</span>
          <span class='id identifier rubyid_is_interpolation'>is_interpolation</span> <span class='op'>=</span> <span class='id identifier rubyid_interpolation?'><a href="#interpolation%3F-instance_method" title="Prism::Translation::Parser::Lexer#interpolation? (method)">interpolation?</a></span>(<span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_last'>last</span>)

          <span class='kw'>if</span> <span class='id identifier rubyid_backslash_count'>backslash_count</span>.<span class='id identifier rubyid_odd?'>odd?</span> <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_is_interpolation'>is_interpolation</span> <span class='op'>||</span> <span class='id identifier rubyid_is_percent_array'>is_percent_array</span>)
            <span class='kw'>if</span> <span class='id identifier rubyid_is_percent_array'>is_percent_array</span>
              <span class='id identifier rubyid_current_line'>current_line</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_percent_array_unescape'><a href="#percent_array_unescape-instance_method" title="Prism::Translation::Parser::Lexer#percent_array_unescape (method)">percent_array_unescape</a></span>(<span class='id identifier rubyid_line'>line</span>)
              <span class='id identifier rubyid_adjustment'>adjustment</span> <span class='op'>+=</span> <span class='int'>1</span>
            <span class='kw'>else</span>
              <span class='id identifier rubyid_chomped_line'>chomped_line</span>.<span class='id identifier rubyid_delete_suffix!'>delete_suffix!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>)
              <span class='id identifier rubyid_current_line'>current_line</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_chomped_line'>chomped_line</span>
              <span class='id identifier rubyid_adjustment'>adjustment</span> <span class='op'>+=</span> <span class='int'>2</span>
            <span class='kw'>end</span>
            <span class='comment'># If the string ends with a line continuation emit the remainder
</span>            <span class='id identifier rubyid_emit'>emit</span> <span class='op'>=</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>==</span> <span class='id identifier rubyid_lines'>lines</span>.<span class='id identifier rubyid_count'>count</span> <span class='op'>-</span> <span class='int'>1</span>
          <span class='kw'>else</span>
            <span class='id identifier rubyid_current_line'>current_line</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_line'>line</span>
            <span class='id identifier rubyid_emit'>emit</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='kw'>end</span>

          <span class='kw'>if</span> <span class='id identifier rubyid_emit'>emit</span>
            <span class='id identifier rubyid_end_offset'>end_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_current_line'>current_line</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='op'>+</span> <span class='id identifier rubyid_adjustment'>adjustment</span>
            <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_CONTENT'>tSTRING_CONTENT</span><span class='comma'>,</span> [<span class='id identifier rubyid_unescape_string'><a href="#unescape_string-instance_method" title="Prism::Translation::Parser::Lexer#unescape_string (method)">unescape_string</a></span>(<span class='id identifier rubyid_current_line'>current_line</span><span class='comma'>,</span> <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_last'>last</span>)<span class='comma'>,</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_end_offset'>end_offset</span>)]]
            <span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_end_offset'>end_offset</span>
            <span class='id identifier rubyid_current_line'>current_line</span> <span class='op'>=</span> <span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_adjustment'>adjustment</span> <span class='op'>=</span> <span class='int'>0</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>next</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_DVAR'>tSTRING_DVAR</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSTRING_END'>tSTRING_END</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>HEREDOC_END</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>)
        <span class='id identifier rubyid_newline_length'>newline_length</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>?</span> <span class='int'>2</span> <span class='op'>:</span> <span class='int'>1</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_heredoc_stack'>heredoc_stack</span>.<span class='id identifier rubyid_pop'>pop</span>.<span class='id identifier rubyid_identifier'>identifier</span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span> <span class='op'>-</span> <span class='id identifier rubyid_newline_length'>newline_length</span>)
      <span class='kw'>elsif</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>REGEXP_END</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>0</span>]
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>+</span> <span class='int'>1</span>)
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_percent_array?'><a href="#percent_array%3F-instance_method" title="Prism::Translation::Parser::Lexer#percent_array? (method)">percent_array?</a></span>(<span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_pop'>pop</span>)
        <span class='id identifier rubyid_prev_token'>prev_token</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span> <span class='op'>-</span> <span class='int'>2</span>] <span class='kw'>if</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>-</span> <span class='int'>2</span> <span class='op'>&gt;=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_empty'>empty</span> <span class='op'>=</span> <span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>PERCENT_LOWER_I</span><span class='words_sep'> </span><span class='tstring_content'>PERCENT_LOWER_W</span><span class='words_sep'> </span><span class='tstring_content'>PERCENT_UPPER_I</span><span class='words_sep'> </span><span class='tstring_content'>PERCENT_UPPER_W</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_prev_token'>prev_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span>)
        <span class='id identifier rubyid_ends_with_whitespace'>ends_with_whitespace</span> <span class='op'>=</span> <span class='id identifier rubyid_prev_token'>prev_token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>WORDS_SEP</span>
        <span class='comment'># parser always emits a space token after content in a percent array, even if no actual whitespace is present.
</span>        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_empty'>empty</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_ends_with_whitespace'>ends_with_whitespace</span>
          <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tSPACE'>tSPACE</span><span class='comma'>,</span> [<span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span>)]]
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSYMBEG'>tSYMBEG</span>
      <span class='kw'>if</span> (<span class='id identifier rubyid_next_token'>next_token</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_first'>first</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='const'>STRING_CONTENT</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='const'>EMBEXPR_BEGIN</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='const'>EMBVAR</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='const'>STRING_END</span>
        <span class='id identifier rubyid_next_location'>next_location</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_join'>join</span>(<span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_location'>location</span>)
        <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSYMBOL'>tSYMBOL</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_value'>value</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>~@</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>~</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>!@</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span> }.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_next_location'>next_location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_next_location'>next_location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)
        <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_value'>value</span>)
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tFID'>tFID</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_tokens'>tokens</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_tokens'>tokens</span>.<span class='id identifier rubyid_dig'>dig</span>(<span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span>) <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_kDEF'>kDEF</span>
        <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tIDENTIFIER'>tIDENTIFIER</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tXSTRING_BEG'>tXSTRING_BEG</span>
      <span class='kw'>if</span> (<span class='id identifier rubyid_next_token'>next_token</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_first'>first</span>) <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>STRING_CONTENT</span><span class='words_sep'> </span><span class='tstring_content'>STRING_END</span><span class='words_sep'> </span><span class='tstring_content'>EMBEXPR_BEGIN</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span>)
        <span class='comment'># self.`()
</span>        <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tBACK_REF2'>tBACK_REF2</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tSYMBOLS_BEG'>tSYMBOLS_BEG</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tQSYMBOLS_BEG'>tQSYMBOLS_BEG</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tWORDS_BEG'>tWORDS_BEG</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tQWORDS_BEG'>tQWORDS_BEG</span>
      <span class='kw'>if</span> (<span class='id identifier rubyid_next_token'>next_token</span> <span class='op'>=</span> <span class='id identifier rubyid_lexed'><a href="#lexed-instance_method" title="Prism::Translation::Parser::Lexer#lexed (method)">lexed</a></span>[<span class='id identifier rubyid_index'>index</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_first'>first</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_next_token'>next_token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>WORDS_SEP</span>
        <span class='id identifier rubyid_index'>index</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tREGEXP_BEG'>tREGEXP_BEG</span>
      <span class='id identifier rubyid_quote_stack'>quote_stack</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_value'>value</span>)
    <span class='kw'>end</span>

    <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> [<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_location'>location</span>]]

    <span class='kw'>if</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='const'>REGEXP_END</span>
      <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>&lt;&lt;</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_tREGEXP_OPT'>tREGEXP_OPT</span><span class='comma'>,</span> [<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_value'>value</span>[<span class='int'>1</span><span class='op'>..</span>]<span class='comma'>,</span> <span class='id identifier rubyid_range'><a href="#range-instance_method" title="Prism::Translation::Parser::Lexer#range (method)">range</a></span>(<span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_start_offset'>start_offset</span> <span class='op'>+</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_end_offset'>end_offset</span>)]]
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_tokens'>tokens</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="trim_heredoc_whitespace-instance_method">
  <h3 class='signature priv'>
    #<strong>trim_heredoc_whitespace</strong>(string, heredoc)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Wonky heredoc tab/spaces rules. <a href="https://github.com/ruby/prism/blob/v1.3.0/src/prism.c#L16528-L16545">github.com/ruby/prism/blob/v1.3.0/src/prism.c#L16528-L16545</a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L640-L654'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='640' data-end='654'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 640</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_trim_heredoc_whitespace'>trim_heredoc_whitespace</span>(<span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='id identifier rubyid_heredoc'>heredoc</span>)
  <span class='id identifier rubyid_trimmed_whitespace'>trimmed_whitespace</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_trimmed_characters'>trimmed_characters</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>while</span> (<span class='id identifier rubyid_string'>string</span>[<span class='id identifier rubyid_trimmed_characters'>trimmed_characters</span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_string'>string</span>[<span class='id identifier rubyid_trimmed_characters'>trimmed_characters</span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_trimmed_whitespace'>trimmed_whitespace</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_heredoc'>heredoc</span>.<span class='id identifier rubyid_common_whitespace'>common_whitespace</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_string'>string</span>[<span class='id identifier rubyid_trimmed_characters'>trimmed_characters</span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_trimmed_whitespace'>trimmed_whitespace</span> <span class='op'>=</span> (<span class='id identifier rubyid_trimmed_whitespace'>trimmed_whitespace</span> <span class='op'>/</span> <span class='int'>8</span> <span class='op'>+</span> <span class='int'>1</span>) <span class='op'>*</span> <span class='int'>8</span><span class='semicolon'>;</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_trimmed_whitespace'>trimmed_whitespace</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_heredoc'>heredoc</span>.<span class='id identifier rubyid_common_whitespace'>common_whitespace</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_trimmed_whitespace'>trimmed_whitespace</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_trimmed_characters'>trimmed_characters</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_string'>string</span>[<span class='id identifier rubyid_trimmed_characters'>trimmed_characters</span><span class='op'>..</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unescape_string-instance_method">
  <h3 class='signature priv'>
    #<strong>unescape_string</strong>(string, quote)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Apply Ruby string escaping rules</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_7/lib/prism/translation/parser/lexer.rb#L675-L715'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='675' data-end='715'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/prism/translation/parser/lexer.rb', line 675</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unescape_string'>unescape_string</span>(<span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='id identifier rubyid_quote'>quote</span>)
  <span class='comment'># In single-quoted heredocs, everything is taken literally.
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_string'>string</span> <span class='kw'>if</span> <span class='id identifier rubyid_quote'>quote</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;&lt;&#39;</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># OPTIMIZATION: Assume that few strings need escaping to speed up the common case.
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_string'>string</span> <span class='kw'>unless</span> <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>)

  <span class='comment'># Enclosing character for the string. `&quot;` for `&quot;foo&quot;`, `{` for `%w{foo}`, etc.
</span>  <span class='id identifier rubyid_delimiter'>delimiter</span> <span class='op'>=</span> <span class='id identifier rubyid_quote'>quote</span>[<span class='op'>-</span><span class='int'>1</span>]

  <span class='kw'>if</span> <span class='id identifier rubyid_regexp?'><a href="#regexp%3F-instance_method" title="Prism::Translation::Parser::Lexer#regexp? (method)">regexp?</a></span>(<span class='id identifier rubyid_quote'>quote</span>)
    <span class='comment'># Should be escaped handled to single-quoted heredocs. The only character that is
</span>    <span class='comment'># allowed to be escaped is the delimiter, except when that also has special meaning
</span>    <span class='comment'># in the regexp. Since all the symetry delimiters have special meaning, they don&#39;t need
</span>    <span class='comment'># to be considered separately.
</span>    <span class='kw'>if</span> <span class='const'><a href="#REGEXP_META_CHARACTERS-constant" title="Prism::Translation::Parser::Lexer::REGEXP_META_CHARACTERS (constant)">REGEXP_META_CHARACTERS</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_delimiter'>delimiter</span>)
      <span class='id identifier rubyid_string'>string</span>
    <span class='kw'>else</span>
      <span class='comment'># There can never be an even amount of backslashes. It would be a syntax error.
</span>      <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\\(</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='id identifier rubyid_delimiter'>delimiter</span>)<span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>\1</span><span class='tstring_end'>&#39;</span></span>)
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_interpolation?'><a href="#interpolation%3F-instance_method" title="Prism::Translation::Parser::Lexer#interpolation? (method)">interpolation?</a></span>(<span class='id identifier rubyid_quote'>quote</span>)
    <span class='comment'># Appending individual escape sequences may force the string out of its intended
</span>    <span class='comment'># encoding. Start out with binary and force it back later.
</span>    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_b'>b</span>

    <span class='id identifier rubyid_scanner'>scanner</span> <span class='op'>=</span> <span class='const'>StringScanner</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Prism::Translation::Parser::Lexer.new (method)">new</a></span>(<span class='id identifier rubyid_string'>string</span>)
    <span class='kw'>while</span> (<span class='id identifier rubyid_skipped'>skipped</span> <span class='op'>=</span> <span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_skip_until'>skip_until</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\\</span><span class='regexp_end'>/</span></span>))
      <span class='comment'># Append what was just skipped over, excluding the found backslash.
</span>      <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_byteslice'>byteslice</span>(<span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_pos'>pos</span> <span class='op'>-</span> <span class='id identifier rubyid_skipped'>skipped</span><span class='comma'>,</span> <span class='id identifier rubyid_skipped'>skipped</span> <span class='op'>-</span> <span class='int'>1</span>))
      <span class='id identifier rubyid_escape_read'><a href="#escape_read-instance_method" title="Prism::Translation::Parser::Lexer#escape_read (method)">escape_read</a></span>(<span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_scanner'>scanner</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>false</span>)
    <span class='kw'>end</span>

    <span class='comment'># Add remaining chars
</span>    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_append_as_bytes'>append_as_bytes</span>(<span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_byteslice'>byteslice</span>(<span class='id identifier rubyid_scanner'>scanner</span>.<span class='id identifier rubyid_pos'>pos</span><span class='op'>..</span>))
    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_force_encoding'>force_encoding</span>(<span class='id identifier rubyid_source_buffer'><a href="#source_buffer-instance_method" title="Prism::Translation::Parser::Lexer#source_buffer (method)">source_buffer</a></span>.<span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_encoding'>encoding</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_delimiters'>delimiters</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_delimiter'>delimiter</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='const'><a href="#DELIMITER_SYMETRY-constant" title="Prism::Translation::Parser::Lexer::DELIMITER_SYMETRY (constant)">DELIMITER_SYMETRY</a></span>[<span class='id identifier rubyid_delimiter'>delimiter</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\\([\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_delimiters'>delimiters</span><span class='embexpr_end'>}</span><span class='tstring_content'>])</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>\1</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>