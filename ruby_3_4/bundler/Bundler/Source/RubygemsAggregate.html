<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Bundler::Source::RubygemsAggregate &mdash; bundler  Ruby-3.4.6 p54</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Bundler::Source::RubygemsAggregate",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../'>Ruby-3.4.6</a> &raquo; 
      <a href='../../'>bundler</a> &raquo; 
      <a href='../../_index.html#alpha_R'>Index (R)</a> &raquo; 
        <a href="../../Bundler.html" title="Bundler (module)">Bundler</a> &raquo; 
        <a href="../Source.html" title="Bundler::Source (class)">Source</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>RubygemsAggregate&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Bundler::Source::RubygemsAggregate</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L5'>lib/bundler/source/rubygems_aggregate.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(sources, source_map)  &#x21d2; RubygemsAggregate </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#source_map-instance_method" title="#source_map (instance method)">#<strong>source_map</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#sources-instance_method" title="#sources (instance method)">#<strong>sources</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#identifier-instance_method" title="#identifier (instance method)">#<strong>identifier</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#specs-instance_method" title="#specs (instance method)">#<strong>specs</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_index-instance_method" title="#build_index (instance method)">#<strong>build_index</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#double_check_for_index-instance_method" title="#double_check_for_index (instance method)">#<strong>double_check_for_index</strong>(idx, dependency_names)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Suppose the gem Foo depends on the gem Bar.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(sources, source_map)  &#x21d2; <code>RubygemsAggregate</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L8-L13'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='8' data-end='13'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 8</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_sources'><a href="#sources-instance_method" title="Bundler::Source::RubygemsAggregate#sources (method)">sources</a></span><span class='comma'>,</span> <span class='id identifier rubyid_source_map'><a href="#source_map-instance_method" title="Bundler::Source::RubygemsAggregate#source_map (method)">source_map</a></span>)
  <span class='ivar'>@sources</span> <span class='op'>=</span> <span class='id identifier rubyid_sources'><a href="#sources-instance_method" title="Bundler::Source::RubygemsAggregate#sources (method)">sources</a></span>
  <span class='ivar'>@source_map</span> <span class='op'>=</span> <span class='id identifier rubyid_source_map'><a href="#source_map-instance_method" title="Bundler::Source::RubygemsAggregate#source_map (method)">source_map</a></span>

  <span class='ivar'>@index</span> <span class='op'>=</span> <span class='id identifier rubyid_build_index'><a href="#build_index-instance_method" title="Bundler::Source::RubygemsAggregate#build_index (method)">build_index</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="source_map-instance_method">
  <h3 class='signature ro first'>
    #<strong>source_map</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L6-L6'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='6' data-end='6'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 6</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_source_map'>source_map</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_sources'><a href="#sources-instance_method" title="Bundler::Source::RubygemsAggregate#sources (method)">sources</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="sources-instance_method">
  <h3 class='signature ro'>
    #<strong>sources</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L6-L6'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='6' data-end='6'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 6</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_source_map'><a href="#source_map-instance_method" title="Bundler::Source::RubygemsAggregate#source_map (method)">source_map</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_sources'>sources</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="build_index-instance_method">
  <h3 class='signature priv first'>
    #<strong>build_index</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L29-L41'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='29' data-end='41'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 29</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_index'>build_index</span>
  <span class='const'><a href="../Index.html" title="Bundler::Index (class)">Index</a></span>.<span class='id identifier rubyid_build'><a href="../Index.html#build-class_method" title="Bundler::Index.build (method)">build</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_idx'>idx</span><span class='op'>|</span>
    <span class='id identifier rubyid_dependency_names'><a href="../Source.html#dependency_names-instance_method" title="Bundler::Source#dependency_names (method)">dependency_names</a></span> <span class='op'>=</span> <span class='id identifier rubyid_source_map'><a href="#source_map-instance_method" title="Bundler::Source::RubygemsAggregate#source_map (method)">source_map</a></span>.<span class='id identifier rubyid_pinned_spec_names'>pinned_spec_names</span>

    <span class='id identifier rubyid_sources'><a href="#sources-instance_method" title="Bundler::Source::RubygemsAggregate#sources (method)">sources</a></span>.<span class='id identifier rubyid_all_sources'>all_sources</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_source'>source</span><span class='op'>|</span>
      <span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_dependency_names'><a href="../Source.html#dependency_names-instance_method" title="Bundler::Source#dependency_names (method)">dependency_names</a></span> <span class='op'>=</span> <span class='id identifier rubyid_dependency_names'><a href="../Source.html#dependency_names-instance_method" title="Bundler::Source#dependency_names (method)">dependency_names</a></span> <span class='op'>-</span> <span class='id identifier rubyid_source_map'><a href="#source_map-instance_method" title="Bundler::Source::RubygemsAggregate#source_map (method)">source_map</a></span>.<span class='id identifier rubyid_pinned_spec_names'>pinned_spec_names</span>(<span class='id identifier rubyid_source'>source</span>)
      <span class='id identifier rubyid_idx'>idx</span>.<span class='id identifier rubyid_add_source'>add_source</span> <span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_specs'><a href="#specs-instance_method" title="Bundler::Source::RubygemsAggregate#specs (method)">specs</a></span>
      <span class='id identifier rubyid_dependency_names'><a href="../Source.html#dependency_names-instance_method" title="Bundler::Source#dependency_names (method)">dependency_names</a></span>.<span class='id identifier rubyid_concat'>concat</span>(<span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_unmet_deps'><a href="../Source.html#unmet_deps-instance_method" title="Bundler::Source#unmet_deps (method)">unmet_deps</a></span>).<span class='id identifier rubyid_uniq!'>uniq!</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_double_check_for_index'><a href="#double_check_for_index-instance_method" title="Bundler::Source::RubygemsAggregate#double_check_for_index (method)">double_check_for_index</a></span>(<span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> <span class='id identifier rubyid_dependency_names'><a href="../Source.html#dependency_names-instance_method" title="Bundler::Source#dependency_names (method)">dependency_names</a></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="double_check_for_index-instance_method">
  <h3 class='signature priv'>
    #<strong>double_check_for_index</strong>(idx, dependency_names)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Suppose the gem Foo depends on the gem Bar.  Foo exists in <a href="../Source.html" title="Bundler::Source (class)"><code>::Bundler::Source</code></a> A.  Bar has some versions that exist in both sources A and B.  At this point, the API request will have found all the versions of Bar in source A, but will not have found any versions of Bar from source B, which is a problem if the requested version of Foo specifically depends on a version of Bar that is only found in source B. This ensures that for each spec we found, we add all possible versions from all sources to the index.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L48-L65'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='48' data-end='65'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_double_check_for_index'>double_check_for_index</span>(<span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> <span class='id identifier rubyid_dependency_names'><a href="../Source.html#dependency_names-instance_method" title="Bundler::Source#dependency_names (method)">dependency_names</a></span>)
  <span class='id identifier rubyid_pinned_names'>pinned_names</span> <span class='op'>=</span> <span class='id identifier rubyid_source_map'><a href="#source_map-instance_method" title="Bundler::Source::RubygemsAggregate#source_map (method)">source_map</a></span>.<span class='id identifier rubyid_pinned_spec_names'>pinned_spec_names</span>

  <span class='id identifier rubyid_names'>names</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_names'>names</span> <span class='comment'># do this so we only have to traverse to get dependency_names from the index once
</span>  <span class='id identifier rubyid_unmet_dependency_names'>unmet_dependency_names</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='kw'>do</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_names'>names</span> <span class='kw'>unless</span> <span class='id identifier rubyid_names'>names</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_names'>names</span>
    <span class='id identifier rubyid_new_names'>new_names</span> <span class='op'>=</span> <span class='id identifier rubyid_sources'><a href="#sources-instance_method" title="Bundler::Source::RubygemsAggregate#sources (method)">sources</a></span>.<span class='id identifier rubyid_all_sources'>all_sources</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_dependency_names_to_double_check'><a href="../Source.html#dependency_names_to_double_check-instance_method" title="Bundler::Source#dependency_names_to_double_check (method)">dependency_names_to_double_check</a></span>)
    <span class='kw'>return</span> <span class='id identifier rubyid_names'>names</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_new_names'>new_names</span>.<span class='id identifier rubyid_compact!'>compact!</span>
    <span class='id identifier rubyid_names'>names</span> <span class='op'>=</span> <span class='id identifier rubyid_new_names'>new_names</span>.<span class='id identifier rubyid_flatten'>flatten</span>(<span class='int'>1</span>).<span class='id identifier rubyid_concat'>concat</span>(<span class='id identifier rubyid_dependency_names'><a href="../Source.html#dependency_names-instance_method" title="Bundler::Source#dependency_names (method)">dependency_names</a></span>)
    <span class='id identifier rubyid_names'>names</span>.<span class='id identifier rubyid_uniq!'>uniq!</span>
    <span class='id identifier rubyid_names'>names</span> <span class='op'>-=</span> <span class='id identifier rubyid_pinned_names'>pinned_names</span>
    <span class='id identifier rubyid_names'>names</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sources'><a href="#sources-instance_method" title="Bundler::Source::RubygemsAggregate#sources (method)">sources</a></span>.<span class='id identifier rubyid_all_sources'>all_sources</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_source'>source</span><span class='op'>|</span>
    <span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_double_check_for'><a href="../Source.html#double_check_for-instance_method" title="Bundler::Source#double_check_for (method)">double_check_for</a></span>(<span class='id identifier rubyid_unmet_dependency_names'>unmet_dependency_names</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="identifier-instance_method">
  <h3 class='signature '>
    #<strong>identifier</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L19-L21'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='19' data-end='21'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 19</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_identifier'>identifier</span>
  <span class='id identifier rubyid_to_s'><a href="#to_s-instance_method" title="Bundler::Source::RubygemsAggregate#to_s (method)">to_s</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="specs-instance_method">
  <h3 class='signature '>
    #<strong>specs</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L15-L17'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='15' data-end='17'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 15</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_specs'>specs</span>
  <span class='ivar'>@index</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_s-instance_method">
  <h3 class='signature '>
    #<strong>to_s</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_4_6/lib/bundler/source/rubygems_aggregate.rb#L23-L25'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='23' data-end='25'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/bundler/source/rubygems_aggregate.rb', line 23</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>any of the sources</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>