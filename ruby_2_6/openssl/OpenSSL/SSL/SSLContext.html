<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: OpenSSL::SSL::SSLContext &mdash; openssl</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL::SSL::SSLContext",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../'>Ruby-2.6.10</a> &raquo; 
      <a href='../../'>openssl</a> &raquo; 
      <a href='../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a> &raquo; 
        <a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>SSLContext&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: OpenSSL::SSL::SSLContext</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2447'>ext/openssl/ossl_ssl.c</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L19'>ext/openssl/lib/openssl/ssl.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>An SSLContext is used to set various options regarding certificates, algorithms, verification, session caching, etc.  The SSLContext is used to create an <a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)"><code>SSLSocket</code></a>.</p>

<p>All attributes must be set before creating an <a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)"><code>SSLSocket</code></a> as the <code>SSLContext</code> will be frozen afterward.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='DEFAULT_2048-constant' class='summary_signature priv'>DEFAULT_2048 =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L33-L42'># File 'ext/openssl/lib/openssl/ssl.rb', line 33</a>    <pre class='code ruby'><span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../PKey.html" title="OpenSSL::PKey (module)">PKey</a></span><span class='op'>::</span><span class='const'><a href="../PKey/DH.html" title="OpenSSL::PKey::DH (class)">DH</a></span>.<span class='id identifier rubyid_new'><a href="../PKey/DH.html#new-class_method" title="OpenSSL::PKey::DH.new (method)">new</a></span> <span class='heredoc_beg'>&lt;&lt;-_end_of_pem_</span>
<span class='tstring_content'>-----BEGIN DH PARAMETERS-----
MIIBCAKCAQEA7E6kBrYiyvmKAMzQ7i8WvwVk9Y/+f8S7sCTN712KkK3cqd1jhJDY
JbrYeNV3kUIKhPxWHhObHKpD1R84UpLs2b55iMd6GmL7OYmNIT/FccKhTcveab
VBmZT86BZKYyf45hUF9FOuUM9xPzuK3Vd8oJQvfYMCd7LPC0taAEljQLR4Edf8E6
YoaOffgTf5qxiwkjnlVZQc3whgnEt9FpVMvQ9eknyeGB5KHfayAc3+hUAvI3/Cr3
1bNveX5wInh5GDx1FGhKBZs1HaedudCm7sCgRwv8lKWYGiHzObSma8A86KG+MD
7Lo5JquQ3DlBodj3IDyPrxIv96lvRPFtAwIBAg==
-----END DH PARAMETERS-----
</span><span class='heredoc_end'>_end_of_pem_</span></pre>
  </li>
  <li>
    <span id='DEFAULT_CERT_STORE-constant' class='summary_signature nodoc'>DEFAULT_CERT_STORE =</span>
    <span class='nodoc note title'>Internal use only</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L89-L89'># File 'ext/openssl/lib/openssl/ssl.rb', line 89</a>    <pre class='code ruby'><span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="../X509/Store.html" title="OpenSSL::X509::Store (class)">Store</a></span>.<span class='id identifier rubyid_new'><a href="../X509/Store.html#new-class_method" title="OpenSSL::X509::Store.new (method)">new</a></span></pre>
  </li>
  <li>
    <span id='DEFAULT_PARAMS-constant' class='summary_signature nodoc'>DEFAULT_PARAMS =</span>
    <span class='nodoc note title'>Internal use only</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L20-L30'># File 'ext/openssl/lib/openssl/ssl.rb', line 20</a>    <pre class='code ruby'>{ <span class='comment'># :nodoc:
</span>  <span class='symbeg'>:</span><span class='id identifier rubyid_min_version'>min_version</span> <span class='op'>=&gt;</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#TLS1_VERSION-constant" title="OpenSSL::SSL::TLS1_VERSION (constant)">TLS1_VERSION</a></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_mode'>verify_mode</span> <span class='op'>=&gt;</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#VERIFY_PEER-constant" title="OpenSSL::SSL::VERIFY_PEER (constant)">VERIFY_PEER</a></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_hostname'><a href="../SSL.html#verify_hostname-class_method" title="OpenSSL::SSL.verify_hostname (method)">verify_hostname</a></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_options'><a href="#options-instance_method" title="OpenSSL::SSL::SSLContext#options (method)">options</a></span> <span class='op'>=&gt;</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span>
    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#OP_ALL-constant" title="OpenSSL::SSL::OP_ALL (constant)">OP_ALL</a></span>
    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>&amp;=</span> <span class='op'>~</span><span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#OP_DONT_INSERT_EMPTY_FRAGMENTS-constant" title="OpenSSL::SSL::OP_DONT_INSERT_EMPTY_FRAGMENTS (constant)">OP_DONT_INSERT_EMPTY_FRAGMENTS</a></span>
    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>|=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#OP_NO_COMPRESSION-constant" title="OpenSSL::SSL::OP_NO_COMPRESSION (constant)">OP_NO_COMPRESSION</a></span>
    <span class='id identifier rubyid_opts'>opts</span>
  }.<span class='id identifier rubyid_call'>call</span>
}</pre>
  </li>
  <li>
    <span id='DEFAULT_TMP_DH_CALLBACK-constant' class='summary_signature nodoc'>DEFAULT_TMP_DH_CALLBACK =</span>
    <span class='nodoc note title'>Internal use only</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L45-L48'># File 'ext/openssl/lib/openssl/ssl.rb', line 45</a>    <pre class='code ruby'><span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_is_export'>is_export</span><span class='comma'>,</span> <span class='id identifier rubyid_keylen'>keylen</span><span class='op'>|</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>using default DH parameters.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='gvar'>$VERBOSE</span>
  <span class='const'><a href="#DEFAULT_2048-constant" title="OpenSSL::SSL::SSLContext::DEFAULT_2048 (constant)">DEFAULT_2048</a></span>
}</pre>
  </li>
  <li>
    <span id='METHODS-constant' class='summary_signature'>METHODS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The list of available SSL/TLS methods. This constant is only provided for backwards compatibility.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L227-L229'># File 'ext/openssl/lib/openssl/ssl.rb', line 227</a>    <pre class='code ruby'><span class='const'><a href="#METHODS_MAP-constant" title="OpenSSL::SSL::SSLContext::METHODS_MAP (constant)">METHODS_MAP</a></span>.<span class='id identifier rubyid_flat_map'>flat_map</span> { <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='op'>|</span>
  [<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='symbeg'>:&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_client</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbeg'>:&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_server</span><span class='tstring_end'>&quot;</span></span>]
}.<span class='id identifier rubyid_freeze'><a href="#freeze-instance_method" title="OpenSSL::SSL::SSLContext#freeze (method)">freeze</a></span></pre>
  </li>
  <li>
    <span id='METHODS_MAP-constant' class='summary_signature priv'>METHODS_MAP =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L215-L222'># File 'ext/openssl/lib/openssl/ssl.rb', line 215</a>    <pre class='code ruby'>{
  <span class='label'>SSLv23:</span> <span class='int'>0</span><span class='comma'>,</span>
  <span class='label'>SSLv2:</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#SSL2_VERSION-constant" title="OpenSSL::SSL::SSL2_VERSION (constant)">SSL2_VERSION</a></span><span class='comma'>,</span>
  <span class='label'>SSLv3:</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#SSL3_VERSION-constant" title="OpenSSL::SSL::SSL3_VERSION (constant)">SSL3_VERSION</a></span><span class='comma'>,</span>
  <span class='label'>TLSv1:</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#TLS1_VERSION-constant" title="OpenSSL::SSL::TLS1_VERSION (constant)">TLS1_VERSION</a></span><span class='comma'>,</span>
  <span class='label'>TLSv1_1:</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#TLS1_1_VERSION-constant" title="OpenSSL::SSL::TLS1_1_VERSION (constant)">TLS1_1_VERSION</a></span><span class='comma'>,</span>
  <span class='label'>TLSv1_2:</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#TLS1_2_VERSION-constant" title="OpenSSL::SSL::TLS1_2_VERSION (constant)">TLS1_2_VERSION</a></span><span class='comma'>,</span>
}.<span class='id identifier rubyid_freeze'><a href="#freeze-instance_method" title="OpenSSL::SSL::SSLContext#freeze (method)">freeze</a></span></pre>
  </li>
  <li>
    <span id='SESSION_CACHE_BOTH-constant' class='summary_signature'>SESSION_CACHE_BOTH =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>no different than CACHE_SERVER in 0.9.8e</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2725'># File 'ext/openssl/ossl_ssl.c', line 2725</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_BOTH</span>)</pre>
  </li>
  <li>
    <span id='SESSION_CACHE_CLIENT-constant' class='summary_signature'>SESSION_CACHE_CLIENT =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>doesn’t actually do anything in 0.9.8e</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2715'># File 'ext/openssl/ossl_ssl.c', line 2715</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_CLIENT</span>)</pre>
  </li>
  <li>
    <span id='SESSION_CACHE_NO_AUTO_CLEAR-constant' class='summary_signature'>SESSION_CACHE_NO_AUTO_CLEAR =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Normally the session cache is checked for expired sessions every 255 connections.  Since this may lead to a delay that cannot be controlled, the automatic flushing may be disabled and <a href="#flush_sessions-instance_method" title="OpenSSL::SSL::SSLContext#flush_sessions (method)">#flush_sessions</a> can be called explicitly.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2733'># File 'ext/openssl/ossl_ssl.c', line 2733</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_NO_AUTO_CLEAR</span>)</pre>
  </li>
  <li>
    <span id='SESSION_CACHE_NO_INTERNAL-constant' class='summary_signature'>SESSION_CACHE_NO_INTERNAL =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Enables both <a href="#SESSION_CACHE_NO_INTERNAL_LOOKUP-constant" title="OpenSSL::SSL::SSLContext::SESSION_CACHE_NO_INTERNAL_LOOKUP (constant)">SESSION_CACHE_NO_INTERNAL_LOOKUP</a> and <a href="#SESSION_CACHE_NO_INTERNAL_STORE-constant" title="OpenSSL::SSL::SSLContext::SESSION_CACHE_NO_INTERNAL_STORE (constant)">SESSION_CACHE_NO_INTERNAL_STORE</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2752'># File 'ext/openssl/ossl_ssl.c', line 2752</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_NO_INTERNAL</span>)</pre>
  </li>
  <li>
    <span id='SESSION_CACHE_NO_INTERNAL_LOOKUP-constant' class='summary_signature'>SESSION_CACHE_NO_INTERNAL_LOOKUP =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Always perform external lookups of sessions even if they are in the internal cache.</p>

<p>This flag has no effect on clients</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2741'># File 'ext/openssl/ossl_ssl.c', line 2741</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_NO_INTERNAL_LOOKUP</span>)</pre>
  </li>
  <li>
    <span id='SESSION_CACHE_NO_INTERNAL_STORE-constant' class='summary_signature'>SESSION_CACHE_NO_INTERNAL_STORE =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Never automatically store sessions in the internal store.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2746'># File 'ext/openssl/ossl_ssl.c', line 2746</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_NO_INTERNAL_STORE</span>)</pre>
  </li>
  <li>
    <span id='SESSION_CACHE_OFF-constant' class='summary_signature'>SESSION_CACHE_OFF =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>No session caching for client or server</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2710'># File 'ext/openssl/ossl_ssl.c', line 2710</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_OFF</span>)</pre>
  </li>
  <li>
    <span id='SESSION_CACHE_SERVER-constant' class='summary_signature'>SESSION_CACHE_SERVER =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Server sessions are added to the session cache</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2720'># File 'ext/openssl/ossl_ssl.c', line 2720</a>    <pre class='code c'><span class='const'>LONG2NUM</span>(<span class='const'>SSL_SESS_CACHE_SERVER</span>)</pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>  &#x21d2; ctx </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a new <a href="../SSL.html" title="OpenSSL::SSL (module)"><code>::OpenSSL::SSL</code></a> context.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#ciphers-instance_method" title="#ciphers (instance method)">#<strong>ciphers</strong>  &#x21d2; Array, ... </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>The list of cipher suites configured for this context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#ciphers=-instance_method" title="#ciphers= (instance method)">#<strong>ciphers=</strong>(&quot;cipher1:cipher2:...&quot;)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the list of available cipher suites for this context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature wo'>
      <a href="#ecdh_curves=-instance_method" title="#ecdh_curves= (instance method)">#<strong>ecdh_curves=</strong>(curve_list)  &#x21d2; curve_list </a>
    </span>
    <span class='note title writeonly'>writeonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the list of “supported elliptic curves” for this context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature wo'>
      <a href="#max_version=-instance_method" title="#max_version= (instance method)">#<strong>max_version=</strong>(OpenSSL::SSL::TLS1_2_VERSION)  </a>
    </span>
    <span class='note title writeonly'>writeonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the upper bound of the supported SSL/TLS protocol version.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature wo'>
      <a href="#min_version=-instance_method" title="#min_version= (instance method)">#<strong>min_version=</strong>(OpenSSL::SSL::TLS1_2_VERSION)  </a>
    </span>
    <span class='note title writeonly'>writeonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the lower bound on the supported SSL/TLS protocol version.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Gets various <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> options.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#options=-instance_method" title="#options= (instance method)">#<strong>options=</strong>(options)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets various <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> options.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#security_level-instance_method" title="#security_level (instance method)">#<strong>security_level</strong>  &#x21d2; Integer </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the security level for the context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#security_level=-instance_method" title="#security_level= (instance method)">#<strong>security_level=</strong>(integer)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the security level for the context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#servername_cb-instance_method" title="#servername_cb (instance method)">#<strong>servername_cb</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>A callback invoked at connect time to distinguish between multiple server names.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#session_cache_mode-instance_method" title="#session_cache_mode (instance method)">#<strong>session_cache_mode</strong>  &#x21d2; Integer </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>The current session cache mode.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#session_cache_mode=-instance_method" title="#session_cache_mode= (instance method)">#<strong>session_cache_mode=</strong>(integer)  &#x21d2; Integer </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the <a href="../SSL.html" title="OpenSSL::SSL (module)"><code>::OpenSSL::SSL</code></a> session cache mode.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#session_cache_size-instance_method" title="#session_cache_size (instance method)">#<strong>session_cache_size</strong>  &#x21d2; Integer </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the current session cache size.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#session_cache_size=-instance_method" title="#session_cache_size= (instance method)">#<strong>session_cache_size=</strong>(integer)  &#x21d2; Integer </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the session cache size.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature wo'>
      <a href="#ssl_version=-instance_method" title="#ssl_version= (instance method)">#<strong>ssl_version=</strong>(:TLSv1)  </a>
    </span>
    <span class='note title writeonly'>writeonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the SSL/TLS protocol version for the context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#tmp_dh_callback-instance_method" title="#tmp_dh_callback (instance method)">#<strong>tmp_dh_callback</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>A callback invoked when DH parameters are required.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#add_certificate-instance_method" title="#add_certificate (instance method)">#<strong>add_certificate</strong>(certiticate, pkey [, extra_certs])  &#x21d2; self </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Adds a certificate to the context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enable_fallback_scsv-instance_method" title="#enable_fallback_scsv (instance method)">#<strong>enable_fallback_scsv</strong>  &#x21d2; nil </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Activate TLS_FALLBACK_SCSV for this context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#flush_sessions-instance_method" title="#flush_sessions (instance method)">#<strong>flush_sessions</strong>(time)  &#x21d2; self </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Removes sessions in the internal cache that have expired at <em>time</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#freeze-instance_method" title="#setup (instance method)">#<strong>setup</strong>  &#x21d2; Qtrue #firstt time </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#setup-instance_method" title="OpenSSL::SSL::SSLContext#setup (method)">#setup</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#session_add-instance_method" title="#session_add (instance method)">#<strong>session_add</strong>(session)  &#x21d2; Boolean </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Adds <em>session</em> to the session cache.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#session_cache_stats-instance_method" title="#session_cache_stats (instance method)">#<strong>session_cache_stats</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a Hash containing the following keys:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#session_remove-instance_method" title="#session_remove (instance method)">#<strong>session_remove</strong>(session)  &#x21d2; Boolean </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Removes <em>session</em> from the session cache.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_params-instance_method" title="#set_params (instance method)">#<strong>set_params</strong>(params = {})  &#x21d2; params </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets saner defaults optimized for the use with HTTP-like protocols.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#setup-instance_method" title="#setup (instance method)">#<strong>setup</strong>  &#x21d2; Qtrue #firstt time </a>
      (also: #freeze)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This method is called automatically when a new <a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)"><code>SSLSocket</code></a> is created.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ssl_timeout-instance_method" title="#ssl_timeout (instance method)">#<strong>ssl_timeout</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <code>timeout</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ssl_timeout=-instance_method" title="#ssl_timeout= (instance method)">#<strong>ssl_timeout=</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <code>timeout=</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#set_minmax_proto_version-instance_method" title="#set_minmax_proto_version (instance method)">#<strong>set_minmax_proto_version</strong>(min, max)  &#x21d2; nil </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the minimum and maximum supported protocol versions.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    <div class='inline-block'>
      <span class='overload'>.<strong>new</strong>  &#x21d2; <code>ctx</code> </span>
      <span class='overload'>.<strong>new</strong>(:TLSv1)  &#x21d2; <code>ctx</code> </span>
      <span class='overload'>.<strong>new</strong>(&quot;SSLv23&quot;)  &#x21d2; <code>ctx</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new <a href="../SSL.html" title="OpenSSL::SSL (module)"><code>::OpenSSL::SSL</code></a> context.</p>

<p>If an argument is given, <a href="#ssl_version=-instance_method" title="OpenSSL::SSL::SSLContext#ssl_version= (method)">#ssl_version=</a> is called with the value. Note that this form is deprecated. New applications should use <a href="#min_version=-instance_method" title="OpenSSL::SSL::SSLContext#min_version= (method)">#min_version=</a> and <a href="#max_version=-instance_method" title="OpenSSL::SSL::SSLContext#max_version= (method)">#max_version=</a> as necessary.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L121-L124'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='121' data-end='124'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/ssl.rb', line 121</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="OpenSSL::SSL::SSLContext#options (method)">options</a></span> <span class='op'>|=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#OP_ALL-constant" title="OpenSSL::SSL::OP_ALL (constant)">OP_ALL</a></span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_ssl_version'>ssl_version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span> <span class='kw'>if</span> <span class='id identifier rubyid_version'>version</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="ciphers-instance_method">
  <h3 class='signature rw first'>
    #<strong>ciphers</strong>  &#x21d2; <code>Array</code>, ...  <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The list of cipher suites configured for this context.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L981-L1002'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='981' data-end='1002'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 981</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_get_ciphers(VALUE self)
{
    SSL_CTX *ctx;
    STACK_OF(SSL_CIPHER) *ciphers;
    const SSL_CIPHER *cipher;
    VALUE ary;
    int i, num;

    GetSSLCTX(self, ctx);
    ciphers = SSL_CTX_get_ciphers(ctx);
    if (!ciphers)
        return rb_ary_new();

    num = sk_SSL_CIPHER_num(ciphers);
    ary = rb_ary_new2(num);
    for(i = 0; i &lt; num; i++){
        cipher = sk_SSL_CIPHER_value(ciphers, i);
        rb_ary_push(ary, ossl_ssl_cipher_to_ary(cipher));
    }
    return ary;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ciphers=-instance_method">
  <h3 class='signature rw'>
    <div class='inline-block'>
      <span class='overload'>#<strong>ciphers=</strong>(&quot;cipher1:cipher2:...&quot;)   <span class="extras">(<span class='rw'>rw</span>)</span></span>
      <span class='overload'>#<strong>ciphers=</strong>([name, ...])  </span>
      <span class='overload'>#<strong>ciphers=</strong>([[name, version, bits, alg_bits], ...])  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the list of available cipher suites for this context.  Note in a server context some ciphers require the appropriate certificates.  For example, an RSA cipher suite can only be chosen when an RSA certificate is available.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1014-L1044'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1014' data-end='1044'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1014</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_set_ciphers(VALUE self, VALUE v)
{
    SSL_CTX *ctx;
    VALUE str, elem;
    int i;

    rb_check_frozen(self);
    if (NIL_P(v))
	return v;
    else if (RB_TYPE_P(v, T_ARRAY)) {
        str = rb_str_new(0, 0);
        for (i = 0; i &lt; RARRAY_LEN(v); i++) {
            elem = rb_ary_entry(v, i);
            if (RB_TYPE_P(elem, T_ARRAY)) elem = rb_ary_entry(elem, 0);
            elem = rb_String(elem);
            rb_str_append(str, elem);
            if (i &lt; RARRAY_LEN(v)-1) rb_str_cat2(str, &quot;:&quot;);
        }
    } else {
        str = v;
        StringValue(str);
    }

    GetSSLCTX(self, ctx);
    if (!SSL_CTX_set_cipher_list(ctx, StringValueCStr(str))) {
        ossl_raise(eSSLError, &quot;SSL_CTX_set_cipher_list&quot;);
    }

    return v;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ecdh_curves=-instance_method">
  <h3 class='signature wo'>
    #<strong>ecdh_curves=</strong>(curve_list)  &#x21d2; <code>curve_list</code>  <span class="extras">(<span class='writeonly'>writeonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the list of “supported elliptic curves” for this context.</p>

<p>For a TLS client, the list is directly used in the Supported Elliptic Curves Extension. For a server, the list is used by <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> to determine the set of shared curves. <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> will pick the most appropriate one from it.</p>

<p>Note that this works differently with old <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> (&lt;= 1.0.1). Only one curve can be set, and this has no effect for TLS clients.</p>

<h4 id="label-Example">Example</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ctx1'>ctx1</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'>SSLContext</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="OpenSSL::SSL::SSLContext.new (method)">new</a></span>
<span class='id identifier rubyid_ctx1'>ctx1</span>.<span class='id identifier rubyid_ecdh_curves'>ecdh_curves</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>X25519:P-256:P-224</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_svr'>svr</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="SSLServer.html" title="OpenSSL::SSL::SSLServer (class)">SSLServer</a></span>.<span class='id identifier rubyid_new'><a href="SSLServer.html#new-class_method" title="OpenSSL::SSL::SSLServer.new (method)">new</a></span>(<span class='id identifier rubyid_tcp_svr'>tcp_svr</span><span class='comma'>,</span> <span class='id identifier rubyid_ctx1'>ctx1</span>)
<span class='const'>Thread</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="OpenSSL::SSL::SSLContext.new (method)">new</a></span> { <span class='id identifier rubyid_svr'>svr</span>.<span class='id identifier rubyid_accept'>accept</span> }

<span class='id identifier rubyid_ctx2'>ctx2</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'>SSLContext</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="OpenSSL::SSL::SSLContext.new (method)">new</a></span>
<span class='id identifier rubyid_ctx2'>ctx2</span>.<span class='id identifier rubyid_ecdh_curves'>ecdh_curves</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>P-256</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_cli'>cli</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)">SSLSocket</a></span>.<span class='id identifier rubyid_new'><a href="SSLSocket.html#new-class_method" title="OpenSSL::SSL::SSLSocket.new (method)">new</a></span>(<span class='id identifier rubyid_tcp_sock'>tcp_sock</span><span class='comma'>,</span> <span class='id identifier rubyid_ctx2'>ctx2</span>)
<span class='id identifier rubyid_cli'>cli</span>.<span class='id identifier rubyid_connect'>connect</span>

<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_cli'>cli</span>.<span class='id identifier rubyid_tmp_key'>tmp_key</span>.<span class='id identifier rubyid_group'>group</span>.<span class='id identifier rubyid_curve_name'>curve_name</span>
<span class='comment'># =&gt; &quot;prime256v1&quot; (is an alias for NIST P-256)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1074-L1126'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1074' data-end='1126'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1074</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_set_ecdh_curves(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;

    rb_check_frozen(self);
    GetSSLCTX(self, ctx);
    StringValueCStr(arg);

#if defined(HAVE_SSL_CTX_SET1_CURVES_LIST)
    if (!SSL_CTX_set1_curves_list(ctx, RSTRING_PTR(arg)))
	ossl_raise(eSSLError, NULL);
#else
    /* OpenSSL does not have SSL_CTX_set1_curves_list()... Fallback to
     * SSL_CTX_set_tmp_ecdh(). So only the first curve is used. */
    {
	VALUE curve, splitted;
	EC_KEY *ec;
	int nid;

	splitted = rb_str_split(arg, &quot;:&quot;);
	if (!RARRAY_LEN(splitted))
	    ossl_raise(eSSLError, &quot;invalid input format&quot;);
	curve = RARRAY_AREF(splitted, 0);
	StringValueCStr(curve);

	/* SSL_CTX_set1_curves_list() accepts NIST names */
	nid = EC_curve_nist2nid(RSTRING_PTR(curve));
	if (nid == NID_undef)
	    nid = OBJ_txt2nid(RSTRING_PTR(curve));
	if (nid == NID_undef)
	    ossl_raise(eSSLError, &quot;unknown curve name&quot;);

	ec = EC_KEY_new_by_curve_name(nid);
	if (!ec)
	    ossl_raise(eSSLError, NULL);
	EC_KEY_set_asn1_flag(ec, OPENSSL_EC_NAMED_CURVE);
	if (!SSL_CTX_set_tmp_ecdh(ctx, ec)) {
	    EC_KEY_free(ec);
	    ossl_raise(eSSLError, &quot;SSL_CTX_set_tmp_ecdh&quot;);
	}
	EC_KEY_free(ec);
# if defined(HAVE_SSL_CTX_SET_ECDH_AUTO)
	/* tmp_ecdh and ecdh_auto conflict. tmp_ecdh is ignored when ecdh_auto
	 * is enabled. So disable ecdh_auto. */
	if (!SSL_CTX_set_ecdh_auto(ctx, 0))
	    ossl_raise(eSSLError, &quot;SSL_CTX_set_ecdh_auto&quot;);
# endif
    }
#endif

    return arg;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="max_version=-instance_method">
  <h3 class='signature wo'>
    <div class='inline-block'>
      <span class='overload'>#<strong>max_version=</strong>(OpenSSL::SSL::TLS1_2_VERSION)   <span class="extras">(<span class='writeonly'>writeonly</span>)</span></span>
      <span class='overload'>#<strong>max_version=</strong>(:TLS1_2)  </span>
      <span class='overload'>#<strong>max_version=</strong>(nil)  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the upper bound of the supported SSL/TLS protocol version. See <a href="#min_version=-instance_method" title="OpenSSL::SSL::SSLContext#min_version= (method)">#min_version=</a> for the possible values.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L182-L185'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='182' data-end='185'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/ssl.rb', line 182</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_max_version='>max_version=</span>(<span class='id identifier rubyid_version'>version</span>)
  <span class='id identifier rubyid_set_minmax_proto_version'><a href="#set_minmax_proto_version-instance_method" title="OpenSSL::SSL::SSLContext#set_minmax_proto_version (method)">set_minmax_proto_version</a></span>(<span class='ivar'>@min_proto_version</span> <span class='op'>||=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span>)
  <span class='ivar'>@max_proto_version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="min_version=-instance_method">
  <h3 class='signature wo'>
    <div class='inline-block'>
      <span class='overload'>#<strong>min_version=</strong>(OpenSSL::SSL::TLS1_2_VERSION)   <span class="extras">(<span class='writeonly'>writeonly</span>)</span></span>
      <span class='overload'>#<strong>min_version=</strong>(:TLS1_2)  </span>
      <span class='overload'>#<strong>min_version=</strong>(nil)  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the lower bound on the supported SSL/TLS protocol version. The version may be specified by an integer constant named OpenSSL::SSL::*_VERSION, a Symbol, or <code>nil</code> which means “any version”.</p>

<p>Be careful that you don’t overwrite OpenSSL::SSL::OP_NO_<code>SSL,TLS</code>v* options by <a href="#options=-instance_method" title="OpenSSL::SSL::SSLContext#options= (method)">#options=</a> once you have called <code>#min_version=</code> or <a href="#max_version=-instance_method" title="OpenSSL::SSL::SSLContext#max_version= (method)">#max_version=</a>.</p>

<h4 id="label-Example">Example</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ctx'>ctx</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'>SSLContext</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="OpenSSL::SSL::SSLContext.new (method)">new</a></span>
<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_min_version'>min_version</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#TLS1_1_VERSION-constant" title="OpenSSL::SSL::TLS1_1_VERSION (constant)">TLS1_1_VERSION</a></span>
<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_max_version'>max_version</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#TLS1_2_VERSION-constant" title="OpenSSL::SSL::TLS1_2_VERSION (constant)">TLS1_2_VERSION</a></span>

<span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)">SSLSocket</a></span>.<span class='id identifier rubyid_new'><a href="SSLSocket.html#new-class_method" title="OpenSSL::SSL::SSLSocket.new (method)">new</a></span>(<span class='id identifier rubyid_tcp_sock'>tcp_sock</span><span class='comma'>,</span> <span class='id identifier rubyid_ctx'>ctx</span>)
<span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_connect'>connect</span> <span class='comment'># Initiates a connection using either TLS 1.1 or TLS 1.2</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L170-L173'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='170' data-end='173'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/ssl.rb', line 170</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_min_version='>min_version=</span>(<span class='id identifier rubyid_version'>version</span>)
  <span class='id identifier rubyid_set_minmax_proto_version'><a href="#set_minmax_proto_version-instance_method" title="OpenSSL::SSL::SSLContext#set_minmax_proto_version (method)">set_minmax_proto_version</a></span>(<span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='ivar'>@max_proto_version</span> <span class='op'>||=</span> <span class='kw'>nil</span>)
  <span class='ivar'>@min_proto_version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="options-instance_method">
  <h3 class='signature rw'>
    #<strong>options</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Gets various <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> options.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L732-L742'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='732' data-end='742'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 732</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_get_options(VALUE self)
{
    SSL_CTX *ctx;
    GetSSLCTX(self, ctx);
    /*
     * Do explicit cast because SSL_CTX_get_options() returned (signed) long in
     * OpenSSL before 1.1.0.
     */
    return ULONG2NUM((unsigned long)SSL_CTX_get_options(ctx));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="options=-instance_method">
  <h3 class='signature rw'>
    #<strong>options=</strong>(options)   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets various <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> options.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L747-L764'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='747' data-end='764'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 747</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_set_options(VALUE self, VALUE options)
{
    SSL_CTX *ctx;

    rb_check_frozen(self);
    GetSSLCTX(self, ctx);

    SSL_CTX_clear_options(ctx, SSL_CTX_get_options(ctx));

    if (NIL_P(options)) {
	SSL_CTX_set_options(ctx, SSL_OP_ALL);
    } else {
	SSL_CTX_set_options(ctx, NUM2ULONG(options));
    }

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="security_level-instance_method">
  <h3 class='signature rw'>
    #<strong>security_level</strong>  &#x21d2; <a href="../../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the security level for the context.</p>

<p>See also <a href="#security_level=-instance_method" title="OpenSSL::SSL::SSLContext#security_level= (method)">#security_level=</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1139-L1152'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1139' data-end='1152'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1139</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_get_security_level(VALUE self)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

#if defined(HAVE_SSL_CTX_GET_SECURITY_LEVEL)
    return INT2NUM(SSL_CTX_get_security_level(ctx));
#else
    (void)ctx;
    return INT2FIX(0);
#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="security_level=-instance_method">
  <h3 class='signature rw'>
    #<strong>security_level=</strong>(integer)   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the security level for the context. <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> limits parameters according to the level. The “parameters” include: ciphersuites, curves, key sizes, certificate signature algorithms, protocol version and so on. For example, level 1 rejects parameters offering below 80 bits of security, such as ciphersuites using MD5 for the MAC or RSA keys shorter than 1024 bits.</p>

<p>Note that attempts to set such parameters with insufficient security are also blocked. You need to lower the level first.</p>

<p>This feature is not supported in <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> &lt; 1.1.0, and setting the level to other than 0 will raise NotImplementedError. Level 0 means everything is permitted, the same behavior as previous versions of <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a>.</p>

<p>See the manpage of SSL_CTX_set_security_level(3) for details.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1173-L1191'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1173' data-end='1191'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1173</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_set_security_level(VALUE self, VALUE value)
{
    SSL_CTX *ctx;

    rb_check_frozen(self);
    GetSSLCTX(self, ctx);

#if defined(HAVE_SSL_CTX_GET_SECURITY_LEVEL)
    SSL_CTX_set_security_level(ctx, NUM2INT(value));
#else
    (void)ctx;
    if (NUM2INT(value) != 0)
	ossl_raise(rb_eNotImpError, &quot;setting security level to other than 0 is &quot;
		   &quot;not supported in this version of OpenSSL&quot;);
#endif

    return value;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="servername_cb-instance_method">
  <h3 class='signature rw'>
    #<strong>servername_cb</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A callback invoked at connect time to distinguish between multiple server names.</p>

<p>The callback is invoked with an <a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)"><code>SSLSocket</code></a> and a server name.  The callback must return an <code>SSLContext</code> for the server name or nil.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L109-L109'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='109' data-end='109'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/ssl.rb', line 109</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_servername_cb'>servername_cb</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session_cache_mode-instance_method">
  <h3 class='signature rw'>
    #<strong>session_cache_mode</strong>  &#x21d2; <a href="../../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The current session cache mode.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1363-L1371'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1363' data-end='1371'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1363</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_get_session_cache_mode(VALUE self)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    return LONG2NUM(SSL_CTX_get_session_cache_mode(ctx));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session_cache_mode=-instance_method">
  <h3 class='signature rw'>
    #<strong>session_cache_mode=</strong>(integer)  &#x21d2; <a href="../../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the <a href="../SSL.html" title="OpenSSL::SSL (module)"><code>::OpenSSL::SSL</code></a> session cache mode.  Bitwise-or together the desired SESSION_CACHE_* constants to set.  See SSL_CTX_set_session_cache_mode(3) for details.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1381-L1391'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1381' data-end='1391'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1381</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_set_session_cache_mode(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    SSL_CTX_set_session_cache_mode(ctx, NUM2LONG(arg));

    return arg;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session_cache_size-instance_method">
  <h3 class='signature rw'>
    #<strong>session_cache_size</strong>  &#x21d2; <a href="../../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the current session cache size.  Zero is used to represent an unlimited cache size.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1400-L1408'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1400' data-end='1408'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1400</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_get_session_cache_size(VALUE self)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    return LONG2NUM(SSL_CTX_sess_get_cache_size(ctx));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session_cache_size=-instance_method">
  <h3 class='signature rw'>
    #<strong>session_cache_size=</strong>(integer)  &#x21d2; <a href="../../Integer.html" title="Integer (class)">Integer</a>  <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the session cache size.  Returns the previously valid session cache size.  Zero is used to represent an unlimited session cache size.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1417-L1427'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1417' data-end='1427'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1417</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_set_session_cache_size(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    SSL_CTX_sess_set_cache_size(ctx, NUM2LONG(arg));

    return arg;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ssl_version=-instance_method">
  <h3 class='signature wo'>
    <div class='inline-block'>
      <span class='overload'>#<strong>ssl_version=</strong>(:TLSv1)   <span class="extras">(<span class='writeonly'>writeonly</span>)</span></span>
      <span class='overload'>#<strong>ssl_version=</strong>(&quot;SSLv23&quot;)  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the SSL/TLS protocol version for the context. This forces connections to use only the specified protocol version. This is deprecated and only provided for backwards compatibility. Use <a href="#min_version=-instance_method" title="OpenSSL::SSL::SSLContext#min_version= (method)">#min_version=</a> and <a href="#max_version=-instance_method" title="OpenSSL::SSL::SSLContext#max_version= (method)">#max_version=</a> instead.</p>

<h4 id="label-History">History</h4>

<p>As the name hints, this used to call the SSL_CTX_set_ssl_version() function which sets the <a href="../SSL.html" title="OpenSSL::SSL (module)"><code>::OpenSSL::SSL</code></a> method used for connections created from the context. As of Ruby/OpenSSL 2.1, this accessor method is implemented to call <a href="#min_version=-instance_method" title="OpenSSL::SSL::SSLContext#min_version= (method)">#min_version=</a> and <a href="#max_version=-instance_method" title="OpenSSL::SSL::SSLContext#max_version= (method)">#max_version=</a> instead.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L201-L213'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='201' data-end='213'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/ssl.rb', line 201</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_version='>ssl_version=</span>(<span class='id identifier rubyid_meth'>meth</span>)
  <span class='id identifier rubyid_meth'>meth</span> <span class='op'>=</span> <span class='id identifier rubyid_meth'>meth</span>.<span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_meth'>meth</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Symbol</span>)
  <span class='kw'>if</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(?&lt;type&gt;_client|_server)\z</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='id identifier rubyid_meth'>meth</span>
    <span class='id identifier rubyid_meth'>meth</span> <span class='op'>=</span> <span class='backref'>$`</span>
    <span class='kw'>if</span> <span class='gvar'>$VERBOSE</span>
      <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_caller'>caller</span>(<span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span>)[<span class='int'>0</span>]<span class='embexpr_end'>}</span><span class='tstring_content'>: method type </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is ignored</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='const'><a href="#METHODS_MAP-constant" title="OpenSSL::SSL::SSLContext::METHODS_MAP (constant)">METHODS_MAP</a></span>[<span class='id identifier rubyid_meth'>meth</span>.<span class='id identifier rubyid_intern'>intern</span>] <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown SSL method `%s&#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_meth'>meth</span>
  <span class='id identifier rubyid_set_minmax_proto_version'><a href="#set_minmax_proto_version-instance_method" title="OpenSSL::SSL::SSLContext#set_minmax_proto_version (method)">set_minmax_proto_version</a></span>(<span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span>)
  <span class='ivar'>@min_proto_version</span> <span class='op'>=</span> <span class='ivar'>@max_proto_version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="tmp_dh_callback-instance_method">
  <h3 class='signature rw'>
    #<strong>tmp_dh_callback</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A callback invoked when DH parameters are required.</p>

<p>The callback is invoked with the <a href="Session.html" title="OpenSSL::SSL::Session (class)"><code>Session</code></a> for the key exchange, an flag indicating the use of an export cipher and the keylength required.</p>

<p>The callback must return an <a href="../PKey/DH.html" title="OpenSSL::PKey::DH (class)"><code>::OpenSSL::PKey::DH</code></a> instance of the correct key length.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L102-L102'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='102' data-end='102'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/ssl.rb', line 102</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tmp_dh_callback'>tmp_dh_callback</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="add_certificate-instance_method">
  <h3 class='signature  first'>
    #<strong>add_certificate</strong>(certiticate, pkey [, extra_certs])  &#x21d2; <code>self</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Adds a certificate to the context. <em>pkey</em> must be a corresponding private key with <em>certificate</em>.</p>

<p>Multiple certificates with different public key type can be added by repeated calls of this method, and <a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> will choose the most appropriate certificate during the handshake.</p>

<p><code>#cert=</code>, <code>#key=</code>, and <code>#extra_chain_cert=</code> are old accessor methods for setting certificate and internally call this method.</p>

<h4 id="label-Parameters">Parameters</h4>
<dl class="rdoc-list note-list"><dt><em>certificate</em>
<dd>
<p>A certificate. An instance of OpenSSL::X509::Certificate.</p>
</dd><dt><em>pkey</em>
<dd>
<p>The private key for <em>certificate</em>. An instance of OpenSSL::PKey::PKey.</p>
</dd><dt><em>extra_certs</em>
<dd>
<p>Optional. An array of OpenSSL::X509::Certificate. When sending a certificate chain, the certificates specified by this are sent following <em>certificate</em>, in the order in the array.</p>
</dd></dl>

<h4 id="label-Example">Example</h4>

<pre class="code ruby"><code class="ruby">rsa_cert = OpenSSL::X509::Certificate.new(...)
rsa_pkey = OpenSSL::PKey.read(...)
ca_intermediate_cert = OpenSSL::X509::Certificate.new(...)
ctx.add_certificate(rsa_cert, rsa_pkey, [ca_intermediate_cert])

ecdsa_cert = ...
ecdsa_pkey = ...
another_ca_cert = ...
ctx.add_certificate(ecdsa_cert, ecdsa_pkey, [another_ca_cert])</code></pre>

<h4 id="label-Note">Note</h4>

<p><a href="../../OpenSSL.html" title="OpenSSL (module)"><code>::OpenSSL</code></a> before the version 1.0.2 could handle only one extra chain across all key types. Calling this method discards the chain set previously.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1252-L1319'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1252' data-end='1319'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1252</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_add_certificate(int argc, VALUE *argv, VALUE self)
{
    VALUE cert, key, extra_chain_ary;
    SSL_CTX *ctx;
    X509 *x509;
    STACK_OF(X509) *extra_chain = NULL;
    EVP_PKEY *pkey, *pub_pkey;

    GetSSLCTX(self, ctx);
    rb_scan_args(argc, argv, &quot;21&quot;, &amp;cert, &amp;key, &amp;extra_chain_ary);
    rb_check_frozen(self);
    x509 = GetX509CertPtr(cert);
    pkey = GetPrivPKeyPtr(key);

    /*
     * The reference counter is bumped, and decremented immediately.
     * X509_get0_pubkey() is only available in OpenSSL &gt;= 1.1.0.
     */
    pub_pkey = X509_get_pubkey(x509);
    EVP_PKEY_free(pub_pkey);
    if (!pub_pkey)
	rb_raise(rb_eArgError, &quot;certificate does not contain public key&quot;);
    if (EVP_PKEY_cmp(pub_pkey, pkey) != 1)
	rb_raise(rb_eArgError, &quot;public key mismatch&quot;);

    if (argc &gt;= 3)
	extra_chain = ossl_x509_ary2sk(extra_chain_ary);

    if (!SSL_CTX_use_certificate(ctx, x509)) {
	sk_X509_pop_free(extra_chain, X509_free);
	ossl_raise(eSSLError, &quot;SSL_CTX_use_certificate&quot;);
    }
    if (!SSL_CTX_use_PrivateKey(ctx, pkey)) {
	sk_X509_pop_free(extra_chain, X509_free);
	ossl_raise(eSSLError, &quot;SSL_CTX_use_PrivateKey&quot;);
    }

    if (extra_chain) {
#if OPENSSL_VERSION_NUMBER &gt;= 0x10002000 &amp;&amp; !defined(LIBRESSL_VERSION_NUMBER)
	if (!SSL_CTX_set0_chain(ctx, extra_chain)) {
	    sk_X509_pop_free(extra_chain, X509_free);
	    ossl_raise(eSSLError, &quot;SSL_CTX_set0_chain&quot;);
	}
#else
	STACK_OF(X509) *orig_extra_chain;
	X509 *x509_tmp;

	/* First, clear the existing chain */
	SSL_CTX_get_extra_chain_certs(ctx, &amp;orig_extra_chain);
	if (orig_extra_chain &amp;&amp; sk_X509_num(orig_extra_chain)) {
	    rb_warning(&quot;SSL_CTX_set0_chain() is not available; &quot; \
		       &quot;clearing previously set certificate chain&quot;);
	    SSL_CTX_clear_extra_chain_certs(ctx);
	}
	while ((x509_tmp = sk_X509_shift(extra_chain))) {
	    /* Transfers ownership */
	    if (!SSL_CTX_add_extra_chain_cert(ctx, x509_tmp)) {
		X509_free(x509_tmp);
		sk_X509_pop_free(extra_chain, X509_free);
		ossl_raise(eSSLError, &quot;SSL_CTX_add_extra_chain_cert&quot;);
	    }
	}
	sk_X509_free(extra_chain);
#endif
    }
    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enable_fallback_scsv-instance_method">
  <h3 class='signature '>
    #<strong>enable_fallback_scsv</strong>  &#x21d2; <code>nil</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Activate TLS_FALLBACK_SCSV for this context. See RFC 7507.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1201-L1210'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1201' data-end='1210'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1201</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_enable_fallback_scsv(VALUE self)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);
    SSL_CTX_set_mode(ctx, SSL_MODE_SEND_FALLBACK_SCSV);

    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="flush_sessions-instance_method">
  <h3 class='signature '>
    #<strong>flush_sessions</strong>(time)  &#x21d2; <code>self</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Removes sessions in the internal cache that have expired at <em>time</em>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1483-L1505'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1483' data-end='1505'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1483</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_flush_sessions(int argc, VALUE *argv, VALUE self)
{
    VALUE arg1;
    SSL_CTX *ctx;
    time_t tm = 0;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;arg1);

    GetSSLCTX(self, ctx);

    if (NIL_P(arg1)) {
        tm = time(0);
    } else if (rb_obj_is_instance_of(arg1, rb_cTime)) {
        tm = NUM2LONG(rb_funcall(arg1, rb_intern(&quot;to_i&quot;), 0));
    } else {
        ossl_raise(rb_eArgError, &quot;arg must be Time or nil&quot;);
    }

    SSL_CTX_flush_sessions(ctx, (long)tm);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="freeze-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>setup</strong>  &#x21d2; <code>Qtrue</code> #<code>firstt</code> <code>time</code> </span>
      <span class='overload'>#<strong>setup</strong>  &#x21d2; <code>nil</code> #<code>thereafterr</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#setup-instance_method" title="OpenSSL::SSL::SSLContext#setup (method)">#setup</a>.</p>

  </div>
</div>

</section>

<section class='method_details' id="session_add-instance_method">
  <h3 class='signature '>
    #<strong>session_add</strong>(session)  &#x21d2; <code>Boolean</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Adds <em>session</em> to the session cache.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1327-L1337'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1327' data-end='1337'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1327</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_session_add(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;
    SSL_SESSION *sess;

    GetSSLCTX(self, ctx);
    GetSSLSession(arg, sess);

    return SSL_CTX_add_session(ctx, sess) == 1 ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session_cache_stats-instance_method">
  <h3 class='signature '>
    #<strong>session_cache_stats</strong>  &#x21d2; <code>Hash</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a Hash containing the following keys:</p>
<dl class="rdoc-list note-list"><dt>:accept
<dd>
<p>Number of started SSL/TLS handshakes in server mode</p>
</dd><dt>:accept_good
<dd>
<p>Number of established SSL/TLS sessions in server mode</p>
</dd><dt>:accept_renegotiate
<dd>
<p>Number of start renegotiations in server mode</p>
</dd><dt>:cache_full
<dd>
<p>Number of sessions that were removed due to cache overflow</p>
</dd><dt>:cache_hits
<dd>
<p>Number of successfully reused connections</p>
</dd><dt>:cache_misses
<dd>
<p>Number of sessions proposed by clients that were not found in the cache</p>
</dd><dt>:cache_num
<dd>
<p>Number of sessions in the internal session cache</p>
</dd><dt>:cb_hits
<dd>
<p>Number of sessions retrieved from the external cache in server mode</p>
</dd><dt>:connect
<dd>
<p>Number of started SSL/TLS handshakes in client mode</p>
</dd><dt>:connect_good
<dd>
<p>Number of established SSL/TLS sessions in client mode</p>
</dd><dt>:connect_renegotiate
<dd>
<p>Number of start renegotiations in client mode</p>
</dd><dt>:timeouts
<dd>
<p>Number of sessions proposed by clients that were found in the cache but had expired due to timeouts</p>
</dd></dl>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1451-L1474'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1451' data-end='1474'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1451</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_get_session_cache_stats(VALUE self)
{
    SSL_CTX *ctx;
    VALUE hash;

    GetSSLCTX(self, ctx);

    hash = rb_hash_new();
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_num&quot;)), LONG2NUM(SSL_CTX_sess_number(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;connect&quot;)), LONG2NUM(SSL_CTX_sess_connect(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;connect_good&quot;)), LONG2NUM(SSL_CTX_sess_connect_good(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;connect_renegotiate&quot;)), LONG2NUM(SSL_CTX_sess_connect_renegotiate(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;accept&quot;)), LONG2NUM(SSL_CTX_sess_accept(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;accept_good&quot;)), LONG2NUM(SSL_CTX_sess_accept_good(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;accept_renegotiate&quot;)), LONG2NUM(SSL_CTX_sess_accept_renegotiate(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_hits&quot;)), LONG2NUM(SSL_CTX_sess_hits(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cb_hits&quot;)), LONG2NUM(SSL_CTX_sess_cb_hits(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_misses&quot;)), LONG2NUM(SSL_CTX_sess_misses(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_full&quot;)), LONG2NUM(SSL_CTX_sess_cache_full(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;timeouts&quot;)), LONG2NUM(SSL_CTX_sess_timeouts(ctx)));

    return hash;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session_remove-instance_method">
  <h3 class='signature '>
    #<strong>session_remove</strong>(session)  &#x21d2; <code>Boolean</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Removes <em>session</em> from the session cache.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L1345-L1355'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1345' data-end='1355'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 1345</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_session_remove(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;
    SSL_SESSION *sess;

    GetSSLCTX(self, ctx);
    GetSSLSession(arg, sess);

    return SSL_CTX_remove_session(ctx, sess) == 1 ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_minmax_proto_version-instance_method">
  <h3 class='signature priv'>
    #<strong>set_minmax_proto_version</strong>(min, max)  &#x21d2; <code>nil</code>  <span class="extras">(<span class='priv'>private</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the minimum and maximum supported protocol versions. See <a href="#min_version=-instance_method" title="OpenSSL::SSL::SSLContext#min_version= (method)">#min_version=</a> and <a href="#max_version=-instance_method" title="OpenSSL::SSL::SSLContext#max_version= (method)">#max_version=</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L152-L198'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='152' data-end='198'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 152</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_set_minmax_proto_version(VALUE self, VALUE min_v, VALUE max_v)
{
    SSL_CTX *ctx;
    int min, max;

    GetSSLCTX(self, ctx);
    min = parse_proto_version(min_v);
    max = parse_proto_version(max_v);

#ifdef HAVE_SSL_CTX_SET_MIN_PROTO_VERSION
    if (!SSL_CTX_set_min_proto_version(ctx, min))
	ossl_raise(eSSLError, &quot;SSL_CTX_set_min_proto_version&quot;);
    if (!SSL_CTX_set_max_proto_version(ctx, max))
	ossl_raise(eSSLError, &quot;SSL_CTX_set_max_proto_version&quot;);
#else
    {
	unsigned long sum = 0, opts = 0;
	int i;
	static const struct {
	    int ver;
	    unsigned long opts;
	} options_map[] = {
	    { SSL2_VERSION, SSL_OP_NO_SSLv2 },
	    { SSL3_VERSION, SSL_OP_NO_SSLv3 },
	    { TLS1_VERSION, SSL_OP_NO_TLSv1 },
	    { TLS1_1_VERSION, SSL_OP_NO_TLSv1_1 },
	    { TLS1_2_VERSION, SSL_OP_NO_TLSv1_2 },
# if defined(TLS1_3_VERSION)
	    { TLS1_3_VERSION, SSL_OP_NO_TLSv1_3 },
# endif
	};

	for (i = 0; i &lt; numberof(options_map); i++) {
	    sum |= options_map[i].opts;
            if ((min &amp;&amp; min &gt; options_map[i].ver) ||
                (max &amp;&amp; max &lt; options_map[i].ver)) {
		opts |= options_map[i].opts;
            }
	}
	SSL_CTX_clear_options(ctx, sum);
	SSL_CTX_set_options(ctx, opts);
    }
#endif

    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_params-instance_method">
  <h3 class='signature '>
    #<strong>set_params</strong>(params = {})  &#x21d2; <code>params</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets saner defaults optimized for the use with HTTP-like protocols.</p>

<p>If a Hash <em>params</em> is given, the parameters are overridden with it. The keys in <em>params</em> must be assignment methods on <code>SSLContext</code>.</p>

<p>If the verify_mode is not <a href="../SSL.html#VERIFY_NONE-constant" title="OpenSSL::SSL::VERIFY_NONE (constant)">VERIFY_NONE</a> and ca_file, ca_path and cert_store are not set then the system default certificate store is used.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/lib/openssl/ssl.rb#L138-L148'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='138' data-end='148'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/ssl.rb', line 138</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_params'>set_params</span>(<span class='id identifier rubyid_params'>params</span><span class='op'>=</span>{})
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='const'><a href="#DEFAULT_PARAMS-constant" title="OpenSSL::SSL::SSLContext::DEFAULT_PARAMS (constant)">DEFAULT_PARAMS</a></span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_params'>params</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="OpenSSL::SSL::SSLContext#options (method)">options</a></span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_options'><a href="#options-instance_method" title="OpenSSL::SSL::SSLContext#options (method)">options</a></span>) <span class='comment'># set before min_version/max_version
</span>  <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_each'>each</span>{<span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span> <span class='kw'>self</span>.<span class='id identifier rubyid___send__'>__send__</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>) }
  <span class='kw'>if</span> <span class='kw'>self</span>.<span class='id identifier rubyid_verify_mode'>verify_mode</span> <span class='op'>!=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="../SSL.html#VERIFY_NONE-constant" title="OpenSSL::SSL::VERIFY_NONE (constant)">VERIFY_NONE</a></span>
    <span class='kw'>unless</span> <span class='kw'>self</span>.<span class='id identifier rubyid_ca_file'>ca_file</span> <span class='kw'>or</span> <span class='kw'>self</span>.<span class='id identifier rubyid_ca_path'>ca_path</span> <span class='kw'>or</span> <span class='kw'>self</span>.<span class='id identifier rubyid_cert_store'>cert_store</span>
      <span class='kw'>self</span>.<span class='id identifier rubyid_cert_store'>cert_store</span> <span class='op'>=</span> <span class='const'><a href="#DEFAULT_CERT_STORE-constant" title="OpenSSL::SSL::SSLContext::DEFAULT_CERT_STORE (constant)">DEFAULT_CERT_STORE</a></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_params'>params</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="setup-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>setup</strong>  &#x21d2; <code>Qtrue</code> #<code>firstt</code> <code>time</code> </span>
      <span class='overload'>#<strong>setup</strong>  &#x21d2; <code>nil</code> #<code>thereafterr</code> </span>
    </div>
    <span class='aliases'>Also known as: <span class='names'>#freeze</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>This method is called automatically when a new <a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)"><code>SSLSocket</code></a> is created. However, it is not thread-safe and must be called before creating <a href="SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)"><code>SSLSocket</code></a> objects in a multi-threaded program.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L775-L957'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='775' data-end='957'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ssl.c', line 775</span></pre>
<pre class='code cpp'>

static VALUE
ossl_sslctx_setup(VALUE self)
{
    SSL_CTX *ctx;
    X509 *cert = NULL, *client_ca = NULL;
    EVP_PKEY *key = NULL;
    char *ca_path = NULL, *ca_file = NULL;
    int verify_mode;
    long i;
    VALUE val;

    if(OBJ_FROZEN(self)) return Qnil;
    GetSSLCTX(self, ctx);

#if !defined(OPENSSL_NO_DH)
    SSL_CTX_set_tmp_dh_callback(ctx, ossl_tmp_dh_callback);
#endif

#if !defined(OPENSSL_NO_EC)
    /* We added SSLContext#tmp_ecdh_callback= in Ruby 2.3.0,
     * but SSL_CTX_set_tmp_ecdh_callback() was removed in OpenSSL 1.1.0. */
    if (RTEST(rb_attr_get(self, id_i_tmp_ecdh_callback))) {
# if defined(HAVE_SSL_CTX_SET_TMP_ECDH_CALLBACK)
	rb_warn(&quot;#tmp_ecdh_callback= is deprecated; use #ecdh_curves= instead&quot;);
	SSL_CTX_set_tmp_ecdh_callback(ctx, ossl_tmp_ecdh_callback);
#  if defined(HAVE_SSL_CTX_SET_ECDH_AUTO)
	/* tmp_ecdh_callback and ecdh_auto conflict; OpenSSL ignores
	 * tmp_ecdh_callback. So disable ecdh_auto. */
	if (!SSL_CTX_set_ecdh_auto(ctx, 0))
	    ossl_raise(eSSLError, &quot;SSL_CTX_set_ecdh_auto&quot;);
#  endif
# else
	ossl_raise(eSSLError, &quot;OpenSSL does not support tmp_ecdh_callback; &quot;
		   &quot;use #ecdh_curves= instead&quot;);
# endif
    }
#endif /* OPENSSL_NO_EC */

    val = rb_attr_get(self, id_i_cert_store);
    if (!NIL_P(val)) {
	X509_STORE *store = GetX509StorePtr(val); /* NO NEED TO DUP */
	SSL_CTX_set_cert_store(ctx, store);
#if !defined(HAVE_X509_STORE_UP_REF)
	/*
         * WORKAROUND:
	 *   X509_STORE can count references, but
	 *   X509_STORE_free() doesn&#39;t care it.
	 *   So we won&#39;t increment it but mark it by ex_data.
	 */
        SSL_CTX_set_ex_data(ctx, ossl_sslctx_ex_store_p, ctx);
#else /* Fixed in OpenSSL 1.0.2; bff9ce4db38b (master), 5b4b9ce976fc (1.0.2) */
	X509_STORE_up_ref(store);
#endif
    }

    val = rb_attr_get(self, id_i_extra_chain_cert);
    if(!NIL_P(val)){
	rb_block_call(val, rb_intern(&quot;each&quot;), 0, 0, ossl_sslctx_add_extra_chain_cert_i, self);
    }

    /* private key may be bundled in certificate file. */
    val = rb_attr_get(self, id_i_cert);
    cert = NIL_P(val) ? NULL : GetX509CertPtr(val); /* NO DUP NEEDED */
    val = rb_attr_get(self, id_i_key);
    key = NIL_P(val) ? NULL : GetPrivPKeyPtr(val); /* NO DUP NEEDED */
    if (cert &amp;&amp; key) {
        if (!SSL_CTX_use_certificate(ctx, cert)) {
            /* Adds a ref =&gt; Safe to FREE */
            ossl_raise(eSSLError, &quot;SSL_CTX_use_certificate&quot;);
        }
        if (!SSL_CTX_use_PrivateKey(ctx, key)) {
            /* Adds a ref =&gt; Safe to FREE */
            ossl_raise(eSSLError, &quot;SSL_CTX_use_PrivateKey&quot;);
        }
        if (!SSL_CTX_check_private_key(ctx)) {
            ossl_raise(eSSLError, &quot;SSL_CTX_check_private_key&quot;);
        }
    }

    val = rb_attr_get(self, id_i_client_ca);
    if(!NIL_P(val)){
	if (RB_TYPE_P(val, T_ARRAY)) {
	    for(i = 0; i &lt; RARRAY_LEN(val); i++){
		client_ca = GetX509CertPtr(RARRAY_AREF(val, i));
        	if (!SSL_CTX_add_client_CA(ctx, client_ca)){
		    /* Copies X509_NAME =&gt; FREE it. */
        	    ossl_raise(eSSLError, &quot;SSL_CTX_add_client_CA&quot;);
        	}
	    }
        }
	else{
	    client_ca = GetX509CertPtr(val); /* NO DUP NEEDED. */
            if (!SSL_CTX_add_client_CA(ctx, client_ca)){
		/* Copies X509_NAME =&gt; FREE it. */
        	ossl_raise(eSSLError, &quot;SSL_CTX_add_client_CA&quot;);
            }
	}
    }

    val = rb_attr_get(self, id_i_ca_file);
    ca_file = NIL_P(val) ? NULL : StringValueCStr(val);
    val = rb_attr_get(self, id_i_ca_path);
    ca_path = NIL_P(val) ? NULL : StringValueCStr(val);
    if(ca_file || ca_path){
	if (!SSL_CTX_load_verify_locations(ctx, ca_file, ca_path))
	    rb_warning(&quot;can&#39;t set verify locations&quot;);
    }

    val = rb_attr_get(self, id_i_verify_mode);
    verify_mode = NIL_P(val) ? SSL_VERIFY_NONE : NUM2INT(val);
    SSL_CTX_set_verify(ctx, verify_mode, ossl_ssl_verify_callback);
    if (RTEST(rb_attr_get(self, id_i_client_cert_cb)))
	SSL_CTX_set_client_cert_cb(ctx, ossl_client_cert_cb);

    val = rb_attr_get(self, id_i_timeout);
    if(!NIL_P(val)) SSL_CTX_set_timeout(ctx, NUM2LONG(val));

    val = rb_attr_get(self, id_i_verify_depth);
    if(!NIL_P(val)) SSL_CTX_set_verify_depth(ctx, NUM2INT(val));

#ifndef OPENSSL_NO_NEXTPROTONEG
    val = rb_attr_get(self, id_i_npn_protocols);
    if (!NIL_P(val)) {
	VALUE encoded = ssl_encode_npn_protocols(val);
	rb_ivar_set(self, id_npn_protocols_encoded, encoded);
	SSL_CTX_set_next_protos_advertised_cb(ctx, ssl_npn_advertise_cb, (void *)encoded);
	OSSL_Debug(&quot;SSL NPN advertise callback added&quot;);
    }
    if (RTEST(rb_attr_get(self, id_i_npn_select_cb))) {
	SSL_CTX_set_next_proto_select_cb(ctx, ssl_npn_select_cb, (void *) self);
	OSSL_Debug(&quot;SSL NPN select callback added&quot;);
    }
#endif

#ifdef HAVE_SSL_CTX_SET_ALPN_SELECT_CB
    val = rb_attr_get(self, id_i_alpn_protocols);
    if (!NIL_P(val)) {
	VALUE rprotos = ssl_encode_npn_protocols(val);

	/* returns 0 on success */
	if (SSL_CTX_set_alpn_protos(ctx, (unsigned char *)RSTRING_PTR(rprotos),
				    RSTRING_LENINT(rprotos)))
	    ossl_raise(eSSLError, &quot;SSL_CTX_set_alpn_protos&quot;);
	OSSL_Debug(&quot;SSL ALPN values added&quot;);
    }
    if (RTEST(rb_attr_get(self, id_i_alpn_select_cb))) {
	SSL_CTX_set_alpn_select_cb(ctx, ssl_alpn_select_cb, (void *) self);
	OSSL_Debug(&quot;SSL ALPN select callback added&quot;);
    }
#endif

    rb_obj_freeze(self);

    val = rb_attr_get(self, id_i_session_id_context);
    if (!NIL_P(val)){
	StringValue(val);
	if (!SSL_CTX_set_session_id_context(ctx, (unsigned char *)RSTRING_PTR(val),
					    RSTRING_LENINT(val))){
	    ossl_raise(eSSLError, &quot;SSL_CTX_set_session_id_context&quot;);
	}
    }

    if (RTEST(rb_attr_get(self, id_i_session_get_cb))) {
	SSL_CTX_sess_set_get_cb(ctx, ossl_sslctx_session_get_cb);
	OSSL_Debug(&quot;SSL SESSION get callback added&quot;);
    }
    if (RTEST(rb_attr_get(self, id_i_session_new_cb))) {
	SSL_CTX_sess_set_new_cb(ctx, ossl_sslctx_session_new_cb);
	OSSL_Debug(&quot;SSL SESSION new callback added&quot;);
    }
    if (RTEST(rb_attr_get(self, id_i_session_remove_cb))) {
	SSL_CTX_sess_set_remove_cb(ctx, ossl_sslctx_session_remove_cb);
	OSSL_Debug(&quot;SSL SESSION remove callback added&quot;);
    }

    val = rb_attr_get(self, id_i_servername_cb);
    if (!NIL_P(val)) {
        SSL_CTX_set_tlsext_servername_callback(ctx, ssl_servername_cb);
	OSSL_Debug(&quot;SSL TLSEXT servername callback added&quot;);
    }

    return Qtrue;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ssl_timeout-instance_method">
  <h3 class='signature '>
    #<strong>ssl_timeout</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <code>timeout</code>.</p>

  </div>
</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2690'>GitHub</a> ]</span>

</section>

<section class='method_details' id="ssl_timeout=-instance_method">
  <h3 class='signature '>
    #<strong>ssl_timeout=</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <code>timeout=</code>.</p>

  </div>
</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby/ruby/blob/v2_6_10/ext/openssl/ossl_ssl.c#L2691'>GitHub</a> ]</span>

</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>