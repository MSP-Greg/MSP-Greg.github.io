<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: OpenSSL &mdash; openssl Ruby-2.0.0 p247</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.0.0</a> &raquo; 
          <a href='index.html'>openssl</a> &raquo; 
          <a href='_index.html'>Index (O)</a> &raquo; 
          <span class='title'>OpenSSL</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: OpenSSL</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>

  <tr>
    <td class='box_1'>Child Modules:</td>
    <td>
      <a href="OpenSSL/ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a>,
    <a href="OpenSSL/Buffering.html" title="OpenSSL::Buffering (module)">Buffering</a>,
    <a href="OpenSSL/Netscape.html" title="OpenSSL::Netscape (module)">Netscape</a>,
    <a href="OpenSSL/OCSP.html" title="OpenSSL::OCSP (module)">OCSP</a>,
    <a href="OpenSSL/PKCS5.html" title="OpenSSL::PKCS5 (module)">PKCS5</a>,
    <a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a>,
    <a href="OpenSSL/Random.html" title="OpenSSL::Random (module)">Random</a>,
    <a href="OpenSSL/SSL.html" title="OpenSSL::SSL (module)">SSL</a>,
    <a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <a href="OpenSSL/BN.html" title="OpenSSL::BN (class)">BN</a>,
    <a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)">Cipher</a>,
    <a href="OpenSSL/Config.html" title="OpenSSL::Config (class)">Config</a>,
    <a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a>,
    <a href="OpenSSL/Engine.html" title="OpenSSL::Engine (class)">Engine</a>,
    <a href="OpenSSL/HMAC.html" title="OpenSSL::HMAC (class)">HMAC</a>,
    <a href="OpenSSL/PKCS12.html" title="OpenSSL::PKCS12 (class)">PKCS12</a>,
    <a href="OpenSSL/PKCS7.html" title="OpenSSL::PKCS7 (class)">PKCS7</a>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Child Exceptions:</td>
    <td>
      <a href="OpenSSL/BNError.html" title="OpenSSL::BNError (class)">BNError</a>,
    <a href="OpenSSL/ConfigError.html" title="OpenSSL::ConfigError (class)">ConfigError</a>,
    <a href="OpenSSL/HMACError.html" title="OpenSSL::HMACError (class)">HMACError</a>,
    <a href="OpenSSL/OpenSSLError.html" title="OpenSSL::OpenSSLError (class)">OpenSSLError</a>
    </td>
  </tr>




  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
openssl/ossl_bn.c<span class='defines'>,<br />openssl/ossl.c,<br /> openssl/ossl_asn1.c,<br /> openssl/ossl_cipher.c,<br /> openssl/ossl_digest.c,<br /> openssl/ossl_hmac.c,<br /> openssl/ossl_ns_spki.c,<br /> openssl/ossl_pkcs5.c,<br /> openssl/ossl_pkey.c,<br /> openssl/ossl_pkey_dh.c,<br /> openssl/ossl_pkey_dsa.c,<br /> openssl/ossl_pkey_ec.c,<br /> openssl/ossl_pkey_rsa.c,<br /> openssl/ossl_rand.c,<br /> openssl/ossl_ssl.c,<br /> openssl/ossl_ssl_session.c,<br /> openssl/ossl_x509cert.c,<br /> openssl/ossl_x509store.c,<br /> openssl/lib/openssl/bn.rb,<br /> openssl/lib/openssl/cipher.rb,<br /> openssl/lib/openssl/config.rb,<br /> openssl/lib/openssl/digest.rb,<br /> openssl/lib/openssl/ssl.rb,<br /> openssl/lib/openssl/x509.rb</span>
</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>OpenSSL provides SSL, TLS and general purpose cryptography.  It wraps the
<a href="http://www.openssl.org/">OpenSSL</a> library.</p>

<h3 id="label-Examples">Examples</h3>

<p>All examples assume you have loaded OpenSSL with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openssl</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>These examples build atop each other.  For example the key created in the
next is used in throughout these examples.</p>

<h4 id="label-Keys">Keys</h4>

<h5 id="label-Creating+a+Key">Creating a Key</h5>

<p>This example creates a 2048 bit RSA keypair and writes it to the current
directory.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='int'>2048</span>

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private_key.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span> <span class='kw'>end</span>
<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>public_key.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span> <span class='kw'>end</span>
</code></pre>

<h5 id="label-Exporting+a+Key">Exporting a Key</h5>

<p>Keys saved to disk without encryption are not secure as anyone who gets
ahold of the key may use it unless it is encrypted.  In order to securely
export a key you may export it with a pass phrase.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cipher'>cipher</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Cipher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-128-CBC</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_pass_phrase'>pass_phrase</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my secure pass phrase goes here</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_key_secure'>key_secure</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_export'>export</span> <span class='id identifier rubyid_cipher'>cipher</span><span class='comma'>,</span> <span class='id identifier rubyid_pass_phrase'>pass_phrase</span>

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private.secure.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_key_secure'>key_secure</span>
<span class='kw'>end</span>
</code></pre>

<p><a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)">Cipher</a>.ciphers returns a list of available ciphers.</p>

<h5 id="label-Loading+a+Key">Loading a Key</h5>

<p>A key can also be loaded from a file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key2'>key2</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private_key.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_key2'>key2</span><span class='period'>.</span><span class='id identifier rubyid_public?'>public?</span> <span class='comment'># =&gt; true
</span></code></pre>

<p>or</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key3'>key3</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>public_key.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_key3'>key3</span><span class='period'>.</span><span class='id identifier rubyid_private?'>private?</span> <span class='comment'># =&gt; false
</span></code></pre>

<h5 id="label-Loading+an+Encrypted+Key">Loading an Encrypted Key</h5>

<p>OpenSSL will prompt you for your pass phrase when loading an encrypted key.
If you will not be able to type in the pass phrase you may provide it when
loading the key:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key4_pem'>key4_pem</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private.secure.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_key4'>key4</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_key4_pem'>key4_pem</span><span class='comma'>,</span> <span class='id identifier rubyid_pass_phrase'>pass_phrase</span>
</code></pre>

<h4 id="label-RSA+Encryption">RSA Encryption</h4>

<p>RSA provides encryption and decryption using the public and private keys.
You can use a variety of padding methods depending upon the intended use of
encrypted data.</p>

<h5 id="label-Encryption+-26+Decryption">Encryption &amp; Decryption</h5>

<p>Asymmetric public/private key encryption is slow and victim to attack in
cases where it is used without padding or directly to encrypt larger chunks
of data. Typical use cases for RSA encryption involve “wrapping” a
symmetric key with the public key of the recipient who would “unwrap” that
symmetric key again using their private key. The following illustrates a
simplified example of such a key transport scheme. It shouldn&#39;t be used
in practice, though, standardized protocols should always be preferred.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_wrapped_key'>wrapped_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_public_encrypt'>public_encrypt</span> <span class='id identifier rubyid_key'>key</span>
</code></pre>

<p>A symmetric key encrypted with the public key can only be decrypted with
the corresponding private key of the recipient.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_original_key'>original_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_private_decrypt'>private_decrypt</span> <span class='id identifier rubyid_wrapped_key'>wrapped_key</span>
</code></pre>

<p>By default <code>PKCS#1</code> padding will be used, but it is also possible to use
other forms of padding, see <a href="OpenSSL/PKey/RSA.html" title="OpenSSL::PKey::RSA (class)">PKey::RSA</a> for further details.</p>

<h5 id="label-Signatures">Signatures</h5>

<p>Using “private_encrypt” to encrypt some data with the private key is
equivalent to applying a digital signature to the data. A verifying party
may validate the signature by comparing the result of decrypting the
signature with “public_decrypt” to the original data. However,
<a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a> already has methods “sign” and “verify” that handle digital
signatures in a standardized way - “private_encrypt” and “public_decrypt”
shouldn&#39;t be used in practice.</p>

<p>To sign a document, a cryptographically secure hash of the document is
computed first, which is then signed using the private key.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA256</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_signature'>signature</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_digest'>digest</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span>
</code></pre>

<p>To validate the signature, again a hash of the document is computed and the
signature is decrypted using the public key. The result is then compared to
the hash just computed, if they are equal the signature was valid.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA256</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_verify'>verify</span> <span class='id identifier rubyid_digest'>digest</span><span class='comma'>,</span> <span class='id identifier rubyid_signature'>signature</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Valid</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>else</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Invalid</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</code></pre>

<h4 id="label-PBKDF2+Password-based+Encryption">PBKDF2 Password-based Encryption</h4>

<p>If supported by the underlying OpenSSL version used, Password-based
Encryption should use the features of PKCS5. If not supported or if
required by legacy applications, the older, less secure methods specified
in RFC 2898 are also supported (see below).</p>

<p>PKCS5 supports PBKDF2 as it was specified in <code>PKCS#5</code> <a
href="http://www.rsa.com/rsalabs/node.asp?id=2127">v2.0</a>. It still uses
a password, a salt, and additionally a number of iterations that will slow
the key derivation process down. The slower this is, the more work it
requires being able to brute-force the resulting key.</p>

<h5 id="label-Encryption">Encryption</h5>

<p>The strategy is to first instantiate a Cipher for encryption, and then to
generate a random IV plus a key derived from the password using PBKDF2.
PKCS <code>#5</code> v2.0 recommends at least 8 bytes for the salt, the number of
iterations largely depends on the hardware being used.</p>

<pre class="code ruby"><code class="ruby">cipher = OpenSSL::Cipher.new &#39;AES-128-CBC&#39;
cipher.encrypt
iv = cipher.random_iv

pwd = &#39;some hopefully not to easily guessable password&#39;
salt = OpenSSL::Random.random_bytes 16
iter = 20000
key_len = cipher.key_len
digest = OpenSSL::Digest::SHA256.new

key = OpenSSL::PKCS5.pbkdf2_hmac(pwd, salt, iter, key_len, digest)
cipher.key = key

Now encrypt the data:

encrypted = cipher.update document
encrypted &lt;&lt; cipher.final</code></pre>

<h5 id="label-Decryption">Decryption</h5>

<p>Use the same steps as before to derive the symmetric AES key, this time
setting the Cipher up for decryption.</p>

<pre class="code ruby"><code class="ruby">cipher = OpenSSL::Cipher.new &#39;AES-128-CBC&#39;
cipher.decrypt
cipher.iv = iv # the one generated with #random_iv

pwd = &#39;some hopefully not to easily guessable password&#39;
salt = ... # the one generated above
iter = 20000
key_len = cipher.key_len
digest = OpenSSL::Digest::SHA256.new

key = OpenSSL::PKCS5.pbkdf2_hmac(pwd, salt, iter, key_len, digest)
cipher.key = key

Now decrypt the data:

decrypted = cipher.update encrypted
decrypted &lt;&lt; cipher.final</code></pre>

<h4 id="label-PKCS+-7B-235-7D+Password-based+Encryption">PKCS <code>#5</code> Password-based Encryption</h4>

<p>PKCS <code>#5</code> is a password-based encryption standard documented at <a
href="http://www.ietf.org/rfc/rfc2898.txt">RFC2898</a>.  It allows a short
password or passphrase to be used to create a secure encryption key. If
possible, PBKDF2 as described above should be used if the circumstances
allow it.</p>

<p>PKCS <code>#5</code> uses a Cipher, a pass phrase and a salt to generate an encryption
key.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_pass_phrase'>pass_phrase</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my secure pass phrase goes here</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>8 octets</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<h5 id="label-Encryption">Encryption</h5>

<p>First set up the cipher for encryption</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_encrypter'>encrypter</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Cipher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-128-CBC</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_encrypter'>encrypter</span><span class='period'>.</span><span class='id identifier rubyid_encrypt'>encrypt</span>
<span class='id identifier rubyid_encrypter'>encrypter</span><span class='period'>.</span><span class='id identifier rubyid_pkcs5_keyivgen'>pkcs5_keyivgen</span> <span class='id identifier rubyid_pass_phrase'>pass_phrase</span><span class='comma'>,</span> <span class='id identifier rubyid_salt'>salt</span>
</code></pre>

<p>Then pass the data you want to encrypt through</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_encrypted'>encrypted</span> <span class='op'>=</span> <span class='id identifier rubyid_encrypter'>encrypter</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>top secret document</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_encrypted'>encrypted</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_encrypter'>encrypter</span><span class='period'>.</span><span class='id identifier rubyid_final'>final</span>
</code></pre>

<h5 id="label-Decryption">Decryption</h5>

<p>Use a new Cipher instance set up for decryption</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_decrypter'>decrypter</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Cipher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-128-CBC</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_decrypter'>decrypter</span><span class='period'>.</span><span class='id identifier rubyid_decrypt'>decrypt</span>
<span class='id identifier rubyid_decrypter'>decrypter</span><span class='period'>.</span><span class='id identifier rubyid_pkcs5_keyivgen'>pkcs5_keyivgen</span> <span class='id identifier rubyid_pass_phrase'>pass_phrase</span><span class='comma'>,</span> <span class='id identifier rubyid_salt'>salt</span>
</code></pre>

<p>Then pass the data you want to decrypt through</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_plain'>plain</span> <span class='op'>=</span> <span class='id identifier rubyid_decrypter'>decrypter</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='id identifier rubyid_encrypted'>encrypted</span>
<span class='id identifier rubyid_plain'>plain</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_decrypter'>decrypter</span><span class='period'>.</span><span class='id identifier rubyid_final'>final</span>
</code></pre>

<h4 id="label-X509+Certificates">X509 Certificates</h4>

<h5 id="label-Creating+a+Certificate">Creating a Certificate</h5>

<p>This example creates a self-signed certificate using an RSA key and a SHA1
signature.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Name</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CN=nobody/DC=example</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>2</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_after'>not_after</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>3600</span>

<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
</code></pre>

<h5 id="label-Certificate+Extensions">Certificate Extensions</h5>

<p>You can add extensions to the certificate with
SSL::ExtensionFactory to indicate the purpose of the
certificate.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_extension_factory'>extension_factory</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>ExtensionFactory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_cert'>cert</span>

<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:FALSE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>

<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyUsage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyEncipherment,dataEncipherment,digitalSignature</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectKeyIdentifier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>The list of supported extensions (and in some cases their possible values)
can be derived from the “objects.h” file in the OpenSSL source code.</p>

<h5 id="label-Signing+a+Certificate">Signing a Certificate</h5>

<p>To sign a certificate set the issuer and use
<a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a>::Certificate#sign with a digest algorithm.  This creates a
self-signed cert because we&#39;re using the same name and key to sign the
certificate as was used to create the certificate.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA1</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>certificate.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span> <span class='kw'>end</span>
</code></pre>

<h5 id="label-Loading+a+Certificate">Loading a Certificate</h5>

<p>Like a key, a cert can also be loaded from a file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cert2'>cert2</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>certificate.pem</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<h5 id="label-Verifying+a+Certificate">Verifying a Certificate</h5>

<p><code>Certificate#verify</code> will return true when a certificate was signed with
the given public key.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>certificate can not be verified</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_cert2'>cert2</span><span class='period'>.</span><span class='id identifier rubyid_verify'>verify</span> <span class='id identifier rubyid_key'>key</span>
</code></pre>

<h4 id="label-Certificate+Authority">Certificate Authority</h4>

<p>A certificate authority (CA) is a trusted third party that allows you to
verify the ownership of unknown certificates.  The CA issues key signatures
that indicate it trusts the user of that key.  A user encountering the key
can verify the signature by using the CA&#39;s public key.</p>

<h5 id="label-CA+Key">CA Key</h5>

<p>CA keys are valuable, so we encrypt and save it to disk and make sure it is
not readable by other users.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_key'>ca_key</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='int'>2048</span>

<span class='id identifier rubyid_cipher'>cipher</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Cipher</span><span class='op'>::</span><span class='const'>Cipher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-128-CBC</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca_key.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0400</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_export'>export</span><span class='lparen'>(</span><span class='id identifier rubyid_cipher'>cipher</span><span class='comma'>,</span> <span class='id identifier rubyid_pass_phrase'>pass_phrase</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</code></pre>

<h5 id="label-CA+Certificate">CA Certificate</h5>

<p>A CA certificate is created the same way we created a certificate above,
but with different extensions.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_name'>ca_name</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Name</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CN=ca/DC=example</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_ca_cert'>ca_cert</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>2</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_not_after'>not_after</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>86400</span>

<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_key'>ca_key</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_name'>ca_name</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_name'>ca_name</span>

<span class='id identifier rubyid_extension_factory'>extension_factory</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>ExtensionFactory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_subject_certificate'>subject_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_issuer_certificate'>issuer_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>

<span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectKeyIdentifier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>This extension indicates the CA&#39;s key may be used as a CA.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:TRUE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<p>This extension indicates the CA&#39;s key may be used to verify signatures
on both certificates and certificate revocations.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyUsage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cRLSign,keyCertSign</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<p>Root CA certificates are self-signed.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_ca_key'>ca_key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA1</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
</code></pre>

<p>The CA certificate is saved to disk so it may be distributed to all the
users of the keys this CA will sign.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca_cert.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span>
<span class='kw'>end</span>
</code></pre>

<h5 id="label-Certificate+Signing+Request">Certificate Signing Request</h5>

<p>The CA signs keys through a Certificate Signing Request (CSR).  The CSR
contains the information necessary to identify the key.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_csr'>csr</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Request</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
<span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA1</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
</code></pre>

<p>A CSR is saved to disk and sent to the CA for signing.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csr.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span>
<span class='kw'>end</span>
</code></pre>

<h5 id="label-Creating+a+Certificate+from+a+CSR">Creating a Certificate from a CSR</h5>

<p>Upon receiving a CSR the CA will verify it before signing it.  A minimal
verification would be to check the CSR&#39;s signature.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_csr'>csr</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Request</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csr.pem</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CSR can not be verified</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_verify'>verify</span> <span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>
</code></pre>

<p>After verification a certificate is created, marked for various usages,
signed with the CA key and returned to the requester.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_csr_cert'>csr_cert</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>2</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_not_after'>not_after</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>600</span>

<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>

<span class='id identifier rubyid_extension_factory'>extension_factory</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>ExtensionFactory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_subject_certificate'>subject_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_csr_cert'>csr_cert</span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_issuer_certificate'>issuer_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>

<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:FALSE</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyUsage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyEncipherment,dataEncipherment,digitalSignature</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectKeyIdentifier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_ca_key'>ca_key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA1</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csr_cert.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_csr_cert'>csr_cert</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span>
<span class='kw'>end</span>
</code></pre>

<h4 id="label-SSL+and+TLS+Connections">SSL and TLS Connections</h4>

<p>Using our created key and certificate we can create an SSL or TLS
connection. An SSLContext is used to set up an SSL session.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>SSLContext</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
</code></pre>

<h5 id="label-SSL+Server">SSL Server</h5>

<p>An SSL server requires the certificate and private key to communicate
securely with its clients:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='id identifier rubyid_cert'>cert</span>
<span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>
</code></pre>

<p>Then create an SSLServer with a TCP server socket and the context.  Use the
SSLServer like an ordinary TCP server.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_tcp_server'>tcp_server</span> <span class='op'>=</span> <span class='const'>TCPServer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='int'>5000</span>
<span class='id identifier rubyid_ssl_server'>ssl_server</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>SSLServer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_tcp_server'>tcp_server</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>

<span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_ssl_connection'>ssl_connection</span> <span class='op'>=</span> <span class='id identifier rubyid_ssl_server'>ssl_server</span><span class='period'>.</span><span class='id identifier rubyid_accept'>accept</span>

  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>

  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_response'>response</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</code></pre>

<h5 id="label-SSL+client">SSL client</h5>

<p>An SSL client is created with a TCP socket and the context.
<code>SSLSocket#connect</code> must be called to initiate the SSL handshake and start
encryption.  A key and certificate are not required for the client socket.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_tcp_client'>tcp_client</span> <span class='op'>=</span> <span class='const'>TCPSocket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>5000</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>SSLSocket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_client_socket'>client_socket</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span>

<span class='id identifier rubyid_ssl_client'>ssl_client</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello server!</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_ssl_client'>ssl_client</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>
</code></pre>

<h5 id="label-Peer+Verification">Peer Verification</h5>

<p>An unverified SSL connection does not provide much security.  For enhanced
security the client or server can verify the certificate of its peer.</p>

<p>The client can be modified to verify the server&#39;s certificate against
the certificate authority&#39;s certificate:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_ca_file'>ca_file</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca_cert.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_verify_mode'>verify_mode</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_PEER</span>

<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_tcp_client'>tcp_client</span> <span class='op'>=</span> <span class='const'>TCPSocket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>5000</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>SSLSocket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_client_socket'>client_socket</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span>

<span class='id identifier rubyid_ssl_client'>ssl_client</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello server!</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_ssl_client'>ssl_client</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>
</code></pre>

<p>If the server certificate is invalid or <code>context.ca_file</code> is not
set when verifying peers an <a href="OpenSSL/SSL/SSLError.html" title="OpenSSL::SSL::SSLError (class)">SSL::SSLError</a> will be raised.</p>


  </div>
</div>
<div class="tags">
  
</div>
<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='OPENSSL_FIPS-constant'>
      OPENSSL_FIPS
    </dt>
    <dd>
          </dd>
    <dt id='OPENSSL_VERSION-constant'>
      OPENSSL_VERSION
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>Version of OpenSSL the ruby OpenSSL extension was built with</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='OPENSSL_VERSION_NUMBER-constant'>
      OPENSSL_VERSION_NUMBER
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>Version number of OpenSSL the ruby OpenSSL extension was built with (base
16)</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='VERSION-constant'>
      VERSION
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>OpenSSL ruby extension version</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
  </dl>





<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#debug-class_method" title="debug (class method)">.<strong>debug</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='mod_func note title'>mod_func</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#debug%3D-class_method" title="debug= (class method)">.<strong>debug=</strong>(boolean)  &#x21d2; Boolean </a>
      </span>
      <span class='mod_func note title'>mod_func</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Turns on or off CRYPTO_MEM_CHECK.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#Digest-class_method" title=".Digest (class method)"><strong>Digest</strong>(name)  </a>
      </span>
      <span class='mod_func note title'>mod_func</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a Digest subclass by <code>name</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#errors-class_method" title="errors (class method)">.<strong>errors</strong>  &#x21d2; Array </a>
      </span>
      <span class='mod_func note title'>mod_func</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>See any remaining errors held in queue.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#fips_mode%3D-class_method" title="fips_mode= (class method)">.<strong>fips_mode=</strong>(boolean)  &#x21d2; Boolean </a>
      </span>
      <span class='mod_func note title'>mod_func</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Turns FIPS mode on or off.</p>
</div>
      </span>
    </li>
  </ul>


<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="debug-class_method">
  <h3 class='signature first'>
  .<strong>debug</strong>  &#x21d2; <tt>Boolean</tt>  <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div>
</section>
  <section class='method_details' id="debug=-class_method">
  <h3 class='signature'>
  .<strong>debug=</strong>(boolean)  &#x21d2; <tt>Boolean</tt>  <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Turns on or off CRYPTO_MEM_CHECK. Also shows some debugging message on
stderr.</p>


  </div>
</div>
<div class="tags">
  
</div>
</section>
  <section class='method_details' id="Digest-class_method">
  <h3 class='signature'>
  <strong>Digest</strong>(name)   <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a Digest subclass by <code>name</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openssl</span><span class='tstring_end'>&#39;</span></span>

<span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MD5</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; OpenSSL::Digest::MD5
</span>
<span class='const'>Digest</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Foo</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; NameError: wrong constant name Foo
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


82
83
84</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'openssl/lib/openssl/digest.rb', line 82</span>

<span class='kw'>def</span> <span class='const'>Digest</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="errors-class_method">
  <h3 class='signature'>
  .<strong>errors</strong>  &#x21d2; <tt>Array</tt>  <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>See any remaining errors held in queue.</p>

<p>Any errors you see here are probably due to a bug in ruby&#39;s OpenSSL
implementation.</p>


  </div>
</div>
<div class="tags">
  
</div>
</section>
  <section class='method_details' id="fips_mode=-class_method">
  <h3 class='signature'>
  .<strong>fips_mode=</strong>(boolean)  &#x21d2; <tt>Boolean</tt>  <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Turns FIPS mode on or off. Turning on FIPS mode will obviously only have an
effect for FIPS-capable installations of the OpenSSL library. Trying to do
so otherwise will result in an error.</p>

<h4 id="label-Examples">Examples</h4>

<p>fips_mode = true   # turn FIPS mode on fips_mode =
false  # and off again</p>


  </div>
</div>
<div class="tags">
  
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.0 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>