<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: ChangeLog &mdash; Core Ruby-2.0.0 p648</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ChangeLog",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.0.0</a> &raquo; 
          <a href='index.html'>Core</a> &raquo; 
          <a href='_index.html'>Index</a> &raquo; 
          <span class='title'>File: ChangeLog</span>
                </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="file_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='file'>

<p>Wed Dec 16 21:16:55 2015  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/fiddle/handle.c: check tainted string arguments. 	  Patch provided
by tenderlove and nobu.</p>

<p>* test/fiddle/test_handle.rb (class TestHandle): add test for above.</p>

<p>Wed Dec 16 21:16:55 2015  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* ext/dl/handle.c (rb_dlhandle_initialize): prohibits DL::dlopen 	  with a
tainted name of library. 	  Patch by sheepman &lt;sheepman AT
sheepman.sakura.ne.jp&gt;.</p>

<p>* ext/dl/handle.c (rb_dlhandle_sym): ditto</p>

<p>Tue Aug 18 22:00:12 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb: bump version to 2.0.14.1. this version fixed 	 
CVE-2015-3900.</p>

<p>* lib/rubygems/remote_fetcher.rb: ditto.</p>

<p>* test/rubygems/test_gem_remote_fetcher.rb: added testcase for
CVE-2015-3900</p>

<p>Tue Jun  2 00:10:14 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/resolv.rb (Requester#request): typo, regression introduced at 	 
r49422 (patchlevel 618).  reported and patched by Stefan Kolb 	 
[ruby-core:69429] [Backport #11204]</p>

<p>Mon Apr 13 22:11:42 2015  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/openssl/lib/openssl/ssl.rb: stricter hostname verification 	 
following RFC 6125. with the patch provided by Tony Arcieri and 	  Hiroshi
Nakamura [ruby-core:61545] [Bug #9644] 	* test/openssl/test_ssl.rb: add
tests for above.</p>

<p>Tue Mar 24 16:38:14 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* spec/default.mspec: use default configuration file name. 	  <a
href="https://github.com/ruby/rubyspec/commit/cc69f337b06362e5607ffa3e3ad40ef7494960cf">github.com/ruby/rubyspec/commit/cc69f337b06362e5607ffa3e3ad40ef7494960cf</a></p>

<p>Tue Mar 24 16:38:14 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* spec/default.mspec: remove specific version number. 	  <a
href="https://github.com/ruby/rubyspec/commit/7a909e925c1baa9c700bd44af9241aef6e596714">github.com/ruby/rubyspec/commit/7a909e925c1baa9c700bd44af9241aef6e596714</a></p>

<p>Tue Mar 24 16:38:14 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* common.mk: use ruby organization for rubyspec.</p>

<p>Wed Feb 25 17:30:10 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* class.c (clone_method): fixed missing assignment introduced by 	 
previous commit.</p>

<p>* vm_insnhelper.c (rb_vm_rewrite_cref_stack): ditto.</p>

<p>Wed Feb 25 15:07:01 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm_insnhelper.c (rb_vm_rewrite_cref_stack): copy nd_refinements 	  of
original crefs. It fixes segmentation fault when calling 	  refined method
in duplicate module. [ruby-dev:48878] [Bug #10885]</p>

<p>* vm_core.h, class.c: change accordingly.</p>

<p>* test/ruby/test_refinement.rb: add a test for above.</p>

<p>Wed Feb 25 14:53:27 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* class.c (method_entry_i, class_instance_method_list, 	 
rb_obj_singleton_methods): should not include methods of 	  superclasses if
recur is false. [ruby-dev:48854] [Bug #10826]</p>

<p>Wed Feb 25 14:53:27 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (remove_method): When remove refined 	  method, raise a
NameError if the method is not 	  defined in refined class. 	 	  But if the
method is defined in refined class, 	  it should keep refined method and
remove original 	  method.</p>

<p>Patch by Seiei Higa. [ruby-core:67722] [Bug #10765]</p>

<p>Wed Feb 25 14:41:01 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>* vm_method.c (check_definition): Module#public_method_defined?, 	 
Module#private_method_defined?, Module#protected_method_defined? 	  should
not use refinements. [ruby-core:67656] [Bug #10753]</p>

<p>Wed Feb 25 14:29:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/sdbm/_sdbm.c: include ruby/ruby.h for PRIdPTRDIFF when a 	  macro
`DEBUG` is defined.  based on the patch by Owen Rodley in 	 
[ruby-core:67987]. [Bug #10825]</p>

<p>Wed Feb 25 14:22:57 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (try_cppflags, try_cflags, try_ldflags): get rid of 	 
interference by modifying global variables in have_devel? method. 	 
[ruby-core:67962] [Bug #10821]</p>

<p>Wed Feb 25 14:19:35 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* thread.c: Improve documentation for Thread#value 	  [Bug #<a
href="ruby-core:67324">10694]</a>[ci skip]</p>

<p>Wed Feb 25 14:18:26 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* string.c: [DOC] Add missing documentation around String#chomp. 	 
Patchby @stderr [ci skip][fix GH-780]</p>

<p>Sat Feb 21 09:48:48 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/generic.rb (URI::Generic.build): 	  use hostname= to detect and
wrap IPv6 hosts. 	  Build is accepting URI components and users may not
expect 	  that a host component needs to be wrapped with square brackets 	 
since it&#39;s not providing a URI. 	  Note: initialize with arg_check
=&gt; true does not wrap IPv6 hosts. 	  by Joe Rafaniello
&lt;jrafanie@redhat.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/765">github.com/ruby/ruby/pull/765</a>
fix GH-765</p>

<p>* test/uri/test_generic.rb: Add more tests</p>

<p>Wed Feb 18 16:02:30 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/resolv.rb (Resolv::DNS::Resource#==, #hash): elements 	  returned by
Kernel#instance_variables are Symbols now. 	  [ruby-core:68128] [Bug
#10857]</p>

<p>Tue Feb 17 17:37:14 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/getaddrinfo.c (get_addr): reject too long hostname to 	  get
rid of GHOST vulnerability on very old platforms.</p>

<p>* ext/socket/raddrinfo.c (make_hostent_internal): ditto, paranoic 	  check
for the canonical name.</p>

<p>Fri Jan 30 16:49:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c: [DOC] Revise documentation by Marcus Stollsteimer at 	 
[ruby-core:66368].  [Bug #10526]</p>

<p>* #inspect: be more specific about generated string, remove 	   
obsolete example. 	  * #nil?: use code examples instead of different
call-seq&#39;s. 	  * #tap: clarify what is yielded. 	  * Integer(): be more
specific about to_int and to_i, remove 	    reference to Ruby 1.8. 	  *
Array(): fix error. 	  * Class: fix variable name style and indentation in
example. 	  * improve consistency, fix typos and formatting.</p>

<p>Fri Jan 30 16:49:15 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* object.c (Module#const_defined?): [DOC] Revise the documentation. 	 
Patch by Xavier Noria. 	  [Fixes GH-754] <a
href="https://github.com/ruby/ruby/pull/754">github.com/ruby/ruby/pull/754</a></p>

<p>Fri Jan 30 16:49:15 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* object.c: fix document of Kernel.Stirng by @suzukaze 	  [fix GH-743][ci
skip]</p>

<p>Fri Jan 30 16:26:57 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* pack.c (str_associate, str_associated): keep associated objects 	  in an
instance variables, instead of in the internal structure.</p>

<p>Fri Jan 30 16:11:47 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rdoc/text.rb (expand_tabs): get rid of infinite loop with 	  CR. 
should check if substitution occurred too. 	  [ruby-dev:48813] [Bug #10732]</p>

<p>Fri Jan 30 16:00:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (install_dirs): revert DESTDIR prefix by r39841, since 	  it
is fixed by r41648.  [ruby-core:55760] [Bug #8115]</p>

<p>Fri Jan 30 15:47:49 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* numeric.c (bit_coerce): use original value for error message 	 
[ruby-core:67405] [Bug #10711] 	* test/ruby/test_numeric.rb (test_coerce):
check error message</p>

<p>Tue Jan 27 17:05:43 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>* vm_method.c (rb_alias): raise a NameError when creating alias to 	  a
refined method if the original method of the refined method is 	  not
defined.  [ruby-core:67523] [Bug #10731]</p>

<p>Tue Jan 27 16:41:33 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>* vm_method.c (rb_export_method): bail out if the original method 	  is
undefined when the method is refined. 	  [ruby-core:67387] [Bug #10706]</p>

<p>Tue Jan 27 16:27:44 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* lib/resolv.rb: consider ENETUNREACH as ResolvTimeout 	 
[ruby-core:67411] [Bug #10712]</p>

<p>Thu Jan 22 18:15:41 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* ext/zlib/zlib.c: fix document of method signatures. 	  [Bug #<a
href="ruby-core:67186">10668]</a>[ci skip]</p>

<p>Thu Jan 22 18:10:35 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb: added timeout for AIX environment. 	 
[ruby-core:62983][Bug #9917]</p>

<p>Thu Jan 22 17:30:33 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* lib/net/http.rb (Net::HTTP#send_request): there is no response body 	 
with HEAD request. Patch by @rodrigosaito [fix GH-520]</p>

<p>Thu Jan 22 17:30:33 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* test/net/http/test_http.rb (_test_send_request__HEAD): Added 	  failing
test for send_request with HEAD method.</p>

<p>Wed Jan 14 16:53:14 2015  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* ext/tk/lib/tkextlib/tcllib/plotchart.rb: fix to invoke correct function
	  of tcllib. Patch by @zalt50 [fix GH-787]</p>

<p>Wed Jan 14 16:48:15 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb (Resolv::DNS::Name#==): Compare an array of Label:Str 	 
objects.  Label#Str#== is case-insensitive.</p>

<p>Wed Jan 14 16:48:15 2015  Ben Miller  &lt;bmiller@rackspace.com&gt;</p>

<p>* lib/resolv.rb (Resolv::DNS::Name#==): DNS is case-insensitive, so the 	 
comparison should be case-insensitive as well. 	  [ruby-core:66498] [Bug
#10550]</p>

<p>Wed Jan 14 16:48:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/resolv.rb (Resolv::DNS::Name): names with different dots 	  should
be different.</p>

<p>Wed Jan 14 16:30:51 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http/response.rb (Net::HTTPResponse): require one or more 	 
spaces [Bug #10591]. 	  by leriksen &lt;leif.eriksen.au@gmail.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/782">github.com/ruby/ruby/pull/782</a>
fix GH-782 	  NOTE: graph.facebook.com returns without SP Reason-Phrase.</p>

<p>Wed Jan 14 16:23:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_cipher.c (ossl_cipher_update_long): update huge 	  data
gradually not to exceed INT_MAX.  workaround of OpenSSL API 	  limitation. 
[ruby-core:67043] [Bug #10633]</p>

<p>Wed Jan 14 16:14:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (rb_cv_binary_elf): get rid of -e option of cat 	  which is
not available on BusyBox, use tr instead. 	  [ruby-core:64824] [Bug #10210]</p>

<p>Wed Jan 14 16:07:11 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* signal.c (ruby_signal): since SIGKILL is not supported by MSVCRT, 	 
should be treated before calling signal(3). 	  [Bug #10615]</p>

<p>Wed Jan 14 15:57:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (exec_recursive): use the same last method name as 	 
recursive_push in the error message when recursive_pop failed. 	 
[ruby-core:66742] [Bug #10579]</p>

<p>Wed Jan 14 15:57:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (rb_frame_last_func): return the most recent frame method 	 
name.</p>

<p>* thread.c (recursive_list_access): use the last method name, 	  instead
of the current method name which can be unset in some 	  cases, not to use
a symbol by the invalid ID. 	  [ruby-core:66742] [Bug #10579]</p>

<p>Wed Jan 14 15:54:18 2015  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/resolv.rb: fall back if canonicalization fails. 	  Thanks Vit
Ondruch for the patch!  [ruby-core:65836]</p>

<p>* test/resolv/test_dns.rb: test for patch</p>

<p>Fri Nov 28 16:43:20 2014  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Do not attempt SSL session resumption when the 	 
session is expired.  [Bug #10533]</p>

<p>Fri Nov 28 16:36:34 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (symbol_list): fix the node type of literal symbol list 	  with
no interpolation.  [ruby-core:66343]</p>

<p>Fri Nov 28 16:28:07 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/etc/etc.c (etc_getlogin): set login name encoding properly. 	 
[ruby-core:66163] [Bug #10493]</p>

<p>Fri Nov 28 16:18:44 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (method_proc): the receiver of binding from method should 	  be
same as the receiver of the method. 	  [ruby-core:65917] [Bug #10432]</p>

<p>Fri Nov 28 16:12:22 2014  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP.proxy_uri): use initializer instead 	  of
parser to handle IPv6 address. [Bug #9129]</p>

<p>Fri Nov 28 16:05:09 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (copy_stream_body): should write in binary mode.  based on a 	 
patch by godfat (Lin Jen-Shin) at [ruby-core:56556]. 	  [ruby-core:56518]
[Bug #8767]</p>

<p>Fri Nov 28 16:05:09 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (copy_stream_body): move common open flags.</p>

<p>Fri Nov 28 16:01:44 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rubygems/ssl_certs/AddTrustExternalCARoot<code>-2048,</code>.pem: add newer 	 
root CA for rubygems.org.  a part of r48389 of trunk. 	  see also <a
href="https://github.com/rubygems/rubygems/commit/98f5f44c7141881c756003e4256b1a96b200b98e">github.com/rubygems/rubygems/commit/98f5f44c7141881c756003e4256b1a96b200b98e</a>
. 	  [Backport #10516] [ruby-core:66303]</p>

<p>Wed Nov 19 10:19:36 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* vm_eval.c (rb_yield_splat): add missing GC guard 	  [Bug #10509]</p>

<p>Thu Nov 13 22:31:50 2014  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rexml/document.rb: add REXML::Document#document. 	  reported by
Tomas Hoger &lt;thoger@redhat.com&gt; and patched by nahi.</p>

<p>Thu Nov  6 17:31:51 2014  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* compile.c (compile_data_alloc): add padding when strict alignment 	  is
required for memory access. Currently, the padding is enabled 	  only when
the CPU is 32-bit SPARC and the compiler is GCC. 	  [Bug #9681]
[ruby-core:61715]</p>

<p>* compile.c (STRICT_ALIGNMENT): defined if strict alignment is required</p>

<p>* compile.c (ALIGNMENT_SIZE, ALIGNMENT_SIZE_MASK, PADDING_SIZE_MAX): 	 
new macros for alignemnt word size, bit mask, max size of padding.</p>

<p>* compile.c (calc_padding): new function to calculate padding size</p>

<p>Wed Nov  5 18:26:49 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (unknown_keyword_error): delete expected keywords 	 
directly from raw table, so that the given block is not called. 	  derived
from r48102 of trunk. 	  [ruby-core:65837] [Bug #10413]</p>

<p>Mon Oct 27 20:21:05 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rexml/entity.rb: keep the entity size within the limitation. 	 
reported by Willis Vandevanter &lt;will@silentrobots.com&gt; and 	  patched
by nahi.</p>

<p>Mon Oct 27 13:26:46 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_method_entry_make): warn redefinition only for 	 
already defined methods, but not for undefined methods. 	  [ruby-dev:48691]
[Bug #10421]</p>

<p>Thu Oct 23 18:56:55 2014  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/openssl/lib/openssl/ssl.rb (DEFAULT_PARAMS): override 	  options
even if OpenSSL::SSL::OP_NO_SSLv3 is not defined. 	  this is pointed out by
Stephen Touset. [ruby-core:65711] [Bug #9424]</p>

<p>Thu Oct 23 18:56:55 2014  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* test/openssl/test_ssl.rb: Reuse TLS default options from 	 
OpenSSL::SSL::SSLContext::DEFAULT_PARAMS.</p>

<p>Thu Oct 23 18:56:55 2014  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* lib/openssl/ssl.rb: Explicitly whitelist the default 	  SSL/TLS ciphers.
Forbid SSLv2 and SSLv3, disable 	  compression by default. 	  Reported by
Jeff Hodges. 	  [ruby-core:59829] [Bug #9424]</p>

<p>Mon Oct 20 14:41:45 2014  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm_core.h, vm.c, proc.c: fix GC mark miss on bindings. 	 
[ruby-dev:48616] [Bug #10368]</p>

<p>* test/ruby/test_eval.rb: add a test code.</p>

<p>Fri Oct 17 13:22:17 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_here_document): do not append already appended 	  and
disposed code fragment.  [ruby-dev:48647] [Bug #10392]</p>

<p>Fri Oct 17 13:19:44 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_write): ASCII-8BIT StringIO 	  should be
writable any encoding strings, without conversion. 	  [ruby-core:65240]
[Bug #10285]</p>

<p>Fri Oct 17 13:10:08 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (eval_string_with_cref): fix super from eval with 	  scope. 
set klass in the current control frame to the class of 	  the receiver in
the context to be evaluated, this class/module 	  must match the actual
receiver to call super. 	  [ruby-core:65122] [Bug #10263]</p>

<p>Thu Oct 16 16:33:51 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* regcomp.c, regexec.c: Optimization should be disabled not only for 	 
/(?&lt;=x).*/ but also for /(?!x).*/. 	  (merge r47598 partially. [Bug
#9728])</p>

<p>Thu Oct 16 16:23:03 2014  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* lib/fileutils.rb: handle ENOENT error with symlink targeted to 	 
non-exists file. [ruby-dev:45933] [Bug #6716]</p>

<p>Wed Oct 15 16:23:22 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_time_tz.rb: Fix test error with tzdata-2014g. 	 
[ruby-core:65058] [Bug #10245] Reported by Vit Ondruch.</p>

<p>Wed Oct 15 16:23:22 2014  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* test/minitest/test_minitest_unit.rb: removed obsoleted condition 	  for
Ruby 1.8. 	* test/ruby/test_time_tz.rb: ditto.</p>

<p>Wed Oct 15 16:19:39 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* array.c (ary_recycle_hash): add RB_GC_GUARD 	  (rb_ary_diff): remove
volatile 	  [Bug #10369]</p>

<p>Wed Oct 15 16:13:28 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (dir_s_aref): fix rdoc.  `Dir.glob` allows an array but 	  `Dir[]`
not.  the former accepts an optional parameter `flags`, 	  while the latter
accepts arbitrary number of arguments but no 	  `flags`.  [ruby-core:65265]
[Bug #10294]</p>

<p>Wed Oct 15 16:12:11 2014  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* configure.in: Fix typo. [Bug #9914]</p>

<p>Wed Oct 15 16:05:47 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* error.c: update exception tree. [DOC] 	  reported by @hemge via twitter.</p>

<p>Wed Oct 15 15:57:48 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (VCSUP): nothing to do if this worktree is not 	 
under any VCS (it means that the worktree may be from the release 	 
package).</p>

<p>Wed Oct 15 15:35:39 2014  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* ext/pathname/pathname.c (path_inspect): use PRIsVALUE to preserve 	  the
result encoding.</p>

<p>Wed Sep 17 15:09:16 2014  Natalie Weizenbaum  &lt;nweiz@google.com&gt;</p>

<p>* ext/pathname/lib/pathname.rb (SAME_PATHS): 	 
Pathname#relative_path_from uses String#casecmp to compare strings 	  on
case-insensitive filesystem platforms (e.g., Windows). This can 	  return
nil for strings with different encodings, and the code 	  previously
assumed that it always returned a Fixnum.  [Fix GH-713]</p>

<p>Wed Sep 17 15:07:35 2014  Sho Hashimoto  &lt;sho.hsmt@gmail.com&gt;</p>

<p>* ext/fiddle/lib/fiddle/import.rb (Fiddle::Importer#sizeof): fix typo, 	 
SIZEOF_LONG_LON.  [Fix GH-714]</p>

<p>Wed Sep 17 14:58:50 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#pkg_config): append –cflags to also 	 
$CXXFLAGS, as they are often used by C++ compiler. 	  [ruby-core:54532]
[Bug #8315]</p>

<p>Wed Sep 17 14:58:50 2014  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* lib/mkmf.rb (configuration): Make CXXFLAGS customizable. 	  Patch by
Kohei Suzuki (eagletmt). [Fixes GH-492]</p>

<p>Wed Sep 17 14:52:38 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/csv.rb (CSV#&lt;&lt;): honor explicitly given encoding.  based on 	 
the patch by DAISUKE TANIWAKI &lt;daisuketaniwaki AT gmail.com&gt; at 	 
[ruby-core:62113].  [Bug #9766]</p>

<p>Fri Sep 12 11:34:39 2014  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_object.rb: extend timeout.</p>

<p>Fri Sep 12 11:34:39 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_obj_copy_ivar): allocate no memory for empty 	  instance
variables.  [ruby-core:64700] [Bug #10191]</p>

<p>Fri Sep 12 11:34:39 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_obj_copy_ivar): extract function to copy instance 	 
variables only for T_OBJECT from init_copy.</p>

<p>Fri Sep 12 11:30:50 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* regcomp.c: Merge Onigmo 988517a4f16f14acbd7cc9d5b51a096d5153992c. 	 
[Bug #9344].</p>

<p>Fri Sep 12 11:22:55 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (Doxyfile): revert r43888, not to require preinstalled 	 
ruby.  [ruby-core:64488] [Bug #10161]</p>

<p>Fri Sep 12 11:15:04 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_reopen): create a new, temporary FD via rb_sysopen and 	 
call rb_cloexec_dup2 on it to atomically replace the file fptr-&gt;fd 	 
points to.  This leaves no possible window where fptr-&gt;fd is invalid 	 
to userspace (even for any threads running w/o GVL).  based on the 	  patch
by Eric Wong &lt;normalperson@yhbt.net&gt; at [ruby-core:57943]. 	  [Bug
#9036]</p>

<p>Wed Sep 10 12:34:34 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_close): ignore only “closed stream” IOError and 	 
NoMethodError, do not swallow other exceptions at the end of 	  block. 
[ruby-core:64463] [Bug #10153]</p>

<p>Wed Sep 10 12:27:08 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/trans/euckr-tbl.rb (EUCKR_TO_UCS_TBL): add missing euro and 	 
registered signs.  [ruby-core:64452] [Bug #10149]</p>

<p>Wed Sep 10 12:25:24 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* time.c (time_timespec): fix tv_nsec overflow 	  [Bug #10144]</p>

<p>Wed Sep 10 12:21:51 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* ext/zlib/zlib.c (gzfile_reset): preserve ZSTREAM_FLAG_GZFILE 	  [Bug
#10101]</p>

<p>* test/zlib/test_zlib.rb (test_rewind): test each_byte</p>

<p>Wed Sep 10 12:06:27 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_initialize): [DOC] fix rdoc of append mode.  it does 	  not
move the pointer at open.  [ruby-core:63747] [Bug #10039]</p>

<p>Wed Sep 10 11:50:26 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (GETASTER): should not use the numbered argument to be 	 
formatted, raise ArgumentError instead. 	  [ruby-dev:48330] [Bug #9982]</p>

<p>Wed Sep 10 11:43:55 2014  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* test/openssl/test_pkey_rsa.rb (OpenSSL#test_sign_verify_memory_leak): 	 
added timeout into testcase for low performance environment. 	  [Bug #<a
href="ruby-core:63367">9984]</a></p>

<p>Wed Sep 10 11:39:54 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (env_aset, env_has_key, env_assoc, env_has_value), 	 
(env_rassoc, env_key): prohibit tainted strings if $SAFE is 	  non-zero. 
[Bug #9976]</p>

<p>Sat Sep  6 09:10:45 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/rdoc/generator/template/darkfish/js/jquery.js: Backport 	 
rdoc/rdoc@74f60fcb04fee1778fe2694d1a0ea6513f8e67b7</p>

<p>Fri Sep  5 14:08:00 2014  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* ext/win32ole/win32ole.c (ole_create_dcom): use the converted 	  result
if the argument can be converted to a string, to get rid 	  of invalid
access. Thanks to nobu. [ruby-dev:48467] [Bug #10127]</p>

<p>Fri Sep  5 14:00:33 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (open): use UTF-8 version function to support 	  non-ascii
path properly.  [ruby-core:63185] [Bug #9946]</p>

<p>Fri Sep  5 13:53:41 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_yylex): fix invalid char in eval, should raise 	  an
syntax error too, as well as directly coded. 	  [ruby-core:64243] [Bug
#10117]</p>

<p>Fri Sep  5 13:51:10 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_yyerror): preserve source code encoding in 	  syntax
error messages.  [ruby-core:64228] [Bug #10114]</p>

<p>Fri Sep  5 13:44:53 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_count): fix wrong single-byte optimization. 	  7bit
ascii can be a trailing byte in Shift_JIS. 	  [ruby-dev:48442] [Bug #10078]</p>

<p>Fri Sep  5 13:36:12 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>merge r46831 partially.  these changes are from: 	<a
href="https://github.com/k-takata/Onigmo/commit/7abd7b29481f98eb92be786e3d33611fc7d000a0">github.com/k-takata/Onigmo/commit/7abd7b29481f98eb92be786e3d33611fc7d000a0</a>
	[Bug #8716]</p>

<p>* include/ruby/oniguruma.h (ONIG_MAX_CAPTURE_GROUP_NUM, 	 
ONIGERR_TOO_MANY_CAPTURE_GROUPS): add cheking the number of capture 	 
groups.</p>

<p>* regerror.c (onig_error_code_to_format): ditto.</p>

<p>* regparse.c (scan_env_add_mem_entry): ditto.</p>

<p>* regexec.c (onig_region_copy, match_at): fix: segmation fault occurs 	 
when many groups are used.</p>

<p>Fri Sep  5 13:06:53 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_resize): update capa only when buffer get 	 
reallocated. 	  <a
href="http://d.hatena.ne.jp/nagachika/20140613/ruby_trunk_changes_46413_46420#r46413">d.hatena.ne.jp/nagachika/20140613/ruby_trunk_changes_46413_46420#r46413</a></p>

<p>Fri Sep  5 13:06:53 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_resize): should consider the capacity instead 	  of the
old length, as pointed out by nagachika.</p>

<p>Fri Sep  5 13:06:53 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (expand_path): shrink expanded path which no longer needs 	 
rooms to append.  [ruby-core:63114] [Bug #9934]</p>

<p>Wed Sep  3 13:42:24 2014  Mark Lorenz  &lt;mlorenz@covermymeds.com&gt;</p>

<p>* lib/erb.rb (result): [DOC] no longer accepts a Proc, as 	  Kernel.eval
does not.  [fix GH-619]</p>

<p>Wed Sep  3 13:23:29 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_io_autoclose_p): Don&#39;t raise on frozen IO.</p>

<p>* test/lib/minitest/unit.rb: IO#autoclose? may raise IOError.</p>

<p>Wed Sep  3 13:23:29 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_fileno, rb_io_inspect): non-modification does not 	  error
on frozen IO.  [ruby-dev:48241] [Bug #9865]</p>

<p>Wed Sep  3 13:17:38 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (posix_fadvise): disable use of posix_fadvise 	  itself on
32-bit AIX.  [ruby-core:62968] [Bug #9914]</p>

<p>Wed Sep  3 13:17:38 2014    &lt;kanemoto@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_advise): AIX currently does not support a 32-bit call to 	 
posix_fadvise() if _LARGE_FILES is defined. Patch by Rei Odaira. 	 
[ruby-core:62968] [Bug #9914]</p>

<p>Wed Sep  3 12:48:14 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_write): use rb_str_append to 	  reuse
coderange bits other than ASCII-8BIT, and keep 	  taintedness. 
[ruby-dev:48118] [Bug #9769]</p>

<p>Wed Sep  3 12:41:35 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (env_shift): fix memory leak on Windows, free environment 	 
strings block always.  [ruby-dev:48332] [Bug #9983]</p>

<p>Wed Sep  3 12:41:35 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (env_select): fix memory leak and crash on Windows, make 	  keys
array first instead of iterating on environ directly. 	  [ruby-dev:48325]
[Bug #9978]</p>

<p>Wed Sep  3 12:41:35 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (ruby_setenv): fix memory leak on Windows, free 	  environment
strings block after check for the size. 	  [ruby-dev:48323] [Bug #9977]</p>

<p>Wed Sep  3 12:24:39 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* re.c (match_aref, rb_reg_regsub): consider encoding of captured 	 
names, encoding-incompatible should not match. 	  [ruby-dev:48278] [Bug
#9903]</p>

<p>Wed Sep  3 12:24:39 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (ruby__sfvextra): add QUOTE flag to escape unprintable 	 
characters.</p>

<p>Wed Sep  3 12:24:39 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (ruby__sfvextra): add QUOTE flag to escape unprintable 	 
characters.</p>

<p>Sun Aug 31 16:59:45 2014  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_eval.c (rb_catch_protect): fix same problem of [Bug #9961].</p>

<p>* vm_eval.c (rb_iterate): ditto.</p>

<p>Sun Aug 31 16:59:45 2014  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (rb_vm_rewind_cfp): add new function to rewind specified cfp 	 
with invoking RUBY_EVENT_C_RETURN. 	  [Bug #9961]</p>

<p>* vm_core.h: ditto.</p>

<p>* eval.c (rb_protect): use it.</p>

<p>* eval.c (rb_rescue2): ditto.</p>

<p>* vm_eval.c (rb_iterate): ditto.</p>

<p>* test/ruby/test_settracefunc.rb: add a test.</p>

<p>* vm_core.h (rb_name_err_mesg_new):</p>

<p>Sun Aug 31 16:50:06 2014  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (rb_iseq_compile_node): put start label of block after 	 
trace (b_call). 	  [Bug #9964]</p>

<p>* test/ruby/test_settracefunc.rb: add a test.</p>

<p>added assert_consistent_call_return() method check call/return 	 
consistency.</p>

<p>Sun Aug 31 16:38:26 2014  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: add VM_FRAME_MAGIC_RESCUE to recognize normal block or 	 
rescue clause.</p>

<p>* vm.c (vm_exec): use VM_FRAME_MAGIC_RESCUE on at rescue/ensure.</p>

<p>* test/ruby/test_settracefunc.rb: should not invoke b_return at rescue 	 
clause. 	  [Bug #9957]</p>

<p>* vm_dump.c (control_frame_dump): check VM_FRAME_MAGIC_RESCUE.</p>

<p>* vm_dump.c (vm_stack_dump_each): ditto.</p>

<p>Sun Aug 31 16:32:10 2014  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* lib/test/unit/parallel.rb: fix test-all parallel failure if a test 	  is
skipped after raise. 	  DL::TestFunc#test_sinf is skipped after raise on
mingw ruby. 	  But it causes Marshal.load failure due to undefined
class/module 	  DL::DLError when doing test-all parallel and test-all
doesn&#39;t 	  complete. We create new MiniTest::Skip object to avoid
Marshal.load 	  failure. 	  [ruby-core:62133] [Bug #9767]</p>

<p>* test/testunit/test_parallel.rb (TestParallel): add a test.</p>

<p>* test/testunit/tests_for_parallel/ptest_forth.rb: ditto.</p>

<p>Sun Aug 31 16:24:54 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/pathname/lib/pathname.rb (cleanpath_aggressive): make all 	 
separators File::SEPARATOR from File::ALT_SEPARATOR. 	  Reported by Daniel
Rikowski. 	  Fixed by Nobuyoshi Nakada.  [Bug #9618]</p>

<p>* ext/pathname/lib/pathname.rb (cleanpath_conservative): ditto.</p>

<p>Sun Aug 31 16:23:41 2014  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* lib/fileutils.rb (rmdir): rescue Errno::EEXIST in addition to 	 
ENOTEMPTY (and ENOENT), because SUSv3 describes that “If the 	  directory
is not an empty directory, rmdir() shall fail and set 	  errno to [EEXIST]
or [ENOTEMPTY]” and Solaris uses EEXIST. 	  [Bug #9571] [ruby-dev:48017]</p>

<p>Sun Aug 31 16:20:14 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb (bind_random_port): Rescue EPERM for FreeBSD which 	 
security.mac.portacl.port_high is changed. 	  See mac_portacl(4) for
details. 	  Reported by Jakub Szafranski.  [ruby-core:60917] [Bug #9544]</p>

<p>Sun Aug 31 16:16:24 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* re.c (match_aref): should not ignore name after NUL byte. 	 
[ruby-dev:48275] [Bug #9902]</p>

<p>Sun Aug 31 16:10:30 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/digest/digest.c (rb_digest_instance_equal): no need to call 	 
`to_s` twice.  [Bug #9913]</p>

<p>Sun Aug 31 16:10:30 2014  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* ext/digest/digest.c (rb_digest_instance_equal): 	  fix #== for
non-string arguments. [ruby-core:62967] [Bug #9913]</p>

<p>* test/digest/test_digest.rb: add test for above.</p>

<p>Sun Aug 31 15:46:23 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (yield_indexed_values): extract from permute0(), 	  rpermute0(),
and rcombinate0().</p>

<p>Sun Aug 31 15:23:25 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_permutation): `p` is the array of size `r`, as 	 
commented at permute0().  since `n &gt;= r` here, buffer overflow 	  never
happened, just reduce unnecessary allocation though.</p>

<p>Mon Jul  7 13:05:04 2014  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* test/test_timeout.rb (test_timeout): inverted test condition. 	  [Bug
#8523]</p>

<p>Mon Jul  7 12:57:26 2014  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* st.c (st_foreach_check): change start point of search at check 	  from
top to current. [ruby-dev:48047] [Bug #9646]</p>

<p>Mon Jul  7 12:53:45 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/gserver.rb: [DOC] Fixed typo in example by @stomar [Bug #9543]</p>

<p>Mon Jul  7 12:52:44 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* enumerator.c: [DOC] Fix example to show Enumerator#peek behavior 	 
Patch by Erik Hollembeak [Bug #9814]</p>

<p>Mon Jul  7 12:51:09 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* enum.c: [DOC] Use #find in example to clarify alias by @rachellogie 	 
Patch submitted via documenting-ruby/ruby#34</p>

<p>Mon Jul  7 12:49:10 2014  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* man/ruby.1: remove deadlink. [ruby-core:62145][Bug #9773]</p>

<p>Mon Jul  7 12:46:28 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* struct.c (not_a_member): extract name error and use same error 	 
messages.  based on the patch by Marcus Stollsteimer &lt;sto.mar AT 	 
web.de&gt; at [ruby-core:61721].  [Bug #9684]</p>

<p>Mon Jul  7 12:39:34 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (read_all): truncate the buffer before appending read data, 	 
instead of truncating before reading. 	  [ruby-core:55951] [Bug #8625]</p>

<p>Mon Jul  7 12:39:34 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_setstrbuf, io_read): should not shorten the given buffer until
	  read succeeds.  [ruby-core:55951] [Bug #8625]</p>

<p>Mon Jul  7 12:16:54 2014  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (gets, readline): read lines without LF properly. 	 
[ruby-core:63205] [Bug #9949]</p>

<p>* test/net/ftp/test_buffered_socket.rb: related test.</p>

<p>Mon Jul  7 12:13:09 2014  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (body_type_1part): Gmail IMAP reports a body 	  type as
“MIXED” followed immediately by params 	  [ruby-core:62864] [Bug #9885] 	 
Patch by @rayners (David Raynes). [Fixes GH-622]  	  <a
href="https://github.com/ruby/ruby/pull/622">github.com/ruby/ruby/pull/622</a></p>

<p>Mon Jul  7 12:05:28 2014  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (body_type_msg): should accept 	 
message/delivery-status with extra data. 	  [ruby-core:53741] [Bug #8167]</p>

<p>* test/net/imap/test_imap_response_parser.rb: related test.</p>

<p>Mon Jul  7 11:47:51 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (local_tbl_gen): remove local variables duplicated with 	 
arguments.</p>

<p>Thu Jul  3 15:17:22 2014  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>[ruby-core:60501] [Bug #9486] 	* vm.c (rb_vm_pop_cfunc_frame): added. 
It cares c_return event. 	  The patch base by drkaes (Stefan Kaes). 	  [Bug
#9321]</p>

<p>* variable.c (rb_mod_const_missing): use rb_vm_pop_cfunc_frame() 	 
instead of rb_frame_pop().</p>

<p>* vm_eval.c (raise_method_missing): ditto.</p>

<p>* vm_eval.c (rb_iterate): ditto.</p>

<p>* internal.h (rb_vm_pop_cfunc_frame): add decl.</p>

<p>* test/ruby/test_settracefunc.rb: add tests. 	  provided by drkaes (Stefan
Kaes).</p>

<p>* vm.c, eval.c, include/ruby/intern.h (rb_frame_pop): 	  move definition
of rb_frame_pop() and deprecate it. 	  It doesn&#39;t care about
`return&#39; events.</p>

<p>Fri Jun 27 17:57:16 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_substr): need to reset code range for shared 	  string
too, not only copied string. 	  [ruby-core:62842] [Bug #9882]</p>

<p>Fri Jun 27 17:54:09 2014  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* signal.c (ruby_signal): should return either `old.sa_sigaction` 	  or
`old.sa_handler`, depending on whether `SA_SIGINFO` is set in 	 
`old.sa_flags`, because they may not be a union. 	  [ruby-core:62836] [Bug
#9878]</p>

<p>Fri Jun 27 17:37:12 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vsnprintf.c (BSD_vfprintf): fix string width when precision is 	  given.
as the result of `memchr` is NULL or its offset from the 	  start cannot
exceed the size, the comparison was always false. 	  [ruby-core:62737] [Bug
#9861]</p>

<p>Fri Jun 27 17:27:26 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* process.c (proc_getgroups, proc_setgroups): use ALLOCV_N 	  [Bug #9856]</p>

<p>Fri Jun 27 17:19:22 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_setstrbuf): always check if the buffer is modifiable. 	 
[ruby-core:62643] [Bug #9847]</p>

<p>Fri Jun 27 17:15:36 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SSLServer#accept): 	 
Consider Socket#accept as well as TCPServer#accept. 	  Reported by Sam
Stelfox.  [ruby-core:62064] [Bug #9750]</p>

<p>Fri Jun 27 17:12:45 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* complex.c (parse_comp): replace ALLOCA_N with ALLOCV_N/ALLOCV_END 	 
[Bug #9608] 	* rational.c (read_digits): ditto</p>

<p>Fri Jun 27 17:05:23 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/net/ftp.rb (transfercmd): Close TCP server socket even if an 	 
exception occur.</p>

<p>Fri Jun 27 17:02:36 2014  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* thread_win32.c (rb_w32_stack_overflow_handler): use Structured 	 
Exception Handling by AddVectoredExceptionHandler() for machine 	  stack
overflow on mingw. 	  This would be equivalent to the handling using __try
and __except 	  on mswin introduced by r43748.</p>

<p>Fri Jun 27 17:02:36 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* eval_intern.h (SAVE_ROOT_JMPBUF): workaround for the failure of 	 
test/ruby/test_exception.rb on Windows. 	  wrap by __try and __exception
statements on mswin to raise SIGSEGV 	  when EXCEPTION_STACK_OVERFLOW is
occurred, because MSVCRT doesn&#39;t 	  handle the exception. 	  however,
(1) mingw-gcc doesn&#39;t support __try and __exception 	  statements, and
(2) we cannot retry SystemStackError after this 	  change yet (maybe
crashed) because SEH and longjmp() are too 	  uncongenial.</p>

<p>* signal.c (check_stack_overflow, CHECK_STACK_OVERFLOW): now defined on 	 
Windows, too.</p>

<p>* thread_win32.c (ruby_stack_overflowed_p): ditto.</p>

<p>Fri Jun 27 16:56:38 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* signal.c (signal_exec): ignore immediate cmd for SIG_IGN 	* signal.c
(trap_handler): set cmd to true for SIG_IGN 	* signal.c (trap): handle nil
and true values for oldcmd 	  [Bug #9835]</p>

<p>Mon Jun 23 18:51:43 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_mod_init_copy): always clear instance variable, 	  constant
and method tables first, regardless the source tables. 	  [ruby-dev:48182]
[Bug #9813]</p>

<p>Mon Jun 23 18:50:13 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (thread_start_func_2): stop if forked in a sub-thread, 	  the
thread has become the main thread. 	  [ruby-core:62070] [Bug #9751]</p>

<p>Mon Jun 23 18:35:34 2014  Josh Goebel  &lt;dreamer3@gmail.com&gt;</p>

<p>* net/protocol.rb (using_each_crlf_line): fix SMTP dot-stuffing 	  for
messages not ending with a new-line. 	  [ruby-core:61441] [Bug #9627] [fix
GH-616]</p>

<p>Mon Jun 23 18:16:07 2014  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* configure.in: enable SSE2 on mingw. target=&#39;i386-pc-mingw32&#39;. 	 
[ruby-core:62095] [Bug #8358]</p>

<p>Mon Jun 23 18:16:07 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: Fix compilation error. 	  <a
href="https://bugs.ruby-lang.org/issues/8358#note-16">bugs.ruby-lang.org/issues/8358#note-16</a></p>

<p>Mon Jun 23 18:16:07 2014  Vit Ondruch  &lt;vondruch@redhat.com&gt;</p>

<p>* configure.in: add qouting brackets and append wildcard for the 	  rest
after target_cpu, to properly detect platform for SSE2 	  instructions. 
[ruby-core:60576] [Bug #8358]</p>

<p>Mon Jun 23 18:16:07 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: use SSE2 instructions to drop unexpected precisions on 	 
other than mingw.  [ruby-core:59472] [Bug #8358]</p>

<p>Mon Jun 23 18:16:07 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: use SSE2 instructions for drop unexpected 	  precisions. 
[ruby-core:54738] [Bug #8358]</p>

<p>Mon Jun 23 17:29:53 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (obj2uid, obj2gid): now getpwnam_r() and getgrnam_r() 	  may
need larger buffers than sysconf values, so retry with 	  expanding the
buffer when ERANGE is returned. 	  [ruby-core:61325] [Bug #9600]</p>

<p>Mon Jun 23 17:20:10 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/socket.c (sock_s_getnameinfo): Save errno for EAI_SYSTEM. 	 
Reported by Saravana kumar.  [ruby-core:61820] [Bug #9697] 	  Fixed by
Heesob Park.  [ruby-core:61868]</p>

<p>Mon Jun 23 17:20:10 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/ipsocket.c (ip_s_getaddress): Don&#39;t access freed memory.</p>

<p>Mon Jun 23 17:20:10 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket: always operate length of socket addess companion with 	 
socket address.</p>

<p>* ext/socket/rubysocket.h (rsock_make_ipaddr): add an argument for 	 
socket address length. 	  (rsock_ipaddr): ditto.</p>

<p>* ext/socket/ipsocket.c (ip_addr): pass length to rsock_ipaddr. 	 
(ip_peeraddr): ditto. 	  (ip_s_getaddress): pass length to
rsock_make_ipaddr.</p>

<p>* ext/socket/socket.c (make_addrinfo): pass length to rsock_ipaddr. 	 
(sock_s_getnameinfo): pass actual address length to rb_getnameinfo. 	 
(sock_s_unpack_sockaddr_in): pass length to rsock_make_ipaddr.</p>

<p>* ext/socket/init.c (rsock_s_recvfrom): pass length to rsock_ipaddr. 	 
(rsock_s_recvfrom_nonblock): ditto.</p>

<p>* ext/socket/tcpsocket.c (tcp_sockaddr): pass length to 	 
rsock_make_ipaddr.</p>

<p>* ext/socket/raddrinfo.c (make_ipaddr0): add an argument for socket 	 
address length.  pass the length to rb_getnameinfo. 	  (rsock_ipaddr):
ditto. 	  (rsock_make_ipaddr): add an argument for socket address length. 
	  pass the length to make_ipaddr0. 	  (make_inetaddr): pass length to
make_ipaddr0. 	  a local variable renamed. 	  (host_str): a local variable
renamed. 	  (port_str): ditto.</p>

<p>Mon Jun 23 16:55:13 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (primary): flush cmdarg flags inside left-paren in a 	  command
argument, to allow parenthesed do-block as an argument 	  without arguments
parentheses.  [ruby-core:61950] [Bug #9726]</p>

<p>Mon Jun 23 16:45:48 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dl/cptr.c (dlptr_free), ext/dl/handle.c (dlhandle_free), 	 
ext/fiddle/handle.c (fiddle_handle_free), 	  ext/fiddle/pointer.c
(fiddle_ptr_free): fix memory leak. 	  based on the patch Heesob Park at
[ruby-dev:48021] [Bug #9599].</p>

<p>Wed May 28 13:24:39 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (rb_cv_func___builtin_unreachable): try with an 	  external
variable not only by a warning, which might not be 	  shown due to the
optimization.  [ruby-core:61647] [Bug #9665]</p>

<p>Wed May 28 13:20:32 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_asn1.c (ossl_asn1_initialize): SYMID on a value 	 
other than Symbol is an undefined behavior.  fix up r31699. 	 
[ruby-core:62142] [Bug #9771]</p>

<p>Wed May 28 13:18:21 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_putc): fix for non-ascii 	  encoding,
like as IO#putc.  [ruby-dev:48114] [Bug #9765]</p>

<p>Tue May 27 13:57:41 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/fileutils.rb (FileUtils#copy_entry): update rdoc about 	  preserve
option and permissions, following r31123. 	  [ruby-core:62065] [Bug #9748]</p>

<p>Tue May 27 13:42:36 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (umethod_bind): use the ancestor iclass instead of new 	  iclass
to get rid of infinite recursion, if the defined module 	  is already
included.  [ruby-core:62014] [Bug #9721]</p>

<p>Tue May 27 13:42:36 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (rb_method_call_with_block, umethod_bind): call with 	  IClass
including the module for a module instance method. 	  [ruby-core:61936]
[Bug #9721]</p>

<p>* vm_insnhelper.c (vm_search_super_method): allow bound 	  UnboundMethod
case.</p>

<p>Tue May 27 11:51:00 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (ary_reject): may be turned into a shared array during 	  the
given block.  [ruby-dev:48101] [Bug #9727]</p>

<p>Tue May 27 11:48:22 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (str_buf_cat): should round up the capacity by 4KiB, 	  but not
number of rooms.  [ruby-core:61886] [Bug #9709]</p>

<p>Tue May 27 11:46:03 2014  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/xmlrpc/client.rb (do_rpc): don&#39;t check body length. 	  If HTTP
content-encoding is used, the length may be different. 	  [Bug #8182]
[ruby-core:53811]</p>

<p>Tue May 27 11:23:02 2014  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c (d_lite_cmp): should compare with #&lt;.</p>

<p>Mon May  5 00:42:35 2014  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* ext/psych/yaml/config.h: ditto.</p>

<p>* ext/psych/yaml/scanner.c: ditto.</p>

<p>* ext/psych/yaml/yaml_private.h: ditto.</p>

<p>Thu May  8 02:01:51 2014  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_initialize): Insert GC guard.</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_global_new): ditto.</p>

<p>Thu May  8 01:51:19 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_pkey.c (ossl_pkey_verify): as EVP_VerifyFinal() 	 
finalizes only a copy of the digest context, the context must be 	  cleaned
up after initialization by EVP_MD_CTX_cleanup() or a 	  memory leak will
occur.  [ruby-core:62038] [Bug #9743]</p>

<p>Wed Apr 30 16:39:43 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/readline/extconf.rb (rl_hook_func_t): check pointer type. 	 
[ruby-dev:48089] [Bug #9702]</p>

<p>Wed Apr 30 16:37:16 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_accept, open_ifs_socket, socketpair_internal): 	 
reset inherit flag of socket to avoid unintentional inheritance of 	 
socket.  note that the return value of SetHandleInformation() is not 	 
verified intentionally because old Windows may return an error. 	  [Bug
#9688] [ruby-core:61754]</p>

<p>Wed Apr 30 16:33:57 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* time.c (time_mload): freeze and preserve marshal-loaded time zone 	*
test/ruby/test_time.rb: add test for GC on loaded object 	  [Bug #9652]</p>

<p>Wed Apr 30 16:15:09 2014  Kohei Suzuki  &lt;eagletmt@gmail.com&gt;</p>

<p>* vm_method.c (rb_method_entry_get_without_cache): me-&gt;klass is 0 	 
for a method aliased in a module.  [ruby-core:61636] [Bug #9663]</p>

<p>Wed Apr 30 16:15:09 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_method_entry_get_without_cache): get rid of 	  infinite
recursion at aliases in a subclass and a superclass. 	  return actually
defined class for other than singleton class. 	  [ruby-core:60431] [Bug
#9475]</p>

<p>Wed Apr 30 16:09:18 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_callee_setup_arg): turn a macro into an 	  inline
function.</p>

<p>Wed Apr 30 15:04:25 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/readline/extconf.rb: fix typo, `$defs` not `$DEFS`. 	 
[ruby-core:61756] [Bug #9578]</p>

<p>Mon Mar 31 00:57:39 2014  James Edward Gray II 
&lt;james@graysoftinc.com&gt;</p>

<p>* lib/csv.rb: Fixed a broken regular expression that was causing 	  CSV to
miss escaping some special meaning characters when used 	  in parsing. 	 
Reported by David Unric 	  [ruby-core:54986] [Bug #8405]</p>

<p>Mon Mar 31 00:48:12 2014  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_no_memory_leak): increase default value 	 
of `limit` keyword argument. 	  assert_no_memory_leak occasionally fails
with limit=1.5.</p>

<p>Mon Mar 31 00:15:45 2014  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* vm_eval.c (eval_string_with_cref): Unify to use NIL_P.</p>

<p>Mon Mar 31 00:15:45 2014  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* vm_eval.c (eval_string_with_cref): Use file path even if scope is 	 
given. Related to [ruby-core:56099] [Bug #8662] and r42103.</p>

<p>Mon Mar 31 00:02:04 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (yycompile): store file name as String to keep the encoding.</p>

<p>* parse.y (rb_parser_compile_string_path, rb_parser_compile_file_path): 	 
new functions to pass file name as a String.</p>

<p>* parse.y (gettable_gen): return a copy of the original file name, not 	 
a copy in filesystem encoding.</p>

<p>* vm_eval.c (eval_string_with_cref): use Qundef instead of “(eval)”.</p>

<p>Sun Mar 30 23:49:21 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl.c (ossl_make_error): check NULL for unknown 	  error
reasons with old OpenSSL, and insert a colon iff formatted 	  message is
not empty.</p>

<p>Thu Mar 20 21:13:18 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* variable.c (rb_const_set): delete existing entry on redefinition 	  [Bug
#9645] 	* test/ruby/test_const.rb (test_redefinition): test for leak</p>

<p>Thu Mar 20 20:44:17 2014  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* test/fiddle/test_c_struct_entry.rb, 	 
test/fiddle/test_c_union_entity.rb, 	  test/fiddle/test_cparser.rb,
test/fiddle/test_func.rb, 	  test/fiddle/test_handle.rb,
test/fiddle/test_import.rb, 	  test/fiddle/test_pointer.rb: don&#39;t run
test if the system 	  don&#39;t support fiddle.</p>

<p>Sun Mar 16 00:57:20 2014  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* ext/.document: remove refinement from documentable directories.</p>

<p>Mon Mar  3 01:43:30 2014  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* eval_error.c (warn_printf): use rb_vsprintf instead so ruby specific 	 
extensions like PRIsVALUE can be used in format strings 	* eval_error.c
(error_print): use warn_print_str (alias for 	  rb_write_error_str) to
print a string value instead of using 	  RSTRING_PTR and RSTRING_LEN
manually 	* eval.c (setup_exception): use PRIsVALUE instead of %s and
RSTRING_PTR</p>

<p>Mon Mar  3 01:32:14 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/readline/extconf.rb (rl_hook_func_t): define as Function for 	  very
old readline versions.  [ruby-core:61209] [Bug #9578]</p>

<p>Mon Mar  3 01:32:14 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/readline/readline.c (Init_readline): Use rl_hook_func_t instead 	 
of Function to support readline-6.3.  (rl_hook_func_t is available 	  since
readline-4.2.) 	  Reported by Dmitry Medvinsky.  [ruby-core:61141] [Bug
#9578]</p>

<p>Mon Mar  3 01:25:28 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (setup_exception): preserve errinfo across calling #to_s 	 
method on the exception.  [ruby-core:61091] [Bug #9568]</p>

<p>Mon Mar  3 01:00:00 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (ruby_num_interval_step_size): check signs and get rid 	  of
implementation dependent behavior of negative division. 	 
[ruby-core:61106] [Bug #9570]</p>

<p>Mon Mar  3 00:43:33 2014  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>(merged partially from r42781) 	* test/ruby/test_numeric.rb (assert_step):
introduce assert_step.</p>

<p>Mon Mar  3 00:24:38 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* README.EXT.ja: [DOC] Fix typo “macro macro” @utenmiki [Fixes GH-551] 	 
<a
href="https://github.com/ruby/ruby/pull/551">github.com/ruby/ruby/pull/551</a></p>

<p>Sat Feb 22 22:11:58 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (console_dev): need read access for conout$ 	 
because some functions need it.  [Bug#9554]</p>

<p>Sat Feb 22 14:01:42 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (iseq_load): keep type_map to get rid of memory leak. 	  based on
a patch by Eric Wong at [ruby-core:59699].  [Bug #9399]</p>

<p>Sat Feb 22 13:56:38 2014  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_build_from_ary_body): Use :blockptr instead of :block 	 
as hash key when loading serialized instruction sequences from arrays. 	 
[Bug #9455] [ruby-core:60146]</p>

<p>Sat Feb 22 13:04:54 2014  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/socket/init.c (wait_connectable): break if the socket is 	  writable
to avoid infinite loops on FreeBSD and other platforms 	  which conforms to
SUSv3.  This problem cannot be reproduced with 	  loopback interfaces, so
it&#39;s hard to write test code. 	  rsock_connect() and wait_connectable()
are overly complicated, so 	  they should be refactored, but I commit this
fix as a workaround 	  for the release of Ruby 1.9.3 scheduled on Feb 24. 	
[ruby-core:60940] [Bug #9547]</p>

<p>Sat Feb 22 12:55:24 2014  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>(merged partially from r42927) 	* lib/rubygems/core_ext/kernel_require.rb:
Backport a fix for concurrent 	  requires. [ruby-core:58918] [Backport
#9224] 	  see also <a
href="https://github.com/rubygems/rubygems/pull/833">github.com/rubygems/rubygems/pull/833</a></p>

<p>Sat Feb 22 11:50:52 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* ext/socket/ancdata.c (bsock_sendmsg_internal): only retry on error 	 
(bsock_recvmsg_internal): ditto 	* test/socket/test_unix.rb: test above for
infinite loop</p>

<p>Sat Feb 22 11:44:50 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_mod_init_copy): do nothing if copying self. 	 
[ruby-dev:47989] [Bug #9535]</p>

<p>* hash.c (rb_hash_initialize_copy): ditto.</p>

<p>Thu Feb 20 02:14:18 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* ext/openssl/lib/openssl/buffering.rb: Fix warning in copyright</p>

<p>Thu Feb 20 02:14:18 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* ext/openssl/lib/openssl/buffering.rb: [DOC] Fix HEREDOC comment for 	 
OpenSSL::Buffering which breaks overview because of RDoc bug</p>

<p>Thu Feb 20 02:04:09 2014  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/.document:  Add syslog/lib to documentable items. [Bug #9228]</p>

<p>Thu Feb 20 01:54:08 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_search_super_method): when super called in a 	 
bound UnboundMethod generated from a module, no superclass is 	  found
since the current defined class is the module, then call 	  method_missing
in that case.  [ruby-core:59619] [Bug #9377]</p>

<p>Thu Feb 20 01:33:06 2014  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/optparse.rb:  The Integer acceptable now allows binary and 	 
hexadecimal numbers per the documentation.  [ruby-trunk - Bug #8865]</p>

<p>DecimalInteger, OctalInteger, DecimalNumeric now validate their input 	 
before converting to a number.  [ruby-trunk - Bug #8865]</p>

<p>* test/optparse/test_acceptable.rb:  Tests for the above, tests for all 	 
numeric acceptables for existing behavior.</p>

<p>Thu Feb 20 01:23:36 2014  Aaron Pfeifer  &lt;aaron.pfeifer@gmail.com&gt;</p>

<p>* thread.c (terminate_atfork_i): fix locking mutexes not unlocked in 	 
forks when not tracked in thread.  [ruby-core:55102] [Bug #8433]</p>

<p>Tue Feb 18 23:48:03 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_separately): require envutil in the 	 
child process too.</p>

<p>Tue Feb 18 22:38:01 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_separately): 	 
specify the encoding of source.</p>

<p>Mon Feb 17 02:00:36 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/open-uri.rb: Make proxy disabling working again. 	  Fixed by
Christophe Philemotte.   [ruby-core:59650] [Bug #9385]</p>

<p>Mon Feb 17 01:57:45 2014  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* range.c (Range#size): [DOC] improve description and add examples. 	 
Patch by @skade. [Fixes GH-501]</p>

<p>Mon Feb 17 01:51:49 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/webrick/htmlutils.rb (WEBrick::HTMLUtils#escape): replace HTML 	 
meta chars even in non-ascii string.  [Bug #8425] [ruby-core:55052]</p>

<p>* lib/webrick/httputils.rb (WEBrick::HTTPUtils#<code>_escape,_unescape</code>): 	 
fix %-escape encodings.  [Bug #8425] [ruby-core:55052]</p>

<p>Mon Feb 17 01:51:49 2014  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/webrick/test_htmlutils.rb: add test for WEBrick::HTMLUtils.</p>

<p>Mon Feb 17 01:41:59 2014  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* array.c (rb_hash_rehash): use hash_alloc() instead of rb_hash_new(). 	 
[Bug #9187]</p>

<p>Mon Feb 17 01:41:59 2014  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* hash.c (rb_hash_rehash): make temporary st_table under the control 	  of
GC. [Bug #9187]</p>

<p>* test/ruby/test_hash.rb: add a test for above.</p>

<p>Mon Feb 17 01:41:59 2014  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* hash.c (rb_hash_rehash): fix to free new st_table when exception 	  is
raised in do_hash(). [Bug #9187]</p>

<p>Mon Feb 17 01:18:04 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_s_constants): return its own constants for other 	  than
Module itself.  [ruby-core:59763] [Bug #9413]</p>

<p>Mon Feb 17 01:16:00 2014  Eric Wong &lt;e@80x24.org&gt;</p>

<p>* ext/json/generator/depend: add build dependencies for json extension 	 
[Bug #9374] [ruby-core:59609] 	* ext/json/parser/depend: ditto</p>

<p>Mon Feb 17 01:12:57 2014  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* ext/fiddle/closure.c: use sizeof(*pcl) for correct sizeof value. 	 
[ruby-core:57599] [Bug #8978].</p>

<p>Mon Feb 17 01:12:57 2014  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/fiddle/closure.c: use sizeof(*pcl) for correct sizeof value. 	 
[ruby-core:57599] [Bug #8978].  Thanks mame!</p>

<p>Mon Feb 17 01:09:52 2014  Eric Wong &lt;e@80x24.org&gt;</p>

<p>* benchmark/driver: avoid large alloc in driver process 	 
[ruby-core:59869] [Bug #9430]</p>

<p>Mon Feb 17 00:59:40 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): fix for platforms 	 
where PTHREAD_STACK_MIN is a dynamic value and not a compile-time 	 
constant.  [ruby-dev:47911] [Bug #9436]</p>

<p>Mon Feb 17 00:59:40 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): expand timer 	  thread
stack size to get rid of segfault on FreeBSD/powerpc64. 	  based on the
patch by Steve Wills at [ruby-core:59923]. 	  [ruby-core:56590] [Bug #8783]</p>

<p>Mon Feb 17 00:45:44 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_modify_expand): enable capacity and disable 	 
association with packed objects when setting capa, so that 	  pack(“p”)
string fails to unpack properly after modified.</p>

<p>Sun Feb 16 01:36:57 2014  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/yaml/emitter.c: merge libyaml 0.1.5 	*
ext/psych/yaml/loader.c: ditto 	* ext/psych/yaml/parser.c: ditto 	*
ext/psych/yaml/reader.c: ditto 	* ext/psych/yaml/scanner.c: ditto 	*
ext/psych/yaml/writer.c: ditto 	* ext/psych/yaml/yaml_private.h: ditto</p>

<p>Sun Feb 16 01:02:32 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/racc/rdoc/grammar.en.rdoc: [DOC] Correct grammar and typos 	  Patch
by Giorgos Tsiftsis [Bug #9429] [ci skip]</p>

<p>Sun Feb 16 01:00:45 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/open-uri.rb: [DOC] use lower case version of core classes, same 	 
as commit r44878, based on patch by Jonathan Jackson [Bug #9483]</p>

<p>Sun Feb 16 01:00:45 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* ext/ripper/lib/ripper/lexer.rb: [DOC] use lower case version of core 	 
classes when referring to return value, since we aren&#39;t directly 	 
talking about the class. Patch by Jonathan Jackson [Bug #9483]</p>

<p>Sun Feb 16 00:57:13 2014  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* variable.c: [DOC] adding extra example in docs. 	  patched by Steve
Klabnik. [Bug #9210]</p>

<p>Sun Feb 16 00:54:50 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb (Resolv::DNS::Resource::TXT#data): Return concatenated 	 
string. 	  Patch by Ryan Brunner.  [ruby-core:58220] [Bug #9093]</p>

<p>Sun Feb 16 00:50:59 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* ext/openssl/ossl_pkey_dh.c: Fixed typo by Sandor Szuecs [Bug #9243]</p>

<p>Sun Feb 16 00:47:36 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/xmlrpc/client.rb: [DOC] Remove note about SSL package on RAA 	 
Since RAA has been deprecated, and the SSL package has been replaced 	 
with net/https this statement is entirely false and should be 	  deleted.
[Bug #9152]</p>

<p>Sun Feb 16 00:44:51 2014  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/net/smtp.rb: [DOC] Remove dead link to RAA by Giorgos Tsiftsis 	 
Fixes the following bugs: [Bug #9152] [Bug #9268] [Bug #9394] 	*
lib/open-uri.rb: ditto</p>

<p>Sun Feb 16 00:27:04 2014  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* hash.c (rb_hash_assoc): revert r42224. table-&gt;type-&gt;compare is 	 
called only if hashes are matched.</p>

<p>* test/ruby/test_hash.rb: add a test to check using #== to compare.</p>

<p>Sun Feb 16 00:27:04 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_hash_initialize_copy): copy st_table type even if empty. 	 
[ruby-core:56256] [Bug #8703]</p>

<p>Sun Feb 16 00:27:04 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_hash_initialize_copy): clear old table before copy new 	 
table.</p>

<p>Sun Feb 16 00:27:04 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_hash_assoc): aggregate object can be initialized only 	  with
link time constants.</p>

<p>Sun Feb 16 00:27:04 2014  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* hash.c (rb_hash_assoc): performance improvement by replacing 	  compare
function in RHASH(hash)-&gt;ntbl-&gt;type temporarily.</p>

<p>Sun Feb 16 00:01:16 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb: Ignore name servers which cause EAFNOSUPPORT on 	  socket
creation. 	  Reported by Bjoern Rennhak.  [ruby-core:60442] [Bug #9477]</p>

<p>Sat Feb 15 23:58:31 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb (Resolv::DNS::Message::MessageDecoder): Raise 	 
DecodeError if no data before the limit. 	  Reported by Will Bryant. 
[ruby-core:60557] [Bug #9498]</p>

<p>Sat Feb 15 23:46:31 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (IDSET_ATTRSET_FOR_INTERN): fix off-by-one bug.</p>

<p>* parse.y (rb_enc_symname_type): junk ID succeeded by &#39;=&#39; is also
	  attrset ID.  [ruby-core:60668] [Bug #8756]</p>

<p>Sat Feb 15 23:42:04 2014  Richo Healy  &lt;richo@psych0tik.net&gt;</p>

<p>* test/ruby/test_struct.rb: Add regression test for question marks and 	 
bangs in struct members. [Closes GH-468]</p>

<p>Sat Feb 15 23:26:31 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* struct.c (new_struct): fix warning message, class name and encoding.</p>

<p>Sat Feb 15 16:08:26 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* struct.c (make_struct): avoid inadvertent symbol creation. 	 
(rb_struct_aref): ditto. 	  (rb_struct_aset): ditto.</p>

<p>Sat Feb 15 15:32:46 2014  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): should check ci-&gt;me-&gt;flag of 	 
a refining method in case the method is private. 	  [ruby-core:60111] [Bug
#9452]</p>

<p>* vm_method.c (make_method_entry_refined): set me-&gt;flag of a refined 	 
method entry to NOEX_PUBLIC in case the original method is private 	  and
it is refined as a public method.  The original flag is stored 	  in
me-&gt;def-&gt;body.orig_me, so it&#39;s OK to make a refined method 	 
entry public.  [ruby-core:60111] [Bug #9452]</p>

<p>* test/ruby/test_refinement.rb: related tests.</p>

<p>Tue Feb 11 23:21:02 2014  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* test/ruby/test_struct.rb (test_struct_question_mark): add a testcase 	 
for Struct attribute with question mark. the patch was originally 	 
written by Eric Wong [ruby-core:59095] [Backport #9248]</p>

<p>Tue Feb 11 23:21:02 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_id_attrset, intern_str): allow junk attrset ID for 	 
Struct.</p>

<p>* parse.y (rb_id_attrset): fix inconsistency with literals, allow 	 
ID_ATTRSET and return it itself, but ID_JUNK cannot make ID_ATTRSET. 	  and
raise a NameError instead of rb_bug() for invalid argument.</p>

<p>Tue Feb 11 23:21:02 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_enc_symname_type): allow ID_ATTRSET for ID_INSTANCE, 	 
ID_GLOBAL, ID_CLASS, ID_JUNK too.  [Bug #8756]</p>

<p>Tue Feb 11 23:21:02 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_id_attrset): allow other than ID_ATTRSET.</p>

<p>* parse.y (intern_str): ditto.  try stem ID for ID_INSTANCE, 	  ID_GLOBAL,
ID_CLASS, ID_JUNK too.  [Bug #8756]</p>

<p>Tue Feb 11 23:21:02 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_id_attrset): check if the argument is valid type as an 	 
attribute.</p>

<p>Tue Feb 11 00:26:19 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (GetLastError): already defined in windows.h on nowadays 	 
cygwin, and caused the confliction with the system provided 	  definition
on cygwin64.  by @kou1okada [Fixes GH-433].</p>

<p>Mon Feb 10 01:15:10 2014  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* ext/socket/raddrinfo.c (nogvl_getaddrinfo): Fix indent.</p>

<p>Mon Feb 10 01:15:10 2014  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* ext/socket/raddrinfo.c (nogvl_getaddrinfo): Add missing return 	  value
assignment.</p>

<p>Mon Feb 10 01:15:10 2014  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/socket/raddrinfo.c (nogvl_getaddrinfo): work around for Ubuntu 	 
13.04&#39;s getaddrinfo issue with mdns4. [ruby-list:49420]</p>

<p>Mon Feb 10 00:42:12 2014  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* ext/thread/thread.c (rb_szqueue_clear): notify SZQUEUE_WAITERS 	  on
SizedQueue#clear. [ruby-core:59462] [Bug #9342]</p>

<p>* test/thread/test_queue.rb: add test. the patch is from 	  Justin
Collins.</p>

<p>Mon Feb 10 00:27:33 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (local_push_gen, local_pop_gen): save cmdarg_stack to 	  isolate
command argument state from outer scope. 	  [ruby-core:59342] [Bug #9308]</p>

<p>Mon Feb 10 00:02:18 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (glob_helper): don&#39;t skip current directories if FNM_DOTMATCH
	  is given.  [ruby-core:53108] [Bug #8006]</p>

<p>Wed Feb  5 23:39:36 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (intern_str): sigil only names are junk, at least one 	 
identifier character is needed.  [ruby-dev:47723] [Bug #8928]</p>

<p>* parse.y (rb_enc_symname_type): fix out of bound access.</p>

<p>Wed Feb  5 22:54:52 2014  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* time.c (get_timeval, get_new_timeval): use rb_obj_class() 	  instead of
CLASS_OF() because CLASS_OF() may return 	  a singleton class.</p>

<p>Sun Feb 2 05:48:42 2014  Eric Wong &lt;e@80x24.org&gt;</p>

<p>* io.c (rb_io_syswrite): add RB_GC_GUARD 	  [Bug #<a
href="ruby-core:60407">9472]</a></p>

<p>Fri Jan 31 00:51:50 2014  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* configure.in: use $@ instead of $(.TARGET) because .TARGET is not 	 
supported by GNU make.</p>

<p>Fri Jan 31 00:49:41 2014  Yamashita Yuu  &lt;yamashita@geishatokyo.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c (Init_ossl_ssl): Declare a constant 	 
`OP_MSIE_SSLV2_RSA_PADDING` only if the macro is defined.  The 	 
`SSL_OP_MSIE_SSLV2_RSA_PADDING` has been removed from latest 	  snapshot of
OpenSSL 1.0.1.  [Fixes GH-488]</p>

<p>Thu Jan 23 21:08:16 2014  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* vm_insnhelper.c (check_match): Fix SEGV with VM_CHECKMATCH_TYPE_CASE 	 
and class of `pattern` has `method_missing` 	  [Bug #8882]
[ruby-core:58606]</p>

<p>Mon Jan 20 01:02:18 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (CLASS_NAME): macro to wrap 	  depending on
PRIsVALUE for 1.9.  [Backport #9406]</p>

<p>* ext/bigdecimal/bigdecimal.c (DECIMAL_SIZE_OF_BITS): fallback 	 
definition for 2.1 or older.  [ruby-core:59750] [Backport #9406]</p>

<p>Sun Jan 12 22:46:49 2014  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>patch inspired from r44260 on trunk. [ruby-core:58652] [Bug #9168]</p>

<p>* gc.c (run_finalizer): clear th-&gt;errinfo before invoke finalizer and 	
restore afterward.</p>

<p>* test/ruby/test_gc.rb (test_exception_in_finalizer): add test for 	 
above.</p>

<p>* vm_trace.c (rb_threadptr_exec_event_hooks_orig): clear th-&gt;errinfo 	 
before invoke hook.</p>

<p>Sun Jan 12 16:07:52 2014  vo.x (Vit Ondruch)  &lt;vondruch@redhat.com&gt;</p>

<p>* tool/rbinstall.rb (Gem::Specification#collect): make stable 	 
Gem::Specification.files in default .gemspecs the different order of 	 
“files” in .gemspec files makes them different therefore possibly 	 
conflicting in multilib scenario.  patch by vo.x (Vit Ondruch) at 	 
[ruby-core:57544] [Bug #8623].</p>

<p>Sun Jan 12 16:01:54 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/openssl/test_cipher.rb (test_aes_gcm_wrong_tag): Don&#39;t use 	 
String#succ because it can make modified (wrong) auth_tag longer 	  than 16
bytes.  The longer auth_tag makes that 	  EVP_CIPHER_CTX_ctrl (and
internally aes_gcm_ctrl) fail. 	  [ruby-core:55143] [Bug #8439] reported by
Vit Ondruch.</p>

<p>Sun Jan 12 15:33:11 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (ruby_qsort): fix potential stack overflow on a large 	  machine.
based on the patch by Conrad Irwin &lt;conrad.irwin AT 	  gmail.com&gt; at
[ruby-core:51816].  [Bug #7772]</p>

<p>Sun Jan 12 15:17:00 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/tk/tkutil/tkutil.c: use rb_sprintf(), rb_id2str(), and 	 
rb_intern_str() instead of rb_intern() and RSTRING_PTR() with 	 
RB_GC_GUARD(), to prevent temporary objects from GC. 	  [ruby-core:39000]
[Bug #5199]</p>

<p>Tue Jan  7 01:16:34 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (mnew_from_me): keep iclass as-is, to make inheritance 	  chain
consistent.  [ruby-core:59358] [Bug #9315]</p>

<p>* proc.c (method_owner): return the original defined_class from 	 
prepended iclass, instead.</p>

<p>Tue Jan  7 01:16:34 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_search_super_method): direct superclass of a 	 
module is found when super called in a Method object generated a 	  method
defined in a module, call method_missing in that case. 	  [ruby-core:59358]
[Bug #9315]</p>

<p>Fri Jan  3 22:25:23 2014  Aman Gupta &lt;ruby@tmm1.net&gt;</p>

<p>* test/net/imap/cacert.pem: generate new CA cert, since the last one 	 
expired. [Bug #9341] [ruby-core:59459] 	* test/net/imap/server.crt: new
server cert signed with updated CA. 	* test/net/imap/Makefile: add `make
regen_certs` to automate this 	  process.</p>

<p>Wed Dec 25 00:46:44 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/smtp.rb (Net::SMTP#critical):  Always return a 	 
Net::SMTP::Response.  Patch by Pawel Veselov. 	  [ruby-trunk - Bug #9125]
	* test/net/smtp/test_smtp.rb:  Test for the above.</p>

<p>Wed Dec 25 00:18:19 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/lib/socket.rb: Don&#39;t test $! in “ensure” clause because 	
it may be set before the body. 	  Reported by ko1 and mrkn. 
[ruby-core:59088] [Bug #9247]</p>

<p>* lib/cgi/core.rb: Ditto.</p>

<p>* lib/drb/ssl.rb: Ditto.</p>

<p>Tue Dec 24 00:18:14 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (configuration): strip destdir part from prefix to get 	 
rid of duplication.  a patch by arton at [ruby-core:58859]. 	 
[ruby-core:58856] [Bug #9213]</p>

<p>Mon Dec 23 22:37:01 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (mnew_from_me): method by respond_to_missing? should be 	  owned
by the original class.</p>

<p>Sun Dec 22 22:56:06 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (mnew_from_me): achieve the original defined_class from 	 
prepended iclass, to fix inherited owner.</p>

<p>* proc.c (method_owner): return the defined class, but not the 	  class
which the method object is created from.</p>

<p>Sun Dec 22 22:56:06 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (method_owner): return the class where alias is defined, not 	 
the class original method is defined.</p>

<p>* vm_method.c (rb_method_entry_make, rb_alias): store the originally 	 
defined class in me.  [Bug #7993] [Bug #7842] [Bug #9236]</p>

<p>* vm_method.c (rb_method_entry_get_without_cache): cache included 	 
module but not iclass.</p>

<p>Sun Dec 22 00:07:09 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* insns.def: Fix optimization bug of Float#/ [Bug #9238]</p>

<p>Sat Dec 21 23:13:55 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval_jump.c (rb_exec_end_proc): unlink and free procs data before 	 
calling for each procs.  [Bug #9110]</p>

<p>Sat Dec 21 23:13:55 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* eval_jump.c (rb_exec_end_proc): fix double free or corruption error 	 
when reentering by callcc. [ruby-core:58329] [Bug #9110]</p>

<p>* test/ruby/test_beginendblock.rb: test for above.</p>

<p>Sat Dec 21 22:55:03 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/resolv.rb (Resolv::Hosts#lazy_initialize): should not 	  consider
encodings in hosts file.  [ruby-core:59239] [Bug #9273]</p>

<p>* lib/resolv.rb (Resolv::Config.parse_resolv_conf): ditto.</p>

<p>Sat Dec 21 22:51:51 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (fake.rb): fixed wrong RUBY_PLATFORM, to correctly 	 
install win32.h. 	  [ruby-core:58801][Bug #9199] reported by arton.</p>

<p>Sat Dec 21 16:16:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (finalize_deferred): flush all deferred finalizers while other 	 
finalizers can get ready to run newly by lazy sweep. 	  [ruby-core:58833]
[Bug #9205]</p>

<p>Sat Dec 21 16:07:00 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby_atomic.h (ATOMIC_PTR_EXCHANGE): atomic exchange function for 	  a
generic pointer.</p>

<p>Sat Dec 21 15:50:13 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* ruby_atomic.h: remove duplicate definisions between ATOMIC_XXX 	  and
ATOMIC_SIZE_XXX.</p>

<p>Sat Dec 21 15:50:13 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* ruby_atomic.h: define ATOMIC_SIZE_CAS() with 	 
__atomic_compare_exchange_n() and refactoring.</p>

<p>Sat Dec 21 15:50:13 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* ruby_atomic.h: use __atomic builtin functions supported by GCC. 	 
__sync family are legacy functions now and it is recommended 	  that new
code use the __atomic functions. 	  <a
href="http://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html">gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html</a></p>

<p>* configure.in: check existence of __atomic functions.</p>

<p>Sat Dec 21 15:37:11 2013  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ruby_atomic.h (ATOMIC_SIZE_CAS): fix compile error on Solaris 	  since
r43460.</p>

<p>Sat Dec 21 15:37:11 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby_atomic.h (ATOMIC_SIZE_CAS): new macro, compare and swap size_t.</p>

<p>Sat Dec 21 15:37:11 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby_atomic.h (rb_w32_atomic_cas): call InterlockedCompareExchange 	 
directly.</p>

<p>* ruby_atomic.h (ATOMIC_CAS): fix missing function call.</p>

<p>Sat Dec 21 15:37:11 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby_atomic.h (ATOMIC_CAS): suppress C4022 and C4047 warnings in 	  VC6.
only InterlockedCompareExchange is declared using PVOID.</p>

<p>Sat Dec 21 14:54:37 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/util.rb: [DOC] remove example of 	 
Rational#to_d without argument. [Bug #8958]</p>

<p>Sat Dec 21 14:54:37 2013  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/util.rb: [DOC] <code>precision</code> is
required</p>

<p>Sat Dec 21 14:54:37 2013  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/util.rb: [DOC] Document the required 	 
<code>precision</code> argument for Rational#to_d [Bug #8958]</p>

<p>Sat Dec 21 03:46:14 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/date/date_strptime.c (date__strptime_internal): unset 	 
case-insensitive flag for [:alpha:], which already implies both 	  cases,
to get rid of backtrack explosion.  [ruby-core:58984] 	  [Bug #9221]</p>

<p>Sat Dec 21 03:46:14 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/date/date_parse.c (parse_time): unset case-insensitive flag 	  for
[:alpha:], which already implies both cases, to get rid of 	  backtrack
explosion.  [ruby-core:58876] [Bug #9221]</p>

<p>Fri Dec 13 00:23:01 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerator_with_index): try to convert given offset to 	 
integer. fix bug introduced in r39594.</p>

<p>Mon Dec  2 23:31:00 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerator_with_index): should not store local variable 	 
address to memoise the arguments.  it is invalidated after the return. 	 
[ruby-core:58692] [Bug #9178]</p>

<p>Mon Dec  2 23:16:50 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enumerator.c (enumerator_with_index):  Restore handling of a nil memo 	 
from r39594.</p>

<p>Mon Dec  2 22:53:05 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_readlink): fix buffer overflow on a long symlink. since 	 
rb_str_modify_expand() expands from its length but not its capacity, 	 
need to set the length properly for each expansion. 	  [ruby-core:58592]
[Bug #9157]</p>

<p>Fri Nov 29 00:31:46 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (Doxyfile): tool/file2lastrev.rb needs running with 	 
BASERUBY since r43617.  [ruby-dev:47823] [Bug #9169]</p>

<p>Fri Nov 22 13:18:28 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (ruby_strtod): BigMath requires more precision.</p>

<p>Fri Nov 22 12:46:08 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (ruby_strtod): ignore too long fraction part, which does not 	 
affect the result.</p>

<p>Wed Nov 20 15:20:00 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* test/ruby/test_thread.rb (test_mutex_unlock_on_trap): extend waiting 	 
time to invocation of signal handler from 0.01 sec to 0.2 sec. 	  RubyCI
report error on mswin. reported by @unak</p>

<p>Wed Nov 13 11:57:01 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to RubyGems 2.0.14. [ruby-core:58300] 	  [Backport
#9104] 	  the patch is provided by drbrain (Eric Hodel).</p>

<p>Tue Nov 12 23:41:43 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (rb_feature_p): deal with default loadable suffixes.</p>

<p>* load.c (load_lock): initialize statically linked extensions.</p>

<p>* load.c (search_required, rb_require_safe): deal with statically 	 
linked extensions.</p>

<p>* load.c (ruby_init_ext): defer initialization of statically linked 	 
extensions until required actually.  [Bug #8883]</p>

<p>Tue Nov 12 23:41:43 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (ruby_init_ext): share feature names between frame name and 	 
provided features.</p>

<p>Tue Nov 12 23:33:08 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (Gem::Specification.load): obtain spec date from 	 
VCS for the case using git, RUBY_RELEASE_DATE is the last resort. 	 
probably fixes [Bug #9085].</p>

<p>Tue Nov 12 23:24:35 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUNRUBY): append – only after runruby.rb, not 	 
cross-compiling baseruby, so that $(RUN_OPT) can be command line 	 
options.  [ruby-dev:47703] [Bug #8893]</p>

<p>Tue Nov 12 23:24:35 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>(partially merged from r42862) 	* common.mk: use RUNRUBY instead of
MINIRUBY because MINIRUBY can&#39;t 	  require extension libraries. The
patch is from nobu 	  (Nobuyoshi Nakada).</p>

<p>Mon Nov 11 23:54:51 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/init.c (cloexec_accept): Fix a compile error on 	  Debian
GNU/kFreeBSD.  Consider HAVE_ACCEPT4 is defined 	  but SOCK_CLOEXEC is not
defined.</p>

<p>Mon Nov 11 22:14:37 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/win32.h (rb_infinity_float): suppress overflow in 	 
constant arithmetic warnings.  [ruby-core:57981] [Bug #9044]</p>

<p>Mon Nov 11 22:14:37 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (config.h): VC 2013 supports C99 mathematics 	 
functions.  [ruby-core:57981] [Bug #9044]</p>

<p>Thu Oct 31 22:28:04 2013  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* test/openssl/test_pkey_ec.rb: Skip tests for “Oakley” curves as 	  they
are not suitable for ECDSA. 	  [ruby-core:54881] [Bug #8384]</p>

<p>Thu Oct 31 22:28:04 2013  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/ossl_pkey_ec.c: Ensure compatibility to builds of 	  OpenSSL
with OPENSSL_NO_EC2M defined, but OPENSSL_NO_EC not 	  defined. 	*
test/openssl/test_pkey_ec.rb: Iterate over built-in curves 	  (and assert
their non-emptiness!) instead of hard-coding them, as 	  this may cause
problems with respect to the different availability 	  of individual curves
in individual OpenSSL builds. 	  [ruby-core:54881] [Bug #8384]</p>

<p>Thanks to Vit Ondruch for providing the patch!</p>

<p>Sun Oct 27 01:04:28 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to RubyGems 2.0.13. [ruby-core:58031] 	  [Backport
#9052] 	  the patch is provided by drbrain (Eric Hodel).</p>

<p>Sat Oct 26 16:04:36 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* gc.c (gc_prof_set_heap_info): fix compile error when 	 
GC_PROFILE_MORE_DETAIL != 0. 	  the patch is provided by ko1 (Koichi
Sasada).</p>

<p>Thu Oct 24 23:27:12 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to RubyGems 2.0.12. [ruby-core:57818] 	  [Backport
#9014] 	  the patch is provided by drbrain (Eric Hodel).</p>

<p>Thu Oct 24 22:49:28 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* parse.y: Remove +(binary) and -(binary) special cases 	  [Feature #9048]</p>

<p>Thu Oct 24 22:36:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* encoding.c (load_encoding): should preserve outer errinfo, so that 	 
expected exception may not be lost.  [ruby-core:57949] [Bug #9038]</p>

<p>Fri Oct 18 02:10:00 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): set ci-&gt;me to 0 when the 	 
original method of a refined method is undef to avoid SEGV.</p>

<p>* vm_method.c (rb_method_entry_without_refinements): return 0 when 	  the
original method of a refined method is undef to avoid SEGV.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Fri Oct 18 02:05:45 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/file.c (rb_file_expand_path_internal): fix memory leaks at 	  a
non-absolute home exception.</p>

<p>Thu Oct 10 01:14:37 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compar.c (cmp_eq): fail if recursion.  [ruby-core:57736] [Bug #9003]</p>

<p>* thread.c (rb_exec_recursive_paired_outer): new function which is 	 
combinnation of paired and outer variants.</p>

<p>Thu Oct 10 01:07:37 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/tempfile.rb (Tempfile#unlink): finalizer is no longer needed 	 
after unlinking.  patched by by normalperson (Eric Wong) at 	 
[ruby-core:56521] [Bug #8768]</p>

<p>Thu Oct 10 00:58:39 2013  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* test/ruby/test_array.rb (test_count): add a test case for #count 	  with
an argument. See Bug #8654.</p>

<p>Thu Oct 10 00:58:39 2013  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* array.c (rb_ary_count): check length to avoid SEGV 	  while iterating.
Remove other pointer loop when arg is given.</p>

<p>* test/ruby/test_array.rb (test_count): add test for bug. 	 
[ruby-core:56072] [Bug #8654]</p>

<p>Thu Oct 10 00:58:39 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* array.c (rb_ary_count): iterate items appropriately. 	  [Bug #8654]</p>

<p>Thu Oct 10 00:44:28 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_fork_internal): remove cloexec setting on pipes 	  created
by rb_cloexec_pipe.  patch by normalperson (Eric Wong) at 	 
[ruby-core:56523].  [Bug #8769]</p>

<p>Thu Oct 10 00:24:01 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* cont.c: disable FIBER_USE_NATIVE on GNU/Hurd because it doesn&#39;t 	 
support a combination getcontext() and threads. Patch by 	  Gabriele
Giacone (1o5g4r8o@gmail.com). [Bug #<a href="ruby-core:57685">8990]</a></p>

<p>Mon Oct  7 21:03:54 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in, win32/Makefile.sub (FIBER_USE_NATIVE): move conditions 	 
from cont.c</p>

<p>Thu Oct 10 00:17:56 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/dl/test_base.rb: <code>libc,</code> detection now handle GNU/Hurd 	 
correctly. Patch by Gabriele Giacone (1o5g4r8o@gmail.com). 	  [Bug #<a
href="ruby-core:57311">8937]</a> 	* test/fiddle/helper.rb: ditto.</p>

<p>Thu Oct 10 00:00:30 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/time.rb (Time.strptime): Time.strptime(&#39;0&#39;, &#39;%s&#39;)
returns local 	  time Time object as Ruby 2.0 and before.</p>

<p>Thu Oct 10 00:00:30 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/time.rb (Time.strptime): Use :offset. 	  Patch by Felipe Contreras. 
[ruby-core:57694]</p>

<p>Wed Oct  9 23:32:37 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (rb_gc_disable): do rest_sweep() before disable GC. 	  This fix may
solve a failure of 	  TestTracepointObj#test_tracks_objspace_events 	 
[test/-ext-/tracepoint/test_tracepoint.rb:43].</p>

<p>Sat Oct  5 02:14:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_close_read): duplex IO should wait its child process 	  even
after close_read.</p>

<p>Sat Oct  5 02:14:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_close_read): keep fptr in write_io to be discarded, to 	 
fix freed pointer access when it is in use by other threads, and get 	  rid
of potential memory/fd leak.</p>

<p>Sat Oct  5 01:59:50 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_undef): raise a NameError if the original method 	  of a
refined method is not defined.</p>

<p>* vm_insnhelper.c (rb_method_entry_eq): added NULL check to avoid SEGV.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sat Oct  5 00:16:33 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* process.c (rb_daemon): daemon(3) is implemented with fork(2). 	 
Therefore it needs rb_thread_atfork(). (and revert r41903)</p>

<p>Sat Oct  5 00:16:33 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (fork_daemon): kill the other threads all and abandon the 	 
kept mutexes.</p>

<p>Sat Oct  5 00:16:33 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (fork_daemon): kill the other threads all and abandon the 	 
kept mutexes.</p>

<p>Tue Oct  1 00:28:40 2013  SHIBATA Hiroshi 
&lt;shibata.hiroshi@gmail.com&gt;</p>

<p>* tool/make-snapshot: Fix order of priority for option parameter.</p>

<p>Sat Sep 28 21:40:40 2013  Kenichi Kamiya  &lt;kachick1@gmail.com&gt;</p>

<p>* random.c (rb_random_ulong_limited): coerce before check negative. 	 
[Fixes GH-379]</p>

<p>Fri Sep 27 01:24:20 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to Rubygems 2.0.10. [ruby-core:57360] 	  [Backport
#8950] 	  the patch is provided by drbrain (Eric Hodel). 	  this update
contains a security fix for CVE-2013-4363.</p>

<p>Fri Sep 27 01:11:21 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (lambda): adjust position to the beginning of the block.</p>

<p>Fri Sep 27 01:02:59 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/generic.rb (URI::Generic.find_proxy): return nil if 	 
http_proxy environment variable is empty string. 	  [ruby-core:57140] [Bug
#8898]</p>

<p>Fri Sep 27 00:58:57 2013  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/gserver.rb: [DOC] correct gserver.rb license [Bug #8913]</p>

<p>Sun Sep 15 23:15:32 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to Rubygems 2.0.9. [ruby-core:57183] 	  [Backport
#8908] 	  the patch is provided by drbrain (Eric Hodel).</p>

<p>Sun Sep 15 22:59:04 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (Gem::Specification#initialize): default date to 	 
RUBY_RELEASE_DATE.  [ruby-core:57072] [Bug #8878]</p>

<p>* tool/rbinstall.rb (Gem::Specification#to_ruby): add date.</p>

<p>Sun Sep 15 22:55:44 2013  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* hash.c (rb_hash_aset): [DOC] Document key dup patch by @kachick 	 
[Fixes GH-382] <a
href="https://github.com/ruby/ruby/pull/382">github.com/ruby/ruby/pull/382</a></p>

<p>Sun Sep 15 22:03:01 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vsnprintf.c (MAXEXP, MAXFRACT): calculate depending on constants in 	 
float.h.</p>

<p>* vsnprintf.c (BSD_vfprintf): limit length for cvt() to get rid of 	 
buffer overflow.  [ruby-core:57023] [Bug #8864]</p>

<p>* vsnprintf.c (exponent): make expbuf size more precise.</p>

<p>Sat Sep 14 00:01:20 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to RubyGems 2.0.8. [ruby-core:57155] 	  [Backport
#8900] 	  the patch is provided by drbrain (Eric Hodel). 	  this update
contains a security fix for CVE-2013-4287.</p>

<p>Fri Sep 13 23:20:29 2013  Kenichi Kamiya  &lt;kachick1@gmail.com&gt;</p>

<p>* object.c (Init_Object): undef Module#prepend_features on Class, as 	 
well as Module#append_features.  [Fixes GH-376]</p>

<p>* test_class.rb: Added test for above. And ensure type checking 	  on
similar methods as module_function.</p>

<p>Fri Sep 13 23:16:12 2013  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* enumerator.c: [DOC] Remove reference to Enumerator::Lazy#cycle 	  Patch
by @kachick [Fixes GH-372] 	  <a
href="https://github.com/ruby/ruby/pull/372">github.com/ruby/ruby/pull/372</a></p>

<p>Fri Sep 13 22:40:28 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_search_super_method): use ci-&gt;argc instead of 	 
ci-&gt;orig_argc. ci-&gt;argc can be changed by splat arguments. 	 
[ruby-list:49575] 	  This fix should be applied to Ruby 2.0.0 series.</p>

<p>* test/ruby/test_super.rb: add a test for above.</p>

<p>Fri Sep 13 01:44:54 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_mutex_unlock): Mutex#unlock no longer raise 	  an exception
even if uses on trap. [Bug #8891]</p>

<p>Fri Sep 13 01:09:59 2013  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* vm_backtrace.c (vm_backtrace_to_ary): Ignore the second argument if 	 
it is nil. [Bug #8884] [ruby-core:57094]</p>

<p>* test/ruby/test_backtrace.rb (test_caller_with_nil_length): 	  Test for
above.</p>

<p>Fri Sep 13 00:57:54 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (method_entry_i): should exclude refined methods from 	 
instance method list.  [ruby-core:57080] [Bug #8881]</p>

<p>Fri Sep 13 00:33:09 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* vm_eval.c (vm_call0): fix prototype, the id parameter should be of 	 
type ID, not VALUE</p>

<p>* vm_insnhelper.c (check_match): the rb_funcall family of functions 	 
does not care about refinements. We need to use 	 
rb_method_entry_with_refinements instead to call === with 	  refinements.
Thanks to Jon Conley for reporting this bug. 	  [ruby-core:57051] [Bug
#8872]</p>

<p>* test/ruby/test_refinement.rb: add test</p>

<p>Fri Sep 13 00:18:55 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_zip_func): fix non-single argument.  fix 	 
out-of-bound access and pack multiple yielded values. 	  [ruby-core:56383]
[Bug #8735]</p>

<p>Thu Sep 12 01:44:01 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (str_gsub): use BEG(0) for whole matched position not 	  return
value from rb_reg_search(), for K matching. 	  [ruby-dev:47694] [Bug #8856]</p>

<p>Thu Sep 12 01:34:07 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* object.c (rb_class_inherited_p): allow iclasses to be tested for 	 
inheritance. [Bug #8686] [ruby-core:56174]</p>

<p>* test/ruby/test_method.rb: add test</p>

<p>Thu Sep 12 01:18:44 2013  Michal Rokos  &lt;michal@rokos.cz&gt;</p>

<p>* configure.in (sys/pstat.h): fix missing header check for 	 
missing/setproctitle.c on HP-UX.  [ruby-core:56644] [Bug #8792]</p>

<p>Thu Sep 12 01:02:56 2013  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* test/ruby/test_time.rb: use the in_timezone() helper 	  and define it at
the top with other helpers.</p>

<p>Thu Sep 12 01:02:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* time.c (time_mload): ignore auxiliary data, offset and zone, if 	 
invalid.  [ruby-core:56648] [Bug #8795]</p>

<p>Thu Sep 12 00:22:22 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* variable.c (classname): the name of class that has 	  non class id
should not be nil. This bug was introduced 	  in r36577.</p>

<p>* test/thread/test_cv.rb: test for change.</p>

<p>Thu Aug 29 21:51:33 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (zstream_run):  Fix handling of deflate streams that 	 
need a dictionary but are being decompressed by Zlib::Inflate.inflate 	 
(which has no option to set a dictionary).  Now Zlib::NeedDict is 	  raised
instead of crashing.  [ruby-trunk - Bug #8829] 	* test/zlib/test_zlib.rb
(TestZlibInflate):  Test for the above.</p>

<p>Thu Aug 29 21:28:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): a method entry refers the based 	 
class/module, so should search superclass from the origin i-class 	  where
the entry belongs to, to get rid of infinite loop when zsuper 	  in a
prepended class/module.  [ruby-core:54105] [Bug #8238]</p>

<p>Fri Aug 23 01:16:00 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/date/date_parse.c (rfc2822_cb): check if wday is given, since it 	 
can be omitted.</p>

<p>Fri Aug 23 00:55:02 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* gc.c (getrusage_time): Fallback clock_gettime to getrusage when 	 
clock_gettime fails. 	  Reported by Eric Saxby.  [ruby-core:56762] [Bug
#8805]</p>

<p>Sat Aug 17 00:42:12 2013  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* parse.y: fix build error with bison-3.0.</p>

<p>Sat Aug 17 00:39:20 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/webrick/test_cgi.rb (TestWEBrickCGI#<code>start_cgi_server,test_cgi</code>): 	
mswin is not only mswin32 but also mswin64. [Bug #8746]</p>

<p>Sat Aug 17 00:36:24 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* test/openssl/test_ssl.rb: Fix test for CVE-2013-4073. 	  Patch by
Antonio Terceiro. [Bug #8750] [ruby-core:56437]</p>

<p>Sat Aug 17 00:32:17 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: update to RubyGems 2.0.7. the patch by drbrain. 	 
[ruby-core:56633] [Backport #8787]</p>

<p>Sat Aug 10 23:59:47 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/coverage/test_coverage.rb (TestCoverage#test_big_code): use `1&#39;
	  instead of `p&#39; to get rid of a side effect. 	  Kernel#p without any
argument seems to do nothing, but flushes stdout. 	  and, if stdout is
redirected to file, fsync() will be called on 	  Windows.  so, when running
test-all on Windows with redirection, such 	  as CI environment, this test
took a lot of time.</p>

<p>Sun Aug  4 22:42:16 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (wrename): use MoveFileExW instead of MoveFileW, 	 
because the latter fails on cross device file move of some 	  environments.
	  fix [ruby-core:53492] [Bug #8109] 	  reported by mitchellh (Mitchell
Hashimoto)</p>

<p>Sat Aug  3 23:02:09 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/extmk.rb (extmake): Invoke Logging::log_close in a ensure 	  clause.</p>

<p>Sat Aug  3 23:02:09 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/extmk.rb (extmake): Use Logging.open to switch stdout and 	  stderr.
Delay Logging::log_close until the failure message is 	  written.  Write
the failure message only if log file is opened.</p>

<p>* lib/mkmf.rb (Logging.log_opened?): New method.</p>

<p>[ruby-dev:47215] [Bug #8209]</p>

<p>Sat Aug  3 22:46:19 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (xsystem): expand environment variable in all macros not 	 
expanded with RbConfig.  [Bug #8702]</p>

<p>* test/mkmf/test_framework.rb (create_framework): replace all $@ not 	 
only once.</p>

<p>Sat Aug  3 22:40:57 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (have_framework): allow header file to check. 	 
[ruby-core:55745] [Bug #8593]</p>

<p>Sat Aug  3 22:24:44 2013  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* lib/uri/common.rb (URI.decode_www_form_component): 	  Don&#39;t raise
error when str includes multibyte characters.</p>

<p>Sun Jul 28 22:00:10 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* rational.c (f_round_common): Rational is expected to be returned by 	 
Rational#*, but mathn.rb breaks that assumption.  [ruby-core:56177] 	  [Bug
#8687]</p>

<p>Sun Jul 28 21:50:34 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* io.c (io_getpartial): use rb_str_locktmp_ensure(). 	  [ruby-core:56121]
[Bug #8669]</p>

<p>* io.c (rb_io_sysread): ditto.</p>

<p>* test/ruby/test_io.rb: add tests for above.</p>

<p>Sun Jul 28 21:50:34 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* string.c: add internal API rb_str_locktmp_ensure().</p>

<p>* io.c (io_fread): use rb_str_locktmp_ensure(). 	  [ruby-core:56121] [Bug
#8669]</p>

<p>* test/ruby/test_io.rb: add a test for above.</p>

<p>Sun Jul 28 21:44:57 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl_asn1.c (asn1time_to_time):  Implement YYMMDDhhmmZ 	 
format for ASN.1 UTCTime.  [ruby-trunk - Bug #8664] 	*
test/openssl/test_asn1.rb:  Test for the above.</p>

<p>Fri Jul 26 00:38:58 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to RubyGems 2.0.6. [ruby-core:56160] 	  [Backport
#8682]</p>

<p>Wed Jul 24 22:35:32 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/generic.rb (find_proxy): raise BadURIError if the URI is 	  a
relative URI. [Bug #8645]</p>

<p>Wed Jul 24 01:13:02 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* include/ruby/intern.h (rb_f_lambde): restore the declaration of 	 
rb_f_lambda() for backword compatibility. and mark it as deprecated.</p>

<p>Tue Jul 23 01:36:43 2013  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* lib/rubygems/psych_additions.rb: Ignore Psych docs here</p>

<p>Tue Jul 23 01:34:00 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/test_tracer.rb: catch up recent rubygems changes.</p>

<p>Tue Jul 23 01:28:54 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rubygems: Update to RubyGems 2.0.5. 	  The patch provided by drbrain
(Eric Hodel). [ruby-core:55896] 	  [Backport #8617]</p>

<p>* test/rubygems:  Tests for the above.</p>

<p>Tue Jul 23 00:00:27 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (eval_string_with_cref): use the given file name unless 	 
eval even if scope is given.  additional fix for [Bug #8436]. 	  based on
the patch by srawlins at [ruby-core:56099] [Bug #8662].</p>

<p>Sat Jul 20 23:49:33 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/drb/drbtest.rb (Drb<code>Core,Ary</code>#teardown): retry Process.kill 	  if
it fails with Errno::EPERM on Windows (workaround). 	  [ruby-dev:47245]
[Bug #8251]</p>

<p>Sat Jul 20 23:31:11 2013  Aman Gupta  &lt;tmm1@ruby-lang.org&gt;</p>

<p>* iseq.c (iseq_location_setup): re-use existing string when iseq has 	 
the same path and absolute_path. [Bug #8149]</p>

<p>Sun Jul 14 00:18:08 2013  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>* sprintf.c: Fix typo patch by @hynkle [Fixes GH-357] 	  <a
href="https://github.com/ruby/ruby/pull/357">github.com/ruby/ruby/pull/357</a></p>

<p>Sun Jul 14 00:17:07 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* man/ri.1: Incorrect use of .Dd macro [Bug #8620] by Tristan Hill</p>

<p>Sun Jul 14 00:15:26 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/logger.rb: Use :call-seq: for method signature rdoc</p>

<p>Sun Jul 14 00:13:01 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/net/http/test_http.rb (TestNetHTTP_v1_2#test_get, 	 
TestNetHTTP_v1_2_chunked#test_get): shouldn&#39;t check 	 
HttpResponse#decode_content if Zlib is not available. 	  ko1 complained via
IRC.</p>

<p>Sat Jul 13 23:50:00 2013  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: fixed coding error [ruby-core:55337]. 	  reported
by Riley Lynch.</p>

<p>Sat Jul 13 23:50:00 2013  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: fixed a bug [ruby-core:55295].  reported 	  by
Riley Lynch.</p>

<p>Sat Jul 13 23:41:25 2013  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c (date_zone_to_diff): [ruby-core:55831].</p>

<p>Sat Jul 13 23:34:13 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* object.c: Fix rdoc for Kernel#&lt;=&gt;. [Fix GH-352]</p>

<p>Sat Jul 13 23:29:51 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/fileutils.rb (FileUtils#mode_to_s): Define mode_to_s() also 	  as
singleton method, or FileUtils.chmod fails in verbose mode.</p>

<p>Sat Jul 13 23:27:12 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/fileutils.rb (FileUtils#chown, FileUtils#chown_R): If user 	  and
group are both nil, print “:”.</p>

<p>Sat Jul 13 23:16:49 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (bigrsh_bang): Fix bignum digits overrun.</p>

<p>Sat Jul 13 23:16:49 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (biglsh_bang): Fix bignum digits under-run.</p>

<p>Sat Jul 13 22:45:10 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_DTRACE_POSTPROCESS): dtrace version SUN D 1.11 	 
introduces a check in the dtrace compiler to ensure that probes 	  actually
exist. If there are no probes, then the -G step will 	  fail. As this test
is only being used to determine whether -G is 	  necessary (for instance,
on OSX it is not), adding a real probe to 	  the conftest allows it to
succeed on newer versions of dtrace. 	  Patch by Eric Saxby &lt;sax AT
livinginthepast.org&gt; at 	  [ruby-core:55826].  [Fix GH-351], [Bug
#8606].</p>

<p>Sat Jul 13 22:41:20 2013  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* test/openssl/test_x509crl.rb: Remove unused variable. 	 
[ruby-core:53501] [Bug #8114]</p>

<p>Thanks, Vipul Amler, for pointing this out!</p>

<p>Sun Jul  7 02:00:41 2013  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* lib/openssl/ssl.rb: Fix SSL client connection crash for SAN marked 	 
critical. 	  The patch for CVE-2013-4073 caused SSL crash when a SSL server
returns 	  the certificate that has critical SAN value.  X509 extension
could 	  include 2 or 3 elements in it:</p>

<p>[id, criticality, octet_string] if critical, 	  [id, octet_string] if
not.</p>

<p>Making sure to pick the last element of X509 extension and use it as 	 
SAN value. 	  [ruby-core:55685] [Bug #8575]</p>

<p>Thank you @nahi for providing the patch!</p>

<p>Sun Jul  7 01:58:25 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/fileutils.rb (FileUtils#symbolic_modes_to_i): Fix the wrong 	 
character class [+-=], which happened to match all desired 	  characters
but also match undesired characters.</p>

<p>Sun Jul  7 01:54:44 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/fileutils.rb (FileUtils#chown, FileUtils#chown_R): Fix the 	  wrong
output message when user is nil, which should be “chown 	  :group file”
instead of “chown group file”.</p>

<p>Fri Jul  5 00:55:05 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regcomp.c (): Merge Onigmo 5.13.5 23b523076d6f1161.</p>

<p>* [bug]  (thanks Akinori MUSHA and Ippei Obayashi) 	           Fix a
renumbering bug in condition regexp with a named 	           capture. [Bug
#8583] 	  * [spec] (thanks Akinori MUSHA) 	    Allow ENCLOSE_OPTION in
look-behind.</p>

<p>Wed Jul  3 23:31:26 2013  Shota Fukumori  &lt;sorah@cookpad.com&gt;</p>

<p>* lib/mkmf.rb (try_config): Fix to not replace $LDFLAGS with $libs 	 
(1.9.3 behavior) [ruby-core:55752] [Bug #8595]</p>

<p>Tue Jul  2 03:06:38 2013  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigMath_s_exp): Fix for the cases when 	 
the argument x is not a BigDecimal. 	  This change is based on the patch
made by Heesob Park and Garth Snyder. 	  [Bug #6862] [ruby-core:47145] 	 
[Fix GH-332] <a
href="https://github.com/ruby/ruby/pull/332">github.com/ruby/ruby/pull/332</a></p>

<p>Fri Jun 28 02:20:13 2013  Aman Gupta  &lt;ruby@tmm1.net&gt;</p>

<p>* compile.c (iseq_add_mark_object): Use new rb_iseq_add_mark_object().</p>

<p>* insns.def (setinlinecache): Ditto.</p>

<p>* iseq.c (rb_iseq_add_mark_object): New function to allocate 	 
iseq-&gt;mark_ary on demand. [Bug #8142]</p>

<p>* iseq.h (rb_iseq_add_mark_object): Ditto.</p>

<p>* iseq.c (prepare_iseq_build): Avoid allocating mark_ary until needed.</p>

<p>* iseq.c (rb_iseq_build_for_ruby2cext): Ditto.</p>

<p>Thu Jun 27 20:10:56 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/openssl/lib/openssl/ssl.rb (verify_certificate_identity): fix 	 
hostname verification. Patched by nahi.</p>

<p>* test/openssl/test_ssl.rb (test_verify_certificate_identity): test for 	 
above.</p>

<p>Thu Jun 27 13:16:40 2013  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/rubygems/test_gem_installer.rb (test_install_extension_flat): 	 
use ruby in build directory in case ruby is not installed. 	 
[ruby-core:53265] [Bug #8058]</p>

<p>Wed Jun 26 23:05:34 2013  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (TestIO#test_write_32bit_boundary): skip if 	 
writing a file is slow. 	  [ruby-core:55541] [Bug #8519]</p>

<p>Wed Jun 26 22:42:36 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb: should use expanded values for header directories 	  unless
extmk.  patch by vo.x (Vit Ondruch) at [ruby-core:55653] 	  [Bug #8115],
rhbz#921650.</p>

<p>Wed Jun 26 02:25:52 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/rubygems/ext/builder.rb (Gem::Ext::Builder.make): Pass 	  DESTDIR
via command line to override what&#39;s in MAKEFLAGS.  This 	  fixes an
installation problem under a package building 	  environment where DESTDIR
is specified in the (parent) command 	  line. [Fixes GH-327]</p>

<p>Tue Jun 25 00:12:19 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* array.c: Return value in Array overview example found by @PragTob 	 
[Fix GH-336] <a
href="https://github.com/ruby/ruby/pull/336">github.com/ruby/ruby/pull/336</a></p>

<p>Tue Jun 25 00:11:46 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* array.c (rb_ary_zip): typo by @PragTob [Fix GH-337] 	  <a
href="https://github.com/ruby/ruby/pull/337">github.com/ruby/ruby/pull/337</a></p>

<p>Tue Jun 25 00:10:54 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* win32/README.win32: grammar typo by @blankenshipz [Fix GH-334] 	  <a
href="https://github.com/ruby/ruby/pull/334">github.com/ruby/ruby/pull/334</a></p>

<p>Sun Jun 23 00:03:18 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* ext/etc/etc.c (etc_getpwnam): use PRIsVALUE in format string instead 	 
of %s and RSTRING_PTR</p>

<p>* ext/etc/etc.c (etc_getgrnam): ditto</p>

<p>Sat Jun 22 00:54:41 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Update to RubyGems 2.0.3</p>

<p>* test/rubygems:  Tests for the above.</p>

<p>* NEWS:  Added RubyGems 2.0.3 note.</p>

<p>Wed Jun 19 04:20:31 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): ensure methods of type 	 
VM_METHOD_TYPE_ATTR_SET are called with 1 argument</p>

<p>* test/ruby/test_module.rb (class TestModule): add test</p>

<p>[ruby-core:55543] [Bug #8540]</p>

<p>Wed Jun 19 03:54:04 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* defs/id.def (predefined): add “idProc”.</p>

<p>* proc.c (mnew, mproc, mlambda): use predefined IDs.</p>

<p>* vm.c (Init_VM): ditto.</p>

<p>Wed Jun 19 03:54:04 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/intern.h (rb_block_lambda): add declaration instead of 	 
deprecated rb_f_lambda.</p>

<p>Wed Jun 19 03:24:07 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* include/ruby/ruby.h, vm_eval.c (rb_funcall_with_block): 	  new function
to invoke a method with a block passed 	  as an argument.</p>

<p>* string.c (sym_call): use the above function to avoid 	  a block sharing.
[ruby-dev:47438] [Bug #8531]</p>

<p>* vm_insnhelper.c (vm_yield_with_cfunc): don&#39;t set block 	  in the
frame.</p>

<p>* test/ruby/test_symbol.rb (TestSymbol#test_block_given_to_proc): 	  run
related tests.</p>

<p>Wed Jun 19 03:06:57 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* test/ruby/test_proc.rb (TestProc#test_block_given_method_to_proc): 	 
run test for r41359.</p>

<p>Wed Jun 19 03:06:57 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* include/ruby/intern.h, proc.c (rb_method_call_with_block): 	  new
function to invoke a Method object with a block passed 	  as an argument.</p>

<p>* proc.c (bmcall): use the above function to avoid a block sharing. 	 
[ruby-core:54626] [Bug #8341]</p>

<p>* test/ruby/test_proc.rb (TestProc#test_block_persist_between_calls): 	 
run related tests.</p>

<p>Tue Jun 18 02:49:20 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_separately): stop_auto_run of 	 
Test::Unit::Runner to prevent auto runner use ARGV.</p>

<p>* test/ruby/envutil.rb (assert_separately): add $: to separate process.</p>

<p>* test/ruby/envutil.rb (assert_separately): fail if stderr is not 	  empty
and ignore_stderr is false.</p>

<p>Tue Jun 18 02:21:54 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (EnvUtil.with_default_external): add for 	 
changing Encoding.default_external without warnings.</p>

<p>* test/ruby/envutil.rb (EnvUtil.with_default_internal): ditto.</p>

<p>* test/ruby/test_io_m17n.rb: use above with_default_external.</p>

<p>Tue Jun 18 00:43:27 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* vm_backtrace.c: Update rdoc for Backtrace#label with @_ko1</p>

<p>Tue Jun 18 00:34:57 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>merge revision(s) 41347: [Backport #5048] [Backport #5465] [Backport #8319]</p>

<pre class="code ruby"><code class="ruby">* ext/tk/extconf.rb: support s390x (Thanks to bkabrda) [Bug #5465]</code></pre>

<p>* ext/tk/extconf.rb: apply [Bug #5048]</p>

<p>* ext/tk/lib/tk/canvas.rb,ext/tk/sample/demos-<code>en,jp</code>/treetree.rb,widget: 	 
fix bug (Thanks to zzak) [ruby-trunk - Bug #8319]</p>

<p>Sun Jun 16 01:56:54 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (FL_SET_EMBED): shared object is frozen even when get 	 
unshared.</p>

<p>* array.c (rb_ary_modify): ARY_SET_CAPA needs unshared array.</p>

<p>Sun Jun 16 01:32:26 2013  TAKANO Mitsuhiro &lt;tak@no32.tk&gt;</p>

<p>* insns.def: fix condition.</p>

<p>Sun Jun 16 01:22:35 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/socket/extconf.rb:  Enable RFC 3542 IPV6 socket options for OS X 	 
10.7+.  [ruby-trunk - Bug #8517]</p>

<p>Sun Jun 16 01:11:10 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (rb_iseq_compile_node): fix location of a `trace&#39; 	 
instruction (b_return event). 	  [ruby-core:55305] [ruby-trunk - Bug #8489]
	  (need a backport to 2.0.0?)</p>

<p>* test/ruby/test_settracefunc.rb: add a test.</p>

<p>Sun Jun 16 00:30:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (eval_string_with_cref): propagate absolute path from the 	 
binding if it is given explicitly.  patch by Gat (Dawid Janczak) at 	 
[ruby-core:55123]. [Bug #8436]</p>

<p>Wed Jun 12 23:41:21 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_yield_setup_block_args): partially revert r41019. 	 
The code is not useless.</p>

<p>Wed Jun 12 23:41:21 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_yield_setup_block_args): split single parameter 	 
if any keyword arguments exist, and then extract keyword arguments. 	 
[ruby-core:55203] [Bug #8463]</p>

<p>Wed Jun 12 23:05:41 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_getc): fix 7bit coderange condition, check if ascii read 	 
data instead of read length. [ruby-core:55444] [Bug #8516]</p>

<p>Sun Jun  9 02:27:07 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (install_dirs, with_destdir): prefix with DESTDIR 	 
directories to install only unless bundled extension libraries. 	 
[ruby-core:53502] [Bug #8115]</p>

<p>Sun Jun  9 02:17:16 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* class.c (include_modules_at): invalidate method cache if included 	 
module contains constants</p>

<p>* test/ruby/test_module.rb: add test</p>

<p>Sun Jun  9 01:59:39 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>merge revision 40783 (partially): [Backport #8413]</p>

<p>* win32/Makefile.sub: fix a typo in config.h.</p>

<p>Sun Jun  9 01:38:55 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* intern.h: remove dangling rb_class_init_copy declaration 	 
[ruby-core:55120] [Bug #8434]</p>

<p>Sun Jun  9 01:30:57 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (capability_response): should ignore trailing 	  spaces.
Thanks, Peter Kovacs.  [ruby-core:55024] [Bug #8415]</p>

<p>* test/net/imap/test_imap_response_parser.rb: related test.</p>

<p>Wed Jun  5 00:38:46 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/zlib/zlib.c (gzfile_read, gzfile_read_all, gzfile_getc), 	 
(gzreader_gets): check EOF.  [ruby-core:55220] [Bug #8467]</p>

<p>Wed Jun  5 00:32:18 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_require.rb: Remove temporally files in the tests.</p>

<p>* test/ruby/test_rubyoptions.rb: Ditto.</p>

<p>* test/logger/test_logger.rb: Ditto.</p>

<p>* test/psych/test_psych.rb: Ditto.</p>

<p>* test/readline/test_readline.rb: Ditto.</p>

<p>* test/syslog/test_syslog_logger.rb: Ditto.</p>

<p>* test/webrick/test_httpauth.rb: Ditto.</p>

<p>* test/zlib/test_zlib.rb: Ditto.</p>

<p>Wed Jun  5 00:08:55 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* dir.c (bracket): fix copy-paste error.  When the first and last 	 
characters of fnmatch range have different length, fnmatch may 	  have
wrongly matched a path that does not really match. 	  Coverity Scan found
this bug.</p>

<p>Wed Jun  5 00:04:12 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_quote_unprintable): check if argument is a string.</p>

<p>Tue Jun  4 23:42:18 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (loaded_feature_path): fix invalid read by index underflow. 	 
the beginning of name is also a boundary as well as just after &#39;/&#39;.</p>

<p>Tue Jun  4 23:32:12 2013  Charlie Somerville 
&lt;charliesome@ruby-lang.org&gt;</p>

<p>* variable.c (set_const_visibility): use rb_frame_this_func() instead 	 
of rb_frame_callee() for getting the name of the called method</p>

<p>* test/ruby/test_module.rb: add test for private_constant with no args</p>

<p>Tue Jun  4 23:27:24 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* vm_insnhelper.c (vm_callee_setup_keyword_arg, 	 
vm_callee_setup_arg_complex): consider a hash argument for keyword 	  only
when the number of arguments is more than the expected 	  mandatory
parameters.  [ruby-core:53199] [ruby-trunk - Bug #8040]</p>

<p>* test/ruby/test_keyword.rb: update a test for above.</p>

<p>Tue Jun  4 00:46:05 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (setup_overlapped, finish_overlapped): extract from 	 
rb_w32_read() and rb_w32_write().</p>

<p>Tue Jun  4 00:02:45 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_core.h (rb_vm_tag): move jmpbuf between tag and prev so ensure to 	 
be accessible.</p>

<p>Tue Jun  4 00:02:45 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval_intern.h (TH_PUSH_TAG): ensure jmpbuf to be accessible before 	 
pushing tag to get rid of unaccessible tag by stack overflow.</p>

<p>Mon Jun  3 23:22:58 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_compile_each): forward anonymous and first keyword 	 
rest argument one.  [ruby-core:55033] [Bug #8416].</p>

<p>Sun Jun  2 22:39:24 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* range.c: Fix rdoc on Range#bsearch [Bug #8242] [ruby-core:54143]</p>

<p>Mon May 20 04:00:48 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/yaml.rb: YAML documentation from #8344 [Bug #8355]</p>

<p>Wed May 15 23:22:09 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* include/ruby/intern.h: should include sys/time.h for struct timeval 	 
if it exists. [ruby-list:49363]</p>

<p>Tue May 14 20:21:41 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/config_file.rb:  Lazily load .gem/credentials to only 	 
check permissions when necessary.  RubyGems bug #465 	*
test/rubygems/test_gem_config_file.rb:  Test for the above.</p>

<p>* test/rubygems/test_gem_commands_push_command.rb:  Remove duplicated 	 
test.</p>

<p>Tue May 14 20:11:00 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/dl/lib/dl/func.rb (DL::Function#call): check tainted when 	  $SAFE
&gt; 0. 	* ext/fiddle/function.c (function_call): check tainted when $SAFE
&gt; 0. 	* test/fiddle/test_func.rb (module Fiddle): add test for above.</p>

<p>Sun May 12 22:42:25 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (rb_f_kill): fixes typo. s/HAS_KILLPG/HAVE_KILLPG/.</p>

<p>Sun May 12 04:23:06 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_peek_variable_name): treat invalid global, class, 	  and
instance variable names as mere strings rather than errors. 	 
[ruby-core:54885] [Bug #8375]</p>

<p>Sun May 12 04:23:06 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_yylex): fail if $, @, @@ are not followed by a valid 	 
name character.  [ruby-core:54846] [Bug #8375].</p>

<p>Sun May 12 02:50:30 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_RM_RECURSIVE): this hack is needed by only 	 
autoconf 2.69 or earlier on darwin.</p>

<p>Sun May 12 02:50:30 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (rm, shvar_to_cpp, unexpand_shvar): local is not 	 
available on old shells.</p>

<p>* configure.in (shvar_to_cpp): escape quotes for old shells. 	  [Bug
#7959] [Bug #8071]</p>

<p>Thu May  9 23:39:47 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_mod_included_modules): should not include non-modules. 	 
[ruby-core:53158] [Bug #8025]</p>

<p>Thu May  9 23:39:47 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_mod_included_modules): should not include the original 	 
module itself.  [ruby-core:53158] [Bug #8025]</p>

<p>Wed May  8 23:07:19 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* insns.def (defined): use vm_search_superclass() like as normal super 	 
call.  based on a patch &lt;<a
href="https://gist.github.com/wanabe/5520026">gist.github.com/wanabe/5520026</a>&gt;
by 	  wanabe.</p>

<p>* vm_insnhelper.c (vm_search_superclass): return error but not raise 	 
exceptions.</p>

<p>* vm_insnhelper.c (vm_search_super_method): check the result of 	 
vm_search_superclass and raise exceptions on error.</p>

<p>Wed May  8 23:07:19 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* insns.def (defined): get method entry from the method top level 	 
frame, not block frame.  [ruby-core:54769] [Bug #8367]</p>

<p>Wed May  8 01:18:41 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (MUL_OVERFLOW_SIGNED_INTEGER_P): New macro. 	 
(MUL_OVERFLOW_FIXNUM_P): Ditto. 	  (MUL_OVERFLOW_LONG_P): Ditto.</p>

<p>* array.c (rb_ary_product): Don&#39;t overflow on signed integer 	 
multiplication.</p>

<p>* numeric.c (fix_mul): Ditto. 	  (int_pow): Ditto.</p>

<p>* rational.c (f_imul): Ditto.</p>

<p>* insns.def (opt_mult): Ditto.</p>

<p>* thread.c (sleep_timeval): Don&#39;t overflow on signed integer addition.</p>

<p>* bignum.c (rb_int2big): Don&#39;t overflow on signed integer negation. 	 
(rb_big2ulong): Ditto. 	  (rb_big2long): Ditto. 	  (rb_big2ull): Ditto. 	 
(rb_big2ll): Ditto.</p>

<p>Tue May  7 20:13:12 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* test/ruby/test_thread.rb (invoke_rec): extend timeout 10 -&gt; 50 sec, 	
to investigate test failure on rubyci. 	  <a
href="http://a.mrkn.jp/~mrkn/chkbuild/mountain_lion/ruby-2.0.0-m64-o0/log/20130507T052909Z.log.html.gz">a.mrkn.jp/~mrkn/chkbuild/mountain_lion/ruby-2.0.0-m64-o0/log/20130507T052909Z.log.html.gz</a></p>

<p>Sat May  4 23:48:56 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/security.rdoc: Add note about reporting security vulns</p>

<p>Sat May  4 23:44:54 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_obj_is_kind_of): skip prepending modules. 	 
[ruby-core:54742] [Bug #8357]</p>

<p>* object.c (rb_class_inherited_p): ditto. 	  [ruby-core:54736] [Bug #8357]</p>

<p>Thu May  2 23:39:45 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* thread.c (double2timeval): convert the infinity to TIME_MAX to avoid 	 
SEGV by Thread.new {}.join(Float::INFINITY) on 	  Debian GNU/Linux (amd64).</p>

<p>Thu May  2 00:30:00 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): Add STACK_GROW_DIR_DETECTION. 	 
This fixes a compilation failure while cross-compiling for Tensilica 	 
Xtensa Processor.</p>

<p>Thu May  2 00:19:46 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* dir.c (dir_set_pos): Fix a compilation error when seekdir() is not 	 
exist.</p>

<p>Thu May  2 00:16:36 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* README.EXT: correct method name to be used.  [Bug #7982]</p>

<p>* README.EXT.ja: add notes too.</p>

<p>Thu May  2 00:16:36 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* README.EXT: Copy note from r40505 for rb_sprintf() [Bug #7982]</p>

<p>Thu May  2 00:16:36 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* README.EXT: Update note from r40504, by Jeremy Evans [Bug #7982]</p>

<p>Thu May  2 00:16:36 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* README.EXT: Add note to warn use of %i in Exceptions [Bug #7982]</p>

<p>Wed May  1 23:35:18 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_ext_int_to_encs, parse_mode_enc): bom-prefixed name is 	 
not a real encoding name, just a fallback.  so the proper conversion 	 
should take place even if if the internal encoding is equal to the 	 
bom-prefixed name, unless actual encoding is equal to the internal 	 
encoding.  [ruby-core:54563] [Bug #8323]</p>

<p>* io.c (io_set_encoding_by_bom): reset extenal encoding if no BOM 	 
found.  [ruby-core:54569]</p>

<p>Sat Apr 27 02:12:14 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_fd_fix_cloexec): use rb_update_max_fd().</p>

<p>Sat Apr 27 02:12:14 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_update_max_fd): use ATOMIC_CAS because this function 	  is used
from timer thread too.</p>

<p>Sat Apr 27 01:57:43 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* configure.in: use quadrigraphs. workaround for autoconf 2.64. 	  a patch
provided by Hessob Park. [ruby-core:53157] [Backport #8020]</p>

<p>Sat Apr 27 00:39:28 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_inspect): refix r40413, on Ruby 1.9 usual character 	 
escape uses hex/Unicode escapes, so fix to use Unicode escape on 	  Unicode
strings and hex on others. [ruby-core:54458] [Bug #8290]</p>

<p>Sat Apr 27 00:39:28 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* test/ruby/test_module.rb 	  (TestModule#test_const_get_invalid_name) 	 
(test_const_defined_invalid_name): Fix expected values.</p>

<p>Sat Apr 27 00:39:28 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* string.c (rb_str_inspect): NUL should not be represented as “0” 	  when
octal digits may follow.  [ruby-core:54458] [Bug #8290]</p>

<p>Fri Apr 26 23:48:58 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): Add STACK_GROW_DIR_DETECTION. 	 
This fixes a compilation failure while cross-compiling for ARM.</p>

<p>Fri Apr 26 23:32:09 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rss/atom.rb (RSS::Atom::Entry): Fix indent of document comment.</p>

<p>Fri Apr 26 23:32:09 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rss/maker.rb (RSS::Maker): Fix indent of document comment.</p>

<p>Fri Apr 26 23:32:09 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/rss/atom.rb: Documentation for RSS::Atom based on a patch by 	 
Michael Denomy 	* lib/rss/maker.rb: Documentation for RSS::Maker also by
@mdenomy</p>

<p>Thu Apr 25 00:40:41 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* numeric.c: Fix wiki link on Float imprecision in overview, patched 	  by
Makoto Kishimoto [Bug #8304] [ruby-dev:47280]</p>

<p>Thu Apr 25 00:39:16 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* string.c: Document String#setbyte return value by @gjmurakami-10gen 	 
[Fixes GH-294]</p>

<p>Thu Apr 25 00:38:06 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/socket/lib/socket.rb: Doc typos by @vipulnsward [Fixes GH-292]</p>

<p>Tue Apr 23 23:06:43 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_mod_public_method): fix visibility on anonymous 	 
module. set visibility of singleton method, not method in base 	  class. 
[ruby-core:54404] [Bug #8284]</p>

<p>Tue Apr 23 22:33:16 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (getacl_response): parse the mailbox of an ACL 	 
response correctly.  [ruby-core:54365] [Bug #8281]</p>

<p>Sun Apr 21 00:14:36 2013  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/ruby/test_require.rb (TestRequire#test_require_nonascii_path): 	 
RUBY_PLATFORM should escape as Regexp, 	  because RUBY_PLATFORM may contain
&#39;.&#39;.</p>

<p>Sun Apr 21 00:14:36 2013  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_require.rb (TestRequire#test_require_nonascii_path): 	 
fix load path for encoding to run the test as stand-alone.</p>

<p>Sun Apr 21 00:14:36 2013  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* load.c (features_index_add): use rb_str_subseq() to specify C string 	 
position properly to fix require non ascii path. 	  [ruby-core:53733] [Bug
#8165]</p>

<p>* test/ruby/test_require.rb (TestRequire#test_require_nonascii_path): 	  a
test for the above.</p>

<p>Sun Apr 21 00:13:24 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (rb_feature_p), vm_core.h (rb_vm_struct): turn 	 
loaded_features_index into st_table.  patches by tmm1 (Aman Gupta) 	  in
[ruby-core:53251] and [ruby-core:53274] [Bug #8048]</p>

<p>Sun Apr 21 00:13:24 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (features_index_add_single, rb_feature_p): store single index 	 
as Fixnum to reduce the number of arrays for the indexes.  based on 	  the
patch by tmm1 (Aman Gupta) in [ruby-core:53216] [Bug #8048].</p>

<p>Sat Apr 20 23:32:06 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (glob_helper): should skip dot directories only for recursion, 	 
but should not if matching to the given pattern.  [ruby-core:54387] 	  [Bug
#8283]</p>

<p>Sat Apr 20 02:37:33 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/curses/curses.c (Init_curses): fix implementation function, 	 
crmode should be same as cbreak.  [ruby-core:54013] [Bug #8222]</p>

<p>Sat Apr 20 02:09:46 2013  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Correct shutdown behavior w.r.t GC.</p>

<p>* test/openssl/test_ssl.rb: Add tests to verify correct behavior.</p>

<p>[Bug #8240] Patch provided by Shugo Maeda. Thanks!</p>

<p>Sat Apr 20 01:56:32 2013  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): Avoid using uninitialized value. 	 
stackaddr and size are not set if get_stack() fails.</p>

<p>Sat Apr 20 01:47:31 2013  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* thread_pthread.c: Fixes wrong scopes of #if USE_SLEEPY_TIMER_THREAD 	 
.. #endif sections.  This fixes a build error on NativeClient.</p>

<p>Sat Apr 20 01:31:38 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Merge Onigmo 5.13.4 f22cf2e566712cace60d17f84d63119d7c5764ee. 	  [bug]
fix problem with optimization of z (Issue #16) [Bug #8210]</p>

<p>Sat Apr 20 01:18:20 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_callee_setup_keyword_arg): non-symbol key is not 	 
a keyword argument, keep it as a positional argument.</p>

<p>Sat Apr 20 01:14:08 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_mutex_synchronize_m): yield no block params.  patch by 	 
splattael (Peter Suschlik) in [ruby-core:53773] [Bug #8097]. 	  fix GH-266.</p>

<p>Sat Apr 20 00:41:10 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_compile_each): append keyword hash to argument array 	 
to splat if needed.  [ruby-core:54094] [Bug #8236]</p>

<p>Sat Apr 20 00:31:57 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* README.EXT.ja (Data_Wrap_Struct): Remove a description about 	  orphan
argument. Oh, I renamed the argument name without 	  changing description
at r36180… Sorry.… 	  Patch by Makoto Kishimoto. Thanks!!! [ruby-dev:47269]
[Bug #8292] 	* README.EXT.ja (Data_Make_Struct): Add a sample code that
describes 	  how it works. 	  Patch by Makoto Kishimoto. Thanks!!!
[ruby-dev:47269] [Bug #8292]</p>

<p>Tue Apr 16 01:30:47 2013  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* configure.in: set ac_cv_prog_cxx if CXX is supplied.</p>

<p>Tue Apr 16 01:30:47 2013  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* configure.in: Fix c++ compiler auto-selection not only for 	  Darwin
11.x, but also the other versions of Darwin.</p>

<p>Tue Apr 16 00:27:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_compile_each): fix of defined? with empty 	  expression.
[ruby-core:53999] [Bug #8220]</p>

<p>Mon Apr 15 00:25:00 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* time.c (num_exact): use to_r method only if to_int method is 	 
available. 	  [ruby-core:53764] [Bug #8173] reported by Hiro Asari.</p>

<p>Mon Apr 15 00:22:09 2013  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* ext/objspace/objspace.c: Fix typo in doc. Patch by Sho Hashimoto. 	 
[Bug #8116] [ruby-dev:47177]</p>

<p>Mon Apr 15 00:15:04 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (HAVE_METACLASS_P): should check FL_SINGLETON flag before get 	 
instance variable to get rid of wrong warning about __attached__. 	 
[ruby-core:53839] [Bug #8188]</p>

<p>Mon Apr 15 00:13:13 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/file.c (code_page): use cp1252 instead of cp20127 as US-ASCII. 	 
fix [ruby-core:53079] [Bug #7996] 	  reported and patched by mmeltner
(Michael Meltner).</p>

<p>Mon Apr 15 00:07:31 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/io.h: undef POSIX compliant names on AIX, which are no 	 
longer needed.  patch suggested by edelsohn (David Edelsohn) in 	 
[ruby-core:53815].  [Bug #8174]</p>

<p>Mon Apr 15 00:07:31 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/io.h: rename SVR3,4 member names as POSIX compliant, 	  to
get rid of conflict on AIX.  [ruby-core:53765] [Bug #8174]</p>

<p>Sun Apr 14 23:49:48 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (configuration): not include all CFLAGS in CXXFLAGS, to 	 
use different set than C for C++.  [ruby-core:45273] [Bug #6504]</p>

<p>Sun Apr 14 23:43:06 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/fiddle/closure.c (initialize): check mprotect&#39;s return value. 	 
If mprotect is failed because of PaX or something, its function call 	 
will cause SEGV. 	  <a
href="http://c5664.rubyci.org/~chkbuild/ruby-trunk/log/20130401T210301Z.diff.html.gz">c5664.rubyci.org/~chkbuild/ruby-trunk/log/20130401T210301Z.diff.html.gz</a></p>

<p>Sun Apr 14 23:19:55 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MAIN_DOES_NOTHING): ensure symbols for tests to be 	 
preserved.  [ruby-core:53745] [Bug #8169]</p>

<p>Sun Apr 14 23:19:55 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MAIN_DOES_NOTHING): force to refer symbols for tests 	  to
be preserved.  [ruby-core:53745] [Bug #8169]</p>

<p>Sun Apr 14 03:00:51 2013  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* configure.in (AC_CHECK_HEADERS): atomic.h for Solaris atomic_ops.</p>

<p>* ruby_atomic.h: Skip using Solaris10 atomic_ops on Solaris 9 or 	 
earlier if atomic.h is not available. [ruby-dev:47229] [Bug #8228]</p>

<p>Sun Apr 14 02:32:45 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* time.c (GetTimeval): check if already initialized instance.</p>

<p>* time.c (GetNewTimeval): check if newly created instance.</p>

<p>* time.c (time_init_0, time_init_1, time_init_copy, time_mload): must 	 
be newly created instance.  [ruby-core:53436] [Bug #8099]</p>

<p>Sun Apr 14 02:13:25 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* vm_eval.c (check_funcall_respond_to): preserve passed_block, which 	  is
modified in vm_call0_body() via vm_call0(), and caused a bug of 	 
rb_check_funcall() by false negative result of rb_block_given_p(). 	 
re-fix [ruby-core:53650] [Bug #8153]. 	  [ruby-core:53653] [Bug #8154]</p>

<p>Fri Apr 12 04:16:30 2013  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* marshal.c (marshal_dump, marshal_load): workaround for segv on 	  Intel
Solaris compiled with Oracle SolarisStudio 12.3. 	  Partly revert r38174.
[ruby-core:52042] [Bug #7805]</p>

<p>Fri Apr 12 04:12:42 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_conv_enc_opts): convert with one converter, instead 	 
of re-creating converters for each buffer expansion.</p>

<p>Fri Apr 12 03:48:25 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (find_library): fix to format message. 	  [ruby-core:53568]
[Bug #8130]</p>

<p>Fri Apr 12 03:44:45 2013  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* proc.c (bm_free): need to clean up the mark flag of a free and 	 
unlinked method entry. [Bug #8100] [ruby-core:53439]</p>

<p>Fri Apr 12 02:27:42 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* addr2line.c: use more generic type: 	  * u_char -&gt; unsigned char 	  *
u_short -&gt; unsigned short 	  * u_int -&gt; unsigned int 	  * u_long
-&gt; unsigned long 	  * quad_t -&gt; int64_t 	  * u_quad_t -&gt; uint64_t</p>

<p>* addr2line.c (imax): inline is defined by configure.</p>

<p>Fri Apr 12 02:27:42 2013  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* addr2line.c: quad_t and u_quad_t is not available on Solaris. 	 
__inline is not available with old compilers on Solaris. 	 
[ruby-dev:47229] [Bug #8227]</p>

<p>Fri Apr 12 02:27:42 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* addr2line.c (putce): suppress unused return value warning.</p>

<p>Fri Apr 12 02:27:42 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* addr2line.c (kprintf): added from FreeBSD libstand&#39;s printf. 	  this
is consided as async signal safe function.</p>

<p>* addr2line.c (rb_dump_backtrace_with_lines): use kfprintf. 	  [Bug #8144]
[ruby-core:53632]</p>

<p>Fri Apr 12 02:27:42 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* addr2line.c (rb_dump_backtrace_with_lines): output line at once.</p>

<p>Fri Apr 12 02:10:09 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_export_method): directly override the flag of method 	 
defined in prepending class too, not adding zsuper entry. 	 
[ruby-core:53106] [Bug #8005]</p>

<p>Fri Apr 12 01:57:52 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/fileutils.rb:  Revert r34669 which altered the way 	 
metaprogramming in FileUtils occurred.  [ruby-trunk - Bug #7958]</p>

<p>* test/fileutils/visibility_tests.rb:  Refactored tests of FileUtils 	 
options modules to expose bug found in #7958 	*
test/fileutils/test_dryrun.rb:  ditto. 	* test/fileutils/test_nowrite.rb: 
ditto. 	* test/fileutils/test_verbose.rb:  ditto.</p>

<p>Fri Apr 12 01:28:46 2013  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* win32/file.c (get_user_from_path):  add internal function that retrieves
	  username from supplied path (refactored). 	* win32/file.c
(rb_file_expand_path_internal):  refactor expansion of user 	  home to use
get_user_from_path and cover dir_string corner cases. 	  [ruby-core:53168]
[Bug #8034]</p>

<p>Fri Apr 12 01:28:46 2013  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* win32/file.c (rb_file_expand_path_internal):  Expand home directory when
	  used as second parameter (dir_string).  [ruby-core:53168] [Bug #8034] 	*
test/ruby/test_file_exhaustive.rb: add test to verify.</p>

<p>Mon Apr  8 00:10:59 2013  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: Fix unlimited memory growth with large values of 	  RUBY_FREE_MIN.
patched by tmm1(Aman Gupta). 	  [Bug #8095] [ruby-core:53405]</p>

<p>Sun Apr  7 22:27:12 2013  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: Avoid unnecessary heap growth. patched by tmm1(Aman Gupta). 	 
[Bug #8093] [ruby-core:53393]</p>

<p>Sun Apr  7 03:01:49 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (simple_re_meta): escape all closing characters, not only 	 
round parenthesis.  [ruby-core:53578] [Bug #8133]</p>

<p>Sun Apr  7 02:54:40 2013  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: Improve accuracy of objspace_live_num() and 	  allocated/freed
counters. patched by tmm1(Aman Gupta). 	  [Bug #8092] [ruby-core:53392]</p>

<p>Fri Apr  5 00:54:08 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_bn.c (ossl_bn_initialize): fix can&#39;t create from
bn.</p>

<p>Thu Apr  4 02:27:12 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv-replace.rb (TCPSocket#initialize): resolve the 3rd 	 
argument only if non-nil value is given. 	  [ruby-dev:47150] [ruby-trunk -
Bug #8054] reported and analyzed by 	  mrkn.</p>

<p>Thu Apr  4 02:24:59 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Merge Onigmo d4bad41e16e3eccd97ccce6f1f96712e557c4518. 	  fix lookbehind
assertion fails with /m mode enabled. [Bug #8023] 	  fix Z matches where it
shouldn&#39;t. [Bug #8001]</p>

<p>Thu Apr  4 02:11:30 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (w_extended): check for prepended object. 	  [ruby-core:53206]
[Bug #8043]</p>

<p>Wed Mar 27 03:02:30 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_exec.c: Correct predefined macro name. This typo is introduced by 	 
r36534 and should be backported to ruby_2_0_0.</p>

<p>Wed Mar 27 02:58:44 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Merge Onigmo 0fe387da2fee089254f6b04990541c731a26757f 	  v5.13.3
[Bug#7972] [Bug#7974]</p>

<p>Wed Mar 27 02:53:53 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/document.rb: move entity_expansion_text_limit accessor to … 	*
lib/rexml/rexml.rb: … here to make rexml/text independent from 	 
REXML::Document. It causes circular require. 	* lib/rexml/document.rb
(REXML::Document.entity_expansion_text_limit): 	  deprecated. 	*
lib/rexml/document.rb (REXML::Document.entity_expansion_text_limit=): 	 
deprecated. 	* lib/rexml/text.rb: add missing require “rexml/rexml” for 	 
REXML.entity_expansion_text_limit. 	  Reported by Robert Ulejczyk.
Thanks!!! [ruby-core:52895] [Bug #7961]</p>

<p>Wed Mar 27 02:50:45 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* object.c (Init_Object): remove Module#used, which has been 	  introduced
in Ruby 2.0 by mistake.  [Bug #7916] [ruby-core:52719]</p>

<p>Mon Mar 25 02:02:15 2013  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c: edited rdoc. 	* rational.c: ditto.</p>

<p>Mon Mar 25 02:02:15 2013  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c: described syntax of string form. 	* rational.c: ditto.</p>

<p>Mon Mar 25 01:26:26 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/webrick/httpproxy.rb: Fix typos in HTTPProxyServer [Bug #8013] 	 
Patch by Nobuhiro IMAI [ruby-core:53127]</p>

<p>Mon Mar 25 01:09:48 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_compile_each): pass keyword arguments to zsuper, 	  with
current values.  [ruby-core:53114] [Bug #8008]</p>

<p>Mon Mar 25 01:05:15 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/objspace/objspace.c (count_nodes): count also newly added nodes, 	 
and fix key for unknown node.  patch by tmm1 (Aman Gupta) in 	 
[ruby-core:53130] [Bug #8014]</p>

<p>Mon Mar 25 01:00:03 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_prepend_module): check redefinition of built-in optimized 	 
methods.  [ruby-dev:47124] [Bug #7983]</p>

<p>* vm.c (rb_vm_check_redefinition_by_prepend): ditto.</p>

<p>Mon Mar 25 00:51:57 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (miniruby, ruby): move MAINLIBC because linker arguments 	 
must appear after object files with newer versions of gcc.  patch by 	 
tmm1 (Aman Gupta) in [ruby-core:53121] [Bug #8009]</p>

<p>Mon Mar 25 00:47:04 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (iseq_data_to_ary): fix condition. 	  r34303 introduces a bug to
avoid all line information from 	  a result of ISeq#to_a. This is a
regression problem from 2.0.0p0.</p>

<p>* test/ruby/test_iseq.rb: add a test of lines after ISeq#to_a.</p>

<p>Mon Mar 25 00:41:23 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb: reconstruct comma separated list values.  a 	  command
line to Windows batch file is split not only by spaces 	  and equal signs
but also by commas and semicolons.</p>

<p>Wed Mar 20 23:21:14 2013  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/rubygems/test_gem_installer.rb (test_install_extension_flat): 	 
use ruby in build directory in case ruby is not installed. 	 
[ruby-core:53265] [Bug #8058]</p>

<p>Wed Mar 20 23:17:33 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/win32ole/test_err_in_callback.rb (TestErrInCallBack#setup): 	 
allow using different root for source and build directories. 	  this may
fixes a minor problem of r39834.</p>

<p>Wed Mar 20 23:17:33 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/win32ole/test_err_in_callback.rb (TestErrInCallBack#setup): use 	 
relative path to get rid of “too long commandline” error.</p>

<p>Wed Mar 20 23:17:33 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/win32ole/test_err_in_callback.rb 	 
(TestErrInCallBack#test_err_in_callback): shouldn&#39;t create a file in 	 
the top of build directory.</p>

<p>Wed Mar 20 23:08:40 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/missing.h: removed __linux__. it&#39;s unnecessary.</p>

<p>Wed Mar 20 23:03:27 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: move OS specific header/function knowledge before 	 
automatic header tests.</p>

<p>Wed Mar 20 23:01:42 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: move header files check to the beginning of 	  “header and
library section”. 	  test rlim_t with sys/types.h and sys/time.h for MirOS
BSD. 	  sys/types.h and sys/time.h is gurded by #ifdef and the above move 	
is required for this change.</p>

<p>Wed Mar 20 22:57:27 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: move the test for -march=i486 just after 	 
RUBY_UNIVERSAL_ARCH/RUBY_DEFAULT_ARCH.</p>

<p>Wed Mar 20 22:56:07 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: change CFLAGS temporally to test 	 
ARCH_FLAG=“-march=i486”.</p>

<p>Wed Mar 20 22:54:33 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: don&#39;t define ARCH_FLAG=“-march=i486” if it causes 	 
compilation problem.</p>

<p>Wed Mar 20 22:36:41 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c: disabled _FORTIFY_SOURCE for avoid to hit glibc bug. 	  [Bug
#8080] [ruby-core:53349] 	* test/ruby/test_io.rb
(TestIO#test_io_select_with_many_files): 	  test for the above.</p>

<p>Wed Mar 20 22:34:52 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/missing.h (__syscall): moved to… 	* io.c: here. because
__syscall() is only used from io.c.</p>

<p>* include/ruby/missing.h: move “#include &lt;sys/type.h&gt;” to .… 	*
include/ruby/intern.h: here. because it was introduced for 	  fixing
NFDBITS issue. [ruby-core:05179].</p>

<p>Wed Mar 20 22:33:26 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/missing.h (struct timespec): include &lt;sys/time.h&gt;</p>

<p>Wed Mar 20 22:33:26 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: check struct timeval exist or not. 	*
include/ruby/missing.h (struct timeval): check HAVE_STRUCT_TIMEVAL 	 
properly. and don&#39;t include sys/time.h if struct timeval exist.</p>

<p>* file.c: include sys/time.h explicitly. 	* random.c: ditto. 	*
thread_pthread.c: ditto. 	* time.c: ditto. 	* ext/date/date_strftime.c:
ditto.</p>

<p>Mon Mar 18 00:12:28 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/setup_command.rb:  Don&#39;t delete non-rubygems 	
files when installing RubyGems. 	*
test/rubygems/test_gem_commands_setup_command.rb:  Test for the 	  above.</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb:  Use full path to siteconf.rb 	 
in case the extconf.rb changes directories (like memcached does).</p>

<p>* lib/rubygems/package.rb:  Remove double slash from path. 	*
test/rubygems/test_gem_package.rb:  Test for the above. 	*
test/rubygems/test_gem_package_old.rb:  ditto.</p>

<p>* lib/rubygems/source.rb:  Revert automatic HTTPS upgrade 	*
lib/rubygems/spec_fetcher.rb:  ditto. 	*
test/rubygems/test_gem_remote_fetcher.rb:  ditto. 	*
test/rubygems/test_gem_source.rb:  ditto. 	*
test/rubygems/test_gem_spec_fetcher.rb:  ditto.</p>

<p>Mon Mar 18 00:11:33 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb (Gem::Ext::ExtConfBuilder.build): 	
it is impossible to predict which file will be installed to where, 	  by
the arguments, so use intermediate destination directory always. 	  [Bug
#7698]</p>

<p>Mon Mar 18 00:11:33 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb (Gem::Ext::ExtConfBuilder.build): 	
it is impossible to predict which file will be installed to where, 	  by
the arguments, so use intermediate destination directory always. 	  [Bug
#7698]</p>

<p>Mon Mar 18 00:05:50 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/setup_command.rb:  Install .pem files. 	*
test/rubygems/test_gem_commands_setup_command.rb:  Test for the 	  above.</p>

<p>* lib/rubygems/spec_fetcher.rb:  Test HTTPS upgrade with URI::HTTPS, 	 
not URI::HTTP.  Fixes bug in automatic HTTPS upgrade. 	*
test/rubygems/test_gem_spec_fetcher.rb:  Test for the above.</p>

<p>* lib/rubygems.rb:  Version 2.0.2</p>

<p>* lib/rubygems/test_utilities.rb:  Ensure scheme and uri class match.</p>

<p>Mon Mar 18 00:03:27 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rubygems/test_require.rb:  Fix tests when &#39;a.rb&#39; exists. 	 
[ruby-trunk - Bug #7749]</p>

<p>Mon Mar 18 00:02:27 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems.rb:  Allow specification of directory permissions. 	 
[ruby-trunk - Bug #7713] 	* test/rubygems/test_gem.rb:  Test for the above.</p>

<p>Mon Mar 18 00:00:32 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rubygems/test_gem_spec_fetcher.rb:  Removed unused variable.</p>

<p>Mon Mar 18 00:00:32 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/query_command.rb:  Only fetch remote specs when 	 
showing details.  [ruby-trunk - Bug #8019]  RubyGems bug #487 	*
lib/rubygems/remote_fetcher.rb:  ditto. 	* lib/rubygems/security/policy.rb:
ditto. 	* test/rubygems/test_gem_commands_query_command.rb:  Test for the 	
above.</p>

<p>* lib/rubygems/security.rb:  Make OpenSSL optional for RubyGems. 	*
lib/rubygems/commands/cert_command.rb:  ditto.</p>

<p>* lib/rubygems/config_file.rb:  Display file with YAML error, not 	 
~/.gemrc</p>

<p>* lib/rubygems/remote_fetcher.rb:  Only create gem subdirectories when 	 
installing gems. 	* lib/rubygems/dependency_resolver.rb:  ditto. 	*
lib/rubygems/test_utilities.rb:  ditto. 	*
test/rubygems/test_gem_commands_fetch_command.rb:  Test for the 	  above.</p>

<p>* lib/rubygems/spec_fetcher.rb:  Only try to upgrade 	  <a
href="http://rubygems.org">rubygems.org</a> to HTTPS 	*
test/rubygems/test_gem_spec_fetcher.rb:  Test for the above.</p>

<p>* lib/rubygems.rb:  Update win_platform? check for JRuby compatibility.</p>

<p>* test/rubygems/test_gem_installer.rb:  Update for Ruby 1.9.2 	 
compatibility</p>

<p>Sun Mar 17 23:53:19 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems.rb:  Bump version to 2.0.1 for upcoming bugfix release</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb:  Restore ruby 1.8 compatibility 	 
for [Bug #7698] 	* test/rubygems/test_gem_installer.rb:  Ditto.</p>

<p>* lib/rubygems/package.rb:  Restore ruby 1.8 compatibility.</p>

<p>* test/rubygems/test_gem_dependency_installer.rb:  Fix warnings</p>

<p>Sun Mar 17 23:36:05 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/available_set.rb:  Undent for style</p>

<p>* lib/rubygems/dependency_installer.rb:  Pick latest prerelease gem to 	 
install.  Fixes RubyGems bug #468. 	*
test/rubygems/test_gem_dependency_installer.rb:  Test for the above.</p>

<p>* lib/rubygems/dependency_installer.rb:  Don&#39;t display “Done
installing 	  documentation” if documentation will not be installed. 	*
lib/rubygems/rdoc.rb:  ditto</p>

<p>* lib/rubygems/dependency_list.rb:  Use Array#concat for Ruby 1.x 	 
performance.</p>

<p>* lib/rubygems/installer.rb:  Use formatted program name when comparing 	 
executables.  RubyGems pull request #471 	*
test/rubygems/test_gem_installer.rb:  Test for the above.</p>

<p>* lib/rubygems/package.rb:  Use more explicit feature check to work 	 
around JRuby bug #552</p>

<p>* lib/rubygems/ssl_certs/GeoTrust_Global_CA.pem:  Added GeoTrust root 	 
certificate.</p>

<p>* test/rubygems/test_gem_source_list.rb:  Use “example” instead of real 	 
hostname</p>

<p>Sun Mar 17 23:28:44 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb (Gem::Ext::ExtConfBuilder.build): 	
clear DESTDIR so RUBYARCHDIR and RUBYLIBDIR are not be overrdden. 	  [Bug
#7698]</p>

<p>Sun Mar 17 23:26:31 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb (Gem::Ext::ExtConfBuilder.build): 	
fix for unusal cases again.  install to a temporary directory once 	  and
move instaled files to the destination directory, if it is same 	  as the
current directory.  [Bug #7698]</p>

<p>Sun Mar 17 23:22:22 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb 	 
(Gem::Ext::ExtConfBuilder.hack_for_obsolete_style_gems): remove 	  circular
dependencies in install-so too.  [ruby-core:52882] 	  [Bug #7698]</p>

<p>Sun Mar 17 23:19:34 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rubygems/ext/ext_conf_builder.rb (Gem::Ext::ExtConfBuilder.build): 	
revert use of temporary directory for build, to work some buggy 	 
extconf.rb which cannot build outside the source directory. 	 
[ruby-core:53056] [Bug #7698]</p>

<p>Sun Mar 17 23:11:35 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/ext/builder.rb:  Fix incompatibilities when installing 	 
extensions.  Patch by Nobu. 	  [ruby-trunk - Bug #7698] [ruby-trunk - Bug
#7971] 	* lib/rubygems/ext/ext_conf_builder.rb:  ditto. 	*
lib/rubygems/installer.rb:  ditto. 	*
test/rubygems/test_gem_ext_ext_conf_builder.rb:  Test for the above. 	*
test/rubygems/test_gem_installer.rb:  ditto.</p>

<p>* lib/rubygems/commands/sources_command.rb:  Prefer HTTPS over HTTP. 	*
lib/rubygems/defaults.rb:  ditto 	* lib/rubygems/dependency_resolver.rb: 
Ditto. 	* lib/rubygems/source.rb:  ditto. 	* lib/rubygems/spec_fetcher.rb: 
ditto. 	* lib/rubygems/specification.rb:  ditto. 	*
lib/rubygems/test_utilities.rb:  ditto. 	* test/rubygems/test_gem.rb:  Test
for the above. 	* test/rubygems/test_gem_commands_sources_command.rb: 
ditto. 	* test/rubygems/test_gem_dependency_resolver_api_set.rb:  ditto. 	*
test/rubygems/test_gem_remote_fetcher.rb:  ditto. 	*
test/rubygems/test_gem_source.rb:  ditto. 	*
test/rubygems/test_gem_spec_fetcher.rb:  ditto.</p>

<p>Tue Mar 12 00:56:19 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/thread/test_queue.rb (TestQueue#test_thr_kill): reduce 	 
iterations from 2000 to 250. When running on uniprocessor 	  systems, every
th.kill needs TIME_QUANTUM_USEC time (i.e. 	  100msec on posix systems).
Because, “r.read 1” is 3 steps 	  operations that 1) release GVL 2) read 3)
acquire gvl and 	  (1) invoke context switch to main thread. and then, main
	  thread&#39;s th.kill resume (1), but not (2). Thus read interrupt 	 
need TIME_QUANTUM_USEC. Then maximum iteration is 30sec/100msec 	  = 300.</p>

<p>Tue Mar 12 00:53:34 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* process.c (setup_communication_pipe): remove unused function. 	  it was
unintentionally added r39683.</p>

<p>Tue Mar 12 00:53:34 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (ARRAY_SIZE): new. 	* thread_pthread.c
(gvl_acquire_common): use low priority 	  notification for avoiding timer
thread interval confusion. 	  If we use <a href="1">timer_thread_pipe</a>,
every gvl_yield() request 	  one more gvl_yield(). It lead to thread
starvation. 	  [Bug #7999] [ruby-core:53095] 	* thread_pthread.c
(rb_reserved_fd_p): adds timer_thread_pipe_low 	  to reserved fds.</p>

<p>Tue Mar 12 00:53:34 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (rb_thread_wakeup_timer_thread_fd): add fd 	  argument
and remove hardcoded dependency of <a href="1">timer_thread_pipe</a>. 	*
thread_pthread.c (consume_communication_pipe): add fd argument. 	*
thread_pthread.c (close_communication_pipe): ditto.</p>

<p>* thread_pthread.c (timer_thread_sleep): adjust the above changes.</p>

<p>* thread_pthread.c (setup_communication_pipe_internal): factor 	  out pipe
initialize logic.</p>

<p>Tue Mar 12 00:53:34 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): factor out 	  creating
communication pipe logic into separate function. 	* thread_pthread.c
(setup_communication_pipe): new helper function. 	* thread_pthread.c
(set_nonblock): moves a definition before 	  setup_communication_pipe.</p>

<p>Tue Mar 12 00:53:34 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (consume_communication_pipe): retry when 	  read
returned CCP_READ_BUFF_SIZE.</p>

<p>Tue Mar 12 00:53:34 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (set_nonblock): new helper function for set 	 
O_NONBLOCK. 	* thread_pthread.c (rb_thread_create_timer_thread): set
O_NONBLOCK 	  to <a href="0">timer_thread_pipe</a> too.</p>

<p>Tue Mar 12 00:51:23 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (timer_thread_sleep): use poll() instead of 	 
select(). select doesn&#39;t work if <a href="0">timer_thread_pipe</a> is 	
greater than FD_SETSIZE. 	* thread_pthread.c (USE_SLEEPY_TIMER_THREAD): add
a dependency 	  against poll.</p>

<p>Tue Mar 12 00:51:23 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (USE_SLEEPY_TIMER_THREAD): use more accurate 	  ifdef
condtions.</p>

<p>Mon Mar 11 01:16:12 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (unexpand_shvar): get rid of non-portable shell 	  behavior
on OpenBSD, so no extra quotes.  [Bug #7959]</p>

<p>Mon Mar 11 01:12:50 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (IS_LABEL_POSSIBLE): allow labels for keyword arguments just 	 
after method definition without a parenthesis.  [ruby-core:52820] 	  [Bug
#7942]</p>

<p>Mon Mar 11 01:09:23 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* error.c: clarify reason for sleep in SignalException example</p>

<p>Mon Mar 11 01:09:23 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* error.c: clarify a document of SignalException. Process.kill() 	 
doesn&#39;t have any guarantee when signal will be delivered. 	  [Bug
#7951] [ruby-core:52864]</p>

<p>Mon Mar 11 01:04:54 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (str_byte_substr): don&#39;t set coderange if it&#39;s not
known. 	  [Bug #7954] [ruby-dev:47108]</p>

<p>Mon Mar 11 00:58:30 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (realclean-local): miniprelude.c is made by srcs, so it 	 
should not removed by distclean but by realclean.  [Bug #6807]</p>

<p>Mon Mar 11 00:54:30 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/depend (ARFLAGS): VisualC++ linker does not allow spaces between 	 
output option and the output file name.  [Bug #7950]</p>

<p>* enc/depend (RANLIB): set default command to do nothing, or make the 	 
entire line a label on Windows.</p>

<p>Mon Mar 11 00:50:21 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* thread.c: Document Thread::new, clean up ::fork and mention calling 	 
super if subclassing Thread</p>

<p>Mon Mar 11 00:47:47 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* configure.in (unexpand_shvar): Use the numeric comparison 	  operator
instead of &#39;==&#39; which is a ksh extention. [Bug #7941]</p>

<p>Sun Mar 10 00:01:07 2013  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: [ruby-core:52303]</p>

<p>Sat Mar  9 23:55:42 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (rb_random_ulong_limited): limit is inclusive, but generic 	 
rand method should return a number less than it, so increase for the 	 
difference.  [ruby-core:52779] [Bug #7935]</p>

<p>Sat Mar  9 23:51:58 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (rb_random_ulong_limited): fix error message for negative 	 
value.  [ruby-dev:47061] [Bug #7903]</p>

<p>Sat Mar  9 23:41:11 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* thread.c: Document ThreadGroup::Default</p>

<p>Sat Mar  9 23:31:46 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): block level control frame does not 	 
have method entry, so obtain the method entry from method top-level 	 
control frame to be compared with refined method entry. 	 
[ruby-core:52750] [Bug #7925]</p>

<p>Sat Mar  9 23:15:06 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (sigsegv): suppress unused result warning. Because 	  write(2)
is marked <em>warn_unused_result</em> on Linux glibc.</p>

<p>Sat Mar  9 23:08:43 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_set_arguments): no keyword check if any keyword rest 	 
argument exists, even unnamed.  [ruby-core:52744] [Bug #7922]</p>

<p>Sat Mar  9 22:50:28 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* array.c: Document #&lt;=&gt; return values and formatting 	* bignum.c:
ditto 	* file.c: ditto 	* object.c: ditto 	* numeric.c: ditto 	*
rational.c: ditto 	* string.c: ditto 	* time.c: ditto</p>

<p>Sat Mar  9 22:45:01 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* array.c (rb_ary_diff, rb_ary_and, rb_ary_or): Document return order 	 
[RubySpec #7803]</p>

<p>Sat Mar  9 22:38:26 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* object.c (rb_obj_comp): Documenting Object#&lt;=&gt; return values 	 
Patch by Stefan Rusterholz</p>

<p>Sat Mar  9 22:35:22 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (file_s_fnmatch, fnmatch_brace): encoding-incompatible pattern 	 
and string do not match, instead of exception.  [ruby-dev:47069] 	  [Bug
#7911]</p>

<p>Sat Mar  9 22:18:43 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/test_rbconfig.rb (TestRbConfig): fix r39372. 	  It must see
RbConfig::CONFIG instead of CONFIG.</p>

<p>Sat Mar  9 22:18:43 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/test_rbconfig.rb (TestRbConfig): skip user defined values by 	 
configuration options.  [Bug #7902]</p>

<p>Sat Mar  9 22:07:53 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document.entity_expansion_text_limit): 	 
fix a typo in comment in r39384.</p>

<p>Sat Mar  9 21:52:19 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* numeric.c: Examples and formatting for Numeric and Float 	  Based on a
patch by Zach Morek and Oren K of newhaven.rb 	  [Github
documenting-ruby/ruby#5]</p>

<p>Sat Mar  9 21:46:41 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/globals.rdoc:  Document what setting $DEBUG does.</p>

<p>* doc/globals.rdoc:  Added pointer to $-d for full documentation.</p>

<p>Sat Mar  9 21:45:38 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/globals.rdoc:  Document what setting $VERBOSE does.  [Bug #7899]</p>

<p>* doc/globals.rdoc:  Added pointer to $-w and $-v for full 	 
documentation.</p>

<p>Sat Mar  9 21:29:45 2013  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* signal.c (ruby_abort): fix typo in r39354 [Bug #5014]</p>

<p>Sat Mar  9 21:29:45 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* signal.c (check_stack_overflow): extract duplicated code and get rid 	 
of declaration-after-statement.  [Bug #5014]</p>

<p>Sat Mar  9 21:29:45 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (sigsegv): avoid to use async signal unsafe functions 	  when
nested sigsegv is happen. 	  [Bug #5014] [ruby-dev:44082]</p>

<p>Sat Mar  9 21:25:45 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* file.c (rb_group_member): added an error check. SUS says, 	 
getgroups(small_value) may return EINVAL.</p>

<p>Sat Mar  9 21:23:36 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* process.c (RB_MAX_GROUPS): moved to 	* internal.h (RB_MAX_GROUPS): here.</p>

<p>* file.c (rb_group_member): use RB_MAX_GROUPS instead of 	 
RUBY_GROUP_MAX. They are the same.</p>

<p>Sat Mar  9 21:15:39 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* file.c (access_internal): removed. 	* file.c (rb_file_readable_real):
use access() instead of 	  access_internal(). 	* file.c
(rb_file_writable_real): ditto. 	* file.c (rb_file_executable_real): ditto.</p>

<p>Wed Mar  6 22:13:38 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>merge revision(s) 39297: [Backport #8032]</p>

<p>* tool/mkconfig.rb: clear exec_prefix which may differ from prefix, 	 
before expanding rubyarchdir to remove prefix.</p>

<p>Tue Mar  5 01:20:39 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: add interaction when only ChangeLog is modified.</p>

<p>Tue Mar  5 01:03:16 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* file.c (rb_group_member): get rid of NGROUPS dependency. 	  [Bug #7886]
[ruby-core:52537]</p>

<p>Tue Mar  5 00:16:56 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl.c (class OpenSSL):  Use only inner parenthesis in 	 
create_extension examples.</p>

<p>Tue Mar  5 00:16:56 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl.c (class OpenSSL):  Fixed ExtensionFactory example. 	 
Patch by Richard Bradley.  [ruby-trunk - Bug #7551]</p>

<p>Mon Mar  4 23:53:18 2013  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>(merge r39291) 	* configure.in (opt-dir): remove debug print.</p>

<p>Mon Mar  4 23:42:34 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/psych/lib/psych/y.rb: Document Kernel#y by Adam Stankiewicz 	 
[Github tenderlove/psych#127]</p>

<p>Mon Mar  4 23:37:14 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb: remove prefix from rubyarchdir. 	  r39267 expands
variables, it changes expansion timing, 	  breaks <a
href=""includedir"">RbConfig::CONFIG</a> and building 	  extension
libraries with installed ruby.</p>

<p>Sun Mar  3 02:45:13 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (ENV_IN_HEAP_P): fix off-by-one error.</p>

<p>Sun Mar  3 02:39:01 2013  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/ruby/test_thread.rb: fixed typo 	  patched by Hiroki Matsue via <a
href="https://github.com/ruby/ruby/pull/248">github.com/ruby/ruby/pull/248</a></p>

<p>Sun Mar  3 02:22:56 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (include_modules_at): detect cyclic prepend with original 	 
method table.  [ruby-core:52205] [Bug #7841]</p>

<p>Sun Mar  3 02:16:24 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c: call method_removed hook on called class, not on 	 
prepending iclass.  [ruby-core:52207] [Bug #7843]</p>

<p>Sun Mar  3 01:57:50 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (warnflags): disable -Werror by default unless 	 
development.  [ruby-core:52131] [Bug #7830]</p>

<p>Wed Feb 27 00:20:43 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_process.rb (test_setsid): Added a workaround for 	  MacOS
X. Patch by nagachika. [Bug #7826] [ruby-core:52126]</p>

<p>Sun Feb 24 15:16:00 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Removed duplicate Accept-Encoding in Net::HTTP#get. 	 
[ruby-trunk - Bug #7924] 	* test/net/http/test_http.rb:  Test for the
above.</p>

<p>Wed Feb 20 14:23:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* thread.c: Grammar for #backtrace_locations and ::handle_interrupt</p>

<p>Fri Feb 22 11:10:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* enum.c (Enumerable#chunk: Improved examples, grammar, and formatting 	 
Patch by Dan Bernier and Rich Bruchal of newhaven.rb 	  [Backport #7926]</p>

<p>Fri Feb 22 02:33:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/abbrev.rb: Add words parameter to Abbrev::abbrev 	  Patch by Devin
Weaver [Backport #7927]</p>

<p>Wed Feb 20 13:37:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/pty/pty.c: Documentation for the PTY module [Backport #7928]</p>

<p>Wed Feb 20 12:18:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* object.c: Document Data class by Matthew Mongeau [Backport #7929]</p>

<p>Wed Feb 20 11:50:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/mutex_m.rb: Add rdoc for Mutex_m module [Backport #7930]</p>

<p>Tue Feb 19 12:30:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* object.c: rdoc formatting for Kernel#Array() [Backport #7931] 	*
array.c: Add rdoc for Array() method to Creating Arrays section</p>

<p>Sat Feb 23 16:51:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* thread.c: Documentation for Thread#backtrace_locations 	  [Backport
#7932]</p>

<p>Sat Feb 23 16:05:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* vm.c: Typo in ObjectSpace::WeakMap overview [Backport #7933]</p>

<p>Sat Feb 23 16:00:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* thread.c: Improved rdoc for ::handle_interrupt, ::pending_interrupt? 	 
and #pending_interrupt? [Backport #7934]</p>

<p>Sat Feb 23 14:19:51 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (HAVE_RB_SCAN_ARGS_OPTIONAL_HASH): for 	 
rb_scan_args() optional hash feature.  [Bug #7861]</p>

<p>Sat Feb 23 13:03:22 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/ipaddr.rb (IPAddr#in6_addr): Fix a typo with the closing 	 
parenthesis.</p>

<p>Sat Feb 23 13:03:22 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/ipaddr.rb (IPAddr#in6_addr): Fix the parser so that it can 	 
recognize IPv6 addresses with only one edge 16-bit piece 	  compressed,
like [::2:3:4:5:6:7:8] or [1:2:3:4:5:6:7::]. 	  [Bug #7477]</p>

<p>Sat Feb 23 13:00:49 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* configure.in (LIBRUBY_DLDFLAGS): Fix a bug where –with-opt-dir 	 
options given were not reflected to LIBRUBY_DLDFLAGS on many 	  platforms
including Linux and other GNU-based systems, NetBSD, 	  AIX and BeOS.</p>

<p>Sat Feb 23 13:00:07 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* configure.in: Fix a bug introduced in r38342 that the cflagspat 	 
substitution is messed up by the way CFLAGS and optflags are 	  modified,
which affected FreeBSD and NetBSD/amd64 when 	  configured to use
libexecinfo.  This bug resulted in CFLAGS and 	  CXXFLAGS in
RbConfig::CONFIG having warnflags expanded in them, 	  forcing third-party
C/C++ extensions to follow what warnflags 	  demands, like ANSI/ISO-C90
conformance.  ref [Bug #7101]</p>

<p>Sat Feb 23 12:58:32 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb: remove extra topdir in VPATH, which was in 	 
win32/Makefile.sub for some reason and moved from there. 	 
[ruby-dev:46998] [Bug #7864]</p>

<p>Tue Feb 23 12:07:00 2013  Kenta MURATA  &lt;mrkn@mrkn.jp&gt;</p>

<p>* backport r39321 from trunk. [ruby-core:51777] [Bug #7761]</p>

<p>* ext/bigdecimal/bigdecimal.gemspec: bump to 1.2.0. 	  [ruby-core:51777]
[Bug #7761]</p>

<p>Sat Feb 23 08:57:46 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* backport r39410 from trunk</p>

<p>* doc/NEWS-*: Update NEWS from their respective branches</p>

<p>Sat Feb 23 08:14:43 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* backport r39400-r39407 from trunk.</p>

<p>* NEWS: many additions</p>

<p>* object.c: Add doc for Module.prepended</p>

<p>Sat Feb 23 06:07:04 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/installer.rb (build_extensions):  Create extension 	 
install destination before building extension.  Patch by Kenta Murata. 	 
[ruby-trunk - Bug #7897] 	* test/rubygems/test_gem_installer.rb:  Test for
the above.</p>

<p>Sat Feb 23 04:34:44 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* NEWS: pending_interrupt? is both instance and singleton method</p>

<p>Sat Feb 23 02:49:10 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* NEWS: Add Thread#pending_interrupt? and Thread.handle_interrupt</p>

<p>Fri Feb 22 19:22:05 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document.entity_expansion_text_limit): 	 
new attribute to read/write entity expansion text limit.  the default 	 
limit is 10Kb.</p>

<p>* lib/rexml/text.rb (REXML::Text.unnormalize): check above attribute.</p>

<p>Thu Feb 21 05:03:38 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/update_command.rb:  Create the installer after 	 
options are processed.  [ruby-trunk - Bug #7779] 	*
test/rubygems/test_gem_commands_update_command.rb:  Test for the 	  above.</p>

<p>Thu Feb 21 04:54:14 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/installer.rb:  Use gsub instead of gsub! to avoid 	 
altering @bin_dir.  Fixes tests on windows.  [ruby-trunk - Bug #7885]</p>

<p>Thu Feb 21 03:16:37 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* NEWS: Floats are frozen too</p>

<p>Thu Feb 21 03:10:53 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* NEWS: Add that Fixnums and Bignums are frozen</p>

<p>Wed Feb 20 17:02:12 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_eval.c (vm_call0_body): check interrupts after method dispatch 	 
from C methods. [Bug #7878]</p>

<p>Wed Feb 20 08:05:25 2013 Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compar.c (rb_invcmp): compare by inversed comparison, with preventing 	 
from infinite recursion.  [ruby-core:52305] [Bug #7870]</p>

<p>* string.c (rb_str_cmp_m), time.c (time_cmp): get rid of infinite 	 
recursion.</p>

<p>Tue Feb 19 15:49:58 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (unexpand_shvar): regularize a shell variable by 	 
unexpanding shell variables in it.</p>

<p>* configure.in (shvar_to_cpp): do not substitute exec_prefix itself 	 
with RUBY_EXEC_PREFIX, which cause recursive definition. 	 
[ruby-core:52296] [Bug #7860]</p>

<p>* configure.in: unexpand arch sitearch and exec_prefix values, so 	 
directly specified bindir, libdir, rubyprefix, etc can be properly 	 
substituted.  [ruby-core:52296] [Bug #7860]</p>

<p>Tue Feb 19 14:08:46 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* backport r39307 from trunk.  [Bug #7880]</p>

<p>* lib/rubygems/installer.rb:  Fixed placement of executables with 	 
–user-install.  [ruby-trunk - Bug #7779]</p>

<p>* test/rubygems/test_gem_installer.rb:  Test for above.</p>

<p>Tue Feb 19 13:57:26 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* backport r39247 from trunk. [Bug #7853]</p>

<p>* lib/rdoc.rb:  Update to release version of 4.0.0</p>

<p>* lib/rubygems.rb:  Update to release version of 2.0.0</p>

<p>Tue Feb 19 12:25:27 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (config.status): site and vendor directories 	 
should use sitearch, not arch.  [ruby-dev:46964] [Bug #7823]</p>

<p>Tue Feb 19 07:51:01 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* backport r39275 from trunk. [ruby-dev:46994] [Bug #7774]</p>

<p>* proc.c (rb_binding_new_with_cfp): create binding object even if 	  the
frame is IFUNC. But return a ruby-level binding to keep 	  compatibility. 	
This patch fix degradation introduced from r39067. 	  [Bug #7774]
[ruby-dev:46960]</p>

<p>* test/ruby/test_settracefunc.rb: add a test.</p>

<p>Sat Feb 16 20:43:43 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* backport r39276 from trunk. [ruby-dev:46997] [Bug #7825]</p>

<p>* vm.c (rb_thread_mark): mark a working Proc of bmethod 	  (a method
defined by define_method) even if the method was removed. 	  We could not
trace working Proc object which represents the body 	  of bmethod if the
method was removed (alias/undef/overridden). 	  Simply, it was mark miss. 	
This patch by Kazuki Tsujimoto. [Bug #7825]</p>

<p>NOTE: We can brush up this marking because we do not need to mark 	 
`me&#39; on each living control frame. We need to mark `me&#39;s 	  only if
`me&#39; was free&#39;ed. This is future work after Ruby 2.0.0.</p>

<p>* test/ruby/test_method.rb: add a test.</p>

<p>Fri Feb 15 00:49:32 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Removed OpenSSL dependency from Net::HTTP.</p>

<p>* test/net/http/test_http.rb:  Remove Zlib dependency from tests. 	*
test/net/http/test_http_request.rb:  ditto.</p>

<p>Fri Feb 15 00:49:32 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http:  Do not handle Content-Encoding when the user sets 	 
Accept-Encoding.  This allows users to handle Content-Encoding for 	 
themselves.  This restores backwards-compatibility with Ruby 1.x. 	 
[ruby-trunk - Bug #7831] 	* lib/net/http/generic_request.rb:  ditto. 	*
lib/net/http/response.rb:  ditto 	* test/net/http/test_http.rb:  Test for
the above. 	* test/net/http/test_http_request.rb:  ditto. 	*
test/net/http/test_httpresponse.rb:  ditto.</p>

<p>Thu Feb 14 13:17:10 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* Backport r39168 Warning about TracePoint events to 2.0.0 	 
[ruby-core:52073] [Bug #7815]</p>

<p>* vm_trace.c: note about TracePoint events set</p>

<p>Thu Feb 14 07:04:13 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* Backport r39213 from trunk [ruby-trunk - Bug #7383]</p>

<p>* lib/rubygems.rb:  Return BINARY strings from Gem.gzip and Gem.gunzip. 	 
Fixes intermittent test failures.  RubyGems issue #450 by Jeremey 	 
Kemper. 	* test/rubygems/test_gem.rb:  Test for the above.</p>

<p>Thu Feb 14 07:01:12 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* Backport part of r39166 from trunk [ruby-trunk - Bug #7809]</p>

<p>* lib/rubygems/package.rb:  Include checksums.yaml.gz signatures for 	 
verification. 	* test/rubygems/test_gem_package.rb:  Test for the above.</p>

<p>Wed Feb 13 15:34:21 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json: merge JSON 1.7.7. 	  This includes security fix.
[CVE-2013-0269] 	  <a
href="https://github.com/flori/json/commit/d0a62f3ced7560daba2ad546d83f0479a5ae2cf2">github.com/flori/json/commit/d0a62f3ced7560daba2ad546d83f0479a5ae2cf2</a>
	  <a
href="https://groups.google.com/d/topic/rubyonrails-security/4_YvCpLzL58/discussion">groups.google.com/d/topic/rubyonrails-security/4_YvCpLzL58/discussion</a></p>

<p>Sat Feb  9 21:13:35 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* backport r39167 from trunk. [ruby-core:52059] [Bug #7812]</p>

<p>* BSDL: update copyright notice for 2013.</p>

<p>Fri Feb  8 19:56:54 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_dup): reverted r39004.  see [Bug #7768], and 	  release
manager finally decided to revert it.</p>

<p>Fri Feb  8 16:09:45 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (rb_ensure): preserve errinfo across ensure proc before 	 
JUMP_TAG().  [ruby-core:52022] [Bug #7802]</p>

<p>Fri Feb  8 16:08:28 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_separately): check also terminating 	 
signal not only if core dumped.</p>

<p>Fri Feb  8 13:12:04 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/generator/darkfish.rb:  Set encoding on output template to 	 
user-specified encoding. 	* test/rdoc/test_rdoc_generator_darkfish.rb: 
Test for above.</p>

<p>* lib/rdoc.rb:  Bump version</p>

<p>Fri Feb  8 11:53:33 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/security/policy.rb:  Raise proper exceptions when 	 
verifying unsigned gems (instead of crashing). 	*
test/rubygems/test_gem_security_policy.rb:  Tests for the above.</p>

<p>Fri Feb  8 10:44:44 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rubygems/test_gem_dependency_installer.rb:  Improve coverage of 	 
–install-dir feature of gem install.</p>

<p>Fri Feb  8 10:11:09 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/config_file.rb:  Add missing require for 	 
user_interaction.rb</p>

<p>* lib/rubygems/dependency_installer.rb:  Minor refactor for clarity.</p>

<p>Fri Feb  8 09:35:17 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#configuration): set all ruby names. 	  hdrdir
now needs RUBY_VERSION_NAME.</p>

<p>Fri Feb  8 08:58:26 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/package/old.rb:  Fix loading old format gems on ruby 	 
1.8.  This commit is only so trunk and rubygems master have the same 	 
code.</p>

<p>Fri Feb  8 08:53:27 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: fixing string quotation 	 
when dumping Ruby strings. Thanks Ingy</p>

<p>* test/psych/test_psych.rb: appropriate tests.</p>

<p>* test/psych/test_yaml.rb: ditto</p>

<p>Fri Feb  8 08:50:42 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: change output reference 	 
ids to be sequential numbers.</p>

<p>Fri Feb  8 07:47:56 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/package/old.rb:  Disallow installation of old-format 	 
gems when a security policy is active. 	*
test/rubygems/test_gem_package_old.rb:  Test for above.</p>

<p>Fri Feb  8 07:34:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/net/http.rb (HTTP.post_form): Fix module scope in documentation 	 
Patch by David Albert [Bug #7794] [ruby-core:51955]</p>

<p>Fri Feb  8 07:33:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* compar.c (cmp_equal): Document ignored exception and return false 	  By
Makoto Kishimoto [Bug #7790] [ruby-dev:46925] [ruby-dev:46910]</p>

<p>Fri Feb  8 07:17:00 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/dependency_installer.rb:  Only install local gems if 	 
they end in &#39;.gem&#39;.  Fixes github rubygems issue #407. 	*
test/rubygems/test_gem_dependency_installer.rb:  Test for the above.</p>

<p>Fri Feb  8 00:02:48 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (obj2gid): use getgrnam_r() only if getgrnam_r() and 	 
_SC_GETGR_R_SIZE_MAX is available. 	  MirOS BSD (MirBSD 10 GENERIC#1382
i386) have getgrnam_r() but 	  no _SC_GETGR_R_SIZE_MAX. 	  (obj2uid): use
getpwnam_r() only if getpwnam_r() and 	  _SC_GETPW_R_SIZE_MAX is available.
	  This is consistency for obj2gid. 	  MirOS BSD have neither getpwnam_r()
nor _SC_GETPW_R_SIZE_MAX.</p>

<p>Thu Feb  7 22:01:18 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: define linker for shared library on MirOS BSD.</p>

<p>Thu Feb  7 21:09:23 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_config_file.rb 	 
(TestGemConfigFile#test_check_credentials_permissions): skip on 	  Windows.
see [Bug #7784] [ruby-core:51864] and r39070.</p>

<p>Thu Feb  7 20:52:40 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (config.status): added variables which were 	 
missing at r39130.</p>

<p>Thu Feb  7 15:33:17 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#merge_libs): insert following reversal 	 
ordered elements just after the duplicated element, not overwriting 	 
successive elements.  [ruby-core:50314] [Bug #7467]</p>

<p>Thu Feb  7 14:56:15 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/package.rb:  Ensure digests are generated for signing. 	*
test/rubygems/test_gem_package.rb:  Test for the above.</p>

<p>* lib/rubygems/security/policy.rb:  Ensure digests are present when 	 
verifying a gem and match the number of signatures bidirectionally. 	*
test/rubygems/test_gem_security_policy.rb:  Test for the above.</p>

<p>* lib/rubygems.rb:  Documentation improvements (by zzak)</p>

<p>Thu Feb  7 05:52:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/pty/README: Remove static documentation file 	* ext/pty/pty.c: Add
License to PTY module overview</p>

<p>Thu Feb  7 02:31:10 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* vm_insnhelper.c: attr_writer should return its argument [Bug #7773]</p>

<p>* test/ruby/test_basicinstructions.rb: Test for above</p>

<p>Thu Feb  7 01:35:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/security.rdoc: Link to japanese version of CVE page patch by 	 
nagachika</p>

<p>Wed Feb  6 23:30:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/pty/README.expect: Removed static documentation file 	*
ext/pty/lib/expect.rb: Documentation for IO#expect</p>

<p>Wed Feb  6 22:25:00 2013  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* hash.c (env_reject_bang): hide keys array from ObjectSpace 	* hash.c
(env_select_bang): ditto</p>

<p>Wed Feb  6 17:33:01 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (multiarch): add option to move architecture dependent 	 
directories.  [Feature #6111]</p>

<p>* template/ruby.pc.in: add arch dependent paths.</p>

<p>* configure.in (rubyarchhdrdir, sitearchhdrdir, vendorarchhdrdir): add 	 
options to customize architecture dependent header directories.</p>

<p>* configure.in (rubyarchprefix, sitearchdir, vendorarchdir): add 	 
options to customize architecture dependent library directories.</p>

<p>* template/ruby.pc.in, tool/mkconfig.rb, tool/rbinstall.rb: use 	 
configured values.</p>

<p>* tool/mkconfig.rb: expand rubyarchdir to extract prefix.</p>

<p>* configure.in (RUBY_VERSION_NAME), template/ruby.pc.in: add 	 
substitution and define.</p>

<p>* configure.in, version.c: parametric architecture name for paths.</p>

<p>* configure.in (shvar_to_cpp): convert sh variable references 	  by
replacing with string literal forms in cpp.</p>

<p>Wed Feb  6 17:05:26 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc:  Import RDoc 4.0.0.rc.2</p>

<p>Mon Feb  4 02:22:49 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_process.rb (test_setsid): ensure to call 	 
Process.wait(). Reported by George Koehler. Thanks.</p>

<p>Mon Feb  4 02:18:00 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_process.rb (test_setsid): skip when platform is 	 
OpenBSD. Contributed from George Koehler. 	  [Bug #7789] [ruby-core:51889]</p>

<p>Wed Feb  6 13:35:20 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (rb_method_entry_location, rb_<code>mod,obj</code>_method_location): new 	 
functions to obtain source location of method definition.</p>

<p>* vm_method.c (rb_obj_respond_to): show the location of old style 	 
respond_to? method.</p>

<p>Wed Feb  6 13:03:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/security.rdoc: Add link to CVEs on ruby-lang.org/en/security</p>

<p>Wed Feb  6 12:49:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* NEWS: Add note about removal of CSV::load and CSV::dump from r39077</p>

<p>Wed Feb  6 05:57:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/racc/parser.rb: Hide copyright notice from Racc doc</p>

<p>Wed Feb  6 05:50:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/rubygems/*: Removed outdated documentation files 	*
lib/rubygems/LICENSE.txt: Include license file 	* lib/rubygems.rb: Move Gem
module documentation so rdoc can parse it 	  and link to LICENSE.txt 	*
lib/rubygems/*: Hide useless documentation from Gem module rdoc</p>

<p>Wed Feb  6 03:45:19 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/security.rdoc: Remove documentation for unsafe CSV.load which 	  was
deleted in r39077</p>

<p>Wed Feb  6 03:27:19 2013  James Edward Gray II 
&lt;james@graysoftinc.com&gt;</p>

<p>* lib/csv.rb: Remove the dangerous serialization feature.</p>

<p>Wed Feb  6 00:56:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb.rb: Remove example from restrictions, it works [Github #246] 	 
Based on patch by Ryunosuke SATO</p>

<p>Wed Feb  6 00:46:53 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (rb_vm_stack_to_heap): call rb_vm_get_binding_creatable_next_cfp 	 
instead of rb_vm_get_ruby_level_next_cfp to prevent a segfault by 	 
calling Kernel#callcc. See r39067 for more details. 	  [ruby-dev:46908]
[ruby-trunk - Bug #7774]</p>

<p>* test/ruby/test_settracefunc.rb: add a test.</p>

<p>Tue Feb  5 18:48:00 2013  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* doc/security.rdoc: add regex, eval and drb sections</p>

<p>Tue Feb  5 17:24:02 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/servlet.rb:  Fixed root search paths, filesystem paths 	 
instead of HTTP paths were returned. 	* test/rdoc/test_rdoc_servlet.rb: 
Test for above.</p>

<p>Tue Feb  5 16:37:00 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/config_file.rb:  Ignore permissions check on windows. 	 
Windows writes 0600 file as 0644 permissions making the check 	  useless.</p>

<p>Tue Feb  5 16:25:25 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_obj_respond_to): drop optional include_all flag if 	 
respond_to? method is defined in old style.  [Bug #7722]</p>

<p>Tue Feb 05 15:04:34 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* proc.c (rb_binding_new_with_cfp): permit to create binding object 	  of
IFUNC frame. 	  When `rb_binding_new_with_cfp()&#39; is called, VM finds
out the first 	  normal (has iseq) frame and create a binding object of
this frame 	  and create Env objects. `ep&#39;s of related frames are
updated 	  (`ep&#39;s point Env object managed spaces). 	  However,
`ep&#39; of skipped IFUNC frame was not updated and 	  old invalid `ep&#39;
was remained. It causes serious problems. 	  To solve this issue, permit
IFUNC to create binding. 	  (Maybe there is no problem on it) 	 
[ruby-dev:46908] [ruby-trunk - Bug #7774]</p>

<p>* test/ruby/test_settracefunc.rb: add a test.</p>

<p>* vm.c (rb_vm_get_binding_creatable_next_cfp), vm_core.h: added.</p>

<p>* vm_trace.c: fix to use `rb_vm_get_binding_creatable_next_cfp()&#39;.</p>

<p>Tue Feb  5 14:43:15 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix.rb: Fix error message, patch by pypypy [Bug #7777]</p>

<p>Tue Feb  5 14:36:04 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c (fix_pow): Handle special cases when base is 0, -1 or +1 	 
[Bug #5713] [Bug #5715]</p>

<p>* rational.c (nurat_expt): ditto</p>

<p>Tue Feb  5 13:27:53 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (rawmode_opt): use default values by `stty 	 
raw`.</p>

<p>Tue Feb  5 12:50:47 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* range.c: Use div instead of / for bsearch</p>

<p>* test/ruby/test_range.rb: Test showing bug when requiring mathn</p>

<p>Tue Feb  5 12:48:38 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c: Use to_enum for Enumerable methods returning 	 
Enumerators. 	  This makes Lazy#cycle no longer needed, so it was removed.
	  Make Enumerator#chunk and slice_before return lazy Enumerators. 	  [Bug
#7715]</p>

<p>* internal.h: Remove ref to rb_enum_cycle_size; no longer needed</p>

<p>* enum.c: Make enum_cycle_size static.</p>

<p>* test/ruby/test_lazy_enumerator.rb: Test for above</p>

<p>Tue Feb  5 12:48:10 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c: Finalize and document Lazy.new. [Bug #7248] 	  Add
Lazy#to_enum and simplify Lazy#size.</p>

<p>* test/ruby/test_lazy_enumerator.rb: tests for above</p>

<p>Tue Feb  5 11:35:35 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/push_command.rb:  Fixed credential download for 	 
`gem push –host` 	* lib/rubygems/gemcutter_utilities.rb:  ditto. 	*
test/rubygems/test_gem_commands_push_command.rb:  Test for the above. 	*
test/rubygems/test_gem_gemcutter_utilities.rb:  ditto.</p>

<p>* lib/rubygems/config_file.rb:  Abort if the `gem push` credentials 	 
file has insecure permissions. 	* test/rubygems/test_gem_config_file.rb: 
Test for the above.</p>

<p>* lib/rubygems/ext/builder.rb:  Do not look for Gemfile, Isolate, etc. 	 
while building gem extensions.</p>

<p>* lib/rubygems/package.rb:  Unset spec and files list if a gem&#39;s 	 
signatures cannot be verified. 	* test/rubygems/test_gem_package.rb:  Test
for the above.</p>

<p>* lib/rubygems/specification.rb:  Reduce use of eval. 	*
lib/rubygems/test_case.rb:  ditto.</p>

<p>* test/rubygems/test_gem_specification.rb:  Test setting 	 
specification_version for legacy gems.  Dup Gem.ruby before 	  untainting
in case it&#39;s frozen.</p>

<p>* lib/rubygems.rb:  Reduce use of eval.  Only read files when looking 	 
for Gemfile, Isolate, etc. 	* test/rubygems/test_gem.rb:  Test for the
above.</p>

<p>Tue Feb  5 10:15:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/security.rdoc: Wrap security guide at 80 columns</p>

<p>Tue Feb  5 10:15:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/security.rdoc: Grammatical error on security guide 	  Patch by Josh
Bassett [Github fixes #245]</p>

<p>Tue Feb  5 10:00:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/racc/parser.rb: Update #do_parse and #yyparse from upstream 	  See
[Github tenderlove/racc@7d954b5]</p>

<p>Tue Feb  5 09:55:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/racc: Merge Racc documentation downstream, add grammar ref file</p>

<p>Tue Feb  5 08:03:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb.rb, lib/irb/ext/save-history.rb: Add documentation on how to 	 
enabled irb history [ruby-core:51347] [Bug #7679]</p>

<p>Tue Feb  5 07:35:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb.rb, lib/irb/context.rb: Add documentation on how to enable 	 
auto-indentation and autocompletion using irbrc and irb_context 	 
[ruby-core:51209] [Bug #7642] and [ruby-core:51348] [Bug #7680]</p>

<p>Tue Feb  5 05:20:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/standard_library.rdoc: Document list of libraries and extensions 	 
and their purpose or short description 	* lib/README: Remove lib/README in
favor of doc/standard_library.rdoc</p>

<p>Tue Feb  5 04:40:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/json/lib/json.rb: Move module overview definition for rdoc</p>

<p>Tue Feb  5 03:00:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/tracer.rb: Move class overview definition and reformat</p>

<p>Mon Feb  4 15:10:10 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (rawmode_opt): initialize options for the 	 
case all options are not given.</p>

<p>Mon Feb  4 12:44:13 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_dump.c (control_frame_dump): capitalize prefix of `ep&#39; 	  if
`ep&#39; points an env object.</p>

<p>Mon Feb  4 04:20:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/English.rb: Add English module for RDoc to parse, then 	 
remove_const to avoid confusion. Include full list of aliases and 	  their
associated global variable.</p>

<p>Mon Feb  4 02:40:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/yaml.rb (YAML::EngineManager): Documentation for #yamler and 	 
#yamler= for using the removed Syck gem as the YAML::ENGINE</p>

<p>Sun Feb  3 16:54:27 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/io-console.gemspec: bump.  [Bug #7762]</p>

<p>* test/io/console/test_io_console.rb (test_stringio_getch): use more 	 
descriptive assertions.</p>

<p>* ext/io/console/console.c (rawmode_opt): min is minimum characters, 	 
not tenths.</p>

<p>Sun Feb  3 16:13:00 2013  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* doc/security.rdoc: add first cut at a Ruby security document</p>

<p>Sun Feb  3 10:25:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* random.c: Document range argument for Kernel#rand. 	  [ruby-core:51794]
[Bug #7770]</p>

<p>Sun Feb  3 10:00:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* numeric.c: Document Float constants [ruby-core:51484] [Bug #7709]</p>

<p>Sun Feb  3 09:38:44 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/profiler.rb (PROFILE_CALL_PROC, PROFILE_RETURN_PROC): add b_call 	 
and b_return to profile block calls.</p>

<p>* lib/profiler.rb (PROFILE_CALL_PROC, PROFILE_RETURN_PROC): split 	 
PROFILE_PROC for call and return events.</p>

<p>Sat Feb  2 14:32:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/minitest/mock.rb, lib/minitest/hell.rb: nodoc top-level module</p>

<p>Sat Feb  2 14:05:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/debug.rb: Documentation for DEBUGGER__ class methods based on 	 
patch by Vincent Batts [ruby-core:51253]</p>

<p>Sat Feb  2 13:37:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/net/smtp.rb: Fix rdoc title for Net::SMTP</p>

<p>Sat Feb  2 13:32:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/net/pop.rb: Fix rdoc title for Net::POP3</p>

<p>Sat Feb  2 13:00:11 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* lib/gserver.rb (GServer#start): fix a timing issue.  patch from 	 
Charles Nutter.  [Bug #7081]</p>

<p>Sat Feb  2 12:36:54 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* lib/fileutils.rb (copy_entry, wrap_traverse): preserve attributes of 	 
directories on FileUtils.cp_r.  The fix was proposed by Jan 	  Wedekind. 
[Bug #7246]</p>

<p>* test/fileutils/test_fileutils.rb: add a test for above.</p>

<p>Sat Feb  2 12:30:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/uri/ftp.rb (URI::FTP.new2): nodoc method from r39013 [Bug #7301]</p>

<p>Sat Feb  2 12:15:36 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* lib/uri/ftp.rb (URI::FTP.new2): remove the rdoc because it is not 	 
well tested yet.  [Bug #7301]</p>

<p>Sat Feb  2 12:07:41 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* ChangeLog: Forgot to add a reference to the ChangeLog of the 	  previous
commit.</p>

<p>Sat Feb  2 12:05:18 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* lib/fileutils.rb: chmod/chmod_R with a string mode (e.g., “+x”) 	 
caused error in verbose mode.  [Bug #7373]</p>

<p>* test/fileutils/test_fileutils.rb: add a test for above.</p>

<p>Sat Feb  2 11:44:42 2013  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* lib/English.rb: Remove some confusing words from rdoc.  [Bug #7406]</p>

<p>Sat Feb  2 10:17:12 2013  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* NEWS: add keyword arguments.</p>

<p>Sat Feb  2 07:45:44 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* proc.c (proc_curry): Fix arity check [Bug #5747]</p>

<p>* test/ruby/test_proc.rb: Test for above</p>

<p>Sat Feb  2 07:44:15 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* proc.c: Add <code>*</code>_min_max_arity and refactor. 	  [Bug #7765]</p>

<p>* test/ruby/test_proc.rb: Fix wrong test</p>

<p>Fri Feb  2 00:46:00 2013  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* marshal.c: add security considerations to marshal overview, refer to 	 
overview from Marshal.load documentation [#7759]</p>

<p>Fri Feb  1 23:04:00 2013  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* array.c (rb_ary_dup): make returned array the same class as the original
	  array [Bug #7768] [ruby-core:51792] 	* test/ruby/test_array.rb (class
TestArray): add test</p>

<p>Fri Feb  1 16:35:34 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (r_object0): prohibit setting instance variables of 	 
existing class/module.</p>

<p>Fri Feb  1 14:34:29 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/readline/extconf.rb, ext/readline/readline.c: check 	 
RL_PROMPT_START_IGNORE and RL_PROMPT_END_IGNORE directly in 	  readline.c. 
Patch by Zachary Scott.  [Bug #7397] [ruby-core:49561]</p>

<p>Thu Jan 31 21:55:00 2013  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* marshal.c (marshal_load): Add documentation warning against using 	 
Marshal.load on untrusted data [Bug #7759] [ruby-core:51765]</p>

<p>Thu Jan 31 16:33:27 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (local_push_gen): no assigned but unused variable warnings 	  in
eval as well as -e.  [Feature #7730] [ruby-core:51580]</p>

<p>Wed Jan 30 12:30:08 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_signal.rb (test_trap_puts): Fix typo. “sync” 	  should be
“STDOUT.sync”.</p>

<p>Thu Jan 31 15:39:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* string.c (rb_str_aset_m): Documentation for String#[]= fix 	  Raises an
IndexError if Regexp match is out of range. 	  Github fixes #243 Patch by
Dmtiriy Budnik</p>

<p>Thu Jan 31 13:54:44 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/socket/raddrinfo.c (rsock_unix_sockaddr_len): return 	 
sizeof(sa_family_t) if path is empty.  see “Autobind Feature” in 	  unix(7)
for details.</p>

<p>* ext/socket/lib/socket.rb (unix_socket_abstract_name?): treat an 	  empty
path as an abstract name.</p>

<p>* test/socket/test_unix.rb: related test.</p>

<p>Wed Jan 30 20:58:50 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/basicsocket.c (bsock_getsockname): ignore truncated 	  part
of socket address. 	  (bsock_getpeername): ditto. 	  (bsock_local_address):
ditto. 	  (bsock_remote_address): ditto.</p>

<p>* ext/socket/unixsocket.c (unix_path): ditto. 	  (unix_addr): ditto. 	 
(unix_peeraddr): ditto.</p>

<p>* ext/socket/init.c (cloexec_accept): ditto.</p>

<p>Wed Jan 30 17:08:20 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/win32.h (fstat): revert r37337, which uses _fstati64() 	 
instead of fstati64() on mingw32.  [Bug #7276]</p>

<p>Wed Jan 30 15:26:37 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/socket/unixsocket.c (rsock_init_unixsock): use rb_inspect() 	 
because rb_sys_fail_str() fails if its argument contains NUL.</p>

<p>* test/socket/test_unix.rb: related test.</p>

<p>Wed Jan 30 15:21:30 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_dump.c (rb_vm_bugreport): show the most important message, Crash 	 
Report log information, first.</p>

<p>Wed Jan 30 15:00:05 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* array.c (rb_ary_bsearch): Raise TypeError on bad return from block</p>

<p>* range.c (range_bsearch): ditto</p>

<p>* test/ruby/test_array.rb (class): Test for above</p>

<p>* test/ruby/test_range.rb (class): ditto</p>

<p>Wed Jan 30 14:46:28 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* range.c: Restrict bsearch to integers [#7728]</p>

<p>* test/ruby/test_range.rb: Test for above</p>

<p>Wed Jan 30 14:10:52 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* array.c (rb_ary_bsearch): Return enumerator if no block [#7725]</p>

<p>* range.c (range_bsearch): ditto</p>

<p>* test/ruby/test_array.rb: Test for above</p>

<p>* test/ruby/test_range.rb: ditto</p>

<p>Wed Jan 30 13:53:43 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix.rb: Take conjugate for inner product 	 
[rubyspec:5a01ad5719f2] [ruby-dev:46101]</p>

<p>Wed Jan 30 13:22:05 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (local_push_gen): warn assigned but unused variables also in 	 
toplevel, except for -e option.  [Feature #7730] [ruby-core:51580]</p>

<p>Wed Jan 30 13:17:53 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* cont.c (cont_restore_thread): svar should be separate per fibers. 	 
[ruby-core:51331] [Bug #7678]</p>

<p>Wed Jan 30 07:15:04 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* re.c (reg_operand): Simplify and reuse error handling [Bug #7539]</p>

<p>* test/ruby/test_regexp.rb: Test for above</p>

<p>Wed Jan 30 07:00:16 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* object.c: Improve error for failed implicit conversions [Bug #7539]</p>

<p>* error.c: Adapt rdoc</p>

<p>* test/ruby/test_object.rb: Test for above</p>

<p>Tue Jan 29 21:40:12 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/net/http/generic_request.rb (encode_multipart_form_data): remove 	 
tempfile explicitly.</p>

<p>Tue Jan 29 19:27:18 2013  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* array.c: Improve documentation about 	  comparison by hash for concerned
methods. [ruby-core:51266]</p>

<p>Tue Jan 29 17:03:28 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c: fix issue of rb_debug_inspector_open(). 	  The order of
making binding should be stack (frame) top to bottom. 	  [Bug #7635] 	  And
also fix issue of collecting klass. Collecting klass is same 	  as
TracePoint#defined_class. 	  (previous version, it returns T_ICLASS
(internal objects).</p>

<p>* test/-ext-/debug/test_debug.rb: add a test.</p>

<p>* ext/-test-/debug/extconf.rb, init.c, inspector.c: ditto.</p>

<p>* vm_backtrace.c: remove magic number and add enum CALLER_BINDING_*.</p>

<p>* vm_backtrace.c, include/ruby/debug.h: add new C api (experimental) 	 
rb_debug_inspector_frame_self_get().</p>

<p>* vm.c, vm_core.h, vm_trace.c: move decl. of 	 
rb_vm_control_frame_id_and_class() and constify first parameter.</p>

<p>Tue Jan 29 16:50:58 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_trace.c (rb_tracepoint_enable, rb_tracepoint_disable): check safe 	 
level as well as set_trace_func.</p>

<p>* vm_trace.c (set_trace_func, thread_<code>add,set</code>_trace_func_m): check 	 
safe level as well as 1.8.</p>

<p>Tue Jan 29 16:49:19 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (rb_mod_method_arity): return original arity of the method if 	 
aliased because of visibility change, like as Method#arity.</p>

<p>Tue Jan 29 12:05:18 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_marshal.rb: remove temporally files early.</p>

<p>* test/ruby/test_process.rb: ditto.</p>

<p>* test/psych/test_exception.rb: ditto.</p>

<p>Tue Jan 29 09:26:20 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/socket/socket.c (sock_s_pack_sockaddr_un): calculate the 	  correct
address length of an abstract socket.</p>

<p>* test/socket/test_unix.rb: related test.</p>

<p>Mon Jan 28 18:02:16 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_backtrace.c (rb_debug_inspector_frame_<code>class,binding,iseq</code>_get): 	 
use long as index as well as RARRAY_LEN().</p>

<p>Mon Jan 28 17:51:38 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_separately): imply no core dump.</p>

<p>Mon Jan 28 12:32:31 2013  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/fcntl/fcntl.c: update document.  use “file descriptor” instead 	  of
“file handle” because it is not used other Ruby documents and 	  it is
confusing with Windows file handle. 	  correct F_DUPFD behavior.</p>

<p>Sat Jan 26 22:39:12 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (w_object): dump instance variables of the result of 	 
marshal_dump not the original object.  [ruby-core:51163] [Bug #7627]</p>

<p>* complex.c (nucomp_marshal_dump): need to copy instance variables.</p>

<p>* rational.c (nurat_marshal_dump): ditto.</p>

<p>Sat Jan 26 13:35:56 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/fcntl/fcntl.c:  Document Fcntl constants</p>

<p>Sat Jan 26 12:54:40 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* hash.c (rb_env_size):  Restored documentation for ENV.size</p>

<p>* lib/drb/drb.rb:  Documented DRb::DRb#run.</p>

<p>* lib/erb.rb (class ERB):  Improved documentation of ERb.</p>

<p>* transcode.c:  Documented Encoding::Converter constants.</p>

<p>Sat Jan 26 10:09:57 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/webrick/accesslog.rb:  Improved WEBrick documentation. 	*
lib/webrick/cgi.rb:  ditto. 	* lib/webrick/config.rb:  ditto. 	*
lib/webrick/cookie.rb:  ditto. 	* lib/webrick/httpauth/authenticator.rb: 
ditto. 	* lib/webrick/httpauth/basicauth.rb:  ditto. 	*
lib/webrick/httpauth/digestauth.rb:  ditto. 	* lib/webrick/httpproxy.rb: 
ditto. 	* lib/webrick/httprequest.rb:  ditto. 	*
lib/webrick/httpresponse.rb:  ditto. 	* lib/webrick/https.rb:  ditto. 	*
lib/webrick/httpserver.rb:  ditto. 	*
lib/webrick/httpservlet/cgihandler.rb:  ditto. 	*
lib/webrick/httpservlet/filehandler.rb:  ditto. 	*
lib/webrick/httpservlet/prochandler.rb:  ditto. 	*
lib/webrick/httputils.rb:  ditto. 	* lib/webrick/httpversion.rb:  ditto. 	*
lib/webrick/log.rb:  ditto. 	* lib/webrick/server.rb:  ditto. 	*
lib/webrick/ssl.rb:  ditto. 	* lib/webrick/utils.rb:  ditto. 	*
lib/webrick/version.rb:  ditto.</p>

<p>Sat Jan 26 08:29:33 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/socket/raddrinfo (rsock_unix_sockaddr_len): renamed from 	 
rsock_unixpath_len, because it returns not the length of the path, 	  but
the length of a socket address for the path.</p>

<p>Sat Jan 26 01:12:23 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (test_ioctl_linux): skip if a platform is 	  not
x86 because linux ioctl request number depend on cpu arch. 	  At least,
alpha, mips, sparc and ppc have a different number. 	  [Bug #7718]
[ruby-core:51544]</p>

<p>Fri Jan 25 19:14:24 2013  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* ext/win32ole/win32ole.c: use TlsAlloc instead of __declspec(thread) 	 
to avoid SEGV if win32ole.so loaded with LoadLibrary in Windows 	  XP or
earlier.</p>

<p>Fri Jan 25 16:47:31 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/socket/raddrinfo.c (rsock_unixpath_len, init_unix_addrinfo), 	 
ext/socket/unixsocket.c (unixsock_connect_internal, 	 
rsock_init_unixsock): calculate the correct address length of 	  an
abstract socket.  Without this fix, sizeof(struct sockaddr_un) 	  is
specified as the length of an abstract socket for bind(2) or 	  connect(2),
so the address of the socket is filled with extra NUL 	  characters.  See
unix(7) for details.</p>

<p>* ext/socket/lib/socket.rb (unix_server_socket): don&#39;t access the 	 
file system if the platform is Linux and path starts with NUL, 	  which
means that the socket is an abstract socket.</p>

<p>* test/socket/test_unix.rb: related test.</p>

<p>Fri Jan 25 13:02:27 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/drb/drb.rb:  Updated documentation based on patch from Vincent 	 
Batts.  [ruby-trunk - Bug #7714] 	* lib/drb/ssl.rb:  ditto.</p>

<p>Fri Jan 25 12:23:29 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/drb/drb.rb:  Improved documentation by adding or hiding methods. 	*
lib/drb/eq.rb:  ditto. 	* lib/drb/extserv.rb:  ditto. 	* lib/drb/gw.rb: 
ditto. 	* lib/drb/invokemethod.rb:  ditto. 	* lib/drb/observer.rb:  ditto.
	* lib/drb/ssl.rb:  ditto. 	* lib/drb/timeridconv.rb:  ditto. 	*
lib/drb/unix.rb:  ditto.</p>

<p>* sample/drb/gw_cu.rb:  Fixed bug in DRb gateway sample.</p>

<p>Fri Jan 25 12:01:56 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: modify a comment about rb_iseq_t::local_size. 	  A patch by
davidbalbert (David Albert) [Bug #6750]</p>

<p>Fri Jan 25 10:36:31 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/mkmf.rb:  Documented MakeMakefile constants.  Hide implementation 	 
details from RDoc</p>

<p>Fri Jan 25 10:04:07 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/compatibility.rb:  Hide compatibility shims from RDoc</p>

<p>* lib/rubygems/config_file.rb:  Hide RbConfig use from RDoc</p>

<p>* lib/rubygems/test_case.rb:  Added note to use realpath when 1.8 	 
support is dropped.</p>

<p>Fri Jan 25 09:14:43 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/generator/darkfish.rb:  Fixed debug message.  RDoc bug #174 	 
by Thomas Leitner.</p>

<p>* lib/rdoc/store.rb:  Fixed deletion of ri attribute data when a class 	 
was loaded then saved.  RDoc bug #171 by Thomas Leitner. 	*
test/rdoc/test_rdoc_store.rb:  Test for above.</p>

<p>Thu Jan 24 19:55:25 2013  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* NEWS (yaml): Write about bundled libyaml.</p>

<p>Thu Jan 24 16:54:34 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/calling_methods.rdoc:  Added a Method Lookup section. 	*
doc/syntax/refinements.rdoc (Method Lookup):  Clarified that 	  refinement
methods are looked up in classes, not instances.</p>

<p>Thu Jan 24 16:49:17 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enum.c (enum_zip): Fix error message</p>

<p>* array.c (take_items): Same, for Array#zip</p>

<p>Thu Jan 24 16:47:26 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c (lazy_zip): raise error for bad arguments 	  [Bug #7706]</p>

<p>Thu Jan 24 16:05:08 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c: Optimize Lazy#zip when passed only arrays 	  [Bug #7706]</p>

<p>Thu Jan 24 15:21:17 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c: Fix state handling for Lazy#zip,<code>drop_take</code><code>_while</code> 	 
[bug #7696] [bug #7691]</p>

<p>Thu Jan 24 11:43:47 2013  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* eval.c (f_current_dirname): Add documentation about “__dir__ 	  returns
always an absolute path”. [Bug #7729]</p>

<p>Thu Jan 24 10:28:30 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* NEWS (RDoc):  Added mention of page support and markdown support.</p>

<p>Thu Jan 24 09:40:13 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/refinements.rdoc:  Added refinements document based on 	  the
specification from the wiki. 	* doc/syntax.rdoc:  Added link to refinements
document.</p>

<p>Wed Jan 23 16:29:09 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_spawn, rb_w32_aspawn_flags): fix missing 	 
initialization.  pointed out by phasis68 (Heesob Park) at 	 
[ruby-core:51579].  [Bug #7721]</p>

<p>Wed Jan 23 16:18:04 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#try_constant): fix for large unsigned.</p>

<p>* lib/mkmf.rb (MakeMakefile#try_constant): fix for larger constants.</p>

<p>* test/mkmf/test_constant.rb: tests for try_constant. 	  TODO: define
check_constant and use it.</p>

<p>Wed Jan 23 13:35:37 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): ignore `STACK_END_ADDRESS&#39; 	  if
Ruby interpreter is running on co-routine. 	  [Feature #2294] 	  <a
href="https://bugs.ruby-lang.org/issues/2294#note-18">bugs.ruby-lang.org/issues/2294#note-18</a></p>

<p>Wed Jan 23 12:28:22 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_spawn, rb_w32_aspawn_flags): check the results 	 
of acp_to_wstr() which can return NULL.  [ruby-core:51557] [Bug #7721]</p>

<p>Wed Jan 23 10:40:49 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/assignment.rdoc (Implicit Array Assignment):  Clarify 	  that
“left-hand side” means “of the assignment”.  Suggested by Jorge 	  Dias. 	*
doc/syntax/assignment.rdoc (Multiple Assignment):  ditto.</p>

<p>Wed Jan 23 10:34:47 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/assignment.rdoc (Local Variables and Methods):  Fixed 	 
example showing caching of a method&#39;s results into a local variable. 	 
Added not about using an explicit receiver to call a method that 	  matches
a local variable.  Suggested by markov_twain on twitter.</p>

<p>Wed Jan 23 10:20:08 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/README:  Fixed typo.  Patch by Pradeep Sahoo. 	  Fixes #240 on
github</p>

<p>Wed Jan 23 09:53:39 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/servlet.rb:  Fixed display of site and home documentation. 	 
Fixes rdoc issue #170 by Thomas Leitner. 	* test/rdoc/test_rdoc_servlet.rb:
Test for above.</p>

<p>* lib/rdoc/code_object.rb:  Split #initialize_visibility from 	 
#initialize for reuse when loading a stored object. 	  Fixes rdoc issue
#171 by Thomas Leitner.</p>

<p>* lib/rdoc/any_method.rb:  Initialize visibility for #display?  For 	 
rdoc issue #171 	* lib/rdoc/attr.rb:  ditto. 	* lib/rdoc/class_module.rb: 
ditto. 	* lib/rdoc/top_level.rb:  ditto. 	*
test/rdoc/test_rdoc_any_method.rb:  Test for above. 	*
test/rdoc/test_rdoc_attr.rb:  ditto. 	*
test/rdoc/test_rdoc_class_module.rb:  ditto. 	*
test/rdoc/test_rdoc_constant.rb:  ditto. 	*
test/rdoc/test_rdoc_top_level.rb:  ditto.</p>

<p>Wed Jan 23 06:43:26 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/test_case.rb:  Use Dir.tmpdir for rubygems tests instead 	 
of ./tmp/test.  Fixes [ruby-trunk - Bug #7717]</p>

<p>Tue Jan 22 22:58:03 2013  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* misc/ruby-electric.el (ruby-electric-curlies): Fix the bug where 	  an
open curly inserted in a string is always replaced with a 	  hash sign.</p>

<p>Mon Jan 21 15:41:33 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb: BASERUBY is transient at core build.</p>

<p>Mon Jan 21 13:51:21 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb ($extmk): traverse parent directories for the case 	  srcdir
is a symlink.</p>

<p>Sun Jan 20 23:55:37 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (w_object, r_object0): separate respond_to checks and 	 
calling, and get back to the old behavior for 2.0.  [Bug #7564]</p>

<p>Sun Jan 20 22:24:28 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/vpath.rb (VPath#def_options): hack for msys make, which 	  converts
a command line argument to non-msys command seems like a 	  path list
automagically.  [Bug #7710] [ruby-core:51489]</p>

<p>Sat Jan 19 11:35:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* struct.c (Struct.new): Document Struct.new with block 	  Patch by
Hiroyuki Iwatsuki [Bug #7674]</p>

<p>Sat Jan 19 09:52:46 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/miscellaneous.rdoc:  Added section on defined?</p>

<p>Sat Jan 19 09:27:31 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/assignment.rdoc (Local Variables and Methods):  Made it 	 
more clear that local variables are created by the parser, not 	 
execution.  Thanks to John Hawthorn.</p>

<p>Sat Jan 19 09:15:58 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/assignment.rdoc:  Improved links 	* doc/syntax/methods.rdoc: 
ditto.</p>

<p>* doc/syntax.rdoc:  Added link to assignment document</p>

<p>Sat Jan 19 08:47:33 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/assignment.rdoc:  Added a syntax document on assignment.</p>

<p>Fri Jan 18 14:11:01 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc:  Added Array Decomposition.</p>

<p>Fri Jan 18 12:54:21 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (gem): Gem.ensure_gem_subdirectories makes 	 
subdirectories group-writable, so make them with $dir_mode.</p>

<p>Fri Jan 18 11:24:33 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/win32ole/win32ole.c (ole_initialize): uninitialize OLE at thread 	 
ends.  [Bug #2618] [ruby-core:27634]</p>

<p>* ext/win32ole/win32ole.c (ole_initialize): initialize OLE for each 	 
threads.  [Bug #2618] [ruby-core:27634]</p>

<p>Thu Jan 17 22:10:35 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rubygems/ext/builder.rb (Gem::Ext::Builder.make): Remove 	  .time
dependency from *.rb install target. It causes needless 	  *.rb install.
[Bug #7698] [ruby-core:51437] 	  Reported by Tadashi Saito. Thanks!!! 	*
test/rubygems/test_gem_installer.rb 	 
(TestGemInstaller#test_install_extension_and_script): Add a test 	  for the
above change.</p>

<p>Thu Jan 17 21:08:20 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* eval.c: Fix a typo in ruby_finalize() documentation.</p>

<p>Thu Jan 17 20:28:18 2013  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* object.c: Typo in Kernel#hash documentation. 	  Patch by zed_0xff
[Github Fixes #237]</p>

<p>Thu Jan 17 10:48:56 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: use constants rather than 	 
calculating Inf and NaN.</p>

<p>Thu Jan 17 10:21:05 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/miscellaneous.rdoc:  Added Ending an Expression and 	 
indentation.</p>

<p>Thu Jan 17 09:30:21 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/installer.rb:  Untaint string when checking output 	  for
$SAFE=1</p>

<p>* lib/rubygems/specification.rb:  Keep previously loaded specs as 	 
active.  This prevents double loading when refreshing the gem list. 	*
test/rubygems/test_gem.rb:  Test for above</p>

<p>* lib/rubygems.rb:  Bump version to 2.0.0.rc.2</p>

<p>Thu Jan 17 09:08:37 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/control_expressions.rdoc:  Added ? : ternary if</p>

<p>Thu Jan 17 08:36:04 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/miscellaneous.rdoc:  Added documentation for alias, undef, 	 
BEGIN, END. 	* doc/syntax/modules_and_classes.rdoc (Constants):  Fixed
unwrapped 	  paragraph with trailing whitespace. 	*
doc/syntax/modules_and_classes.rdoc (Scope):  Added section pointing 	  to
alias and undef documentation. 	* doc/syntax.rdoc:  Added link to
miscellaneous section.</p>

<p>Thu Jan 17 07:50:26 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/control_expressions.rdoc (Flip-Flop):  Added a section on 	 
the flip-flop.</p>

<p>Thu Jan 17 06:59:51 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/control_expressions.rdoc (if Expressions):  Fixed markup 	 
error.  Fixes #235 on github by FlyingFoX.</p>

<p>Thu Jan 17 06:53:58 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/literals.rdoc (Strings):  Fixed typo.  Fixes #236 on 	 
github by Doug Yun.</p>

<p>Wed Jan 16 18:45:46 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/win32ole/lib/win32ole.rb: use TracePoint to hook all thread 	 
creation not only by Thread.new and to get rid of interference with 	  svar
scope.  [Bug #7681] [ruby-core:51365]</p>

<p>Wed Jan 16 09:35:53 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* .document:  Removed extra space 	* lib/irb/lc/.document:  Hide
help-message 	* lib/minitest/.document:  Hide README.txt 	*
lib/rake/lib/.document:  Hide project.rake 	*
lib/rdoc/generator/template/json_index/.document:  Hide JavaScript 	  files
	* lib/rubygems/ssl_certs/.document:  Hide PEM files.</p>

<p>Wed Jan 16 03:54:28 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/control_expressions.rdoc:  Omit optional “then” for if and 	 
unless expressions.  Improved description of “a if a = 0.zero?” 	 
NameError.  Note that “do” for for loop is optional.</p>

<p>Wed Jan 16 03:28:47 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/calling_methods.rdoc:  Link to defining methods. 	*
doc/syntax/methods.rdoc:  Link to calling methods, fixed typo.</p>

<p>Wed Jan 16 03:15:00 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc:  Fixed link 	*
doc/syntax/modules_and_classes.rdoc:  Fixed link 	* doc/syntax.rdoc: 
Updated with links to the recently added pages</p>

<p>Wed Jan 16 03:05:50 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/control_expressions.rdoc (redo Statement):  Added note 	 
about retry. 	* doc/syntax/exceptions.rdoc:  Added retry statement</p>

<p>Tue Jan 15 23:12:34 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/vpath.rb (VPath#list): default separator to PATH_SEPARATOR from 	 
configure.in for make, not same name constant of File for use in ruby.</p>

<p>Tue Jan 15 22:30:04 2013  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/ext/save-history.rb: identify rightly a status of a 	  history
file that already exists [Bug #7694]. Thanks Nobuhiro IMAI 	  for this
patch.</p>

<p>Tue Jan 15 15:55:28 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/control_expressions.rdoc:  Added description of control 	 
expressions in ruby.</p>

<p>Tue Jan 15 13:33:00 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc (Method Names):  Added method names including 	 
operator methods. 	* doc/syntax/methods.rdoc (Return Values):  Added note
that assignment 	  methods ignore return values. 	*
doc/syntax/precedence.rdoc:  Added document describing precedence.</p>

<p>Tue Jan 15 11:49:31 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc (Block Argument):  Added section on block 	 
argument.  Thanks to Andy Lindeman.</p>

<p>Tue Jan 15 10:54:59 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/calling_methods.rdoc (Arguments):  Added improved 	 
introduction to arguments including passing style and lazy 	  evaluation. 
Thanks to Matt Aimonetti. 	* doc/syntax/calling_methods.rdoc (Positional
Arguments):  Added 	  description for sending a message to a method with
*arguments 	* doc/syntax/calling_methods.rdoc (Default Positional
Arguments): 	  Added description.  Thanks to Andy Lindeman. 	*
doc/syntax/calling_methods.rdoc (Block Local Arguments): 	  Added
description of block locals.  Thanks to Justin Collins. 	*
doc/syntax/calling_methods.rdoc (Hash to Keyword Arguments):  Added 	 
section describing ** operator.  Thanks  to Justin Collins.</p>

<p>Tue Jan 15 10:40:18 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* test_lazy_enumerator: Test that map &amp; flat_map also require a block</p>

<p>Tue Jan 15 09:22:47 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (gvl_init): Reset gvl.wait_yield explicitly when 	 
fork()ing. Patch by Apollon Oikonomopoulos. Thanks! 	  [Bug #<a
href="ruby-core:51424">7693]</a></p>

<p>Tue Jan 15 09:27:56 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>
<dl class="rdoc-list note-list"><dt>	* doc/syntax/calling_methods.rdoc (Receiver):  Added 
<dd>
<p>as pointed out</p>
</dd></dl>

<p>by Tony Arcieri 	* doc/syntax/calling_methods.rdoc (Block Argument): 
Fixed { } block 	  examples as pointed out by David Copeland.</p>

<p>Tue Jan 15 09:10:29 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc (Array/Hash Argument):  Moved above Keyword 	 
Arguments 	* doc/syntax/methods.rdoc (Keyword Arguments):  Described ** for
	  gathering arbitrary keyword arguments.</p>

<p>Tue Jan 15 08:56:37 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/calling_methods.rdoc:  Added document describing method 	 
calls.</p>

<p>Tue Jan 15 07:39:21 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/top_level.rb:  Fixed extension trimming for page names in 	 
RDoc HTML output.  [ruby-trunk - Bug #7673] 	*
test/rdoc/test_rdoc_top_level.rb:  Test for above.</p>

<p>Mon Jan 14 23:06:41 2013  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/ext/save-history.rb: outputs its history to 	 
owner-only-readable file and change the permission of a file that 	 
already exists [Bug #7694]. Thanks Nobuhiro IMAI for bug reports.</p>

<p>Mon Jan 14 17:12:48 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_flat_map_func): flat_map should call each only 	 
when the value of a block returns a forcable object. 	  [ruby-core:51401]
[Bug #7690]</p>

<p>* enumerator.c (lazy_flat_map): add documentation.</p>

<p>* test/ruby/test_lazy_enumerator.rb: related test.</p>

<p>Mon Jan 14 16:42:28 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c: Require block for Lazy#<code>take|drop</code>_while [Bug #7692]</p>

<p>Mon Jan 14 14:41:00 2013  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_to_s): use CRuby style.</p>

<p>Mon Jan 14 14:39:00 2013  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c: use `RB_TYPE_P(x, t)` instead of 	 
`TYPE(x) == t`.</p>

<p>Mon Jan 14 10:18:56 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c: Fix size for Enumerator::Lazy#flat_map</p>

<p>Mon Jan 14 07:12:52 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix/lup_decomposition: Fix bugs with LUP Decomposition of 	 
rectangular matrices. [rubyspec:ba849801a85]</p>

<p>Mon Jan 14 06:46:53 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (add_ctype_to_cc): don&#39;t check dup warn on adding 	 
negative ctype to cclass. [Bug #7471] [ruby-core:50344]</p>

<p>Mon Jan 14 06:06:03 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix/eigenvalue_decomposition: Backport bugfix of Jama 1.0.3 	 
[rubyspec:df87040be371]</p>

<p>Sun Jan 13 16:45:00 2013  Zachary Scott &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/psych/yaml/scanner.c: Fix typos, patch by James Dabbs 	  [Github
tenderlove/psych#118]</p>

<p>Sun Jan 13 15:00:00 2013  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_sub): 	  need to specify
precision for converting Rational and Float. 	  [ruby-dev:46544] [Bug
#7404]</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_mult): ditto.</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_divide): ditto.</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_DoDivmod): ditto.</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_divremain): ditto.</p>

<p>* test/bigdecimal/test_bigdecimal.rb: add tests for the above fixes.</p>

<p>Sun Jan 13 14:48:55 2013  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix/eigenvalue_decomposition: Fix eigensystem with complex 	 
eigenvectors. Patch by pypypy567. 	  [Bug #7208] [ruby-dev:46251]
[rubyspec:242f8e55bd]</p>

<p>* lib/matrix/lup_decomposition.rb: Fix error for rectangular matrices 	 
[bug#7620] [ruby-core:51118] [rubyspec:41f833ee2]</p>

<p>Sun Jan 13 14:06:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb.rb, lib/prime.rb: Typos in overview 	  Patch by Ershad K [Github
Fixes #234]</p>

<p>Sun Jan 13 13:40:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/open3.rb : Typo in Open3 overview. Patch by zed_0xff 	  [Github
Fixes #233]</p>

<p>Sat Jan 12 17:42:00 2013  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>* numeric.c (do_coerce): fix for the exceptions which the coerce 	  method
raises.  The optimization done by r38756 is preserved. 	  [Bug #7645]
[ruby-core:51213]</p>

<p>Sat Jan 12 16:12:46 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/setup.mak (-runtime-): see msvcrt from link header on mswin 	 
instead of running testing executable file, for cross compiling.</p>

<p>Sat Jan 12 08:58:47 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: merge key values that 	 
contain something besides a hash should be left in tact.</p>

<p>* test/psych/test_merge_keys.rb: test for change</p>

<p>Sat Jan 12 07:52:47 2013  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* ext/win32ole/win32ole.c (ole_set_byref): support VT_UI8|VT_BYREF, 	 
VT_I8|VT_BYREF in cygwin and mingw.</p>

<p>* ext/win32ole/win32ole.c (ole_variant2val): ditto.</p>

<p>* test/win32ole/test_win32ole_variant.rb (test_s_new_with_i8_byref): 	 
ditto.</p>

<p>* test/win32ole/test_win32ole_variant.rb (test_s_new_with_ui8_byref): 	 
ditto.</p>

<p>Sat Jan 12 02:45:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* man/ruby.1 (options): include –*-encoding from r38784</p>

<p>Fri Jan 11 23:34:48 2013  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* ruby.c (usage): sort –*-encoding in help. (same order of -E)</p>

<p>Fri Jan 11 16:56:29 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb: use configured libdir value to fix 	 
–enable-load-relative on systems where libdir is not default value, 	 
overridden in config.site files.  [ruby-core:47267] [Bug #6903]</p>

<p>Fri Jan 11 11:59:32 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (dispose_string): use rb_str_free for freeing string in 	 
parse.y. by Sokolov Yura &lt;funny.falcon@gmail.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/87">github.com/ruby/ruby/pull/87</a>
fix GH-87</p>

<p>Fri Jan 11 09:56:22 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* insns.def (defineclass): private constants should not be accessed 	  by
scoped module definitions.  The bug was introduced in r38495.</p>

<p>* test/ruby/test_module.rb: related test.</p>

<p>Fri Jan 11 02:11:59 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/rbconfig/obsolete.rb (respond_to_missing?): use send because 	 
RbConfig.respond_to_missing? is now private.</p>

<p>Thu Jan 10 22:00:58 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h (VM_DEBUG_BP_CHECK): set 0 as default. 	  This flag specifies
checking BP consistency on each frame popping. 	  Now, we don&#39;t have
any trouble on it, so I remove it. 	  If you feel any bugs about VM
execution, then set it to 1.</p>

<p>Thu Jan 10 21:03:05 2013 TAKANO `takano32&#39; Mitsuhiro
&lt;tak@no32.tk&gt;</p>

<p>* cont.c: define FIBER_USE_NATIVE as 0 in ia64.</p>

<p>Thu Jan 10 19:39:05 2013  TAKANO `takano32&#39; Mitsuhiro
&lt;tak@no32.tk&gt;</p>

<p>* thread.c: fix RB_GC_SAVE_MACHINE_REGISTER_STACK define for ia64.</p>

<p>Thu Jan 10 17:45:39 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in, win32/Makefile.sub ($(MKFILES)): continue if Makefile 	 
unchanged.</p>

<p>Thu Jan 10 16:31:20 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_search_super_method): raise a TypeError 	  instead
of a NotImplementedError if self is not an instance of the 	  current
class.  [ruby-dev:39772] [Bug #2402]</p>

<p>Thu Jan 10 16:47:18 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/tk/extconf.rb (find_tcltk_header): use have_header instead of 	 
try_cpp, which is incredibly slow with VC.</p>

<p>Thu Jan 10 15:55:28 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* numeric.c (do_coerce): remove an unused variable.</p>

<p>Thu Jan 10 15:35:55 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* tool/gen_dummy_probes.rb: remove comments in probes.d to fix the 	 
compilation error introduced by r38755.</p>

<p>Thu Jan 10 11:15:04 2013  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>* numeric.c (do_coerce): speed optimization by using rb_check_funcall 	 
instead of rb_rescue + rb_funcall. 	  This fix is based on the patch by
Benoit Daloze. 	  [Bug #7645] [ruby-core:51213]</p>

<p>Thu Jan 10 11:15:04 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* probes.d: updating probes to be more symmetrical, adding 	 
documentation.</p>

<p>* load.c: ditto</p>

<p>Thu Jan 10 04:23:07 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: strip trailing dots from 	 
floats so that Float() will not raise an exception.</p>

<p>* test/psych/test_numeric.rb: test to ensure “1.” can be loaded</p>

<p>* test/psych/test_string.rb: make sure “1.” can round trip</p>

<p>Thu Jan 10 03:38:40 2013  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: ascii only binary strings 	 
will be dumped as unicode.  Thanks Paul Kunysch!</p>

<p>* test/psych/test_string.rb: appropriate test</p>

<p>Thu Jan 10 03:29:55 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (compile_array_): modify wrong optimization. 	  A script
“[print(1)]; print(2)” should output “12”. 	  However, the compiler had
eliminated “[print(1)]” expression 	  because it is void expression (unused
array). 	  Of course, side-effect should be remained. 	  This issue is
reported by Masaya Tarui.</p>

<p>* bootstraptest/test_literal.rb: add a test.</p>

<p>Wed Jan  9 22:07:42 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* load.c (load_lock): if thread shield is destroyed and there is no 	 
waiting thread, insert new thread shield into load_table. 	  [Bug #7530]
[ruby-core:50645]</p>

<p>Wed Jan  9 21:43:32 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* load.c (load_lock): revert r38744. it should acquire new thread 	 
shield.</p>

<p>Wed Jan  9 15:40:18 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (th_init, ruby_thread_init): initialize root_svar with Qnil, 	 
since lep_svar_place() expects uninitialized svar to be nil, not 0.</p>

<p>Wed Jan  9 13:20:23 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* test/ruby/test_require.rb: improve test for r38744. 	  fix to use
Tempfile instead of temporary file in current directory. 	  the patch is
from nobu (Nobuyoshi Nakada).</p>

<p>Wed Jan  9 09:53:23 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* load.c (load_lock): fix not to delete thread shield twice. 	  it may
break the shield locked by another thread. 	  [Bug #7530] [ruby-core:50645]</p>

<p>* test/ruby/test_require.rb: a test for above.</p>

<p>Wed Jan  9 02:13:22 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RBasic): to be aligned on a VALUE size 	  boundary.
[Bug #7647]</p>

<p>Tue Jan  8 14:41:41 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_core.h (rb_iseq_t): move flip_cnt from struct iseq_compile_data, 	 
because it has same life span as enclosing iseq.  [Bug #7671] 	 
[ruby-core:51296]</p>

<p>Mon Jan  7 23:43:00 2013  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (rmpd_power_by_big_decimal): 	  add
RB_GC_GUARD to prevent the intermediate object is GCed too early. 	  This
patch was made by Yusuke Endoh.  [Bug #7044] [ruby-core:47632]</p>

<p>* test/bigdecimal/test_bigdecimal.rb: add a reproduction test for 	  the
issue [Bug #7044]</p>

<p>Mon Jan  7 21:40:36 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (Init_eval_method): main.public and main.private 	  should
be private.</p>

<p>* proc.c (Init_Proc): main.define_method should be private.</p>

<p>* test/ruby/test_module.rb: related test.</p>

<p>Mon Jan  7 20:48:47 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (Init_eval): main.include should be private. 	  [ruby-core:51293]
[Bug #7670]</p>

<p>* test/ruby/test_module.rb (test_top_include_is_private): a new test 	 
for the above change.</p>

<p>Mon Jan  7 20:29:50 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* NEWS: remove description about `require “refinement”&#39;.</p>

<p>Mon Jan  7 20:15:49 2013  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (Init_eval): enable Refinements by default. 	  [ruby-core:51286]
[Bug #7667]</p>

<p>* eval.c (rb_mod_refine, top_using): show a warning when 	  Module#refine
or main.using is called at the first time.</p>

<p>* ext/refinement/*: removed the extension library “refinement”.</p>

<p>* test/ruby/test_refinement.rb: fix for the above changes.</p>

<p>Mon Jan  7 17:34:22 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/ruby.h (RUBY_EVENT_SPECIFIED_LINE): make it special. 	 
This flag is not contained by RUBY_EVENT_TRACEPOINT_ALL. 	  This event is
experimental one. It is possible to remove/rename 	  flag name after 2.0.1.</p>

<p>* vm_trace.c (get_event_id): return :line if SPECIFIED_LINE was 	 
occurred. `:specified_line&#39; never been returned.</p>

<p>Mon Jan  7 15:42:10 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (f_kwrest): allow bare kwrest_mark as valid syntax.  its 	 
semantics is still undefined.  [Bug #7662] [ruby-core:51269]</p>

<p>Mon Jan  7 15:31:58 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (f_kwrest): reject duplicated kwrest argument name.</p>

<p>Mon Jan  7 15:24:10 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (rb_threadptr_exec_event_hooks_orig): pop tag before 	 
JUMP_TAG() if frame is `finish&#39; frame. 	  Without this patch, there is
an inconsistency between control 	  frame stack and tags stack. 	  [Bug
#7668]</p>

<p>* test/ruby/test_settracefunc.rb: add a test for above.</p>

<p>Mon Jan  7 15:21:48 2013  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* Makefile.in, common.mk (fake, yes-fake, no-make): these dependencies 	 
are not platform dependent.</p>

<p>* win32/Makefile.sub ($(arch)-fake.rb): workaround.</p>

<p>Mon Jan  7 12:09:24 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_callee_setup_arg_complex,
vm_yield_setup_block_args): 	  set keyrest hash after making rest array, so
that the last element 	  will not be overwritten.  [ruby-core:51278] [Bug
#7665]</p>

<p>Mon Jan  7 09:37:24 2013  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* NEWS: add a NEWS entry about RubyVM.</p>

<p>Sun Jan  6 19:06:57 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>* win32/Makefile.sub: Fix build with VC. 	  Patch by Charlie Savage. Fixes
[ruby-core:51261]</p>

<p>Sun Jan  6 18:43:48 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>* bootstraptest/test_io.rb: add a test for [ruby-dev:46834].</p>

<p>* io.c (rb_cloexec_fcntl_dupfd) Use an emulation with dup(2) when 	 
fcntl(2) and/or F_DUPFD is unavailable. 	  Suggested by akr.</p>

<p>* configure.in (HAVE_FCNTL): NativeClient does not provide fcntl(2).</p>

<p>Sun Jan  6 11:11:26 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/modules_and_classes.rdoc:  Fixed typo.</p>

<p>Sun Jan  6 05:35:18 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/modules_and_classes.rdoc:  Added singleton classes 	 
documentation.</p>

<p>Sun Jan  6 02:22:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/webrick/httpservlet/abstract.rb (WEBrick::HTTPServlet): Typo in 	 
example. Patch by shlensky [Fixes #232 on github]</p>

<p>Sat Jan  5 21:15:10 2013  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http/generic_request.rb: 	  Amazon ECA API and GTE/1.3 disallow
requests whose host has port 	  number if its port number equals to default
port number of the 	  scheme. [Bug #7650]</p>

<p>Sat Jan  5 13:58:59 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/modules_and_classes.rdoc:  Improved description of methods 	 
on a module or class as suggested by Tobias Buhlmann</p>

<p>Sat Jan  5 13:38:07 2013  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* string.c (rb_str_enumerate_lines): fix invalid byte sequence error 	 
when a separator is passed. The patch is from yoshidam (Yoshida 	  Masato).
	  [Bug #7646] [ruby-dev:46827]</p>

<p>* test/ruby/test_string.rb: a test for above.</p>

<p>Sat Jan  5 12:25:42 2013  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_in_out_err): 	 
check stdout and stderr both.</p>

<p>Sat Jan  5 10:21:54 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/modules_and_classes.rdoc:  Added documentation of syntax 	 
for Modules and Classes. 	* doc/syntax/methods.rdoc:  Moved some text to
the Modules and 	  Classes syntax document.</p>

<p>Sat Jan  5 08:38:27 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc:  Added return values and scope sections, 	 
slightly modified from the original patch.  Fixes #227 from github by 	 
Dave Brown.</p>

<p>Sat Jan  5 08:21:41 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_cloexec_fcntl_dupfd): improve #ifdef condition. 	* io.c
(rb_maygvl_fd_fix_cloexec): ditto.</p>

<p>Sat Jan  5 07:54:59 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/cleanup_command.rb:  Clean all possible gems 	 
using multiple passes.  Fixes RubyGems bug #422.  Refactored for 	 
maintainability. 	* test/rubygems/test_gem_commands_cleanup_command.rb: 
Test for above.</p>

<p>Sat Jan  5 05:04:39 2013  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* gc.c (vm_xrealloc): add a few comment why we avoid realloc(ptr,0).</p>

<p>Fri Jan  4 20:17:06 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>* Makefile.in (RBCONFIG): Moved from common.mk in order to use the 	 
variable in Makefile.in.</p>

<p>* win32/Makefile.sub (RBCONFIG): Ditto.</p>

<p>Fri Jan  4 19:45:50 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>* common.mk (run, parse): Use BTESTRUBY instead of MINIRUBY to handle 	 
cross-compiling cases, e.g. NativeClient.</p>

<p>Fri Jan  4 17:58:16 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>* common.mk (yes-btest): btest depends on also $(arch)-fake.rb and 	 
rbconfig.rb on building for NativeClient.</p>

<p>* Makefile.in (fake): Avoid generating $(arch)-fake.rb unless cross 	 
compiling.</p>

<p>* configure.in (CROSS_COMPILING): New substitution.</p>

<p>Fri Jan  4 16:26:45 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/doctor.rb:  Process directories in order in case the 	 
filesystem doesn&#39;t.  [ruby-trunk - Bug #7618]</p>

<p>Process specifications before other directories in case of bugs. 	*
test/rubygems/test_gem_doctor.rb:  Test for above.</p>

<p>* lib/rubygems.rb:  Updated version.</p>

<p>* test/rubygems/test_require.rb:  Fixed double require of 	  benchmark.rb.
RubyGems bug #420.</p>

<p>* test/rubygems/test_gem_commands_check_command.rb:  Fixed unused 	 
variable warnings. 	* test/rubygems/test_gem_commands_query_command.rb: 
ditto 	* test/rubygems/test_gem_installer.rb:  ditto</p>

<p>Fri Jan  4 15:05:25 2013  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/cross_reference.rb:  Fixed matching of C#=== or #===.  RDoc 	 
bug #164 	* test/rdoc/test_rdoc_cross_reference.rb:  Test for above.</p>

<p>* lib/rdoc/parser/changelog.rb:  Fixed parsing of dates.  RDoc bug #165 	*
test/rdoc/test_rdoc_parser_changelog.rb:  Test for above.</p>

<p>* lib/rdoc/parser.rb:  Fixed parsing multibyte files with incomplete 	 
characters at byte 1024.  [ruby-trunk - Bug #6393] 	  Fixed handling of -E.
[ruby-trunk - Bug #6392] 	* test/rdoc/test_rdoc_options.rb:  Test for
above. 	* test/rdoc/test_rdoc_parser.rb:  ditto. 	*
test/rdoc/test_rdoc_parser_c.rb:  ditto. 	*
test/rdoc/test_rdoc_parser_changelog.rb:  ditto. 	*
test/rdoc/test_rdoc_parser_markdown.rb:  ditto. 	*
test/rdoc/test_rdoc_parser_rd.rb:  ditto. 	* test/rdoc/test_rdoc_rdoc.rb: 
ditto.</p>

<p>* lib/rdoc/tom_doc.rb:  Fixed parsing of [] in TomDoc arguments list. 	 
RDoc bug #167 	* test/rdoc/test_rdoc_tom_doc.rb:  Test for above.</p>

<p>* lib/rdoc.rb:  Update version.</p>

<p>Fri Jan  4 11:51:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/forwardable.rb: Fix rdoc parameters for ::def_single_delegator. 	 
Patch by Vladimir Andrijevik [Github Fixes #230]</p>

<p>Fri Jan  4 00:35:11 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>Fix failures on btest for NativeClient. 	* bootstraptest/runner.rb
(nacl?): New method to distinguish NaCl 	  cross build.</p>

<p>* bootstraptest/test_io.rb: Skip unsupported operations.</p>

<p>* bootstraptest/test_literal.rb: ditto.</p>

<p>Fri Jan  4 00:29:40 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>* io.c (rb_cloexec_fcntl_dupfd): Fix failures in 	 
bootstrap_test/test_io.rb.  NativeClient does not support F_DUPFD 	  but
supports dup2(2).</p>

<p>Thu Jan  3 17:46:50 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/element.rb (REXML::Elements#add): Remove too much 	 
“elements” in document. Sorry…</p>

<p>Thu Jan  3 17:42:32 2013  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/element.rb (REXML::Elements#each): Add missing 	  “elements”
in document. [ruby-talk:402713] 	  Reported by Wesley Rishel. Thanks!!!</p>

<p>Thu Jan  3 15:13:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/psych/lib/psych.rb (Psych.load): Return value of 	 
Psych::SyntaxError.message should be same as example. 	  Patch by Ippei
Obayashi [ruby-core:51193] [Bug #7636]</p>

<p>Thu Jan  3 14:58:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/forwardable.rb (SingleForwardable): Fix example in overview 	  Patch
by Vladimir Andrijevik [Github Fixes #231]</p>

<p>Thu Jan  3 14:32:47 2013  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>* configure.in (OBJCOPY):  Fixes build error for NativeClient. 	  Avoid
disabling OBJCOPY for NativeClient.</p>

<p>* thread_pthread.c (rb_reserved_fd_p): USE_SLEEPY_TIMER_THREAD is 	 
always defined.  Fixes compilation error for NativeClient.</p>

<p>Wed Jan 02 03:09:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/zlib/zlib.c (Zlib::GzipReader): Fix typo by zed_0xff 	  [Fixes
Github #229]</p>

<p>Wed Jan 02 02:29:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* hash.c (rb_hash_update): Revert documentation from r38672 	  See: <a
href="https://github.com/ruby/ruby/pull/228#issuecomment-11791013">github.com/ruby/ruby/pull/228#issuecomment-11791013</a></p>

<p>Wed Jan 02 02:16:00 2013  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* hash.c (rb_hash_update): Documentation for Hash#merge and shallow 	 
copies Patch by Yorick Peterse [Fixes Github #228]</p>

<p>Mon Dec 31 15:10:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* vm_backtrace.c: Add documentation for Kernel#caller_locations, 	 
Kernel#caller, and Thread::Backtrace::Location</p>

<p>Mon Dec 31 13:05:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* test/ruby/test_backtrace.rb: Add test for r37957 [Feature #7434]</p>

<p>Sun Dec 30 23:33:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (simple_re_meta): escaped closing parenthesis has different 	 
meaning.  [Bug #7610] [ruby-core:51088]</p>

<p>Sun Dec 30 12:09:47 2012  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* configure.in: use 4 argument form of AC_CHECK_HEADERS to force 	 
autoconf to use compiler&#39;s result</p>

<p>Sun Dec 30 10:58:04 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* test/ruby/test_keyword.rb: add a test for passing hash 	  as a last
argument. [ruby-dev:46712] [Bug #7529]</p>

<p>Sun Dec 30 10:51:29 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm_insnhelper.c: set keyword hash on Proc/block calls. 	 
[ruby-core:51172] [Bug #7630]</p>

<p>* test/ruby/test_keyword.rb: add tests for above.</p>

<p>Sat Dec 29 21:57:11 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/completion.rb: treat rightly completion for symbol on irb 	 
[Bug #7632].</p>

<p>Sat Dec 29 21:51:30 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/curses/curses.c (window_cury, window_curx, window_maxy, 	 
window_maxx, window_begy, window_begx): use RB_UNUSED_VAR() 	  to suppress
unused-but-set-variable warnings.</p>

<p>Sat Dec 29 16:45:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* iseq.c (RubyVM::InstructionSequence): rdoc formatting</p>

<p>Sat Dec 29 15:28:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* iseq.c (RubyVM::InstructionSequence):	Add rdoc for new iseq features 	 
added from r38085, this includes ::of, #path, #absolute_path, 	  #label,
#base_label, #first_lineno, and #inspect</p>

<p>Sat Dec 29 14:06:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* iseq.c (rb_iseq_line_trace_all, rb_iseq_line_trace_specify): Add 	  rdoc
for experimental C level api of iseq, from r38076</p>

<p>Sat Dec 29 11:37:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_obj_clone): attach clone to its singleton class during 	 
cloning singleton class so that singleton_method_added will be called 	  on
it.  based on the patch by shiba (satoshi shiba)[Bug #5283] in 	 
[ruby-dev:44477].  [Bug #5283]</p>

<p>Sat Dec 29 10:10:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (crt_externs.h): use standard macro AC_CHECK_HEADERS.</p>

<p>Fri Dec 28 23:12:44 2012  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* configure.in: check for the whether crt_externs.h is present when
compiling 	  for darwin (this header is missing in the iOS SDK) 	*
eval_intern.h: check HAVE_CRT_EXTERNS_H before including crt_externs.h, if
	  not defined, include missing/crt_externs.h instead 	* hash.c: ditto 	*
missing/setproctitle.c: ditto 	* missing/crt_externs.h: declare
_NSGetEnviron() function and define environ 	  for iOS</p>

<p>Fri Dec 28 21:40:36 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/context.rb: IRB::Context#new: Check from JobManager 	  inside
IRB namespace [Bug #7628]. Thanks rafaelfranca for bug 	  report and its
patch.</p>

<p>Fri Dec 28 17:06:17 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* misc/ruby-electric.el (ruby-electric-curlies): Automatically 	  indent
closing curly brackets when 	  ruby-electric-newline-before-closing-bracket
is true.</p>

<p>Fri Dec 28 11:50:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_yield_setup_block_args): pass single argument to 	 
single optional parameter unchanged without splatting.  [Bug #7621] 	 
[ruby-dev:46801]</p>

<p>Fri Dec 28 11:17:47 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* proc.c (method_eq): fix the documentation to refer to owner. 	 
[ruby-core:51105] [Bug #7613]</p>

<p>* test/ruby/test_method.rb (test_alias_onwer): new test to confirm 	  that
`a == b&#39; returns false if owners of a and b are different.</p>

<p>Fri Dec 28 07:07:43 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* def/id.def: use split(/^/) instead of String#lines to support 	  Ruby
1.8.5 as BASERUBY.</p>

<p>Thu Dec 27 21:56:56 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* variable.c (rb_mod_remove_const): fix segv caused by r38558.</p>

<p>Tue Dec 28 01:13:48 2012  James Edward Gray II 
&lt;james@graysoftinc.com&gt;</p>

<p>* lib/csv.rb: Added more Hash methods to CSV::Row.</p>

<p>Thu Dec 27 23:27:15 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/ruby-lex.rb: make lex_state to EXPR_END when next token 	  is an
operator after SYMBEG [Bug #6378].</p>

<p>Thu Dec 27 21:30:21 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/ruby-lex.rb: allow to handle recursive heredocs on 	  irb[Bug
#5648].</p>

<p>Thu Dec 27 20:45:29 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* ext/stringio/stringio.c (strio_getline): fix not to raise TypeError 	 
when limit is nil. 	  [Bug #7232] [ruby-core:48531]</p>

<p>* test/stringio/test_stringio.rb: a test for above.</p>

<p>Thu Dec 27 21:08:23 2012  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* vm_core.h (VM_DEFINECLASS_TYPE): explicit cast to enum type to avoid
64-&gt;32 	  shorten warning</p>

<p>Thu Dec 27 20:11:29 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* ext/stringio/stringio.c (strio_ungetc): raise IOError instead of
RuntimeError 	  if the string is frozen. 	  [Bug #7231] [ruby-core:48530]</p>

<p>* ext/stringio/stringio.c (strio_ungetbyte): ditto.</p>

<p>* test/stringio/test_stringio.rb: a test for above.</p>

<p>Wed Dec 26 23:55:18 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/context.rb: fix IRB::Inspector#keys_with_inspector [Bug #7598]</p>

<p>Wed Dec 26 23:26:15 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/context.rb: IRB::Context#use_readline= has been obsolete 	  [Bug
#6339].</p>

<p>Wed Dec 26 21:32:46 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/context.rb: make a correct prompt from 	  <a
href=":IRB_NAME">IRB.conf</a> on irb [Bug #6338]. Patched by sho-h.</p>

<p>Wed Dec 26 21:09:19 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/ext/math-mode.rb: make not able to change math-mode 	  after irb
starting [Bug #6302]. Patched by sho-h.</p>

<p>Wed Dec 26 12:52:36 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/init.rb: change default debug level for 	  <a
href="ruby-dev:46805">irb</a>, [Bug #6301].</p>

<p>Wed Dec 26 11:54:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: enable -fPIE when checking -pie for fixing 	  OpenBSD
build error. Patch by George Koehler. Thank you! 	  [Bug #7606]
[ruby-core:51082]</p>

<p>Wed Dec 26 07:31:24 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_enc_cr_str_copy_for_substr): empty string is always 	 
valid or 7bit.</p>

<p>* string.c (rb_str_enumerate_lines, rb_str_chop): reduce duplicated 	 
code.</p>

<p>* string.c (rb_str_enumerate_chars): prevent shared copy from GC.</p>

<p>Wed Dec 26 01:31:16 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/init.rb, lib/irb/context.rb: fix conf.debug_level= 	  [Bug
#6301] and fix irb command option: – irb_debug_level for irb.</p>

<p>Wed Dec 26 00:59:18 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/ruby-lex.rb: improve RubyLex performance for large files 	  [Bug
#5202]. Patch by ryanmelt.</p>

<p>Tue Dec 25 22:21:06 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/output-method.rb: raise right exception when 	 
IRB::OutputMethod#print don&#39;t defined [Bug #6657].</p>

<p>Tue Dec 25 22:06:33 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (rb_threadptr_exec_event_hooks_and_pop_frame): 	  pop a frame
before JUMP_TAG() if exception occurred. 	  This change fix bug of Ruby
1.9. 	  [ruby-core:51128] [ruby-trunk - Bug #7624]</p>

<p>* vm_core.h (EXEC_EVENT_HOOK_AND_POP_FRAME): add to use 	 
`rb_threadptr_exec_event_hooks_and_pop_frame()&#39;.</p>

<p>* vm.c (vm_exec): use EXEC_EVENT_HOOK_AND_POP_FRAME() while 	  exception
handling. While exception handling, if an exception 	  is raised in hooks,
need to pop current frame and raise this 	  raised exception by hook.</p>

<p>* test/ruby/test_settracefunc.rb: add a test.</p>

<p>Tue Dec 25 21:08:53 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/init.rb, lib/irb/lc/ja/error.rb, lib/irb/lc/error.rb: 	  raise
exception when illegal RC_NAME_GENERATOR defined [Bug #6455].</p>

<p>Tue Dec 25 19:22:17 2012  Keiju Ishitsuka  &lt;keiju@ishitsuka.com&gt;</p>

<p>* lib/irb/workspace.rb: define method to private on top-level irb 	  [Bug
#5776]. Patch by davidbalbert.</p>

<p>Tue Dec 25 19:09:51 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* bignum.c, include/ruby/intern.h (rb_big_eql): exported.</p>

<p>* thread.c (recursive_check): object_id maybe a Bignum, not Fixnum on 	 
LLP64.  see also r38493 and r38548. 	  reported by Heesob Park at
[ruby-core:51083] [Bug #7607], and patched 	  by shirosaki at
[ruby-core:51095]</p>

<p>Tue Dec 25 18:53:35 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h, eval_intern.h (CHECK_STACK_OVERFLOW): move 	 
CHECK_STACK_OVERFLOW() to vm_core.h and rename to 	 
CHECK_VM_STACK_OVERFLOW(). 	  This change is only move and rename.</p>

<p>* tool/instruction.rb: catch up above changes.</p>

<p>* vm.c, vm_insnhelper.c: ditto.</p>

<p>* vm_insnhelper.c (vm_stackoverflow): add a function to unify 	  raising
vm stackoverflow exception.</p>

<p>Tue Dec 25 16:16:54 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h (RUBY_VM_THREAD_VM_STACK_SIZE): change default 	  VM stack
size (128 KB or  256 KB -&gt; 512 KB or 1024 KB). 	  This re-sizing
corrects smaller value introduced at r38478. 	  Newer value is same VM
stack size of Ruby 1.9. 	  [ruby-dev:46797] [ruby-trunk - Bug #7603]</p>

<p>Tue Dec 25 13:38:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (compile_err_append, compile_warn_print, warn_print): use 	 
rb_write_error_str() instead of writing to rb_stderr directly.</p>

<p>* io.c (rb_write_error_str): a stopgap measure not to unblock GVL. 	 
warning from require seems to still have race condition errors.</p>

<p>Tue Dec 25 00:59:29 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* node.h (NODE_OP_CDECL), compile.c (iseq_compile_each), 	  parse.y (stmt,
arg): allow scoped constant op-assignment. 	  [ruby-core:40154] [Bug #5449]</p>

<p>Mon Dec 24 04:56:48 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http/generic_request.rb (Net::HTTPGenericRequest): 	  set
content-length to zero on empty post requests 	  by Gregory Ostermayr
&lt;gregory.ostermayr@gmail.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/201">github.com/ruby/ruby/pull/201</a>
fix GH-201</p>

<p>Sun Dec 23 19:09:16 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c: rename methods: 	    from Thread.async_interrupt_timing to
Thread.handle_interrupt, 	    from Thread.async_interrupted? to
Thread.pending_interrupt?. 	  Also rename option from `defer&#39; to
`never&#39;. 	  [ruby-core:51074] [ruby-trunk - Feature #6762]</p>

<p>* vm_core.c, thread.c: rename functions and data structure 	 
`async_errinfo&#39; to `pending_interrupt&#39;.</p>

<p>* thread.c: add global variables sym_immediate, sym_on_blocking and 	 
sym_never.</p>

<p>* cont.c, process.c, vm.c, signal.c: ditto.</p>

<p>* lib/sync.rb, lib/thread.rb: catch up this renaming.</p>

<p>* test/ruby/test_thread.rb: ditto.</p>

<p>Sun Dec 23 17:57:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/profiler.rb (Profiler__::PROFILE_PROC, print_profile): store 	 
profile data per threads for concurrent-execution. 	  [ruby-core:22046]
[Bug #1152]</p>

<p>* lib/profiler.rb (Profiler__::Wrapper): support calling singleton 	 
methods of an instance of BasicObject.</p>

<p>* lib/profiler.rb (Profiler__::PROFILE_PROC): use TracePoint.</p>

<p>Sun Dec 23 16:13:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/erb.rb: typos for ERB::new link</p>

<p>Sun Dec 23 16:06:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/erb.rb: Document ERB::new trim_mode &#39;-&#39; for lines ending in
-%&gt; 	  [ruby-core:51084] [Bug #7608]</p>

<p>Sun Dec 23 15:25:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb/ruby-lex.rb: Add handling for %i and %I quoting to irb 	  Patch
by flori [ruby-core:49550] [Bug #7392] [Github Issue #157]</p>

<p>Sun Dec 23 15:05:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (rb_check_funcall_with_hook): rb_check_funcall with hook 	 
which is called before calling method_missing or target method.</p>

<p>* marshal.c (w_object, r_object0): use rb_check_funcall_with_hook 	 
instead of respond_to? and call.</p>

<p>Sun Dec 23 14:52:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* re.c (rb_reg_eqq): doc: #=== is not a synonym for #=~, added example 	 
[ruby-dev:46746] [Bug #7571]</p>

<p>Sun Dec 23 14:35:13 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (BLOCKING_REGION): if fail_if_interrupted is false ignore 	 
the result of blocking_region_begin(), since it always is true in 	  that
case.  suppress “uninitialized” warnings.</p>

<p>Sun Dec 23 09:34:07 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/check_command.rb:  Added –doctor and –dry-run 	 
options to clean up after failed uninstallation. 	*
test/rubygems/test_gem_commands_check_command.rb:  Test for above.</p>

<p>* lib/rubygems/commands/push_command.rb:  Allow pushes from RubyGems 	 
2.0.0.preview3</p>

<p>* lib/rubygems/commands/update_command.rb:  Use Gem.ruby_version</p>

<p>* lib/rubygems/dependency.rb:  Update style.</p>

<p>* lib/rubygems/installer.rb:  Ensure installed gem specifications will 	 
be useable.  Refactor. 	* test/rubygems/test_gem_installer.rb:  ditto.</p>

<p>* lib/rubygems/validator.rb:  Fixed bug with unreadable files.</p>

<p>* lib/rubygems.rb:  Fixed broken methods. 	* test/rubygems/test_gem.rb: 
Test for above.</p>

<p>* test/rubygems/test_gem_commands_push_command.rb:  Fixed overridden 	 
Gem.latest_rubygems_version</p>

<p>Sun Dec 23 01:52:01 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* io.c (rb_io_lines, rb_io_bytes, rb_io_chars, rb_io_codepoints): 	 
Deprecate IO#<code>lines,bytes,chars,codepoints</code> and those of ARGF. 	  [Feature
#6670]</p>

<p>* ext/stringio/stringio.c (strio_lines, strio_bytes, strio_chars) 	 
(strio_codepoints): Deprecate 	  StringIO#<code>lines,bytes,chars,codepoints</code>.
[Feature #6670]</p>

<p>* ext/zlib/zlib.c (rb_gzreader_lines, rb_gzreader_bytes): 	  Deprecate
Zlib::GzipReader#<code>lines,bytes</code>. [Feature #6670]</p>

<p>Sat Dec 23 01:35:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/optparse.rb: Documentation for OptionParser to remove &#39;shadowed
	  outer local variable&#39; from example and make obvious ARGV with 	 
non-option arguments. 	  Patch by Marcus Stollsteimer [ruby-core:47460]
[Bug #6997]</p>

<p>Sat Dec 23 00:08:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* include/ruby/intern.h: add the prototype declaration of 	 
rb_num_coerce_bit.</p>

<p>* numeric.c (rb_num_coerce_bit): the new coerce function for bitwise 	 
binary operation.</p>

<p>* bignum.c (rb_big_and): use coerce to convert the argument, which
isn&#39;t 	  a Fixnum nor a Bignum, to the corresponding Integer object so
that 	  bitwise operations can support Integer-mimic objects. 	  [Bug
#1792] [ruby-core:39491]</p>

<p>* bignum.c (rb_big_or): ditto.</p>

<p>* bignum.c (rb_big_xor): ditto.</p>

<p>* numeric.c (bit_coerce): ditto.</p>

<p>* numeric.c (fix_and): ditto.</p>

<p>* numeric.c (fix_or): ditto.</p>

<p>* numeric.c (fix_xor): ditto.</p>

<p>* test/ruby/test_integer.rb: add tests for the above changes.</p>

<p>* test/ruby/test_bignum.rb: ditto.</p>

<p>Sun Dec 23 00:04:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h (QUOTE, QUOTE_ID): quote unprintable chars in strings and 	 
IDs. [Bug #7574] [ruby-dev:46749]</p>

<p>* string.c (rb_str_quote_unprintable): ditto.</p>

<p>Sat Dec 22 23:59:18 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_compile_error, rb_compile_warn, rb_compile_warning), 	 
(rb_warn, rb_warning): support PRIsVALUE.</p>

<p>Sat Dec 22 22:04:58 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* cont.c (rb_fiber_start): unify conditions.</p>

<p>Sat Dec 22 21:47:55 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_io_wait_writable): use rb_thread_check_ints() instead 	  of
rb_thread_fd_writable(). 	* io.c (rb_io_wait_readable): ditto.</p>

<p>Sat Dec 22 20:31:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_mod_const_get): symbol cannot be nested constant name.</p>

<p>Sat Dec 22 19:26:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_mod_const_get): check more strictly.  [ruby-dev:46748] 	 
[Bug #7573]</p>

<p>Wed Dec 19 02:34:48 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* cont.c (rb_fiber_start): in case of jump with TAG_FATAL, 	  enqueue
error into async_errinfo_queue, because you cannot call 	  TH_TAG_JUMP() in
this function. [ruby-dev:45218]  [Bug #5993]</p>

<p>* thread.c (rb_threadptr_execute_interrupts): now INT2FIX(TAG_FATAL) 	 
can be popped from async_errinfo_queue.</p>

<p>* vm.c (rb_vm_make_jump_tag_but_local_jump): revert r38441. 	 
rb_vm_make_jump_tag_but_local_jump() shouldn&#39;t return exception 	  in
case of state == TAG_FATAL.</p>

<p>* test/ruby/test_fiber.rb (test_exit_in_fiber): fix a test to illuminate 	
Thread.exit should terminate current Thread.</p>

<p>Sat Dec 22 13:15:08 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* gc.c (obj_id_to_ref): add a macro to treat Bignum object id. 	  This
follows the change r38493.</p>

<p>* gc.c (id2ref): fix for working fine with Bignum object id on x64 	 
Windows. 	* gc.c (wmap_finalize): ditto.</p>

<p>Sat Dec 22 11:30:21 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* struct.c (make_struct): remove junk ID check to allow members who 	 
have junk name like “foo000”. 	* test/ruby/test_struct.rb: Test for above.
	  [Bug #7575] [ruby-dev:46750]</p>

<p>Sat Dec 22 05:34:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Requests may be created with a URI which sets the 	 
Host header.  Responses contain the requested URI for easier redirect 	 
following.  [ruby-trunk - Feature #6482] 	*
lib/net/http/generic_request.rb:  ditto. 	* lib/net/http/response.rb: 
ditto. 	* NEWS (net/http):  Updated for above. 	*
test/net/http/test_http.rb:  Tests for above. 	*
test/net/http/test_http.rb:  ditto. 	* test/net/http/test_httpresponse.rb: 
ditto.</p>

<p>Sat Dec 22 02:35:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb/slex.rb(#match): Typo, should be D_DETAIL 	  [ruby-core:51071]
[Bug#7600]</p>

<p>Sat Dec 22 02:29:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb/input-method.rb, lib/irb.rb: Typo in 	 
InputMethod#readable_atfer_eof? to #readable_after_eof? 	 
[ruby-core:51069] [Bug #7599]</p>

<p>Sat Dec 22 02:19:38 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm_dump.c (rb_vm_bugreport): revert r38533. 	* addr2line.c (fill_lines):
add ELF sanity check. 	  [Bug #7597] [ruby-dev:46786]</p>

<p>Sat Dec 22 02:05:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb/inspector.rb, lib/irb/context.rb: Move IRB::INSPECTORS and 	 
class methods to IRB::Inspector [ruby-core:51067][Bug #7598]</p>

<p>Sat Dec 22 00:28:46 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* object.c (rb_obj_hash): shouldn&#39;t assume object_id can be long. 	 
based on a patch by Heesob Park at [ruby-core:51060]. 	  cf. [Backport
#7454]</p>

<p>Fri Dec 21 23:15:25 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* ext/fiddle/lib/fiddle/struct.rb (Fiddle::CStructEntity#set_ctypes): 	 
CPtr -&gt; Pointer. 	* test/fiddle/test_c_struct_entry.rb 	 
(Fiddle::TestCStructEntity#test_aref_pointer): 	  Added the test for the
above.</p>

<p>Fri Dec 21 23:12:05 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* ext/fiddle/lib/fiddle/struct.rb (Fiddle::CStructEntity#set_ctypes): 	 
CPtr -&gt; Pointer. 	* test/fiddle/test_c_struct_entry.rb 	 
(Fiddle::TestCStructEntity#test_aref_pointer_array): 	  Added the test for
the above.</p>

<p>Fri Dec 21 22:43:36 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* ext/fiddle/lib/fiddle/import.rb (Fiddle::Importer#sizeof): 	  CPtr -&gt;
Pointer. 	* test/fiddle/test_import.rb (Fiddle::TestImport#test_sizeof): 	 
Added the test for the above.</p>

<p>Fri Dec 21 22:34:17 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_iseq.rb: disable a test which checks features 	  removed
at r38532.</p>

<p>Fri Dec 21 22:02:00 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/dirdir.h,win32dir.h,win32.c (rb_w32_readdir): removed old rb_w32_readdir() 	 
and renamed from rb_w32_readdir_with_enc(). 	  [ruby-core:24864] [Feature
#1927]</p>

<p>* dir.c (READDIR): follow above change.</p>

<p>Fri Dec 21 21:12:54 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* vm_dump.c (rb_vm_bugreport): commentout addr2line call temporarily 	  in
order to avoid segv. anyone can fix addr2line? 	  [Bug #7597]
[ruby-dev:46786]</p>

<p>Fri Dec 21 20:38:28 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (Init_ISeq): remove definition of the following methods: 	 
ISeq#line_trace_all and ISeq#line_trace_specify because they are 	  half
baked. 	  C APIs are remained as experimental. These functions will be 	 
renamed, removed their parameters may be changed. 	  You can use these
methods by C exts. Please give us your comments.</p>

<p>Fri Dec 21 20:21:04 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (tracepoint_new): add code to support specified thread. 	 
But not tested and this feature is not supported officially.</p>

<p>Fri Dec 21 19:37:15 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ruby.c (process_options): need to acquire env from TOPLEVEL_BINDING 	 
each time. 	  `bind-&gt;env&#39; may update after `eval()&#39;. 	   [Bug
#7536]</p>

<p>Fri Dec 21 18:46:50 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/debug.h, vm_core.h: define rb_trace_arg_t at 	 
include/ruby/debug.h (move from vm_core.h).</p>

<p>Fri Dec 21 17:48:15 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h, vm_trace.c: fix multi-threading bug for tracing. 	  Move
`trace_arg&#39; from rb_tp_t::trace_arg to rb_thread_t::trace_arg. 	 
`trace_arg&#39; may changed by multiple threads. 	  rb_thread_t::trace_arg
can represent rb_thread_t::trace_running 	  (null or non-null) and
rb_thread_t::trace_running is removed. 	  After that, `rb_tp_t&#39; is not
needed to check tracing or not 	  (A running thread knows tracing or not).
This is why I remove 	  tp_attr_check_active() and make new function
get_trace_arg().</p>

<p>And this modification disable to work the following code: 	   
TracePoint.trace{|tp| 	      Thread.new{p tp.event} # access `tp&#39; from
other threads. 	    } 	  I believe nobody mix threads at trace procedure. 	
This is current limitation. 	  [Bug #7590]</p>

<p>* cont.c (fiber_switch, rb_cont_call): use rb_thread_t::trace_arg 	 
instead of rb_thread_t::trace_running.</p>

<p>* test/ruby/test_settracefunc.rb: add a multi-threading test.</p>

<p>Fri Dec 21 16:38:08 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* template/id.h.tmpl (ID2ATTRSET): compile time constant macro for 	 
ID_ATTRSET.</p>

<p>* defs/id.def (KeywordError): check duplication.</p>

<p>* defs/id.def: support for other scope IDs, 	 
ID_<code>INSTANCE,GLOBAL,CONST,CLASS</code>.</p>

<p>Fri Dec 21 14:45:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb.rb, lib/irb/*: Documentation for IRB</p>

<p>Fri Dec 21 11:31:02 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rake/*:  Updated to rake 0.9.6 	* doc/rake/*:  ditto 	* test/rake/*:
ditto</p>

<p>Fri Dec 21 08:56:34 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* vm_trace.c (rb_suppress_tracing): remove unused variable
&#39;vm_tracing&#39;</p>

<p>Fri Dec 21 01:01:45 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* lib/irb/completion.rb (CompletionProc): support completion of 	 
instance variables. [ruby-dev:46710] [Bug #7520]</p>

<p>Thu Dec 20 20:58:25 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* vm_trace.c (rb_suppress_tracing): bugfix for vm-&gt;trace_running 	 
counter. And if tracing is already true, vm_trace_running ops is 	  skipped
to control overflow.</p>

<p>Thu Dec 20 18:29:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RTEST, NIL_P): make bare expressions without 	 
outermost parentheses.</p>

<p>Thu Dec 20 17:29:00 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* NEWS: fix the description for Refinements.</p>

<p>Thu Dec 20 16:53:59 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_core.h (rb_vm_defineclass_type_t), 	  compile.c (iseq_compile_each),
insns.def (defineclass): change the 	  meaning of the third operand of
defineclass as follows: 	    lower 3bits: the type of the defineclass 	    
0 = class, 1 = singleton class, 2 = module 	    4th bit: a flag represents
whether the defineclass is scoped 	               0 = not scoped (e.g.,
class Foo) 		       1 = scoped (e.g., class Bar::Baz) 	    5th bit: a flag
represents whether the superclass is specified 	               0 = not
specified (e.g., class Foo) 	               1 = specified (e.g., class Bar
&lt; Foo) 	  If the superclass is specified and is not a class, a TypeError
	  should be raised.  [ruby-dev:46747] [Bug #7572]</p>

<p>* test/ruby/test_class.rb: related test.</p>

<p>Thu Dec 20 16:52:37 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* NEWS: announce AEAD encryption support in the OpenSSL extension.</p>

<p>Thu Dec 20 16:40:13 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* gc.c (nonspecial_obj_id): VALUE is not compatible with Fixnum on 	 
LLP64 platform, such as 64bit Windows. 	  reported by Heesob Park at
[ruby-core:50255] [Bug #7454], and the 	  fix is suggested by akr.</p>

<p>Thu Dec 20 16:39:04 2012  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/ossl_cipher.c: fix errors for installations that do not 	 
feature Authenticated Encryption. 	* ext/openssl/extconf.rb: detect
presence of EVP_CTRL_GCM_GET_TAG to 	  determine whether Authenticated
Encryption can be used. 	  [Feature #6980] [ruby-core:47426]</p>

<p>Thu Dec 20 15:55:46 2012  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/ossl.c: do not use FIPS_mode_set if not available. 	*
test/openssl/utils.rb: revise comment about setting FIPS mode to 	  false.
	* test/openssl/test_fips.rb: remove tests that cause errors on 	  ruby-ci.
	  [Feature #6946] [ruby-core:47345]</p>

<p>Thu Dec 20 15:22:59 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/parser/ruby.rb:  Ignore methods defined on constants to 	 
prevent modules with the names of constants from appearing in the 	 
documentation. 	* test/rdoc/test_rdoc_parser_ruby.rb:  Test for the above.</p>

<p>Thu Dec 20 15:00:33 2012  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/ossl_cipher.c: add support for Authenticated Encryption 	 
with Associated Data (AEAD) for OpenSSL versions that support the 	  GCM
encryption mode. It&#39;s the only mode supported for now by OpenSSL 	 
itself. Add Cipher#authenticated? to detect whether a chosen mode 	  does
support Authenticated Encryption. 	* test/openssl/test_cipher.rb: add tests
for Authenticated Encryption. 	  [Feature #6980] [ruby-core:47426] Thank
you, Stephen Touset for 	  providing a patch!</p>

<p>Thu Dec 20 12:56:53 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/markup/to_html.rb (class RDoc):  Added current heading and 	 
top links to headings. 	* lib/rdoc/generator/template/darkfish/rdoc.css: 
ditto 	* test/rdoc/test_rdoc_generator_markup.rb:  Test for above 	*
test/rdoc/test_rdoc_markup_to_html.rb:  ditto</p>

<p>* test/rdoc/test_rdoc_comment.rb:  Removed trailing whitespace.</p>

<p>Thu Dec 20 11:05:26 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_valid_syntax): move from 	  test_syntax.rb.</p>

<p>* test/ruby/envutil.rb (assert_normal_exit): validate syntax before 	 
running because this assertion passes even if the code fails by 	 
SyntaxError.</p>

<p>Thu Dec 20 10:29:58 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_pkey_dh.rb: revert special treatment of 	 
FIPS-capable installations since FIPS mode is now disabled for the 	 
tests.</p>

<p>Thu Dec 20 10:23:12 2012  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/ossl.c: add OpenSSL.fips_mode= to allow enabling FIPS 	 
mode manually. 	* test/openssl/utils.rb: turn off FIPS mode for tests. This
prevents 	  OpenSSL installations with FIPS mode enabled by default from
raising 	  FIPS-related errors during the tests. 	*
test/openssl/test_fips.rb: add tests for FIPS-capable OpenSSL 	 
installations. 	  [Feature #6946] [ruby-core:47345]</p>

<p>Thu Dec 20 06:59:52 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c: support variable VM/Machine stack sizes. 	  Specified by the
following environment variables: 	    - RUBY_THREAD_VM_STACK_SIZE: vm stack
size used at thread creation. 	      default: 128KB (32bit CPU) or 256KB
(64bit CPU). 	    - RUBY_THREAD_MACHINE_STACK_SIZE: machine stack size used
at thread 	      creation. default: 512KB or 1024KB. 	    -
RUBY_FIBER_VM_STACK_SIZE: vm stack size used at fiber creation. 	     
default: 64KB or 128KB. 	    - RUBY_FIBER_MACHINE_STACK_SIZE: machine stack
size used at fiber 	      creation. default: 256KB or 256KB. 	  This values
are specified at launched timing. You can not change 	  these values at
running time. 	  Environ variables are only <strong>hints</strong> because:
	    - They are aligned to 4KB. 	    - They have minimum values (depend on
OSs). 	    - Machine stack settings are ignored by some OSs. 	  Default
values especially fiber stack sizes are increased. 	  This change affect
Fiber&#39;s behavior: 	    (1) You can run more complex program on a Fiber.
	    (2) You can not make many (thousands) Fibers because of 	        lack
of address space (on 32bit CPU). 	  If (2) bothers you, 	    (a) Use 64bit
CPU with big memory, or 	    (b) Specify RUBY_FIBER_(VM|MACHINE)_STACK_SIZE
correctly. 	  You need to choose correct stack size carefully. These values
	  are completely rely on systems (OS/compiler and so on). 	  [Feature
#4614], [Bug #7212]</p>

<p>* vm_core.h (rb_vm_t::default_params): add to record above settings.</p>

<p>* vm.c (RubyVM::DEFAULT_PARAMS): add new constant to see 	  above setting.</p>

<p>* thread_pthread.c: support RUBY_THREAD_MACHINE_STACK_SIZE.</p>

<p>* cont.c: support RUBY_FIBER_(VM|MACHINE)_STACK_SIZE.</p>

<p>* test/ruby/test_fiber.rb: add tests for above.</p>

<p>* test/ruby/test_thread.rb: ditto.</p>

<p>Thu Dec 20 06:25:44 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_fiber.rb: remove a strange single quote character. 	 
With this character, this script exits by SyntaxError.</p>

<p>Thu Dec 20 01:03:00 2012  Zachary Scott  &lt;zachary@zacharyscott&gt;</p>

<p>* ext/.document: Add missing ext modules to .document 	  Patch by
Ryunosuke SATO [Fixes Github #224]</p>

<p>Wed Dec 19 23:52:16 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ruby.c (load_file_internal): use original C string as the filename 	 
for parser. 	  reported by whiteleaf at [ruby-list:49085] [ruby-dev:46738]
	  [Bug #7562]</p>

<p>Wed Dec 19 23:36:12 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* marshal.c (marshal_dump, marshal_load): fix SEGV during make rdoc 	  and
test failure in TestMarshal#test_gc and test_context_switch 	  on SPARC
Solaris 10 compiled with Oracle Solaris Studio 12.3. 	  [Bug #7591]
[ruby-dev:46772]</p>

<p>Wed Dec 19 19:34:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_mod_const_get): nul byte is invalid as constant name.</p>

<p>Wed Dec 19 17:54:18 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* vm_trace.c (rb_threadptr_exec_event_hooks): get rid of race 	 
condition. [Bug #7589] [ruby-dev:46763]</p>

<p>Wed Dec 19 16:30:28 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/literals.rdoc:  Added 0d decimal format.  Thanks Nobu!</p>

<p>Wed Dec 19 16:19:36 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc:  Fixed typo.  Thanks to Josh Susser.</p>

<p>Wed Dec 19 16:18:22 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/query_command.rb:  Refactored to improve 	 
maintainability. 	* test/rubygems/test_gem_commands_query_command.rb:  Note
default gems 	  in gem list details.</p>

<p>* lib/rubygems/uninstaller.rb:  Detect all gems for uninstallation. 	 
This allows duplicate installs of default gems to be removed. 	*
lib/rubygems/specification.rb:  Allow use of ::each_spec. 	*
lib/rubygems/test_case.rb:  Added install_default_gems. 	*
test/rubygems/test_gem_commands_uninstall_command.rb:  Moved test 	  down
to the uninstaller tests. 	* test/rubygems/test_gem_uninstaller.rb:  Test
for uninstallation of 	  default gems and duplicate default gems.</p>

<p>Wed Dec 19 15:23:50 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc:  Add () around keyword arguments example for 	 
consistency.  Thanks to Josh Susser.</p>

<p>Wed Dec 19 01:51:24 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* vm.c (rb_vm_jump_tag_but_local_jump): remove unnecessary 2nd 	 
argument.</p>

<p>* load.c (rb_load_internal): ditto.</p>

<p>* eval_intern.h (rb_vm_jump_tag_but_local_jump): ditto.</p>

<p>Tue Dec 18 18:57:58 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_io_wait_writable): don&#39;t use rb_thread_wait_fd() 	  because
it is for waiting until io readable.</p>

<p>* io.c (rb_io_wait_writable): always use rb_thread_fd_writable() 	 
instead of bare rb_wait_for_single_fd(). we shouldn&#39;t ignore 	  return
value. 	* io.c (rb_io_wait_readable): ditto. always use
rb_thread_wait_fd().</p>

<p>Tue Dec 18 18:55:33 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_wait_fd_rw): fix infinite loop bug. 	 
rb_wait_for_single_fd() never return positive number.</p>

<p>Tue Dec 18 17:24:40 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/encoding.rb:  Do not remove #! line from document when 	 
setting encoding.  This allows ruby executables to be parsed as ruby 	 
files. 	* test/rdoc/test_rdoc_encoding.rb:  Test for above.</p>

<p>* lib/rdoc/parser.rb:  Set the parser file name of ruby executables 	 
correctly. 	* test/rdoc/test_rdoc_parser.rb:  Test for above.</p>

<p>Tue Dec 18 16:46:15 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/literals.rdoc:  Used simplified heredoc example that 	 
doesn&#39;t include method definition.  Added heredoc with backticks.</p>

<p>Tue Dec 18 16:38:51 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/store.rb:  Work around RDoc stores from older versions of 	 
RDoc. 	* test/rdoc/test_rdoc_store.rb:  Test for above.</p>

<p>Tue Dec 18 16:31:20 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/ruby_lex.rb:  Return a TkHEREDOC instead of a TkSTRING when 	 
the heredoc identifier is followed by a line-end.  This allows proper 	 
display of some HEREDOCs in source view. 	* lib/rdoc/ruby_token.rb:  Added
TkHEREDOC 	* test/rdoc/test_rdoc_ruby_lex.rb:  Test for above.</p>

<p>Tue Dec 18 09:45:14 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* vm.c (rb_vm_make_jump_tag_but_local_jump): take care of the case 	 
TAG_JUMP() with TAG_FATAL (ex. rb_fatal()). [ruby-core:50917] 	  [Bug
#7570]</p>

<p>* test/ruby/test_fiber.rb (test_fatal_in_fiber): add a test for above.</p>

<p>* ext/-test-/fatal/extconf.rb, ext/-test-/fatal/rb_fatal.c: ditto.</p>

<p>Tue Dec 18 13:17:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* vm_trace.c (tracepoint_attr_defined_class): Clean up rdoc for 	 
TracePoint#defined_class</p>

<p>Tue Dec 18 12:15:59 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/specification.rb:  Fixed ruby output of requirements 	 
with multiple version specifiers. 	*
test/rubygems/test_gem_ext_cmake_builder.rb:  Only look for specific 	 
lines in cmake output.  Should fix [ruby-trunk - Bug #7579]</p>

<p>Tue Dec 18 11:45:26 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/literals.rdoc:  Added 0o octal integers.</p>

<p>Tue Dec 18 12:28:52 2012  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* test/openssl/test_ssl.rb: Use :TLSv1_2_client explicitly in 	 
test_tls_v1_2 to prevent upstream bug. 	  [Bug #7197] [ruby-dev:46240]</p>

<p>Tue Dec 18 11:52:34 2012  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/lib/ssl.rb: Enable insertion of empty fragments as a 	 
countermeasure for the BEAST attack by default. The default options 	  of
OpenSSL::SSL:SSLContext are now: 	  OpenSSL::SSL::OP_ALL &amp;
~OpenSSL::SSL::OP_DONT_INSERT_EMPTY_FRAGMENTS 	  [Bug #5353]
[ruby-core:39673]</p>

<p>* test/openssl/test_ssl.rb: Adapt tests to new SSLContext default.</p>

<p>* NEWS: Announce the new default.</p>

<p>Tue Dec 18 06:36:12 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* method.h: remove `VM_METHOD_TYPE_CFUNC_FRAMELESS&#39; method type. 	 
This method type is for optimized CFUNC such as Fixnum#+ and so on. 	  This
feature is half-baked and no way to use them. 	  [Background] 	  Now, VM
has opt_plus instructions to optimize `+&#39; methods for 	  some Classes
(such as Fixnum, Float (flonum)). We call this 	  type of instructions as
`specialized instructions&#39;. 	  This simple technique improve simple
program dramatically. 	  However, we can make specialized instructions for
only several 	  types (classes) and selectors (method names) because a
large 	  instruction will be slow. In other words, this technique has no 	 
extensibility. 	  To overcome this problem, VM_METHOD_TYPE_CFUNC_FRAMELESS
was 	  introduced (r37198). This type is a variant of CFUNC, but called 	 
their functions directly without building a method frame. 	  Any CFUNC
method can be defined as frameless methods if a method 	  is not needed to
make method frame. Frameless methods are faster 	  as specialized
instructions (a bit slower, but no need to care). 	  No problem described
at 	  <a
href="http://charlie.bz/blog/why-do-singleton-methods-make-ruby-slow">charlie.bz/blog/why-do-singleton-methods-make-ruby-slow</a>
	  because this technique doesn&#39;t see class, but see method body 	 
itself. Alias is also no problem. 	  [Problem] 	  However, we can&#39;t set
frameless method type for polymorphic methods 	  such as Array#[].
Necessity for method frame depends on which 	  parameter type. For example,
Fixnum#+ needs method frame if 	  coerce is needed. Current
VM_METHOD_TYPE_CFUNC_FRAMELESS is not 	  flexible and need more tuning to
introduce it. 	  Expected behavior of frameless method type may be: 	   
result = optimized_cfunc(params); /* call optimized cfunc */ 	    if
(result == Qundef) { result = normal_cfunc(); } 	  This is why I say this
feature is half-baked. 	  We need to learn primitive method in Smalltalk
more. 	  (I heard this name at RubyConf Taiwan this month. Thanks!) 	 
[Conclusion] 	  I remove this feature and consider again. 	  This feature
goes to next minor (2.1?). 	  Nobody may use this feature and there is no
compatibility issue.</p>

<p>* proc.c (rb_method_entry_arity): ditto.</p>

<p>* vm_eval.c, vm_insnhelper.c, vm_method.c: ditto.</p>

<p>Tue Dec 18 04:58:22 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (fill_id_and_klass): TracePoint#defined_class returns 	 
singleton class. `set_trace_func&#39; passed attached class (which is 	 
attached/modified by singleton class) by 6th block parameter if it 	  is
singleton class. Previous behavior follows this spec. 	  However, this
method named `defined_class&#39; should return singleton 	  class directly
because singleton methods are defined in singleton 	  class. There are no
compatible issue because TracePoint is introduced 	  after 2.0. 	  But
compatibility with `set_trace_func&#39; is broken. This means that 	  you
can not replace all `set_trace_func&#39; code with TracePoint 	  without
consideration of this behavior. 	  [Bug #7554]</p>

<p>* test/ruby/test_settracefunc.rb: change a test to catch up 	  an above
change.</p>

<p>Tue Dec 18 03:03:10 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: speed up node mapping so 	 
common cases are evaluated first.  Thanks Kevin Menard!</p>

<p>Tue Dec 18 02:35:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/optparse.rb: Remove &#39;developer documentation&#39; section from
rdoc 	  Patch by Marcus Stollsteimer [ruby-core:50526][Bug #7504]</p>

<p>Tue Dec 18 02:35:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/matrix.rb (#lup): typo in example [ruby-core:50946][Bug #7582]</p>

<p>Mon Dec 17 18:03:34 2012  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* class.c (rewrite_cref_stack, clone_method): rewrite a method&#39;s cref
	  stack when cloning into a new class to allow lexical const lookup to 	 
work as expected [ruby-core:47834] [Bug #7107] 	* test/ruby/test_class.rb
(class TestClass): related test</p>

<p>Mon Dec 17 13:56:55 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (io_flush_buffer_sync2): avoid to return 0. because 	 
rb_thread_call_without_gvl2 uses 0 internally. 	* io.c
(io_flush_buffer_async2): adapt the above.</p>

<p>Mon Dec 17 12:05:32 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax/methods.rdoc:  Added a description of singleton methods.</p>

<p>Mon Dec 17 11:35:57 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/.document:  Added doc/syntax</p>

<p>Mon Dec 17 11:25:32 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/syntax.rdoc:  Added syntax guide table of contents 	*
doc/syntax/exceptions.rdoc:  Syntax guide for exceptions 	*
doc/syntax/literals.rdoc:  Syntax guide for literals 	*
doc/syntax/methods.rdoc:  Syntax guide for methods</p>

<p>Mon Dec 17 07:59:40 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems.rb:  Updated VERSION</p>

<p>* test/rubygems/test_gem_installer.rb:  Fixed ambiguous first argument 	 
warning.</p>

<p>* test/rubygems/test_gem_rdoc.rb:  RDoc generation depends on installed 	 
version of RDoc.</p>

<p>Sun Dec 16 02:04:41 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (rb_sigaltstack_size): cast sysconf() return value 	 
explicitly. Fix compile error on Mac OS X.</p>

<p>Sun Dec 16 00:39:43 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* cont.c (rb_fiber_start): don&#39;t enqueue Qnil to async_errinfo_queue.
	  rb_vm_make_jump_tag_but_local_jump() could return Qnil (ex. when 	 
finished by Thread.exit). [ruby-dev:45218] [Bug #5993]</p>

<p>* test/ruby/test_fiber.rb (test_exit_in_fiber): add test for it.</p>

<p>Sat Dec 15 23:56:51 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/fiddle/pointer.c (rb_fiddle_ptr2cptr): fix error message 	 
forgotten to be changed from DL to Fiddle.</p>

<p>Sat Dec 15 23:14:32 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (default_handler): remove rb_register_sigaltstack() 	  call.
sigaltstack was already registered when creating threads.</p>

<p>Sat Dec 15 23:08:56 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (rb_sigaltstack_size): new. calculate stack size for 	  sigsegv
handler. enlarge value when x86 or x86_64 on Linux. 	  Linux has very small
MINSIGSTKSZ size (2048 bytes) and 	  our sigsegv routine need 5KiB at
least. [Bug #7141] 	* internal.h: add declaration of rb_sigaltstack_size().
	* vm_core.h: remove ALT_STACK_SIZE definition.</p>

<p>* signal.c (rb_register_sigaltstack): replace ALT_STACK_SIZE with 	 
rb_sigaltstack_size(); 	* gc.c (Init_heap): ditto. 	* vm.c (th_init):
ditto.</p>

<p>Sat Dec 15 18:24:21 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* rational.c (f_round_common): should check overflow.</p>

<p>Sat Dec 15 18:00:00 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* rational.c (float_rationalize): reduced.</p>

<p>Sat Dec 15 14:18:44 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (finish_writeconv): uses rb_write_internal2 if 	 
fptr-&gt;write_lock have.</p>

<p>Sat Dec 15 13:57:08 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_mutex_owned_p): remove static. 	* io.c (io_flush_buffer):
don&#39;t hold mutex if already have. 	  Now recursive lock may occur when
following scenario. 	  fptr_finalize -&gt; finish_writeconv_sync -&gt;
finish_writeconv 	  -&gt; io_fflush.</p>

<p>Sat Dec 15 13:38:30 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (io_flush_buffer): uses io_flush_buffer_async2 instead of 	 
io_flush_buffer_async. 	* io.c (io_flush_buffer_async2): new helper
function for 	  io_flush_buffer. It uses rb_thread_call_without_gvl2()
instead 	  of rb_thread_io_blocking_region. 	* io.c
(io_flush_buffer_sync2): new helper function for 	  io_flush_buffer_async2.</p>

<p>Sat Dec 15 13:04:26 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (internal_write_func2): new helper function for
rb_write_internal2(). 	* io.c (rb_write_internal2): new function. it uses 	
rb_thread_call_without_gvl2() instead of rb_thread_io_blocking_region(). 	*
io.c (rb_binwrite_string): uses rb_write_internal2 instead of 	 
rb_write_internal. [Bug #7134]</p>

<p>Sat Dec 15 12:55:29 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_io_wait_writable): add to call rb_thread_wait_fd() 	  likes
rb_io_wait_readable.</p>

<p>Sat Dec 15 11:54:50 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_io_wait_writable): don&#39;t call rb_thread_fd_writable() 	 
when EINTR. EINTR mean signal interrupt was happen. We don&#39;t 	  need
any wait.</p>

<p>Sat Dec 15 11:53:36 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_wait_fd_rw): remove silly rb_thread_alone() 	 
check.</p>

<p>Sat Dec 15 10:22:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_polling): revert but deprecate.</p>

<p>* include/ruby/intern.h (rb_thread_polling): deprecate.</p>

<p>Sat Dec 15 08:37:01 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_ext_cmake_builder.rb (test_self_build): 	  get
rid of false positive.</p>

<p>Sat Dec 15 08:05:56 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_thread.rb (test_uninitialized, test_backtrace,
	test_thread_timer_and_interrupt, test_thread_join_in_trap,
	test_thread_join_current, test_thread_join_main_thread,
	test_main_thread_status_at_exit, test_thread_status_in_trap,
	test_thread_status_raise_after_kill, test_mutex_owned,
	test_mutex_owned2): move these tests from TestThreadGroup class 	  to
TestThread because they are not thread group tests.</p>

<p>* test/ruby/test_thread.rb (test_thread_status_raise_after_kill): 	  add
t.join.</p>

<p>* test/ruby/test_threadgroup.rb: new file. moved ThreadGroup test 	  from
test_thread.rb.</p>

<p>Sat Dec 15 08:02:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_thread.rb (TestThread::Thread::new.): remove 	 
th.abort_on_exception change. Test template shouldn&#39;t change 	  global
flag. It prevent to test a normal case.</p>

<p>Sat Dec 15 06:15:14 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* configure.in (HAVE_GCC_ATOMIC_BUILTINS):  Set -march=i486 to enable 	 
__sync_val_compare_and_swap.  Patch by KOSAKI Motohiro. 	  [ruby-trunk -
Bug #7485]</p>

<p>Sat Dec 15 03:42:34 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/.document: add fiddle/pointer.c, fiddle/handle.c, and 	 
fiddle/win32/lib as documentation.</p>

<p>Sat Dec 15 03:06:40 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* file.c (rb_file_flock): use rb_thread_wait_for() instead of 	 
rb_thread_polling(). When getting EAGAIN, we need to wait a 	  while even
if no multi threading. 	* thread.c (sleep_for_polling, rb_thread_polling)
removed.</p>

<p>Sat Dec 15 00:03:31 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (rb_f_kill): remove rb_thread_polling() because this 	  has no
good effect and makes meaningless 100ms delay. 1) 	  when sending signal to
another process, waiting has just silly. 	  2) when sending signal to
current process, 100ms is often not 	  enough time to wait. It depend on
kernel behavior. And, 	  rb_thread_polling() doesn&#39;t make sense anyway.
When rb_thread_alone() 	  is true, it doesn&#39;t wait at all and
Process.kill() users don&#39;t 	  expect threading changes Process.kill()
behavior. [Bug #7560]</p>

<p>Fri Dec 14 17:10:57 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_params): parser_tokline to track the line number at 	 
which token started.  [ruby-dev:46737] [Bug #7559]</p>

<p>* parse.y (fcall): operation with starting line number.</p>

<p>* parse.y (command, primary, method_call): point method name line.</p>

<p>* parse.y (gettable_gen): return token line for __LINE__.</p>

<p>Fri Dec 14 16:56:59 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_super_method): remove volatile introduced 	  in
r38365.</p>

<p>* vm_insnhelper.c (vm_call_method): use __forceinline to prevent 	  VC++
to make vm_call_general and vm_call_super_method as the same 	  method. 
Thanks, Heesob Park.  [Bug #7556] [ruby-core:50867]</p>

<p>Fri Dec 14 14:59:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_separately): 	  take
file and line by using caller_locations if not given.</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_separately): 	 
count assertions in separated tests.</p>

<p>Fri Dec 14 14:16:42 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/rubygems_hook.rb:  Fixed generation of documentation. 	 
Disabled rdoc generation by default to match RubyGems defaults. 	  Reduced
diff with RubyGems::RDoc. 	* test/rdoc/test_rdoc_rubygems_hook.rb:  Tests
for the above. 	* test/rubygems/test_gem_rdoc.rb:  ditto.</p>

<p>* lib/rdoc/store.rb:  Removed useless variable assignment</p>

<p>Fri Dec 14 13:58:40 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/rdoc_command.rb:  When overwriting 	 
documentation, remove existing documentation first.</p>

<p>* lib/rubygems/server.rb:  Fixed documentation links. 	*
test/rubygems/test_gem_server.rb:  Test for the above.</p>

<p>* lib/rubygems/rdoc.rb:  Reduced diff with RDoc::RubyGemsHook 	*
test/rubygems/test_gem_rdoc.rb:  ditto</p>

<p>Fri Dec 14 04:08:05 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_separately): 	 
added to execute given test source on separate process, 	  catch its
resulted exception and raise it on main process.</p>

<p>Fri Dec 14 07:43:44 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: quote strings that begin 	 
with non-word characters.  Thanks Alex Tambellini! 	*
test/psych/test_yaml.rb: appropriate test case</p>

<p>Thu Dec 13 23:14:17 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_super_method): a workaround for the 	  failure
of TestRefinement#test_refine_recursion in Windows. 	  See
[ruby-core:50871] for details.</p>

<p>Thu Dec 13 23:10:52  Charlie Somerville 
&lt;charlie@charliesomerville.com&gt;</p>

<p>* object.c (Init_Object): use rb_mod_init_copy for Class#initialize_copy
	* class.c (rb_class_init_copy): rename to class_init_copy_check, performs
type 	  checks on arguments to prevent reinitialization of initialized
class 	  [ruby-core:50869] [Bug #7557] 	* class.c (rb_mod_init_copy): use
class_init_copy_check if receiver is T_CLASS 	* test/ruby/test_class.rb
(class TestClass): related test</p>

<p>Thu Dec 13 16:53:10 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/class_module.rb:  Fixed duplicate comments for classes and 	 
modules from C. 	* test/rdoc/test_rdoc_class_module.rb:  Test for the
above.</p>

<p>* lib/rdoc/parser/c.rb:  Reload C variable names to allow proper 	 
updates of an ri store for C files. 	* lib/rdoc/rdoc.rb:  ditto. 	*
lib/rdoc/store.rb:  ditto. 	* test/rdoc/test_rdoc_parser_c.rb:  Test for
the above. 	* test/rdoc/test_rdoc_store.rb:  ditto.</p>

<p>Thu Dec 13 14:20:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/irb*: merge doc from doc/irb/ird.rd and improve overall 	 
documentation of IRB 	* doc/irb/irb.rd: remove stale documentation</p>

<p>Thu Dec 13 14:10:00 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* marshal.c (r_entry0): don&#39;t taint classes and modules because 	 
Marshal.load just returns the dumped classes and modules. 	  [Bug #7325]
[ruby-core:49198]</p>

<p>* test/ruby/test_marshal.rb: related test.</p>

<p>Thu Dec 13 14:10:13 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_require.rb (TestRequire#test_loaded_features_encoding): 	
need to check compatibility, not equality of encodings.</p>

<p>Thu Dec 13 14:02:15 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* file.c (rb_file_join): check encoding compatibility before joining 	 
strings.</p>

<p>Thu Dec 13 13:06:27 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (umethod_bind): allow another form of method transplanting 	 
from a module via UnboundMethod.  [ruby-core:34267][Feature #4254]</p>

<p>Thu Dec 13 12:07:25 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RB_UNUSED_VAR): new macro to suppress 	  warnings
for unused variables.</p>

<p>* ext/bigdecimal/bigdecimal.c (ENTER): use RB_UNUSED_VAR() to 	  suppress
annoying warnings by -Wunused-but-set-variable in gcc 4.6.</p>

<p>Thu Dec 13 11:22:33 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* method.h: remove “VM_METHOD_TYPE__MAX” from rb_method_type_t. 	 
rb_method_type_t is not a number and “_MAX” causes misunderstanding.</p>

<p>* proc.c (rb_method_entry_arity): ditto.</p>

<p>* vm_eval.c (vm_call0_body): ditto.</p>

<p>* vm_insnhelper.c (vm_call_method): ditto.</p>

<p>Wed Dec 12 21:40:45 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/tmpdir.rb (Dir::Tmpname#create): deal with a prefix name which 	 
starts with tilde as a plain name, not expanding as home directory. 	 
[ruby-core:50793] [Bug #7547]</p>

<p>Wed Dec 12 19:48:59 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json: merge JSON 1.7.5. 	  fix tests and other fixes.</p>

<p>Wed Dec 12 18:30:29 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* class.c (rb_prepend_module): move refined methods from the origin 	  of
a class to the class, because refinements should have priority 	  over
prepended modules.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Wed Dec 12 18:27:09 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* time.c (zone_str): lookup or insert by using st_update() at once.</p>

<p>Wed Dec 12 15:30:11 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: add -fno-omit-frame-pointer if libexecinfo is used. 	  At
least on FreeBSD ruby will crash on getting C backtrace 	  when it is
compiled with other than -O0.</p>

<p>* vm_dump.c: enable backtrace on FreeBSD even if with optimizations.</p>

<p>Wed Dec 12 16:08:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/rdoc/test_rdoc_rdoc.rb
(TestRDocRDoc#test_normalized_file_list_non_file_directory): 	  use
File::NULL for portability if possible.</p>

<p>Wed Dec 12 16:07:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* method.h (rb_method_flag_t): name a magic number for NOEX_SAFE and 	 
NOEX_WITH as NOEX_SAFE_SHIFT_OFFSET.</p>

<p>* method.h (rb_method_type_t, method_optimized_type): C89 forbids a 	 
comma after the last element in enum.</p>

<p>* proc.c (rb_method_entry_arity), vm_eval.c (vm_call0_body), 	 
vm_insnhelper.c (vm_call_method): add VM_METHOD_TYPE__MAX case.</p>

<p>Wed Dec 12 14:16:35 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/class_module.rb:  Added RDoc::ClassModule#documented? which 	 
checks comment_location.  Hide RDoc::ClassModule#comment=. 	*
test/rdoc/test_rdoc_class_module.rb:  Test for above.</p>

<p>* lib/rdoc/generator/template/darkfish/_sidebar_table_of_contents.rhtml: 	
Fix display of the table of contents in the sidebar.</p>

<p>* lib/rdoc/generator/template/darkfish/table_of_contents.rhtml: 	  Use
#comment_location when displaying classes or modules.</p>

<p>* test/rdoc/test_rdoc_store.rb:  Use comment_location.</p>

<p>Wed Dec 12 13:40:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_getivar): no uninitialized instance variables 	 
warnings for non-object if attr method.</p>

<p>Wed Dec 12 06:43:37 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* iseq.c (rb_iseq_parameters): fix limit for optional arguments.</p>

<p>* test/ruby/test_keyword.rb: tests for above.</p>

<p>* vm_core.h (struct rb_iseq_struct): update documentation 	  with keyword
arguments. [Bug #7540] [ruby-core:50735]</p>

<p>Wed Dec 12 03:45:41 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (vm_exec): pass exceptions while handling an exception.</p>

<p>* vm_trace.c (rb_threadptr_exec_event_hooks): propagate exceptions. 	 
revert r38293 partially.</p>

<p>Wed Dec 12 03:09:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sample/test.rb (Progress#initialize): add –verbose option and show 	 
messages in one line unless –verbose is given.</p>

<p>Wed Dec 12 01:47:02 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_using_refinement): make the method table of an iclass 	  for
a refinement that of the refinement, not that of the origin of 	  the
refinement, which is set by rb_include_class_new().  This 	  change is
needed to make module prepend into a refinement work 	  properly.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Wed Dec 12 01:05:04 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/make-snapshot: add –disable-rubygem to both MINIRUBY and RUBY. 	 
On making miniprelude.c, it seems use MINIRUBY. this fixes #7541 	  but
rubygems also needs to be fixed for older rubies.</p>

<p>Wed Dec 12 00:32:11 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* test/dl/test_func.rb (test_name_with_block, test_bind, test_qsort1): 	 
call unbind to release the callback closure because maximum number 	  of
callbacks is limited to DL::MAX_CALLBACK (== 5) with pure DL 	  without
Fiddle.</p>

<p>Wed Dec 12 00:13:34 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/dl/lib/dl/func.rb (DL::Function#unbind, #bound?): suppress 	 
NoMethodError when Fiddle is available. [ruby-core:50756] [Bug #7543] 	*
test/dl/test_func.rb (test_bound*, test_unbind*): tests for the above.</p>

<p>Tue Dec 11 19:38:37 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/fiddle/function.c (Fiddle::Function.new): new keyword argument 	 
:name to set the name attribute. 	* ext/fiddle/lib/fiddle/import.rb
(import_function, bind_function): 	  set function name by using the :name
keyword argument. 	  Re-fixes r38243. [ruby-core:50566] 	*
test/fiddle/test_function.rb (test_name): test for the :name keyword 	 
argument and Fiddle::Function#name.</p>

<p>Tue Dec 11 16:57:33 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* common.mk:  Added –pages-dir to rdoc creation.  Now doc/ items show 	 
up at top-level. 	* .document:  Moved doc/* entries to doc/.document 	*
doc/.document:  ditto</p>

<p>Tue Dec 11 16:44:37 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/options.rb:  Added –page-dir option for moving pages in 	  doc/
to the top-level. 	* lib/rdoc/rdoc.rb:  ditto. 	*
test/rdoc/test_rdoc_options.rb:  Test for the above. 	*
test/rdoc/test_rdoc_rdoc.rb:  ditto.</p>

<p>Tue Dec 11 15:24:05 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/pathname/lib/pathname.rb:  Hide private methods from RDoc.</p>

<p>Tue Dec 11 15:11:29 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/make-snapshot (BASERUBY): add –disable-gem to avoid load gems. 	 
[Bug #7541] [ruby-core:50736]</p>

<p>Tue Dec 11 12:00:19 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/dl/win32/extconf.rb: Fix typo 	  by Santiago Pastorino
&lt;santiago@wyeworks.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/221">github.com/ruby/ruby/pull/221</a>
fix GH-221</p>

<p>Tue Dec 11 01:53:37 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix: alias <code>row|column</code>_size to <code>row|column</code>_count and use 	  the
latter. 	  [Bug #7369] [ruby-core:49409]</p>

<p>Tue Dec 11 00:26:58 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* fix the behavior when a module is included into a refinement. 	  This
change is a little tricky, so it might be better to prohibit 	  module
inclusion to refinements.</p>

<p>* include/ruby/ruby.h (RMODULE_INCLUDED_INTO_REFINEMENT): new flag 	  to
represent that a module (iclass) is included into a refinement.</p>

<p>* class.c (include_modules_at): set RMODULE_INCLUDED_INTO_REFINEMENT 	  if
klass is a refinement.</p>

<p>* eval.c (rb_mod_refine): set the superclass of a refinement to the 	 
refined class for super.</p>

<p>* eval.c (rb_using_refinement): skip the above superclass (the 	  refined
class) when creating iclasses for refinements.  Otherwise, 	  `using
Refinement1; using Refinement2&#39; creates iclasses: 	 
&lt;Refinement2&gt; -&gt; &lt;RefinedClass&gt; -&gt; &lt;Refinement1&gt;
-&gt; RefinedClass, 	  where &lt;Module&gt; is an iclass for Module, so
RefinedClass is 	  searched before Refinement1.  The correct iclasses
should be 	  &lt;Refinement2&gt; -&gt; &lt;Refinement1&gt; -&gt;
RefinedClass.</p>

<p>* vm_insnhelper.c (vm_search_normal_superclass): if klass is an 	  iclass
for a refinement, use the refinement&#39;s superclass instead 	  of the
iclass&#39;s superclass.  Otherwise, multiple refinements are 	  searched
by super.  For example, if a refinement Refinement2 	  includes a module M
(i.e., Refinement2 -&gt; &lt;M&gt; -&gt; RefinedClass, 	  and if
refinements iclasses are &lt;Refinement2&gt; -&gt; &lt;M&gt;&#39; -&gt; 	 
&lt;Refinement1&gt; -&gt; RefinedClass, then super in &lt;Refinement2&gt;
should 	  use Refinement2&#39;s superclass &lt;M&gt; instead of
&lt;Refinement2&gt;&#39;s 	  superclass &lt;M&gt;&#39;.</p>

<p>* vm_insnhelper.c (vm_search_super_method): do not raise a 	 
NotImplementError if current_defined_class is a module included 	  into a
refinement.  Because of the change of 	  vm_search_normal_superclass(), the
receiver might not be an 	  instance of the module(&#39;s iclass).</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Mon Dec 10 18:35:25 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_method_entry_without_refinements): use 	 
rb_resolve_refined_method() to search superclasses if 	 
me-&gt;def-&gt;orig_me is 0.  This change fixes make test-all 	 
TESTS=“json ruby/test_refinement.rb”.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Mon Dec 10 17:59:07 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/fiddle/win32/*: library ports from DL to Fiddle.</p>

<p>* ext/dl/win32/extconf.rb: check fiddle.  often case dl compiled prior 	 
to fiddle, so this change is no meaning.  in most cases, simply 	 
fiddle/win32 overwrite dl/win32.</p>

<p>Mon Dec 10 15:23:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_trace.c (rb_threadptr_exec_event_hooks): exceptions in event 	  hooks
should not propagate outside.</p>

<p>Mon Dec 10 15:11:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_compile_each): count flip-flop state in local iseq 	 
not in each iseqs, so that the keys can be other than hidden 	  strings. 
[ruby-core:47253] [Bug #6899]</p>

<p>* vm_insnhelper.c (lep_svar_get, lep_svar_set, vm_getspecial): store 	 
flip-flop states in an array instead of a hash.</p>

<p>* iseq.c (set_relation): main iseq also can has local scope.</p>

<p>Mon Dec 10 10:36:12 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* lib/irb/magic-file.rb: set a encoding, which is detected from 	  the
file to read, to the internal encoding. 	  [Bug #<a
href="ruby-dev:43036">4281]</a></p>

<p>Mon Dec 10 09:40:19 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/ext/cmake_builder.rb:  Added a builder for cmake. 	*
lib/rubygems/ext.rb:  ditto. 	* lib/rubygems/installer.rb:  ditto. 	*
test/rubygems/test_gem_ext_cmake_builder.rb:  Test for above.</p>

<p>Mon Dec 10 09:13:08 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/package.rb:  Omit directories when packaging gems like 	 
RubyGems 1.8.x 	* test/rubygems/test_gem_package.rb:  Test for above.</p>

<p>Sun Dec  9 17:36:59 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_opt_send): Kernel#send should not use 	 
refinements.</p>

<p>* proc.c (mnew): Kernel#method, Kernel#public_method, 	 
Module#instance_method, and Module#public_instance_method should 	  not use
refinements.</p>

<p>* vm_method.c (rb_method_boundp): Kernel#respond_to? should not use 	 
refinements.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sun Dec  9 06:19:04 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/markdown/entities.rb:  Added documentation.</p>

<p>* lib/rdoc/parser/ruby.rb:  Updated style</p>

<p>* lib/rdoc/ruby_lex.rb:  Parse characters up to u<code>FFFFF</code> 	*
test/rdoc/test_rdoc_ruby_lex.rb:  Test for above.</p>

<p>Sat Dec  8 22:38:35 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_refine): don&#39;t override Module#include.  It&#39;s 	 
unnecessary now because refinements are activated only in refine 	  blocks.</p>

<p>Sat Dec  8 22:33:26 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c: remove Module#refinements.</p>

<p>* test/ruby/test_refinement.rb: remove tests for Module#refinements.</p>

<p>Sat Dec  8 13:17:55 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (top_using): raise a RuntimeError if using is called in a 	 
module definition or a method definition.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sat Dec  8 15:01:35 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/cleanup_command.rb:  Skip default gems when 	 
cleaning up. 	* test/rubygems/test_gem_commands_cleanup_command.rb:  Test
for above.</p>

<p>* lib/rubygems/commands/query_command.rb:  Fixed listing remote gems.</p>

<p>* lib/rubygems/dependency_installer.rb:  Ignore non-files when looking 	 
for local gems. 	* test/rubygems/test_gem_dependency_installer.rb:  Test
for above.</p>

<p>* lib/rubygems/uninstaller.rb:  The user must confirm uninstalling gems 	 
that have dependencies. 	* test/rubygems/test_gem_uninstaller.rb:  Test for
above.</p>

<p>* lib/rubygems.rb (module Gem):  Updated version.</p>

<p>* test/rubygems/*.pem:  Updated to run in FIPS mode. 	*
test/rubygems/test_gem_security.rb:  ditto. 	*
test/rubygems/test_gem_security_signer.rb:  ditto.</p>

<p>Sat Dec  8 12:34:01 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_search_normal_superclass): super in a 	  refinement
always uses the refined class as its superclass.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sat Dec  8 11:59:59 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_refine): raise an ArgumentError if a given 	  block is of
a Proc object.</p>

<p>* vm_insnhelper.c (vm_call_method): store refined methods in inline 	 
cache to improve performance.  It&#39;s safe now because blocks cannot 	 
be yielded with different refinements in the new specification.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sat Dec  8 11:17:53 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_refine), vm_eval.c (rb_yield_refine_block): 	 
Module#refine activates all refinements defined in that module 	  only in a
given block.</p>

<p>* string.c (sym_to_proc, sym_call): don&#39;t use refinements.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sat Dec  8 09:24:42 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl_x509name.c:  Completed documentation for 	 
OpenSSL::X509::Name.</p>

<p>Sat Dec  8 07:57:12 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ext/objspace/objspace.c (iow_size): return size of internal object 	 
for ObjectSpace.memsize_of().</p>

<p>* test/objspace/test_objspace.rb: add a test.</p>

<p>Tue Dec 08 02:39:23 2012  James Edward Gray II 
&lt;james@graysoftinc.com&gt;</p>

<p>* lib/csv.rb: A fix for row comparison by Stephen Wattam.  [Bug #7528]</p>

<p>Sat Dec  8 01:27:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_run_parallel): no need to 	  check
all reports.</p>

<p>Sat Dec  8 00:10:34 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_eval.c (yield_under, eval_under): do not activate refinements 	  of
the receiver in module_eval and instance_eval.</p>

<p>* eval.c (ruby_Init_refinement): undef Class#refine.</p>

<p>* eval.c (ruby_Init_refinement): remove Module#using.</p>

<p>* eval.c (ruby_Init_refinement): main.using should be private.</p>

<p>* eval.c (rb_mod_refine): the argument of Module#refine should not 	  be a
module.</p>

<p>* insns.def (defineclass): do not activate refinements in a class or 	 
module.</p>

<p>Fri Dec  7 23:42:11 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/refinement/refinement.c: include ruby/ruby.h instead of the 	 
declaration of rb_warn().</p>

<p>Fri Dec  7 16:07:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/etc.rd: Removed stale documentation file 	* ext/etc/etc.c:  Merged
documentation from doc/etc.rd and updated 	  rdoc, added documentation for
Etc::Passwd and Etc::Group</p>

<p>Fri Dec  7 16:00:57 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_run_parallel): no need to 	  retry
skipped test.  this fix makes 40% faster the whole test-all 	  with -j5 on
Windows.</p>

<p>Fri Dec  7 14:22:29 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/markup/to_joined_paragraph.rb:  Completed documentation 	*
lib/rdoc/parser/c.rb:  ditto 	* lib/rdoc/parser/changelog.rb:  ditto 	*
lib/rdoc/servlet.rb:  ditto 	* lib/rdoc/store.rb:  ditto</p>

<p>* lib/rdoc/store.rb:  Improved HTML error page.  Completed 	 
documentation</p>

<p>* lib/rdoc/parser/ruby.rb:  Fixed bug attaching a comment to A::B = 42 	*
test/rdoc/test_rdoc_parser_ruby.rb:  Test for above</p>

<p>* test/rdoc/test_rdoc_comment.rb:  Removed garbage</p>

<p>Fri Dec  7 14:03:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/timeout.rb (Timeout#timeout): since async_interrupt_timing 	 
re-raises a deferred exception, replace the timeout exception with 	 
Timeout::Error after it.  [Bug #7503]</p>

<p>Fri Dec  7 13:07:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/forwardable.rd: Remove stale documentation file 	*
lib/forwardable.rb: Merge documentation from doc/forwardable.rd</p>

<p>Fri Dec  7 09:47:35 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* time.c (time_mdump): dump timezone string to private instance variable 	
on marshaling.</p>

<p>* time.c (time_mload): load timezone string from private instance 	 
variable named &#39;zone&#39;.</p>

<p>Fri Dec  7 01:15:07 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/fiddle/lib/fiddle/function.rb (Fiddle::Function#name): new 	 
attribute needed to switch Win32::Registry from DL to Fiddle.</p>

<p>* ext/fiddle/lib/fiddle/import.rb (import_function, bind_function): 	  set
function name to the returned Fiddle::Function object.</p>

<p>Fri Dec  7 00:11:44 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* test/ruby/test_refinement.rb: fix some tests to use neither 	 
Module#using nor Module#module_eval.</p>

<p>Thu Dec  6 23:27:50 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (ruby_Init_refinement): a new function to enable 	  Refinements
with a warning “Refinements are experimental…”.</p>

<p>* ext/refinement/refinement.c, ext/refinement/extconf.rb: a new 	 
extension library to enable Refinements.</p>

<p>Thu Dec  6 18:23:05 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* revised r37993 to avoid SEGV/ILL in tests.  In r37993, a method 	  entry
with VM_METHOD_TYPE_REFINED holds only the original method 	  definition,
so ci-&gt;me is set to a method entry allocated in the 	  stack, and it
causes SEGV/ILL.  In this commit, a method entry 	  with
VM_METHOD_TYPE_REFINED holds the whole original method entry. 	 
Furthermore, rb_thread_mark() is changed to mark cfp-&gt;klass to 	  avoid
GC for iclasses created by copy_refinement_iclass().</p>

<p>* vm_method.c (rb_method_entry_make): add a method entry with 	 
VM_METHOD_TYPE_REFINED to the class refined by the refinement if 	  the
target module is a refinement.  When a method entry with 	 
VM_METHOD_TYPE_UNDEF is invoked by vm_call_method(), a method with 	  the
same name is searched in refinements.  If such a method is 	  found, the
method is invoked.  Otherwise, the original method in 	  the refined class
(rb_method_definition_t::body.orig_me) is 	  invoked.  This change is made
to simplify the normal method lookup 	  and to improve the performance of
normal method calls.</p>

<p>* vm_method.c (EXPR1, search_method, rb_method_entry), 	  vm_eval.c
(rb_call0, rb_search_method_entry): do not use 	  refinements for method
lookup.</p>

<p>* vm_insnhelper.c (vm_call_method): search methods in refinements if 	 
ci-&gt;me is VM_METHOD_TYPE_REFINED.  If the method is called by 	  super
(i.e., ci-&gt;call == vm_call_super_method), skip the same 	  method entry
as the current method to avoid infinite call of the 	  same method.</p>

<p>* class.c (include_modules_at): add a refined method entry for each 	 
method defined in a module included in a refinement.</p>

<p>* class.c (rb_prepend_module): set an empty table to 	 
RCLASS_M_TBL(klass) to add refined method entries, because 	  refinements
should have priority over prepended modules.</p>

<p>* proc.c (mnew): use rb_method_entry_with_refinements() to get 	  a
refined method.</p>

<p>* vm.c (rb_thread_mark): mark cfp-&gt;klass for iclasses created by 	 
copy_refinement_iclass().</p>

<p>* vm.c (Init_VM), cont.c (fiber_init): initialize th-&gt;cfp-&gt;klass.</p>

<p>* test/ruby/test_refinement.rb (test_inline_method_cache): do not skip 	 
the test because it should pass successfully.</p>

<p>* test/ruby/test_refinement.rb (test_redefine_refined_method): new 	  test
for the case a refined method is redefined.</p>

<p>Thu Dec  6 17:29:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_here_document): flush string content between new 	  line
and :string_embexpr.  [ruby-core:48703] [Bug #7255]</p>

<p>Thu Dec  6 16:35:21 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rake/helper.rb:  Load envutil correctly.  Removed useless rescue 	 
for signal propagation tests 	* lib/rake/file_utils.rb:  Prefer the built
ruby. 	* test/rake/test_rake_functional.rb:  ditto</p>

<p>Thu Dec  6 15:20:34 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/context.rb:  Don&#39;t warn for duplicate methods while
loading. 	* test/rdoc/test_rdoc_context.rb:  Test for above.</p>

<p>Thu Dec  6 14:26:22 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/command_manager.rb:  Removed string concatenation 	 
syntax.  [Bug #6265] 	* lib/rubygems/commands/install_command.rb:  ditto 	*
lib/rubygems/commands/uninstall_command.rb:  ditto 	*
lib/rubygems/indexer.rb:  ditto 	* lib/rubygems/security/policy.rb:  ditto
	* lib/rubygems/security.rb:  ditto 	* lib/rubygems/uninstaller.rb:  ditto
	* test/rubygems/test_gem_commands_cert_command.rb:  ditto 	*
test/rubygems/test_gem_package.rb:  ditto 	*
test/rubygems/test_gem_security.rb:  ditto 	*
test/rubygems/test_gem_security_policy.rb:  ditto</p>

<p>Thu Dec  6 14:10:08 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/package.rb:  Set rubygems_version before validation. 	 
Fixes issue with bundler. 	* test/rubygems/test_gem_package.rb:  Test for
above.</p>

<p>* lib/rubygems/remote_fetcher.rb:  Only update the cache when we have 	 
permission.  [ruby-trunk - Bug #7509] 	* lib/rubygems/source.rb (class
Gem):  ditto 	* test/rubygems/test_gem_remote_fetcher.rb:  Test for above.
	* lib/rubygems/test_utilities.rb:  ditto</p>

<p>* lib/rubygems/specification.rb:  Derive base_dir properly for default 	 
gems.  [ruby-trunk - Bug #7496] 	* test/rubygems/test_gem_specification.rb:
Test for above.</p>

<p>* lib/rubygems.rb:  Untaint Dir.pwd when searching for gemdeps files 	 
for operation under $SAFE=1</p>

<p>Thu Dec 06 12:07:11 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c: TracePoint#enable should not cause an error 	  when it is
already enabled. TracePoint#disable is too. 	  [ruby-core:50561]
[ruby-trunk - Bug #7513]</p>

<p>* test/ruby/test_settracefunc.rb: add tests.</p>

<p>Thu Dec  6 07:19:58 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc*:  Improved display of ChangeLog files as HTML. 	* test/rdoc*: 
Test for above.</p>

<p>Thu Dec  6 04:34:19 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_uninterruptible): helper function for providing 	 
temporary async_interrupt_timing(Object =&gt; :defer)</p>

<p>* io.c (rb_f_p): use rb_uninterruptible. 	* io.c (rb_f_p_internal): helper
function for rb_f_p(). 	* io.c (struct rb_f_p_arg): new struct for
rb_f_p_internal.</p>

<p>* test/ruby/test_thread.rb (test_async_interrupt_and_p): test for 	  the
above.</p>

<p>Thu Dec  6 04:27:10 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (io_binwrite): check interrupt before io issue. 	*
test/ruby/test_thread.rb (test_async_interrupt_and_io): 	  test for the
above.</p>

<p>Thu Dec  6 01:10:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (rb_method_call_status): use Qundef as no self instead of 	 
the current self.</p>

<p>* vm_eval.c (send_internal): public_send does not consider how it is 	 
called, as mentioned in r14173.  patched by charliesome (Charlie 	 
Somerville).  [ruby-core:50489] [Bug #7499]</p>

<p>Wed Dec  5 23:50:23 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (getrusage_time): uses clock_gettime() with 	 
CLOCK_PROCESS_CPUTIME_ID when available, which provides a 1ns 	  precision
on linux. [ruby-core:50495] [Bug #7500] 	  patched by Aman Gupta.</p>

<p>Wed Dec  5 22:46:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (rb_vm_make_proc): save the proc made from the given block so 	 
that it will not get collected.  [ruby-core:50545] [Bug #7507]</p>

<p>Wed Dec  5 22:13:57 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/dl/lib/dl/func.rb (DL::Function#bind): When Fiddle is used, 	  @ptr
should be updated. This fixes SEGV raised in DL::Function#call 	  after
calling DL::Function#bind. [Bug #7516] [ruby-dev:46708]</p>

<p>* test/dl/test_func.rb (test_bind): test for the above</p>

<p>Wed Dec  5 18:53:00 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_s_async_interrupt_timing): have to check ints 	 
before jumping out. 	* test/ruby/test_thread.rb
(test_async_interrupt_with_return): add test 	  rescue has to catch a
queued async exception at the time of return. 	* test/ruby/test_thread.rb
(test_async_interrupt_with_break): add test 	  rescue has to catch a queued
async exception at the time of break.</p>

<p>Wed Dec  5 16:54:28 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/memory_status.rb: suppress warning. 	  A patch from NAKAMURA
Usaku.</p>

<p>Wed Dec  5 16:06:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/parser/changelog.rb:  Parse more ChangeLog file variations. 	*
test/rdoc/test_rdoc_parser_changelog.rb:  Test for above.</p>

<p>Wed Dec  5 12:17:11 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/dl/lib/dl/func.rb (DL::Function#initialize, DL::Function#bind): 	 
ABI should be set by using CFunc#calltype even when Fiddle is used. 	  When
Fiddle is used and a block is given, name should not be ignored. 	 
[ruby-core:50562] [Bug #7514]</p>

<p>* ext/dl/lib/dl/import.rb (DL::Importer#bind_function): should respect 	 
abi and name when Fiddle is used.</p>

<p>* test/dl/test_func.rb (test_name_with_block): test for “name” method 	 
with giving a block.</p>

<p>Wed Dec  5 11:55:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/shell.rd, doc/shell.rd.ja: Removed stale doc files 	* lib/shell.rb,
lib/shell/*: Merge and updates docs from doc/shell.rd*</p>

<p>Wed Dec  5 11:42:38 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_settracefunc.rb: disable trace.</p>

<p>Wed Dec  5 11:37:37 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#macro_defined?): use clearly different 	 
strings from conflict markers.</p>

<p>Wed Dec  5 04:25:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/README: Add rdoc modeline directive and formatting libs</p>

<p>Wed Dec  5 04:04:02 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* test/ruby/test_thread.rb (test_async_interrupt_blocking): bugfix 	 
about deferred check</p>

<p>Wed Dec  5 03:35:37 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* vm_core.h (RUBY_VM_CHECK_INTS_BLOCKING): check async queue everytime. 	*
thread.c (sleep_forever): check RUBY_VM_CHECK_INTS_BLOCKING first. 	*
thread.c (sleep_timeval): ditto. 	* test/ruby/test_thread.rb
(test_async_interrupt_blocking): add a test 	  exceptions are correctly
deferred and raised on :on_blocking context.</p>

<p>Wed Dec  5 02:36:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk, defs/id.def, template/id.c.tmpl: generate id.c as well as
id.h.</p>

<p>Wed Dec  5 00:56:21 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_mutex_owned_p): new method that return current 	  thread
have the target mutex or not. [Feature #7505] [ruby-dev:46697] 	*
test/ruby/test_thread.rb (test_mutex_owned, test_mutex_owned2): 	  test for
the above. 	* NEWS: new for the above.</p>

<p>Wed Dec  5 00:05:47 2012  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* lib/erb.rb (make_compiler, add_put_cmd, add_insert_cmd): extract 	 
methods.</p>

<p>Tue Dec  4 18:21:04 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* test/ruby/memory_status.rb (Memory): use fiddle/types if available.</p>

<p>* test/ruby/memory_status.rb (Memory::Win32): :stdcall is needed on 	  x86
WIN32. This commit partly reverts r38054.</p>

<p>Tue Dec  4 18:05:58 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/fiddle/lib/fiddle/types.rb: copied from ext/dl/lib/dl/types.rb 	 
and modified for Fiddle, needed for migration from DL to Fiddle.</p>

<p>Tue Dec  4 17:57:09 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/fiddle/lib/fiddle/import.rb (import_function, bind_function): 	 
should respect call_type for migration from DL to Fiddle. 	  [Bug #7484]
[ruby-core:50405]</p>

<p>Tue Dec  4 16:54:00 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* .document:  Added ChangeLog and doc/ChangeLog-* as documentation</p>

<p>Tue Dec  4 16:47:46 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/parser/changelog.rb:  Added a ChangeLog parser to RDoc. 	*
lib/rdoc/parser.rb:  ditto 	* test/rdoc/test_rdoc_parser_changelog.rb: 
Test for above.</p>

<p>Tue Dec  4 16:23:32 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (path2class, path2module): use PRIsVALUE.</p>

<p>* marshal.c (w_object, marshal_dump, marshal_load): use 	 
rb_check_funcall if possible.</p>

<p>* marshal.c (w_object, marshal_dump, r_object0, marshal_load): use 	 
RB_GC_GUARD() (directly or indirectly) instead of volatile.</p>

<p>* variable.c (rb_path_to_class): prevent the argument from GC.</p>

<p>Tue Dec 04 13:55:07 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_opts.h: enable optimization - operand unification. 	  Operand
unification technique enable to combine 	  an instruction and specific
operands and make new 	  instruction.</p>

<p>* defs/opt_operand.def: add several configuration 	  of operand
unification.</p>

<p>* insns.def: use `int&#39; instead to suppress warning.</p>

<p>Mon Dec  3 17:58:53 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* parse.y: replace parser-&gt;enc with current_enc.</p>

<p>Tue Dec  4 08:33:46 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* README.EXT:  Converted to RDoc format 	* README.EXT.ja:  ditto</p>

<p>Tue Dec  4 08:32:10 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/ri/driver.rb:  Fixed ri page display for files with 	 
extensions. 	* test/rdoc/test_rdoc_ri_driver.rb:  Test for above</p>

<p>Tue Dec  4 04:11:50 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* .document:  Add NEWS for `ri ruby:NEWS` 	* NEWS:  Set format as rdoc 	*
doc/NEWS-1.8.7:  ditto 	* doc/NEWS-1.9.1:  ditto 	* doc/NEWS-1.9.2:  ditto
	* doc/NEWS-1.9.3:  ditto</p>

<p>Mon Dec  3 20:37:22 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_exec.c: check VM_COLLECT_USAGE_DETAILS.</p>

<p>Mon Dec  3 20:28:02 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (iseq_specialized_instruction): 	  change condition of using
`opt_send_simple&#39;. 	  More method invocations can be simple.</p>

<p>Mon Dec  3 20:03:38 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_objectspace.rb: skip RuntimeError 	  which says a message
“can&#39;t modify frozen File”. 	  Is that correct behavior?</p>

<p>Mon Dec 03 20:00:19 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_exec.c: vm_analysis_insn should be static.</p>

<p>Mon Dec  3 19:10:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (Init_Random), rational.c (Init_Rational): make marshal 	 
methods private.  [Feature #6539]</p>

<p>Mon Dec  3 18:29:27 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.h: iseq_catch_table_entry::catch_type should be 	  Fixnum because
they are pushed into Array in a compiler. 	  [Bug #7502]</p>

<p>* test/ruby/test_objectspace.rb: add a test of this issue.</p>

<p>Mon Dec  3 18:25:16 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* template/id.h.tmpl (preserved_ids): “empty?” is not an attribute name.</p>

<p>Mon Dec  3 16:23:09 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c (vm_backtrace_to_ary): check negative size (2nd arg).</p>

<p>Mon Dec  3 15:50:33 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* misc/ruby-additional.el (ruby-mode-set-encoding): Unbreak by 	  fixing a
typo, s/set/setq/.</p>

<p>Mon Dec  3 14:14:19 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (iseq_compile_each): joke shouldn&#39;t use id.h defined ids.</p>

<p>* id.c (Init_id): ditto.</p>

<p>* common.mk: fix dependency.</p>

<p>Mon Dec  3 12:43:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* misc/ruby-mode.el (ruby-block-end-re, ruby-delimiter) 	 
(ruby-mode-syntax-table, ruby-parse-partial, ruby-beginning-of-indent): 	 
merge from Emacs.</p>

<p>* misc/ruby-mode.el (ruby-calculate-indent): fix indentation of 	 
argument lines in parentheses.  [Bug #5140]</p>

<p>Mon Dec  3 07:52:41 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/parser.rb:  Improved modeline support.  Patch by nobu. 	*
test/rdoc/test_rdoc_parser.rb:  Test for above.</p>

<p>Sun Dec  3 00:06:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_new): stop checking string 	 
taintness.  [Bug #5508] [ruby-core:40510]</p>

<p>Sun Dec  2 19:26:47 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* thread.c (RB_GC_SAVE_MACHINE_CONTEXT, rb_gc_save_machine_context): 	 
extract rb_gc_save_machine_context to RB_GC_SAVE_MACHINE_CONTEXT. 	  NOTE:
machine_regs and machine_stack_end must be set in current scope.</p>

<p>Sun Dec  2 18:46:24 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* array.c, enum.c, insns.def, io.c, numeric.c, parse.y, process.c, 	 
range.c: use prepared IDs. 	  A patch from charliesome (Charlie
Somerville). 	  [Bug #7495]</p>

<p>* common.mk: add dependency to id.h.</p>

<p>* common.mk: replace ID_H_INCLUDES with id.h.</p>

<p>Sun Dec  2 16:48:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/weakref.rb (rdoc): Clean up usage, add example, 	  note
ArgumentError on WeakRef.new</p>

<p>Sun Dec  2 16:45:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* gc.c (WeakMap): Add doc for internal reference, use lib/weakref.rb</p>

<p>Sun Dec  2 07:24:23 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/parser.rb:  Parse files with a -*- rdoc -*- modeline 	*
test/rdoc/test_rdoc_parser.rb:  Test for above</p>

<p>Sun Dec  2 06:02:00 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* gc.h (SET_MACHINE_STACK_END): add volatile for preventing 	  harmful
optimization.  [ruby-dev:46665] [Bug #7468]</p>

<p>Sun Dec  2 05:01:58 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (rb_iseq_line_trace_each): iterate `line&#39; event only.</p>

<p>* test/ruby/test_iseq.rb: add a test for this change.</p>

<p>Sun Dec  2 02:46:04 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c: add TracePoint#inspect.</p>

<p>* test/ruby/test_settracefunc.rb: add a test for this change.</p>

<p>Sat Dec  1 21:18:19 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_backtrace.rb: add a test for 	 
Thread::Backtrace::Location#inspect. 	  BTW, tests for
`caller_locations&#39; are not enough. 	  Any volunteers are welcome.</p>

<p>Sat Dec  1 21:06:58 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c (location_inspect_m): add 	 
Thread::Backtrace::Location#inspect. 	  It same as loc_obj.to_s.inspect.</p>

<p>Sat Dec  1 19:24:09 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_puts): recurse for the argument itself, not converted 	 
array elements.  [ruby-core:42444] [Bug #5986]</p>

<p>Sat Dec  1 19:01:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (w_object, r_object0): call private marshal methods. 	 
[Feature #6539]</p>

<p>Sat Dec  1 18:52:22 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/cleanup_command.rb:  Fix cleanup command for 	 
multiple gems.  [ruby-trunk - #7481] by Kouhei Sutou 	*
test/rubygems/test_gem_commands_cleanup_command.rb:  Test for above. 	*
lib/rubygems.rb:  Autoload Gem::Source to prevent test failures</p>

<p>Sat Dec  1 18:17:00 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* complex.c (Init_Complex), time.c (Init_Time): make marshal methods 	 
private.  [Feature #6539]</p>

<p>* object.c (Init_Object): make remove_instance_variable public. 	 
[Feature #6539]</p>

<p>* id.c (Init_id), template/id.h.tmpl: add initialize_<code>copy,clone,dup</code> 	 
and respond_to_missing?.</p>

<p>* vm_method.c (rb_method_entry_make): make above methods private. 	 
[Feature #6539]</p>

<p>Sat Dec  1 16:40:22 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_thread.rb: move ConditionVariable related test 	  into
test/thread/test_cv.rb. 	* test/thread/test_cv.rb: new file. 	*
test/thread/test_cv.rb (test_condvar_empty_signal): new tests. 	*
test/thread/test_cv.rb (test_condvar_empty_broadcast): ditto.</p>

<p>Sat Dec  1 15:14:25 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_thread.rb (test_cv_wait_deadlock): enable 	  cv deadlock
test.</p>

<p>Sat Dec  1 14:23:33 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/thread.rb (ConditionVariable): use hash instead of array for 	 
@waiters. 	* test/thread/test_queue.rb (test_sized_queue_and_wakeup):
remove 	  a test because @waiters no longer have a chance to duplicated.
Now it&#39;s 	  a hash.</p>

<p>Sat Dec  1 17:16:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* misc/ruby-electric.el (ruby-electric-curlies): use kill-region 	 
instead of interactive command delete-backward-char.</p>

<p>Sat Dec  1 17:12:55 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* misc/inf-ruby.el (inferior-ruby-mode): fix the 	 
compilation-shell-minor-mode configuration.  a patch by 	  j2petkov
(Jean-Christophe Petkovich) in [ruby-core:46518]. 	  [Bug #6742]</p>

<p>Sat Dec  1 15:05:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (glob_helper): use NAMLEN() to tell the length of d_name 	 
instead of strlen(), which can access beyond the boundary.</p>

<p>Sat Dec  1 13:48:13 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/specification.rb:  Don&#39;t add default gems to $LOAD_PATH
	  as they are already there.</p>

<p>Sat Dec  1 12:22:17 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* re-added r38053 that is reverted by r38061. Problems by r38053 	  are
resolved by r38096. r38096 removed GEM_SKIP configuration.</p>

<p>The below is ChangeLog of r38053:</p>

<p>* defs/default_gems: Add base directory column.</p>

<p>* tool/rbinstall.rb: 	  - Install .gemspecs of default gem to 	   
#<code>GEM_HOME</code>/specifications/default/. 	  - Update files parameter of
.gemspecs by relative path from 	    library directory.</p>

<p>Sat Dec  1 11:09:12 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* variable.c (rb_class_path_no_cache): add a function to get the class 	 
path without caching the computed path. Some classes are frozen, and 	 
will raise an exception without this.</p>

<p>* probes.d (cmethod-entry, cmethod-return): separate cmethods from 	 
regular methods to match set trace func.</p>

<p>* probes_helper.h: refactor macros.  Fix probes to avoid calling 	 
#inspect when profiling.</p>

<p>* insns.def: update for use with new macros.</p>

<p>* vm_eval.c: ditto</p>

<p>* vm_insnhelper.c: ditto</p>

<p>* test/dtrace/test_singleton_function.rb: fix test for new output.</p>

<p>* test/dtrace/test_cmethod.rb: test the cmethod probes.</p>

<p>Sat Dec  1 09:44:16 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rdoc/test_rdoc_options.rb:  Windows drive letters are 	 
case-insensitive.</p>

<p>Sat Dec  1 09:42:13 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems.rb:  Search for gem deps file up the directory tree. 	*
test/rubygems/test_gem.rb:  Test for above.</p>

<p>Sat Dec  1 09:33:32 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/runner.rb:  Set GEM_HOME, GEM_PATH and GEM_SKIP to empty set. 	 
With default_gem support in RubyGems GEM_SKIP prevents loading of 	 
built-in gems.</p>

<p>Sat Dec  1 07:16:17 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* compile.c (ADD_CATCH_ENTRY): add a cast to fix SEGV with x64 mingw 	  on
Windows 8. Without cast, 0 might be non zero value at higher bits 	  in
rb_ary_new3(). 	  [ruby-core:50258] [Bug #7456]</p>

<p>Sat Dec  1 04:07:57 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* parse.y (parser.utf8): remove unused property.</p>

<p>* parse.y (UTF8_ENC): remove unused macro.</p>

<p>* parse.y (parser_tokadd_utf8): use rb_utf8_encoding() directly.</p>

<p>Sat Dec  1 03:49:45 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/sync.rb (Sync_m#sync_synchronize): add Thread.async_interrupt_timing
	  for protecting from async interrupt. 	* lib/sync.rb (Sync_m#sync_lock):
ditto.</p>

<p>Sat Dec  1 03:38:04 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/thread.rb (ConditionVariable#broadcast):
s/RuntimeError/StandardError/ 	* lib/thread.rb (ConditionVariable#signal):
ditto.</p>

<p>Sat Dec  1 03:29:52 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/thread.rb (SizedQueue#pop): rewrite by using ConditionVariable. 	*
lib/thread.rb (SizedQueue#push): ditto. 	* lib/thread.rb (SizedQueue#max):
ditto. 	* lib/thread.rb (Queue#pop): ditto. 	* lib/thread.rb (Queue#push):
ditto.</p>

<p>* lib/thread.rb (SizedQueue#num_waiting): adopt the above changes. 	*
lib/thread.rb (SizedQueue#initialize): ditto. 	* lib/thread.rb
(Queue#num_waiting): ditto. 	* lib/thread.rb (Queue#initialize): ditto. 	*
test/thread/test_queue.rb (test_sized_queue_and_wakeup): ditto.</p>

<p>Sat Dec  1 03:45:47 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (Thread.async_interrupt_timing): fix RDoc. 	  :never is not
used any more.</p>

<p>Sat Dec  1 02:56:19 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c: add RubyVM::InstructionSequence (ISeq) inspection methods. 	  *
ISeq#path returns path of this ISeq written. 	  * ISeq#absolute_path
returns absolute path. 	  * ISeq#label returns label (method name and so
on). 	  * ISeq#base_label returns base label (see
Thread::Backtrace::Location). 	  * ISeq#first_lineno returns first line
number of this ISeq. 	  * ISeq.of(obj) returns ISeq object which obj (Proc
or Method) 	    is contains.</p>

<p>* test/ruby/test_iseq.rb: add tests.</p>

<p>Sat Dec  1 02:58:51 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* include/ruby/ruby.h (rb_event_flag_t):  Maintain integer precision 	 
for clang error (VALUE aka unsigned long vs unsigned int)</p>

<p>Sat Dec  1 02:53:18 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rubygems/test_gem_dependency_installer.rb:  Use Gem.read_binary 	 
instead of File.binread for ruby 1.8 compatibility in the rubygems 	 
source repository.  Updates r38075</p>

<p>Sat Dec  1 02:33:20 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_threadptr_interrupt_mask, async_interrupt_timing_func): 	 
merge into them into rb_thread_s_async_interrupt_timing. 	* thread.c
(rb_thread_s_async_interrupt_timing): ditto.</p>

<p>Sat Dec  1 02:11:47 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_threadptr_interrupt_mask): add argument check. 	* thread.c
(async_interrupt_timing_arg_check_i): helper function 	  for the above. 	*
test/ruby/test_thread.rb (test_async_interrupt_timing_invalid_argument): 	 
test for the above.</p>

<p>Sat Dec  1 01:19:34 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/thread.rb (ConditionVariable#broadcast): protect from 	  async
interrupt by using Thread.async_interrupt_timing. 	* lib/thread.rb
(ConditionVariable#signal): ditto. 	* lib/thread.rb
(ConditionVariable#wait): ditto.</p>

<p>Sat Dec  1 02:04:23 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_in_out_err): 	 
raise if assert_in_out_err misused.</p>

<p>Sat Dec  1 02:08:16 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rdoc/test_rdoc_rubygems_hook.rb 	 
(TestRDocRubygemsHook#test_setup_unwritable): 1. check the existence 	  of
the file(directory) before touch it.  2. remove test 	  file(directory)
after the test.  see [ruby-core:50388].</p>

<p>Sat Dec  1 01:51:06 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>[EXPERIMENTAL] 	* iseq.c: add following two methods. 	  *
ISeq#line_trace_all returns all line traces (line numbers) 	  *
ISeq#line_trace_specify(pos, set) set `pos&#39;th line event to 	   
specified_line event (if set is true). 	  These features are introduced for
debuggers (mainly to make 	  breakpoint).</p>

<p>* iseq.h: add decl. of C APIs.</p>

<p>* test/ruby/test_iseq.rb: add tests.</p>

<p>* vm_trace.c: add `specified_line&#39; event.</p>

<p>* include/ruby/ruby.h: ditto.</p>

<p>Sat Dec  1 01:49:52 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_dependency_installer.rb: gems are of course 	 
binary files, so use a binary reading method when reading it. 	  see
[ruby-core:50388].</p>

<p>Sat Dec  1 01:21:07 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rubygems/command.rb (Gem::Command#get_all_gem_names_and_versions): 	
who assumes that the pathname of a gem never contains &#39;:&#39; ? 	  yes,
on Unixen pathnames can contain &#39;:&#39;, and on Windows they almost 	 
certainly contain &#39;:&#39;.  see [ruby-core:50388].</p>

<p>* lib/rubygems/requirement.rb (Gem::Requirement::PATTERN_RAW): extract 	 
the regexp to match the version specifier from PATTERN to use in 	  above
method.</p>

<p>Sat Dec  1 00:48:19 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/fiddle/extconf.rb, ext/fiddle/function.c 	 
(Fiddle::Function::STDCALL): FFI_STDCALL is not a macro, but an 	 
enumeration. [ruby-core:50398] [Bug #7483]</p>

<p>Sat Dec  1 00:08:55 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_installer.rb 	 
(TestGemInstaller#test_check_executable_overwrite_other_non_gem): 	  on
Windows, rubygems always generate a wrapper .bat file when 	  installing a
file into bin, so testing no-overwrite a wrapper file 	  and a non-wrapper
file is nonsense.  see [ruby-core:50388].</p>

<p>Fri Nov 30 23:39:58 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_installer.rb 	 
(TestGemInstaller#test_check_executable_overwrite_default_bin_dir): 	  if
the executable to be overwritten was generated by rubygems, the 	  error
message differs from the only copied one&#39;s. 	  see [ruby-core:50388].</p>

<p>Fri Nov 30 23:27:26 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_ext_ext_conf_builder.rb 	 
(TestGemExtExtConfBuilder::test_class_make): reading with binary mode 	  of
course introduce r on Windows.  see [ruby-core:50388].</p>

<p>Fri Nov 30 23:11:37 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rubygems/specification.rb 	 
(Gem::Specification.validate_permissions): don&#39;t check executability 	 
of the source on Windows.  they will be wrapped to .bat files when 	 
installing.  see [ruby-core:50388].</p>

<p>Fri Nov 30 22:44:14 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm_core.h (rb_vm_struct): add thread_destruct_lock field. 	* thread.c
(Init_Thread): ditto. 	* thread.c (rb_vm_gvl_destroy): ditto.</p>

<p>* thread.c (thread_start_func_2): make sure vm-&gt;running_thread 	 
don&#39;t point to dead thread. 	* thread.c (timer_thread_function): close
a race against thread 	  destruction. [Bug #<a
href="ruby-dev:43859">4911]</a></p>

<p>* vm_core.h (rb_thread_set_current): reset running time of 	  current
thread instead of previous thread. We no longer 	  assume previous running
thread still live.</p>

<p>Fri Nov 30 21:57:43 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* revert r38053 because it causes too many test failures. 	  if you&#39;ve
already installed r38053 or later, remove the installed 	 
lib/ruby/gems/2.0.0 directory and reinstall this revision or later.</p>

<p>Fri Nov 30 21:07:56 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/test/unit/parallel.rb (Test::Unit::Worker.run): wrap LoadError 	 
because it&#39;s Gem::LoadError sometimes.  see [Bug #6882]</p>

<p>Fri Nov 30 20:47:44 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c: TracePoint#self returns invoking/exiting thread object 	  at
thread_begin/end event.</p>

<p>* test/ruby/test_settracefunc.rb: fix test.</p>

<p>Fri Nov 30 19:55:17 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/memory_status.rb (Memory::Win32): use fiddle instead of dl, 	 
but I doubt fiddle is not compatible with dl. (if you are interested, 	 
see the diff.)  [ruby-core:50194] [Bug #7443]</p>

<p>Fri Nov 30 19:37:44 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* defs/default_gems: Add base directory column.</p>

<p>* tool/rbinstall.rb: 	  - Install .gemspecs of default gem to 	   
#<code>GEM_HOME</code>/specifications/default/. 	  - Update files parameter of
.gemspecs by relative path from 	    library directory.</p>

<p>Fri Nov 30 19:30:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* vm_trace.c: 	  tracepoint_attr_return_value (TracePoint#return_value): 	
include `:b_return` for method doc 	  tracepoint_enable_m,
tracepoint_disable_m (#enable/#disable): 	    don&#39;t have block
argument, document block scope</p>

<p>Fri Nov 30 18:52:56 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (tracepoint_disable_m, tracepoint_enable_m): 	  fix block
parameter. 	  No argument should be given to a block which is passed 	  to
TracePoint#enable (and disable).</p>

<p>Fri Nov 30 18:23:26 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c: rename Thread.control_interrupt 	  to
Thread.async_interrupt_timing. 	  The option name `:never&#39; is also
changed to  `:defer&#39;. 	  [ruby-core:50375] [ruby-trunk - Feature #6762]</p>

<p>* thread.c: remove Thread.check_interrupt. 	  This method is difficult to
understand by name.</p>

<p>* thread.c: add Thread.async_interrupted?. 	  This method check any
deferred async interrupts.</p>

<p>* test/ruby/test_thread.rb: change tests for above.</p>

<p>Fri Nov 30 18:24:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* vm_trace.c: Documentation for TracePoint API 	  [ruby-core:47243]
[Feature #6895]</p>

<p>Fri Nov 30 17:43:50 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_cmp_m): try to compare with to_str result if 	 
possible before calling &lt;=&gt; method.  [ruby-core:49279] [Bug #7342]</p>

<p>* string.c (rb_str_cmp_m): use rb_check_funcall instead of respond_to 	 
and call.</p>

<p>* string.c (rb_str_cmp_m): return fixed value, one of -1,0,+1 always.</p>

<p>Fri Nov 30 16:19:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_dump.c (rb_vm_bugreport): get rid of calling methods in sigsegv 	 
handler.  based on a patch by charliesome (Charlie Somerville) 	 
[ruby-core:49573] [Bug #7402]</p>

<p>Fri Nov 30 16:05:44 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* NEWS:  Added RubyGems 2.0.0</p>

<p>Fri Nov 30 15:24:37 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_yylex): fix false usage of local variable, it cannot 	 
appear in fname state [ruby-core:49659] [Bug #7408]</p>

<p>Fri Nov 30 15:20:12 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/package.rb:  Load YAML for building gems. 	*
test/rubygems/test_gem_commands_contents_command.rb:  Sort expected 	 
output of default gem contents.  Re-fixes r38004 and r38005.</p>

<p>Fri Nov 30 15:15:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* vm_trace.c (set_trace_func): Formatting of params and events</p>

<p>Fri Nov 30 14:45:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/net/http.rb: Net::HTTP::Patch to list of HTTP Request Classes 	 
Patch by Ryunosuke SATO [Fixes #217 on github]</p>

<p>Fri Nov 30 14:05:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/cgi.rb: CGI example for HTML generation 	  Patch by Marcus
Stollsteimer [ruby-core:50303] [Bug #7465]</p>

<p>Fri Nov 30 13:52:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* time.c: Documentation improvements, grammar and formatting 	  Patch by
Bernd Homuth [ruby-core:49203] [Bug #7326]</p>

<p>Fri Nov 30 13:48:33 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc.rb:  Set version to 4.0.0.preview2 	* lib/rubygems.rb:  Set
version to 2.0.0.preview2</p>

<p>Fri Nov 30 13:11:53 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/setup_command.rb:  Remove old files on install 	 
of RubyGems.  (not by rbinstall.rb). 	*
test/rubygems/test_gem_commands_setup_command.rb:  Test for above.</p>

<p>Fri Nov 30 12:47:59 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/abbrev.rb (Abbrev#abbrev): A fixed string prefix pattern 	  should
only match the beginning of each word, not the beginning 	  of every line
in it.</p>

<p>* lib/abbrev.rb (Abbrev#abbrev): Stop using a regexp that causes a 	 
false warning. [Bug #7471]</p>

<p>Fri Nov 30 12:30:55 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* test/test_abbrev.rb: Add tests for lib/abbrev.rb.</p>

<p>Fri Nov 30 12:27:51 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/spec_fetcher.rb:  Allow prerelease spec fetching to fail 	 
for bundler. 	* test/rubygems/test_gem_spec_fetcher.rb:  Test for above.</p>

<p>Fri Nov 30 12:20:53 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rake/backtrace.rb:  Removed duplication in 	 
Rake::Backtrace::SUPPRESSED_PATHS 	* test/rake/test_rake_backtrace.rb: 
Skip tests when tmpdir is in the 	  suppressed pattern.</p>

<p>Fri Nov 30 11:07:45 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* revert r37993 to avoid SEGV in tests.</p>

<p>Fri Nov 30 10:38:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/ri/driver.rb:  Relaxed matching for pages to be more 	 
user-friendly. 	* test/rdoc/test_rdoc_ri_driver.rb:   Test for above.</p>

<p>Fri Nov 30 09:50:16 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/markdown.rb:  Fixed warnings with -w</p>

<p>Fri Nov 30 09:38:22 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RB_GC_GUARD_PTR): add note.</p>

<p>* vm_backtrace.c (backtrace_to_str_ary): use RB_GC_GUARD() instead of 	 
RB_GC_GUARD_PTR() which has no effect. 	  (backtrace_to_location_ary):
ditto. 	  (vm_backtrace_to_ary): ditto.</p>

<p>Fri Nov 30 09:22:52 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/commands/contents_command.rb:  Sort output from command. 	 
Replaces r38004, r38005 	*
test/rubygems/test_gem_commands_contents_command.rb:  ditto.</p>

<p>* lib/rubygems/defaults.rb:  Use Gem.path_separator for jruby support. 	*
lib/rubygems/path_support.rb:  ditto</p>

<p>Fri Nov 30 08:34:03 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/generator/darkfish.rb:  Silenced warning 	*
test/rdoc/test_rdoc_rdoc.rb:  ditto</p>

<p>* lib/rdoc/markup/parser.rb:  Use byteslice when available for 	 
performance 	* test/rdoc/test_rdoc_markup_parser.rb:  Test for above 	*
lib/rdoc/test_case.rb:  ditto</p>

<p>* lib/rdoc/parser/ruby.rb:  Fixed bug parsing yield({}) 	*
test/rdoc/test_rdoc_parser_ruby.rb (end):</p>

<p>* lib/rdoc/rubygems_hook.rb:  Skip default gems.  Display generator 	 
name properly. 	* test/rdoc/test_rdoc_rubygems_hook.rb:  Test for above</p>

<p>* lib/rdoc/servlet.rb:  Fixed typo.</p>

<p>Fri Nov 30 08:09:56 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c : remove a unused function.</p>

<p>Fri Nov 30 07:46:42 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (rb_objspace_call_finalizer): finalize_deferred may free up 	  a
object which is reachable from a part after this function, 	  e.g.
ruby_vm_destruct(). [ruby-dev:46647] [Bug #7452]</p>

<p>* test/ruby/test_gc.rb (test_finalizing_main_thread): add a test 	  for
above.</p>

<p>Fri Nov 30 07:43:44 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_thread_interrupted): avoid warning of 	  implicit
conversion.</p>

<p>* thread.c (rb_threadptr_execute_interrupts): ditto.</p>

<p>Fri Nov 30 07:34:28 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c: add GC guards.</p>

<p>Fri Nov 30 07:21:33 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>[EXPERIMENTAL: NEED DISCUSS] 	* vm_trace.c: add events 	  * :thread_begin
- hook at thread beginning. 	  * :thread_end - hook at thread ending. 	  *
:b_call - hook at block enter. 	  * :b_return - hook at block leave. 	 
This change slow down block invocation. 	  Please try and give us feedback
until 2.0 code freeze.</p>

<p>* include/ruby/ruby.h: ditto.</p>

<p>* compile.c (rb_iseq_compile_node): ditto.</p>

<p>* insns.def: ditto.</p>

<p>* thread.c: ditto.</p>

<p>* vm.c: ditto.</p>

<p>* include/ruby/debug.h: add a comment.</p>

<p>* test/ruby/test_settracefunc.rb: add a tests.</p>

<p>Fri Nov 30 06:56:30 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* test/minitest/*: Imported minitest 4.3.2 (r8027)</p>

<p>Fri Nov 30 04:16:29 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rake/*:  Updated to rake 0.9.5 	* test/rake/*:  ditto. 	* NEWS: 
ditto.</p>

<p>Fri Nov 30 02:53:47 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* vm.c: add a return hook when a method raises an exception.</p>

<p>* probes_helper.h: look up klass and method if none are provided.</p>

<p>* eval.c: update macro usage.</p>

<p>* vm_eval.c: ditto.</p>

<p>* vm_insnhelper.c: ditto.</p>

<p>* test/dtrace/test_function_entry.rb: test for change.</p>

<p>Fri Nov 30 02:27:12 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* compile.c (compile_array_): refix r37991 remove assertion: 	  it is true
only if type == COMPILE_ARRAY_TYPE_HASH. 	  [ruby-dev:46658] [Bug #7466]</p>

<p>* vm.c (m_core_hash_from_ary): add assertion instead of above.</p>

<p>* vm.c (m_core_hash_merge_ary): ditto.</p>

<p>Thu Nov 29 19:15:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (compile_array_): hash elements must be paired even for 	 
literal elements.  [ruby-dev:46658] [Bug #7466]</p>

<p>Thu Nov 29 22:39:35 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ssl_npn_encode_protocol_i): fix byte order 	 
issue on big-endian architecture [ruby-core:50292] [Bug #7463]</p>

<p>Thu Nov 29 22:23:31 2012  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* test/openssl/test_cipher.rb (test_ctr_if_exists): add CTR mode test 	 
if underlying OpenSSL supports it. See #4408</p>

<p>Thu Nov 29 21:42:16 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_method_entry_make): add a method entry with 	 
VM_METHOD_TYPE_REFINED to the class refined by the refinement if 	  the
target module is a refinement.  When a method entry with 	 
VM_METHOD_TYPE_UNDEF is invoked by vm_call_method(), a method with 	  the
same name is searched in refinements.  If such a method is 	  found, the
method is invoked.  Otherwise, the original method in 	  the refined class
(rb_method_definition_t::body.orig_def) is 	  invoked.  This change is made
to simplify the normal method lookup 	  and to improve the performance of
normal method calls.</p>

<p>* vm_method.c (EXPR1, search_method, rb_method_entry), 	  vm_eval.c
(rb_call0, rb_search_method_entry): do not use 	  refinements for method
lookup.</p>

<p>* vm_insnhelper.c (vm_call_method): search methods in refinements if 	 
ci-&gt;me is VM_METHOD_TYPE_REFINED.  If the method is called by 	  super
(i.e., ci-&gt;call == vm_call_super_method), skip the same 	  method entry
as the current method to avoid infinite call of the 	  same method.</p>

<p>* class.c (include_modules_at): add a refined method entry for each 	 
method defined in a module included in a refinement.</p>

<p>* class.c (rb_prepend_module): set an empty table to 	 
RCLASS_M_TBL(klass) to add refined method entries, because 	  refinements
should have priority over prepended modules.</p>

<p>* proc.c (mnew): use rb_method_entry_with_refinements() to get 	  a
refined method.</p>

<p>* test/ruby/test_refinement.rb (test_inline_method_cache): do not skip 	 
the test because it should pass successfully.</p>

<p>* test/ruby/test_refinement.rb (test_redefine_refined_method): new 	  test
for the case a refined method is redefined.</p>

<p>Thu Nov 29 17:45:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (rb_const_set): show namespace in warning messages. 	 
[Feature #7190]</p>

<p>Thu Nov 29 17:31:53 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb (Gem.load_yaml): return if Kernel#gem is not defined 	 
yet. This causes crash if test-all requires libraries in a certain 	 
order. A simple reproducible code is 	  ruby –disable-gem
-e&#39;require“yaml”;require“minitest/autorun”&#39;</p>

<p>Thu Nov 29 17:19:26 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/tracer.rb:  Updated to match removal of custom_require from 	 
RubyGems. 	* test/test_tracer.rb:  ditto.  Improved failure message if the
test 	  fails</p>

<p>Thu Nov 29 17:15:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* gc.c: Documentation for GC, GC::Profiler, ObjectSpace, and 	 
ObjectSpace::WeakMap [ruby-core:50245] [Bug #7449]</p>

<p>Thu Nov 29 17:12:26 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/generic_erb.rb, tool/id2token.rb: add –path-separator option 	  for
mingw where make and built ruby live in different world.</p>

<p>* tool/vpath.rb: extract from tool/instruction.rb.</p>

<p>Thu Nov 29 17:11:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/io/wait/test_io_wait.rb (TestIOWait#fill_pipe): 	 
Errno::EWOULDBLOCK may not be the same as Errno::EAGAIN.  patch by 	 
phasis68 (Heesob Park) at [ruby-core:49894].  [Bug #7420]</p>

<p>Thu Nov 29 17:03:38 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/test_case.rb:  Determine path to certificates to avoid 	 
build-dir problems. 	* test/rubygems/test_gem_security_signer.rb:  Use
predetermined paths 	  to avoid build-dir problems.</p>

<p>Thu Nov 29 16:18:14 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/test_case.rb:  Disable loading of keys and certificates 	 
outside rubygems or ruby tests as the files are not available (or 	 
necessary).</p>

<p>Thu Nov 29 16:14:41 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c (rb_debug_inspector_open): use RARRAY_LENINT() for 	  int
variable.</p>

<p>Thu Nov 29 15:59:55 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/debug.h: add rb_debug_inspector_* APIs.</p>

<p>* vm_backtrace.c: ditto.</p>

<p>* common.mk: add dependency from vm_backtrace.o to 	 
include/ruby/debug.h.</p>

<p>* proc.c (rb_binding_new_with_cfp): constify.</p>

<p>* vm.c (rb_vm_get_ruby_level_next_cfp): constify.</p>

<p>* vm_core.h, vm_trace.c: move decls.</p>

<p>Thu Nov 29 15:56:14 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rdoc/test_case.rb (RDoc::TestCase#verbose_capture_io): 	  defined
for asserts of warnings.</p>

<p>* test/rdoc: use verbose_capture_io on asserts of warnings. 	  they failed
when tests was run with RUBYOPT=-W0.</p>

<p>Thu Nov 29 15:53:38 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/psych/extconf.rb: added –enable-bundled-libyaml option.  this 	 
enforces using bundled libyaml.</p>

<p>Thu Nov 29 15:51:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems*:  Updated to RubyGems 2.0 	* test/rubygems*:  ditto.</p>

<p>* common.mk (prelude):  Updated for RubyGems 2.0 source rearrangement.</p>

<p>* tool/change_maker.rb:  Allow invalid UTF-8 characters in source 	 
files.</p>

<p>Thu Nov 29 15:38:14 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/debug.h: provide rb_tracearg_*() APIs, 	  instead of
rb_tracepoint_attr_*(). 	  These APIs are for debuggers/profilers. 	  They
will be explained in another docs sometime.</p>

<p>* vm_trace.c: ditto.</p>

<p>Thu Nov 29 15:10:45 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/minitest/test_minitest_unit.rb: restore orig_verbose only 	  if it
is set. This broke rdoc&#39;s tests. 	  <a
href="http://u64.rubyci.org/~chkbuild/ruby-trunk/log/20121129T050102Z.diff.html.gz">u64.rubyci.org/~chkbuild/ruby-trunk/log/20121129T050102Z.diff.html.gz</a></p>

<p>Thu Nov 29 14:56:30 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (rb_tracepoint_attr_method_id): 	  rename TracePoint#id to
TracePoint#method_id.</p>

<p>* include/ruby/debug.h: ditto.</p>

<p>* test/ruby/test_settracefunc.rb: ditto,</p>

<p>Thu Nov 29 14:49:10 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (rb_tracepoint_attr_defined_class): 	  rename
TracePoint#klass to TracePoint#defined_class. 	  [ruby-core:50187] Re:
[ruby-trunk - Feature #6895]</p>

<p>* include/ruby/debug.h: ditto.</p>

<p>* test/ruby/test_settracefunc.rb: ditto.</p>

<p>Thu Nov 29 14:27:57 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (gc_stat): prepare Symbol objects at first time 	  to make it fast.</p>

<p>Thu Nov 29 14:02:15 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (gc_stat): GC.stat supports new information 	  *
total_allocated_object: total allocated object number. 	  *
total_freed_object: total freed object number. 	  Above two numbers are
only accumulated and they will 	  overflow (return to 0). Please use them
as a hint.</p>

<p>Thu Nov 29 12:13:54 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 4.3.2 (r8026) 	* test/minitest/*:
ditto</p>

<p>Thu Nov 29 11:06:06 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_start_func_2): remove unused code. When 	 
th-&gt;safe_level == 4, th-&gt;errinfo never be thrown. So, to 	  create
new exception makes no sense.</p>

<p>Thu Nov 29 10:29:53 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c: same as a last patch.</p>

<p>Thu Nov 29 10:24:25 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c: use `long&#39; for return values of `NUM2LONG()&#39;.</p>

<p>Thu Nov 29 09:52:08 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (do_select): suppress warning (uninitialized value warning) 	 
with UNINITIALIZED_VAR().</p>

<p>Thu Nov 29 09:36:09 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* eval.c (ruby_cleanup): delay THREAD_KILLED timing. 	  It should be
located just before rb_thread_terminate_all().</p>

<p>Thu Nov 29 09:10:17 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c (vm_backtrace_to_ary): support range argument 	  like
Array#[]. 	  [ruby-core:50092] [ruby-trunk - Feature #7434] 	  Test and
document is not available. Please help us.</p>

<p>Thu Nov 29 06:46:33 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_start_func_2): small cleanups.</p>

<p>Thu Nov 29 06:37:08 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_start_func_2): remove unused code. 	  this function
never be used for main thread.</p>

<p>Thu Nov 29 06:27:55 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_start_func_2): remove unused code. 	  errinfo =
th-&gt;errinfo; and errinfo = rb_errinfo(); are 	  the same.</p>

<p>Thu Nov 29 05:26:32 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c (backtrace_to_str_ary2): rename to backtrace_to_str_ary.</p>

<p>* vm_backtrace.c (rb_backtrace_to_str_ary): use
`backtrace_to_str_ary()&#39;.</p>

<p>* vm_backtrace.c (backtrace_to_frame_ary): rename to 	 
backtrace_to_location_ary.</p>

<p>Thu Nov 29 05:19:25 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* probes.d: Change function-entry probe to method-entry. 	* insns.def:
ditto 	* probes_helper.h: ditto 	* test/dtrace/test_function_entry.rb:
ditto 	* test/dtrace/test_singleton_function.rb: ditto 	* vm.c: ditto 	*
vm_eval.c: ditto 	* vm_insnhelper.c: ditto</p>

<p>Thu Nov 29 04:45:17 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c: rename Class name from 	  ::RubyVM::Backtrace and
::RubyVM::Backtrace::Location 	  to ::Thread::Backtrace and
::Thread::Backtrace::Location.</p>

<p>Wed Nov 28 23:52:02 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* NEWS (Thread) remove incompatible changes about trap.</p>

<p>Wed Nov 28 23:39:01 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_mutex_sleep): fix to allow spurious wakeup. 	 
[ruby-dev:46654] [ruby-trunk - Bug #7455]</p>

<p>* NEWS: write about spurious wakeup.</p>

<p>Wed Nov 28 22:57:23 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread_win32.c: catch up latest change of BLOCKING_REGION.</p>

<p>Wed Nov 28 22:54:21 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): fix undefined behavior. 	  Should not
access scope local variable from outer scope.</p>

<p>Wed Nov 28 22:20:55 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* test/ruby/test_thread.rb (test_thread_status_in_trap): change test for 	
thread status in trap. now can accept Thread#join and Thread#value in trap.</p>

<p>Wed Nov 28 21:58:47 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/thread.h (rb_thread_call_without_gvl2): change 	  meaning
of function. 	  This function is called with same parameters of 	 
`rb_thread_call_without_gvl()&#39;. 	  However, if interrupts are detected,
then return immediately.</p>

<p>* thread.c: implement `rb_thread_call_without_gvl2()&#39;.</p>

<p>Wed Nov 28 21:31:21 2012  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* thread.c (thread_join_sleep): check spurious wakeup by itself for
	corresponding status change in trap context. 	* vm_core.h (struct
rb_thread_struct): add rb_thread_list_t and use as join_list for 	reentry
by trap context. 	* thread.c (thread_start_func_2): ditto. 	* thread.c
(remove_from_join_list): ditto. 	* thread.c (rb_thread_atfork): ditto. 	*
thread.c (thread_join): ditto. &amp; remove trap handler check. 	* thread.c
(sleep_forever): add argument : spurious_check. 	* thread.c
(sleep_timeval): ditto. 	* thread.c (rb_thread_sleep_forever): set
spurious_check. 	* thread.c (rb_thread_sleep_deadly): ditto. 	* thread.c
(sleep_for_polling): ditto. 	* thread.c (rb_thread_wait_for): ditto. 	*
thread.c (sleep_wait_for_interrupt): bypass spurious_check.</p>

<p>Wed Nov 28 21:23:18 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/psych/yaml/emitter.c (yaml_emitter_write_indicator): constify.</p>

<p>* ext/psych/yaml/emitter.c (yaml_emitter_write_block_scalar_hints): 	 
ditto.</p>

<p>* ext/psych/extconf.rb: mingw32 also needs macros for win32, not 	  only
mswin32.</p>

<p>* ext/psych/extconf.rb: compile sources in the source directory 	  without
copying by using VPATH.</p>

<p>Wed Nov 28 21:18:57 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#each_compile_rules): splat
$(<strong>VPATH</strong>) for 	  each VPATH elements.</p>

<p>Wed Nov 28 16:40:14 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm_core.h (enum rb_thread_status): remove THREAD_TO_KILL 	* vm_core.h
(struct rb_thread_struct): add to_kill field 	* thread.c (terminate_i):
convert THREAD_TO_KILL to to_kill. 	* thread.c (rb_threadptr_to_kill):
ditto. 	* thread.c (rb_thread_kill): ditto. 	* thread.c
(rb_thread_wakeup_alive): ditto. 	* thread.c (thread_list_i): ditto. 	*
thread.c (static const char): ditto. 	* thread.c (thread_status_name):
ditto. 	* thread.c (rb_thread_status): ditto. 	* thread.c
(rb_thread_inspect): ditto. 	* vm_backtrace.c (thread_backtrace_to_ary):
ditto.</p>

<p>* thread.c (rb_threadptr_execute_interrupts): fix thread status 	 
overwritten issue. [Bug #7450] [ruby-core:50249]</p>

<p>* test/ruby/test_thread.rb (test_hread_status_raise_after_kill): 	  test
for the above. 	* test/ruby/test_thread.rb (test_thread_status_in_trap):
test for 	  thread status in trap. 	* test/ruby/test_thread.rb
(test_status_and_stop_p): remove 	  Thread.control_interrupt unsafe test.
Thread#kill no longer 	  changes thread status. Instead of, Thread#kill
receiver changes 	  their own status when receiving kill signal.</p>

<p>Wed Nov 28 16:21:46 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (struct rb_mutex_struct): add allow_trap field. 	* internal.h
(rb_mutex_allow_trap): added. 	* thread.c (rb_mutex_lock, rb_mutex_unlock):
check mutex-&gt;allow_trap. 	* thread.c (mutex_sleep): remove trap check
because it uses 	  rb_mutex_lock and rb_mutex_unlock internally. 	*
thread.c (rb_mutex_allow_trap): new helper function for the above.</p>

<p>* io.c (io_binwrite): mark fptr-&gt;write_lock as writable in trap.</p>

<p>* test/ruby/test_signal.rb (test_trap_puts): test for the above.</p>

<p>Wed Nov 28 16:59:12 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* proc.c: remove Proc#== and Proc#eql?. 	  Proc objects compared with
their object ids. 	  [Bug #4559]</p>

<p>* test/ruby/test_proc.rb: remove related test.</p>

<p>Wed Nov 28 16:41:04 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/servlet.rb:  Add support for serving documentation from a 	 
subdirectory. 	* lib/rdoc/generator/darkfish.rb:  ditto 	*
test/rdoc/test_rdoc_servlet.rb:  Test for above 	*
test/rdoc/test_rdoc_servlet.rb:  ditto</p>

<p>Wed Nov 28 15:37:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: fix r37924: run only on <a href="3-6">i</a>86-linux.</p>

<p>Wed Nov 28 15:31:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (FMODE_SYNCWRITE): removed unused macro.</p>

<p>Wed Nov 28 15:19:25 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* configure.in: revert r37911, r37906 and r37904 which break build 	  with
non-gcc and/or non-IA32 compilers, e.g. Solaris Studio, 	  Fujitsu C
Compiler. [ruby-dev:46646] [Bug #7451]</p>

<p>Wed Nov 28 14:50:55 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ext/psych/extconf.rb: copy sources into build directory, 	  not into
srcdir.</p>

<p>Wed Nov 28 14:34:06 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_mutex_lock): moved trap context check from 	 
rb_mutex_trylock because try_lock have no change to make 	  a deadlock. 	*
thread.c (rb_mutex_trylock): ditto. 	* NEWS: news for the above.</p>

<p>Wed Nov 28 13:39:54 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_s_new): uses main_thread-&gt;status instead of 	 
th-&gt;inhibit_thread_creation for preventing thread creation. 	* vm_core.h
(rb_vm_struct): remove inhibit_thread_creation field. 	* thread.c
(rb_thread_terminate_all): ditto.</p>

<p>Wed Nov 28 13:27:29 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/extconf.rb: use embedded libyaml if no system libyaml is 	 
found. [ruby-core:49463] 	* ext/psych/lib/psych.rb: updating to psych 2.0.0
	* ext/psych/lib/psych/deprecated.rb: updated docs 	*
ext/psych/psych.gemspec: updated to psych 2.0.0 	* ext/psych/psych.h:
fixing header file include for rename 	* ext/psych/psych_emitter.c: renamed
to avoid libyaml conflict. 	* ext/psych/psych_emitter.h: ditto 	*
ext/psych/psych_parser.c: ditto 	* ext/psych/psych_parser.h: ditto 	*
ext/psych/psych_to_ruby.c: ditto 	* ext/psych/psych_to_ruby.h: ditto 	*
ext/psych/psych_yaml_tree.c: ditto 	* ext/psych/psych_yaml_tree.h: ditto 	*
ext/psych/yaml/LICENSE: embedding libyaml 0.1.4 	* ext/psych/yaml/api.c:
ditto 	* ext/psych/yaml/config.h: ditto 	* ext/psych/yaml/dumper.c: ditto
	* ext/psych/yaml/emitter.c: ditto 	* ext/psych/yaml/loader.c: ditto 	*
ext/psych/yaml/parser.c: ditto 	* ext/psych/yaml/reader.c: ditto 	*
ext/psych/yaml/scanner.c: ditto 	* ext/psych/yaml/writer.c: ditto 	*
ext/psych/yaml/yaml.h: ditto 	* ext/psych/yaml/yaml_private.h: ditto</p>

<p>Wed Nov 28 12:54:59 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_join): A trap handler check was moved from 	 
thread_join_m because Thread#value should be raised an exception 	  too. 	*
thread.c (thread_join_m): remove trap handler check. 	*
test/ruby/test_thread.rb (test_thread_join_in_trap): add test 	  for
thread#value. 	* NEWS: documentation fix for the above.</p>

<p>Wed Nov 28 11:07:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/fiddle/closure.c: Documentation for Fiddle 	*
ext/fiddle/lib/fiddle/import.rb: ditto 	* ext/fiddle/lib/fiddle/value.rb:
ditto 	* ext/fiddle/lib/fiddle/pack.rb: ditto 	*
ext/fiddle/lib/fiddle/cparser.rb: ditto 	* ext/fiddle/lib/fiddle/struct.rb:
ditto 	* ext/fiddle/lib/fiddle/function.rb: ditto</p>

<p>Wed Nov 28 09:15:51 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* ext/strscan/strscan.c: Added #charpos for multibyte string position. 	*
test/strscan/test_stringscanner.rb: ditto</p>

<p>Wed Nov 28 09:00:34 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/fiddle/fiddle.c: adding alignment constants for compatibility 	 
with DL. 	* ext/fiddle/fiddle.h: ditto 	* ext/fiddle/lib/fiddle/cparser.rb:
importing the C parser for DL 	  backwards compatibility. 	*
ext/fiddle/lib/fiddle/import.rb: importing the import DSL for DL 	 
backwards compatibility. 	* ext/fiddle/lib/fiddle/pack.rb: importing
structure pack for DL 	  backwards compatibility. 	*
ext/fiddle/lib/fiddle/value.rb: ditto 	* ext/fiddle/lib/fiddle/struct.rb:
importing struct DSL for DL backwards 	  compatibility. 	*
test/dl/test_c_struct_entry.rb: importing tests 	*
test/dl/test_c_union_entity.rb: ditto 	* test/dl/test_cparser.rb: ditto 	*
test/dl/test_import.rb: ditto 	* test/fiddle/test_c_struct_entry.rb: ditto
	* test/fiddle/test_c_union_entity.rb: ditto 	*
test/fiddle/test_cparser.rb: ditto 	* test/fiddle/test_import.rb: ditto</p>

<p>Wed Nov 28 08:56:00 2012  Zachary Scott &lt;zachary@zacharyscott.net&gt;</p>

<p>* doc/globals.rdoc: Add documentation file for magic globals
	[ruby-core:29048] [Bug #3022]</p>

<p>Wed Nov 28 08:55:00 2012  Zachary Scott &lt;zachary@zacharyscott.net&gt;</p>

<p>* .document: Add README&#39;s to be included with docs</p>

<p>Wed Nov 28 08:26:00 2012  Zachary Scott &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/dl/lib/dl.rb: Deprecation notice for DL</p>

<p>Wed Nov 28 08:25:00 2012  Zachary Scott &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/fiddle/closure.c: Documentation for Fiddle 	* ext/fiddle/pointer.c:
ditto 	* ext/fiddle/function.c: ditto 	* ext/fiddle/lib/fiddle.rb: ditto 	*
ext/fiddle/fiddle.c: ditto 	* ext/fiddle/handle.c: ditto</p>

<p>Wed Nov 28 04:53:40 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/fiddle/handle.c: Make Fiddle independent of DL, copy DL::Handle 	 
to Fiddle::Handle. 	* ext/fiddle/pointer.c: Make Fiddle independent of DL,
copy 	  DL::Pointer to Fiddle::Pointer. 	* test/fiddle/test_func.rb:
relevant tests 	* test/fiddle/test_handle.rb: ditto 	*
test/fiddle/test_pointer.rb: ditto 	* ext/dl/lib/dl/struct.rb: use
Fiddle::Pointer if available 	* ext/fiddle/extconf.rb: check for dlfcn.h 	*
ext/fiddle/fiddle.c: add constants for sizeof() things 	*
ext/fiddle/fiddle.h: include dlfcn.h 	* ext/fiddle/function.c: expose a C
function for creating new 	  Fiddle::Function objects. 	*
ext/fiddle/lib/fiddle.rb: include constants for dl backwards compat 	*
ext/fiddle/lib/fiddle/function.rb: read the pointer from the 	  function
for dl backwards compat. 	* test/dl/test_callback.rb: check the addresses
of the pointers rather 	  than their types. 	* test/fiddle/helper.rb:
remove dependency on dl 	* test/fiddle/test_closure.rb: ditto 	*
test/fiddle/test_fiddle.rb: ditto</p>

<p>Wed Nov 28 03:03:28 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (opt-dir): don&#39;t use non portable flag -E of sed.</p>

<p>Wed Nov 28 02:55:35 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (ARCH_FLAG): __sync_val_compare_and_swap_4 needs 	 
-march=$target_cpu on at least linux gcc 4.1. 	  patched by KOSAKI Motohiro</p>

<p>Tue Nov 27 22:03:09 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* string.c (rb_str_enumerate_chars, rb_str_enumerate_codepoints) 	 
(rb_str_enumerate_lines): Dummy initialization of ary has been 	  replaced
with UNINITIALIZED_VAR().</p>

<p>Tue Nov 27 21:29:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (bigdivrem): optimize the way to retry calculation of 	 
bigdivrem so that the calculation is started from the point where 	  the
last interruption was occurred.</p>

<p>* bignum.c (bigdivrem1): ditto.</p>

<p>* test/ruby/test_bignum.rb: add a test case for rb_bigdivrem in the 	 
case that an interruption is occurred during bigdivrem1 is running.</p>

<p>Tue Nov 27 19:56:43 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (rb_vm_make_env_object): make Proc object if Env is possible 	  to
point block. 	  [ruby-core:41038] [ruby-trunk - Bug #5634]</p>

<p>* vm.c (rb_vm_make_proc): No need to make Proc object here.</p>

<p>* bootstraptest/test_proc.rb: add tests.</p>

<p>Tue Nov 27 18:51:06 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ruby_atomic.h (ATOMIC_CAS): added for Solaris and other platforms. 	*
ruby_atomic.h, signal.c (NEED_RUBY_ATOMIC_OPS): renamed from 	 
NEED_RUBY_ATOMIC_EXCHANGE. 	* signal.c (ruby_atomic_compare_and_swap):
naive, non-atomic 	  compare-and-swap implementation only used for
platforms without 	  valid support for atomic operations.</p>

<p>Tue Nov 27 17:43:46 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/*:  Added –root option for building documentation outside 	 
the source directory. 	* test/rdoc/*:  ditto 	* common.mk (rdoc):  Added
–root to rdoc rule</p>

<p>Tue Nov 27 16:24:45 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rdoc/test_rdoc_ri_paths.rb:  Fixed duplicate path bug which 	 
caused windows failures.</p>

<p>Tue Nov 27 16:06:00 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rdoc/test_rdoc_generator_darkfish.rb:  Updated tests for windows 	*
test/rdoc/test_rdoc_options.rb:  ditto 	* test/rdoc/test_rdoc_parser.rb: 
ditto 	* test/rdoc/test_rdoc_rdoc.rb:  ditto 	*
test/rdoc/test_rdoc_ri_driver.rb:  ditto 	* test/rdoc/test_rdoc_servlet.rb:
ditto</p>

<p>Tue Nov 27 15:13:51 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* common.mk (rdoc):  Set –debug for rdoc generation in case of bugs</p>

<p>Tue Nov 27 14:56:45 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc/rubygems_hook.rb:  Updated for (upcoming) RubyGems 2 	  import.
	* test/rdoc/test_rdoc_rubygems_hook.rb:  ditto</p>

<p>Tue Nov 27 13:59:29 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* NEWS: add improvements of the garbage collector.</p>

<p>Tue Nov 27 13:27:46 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc*:  Updated to RDoc 4.0 (pre-release) 	* bin/rdoc:  ditto 	*
test/rdoc*:  ditto 	* NEWS:  Updated with RDoc 4.0 information</p>

<p>Tue Nov 27 12:17:11 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_thread_terminate_all): retry broadcast only when 	  an
exception is raised.</p>

<p>Tue Nov 27 12:02:25 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_thread_terminate_all): broadcast terminate event 	  not
only an interrupt exception but any exceptions.</p>

<p>Tue Nov 27 10:55:09 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* eval.c (ruby_cleanup): set thread status to THREAD_KILLED 	  for
preventing thr.raise. 	* test/ruby/test_thread.rb
(test_main_thread_status_at_exit): 	  test for the above.</p>

<p>Tue Nov 27 10:31:29 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_terminate_all): suppress a warning.</p>

<p>Tue Nov 27 09:29:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_join): raises ThreadError if target thread 	  is a main
thread. 	* test/ruby/test_thread.rb (test_thread_join_main_thread): 	  test
for the above. 	* NEWS: news for the above.</p>

<p>Tue Nov 27 09:24:47 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_join): raises ThreadError if target thread 	  is a
current thread. 	* test/ruby/test_thread.rb (test_thread_join_current): 	 
test for the above. 	* NEWS: news for the above.</p>

<p>Tue Nov 27 09:59:16 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extmake): close mkmf.log for each libraries so that 	 
failure messages are not mixed.</p>

<p>Tue Nov 27 09:58:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/digest/*/extconf.rb, ext/openssl/extconf.rb: get git rid of 	 
post-1.8 feature require_relative for cross compilation. 	 
[ruby-core:50160] [Bug #7439]</p>

<p>Tue Nov 27 09:17:59 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* NEWS: add TracePoint.</p>

<p>Tue Nov 27 08:16:03 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c: rename TracePoint#file and TracePoint#line 	  to
TracePoint#path and TracePoint#lineno respectively. 	  They are consistent
to RubyVM::Backtrace::Location.</p>

<p>* include/ruby/debug.h: ditto.</p>

<p>* vm_core.h: ditto.</p>

<p>* test/ruby/test_settracefunc.rb: ditto.</p>

<p>Tue Nov 27 08:04:26 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_terminate_all): broadcast eTerminateSignal 	  again
when Ctrl-C was pressed. [Feature #1952] [ruby-dev:39107]</p>

<p>Tue Nov 27 07:58:03 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: add members to rb_trace_arg_t: 	  * `klass_solved&#39;
represents klass and id is checked. 	  * `line&#39; represents line
calculated from cfp. 	  * `file&#39; represents line calculated from cfp.</p>

<p>* vm_trace.c: fix to use above data structures. 	  No need to calculate
klass and id, line and file 	  pairs for each trace points.</p>

<p>Tue Nov 27 07:47:09 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_terminate_all): add RUBY_VM_CHECK_INTS_BLOCKING(). 	
Otherwise the loop in this function behave as busy loop because 	 
native_sleep() return immediately when RUBY_VM_INTERRUPTED() is true.</p>

<p>Tue Nov 27 04:12:49 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extmake): git rid of post-1.8 features for cross 	 
compilation.  [ruby-core:50160] [Bug #7439]</p>

<p>Tue Nov 27 00:13:41 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_mutex_trylock, rb_mutex_unlock, mutex_sleep): 	  raises
ThreadError if called from trap handler as Thread#join. 	* NEWS: news for
the above.</p>

<p>Mon Nov 26 23:55:33 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* NEWS: update for Thread#join incompatible change.</p>

<p>Mon Nov 26 22:44:24 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_terminate_all): use native_sleep() instead 	  of
rb_thread_schedule(). Otherwise, it consume 100% cpu meaninglessly. 	  [Bug
#5368] [ruby-dev:44546] 	* thread.c (thread_start_func_2): last sub-thread
wakes up main thread.</p>

<p>Mon Nov 26 21:16:04 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm_core.h (RUBY_VM_SET_TIMER_INTERRUPT, RUBY_VM_SET_INTERRUPT)
	(RUBY_VM_SET_FINALIZER_INTERRUPT, RUBY_VM_SET_TRAP_INTERRUPT)
	(RUBY_VM_INTERRUPTED): use enum symbol instead of immediate value. 	*
thread.c (thread_join_m, rb_threadptr_execute_interrupts): ditto. 	*
signal.c (signal_exec): ditto.</p>

<p>Mon Nov 26 20:23:20 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_join_m): use th-&gt;interrupt_mask instead of 	 
th-&gt;in_trap.</p>

<p>* vm_core.h (struct rb_thread_struct): remove in_trap member. 	* signal.c
(signal_exec): ditto. 	* thread.c (thread_create_core): ditto. 	* thread.c
(Init_Thread): ditto.</p>

<p>Mon Nov 26 20:23:49 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_argf.rb (TestArgf#test_chars): since marshal data is 	 
binary, shouldn&#39;t pass via text mode.  use base64 encoded data.</p>

<p>Mon Nov 26 19:45:18 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ruby_atomic.h (ATOMIC_CAS): new macro for compare-and-exchange.</p>

<p>* vm_core.h (struct rb_thread_struct): add interrupt_mask member. 	*
thread.c (thread_create_core, Init_Thread): initialize 	 
th-&gt;thread_mask.</p>

<p>* vm_core.h (RUBY_VM_INTERRUPTED_ANY): new macro for avoiding 	  bare
th-&gt;interrupt_flag. 	* vm_core.h (RUBY_VM_INTERRUPTED,
RUBY_VM_INTERRUPTED): check 	  th-&gt;interrupt_mask. 	* thread.c
(set_unblock_function, rb_thread_schedule): replace 	 
th-&gt;interrupt_flag with RUBY_VM_INTERRUPTED_ANY()</p>

<p>* signal.c (signal_exec): set up thread-&gt;interrupt_mask for 	 
preventing recursive trap handler. 	* vm_core.h (RUBY_VM_CHECK_INTS,
RUBY_VM_CHECK_INTS_BLOCKING): ditto.</p>

<p>* thread.c (rb_threadptr_execute_interrupts): 	  don&#39;t process
interrupt if it is masked. 	  [Bug #6009] [ruby-core:42524]</p>

<p>Mon Nov 26 19:43:42 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (make_compile_option_value): add trace_instruction option. 	  a
patch by davidbalbert (David Albert). 	  [Bug #6786]</p>

<p>Mon Nov 26 19:10:53 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* bootstraptest/test_thread.rb: try to `join&#39; each 100 	  threads. 	 
This benchmark seems consuming long time on travis-ci 	  several times (and
make `failure&#39;).</p>

<p>Mon Nov 26 18:22:56 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* common.mk: specify label `built-ruby&#39;.</p>

<p>* benchmark/driver.rb: quote path.</p>

<p>Mon Nov 26 18:26:28 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (signal_exec): add volatile to make sure setjmp safe.</p>

<p>Mon Nov 26 18:19:47 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (signal_exec): suppress “warning: variable &#39;signum&#39; 	 
might be clobbered by &#39;longjmp&#39; or &#39;vfork&#39;” warning.</p>

<p>Mon Nov 26 18:15:47 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: accept multiple `-e&#39;. 	  You don&#39;t need to
use `;&#39; separation character. 	  [ruby-core:50139] [ruby-trunk - Bug
#7380]</p>

<p>Mon Nov 26 17:10:04 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* string.c (rb_str_enumerate_chars, rb_str_enumerate_codepoints)
	(rb_str_enumerate_lines): suppress “may be used uninitialized in 	  this
function” warning.</p>

<p>Mon Nov 26 17:00:12 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm_core.h (rb_thread_struct): added &#39;in_trap&#39; member for marking
	  running trap handler. 	* signal.c (signal_exec): turn on in_trap when
running trap. 	* thread.c (Init_Thread, thread_create_core): initialize
in_trap 	  when creating new threads. 	* thread.c (thread_join_m): raise
ThreadError when running trap 	  handler.Bug [#<a
href="ruby-core:44956">6416]</a> 	* test/ruby/test_thread.rb
(test_thread_join_in_trap): new test 	  for the above.</p>

<p>Mon Nov 26 16:36:13 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (argf_each_codepoint): add missing ARGF#codepoints [Bug #7438]</p>

<p>Mon Nov 26 15:50:29 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* bignum.c (bigdivrem): restart calculation when bigdivrem1 was 	 
interrupted by signal. Otherwise, ruby script may see a garbage 	  value.</p>

<p>Mon Nov 26 15:33:02 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* bignum.c (big_div_struct): added volatile to &#39;stop&#39; member. 	 
Otherwise, “if (bds-&gt;stop)” check in bigdivrem1 don&#39;t read 	  memory
and ignore interrupt. 	* bignum.c (bigdivrem, rb_big_stop): ditto.</p>

<p>Mon Nov 26 12:11:09 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (DLNOBJ): missing in r37821.</p>

<p>Mon Nov 26 10:50:19 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_process.rb (test_setsid): added a few wait for 	 
preventing that Process.getsid(io.pid) makes Errno::ESRCH.</p>

<p>Sun Nov 25 22:34:00 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* array.c (ary_resize_smaller): new function to resize array.</p>

<p>* array.c (rb_ary_delete): refactoring to extract a function.</p>

<p>* array.c (rb_ary_delete_same): refactoring. 	  It renames function,
reduces duplicated code and removes unused 	  code.</p>

<p>* gc.c (wmap_final_func): follow the above change.</p>

<p>* internal.h (rb_ary_delete_same): ditto.</p>

<p>Sun Nov 25 22:27:33 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* array.c: fixes for the updated documentation in r35858: 	  Typos and
#take/#drop accept to take/drop 0 elements.</p>

<p>Sun Nov 25 19:43:29 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* NEWS: add a news about iconv.</p>

<p>Sun Nov 25 03:49:23 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/set.rb, test/test_set.rb: Move tests embedded in lib/set.rb 	  to
test/test_set.rb.</p>

<p>Sun Nov 25 03:44:50 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* string.c (rb_str_each_line, rb_str_lines): String#lines now 	  returns
an array instead of an enumerator.  Passing a block is 	  deprecated but
still supported for backwards compatibility. 	  Based on the patch by
yhara. [Feature #6670]</p>

<p>* string.c (rb_str_each_char, rb_str_chars): Ditto for 	  String#chars.</p>

<p>* string.c (rb_str_each_codepoint, rb_str_codepoints): Ditto for 	 
String#codepoints.</p>

<p>* string.c (rb_str_each_byte, rb_str_bytes): Ditto for 	  String#bytes.</p>

<p>* NEWS: Add notes for the above changes.</p>

<p>Sun Nov 25 02:07:37 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_warning) 	 
(Test::Unit::Assertions#assert_warn), test/ruby/envutil.rb, 	 
test/ruby/test_enumerator.rb, test/ruby/test_io_m17n.rb, 	 
test/ruby/test_regexp.rb, test/ruby/test_syntax.rb: 	  assert_warn() and
assert_warning() are reversed.</p>

<p>Sat Nov 24 21:08:50 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* gc.c (wmap_final_func): rename variables to clarify the meaning. 	  In
wmap2obj the key is WeakRef and the value is referenced object. 	  In
obj2wmap the key is referenced object and the value is an array 	  of
WeakRef.</p>

<p>* gc.c (wmap_finalize): ditto. 	  [ruby-core:49044] [Bug #7304]</p>

<p>Sat Nov 24 21:01:55 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* array.c (rb_ary_delete_same_obj): new function for WeakRef. 	  This
deletes same objects as item argument in the array.</p>

<p>* internal.h (rb_ary_delete_same_obj): add a declaration.</p>

<p>* gc.c (wmap_final_func): remove WeakRef object reference from the 	 
array. rb_ary_delete() is not usable because it uses rb_equal() to 	 
compare object references.</p>

<p>* gc.c (wmap_finalize): remove recycled object references from weak 	  map
hash properly. How to get object reference from object id was 	  wrong.
st_delete() doesn&#39;t work properly if key and value arguments 	  are
same. The key of obj2wmap is referenced object and the value of 	  obj2wmap
is WeakRef array.</p>

<p>* gc.c (wmap_aset): obj2wmap should contain WeakRef array in the 	 
definition.</p>

<p>* test/test_weakref.rb 	 
(TestWeakRef#test_not_reference_different_object, 	  
TestWeakRef#test_weakref_finalize): add tests for above. 	 
[ruby-core:49044] [Bug #7304]</p>

<p>Sat Nov 24 19:44:41 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf-utf8/nkf.c (unicode_iconv_combine): returning flags are 	 
nkf_char.</p>

<p>Sat Nov 24 19:29:18 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* test/ruby/test_rubyoptions.rb (test_usage, test_usage_long): 	  reduced,
renamed.</p>

<p>Sat Nov 24 13:10:14 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c (rb_tracepoint_attr_raised_exception): should not check 	 
value before event checking.</p>

<p>* vm_trace.c (rb_tracepoint_attr_return_value): ditto.</p>

<p>* test/ruby/test_settracefunc.rb: add tests for TracePoint#return_value 	 
and TracePoint#raised_exception.</p>

<p>Sat Nov 24 12:47:27 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_process.rb (TestProcess#test_setsid): “./ruby-trunk” 	 
doesn&#39;t work on all environments. EnvUtil.rubybin would be suitable.</p>

<p>Sat Nov 24 12:28:04 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* array.c (rb_ary_aref): fix Segmentation fault at TestArray#test_aref 	 
on x64 mingw. Variable argument of rb_scan_args() should be a pointer 	 
(VALUE *), but 0 of variable argument seems not equal to null pointer 	  on
x64 mingw.</p>

<p>Sat Nov 24 11:47:14 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* process.c (proc_getsid): adds new method for getting session id. 	 
Contributed from fumiyas (Fumiyasu SATOH). Thank you! 	  [Feature #6757]
[ruby-dev:45977] 	* configure.in: adds getsid check. 	*
test/ruby/test_process.rb (TestProcess#test_setsid): new test 	  for the
above. 	* NEWS: news for the above.</p>

<p>Sat Nov 24 10:59:14 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (thread_create_core): don&#39;t use th-&gt;thread_id before 	 
initialized.</p>

<p>Sat Nov 24 00:00:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (proc_options, process_options, ruby_process_options): take 	 
care of the case argc is 0, and check if argv has NULL. 	 
[ruby-core:49889] [Bug #7423]</p>

<p>Sat Nov 24 00:00:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (–disable-dln): option to disable dynamic linking 	 
feature.  [ruby-core:37676] [Feature #4946]</p>

<p>Fri Nov 23 23:44:41 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#pkg_config): strip all white spaces for 	 
mingw64+MSYS pkg-config which erroneously emits extra newlines. 	 
[ruby-core:47998] [Bug #7163]</p>

<p>Fri Nov 23 17:31:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (usage): wrap description lines if options are too long.</p>

<p>Fri Nov 23 11:13:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/test_rubyoptions.rb (TestRubyOptions#test_usage2): refine 	 
assertion.</p>

<p>* test/ruby/test_rubyoptions.rb (TestRubyOptions#test_usage2): now 	 
–help option is for modern terminals.</p>

<p>Fri Nov 23 10:45:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/socket/ipsocket.c (IPSocket#peeraddr): Fix example 	 
[ruby-core:46429] [Bug #6732]</p>

<p>Fri Nov 23 02:40:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/cgi/core.rb: Documentation for CGI#header alias 	  Based on a patch
by Marcus Stollsteimer 	  [ruby-core:49585] [Bug #7405]</p>

<p>Thu Nov 22 23:48:10 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (is_swept_object): extract from is_dead_object().</p>

<p>* gc.c (rb_gcdebug_print_obj_condition): add the function for debug. 	 
This function shows some conditions of given object (e.g., 	  marked, in
heap, swept).</p>

<p>* gc.c (rb_gcdebug_sentinel): add the function for debug. 	  This function
allow check to inadvertently free up an object.</p>

<p>Thu Nov 22 23:45:18 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* array.c (rb_ary_shared_with_p): fix cache validity check. 	  If #pop or
#shift has been called against $: or $“, the array will 	  be still shared
with the snapshot. We check array length for cache 	  validity. 	 
[ruby-core:49518] [Bug #7383]</p>

<p>* test/ruby/test_require.rb 	  (TestRequire#test_require_with_array_pop, 	
TestRequire#test_require_with_array_shift): add tests for above.</p>

<p>Thu Nov 22 21:48:48 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk, win32/Makefile.sub (probes.dmyh): now be made in current 	 
(=build) directory if build from the repository.</p>

<p>Thu Nov 22 21:34:51 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* test/ruby/test_rubyoptions.rb: added a test.</p>

<p>Thu Nov 22 20:32:07 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (string_to_c_strict, string_to_c): check NUL. 	* rational.c
(string_to_r_strict, string_to_r): ditto.</p>

<p>Thu Nov 22 20:21:45 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* Makefile.in (.dmyh.h): removed $(VPATH). GNU make don&#39;t 	  recognize
suffix rule with VPATH.</p>

<p>Thu Nov 22 18:11:27 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk, Makefile.in, win32/Makefile.sub (.dmyh.h): nmake merges 	 
explicit rules for same target, but not merges explicit rules and 	 
implicit rules – always explicit rules win.  So, need to add an 	  explicit
rule for probes.h.  [Bug #7421] [ruby-core:49839]</p>

<p>Thu Nov 22 18:01:28 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Makefile.in (probes.o): add -C to ignore #include in probes.d.</p>

<p>* probes.d: include vm_opts.h instead of vm_core.h.</p>

<p>* vm_opts.h (VM_COLLECT_USAGE_DETAILS): move definition from vm_core.h.</p>

<p>Thu Nov 22 17:45:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf-utf8: Merge b0a6577a521d1bba5e19853f95d5c4b9be1072b5. 	 
Support JIS X 0213 and some bugfixes.</p>

<p>Thu Nov 22 17:39:37 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* tool/gen_dummy_probes.rb: don&#39;t change #include, #if and #endif 	 
lines. [Bug #7370]</p>

<p>Thu Nov 22 16:58:26 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* Makefile.in: run preprocessor when making probe.h 	* probes.d: define
probe insn and insn__operand only when 	  VM_COLLECT_USAGE_DETAILS is 1.
[Bug #7370]</p>

<p>Thu Nov 22 16:20:49 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm.c: Don&#39;t define vm_collect_usage_operand() and 	  static void
vm_collect_usage_insn() when disabling 	  VM_COLLECT_USAGE_DETAILS. (refix
r37796)</p>

<p>Thu Nov 22 15:26:02 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.h: partly revert r37631 (DTrace support). 	  “vm usage
information is always collected, so uncomment the 	  functions.” causes
performance impact. [Bug #7370] 	  Off course this revert disables related
probes.</p>

<p>Thu Nov 22 14:14:36 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* re.c (rb_memsearch_ss): Apply performance improvement to short 	  byte
array search for platforms without memmem(3). 	  [Feature #6311]
[ruby-dev:45530]</p>

<p>Thu Nov 22 12:52:19 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* test/ruby/test_string.rb (TestString#test_index): Add some 	  corner
cases to tests for String#index, which might fail if ruby 	  directly used
a buggy memmem(3) implementation.</p>

<p>Thu Nov 22 08:06:42 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* test/ruby/test_gc.rb (test_profiler_clear): fix wrong method 	  calls
[Bug #7419] [ruby-core:49828].</p>

<p>Thu Nov 22 02:22:33 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* NEWS: edited (order etc).</p>

<p>Wed Nov 21 22:52:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/wait/wait.c (io_wait_readable): add alias wait_readable.</p>

<p>* ext/io/wait/wait.c (io_wait_writable): this is easier to use than 	 
IO.select for a single IO object and is immune to the 	 
limitations/inefficiency of select() on platforms where poll/ppoll 	  is
available.  patched by Eric Wong.  [Feature #4646]</p>

<p>Wed Nov 21 22:27:52 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (garbage_collect): remove a duplicative probe.</p>

<p>Wed Nov 21 22:08:48 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (gc_profile_clear): realloc profile records if its size is 	 
higher than the threshold, GC_PROFILE_RECORD_DEFAULT_SIZE * 2.</p>

<p>Wed Nov 21 21:53:29 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (nucomp_to_c): added.</p>

<p>Wed Nov 21 21:35:38 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* include/ruby/util.h: removed extra semicolon in definition of 	  macro.
	* compile.c: ditto. 	* cont.c: ditto. 	* math.c: ditto. 	* node.c: ditto.
	* parse.y: ditto.</p>

<p>Wed Nov 21 18:46:37 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* rational.c (read_digits): due to a bit tighter rb_cstr_to_inum().</p>

<p>Wed Nov 21 16:13:37 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bm_so_nsieve_bits.rb: add an encoding pragma because 	  this
benchmark using strings (literals) as binary sequence. 	  Now, they are
UTF-8 strings. [ruby-dev:46578]</p>

<p>Wed Nov 21 00:57:43 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* file.c (Init_File): null device definition uses rb_define_const 	 
instead of rb_file_const.</p>

<p>Wed Nov 21 00:28:18 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/ruby/test_m17n_comb.rb (test_str_crypt): Use RbConfig to get 	 
libc&#39;s directory. Patched by Vit Ondruch [ruby-core:49763] [Bug #7312]</p>

<p>Tue Nov 20 23:28:26 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* marshal.c: add marshal readahead. marshalized Array, Hash and Struct 	 
have size at least number of its elements, marshal readahead will 	  read
the certain readable length and buffer when it needs more bytes. 	  marshal
readahead prevents many calls to IO#getbyte and IO#read, 	  then it enables
performance improvement. 	  [ruby-dev:45637] [Feature #6440]</p>

<p>Tue Nov 20 22:35:02 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Makefile.in (.d.h): replace char * to const char * because somehow 	 
current dtrace removes const of function declaration in probes.d.</p>

<p>Tue Nov 20 21:41:04 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/debug.h: introduced. 	  Debugging/profiling features will
be located.</p>

<p>* vm_trace.c: expose C-level TracePoint APIs. 	  Note that they are
experimental.</p>

<p>* vm_trace.c, include/ruby/debug.h: rename `rb_hook_flag_t&#39; 	  to
`rb_event_hook_flag_t&#39;. 	  Macro names `RUBY_HOOK_FLAG_*&#39; are also
renamed to 	  `RUBY_EVENT_HOOK_FLAG_*&#39;.</p>

<p>* debug.h, vm_debug.h: rename debug.h to vm_debug.h.</p>

<p>* common.mk: ditto.</p>

<p>* debug.c, main.c, vm_core.h: ditto.</p>

<p>Tue Nov 20 21:12:37 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_DTRACE_AVAILABLE): only check dtrace availability.</p>

<p>* configure.in (RUBY_DTRACE_POSTPROCESS): restore.</p>

<p>Tue Nov 20 21:22:44 2012  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* test/win32ole/test_win32ole_type.rb (test_implemented_ole_types): 	 
IShellDispatch6 bundled in Windows 8. Thanks to phasis68 (Heesob 	  Park). 
[ruby-core:49580][Bug #7403]</p>

<p>Tue Nov 20 21:06:41 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c: some improvements. 	* rational.c: ditto.</p>

<p>Tue Nov 20 21:01:16 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (incs): BSD make cannot deal with non-prefixed dependency 	 
and prefixed target.</p>

<p>Tue Nov 20 20:10:23 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* array.c (rb_ary_bsearch): fix rdoc bug (O(n log n) -&gt; O(log n)). 	 
Patch by Charlie Somerville.  [ruby-core:49661] [Bug #7409]</p>

<p>* range.c (range_bsearch): ditto.</p>

<p>Tue Nov 20 19:02:44 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c: rename and add TracePoint APIs. 	  (1) TracePoint.new(…)<code>…</code>
creates a new trace point 	      but does not make it enable. 	  (2)
TracePoint.trace(…)<code>…</code> creates a new trace point 	      and enable it (same
as old behavior). 	  (3) TracePoint#enable make it enable (renamed from
TracePoint#retrace). 	      If block given, when enable only in block. 	 
(4) TracePoint#disable make it disable (renamed from TracePoint#untrace). 	
If block given, when disable only in block. 	  (5) TracePoint#enabled?
returns this trace is enable or not. 	  [Feature #6895]</p>

<p>* test/ruby/test_settracefunc.rb: add tests.</p>

<p>Tue Nov 20 18:35:05 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c: add two methods: 	  (1) TracePoint#return_value which
returns return 	      value on the :return and :c_return event. 	  (2)
TracePoint#raised_exception which returns raised exception 	      value on
the :raise event. 	  Each methods raise RuntimeError if it is called at
unsupported 	  event. 	  Please review and give us feedback until next
preview 	  release (Dec/2012) of Ruby 2.0.0. 	  [Feature #6895]</p>

<p>* insns.def, vm.c, vm_eval.c, vm_insnhelper.c, eval.c, thread.c: 	  ditto.</p>

<p>* vm_trace.c, vm_core.h: move definition of rb_trace_arg_t from 	 
vm_trace.c to vm_core.h. 	  Caller fills rb_trace_arg_t and pass the
pointer of this variable.</p>

<p>* test/ruby/test_settracefunc.rb: fix tests to test this change.</p>

<p>Tue Nov 20 17:31:12 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: fix dtrace didn&#39;t work on darwin.</p>

<p>* configure.in (RUBY_DTRACE_AVAILABLE): unify RUBY_DTRACE_POSTPROCESS 	 
and RUBY_DTRACE_BSD_BROKEN.</p>

<p>Tue Nov 20 15:20:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* file.c (File.extname): Documentation for extname on dotfiles and 	files
ending with a dot. Also, added example for this. 	[ruby-core:47852] [Bug
#7112]</p>

<p>Tue Nov 20 14:19:20 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_signal.rb (TestSignal#test_signame): fix windows 	  test
failure. Process.kill on windows can&#39;t send a signal to 	  another
process.</p>

<p>Tue Nov 20 13:58:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (Init_IO): moved all rb_file_const() into file.c. 	* file.c
(Init_File): replace with rb_file_const() with 	  rb_define_const() because
RDoc don&#39;t care rb_file_const. 	  [Bug #5530]</p>

<p>Tue Nov 20 12:35:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* ruby.c (usage_msg): Fix typo [ruby-core:49205] [Bug #7327]</p>

<p>Tue Nov 20 12:35:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* file.c (File::NULL): Document File::NULL constant 	  [ruby-core:49384]
[Bug #7365]</p>

<p>Tue Nov 20 12:05:15 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_read): Windows 8 fixed one of a bug of console 	 
API. 	  based on the patch by Heesob Park at [ruby-core:49479] [Bug #7379]</p>

<p>Tue Nov 20 11:14:33 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (–enable-dtrace): always call RUBY_DTRACE_BSD_BROKEN 	  for
portability. 	  As the note, FreeBSD 8 has DTrace as the optional 	 
feature (it is enabled by the build option), but doesn&#39;t have USDT. 	 
FreeBSD 9 has USDT but they are still optional. FreeBSD 10 will 	  enable
them by default. 	  The variable $rb_cv_prog_dtrace_g is “yes” only on
FreeBSD 9 with 	  optional DTrace or FreeBSD 10. If it is “no”, you cannot
know 	  whether it doesn&#39;t need -G or DTrace is disabled. (by checking
	  error code, you can know)</p>

<p>Mon Nov 19 22:55:48 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* configure.in (–enable-dtrace): change help message</p>

<p>Tue Nov 20 11:05:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/tracer.rb (Tracer.trace_func): printf to stdout 	  Patch by Michal
Fojtik [ruby-core:45219] [Bug #6490]</p>

<p>Mon Nov 19 21:24:18 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* vm_dump.c: not to include probes.h because the code does not depend 	 
on it. 	* common.mk (vm_dump.$(OBJEXT)): remove dependency on probes.h</p>

<p>Tue Nov 20 10:14:22 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_s_check_interrupt): removed redundant 	 
GET_THREAD().</p>

<p>Tue Nov 20 10:12:46 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_threadptr_async_errinfo_active_p): added a small 	 
comment.</p>

<p>Tue Nov 20 10:05:56 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_blocking_region_end): replaced GET_THREAD() 	  with
ruby_thread_from_native(). We don&#39;t have GVL here.</p>

<p>Tue Nov 20 09:56:15 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_threadptr_execute_interrupts) removed. 	* thread.c
(rb_threadptr_execute_interrupts_common) renamed to 	 
rb_threadptr_execute_interrupts. I.e. unified 	 
rb_threadptr_execute_interrupts and rb_threadptr_execute_interrupts_common.
	* thread.c (rb_thread_schedule, rb_thread_execute_interrupts) s/_common//.</p>

<p>Tue Nov 20 09:48:34 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (rb_get_next_signal): removed pointless signal 	  disabling.
pthread_sigmask() only changes current thread 	  mask.</p>

<p>Tue Nov 20 09:36:55 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (install_sighandler): added comments why we need 	 
rb_disable_interrupt().</p>

<p>Tue Nov 20 09:31:33 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (rb_disable_interrupt, rb_enable_interrupt): removed 	 
USE_TRAP_MASK. 	* signal.c (trap_arg, trap_ensure): removed. 	* signal.c
(trap, sig_trap): removed pointless signal disabling. 	  We don&#39;t need
it because we no longer run trap handler on signal 	  handler context.</p>

<p>Tue Nov 20 09:20:49 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* prelude.rb: Moved Mutex#synchronize to 	* thread.c
(rb_mutex_synchronize_m): here. [Bug #4266]</p>

<p>Tue Nov 20 08:36:15 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (sig_signame): implements Signal.signame method 	[Feature
#5613] 	* test/ruby/test_signal.rb (test_signame): adds test for above 	*
NEWS: add an item about above</p>

<p>Mon Nov 19 16:30:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* struct.c (rb_struct_each_pair): yield associated pairs so that 	  an
unsplat argument can get both, for consistency with Hash, 	  OpenStruct,
and etc.  [ruby-dev:46533] [Bug #7382]</p>

<p>Mon Nov 19 16:17:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (LIBS): libelf is need on only FreeBSD.</p>

<p>Mon Nov 19 16:08:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (RUBYLIB): purelib option in runruby.rb is deprecated 	  since
r28841, so set to an empty list to get rid of a bogus path in 	  child
processes, which caused an insecure operation exception in 	 
test/ruby/test_encoding.rb:test_unsafe.</p>

<p>Mon Nov 19 15:40:50 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (script): add OPTS=-v, requested by @_ko1.</p>

<p>Mon Nov 19 15:09:07 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: fix didn&#39;t enable_dtrace=yes on auto.</p>

<p>* configure.in: see enable_dtrace for adding libelf on FreeBSD.</p>

<p>* common.mk: VPATH is not needed.</p>

<p>Mon Nov 19 14:55:51 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c: add `Thread#backtrace_locations&#39; method. 	  This method is
similar to `caller_locations&#39; method for 	  specific method. 	  And fix
to accept `level&#39; and `n&#39; parameters for `Thread#backtrace&#39; 	 
and `Thread#backtrace_locations&#39;. 	  `caller&#39; (and
`caller_locations&#39;) do not return `caller&#39; method 	  frame. 	 
However, `Thread#backtrace&#39; (and `Thread#backtrace_locations&#39;) 	 
return `Thread#backtrace&#39; method frame itself 	  if
`Thread.current.backtrace&#39; was called.</p>

<p>* vm_backtrace.c: ditto.</p>

<p>* internal.h: ditto.</p>

<p>* test/ruby/test_backtrace.rb: add tests.</p>

<p>Mon Nov 19 14:54:32 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* Makefile.in, common.mk (probes.h): moved to common.mk and changed to 	 
see $(srcdir).</p>

<p>* common.mk (probes.dmyh): now created it on $(srcdir) always.</p>

<p>* win32/Makefile.sub (.SUFFIXES): removed common suffix.</p>

<p>Mon Nov 19 10:00:10 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Makefile.in (.SUFFIX): bsdmake needs .SUFFIX is defined before use.</p>

<p>* common.mk: fix path of probes.dmyh.</p>

<p>* common.mk (vm_dump.o): depend probes.h.</p>

<p>* configure.in: FreeBSD&#39;s USDT requires libelf.</p>

<p>Mon Nov 19 01:11:59 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* vm_core.h, probes_helper.h (RUBY_DTRACE_FUNC_ENTRY_HOOK, 	 
RUBY_DTRACE_FUNC_RETURN_HOOK): move from vm_core.h to new file 	 
probes_helper.h for narrowing dependency to probes.h. 	* common.mk
(VM_CORE_H_INCLUDES): remove dependency to probes.h. 	* common.mk
(vm.$(OBJEXT)): add dependency to probes_helper.h. 	* vm.c,
vm_insnhelper.c: include probes_helper.h.</p>

<p>Sun Nov 18 16:33:00 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* configure.in, Makefile.in, common.mk: support DTrace on Solaris 10, 	 
based on r26235 by Yugui. On Solaris 10, low optimization level 	  may also
be needed, e.g. optflags=“-xO1” or “-xO0” with Oracle 	  SolarisStudio 12.3
cc.</p>

<p>* configure.in (–enable-dtrace): new option to enable/disable 	  DTrace
support. By default, trying to enable if dtrace command 	  is found on the
system. It is disabled when cross compiling.</p>

<p>* configure.in (RUBY_DTRACE_POSTPROCESS): new macro. checks whether 	  the
dtrace on the system needs postprocessing with “dtrace -G”. 	  The
postprocessing is needed on Solaris 10 and other platforms.</p>

<p>* configure.in (RUBY_DTRACE_BSD_BROKEN): new macro. checks whether 	  the
dtrace supports USDT.</p>

<p>* configure.in (DTRACE): move after RUBY_DTRACE_POSTPROCESS.</p>

<p>* configure.in (LD): On Solaris, /usr/ccs/bin/ld is preferred.</p>

<p>* configure.in, Makefile.in, common.mk (DTRACE_OBJ): new macro for 	 
DTrace probe object generated by postprocessing with “dtrace -G”.</p>

<p>* Makefile.in, common.mk (probes.$(OBJEXT)): DTrace probe object 	 
generated by the postprocessing. New file probes.stamp is for 	  rebuilding
related objects that may be modified by “dtrace -G”.</p>

<p>* configure.in, Makefile.in, common.mk (DTRACE_GLOMMED_OBJ): new 	  macro
for DTrace static library hacks.</p>

<p>* configure.in, Makefile.in (LIBRUBY_A_OBJS): ditto.</p>

<p>* Makefile.in, common.mk (ruby-glommed.$(OBJEXT)): new target with 	  rule
for DTrace static library hacks.</p>

<p>* common.mk (DTRACE_DEPENDENT_OBJS): objects depended on probes.h.</p>

<p>Sun Nov 18 09:31:47 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (read_comp): mathn compliant. 	* rational.c (read_num): ditto.</p>

<p>Sun Nov 18 02:50:12 2012  Luis Lavena &lt;luislavena@gmail.com&gt;</p>

<p>* win32/file.c (replace_to_long_name): correct logic around wildcard 	 
characters detection and ensure wide-chars are used as pattern. 	 
[ruby-core:49451] [Bug #7374]</p>

<p>Sun Nov 18 02:02:46 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (read_comp): modified handling of polar form.</p>

<p>Sun Nov 18 00:50:44 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (read_comp): fixed handling of polar form.</p>

<p>Sun Nov 18 00:14:46 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (string_to_c_strict, string_to_c): rewrote without regexp. 	*
rational.c (string_to_r_strict, string_to_r): ditto.</p>

<p>Sat Nov 17 23:53:05 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (make_patterns): should not accept extra sign.</p>

<p>Sat Nov 17 21:45:12  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* win32/file.c (replace_to_long_name): skip expansion for all wildcard 	 
characters. 	  [ruby-core:49451] [Bug #7374]</p>

<p>* test/ruby/test_file_exhaustive.rb: add more assertions to test.</p>

<p>Sat Nov 17 12:14:50 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: use literal YAML style 	 
when emitting multi-line strings. Thanks @atambo</p>

<p>* test/psych/test_yaml.rb: test for change.</p>

<p>Sat Nov 17 12:03:41 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: avoid raising exceptions when 	 
parsing Floats and Integers. Thanks riffraff [ruby-core:44426] 	*
test/psych/test_numeric.rb: associated test</p>

<p>Sat Nov 17 11:34:31 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* st.c (st_update): pass the key in st_table so that we can free 	  memory
of the key in st_table when deleting. 	  [ruby-core:49220] [Bug #7330]</p>

<p>* test/-ext-/st/test_update.rb 	 
(Bug::StTable#test_pass_objects_in_st_table): add a test.</p>

<p>Sat Nov 17 11:26:36 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/core_ext.rb: move Kernel#y so that it can 	 
manually be required as &#39;psych/y&#39;.</p>

<p>* ext/psych/lib/psych/y.rb: ditto</p>

<p>Sat Nov 17 08:13:48 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* lib/abbrev.rb: fix r37113. Correct examples, fix style 	  and show
explicit dependency (require &#39;abbrev&#39;).</p>

<p>Sat Nov 17 07:35:15 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* win32/file.c (replace_to_long_name): skip automatic path expansion 	 
when wildcard character is used.  [ruby-core:49451] [Bug #7374]</p>

<p>* test/ruby/test_file_exhaustive.rb: add a test for above.</p>

<p>Sat Nov 17 00:50:23 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* marshal.c (w_object): add flonum to arg-&gt;data to keep reference index
	  consistency. [ruby-core:49323] [Bug #7348]</p>

<p>* test/ruby/test_marshal.rb: add a test for above.</p>

<p>Sat Nov 17 00:40:25 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (incs): dist files need probes.dmyh.</p>

<p>* common.mk (probes.dmyh): depends on generator script.</p>

<p>* Makefile.in, common.mk, configure.in, win32/Makefile.sub (probes.h): 	 
select generating with dtrace or copying dummy file by suffix rules.</p>

<p>Fri Nov 16 19:24:10 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_thread_call_without_gvl2): change the parameter of 	 
`func&#39; from `int *skip_interrupt&#39; to `VALUE *flags&#39;. 	  If
(flags &amp; RUBY_CALL_WO_GVL_FLAG_SKIP_CHECK_INTS) is not zero, 	  then
skip checking interrupt. 	  [ruby-core:46547]</p>

<p>* include/ruby/thread.h: ditto.</p>

<p>Fri Nov 16 18:59:05 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Makefile.in (no-dtrace-probes.h): dmyprobes.h is in srcdir.</p>

<p>* common.mk (dmyprobes.h): ditto.</p>

<p>Fri Nov 16 17:57:15 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (probes.h): split build commands for dtrace-available 	  and
unavailable platforms.</p>

<p>* Makefile.in (incs): probes.h is a platform dependent file, so it 	 
cannot be a part of prereq target.  move it to all-incs.</p>

<p>* configure.in (DTRACE): move after AC_PROG_CC since cross_compiling 	  is
set in it.</p>

<p>* configure.in (DTRACE): ignore non-prefixed version if 	 
cross-compiling.</p>

<p>* Makefile.in, win32/Makefile.sub (probes.h): fix copying dmyprobes.h 	 
path when outplace-build.</p>

<p>Fri Nov 16 15:27:36 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* lib/net/pop.rb (POP3.certs): fix typo in comment. 	  patch from no6v
(Nobuhiro IMAI) &lt;nov@yo.rim.or.jp&gt;. 	  [ruby-dev:46519] [Bug #7355]</p>

<p>Fri Nov 16 12:36:47 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/rake/helper.rb (Rake::TestCase#setup): revert r37669. 	  @orig_PWD
should be the original pwd.</p>

<p>* test/rake/test_*.rb: don&#39;t use @orig_PWD to load libraries. 	  It
should be specified with relative path from the file.</p>

<p>Fri Nov 16 10:22:52 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/rake/helper.rb (Rake::TestCase#setup): @orig_PWD shouldn&#39;t be 	
Dir.pwd when the build directory is different from source directory.</p>

<p>Fri Nov 16 09:41:08 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rake/version.rb:  workaround fix to build. see #7366 	 
[ruby-dev:46522]</p>

<p>Fri Nov 16 07:23:18 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rake*:  Updated to rake 0.9.4 	  <a
href="http://rake.rubyforge.org/doc/release_notes/rake-0_9_4_rdoc.html">rake.rubyforge.org/doc/release_notes/rake-0_9_4_rdoc.html</a>
for 	  a list of changes in 0.9.4.</p>

<p>* test/rake*:  ditto</p>

<p>* NEWS:  ditto</p>

<p>Fri Nov 16 06:58:52 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rake*:  Updated to rake 0.9.3.  See 	  <a
href="http://rake.rubyforge.org/doc/release_notes/rake-0_9_3_rdoc.html">rake.rubyforge.org/doc/release_notes/rake-0_9_3_rdoc.html</a>
for 	  a list of changes in 0.9.3.</p>

<p>* test/rake*:  ditto</p>

<p>* bin/rake:  ditto</p>

<p>* NEWS:  ditto</p>

<p>Thu Nov 15 22:39:32 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* range.c (range_bsearch): fix some bugs: a documentation bug, a wrong 	 
condition, missed break in switch/case, and workaround for GCC 	 
optimization. See [ruby-core:49364] in detail.  A great patch from 	 
Heesob Park. [Bug #7352] [Feature #4766]</p>

<p>* array.c (rb_ary_bsearch): fix similar bug (missed break).</p>

<p>* test/ruby/test_range.rb: add two test cases for above.</p>

<p>Thu Nov 15 22:41:57 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_exec.h (GENTRY): GENTRY should be pointer size. 	  A patch by
yoshidam (Yoshida Masato) [Bug #7332].</p>

<p>Thu Nov 15 13:20:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* man/erb.1: Fix grammar and copyright dates 	* man/goruby.1: ditto 	*
man/irb.1: ditto 	* man/rake.1: ditto 	* man/ri.1: ditto 	* man/ruby.1:
ditto 	  Patch by Arthur Gunn 	  [Fixes Github #210]</p>

<p>Thu Nov 15 11:35:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* man/ruby.1: Grammar edits for man page 	  Based on a patch by Michael
Endsley [Fixes Github #183]</p>

<p>Thu Nov 15 00:47:20 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* array.c (rb_ary_bsearch): add Array#bsearch for binary search. 	 
[ruby-core:36390] [Feature #4766]</p>

<p>* test/ruby/test_array.rb: add a test for above.</p>

<p>* range.c (range_bsearch): add Range#bsearch for binary search. 	 
[ruby-core:36390] [Feature #4766]</p>

<p>* test/ruby/test_range.rb: add a test for above</p>

<p>* NEWS: added the two new methods.</p>

<p>Wed Nov 14 13:25:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/fileutils.rb (chmod): Add “X” to modes, convert format to table 	 
[ruby-core:48965] [Bug #7288]</p>

<p>Wed Nov 14 11:51:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/csv.rb (init_comments): Document private method #init_comments. 	 
Based on a patch from Vincent Batts [ruby-core:49172] [Bug #7319]</p>

<p>Wed Nov 14 00:54:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* Makefile.in (probes.h): create from probes.d</p>

<p>Tue Nov 13 18:44:01 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_call_cfunc_with_frame): don&#39;t use ci after 	 
EXEC_EVENT_HOOK because ci can be overridden.</p>

<p>* vm_eval.c: ditto.</p>

<p>* method.h: change invoker&#39;s parameters types.</p>

<p>* vm_method.c (call_cfunc_invoker_func): ditto.</p>

<p>Tue Nov 13 18:01:54 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_using): raise an ArgumentError if cyclic using is 	 
detected.  based on the patch by Charlie Somerville. 	  [ruby-core:49092]
Bug #7308</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Tue Nov 13 17:40:04 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* common.mk (vm_insnhelper.c): this target is useless and causes 	  ruby
always need rebuild.</p>

<p>Tue Nov 13 17:35:49 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (insn_data_to_s_detail): remove debug lines.</p>

<p>Tue Nov 13 17:28:47 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_caller_setup_args): save and restore 	  ci-&gt;argc
and ci-&gt;blockptr before and after method invocations 	  because these
method dispatches can override call_info.</p>

<p>* bootstraptest/test_method.rb: add tests for this fix.</p>

<p>Tue Nov 13 16:38:02 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* common.mk (dmyprobes.h): always create for make dist.</p>

<p>* Makefile.in (probes.h): create or copy dmyprobes.h</p>

<p>* win32/Makefile.sub: only do copy dmyprobes.h.</p>

<p>Tue Nov 13 15:37:21 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Makefile.in (.SUFFIX): .SUFFIX is needed here for .d.h on bsd make.</p>

<p>Tue Nov 13 15:34:35 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk Makefile.in win32/Makefile.sub (.d.h): it&#39;s not common.</p>

<p>Tue Nov 13 12:27:11 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: disable dtrace because it doesn&#39;t work on FreeBSD.</p>

<p>* common.mk (clean-local): rm probes.h.</p>

<p>* common.mk (parse.o): depend $(PROBES_H_INCLUDES).</p>

<p>* common.mk (.d.h): moved from Makefile.in and use BASERUBY.</p>

<p>* tool/gen_dummy_probes.rb: reimplemented with ruby because sed is not 	 
available on Windows Microsoft VC++ environment.</p>

<p>Tue Nov 13 12:30:26 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/README.win32: added mention about build directory.  currently 	 
we can not build ruby in win32 directory.  this problem is reported 	  by
Masahiro Kitajima &lt;katonbo@katontech.com&gt;.</p>

<p>Tue Nov 13 11:03:47 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* re.c (rb_memsearch_ss): performance improvement by using memmem(3) if 	 
possible. [ruby-dev:45530] [Feature #6311]</p>

<p>* configure.in: check existence of memmem(3) and that it is not broken.</p>

<p>Tue Nov 13 06:50:02 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* probes.d: add DTrace probe declarations. [ruby-core:27448]</p>

<p>* array.c (empty_ary_alloc, ary_new): added array create DTrace probe.</p>

<p>* compile.c (rb_insns_name): allowing DTrace probes to access 	 
instruction sequence name.</p>

<p>* Makefile.in: translate probes.d file to appropriate header file.</p>

<p>* common.mk: declare dependencies on the DTrace header.</p>

<p>* configure.in: add a test for existence of DTrace.</p>

<p>* eval.c (setup_exception): add a probe for when an exception is 	 
raised.</p>

<p>* gc.c: Add DTrace probes for mark begin and end, and sweep begin and 	 
end.</p>

<p>* hash.c (empty_hash_alloc): Add a probe for hash allocation.</p>

<p>* insns.def: Add probes for function entry and return.</p>

<p>* internal.h: function declaration for compile.c change.</p>

<p>* load.c (rb_f_load): add probes for `load` entry and exit, require 	 
entry and exit, and wrapping search_required for load path search.</p>

<p>* object.c (rb_obj_alloc): added a probe for general object creation.</p>

<p>* parse.y (yycompile0): added a probe around parse and compile phase.</p>

<p>* string.c (empty_str_alloc, str_new): DTrace probes for string 	 
allocation.</p>

<p>* test/dtrace/*: tests for DTrace probes.</p>

<p>* vm.c (vm_invoke_proc): add probes for function return on exception 	 
raise, hash create, and instruction sequence execution.</p>

<p>* vm_core.h: add probe declarations for function entry and exit.</p>

<p>* vm_dump.c: add probes header file.</p>

<p>* vm_eval.c (vm_call0_cfunc, vm_call0_cfunc_with_frame): add probe on 	 
function entry and return.</p>

<p>* vm_exec.c: expose instruction number to instruction name function.</p>

<p>* vm_insnhelper.c: add function entry and exit probes for cfunc 	 
methods.</p>

<p>* vm_insnhelper.h: vm usage information is always collected, so 	 
uncomment the functions.</p>

<p>Mon Nov 12 19:14:50 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* configure.in (isinf, isnan): isinf() and isnan() are macros on 	 
DragonFly which cannot be found by AC_REPLACE_FUNCS().  This 	  workaround
enforces the fact that they exist on DragonFly.</p>

<p>Mon Nov 12 15:59:38 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_core.h (rb_call_info_t::refinements), compile.c (new_callinfo), 	 
vm_insnhelper.c (vm_search_method): revert r37616 because it&#39;s too 	 
slow.  [ruby-dev:46477]</p>

<p>* test/ruby/test_refinement.rb (test_inline_method_cache): skip 	  the
test until the bug is fixed efficiently.</p>

<p>Mon Nov 12 14:28:01 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/mkexports.rb (each_export): skip garbage generated by VS2012&#39;s
	  nmake. 	  reported and patched by Yoshida Masato at [Bug #7333]
[ruby-dev:46484]</p>

<p>Sun Nov 11 18:58:55 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* test/date/test_date_<code>parse,strptime</code>.rb: changed the format of 	  some
extra messages.</p>

<p>Sun Nov 11 18:41:34 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c (date__parse): revised the tight parser 	  (about
handling of apostrophes).</p>

<p>Sun Nov 11 15:39:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_hash_s_create): just warn for wrong elements now. 	 
[ruby-dev:46440] [Bug #7300]</p>

<p>* hash.c (rb_hash_s_create): refine error messages.</p>

<p>* error.c (rb_builtin_class_name): share for above.</p>

<p>Sun Nov 11 15:12:18 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (top_using): remove Kernel#using, and add main.using instead.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sun Nov 11 13:41:01 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_using_refinement, rb_mod_using, f_using): clear method 	 
cache only when using is called explicitly.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sun Nov 11 12:56:34 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* lib/pstore.rb (PStore): fix not to replace ThreadError raised in 	 
#transaction block with PStore::Error. 	  [ruby-core:39238] [Bug #5269]</p>

<p>Sun Nov 11 11:36:19 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_core.h (rb_call_info_t::refinements), compile.c (new_callinfo): 	 
add a new field for inline method cache.</p>

<p>* vm_insnhelper.c (vm_search_method): check rb_call_info_t::refinements 	 
not to confuse inline method cache when module_eval is used with 	 
refinements.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Sun Nov 11 08:45:45 2012  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* ruby.c: removed a comma before “before”</p>

<p>Sat Nov 10 23:02:31 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: move immutable fields from struct heaps_slot and struct 	 
sorted_heaps_slot into struct heaps_header. 	  Based on a patch from
Sokolov Yura [Feature #<a href="ruby-core:43592">6199]</a></p>

<p>Sat Nov 10 19:28:16 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c: modified doc. 	* rational.c: ditto.</p>

<p>Sat Nov 10 18:20:10 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c: edited about era.</p>

<p>Sat Nov 10 12:13:41 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* tool/rbinstall.rb: Don&#39;t install *.gemspec under lib/. 	 
[ruby-core:48966] [Bug #7289] 	  Reported by Vit Ondruch. Thanks!!!</p>

<p>Sat Nov 10 00:49:26 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ruby_atomic.h: renamed from atomic.h to avoid header file name 	 
conflict on Solaris 10. [ruby-dev:46414] [Bug #7287]</p>

<p>* gc.c, signal.c, vm_core.h, common.mk: reflect the rename from 	 
atomic.h to ruby_atomic.h.</p>

<p>Sat Nov 10 00:46:57 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* atomic.h: Revert r37491 which is a temporary workaround.</p>

<p>Sat Nov 10 00:33:31 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* siphash.h: check configure macros before include newer headers.</p>

<p>Fri Nov  9 23:33:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/erb.rb (ERB#run, ERB#result): eval under isolated bindings for 	 
safe concurrent use.  [ruby-core:47638] [Bug #7046]</p>

<p>Fri Nov  9 23:05:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (BYTE_ORDER): define using configured WORDS_BIGENDIAN.</p>

<p>* siphash.c (sip_init_state): use union to suppress warnings by gcc 	 
4.7.</p>

<p>Fri Nov  9 19:40:03 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_splice): fix r37583 doesn&#39;t consider the case when 	
beg &gt; array length.</p>

<p>Fri Nov  9 16:11:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (rb_memhash): use siphash.</p>

<p>Fri Nov  9 16:08:46 2012  Sokolov Yura funny-falcon 
&lt;funny.falcon@gmail.com&gt;</p>

<p>* array.c: speedup Array#unshift by using space in shared array. 	 
[Feature #6638] 	  - when array owns its shared array (ARY_SHARED_NUM ==
1), and there 	    is enough space then try unshift values directly into
shared 	    array. 	  - when resulting array is big (~&gt;64 items) then
make it shared with 	    enough room for future #unshifts, and then insert
into shared 	    array.</p>

<p>* array.c (rb_ary_splice): use shared array in rb_ary_slice. 	  [Feature
#6638] 	  - use ary_ensure_room_for_push when rb_ary_slice used to add at
the 	    end of array, cause rb_ary_concat use rb_ary_slice.</p>

<p>* array.c (ary_ensure_room_for_push): make array really suitable for 	 
queue.  [Feature #6638] 	  when array is shared (which happens after
Array#shift), and 	  ARY_SHARED_NUM == 1 (which is very often when array
used as queue), 	  then make rb_ary_push push directly into shared array.</p>

<p>* array.c (rb_ary_modify): steal shared array&#39;s container when 	 
ARY_SHARED_NUM == 1.  [Feature #6638] 	  - Do not allocate new memory in
rb_ary_modify when ARY_SHARED_NUM == 1 	    and length almost same. 	  -
Store ARY_CAPA instead of RARRAY_LEN in ary_make_shared, to make 	    it
useful. 	  - Fix rb_ary_sort_bang accordantly.</p>

<p>Fri Nov  9 16:00:00 2012  Zachary Scott  &lt;zzak@zacharyscott.net&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c: Documentation for BigDecimal 	  Based on a
patch from Vincent Batts [ruby-core:49047] [Bug #7305]</p>

<p>Fri Nov  9 15:25:42 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/shellwords.rb (Shellwords#shellescape): Add back my original 	  real
world example with some enhancement.</p>

<p>* lib/shellwords.rb (Shellwords#shelljoin): Undo part of the 	  previous
rdoc change.  This new example using a string-only 	  array was not in line
with the description.</p>

<p>Fri Nov  9 12:58:13 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_crypt): crypt(3) may return NULL. 	  Latest glibc
(2.16?) crypt(3) actually returns NULL. [Bug #7312]</p>

<p>Fri Nov  9 12:07:06 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* include/ruby/ruby.h (alloca), eval_intern.h (alloca), gc.c 	  (alloca):
Make alloca() globally available by moving the 	  ultimate ifdef&#39;s to
ruby/ruby.h.  Gcc hides its builtin alloca() 	  when compiling with -ansi,
and linking thus fails on platforms 	  that lack their own alloca()
implementation in libc, which 	  include OpenBSD and some ports of NetBSD. 
We use alloca() 	  everywhere including from within third party C
extensions, so 	  alloca() must be made globally available. [Bug #7307]</p>

<p>* addr2line.c (alloca): Replace the alloca() part with the 	  ultimate
ifdef&#39;s. [Bug #7307]</p>

<p>Fri Nov  9 09:30:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* io.c (IO#new): 	  Fix indentation from r37444 	  [ruby-core:48052] [Bug
#7179]</p>

<p>Fri Nov  9 07:36:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (bigmul0): enable big_mul_toom3. 	  [ruby-core:48552] [Bug
#7242]</p>

<p>* bignum.c (bigmul1_toom3): fix incorrect calculation. 	  the patch is
made by Heesob Park. 	  [ruby-core:48552] [Bug #7242]</p>

<p>Fri Nov  9 05:33:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (bigmul0): disable big_mul_toom3 temporarily. 	 
[ruby-core:48552] [Bug #7242]</p>

<p>* test/ruby/test_bignum.rb (test_mul_large_numbers): 	  add a test for
bigmul1_toom3 suggested in [Bug #7242].</p>

<p>Thu Nov  8 21:57:59 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* re.c (rb_memsearch): performance improvement by using memchr(). 	 
[ruby-dev:45397] [Feature #6173]</p>

<p>Thu Nov  8 19:02:50 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/protocol.rb (Net::InternetMessageIO#each_crlf_line): 	  treat r
as newline as mame pointed. [ruby-dev:46425] [Bug #7278]</p>

<p>Thu Nov  8 11:32:11 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* configure.in (–with-opt-dir): Avoid nesting of double quotes 	  inside
backquotes, since some traditional shells like PD KSH 	  (which
OpenBSD&#39;s /bin/sh bases on) fail to parse them.</p>

<p>Thu Nov  8 09:34:00 2012  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>* numeric.c: Add a caution that the results of the comparing 	  operations
of two NaNs are undefined. 	  [#1720] [ruby-dev:38725] [ruby-core:36966]</p>

<p>Thu Nov  8 04:45:21 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* include/ruby/intern.h: Restore rb_enumeratorize as it was before 	 
r37497 and introduce rb_enumeratorize_with_size instead. [#7302]</p>

<p>* enumerator.c: ditto.</p>

<p>Wed Nov  7 15:22:37 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* numeric.c (ruby_float_step): fix r37514: it yielded with NaN 	  if the
unit is infinity.</p>

<p>Wed Nov  7 15:46:12 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/webrick.rb: fix typo. reported by Rohit Arondekar. 	  <a
href="https://github.com/ruby/ruby/pull/211">github.com/ruby/ruby/pull/211</a></p>

<p>Wed Nov  7 15:34:12 2012  Takeyuki FUJIOKA  &lt;xibbar@ruby-lang.org&gt;</p>

<p>* lib/cgi/core.rb: alias CGI#http_header to CGI#header.</p>

<p>Wed Nov  7 12:49:39 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_refine): set RMODULE_IS_REFINEMENT to a created 	 
refinement module, and don&#39;t override method_added.</p>

<p>* vm_method.c (rb_method_entry_make): check redefinition of 	  optimized
methods when a method is added to a refinement module. 	  [ruby-core:48970]
[Bug #7290]</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Wed Nov  7 11:48:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* misc/ruby-additional.el (ruby-mode-set-encoding): now encoding needs 	 
to be set always explicitly actually.  [Feature #6679]</p>

<p>Wed Nov  7 09:15:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_mod_const_get): avoid inadvertent symbol creation.</p>

<p>Wed Nov  7 07:52:50 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enum.c (rb_enum_cycle_size): prefix with rb.</p>

<p>Wed Nov  7 04:32:15 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* test/ruby/test_file_exhaustive.rb: Remove FIXME skip on Windows 	 
specific test because the test in question was already fixed.</p>

<p>Wed Nov  7 03:45:12 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* ext/zlib/extconf.rb: Recognize zlibwapi as linking library. 	  Patch by
Daniel Berger.</p>

<p>[ruby-core:44979] [Feature #6421]</p>

<p>Wed Nov  7 02:06:40 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* enumerator.c: New method #size; constructor accepts size. 	             
Have #to_enum accept a block 	                Warn when using deprecated
form of constructor 	                Support #size for enumerators created
from enumerators 	                Support for lazy.<code>map|flat_map|…</code>.size.</p>

<p>* include/ruby/intern.h: RETURN_SIZED_ENUMERATOR for support of 	  sized
enumerators.</p>

<p>* array.c: Support for various enumerator.size.</p>

<p>* enum.c: ditto.</p>

<p>* hash.c: ditto.</p>

<p>* numeric.c: ditto.</p>

<p>* range.c: ditto.</p>

<p>* string.c: ditto.</p>

<p>* struct.c: ditto.</p>

<p>* vm_eval.c: ditto.</p>

<p>Tue Nov  6 20:40:28 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* object.c (rb_mod_const_get): Fix constant missing exception class 	  and
message to maintain backwards compatibility. Constant search 	  should
start at Object when constant starts with &#39;::&#39;</p>

<p>* test/ruby/test_module.rb: test for fixes</p>

<p>Tue Nov  6 16:50:00 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* lib/tempfile.rb (Tempfile#inspect): fix confusing #inspect. 	  previous
Tempfile#inspect says it is a File, but actually 	  it is not a File.</p>

<p>t = Tempfile.new(“foo”) #=&gt;
#&lt;File:/tmp/foo20121106-31970-1ffbum0&gt; 	    t.is_a? File #=&gt; false</p>

<p>now Tempfile#inspect returns like:</p>

<p>t = Tempfile.new(“foo”) 	    #=&gt;
#&lt;Tempfile:/tmp/foo20121106-31970-1ffbum0&gt;</p>

<p>[ruby-core:47544] [Bug #7027]</p>

<p>Tue Nov  6 16:22:30 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* atomic.h: add #include &lt;sys/atomic.h&gt; for the workaround of 	 
header file name conflict of atomic.h with /usr/include/atomic.h 	  on
Solaris 10. [ruby-dev:46414] [Bug #7287]</p>

<p>Tue Nov  6 14:38:00 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/win32ole/test_win32ole.rb: now source encoding is UTF-8, so 	 
binary strings in old scripts are dangerous.</p>

<p>Tue Nov  6 14:25:09 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/protocol.rb (Net::InternetMessageIO#each_crlf_line): 	 
don&#39;t use /n in universal regexp. [ruby-dev:46394] [Bug #7278]</p>

<p>Tue Nov  6 09:42:26 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_b): Add String#b, returning a copied string 	  whose
encoding is ASCII-8BIT. [ruby-dev:45992] [Feature #6767]</p>

<p>Tue Nov  6 09:37:57 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ruby.c (load_file_internal): set default source encoding as 	  UTF-8
instead of US-ASCII. [ruby-core:46021] [Feature #6679]</p>

<p>* parse.y (parser_initialize): set default parser encoding as 	  UTF-8
instead of US-ASCII.</p>

<p>Tue Nov  6 05:48:06 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_require.rb 	 
(TestRequire#test_require_to_path_redefined_in_load_path, 	  
TestRequire#test_require_to_str_redefined_in_load_path): 	  Suppress method
redefined warning when test-all with RUBYOPT=-w.</p>

<p>Thu Nov  8 00:24:14 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* ext/curses/view.rb: Do not fail if the file to view is shorter 	  than
the screen height.</p>

<p>Mon Nov  5 11:40:00 2012  Mark Somerville  &lt;mark@scottishclmibs.com&gt;</p>

<p>* thread_pthread.c (rb_reserved_fd_p): fix typo in macro check 	  that
prevented the ifdef ever being true. 	  [Bug #7281] [ruby-core:48940]</p>

<p>Mon Nov  5 23:28:57 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* file.c (rb_get_path_check_to_string): extract from 	 
rb_get_path_check(). We change the spec not to call to_path of 	  String
object.</p>

<p>* file.c (rb_get_path_check_convert): extract from rb_get_path_check().</p>

<p>* file.c (rb_get_path_check): follow the above change.</p>

<p>* file.c (rb_file_expand_path_fast): remove check_expand_path_args(). 	 
Instead we call it in load.c.</p>

<p>* file.c (rb_find_file_ext_safe): use rb_get_expanded_load_path() to 	 
reduce expand cost.</p>

<p>* file.c (rb_find_file_safe): ditto.</p>

<p>* internal.h (rb_get_expanded_load_path): add a declaration.</p>

<p>* internal.h (rb_get_path_check_to_string, rb_get_path_check_convert): 	 
add declarations.</p>

<p>* load.c (rb_construct_expanded_load_path): fix for compatibility. 	  Same
checks in rb_get_path_check() are added. We don&#39;t replace 	  $LOAD_PATH
and ensure that String object of $LOAD_PATH are frozen. 	  We don&#39;t
freeze non String object and expand it every time. We add 	  arguments for
expanding load path partially and checking if load path 	  have relative
paths or non String objects.</p>

<p>* load.c (load_path_getcwd): get current working directory for checking 	 
if it&#39;s changed when getting load path.</p>

<p>* load.c (rb_get_expanded_load_path): fix for rebuilding cache properly. 	
We check if current working directory is changed and rebuild expanded 	 
load path cache. We expand paths which start with ~ (User HOME) and 	  non
String objects every time for compatibility. We make this 	  accessible
from other source files.</p>

<p>* load.c (rb_feature_provided): call rb_get_path() since we changed 	 
rb_file_expand_path_fast() not to call it.</p>

<p>* load.c (Init_load): initialize vm-&gt;load_path_check_cache.</p>

<p>* vm.c (rb_vm_mark): mark vm-&gt;load_path_check_cache for GC.</p>

<p>* vm_core.h (rb_vm_struct): add vm-&gt;load_path_check_cache to store data
	  to check load path cache validity.</p>

<p>* test/ruby/test_require.rb (TestRequire): add tests for require 	 
compatibility related to cached expanded load path. 	  [ruby-core:47970]
[Bug #7158]</p>

<p>Mon Nov  5 23:26:05 2012  Greg Price  &lt;price@mit.edu&gt;</p>

<p>* load.c (rb_get_expanded_load_path): cache the expanded load 	  path. 
This saves 4KB of allocation and some stats for every 	  element of the
load path (so nearly a MB in my Rails app) 	  on every require.</p>

<p>* load.c (rb_construct_expanded_load_path): ensure that $LOAD_PATH 	 
entries are frozen strings.  The user must mutate $LOAD_PATH 	  itself
rather than its individual entries.</p>

<p>* vm_core.h (rb_vm_struct): add fields.</p>

<p>* vm.c (rb_vm_mark): mark new fields.</p>

<p>* ruby.c (process_options): modify $LOAD_PATH directly rather than 	  its
elements. 	  Patch by Greg Price. 	  [ruby-core:47970] [Bug #7158]</p>

<p>Mon Nov  5 23:24:42 2012  Greg Price  &lt;price@mit.edu&gt;</p>

<p>* load.c (rb_feature_p, rb_provide_feature): index $LOADED_FEATURES 	  so
that require isn&#39;t so slow.</p>

<p>* load.c (rb_provide_feature, get_loaded_features_index): ensure 	  that
$LOADED_FEATURES entries are frozen strings.  The user 	  must mutate
$LOADED_FEATURES itself rather than its individual 	  entries.</p>

<p>* load.c (reset_loaded_features_snapshot): add a new function to reset 	 
vm-&gt;loaded_features_snapshot.</p>

<p>* load.c (get_loaded_features_index_raw): add a new function to get 	  the
loaded-features index.</p>

<p>* load.c (features_index_add_single): add a new function to add to the 	 
loaded-features index a single feature.</p>

<p>* load.c (features_index_add): add a new function to add to the 	 
loaded-features index all the required entries for `feature`.</p>

<p>* vm_core.h (rb_vm_struct): add fields.</p>

<p>* vm.c (rb_vm_mark): mark new fields.</p>

<p>* include/ruby/intern.h (rb_hash_clear): declare function.</p>

<p>* hash.c (rb_hash_clear): make function non-static. 	  Patch by Greg
Price. 	  [ruby-core:47970] [Bug #7158]</p>

<p>Mon Nov  5 23:23:51 2012  Greg Price  &lt;price@mit.edu&gt;</p>

<p>* array.c (rb_ary_shared_with_p): new function. 	  Expose whether two
arrays are shared (read-only, C only).</p>

<p>* include/ruby/intern.h (rb_ary_shared_with_p): declare. 	  Patch by Greg
Price. 	  [ruby-core:47970] [Bug #7158]</p>

<p>Mon Nov  5 23:21:14 2012  Greg Price  &lt;price@mit.edu&gt;</p>

<p>* load.c (loaded_feature_path): clarify and briefly comment 	  function. 
These clarifications have no effect on the behavior 	  of the function.</p>

<p>* load.c (rb_feature_p): explain the search loop.  Especially 	  useful
because the logic is complicated as described in the 	  second paragraph. 	
Patch by Greg Price. 	  [ruby-core:47970] [Bug #7158]</p>

<p>Mon Nov  5 22:45:03 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* ext/dl/win32/lib/Win32API.rb (Win32API#call): use 64bit pointer for x64
	  Windows. This would fix 	 
TestSecureRandom#test_s_random_bytes_without_openssl error. 	 
[ruby-core:47451] [Bug #6990]</p>

<p>Mon Nov  5 22:09:26 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* cygwin/GNUmakefile.in (uncommon.mk): link *.res.o. 	  EXTOBJES is
defined in uncommon.mk. *.res.o setting should be below 	  uncommon.mk. 	 
[ruby-core:48858] [Bug #7277]</p>

<p>Mon Nov  5 11:35:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (native_thread_init, native_thread_destroy): 	  removed
HAVE_PTHREAD_CONDATTR_INIT check because this silly 	  #ifdef makes
use-uninitialized-var issue and (2) native_cond_initialize() 	  already
have a right platform and caller don&#39;t need any additional care. 	 
[Bug #6825]</p>

<p>Mon Nov  5 10:57:59 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/cgi/core.rb: check if Tempfile is defined before use it.</p>

<p>* lib/cgi/core.rb: remove tempfiles only if tempfiles exist</p>

<p>Mon Nov  5 12:17:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/uri/http.rb (URI::HTTP.build): Fix example 	  Patch by Carina C.
Zona 	  [Fixes #209 Github]</p>

<p>Mon Nov  5 09:55:05 2012  Takeyuki FUJIOKA  &lt;xibbar@ruby-lang.org&gt;</p>

<p>* lib/cgi/core.rb: remove tempfile more early.</p>

<p>Sun Nov  4 20:29:46 2012  Takeyuki FUJIOKA  &lt;xibbar@ruby-lang.org&gt;</p>

<p>* lib/cgi.rb, lib/cgi/*/rb: rename CGI#header to CGI#http_header, 	  add
and update HTML5 tag generator.  [Bug #7110] 	  Patch provided by Marcus
Stollsteimer, thank you !</p>

<p>Sun Nov  4 11:47:39 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* lib/fileutils.rb (module FileUtils): repatch [ruby-core:39622] 	 
[Feature #5337]. improve performance of FileUtils.compare_stream. 	 
[ruby-core:47545] [Feature #7028]</p>

<p>Sun Nov  4 11:27:54 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* array.c (recursive_equal): fix to return true when self and other 	  are
resized to same size and the current index become out of 	  range.</p>

<p>* test/ruby/test_array.rb: add a test for the above.</p>

<p>Sun Nov  4 10:19:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (file_s_fnmatch): match with expanding braces if FNM_EXTGLOB 	  is
set.  [ruby-core:40037] [Feature #5422]</p>

<p>Sat Nov  3 23:38:15 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c: modified doc. 	* rational.c: ditto.</p>

<p>Sat Nov  3 22:38:55 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: modified doc.</p>

<p>Sat Nov  3 18:35:55 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (rb_vm_rewrite_ep_in_errinfo, vm_rewrite_ep_in_errinfo): 	  merge
code and remove `rb_vm_rewrite_ep_in_errinfo&#39;.</p>

<p>Sat Nov  3 18:15:24 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c, proc.c: avoid unnecessary `rb_vm_rewrite_ep_in_errinfo&#39; 	 
calls.</p>

<p>Sat Nov  3 17:53:43 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* bin/testrb: Use only Test::Unit::AutoRunner in test-unit gem 	 
compatible API to be available by both test/unit bundled in Ruby 	  and
test-unit gem. 	* lib/test/unit.rb (Test::Unit::AutoRunner): Move codes
from testrb.</p>

<p>Sat Nov  3 14:56:21 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c (parse_eu): should capture apostrophe too.</p>

<p>Sat Nov  3 14:46:15 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c (date__parse): revised the tight parser.</p>

<p>Sat Nov  3 14:43:42 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/xmldecl.rb (REXML::XMLDecl#content): Add missing A 	  and z.</p>

<p>Sat Nov  3 14:42:55 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/output.rb (REXML::Output#initialize): Use normalized 	 
encoding name.</p>

<p>Sat Nov  3 14:41:17 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/output.rb (REXML::Output): Don&#39;t output BOM in middle 	 
of the output string. 	* test/rexml/test_document.rb: Add a test for the
above change.</p>

<p>Sat Nov  3 14:09:55 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* NEWS: Add an item about REXML::Document#write.</p>

<p>Sat Nov  3 13:46:49 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* test/rexml/test_document.rb: Fix tests that expect encoding name 	 
isn&#39;t normalized.</p>

<p>Sat Nov  3 13:26:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* dir.c (Dir#glob): 	  Documentation for pattern section, backslash
subsection 	  Patch by Eric Bouchut 	  [ruby-core:48528] [Bug #7230]</p>

<p>Sat Nov  3 13:26:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* io.c (IO#new): 	  Documentation for IO#open modes and formatting 	 
[ruby-core:48052] [Bug #7179]</p>

<p>Sat Nov  3 13:01:02 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* test/rexml/test_encoding.rb (EncodingTester#test_in_different_out): 	 
Fix a test that expects encoding in XML declaration is changed by 	 
Output&#39;s encoding. It is dropped feature.</p>

<p>Sat Nov  3 12:49:45 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document#write): Document encoding 	 
option. Now different encoding between XML file&#39;s encoding and 	  XML
declaration&#39;s encoding is support. 	  [Feature #4872] (work in
progress) 	* lib/rexml/xmldecl.rb (REXML::XMLDecl#write): Always use
XMLDecl&#39;s 	  encoding. 	* test/rexml/test_document.rb: Update tests for
the above change.</p>

<p>Sat Nov  3 12:18:35 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* array.c (recursive_equal): fix not to make invalid pointers when 	  self
and other are resized to same size in #== of their elements. 	 
[ruby-dev:46373] [Feature #6177]</p>

<p>Sat Nov  3 12:06:15 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* test/rexml/test_xml_declaration.rb (TestXmlDeclaration#test_*): 	 
Remove needless prefix from test names.</p>

<p>Sat Nov  3 12:04:52 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* test/rexml/test_xml_declaration_parent_child.rb: Rename to … 	*
test/rexml/test_xml_declaration.rb: … this.</p>

<p>Sat Nov  3 11:43:00 2012  Zachary Scott  &lt;zachary@zacharyscott.net&gt;</p>

<p>* hash.c (rb_hash_delete): Correct grammar 	  Patch by Glenn Oppegard 	 
[Fixes #208 Github]</p>

<p>Sat Nov  3 11:28:28 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* NEWS: add a news about GC::Profiler.raw_data.</p>

<p>Sat Nov  3 11:01:32 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* NEWS: add a news about rb_newobj_of() and NEWOBJ_OF().</p>

<p>Sat Nov  3 10:17:41 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* eval.c (f_current_dirname): add the new method for Kernel. 	  This
method almost same as File.dirname(__FILE__). One 	  different behavior is
it returns nil when __FILE__ returns nil. 	  [Feature #3346]</p>

<p>* NEWS:  ditto</p>

<p>* test/ruby/test_method.rb: related test.</p>

<p>Sat Nov  3 09:03:34 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* test/ruby/test_refinement.rb (test_new_method_by_send, 	 
test_new_method_by_method_object): add tests for Kernel#send and 	 
Kernel#method with refinements.</p>

<p>* test/ruby/test_refinement.rb (test_symbol_to_proc): add a test 	 
calling a proc created by Symbol#to_proc outside the scope where 	  a
refinement is closed over.</p>

<p>Sat Nov  3 04:14:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (rb_vm_rewrite_ep_in_errinfo): rewrite all catch points in 	 
errinfo, not only the topmost frame.  based on the patch by 	  ktsj (Kazuki
Tsujimoto) in [ruby-dev:45656]. [Bug #6460]</p>

<p>Fri Nov  2 20:11:17 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#timestamp_file): remove @ which looks like 	 
configure variables.</p>

<p>* lib/mkmf.rb (MakeMakefile#timestamp_file): use .-. instead of !, a 	 
special character of NMAKE and BSD make.  [Bug #7265]</p>

<p>Fri Nov  2 17:55:39 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb (_run_parallel): Delete status line before showing 	 
results. Patch by Hiroshi Shirosaki. [Bug #6897] [ruby-core:47250]</p>

<p>* lib/test/unit.rb (_run_parallel): Fix strange result when disabled
retrying. 	  Patch by Hiroshi Shirosaki. [Bug #6897] [ruby-core:47250]</p>

<p>Fri Nov  2 17:52:12 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* object.c (rb_mod_to_s): Module#<code>to_s,inspect</code>, when invoked on 	  a
refinement, returns a string in the format #&lt;refinement:C@M&gt;, 	 
where C is a refined class and M is a module at which the refinement 	  is
defined.</p>

<p>* eval.c (rb_mod_refine): store information on a refinement for the 	 
above change.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Fri Nov  2 16:57:52 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* vm_dump.c (rb_vm_bugreport): Because of many log directories, 	  making
directory lists readable.</p>

<p>Fri Nov  2 16:44:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* vm_dump.c (rb_vm_bugreport): add ~/Library/Logs/DiagnosticReports 	  in
the locations list of crash reports.</p>

<p>Fri Nov  2 14:52:52 2012  Masaki Matsushita  &lt;glass.saga@gmail.com&gt;</p>

<p>* array.c (recursive_equal): performance improvement by avoiding 	 
overhead to call rb_ary_elt(). 	  [ruby-dev:45412] [Feature #6177]</p>

<p>Fri Nov  2 14:47:53 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* string.c (sym_to_proc, sym_call): A Proc created by Symbol#to_proc 	 
should close over the current refinements. 	  [ruby-dev:46345] [Bug #7261]</p>

<p>* vm_eval.c (rb_call0, rb_search_method_entry, 	 
rb_funcall_passing_block_with_refinements): add a new argument 	 
`refinements&#39; for the above changes.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Fri Nov  2 08:24:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (top_define_method): new method, main.define_method. 	 
[ruby-core:45715] [Feature #6609]</p>

<p>* eval.c (top_include): fix a warning message, main is not a class or 	 
module.</p>

<p>Fri Nov  2 04:41:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#timestamp_file): use ! instead of %, a GNU 	 
make special character.</p>

<p>Fri Nov  2 04:40:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/test_process.rb (test_execopts_preserve_env_on_exec_failure):
	  use never existing file in the current temporary directory.</p>

<p>Fri Nov  2 04:23:20 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: add feature to tag preview/rc.</p>

<p>Fri Nov  2 03:23:37 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb: fix for if <a href=""libdir"">config</a> is nil.</p>

<p>Thu Nov  1 23:06:01 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/make-snapshot: fix wrong regexp for releasing preview. 	  patched
by mame.</p>

<p>Thu Nov  1 22:27:11 2012  Koichi Sasada &lt;ko1@atdot.net&gt;</p>

<p>* NEWS: add a news about objspace, 	  ObjectSpace.reachable_objects_from.</p>

<p>Thu Nov  1 21:57:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_new), 	 
test/bigdecimal/test_bigdecimal.rb: 	  Fix exception message of BigDecimal
constructor with a Float.</p>

<p>Thu Nov  1 21:52:20 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_add), 	 
test/bigdecimal/test_bigdecimal.rb: 	  need to specify precision for
converting Rational and Float. 	  [ruby-core:48045] [Bug #7176]</p>

<p>Thu Nov  1 21:42:20 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* test/ruby/test_process.rb: Revert r37404.  My ubuntu box has 	  actually
the directory named “/nonexistent”…  Sorry.</p>

<p>Thu Nov  1 21:28:28 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* test/ruby/test_process.rb: Process.exec raised EACCES on Linux 	 
3.5.0-17-generic.  This is a temporal fix to rescue that exception. 	 
Needs kosaki&#39;s review.</p>

<p>Thu Nov  1 21:19:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (set_relation): parent_iseq need to be set regardless iseq 	 
type.  fix r37397.</p>

<p>Thu Nov  1 19:47:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (RUBY_STACK_MIN): may not a compile time constant. 	 
fix r37079.  [ruby-dev:46322] [Bug #7247]</p>

<p>Thu Nov  1 16:44:36 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* NEWS: add note for Module#refine, Module#refinements, 	  Module#using,
and Kernel#using.</p>

<p>Thu Nov  1 14:41:47 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_using_module): using should be used indirectly. 	 
[ruby-dev:46326] [Feature #7251]</p>

<p>Wed Oct 31 18:17:38 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (gc_profile_record): don&#39;t define unused variables when 	 
GC_PROFILE_MORE_DETAIL is 0.</p>

<p>Wed Oct 31 18:10:53 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (gc_prof_mark_timer_stop): count is not initialized.</p>

<p>Wed Oct 31 09:28:24 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* thread.c (rb_thread_call_without_gvl2):  Note that ubf() may or may 	 
not be called with the GVL.  Hinted that rb_thread_call_with_gvl() 	  can
be used to access ruby functionality.</p>

<p>Wed Oct 31 09:06:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* thread.c (rb_thread_call_without_gvl2):  Update documentation to 	 
natural English. 	* thread.c (rb_thread_call_with_gvl):  ditto.</p>

<p>Wed Oct 31 02:53:07 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/dl/lib/dl/struct.rb: fix strange require order. [ruby-dev:45702]</p>

<p>* ext/dl/lib/dl/value.rb: ditto</p>

<p>* test/dl/test_c_struct_entry.rb: remove strange require order from 	 
tests.</p>

<p>* test/dl/test_c_union_entity.rb: ditto</p>

<p>Tue Oct 30 23:59:32 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_refine): fix the error message when no block is 	  given.
[ruby-dev:46319] [Bug #7244]</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Tue Oct 30 19:27:48 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* process.c (redirect_dup2): set standard handles when new fd is stdio, 	 
because if there is no allocated console at the moment Windows does 	  not
automatically associate it for child process&#39;s standard handle. 	  this
is adhoc workaround. 	  reported by Martin Thiede at [ruby-core:48542] [Bug
#7239].</p>

<p>* io.c (rb_cloexec_dup2): ditto.</p>

<p>Tue Oct 30 03:08:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rbconfig/obsolete.rb (Config): re-introduce warnings for a 	 
lame-duck.  [ruby-core:46836] [Bug #6809]</p>

<p>Tue Oct 30 02:20:10 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* thread.c: added Thread#thread_variable_(get|set), 	 
Thread#thread_variable?, and Thread#thread_variables for operating 	  on
variables that are local to threads. [ruby-core:47790]</p>

<p>* vm.c: ditto</p>

<p>* test/ruby/test_thread.rb: tests for thread variables.</p>

<p>Mon Oct 29 18:22:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_close): close separately per each 	 
instances, as well as IO.</p>

<p>Mon Oct 29 10:22:00 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/handlers/recorder.rb: added a class for 	  recording
YAML parse and emit events.</p>

<p>* ext/psych/lib/psych/handler.rb: adding a list of events so that 	 
handler classes can more easily be meta-programmed.</p>

<p>* test/psych/handlers/test_recorder.rb: tests for the change.</p>

<p>Mon Oct 29 05:48:52 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/ostruct.rb: Add [] and []=, base on a patch by Thomas Sawyer. 	 
Also accept <code>Open</code>Struct as argument to new. 	  Add #eql?, #hash &amp;
#each_pair 	  Protect new_ostruct_member</p>

<p>Mon Oct 29 03:20:58 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix.rb: Fix determinant_e [ruby-dev:46305] [Bug #7228]</p>

<p>Sun Oct 28 23:52:25 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* test/rexml/test_document.rb: Add tests for parsing XML encoded 	  by
UTF-8 with BOM.</p>

<p>Sun Oct 28 23:47:09 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/source.rb: Move encoding detection code to base class. 	*
lib/rexml/encoding.rb: Remove needless encoding detection code.</p>

<p>Sun Oct 28 21:40:13 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/parsers/baseparser.rb: Fix a bug that UTF-8 is used 	  for
UTF-16XX encoded XML that doesn&#39;t have encoding=“UTF-16” in 	  XML
declaration. 	* test/rexml/test_document.rb: Add tests for the above
change.</p>

<p>Sun Oct 28 21:37:34 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* test/rexml/test_document.rb: Group tests that they parse 	  UTF-16XX
encoded XML that has encoding=“UTF-16” in XML declaration.</p>

<p>Sun Oct 28 21:25:11 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/source.rb (REXML::IOSource#initialize): Reduce 	  @line_break
initialize code. It should be done only in #encoding=. 	*
lib/rexml/parsers/baseparser.rb: Don&#39;t set UTF-16 encoding to 	  source
by encoding=“UTF-16” in XML declaration because UTF-16XX 	  source encoding
should be set in Source#initialize or 	  IOSource#initialize. They should
handle BOM. Parser should not 	  consider about it.</p>

<p>Sun Oct 28 21:18:37 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* test/rexml/test_document.rb: Add tests for parsing XML encoded 	  by
UTF-16 with BOM.</p>

<p>Sun Oct 28 19:12:11 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c (iso8601_<code>ext,bas</code>_time): should not match 	 
empty string.</p>

<p>Sun Oct 28 18:51:33 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c (date__parse): revised the tight parser.</p>

<p>Sun Oct 28 15:41:50 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document#write): Add :encoding option 	 
to support custom XML encoding. 	  [Feature #4872] (work in progress) 	*
test/rexml/test_document.rb: Add tests for the above change.</p>

<p>Sun Oct 28 15:00:19 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document#write): Remove needless 	  indent
in document.</p>

<p>Sun Oct 28 14:59:14 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document#write): Accept options 	  Hash as
argument. 	* test/rexml/test_document.rb: Add tests for the above change.</p>

<p>Sun Oct 28 14:09:44 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document#write): Fix wrong usage 	  in
document.</p>

<p>Sun Oct 28 14:03:48 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/document.rb (REXML::Document#write): Fix wrong method 	  names
in document.</p>

<p>Sun Oct 28 10:12:15 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: `tree` should return the 	 
same thing on every call.</p>

<p>* test/psych/visitors/test_yaml_tree.rb: related test.</p>

<p>Sun Oct 28 10:05:03 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: YAML Tree object should 	  be
able to take an emitter object as it&#39;s output.</p>

<p>* test/psych/visitors/test_yaml_tree.rb: related test.</p>

<p>Sun Oct 28 08:23:16 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* bignum.c (bignew_1): Bignum instances are frozen. 	  Feature #3222</p>

<p>* include/ruby/ruby.h: Fixnum instances are also frozen.</p>

<p>* class.c (singleton_class_of): check Bignum before 	  singleton checking.</p>

<p>* test/ruby/test_bignum.rb: add a test.</p>

<p>* test/ruby/test_fixnum.rb: ditto.</p>

<p>* test/ruby/marshaltestlib.rb, test/ruby/test_eval.rb, 	 
test/ruby/test_object.rb: catch up above changes.</p>

<p>Sun Oct 28 04:38:06 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (vm_define_method): remove type and frozen checking. 	  Checking is
done in `rb_singleton_class()&#39;.</p>

<p>Sun Oct 28 00:49:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (assign_in_cond): warn for static content object assignments 	 
in conditional statements.  [ruby-dev:43083] [Feature #4299]</p>

<p>Sat Oct 27 23:33:41 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* gc.c (gc_profile_result, gc_profile_report): use internal structures 	 
to avoid allocations and progressively print the output for #report. 	 
[ruby-core:47163] [Bug #6865]</p>

<p>Sat Oct 27 11:01:10 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* numeric.c (rb_float_new_in_heap), include/ruby/ruby.h: 	  make all Float
objects frozen. 	  [ruby-dev:46081] [ruby-trunk - Feature #6936] 	  Most
part of patch by NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;.</p>

<p>* class.c (singleton_class_of): raise TypeError when 	  trying to define a
singleton method on Float objects.</p>

<p>* vm.c (vm_define_method): ditto.</p>

<p>* test/ruby/marshaltestlib.rb: catch up above changes.</p>

<p>* test/ruby/test_class.rb: ditto.</p>

<p>* test/test_pp.rb: ditto.</p>

<p>Sat Oct 27 10:50:53 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* object.c (rb_mod_const_get): make sure the constant name is 	  converted
to a string before searching. [ruby-core:48405]</p>

<p>Sat Oct 27 10:12:13 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* iseq.c (rb_iseq_compile_with_option): Instead of testing 	  respond_to,
just check if the argument is actually a file, 	  because by calling
user-defined gets something weired can 	  happen.  Patch by Glass_saga.
[ruby-dev:40202] [Bug #2861]</p>

<p>* parse.y (ripper_initialize): ditto.</p>

<p>Sat Oct 27 10:07:57 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (enum lex_state_e): [EXPERIMENTAL] lex_state as bit field / 	 
IS_lex_state() macro.  based on the patch by Dave B in 	 
[ruby-core:23503].  [Feature #1493]</p>

<p>Sat Oct 27 10:05:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/win32.h (fstat): use _fstati64() instead of fstati64() 	 
on mingw32.</p>

<p>Sat Oct 27 06:28:33 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* object.c (rb_mod_const_get): const_get accepts qualified constant 	 
strings.  e.g. Object.const_get(“Foo::Bar::Baz”) [ruby-core:41404]</p>

<p>* test/ruby/test_module.rb: tests for new behavior</p>

<p>Fri Oct 26 13:24:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (literal_concat_gen): merge fixed strings across 	  concatenated
literals, after an interpolation.</p>

<p>Thu Oct 25 17:48:54 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (has_redirection): should use shell (cmd.exe) when 	  the
commandline contains &#39;&amp;&#39;. 	  reported by Roger Pack at
[ruby-core:47912] [Bug #7143], and 	  patched by Heesob Park at
[ruby-core:47931].</p>

<p>Thu Oct 25 15:00:08 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/ruby.h, class.c: remove (revert) 	 
`rb_add_method_cfunc_frameless()&#39; API. 	  This API is not mature to
become an official API. 	  For example, we can not use this API with 	 
`rb_define_private_method()&#39;.</p>

<p>* method.h, vm_method.c (rb_add_method_cfunc_frameless): removed.</p>

<p>Thu Oct 25 13:35:07 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb: remove string literal concatenation.</p>

<p>Wed Oct 24 18:49:16 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/objspace/objspace.c (type2sym, count_objects_size): use enum 	 
instead of size_t which may be larger than actual values.</p>

<p>Wed Oct 24 17:41:24 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: add `-x&#39; or `–exclude&#39; option 	  to specify
exclude benchmark name pattern. 	  You can specify “-x foo” if you want to
exclude the benchmarks 	  if the name of benchmark contains `foo&#39;.</p>

<p>Wed Oct 24 11:57:24 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (gc_prepare_free_objects): rename to match the behavior of 	  this
function.</p>

<p>Wed Oct 24 11:55:19 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ext/objspace/objspace.c (reachable_object_from_i): change data 	 
structure of the result of reachable objects. Keys of table 	  contains
object_id of each reachable objects. Value of table 	  is an object itself
or an instance of InternalObjectWrapper. 	  To avoid duplication, we use
st_table and object_id keys.</p>

<p>* ext/objspace/objspace.c (type2sym): bug fix. 	  Should use `i&#39;
instead of `type&#39;.</p>

<p>Wed Oct 24 10:33:09 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (garbage_collect, gc_marks): move the location of 	  clear and
restore rb_objspace_t::mark_func_data 	  from garbage_collect() to
gc_marks().</p>

<p>Wed Oct 24 10:17:45 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ext/objspace/objspace.c (Init_objspace): add a new method 	 
`ObjectSpace::InternalObjectWrapper#internal_object_id&#39; which returns 	
an object id of a wrapped internal object.</p>

<p>Wed Oct 24 08:55:04 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ext/objspace/objspace.c (ObjectSpace.reachable_objects_from): 	 
internal object support. 	  If given object `obj&#39; has references to
internal objects 	  (such as T_NODE objects), then this method returns
instances of 	  `ObjectSpace::InternalObjectWrapper&#39; instead of that
internal objects. 	  This instance contains a reference to an internal
object and you can 	  check the type of internal object using 	 
`ObjectSpace::InternalObjectWrapper#type&#39; method. 	  Rdoc of
`InternalObjectWrapper&#39; is not prepared yet.</p>

<p>* gc.c (rb_objspace_reachable_objects_from), gc.h: change 	  an interface
of &#39;rb_objspace_reachable_objects_from()&#39;</p>

<p>* gc.c, gc.h: add two APIs 	  - rb_objspace_markable_object_p(obj): check
markable or not. 	  - rb_objspace_internal_object_p(obj): check internal or
not.</p>

<p>Wed Oct 24 05:52:36 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): remove `default&#39; and 	  add a case
for `VM_METHOD_TYPE_UNDEF&#39;.</p>

<p>Wed Oct 24 05:41:18 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* eval_error.c (error_print), vm_eval.c (eval_string_with_cref), 	 
vm_trace.c (rb_suppress_tracing): use TH_PUSH_TAG() instead of 	 
PUSH_TAG().</p>

<p>Wed Oct 24 05:17:52 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_eval.c (vm_call0_body): remove RUBY_VM_CHECK_INTS() 	  after method
invocation using rb_call0().</p>

<p>* vm_eval.c (vm_call0_body): remove default section on top of 	  switch
statement and add cases for `VM_METHOD_TYPE_CFUNC_FRAMELESS&#39; 	  and
`VM_METHOD_TYPE_UNDEF&#39;.</p>

<p>* vm_eval.c (vm_call0_body): remove useless brackets.</p>

<p>Tue Oct 23 22:34:49 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (thread_raise_m):  check interrupts after Thread#raise 	  if a
target thread is the current thread because the behavior 	  of
Thread.current.raise is expected to perform same as 	  Kernel.raise (by
rubyspec).</p>

<p>Tue Oct 23 17:08:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (usage, process_options): show more info in –help. 	 
[EXPERIMENTAL] [ruby-core:48072] [Bug #7184]</p>

<p>Tue Oct 23 14:20:43 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* misc/ruby-electric.el using variable `last-command-event&#39; instead of
	  obsolete `last-command-char&#39;, so that work with Emacs trunk. 	  a
patch by Victor Deryagin &lt;vderyagin AT gmail.com&gt;.</p>

<p>Tue Oct 23 14:06:47 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (visibility_option): visibility attribute is not 	 
available before GCC 4, so do not use -fvisibility option in that 	  case. 
[ruby-core:48147] [Bug #7205]</p>

<p>Tue Oct 23 12:57:29 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h, vm_insnhelper.c, vm_eval.c (OPT_CALL_CFUNC_WITHOUT_FRAME): 	 
add a new optimization and its macro `OPT_CALL_CFUNC_WITHOUT_FRAME&#39;. 	 
This optimization makes all cfunc method calls `frameless&#39;, which 	  is
faster than ordinal cfunc method call. 	  If `frame&#39; is needed (for
example, it calls another method with 	  `rb_funcall()&#39;), then build a
frame. In other words, this 	  optimization delays frame building. 	 
However, to delay the frame building, we need additional overheads: 	   
(1) Store the last call information. 	    (2) Check the delayed frame
building before the frame is needed. 	    (3) Overhead to build a delayed
frame. 	  rb_thread_t::passed_ci is storage of delayed cfunc call
information. 	  (1) is lightweight because it is only 1 assignment to
`passed_ci&#39;. 	  To achieve (2), we modify GET_THREAD() to check
`passed_ci&#39; every 	  time. It causes 10% overhead on my environment. 	 
This optimization only works for cfunc methods which do not need 	  their
`frame&#39;. 	  After evaluation on my environment, this optimization does
not 	  effective every time. Because of this evaluation results, this 	 
optimization is disabled at default.</p>

<p>* vm_insnhelper.c, vm.c: add VM_PROFILE* macros to measure behaviour 	  of
VM internals. I will extend this feature.</p>

<p>* vm_method.c, method.h: change parameters of the `invoker&#39; function.
	  Receive `func&#39; pointer as the first parameter.</p>

<p>Tue Oct 23 06:21:05 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c: just get the constant defined in Ruby.</p>

<p>* ext/psych/lib/psych/syntax_error.rb: Psych::SyntaxError now inherits 	 
from StandardError rather than SyntaxError.  Thanks Eric Hodel!</p>

<p>* test/psych/test_exception.rb: tests for change.</p>

<p>Tue Oct 23 06:17:36 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: Cache symbols while 	 
tokenizing.  Thanks Kevin Menard!</p>

<p>Tue Oct 23 06:15:40 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: Updated the RegExp to catch 	 
Strings earlier in the tokenization process.  Thanks Kevin Menard!</p>

<p>Tue Oct 23 06:12:39 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: Handle nil tags specially 	  to
avoid slow method_missing calls.  Thanks Kevin Menard!</p>

<p>Tue Oct 23 06:07:57 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: Ignore bad timestamps.  If 	 
something looks like a timestamp but has an invalid component, treat 	  it
as a string instead of throwing an ArgumentError. 	  Thanks Rhett Sutphin!</p>

<p>* test/psych/test_scalar_scanner.rb: appropriate tests.</p>

<p>Tue Oct 23 06:04:07 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: Fix scalar_scanner to 	 
understand strings starting with an underscore and containing only 	 
digits.  Thanks Kelley Reynolds.</p>

<p>* test/psych/test_scalar_scanner.rb: test for fix</p>

<p>Tue Oct 23 06:00:41 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: Changed comment in psych.rb to update new 	 
home page for libyaml.  Thanks to Carolyn Ann.</p>

<p>Sun Oct 21 19:12:59 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm_core.h (rb_vm_t::trace_running): add a new field 	 
`trace_running&#39; to store vm global tracing status.</p>

<p>* vm_trace.c: fix SEGV bug. event_hook was free&#39;d 	  even when the
hook is still used in another thread. 	  [ruby-dev:46141] [Bug #7032]</p>

<p>Sun Oct 21 19:12:42 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm_core.h (rb_vm_t::trace_flag): remove `trace_flag&#39; 	  which is no
longer used.</p>

<p>Sun Oct 21 18:34:27 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c (date__parse): uses more tight parser if 	 
defined TIGHT_PARSER.  now inactivated; because it introduces 	 
incompatibilities and it is a bit slow.</p>

<p>Sat Oct 20 15:35:06 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* include/ruby/ruby.h: add C APIs. 	  VALUE rb_newobj_of(VALUE klass,
VALUE flags) 	  #define NEWOBJ_OF(obj,type,klass,flags) 	  These allow to
change a allocation strategy depending on klass 	  or flags.</p>

<p>* gc.c: ditto</p>

<p>* array.c: use new C API. 	* bignum.c: ditto 	* class.c: ditto 	*
complex.c: ditto 	* ext/socket/ancdata.c: ditto 	* ext/socket/option.c:
ditto 	* hash.c: ditto 	* io.c: ditto 	* marshal.c: ditto 	* numeric.c:
ditto 	* object.c: ditto 	* random.c: ditto 	* range.c: ditto 	*
rational.c: ditto 	* re.c: ditto 	* string.c: ditto 	* struct.c: ditto 	 
[Feature #7177][Feature #7047]</p>

<p>Sat Oct 20 12:50:00 2012  Zachary Scott	&lt;zachary@zacharyscott.net&gt;</p>

<p>* ext/socket/socket.c: Documentation for Socket 	  Based on a patch by
David Albert 	  [Bug #7105] [ruby-core:47828]</p>

<p>Sat Oct 20 11:00:00 2012  Zachary Scott	&lt;zachary@zacharyscott.net&gt;</p>

<p>* lib/open-uri.rb: Documentation for OpenURI</p>

<p>Sat Oct 20 06:18:34 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* hash.c (initialize_copy): unset the default proc if there isn&#39;t one
	  for the target hash, call to_hash, check frozen status.</p>

<p>Fri Oct 19 22:22:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (rb_vm_jump_tag_but_local_jump): pass through thrown objects. 	 
[ruby-dev:46234] [Bug #7185]</p>

<p>* vm_eval.c (rb_eval_cmd): if state is non-zero, val should be nil and 	 
rb_vm_jump_tag_but_local_jump() just jump tag.</p>

<p>Fri Oct 19 22:11:55 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* pack.c (pack_unpack): set encoding of the 	 
&#39;H&#39;,&#39;h&#39;,&#39;B&#39; and &#39;B&#39; modifiers to US-ASCII.</p>

<p>* test/ruby/test_pack.rb: tests for the above. 	  [ruby-core:47653][Bug
#7050]</p>

<p>* test/test_securerandom.rb: tests for SecureRandom.hex 	  from
tenderlove. [ruby-core:46792][Bug #6799]</p>

<p>Fri Oct 19 19:29:11 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* method.h (rb_method_cfunc_t::invoker): add new field (func ptr) 	 
`invoker&#39;. `invoker&#39; function invoke cfunc body 	 
(rb_method_cfunc_t::func). 	  `invoker&#39; is set at method definition
timing. 	  With this change, the big `switch&#39; (branch) in
`call_cfunc()&#39; 	  is no longer needed. 	  However, the performance
benefit is only a bit.</p>

<p>* vm_core.h (rb_call_info_t::aux::func): add a new field to store 	  cfunc
body function pointer.</p>

<p>* vm_method.c (call_cfunc_invoker_func): add a new function which 	 
returns a suitable invoke function.</p>

<p>* vm_method.c (setup_method_cfunc_struct): added.</p>

<p>* vm_method.c (rb_add_method): fix to set `invoker&#39;.</p>

<p>* vm_eval.c (vm_call0_body): catch up above changes.</p>

<p>* vm_insnhelper.c (call_cfunc): removed.</p>

<p>* vm_insnhelper.c (vm_call_cfunc): fix to call cfunc body 	  with
`invoker&#39; function.</p>

<p>Fri Oct 19 16:55:58 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* eval.c, vm_eval.c: use TH_PUSH_TAG() instead of PUSH_TAG().</p>

<p>Fri Oct 19 11:13:55 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: remove unexpected `output&#39;. 	  (commit miss)</p>

<p>Fri Oct 19 10:24:03 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_search_method): remove needless local variable.</p>

<p>Fri Oct 19 10:22:26 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bmx_temp.rb: removed. 	  This file should not be in
repository.</p>

<p>Fri Oct 19 10:20:10 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: add new option `–ruby-arg [ARG]&#39; 	  which is
passed as a launch parameter for each ruby&#39;s execution. 	  ($ ruby
[ARG] [File])</p>

<p>Thu Oct 18 18:42:35 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def (opt_send_simple): move the location of 	 
`opt_send_simple&#39; to the place near `send&#39; definition. 	  (to take
care about icache locality).</p>

<p>Thu Oct 18 18:29:25 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def (send): remove unused condition. 	  This condition will be
true after r37258.</p>

<p>* vm_insnhelper.c (vm_caller_setup_args): remove `UNLIKELY&#39; on 	 
checking blockiseq (it seems `LIKELY&#39;).</p>

<p>Thu Oct 18 17:31:58 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def (opt_send_simple): introduce new instruction used 	  when no
need to care about block and splat.</p>

<p>* compile.c: use the `opt_send_simple&#39; instruction.</p>

<p>Thu Oct 18 16:44:07 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_add_method_cfunc, rb_add_method_cfunc_frameless): 	 
check arity earlier at definition time.</p>

<p>Thu Oct 18 15:11:31 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c: add `inline&#39; keyword to several functions. 	 
Compilers (gcc) are conservative than I expected.</p>

<p>Thu Oct 18 15:01:15 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/ruby.h: add a decl. of 	 
`rb_define_frameless_method()&#39;.</p>

<p>Thu Oct 18 14:31:17 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (new_callinfo): set a temporary index of callinfo 	  (used in
`iseq_set_sequence()&#39;) to rb_call_info_t::aux::index. 	 
rb_call_info_t::argc is initialized by same value of 	 
rb_call_info_t::orig_argc.</p>

<p>Thu Oct 18 14:11:08 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* class.c (rb_define_frameless_method): rename from 	 
rb_define_method_fast(). Defined method with this C API 	  does not make a
method frame. It is bit lightweight than 	  ordinal C functions. Now only 0
or 1 argc are permitted.</p>

<p>* method.h (VM_METHOD_TYPE_CFUNC_FRAMELESS): rename macro name 	  from
VM_METHOD_TYPE_CFUNC_FAST.</p>

<p>* vm_insnhelper.c, vm_method.c: rename related functions.</p>

<p>* proc.c (rb_method_entry_arity): catch up above changes.</p>

<p>Thu Oct 18 10:30:34 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (assignable_gen): fail if yyerror occurred.  fix a bug in 	 
r36973.</p>

<p>Thu Oct 18 09:23:03 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* hash.c (initialize_copy): duping should rehash the hash.</p>

<p>* test/ruby/test_hash.rb: added a test to ensure rehash.</p>

<p>Wed Oct 17 21:16:47 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* common.mk (WPROGRAM): need same dependencies as PROGRAM.</p>

<p>* cygwin/GNUmakefile.in (uncommon.mk): move include position 	  below
WPROGRAM definition to be defined in uncommon.mk.</p>

<p>* ext/extmk.rb (all, static): fix make rubyw.exe failure with make -jN. 	 
If make of ruby.exe and rubyw.exe run in parallel, link dll and link 	  exe
run in parallel, which causes link failure on mingw. To fix this, 	  we
make ruby.exe and rubyw.exe in one make process. 	  [ruby-core:48007] [Bug
#7165]</p>

<p>Wed Oct 17 16:25:34 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bm_vm2_method_missing.rb: add a benchmark to measure 	 
performance of invoking `method_missing&#39;.</p>

<p>Wed Oct 17 16:23:17 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_getivar): fix to use `aux.index&#39; instead of 	 
`aux.opt_pc&#39;.</p>

<p>Wed Oct 17 16:03:54 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_call_method_missing): make a refactoring 	  about
method_missing process. Use `vm_call_method()&#39; to invoke 	 
`method_missing&#39; method instead of `rb_funcall2()&#39;. 	  In
`vm_call_method()&#39;, set fastpath to `vm_call_method_missing()&#39; 	 
if it can be cached.</p>

<p>* vm_core.h (rb_call_info_t): add new field 	 
`rb_call_info_t::aux::missing_reason&#39; to pass the reason to 	 
`vm_call_method_missing()&#39;.</p>

<p>Wed Oct 17 15:33:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (opt-dir): allow multiple directories separated by 	 
$PATH_SEPARATOR as well as dir_config in mkmf.rb. [ruby-core:47868] 	  [Bug
#7120]</p>

<p>Wed Oct 17 15:08:13 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb: fix Net::IMAP::ResponseParser to accept 	 
message/delivery-status ([ruby-core:47920] [Bug #7146]), 	  message/rfc822
attachments ([ruby-core:47921] [Bug #7147]), and 	  (BODY (“MIXED”))
([ruby-core:47951] [Bug #7153]). 	  patched by Tony Arkles.</p>

<p>* test/net/imap/test_imap_response_parser.rb: related test.</p>

<p>Wed Oct 17 11:04:48 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_hash.rb (TestHash#test_dup_equality): added a new test 	 
to show the problem of r37232.</p>

<p>Wed Oct 17 10:48:40 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_search_method): fix a build error that occurs 	 
when OPT_INLINE_METHOD_CACHE is 0.</p>

<p>Wed Oct 17 08:46:47 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bm_vm2_dstr.rb: add a benchmark to measure 	  performance of
dynamic generated string (“foo#<code>bar</code>baz”).</p>

<p>Wed Oct 17 08:32:46 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (compile_dstr_fragments): use `putobject&#39; instead of 	 
`putstring&#39; for all of strings used by NODE_DSTR because 	  ruby users
can not grab this string. 	  For example, the string object of “baz” in
“foo#<code>bar</code>baz” 	  is located by `putobject&#39; (users can not touch “baz”
object 	  directly). This change reduces GC pressure. 	  This improvement
is suggested by Aaron Patterson.</p>

<p>Wed Oct 17 08:02:57 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_threadptr_interrupt_mask): fix to check interrupt 	  after
interrupt_mask changed.</p>

<p>Wed Oct 17 06:42:47 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): fix to return value immediately. 	 
Remove CHECK_INTS() after that method dispatch.</p>

<p>Wed Oct 17 06:25:56 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* hash.c (initialize_copy): copy the underlying st_table on dup, 	  rather
than copying the hash key by key. [ruby-core:48009]</p>

<p>* test/ruby/test_hash.rb: relevant tests for initialize_copy</p>

<p>Wed Oct 17 06:17:44 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_call_iseq_setup_2): separate tailcall and normal 	 
method frame setup functions. 	  Add checking interrupts at the tailcall
setup function.</p>

<p>Wed Oct 17 05:35:37 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bm_vm1_yield.rb: add a benchmark to measure `yield&#39; 	 
(invoke empty block) performance.</p>

<p>* benchmark/bm_vm2_method_with_block.rb: add a benchmark to measure 	 
method invocation with empty block.</p>

<p>Wed Oct 17 05:05:07 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_invoke_block): vm_caller_setup_args() can skip 	 
when splat flag is not set.</p>

<p>Wed Oct 17 01:53:47 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_getivar, vm_setivar): support index inline cache 	 
with rb_call_info_t to speedup `attr&#39; getter and setter. 	  Cached
index is stored in rb_call_info_t::aux::index. 	  `index&#39; == 0 means
not cached. `index&#39; &gt; 0 means cached and cached 	  index is `index -
1&#39;.</p>

<p>* insns.def ((get|set)instancevariable): use new wrapper functions 	 
vm_(get|set)instancevariable() defined in vm_insnhelper.c.</p>

<p>* vm_core.h (rb_call_info_t::aux): introduce new union data because 	 
opt_pc can share with index.</p>

<p>Tue Oct 16 22:24:44 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb (show_results): Show speedup ratio 	  with first
executables score at last of results 	  if two or more executables are
given.</p>

<p>Tue Oct 16 21:59:01 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: some refactoring. 	  (1) Remove `average
differential&#39;. 	      In this benchmark driver, We should not care
about `average&#39;. 	      We use fastest score because this score should
not include 	      any disturbances (affections of background process,
etc). 	      If you care about timing affect, I recommend `median&#39; 	   
score with more than 5 examinations rather than simple 	      `average&#39;
score (`average&#39; score was affected by error scores). 	  (2) Show log
file name. 	  (3) Change default directory from &#39;./&#39; to
driver&#39;s directory.</p>

<p>Tue Oct 16 14:56:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_file_join): need to check again after any conversion run. 	 
[ruby-core:48012] [Bug #7168]</p>

<p>Tue Oct 16 12:52:14 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#assert_file): 	  rename
from file_assertion.</p>

<p>Tue Oct 16 11:30:18 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_file_join): hide the result under construction until 	 
return.</p>

<p>* file.c (rb_file_join): check nul-byte only for strings, since 	 
FilePathStringValue() does it.  [ruby-core:48012] [Bug #7168]</p>

<p>* file.c (rb_file_join): path names must be ASCII-compatible. 	 
[ruby-core:48012] [Bug #7168]</p>

<p>* file.c (check_path_encoding): new function to ensure path name 	 
encoding to be ASCII-compatible.</p>

<p>Tue Oct 16 09:40:04 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_regexp.rb 	 
(TextRegexp#test_raw_hyphen_and_tk_char_type_after_range): use 	 
Regexp.new instead of literal to ignore a parser warning.</p>

<p>Tue Oct 16 09:30:30 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_regexp.rb 	 
(TextRegexp#test_raw_hyphen_and_tk_char_type_after_range): ignoring 	 
warnings are already set in setup method.</p>

<p>Tue Oct 16 06:44:06 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (VM_CALLEE_SETUP_ARG): fix wrong condition.</p>

<p>Tue Oct 16 06:29:18 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): disable CI_SET_FASTPATH() if 	  this
method call needs splat argument because cached functions 	 
(vm_call_attrset, vm_call_ivar, vm_call_cfunc_fast_(unary|binary)) 	  do
not check an arity.</p>

<p>* bootstraptest/test_method.rb: add a test to check an above issue.</p>

<p>Tue Oct 16 06:15:44 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* method.h: introduce new method type VM_METHOD_TYPE_CFUNC_FAST. 	  This
method is similar to VM_METHOD_TYPE_CFUNC methods, but 	  called cfunc
without building new frame (does not push new control 	  frame). If error
is occurred in cfunc, the backtrace only shows 	  caller frame and upper. 	
This kind of methods can be added by rb_define_method_fast(). 	  This
feature is similar to specialized instructions (opt_plus, etc), 	  but more
flexible (but a bit slower).</p>

<p>* class.c (rb_define_method_fast): added. 	  Maybe it will be renamed
soon.</p>

<p>* vm_insnhelper.c (vm_call_method): support method type 	 
VM_METHOD_TYPE_CFUNC_FAST.</p>

<p>* proc.c (rb_method_entry_arity): catch up new method type.</p>

<p>* vm_method.c (rb_add_method_cfunc_fast): added.</p>

<p>Tue Oct 16 02:32:29 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.h (CI_SET_FASTPATH): add new parameter `enabled&#39;. 	 
If `enable&#39; is 0 then CI_SET_FASTPATH() doesn&#39;t work. 	  And add
new configuration option OPT_CALL_FASTPATH. If this macro 	  was defined by
0, then CI_SET_FASTPATH() doesn&#39;t work any more.</p>

<p>* vm_insnhelper.c (vm_call_method): Pass `0&#39; for `enabled&#39;
parameter 	  of CI_SET_FASTPATH if this method is protected.</p>

<p>Tue Oct 16 02:17:35 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h (VM_CALL_*): rename VM_CALL_*_BIT 	  to VM_CALL_* (remove
`_BIT&#39; suffix). 	  Add comments on each macros. 	  Remove unused macro
VM_CALL_TAILRECURSION_BIT.</p>

<p>* compile.c, iseq.c, insns.def, vm_insnhelper.c: ditto.</p>

<p>Mon Oct 15 22:14:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (Test::Unit::Assertions#file_assertion): 	  rewrite
file assertions.</p>

<p>Mon Oct 15 09:41:17 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (VM_CALLEE_SETUP_ARG): skip CI_SET_FASTPATH() if 	  it
was called from vm_yield_setup_args().</p>

<p>Mon Oct 15 05:20:13 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.h CI_SET_FASTPATH: introduce new macro 	 
`CI_SET_FASTPATH(ci, func)&#39;. This macro set `ci-&gt;call&#39; as
`func&#39;. 	  `func&#39; (ci-&gt;call) is called at the last of `send&#39;
	  (and `invokesuper&#39;) instruction. 	  `CI_SET_FASTPATH&#39; does not
set `ci-&gt;call&#39; when the method 	  (stored in `ci-&gt;me&#39;) is
`protected&#39;.</p>

<p>* vm_insnhelper.c (vm_call_method): use `CI_SET_FASTPATH&#39;. 	  After
several checking (visibility, argc checking), the result of 	  checking can
be reused until re-definition of this method 	  with inline method cache.</p>

<p>Note that this optimization is now experimental. 	  If you find any
problem about it, please tell us.</p>

<p>Mon Oct 15 04:51:55 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c: refactoring. 	  - move all `call&#39; related functions
to the last of file. 	  - make functions for respective method types in
vm_call_method(). 	    (all functions have same function parameters)</p>

<p>* vm_core.h: add `opt_pc&#39; field in `rb_call_info_t&#39; 	  as temporal
variable.</p>

<p>* vm_eval.c (vm_call0_body): catch up above changes.</p>

<p>Mon Oct 15 03:51:46 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bm_vm1_attr_ivar(_set).rb: added (for method dispatch speed).</p>

<p>* benchmark/bm_vm1_float_simple.rb: added (for flonum/float).</p>

<p>Mon Oct 15 02:51:16 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_eval.c (vm_call0_body): add new function. 	  `vm_call0()&#39; makes
call_info struct and calls `vm_call0_body()&#39; 	  with this struct. In
near future, `vm_call0()&#39; will be removed 	  because all of
`vm_call0()&#39; users setup call_info struct by itself.</p>

<p>Mon Oct 15 01:38:06 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def (send, invokesuper, invokeblock, opt_*), vm_core.h: 	  use
only a `ci&#39; (rb_call_info_t) parameter instead of using 	  parameters
such as `op_id&#39;, &#39;op_argc&#39;, `blockiseq&#39; and flag. 	  These
information are stored in rb_call_info_t at the compile 	  time. 	  This
technique simplifies parameter passing at related 	  function calls (~10%
speedups for simple method invocation at 	  my machine). 	 
`rb_call_info_t&#39; also has new function pointer variable `call&#39;. 	 
This `call&#39; variable enables to customize method (block) 	  invocation
process for each place. However, it always call 	  `vm_call_general()&#39;
at this changes. 	  `rb_call_info_t&#39; also has temporary variables for
method 	  (block) invocation.</p>

<p>* vm_core.h, compile.c, insns.def: introduce VM_CALL_ARGS_SKIP_SETUP 	 
VM_CALL macro.  This flag indicates that this call can skip 	  caller_setup
(block arg and splat arg).</p>

<p>* compile.c: catch up above changes.</p>

<p>* iseq.c: catch up above changes (especially for TS_CALLINFO).</p>

<p>* tool/instruction.rb: catch up above changes.</p>

<p>* vm_insnhelper.c, vm_insnhelper.h: ditto. Macros and functions 	 
parameters are changed.</p>

<p>* vm_eval.c (vm_call0): ditto (it will be rewritten soon).</p>

<p>Sun Oct 14 12:30:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (rb_f_sub, rb_f_gsub): pass the given block. 	  [ruby-core:47967]
[Bug #7157]</p>

<p>Sat Oct 13 23:15:39 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* regparse.c (parse_char_class): should match with a hyphen after a 	 
range in a character class.</p>

<p>* test/ruby/test_regexp.rb (TestRegexp#test_char_class): fixed wrong 	 
test.</p>

<p>* test/ruby/test_regexp.rb (TestRegexp#check): now can accept the 	  error
message.</p>

<p>* test/ruby/test_regexp.rb 	 
(TextRegexp#test_raw_hyphen_and_tk_char_type_after_range): renamed 	 
because the previous name was wrong.</p>

<p>* test/ruby/test_regexp.rb 	 
(TextRegexp#test_raw_hyphen_and_tk_char_type_after_range): added 	  more
test pattern.</p>

<p>Sat Oct 13 03:01:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (realpath_rec): prevent link from GC while link_names refers 	 
the content.</p>

<p>Sat Oct 13 01:37:48 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_regexp.rb 	 
(TestRegexp#test_raw_hyphen_and_type_char_after_range): added new 	  test.
ref [ruby-core:47115] [Backport #6853]</p>

<p>Fri Oct 12 21:55:08 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* include/ruby/win32.h (rb_w32_pow): set floating point precision 	  for
mingw-w64 x86 pow(). This improves the precision of pow() on 	  Windows XP
for TestFloat#test_round_with_precision failure. 	  [ruby-core:47911] [Bug
#7142]</p>

<p>Fri Oct 12 21:37:25 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/webrick/test_cgi.rb (TestWEBrickCGI#test_cgi): skip a test 	 
depending on locale on Windows. ENV[] doesn&#39;t work properly if 	 
console code page is not equal to file system encoding. 	 
[ruby-core:47910] [Bug #7140]</p>

<p>Fri Oct 12 20:40:29 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (posix_sh_cmds): the command name of colon is “:”.</p>

<p>Fri Oct 12 18:18:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_get_path_check): path name must not contain NUL bytes.</p>

<p>Fri Oct 12 16:06:20 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: now can merge revision(s) without –ticket again.</p>

<p>Fri Oct 12 14:10:41 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (dir_config, init_mkmf): use configured libdir value as 	 
default library path.  [ruby-core:43726] [Bug #6207]</p>

<p>Fri Oct 12 05:25:00 2012  Zachary Scott	&lt;zzak@ruby-lang.org&gt;</p>

<p>* lib/timeout.rb (timeout): 	  Remove paragraph on wrong implementation
detail. 	  [ruby-core:47739] [Bug #7088]</p>

<p>Thu Oct 11 23:09:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_sub<code>seq,pos,str</code>, rb_str_each_<code>line,codepoint</code>): 	 
prevent String copies from GC.  [ruby-core:47881] [Bug #7135]</p>

<p>Thu Oct 11 07:40:50 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* iseq.c (insn_operand_intern): cast op to rb_call_info_t* before 	 
compare with iseq-&gt;callinfo_entries whose type is rb_call_info_t*.</p>

<p>Thu Oct 11 03:37:08 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* bootstraptest/test_block.rb: add tests for block with super.</p>

<p>Thu Oct 11 02:54:07 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_dump.c: fix debug prints to catch up recent changes 	  such as VM
data structures.</p>

<p>Thu Oct 11 02:50:34 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (insn_operand_intern): add support disasm TS_CALLINFO 	 
operands.</p>

<p>Wed Oct 10 15:12:48 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_process.rb (TestProcess#test_execopts_gid): skip on 	 
windows because the platform does not have Process.group method. 	  patched
by Jon Forums in [ruby-core:47878] [Bug #7133].</p>

<p>Tue Oct  9 23:18:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_file, assert_file_not): more 	  descriptive
assertions for File predicates.</p>

<p>Tue Oct  9 18:01:37 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_sample): use rb_random_ulong_limited, since 	  precision
of long may be larger than double.</p>

<p>* random.c (rb_random_ulong_limited): new function to return a random 	 
value from 0 upto limit as unsigned long, similarly to 	 
rb_genrand_ulong_limited but with arbitrary RNG object.</p>

<p>Tue Oct  9 17:13:27 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_execarg_addopt, rb_execarg_run_options): add :uid and 	 
:gid options.  [ruby-core:47414] [Feature #6975]</p>

<p>Tue Oct  9 14:36:11 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (iseq_free): fix memory leak. 	  rb_iseq_t::callinfo_entries
should be freed.</p>

<p>Tue Oct  9 14:28:18 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h (rb_call_info_t): add new type `rb_call_info_t&#39;. 	  This
data structure contains information including inline method 	  cache. After
that, `struct iseq_inline_cache_entry&#39; does not 	  need to contain
inline cache for method invocation. 	  Other information will be added to
this data structure.</p>

<p>* vm_core.h (rb_iseq_t): add `callinfo_entries&#39; and
`callinfo_size&#39; 	  members to `rb_iseq_t&#39;.</p>

<p>* insns.def, compile.c: Use CALL_INFO instead of IC.</p>

<p>* tool/instruction.rb: support CALL_INFO as operand type.</p>

<p>* vm_insnhelper.c, vm_insnhelper.h: ditto.</p>

<p>Sun Oct  7 23:54:33 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/zlib/zlib.c (zstream_run_func): don&#39;t call inflate() when 	 
z-&gt;stream.avail_in == 0. it return Z_BUF_ERROR. 	  but deflate() could
be called with z-&gt;stream-&gt;avail_in == 0 because 	  it has hidden
buffer in z-&gt;stream-&gt;state (opaque structure). 	  fix for gem install
error. [ruby-dev:46149] [Bug #7040]</p>

<p>Mon Oct  8 23:55:41 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_refinements): new method Module#refinements.</p>

<p>* test/ruby/test_refinement.rb: add new tests for the above changes.</p>

<p>Mon Oct  8 23:02:19 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c, gc.c, iseq.c, node.h, vm_insnhelper.c, vm_insnhelper.h, 	 
vm_method.c: rename omod and overlaid modules to refinements.</p>

<p>* eval.c (hidden_identity_hash_new): renamed from identity_hash_new.</p>

<p>Sun Oct  7 04:50:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* lib/abbrev.rb: Documentation examples for Abbrev. 	  [ruby-core:47442]
[Bug #6985]</p>

<p>Sun Oct  7 04:50:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_aref): 	  Grammar in Thread documentation. 	  Patch
by Steve Klabnik [ruby-core:47799] [Bug #7099]</p>

<p>Sun Oct  7 04:37:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_match): 	  Clarify behavior for captured strings and
local variable assignment 	  Patch by Marcus Stollsteimer [ruby-core:47668]
[Bug #7062]</p>

<p>Sat Oct  6 18:31:36 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_opts.h (OPT_GLOBAL_METHOD_CACHE): new build option to 	 
enable/disable global method caching. [ruby-dev:46203] [Bug #7111]</p>

<p>* vm_method.c (rb_method_entry_get_with_omod): don&#39;t use global 	 
method cache if OPT_GLOBAL_METHOD_CACHE is 0.</p>

<p>Sat Oct  6 16:32:04 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (search_method): check omod only once for performance.</p>

<p>Sat Oct  6 09:42:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/encdb.c, enc/utf_16_32.h (ENC_DUMMY_UNICODE): endian-less wide 	 
UTF encodings are dummy but Unicode.</p>

<p>* encoding.c (rb_encdb_set_unicode): set Unicode flag.</p>

<p>* template/encdb.h.tmpl: allow ENC_DUMMY variants.</p>

<p>* encoding.c (rb_enc_unicode_p): oniguruma provides Unicode flag.</p>

<p>Fri Oct  5 17:18:42 JST 2012  TAKANO Mitsuhiro  &lt;tak@no32.tk&gt;</p>

<p>* template/Doxyfile.tmpl: remove SHOW_DIRECTORIES and 	 
HTML_ALIGN_MEMBERS lines. They have been obsolete in 	  Doxygen version
1.8.2.</p>

<p>Fri Oct  5 15:26:18 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ext/objspace/objspace.c: add ObjectSpace#reachable_objects_from. 	  This
method returns an array of objects referenced by given object. 	  If given
object is special objects such as true/false/nil/Fixnum etc 	  then it
returns nil. See rdoc for details. 	  [ruby-core:39772]</p>

<p>* test/objspace/test_objspace.rb: add a test for this method.</p>

<p>* gc.c: add rb_objspace_reachable_objects_from(). 	  To make this
function, add several member `mark_func_data&#39; 	  to rb_objspace_t.  If
mark_func_data is not null, then 	  gc_mark() calls
mark_func_data::mark_func.</p>

<p>* gc.h: export rb_objspace_reachable_objects_from().</p>

<p>Thu Oct  4 23:40:04 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (init_heap): call init_mark_stack before to allocate 	  altstack.
This change avoid the stack overflow at the signal 	  handler on 32bit, but
I don&#39;t understand reason… [Feature #7095]</p>

<p>Thu Oct  4 22:39:27 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def (getlocal, setlocal): remove old getlocal/setlocal 	 
instructions and rename getdaynmic/setdynamic instructions 	  to
getlocal/setlocal.</p>

<p>* compile.c: ditto.</p>

<p>* iseq.c: remove TS_DINDEX.</p>

<p>* vm_exec.h (dindex_t): remove type definition of `dindex_t&#39;.</p>

<p>* tool/instruction.rb: ditto.</p>

<p>Thu Oct  4 21:44:17 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (vm_analysis_insn|operand|register): use st_insert 	  instead of
using rb_hash_aset() because rb_hash_aset() 	  check $SAFE.</p>

<p>Thu Oct  4 21:15:26 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (VM_COLLECT_USAGE_DETAILS): make new VM usage analysis 	  hooks
(old macro name is COLLECT_USAGE_ANALYSIS). 	  This feature is only for VM
developers.  (I&#39;m not sure I can use 	  `VM developers&#39; (the plural
form) in this sentence). 	  If VM_COLLECT_USAGE_DETAILS is not 0, VM
enables the following 	  usage collection features: 	    (1) instruction:
collect instruction usages. 	    (2) operand: collect operand usages. 	   
(3) register: collect register usages. 	  The results are stored in 	   
RubyVM::USAGE_ANALYSIS_INSN for (1, 2), 	   
RubyVM::USAGE_ANALYSIS_INSN_BIGRAM for (1) and 	   
RubyVM::USAGE_ANALYSIS_REGS for (3). 	  You can stop collecting usages with
	    RubyVM::USAGE_ANALYSIS_INSN_STOP(), 	   
RubyVM::USAGE_ANALYSIS_OPERAND_STOP(), 	   
RubyVM::USAGE_ANALYSIS_REGISTER_STOP() 	  for (1), (2), (3) respectively. 	
You can also change the hook functions by setting 	  C level global
variables 	    `ruby_vm_collect_usage_func_(insn|operand|register)&#39; 	 
for (1), (2), (3) respectively. 	  See codes for more details.</p>

<p>* tool/instruction.rb: fix macro names.</p>

<p>* iseq.c (insn_operand_intern): make it export (used in vm.c). 	  fix to
skip several processes if not needed (pointer is 0).</p>

<p>* vm_dump.c: move codes for collection features to vm.c.</p>

<p>* vm_exec.h: rename macro and function names.</p>

<p>* vm_insnhelper.h: ditto.</p>

<p>Thu Oct  4 18:59:14 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_settracefunc.rb (test_tracepoint): 	  remove unused test
case. 	  (this test case is redefined by newer tests)</p>

<p>Thu Oct  4 17:24:51 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (rb_objspace_call_finalizer): call gc_mark_stacked_objects 	  at
suitable point.</p>

<p>Thu Oct  4 16:31:29 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (rb_objspace_call_finalizer): mark self-referencing finalizers 	 
before run finalizers, to fix SEGV from btest on 32bit.</p>

<p>* gc.c (gc_mark_stacked_objects): extract from gc_marks().</p>

<p>Thu Oct  4 11:43:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): round stack limit to page size 	 
boundary to calculate stack size more precisely.  [ruby-dev:46174] 	  [Bug
#7084]</p>

<p>Wed Oct  3 19:51:57 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: Use the non-recursive marking instead of recursion. The 	 
recursion marking of CRuby needs checking stack overflow and the 	 
fail-safe system, but these systems not good at partial points, 	  for
example, marking deep tree structures. [ruby-dev:46184] 	  [Feature #7095]</p>

<p>* configure.in (GC_MARK_STACKFRAME_WORD): removed. It&#39;s used by 	 
checking stack overflow of marking.</p>

<p>* win32/Makefile.sub (GC_MARK_STACKFRAME_WORD): ditto.</p>

<p>Wed Oct  3 15:33:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): use getrlimit() for the main 	 
thread on Mac OS X, since pthread_get_stack<code>addr,size</code>_np() 	  return the
default value always, but not the ulimit value. 	  [ruby-dev:46174] [Bug
#7084]</p>

<p>Wed Oct  3 11:43:15 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_reopen): improvement to accept optional arguments. 	  a
patch by Glass_saga (Masaki Matsushita) in [ruby-core:47806]. 	  [Feature
#7103]</p>

<p>Wed Oct  3 04:36:11 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl_x509store.c (ossl_x509store_add_file):  Added 	 
documentation 	* ext/openssl/ossl_x509store.c
(ossl_x509store_set_default_paths): 	  ditto 	*
ext/openssl/ossl_x509store.c (ossl_x509store_add_cert):  ditto</p>

<p>Wed Oct  3 02:23:37 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* error.c (exc_to_s, name_err_to_s, name_err_mesg_to_str): do not 	  taint
messages.</p>

<p>Tue Oct  2 16:47:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (identity_hash_new): hide internal hashes for refinements.</p>

<p>* eval.c (rb_mod_refine): no default value.</p>

<p>Mon Oct  1 22:54:02 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (identity_hash_new): new function to create a new identity 	 
hash.</p>

<p>* eval.c (rb_overlay_module, rb_mod_using, rb_mod_refine): use 	 
identity_hash_new().</p>

<p>Mon Oct  1 02:34:53 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* configure.in (–with-opt-dir): Make this also work on DLDFLAGS 	  so
LIBRUBY_SO links fine with libexecinfo installed in a 	  non-system
directory.</p>

<p>Sun Sep 30 23:32:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* vm_dump.c (rb_vm_bugreport): add /Library/Logs/DiagnosticReports 	  in
the list of locations of crash reports.</p>

<p>Sun Sep 30 21:18:03 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_concat): use memcpy to copy a string which contains 	 
NUL characters. [ruby-core:47751] [Bug #7090]</p>

<p>Sat Sep 29 19:41:53 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/envutil.rb (EnvUtil#invoke_ruby): kill child process 	  before
Timeout::Error is raised. rmdir of mktmpdir fails with 	  EACCES if child
process is alive on Windows.</p>

<p>* test/thread/test_queue.rb (TestQueue): increase timeout. 	  This test
takes long time on Windows XP.</p>

<p>Sat Sep 29 19:41:33 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/net/http/test_http.rb (TestNetHTTP#test_proxy_address): 	  clear
environment variables. If http_proxy environment variable was 	  set, the
test failed.</p>

<p>* test/net/http/test_http.rb (TestNetHTTP#test_proxy_port): ditto.</p>

<p>Sat Sep 29 19:41:11 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/drb/drbtest.rb (DRbCore#teardown): 	  Use Process.kill :KILL on
Windows because Process.kill :INT silently 	  fails on Windows 7 and raises
EINVAL on Windows XP for spawned 	  process with new_pgroup: false.</p>

<p>* test/drb/drbtest.rb (DRbAry#teardown): ditto.</p>

<p>Sat Sep 29 19:40:32 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_unicode_escape.rb (TestUnicodeEscape#test_basic): 	  set
script encoding to work with LANG=C. It would work on both 	  Windows and
Unix. Refix of r37051.</p>

<p>Sat Sep 29 11:21:06 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (rb_vm_using_modules): use using_modules before 	  klass
to fix method lookup order, and use klass even if klass is 	  not a module
to make refinements in class_eval invoked on classes 	  work.</p>

<p>* eval.c (rb_using_module): accept a class as the second argument.</p>

<p>* eval.c (rb_mod_using, f_using): raise a TypeError if the argument 	  is
not a module.</p>

<p>* test/ruby/test_refinement.rb: add new tests for the above changes.</p>

<p>Sat Sep 29 02:18:57 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_unicode_escape.rb (TestUnicodeEscape#test_basic): 	  Use
ruby only on Windows since the test fails on Unix with LANG=C. 	 
[ruby-core:47709] [Bug #7076]</p>

<p>Fri Sep 28 22:19:31 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_unicode_escape.rb (TestUnicodeEscape#test_basic): 	  echo
command doesn&#39;t work properly against non-ascii character on 	  Windows
with chcp 437. Instead we use ruby. 	  [ruby-core:47709] [Bug #7076]</p>

<p>Fri Sep 28 17:54:31 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_setup_method): refactoring. 	  Remove src_argc and
use iseq-&gt;arg_size directly.</p>

<p>Fri Sep 28 17:26:27 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rubygems/installer.rb (check_that_user_bin_dir_is_in_path): 	 
test_generate_bin_bindir_with_user_install_warning(TestGemInstaller) 	 
fails on Windows with msys bash. It makes comparing paths 	 
case-insensitive. 	  pick from upstream to fix a failure of test-all
[ruby-core:47711] 	 <a
href="https://github.com/rubygems/rubygems/commit/c474edb2f3704206f04da1c8c6cf9fb079d84abe">github.com/rubygems/rubygems/commit/c474edb2f3704206f04da1c8c6cf9fb079d84abe</a></p>

<p>Fri Sep 28 15:44:45 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (search_method): copy refinement iclasses to search 	 
superclasses correctly.</p>

<p>* test/ruby/test_refinement.rb: related test.</p>

<p>Fri Sep 28 15:15:41 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def (opt_checkenv): remove unused instruction `opt_checkenv&#39;.</p>

<p>* compile.c (iseq_compile_each): ditto.</p>

<p>* node.h: remove unused node `NODE_OPTBLOCK&#39;.</p>

<p>* ext/objspace/objspace.c, gc.c (gc_mark_children): ditto.</p>

<p>Fri Sep 28 13:14:34 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: now VM_DEBUG_BP_CHECK should be 1.</p>

<p>Fri Sep 28 12:51:54 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: remove rb_control_frame_t::bp (bp: base pointer). 	  `bp&#39;
can be calculate by `sp&#39; (stack pointer) of previous frame. 	  Now,
`bp_check&#39; field is remained for debug.  You can eliminate 	  this
field by setting  VM_DEBUG_BP_CHECK as 0.</p>

<p>* vm_insnhelper.c (vm_base_ptr): add `vm_base_ptr(cfp). 	  This function
calculates base pointer from cfp.</p>

<p>* vm_insnhelper.c (vm_setup_method): push `recv&#39; value on top of 	 
value stack (before method parameters). 	  This change is for keeping
consistency with normal method dispatch.</p>

<p>* insns.def: fix to use vm_base_ptr().</p>

<p>* vm.c (vm_exec): ditto.</p>

<p>* vm_dump.c: remove `bp&#39; related dumps.</p>

<p>* cont.c (fiber_init): fix to check VM_DEBUG_BP_CHECK.</p>

<p>Fri Sep 28 10:40:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_reopen): accept File::Constants as well as mode string. 	 
based on the patch by Glass_saga (Masaki Matsushita) in 	 
[ruby-core:47694].  [Feature #7067]</p>

<p>Thu Sep 27 18:36:51 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_overlay_module, rb_mod_refine): accept a module as the 	 
argument of Module#refine.</p>

<p>* vm_method.c (search_method): if klass is an iclass, lookup the 	 
original module of the iclass in omod in order to allow 	  refinements of
modules.</p>

<p>* test/ruby/test_refinement.rb: add tests for the above changes.</p>

<p>Thu Sep 27 18:12:20 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/syslog/lib/syslog/logger.rb: add a formatter to the 	 
Syslog::Logger object. [Bug #7065] 	* test/syslog/test_syslog_logger.rb:
ditto.</p>

<p>Wed Sep 26 16:39:57 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def: add new instruction `opt_empty_p&#39; for optimize
`empty?&#39; 	  method.  Apply a patch proposed at [ruby-dev:46120] 	 
[ruby-trunk - Feature #6972] by Glass_saga (Masaki Matsushita).</p>

<p>* compile.c (iseq_specialized_instruction), vm.c, vm_insnhelper.h: 	 
ditto.</p>

<p>* id.c, template/id.h.tmpl: ditto.</p>

<p>* test/ruby/test_optimization.rb: test for this changes.</p>

<p>Tue Sep 25 09:59:26 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* insns.def (invokesuper): klass in cfp is not valid in at_exit and 	  END
blocks.  [ruby-core:47680] [Bug #7064]</p>

<p>Tue Sep 25 08:11:11 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* iseq.c (rb_iseq_defined_string): the index of defined_strings must 	  be
the value of type - 1.</p>

<p>Mon Sep 24 17:36:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (defined_expr), insns.def (defined): share single frozen 	 
strings.  [EXPERIMENTAL] [ruby-core:47558][Feature #7035]</p>

<p>* iseq.c (rb_iseq_defined_string): make expression strings.</p>

<p>Mon Sep 24 11:22:36 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: add –ticket option to add ticket number.</p>

<p>Sun Sep 23 21:51:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (String#unspace): unescape with backslashes.  normal 	 
makes need to escape spaces with backslashes.  nmake is not the 	  case. 
[Bug #7036]</p>

<p>* lib/mkmf.rb (create_makefile): use timestamp file dependencies for 	 
directories.</p>

<p>* lib/mkmf.rb: unexpand macros.</p>

<p>* lib/mkmf.rb (LIBPATHFLAG): no needs to escape library path here.</p>

<p>* lib/mkmf.rb (MakeMakefile#configuration): make prefix paths 	  internal
to deal with in Makefile.</p>

<p>* lib/mkmf.rb (MakeMakefile#mkintpath): not a global function now.</p>

<p>Sun Sep 23 02:33:37 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* complex.c: Fix examples of r36993. 	  Keep the simple definition,
mathematics define the result. 	  Based on patch by Robin Dupret. Fixes
#188 on github.</p>

<p>Sat Sep 22 07:15:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* ext/ripper/lib/ripper.rb: 	  Match sample output to Ripper.sexp from
current trunk version. 	  [Bug #6929]</p>

<p>Thu Sep 20 23:05:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (native_cond_initialize): destroy condattr 	  after
using it. Patch by Stanislav Sedov. Thank you. 	  [Bug #7041]
[ruby-core:47619]</p>

<p>Thu Sep 20 22:53:02 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (native_cond_initialize): clean up #ifdef condition.</p>

<p>Thu Sep 20 16:42:44 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/drb/ssl.rb (DRb::DRbSSLSocket::SSLConfig::DEFAULT): add 	 
SSLTmpDhCallback for configuration option.</p>

<p>* lib/drb/ssl.rb (setup_ssl_context): copy the value of tmp_dh_callback.</p>

<p>* test/drb/ut_array_drbssl.rb: set tmp_dh_callback to suppress warning.</p>

<p>* test/drb/ut_drb_drbssl.rb: ditto.</p>

<p>Thu Sep 20 10:56:08 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/drb/ut_drb.rb: revert a part of r36987, and get rid of a warning 	 
with another method.  if the substitution is removed, the ExtSrv 	  object
will be GC&#39;ed and some tests will be blocked.</p>

<p>Thu Sep 20 07:20:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* complex.c: Examples for Complex Documentation. 	  Patch by Robin Dupret.
	  Fixes #184 on github.</p>

<p>Thu Sep 20 07:15:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* ext/ripper/lib/ripper.rb: Documentation for Ripper. 	 
<code>:void_stmt</code> is meaningless 	  [Bug #6929] [ruby-core:47507]</p>

<p>Thu Sep 20 07:05:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* lib/csv.rb (Object#CSV, Array#to_csv, String#parse_csv): 	  Examples and
documentation for CSV. 	  [Bug #6880] [ruby-core:47218]</p>

<p>Thu Sep 20 00:42:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (take_items), enum.c (enum_zip): raise TypeError at 	 
non-enumerable objects, not NoMethodError.  [ruby-dev:46145] 	  [Bug #7038]</p>

<p>* vm_eval.c (rb_check_block_call): check_funcall variant with block 	 
function.</p>

<p>Tue Sep 18 17:51:29 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_sslctx_attrs): add npn_select_db to 	 
suppress warning: instance variable @npn_select_cb not initialized</p>

<p>Sun Sep 16 17:47:00 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* tool/change_maker.rb:  Update svn detection for subversion 1.7&#39;s 	 
single .svn directory.</p>

<p>Sun Sep 16 11:39:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_set_read_length): if the read length equals to the buffer 	 
string size then nothing to do.  or ensure the string modifiable 	  before
setting the length only when the former is shorter.  based on 	  the patch
in [ruby-core:47541] by Hiroshi Shirosaki. 	  [ruby-core:46586] [Bug #6764]</p>

<p>Sun Sep 16 08:57:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (strict_warnflags): separate strict flags from 	  warnflags
only for core.  [ruby-dev:46105]</p>

<p>Sun Sep 16 08:16:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* .editorconfig: add.  [ruby-core:47548] [Feature #7030]</p>

<p>Sat Sep 15 01:56:40 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf-utf8/nkf.c: Merge upstream: 50a383c84. 	  [ruby-dev:46128]
[Bug #7005]</p>

<p>Sat Sep 15 00:20:04 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf.c (rb_nkf_convert): suppress warning.</p>

<p>Fri Sep 14 04:05:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_diff, rb_ary_uniq): 	  Enhance documentation for array
uniqueness 	  Based on a patch by Robin Dupret 	  [Bug #6872]
[ruby-core:47209]</p>

<p>Fri Sep 14 03:30:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_select): 	  Update documentation for Array#select 	*
enum.c (enum_find_all, enum_reject): 	  Update documentation for
Enumerable#find_all and Enumerable#reject 	  Based on a patch by Jeff
Saracco 	  [Bug #6908] [ruby-core:47285] [Fixes #166 on github]</p>

<p>Fri Sep 14 00:20:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* signal.c (rb_f_kill): 	  Update documentation for Process.kill to
reflect kill(2) 	  Patch by Richo Healey</p>

<p>Thu Sep 13 21:40:49 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* lib/securerandom.rb (SecureRandom.random_bytes): 	  Use 64bit value as
pointer for Windows x64 to fix SystemCallError.</p>

<p>* lib/securerandom.rb (SecureRandom.lastWin32ErrorMessage): 	  Set proper
encoding to avoid invalid byte sequence error. 	  [ruby-core:47451] [Bug
#6990]</p>

<p>Thu Sep 13 11:20:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb: Remove unreachable email address from documentation 	 
[Bug #6996] [ruby-core:47459]</p>

<p>Thu Sep 13 11:20:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* lib/xmlrpc.rb: Documentation for XMLRPC 	* lib/xmlrpc/datetime.rb:
ditto. 	* lib/xmlrpc/parser.rb: ditto. 	* lib/xmlrpc/client.rb: ditto. 	*
lib/xmlrpc/utils.rb: ditto. 	* lib/xmlrpc/README.rdoc: ditto. 	*
lib/xmlrpc/create.rb: ditto. 	* lib/xmlrpc/base64.rb: ditto. 	*
lib/xmlrpc/config.rb: ditto. 	* lib/xmlrpc/httpserver.rb: ditto. 	*
lib/xmlrpc/server.rb: ditto. 	* lib/xmlrpc/marshal.rb: ditto. 	*
lib/xmlrpc/README.txt: ditto. 	  [Bug #6909] [ruby-core:47286]</p>

<p>Thu Sep 13 10:22:11 2012  Takashi Toyoshima  &lt;toyoshim@gmail.com&gt;</p>

<p>* configure.in: Don&#39;t use PIE on Haiku because loader support is not 	
enough.</p>

<p>Thu Sep 13 08:20:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* lib/shellwords.rb: Documentation for Shellwords.</p>

<p>Thu Sep 13 08:00:00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* ext/ripper/lib/ripper.rb: Documentation for Ripper. 	*
ext/ripper/lib/ripper/lexer.rb: ditto. 	* ext/ripper/lib/ripper/sexp.rb:
ditto. 	* ext/ripper/lib/ripper/filter.rb: ditto. 	*
ext/ripper/lib/ripper/core.rb: ditto. 	  [Bug #6929] [ruby-core:47309]</p>

<p>Wed Sep 12 22:59:07 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_method_missing, vm_call_method): reuse arguments 	 
on the VM stack and get rid of ALLOCA.</p>

<p>Wed Sep 12 22:45::00 2012  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* ext/pathname/lib/pathname.rb: Documentation for Pathname. 	*
ext/pathname/pathname.c: ditto. 	  [Bug #6947] [ruby-core:47354]</p>

<p>Mon Sep 10 10:19:34 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* enc/depend: fixed wrong change in a part of r34802.</p>

<p>Sun Sep  9 22:02:50 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/socket/basicsocket.c (rsock_bsock_send): 	  avoid unnecessary
select() calls before doing I/O 	  Patch by Eric Wong. [Feature #4538]
[ruby-core:35586] 	* ext/socket/init.c (rsock_s_recvfrom): ditto. 	*
ext/socket/init.c (rsock_s_accept): ditto. 	* ext/socket/udpsocket.c
(udp_send): ditto. 	* io.c (io_fflush): ditto. 	* io.c (io_binwrite):
ditto. 	* io.c (rb_io_syswrite): ditto.</p>

<p>Mon Sep 10 01:38:51 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (nogvl_close, maygvl_close, nogvl_fclose, maygvl_fclose): 	 
suppress integer &lt;-&gt; pointer cast warnings. 	  [Feature #4570]
[ruby-core:35711]</p>

<p>Mon Sep 10 01:36:00 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_io_close): notify fd close before releasing gvl. 	* io.c
(fptr_finalize): modify fptr-&gt;mode before releasing gvl. 	  remove
unnecessary rb_thread_fd_close(). 	  [Feature #4570] [ruby-core:35711]</p>

<p>Mon Sep 10 00:16:34 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* process.c: exec() requires to be single threaded also on Haiku. 	  by
Takashi Toyoshima &lt;toyoshim@gmail.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/178">github.com/ruby/ruby/pull/178</a></p>

<p>Sun Sep  9 21:21:15 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/thread.rb (Queue#pop): Fixed double registration issue when 	 
mutex.sleep is interrupted. [Bug #5258] [ruby-dev:44448] 	* lib/thread.rb
(SizedQueue#push): ditto.</p>

<p>* test/thread/test_queue.rb (test_sized_queue_and_wakeup,
	test_queue_pop_interrupt, test_sized_queue_pop_interrupt,
	test_sized_queue_push_interrupt): new tests.</p>

<p>Sun Sep  9 20:20:31 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/sync.rb (Sync_m#sync_lock): Fixed wakeup/raise unsafe code. 	 
Patched by Masaki Matsushita. [Bug #5355] [ruby-dev:44521]</p>

<p>* test/thread/test_sync.rb (test_sync_lock_and_wakeup, 	 
test_sync_upgrade_and_wakeup, test_sync_lock_and_raise): 	  new test.</p>

<p>Sun Sep  9 18:39:46 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/intern.h (rb_thread_blocking_region): Added 	  a comment of
recommended alternative way.</p>

<p>Sun Sep  9 18:37:05 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/sync.rb (Sync_m): Removed RCS_ID.</p>

<p>Sun Sep  9 18:21:03 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (test_advise_pipe): new test to check 	 
io.advise() against anonymous io object don&#39;t make crash. 	  made by
Eric Wong. [Bug #6081] [ruby-core:42880]</p>

<p>Sun Sep  9 16:47:12 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (nogvl_close, maygvl_close, nogvl_fclose, maygvl_fclose): 	  new
functions. 	* io.c (fptr_finalize): release GVL if possible. 	  Patched by
Eric Wong. [Feature #4570] [ruby-core:35711]</p>

<p>Sun Sep  9 16:08:48 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (io_bufread): removed unnecessary rb_thread_wait_fd(). 	  Patch by
Eric Wong. [Bug #6629] [ruby-core:45789] 	* io.c (rb_io_sysread): ditto. 	*
io.c (copy_stream_fallback_body): ditto.</p>

<p>Sun Sep  9 15:21:52 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_mutex_lock): stop multiple threads use 	 
pthread_cond_timedwait() concurrently. [Bug #6278] [ruby-core:44275]</p>

<p>Sat Sep  8 18:52:22 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h (struct rb_classext_struct): move allocator function into 	 
rb_classext_t from ordinary method table.  [ruby-dev:46121] 	  [Feature
#6993]</p>

<p>* object.c (rb_obj_alloc): call allocator function directly.</p>

<p>* vm_method.c (rb_define_alloc_func, rb_undef_alloc_func) 	 
(rb_get_alloc_func): use allocator function in rb_classext_t.</p>

<p>Fri Sep  7 01:21:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extmake), lib/mkmf.rb (have_framework): fix splitting 	 
options with an argument, not using NUL as special character. 	 
[ruby-core:47447] [Bug #6987]</p>

<p>Thu Sep  6 14:49:49 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* .gdbinit (rp): FLONUM support.</p>

<p>* include/ruby/ruby.h (ruby_special_consts): define FLONUM constants 	 
always, so that they are available from gdb.</p>

<p>* include/ruby/ruby.h (RB_FLOAT_TYPE_P): merge FLONUM and non-FLONUM 	 
versions.  inline TYPE() comparison and FLONUM_P() should be 	  optimized
away on non-FLONUM.</p>

<p>Thu Sep  6 08:20:55 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 3.4.0 (r7762) 	* test/minitest/*:
ditto</p>

<p>Wed Sep  5 19:20:53 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* parse.y (rb_warn4S): renamed from rb_warn4(), because the case in 	 
r36911 takes a string.</p>

<p>* parse.y (rb_warn4S): use ripper_warnS() for ripper.</p>

<p>* parse.y (ripper_warnS): now it is used.</p>

<p>Wed Sep  5 15:51:52 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (notifications): [experimental] update notification 	 
template.</p>

<p>Wed Sep  5 15:21:12 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* parse.y (rb_warn4): added as a rb_warn variant to warn with explicit 	 
source file name and line in parse.y.</p>

<p>* parse.y (warn_unused_var): use rb_warn4 to suppress warning on ripper.</p>

<p>Wed Sep  5 13:30:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (glob_make_pattern): names under recursive need to be single 	 
basenames to match for each name.  [ruby-core:47418] [Bug #6977]</p>

<p>Tue Sep  4 20:55:17 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/envutil.rb (EnvUtil#invoke_ruby): show Timeout::Error 	 
instead of IOError if the timeout has expired.</p>

<p>* test/test_pstore.rb 	 
(PStoreTest#test_pstore_files_are_accessed_as_binary_files): 	  increase
timeout because this test is slow on Windows. 	  [ruby-core:47402] [Bug
#6965]</p>

<p>Tue Sep  4 11:28:57 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* vm_eval.c (ruby_eval_string_from_file_protect): initializer 	  element
is not computable at load time.</p>

<p>Tue Sep  4 07:48:35 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_asn1_rb: 	  test/openssl/test_ssl_session.rb: 	 
test/openssl/test_x509name.rb: 	  test/openssl/test_buffering.rb: 	 
test/openssl/test_x509cert.rb: 	  test/openssl/test_ssl.rb: Refactor code
that leads to warnings on 	  Ruby CI.</p>

<p>Tue Sep  4 07:02:56 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/utils.rb: Use DSS1 as DSA signature digest for all 	 
OpenSSL versions &lt; 1.0.0. 	  [Feature #6946] [ruby-core:47405]</p>

<p>Mon Sep  3 21:22:37 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_float_value): suppress warnings. 	 
[ruby-core:47406][Bug #6971]</p>

<p>Mon Sep  3 14:49:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/matrix.rb (Vector#magnitude): accumulate squares of absolute 	 
values to fix for complex vector.  [ruby-dev:46100] [Bug #6966]</p>

<p>Mon Sep  3 10:09:36 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/extconf.rb: Detect OpenSSL_FIPS macro 	  ext/openssl/ossl.c:
Expose OpenSSL::OPENSSL_FIPS constant to 	  indicate whether OpenSSL runs
in FIPS mode. 	  test/openssl/test_pkey_dh.rb: Generate 256 bit keys for 	 
non-FIPS installations to improve test performance (e.g. for 	  rubyci). 	 
test/openssl/utils.rb: Replace DSS1 as certificate signature 	  digest with
SHA1 for FIPS installations when using DSA by 	  introducing
TestUtils::DSA_SIGNATURE_DIGEST. 	  test/openssl/test_x509cert.rb: 	 
test/openssl/test_x509crl.rb: 	  test/openssl/test_x509req.rb: Use
DSA_SIGNATURE_DIGEST 	  NEWS: Introduce OpenSSL::OPENSSL_FIPS</p>

<p>These changes allow running the OpenSSL tests in FIPS mode 	  while
keeping a high performance for non-FIPS installations. 	  Introduction of
OpenSSL::OPENSSL_FIPS allows for applications 	  to react to special
requirements when using OpenSSL in FIPS mode. 	  [Feature #6946]
[ruby-core:47345]</p>

<p>Sun Sep  2 21:46:28 2012  Martin Bosslet
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/utils.rb: Use a cached DH key instead of generating a 	 
new one each time.</p>

<p>Sun Sep  2 05:41:28 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/ssl.rb (WEBrick::Config::SSL): add new key 	 
SSLTmpDhCallback to set SSLContext#tmp_dh_callback.</p>

<p>* lib/webrick/ssl.rb (WEBrick::GenericServer#setup_ssl_context): 	  follow
above.</p>

<p>Sat Sep  1 18:50:50 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/set.rb (#initialize_copy, #eql): Use instance_variable_get 	 
instead of instance_eval.</p>

<p>Fri Aug 31 21:47:56 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/test/unit/test-unit.gemspec: Make test/unit default gem. 	  [Feature
#6875] [ruby-dev:46051]</p>

<p>Fri Aug 31 18:35:02 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/extconf.rb: Check existence of OPENSSL_NPN_NEGOTIATED. 	 
ext/ossl_ssl.c: Support Next Protocol Negotiation. Protocols to be 	 
advertised by the server can be set in the SSLContext by using 	 
SSLContext#npn_protocols=, protocol selection on the client is 	  supported
by providing a selection callback with 	  SSLContext#npn_select_cb. The
protocol that was finally negotiated 	  is available through
SSL#npn_protocol. 	  test/openssl/test_ssl.rb: Add tests for Next Protocol
Negotiation. 	  NEWS: add news about NPN support. 	  [Feature #6503]
[ruby-core:45272]</p>

<p>Fri Aug 31 17:38:43 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/set.rb (Set#<code>each,reject!,select!</code>, SortedSet#each): Pass 	  the
original block through instead of creating one that only 	  yields the
passed argument.</p>

<p>Fri Aug 31 16:23:20 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/ipaddr.rb: Introduce several new error classes where only 	 
ArgumentError and StandardError were used.  IPAddr::Error is 	  their
common ancestor class that inherits from ArgumentError for 	  backward
compatibility.  Submitted by Jon Daniel.  Fixes #173 on 	  GitHub.</p>

<p>Fri Aug 31 14:51:27 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/bigdecimal/test_bigdecimal.rb (TestBigDecimal#test_to_f): added 	 
for previous commit.</p>

<p>Fri Aug 31 14:32:05 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_to_f): use self&#39;s sign to 	 
determine 0.0 and Inf&#39;s sign instead of internal double value&#39;s. 	 
Reported by phasis68 (Heesob Park) at [ruby-core:47381] [Bug #6955]</p>

<p>Fri Aug 31 14:31:17 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* template/id.h.tmpl, tool/id2token.rb: make id.h independent from 	 
parse.h, and make parse.c dependent on it instead.</p>

<p>Fri Aug 31 14:27:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (create_makefile): fix race conditions at install-ext. 	 
target files need to depend on destination directory timestamp 	  files,
not phony targets.</p>

<p>Fri Aug 31 14:03:45 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_trace.c (clean_hooks): do not access freed memory.</p>

<p>* vm_trace.c (rb_threadptr_exec_event_hooks): fix uninitialized state 	 
when no events is executed.</p>

<p>Thu Aug 30 18:21:51 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_io_close): call rb_last_status_clear.</p>

<p>Thu Aug 30 16:17:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_to_f): check underflow since 	 
strtod() sets errno to ERANGE at underflow too.  [ruby-core:47342] 	  [Bug
#6944]</p>

<p>Thu Aug 30 12:44:43 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/set.rb (Set#&lt;,&gt;,&lt;=,&gt;=): Define comparison operators as
	  shorthand for the <code>proper_</code><code>subset?,superset?</code> methods (finally). 	 
Given a push by Alexander E. Fischer.</p>

<p>Thu Aug 30 09:21:01 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/ftp.rb (URI::FTP#initialize): raise InvalidURIError if “//” 	 
is not present [ruby-core:47344] [Bug #6945]</p>

<p>Thu Aug 30 07:45:12 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* test/ruby/test_file_exhaustive.rb: fix test introduced in r36811 for 	 
posix environments where HOME is not defined.  [ruby-core:47322]</p>

<p>Wed Aug 29 23:42:59 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_last_status_clear): declared.</p>

<p>* process.c (rb_last_status_clear): exported. 	  (rb_f_system): call
rb_last_status_clear.</p>

<p>* io.c (rb_f_backquote): call rb_last_status_clear.</p>

<p>Wed Aug 29 22:01:15 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_f_system): check failures of waitpid. 	 
[ruby-talk:398687]</p>

<p>Wed Aug 29 15:03:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (LIBDIR_BASENAME): use configured libdir value to fix 	 
–enable-load-relative on systems where libdir is not default value, 	 
overridden in config.site files.  [ruby-core:47267] [Bug #6903]</p>

<p>* ruby.c (ruby_init_loadpath_safe): ditto.</p>

<p>Wed Aug 29 14:34:41 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* addr2line.c: SIZE_MAX is defined in stdint.h, so r36755 breaks 	  32bit
FreeBSD. [ruby-core:47360] [Bug #6948]</p>

<p>Wed Aug 29 04:50:04 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/utils.rb 	  test/openssl/test_pair.rb 	 
test/openssl/test_pkey_dh.rb: Use 1024 bit DH parameters to satisfy 	 
OpenSSL FIPS requirements. Patch by Vit Ondruch. 	  [Bug #6938]
[ruby-core:47326]</p>

<p>Tue Aug 28 22:31:49 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* insns.def (checkmatch): suppress warnings. [ruby-core:47339] 	  [Bug
#6930]</p>

<p>Tue Aug 28 20:03:54 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: Fixing Haiku R1/alpha3 build with gcc-4.4.4. 	  - omit
ANSI standard flags to compile socket extension where 	    anonymous union
is required. 	  - remove redundant -be flags. 	  by Takashi Toyoshima
&lt;toyoshim@gmail.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/168">github.com/ruby/ruby/pull/168</a></p>

<p>Tue Aug 28 11:32:37 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* nacl/GNUmakefile.in (.rbconfig.time): r36828 was incomplete. 	  It did
not run correctly on clean build.</p>

<p>Tue Aug 28 09:25:20 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (Makefile): make to depend on common.mk, to 	  stop
and force to re-run make process when common.mk is changed.</p>

<p>Mon Aug 27 20:19:49 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/etc/test_etc.rb (TestEtc#test_getgrgid): fix for non unique GID. 	 
No unixen systems guarantee that GID is unique. Etc.getgrgid would 	  not
return the first entry in the order of Etc.group for shared GID. 	 
[ruby-core:47312] [Bug #6935]</p>

<p>Mon Aug 27 18:19:36 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/ruby.h (rb_float_value): optimize it. 	  This technique was
pointed by shinichiro.hamaji 	  &lt;<a
href="http://shinh.skr.jp/m/?date=20120825#p02">shinh.skr.jp/m/?date=20120825#p02</a>&gt;.</p>

<p>Mon Aug 27 15:08:25 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* common.mk (vm_trace.o): Added a missing dependency.</p>

<p>Sun Aug 26 09:29:32 2012  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* nacl/GNUmakefile.in (package): make package should install 	 
example.html for nacl build</p>

<p>Patch by Takashi Toyoshima &lt;toyoshim AT gmail.com&gt;.</p>

<p>Sun Aug 26 09:22:33 2012  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* nacl/GNUmakefile.in (CC, LD, NM, AR, AS, RANLIB, OBJDUMP, OBJCOPY) 	 
Rewrites these variables instead of PATH. 	  NaCl port uses a toolchain
which is specified by NACL_SDK_ROOT 	  environment variable. Originally,
NaCl build added the toolchain 	  under the NACL_SDK_ROOT to the PATH. But
updating PATH doesn&#39;t work 	  on Mac. 	  (RBCONFIG): Replaces configs
with the variable updates above.</p>

<p>* configure.in: Thus it is no longer necessary to check $PATH.</p>

<p>Based on a patch by Takashi Toyoshima &lt;toyoshim AT gmail.com&gt;.</p>

<p>Sun Aug 26 16:53:00 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* insns.def (checkmatch): suppress warnings.  [ruby-core:47310] 	  [Bug
#6930]</p>

<p>* vm_core.h (VM_FRAME_TYPE_FINISH_P): ditto.</p>

<p>Fri Aug 24 15:42:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (create_makefile): use timestamp for destination 	 
directories to make them before making or copying files there. 	 
[ruby-dev:46067] [Bug #6904]</p>

<p>Fri Aug 24 12:40:15 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* configure.in (mingw): add shlwapi to the list of dependency 	  libs for
Windows. 	* win32/Makefile.sub (EXTSOLIBS): ditto.</p>

<p>* internal.h: declare internal functions rb_w32_init_file, 	 
rb_file_expand_path_internal and rb_file_expand_path_fast.</p>

<p>* file.c (Init_File): invoke Windows initialization rb_w32_init_file</p>

<p>* win32/file.c (rb_file_load_path_internal): new function. 	 
Windows-specific implementation that replaces file_expand_path. 	  [Bug #<a
href="ruby-core:46996">6836]</a></p>

<p>* win32/file.c (rb_w32_init_file): new function. Initialize codepage 	 
cache for faster conversion encodings lookup.</p>

<p>* file.c (file_expand_path): rename to rb_file_expand_path_internal. 	 
Conditionally exclude from Windows.</p>

<p>* file.c (rb_file_expand_path_fast): new function. delegates to 	 
rb_file_expand_path_internal without performing a hit to the 	  filesystem.</p>

<p>* file.c (file_expand_path_1): use rb_file_expand_path_internal without 	 
path expansion (used by require). 	* file.c (rb_find_file_ext_safe): ditto.
	* file.c (rb_find_file_safe): ditto.</p>

<p>* load.c (rb_get_expanded_load_path): use rb_file_expand_path_fast. 	*
load.c (rb_feature_provided): ditto.</p>

<p>* file.c (rb_file_expand_path): use rb_file_expand_path_internal with 	 
path expansion. 	* file.c (rb_file_absolute_path): ditto.</p>

<p>* test/ruby/test_file_exhaustive.rb: new tests to exercise 	 
rb_file_expand_path_internal implementation and compliance with 	  existing
behaviors.</p>

<p>Fri Aug 24 07:35:24 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http/backward.rb (class Net):  Restored Net::HTTPSession to 	 
fix backwards-compatibility with ancient Net::HTTP.  [Bug #6889]</p>

<p>Thu Aug 23 20:58:55 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* common.mk: support `make id.h` without `rm .id.h.time` after 	  `rm
id.h`.</p>

<p>Thu Aug 23 20:48:45 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_fixnum.rb (TestFixnum#test_singleton_method): new test.</p>

<p>* test/ruby/test_bignum.rb (TestBignum#test_singleton_method): ditto.</p>

<p>* test/ruby/test_float.rb (TestFloat#test_singleton_method): ditto.</p>

<p>* test/ruby/test_symbol.rb (TestSymbol#test_singleton_method): ditto.</p>

<p>Thu Aug 23 20:34:32 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* class.c (singleton_class_of): flonum can&#39;t have singleton class.</p>

<p>* vm.c (vm_define_method): flonum can&#39;t have singleton method.</p>

<p>Thu Aug 23 19:18:33 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk (win32/*): macro RUBY_H_INCLUDES is not defined there, 	  so
need to move dependency rules under the definition of it.</p>

<p>Thu Aug 23 19:16:20 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub: refactoring.  remove unused rules, and update 	 
some rules which are not used usually to fit current macros.</p>

<p>Thu Aug 23 16:46:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_find_file_ext_safe, rb_find_file_safe): default to 	 
US-ASCII for encdb and transdb.</p>

<p>* load.c (search_required): keep encoding of feature name.  set 	  loading
path to filesystem encoding.  [Bug #<a href="ruby-core:44750">6377]</a></p>

<p>* ruby.c (add_modules, require_libraries): assume default external 	 
encoding as well as ARGV.</p>

<p>Thu Aug 23 16:20:04 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* include/ruby/ruby.h: introduce flonum technique for 	  64bit CPU
environment (sizeof(double) == sizeof(VALUE)). 	  flonum technique enables
to avoid double object creation 	  if the double value d is in range about
between 	  1.72723e-77 &lt; |d| &lt;= 1.15792e+77 or 0.0. 	  flonum Float
value is immediate and their lowest two bits 	  are b10. 	  If flonum is
activated, then USE_FLONUM macro is 1. 	  I&#39;ll write detailed in this
technique on 	  <a
href="https://bugs.ruby-lang.org/projects/ruby-trunk/wiki/Flonum_tech">bugs.ruby-lang.org/projects/ruby-trunk/wiki/Flonum_tech</a></p>

<p>* benchmark/bmx_temp.rb: add an benchmark for simple 	  Float calculation.</p>

<p>* gc.c (id2ref, rb_obj_id): add flonum Float support.</p>

<p>* include/ruby/intern.h: move decl of rb_float_new(double) 	  to
include/ruby/ruby.h.</p>

<p>* insns.def, vm.c, vm_insnhelper.c: add flonum optimization 	  and
simplify source code.</p>

<p>* vm_insnhelper.h (FLONUM_2_P): added.</p>

<p>* marshal.c: support flonum output.</p>

<p>* numeric.c (rb_float_new_in_heap): added.</p>

<p>* parse.y: support flonum.</p>

<p>* random.c: ditto.</p>

<p>Thu Aug 23 16:12:40 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (create_makefile): add dependency to header files when 	 
depend files don&#39;t exist.  now we can remove simple (and often 	 
wrong) depend files in most cases.</p>

<p>Thu Aug 23 16:02:20 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* ext/date/depend: add dependency to $(ruby_headers).</p>

<p>Thu Aug 23 12:51:39 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* insns.def (invokesuper): reverted r36640 partially to make super 	  in a
thread work correctly. [ruby-core:47284] [Bug #6907]</p>

<p>* test/ruby/test_super.rb: related test.</p>

<p>Thu Aug 23 12:30:20 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/configure.bat: support –with(out)?-ext(ensions) options.</p>

<p>Thu Aug 23 11:52:04 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: Fixing Haiku build. 	  - -lbe is not required for linking
	  - stack protector doesn&#39;t work for now because of the default
gcc&#39;s 	    bug 	  by Takashi Toyoshima &lt;toyoshim@gmail.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/167">github.com/ruby/ruby/pull/167</a></p>

<p>* signal.c (ruby_signal): haiku doesn&#39;t have SIGBUS.</p>

<p>Thu Aug 23 11:32:44 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/open-uri/test_open-uri.rb (TestOpenURI#test_read_timeout): this 	 
test expects that the server thread will be killed in sleep, but 0.01 	 
sec is too short to reach there.</p>

<p>Thu Aug 23 10:49:28 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: use the value of –with-opt-dir on building ruby 	  itself.
[ruby-dev:46064] [Bug #6900]</p>

<p>Thu Aug 23 10:36:35 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk (ID_H_TARGET): revert a part of r36724 and r36751.  they 	 
break mswin build from clean source.</p>

<p>Thu Aug 23 02:37:35 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/syck: removed. Fixes [ruby-core:43360]</p>

<p>* test/syck: removed.</p>

<p>* lib/yaml.rb: only require psych, show a warning if people try to set 	 
the engine to syck.</p>

<p>Thu Aug 23 01:46:53 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* insns.def: search up the cf stack for an object that is an instance 	 
of the recipient class.  Fixes [ruby-core:47186]</p>

<p>* test/ruby/test_super.rb: related test.</p>

<p>Wed Aug 22 19:46:24 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: [ruby-core:47266].</p>

<p>Wed Aug 22 19:41:19 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: [ruby-core:47226].</p>

<p>Wed Aug 22 16:57:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (configuration): extract least ruby headers list as 	 
ruby_headers, so depend files can use default dependency 	  explicitly.</p>

<p>Wed Aug 22 15:27:50 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c (vm_setup_method): fix last commit of 	  vm_insnhelper.c
(r36771). [ruby-dev:46065] [Bug #6901] 	  Should not disable tail call opt
on FINISH_FRAME. 	  This flag should be propagated correctly.</p>

<p>Wed Aug 22 14:05:23 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c: support TracePoint. [ruby-trunk - Feature #6895]</p>

<p>* test/ruby/test_settracefunc.rb: add tests for above.</p>

<p>* proc.c (rb_binding_new_with_cfp): add an internal function.</p>

<p>* vm.c (rb_vm_control_frame_id_and_class): add an internal function.</p>

<p>* vm_trace.c: add rb_add_event_hook2() and rb_thread_add_event_hook2(). 	 
Give us the good name for them!</p>

<p>Wed Aug 22 11:38:16 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (before_script): Turned out that make -j is broken.</p>

<p>Wed Aug 22 11:23:35 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_setup_method): should not enable tail call 	 
optimization for frames with VM_FRAME_FLAG_FINISH. 	  [ruby-dev:46065] [Bug
#6901]</p>

<p>Wed Aug 22 11:20:47 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rubygems/test_case.rb: run test with psych if exist.</p>

<p>Thu Aug 16 12:09:51 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* nacl/pepper_main.c (init_loadpath): Pushes the correct load path on 	 
other architectures than x86_64. Fixes #6873.</p>

<p>Wed Aug 15 19:37:33 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* configure.in (ac_cv_func_shutdown): shutdown(2) has a dummy 	 
implementation but has no declaration and does not work in 	  NativeClient
SDK pepper_20.</p>

<p>Wed Aug 15 19:29:29 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* common.mk (vm_backtrace.o): Added missing dependencies.</p>

<p>* ext/nkf/depend (nkf.o): ditto.</p>

<p>* ext/ripper/depend (ripper.o) ditto.</p>

<p>Wed Aug 22 07:27:00 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/cgi/util.rb (CGI.escapeHTML): use &amp;#39; 	  [ruby-core:47221]
[Bug #6861]</p>

<p>Tue Aug 21 21:59:22 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/observer.rb: fix typo. <a
href="https://github.com/ruby/ruby/pull/162">github.com/ruby/ruby/pull/162</a>
by 	  unsymbol (Philip Cunningham).</p>

<p>Tue Aug 21 20:30:06 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* test/fileutils/test_fileutils.rb (TestFileUtils#teardown): 	  do not
assume cwd is TMPROOT and never remove current directory. 	 
[ruby-core:47224][Bug #6884]</p>

<p>Tue Aug 21 17:29:56 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* addr2line.c (fill_lines): need check and cast of the file size of 	 
target binary because there are some platforms which off_t &gt; size_t.</p>

<p>Tue Aug 21 17:07:58 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (compiler): [experimental] clang support.</p>

<p>Tue Aug 21 15:44:27 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/dl/lib/dl/func.rb (DL::Function#bind): fixes an error in 	 
test/dl/test_import.rb (DL::TestImport#test_carried_function) 	  introduced
by r36718. 	  the instance of the anonymous class which wraps the block
should have 	  same methods and instance variables of self.</p>

<p>Tue Aug 21 14:29:22 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (scriptbin.mk): no need to include twice.</p>

<p>Tue Aug 21 10:52:08 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/unit/test.rb (Test::Unit::ProxyError): new exception class to 	 
wrap exceptions raised in workers in parallel test mode.</p>

<p>* test/unit/parallel.rb (Test::Unit::Worker#puke): use above wrapper 	 
exception. 	  [Bug #6882] [ruby-dev:46054]</p>

<p>Tue Aug 21 10:40:06 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test_continuation.rb (tracing_with_thread_set_trace_func): 	  fix to use
Thread#set_trace_func(nil), not set_trace_func(nil).</p>

<p>Tue Aug 21 09:32:41 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 3.3.0 (r7676) 	* test/minitest/*:
ditto</p>

<p>Tue Aug 21 09:05:32 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/testunit/tests_for_parallel/ptest_forth.rb: added a test case 	 
which causes an error.</p>

<p>* test/testunit/test_parallel.rb: follow above change. 	  see [Bug #6882]</p>

<p>Tue Aug 21 05:43:00 2012  James Edward Gray II 
&lt;james@graysoftinc.com&gt;</p>

<p>* lib/csv.rb: Fixes #161 on github 	* lib/csv.rb: You can now specify a
pattern for :skip_lines. 	  Matching lines will not be passed to the CSV
parser. 	* lib/csv.rb: Patch by Christian Schwartz.</p>

<p>Tue Aug 21 05:25:41 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* re.c (rb_reg_initialize_m): Forgot to update output for or&#39;d-options
	  example.</p>

<p>Tue Aug 21 05:18:03 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* re.c (rb_reg_initialize_m): Update example to show that regexp 	 
options use | an not || to avoid confusion.</p>

<p>Mon Aug 20 23:02:27 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y: more descriptive token names in syntax error messages.</p>

<p>Mon Aug 20 20:36:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_method): follow iclasses as klass in cfp 	  but
not included modules.  [ruby-core:47241] [Bug #6891]</p>

<p>* vm_insnhelper.c (vm_call_bmethod): pass defined_class to follow 	 
proper ancestors.  [ruby-core:47241] [Bug #6891]</p>

<p>Mon Aug 20 11:40:27 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* common.mk: fix failed to make with -j2. 	  <a
href="https://gist.github.com/3397935">gist.github.com/3397935</a></p>

<p>Mon Aug 20 10:51:01 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb, lib/test/unit/parallel.rb: 	  generate error message
(String) in parallel.rb instead of 	  marshalling Exception. Fixes [Bug
#6882] [ruby-dev:46054]</p>

<p>Sun Aug 19 01:24:32 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* enum.c: fix docs. <a
href="https://github.com/ruby/ruby/pull/129">github.com/ruby/ruby/pull/129</a>
by 	  richardkmichael (Richard Michael).</p>

<p>Sun Aug 19 00:47:26 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/fileutils.rb: fix typo. 	  <a
href="https://github.com/ruby/ruby/pull/155">github.com/ruby/ruby/pull/155</a>
by simonc (Simon COURTOIS).</p>

<p>Sat Aug 18 09:57:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/depend: fix inplace-build condition.  enc.mk is generated with 	 
setting $srcdir to enc, but pwd is still top build directory. 	 
[ruby-core:47236] [Bug #6888]</p>

<p>Fri Aug 17 23:28:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_any_to_s, rb_obj_inspect): preserve encodings of class 	 
name and instance variable names.</p>

<p>Fri Aug 17 12:39:33 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/dl/lib/dl/func.rb (DL::Function#bind): allow to return/break from 	 
the callback method. (Fiddle already allows it.) 	  [Bug #6389]
[ruby-dev:45604]</p>

<p>Thu Aug 16 19:54:24 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c, vm_core.h: simplify tracing mechanism.</p>

<p>(1) add rb_hook_list_t data structure which includes 	      hooks,
events (flag) and `need_clean&#39; flag. 	      If the last flag is true,
then clean the hooks list. 	      In other words, deleted hooks are
contained by `hooks&#39;. 	      Cleanup process should run before
traversing the list. 	  (2) Change check mechanism 	      See
EXEC_EVENT_HOOK() in vm_core.h. 	  (3) Add `raw&#39; hooks APIs 	     
Normal hooks are guarded from exception by rb_protect(). 	      However,
this protection is overhead for too simple 	      functions which never
cause exceptions.  `raw&#39; hooks 	      are executed without protection
and faster. 	      Now, we only provide registration APIs.  All `raw&#39; 	
hooks are kicked under protection (same as normal hooks).</p>

<p>* include/ruby/ruby.h: remove internal data definition and 	  macros.</p>

<p>* internal.h (ruby_suppress_tracing), vm_trace.c: rename 	 
ruby_suppress_tracing() to rb_suppress_tracing() 	  and remove unused
function parameter.</p>

<p>* parse.y: fix to use renamed rb_suppress_tracing().</p>

<p>* thread.c (thread_create_core): no need to set RUBY_VM_VM.</p>

<p>* vm.c (mark_event_hooks): move definition to vm_trace.c.</p>

<p>* vm.c (ruby_vm_event_flags): add a global variable. 	  This global
variable represents all of Threads and VM&#39;s 	  event masks (T1#events |
T2#events | … | VM#events). 	  You can check the possibility kick trace
func or not 	  with ruby_vm_event_flags. 	  ruby_vm_event_flags is
maintained by vm_trace.c.</p>

<p>* cont.c (fiber_switch, rb_cont_call): restore tracing status. 	  [Feature
#4347]</p>

<p>* test/ruby/test_continuation.rb: ditto.</p>

<p>Thu Aug 16 19:15:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_class_initialize): forbid inheriting uninitialized 	 
class.  another class tree not based on BasicObject cannot exist. 	 
[ruby-core:47148][Bug #6863]</p>

<p>Thu Aug 16 11:52:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/-ext-/test_printf.rb (Test_SPrintf#test_<code>taint,untrust</code>): use 	 
plain object so that the results of to_s and inspect are infected. 	 
[ruby-dev:46053] [Bug #6881]</p>

<p>Thu Aug 16 09:46:07 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c: remove unnecessary macros to check traditional C. 	  <a
href="https://github.com/ruby/ruby/pull/46">github.com/ruby/ruby/pull/46</a>
by lateau (Daehyub Kim).</p>

<p>* vsnprintf.c: remove K&amp;R.</p>

<p>Wed Aug 15 20:47:49 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* object.c (rb_obj_inspect): Kernel#inspect: do not call #to_s. A class 	 
can now benefit from the nice default #inspect even if it defines #to_s. 	 
Also, there is no more unexpected change in #inspect result.</p>

<p>* NEWS: Add note about the change.</p>

<p>* bignum.c, io.c, numeric.c, object.c, proc.c, vm.c (Init_*): 	  Adapt
internal structures (by aliasing #inspect to #to_s) so they 	  don&#39;t
rely on the removed behavior (#inspect calling overridden #to_s).</p>

<p>* test/ruby/test_object.rb (test_inspect): add tests for Kernel#inspect.</p>

<p>* lib/pp.rb (class PP): do not call #to_s anymore, as #inspect 	  no more
does (mame).</p>

<p>* test/test_pp.rb (class PPInspectTest): remove related assertion (mame).
	  [ruby-core:43238][Feature #6130]</p>

<p>* test/drb/drbtest.rb (DRbCore#teardown, DRbAry#teardown): 	  adapt DRb
tests with the new change (shirosaki). 	  [ruby-core:47182][Bug #6866]</p>

<p>Wed Aug 15 18:05:37 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#failed): need to delete the 	 
status line if the status is skipped and -q is specified.</p>

<p>Wed Aug 15 16:26:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (ruby__sfvextra): the result should be infected by the 	 
given strings.</p>

<p>* sprintf.c (ruby__sfvwrite): set buffer length and exclude 	 
uninitialized garbage to get correct coderange.</p>

<p>Wed Aug 15 16:20:09 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (ID_H_TARGET): make timestamp file of id.h so that the 	 
header will not be remade repetitively.</p>

<p>Wed Aug 15 11:39:53 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_trace.c: separate trace_func related functions from 	  thread.c.</p>

<p>* thread.c: ditto.</p>

<p>* common.mk: add vm_trace.o.</p>

<p>* inits.c: call Init_vm_trace().</p>

<p>Tue Aug 14 16:25:46 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* test/erb/test_erb.rb (test_html_escape): add assertions for the 	  cases
where the argument is not a String.</p>

<p>Tue Aug 14 16:03:31 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (check_valid_dir): reject “…” as directory name. 	  [Bug
#6851]</p>

<p>Tue Aug 14 16:02:51 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_file_exhaustive.rb 	 
(TestFileExhaustive#test_stat_dotted_prefix): added.</p>

<p>Tue Aug 14 15:39:09 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_file_exhaustive.rb 	 
(TestFileExhaustive#test_stat_drive_root): added.</p>

<p>Tue Aug 14 10:38:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/erb.rb (ERB::Util.html_escape): fix r36687: call to_s before 	 
passing it to CGI.escapeHTML.</p>

<p>Mon Aug 13 13:13:19 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/erb.rb (ERB::Util.html_escape): use CGI.escapeHTML to escape 	 
single quotes. [ruby-core:47138] [Bug #6861]</p>

<p>Sun Aug 12 11:57:20 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (invoke_block_from_c): fix unintentional block passing. 	 
[ruby-dev:45071] [Bug #5832]</p>

<p>Fri Aug 10 08:41:28 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* gc.c (gc_malloc_allocated_size):  RDoc does not process macros, so 	 
mention this method is only available when ruby is built with 	 
CALC_EXACT_MALLOC_SIZE 	* gc.c (gc_malloc_allocations):  ditto</p>

<p>Thu Aug  9 23:46:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/mkrunnable.rb: see build_os instead of target arch for 	 
cross-compiling.</p>

<p>* configure.in (MINIRUBY): use real path for include path.</p>

<p>* template/fake.rb.in (builddir): remove duplications</p>

<p>Thu Aug  9 20:03:11 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_file_exhaustive.rb 	 
(TestFileExhaustive#test_stat_special_file): add a test. 	 
GetFileAttributesExW fails to get attributes of special files 	  such as
pagefile.sys.</p>

<p>* win32/win32.c (check_valid_dir): for performance, check the path 	  by
FindFirstFileW only if the path contains “…”</p>

<p>* win32/win32.c (winnt_stat): use GetFileAttributesExW instead of 	 
FindFirstFileW since GetFileAttributesExW is faster. 	  Based on the patch
by Dusan D. Majkic. 	  [ruby-core:47083] [Feature #6845]</p>

<p>Thu Aug  9 18:33:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (proc_options): show version only once even if -v and 	  –version
are given together. 	  <a
href="http://twitter.com/d6rkaiz/status/233491797085671424">twitter.com/d6rkaiz/status/233491797085671424</a></p>

<p>Thu Aug  9 12:37:22 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/openssl/test_config.rb (OpenSSL#test_constants): skip this 	  test
if platform is Mac OS X or Windows. [Bug #6830]</p>

<p>Wed Aug  8 22:51:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (eval_under): singletons other than special constants 	 
don&#39;t need cref-scope hack.</p>

<p>Wed Aug  8 22:45:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (.y.h): split from .y.c rule to manage dependency on 	 
parse.h.  [ruby-core:46741] [Bug #6789]</p>

<p>* common.mk (id.h): keep old file unless changed.</p>

<p>Wed Aug  8 17:11:20 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (ADD_INSNL): make ADD_INSNL as alias of ADD_INSN1.</p>

<p>Wed Aug  8 17:08:14 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* bootstrap/test_exception.rb: fix a last committed test.</p>

<p>Wed Aug  8 16:27:58 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c, insns.def (checkmatch): 	  remove checkincludearray
instruction and 	  add new instruction checkmatch. 	  This change is to
solve 	  [Bug #4438] “rescue args type check omitted”.</p>

<p>* iseq.c: increment ISEQ_MAJOR_VERSION because removal of 	 
checkincludearray instruction.</p>

<p>* vm_core.h: add several definitions for 	  the checkmatch instruction.</p>

<p>* vm_insnhelper.c (check_match): added.</p>

<p>* bootstraptest/test_exception.rb: add a test.</p>

<p>* test/ruby/test_exception.rb: ditto.</p>

<p>Wed Aug  8 05:51:20 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* proc.c (method_clone):  Added documentation.  Patch by Robin Dupret. 	 
Fixes #152 on github.</p>

<p>Tue Aug  7 20:19:29 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (Init_readline): rl_catch_signals=0 returns 	 
back. Without this, on FreeBSD9 and readline 6.2 irb can&#39;t catch ^C. 	 
[Bug #5423]</p>

<p>Tue Aug  7 20:12:39 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_exec.c, insns.def (leave): solve problems on 	 
OPT_CALL_THREADED_CODE. 	  Catch up finish frame structure on
OPT_CALL_THREADED_CODE.</p>

<p>* vm_core.h: add rb_thread_t#retval for temporary space on 	 
OPT_CALL_THREADED_CODE.</p>

<p>* vm.c (th_init): clear rb_thread_t#retval as Qundef.</p>

<p>* vm_dump.c (rb_vmdebug_debug_print_pre): fix debug print format.</p>

<p>Tue Aug  7 11:58:27 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_require.rb (TestRequire#test_require_twice): added.</p>

<p>Tue Aug  7 11:35:37 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_redefine_opt_method): use RCLASS_ORIGIN to avoid 	  SEGV
when a module-prepended class is refined.</p>

<p>Tue Aug  7 10:46:37 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_file_exhaustive.rb 	 
(TestFileExhaustive#test_expand_path*): refactoring.  split the method 	 
into some chunks of the same kind of tests.</p>

<p>Tue Aug  7 00:31:09 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_special_singleton_class_of): utility function.</p>

<p>* vm_eval.c (eval_under): special deal for class variable scope with 	 
instance_eval.</p>

<p>* vm_eval.c (rb_obj_instance_eval, rb_obj_instance_exec): allow method 	 
definition in instance_eval of special constants.  [ruby-core:28324] 	 
[Bug #2788]</p>

<p>Tue Aug  7 00:23:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (CVAR_LOOKUP): split into helper functions.</p>

<p>Mon Aug  6 19:15:11 2012  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* test/win32ole/test_win32ole_variant.rb: setting WIN32OLE.locale 	  to
pass some assertion.  Thanks to Hiroshi Shirosaki. 	  [ruby-core:46873][Bug
#6814]</p>

<p>Mon Aug  6 15:54:50 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* internal.h, class.c, eval.c, insns.def: find the appropriate 	  receiver
for super called in instance_eval.  If such a receiver is 	  not found,
raise NoMethodError. [ruby-dev:39772] [Bug #2402]</p>

<p>Mon Aug  6 14:54:38 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h, eval.c, vm_insnhelper.c: fix typo.</p>

<p>Mon Aug  6 13:13:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (vm_call_super): since cfp-&gt;klass is always class or 	 
iclass, no search from method entry.</p>

<p>* insns.def (defined): now should use klass in the current control 	 
frame to search superclass, not me-&gt;klass.  reported by naruse.</p>

<p>Mon Aug  6 11:19:19 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/etc/test_etc.rb (TestEtc#test_getpwuid): `s&#39; is never set to
nil.</p>

<p>Mon Aug  6 11:08:48 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/syslog/test_syslog_logger.rb: skip unless Syslog module is 	 
available.</p>

<p>Mon Aug  6 00:40:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigMath_s_log): fix format specifier.</p>

<p>Mon Aug  6 00:39:24 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (NUM2ULONG): optimize by inline as well as 	 
NUM2LONG, and cast to unsigned long explicitly for the platforms 	  where
SIZEOF_VALUE is larger than SIZEOF_LONG.</p>

<p>* include/ruby/ruby.h (NUM2SSIZET): fix type to cast.</p>

<p>Sun Aug  5 21:10:36 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c : if ENABLE_VM_OBJSPACE is 1, rest_sweep is not defined. 	  remove
unused declarations. [ruby-core:47004] [Bug #6837]</p>

<p>Sun Aug  5 19:31:57 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: just move functions and so on. I don&#39;t touch any internal 	 
implementation.</p>

<p>Sun Aug  5 13:22:29 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: use gcc-4.2 prior to clang, gcc, and cc if exist for 	 
the use of Snow Leopard&#39;s old clang. see also r36594, r36610, r36611.</p>

<p>Sun Aug  5 06:55:10 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_<code>core,strftime</code>.c: [ruby-core:46990].</p>

<p>Sat Aug  4 22:56:20 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: use inline functions instead of macros, and close up 	  related
codes for the profiler.</p>

<p>Sat Aug  4 20:37:56 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (gc_mark_children): use gc_mark_ptr instead of marking 	  a object
directly.</p>

<p>Sat Aug  4 10:02:03 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* test/ruby/test_alias.rb (test_super_in_aliased_module_method): 	  add a
test case for [ruby-dev:46028], which fails in 1.8.</p>

<p>Sat Aug  4 01:56:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_search_normal_superclass): no longer needs 	 
receiver, klass is always unique in the ancestors now.</p>

<p>Sat Aug  4 01:27:40 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* insns.def (invokesuper): reverted r36612 so that super in an 	  aliased
method will not call the same method.</p>

<p>Fri Aug  3 19:26:10 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* insns.def (invokesuper): don&#39;t skip the same class.  instead, use 	 
rb_method_entry_get_with_omod() to avoid infinite loop when 	  super is
used with refinements. [ruby-core:30450] [Bug #3351]</p>

<p>Fri Aug  3 19:21:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: use clang prior to gcc only when self-compiling on 	 
darwin.  search default compilers on other platforms.  [Bug #6816]</p>

<p>Fri Aug  3 17:25:49 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: move RUBY_MINGW32 after AC_PROG_CC. 	  RUBY_MINGW32 uses
AC_TRY_CPP and it sets CC and CPP. [Bug #6816]</p>

<p>* configure.in: don&#39;t use AC_PROG_CC in AS_CASE.</p>

<p>Fri Aug  3 17:21:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/runner.rb: get rid of loading previously installed gems. 	 
[ruby-dev:46025]</p>

<p>Fri Aug  3 16:40:01 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (notifications): [experimental] IRC notifications.</p>

<p>Thu Aug  2 20:32:29 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* eval.c (rb_mod_using): new method Module#using. [experimental]</p>

<p>* eval.c (rb_mod_refine): new method Module#refine. [experimental]</p>

<p>* eval.c (f_using): new method Kernel#using. [experimental]</p>

<p>Thu Aug  2 20:08:02 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* class.c, insns.def, method.h, proc.c, vm.c, vm_core.h, vm_eval.c, 	 
vm_insnhelper.c, vm_insnhelper.h, vm_method.c: add klass to 	 
rb_control_frame_t to implement super correctly.</p>

<p>Thu Aug  2 13:23:08 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (AC_PROG_CC): AC_PROG_CC tries clang at first on 	  darwin.
[Bug #6816]</p>

<p>Thu Aug  2 11:39:25 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: return true or false. Patch by Dirkjan Bussink. [Bug #6821]</p>

<p>* test/ruby/test_gc.rb: add test-case for this bug.</p>

<p>Thu Aug  2 10:51:12 2012  Martin Bosslet  &lt;Martin.Bosslet@gmail.com&gt;</p>

<p>* ext/openssl/lib/openssl/digest.rb 	  test/openssl/test_digest.rb: Add
Digest module function to OpenSSL 	  module and test it. Patch provided by
Eric Hodel. 	  [ruby-core:46908][Feature #6819]</p>

<p>Wed Aug  1 22:29:12 2012  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* ext/digest/digest.c (hexencode_str_new): return an ASCII string</p>

<p>* test/digest: tests for all kind of digests encodings 	 
[ruby-core:46792][Bug #6799]</p>

<p>Wed Aug  1 05:50:53 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_rubyoptions.rb (TestRubyOptions#test_encoding): 	  Fix
test_encoding failure on Windows. 	  With chcp 65001, 1252 and 437,
test_encoding failed. Test result 	  depends on locale because LANG
environment variable doesn&#39;t affect 	  locale on Windows. 	 
[ruby-core:46872] [Bug #6813]</p>

<p>Wed Aug  1 00:33:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (include_class_new): fix duplication of prepended module. 	 
since m_tbl of prepended module is always zero, copy from its 	  copy
iclass of original.</p>

<p>Tue Jul 31 18:22:34 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (classname): tell if found name is permanent.  search 	 
tmp_classpath only if class id is set.  [ruby-core:42865][Bug #6078]</p>

<p>* variable.c (rb_class_path): duplicate found temporary path.</p>

<p>* variable.c (rb_set_class_path_string, rb_set_class_path): set class 	 
id to find classpath.</p>

<p>Tue Jul 31 10:36:12 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: updated to released version.</p>

<p>* ext/psych/psych.gemspec: ditto</p>

<p>Tue Jul 31 06:18:06 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* time.c (time_sec):  Remove extra wording about leap seconds and refer 	 
directly to Wikipedia&#39;s leap second page for further information. 	 
[Bug #6749]</p>

<p>Mon Jul 30 23:01:47 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rubygems/platform.rb (Gem::Platform#initialize): Support pattern 	 
like x86_64-netbsd6.99.7.</p>

<p>Mon Jul 30 21:00:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (find_class_path): no retry when preferred is given.</p>

<p>* variable.c (classname): if classid is set try it to find full 	 
qualified class path, and then try arbitrary class path.  try 	 
tmp_classpath at last even if enclosing namespace is anonymous. 	  fix
r36574.  [ruby-core:42865][Bug #6078]</p>

<p>* variable.c (rb_set_class_path_string, rb_set_class_path): set 	 
tmp_classpath instead of classpath if the name is not permanent.</p>

<p>Mon Jul 30 14:24:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c: store anonymous class path in tmp_classpath but not in 	 
classpath.  [ruby-core:42865][Bug #6078]</p>

<p>Mon Jul 30 13:11:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (DLDFLAGS): on Darwin, deprecate -flat_namespace to get 	 
rid of huge imported symbols table.</p>

<p>* configure.in (LIBRUBY_RELATIVE): libruby_so is not made when 	 
disable-shared, so no absolute path is used for it and executable 	  file
is runnable anywhere.</p>

<p>Mon Jul 30 01:30:10 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* common.mk: add a dependency. [ruby-core:46741] [Bug #6789]</p>

<p>Sun Jul 29 15:44:47 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* thread.c (thread_create_core): hide th-&gt;async_errinfo_mask_stack from
	  ObjectSpace.each_object. refix of r36539.</p>

<p>Sun Jul 29 23:57:27 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/option.c (inet_ntop): use rb_w32_inet_ntop, instead of 	 
inet_ntop directly, which is unavailable on older version Windows.</p>

<p>* win32/win32.c (rb_w32_inet_ntop): type should be const.</p>

<p>Sun Jul 29 14:20:34 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* thread.c (Init_Thread): does not need to set klass 	  explicitly.</p>

<p>Sun Jul 29 06:21:04 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* win32/win32.c: suppress warning redeclared on mingw64. 	  *_s functions
are declared if MINGW_HAS_SECURE_API is defined. 	  Follow up r36556.</p>

<p>Sun Jul 29 00:28:46 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: remove unused initialization.</p>

<p>Sat Jul 28 16:26:09 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* win32/win32.c (gmtime_r): use _gmtime64_s() with x86_64-w64-mingw32.</p>

<p>* win32/win32.c (localtime_r): use _localtime64_s() with 	 
x86_64-w64-mingw32. Since FileTimeToSystemTime() seems not work with 	 
large value under x64. Mingw-w64 doesn&#39;t have these declaration. 	 
[ruby-core:46780] [Bug #6794]</p>

<p>Fri Jul 27 18:25:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_check_io): make public.</p>

<p>* process.c (check_exec_redirect): try conversion to IO on redirect 	 
parameters.  [ruby-core:44181] [Bug #6269]</p>

<p>Fri Jul 27 17:58:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_CPPOUTFILE): get rid of variable conflict so 	 
CPPFLAGS is not duplicated.  [ruby-core:43097] [Bug #6119]</p>

<p>Fri Jul 27 12:12:36 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/mkexports.rb: should not export DllMain(). 	  reported by luis at
[ruby-core:46743] [Bug #6790], solved by 	  Heesob Park, and confirmed by
nobu.</p>

<p>Thu Jul 26 14:51:29 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* test/net/http/test_https.rb (TestNetHTTPS#test_session_reuse): 	 
localhost is not (always) 127.0.0.1.  Don&#39;t expect that.</p>

<p>Thu Jul 26 07:18:38 2012    &lt;kanemoto@ruby-lang.org&gt;</p>

<p>* ext/json/fbuffer/fbuffer.h: avoid compilation error on AIX by 	   -ansi
-std=iso9899:199409 (r36038). [ruby-core:46744] [Bug #6791].</p>

<p>Thu Jul 26 00:42:23 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* thread.c (thread_create_core, Init_Thread): hide 	 
th-&gt;async_errinfo_queue and th-&gt;async_errinfo_mask_stack from 	 
ObjectSpace.each_object.</p>

<p>Wed Jul 25 17:41:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* complex.c, rational.c: compatible marshal loader for compatibilities 	 
with 1.8.  [ruby-core:45775] [Bug #6625]</p>

<p>Wed Jul 25 17:17:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* atomic.h: prefer GCC atomic builtins than Windows APIs, if possible, 	 
since they are generic.</p>

<p>Wed Jul 25 11:16:57 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/.document:  Removed.  All files in net/ should be included in 	 
RDoc.</p>

<p>Wed Jul 25 10:00:23 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/testunit/test_redefinition.rb: broken class/method names.</p>

<p>Wed Jul 25 09:26:32 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/cgi/html.rb: Use &lt;&lt; instead of <tt>=. 	  `a </tt>= b` is syntax sugar
of `a = a + b`; it creates a new string 	  object. `a &lt;&lt; b` is
concatenation and doesn&#39;t create new object.</p>

<p>Wed Jul 25 09:16:26 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/cgi/html.rb (element_init): suppress redefine warning. 	  Don&#39;t
define methods if they are already defined.</p>

<p>Wed Jul 25 09:05:38 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Added SSL session reuse across connections for a 	 
single instance to speed up connection.  [Feature #5341] 	* NEWS:  ditto 	*
test/net/http/test_https.rb:  Tests for #5341</p>

<p>Wed Jul 25 06:54:24 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/re.rdoc:  Fix spelling</p>

<p>Wed Jul 25 06:49:12 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* re.c (rb_reg_s_last_match):  Update $~ to reference Regexp 	 
documentation about “special global variables”.  [Bug #6723]</p>

<p>Wed Jul 25 06:28:56 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* iseq.c:  Added documentation.  Patch by David Albert.  [Bug #6785]</p>

<p>Wed Jul 25 03:05:06 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* parse.y: added symbols and qsymbols productions for %i and %I 	 
support. %i{ .. } returns a list of symbols without interpolation, 	  %I{
.. } returns a list of symbols with interpolation.  Thanks to 	  Josh
Susser for inspiration of this feature. [Feature #4985]</p>

<p>* ext/ripper/eventids2.c: added ripper events for %i and %I.</p>

<p>* test/ripper/test_parser_events.rb: ripper tests</p>

<p>* test/ripper/test_scanner_events.rb: ditto</p>

<p>* test/ruby/test_array.rb: test for %i and %I behavior</p>

<p>Tue Jul 24 23:34:43 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* include/ruby/win32.h (rb_w32_pow): add new function. 	  We use powl()
instead of broken pow() for x64-mingw32. This workaround 	  fixes test
failures related to floating point numeric. 	  [ruby-core:46686] [Bug
#6784]</p>

<p>Tue Jul 24 15:01:24 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_socket, rb_w32_socketpair): remember the family 	 
in the high word of socklist value.</p>

<p>* win32/win32.c (overlapped_socket_io, recvmsg, sendmsg, setfl): follow 	 
above changes.</p>

<p>* win32/win32.c (rb_w32_getsockname): set remembered family to the 	 
argument when OS&#39;s function fails.</p>

<p>Tue Jul 24 12:35:13 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_dir_m17n.rb: remove a garbage.</p>

<p>* test/ruby/test_dir_m17n.rb: convert from ascii-8bit to other encoding 	 
with 8bit bytes always fails.</p>

<p>Tue Jul 24 12:32:18 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_dir_m17n.rb: sorry, typo.</p>

<p>Tue Jul 24 12:13:26 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_dir_m17n.rb: refactoring. RE should be in the left side 	
of the =~ operator, and compare the result with nil is meaningless.</p>

<p>Tue Jul 24 11:35:20 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_pack.rb (test_pack_unpack_M): was redefined 	 
accidentally.</p>

<p>Tue Jul 24 09:31:18 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Updated to RubyGems 1.8.24, a bugfix release.</p>

<p>Tue Jul 24 08:30:15 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* test/ruby/test_dir_m17n.rb (create_and_check_raw_file_name): add new 	 
helper method to ease encoding testing. Patch by Oleg Sukhodolsky. 	 
[ruby-core:46589][Bug #6765]</p>

<p>* test/ruby/test_dir_m17n.rb (test_filename_extutf8): use filesystem 	 
encoding when reading entries and comparing.</p>

<p>* test/ruby/test_dir_m17n.rb (test_filename_utf8_raw_name): removed.</p>

<p>* test/ruby/test_dir_m17n.rb (test_filename_utf8_raw_jp_name): split test.</p>

<p>Tue Jul 24 08:09:30 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* test/win32ole/test_win32ole_method.rb (is_ruby64?): Correct platform 	 
used to identify mingw-w64 (x64-mingw32). Patch by Hiroshi Shirosaki. 	 
[ruby-core:46651][Bug #6782]</p>

<p>Tue Jul 24 07:22:58 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* time.c (time_sec):  Updated description of leap seconds for accuracy. 	 
Based on patch by Marcus Stollsteimer.  [Bug #6749]</p>

<p>Tue Jul 24 07:03:11 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* string.c (rb_str_sub):  Fixed wording of documentation to match the 	 
replacement operation.  Minor cleanup of markup.  [Bug #6719] 	* string.c
(rb_str_sub_bang):  Minor wording change for clarity, minor 	  cleanup of
markup.</p>

<p>Mon Jul 23 23:58:40 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/Makefile.in (TARGET_NAME, TARGET_ENTRY): needed for EXTDLDFLAGS 	 
on some platforms.  [ruby-core:46600] [Bug #6768]</p>

<p>* enc/depend: no longer needs tweaking DLDFLAGS for TARGET names.</p>

<p>Mon Jul 23 22:48:19 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/open-uri.rb: use respond_to? to test Tempfile. 	  [ruby-dev:45995]
[Bug #6781] reported by hsbt (Hiroshi SHIBATA).</p>

<p>Mon Jul 23 14:43:34 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (LIBPATHENV): LIBPATH is used on AIX, but not 	  SHLIB_PATH
which was carelessly copied from HP/UX.  suggested by 	  Perry Smith at
[ruby-core:46397].  [Bug #6728]</p>

<p>Mon Jul 23 01:55:08 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/uri/test_generic.rb (URI#test_find_proxy): add tests with 	  empty
*_proxy env variables.</p>

<p>Mon Jul 23 01:47:26 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/uri/test_generic.rb (URI#with_env): unset proxy related env 	 
variables.  [Bug #6774]</p>

<p>* test/uri/test_generic.rb (URI#test_find_proxy): fix failures 	  when
proxy related env variables already set.  [Bug #6774]</p>

<p>Sun Jul 22 23:58:48 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (rb_threadptr_execute_interrupts_common): increase 	 
running_time_us on THREAD_TO_KILL like on THREAD_RUNNABLE. 	  This cause
not to switch from a thread which is to be killed 	  on FreeBSD and Mac OS
X. see also the test. 	  This issue maybe exist for long time but happens
after r36430.</p>

<p>Sat Jul 21 06:21:45 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb: fixes for r36476. [Feature #6546] 	 <a
href="http://u64.rubyci.org/~chkbuild/ruby-trunk/log/20120720T030101Z.diff.html.gz">u64.rubyci.org/~chkbuild/ruby-trunk/log/20120720T030101Z.diff.html.gz</a></p>

<p>* lib/net/http.rb (Net::HTTP.newobj): return back for compatibility.</p>

<p>* lib/net/http.rb (Net::HTTP.new): set default_port if proxy port is 	 
not given.</p>

<p>* lib/net/http.rb (Net::HTTP#initialize): ditto.</p>

<p>* lib/net/http.rb (Net::HTTP#proxy?): return true or false.</p>

<p>* lib/net/http.rb (Net::HTTP#proxy_address): check proxy_uri is not nil.</p>

<p>* lib/net/http.rb (Net::HTTP#proxy_port): ditto.</p>

<p>Sat Jul 21 23:12:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): STACK_GROW_DIR_DETECTION is 	 
necessary on platforms with unknown stack direction.  [Bug #6761]</p>

<p>Sat Jul 21 15:13:42 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit/testcase.rb (method_added): refactoring.</p>

<p>Sat Jul 21 14:06:41 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit/testcase.rb: warn when test_* method is redefined. 	 
Patch by mame (Yusuke Endoh). [Feature #2643] [ruby-core:27790]</p>

<p>* test/testunit/test_redefinition.rb: Test for above.</p>

<p>* test/testunit/test4test_redefinition.rb: Ditto.</p>

<p>Sat Jul 21 08:41:14 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/logger.rb:  Updated example in Logger comment to match other 	 
examples and fixed a bug.  Patch by Marcus Stollsteimer. 	  [Bug #6759]</p>

<p>Fri Jul 20 17:20:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (rb_random_real): refine error message.</p>

<p>Fri Jul 20 11:03:17 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* NEWS:  Updated net/http for automatic proxy detection (#6546) and 	 
automatic gzip and deflate compression (#6492, #6494).</p>

<p>Fri Jul 20 10:55:38 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Net::HTTP now automatically detects and uses 	 
proxies from the environment.  A proxy may also be specified as 	  before.</p>

<p>Net::HTTP::Proxy still creates anonymous classes, but these classes 	 
are only used to store configuration information.  When an HTTP 	  instance
is created the configuration is now copied.</p>

<p>Additionally, Net::HTTP::ProxyDelta is no longer used by Net::HTTP</p>

<p>[Feature #6546] 	* lib/open-uri.rb:  Moved URI::Generic#find_proxy to
uri/generic. 	* lib/uri/generic.rb:  Imported find_proxy from open-uri. 	*
test/open-uri/test_open-uri.rb:  Moved proxy-discovery tests to URI. 	*
test/uri/test_generic.rb:  Imported proxy-discovery tests from 	  open-uri.
	* test/net/http/test_http.rb:  Added tests for proxy behavior.</p>

<p>Fri Jul 20 09:34:11 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/socket/test_socket.rb:  Ignore IPv6 unique local addresses on OS 	 
X (iCloud Back to my Mac addresses) for test_udp_socket since they do 	 
not act as loopback addresses.  [Bug #6692]</p>

<p>Fri Jul 20 09:32:14 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/socket/raddrinfo.c (addrinfo_ipv6_unique_local_p):  Added 	 
Addrinfo#ipv6_unique_local? to detect RFC 4193 unique local 	  addresses. 
Part of #6692 	* ext/socket/rubysocket.h:  Add IN6_IS_ADDR_UNIQUE_LOCAL
macro if 	  missing. 	* test/socket/test_addrinfo.rb:  Test for
ipv6_unique_local?</p>

<p>Fri Jul 20 07:40:32 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http/response.rb:  Automatically inflate gzip and 	 
deflate-encoded response bodies.  [Feature #6942] 	*
lib/net/http/generic_request.rb:  Automatically accept gzip and 	  deflate
content-encoding for requests.  [Feature #6494] 	* lib/net/http/request.rb:
Updated documentation for #6494. 	* lib/net/http.rb:  Updated documentation
for #6492 and #6494, removed 	  Content-Encoding handling now present in
Net::HTTPResponse. 	* test/net/http/test_httpresponse.rb:  Tests for #6492
	* test/net/http/test_http_request.rb:  Tests for #6494 	*
test/open-uri/test_open-uri.rb (test_content_encoding):  Updated test 	 
for automatic content-encoding handling.</p>

<p>Fri Jul 20 03:42:54 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread_pthread.c: use #ifdef, not #if.</p>

<p>Thu Jul 19 15:08:40 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_thread_s_control_interrupt, 	           
rb_thread_s_check_interrupt): added for 	  Thread.control_interrupt and
Thread.check_interrupt. 	  See details on rdoc. 	  I&#39;ll make an ticket
for this feature.</p>

<p>* test/ruby/test_thread.rb: add a test for Thread.control_interrupt.</p>

<p>* thread.c (rb_threadptr_raise): make a new exception object 	  even if
argc is 0.</p>

<p>* thread.c (rb_thread_kill): kill thread immediately if target thread 	 
is current thread.</p>

<p>* vm_core.h (RUBY_VM_CHECK_INTS_BLOCKING): added. 	  CHECK_INTS
while/after blocking operation.</p>

<p>* vm_core.h (RUBY_VM_CHECK_INTS): require rb_thread_t ptr.</p>

<p>* cont.c (fiber_switch): use replaced RUBY_VM_CHECK_INTS().</p>

<p>* eval.c (ruby_cleanup): ditto.</p>

<p>* insns.def: ditto.</p>

<p>* process.c (rb_waitpid): ditto.</p>

<p>* vm_eval.c (vm_call0): ditto.</p>

<p>* vm_insnhelper.c (vm_call_method): ditto.</p>

<p>Thu Jul 19 22:46:48 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_io.rb: remove temporally files early.</p>

<p>Thu Jul 19 15:38:35 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* variable.c (rb_mod_class_variables): return inherited variables 	 
except when the optional argument is set to false. 	  [ruby-dev:44034] [Bug
#4971]</p>

<p>* variable.c (rb_mod_constants): fix typo in documentation.</p>

<p>Thu Jul 19 14:30:43 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h: move mark function declarations that should be private.</p>

<p>Thu Jul 19 14:18:22 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/socket/init.c (rsock_init_sock): need to update max fd on all 	 
platforms.</p>

<p>Thu Jul 19 14:15:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_gc_mark_threads): remove deprecated function.</p>

<p>Thu Jul 19 13:28:03 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/net/http/test_http.rb (TestNetHTTPLocalBind#test_bind_to_local*): 	
re-enable the tests because now it&#39;s OK on windows.</p>

<p>Thu Jul 19 13:26:25 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/socket/extconf.rb: now enable IPv6 by default on mswin.</p>

<p>Thu Jul 19 09:33:46 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/emitter.c (initialize): allow a configuration object to be 	 
passed to the constructor so that mutation isn&#39;t required after 	 
instantiation.</p>

<p>* ext/psych/lib/psych/handler.rb: add configuration object</p>

<p>* ext/psych/lib/psych/visitors/emitter.rb: use configuration object if 	 
extra configuration is present.</p>

<p>Thu Jul 19 08:20:25 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_file.rb: remove temporally files early.</p>

<p>Thu Jul 19 07:37:41 2012  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* test/drb/drbtest.rb: fixed: can&#39;t delete unix domain sockets
problem.</p>

<p>Thu Jul 19 03:41:20 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* bignum.c: Added #include &lt;strings.h&gt; for ffs(). Patch by Perry 	 
Smith. Thank you. [Bug #6748]</p>

<p>Thu Jul 19 01:56:02 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/intern.h (rb_num_zerodiv): Added NORETURN. 	  Patched by Xi
Wang. [Bug #6736]</p>

<p>Wed Jul 18 23:57:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* pack.c (pack_pack): round down too long uuencode width.  folding 	 
width in uuencode format cannot be longer than 63 bytes.</p>

<p>Wed Jul 18 23:04:18 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/dbm/dbm.c (fdbm_empty_p): fix wrong condition introduced in r36438.</p>

<p>* ext/sdbm/init.c (fsdbm_empty_p): ditto.</p>

<p>Wed Jul 18 23:08:57 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_beginendblock.rb: remove temporally files early.</p>

<p>Wed Jul 18 22:43:02 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_autoload.rb: remove temporally files early.</p>

<p>Wed Jul 18 21:59:46 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_argf.rb: use temporally directory.</p>

<p>Wed Jul 18 19:41:19 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/openssl/test_config.rb: remove temporally files early.</p>

<p>Wed Jul 18 17:45:26 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_builtin_type_name): map by index.</p>

<p>Wed Jul 18 16:17:40 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (have_framework): get rid of separating -framework 	  option
and its argument and dealing with the argument as a library 	  or an object
name.  if $LDFLAGS were an array…</p>

<p>Wed Jul 18 16:09:10 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/curses/extconf.rb: support PDCurses.  patched by Luis Lavena. 	 
[ruby-core:46485] [Feature #6735]</p>

<p>Wed Jul 18 15:50:25 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* parse.y (primary): allow an empty grouped expression as the 	  operand
of the not operator (e.g., not ()). 	  [ruby-core:45976] [Bug #6674]</p>

<p>* parse.y (parser_yylex): show no warning for a grouped expression 	  as
the operand of the not operator (e.g., not (a)) or as an 	  argument of a
method call without parentheses (e.g., foo (a)). 	  [ruby-core:39050] [Bug
#5214]</p>

<p>Wed Jul 18 15:33:21 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_thread_call_without_gvl2): added. 	  it can skip last
CHECK_INTS.  See document for more details. 	  Document about it was
updated a bit.</p>

<p>* include/ruby/thread.h (decl. of rb_thread_call_without_gvl2): added.</p>

<p>* thread.c (rb_thread_call_with_gvl): remove “EXPERIMENTAL!” 	  warning
from a document.</p>

<p>Wed Jul 18 14:53:21 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (EXTDLDFLAGS): split options for each extension 	 
libraries, and unused in ruby.pc.  [Bug #6734]</p>

<p>* lib/mkmf.rb (MakeMakefile#configuration): add EXTDLDFLAGS.</p>

<p>Wed Jul 18 14:47:23 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c: fix last commit miss.</p>

<p>Wed Jul 18 14:16:51 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread.c (rb_threadptr_async_errinfo_*): manage async errors queue. 	 
Async events such as an exception throwed by Thread#raise, 	  Thread#kill
and thread termination (after main thread termination) 	  will be queued to
th-&gt;async_errinfo_queue. 	  - clear: clear the queue. 	  - enque: enque
err object into queue. 	  - deque: deque err object from queue. 	  -
active_p: return 1 if the queue should be checked. 	 
rb_thread_t#thrown_errinfo was removed.</p>

<p>* vm_core.h: add declarations of rb_threadptr_async_errinfo_*. 	  remove
rb_thread_t#thrown_errinfo field and 	  add rb_thread_t#async_errinfo_queue
(queue body: Array), 	      rb_thread_t#async_errinfo_queue_checked (flag),
	      rb_thread_t#async_errinfo_mask_stack(Array, not used yet).</p>

<p>* vm.c (rb_thread_mark): fix a mark function.</p>

<p>* cont.c (rb_fiber_start): enque an error.</p>

<p>* process.c (after_fork): clear async errinfo queue.</p>

<p>Wed Jul 18 14:25:55 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* pack.c: (ditto) bitwise operations are not char.  Apply explicit 	 
casts on them.</p>

<p>Wed Jul 18 12:59:50 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* encoding.c (load_encoding): explicit cast  to suppress  warning. 	 
Though the  cast truncates some bits, from  heuristic analysis I 	  believe
it is OK to do so here.</p>

<p>* bignum.c (rb_cstr_to_inum): ditto.</p>

<p>Wed Jul 18 12:55:54 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/benchmark.rb: Fix Benchmark.benchmark output with an empty 	 
caption.  patched by Benoit Daloze. [ruby-core:45719] [Bug #6610]</p>

<p>Wed Jul 18 10:00:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/debug.rb:  Added toplevel documentation.  Based on patch by Oscar 	 
Del Ben.  [Bug #6743], fixes #146 on github.</p>

<p>Wed Jul 18 09:33:59 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/win32ole/test_win32ole_event.rb (TestWIN32OLE_EVENT): use 	 
standard skip method to skip tests.</p>

<p>Wed Jul 18 09:26:45 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/logger.rb:  Updated typos and output to match modern Logger 	 
output.  Patch by Marcus Stollsteimer.  [Bug #6738]</p>

<p>Wed Jul 18 07:59:29 2012  Takeyuki FUJIOKA  &lt;xibbar@ruby-lang.org&gt;</p>

<p>* lib/cgi/util.rb (CGI.escapeHTML,unescapeHTML): Add &amp;apos; for HTML5
	  escaping. 	  [Feature #6620]</p>

<p>Tue Jul 17 22:17:13 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/open-uri.rb: call io.close! for Tempfile.</p>

<p>Tue Jul 17 16:41:32 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* proc.c (rb_proc_arity): return normal value (not -n-1) if it is not 	  a
labmda, or it is a labmda and no arg_opts. [Bug #5694]</p>

<p>Tue Jul 17 03:56:34 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: strings with YAML anchors 	 
are properly referenced. Patched by Joe Rafaniello via Github: 	    <a
href="https://github.com/tenderlove/psych/pull/69">github.com/tenderlove/psych/pull/69</a>
	* ext/psych/lib/psych/visitors/yaml_tree.rb: ditto 	*
test/psych/test_alias_and_anchor.rb: test for change</p>

<p>Mon Jul 16 23:20:24 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_integer_float_cmp): use FIXNUM_MIN and FIXNUM_MAX, 	 
instead of LONG_MIN and LONG_MAX.</p>

<p>Mon Jul 16 22:50:41 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (flo_to_s): use the exponential form if the integer part 	  is
longer than or equal DBL_DIG. 	  [ruby-dev:45960] [ruby-trunk - Bug #6741]</p>

<p>Mon Jul 16 22:01:00 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/readline/readline.c: fixed docs. [Bug #<a
href="ruby-core:46501">6740]</a> 	  patched by Nobuhiro IMAI.</p>

<p>Mon Jul 16 19:24:01 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_integer_float_eq): new function. 	  (rb_big_eq): use
rb_integer_float_eq.</p>

<p>* internal.h (rb_integer_float_eq): declared.</p>

<p>* numeric.c (flo_eq): use rb_integer_float_eq. 	  (fix_equal): ditto.</p>

<p>Mon Jul 16 19:02:31 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_integer_float_cmp): rename a local variable.</p>

<p>Mon Jul 16 18:40:26 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_integer_float_cmp): renamed from rb_big_float_cmp.</p>

<p>* internal.h: follow the above change.</p>

<p>* numeric.c: ditto.</p>

<p>Mon Jul 16 17:57:54 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_big_float_cmp): compare an integer and float precisely. 	 
[ruby-core:31376] [Bug #3589] reported by Tomasz Wegrzanowski.</p>

<p>Mon Jul 16 17:29:45 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_big_float_cmp): support fixnum for argument x.</p>

<p>* numeric.c (fix_equal): use rb_big_float_cmp. 	  (fix_cmp): ditto. 	 
(fix_gt): ditto. 	  (fix_ge): ditto. 	  (fix_lt): ditto. 	  (fix_le):
ditto. 	  (flo_eq): ditto. 	  (flo_cmp): use rb_big_float_cmp for fixnum
argument. 	  (flo_gt): ditto. 	  (flo_ge): ditto. 	  (flo_lt): ditto. 	 
(flo_le): ditto.</p>

<p>Mon Jul 16 17:05:53 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/fileutils/test_fileutils.rb: add test for FileUtils#uptodate?</p>

<p>Mon Jul 16 16:56:12 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/fileutils.rb (FileUtils.uptodate?): remove useless parameter. 	 
patched by Oscar Del Ben.[Bug #<a href="ruby-core:46256">6708]</a></p>

<p>Mon Jul 16 15:37:56 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_big_eq): use rb_big_float_cmp.</p>

<p>Mon Jul 16 15:00:45 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_big_float_cmp): declared.</p>

<p>* bignum.c (rb_big_float_cmp): extracted from rb_big_cmp and big_op. 	 
(rb_big_cmp): use rb_big_float_cmp. 	  (big_op): ditto.</p>

<p>* numeric.c (flo_cmp): use rb_big_float_cmp. 	  (flo_gt): ditto. 	 
(flo_ge): ditto. 	  (flo_lt): ditto. 	  (flo_le): ditto.</p>

<p>Mon Jul 16 14:14:21 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (enum big_op_t): new type. 	  (big_op): use enum big_op_t. 	 
(big_gt): ditto. 	  (big_ge): ditto. 	  (big_lt): ditto. 	  (big_le):
ditto.</p>

<p>Sat Jul 14 18:18:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (rb_get_values_at): fill with nil out of range. 	 
[ruby-core:43678] [Bug #6203]</p>

<p>Sat Jul 14 17:17:55 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* cont.c (cont_restore_0): improve docs. [Bug #<a
href="ruby-core:46243">6706]</a> 	  patched by Oscar Del Ben via <a
href="https://github.com/ruby/ruby/pull/140">github.com/ruby/ruby/pull/140</a></p>

<p>Sat Jul 14 17:08:13 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_hash_s_create): raise an exception, when input elements 	 
are not one or two elements arrays.  [ruby-core:39945] [Bug #5406]</p>

<p>Sat Jul 14 16:16:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_run_parallel): use 	  Array#uniq!.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#deal): deal tasks to workers.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#quit_workers): close and kill 	 
all workers.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#delete_worker): delete dead 	 
worker from working set.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#launch_worker): add new worker 	 
to working set.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#launch_worker): extract.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#start_watchdog): extract.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_run_parallel): move 	 
initializations with nothing to release outside begin/ensure.</p>

<p>Sat Jul 14 16:04:24 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_join): should not infected by separator if it is not 	 
used.  [ruby-core:42161][Bug #5902]</p>

<p>Sat Jul 14 02:31:55 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/intern.h (rb_thread_blocking_region): fix declarations 	 
prototypes without arguments in C++ have different meanings than C.</p>

<p>Thu Jul 12 12:32:26 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/runner.rb: skip default gems to get rid of loading old versions 	 
before installation.</p>

<p>Thu Jul 12 11:44:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_new_frozen): since the result object should have 	 
same tainted/untrusted bits with the original object, return new 	  object
if the shared object unmatch.  [ruby-core:39745][Bug #5374]</p>

<p>Thu Jul 12 10:46:39 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/net/http/test_http.rb (TestNetHTTPLocalBind#test_bind_to_local*): 	
cannot cross between network interfaces on Windows, so skip this test 	 
until we find better test.</p>

<p>Thu Jul 12 08:48:33 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 3.2.0 (r7598) 	* test/minitest/*:
ditto</p>

<p>Thu Jul 12 05:11:41 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* insns.def (defined): use method entry and id in cfp for proper 	 
superclass, since klass in iseq is shared by dynamically defined 	  methods
from the same block.  [ruby-core:45831][Bug #6644]</p>

<p>Thu Jul 12 01:49:07 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP#connect): use local_host and local_port 	  if
specified. patched by Ricardo Amorim [Feature #6617]</p>

<p>Wed Jul 11 17:36:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb: append ENCOBJS to DLDOBJS but not EXTSOLIBS which is 	 
not a target, to compile enc/encinit.c.</p>

<p>Wed Jul 11 12:38:20 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_pkey_ec.c (ossl_ec_point_mul): nonstatic initializer 	 
of an aggregate type is a C99ism.</p>

<p>* ext/openssl/ossl_pkey_ec.c (ossl_ec_point_mul): get rid of VC++ 	 
warnings.</p>

<p>Mon Jul  9 16:11:30 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* vm_eval.c (rb_eval_string_from_file, 	 
rb_eval_string_from_file_protect): new functions to replace 	 
rb_compile_main_from_string() and ruby_eval_main().</p>

<p>* nacl/pepper_ruby.c: Follows the change in vm_eval.c</p>

<p>Mon Jul  9 14:05:42 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>Reverts a half of r36079. As we discussed on ruby-dev@ and IRC, 	we do not
need to disclose intermediate representation of program. 	The program
embedding CRuby should use rb_eval_string family. 	* include/ruby/ruby.h
(ruby_opaque_t): removed. 	  (ruby_compile_main_from_file,
ruby_compile_main_from_string, 	   ruby_eval_main): removed.</p>

<p>* eval.c (ruby_eval_main_internal): became ruby_exec_internal() again. 	 
(ruby_eval_main): removed.</p>

<p>* ruby.c (PREPARE_PARSE_MAIN) reverted. 	  (parse_and_compile_main,
ruby_compile_main_from_file, 	   ruby_compile_main_from_string): removed</p>

<p>Wed Jul 11 10:16:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby.h (HAVE_RUBY_THREAD_H): to show ruby/thread.h to be 	 
available.  fixup of r36355.</p>

<p>Wed Jul 11 03:26:47 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c:  Added streaming support to inflate processing. 	  This
allows zlib streams to be processed without huge memory growth. 	  [Feature
#6612] 	* NEWS:  ditto 	* ext/zlib/zlib.c (zstream_expand_buffer):  Uses
rb_yield when a block 	  is given for streaming support.  Refactored to use
	  zstream_expand_buffer_into to remove duplicate code. 	* ext/zlib/zlib.c
(zstream_expand_buffer_protect):  Added wrapper 	  function to pass jump
state back through GVL-free section to allow 	  zstream clean-up before
terminating the ruby call. 	* ext/zlib/zlib.c
(zstream_expand_buffer_without_gvl):  Acquire GVL to 	  yield processed
chunk of output stream. 	* ext/zlib/zlib.c (zstream_detach_buffer):  When a
block is given, 	  returns Qnil mid-stream and yields the output buffer at
the end of 	  the stream. 	* test/zlib/test_zlib.rb:  Updated tests</p>

<p>Tue Jul 10 22:57:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/thread.h: new header file for thread stuff.</p>

<p>* thread.c (rb_thread_call_without_gvl): export.  [Feature#4328] 	 
returns void* instead of VALUE.  [Feature #5543]</p>

<p>* thread.c (rb_thread_blocking_region): deprecate.  [ruby-core:46295]</p>

<p>Tue Jul 10 10:48:59 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/win32.h (NT, NtInitialize): removed unused old macros.</p>

<p>Tue Jul 10 10:43:37 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* configure.in: removed –enable/disable-win95 options. (see r36342)</p>

<p>Tue Jul 10 00:44:41 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/ruby.h: Removed RUBY_GLOBAL_SETUP completely. It is 	  no
meaning definition since r24894. 	* main.c: ditto. 	* nacl/pepper_main.c:
ditto.</p>

<p>Mon Jul  9 23:59:36 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* dln.c: Simplify and make consistent an ifdef for Mac OS X. 	*
ext/socket/rubysocket.h: ditto. 	* ext/tk/stubs.c: ditto. 	* io.c: ditto.
	* process.c: ditto. 	* signal.c: ditto. 	* vm_dump.c: ditto.</p>

<p>Mon Jul  9 17:37:35 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (win95_stat): removed unnecessary macro.</p>

<p>Mon Jul  9 17:22:16 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/configure.bat, win32/setup.mak, win32/Makefile.sub: omitted 	 
Win9x support.  removed –enable/disable-win95 options.</p>

<p>* include/ruby/win32.h, file.c, win32/win32.c: ditto.</p>

<p>* win32/README.win32: ditto.</p>

<p>Mon Jul  9 13:28:34 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (DLDFLAGS): use TARGET_ENTRY to specify an entry point 	 
instead of TARGET which may contain non-identifier characters.</p>

<p>* lib/mkmf.rb (create_makefile): add TARGET_NAME which is the first 	 
part consists of only word characters.  [ruby-core:46248][Bug #6709]</p>

<p>Sun Jul  8 07:36:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (shadowing_lvar_gen, warn_unused_var): no warnings for 	 
variables starting with _.  [ruby-core:46160][Feature #6693]</p>

<p>Sat Jul  7 23:07:30 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* test/csv/test_features.rb: add require for Tempfile. 	*
test/csv/test_serialization.rb: ditto.</p>

<p>Fri Jul  6 06:49:50 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c (rb_ary_aref):  Added a description of the behavior of 	  index
positioning.  [Bug #6680] 	* array.c (rb_ary_aset):  ditto.  Reordered
sentences for clarity. 	* string.c (rb_str_aref_m):  Added a description of
the behavior of 	  index positioning</p>

<p>Fri Jul  6 05:38:44 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* string.c (rb_str_bytesize):  Improve documentation.  Patch by Oscar 	 
Del Ben from github issue #138. 	* string.c (rb_str_empty):  ditto. 	*
string.c (rb_str_times):  ditto. 	* string.c (rb_str_dump):  ditto. 	*
string.c (rb_str_center):  ditto.</p>

<p>Fri Jul  6 04:05:59 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (zstream_expand_buffer_without_gvl):  Use 	 
ruby_xrealloc() to avoid crash with CALC_EXACT_MALLOC_SIZE.</p>

<p>Thu Jul  5 17:32:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h: move ThreadShield declarations from intern.h.</p>

<p>Thu Jul  5 16:00:24 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (ThreadShield): rename from Barrier.</p>

<p>Thu Jul  5 15:14:50 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bootstraptest/runner.rb (show_progress): refine error output. do not 	 
count non-empty error message, but just warn.</p>

<p>* bootstraptest/runner.rb (error): show errors immediately if tty.</p>

<p>Thu Jul  5 12:28:11 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* test/net/http/test_httpresponses.rb: Add a test file for 	 
Net::HTTPResponses and put a test case for the previous bug.</p>

<p>Thu Jul  5 06:33:52 2012  Mark Dodwell &lt;mark@mkdynamic.co.uk&gt;</p>

<p>* lib/net/http/responses.rb: Fix 4xx classes to inherit correctly 	  from
Net::HTTPClientError. [Bug #6700]</p>

<p>Wed Jul  4 21:55:35 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ruby.c (proc_options): warn only if -K and -w option is specified. 	 
see also r36274 [Feature #5206]</p>

<p>Wed Jul  4 21:41:44 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* gc.c, atomic.h (ATOMIC_SIZE_*): moved from gc.c to atomic.h 	 
[ruby-dev:45909]</p>

<p>Wed Jul  4 19:13:15 2012  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* test/win32ole/test_win32ole.rb (test_s_codepage_changed): 	 
FileSystemObject only supports ANSI or UTF-16LE encoding. 	  Patch by
h.shirosaki (Hiroshi Shirosaki) [ruby-trunk - Bug #6650]</p>

<p>Wed Jul  4 11:52:12 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* gc.c (ATOMIC_SIZE_*): 64bit Windows support.</p>

<p>Wed Jul  4 11:11:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (rb_frame_callee, rb_f_callee_name): fix to return the 	  called
id.  this longstanding bug has been caused and blocked by 	  the structure
of old rb_control_frame_t and rb_iseq_t.</p>

<p>* vm_insnhelper.c (vm_push_frame): set proper method entry.</p>

<p>Wed Jul  4 08:29:31 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c (rb_ary_aref):  Updated documentation to indicate the 	 
starting index is an index into the array or string.  Updated 	  examples
to show behavior of indexes at the end of an array or 	  string.  Based on
patch by Marcus Stollsteimer.  [Bug #6680] 	* array.c (rb_ary_aset): 
ditto. 	* string.c (rb_str_aref):  ditto.  Also added descriptive argument
	  names to call-seq section.</p>

<p>Wed Jul  4 07:05:59 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/zlib/test_zlib.rb (test_inflate_partial_input):  Added test for 	 
inflating incomplete zlib streams.</p>

<p>Tue Jul  3 23:14:16 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* gc.c (ATOMIC_SIZE_EXCHANGE): fix function name on Solaris [Bug #6689] 	 
[ruby-dev:45904]</p>

<p>Tue Jul  3 16:07:49 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (vm_malloc_fixup, vm_xrealloc, vm_xfree, after_gc_sweep): use 	 
atomic operations to update malloc_params.</p>

<p>Tue Jul  3 14:50:16 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (zstream_run_func):  Don&#39;t exit run loop for buffer
	  error.  [Feature #6615] 	* ext/zlib/zlib.c:  Fix style to match existing
functions.</p>

<p>Tue Jul  3 12:05:51 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/dl/cfunc.c (rb_dlcfunc_call): also needed the workaround for VC8 	 
for x64.  [ruby-dev:45875] [Bug #6676] 	  reported by aves_ramphastos
(Seigo Ishigane)</p>

<p>Tue Jul  3 11:56:46 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (zstream_detach_buffer):  Refactored tainting of 	 
output string, moving it from the callee to zstream_detach_buffer. 	*
ext/zlib/zlib.c (rb_zstream_finish):  ditto 	* ext/zlib/zlib.c
(rb_zstream_flush_next_out):  ditto 	* ext/zlib/zlib.c
(rb_deflate_deflate):  ditto 	* ext/zlib/zlib.c (rb_deflate_flush):  ditto
	* ext/zlib/zlib.c (rb_inflate_inflate):  ditto</p>

<p>Tue Jul  3 11:16:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (runnable): make symbolic links to run in build directory.</p>

<p>Tue Jul  3 10:46:06 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ruby.c (proc_options): warn if -K option is specified. [Feature #5206]</p>

<p>Tue Jul  3 06:12:13 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c (Init_Object):  Added RDoc location pointers for 	 
Kernel#methods, Kernel#protected_methods, Kernel#private_methods and 	 
Kernel#public_methods.  [Bug #6666]</p>

<p>Tue Jul  3 06:02:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (zstream_run):  Process zlib streams without GVL. 	 
[Feature #6615] 	* NEWS:  ditto.</p>

<p>Mon Jul  2 22:13:04 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* thread.c (rb_thread_aref): add explanation for why Thread#[] and 	 
Thread#[]= are fiber-local and not thread-local. 	  reported by Julien A. 
[ruby-core:41606] [ruby-trunk - Bug #5750]</p>

<p>Mon Jul  2 21:25:55 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* time.c (timew_out_of_timet_range): specialization for 	  SIZEOF_TIME_T
== SIZEOF_INT64_T.</p>

<p>Mon Jul  2 17:06:32 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_include_module): include modules after the origin.</p>

<p>* class.c (include_modules_at): skip prepended modules.</p>

<p>* class.c (rb_prepend_module): now basic.klass in ICLASS refers the 	  old
original class/module.  [ruby-dev:45868][Bug #6662]</p>

<p>* class.c (rb_mod_ancestors): ditto.</p>

<p>* vm_method.c (search_method): search method entry from the origin 	 
iclass.</p>

<p>Mon Jul  2 05:54:58 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: [ruby-core:46058].</p>

<p>Mon Jul  2 05:35:43 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c (d_lite_marshal_load): accepts old dump.</p>

<p>Mon Jul  2 03:21:53 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* README.EXT.ja: fixed args of have_struct_member() , 	  create_makefile()
same as r35977. however, mkmf.rb include 	  no Japanese-docs, so Appendix C
was not removed. [Bug #6597]</p>

<p>Fri Jun 29 05:08:41 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/test/unit/parallel.rb: workaround fix for rubygems. 	  RubyGems
can&#39;t find rake if the source directory is not equal to 	  the
directory which is running the test. [Bug #6604]</p>

<p>Thu Jun 28 20:33:15 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* test/win32ole/test_win32ole.rb (test_s_codepage_changed): 	 
FileSystemObject only supports ANSI or UTF-16LE encoding. 	  Patch by bosko
(Bosko Ivanisevic) [ruby-trunk - Bug #6650]</p>

<p>Thu Jun 28 09:27:09 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* class.c (class_instance_method_list): consider prepended Class/Module 	 
when recur != 0. [ruby-dev:45863] [Bug #6660]</p>

<p>* test/ruby/test_module.rb (test_prepend_instance_methods_false): add 	  a
test for it.</p>

<p>Thu Jun 28 06:12:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_mod_ancestors): fix ancestors order. 	 
[ruby-core:45919][Bug #6658] [ruby-dev:45861][Bug #6659]</p>

<p>Wed Jun 27 21:28:59 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* lib/racc/parser.rb: NotImplementError is not exist.</p>

<p>* lib/irb/output-method.rb (IRB::OutputMethod#print): ditto.</p>

<p>Wed Jun 27 21:31:13 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_prepend_module): ancestors of prepending module also 	 
should be included.  [ruby-core:45914][Bug #6654]</p>

<p>Wed Jun 27 21:01:32 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (class_instance_method_list): m_tbl in prepended 	  class/module
is NULL.  [ruby-core:45915][Bug #6655]</p>

<p>Wed Jun 27 16:48:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_prepend_module): prepend module into another module.</p>

<p>* eval.c (rb_mod_prepend): new method Module#prepend.  [Feature #1102]</p>

<p>Wed Jun 27 09:15:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (is_popen_fork): check if fork and raise NotImplementedError if 	 
unavailable.</p>

<p>* io.c (rb_io_s_popen): allow environment variables hash and exec 	 
options as flat parameters, not in an array arguments. 	  [Feature#6651]
[EXPERIMENTAL]</p>

<p>* process.c (rb_execarg_extract_options): extract exec options, but no 	 
exceptions on non-exec options and returns them as a Hash.</p>

<p>* process.c (rb_execarg_setenv): set environment variables.</p>

<p>Tue Jun 26 16:57:14 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* thread_pthread.c (register_cached_thread_and_wait): 	  return
immediately if malloc() failed. 	  [ruby-core:43960] [ruby-trunk - Bug
#6235]</p>

<p>* thread_pthread.c (USE_THREAD_CACHE): check already defined or not.</p>

<p>Tue Jun 26 10:01:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_s_popen): revert r36213 “popen: shell commands with 	 
envvar” because it disabled to let single command bypass shell.</p>

<p>Mon Jun 25 17:49:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_mix_module): revert Module#mix.</p>

<p>Mon Jun 25 16:57:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (rb_mod_define_method): allow method transplanting from a 	 
module to either class or module.  [ruby-core:34267][Feature #4254]</p>

<p>Mon Jun 25 11:34:45 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* internal.h: use rb_pid_t instead of pid_t because of there is no 	 
definition of pid_t here on Windows.</p>

<p>Mon Jun 25 00:25:01 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in (for stack end address): remove human68k specific 	  check.
It is no longer supported.</p>

<p>Sun Jun 24 23:02:17 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (pipe_open): merge win32 code using spawnv().</p>

<p>Sun Jun 24 22:53:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (check_exec_fds): separate check_exec_fds_1() since 	 
nonstatic initializer of an aggregate type is not allowed by C89.</p>

<p>Sun Jun 24 07:47:17 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): options field removed.</p>

<p>* process.c: follow the rb_execarg change.</p>

<p>Sat Jun 23 23:48:21 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (proc_spawn_cmd): unused variable removed to suppress a 	 
warning. 	  (save_env): ditto.</p>

<p>[ruby-core:45797] reported by Luis Lavena.</p>

<p>Sat Jun 23 23:19:31 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add new_pgroup_given and new_pgroup_flag 	 
fields.</p>

<p>* process.c (EXEC_OPTION_NEW_PGROUP): removed. 	  (proc_spawn_cmd): take a
struct rb_execarg argument. 	  use the new fields. 	  (rb_execarg_addopt):
use the new fields. 	  (rb_spawn_process): follow the proc_spawn_cmd
change.</p>

<p>[ruby-core:45794] [ruby-trunk - Bug #6633] reported by Luis Lavena.</p>

<p>Sat Jun 23 20:26:36 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add fd_dup2, fd_close, fd_open, 	 
fd_dup2_child fields.</p>

<p>* process.c (EXEC_OPTION_DUP2): removed. 	  (EXEC_OPTION_CLOSE): removed.
	  (EXEC_OPTION_OPEN): removed. 	  (EXEC_OPTION_DUP2_CHILD): removed. 	 
(mark_exec_arg): mark the new fields. 	  (check_exec_redirect1): change
condition for default option. 	  (check_exec_redirect): take a struct
rb_execarg argument. 	  use the new fields. 	  (rb_execarg_addopt): follow
the check_exec_redirect change. 	  (check_exec_fds): use the new fields. 	 
(save_redirect_fd): ditto.</p>

<p>Sat Jun 23 19:01:18 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_execarg_fixup): fix envopts condition.</p>

<p>Sat Jun 23 18:44:13 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (check_exec_redirect1): extracted from 	  check_exec_redirect.</p>

<p>Sat Jun 23 17:22:02 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (save_env): don&#39;t use EXEC_OPTION_UNSETENV_OTHERS. 	 
(rb_execarg_run_options): ditto.</p>

<p>Sat Jun 23 17:04:08 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add env_modification field.</p>

<p>* process.c (EXEC_OPTION_ENV): removed. 	  (mark_exec_arg): mark
env_modification field. 	  (rb_exec_fillarg): update the new field, instead
of options array. 	  (rb_execarg_fixup): use the new field. 	  (save_env):
ditto. 	  (rb_execarg_run_options): ditto.</p>

<p>Sat Jun 23 16:27:01 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add rlimit_limits field.</p>

<p>* process.c (EXEC_OPTION_RLIMIT): removed. 	  (mark_exec_arg): mark
rlimit_limits field. 	  (rb_execarg_addopt): update the new fields, instead
of options array. 	  (run_exec_rlimit): use the new field. 	 
(rb_execarg_run_options): clear sarg using MEMZERO.  use the new 	  field.</p>

<p>Sat Jun 23 14:29:25 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add chdir_given and chdir_dir fields.</p>

<p>* process.c (EXEC_OPTION_CHDIR): removed. 	  (mark_exec_arg): mark
chdir_dir field. 	  (rb_execarg_addopt): update the new fields, instead of
options array. 	  (rb_execarg_run_options): use the new fields.</p>

<p>Sat Jun 23 13:20:47 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add close_others_given, close_others_do and 	 
close_others_maxhint fields.</p>

<p>* process.c (EXEC_OPTION_CLOSE_OTHERS): removed. 	  (rb_execarg_addopt):
update the new fields, instead of options array. 	  (check_exec_fds): take
eargp as an argument.  update the 	  close_others_maxhint field. 	 
(rb_execarg_fixup): follow the argument change of check_exec_fds. 	 
(rb_execarg_run_options): use the new fields.</p>

<p>Sat Jun 23 10:41:59 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add unsetenv_others_given and 	 
unsetenv_others_do fields.</p>

<p>* process.c (EXEC_OPTION_UNSETENV_OTHERS): removed. 	 
(rb_execarg_addopt): update the new fields, instead of options array. 	 
(rb_execarg_fixup): use the new fields.</p>

<p>Sat Jun 23 09:35:47 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: use the variable name “soptions” for sargp-&gt;options.</p>

<p>Sat Jun 23 09:17:49 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: use the name “sargp” for struct rb_execarg variables 	 
consistently for saving process attributes.</p>

<p>* io.c: ditto.</p>

<p>Sat Jun 23 07:59:57 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: use the name “eargp” for struct rb_execarg variables 	 
consistently except for saving process attributes.</p>

<p>* io.c: ditto.</p>

<p>* ext/pty/pty.c: ditto.</p>

<p>Wed Jun 20 18:27:03 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* common.mk: Add missing dependencies.</p>

<p>Fri Jun 22 20:27:39 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg): add pgroup_given and pgroup_pgid fields.</p>

<p>* process.c (EXEC_OPTION_PGROUP): removed. 	  (rb_execarg_addopt): update
the new fields, instead of options array. 	  (run_exec_pgroup): take a
struct rb_execarg argument.  refer the new 	  fields. 	 
(rb_execarg_run_options): follow run_exec_pgroup change.</p>

<p>Fri Jun 22 18:48:51 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* README.EXT, README.EXT.ja: use “sval” for the third argument 	  name of
Data_Wrap_Struct(). 	  Suggested by @satoh_fumiyasu. Thanks!!!</p>

<p>Fri Jun 22 18:04:26 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c, vm_eval.c: set th-&gt;base_block properly. 	  th-&gt;base_block
is information for (a) parsing, (b) compiling 	  and © setting up the frame
to execute the program passed by 	  `eval&#39; method.  For example, (1)
parser need to know up-level 	  variables to detect it is variable or
method without paren. 	  Befor (a), (b) and ©, VM set th-&gt;base_block by
passed bindng 	  (or previous frame information).  After execute (a), (b)
and ©, 	  VM should clear th-&gt;base_block.  However, if (a), (b) or © 	 
raises an exception, then th-&gt;base_block is not cleared. 	  Problem is
that the uncleared value th-&gt;balo_block is used for 	  irrelevant iseq
compilation.  It causes SEGV or critical error. 	  I tried to solve this
problem: to clear them before exception, 	  but finally I found out that it
is difficult to do it (Ruby 	  program can be run in many places). 	 
Because of this background, I set th-&gt;base_block before 	  compiling
iseq and restore it after compiling. 	  Basically, th-&gt;base_block is
dirty hack (similar to global 	  variable) and this patch is also dirty.</p>

<p>* bootstraptest/test_eval.rb: add a test for above.</p>

<p>* internal.h: remove unused decl.</p>

<p>* iseq.c (rb_iseq_compile_with_option): add base_block parameter. 	  set
th-&gt;base_block before compilation and restore it after 	  compilation.</p>

<p>* ruby.c (require_libraries): pass 0 as base_block instead of 	  setting
th-&gt;base_block</p>

<p>* tool/compile_prelude.rb (prelude_eval): apply above changes.</p>

<p>* vm.c, vm_eval.c: ditto.</p>

<p>* vm_core.h: add comments.</p>

<p>Fri Jun 22 18:19:38 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: pass struct rb_execarg value instead of its options 	  field
for saving process attribute changing functions. 	  (save_redirect_fd):
take a struct rb_execarg argument. 	  (run_exec_dup2): ditto. 	 
(run_exec_close): ditto. 	  (run_exec_open): ditto. 	 
(run_exec_dup2_child): ditto. 	  (run_exec_pgroup): ditto. 	 
(run_exec_rlimit): ditto. 	  (save_env): ditto. 	 
(rb_execarg_run_options): follow the above functions change.</p>

<p>Fri Jun 22 17:55:48 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_backtrace.rb: decrease recursion depth 	  to reduce
consuming stack size.</p>

<p>Fri Jun 22 13:36:50 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (random_init, random_load): cannot initialize frozen object 	 
again, nor with tainted/untrusted object.  [Bug #6540]</p>

<p>Fri Jun 22 13:32:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_check_copyable): new function, to ensure the target is 	 
not frozen and the source is not tainted nor untrusted.</p>

<p>Fri Jun 22 05:55:20 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* eval.c (ruby_cleanup):  Fixed typo.  Patch by Trever Dawe. 	  Fixes #131
(github).  [ruby-trunk - Bug #6619]</p>

<p>Thu Jun 21 21:16:58 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_execarg_addopt): take a VALUE argument instead of 	 
struct rb_execarg. 	  (rb_exec_arg_addopt): follow the rb_execarg_addopt
change. 	  (check_exec_options_i): ditto.</p>

<p>* io.c (pipe_open): follow the rb_execarg_addopt change.</p>

<p>* internal.h (rb_execarg_addopt): follow the definition change.</p>

<p>Thu Jun 21 20:34:19 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_fillarg): take a VALUE argument instead of 	  struct
rb_execarg. 	  (rb_check_exec_options): ditto. 	  (check_exec_options_i):
ditto.</p>

<p>Thu Jun 21 19:48:05 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_async_signal_safe): use rb_execarg_run_options 	 
instead of rb_run_exec_options_err. 	  (rb_spawn_process): ditto.</p>

<p>Thu Jun 21 19:02:43 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_fillarg): take a VALUE argument instead of 	  struct
rb_execarg. 	  (rb_execarg_init): follow the rb_exec_fillarg change.</p>

<p>Thu Jun 21 18:36:43 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_execarg_init): take a VALUE argument instead of 	  struct
rb_execarg. 	  (rb_execarg_new): follow the rb_execarg_init change. 	 
(rb_exec_arg_init): ditto.</p>

<p>* internal.h (rb_execarg_init): follow the definition change.</p>

<p>Thu Jun 21 17:20:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (new_args_tail_gen): fix GC problem of keyword rest 	  argument.
the wrapped struct should be bound to the wrapping node 	  before
assignment of child nodes, to get rid of the case the 	  children are
referred by only the struct pointer which is not a 	  subject of GC. 
[ruby-core:45744]</p>

<p>Thu Jun 21 07:06:52 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* error.c (err_append): rename err_append() to compile_err_append() 	  and
move definition body.  err_append() is used only by compiling.</p>

<p>Thu Jun 21 06:21:54 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_execarg_fixup): take a VALUE argument instead of 	  struct
rb_execarg.</p>

<p>* internal.h (rb_execarg_fixup): follow the definition change.</p>

<p>* io.c (pipe_open): follow rb_execarg_fixup change.</p>

<p>* ext/pty/pty.c (establishShell): ditto.</p>

<p>Wed Jun 20 21:25:37 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (struct rb_execarg): add umask_given and umask_mask 	 
fields.</p>

<p>* process.c (STATIC_ASSERT): removed. 	  (rb_execarg_addopt): follow the
rb_execarg change. 	  (rb_execarg_run_options): ditto.</p>

<p>Wed Jun 20 20:38:23 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (struct rb_execarg) moved and renamed from 	  struct
rb_exec_arg in intern.h.</p>

<p>* include/ruby/intern.h (struct rb_exec_arg): refer Data object which 	 
contains struct rb_execarg.</p>

<p>* process.c: use struct rb_execarg instead of struct rb_exec_arg 	  except
functions declared in intern.h. 	  (rb_exec_arg_addopt): extract a pointer
to struct rb_execarg from 	  struct rb_exec_arg. 	  (rb_exec_arg_init):
ditto. 	  (rb_exec_arg_fixup): ditto. 	  (rb_run_exec_options_err): ditto.
	  (rb_run_exec_options): ditto. 	  (rb_exec_err): ditto. 	  (rb_exec):
ditto.</p>

<p>* io.c: use struct rb_execarg instead of struct rb_exec_arg.</p>

<p>* ext/pty/pty.c: ditto.</p>

<p>Wed Jun 20 19:13:25 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_execarg_new): declared. 	  (rb_execarg_get): ditto.</p>

<p>* process.c (mark_exec_arg): new function. 	  (free_exec_arg): ditto. 	 
(memsize_exec_arg): ditto. 	  (exec_arg_data_type): defined. 	 
(rb_execarg_new): new function. 	  (rb_execarg_get): ditto. 	  (rb_f_exec):
use rb_execarg_new. 	  (rb_spawn_internal): ditto. 	  (rb_f_spawn): ditto.</p>

<p>* io.c (pipe_open_v): use rb_execarg_new. 	  (pipe_open_s): ditto.</p>

<p>* ext/pty/pty.c (establishShell): use rb_execarg_new.</p>

<p>Wed Jun 20 16:36:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* missing/setproctitle.c (environ): use (*_NSGetEnviron()) instead of 	 
environ on Darwin for namespace cleanness, same as [ruby-core:00537]. 	 
[ruby-core:45615] [Bug #6576]</p>

<p>Wed Jun 20 11:33:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_execarg_addopt): always make Fixnum, and ignore higher 	 
bits in too large umask value.</p>

<p>Wed Jun 20 11:24:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_run_parallel): deal with 	 
sudden-death of workers.</p>

<p>Mon Jun 18 20:34:20 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* time.c (init_leap_second_info): fix non-ANSI function declaration.</p>

<p>Mon Jun 18 20:29:04 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ruby.c (rb_f_sub): use ansi style declaration. 	* ruby.c (rb_f_gsub):
ditto. 	* ruby.c (rb_f_chomp): ditto.</p>

<p>Mon Jun 18 20:26:23 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* random.c (rb_random_int32): get rid of “warning: constant 0x100000000 	 
is so big it is long” warning.</p>

<p>Mon Jun 18 20:07:23 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* dir.c (dir_initialize): get rid of “unused return: argc =
rb_scan_args()” 	  warning.</p>

<p>Mon Jun 18 19:31:20 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/missing.h: include math.h before checking INFINITY 	  and
NAN. Otherwise, strange macro redefinition will occur.</p>

<p>Mon Jun 18 19:12:37 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* array.c (ary_reverse): use ansi style declaration.</p>

<p>Tue Jun 19 18:43:50 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/backward/rubysig.h: fix visibility.  [Bug #6607]</p>

<p>Tue Jun 19 17:51:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_execarg_run_options): do not call any methods in the 	 
async-signal-safe function.  mask has been checked with NUM2MODET() 	 
already and converted with LONG2NUM().</p>

<p>Tue Jun 19 11:59:56 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (Init_readline): don&#39;t set 0 to 	 
rl_catch_signals and rl_catch_sigwinch. [Bug #5423]</p>

<p>Tue Jun 19 11:52:59 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (readline_s_get_special_prefixes): suppress 	 
warning: uninitialized instance variable.</p>

<p>Tue Jun 19 11:43:16 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (readline_getc): fix editline compatibility 	 
broken by r36123. [Bug #6601]</p>

<p>Mon Jun 18 17:10:08 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_subpos): split from rb_str_substr.  returns 	  adjusted
position for substring.</p>

<p>Mon Jun 18 10:42:57 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (readline_getc): deal with ESC just followed 	 
by ASCII as meta prefix in incremental search mode.  based on the 	  patch
from rctay (Tay Ray Chuan) at [ruby-core:45682].  [Bug #6601]</p>

<p>Sun Jun 17 22:23:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (rb_file_directory_p): move documentation for Dir.exist? from 	 
file.c so that the proper description will be shown instead of the 	 
documentation of File.directory?.  [ruby-core:45685]</p>

<p>Sun Jun 17 16:21:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_win32.h (rb_thread_lock_t): make a union for USE_WIN32_MUTEX. 	 
this internal is used only in thread_win32.c, but has to be complete 	  to
define rb_thread_t.</p>

<p>* thread_win32.c (native_mutex_lock, native_mutex_destroy): fix for 	 
USE_WIN32_MUTEX.</p>

<p>* thread_win32.c (native_cond_timedwait_ms): rename reserved pattern 	 
name.  user defined symbols should not start with __.</p>

<p>Sat Jun 16 19:24:01 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: define date_sg_t.</p>

<p>Sat Jun 16 18:46:57 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_tmx.h: offset in struct tmx_funcs is now int. 	*
ext/date/date_strftime.c: ditto. 	* ext/date/date_core.c: ditto.</p>

<p>Sat Jun 16 18:31:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (ruby_setup): set running state in the normal case before 	 
popping a tag.</p>

<p>Sat Jun 16 07:46:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_run_parallel): format workers 	 
results in the parent.</p>

<p>Sat Jun 16 07:12:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/runruby.rb (File.realpath): return real path of expanded path. 	 
[Bug #6598]</p>

<p>Sat Jun 16 07:12:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bootstraptest/runner.rb (main): ignore -j option for compatibility 	 
with test/unit.</p>

<p>Sat Jun 16 07:11:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#puke): modify only result and 	 
drop useless reports, not override entirely.</p>

<p>* lib/test/unit/parallel.rb (Test::Unit::Worker#_run_suite): report 	 
unformatted results.  formatting messages is not a workers task.</p>

<p>* lib/test/unit/parallel.rb (Test::Unit::Worker#puke): store raw 	 
results.</p>

<p>Sat Jun 16 01:27:14 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: bumping psych to 1.3.3 	*
ext/psych/psych.gemspec: ditto</p>

<p>Fri Jun 15 20:54:28 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* vm_backtrace.c (backtrace_collect): rename from backtreace_collect.</p>

<p>Fri Jun 15 19:22:13 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: remove VM_FRAME_MAGIC_FINISH (finish frame type). 	  Before
this commit: 	    `finish frame&#39; was place holder which indicates that
VM loop 	    needs to return function. 	    If a C method calls a Ruby
methods (a method written by Ruby), 	    then VM loop will be (re-)invoked.
When the Ruby method returns, 	    then also VM loop should be escaped. 
`finish frame&#39; has only 	    one instruction `finish&#39;, which
returns VM loop function. 	    VM loop function executes `finish&#39;
instruction, then VM loop 	    function returns itself. 	    With such
mechanism, `leave&#39; instruction (which returns one 	    frame from
current scope) doesn&#39;t need to check that this `leave&#39; 	    should
also return from VM loop function. 	    Strictly, one branch can be removed
from `leave&#39; instruction. 	  Consideration: 	    However, pushing the
`finish frame&#39; needs costs because 	    it needs several memory
accesses.  The number of pushing 	    `finish frame&#39; is greater than I
had assumed.  Of course, 	    pushing `finish frame&#39; consumes
additional control frame. 	    Moreover, recent processors has good branch
prediction, 	    with which we can ignore such trivial checking. 	  After
this commit: 	    Finally, I decide to remove `finish frame&#39; and
`finish&#39; 	    instruction.  Some parts of VM depend on `finish
frame&#39;, 	    so the new frame flag VM_FRAME_FLAG_FINISH is introduced.
	    If this frame should escape from VM function loop, then 	    the
result of VM_FRAME_TYPE_FINISH_P(cfp) is true. 	    `leave&#39; instruction
checks this flag every time. 	    I measured performance on it.  However on
my environments, 	    it improves some benchmarks and slows some benchmarks
down. 	    Maybe it is because of C compiler optimization parameters. 	   
I&#39;ll re-visit here if this cause problems.</p>

<p>* insns.def (leave, finish): remove finish instruction.</p>

<p>* vm.c, vm_eval.c, vm_exec.c, vm_backtrace.c, vm_dump.c: 	  apply above
changes.</p>

<p>Fri Jun 15 19:11:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#puke): always add skipped 	 
results to the report for parallel test.  [Bug #6595]</p>

<p>Fri Jun 15 09:01:35 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* nacl/pepper_main.c: Removed an unnecessary and erroneous inclusion.</p>

<p>Thu Jun 14 22:59:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_CPPOUTFILE): check if output is really sent to 	 
specified file to tell if -o option works.  [ruby-dev:45742] 	  [Bug#6591]</p>

<p>* configure.in (RUBY_CPPOUTFILE): check if output file is actually 	 
created.  [ruby-dev:45742] [Bug#6591]</p>

<p>Thu Jun 14 22:10:50 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (proc_exec_sh): don&#39;t strip leading spaces of the script.</p>

<p>Thu Jun 14 15:54:02 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* file.c (rb_file_s_basename, rb_file_s_dirname): documentation fix. 	 
File.basename and File.dirname support File::ALT_SEPARATOR.</p>

<p>Thu Jun 14 11:10:10 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* nacl/pepper_main.c: Applies the new embedding API to pepper_ruby.</p>

<p>Thu Jun 14 10:44:41 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* include/ruby/ruby.h: Grouped APIs for embedding CRuby interpreter. 	 
(ruby_setup, ruby_compile_main_from_file, 	  ruby_compile_main_from_string,
ruby_eval_main, 	  ruby_set_script_name): new APIs to embed CRuby. 	 
(ruby_opaque_t) Opaque pointer to an internal data, to NODE or iseq 	  in
particular.</p>

<p>* eval.c (ruby_setup): Similar to ruby_init but returns an error code 	 
instead of exit(3) on error. 	  (ruby_eval_main): Similar to ruby_exec_node
but returns the 	  evaluation result. 	  (ruby_eval_main_internal): renamed
from ruby_exec_internal.</p>

<p>* ruby.c (toplevel_context): new helper function. 	  (PREPARE_EVAL_MAIN):
moved. 	  (process_options): refactored with new functions. 	 
(parse_and_compile_main) new helper function. 	 
(ruby_compile_main_from_file, ruby_compile_main_from_string) new API 	 
(ruby_set_script_name): new API.</p>

<p>Thu Jun 14 10:39:48 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* eval.c: Add doxygen comments.</p>

<p>* ruby.c: ditto.</p>

<p>* thread_pthread.c: ditto</p>

<p>* version.c: ditto.</p>

<p>* vm_core.h: ditto.</p>

<p>Thu Jun 14 10:16:07 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: revert r36071 and add NetBSD to blacklist of -ansi.</p>

<p>Thu Jun 14 07:59:12 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (get_stack): Linux is the only OS which includes 	  the
size of guard page into the stack size.</p>

<p>Thu Jun 14 06:21:00 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/drb/drb.rb:  Replace broken links to the English DRb book. 	  Patch
by Zachary Scott.  [ruby-trunk - Bug #6544]</p>

<p>Thu Jun 14 06:17:47 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/observer.rb:  Update broken link to the Programming Ruby book. 	 
Patch by Zachary Scott.  [ruby-trunk - Bug #6536] 	* lib/drb/drb.rb: 
ditto.</p>

<p>Thu Jun 14 05:23:05 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (PFETCH_READY): suppress Wunused-but-set-variable.</p>

<p>* regparse.c (is_onechar_cclass): restructured to clarify that c is 	 
used iff found == 1.</p>

<p>Thu Jun 14 02:54:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: use -fbuiltin with -ansi -std=iso9899:199409. 	  This
prevents errors introduced by disabling builtin functions, 	  which is the
sub-effect of -ansi/-std. 	  Now NetBSD can use -ansi -std=iso9899:199409.
	  Maybe mingw, cygwin and darwin can also.</p>

<p>Thu Jun 14 02:53:30 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Makefile.in: don&#39;t remove macros. now name2ctype uses macros.</p>

<p>* tool/enc-unicode.rb: add comment why it uses Hash#index.</p>

<p>* enc/unicode/name2ctypename2ctype.kwd,name2ctypename2ctype.kwd,name2ctype.src,name2ctypename2ctype.kwd,name2ctype.src,name2ctype.hname2ctype.kwd,name2ctype.src,name2ctype.h.blt: 	  update
to follow the current name2ctype.h. 	  FYI current Unicode version is 6.1.</p>

<p>Thu Jun 14 00:16:59 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/net/http/responses.rb, lib/webrick/httpstatus.rb: Add HTTP 	 
response codes added in RFCs 2817 and 4918.  [ruby-core:45547] 	  [Feature
#6569]</p>

<p>* lib/net/http/responses.rb: Rename Net::HTTPMultipleChoice to 	 
Net::HTTPMultipleChoices, leaving the former as alias to the 	  latter for
backward compatibility.  [ruby-core:45547] 	  [Feature #6569]</p>

<p>* lib/net/http/responses.rb: Add comments about unused, 	  still-in-draft
and private extension response codes. 	  [ruby-core:45547] [Feature #6569]</p>

<p>Wed Jun 13 22:44:32 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* test/dl/test_func.rb (test_qsort1, test_qsort2): use TYPE_SIZE_T 	  for
size_t variables. [ruby-dev:45733] [Bug #6584]</p>

<p>Wed Jun 13 22:18:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: remove -ansi and -std options for lgamma_r() and 	 
finite().</p>

<p>Wed Jun 13 21:46:34 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: cygwin does not provide some declarations in strict 	 
ANSI mode.</p>

<p>Wed Jun 13 20:19:59 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_internal): move a variable declaration.</p>

<p>Wed Jun 13 17:54:38 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* regparse.c (PFETCH_READY):  this  line was to  suppress warning, 	  but 
did emit  warnings if  -Wuninitialized was  set.  Assigning 	  NULL instead
if pfetch_prev should suffice the situation.</p>

<p>Wed Jun 13 17:51:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: cygwin needs C99 for some stuff, e.g., 	 
pthread_attr_setstacksize, sched_yield.</p>

<p>Wed Jun 13 17:50:43 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (.c.i): add warnflags to make the result consistent with 	 
compilation.</p>

<p>Wed Jun 13 15:12:07 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* configure.in: On Windows  platforms, system provided headers are 	  VC++
optimized.  That is, C++ habits are often contaminated into 	  various 
headers.  Most  frequent  situation is  the  use of  // 	  comments.  We
bypass ANSI  C mode for them.  Otherwise extension 	  libs cannot include
those headers.</p>

<p>Wed Jun 13 13:39:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/win32.h: get rid of C99 style one line comments.</p>

<p>Wed Jun 13 13:39:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* encoding.c (enc_alias_internal): use strdup defined as macro.</p>

<p>Wed Jun 13 10:20:27 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_exec_fillarg): get rid of SIZE_T_MAX which may need 	 
more headers.</p>

<p>* process.c (rb_exec_fillarg): fix array element size.  “continue” and 	 
“readonly” exceeded the size.</p>

<p>* process.c (rb_exec_fillarg): use shell if the first word is reserved 	 
or special built-in name. 	 <a
href="http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html">pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html</a></p>

<p>* process.c (rb_exec_fillarg): treat &#39;=&#39; only in the first word. 
if 	  the first word does not contain &#39;=&#39;, it is the command name
and 	  environment assignments cannot be anymore.</p>

<p>Tue Jun 12 23:45:36 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb: add dummy clean-static target to prevent errors for the 	 
case real clean-static target doesn&#39;t exist.</p>

<p>Tue Jun 12 22:49:42 2012  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* process.c (rb_exec_arg_fixup): fix compile error</p>

<p>Tue Jun 12 21:40:13 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_fillarg): treat &#39;=&#39; character as a meta 	 
character to detect assignments preceding command name.</p>

<p>Tue Jun 12 20:29:19 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_exec_arg_init): deprecated. 	 
(rb_exec_arg_addopt): ditto. 	  (rb_exec_arg_fixup): ditto. 	 
(rb_run_exec_options): ditto. 	  (rb_run_exec_options_err): ditto.</p>

<p>* internal.h (rb_execarg_init): declared. 	  (rb_execarg_addopt): ditto. 	
(rb_execarg_fixup): ditto. 	  (rb_execarg_run_options): ditto.</p>

<p>* process.c: call rb_execarg_addopt, rb_execarg_fixup, 	 
rb_execarg_run_options, rb_execarg_init. 	  (rb_execarg_addopt): renamed
from rb_exec_arg_addopt. 	  (rb_exec_arg_addopt): stub to call
rb_execarg_addopt. 	  (rb_execarg_init): renamed from rb_exec_arg_init. 	 
(rb_exec_arg_init): stub to call rb_execarg_init. 	  (rb_execarg_fixup):
renamed from rb_exec_arg_fixup. 	  (rb_exec_arg_fixup): stub to call
rb_execarg_fixup. 	  (rb_execarg_run_options): renamed from
rb_run_exec_options_err. 	  (rb_run_exec_options_err): stub to call
rb_execarg_run_options. 	  (rb_run_exec_options): call
rb_execarg_run_options.</p>

<p>* io.c: call rb_execarg_addopt, rb_execarg_fixup, 	 
rb_execarg_run_options, rb_execarg_init.</p>

<p>* ext/pty/pty.c (establishShell): call rb_execarg_init and 	 
rb_execarg_fixup.</p>

<p>Tue Jun 12 18:39:59 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* configure.in: enable strict ANSI mode by default in case of GCC, 	 
requested by _ko1.</p>

<p>Tue Jun 12 06:40:23 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_fillarg): detect &#39;#&#39; as a meta character.</p>

<p>Mon Jun 11 22:15:44 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_proc_exec_n): deprecated. 	  (rb_exec): ditto.
	  (rb_exec_err): ditto. 	  (rb_fork): ditto. 	  (rb_fork_err): ditto.</p>

<p>Mon Jun 11 18:49:52 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: on checking libexecinfo, don&#39;t specify /use/local. 	 
On FreeBSD people must specify –with-opt-dir or –with-execinfo-dir.</p>

<p>Mon Jun 11 12:14:37 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: remove lfp (local frame pointer) and rename 	  dfp (dynamic
frame pointer) to ep (environment pointer). 	  This change make VM
`normal&#39; (similar to other interpreters). 	  Before this commit: 	   
Each frame has two env pointers lfp and dfp.  lfp points 	    local
environment which is method/class/toplevel frame. 	    <a href="0">lfp</a>
is block pointer. 	    dfp is block local frame. <a href="0">dfp</a> points
previous (parent) 	    environment pointer. 	    lfp == dfp when frame is
method/class/toplevel. 	    You can get lfp from dfp by traversing previous
environment 	    pointers. 	  After this commit: 	    Each frame has only
`ep&#39; to point respective environment. 	    If there is parent
environment, then <a href="0">ep</a> points parent 	    environment (as
dfp).  If there are no more environment, 	    then <a href="0">ep</a>
points block pointer (as lfp).  We call such ep 	    as `LEP&#39; (local
EP).  We add some macros to get LEP and to 	    detect LEP or not. 	    In
short, we replace dfp and lfp with ep and LEP. 	  rb_block_t and
rb_binding_t member `lfp&#39; and `dfp&#39; are removed 	  and member
`ep&#39; is added. 	  rename rb_thread_t&#39;s member `local_lfp&#39; and
`local_svar&#39; to 	  `root_lep&#39; and `root_svar&#39;. 	 
(VM_EP_PREV_EP(ep)): get previous environment pointer.  This macro 	   
assume that ep is not LEP. 	  (VM_EP_BLOCK_PTR(ep)): get block pointer. 
This macro assume 	    that ep is LEP. 	  (VM_EP_LEP_P(ep)): detect ep is
LEP or not. 	  (VM_ENVVAL_BLOCK_PTR(ptr)): make block pointer. 	 
(VM_ENVVAL_BLOCK_PTR_P(v)): detect v is block pointer. 	 
(VM_ENVVAL_PREV_EP_PTR(ptr)): make prev environment pointer. 	 
(VM_ENVVAL_PREV_EP_PTR_P(v)): detect v is prev env pointer.</p>

<p>* vm.c: apply above changes. 	  (VM_EP_LEP(ep)): get LEP. 	 
(VM_CF_LEP(cfp)): get LEP of cfp-&gt;ep. 	  (VM_CF_PREV_EP(cfp)): utility
function VM_EP_PREV_EP(cfp-&gt;ep). 	  (VM_CF_BLOCK_PTR(cfp)): utility
function VM_EP_BLOCK_PTR(cfp-&gt;ep).</p>

<p>* vm.c, vm_eval.c, vm_insnhelper.c, vm_insnhelper.h, insns.def: 	  apply
above changes.</p>

<p>* cont.c: ditto.</p>

<p>* eval.c, eval_intern.h: ditto.</p>

<p>* proc.c: ditto.</p>

<p>* thread.c: ditto.</p>

<p>* vm_dump.c: ditto.</p>

<p>* vm_exec.h: fix function name (on vm debug mode).</p>

<p>Mon Jun 11 11:52:18 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_set_sequence): nonstatic initializer of an 	  aggregate
type is a C99ism.</p>

<p>* compile.c (enum compile_array_type_t): comma at the end of enum 	  list
is a C99ism.</p>

<p>* vm_backtrace.c (enum LOCATION_TYPE): ditto.</p>

<p>Mon Jun 11 06:31:33 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_proc_exec_n): revert the function removed at r35889.</p>

<p>Mon Jun 11 06:20:50 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): assign return 	  value
to the variable err.</p>

<p>Mon Jun 11 06:17:06 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (native_cond_initialize): fix typo in r36022. 	  this
cause a failure on FreeBSD 8.2 amd64. 	 <a
href="http://fbsd.rubyci.org/~chkbuild/ruby-trunk/log/20120610T130201Z.diff.html.gz">fbsd.rubyci.org/~chkbuild/ruby-trunk/log/20120610T130201Z.diff.html.gz</a></p>

<p>Mon Jun 11 05:21:57 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* .gdbinit (SDR): add SDR function.  It&#39;s only for VM debugging.</p>

<p>Sun Jun 10 21:50:45 2012  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* nacl/nacl_config.rb: Fixed for 32bit hosts.</p>

<p>Sun Jun 10 20:23:14 2012  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>Fixes threading on NativeClient.</p>

<p>* thread_pthread.c (timer_thread_sleep): Extracted out a function from 	 
thread_timer(). Added an alternative implementation for platforms 	  that
lacks select(2) or pipe(2). 	  (rb_thread_create_timer_thread,
native_cond_initialize, 	  native_cond_destroy): Replaced wrong HAVE_XXX
checks.</p>

<p>* configure.in (pthread_attr_init): New check.</p>

<p>Sun Jun 10 21:30:11 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_without_timer_thread): renamed from rb_exec_err. 	 
(rb_exec_err): new stub function to call 	  rb_exec_without_timer_thread. 	
(rb_f_exec): call rb_exec_without_timer_thread. 	  (rb_exec): call
rb_exec_without_timer_thread.</p>

<p>Sun Jun 10 21:13:10 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork): call rb_fork_internal instead of rb_fork_err.</p>

<p>Sun Jun 10 20:55:59 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_ruby): call rb_fork_internal directly.</p>

<p>Sun Jun 10 20:19:40 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_ruby): new function. 	  (rb_f_fork): use rb_fork_ruby
instead of rb_fork. 	  (rb_daemon): ditto.</p>

<p>* io.c (pipe_open): use rb_fork_ruby instead of rb_fork.</p>

<p>* internal.h (rb_fork_ruby): declared.</p>

<p>Sun Jun 10 18:58:16 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/net/http/response.rb: Remove a duplicated rdoc and leave a 	 
pointer.</p>

<p>* lib/net/http/responses.rb: Add RFC numbers to base on.</p>

<p>Sun Jun 10 18:31:42 2012  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* configure.in (RUBY_NACL): Warns if $PATH does not contain the path 	  to
NativeClient SDK. PATH variable redefinition in GNUmakefile does 	  not
work for GNU make 3.81.</p>

<p>Sun Jun 10 17:54:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.h (IS_STACK_DIR_UPPER): utility macro.</p>

<p>* thread_pthread.c (get_stack): seems stack size does not include 	  guard
size on Mac OS X.</p>

<p>* thread_pthread.c (ruby_init_stack): adjust stack size for offset of 	 
addr from the bottom.</p>

<p>Sun Jun 10 15:49:47 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (retry_fork): call after_fork except in a child process. 	 
(rb_fork_internal): restrict after_fork call condition.</p>

<p>Sun Jun 10 14:19:33 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: NetBSD 6 adds libexecinfo but it only works on amd64. 	 <a
href="http://www.mail-archive.com/source-changes-full@netbsd.org/msg38729.html">www.mail-archive.com/source-changes-full@netbsd.org/msg38729.html</a></p>

<p>Sun Jun 10 12:43:23 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_f_exec): call rb_exec_async_signal_safe except on 	  Mac
OS X.  cf. the comment in before_exec_non_async_signal_safe.</p>

<p>Sun Jun 10 12:15:18 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (popen_exec): don&#39;t call rb_thread_atfork_before_exec.  use 	 
rb_exec_async_signal_safe instead of rb_exec_err. 	  (pipe_open): use
rb_fork_async_signal_safe instead of rb_fork_err.</p>

<p>Sun Jun 10 11:44:57 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_internal): call after_fork only unless 	 
chfunc_is_async_signal_safe.</p>

<p>Sun Jun 10 11:33:01 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_pkey_ec.c 	  test/openssl/test_pkey_ec.rb: Add support
for EC_POINT_mul. 	  Patch provided by Sambasiva Suda. Thanks! 	 
[ruby-core:44408][ruby-trunk - Feature #6310]</p>

<p>Sun Jun 10 10:48:15 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* lib/openssl/ssl.rb: Use a simple random number to generate the 	 
session id. MD5, as was used before, causes problems when 	  using a FIPS
version of OpenSSL. Issue was found by Jared 	  Jennings, thank you! 	 
[ruby-trunk - Bug #6137]</p>

<p>Sun Jun 10 10:27:34 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* NEWS: Add note about the new private key export behavior.</p>

<p>Sun Jun 10 10:24:51 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_async_signal_safe): exported.</p>

<p>* ext/pty/extconf.rb: modify $INCFLAGS to include internal.h</p>

<p>* ext/pty/pty.c: include internal.h. 	  (chfunc): don&#39;t call
rb_thread_atfork_before_exec.  use 	  rb_exec_async_signal_safe instead of
rb_f_exec. 	  (establishShell): set up earg.  use rb_fork_async_signal_safe
	  instead of rb_fork_err.</p>

<p>* internal.h (rb_exec_async_signal_safe): declared. 	 
(rb_fork_async_signal_safe): declared.</p>

<p>Sun Jun 10 10:21:37 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl.c 	  ext/openssl/ossl_pkey_rsa.c 	 
ext/openssl/ossl_pkey_dsa.c 	  ext/openssl/ossl_pkey_ec.c: Forbid export
passwords that are less 	  than four characters long, as OpenSSL itself
does not allow this. 	  Issue found by Eric Hodel. 	*
ext/openssl/ossl_pkey_ec.c: Add export as an alias of to_pem, 	  following
the PKey interface contract. 	* test/openssl/test_pkey_dsa.rb 	 
test/openssl/test_pkey_rsa.rb 	  test/openssl/test_pkey_ec.rb: Add tests
that assert correct 	  behaviour when dealing with passwords that are less
than four 	  characters long. 	  [ruby-core: 42281][ruby-trunk - Bug #5951]</p>

<p>Sun Jun 10 10:14:26 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_f_exec): use rb_exec_arg_prepare.</p>

<p>Sun Jun 10 06:43:51 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: split after_exec into async-signal-safe part and rest. 	 
(after_exec_async_signal_safe): extracted from after_exec. 	 
(after_exec_non_async_signal_safe): ditto. 	  (after_exec): call them. 	 
(rb_exec_async_signal_safe): call after_exec_async_signal_safe. 	 
(rb_exec_err): call after_exec_non_async_signal_safe instead of 	 
after_exec.</p>

<p>Sun Jun 10 06:21:10 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* NEWS: document new features of Ruby OpenSSL.</p>

<p>Sun Jun 10 03:09:41 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl.c: Fix error in example. Patch by David Albert.</p>

<p>Add/extend existing documentation. Examples now also cover RSA 	 
signatures and PBKDF2. 	  [ruby-core: 45154][ruby-trunk - Bug #6475]</p>

<p>Sun Jun 10 01:41:45 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Introduce SSLContext#renegotiation_cb and 	 
remove SSLContext#disable_client_renegotiation and related 	  functionality
introduced in r35797. The new callback approach 	  gives clients maximum
flexibility to decide on their own what to 	  do on renegotiation attempts.
	  Add documentation for SSL module and SSLError. 	*
test/openssl/test_ssl.rb: Add a test for 	  SSLContext#renegotiation_cb.</p>

<p>Sun Jun 10 01:37:18 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_internal): initialize exc.</p>

<p>Sun Jun 10 00:19:25 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: don&#39;t use non async-signal-safe functions in a child 	 
process before exec, for invoking a command. 	  (rb_exec_atfork): call
rb_exec_async_signal_safe only. 	  (retry_fork): take
chfunc_is_async_signal_safe argument.  call 	  before_fork and after_fork
only unless chfunc_is_async_signal_safe. 	  (send_child_error): take
chfunc_is_async_signal_safe argument. 	  send an exception only unless
chfunc_is_async_signal_safe. 	  (recv_child_error): take
chfunc_is_async_signal_safe argument. 	  receive an exception only unless
chfunc_is_async_signal_safe. 	  (rb_fork_internal): renamed from
rb_fork_err and take 	  chfunc_is_async_signal_safe argument. 	  use
rb_protect only unless chfunc_is_async_signal_safe. 	  (rb_fork_err): call
rb_fork_internal with false as 	  chfunc_is_async_signal_safe. 	 
(rb_fork_async_signal_safe): call rb_fork_internal with true as 	 
chfunc_is_async_signal_safe. 	  (rb_spawn_process): call
rb_fork_async_signal_safe instead of 	  rb_fork_err.</p>

<p>Sat Jun  9 23:57:03 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_err): rewrite a complex “if” statement.</p>

<p>Sat Jun  9 23:44:29 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (before_exec_async_signal_safe): extracted from 	 
before_exec. 	  (before_exec_non_async_signal_safe): ditto. 	 
(before_exec): call before_exec_async_signal_safe and 	 
before_exec_non_async_signal_safe. 	  (rb_exec_async_signal_safe): call
before_exec_async_signal_safe. 	  (rb_exec_err): call
before_exec_non_async_signal_safe instead of 	  before_exec.</p>

<p>Sat Jun  9 23:36:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (iseq_load, insn_operand_intern, rb_iseq_disasm) 	 
(rb_iseq_parameters): use rb_id2str() instead of rb_id2name() to 	  keep
encoding.</p>

<p>* string.c (rb_str_symname_p): new function that checks if the string 	 
is valid as a symbol name.  split from sym_inspect().</p>

<p>Sat Jun  9 22:27:05 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (retry_fork): rewrite a complex “for” statement by 	  simple
statements.</p>

<p>Sat Jun  9 21:50:04 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (retry_fork): extracted from rb_fork_err. 	 
(send_child_error): ditto. 	  (recv_child_error): ditto.</p>

<p>Sat Jun  9 17:21:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (iseq_load): type is a symbol, and invalid as ID in common.</p>

<p>Sat Jun  9 10:57:14 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_async_signal_safe): extracted from rb_exec_err.</p>

<p>Sat Jun  9 09:31:07 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: simplified because close_others option is always 	  enabled
by default. 	  (rb_f_exec): don&#39;t need to set the option. 	 
(rb_exec_arg_prepare): don&#39;t need to set the option.  don&#39;t need 	 
default_close_others argument. 	  (rb_spawn_internal): don&#39;t need to
give default_close_others 	  argument for rb_exec_arg_prepare.  don&#39;t
need default_close_others 	  argument. 	  (rb_spawn_err): don&#39;t need to
give default_close_others 	  argument for rb_spawn_internal. 	  (rb_spawn):
don&#39;t need to give default_close_others 	  argument for
rb_spawn_internal. 	  (rb_f_system): don&#39;t need to give
default_close_others argument for 	  rb_spawn_internal. 	  (rb_f_spawn):
don&#39;t need to give default_close_others argument for 	 
rb_exec_arg_prepare.</p>

<p>Sat Jun  9 09:00:58 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_proc_exec): call before_exec() here addition to 	 
rb_exec_err.</p>

<p>Sat Jun  9 08:30:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (ruby_init_stack): use stack info if possible.</p>

<p>Sat Jun  9 08:21:32 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* README.EXT (prepare extconf.rb):  Added note to see MakeMakefile for 	 
documentation of extconf.rb functions.  Patch by Zachary Scott. 	 
[ruby-trunk - Feature #6522] 	* README.EXT (Appendix C):  Removed in favor
of MakeMakefile. 	  Patch by Zachary Scott. 	* lib/mkmf.rb:  Merged
documentation from README.EXT Appendix C.  Patch 	  by Zachary Scott.</p>

<p>Sat Jun  9 08:16:47 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/re.rdoc:  Completed wording in the description of the =~ operator. 	
[ruby-trunk - Bug #6529]</p>

<p>Sat Jun  9 08:09:38 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* string.c (rb_str_start_with):  Removed “p” from start_with? examples 	 
to match other String method examples.  [ruby-trunk - Bug #6553] 	*
string.c (rb_str_end_with):  Updated end_with? to use code markup 	 
instead of italic.</p>

<p>Sat Jun  9 07:56:03 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/benchmark.rb:  Updated formatting of Benchmark documentation for 	 
consistency.  [ruby-trunk - Bug #6533]</p>

<p>Sat Jun  9 07:46:26 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/delegate.rb:  Added documentation for Delegator#!.  Patch by 	 
Zachary Scott.  [ruby-trunk - Feature #6534]</p>

<p>Sat Jun  9 07:39:50 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http/responses.rb:  Add RFC 6585 response codes.  Patch by 	 
Sangil Jung.  [ruby-trunk - Feature #6480] 	* lib/net/http/response.rb: 
ditto 	* lib/net/http.rb:  ditto 	* lib/webrick/httpstatus.rb:  ditto</p>

<p>Sat Jun  9 01:24:28 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_err): before_exec() call moved from proc_exec_cmd 	 
and proc_exec_sh. 	  (rb_proc_exec): ditto.</p>

<p>Sat Jun  9 01:11:07 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_exec_arg_init): declaration changed to 	 
return a value.</p>

<p>* process.c (rb_exec_arg_init): return a value.</p>

<p>Fri Jun  8 23:44:14 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: don&#39;t check the availability of FD_CLOEXEC.  It should 	 
be available if fork() is available.</p>

<p>* io.c: ditto.</p>

<p>Fri Jun  8 22:39:32 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_err): revert r35955.  The condition needs !chfunc 	 
to close <a href="0">ep</a> and <a href="1">ep</a>.  The catched exception
is re-raised 	  immediately after that if status is not NULL.</p>

<p>Fri Jun  8 19:43:33 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_err): after_exec() call moved from proc_exec_cmd 	 
and proc_exec_sh. 	  (rb_proc_exec): ditto.</p>

<p>Fri Jun  8 19:00:59 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (ARGV_COUNT): unused macro removed. 	  (ARGV_SIZE): ditto. 	 
(ALLOC_ARGV): ditto. 	  (ALLOC_ARGV_WITH_STR): ditto.</p>

<p>Fri Jun  8 16:19:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/runner.rb (src_testdir): expand real path so that 	 
TestGem#test_self_find_files does not fail by aliased load path when 	 
srcdir contains a symbolic link.</p>

<p>* tool/runruby.rb (srcdir): ditto.</p>

<p>Fri Jun  8 12:04:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_fork_err): error state in the child process is prior 	  to
exceptions in proc_syswait().</p>

<p>* process.c (rb_fork_err): determine status on errors.</p>

<p>* ext/pty/pty.c (establishShell): reraise exception if something 	  raised
during sleep.</p>

<p>* ext/pty/pty.c (establishShell): now needs status to protect from 	 
exceptions in rb_fork_err().</p>

<p>Thu Jun  7 22:13:05 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_fork_err): Fix the condition to use rb_protect.</p>

<p>Thu Jun  7 20:29:12 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h: rb_exec_arg and related stuff moved back from 	 
internal.h</p>

<p>Thu Jun  7 15:53:03 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* .gdbinit: add function `trace_machine_instructions&#39; to trace 	  in
native machine assemble. 	  See <a
href="https://bugs.ruby-lang.org/projects/ruby-trunk/wiki/MachineInstructionsTraceWithGDB">bugs.ruby-lang.org/projects/ruby-trunk/wiki/MachineInstructionsTraceWithGDB</a>
	  for more details.</p>

<p>Wed Jun  6 21:31:21 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (proc_exec_cmd) renamed from proc_exec_v. 	  (proc_exec_sh):
renamed from rb_proc_exec_e. 	  (proc_spawn_cmd_internal): renamed from
proc_spawn_v. 	  (proc_spawn_cmd): renamed from proc_spawn_n. 	 
(proc_spawn_sh): renamed from proc_spawn.</p>

<p>Wed Jun  6 21:18:47 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* process.c (try_with_sh): please take care of the macro defined by 	 
you.</p>

<p>Wed Jun  6 20:45:08 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (proc_exec_v): don&#39;t call dln_find_exe_r here because it 	
is not async-signal-safe and proc_exec_v is called in a child 	  process. 	
command_abspath field of rb_exec_arg. 	  (rb_exec_fillarg): call
dln_find_exe_r and set command_abspath. 	  (rb_exec_err): Give the absolute
path of the invoking command for 	  proc_exec_v, instead of the command
name.</p>

<p>* internal.h: add command_abspath field for rb_exec_arg.</p>

<p>Wed Jun  6 20:08:01 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (try_with_sh): take envp argument. 	  (exec_with_sh): ditto. 
use it for execve. 	  (proc_exec_v): provide envp for try_with_sh.</p>

<p>Wed Jun  6 13:25:04 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c, include/ruby/win32.h (rb_w32_wrap_io_handle): new API. 	 
this API wraps an I/O handle (HANDLE or SOCKET) and returns fd. 	  the
second parameter should be combination of O_*, for example, 	  O_RDWR |
O_BINARY | O_NOINHERIT.</p>

<p>* win32/win32.c, include/ruby/win32.h (rb_w32_unwrap_io_handle): new 	 
API.  this API unwraps an I/O handle and close the fd (not closes 	  the
handle itself).</p>

<p>[Feature #4906] [ruby-core:37227]</p>

<p>Wed Jun  6 13:18:26 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_close): of course, console handle is not socket.</p>

<p>Wed Jun  6 12:37:43 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* process.c (rb_run_exec_options_err): allocate a temporary buffer for 	 
run_exec_dup2() for restoring fds on non-fork environments.</p>

<p>Wed Jun  6 09:45:21 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/dl/test_c_<code>struct_entry,union_entity</code>.rb: sorry, typos.</p>

<p>Wed Jun  6 05:27:54 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_fillarg): check use_shell field before accessing 	  a
union field.</p>

<p>Wed Jun  6 04:58:44 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_spawn_process): prog variable is not used for Unix.</p>

<p>Wed Jun  6 00:20:37 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_exec_arg_init): change return type to void.</p>

<p>* process.c (rb_exec_arg_init): don&#39;t return a value. 	 
(rb_exec_arg_prepare): ditto. 	  (rb_spawn_process): don&#39;t take the
prog argument.  extract the 	  information from earg. 	 
(rb_spawn_internal): follow rb_spawn_process change. 	  (rb_f_spawn):
ditto.</p>

<p>* io.c (pipe_open): don&#39;t take the prog argument.  extract the 	 
information from eargp. 	  (pipe_open_v): follow pipe_open change. 	 
(pipe_open_s): ditto.</p>

<p>Tue Jun  5 23:51:33 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_exec_arg): use union to represent command invocation 	 
with/without shell.</p>

<p>* process.c: follow the rb_exec_arg change.</p>

<p>* io.c (pipe_open): ditto.</p>

<p>Tue Jun  5 22:28:46 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h: rb_exec_arg and related stuff moved from intern.h</p>

<p>* include/ruby/intern.h (rb_proc_exec_n): removed.</p>

<p>Tue Jun  5 21:57:22 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_arg_fixup): allocate a temporary buffer for 	 
run_exec_dup2 here because it should be async-signal-safe. 	 
(run_exec_dup2): use the temporary buffer. 	  (run_exec_dup2_tmpbuf_size):
new function.</p>

<p>* include/ruby/intern.h (rb_exec_arg): add dup2_tmpbuf field.</p>

<p>Tue Jun  5 20:13:15 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_obj_init_copy): should check if trusted too.</p>

<p>Tue Jun  5 19:59:13 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (strtok): declaration removed because it is not used.</p>

<p>Tue Jun  5 19:33:51 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (proc_spawn): don&#39;t detect simple command line here 	 
because rb_exec_fillarg already did.</p>

<p>Tue Jun  5 19:21:10 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_fillarg): bail out a loop eagerly.</p>

<p>Tue Jun  5 19:15:14 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c: add comments about async-signal-safe.</p>

<p>* io.c: ditto.</p>

<p>Tue Jun  5 09:25:10 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* io.c:  Edited documentation for IO and File open and new and 	 
Kernel#open for consistency and clarity.</p>

<p>Mon Jun  4 21:53:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_sysinit): let the system not display the 	 
critical-error-handler message box and the Windows Error Reporting 	 
dialog.  [ruby-core:45389] [Bug #6535]</p>

<p>Mon Jun  4 19:36:25 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_fillarg): allocate one more element before 	 
beginning in argv_str for try_with_sh.</p>

<p>* internal.h (ARGVSTR2ARGC): adjust for the above change. 	 
(ARGVSTR2ARGV): ditto.</p>

<p>Mon Jun  4 19:17:06 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (ARGVSTR2ARGC): defined. 	  (ARGVSTR2ARGV): defined.</p>

<p>* process.c (proc_exec_v): use ARGVSTR2ARGV. 	  (rb_spawn_process): use
ARGVSTR2ARGC and ARGVSTR2ARGV.</p>

<p>* io.c (pipe_open): use ARGVSTR2ARGV.</p>

<p>Mon Jun  4 16:13:00 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.h: remove magical code “<a href="0">lfp</a> &amp; 0x02”. 	
Current VM doesn&#39;t use this bit.</p>

<p>* vm_core.h (RUBY_VM_GET_BLOCK_PTR): added.</p>

<p>* eval.c (rb_block_given_p): use RUBY_VM_GET_BLOCK_PTR().</p>

<p>* vm_eval.c (rb_f_block_given_p): ditto.</p>

<p>Mon Jun  4 15:39:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (constat_apply): apply VT100 functions. 	 
[ruby-core:44958] [Feature #6418]</p>

<p>* win32/win32.c (constat_parse): parse some VT100 escape sequence.</p>

<p>Mon Jun  4 14:06:12 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* process.c (rb_exec_err): should preserve errno.</p>

<p>Mon Jun  4 13:10:11 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/dl/test_c_<code>struct_entry,union_entity</code>.rb: broken require.</p>

<p>Mon Jun  4 12:01:21 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_backtrace.rb: fix test. 	  Windows path includes `:&#39;
character.</p>

<p>Mon Jun  4 11:42:39 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h (rb_location_t): fix type and field name. 	  (1) rename
rb_location_t to rb_iseq_location_t. 	  (2) rename field names of
rb_iseq_location_t to adjust 	      RubyVM::Backtrace::Location methods. 	 
(2-1) filename -&gt; path 	      (2-2) filepath -&gt; absolute_path 	     
(2-3) basename -&gt; base_label 	      (2-4) name -&gt; label 	  (3) rename
filed name rb_iseq_location_t#line_no to 	     
rb_iseq_location_t#first_lineno to clear purpose of this field. 	  (4) The
field names rb_binding_t#(filename|line_no) are also renamed 	      to
rb_binding_t#(path|first_lineno).</p>

<p>* compile.c: apply above changes.</p>

<p>* iseq.c: ditto.</p>

<p>* proc.c: ditto.</p>

<p>* vm*.c: ditto.</p>

<p>Mon Jun  4 11:40:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (r_object0): also load TYPE_USRMARSHAL, TYPE_DATA using 	 
compatible loader.</p>

<p>Mon Jun  4 11:33:42 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* process.c (rb_run_exec_options_err): restore save_env() call for 	 
non-fork environments.</p>

<p>* process.c (rb_exec_err): restore environments after the failure of 	 
exec to fix [ruby-core:44093] [Bug #6249] on non-fork environments</p>

<p>Mon Jun  4 10:42:04 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (pipe_open): follow up changes in r35889.</p>

<p>* process.c (proc_spawn_n): now uses char ** instead of VALUE *.</p>

<p>* process.c (rb_spawn_process): prog is now VALUE of String, not char *.</p>

<p>Mon Jun  4 06:12:43 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (r_object0): remove old warning for _alloc.</p>

<p>Mon Jun  4 04:24:06 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* marshal.c: experimental test aborted. 	* complex.c: ditto. 	*
rational.c: ditto. 	* include/ruby/intern.h: ditto.</p>

<p>Mon Jun  4 00:45:18 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_spawn_process): fix for Windows.  not tested.</p>

<p>Mon Jun  4 00:11:51 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_proc_exec_e): don&#39;t use ISSPACE().  f, r and v 	  are
not word separator in Bourne shell.</p>

<p>Sun Jun  3 23:47:30 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_exec_arg): remove argc and argv fields. 	  add
use_shell, argv_str and argv_buf fields.</p>

<p>* process.c (rb_proc_exec_e): don&#39;t split shell command line arguments
	  here to avoid memory allocation in a child process. 	 
(rb_exec_fillarg): split shell command line arguments here. 	 
(proc_exec_v): takes argv_str argument instead of argv. 	 
(rb_proc_exec_ne): removed. 	  (rb_proc_exec_n): removed. 	 
(rb_run_exec_options_err): don&#39;t initialize the removed fields. 	 
(rb_exec_err): don&#39;t initialize the removed fields. 	  call proc_exec_v
directly instead of rb_proc_exec_ne. 	  (rb_spawn_process): use use_shell
field.</p>

<p>Sun Jun  3 21:53:00 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* GPL: update text of GPLv2. [ruby-core:44488] [Bug #6328] 	  <a
href="http://www.gnu.org/licenses/gpl-2.0.txt">www.gnu.org/licenses/gpl-2.0.txt</a></p>

<p>Sun Jun  3 21:22:52 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_exec_getargs): remove rb_exec_arg argument.</p>

<p>Sun Jun  3 21:14:26 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* marshal.c: calls directly rb_<code>Complex,Rational</code>_marshal_load(). 	  But
now disabled. [experimental] 	* complex.c: followed the above. 	*
rational.c: ditto. 	* include/ruby/intern.h: ditto.</p>

<p>Sun Jun  3 21:18:17 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_check_argv): use rb_str_new_frozen instead of 	 
rb_str_new4.</p>

<p>Sun Jun  3 20:10:52 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_proc_exec_e): extended version of rb_proc_exec() to 	 
call execle(). 	  (rb_proc_exec): use rb_proc_exec_e(). 	  (rb_exec_err):
use rb_proc_exec_e().</p>

<p>Sun Jun  3 19:47:18 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (vm_living_thread_num): suppress a warning.</p>

<p>Sun Jun  3 17:23:52 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* use execve() to preserve environment variables when exec method is 	 
failed.  [ruby-core:44093] [ruby-trunk - Bug #6249]</p>

<p>* include/ruby/intern.h (rb_exec_arg): add envp_str and envp_buf field 	 
to store envp of execve().</p>

<p>* process.c (proc_exec_v): takes envp_str as an argument and use it 	  for
execve(). 	  (rb_proc_exec_ne): extended version of rb_proc_exec_n(). 	 
(rb_proc_exec_n): use rb_proc_exec_ne(). 	  (rb_proc_exec): follow
proc_exec_v() change. 	  (fill_envp_buf_i): new function. 	 
(rb_exec_arg_fixup): set up envp_str and envp_buf. 	  (save_env_i):
removed. 	  (save_env): removed. 	  (rb_run_exec_options_err): don&#39;t
modify environment variables. 	  (rb_exec_err): use rb_proc_exec_ne().</p>

<p>Sun Jun  3 16:33:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c: revert r35879 “now marshal_<code>load|dump</code> are external.”</p>

<p>* complex.c (nucomp_marshal__<code>dump,load</code>): should use
rb_marshal_<code>dump,load</code>.</p>

<p>* rational.c (nurat_marshal__<code>dump,load</code>): ditto.</p>

<p>Sun Jun  3 14:13:58 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: checks whether the object is frozen or not.</p>

<p>Sun Jun  3 14:00:51 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c: wrote Complex#_dump and Complex::load.  But now 	  disabled
(due to compatibility) [experimental].</p>

<p>* rational.c: wrote Rational#_dump and Rational::load. ditto.</p>

<p>Sun Jun  3 10:23:32 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (nucomp_marshal_load): [ruby-core:45394] 	* rational.c
(nurat_marshal_load): ditto.</p>

<p>Sun Jun  3 03:15:46 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (onig_number_of_names): suppress a warning.</p>

<p>Sun Jun  3 01:36:52 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c: change names. 	  (1) Class name: RubyVM::FrameInfo -&gt;
RubyVM::Backtrace::Location. 	  (2) Method name: RubyVM::FrameInfo.caller
-&gt; 	      Kernel.caller_locations. 	  (3) Instance methods of 	     
RubyVM::FrameInfo (RubyVM::Backtrace::Location) 	      (3-1) name -&gt;
label 	      (3-2) basename -&gt; base_label (basename is confusing with 		
File.basename) 	      (3-3) line_no -&gt; lineno (We have already similar
name 		    File#lineno, commented by kou [ruby-dev:45686]). 	      (3-4)
filename -&gt; path. 	      (3-5) filepath -&gt; absolute_path. 	     
(3-5) iseq -&gt; removed (we will make other APIs to access iseq 		    and
other information of frame for debugging).</p>

<p>* test/ruby/test_backtrace.rb: apply above changes. 	  And apply comment
from kou [ruby-dev:45686].</p>

<p>Sun Jun  3 00:49:11 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* common.mk: fix to build vm_backtrace.c only itself (vm_backtrace.c 	  is
no longer included from vm.c).  I hope this separation reduce 	  compile
time of vm.c.</p>

<p>* internal.h: ditto.</p>

<p>* vm.c, vm_core.h, vm_dump.c, vm_eval.c: ditto.</p>

<p>* vm_eval.c: some functions (callee, etc) moved to vm_backtrace.c.</p>

<p>Sun Jun  3 00:20:53 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c: added.  Separate backtrace related functions to 	  this
file.</p>

<p>* vm.c, common.mk: ditto.</p>

<p>Sat Jun  2 18:09:02 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/ipaddr.rb: Inhibit zero-filled octets in an IPv4 address in 	  all
platforms. [ruby-dev:45671]</p>

<p>* lib/ipaddr.rb: Allow the x:x:x:x:x:x:d.d.d.d form not limited to 	  IPv4
mapped/compatible addresses.  This change also makes it 	  possible for the
parser to understand IPv4 mapped and compatible 	  IPv6 addresses in
non-compressed form.</p>

<p>* lib/ipaddr.rb: Stop exposing IPSocket.valid*? methods which were 	  only
usable on non-IPv6-ready platforms.</p>

<p>Sat Jun  2 16:59:00 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_enc_cr_str_buf_cat): don&#39;t reset coderange as unknown.
	  the condition &#39;ptr_a8 &amp;&amp; str_cr != ENC_CODERANGE_7BIT&#39;
means not 	  unknown, str is also ASCII-8BIT because str_encindex ==
ptr_encindex, 	  and nont (str_cr == ENC_CODERANGE_UNKNOWN) and 	  str_cr
!= ENC_CODERANGE_7BIT means str_cr is valid because ASCII-8BIT 	  can&#39;t
be broken. [ruby-dev:45688] [Bug #6509]</p>

<p>Sat Jun  2 07:04:48 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/re.rdoc (Performance):  Replaced incorrect example of reducing 	 
backtracking through anchoring with reduced backtracking through a 	 
range.  [ruby-trunk - Bug #6525]</p>

<p>Sat Jun  2 06:34:15 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/re.rdoc (Performance):  Removed useless sample output from final 	 
performance example and switched from #match to #=~ for consistency. 	 
[ruby-trunk - Bug #6524]</p>

<p>Fri Jun  1 09:30:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (class_or_module_required): extract check for class or 	 
module.</p>

<p>Fri Jun  1 08:50:47 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c:  Updated Array documentation formatting.  Patch by Zachary 	 
Scott.  [ruby-trunk - Feature #6517]</p>

<p>Fri Jun  1 06:57:10 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/dl/lib/dl/struct.rb (DL::CStructEntity#set_ctypes):  Refactored 	 
#set_ctypes using newer ruby features to simplify its implementation. 	*
test/dl/test_c_struct_entry.rb (class DL):  Test to verify 	  refactoring.</p>

<p>Fri Jun  1 06:40:25 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c (Init_Object):  Restored Kernel documentation based on 	 
Pickaxe book documentation.  Patch by Zachary Scott. 	  [ruby-trunk -
Feature #6521]</p>

<p>Fri Jun  1 06:29:42 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c (rb_equal):  Let Object be a link in #=== documentation. 	 
Patch by Zachary Scott.  [ruby-trunk - Feature #6518]</p>

<p>Thu May 31 09:27:06 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/dl/lib/dl/struct.rb (DL::CStructEntity::size):  Refactored ::size 	 
to remove unused variables and simplify using newer ruby features. 	*
test/dl/test_c_struct_entry.rb:  Test to validate refactoring</p>

<p>Thu May 31 08:40:34 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/dl/lib/dl/struct.rb (DL::CUnionEntity#set_ctypes):  Refactored 	 
#set_types to reuse DL::CUnionEntity::size 	*
test/dl/test_c_union_entity.rb:  Added test</p>

<p>Thu May 31 08:20:14 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/dl/lib/dl/struct.rb (DL::CUnionEntity::size):  Fixed ::size to 	 
return the size of the union. 	* test/dl/test_c_union_entity.rb:  Test for
DL::CUnionEntity::size</p>

<p>Thu May 31 07:45:43 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/dl:  Added documentation.  Patch by Vincent Batts. 	  [ruby-trunk -
Bug #6496]</p>

<p>Wed May 30 16:30:00 2012  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/jacobian.rb, 	 
ext/bigdecimal/lib/bigdecimal/newton.rb: 	  fix documentation comments. 	 
Patch by alperakgun from github.com/shyouhei/ruby/pull/8</p>

<p>Wed May 30 16:20:00 2012  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/jacobian.rb (Jacobian#dfdxi): 	  fix
jacobian to get stuck in an infinite loop when a solution is not 	  found
due to forget to increment nRetry counter. 	  Patch by alperakgun from
github.com/shyouhei/ruby/pull/8</p>

<p>Wed May 30 10:58:31 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* time.c (utc_offset_arg): utc offset can be precision in seconds. 	  e.g.
old Europe/Lisbon (c.f. [ruby-dev:40066])</p>

<p>Wed May 30 06:20:29 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* error.c (exc_set_backtrace):  Updated documentation to indicate 	 
set_backtrace allows a string as well as an array of strings. 	 
[ruby-trunk - Bug #6501]</p>

<p>Tue May 29 17:28:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): support GNU extension triple 	 
colons modifier.  [EXPERIMENTAL]</p>

<p>* strftime.c (rb_strftime_with_timespec): check conversion with locale 	 
modifier.</p>

<p>* strftime.c (rb_strftime_with_timespec): colons are valid only for 	 
&#39;z&#39; and must come just before it.</p>

<p>Mon May 28 16:56:55 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_prepare_run): StatusLineOutput 	 
needs job_status to be :replace.</p>

<p>Mon May 28 13:35:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (do-install-*): fix dependencies.  based on the patch by 	 
nagachika at [ruby-dev:45683].  [Bug #6506]</p>

<p>Mon May 28 12:03:04 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (obj_free): doesn&#39;t free a method table if it doesn&#39;t 	 
exist. [ruby-dev:44436] 	* test/ruby/test_gc.rb (class TestGc): added the
test case for 	  this issue.</p>

<p>Sun May 27 23:37:48 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bm_vm1_lvar_init.rb: added. 	  This benchmark measures a
initialize time of non-used variable.</p>

<p>* benchmark/bm_vm1_lvar_set.rb: added. 	  This benchmark measures a local
variables initialization time.</p>

<p>* benchmark/bm_vm2_bigarray.rb: added. 	  This benchmark mesures a big
array literal creation time.</p>

<p>* benchmark/bm_vm2_bighash.rb: added. 	  This benchmark mesures a big hash
literal creation time.</p>

<p>* benchmark/bm*: change notation “i=0” to “i = 0”.</p>

<p>Sun May 27 13:33:26 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: fix to continue benchmarks when 	  an error is
occurred.</p>

<p>Sun May 27 11:27:50 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_prepare_run): fix operator 	 
precedence, so that platform and TERM should be counted.</p>

<p>Sun May 27 10:02:33 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strftime.c: allows %Ok and %Ol.</p>

<p>Sun May 27 09:29:20 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: modified doc.</p>

<p>Sat May 26 19:04:34 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: added description.</p>

<p>Sat May 26 18:14:57 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strftime.c: reduced the code.</p>

<p>Sat May 26 18:08:59 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* time.c: modified doc. 	* ext/date/date_core.c: ditto.</p>

<p>Sat May 26 17:05:45 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (backtrace_*): change type of lev and n from size_t to int. 	  Also
set type of rb_backtrace_t#backtrace_size to int. 	  A patch from nobu.</p>

<p>* vm_eval.c: ditto.</p>

<p>Sat May 26 16:26:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (realpath_rec): UNC prefix does not end with path separator, 	 
so new separator is needed after it.</p>

<p>Sat May 26 15:29:22 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_backtrace.rb (test_caller_lev): 	  decrease recursion
size.</p>

<p>Sat May 26 13:50:48 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* NEWS: add Kernel#caller&#39;s second argument.</p>

<p>Sat May 26 13:40:29 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (RubyVM::FrameInfo): add a class to access each frame 	 
information.  You don&#39;t need to parse strings from caller(). 	 
FrameInfo has the following methods: 	    FrameInfo#name: method name,
class name, etc with decorations. 	    FrameInfo#basename: name without
decorations. 	    FrameInfo#line_no: line number. 	    FrameInfo#filename:
file name. 	    FrameInfo#filepath: full filepath. 	    FrameInfo#iseq:
iseq if it is iseq frame (defined by ruby script) 	    FrameInfo#to_s:
return caller() method style string. 	  RubyVM::FrameInfo.caller(n, lev)
returns array of FrameInfo objects. 	  The name “RubyVM::FrameInfo.caller”
is long and ambiguous (it is 	  confusing with Kernel::caller() method), we
need to change the name 	  before Ruby 2.0 release. Good names or comments
are welcome.</p>

<p>* test/ruby/test_backtrace.rb: add a test for above change.</p>

<p>Sat May 26 12:18:09 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (frame_info_to_str): add `break&#39;.</p>

<p>* vm.c (backtrace_object): remove lev and n parameter. 	  backtrace_object
always returns all of backtrace information.</p>

<p>* vm.c (rb_backtrace_to_str_ary): fix to use backtrace_object(). 	  This
change improve performance of caller(lev, n).</p>

<p>* benchmark/bm_vm3_backtrace.rb: added to check above improvement. 	  FYI:
measurement on my laptop, 1.9.3p229 needs 5.125 sec, 	  and current trunk
only needs 0.299sec.</p>

<p>Sat May 26 11:05:09 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (rb_frame_info_t): keep previous ISEQ frame info for CFUNC 	  frame
info.  And fix to cache a calculated line_no of ISEQ frame 	  info.</p>

<p>Sat May 26 09:54:53 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Allow disabling client-side renegotiation. 	*
test/openssl/test_ssl.rb: Simple tests for this.</p>

<p>Client-side renegotiation is still considered problematic, even 	  when
used in the context of secure renegotiation (RI, RFC 5746). 	  The changes
allow users to either completely disable client 	  renegotiation on the
server, or to specify a maximum number of 	  handshakes allowed in total.
The number of total handshakes is 	  counted in a callback set as
SSL_set_info_callback. If the 	  maximum number of handshakes is exceeded
an error will be raised 	  We do not support renegotiation in the OpenSSL
extension, therefore 	  this feature can only be tested externally. 	  The
feature is opt-in, the default setting will be to allow 	  unlimited client
renegotiation, as was the case before.</p>

<p>Fri May 25 23:38:58 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_ssl.rb: Clarify the intention of errors to be 	 
expected. Two errors are possible when connection is refused due 	  to a
protocol version that was explicitly disallowed, 	  OpenSSL::SSL::SSLError
or Errno::ECONNRESET, depending on the 	  OpenSSL version in use.</p>

<p>Fri May 25 22:19:40 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Revert r35583 	* test/openssl/test_ssl.rb:
Handle ECONNRESET in code instead to avoid 	  the test failing in Ruby CI
[1]</p>

<p>[1] <a
href="http://u64.rubyci.org/~chkbuild/ruby-trunk/log/20120507T190102Z.log.html.gz#test-all">u64.rubyci.org/~chkbuild/ruby-trunk/log/20120507T190102Z.log.html.gz#test-all</a></p>

<p>Fri May 25 19:51:36 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_eval.c (rb_f_caller): caller() method accepts second optional 	 
argument `n&#39; which specify how many frames should return. 	  For
example, `caller(0, 1)&#39; returns only one frame information 	  which
calls caller() method.  If there are less than n frame 	  information, then
all frame information are returned.  If n is 0, 	  then always return []. 	
This fix is part of [ruby-dev:42345] [Ruby 1.9-Feature#3917]. 	  However,
performance and features are not enough. 	  RDoc is also not available.</p>

<p>* test/ruby/test_backtrace.rb: add a test for above.</p>

<p>Fri May 25 17:05:07 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (oldbt_init, vm_backtrace_str_ary): arg-&gt;data should 	  be
initialized before calling `backtrace_each()&#39;.</p>

<p>Fri May 25 16:11:27 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* trunk/ext/-test-/printf/printf.c: change function names because of 	 
conflict with msvcrt.  fixed build error of mswin.</p>

<p>Fri May 25 10:52:52 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c: refactoring backtrace related functions. 	  (1) unify similar
functions (rb_backtrace_each() and 	      backtrace_object()). 
backtrace_each() is a unified function. 	      variation: 	      a)
backtrace_object(): create backtrace object. 	      b)
vm_backtrace_str_ary(): create bt as an array of string. 	      c)
vm_backtrace_print(): print backtrace to specified file. 	      d)
rb_backtrace_print_as_bugreport(): print backtrace on 	                    
bugreport style. 	  (2) remove rb_backtrace_each().  Use backtrace_each()
instead. 	  (3) change the type of lev parameter to size_t. 	      a) lev
== 0 means current frame (exception, etc use it). 	      b) lev == 1 means
upper frame (caller(0) use it).</p>

<p>* vm_core.h, vm_dump.c, vm_eval.c: ditto.</p>

<p>* vm.c (backtrace_object(), vm_backtrace_str_ary()): fix to return a 	 
correct size of caller(lev) array. 	  Let n be a “caller(0).size” then ln
as caller(lev).size should be 	  (n - lev).  However, the previous
implementation returns a wrong 	  size array (ln &gt; n - lev). 
[ruby-dev:45673]</p>

<p>* test/ruby/test_backtrace.rb: add tests for backtrace.</p>

<p>Fri May 25 08:51:39 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enum.c (enum_count):  Enumerable#count no longer uses #size when 	 
counting elements.  Patch by Nobuhiro IMAI.  [ruby-trunk - Bug #6473]</p>

<p>Fri May 25 01:15:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (ruby__sfvextra): [EXPERIMENTAL] use inspect instead of 	 
to_s if plus flag is given.</p>

<p>* vsnprintf.c (BSD_vfprintf): pass sign flag.</p>

<p>Fri May 25 00:37:22 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_indexer.rb (setup, teardown): save @tempdir 	  to
remove it properly.  [Bug #5348]</p>

<p>Thu May 24 23:36:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vsnprintf.c (BSD_vfprintf): [EXPERIMENTAL] object representation in 	 
rb_enc_vsprintf(). [Feature #5896]</p>

<p>Thu May 24 15:33:01 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_method.c (rb_method_defined_by): removed. 	  nobu pointed out that
rb_method_basic_definition_p() is enough 	  for last commit.</p>

<p>* error.c, eval_error.c: change for above.</p>

<p>Thu May 24 14:30:13 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c: add RubyVM::Backtrace object (btobj). 	  Backtrace information
contains an array consists of location 	  information for each frames by
string. 	  RubyVM::Backtrace object is lightweight backtrace information, 	
which contains complete information to generate traditional style 	 
backtrace (an array of strings) with faster generation. 	  If someone
accesses to backtrace information via 	  Exception#backtrace, then convert
a RubyVM::Backtrace object to 	  traditional style backtrace. 	  This
change causes incompatibility on marshal dumped binary 	  of Exception.  If
you have any trouble on it, please tell us 	  before Ruby 2.0 release. 	 
Note that RubyVM::Backtrace object should not expose Ruby level.</p>

<p>* error.c, eval.c, vm_eval.c: ditto.</p>

<p>* internal.h: ditto.</p>

<p>* eval_error.c: fix to skip “set_backtrace” method invocation in 	 
creating an exception object if it call a normal set_backtrace 	  method
(defined by core).</p>

<p>* test/ruby/test_settracefunc.rb: fix for above change.</p>

<p>* vm_method.c (rb_method_defined_by): added.  This function 	  checks that
the given object responds with the given method 	  by the given cfunc.</p>

<p>* benchmark/bm_vm2_raise1.rb, benchmark/bm_vm2_raise2.rb: 	  add to
measure exception creation speed. raise1 create 	  exception objects from
shallow stack frame.  raise2 create 	  exception objects from deep stack
frame.</p>

<p>Thu May 24 12:07:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_strip_bom): check EOF.  [Bug #<a
href="ruby-core:45203">6487]</a></p>

<p>Wed May 23 22:06:14 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http/header.rb (Net::HTTPHeader#range): fix broken parser of 	 
HTTP Range request. Old one can&#39;t parse invalid specs and multiple 	 
specs correctly.</p>

<p>Wed May 23 10:18:54 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (finish_overlapped_socket, overlapped_socket_io): 	 
replace ECONNABORTED to EPIPE in send, sendto and sendmsg to improve 	  BSD
socket compatibility.  this change removes a failure on the test 	  of
net/ftp.</p>

<p>Wed May 23 05:35:58 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Broke up Net::HTTP into individual files. 	 
[ruby-trunk - Feature #6435] 	* lib/net/http/backward.rb:  ditto. 	*
lib/net/http/response.rb:  ditto. 	* lib/net/http/exceptions.rb:  ditto. 	*
lib/net/http/responses.rb:  ditto. 	* lib/net/http/generic_request.rb: 
ditto. 	* lib/net/http/header.rb:  ditto. 	* lib/net/http/request.rb: 
ditto. 	* lib/net/http/proxy_delta.rb:  ditto. 	* lib/net/http/requests.rb:
ditto.</p>

<p>Wed May 23 05:15:11 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* class.c (rb_mod_init_copy):  Clear the cached inspect string of a 	 
dup&#39;d anonymous module or class.  [ruby-trunk - Bug #6454] 	*
test/ruby/test_module.rb (class TestModule):  ditto</p>

<p>Tue May 22 16:49:15 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: add a data type rb_location_t to store iseq location 	 
information. 	  rb_location_t#filename, filepath, name and line_no was
moved from 	  rb_iseq_t.  rb_location_t#basename is a new field which is 	 
similar to `name&#39; field without any decoration. 	  `name&#39; field
contains some decoration such as `block in foo&#39;. 	  `basename&#39; only
contains `foo&#39;. 	  rb_iseq_t contains memory object of rb_location_t.</p>

<p>* iseq.c: setup rb_location_t for each rb_iseq_t memory objects.</p>

<p>* compile.c, proc.c, vm.c, vm_dump.c, vm_eval.c, vm_insnhelper.c, 	 
vm_method.c: support about it.</p>

<p>Tue May 22 00:45:05 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* struct.c (rb_struct_members): Refactoring.  As Struct#members had 	 
returned an array of String, the old code was needed to convert 	  Symbols
to Strings.  But it is almost unnecessary because the 	  method now returns
an array of Symbols.  A patch by Masaki 	  Matsushita &lt;glass.saga at
gmail dot com&gt;  [Feature #6218] 	  [ruby-dev:45451]</p>

<p>Mon May 21 19:20:25 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (Net::FTP#retrbinary): close only if conn is not nil 	 
because transfercmd may fail and return nil.</p>

<p>* lib/net/ftp.rb (Net::FTP#retrlines): ditto.</p>

<p>Mon May 21 15:10:28 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* ext/syslog/syslog.c: Classify constants and macros into several 	 
sub-modules. (Syslog::Priority, Syslog::Level, Syslog::Option 	  and
Syslog::Macros)</p>

<p>* ext/syslog/syslog.c (mSyslog_inspect): Use rb_sprintf().</p>

<p>* ext/syslog/syslog.c (mSyslog_inspect): Make sure self is a 	  module
before calling rb_class2name().</p>

<p>Mon May 21 12:44:11 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (install): It seems tcl/tk is skipped in Travis 	  CI.
Trying to fix the situation.</p>

<p>Mon May 21 12:11:25 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/depend (ENCOBJS): add dependencies.</p>

<p>* enc/make_encmake.rb (target_encodings): extract dependencies.</p>

<p>Mon May 21 11:26:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (Net::FTP#transfercmd): rescue shutdown.</p>

<p>Sun May 20 23:00:11 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extmake): reopen $stdout to NULL, since setting 	  $stdout
cannot affect child processes.</p>

<p>Sun May 20 21:36:39 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* enc/shift_jis.c (code_to_mbclen): return 	 
ONIGERR_INVALID_CODE_POINT_VALUE if the code is invalid.</p>

<p>* string.c (tr_next): increment character until the code 	  is a valid
character. [ruby-dev:45652] [Bug #6450]</p>

<p>Sun May 20 12:25:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (LIBRUBY_SO): link EXTSOLIBS too.</p>

<p>* ext/extmk.rb (mf.macro): use EXTSOLIBS instead of SOLIBS to get rid 	 
of discard libraries needed by default.  [Bug #6462]</p>

<p>Sat May 19 19:04:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (command_output): ENCOBJS is needed for all linked 	  ruby,
if –disable-shared and –with-static-linked-ext.</p>

<p>* ext/extmk.rb (command_output): dmyext is needed as DLDOBJS if no 	 
static linked extensions.</p>

<p>* Makefile.in, common.mk (PROGRAM): no extension libraries.</p>

<p>* common.mk (build-ext): pass macros for libruby.so.</p>

<p>* ext/extmk.rb (command_output): link extension libraries and encoding 	 
libraries into libruby.so, not ruby executable.</p>

<p>* ext/extmk.rb (command_output): fold long macro lines.</p>

<p>* Makefile.in (LIBEXT): add macro.</p>

<p>* configure.in (ENCOBJS, EXTOBJS): use LIBEXT, not hardcoded suffix.</p>

<p>* Makefile.in (LIBRUBY_A): fix typo.  re-applying r35242.</p>

<p>Sat May 19 04:46:53 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/openssl/extconf.rb: Use Logging::message instead of message. 	*
ext/zlib/extconf.rb: ditto.</p>

<p>Fri May 18 18:13:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#configuration): keep space at end of 	 
OUTFLAG and COUTFLAG.  [ruby-dev:45650]</p>

<p>Fri May 18 17:39:42 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): Added error 	  check
when failing fcntl(). [Bug #6147] [ruby-dev:45364]</p>

<p>Fri May 18 17:41:00 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extmake): link archives only, skip script only 	 
extension libraries.</p>

<p>Fri May 18 17:25:33 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* cont.c: bump up fiber machine stack size when running on 64bit 	  arch.
[Bug #6344] [ruby-dev:45554]</p>

<p>Fri May 18 15:20:56 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/generic.rb (URI::Generic.build): duplicate args before adding 	 
new items. (don&#39;t change arguments)</p>

<p>* lib/uri/generic.rb (URI::Generic.build): use URI::Generic::COMPONENT 	 
if this method is called from URI::Generic.</p>

<p>* lib/uri/generic.rb (URI::Generic.build2): escape only if the item is 	 
a String.</p>

<p>* lib/uri/generic.rb (URI::Generic.build2): use DEFAULT_PARSER because 	 
it doesn&#39;t have parser method. [Bug #6420]</p>

<p>Fri May 18 15:54:07 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/zlib/extconf.rb: Use an exception instead of bare puts.</p>

<p>Fri May 18 15:53:05 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/psych/extconf.rb: Use an exception instead of bare abort.</p>

<p>Fri May 18 15:51:32 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/fiddle/extconf.rb: Use an exception instead of bare abort.</p>

<p>Fri May 18 15:49:35 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/readline/extconf.rb: Use an exception instead of bare exit.</p>

<p>Fri May 18 15:38:11 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/ripper/extconf.rb: Use an exception instead of bare 	 
Logging.message.</p>

<p>Fri May 18 15:23:06 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/openssl/extconf.rb: Clarify a message when hit Apple 	  OpenSSL
issue.</p>

<p>Fri May 18 15:14:32 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/extmk.rb: Show a message when extconf.rb raised an exception. 	*
ext/openssl/extconf.rb: Use exception raising instead of message 	  and/or
abort. We want to display error message to console <em>and</em> 	  logging
into mkmf.log.</p>

<p>Fri May 18 06:14:07 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/syslog/lib/syslog/logger.rb:  Added Syslog::Logger which was 	 
ported from the SyslogLogger gem.  [ruby-trunk - Feature #5096] 	* NEWS: 
ditto. 	* test/syslog/test_syslog_logger.rb:  ditto.</p>

<p>Fri May 18 01:28:21 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c (transcode_string): fix encoding index names. 	 
Thanks markizko for reporting.</p>

<p>Thu May 17 23:03:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: fix function name to be checked, to initialize 	 
rb_thread_cond_t properly.</p>

<p>* thread_pthread.c (native_cond_initialize, native_cond_destroy): 	  fix
macro name.</p>

<p>Thu May 17 12:53:07 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* thread.c, thread_pthread.c: Moved pthread-specific preprocessor 	  hacks
to thread_pthread.c</p>

<p>Thu May 17 12:18:47 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* io.c: Fix a mistake on merging the patch in the previous commit.</p>

<p>Thu May 17 11:33:07 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>Imports Ruby&#39;s port to NativeClient (a.k.a NaCl). 	Patch by Google
Inc. [ruby-core:45073].</p>

<p>* configure.in (RUBY_NACL): New M4 func to configure variables for 	 
NaCl. 	  (RUBY_NACL_CHECK_PEPPER_TYPES): New M4 func to check the old names
	  of Pepper interface types. 	  (BTESTRUBY): New variable to specify which
ruby should be run on 	  “make btest”. NaCl can run the built binary by
sel_ldr, but it need 	  rbconfig.rb. So this variable is distinguished from
$MINIRUBY.</p>

<p>* thread_pthread.c: Disabled some features on NaCl.</p>

<p>* io.c: ditto.</p>

<p>* process.c: ditto.</p>

<p>* signal.c: ditto.</p>

<p>* file.c: ditto.</p>

<p>* missing/flock.c: ditto.</p>

<p>* nacl/pepper_main.c: An example implementation of Pepper application 	 
that embeds Ruby.</p>

<p>* nacl/example.html: An example of web page that uses the Pepper 	 
application.</p>

<p>* nacl/nacl-config.rb: Detects variants of NaCl SDK.</p>

<p>* nacl/GNUmakefile.in: Makefile template for NaCl specific build 	 
process.</p>

<p>* nacl/package.rb: script for packaging a NaCl-Ruby embedding 	 
application.</p>

<p>* nacl/reate_nmf.rb: Wrapper script of create_nmf.py</p>

<p>* dln.c (dln_load): Added a hack to call on NaCl.</p>

<p>* util.c (ruby_getcwd): Path to the current directory is not available 	 
on NaCl.</p>

<p>Thu May 17 10:54:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/tk/extconf.rb: add -l options to $libs not $LDFLAGS, 	  to be passed
to EXTLIBS in exts.mk.</p>

<p>* enc/encinit.c.erb: use %-lines to adjust indent in the generated file.</p>

<p>* lib/mkmf.rb (MakeMakefile#have_framework): combine -framework option 	 
and its argument with an equal sign not to be separated in merge_libs.</p>

<p>* ext/tk/extconf.rb: ditto.</p>

<p>* ext/extmk.rb: EXTLDFLAGS also needs to be passed.</p>

<p>Wed May 16 15:44:22 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>* configure.in: Fix an unbalanced quote.</p>

<p>Wed May 16 15:43:10 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (exts.mk): use double quotes instead of single quotes 	 
for commandline because it&#39;s not recognized as quotes on Windows.</p>

<p>Wed May 16 15:15:55 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (LD): enclose with single quotes but not double quotes 	 
not to expand command substitution.</p>

<p>Wed May 16 14:19:51 2012  Yuki Yugui Sonoda  &lt;yugui@google.com&gt;</p>

<p>Supports static linking of extensions and encodings again. 	Fixes
–with-static-linked-ext.</p>

<p>Patch by Google Inc. [ruby-core:45073].</p>

<p>* Makefile.in (ENCOBJS, EXTOBJS): New variables to specify static 	 
linked libraries. Also reintroduces extinit.o, introduces encinit.o 	 
introduces encinit.o</p>

<p>* common.mk: Builds static libraries rather than shared objects if 	 
specified.</p>

<p>* configure.in (LD): new substitution.</p>

<p>* enc/depend: Supports static linked libraries 	  (libencs, libenc,
libtrans): New target.</p>

<p>* enc/encinit.c.erb: new template to generate the initialization of 	 
statically linked encodings.</p>

<p>* enc/make_encmake.rb (–module): new flag to specify whether static 	  or
dynamic.</p>

<p>* transcode_data.h (TRANS_INIT): New macro to get rid of the name 	 
collision of encoding initializers and transcoder initializers.</p>

<p>* ext/extmk.rb: Fixes the behavior on $extstatic is true.</p>

<p>* lib/mkmf.rb (clean-static): new target to clean up static linked 	 
libraries.</p>

<p>* ruby.c (process_options): New initializes statically linked 	  encodings
here.</p>

<p>Wed May 16 14:30:43 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c: fixed a merge mistake of r33878, reported by nobu via IRC.</p>

<p>Wed May 16 06:59:41 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strftime.c: should also be aware of flags on 	  complex
specifier.</p>

<p>Wed May 16 05:11:29 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: fix a bug with string 	 
subclass dumping and loading.</p>

<p>* test/psych/test_array.rb: pertinent tests</p>

<p>* test/psych/test_string.rb: ditto</p>

<p>Wed May 16 01:31:21 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: convert omap tagged maps to 	 
Psych::Omap objects rather than hashes. [Bug #6425]</p>

<p>* test/psych/test_omap.rb: pertinent test.</p>

<p>Wed May 16 01:15:45 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: keep a reference to 	  custom
coders so that GC does not impact dumped yaml reference ids.</p>

<p>Tue May 15 23:59:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Options#setup_options): add –color option.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_prepare_run): defer color code 	 
initialization to regard –color option.</p>

<p>Mon May 14 16:28:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (f_arglist): should reset lexical states after empty 	  argument
list with no parenthesis as well as parenthesized list, 	  so that reserved
name method definition work.  [ruby-dev:45626] 	  [Bug #6403]</p>

<p>Mon May 14 00:14:24 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_take_func, lazy_take): multiple calls of 	 
force/to_a method to Enumerator::Lazy#take should return same 	  results.
[ruby-dev:45634] [Bug #6428]</p>

<p>* test/ruby/test_lazy_enumerator.rb (test_take_recycle): add test for 	 
above.</p>

<p>Sun May 13 23:38:31 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io.rb (test_flush_in_finalizer1): don&#39;t use IO.for_fd
	  to close IO objects. it create IO object with already closed fd, and 	 
cause occasional Errno::EBADF in following tests. [ruby-core:45020] 	  [Bug
#6228]</p>

<p>Sun May 13 23:32:16 2012  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io.rb (TestIO): revert r35631. it broke the intent of 	 
test_flush_in_finalizer1.  [ruby-core:43951] [Bug #6228]</p>

<p>Sun May 13 22:46:36 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/etc/etc.c (passwd_ensure): move endpwent() call from 	 
passwd_iterate to close /etc/passwd on exception. 	  (group_ensure): move
endgrent() call from group_iterate to close 	  /etc/group on exception.</p>

<p>Sun May 13 18:10:43 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strftime.c: removed unused code and changed the style.</p>

<p>Sun May 13 17:37:56 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strftime.c: refactored.</p>

<p>Sun May 13 06:40:12 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (class TestIO):  Disable GC during IO tests to 	 
avoid file descriptors being GC&#39;ed. Suggestion by Tomoyuki Chikanaga 	 
[ruby-core:43951][Bug #6228]</p>

<p>Sat May 12 07:00:16 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/sdbm/init.c:  Added documentation.  Patch by Justin Collins, 	 
cleanup by Zachary Scott.  [ruby-trunk - #6410]</p>

<p>Sat May 12 06:02:03 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/fileutils.rb (cp_r):  Fixed cp_r example.  Patch by TJ Koblentz 	 
from pull request #114.  [ruby-trunk - Bug #6411]</p>

<p>Sat May 12 05:23:06 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (rb_threadptr_execute_interrupts_common): 	 
test_signal_requiring of test/ruby/test_signal.rb fail if the sub 	 
process is killed on waiting IO in lex_io_gets in rb_load_file in 	 
rb_load_internal in require. 	  This is because 	  (1) the process receive
the killing signal in 	      rb_thread_io_blocking_region in
rb_read_internal in lex_io_gets. 	  (2) set th-&gt;errinfo as
INT2FIX(TAG_FATAL) at 	      rb_threadptr_execute_interrupts_common. 	  (3)
escape rb_load_file in rb_load_internal and jump to EXEC_TAG() 	     
without set loaded as TRUE. 	  (4) call first
rb_exc_raise(GET_THREAD()-&gt;errinfo); because loaded 	      is FALSE as
above. this errinfo should be an exception object 	      but this is
INT2FIX(TAG_FATAL). 	  Don&#39;t call first rb_exc_raise if
GET_THREAD()-&gt;errinfo is Fixnum.</p>

<p>Fri May 11 14:23:11 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (primary): begin/end block should be isolated from outside. 	 
[ruby-dev:45631][Bug #6419]</p>

<p>Fri May 11 14:09:47 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (PUSH): to prevent VALUE from GC, 	  must
not cast it to unsigned long, which may be shorter than 	  VALUE, and the
result can be mere garbage.</p>

<p>Fri May 11 09:51:07 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#failed): no unnecessary 	  newlines
if no reports to be displayed.</p>

<p>Thu May 10 10:55:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/minitest/test_minitest_mock.rb: Correct requiring path to 	 
metametameta.rb.</p>

<p>* test/minitest/test_minitest_unit.rb: Correct requiring path to 	 
metametameta.rb.</p>

<p>Thu May 10 10:18:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (lex_state_name): returns name for lex_state_e, for debug 	 
use.</p>

<p>Wed May  9 16:36:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#pkg_config): check if libs resulted from 	 
pkg-config works actually.</p>

<p>Wed May  9 16:01:38 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (decode_utf7, encode_utf7): refactored by 	  Nobuyoshi
Nakada, to use String#encode.</p>

<p>Wed May  9 13:26:25 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_remote_fetcher.rb: skip OpenSSL dependent 	 
tests if not available.</p>

<p>Wed May  9 08:09:38 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 3.0.0 (r7435) 	* test/minitest/*:
ditto 	* test/rubygems/*: Imported fixes for buggy use of assert_match 	 
and deprecated assert_block 	UNBUNCH YOUR PANTIES. THE TESTS DO NOT RUN
CLEAN ON OSX.</p>

<p>Wed May  9 06:28:59 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* re.c (rb_reg_equal):  Removed incorrect example for Regexp#== with 	 
“n” option.  [ruby-talk - Bug #6415]</p>

<p>Wed May  9 06:23:33 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: reverted.</p>

<p>Wed May  9 04:31:26 2012  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* lib/rinda/ring.rb (lookup_ring_any): fix Rinda::RingFinger.primary 	 
hungs forever. [ruby-talk:395364]</p>

<p>Tue May  8 21:09:00 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* include/ruby/win32.h (FD_SET): change function to macro. 	  To avoid
buffer overflow when smaller FD_SETSIZE is used in ext 	  libraries.</p>

<p>* win32/win32.c (rb_w32_fdset): this function is not used anymore. 	  But
we leave this for compatibility.</p>

<p>* win32/win32.c (rb_w32_select_with_thread): fix SEGV when smaller 	 
FD_SETSIZE is used in ext libraries. Dereference of fd_set pointer 	 
causes SEGV.</p>

<p>* test/-ext-/win32/test_fd_setsize.rb(TestFdSetSize): add tests for 	 
above. 	* ext/-test-/win32/fd_setsize/depend: ditto. 	*
ext/-test-/win32/fd_setsize/extconf.rb: ditto. 	*
ext/-test-/win32/fd_setsize/fd_setsize.c: ditto.</p>

<p>[ruby-core:44588] [Bug #6352]</p>

<p>Tue May  8 20:44:46 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* io.c (io_unread): fix IO#pos with mode &#39;r&#39; bug on Windows. 	  If
the end of reading buffer is CR, io_unread() needs to unread one 	  more
byte. 	  [ruby-core:44874] [Bug #6401]</p>

<p>* test/ruby/test_io_m17n.rb (TestIO_M17N#test_pos_with_buffer_end_cr): 	 
add a test for above.</p>

<p>Tue May  8 13:38:17 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/date/date_core.c: improving introduction in Date/DateTime 	 
documentation. patched by Daniel Kaufman via Github. 		<a
href="https://github.com/ruby/ruby/pull/110">github.com/ruby/ruby/pull/110</a></p>

<p>Tue May  8 13:36:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (POSTLINK): default to : command to get rid of flag 	  only
command, since BSD make does not work with it.</p>

<p>Tue May  8 13:35:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (MiniTest#run_test): remove exact trace and get rid 	 
of IndexError, which could caused by modified $@ sometimes.</p>

<p>Tue May  8 11:21:27 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/minitest/metametameta.rb (MetaMetaMetaTestCase#assert_report): 	 
support drive letter on Windows.  yes, the original code is metameta.</p>

<p>Tue May  8 08:54:48 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/abbrev.rb:  Fixed typo in abbrev pattern documentation.  Based on 	 
patch by Mark Rushakoff.  [ruby-trunk - #6346]</p>

<p>Tue May  8 07:44:18 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_start_ssl): remove useless rb_sys_fail 	 
before ossl_raise. this cause a test failure on Linux. 	 <a
href="http://u64.rubyci.org/~chkbuild/ruby-trunk/log/20120507T190102Z.log.html.gz">u64.rubyci.org/~chkbuild/ruby-trunk/log/20120507T190102Z.log.html.gz</a></p>

<p>Tue May  8 05:35:18 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c (Init_Object):  Added reference to variable.c where 	 
public_constant and private_constant documentation lives.  [#6381]</p>

<p>Tue May  8 04:47:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#output): prefer local output to 	 
get rid of unexpected side effect in test/minitest/metametameta.rb.</p>

<p>* lib/test/unit.rb (MiniTest#run_test): show the running test in $0.</p>

<p>* lib/test/unit.rb (Test::Unit::StatusLineOutput): new class to output 	 
in status line.</p>

<p>* test/testunit/test_hideskip.rb (TestHideSkip#test_hideskip): 	 
MiniTest#puke now reports Skipped messages only if verbose mode.</p>

<p>* test/testunit/test_sorting.rb (TestTestUnitSorting#test_sorting): 	 
ditto.</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#puke): modify only result and 	 
drop useless reports, not override entirely.</p>

<p>* bootstraptest/runner.rb (exec_test, show_progress): show rotators 	  and
pass/fail counts.</p>

<p>* sample/test.rb (PROGRESS): refine output.</p>

<p>Tue May  8 02:34:26 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/minitest/unit.rb (assert_match): refix of r35563. 	  r35563 breaks
the intention of the original change. 	 <a
href="https://github.com/seattlerb/minitest/commit/68858105b2eb11c85105ffac5f32b662c59397f3">github.com/seattlerb/minitest/commit/68858105b2eb11c85105ffac5f32b662c59397f3</a>
	* lib/minitest/unit.rb (refute_match): ditto.</p>

<p>Mon May  7 21:19:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json: Merge JSON 1.7.1. 	 <a
href="https://github.com/flori/json/commit/e5b9a9465c1159fae533bca320d950b772bcb4ac">github.com/flori/json/commit/e5b9a9465c1159fae533bca320d950b772bcb4ac</a></p>

<p>Mon May  7 22:54:22 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: add support for option flags 	 
OpenSSL::SSL::OP_NO_TLSv1_1 	  OpenSSL::SSL::OP_NO_TLSv1_2 	  to allow
blocking specific TLS versions. Thanks to Justin Guyett for 	  pointing
this out to me. 	* test/openssl/test_ssl.rb: add tests to assert correct
behavior when 	  blocking certain versions of TLS/SSL both on server and
client side. 	  Also refactored tests to reduce boilerplate code a little.
	* test/openssl/utils.rb: rescue Errno::ECONNRESET for tests where 	 
client rejects the connection because a forbidden protocol version 	  was
used.</p>

<p>Mon May  7 20:14:15 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/securerandom.rb (random_bytes): call to_int method for the 	 
argument at first.</p>

<p>Mon May  7 17:54:12 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/minitest/unit.rb (assert_match): replace matcher only if both 	 
matcher and obj are String. fix r35541. [Bug #6405] 	  DON&#39;T COMMIT IF
YOU CAN&#39;T RUN TEST. 	  FIX AS SOON AS POSSIBLE YOU BREAK TESTS. 	 
patched by ayumin. 	  <a
href="https://github.com/seattlerb/minitest/pull/124">github.com/seattlerb/minitest/pull/124</a></p>

<p>* lib/minitest/unit.rb (refute_match): ditto.</p>

<p>Mon May  7 13:41:00 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (PROGRAM), configure.in (POSTLINK): sign built program 	 
using RUBY_CODESIGN identity.</p>

<p>Mon May  7 13:03:55 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (body_type_attachment): parse body type 	  “ATTACHMENT”.
[ruby-core:44849] [Bug #6397]</p>

<p>Mon May  7 10:49:36 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (Init_bigdecimal): define IDs before 	  they
are used. [ruby-core:44900] [Bug #6406]</p>

<p>Mon May  7 10:27:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/digest/rmd160/rmd160.c (RMD160_Update): fix for huge data.</p>

<p>Mon May  7 10:23:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/fileutils/fileasserts.rb: use assert_equal, assert_match, and so
on.</p>

<p>* test/ruby/enc/test_utf16.rb, test/ruby/enc/test_utf32.rb, 	 
test/ruby/test_io_m17n.rb (assert_str_equal): ditto.</p>

<p>* test/rubygems/test_gem_remote_fetcher.rb 	 
(assert_data_from_<code>server,proxy</code>): ditto.</p>

<p>* test/test_pstore.rb (test_thread_safe): ditto.</p>

<p>Mon May  7 10:16:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_installer.rb (TestGemInstaller#test_dir): fix 	 
argument order.  expected value must come first.</p>

<p>Mon May  7 09:14:11 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: support TLSv1.1 &amp; TLSv1.2. Add 	 
SSLContext#version to inspect the version that was negotiated for 	  a
given connection. 	* ext/openssl/extconf.rb: detect TLS 1.1 &amp; 1.2
support. 	* test/openssl/test_ssl.rb: add tests for TLS 1.1 &amp; 1.2 given
they 	  are supported by the native OpenSSL being used.</p>

<p>Sun May  6 21:34:29 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (io_encoding_set): suppress warnings. [ruby-dev:45627] 	  this tmp1
is not required after r35538.</p>

<p>* addr2line.c: suppress warnings.</p>

<p>Sun May  6 18:39:39 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (iseq_compile_each): remove unused variable `size&#39;.</p>

<p>Sun May  6 14:50:03 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/securerandom.rb: show actual read length in an error message.</p>

<p>Sat May  5 06:43:10 2012  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 2.12.1 (r7323) 	* test/minitest/*:
ditto</p>

<p>Sat May  5 01:47:33 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/zlib/test_zlib.rb (test_inflate): add a test for Zlib.inflate. 	 
patched by headius (Charles Nutter). [ruby-core:44859] [Bug #6398]</p>

<p>* test/zlib/test_zlib.rb (test_deflate): add a test for Zlib.deflate.</p>

<p>Sat May  5 00:53:55 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (parse_mode_enc): remove warnings &#39;Ignoring internal
encoding&#39;. 	  [ruby-core:44455] [Bug #6324]</p>

<p>* io.c (io_encoding_set): ditto.</p>

<p>Fri May  4 07:19:02 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rdoc/parser.rb (RDoc.binary?): fix wrong regexp. 	 
[ruby-core:44798] [Bug #6393]</p>

<p>Fri May  4 01:33:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rdoc/parser.rb (RDoc.alias_extension): a real file is irrelevant 	 
to aliasing.  [ruby-core:44796][Bug #6392]</p>

<p>* lib/rdoc/parser.rb (RDoc.zip?): non-existent file will not be a zip 	 
file.</p>

<p>* lib/rdoc/parser.rb (RDoc.can_parse_by_name): accept aliased 	  extension
file names.</p>

<p>* lib/rdoc/parser.rb (RDoc.binary?): binary read data may have 	 
incomplete multibyte sequence.  [ruby-core:44798][Bug #6393]</p>

<p>Wed May  2 23:55:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::RequireFiles#non_options): expand 	  real
path to get rid of loading same files via symlinks.</p>

<p>Wed May  2 23:26:04 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* cont.c (rb_fiber_m_transfer): improve sample code in Fiber#transfer 	 
documentation. emphasize the difference between transfer and resume.</p>

<p>Wed May  2 23:21:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_yylex): allow spaces between lambda arrow and 	 
parenthesis.  [ruby-dev:45605][Feature #6390]</p>

<p>Wed May  2 19:06:30 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* cont.c (rb_fiber_m_transfer): Improved Fiber documentation. 	  patched
by Anuj Dutta. [ruby-core:44540][Bug #6343]</p>

<p>Wed May  2 13:06:37 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* README, README.ja: reformatted using rdoc markup.  based on the 	 
patches by zzak (Zachary Scott) in [Feature #6388].</p>

<p>* README, README.ja: updated the author&#39;s mail address.</p>

<p>Wed May  2 09:46:09 2012  Kouji Takao  &lt;kouji@takao7.net&gt;</p>

<p>* ext/readline/readline.c (Readline.special_prefixes=) 	 
(Readline.special_prefixes): new function. An original patch was 	  created
by nagachika. [Feature #5784]</p>

<p>Tue May  1 22:18:45 2012  Kouji Takao  &lt;kouji@takao7.net&gt;</p>

<p>* ext/readline/readline.c (Readline.pre_input_hook) 	 
(Readline.insert_text, Readline.redisplay): new function. An 	  original
patch was created by nagachika. [Feature #5785]</p>

<p>Tue May  1 15:46:48 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* common.mk: “$(Q)-…” doesn&#39;t work on nmake.</p>

<p>Tue May  1 15:32:10 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* common.mk: replace &#39;@&#39; prefix to &#39;$(Q)&#39; to control build
	  process outputs.</p>

<p>Tue May  1 14:17:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/openssl/deprecation.rb (OpenSSL.check_func): check if header is 	 
available for macro compatibility.</p>

<p>Tue May  1 10:53:54 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_settracefunc.rb: ignore traces from another threads 	 
because Kernel.set_trace_func affects other threads.</p>

<p>Tue May  1 06:04:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/digest/sha2/sha2.c (REVERSE32): explicitly cast since unsigned 	 
long may be larger than sha2_word32.</p>

<p>* ext/digest/sha2/sha2.c (SHA<code>256,512,384</code>_<code>Final,End</code>): should clear 	 
whole content, not pointer size.</p>

<p>* ext/digest/*/extconf.rb: use pkg_config to use same library with 	 
openssl.  [ruby-core:44755][Bug #6379]</p>

<p>* ext/openssl/deprecation.rb: extract check for broken Apple OpenSSL.</p>

<p>Tue May  1 05:02:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (optflags): disable unsafe optimizations. 	 
[ruby-core:44679][Bug #6370]</p>

<p>Mon Apr 30 23:36:49 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/fileutils.rb (copy_metadata): use File.lchown and File.lchmod to 	 
update meta data of symlinks.</p>

<p>Mon Apr 30 23:05:53 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/ruby/test_continuation.rb (tracing_with_set_trace_func): don&#39;t
	  call Continuation from other threads. [ruby-dev:45596] [Bug #6382]</p>

<p>Mon Apr 30 20:10:04 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/zlib/extconf.rb: detect z_crc_t type which will be defined 	  since
zlib-1.2.7.</p>

<p>* ext/zlib/zlib.c (rb_zlib_crc_table): use z_crc_t if available.</p>

<p>Mon Apr 30 09:02:15 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/openssl/lib/openssl/ssl.rb: add hostname to “hostname does not 	 
match server cert.” error. patched by Wes Morgan via Github. 	  <a
href="https://github.com/ruby/ruby/pull/122">github.com/ruby/ruby/pull/122</a></p>

<p>Mon Apr 30 04:43:53 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/json/yaml_events.rb: implicit styles should not 	 
be changeable for JSON events.</p>

<p>Sun Apr 29 06:12:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (assoc, parser_yylex): add syntax to splat keyword hash. 	 
[ruby-core:44591][Feature #6353]</p>

<p>* compile.c (compile_array_): generate keyword splat insns.</p>

<p>* vm.c (m_core_hash_merge_kwd): merge keyword hash into intermediate 	 
hash.  leftward argument is prior currently.</p>

<p>Fri Apr 27 12:34:23 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/dl/cfunc.c (rb_dlcfunc_call): should convert a Bignum value to 	 
unsigned long long on Win64. 	  [ruby-core:44636][Bug #6364] reported by
raylinn@gmail.com (ray linn)</p>

<p>Fri Apr 27 10:58:17 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/readline/test_readline.rb (setup): avoid affected by user&#39;s 	 
inputrc file.  [ruby-dev:45584][Bug #6357]</p>

<p>Fri Apr 27 01:45:05 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (rb_threadptr_execute_interrupts_common): 	  handle
timer_interrupt only on the first loop for the case to avoid 	  the
infinite loop like following case: 	  * there is 2 Ruby threads (3
pthreads) 	  (1) main thread is waiting at gvl_yield:112 (native_cond_wait)
	  (2) sub thread works 	  (3) sub thread waits at gvl_yield:133
(native_mutex_unlock) 	  (4) main thread works 	  (5) main thread goes to
gvl_acquire_common 	  (6) main thread call rb_wakeup_timer_thread 	  (7)
timer thread set timer interrupt to the main thread 	  (8) main thread
works 	  (9) main thread waits at gvl_acquire_common:64 (native_cond_wait)
	  (10) sub tread works 	  (11) set sub thread as the current thread 	 
(12) run Ruby thread 	  (13) …100ms 	  (14) sub thread goes to
rb_threadptr_execute_interrupts_common 	  (15) sub thread call
rb_thread_schedule_limits 	  (16) sub thread call gvl_release_common 	 
(17) sub threads waits at gvl_yield:121 (native_cond_wait) 	  (18) main
threads works 	  (19) main thread back to gvl_yield 	  (20) set main thread
as the current thread 	  (21) main thread call gvl_yield 	  (22) main
thread waits at gvl_yield:112 (native_cond_wait) 	  As described above, the
main thread can&#39;t escape from 	 
rb_threadptr_execute_interrupts_common. 	  See extended memo: <a
href="http://bugs.ruby-lang.org/projects/ruby-trunk/wiki/R35480_ExtendedMemo">bugs.ruby-lang.org/projects/ruby-trunk/wiki/R35480_ExtendedMemo</a></p>

<p>Fri Apr 27 07:15:07 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/socket.c (sock_s_pack_sockaddr_un): support the longest 	 
path in sockaddr_un, really. 	  reported by nagachika. 	 <a
href="http://d.hatena.ne.jp/nagachika/20120426/ruby_trunk_changes_35474_35476">d.hatena.ne.jp/nagachika/20120426/ruby_trunk_changes_35474_35476</a></p>

<p>Thu Apr 26 12:28:06 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/raddrinfo.c (init_unix_addrinfo): support the longest 	  path
in sockaddr_un. 	  (inspect_sockaddr): ditto. 	  (addrinfo_mdump): ditto. 	
(addrinfo_mload): ditto. 	  (rsock_unixpath_str): new function. 	 
(rsock_unixpath): removed. 	  (rsock_unixaddr): use rsock_unixpath_str.</p>

<p>* ext/socket/socket.c (sock_s_pack_sockaddr_un): support the longest 	 
path in sockaddr_un. 	  (sock_s_unpack_sockaddr_un): ditto. 	 
(sock_s_gethostbyaddr): unused variable removed.</p>

<p>* ext/socket/unixsocket.c (rsock_init_unixsock): support the longest 	 
path in sockaddr_un.</p>

<p>* ext/socket/rubysocket.h (rsock_unixpath_str): declared. 	 
(rsock_unixpath): removed.</p>

<p>* test/socket/test_unix.rb: comment out test_nul because abstract unix 	 
sockets may contain NULs.</p>

<p>Thu Apr 26 01:32:33 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/optparse/test_summary.rb (test_summary_containing_space): add 	 
test for r35467. OptionParser#to_a shouldn&#39;t split banner by spaces.</p>

<p>Wed Apr 25 23:02:46 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/raddrinfo.c (init_unix_addrinfo): refine error message 	 
format. 	  (addrinfo_mload): show more information on “too long AF_UNIX
path” 	  error. 	  (addrinfo_unix_path): ditto for “too short AF_UNIX
address” and 	  “too long AF_UNIX address” error.</p>

<p>Wed Apr 25 05:46:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb (OptionParser#to_a): split for each lines. 	 
[ruby-dev:45568][Bug #6348]</p>

<p>Tue Apr 24 21:57:53 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/raddrinfo.c (init_unix_addrinfo): show actual path length 	 
when it is too long for Unix socket.</p>

<p>* ext/socket/unixsocket.c (rsock_init_unixsock): ditto.</p>

<p>* ext/socket/socket.c (sock_s_pack_sockaddr_un): ditto.</p>

<p>Tue Apr 24 21:43:58 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* lib/net/smtp.rb (check_continue): raise an error with an explanatory 	 
message.  [ruby-core:35854] [Feature #4598]</p>

<p>Tue Apr 24 21:11:31 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb (OptionParser#to_a): should split by end-of-line, 	  and
MUST TEST IT, MUST RUN THE TEST, MUST VERIFY BEFORE BACKPORT. 	 
[ruby-dev:45568][Bug #6348]</p>

<p>Tue Apr 24 19:59:31 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* enc/euc_jp.c: added EUC-JP-2004 and its alias EUC-JISX0213. 	 
[ruby-dev:45571] [Feature #6349] 	  Requested by Kyouhei Yanagita
&lt;yanagi@shakenbu.org&gt;.</p>

<p>* enc/trans/japanese_euc.trans: ditto.</p>

<p>* <a href="12">enc/trans/JIS/JISX0213-</a>%UCS@<code>BMP,SIP</code>.src: JIS X
0213:2004 -&gt; 	  Unicode mapping table from NetBSD.</p>

<p>* enc/trans/JIS/UCS@<code>BMP,SIP</code>%<a href="12">JISX0213-</a>.src: Unicode
-&gt; JIS X 	  0213:2004 mapping table from NetBSD.</p>

<p>* tool/transcode-tblgen.rb: added SIP support.</p>

<p>* test/ruby/test_transcode.rb: tests of above changes.</p>

<p>Tue Apr 24 18:12:13 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c: fix to output warning when the same literals 	  are available
as a condition of same case clause. 	  And remove information
(&#39;#n&#39;) because we can find duplicated 	  condition with explicit
line numbers. 	  [ruby-core:38343] [Ruby 1.9 - Bug #5068]</p>

<p>* test/ruby/test_syntax.rb: add a test for above.</p>

<p>Tue Apr 24 17:03:51 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (waitpid): need to check the return value of 	 
FindChildSlotByHandle() before passing poll_child_status(). 	  this fixed a
SEGV in test-all.  reported by ko1 via IRC.</p>

<p>Tue Apr 24 16:04:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_yylex): EXPR_BEG by keywords is a start point of 	 
commands.  [ruby-dev:45563][Bug #6347]</p>

<p>* parse.y (superclass): ditto for superclass.</p>

<p>* parse.y (parser_parse_string, parser_here_document): ditto for 	  string
interpolation.</p>

<p>* parse.y (parser_yylex): ditto for singleton class.</p>

<p>Tue Apr 24 15:51:41 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb (OptionParser#to_a): should split by end-of-line 	 
[ruby-dev:45568][Bug #6348]</p>

<p>* lib/optparse.rb (OptionParser#to_a): String#to_a is no longer 	 
defined.  [ruby-dev:45568][Bug #6348]</p>

<p>Tue Apr 24 12:46:50 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* hash.c, object.c, struct.c, lib/ostruct.rb: add to_h methods. 	 
[Feature #6276]</p>

<p>Tue Apr 24 10:54:34 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/drb/drbtest.rb (<code>DRbCore,DRbAry</code>#teardown): cannot pass SIGTERM 	 
to another process on Windows, so use SIGINT instead.</p>

<p>Tue Apr 24 00:25:39 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* thread.c (rb_check_deadlock): refine an error message of deadlock 	 
detection.  [ruby-core:44336] [Bug #6288]</p>

<p>Tue Apr 24 00:14:42 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* parse.y (primary): remove wrong “fixpos” that caused incorrect 	 
source_location of blocks.  [ruby-core:42232] [Bug #5930]</p>

<p>* test/ruby/test_proc.rb: add a test for above.</p>

<p>Mon Apr 23 22:56:08 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/iconv: deprecated.  [Feature #6322]</p>

<p>Mon Apr 23 22:07:00 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/socket/test_unix.rb (bound_unix_socket): make temporary 	  filename
shorter for less possibility of Unix socket path over 	  107 bytes when
TMPDIR has long path.</p>

<p>Mon Apr 23 20:35:49 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (szInternalCmds, internal_match, internal_cmd_match): 	 
get rid of a segmentation fault with GCC 4.7.0. 	  reported by
raylinn@gmail.com (ray linn) at [ruby-core:44505] 	  [Bug #6333], and
patched by mame.</p>

<p>* test/ruby/test_system.rb (TestSystem#test_system): test for it.</p>

<p>Mon Apr 23 20:11:02 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/drb/ssl.rb: generate 1024 bits RSA key instead of 512 bits. 	 
OpenSSL 1.0.1 rejects 512 bits RSA key for TLS1.2 with SHA512. 	 <a
href="http://rt.openssl.org/Ticket/Display.html?id=2769&user=guest&pass=guest">rt.openssl.org/Ticket/Display.html?id=2769&user=guest&pass=guest</a>
	  reported by Bohuslav Kabrda. 	  [ruby-core:43844] [ruby-trunk - Bug
#6221]</p>

<p>Mon Apr 23 19:54:33 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/drb/drbtest.rb: rescue Errno::ESRCH for Process.kill. 	  reported
by NARUSE, Yui.  [ruby-dev:45551]</p>

<p>Mon Apr 23 14:16:45 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* .gdbinit (rb_ps_vm): follow st_table&#39;s packing change.</p>

<p>Mon Apr 23 10:43:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: disable rubygems not to load rbconfig.rb before 	 
fake.rb.  [ruby-core:44492][Bug #6329]</p>

<p>Sun Apr 22 20:26:06 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/drb/extservm.rb (DRb::ExtServManager): don&#39;t use /bin/sh to 	 
invoke service subprocess.  mark detach threads for clean up.</p>

<p>* test/drb/drbtest.rb: clean up the service subprocess in teardown.</p>

<p>* test/drb/test_drb.rb: set @service_name for teardown.</p>

<p>* test/drb/test_drbunix.rb: ditto.</p>

<p>* test/drb/test_drbssl.rb: ditto.</p>

<p>[ruby-dev:45547]</p>

<p>Sun Apr 22 07:51:29 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/drb/ssl.rb: close accepted TCP socket if SSL accept is failed. 	 
[ruby-dev:45541]</p>

<p>Sat Apr 21 14:36:49 2012  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* test/rinda/test_rinda.rb: fix sticks on some tests problem 	  [Bug
#6272]</p>

<p>Fri Apr 20 12:24:04 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/ssl_certs/AddTrustExternalCARoot.pem:  Removed to avoid 	 
conflict with ca-bundle.pem 	*
lib/rubygems/ssl_certs/VerisignClass3PublicPrimaryCertificationAuthority-G2.pem:
	  ditto. 	*
lib/rubygems/ssl_certs/Entrust_net-Secure-Server-Certification-Authority.pem:
	  ditto.</p>

<p>Fri Apr 20 08:07:06 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Update to RubyGems 1.8.23 which contains security 	 
fixes:</p>

<p>RubyGems now disallows redirection from HTTPS to HTTP.</p>

<p>RubyGems now verifies SSL connections.</p>

<p>See <a
href="https://github.com/rubygems/rubygems/blob/1.8/History.txt">github.com/rubygems/rubygems/blob/1.8/History.txt</a>
for 	  changes since 1.8.22. 	* test/rubygems:  ditto.</p>

<p>Thu Apr 19 16:33:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): fix carry-up bug and 	 
overwrite &#39;+&#39; with &#39;-&#39; if negative offset less than a hour.
	  [ruby-core:44447][Bug #6323]</p>

<p>Thu Apr 19 09:39:57 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/-test-/win32/dln/extconf.rb: need import library for ordinal 	 
entry even on mingw.  [ruby-core:44441][Bug #6320]</p>

<p>Thu Apr 19 09:35:15 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* random.c (random_init):  Clarify that the default seed is 	 
Random.new_seed, not zero.  Based on patch by Roger Pack. 	  [ruby-trunk -
Bug #6313] 	* random.c (rb_f_srand):  ditto.</p>

<p>Thu Apr 19 08:59:02 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/curses/curses.c (window_nodelay):  Fixed call-seq of nodelay to 	 
include the &#39;=&#39;.</p>

<p>Improved description window.nodelay=.</p>

<p>Thu Apr 19 08:47:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* io.c (io_readpartial):  Document the output buffer parameter is 	 
overwritten with the read contents even when non-empty. 	  Patch by yu
nobuoka.  [ruby-trunk - Bug #6285] 	* io.c (io_read_nonblock):  ditto. 	*
io.c (io_read):  ditto. 	* io.c (rb_io_sysread):  ditto. 	* io.c
(argf_read):  ditto. 	* io.c (argf_readpartial):  ditto. 	*
ext/stringio/stringio.c (strio_read):  ditto. 	* test/ruby/test_argf.rb
(class TestArgf):  Add test for existing 	  behavior of read outbuf. 	*
test/ruby/test_io.rb (class TestIO):  ditto. 	*
test/stringio/test_stringio.rb (class TestStringIO):  ditto.</p>

<p>Wed Apr 18 22:58:55 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (DOT, DOXYGEN): use AC_CHECK_PROGS instead of 	 
AC_CHECK_PROG which needs the third argument.  [ruby-core:44433] 	  [Bug
#6316]</p>

<p>* configure.in (PKG_CONFIG): fix condition to skip older version 	  of
pkg-config.  continue in backticks does not affect outside.</p>

<p>Wed Apr 18 13:59:40 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/file.c (INVALID_FILE_ATTRIBUTES): define for old SDK.</p>

<p>Wed Apr 18 10:22:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): add an interim digit for 	  the
timezone offset which is less than an hour.</p>

<p>Wed Apr 18 09:58:29 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/version.rb:  Fixed init_with warning by calling into 	 
yaml_initialize (for syck) from psych&#39;s init_with</p>

<p>Wed Apr 18 09:03:43 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Update to RubyGems 1.8.22 plus r33517 and r35337 which 	 
were ported to the rubygems git repository.</p>

<p>See <a
href="https://github.com/rubygems/rubygems/blob/1.8/History.txt">github.com/rubygems/rubygems/blob/1.8/History.txt</a>
for 	  changes since 1.8.11.</p>

<p>* test/rubygems:  ditto.</p>

<p>Tue Apr 17 22:18:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): fix padding of time zone 	 
offset.  [ruby-dev:43287][Bug #4458]</p>

<p>Tue Apr 17 13:11:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dln.c (rb_w32_check_imported): skip ordinal entries.  based on a 	 
patch by phasis68 (Heesob Park) at [ruby-core:44381]. 	 
[ruby-core:44371][Bug #6303]</p>

<p>Mon Apr 16 18:22:14 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* spec/default.mspec: expand relative path for ruby_exe which uses 	  them
with Dir.chdir; it breaks relative paths, for example 	 
core/kernel/exec_spec.rb.</p>

<p>Mon Apr 16 16:22:40 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (gmtime_r, localtime_r): POSIX compliant reentrant 	 
versions.</p>

<p>* configure.in (RUBY_MSVCRT_VERSION): define on mingw too.</p>

<p>* win32/Makefile.sub (config.h): prefix RT_VER with RUBY and make 	  more
descriptive to get rid of potential conflict.</p>

<p>Mon Apr 16 15:19:39 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (NO_RUBY_VENDOR_LIB): fix missing comma.</p>

<p>Mon Apr 16 12:17:12 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix.rb (hermitian?): Bug fix, patch by George Koehler 	  [Bug
#6290] [rubyspec:4b9573d7613]</p>

<p>Mon Apr 16 09:42:50 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rubygems/remote_fetcher.rb (Gem::RemoteFetcher#download): should 	 
use File.identical? to check the identity of the files. 	  this fixed an
error of a test on Windows.</p>

<p>Sat Apr 14 12:55:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (UNREACHABLE): gcc 4.4 eliminates unreachable code 	  if
-O3 is given.</p>

<p>* win32/win32.c (child_result): dropped colon.</p>

<p>Sat Apr 14 10:45:18 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/server.rb (WEBrick::GenericServer#start): 	  partially
revert r35315.</p>

<p>* test/webrick/test_server.rb (test_start_exception): 	  received signal
is delivered to the main thread, so it is needed to 	  emulate it. patched
by Eric Hodel. [ruby-core:44348] [Feature #6236]</p>

<p>Sat Apr 14 09:35:45 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* variable.c (trace_ev):  Removed “not reached” comment as this line is 	 
reached. 	* variable.c (rb_obj_remove_instance_variable):  Replaced “not
reached” 	  comment with the UNREACHABLE macro. 	* variable.c
(rb_mod_const_missing):  ditto. 	* variable.c (rb_mod_remove_cvar):  ditto.
	* enum.c (first_i):  ditto. 	* string.c (rb_str_aref):  ditto. 	* string.c
(str_byte_aref):  ditto. 	* string.c (rb_to_id):  ditto. 	* io.c
(rb_io_fmode_modestr):  ditto. 	* io.c (rb_io_oflags_modestr):  ditto. 	*
pack.c (num2i32):  ditto. 	* vm_eval.c (rb_method_missing):  ditto. 	*
vm_eval.c (rb_f_throw):  ditto. 	* dir.c (dir_read):  ditto. 	*
win32/win32.c (child_result):  ditto. 	* struct.c (rb_struct_getmember): 
ditto. 	* struct.c (rb_struct_set):  ditto. 	* struct.c
(rb_struct_aref_id):  ditto. 	* eval.c (rb_f_raise):  ditto. 	* process.c
(rb_f_exit_bang):  ditto. 	* process.c (rb_f_exit):  ditto. 	* process.c
(rb_f_abort):  ditto. 	* ext/-test-/iter/break.c (iter_break_value): 
ditto. 	* ext/pty/pty.c (pty_check):  ditto. 	* ext/openssl/ossl_pkey.c
(ossl_pkey_new):  ditto. 	* ext/readline/readline.c (rb_remove_history): 
ditto. 	* ext/stringio/stringio.c (strio_unimpl):  ditto. 	* numeric.c
(num_sadded):  ditto. 	* numeric.c (num_init_copy):  ditto. 	* numeric.c
(rb_num2ll):  ditto. 	* numeric.c (rb_num2ull):  ditto. 	* vm_insnhelper.c
(call_cfunc):  ditto. 	* ruby.c (opt_W_getter):  ditto. 	* bignum.c
(rb_big_coerce):  ditto. 	* file.c (rb_f_test):  ditto.</p>

<p>Sat Apr 14 08:38:20 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* encoding.c (rb_enc_codepoint_len):  Use UNREACHABLE to avoid “control 	 
reaches end of non-void function” warnings.  [ruby-trunk - Bug #6066] 	*
re.c (name_to_backref_number):  ditto. 	* object.c (rb_Float):  ditto. 	*
io.c (io_readpartial):  ditto. 	* io.c (io_read_nonblock):  ditto. 	*
pack.c (rb_uv_to_utf8):  ditto. 	* proc.c (rb_method_entry_arity):  ditto.
	* vm_method.c (rb_f_notimplement):  ditto. 	* struct.c
(rb_struct_aset_id):  ditto. 	* class.c (rb_scan_args):  ditto. 	*
process.c (rlimit_resource_type):  ditto. 	* process.c
(rlimit_resource_value):  ditto. 	* process.c (p_uid_switch):  ditto. 	*
process.c (p_gid_switch):  ditto. 	* ext/digest/digest.c
(rb_digest_instance_update):  ditto. 	* ext/digest/digest.c
(rb_digest_instance_finish):  ditto. 	* ext/digest/digest.c
(rb_digest_instance_reset):  ditto. 	* ext/digest/digest.c
(rb_digest_instance_block_length):  ditto. 	* ext/bigdecimal/bigdecimal.c
(BigDecimalCmp):  ditto. 	* ext/dl/handle.c (rb_dlhandle_close):  ditto. 	*
ext/tk/tcltklib.c (pending_exception_check0):  ditto. 	* ext/tk/tcltklib.c
(pending_exception_check1):  ditto. 	* ext/tk/tcltklib.c
(ip_cancel_eval_core):  ditto. 	* ext/tk/tcltklib.c (lib_get_reltype_name):
ditto. 	* ext/tk/tcltklib.c (create_dummy_encoding_for_tk_core):  ditto. 	*
ext/tk/tkutil/tkutil.c (tk_hash_kv):  ditto. 	* ext/openssl/ossl_ssl.c
(ossl_ssl_session_reused):  ditto. 	* ext/openssl/ossl_pkey_ec.c
(ossl_ec_key_dsa_verify_asn1):  ditto. 	* ext/openssl/ossl_pkey_ec.c
(ossl_ec_point_is_at_infinit):  ditto. 	* ext/openssl/ossl_pkey_ec.c
(ossl_ec_point_is_on_curve):  ditto. 	* ext/fiddle/conversions.c
(generic_to_value):  ditto. 	* ext/socket/raddrinfo.c
(rsock_io_socket_addrinfo):  ditto. 	* ext/socket/socket.c
(sock_s_getnameinfo):  ditto. 	* ext/ripper/eventids2.c
(ripper_token2eventid):  ditto. 	* cont.c (return_fiber):  ditto. 	*
dmydln.c (dln_load):  ditto. 	* vm_insnhelper.c
(vm_search_normal_superclass):  ditto. 	* bignum.c (big_fdiv):  ditto. 	*
marshal.c (r_symlink):  ditto. 	* marshal.c (r_symbol):  ditto.</p>

<p>Fri Apr 13 17:12:09 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* hash.c (inspect_i): keep string&#39;s coderange.</p>

<p>Fri Apr 13 15:26:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_hash_aset, rb_hash_update, rb_hash_update_by): use 	 
st_update() to reduce evaluation of hash values.</p>

<p>Fri Apr 13 15:17:36 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/server.rb (WEBrick::GenericServer#stop): fix r35303; 	  this
method is to deny new connections, not shutdown yet.</p>

<p>* lib/webrick/server.rb (WEBrick::GenericServer#start): 	  re-raise
exception only when the exception is Interrupt (^C).</p>

<p>Thu Apr 12 19:51:45 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: added some notes.</p>

<p>Wed Apr 11 17:16:49 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (compile_array, compile_array_): 	  Divide big array (or hash)
literals into several blocks and 	  concatenate them.  There was a problem
that a big array (hash) 	  literal causes SystemStackError exception (stack
overflow) 	  because VM push all contents of the literal onto VM stack to 	
make an array (or hash).  To solve this issue, we make several 	  arrays
(hashes) and concatenate them to make a big array (hash) 	  object. 
[ruby-dev:37701] [Bug #982]</p>

<p>* compile.c (iseq_compile_each, setup_args): use modified 	 
compile_array.</p>

<p>* vm.c (m_core_hash_from_ary, m_core_hash_merge_ary, 	 
m_core_hash_merge_ptr): added for above change.</p>

<p>* id.c (Init_id), parse.y: add core method ids.</p>

<p>* bootstraptest/test_literal.rb: add simple tests.</p>

<p>* bootstraptest/test_eval.rb: remove rescue clause to catch 	 
SystemStackError exception.</p>

<p>* test/ruby/test_literal.rb: add tests to check no stack overflow.</p>

<p>Thu Apr 12 07:10:37 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/uri/generic.rb (module URI):  URI now downcases the scheme to 	 
follow RFC 2396 section 3.1.  [ruby-trunk - Feature #4551] 	*
test/uri/test_generic.rb (class URI):  Test for above</p>

<p>Thu Apr 12 06:15:44 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/protocol.rb (module Net):  Added ReadTimeout to match 	 
OpenTimeout.  ReadTimeout is now raised by rbuf_fill instead of 	 
Timeout::Error to help users distinguish what type of timeout 	  occurred. 
[ruby-trunk - Feature #6088] 	* lib/net/pop.rb (module Net):  Updated
documentation for ReadTimeout 	  and OpenTimeout. 	* lib/net/http.rb
(module Net):  ditto 	* lib/net/smtp.rb (module Net):  ditto 	*
lib/net/telnet.rb (module Net):  Net::ReadTimeout is now raised in 	 
waitfor to match Net::Protocol. 	* test/net/http/test_http.rb:  Updated
Timeout::Error expectation to 	  Net::ReadTimeout. 	*
test/net/ftp/test_ftp.rb:  ditto</p>

<p>Thu Apr 12 05:27:01 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/webrick/server.rb (module WEBrick::GenericServer):  A server 	  will
now continue only when a StandardError subclass is raised.  For 	  other
exception types the error will be logged at the fatal level and 	  the
server will safely stop.  Based on a patch by Alex Young. 	  [ruby-trunk -
Feature #6236] 	* test/webrick/test_server.rb:  Test for new exception
handling 	  behavior.  Join the server thread instead of busy-waiting for
it to 	  shut down to remove race conditions.</p>

<p>Thu Apr 12 03:50:44 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit:Runner::Worker#_run_suites): 	  call
GC.start before running the test suites.</p>

<p>Wed Apr 11 22:31:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_check_id_cstr): new function to check if ID is 	  registered
with NUL-terminated C string.</p>

<p>* sprintf.c (rb_str_format): avoid inadvertent symbol creation.</p>

<p>Wed Apr 11 20:28:36 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* io.c (rb_io_eof): use eof() instead of io_fillbuf(). It&#39;s because 	 
io_unread() doesn&#39;t work properly when reading CRLF with read(length) 	
and mode &#39;r&#39;. 	  [ruby-core:44189][Bug #6271]</p>

<p>* test/ruby/test_io_m17n.rb (TestIO_M17N#test_read_crlf_and_eof): 	  test
for above.</p>

<p>Wed Apr 11 07:38:33 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/digest/sha2/lib/sha2.rb (Digest#block_length):  Fixed method name 	 
in documentation examples.  Patch by naleski via 	  <a
href="https://github.com/ruby/ruby/pull/115">github.com/ruby/ruby/pull/115</a></p>

<p>Wed Apr 11 07:33:13 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* pack.c (pack_pack):  Warn when an invalid character is found in the 	 
format string when $VERBOSE is true.  [ruby-trunk - Feature #5219] 	*
pack.c (pack_unpack):  ditto 	* test/ruby/test_pack.rb (class TestPack): 
Test for warnings on 	  invalid format characters.</p>

<p>Wed Apr 11 06:11:10 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* string.c (rb_str_tr):  Documented use of \ to escape characters. 	 
[ruby-trunk - Bug #6161] 	* string.c (rb_str_count):  ditto</p>

<p>Wed Apr 11 05:14:51 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/abbrev.rb:  Clarified that Abbrev.abbrev returns a Hash instead 	 
of an Array.  Patch by Andrei Bocan.  [ruby-trunk - Bug #6107]</p>

<p>Wed Apr 11 03:02:24 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/ripper/lib/ripper/sexp.rb: fix spelling. patched by 	  Jonathan
Hinkle via <a
href="https://github.com/ruby/ruby/pull/116">github.com/ruby/ruby/pull/116</a></p>

<p>Tue Apr 10 19:07:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_enc_raise): new function to raise an exception with 	  the
message in the given encoding.  patched by now (Nikolai 	  Weibull) at
[ruby-core:41160].  [Feature #5650]</p>

<p>Tue Apr 10 18:19:32 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP#send_request_with_body_stream): 	  use
IO.copy_stream for requests using body_stream. 	  patched by Eric Wong.
[ruby-core:40898] [Feature #5605]</p>

<p>Tue Apr 10 16:53:21 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c: add prototype declarations for older Mac OS X. 	 
[ruby-core:43376][Bug #6170]</p>

<p>Tue Apr 10 15:35:21 2012  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* compile.c (iseq_set_sequence): show a hint if there are duplicated 	 
“when” clauses.  [ruby-core:41502] [ruby-trunk - Feature #5716]</p>

<p>Tue Apr 10 09:57:00 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* string.c (rb_str_split_m):  Documented behavior of split on the empty 	 
string.  [ruby-trunk - Feature #3575]</p>

<p>Tue Apr 10 09:48:31 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (rb_deflate_s_deflate):  Fixed ruby example replacing 	 
NO_FLUSH with FINISH.  [ruby-trunk - Bug #6273]</p>

<p>Mon Apr  9 23:10:26 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (isUNCRoot, winnt_stat): support long UNC. 	 
[ruby-core:30623][Feature #3399]</p>

<p>Mon Apr  9 15:16:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (string_content, parser_yylex): count brace nesting to 	 
dispatch embexpr_end.  [ruby-core:43775][Bug #6211]</p>

<p>Mon Apr  9 13:06:58 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* hash.c (rb_hash_set_default_proc): Accept nil, patch by Run Paint 	 
[Feature #4234]</p>

<p>* test/ruby/test_hash.rb: test for above.</p>

<p>Mon Apr  9 08:01:15 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strftime.c: gets the value with range() consistently. 	*
ext/date/date_strftime.c (range): now just replaces the given item.</p>

<p>Mon Apr  9 06:58:01 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* complex.c (nucomp_expt): [ruby-core:44170].</p>

<p>Mon Apr  9 02:52:03 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* complex.c (nucomp_expt): the result of f_complex_new2 may be a fixnum 	 
with mathn. [ruby-core:44170] [Bug #6267]</p>

<p>Sun Apr  8 22:46:01 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json/generator/generator.c (generate_json_bignum): 	  add
RB_GC_GUARD. 	 <a
href="http://fb.rubyci.org/~chkbuild/ruby-trunk/log/20120407T210301Z.diff.html.gz">fb.rubyci.org/~chkbuild/ruby-trunk/log/20120407T210301Z.diff.html.gz</a></p>

<p>Sun Apr  8 07:26:40 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler): get keys 	  and
fetch values from it to prevent @timeout_info&#39;s error 	  “can&#39;t add
a new key into hash during iteration”.</p>

<p>Sun Apr  8 06:51:57 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (io_unread): cast as long the value for extra_max. 	 
[ruby-core:44137] [Bug #6257]</p>

<p>Sun Apr  8 06:46:48 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/httpresponse.rb (WEBrick::HTTPResponse#send_body_io): 	  use
readpartial to get data even if the response is streaming data and 	  each
data is smaller than @buffer_size. 	  patched by yu nobuoka.
[ruby-dev:45471] [Bug #6230]</p>

<p>Sat Apr  7 22:35:36 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* include/ruby/win32.h (rb_w32_aspawn_flags): add the declaration of 	 
new function.</p>

<p>* process.c (enum): add EXEC_OPTION_PGROUP and move the position 	  above
for the usage in proc_spawn_n().</p>

<p>* process.c (proc_spawn_n): add an argument to pass new option 	 
`new_pgroup`. The option specifies CREATE_NEW_PROCESS_GROUP flag to 	 
CreateProcessW(). This flag is necessary for the usage of 	  Process.kill
on the subprocess on Windows.</p>

<p>* process.c (rb_exec_arg_addopt): ditto.</p>

<p>* process.c (rb_spawn_process): ditto.</p>

<p>* process.c (documentation for rb_f_spawn): add documentation for new 	 
option `new_pgroup` of spawn.</p>

<p>* test/ruby/test_process.rb (TestProcess#test_execopts_new_pgroup): 	  add
tests for option `new_pgroup`.</p>

<p>* test/ruby/test_thread.rb 	 
(TestThreadGroup#test_thread_timer_and_interrupt): 	  add option
`new_pgroup: true` to spawn on Windows. It&#39;s needed for 	  Process.kill
on a subprocess.</p>

<p>* win32/win32.c (CreateChild): add an argument to pass 	  dwCreationFlags
of CreateProcessW().</p>

<p>* win32/win32.c (rb_w32_spawn): ditto.</p>

<p>* win32/win32.c (rb_w32_aspawn_flags): add new function to pass 	 
dwCreationFlags.</p>

<p>* win32/win32.c (rb_w32_aspawn): refactor to move the content to 	 
rb_w32_aspawn_flags(). 	  [ruby-core:43245][Bug #6131]</p>

<p>Sat Apr  7 22:32:00 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_thread.rb 	 
(TestThreadGroup#test_thread_timer_and_interrupt): skip on Windows. 	 
Process.kill cannot kill a subprocess if CREATE_NEW_PROCESS_GROUP 	  flag
is not specified in a call to CreateProcessW().</p>

<p>* win32/win32.c (CreateChild): revert the usage of 	 
CREATE_NEW_PROCESS_GROUP flag for compatibility. 	  [ruby-core:43245][Bug
#6131]</p>

<p>Sat Apr  7 10:28:40 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: bumping up psych version to match release. 	*
ext/psych/psych.gemspec: ditto</p>

<p>Sat Apr  7 02:07:00 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c: fall back to any encoding if the external 	 
encoding is wrong.  [ruby-core:44163] 	* test/psych/test_encoding.rb: fix
test</p>

<p>Fri Apr  6 16:24:24 2012  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* struct.c (documentation for rb_struct_members_m): 	  fix &#39;array of
strings&#39; to &#39;array of symbols&#39; 	  [ruby-core:44152][Bug #6264]</p>

<p>Fri Apr  6 14:27:04 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* Makefile.in ($(LIBRUBY_A)): fix typo.</p>

<p>Thu Apr  5 13:26:15 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* missing/alloca.c (xmalloc, xfree): use ruby version, not 	  depending on
RUBY_LIB_PREFIX.  [ruby-dev:45492][Bug #6255]</p>

<p>Wed Apr  4 13:06:39 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/ftp/ftp.rb (Net::FTP#close): restore original read_timeout.</p>

<p>Wed Apr  4 10:33:31 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/ftp/ftp.rb (Net::FTP#close): ignore exceptions from shutdown and 	 
read on closing.</p>

<p>Wed Apr  4 01:48:35 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/ftp/ftp.rb (Net::FTP#close): close socket more gracefully.</p>

<p>* lib/ftp/ftp.rb (Net::BufferedSocket#shutdown): added.</p>

<p>* test/net/ftp/test_ftp.rb (FTPTest#create_ftp_server): wait socket 	 
with shutdown and read.</p>

<p>Tue Apr  3 19:00:52 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/net/ftp/test_ftp.rb (FTPTest#create_ftp_server): should wait 	  a
little before closing socket because if the client call 	 
Net::FTP#getmultiline the socket is suddenly closed by the server in 	  the
getline loop.</p>

<p>Tue Apr  3 18:33:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (setreuid, setregid): suppress warnings. 	 
[ruby-core:43374][Bug #6169]</p>

<p>Tue Apr  3 10:18:27 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (inspect_enumerator): suppress uninitialized 	  instance
variable warnings.  [ruby-dev:45449][Bug #6214] 	  patched by no6v
(Nobuhiro IMAI).</p>

<p>Mon Apr  2 13:25:08 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/optparse/ac.rb: autoconf-like options.</p>

<p>Mon Apr  2 10:34:00 2012  eregon  &lt;eregontp@gmail.com&gt;</p>

<p>* string.c (rb_str_start_with, rb_str_end_with): raise an error if 	  an
argument is not convertible to a String. 	  [ruby-core:40623][Bug #5536]</p>

<p>Mon Apr  2 03:35:25 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/server.rb (WEBrick::GenericServer): close socket only if 	 
the socket is not closed yet.</p>

<p>Sun Apr  1 23:03:18 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (Net::BufferedSocket): should delegate send() to @io 	 
for Net::FTP#abort and Net::FTP#status.</p>

<p>Sun Apr  1 00:41:56 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb: fixed the domain name in examples.</p>

<p>Sat Mar 31 21:39:45 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler): dup to prevent 	 
@timeout_info&#39;s “can&#39;t add a new key into hash during iteration”.</p>

<p>Sat Mar 31 14:22:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (hash_default_value): extract from rb_hash_aref(), to be 	 
shared with rb_hash_shift(), so that overriding Hash#default 	  will be
respected.</p>

<p>Sat Mar 31 14:16:02 2012  Sokolov Yura (funny-falcon) 
&lt;funny.falcon@gmail.com&gt;</p>

<p>* hash.c: do not allocate st_table when it is not necessary.</p>

<p>Sat Mar 31 13:42:39 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (read_timeout=, open_timeout=): supported timeout.</p>

<p>Sat Mar 31 13:20:40 2012  Sokolov Yura (funny-falcon) 
&lt;funny.falcon@gmail.com&gt;</p>

<p>* hash.c: remove unnecessary checks for Qundef in hash iterations. 	 
since hash use st_foreach_check for iterations, such checks are 	 
needless.</p>

<p>Sat Mar 31 12:05:01 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_x509cert.c: Fix doc typo.</p>

<p>Sat Mar 31 10:13:24 2012  Sokolov Yura (funny-falcon) 
&lt;funny.falcon@gmail.com&gt;</p>

<p>* st.c (st_foreach_check, st_foreach): remove ancient check.  This 	 
check are from initial ordered hash commit when first entry were 	  created
with entry-&gt;fore = entry-&gt;back = entry.</p>

<p>* st.c (st_delete): use real_entries in st_delete for packed tables</p>

<p>Sat Mar 31 07:53:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c (st_foreach_check): remove the entry by replacing with never 	 
when ST_DELETE.</p>

<p>* hash.c (st_foreach_safe): since table is not for VALUE, Qundef is 	  not
special value, so use 0 instead.  therefore this function can be 	  applied
to only st_table which 0 is invalid as keys, e.g., IDs.</p>

<p>* hash.c: Qundef cannot be passed from st_foreach_check().</p>

<p>* hash.c, marshal.c, object.c, variable.c: fix callback argument types 	 
of iterators.</p>

<p>Thu Mar 29 23:50:15 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c (st_update): pass pointer to key to the callback function.</p>

<p>Thu Mar 29 16:36:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c (st_update): add existing parameter to the callback function.</p>

<p>Thu Mar 29 16:35:32 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (terminal_width, del_status_line, put_status): 	 
extract as methods.</p>

<p>Thu Mar 29 10:20:18 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_pkcs7.c: fix crash when parsing garbage data. 	*
test/openssl/test_pkcs7.rb: assert correct behavior for it. 	  Thanks to
Matt Venables for reporting the issue. 	  [ruby-core:43250][Bug #6134]</p>

<p>Thu Mar 29 10:16:05 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* thread_win32.c (TIME_QUANTUM_USEC): 10ms(= old setting) [experimental] 	
cf. [Bug #6098]</p>

<p>Thu Mar 29 10:12:12 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* thread.c (rb_threadptr_execute_interrupts_common): use defined 	 
TIME_QUANTUM_USEC instead of a magic number.  there is no meanings 	  to
use different values for checking interval of interruption and 	  thread
switching limits. 	  cf. [Bug #6098]</p>

<p>Thu Mar 29 09:26:17 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_x509cert.rb: exclude test that fails when issuing 	  a
certificate with RSA signature and DSS1 digest for earlier 	  OpenSSL
versions when used in conjunction with OpenSSL 1.0.1. 	  Thanks, Vit
Ondruch, for reporting the issue. 	  [ruby-core:42949][Bug #6089]</p>

<p>Thu Mar 29 08:25:35 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* NEWS: add note about unified behavior of encoding nil values in 	 
instances of OpenSSL::ASN1::ASN1Data.</p>

<p>Thu Mar 29 07:45:36 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_asn1.c: raise TypeError when trying to encode nil 	 
values for Primitive instances. 	* test/openssl/test_asn1.rb: Assert
consistent behavior when 	  encoding nil values: Primitives raise
TypeError, Constructives 	  raise NoMethodError. 	  Fixes
[ruby-core:43009][Bug #6102]</p>

<p>Wed Mar 28 16:39:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (obj2uid, obj2gid): allow strings as input user/group id. 	 
[ruby-core:40923][Feature #5610]</p>

<p>Wed Mar 28 15:06:18 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* marshal.c (r_symreal): default to ASCII-8BIT for non-ascii symbols, 	 
otherwise it should be converted to US-ASCII in rb_intern_str() if 	 
possible.  [ruby-core:43762][Bug #6209]</p>

<p>Wed Mar 28 08:44:24 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: updating version to match gem 	*
ext/psych/psych.gemspec: ditto 	* ext/psych/lib/psych/visitors/to_ruby.rb:
fixing deprecation warning</p>

<p>Tue Mar 27 23:44:11 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (io_unread): fixed memory leak.  report by nagachika via IRC.</p>

<p>Tue Mar 27 22:44:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (verconf.h): separate load path specific stuff from 	 
config.h.</p>

<p>Tue Mar 27 22:43:40 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub: fix config.h path to include.</p>

<p>Tue Mar 27 17:08:08 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* win32/win32.c (check_if_dir): fix memory leak.</p>

<p>Tue Mar 27 13:13:51 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (str_new_empty): should copy also the encoding as an 	  empty
substring.  [ruby-dev:45441][Bug #6206]</p>

<p>Mon Mar 26 23:43:04 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (parse227, parse228, parse229): don&#39;t use $~.</p>

<p>Mon Mar 26 23:34:40 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (parse227, parse228, parse229): don&#39;t use local 	 
variables defined by named capture for other Ruby implementations 	  such
as Rubinius.</p>

<p>Mon Mar 26 23:19:03 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (parse_pasv_port): refactored.</p>

<p>Mon Mar 26 19:49:49 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* test/net/ftp/test_ftp.rb: add the test, which was forgotten in the 	 
previous commit.</p>

<p>Mon Mar 26 19:37:27 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (parse227, parse228, parse229): refactored.</p>

<p>Mon Mar 26 11:46:23 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (inspect_enumerator): show method arguments of 	  lazy
enumerators correctly.</p>

<p>Mon Mar 26 13:51:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (check_if_dir, check_if_wdir): fix for Visual C++ 	  not
to use S_ISDIR().  [Feature #<a href="ruby-core:26925">2408]</a></p>

<p>* ruby.c (load_file_internal): ditto.</p>

<p>Mon Mar 26 11:46:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (load_file_internal): bail out if the script is a directory. 	 
[Feature #<a href="ruby-core:26925">2408]</a></p>

<p>* win32/win32.c (rb_w32_open, rb_w32_wopen): check if the file is a 	 
directory when access denied, to set errno to EISDIR.</p>

<p>Sun Mar 25 18:13:14 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (tr_setup_table): fix multiple non latin argument for 	  non
latin (over 256 characters) tr-like methods. 	  [ruby-core:43371] [Bug
#6167]</p>

<p>Sun Mar 25 00:46:06 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator (lazy_initialize): set the instance variable “receiver” 	  to
include the receiver to the return value of inspect on a lazy 	  enumerator
directly created by Enumerator::Lazy.new.</p>

<p>* enumerator (RETURN_LAZY): don&#39;t set the instance variable
“receiver”.</p>

<p>Sat Mar 24 23:59:00 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator (enumerator_inspect): include the original receiver and 	 
method name of Enumerator::Lazy in the result of inspect. 	 
[ruby-core:43345] [Bug #6159]</p>

<p>* enumerator (InitVM_Enumerator): don&#39;t use rb_define_alias for 	 
some methods such as collect in order to make rb_frame_this_func() 	 
return the correct method names.</p>

<p>Sat Mar 24 22:22:18 2012  Sambasiva Rao Suda 
&lt;sambasivarao@gmail.org&gt;</p>

<p>* time.c (time_init_1): Time.new will accept seconds as string or 	  int. 
[ruby-core:43569][Bug #6193]</p>

<p>Fri Mar 23 15:12:12 2012  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* transcode.c (documentation for str_encode): Explain 	  that transcoding
to the same encoding is a no-op 	  (i.e. no exceptions, no replacements,…).
	  [ruby-core:43557][Bug #6190]</p>

<p>Fri Mar 23 13:19:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_str_to_inum): must be ASCII compatible encoding as 	  well
as String#hex and String#oct.  [ruby-core:43566][Bug #6192]</p>

<p>* string.c (rb_must_asciicompat): check if ASCII compatible.</p>

<p>Thu Mar 22 23:14:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c (str_encode_bang, encoded_dup): if nothing was 	 
transcoded, just set encoding but leave coderange unchanged as 	 
force_encoding.  [ruby-core:43557][Bug #6190]</p>

<p>Thu Mar 22 22:30:44 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* io.c (static int io_fflush): add the definition. 	  Use it in
set_binary_mode_with_seek_cur().</p>

<p>* io.c (set_binary_mode_with_seek_cur): refactoring to split the 	 
content into io_unread(). Fix the possibility of buffer overflow.</p>

<p>* io.c (io_unread): add new implementation for Windows. Previous one 	 
caused invalid cursor position using IO#pos with OS text mode. New 	  one
fixes the bug.</p>

<p>* test/ruby/test_io_m17n.rb 	 
(TestIO_M17N#test_pos_dont_move_cursor_position): add a test for 	  above
bug. 	  [ruby-core:43497] [Bug #6179]</p>

<p>Thu Mar 22 19:55:08 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_fstat, rb_w32_fstati64): convert FILETIME 	  to
time_t directly, not to be affected by TZ unnecessarily.</p>

<p>* win32/win32.c (unixtime_to_filetime): convert time_t to FILETIME 	 
simply.</p>

<p>Thu Mar 22 13:43:31 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_pkey_rsa.c (rsa_generate): fix argument type. 	  [Bug
#6094]</p>

<p>Thu Mar 22 11:14:10 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io.rb (TestIO#test_pos_with_getc): updated. 	  see
[ruby-core:43550]</p>

<p>Wed Mar 21 17:57:57 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regcomp.c: Merge Onigmo 3d855b30d574536d3ae600260208c6624ae4791c. 	 
[Bug#6143] [Bug#6144] [Bug#6145]</p>

<p>Wed Mar 21 17:01:55 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io.rb (TestIO#test_pos_with_getc): added. 	  see [Bug #<a
href="ruby-core:43518">6179]</a></p>

<p>Mon Mar 19 17:18:51 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_flat_map_func): convert the block value to 	  Array
if it doesn&#39;t respond to each.  [ruby-core:43334] 	  [Bug #6155]</p>

<p>Mon Mar 19 16:34:14 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enum.c (zip_i): variadic argument needs explicit cast on the 	 
platforms where VALUE is longer than int.</p>

<p>Mon Mar 19 15:36:41 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerable_lazy): add an example of take and first 	  to
the documentation.  [ruby-core:43344] [Bug #6158] 	  add the description of
the behavior when a block is given to zip 	  or cycle.</p>

<p>Mon Mar 19 15:20:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_specialized_instruction): DRY and replace chain 	  of
if-else with switch for special instructions.  based on a 	  patch by
Vasfed.  <a
href="https://github.com/ruby/ruby/pull/105">github.com/ruby/ruby/pull/105</a></p>

<p>Mon Mar 19 15:05:54 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* test/test_pty.rb: same as r29280, skip tests when PTY allocation 	 
failed (that&#39;s not our fault).</p>

<p>Sun Mar 18 23:21:17 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (aligned_free): fix condition for free.  memalign() and 	 
posix_memalign() are not defined together normally.</p>

<p>Sun Mar 18 18:31:45 2012  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* gc.c (aligned_malloc, aligned_free): added fallback implementations 	 
for platforms like OSX Leopard.</p>

<p>Sun Mar 18 17:17:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big_pow): estimate result bit size more precisely. 	 
[ruby-core:30735][Feature #3429]</p>

<p>Sun Mar 18 17:17:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (free_method_entry_i): method entry may be in 	 
unlinked_method_entry_list.  [ruby-core:43383][Bug #6171]</p>

<p>Sun Mar 18 15:27:31 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* compile.c: typo fix by Run Paint Run Run. 	  [ruby-core:28368] [Bug
#2824]</p>

<p>Sun Mar 18 10:01:02 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* lib/profiler.rb: support calling singleton methods of 	  an instance of
BasicObject.</p>

<p>Sat Mar 17 06:56:58 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c:  Fix indentation of Class#inherited example.</p>

<p>Sat Mar 17 01:46:05 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* string.c (trnext): fix bug with string ending with &#39;\&#39;. 	 
[ruby-dev:45374][Bug #6160]</p>

<p>* test/ruby/test_string.rb (TestString#test_delete): test for 	  above.</p>

<p>Fri Mar 16 20:06:24 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (trnext): should advance char-wise. 	  [ruby-core:43335][Bug
#6156]</p>

<p>Fri Mar 16 17:42:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (block_append_gen): fix unreachable warning line number. 	 
should warn at the code, not jump.</p>

<p>Fri Mar 16 17:33:08 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enum.c (enum_take): allocate buffer array before iteration, as well 	 
as enum_first did.</p>

<p>* enum.c (enum_first): remove duplication.</p>

<p>Fri Mar 16 14:43:18 2012  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* load.c (ruby_init_ext): don&#39;t free the given pointer itself. 	  It
is not guaranteed even that the pointer is on heap.</p>

<p>Fri Mar 16 14:37:57 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_eval.c (rb_mod_module_eval): fix the documentation of 	  class_eval
to mention class variable lookup.  [ruby-core:40649] 	  [Bug #5544]</p>

<p>Fri Mar 16 14:27:11 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_eval.c (rb_mod_module_eval): fix the documentation of 	  class_eval
to mention constant lookup.  [ruby-core:41718] 	  [Bug #5777]</p>

<p>Fri Mar 16 14:10:45 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (initialize): raise Net::IMAP::Error when the 	 
connection is closed without a greeting response. 	  [ruby-core:40938] [Bug
#5616]</p>

<p>Fri Mar 16 13:50:12 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (rfc822_text): ignore [] after RFC822. 	 
[ruby-core:40945] [Bug #5620]</p>

<p>Fri Mar 16 12:00:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (argument_error): use line number at the beginning 	  of
lambda, not the first code of its body. 	  [ruby-core:43314][Bug #6151]</p>

<p>* iseq.c (rb_iseq_first_lineno): constified.</p>

<p>Fri Mar 16 11:20:07 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_take): don&#39;t enumerate an extra value. 	 
[ruby-dev:45370] [Bug #6152]</p>

<p>Fri Mar 16 06:30:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_zip_func): variadic argument needs explicit cast 	 
on the platforms where VALUE is longer than int.</p>

<p>* enumerator.c (lazy_init_iterator): no need to check overflow twice.</p>

<p>Fri Mar 16 05:47:09 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enumerator.c (lazy_init_iterator):  Fix type error (int vs long).</p>

<p>Thu Mar 15 23:13:36 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enum.c (rb_enum_values_pack): rename from enum_values_pack, and 	 
remove static.</p>

<p>* enumerator.c (lazy_init_iterator, lazy_init_yielder, 	 
lazy_select_func, lazy_reject_func, lazy_grep_func): handle 	  multiple
values correctly.</p>

<p>* enumerator.c (lazy_grep): change the behavior when a block is 	  given,
to be consistent with Enumerable#grep.</p>

<p>Thu Mar 15 19:12:31 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_zip): rescue StopIteration returned by 	 
Enumerator#next.</p>

<p>Thu Mar 15 18:19:53 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_zip, lazy_cycle): Enumerator::Lazy#<code>zip,cycle</code> 	 
should be eager when a block is given, to be consistent with 	 
Enumerable#<code>zip,cycle</code>.</p>

<p>Thu Mar 15 17:45:27 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (InitVM_Enumerator): renamed Enumerable::Lazy to 	 
Enumerator::Lazy.</p>

<p>Thu Mar 15 16:37:38 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerable_lazy): added cycle to the documentation.</p>

<p>Thu Mar 15 15:37:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_yylex): fix warning line number.</p>

<p>Thu Mar 15 15:19:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_cycle): check argument number overflow before 	 
creating temporary array.</p>

<p>Thu Mar 15 15:04:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (ruby_strtod): no need to check same digit for hexdigit 	  twice.
[ruby-dev:45363][Bug #6146]</p>

<p>* parse.y (sym_check_asciionly): check ascii compatibility before 	 
scanning for code range.</p>

<p>* parse.y (intern_str): set to us-ascii if ascii only. 	 
[ruby-dev:45363][Bug #6146]</p>

<p>* file.c (ruby_enc_find_basename): allow NULL as alllen. 	 
[ruby-dev:45363][Bug #6146]</p>

<p>Thu Mar 15 14:49:31 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_conv_enc_opts): default to original encoding.</p>

<p>Thu Mar 15 13:47:17 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* hash.c (env_str_new, rb_f_getenv, env_fetch): use rb_str_conv_enc() 	 
instead of rb_str_encode() to simplify the code.</p>

<p>Thu Mar 15 12:44:50 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c, include/ruby/win32.h (rb_w32_ugetenv): new API to 	 
accept and to return UTF-8 strings.</p>

<p>* win32/win32.c (rb_w32_getenv): follow above change.</p>

<p>* win32/win32.c (rb_w32_get_environ): returns UTF-8 environment area.</p>

<p>* hash.c (env_str_new, rb_f_getenv, env_fetch): follow above changes. 	 
[Bug #5570] [ruby-core:40737]</p>

<p>Thu Mar 15 10:57:27 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_cycle): add Enumerable::Lazy#cycle.</p>

<p>Thu Mar 15 10:31:40 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/test_arity.rb (TestArity#err_mess): use assert_raise.</p>

<p>Thu Mar 15 07:03:52 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* vm_eval.c (check_funcall):  Raise ArgumentError if respond_to? 	 
requires more than three arguments. [Bug #6000]</p>

<p>* test/ruby/test_object.rb (class TestObject):  Test for respond_to? 	 
requiring more than three arguments.</p>

<p>Thu Mar 15 06:08:06 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* include/ruby/intern.h: Add rb_check_arity, rb_error_arity [#6085]</p>

<p>* array.c: Use rb_check_arity / rb_error_arity</p>

<p>* class.c: ditto</p>

<p>* enumerator.c: ditto</p>

<p>* eval.c: ditto</p>

<p>* file.c: ditto</p>

<p>* hash.c: ditto</p>

<p>* numeric.c: ditto</p>

<p>* proc.c: ditto</p>

<p>* process.c: ditto</p>

<p>* random.c: ditto</p>

<p>* re.c: ditto</p>

<p>* signal.c: ditto</p>

<p>* string.c: ditto</p>

<p>* struct.c: ditto</p>

<p>* transcode.c: ditto</p>

<p>* vm_eval.c: ditto</p>

<p>* vm_insnhelper.c: ditto &amp; implementation of rb_error_arity</p>

<p>* test/ruby/test_arity.rb: tests for above</p>

<p>Thu Mar 15 06:08:05 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* vm_insnhelper.c: improve number of arguments error in case of 	 
optional parameters (issue #6085)</p>

<p>* include/ruby/intern.h: define UNLIMITED_ARGUMENTS</p>

<p>* test/ruby/test_arity.rb:  test for above</p>

<p>Thu Mar 15 00:58:04 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerable_lazy): fix the documentation of 	 
Enumerable#lazy.</p>

<p>Wed Mar 14 22:01:06 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_init_iterator): break when Qundef is returned 	  to
make obj.drop(3).take(2) work properly.</p>

<p>* enumerator.c (lazy_take_while): add Enumerable::Lazy#take_while.</p>

<p>* enumerator.c (lazy_drop): add Enumerable::Lazy#drop.</p>

<p>* enumerator.c (lazy_drop_while): add Enumerable::Lazy#drop_while.</p>

<p>* enumerator.c (InitVM_Enumerator): add Enumerable::Lazy#force as an 	 
alias of to_a.</p>

<p>Wed Mar 14 19:28:40 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_take): add Enumerable::Lazy#take.</p>

<p>Wed Mar 14 18:40:36 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c: use long for array indices.</p>

<p>Wed Mar 14 18:25:18 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c: moved the comment of StopIteration.</p>

<p>Wed Mar 14 17:55:29 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* numeric.c (flodivmod): must go through the same pass if HAVE_FMOD or 	 
not.  this is a bugfix of r35013.</p>

<p>Wed Mar 14 16:41:55 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/test_tmpdir.rb (TestTmpdir#test_world_writable): skip on Windows.</p>

<p>Wed Mar 14 15:09:23 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c: fix flodivmod for cornercases [Bug #6044] 	  add
ruby_float_mod</p>

<p>* insns.def (opt_mod): use ruby_float_mod</p>

<p>* internal.h: declare ruby_float_mod</p>

<p>* test/ruby/test_float.rb: tests for above</p>

<p>* test/ruby/envutil.rb: create helper assert_is_minus_zero</p>

<p>Wed Mar 14 10:44:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_grep_func): should use === instead of =~, as 	  well
as Enumerable#grep</p>

<p>Wed Mar 14 08:15:54 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_flat_map_func): use each for non-Array objects.</p>

<p>Wed Mar 14 08:06:35 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_zip): add Enumerable::Lazy#zip.</p>

<p>* enumerator.c (lazy_lazy): just returns self.</p>

<p>Wed Mar 14 07:48:36 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c (datetime_s_now): [ruby-core:43256].</p>

<p>Tue Mar 13 22:00:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_set_arguments): keyword rest arg without keyword args.</p>

<p>* node.c (dump_node): dump kw_rest_arg too.</p>

<p>* parse.y (block_param, f_arg): more kwrest patterns. 	 
[ruby-core:42455][Bug #5989]</p>

<p>* parse.y (new_args_gen): no extra kw_rest_arg if no keyword rest arg.</p>

<p>Tue Mar 13 15:17:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (block_param, f_args): add rules for the case arguments 	  begin
with kwrest.  [ruby-core:42455][Bug #5989]</p>

<p>Tue Mar 13 12:37:53 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (io_encoding_set): always warn if external encoding and internal 	 
encoding are identical. [ruby-core:40727] [Bug #5568]</p>

<p>Tue Mar 13 12:37:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c: add ObjectSpace::WeakMap.  [ruby-dev:44565][Bug #5350]</p>

<p>* lib/weakref.rb: use WeakMap instead of _id2ref.</p>

<p>Tue Mar 13 10:59:48 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (prepare): skip if basedir is not defined. 	 
[ruby-core:39135][Bug #5238]</p>

<p>* tool/rbinstall.rb (CONFIG.[]): check for mandatory 	  configurations.</p>

<p>Tue Mar 13 00:09:18 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerable_lazy): added documentation.</p>

<p>Mon Mar 12 20:19:25 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/tmpdir.rb (Dir::tmpdir): test the current directory suitable for 	 
temporary directory.</p>

<p>Mon Mar 12 20:08:16 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/fileutils.rb (fu_have_symlink?): specify TypeError for rescue 	 
clause.</p>

<p>Mon Mar 12 19:23:13 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* encoding.c (rb_find_encoding): new function find encoding from 	 
arbitrary object as a pointer to rb_encoding, and return NULL if 	  not
found.</p>

<p>* io.c (io_encoding_set): just warn unsupported encodings, but not 	 
exception.  [ruby-core:40726] [Bug #5567]</p>

<p>Mon Mar 12 19:03:32 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (Init_eval_method): respond_to? and 	  respond_to_missing?
are public.</p>

<p>Mon Mar 12 14:56:52 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* node.h (NEW_YIELD), parse.y (new_yield_gen): array-values flags 	  has
been already obsolete.  patch by Thomas Enebo. 	  [ruby-core:41929][Bug
#5847]</p>

<p>Mon Mar 12 12:44:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (Init_eval_method): copy basic methods to Exception. 	 
[ruby-core:40287][Bug #5473]</p>

<p>Mon Mar 12 10:13:36 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval_jump.c (rb_exec_end_proc): remember the latest exit status. 	 
[ruby-core:43173][Bug #5218]</p>

<p>Mon Mar 12 07:33:12 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/tmpdir.rb: update document for changing 	 
FileUtils.remove_entry_secure to FileUtils.remove_entry.</p>

<p>* NEWS: add incompatibility note for lib/tmpdir.rb.</p>

<p>Mon Mar 12 07:19:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/tmpdir.rb (Dir.tmpdir): should not use world-writable but 	 
non-sticky directory.</p>

<p>* lib/tmpdir.rb (Dir.mktmpdir): check the parent directory.</p>

<p>Mon Mar 12 07:04:11 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (Init_Random): removed rb_Random_DEFAULT and register as 	 
mark-object instead of global variable.</p>

<p>Mon Mar 12 07:03:32 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (random_s_rand): ensure default PRNG is re-initialized 	  after
fork.  patched by Eric Wong.  [ruby-core:41209][Bug #5661]</p>

<p>Sun Mar 11 23:57:29 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* pack.c (pack_unpack): when unpack(&#39;M&#39;) occurs an illegal byte 	 
sequence, output the “=” character and the following character in 	  the
decoded data without any transformation. 	  [ruby-dev:44875] [Bug #5635]</p>

<p>Sun Mar 11 22:32:43 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json: Merge 164a75c8bd2007d32c4d7665d53140d8fc126dcd. 	 
[ruby-core:41917] [Bug #5846]</p>

<p>Sun Mar 11 17:10:04 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb: Put error message into STDERR if failed to launch 	 
worker (job) process. [ruby-dev:44802] [Bug #5577]</p>

<p>* lib/test/unit/parallel.rb: If failed to increment_io, exit with code 	 
2. [ruby-dev:44802] [Bug #5577]</p>

<p>Sun Mar 11 15:46:45 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* io.c: fix rdoc of `IO.binwrite` to show same as `IO.write` except 	  it
opens file with mode “wb:ASCII-8BIT”. [Bug #5782] [ruby-core:42592]</p>

<p>Sat Mar 10 23:52:28 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c: pack tables also generic keys.  patched by Sokolov Yura at 	  <a
href="https://github.com/ruby/ruby/pull/84">github.com/ruby/ruby/pull/84</a></p>

<p>* st.c: add st_foreach_check for fixing iteration over packed table 	  and
st_delete_safe.  patched by Sokolov Yura at 	  <a
href="https://github.com/ruby/ruby/pull/84">github.com/ruby/ruby/pull/84</a></p>

<p>* st.c: fix packed num_entries on delete_safe.  patched by Sokolov 	  Yura
at <a
href="https://github.com/ruby/ruby/pull/84">github.com/ruby/ruby/pull/84</a></p>

<p>Fri Mar  9 14:29:32 2012  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_flat_map): add Enumerable::Lazy#flat_map.</p>

<p>Fri Mar  9 06:29:22 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb (load, parse): stop parsing or loading after 	 
the first document has been parsed.</p>

<p>* test/psych/test_stream.rb: pertinent tests.</p>

<p>Fri Mar  9 06:17:05 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb (parse_stream, load_stream): if a block is 	 
given, documents will be yielded to the block as they are parsed. 	 
[ruby-core:42404] [Bug #5978]</p>

<p>* ext/psych/lib/psych/handlers/document_stream.rb: add a handler that 	 
yields documents as they are parsed</p>

<p>* test/psych/test_stream.rb: corresponding tests.</p>

<p>Fri Mar  9 00:35:03 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_initialize, enumerable_lazy): no additional 	 
arguments.</p>

<p>Fri Mar  9 00:30:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c: add Enumerable#lazy. based on the patch by 	  Innokenty
Mikhailov at &lt;<a
href="https://github.com/ruby/ruby/pull/101">github.com/ruby/ruby/pull/101</a>&gt;
	  [ruby-core:37164] [Feature #4890]</p>

<p>Fri Mar  9 00:25:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerator_each, generator_each): pass arguments to 	  the
block with yielder.</p>

<p>Fri Mar  9 00:25:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_cat): new function to concat objects into array.</p>

<p>Thu Mar  8 16:44:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* .gdbinit (rb_numtable_entry): update for recent refactoring of 	 
st_table.</p>

<p>Wed Mar  7 22:41:50 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* lib/xmlrpc/client.rb (module XMLRPC): fix typo.</p>

<p>* test/xmlrpc/test_client.rb (test_async_call): add test for 	 
XMLRPC::Client#call_async to check above fix.</p>

<p>Wed Mar  7 16:30:24 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_load_fail): should honor encoding.</p>

<p>* load.c (load_failed): ditto.</p>

<p>Wed Mar  7 12:26:25 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_load_fail): use path as a string, not char*.</p>

<p>* internal.h: (rb_load_fail): moved from ruby/intern.h.</p>

<p>* ruby.c (load_file_internal): fname cannot be NULL.</p>

<p>Wed Mar  7 08:32:43 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* error.c (rb_loaderror_with_path): Adding the missing file as an 	 
instance variable to the LoadError exception. 	  [ruby-core:39079]</p>

<p>* load.c: call rb_loaderror_with_path so that the missing path is 	  added
to the exception.</p>

<p>* ruby.c: call rb_loaderror rather than raising our own LoadError 	 
exception.</p>

<p>* include/ruby/intern.h: add declaration for rb_loaderror_with_path.</p>

<p>* test/ruby/test_require.rb: add supporting test for LoadError#path 	 
method.</p>

<p>Wed Mar  7 08:28:00 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/xmlrpc/parser.rb: support i8 types. Thanks Stas Kelvich! 	 
[ruby-core:29246] [Feature #3090]</p>

<p>* test/xmlrpc/test_client.rb: supporting test</p>

<p>Wed Mar  7 07:43:29 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/xmlrpc/client.rb: assume servers that do not send a Content-Type 	 
header are sending &#39;text/xml&#39;. Thanks Nathan Leavitt! 	 
[ruby-core:41204] [Bug #5660]</p>

<p>* test/xmlrpc/test_client.rb: supporting test</p>

<p>Wed Mar  7 07:39:28 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* test/xmlrpc/test_client.rb: adding a test for performing an XMLRPC 	 
call. 	* test/xmlrpc/data/blog.xml: supporting XML document for the
response.</p>

<p>Tue Mar  6 16:24:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_tokadd_string): escape simple regexp meta 	  character
terminators.</p>

<p>Tue Mar  6 10:11:43 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (set_rawmode): clear ECHOE and ECHOK 	  bits
too.</p>

<p>* ext/io/console/console.c (echo_p): ignore ECHOE and ECHOK bits. 	 
[ruby-dev:45309] [Bug #6116]</p>

<p>* ext/io/console/console.c (console_raw): fix rdoc.</p>

<p>* ext/io/console/console.c (console_set_echo): mentioned about 	  platform
dependency.</p>

<p>Tue Mar  6 07:18:10 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/xmlrpc/client.rb: switch net/http post2 calls to modern 	 
`request_post` methods.</p>

<p>Tue Mar  6 02:31:20 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/core_ext.rb: only extend Kernel if IRB is loaded 	 
in order to stop method pollution.</p>

<p>Tue Mar  6 01:34:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (block_call): rules for block_call after block_call. 	  based on
a patch by pasberth <a
href="https://github.com/ruby/ruby/pull/102">github.com/ruby/ruby/pull/102</a>
	  [ruby-dev:45308][Bug #6115]</p>

<p>Tue Mar  6 01:24:13 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (block_command, block_call): simplified rules.</p>

<p>Mon Mar  5 18:28:35 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/ruby/test_regexp.rb (TestRegexp#test_source): fix typo. 	*
test/ruby/test_regexp.rb (TestRegexp#test_equal): ditto.</p>

<p>Mon Mar  5 17:11:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/syck/lib/syck/rubytypes.rb (Exception.yaml_new): fix bug 	  that
causes YAML serialization problem for Exception. 	  Exception#initialize
doesn&#39;t use visible instance variable for 	  the exception message, so
call the method with the message. 	  patched by Jingwen Owen Ou
&lt;jingweno AT gmail.com&gt;. 	  <a
href="http://github.com/ruby/ruby/pull/41">github.com/ruby/ruby/pull/41</a></p>

<p>Mon Mar  5 16:50:22 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_sleep.rb (TestSleep#test_sleep_5sec): syntax error.</p>

<p>* test/ruby/test_sleep.rb (TestSleep#test_sleep_5sec): call uname 	  only
on linux because it&#39;s a workaround for linux only.</p>

<p>Mon Mar  5 12:44:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c (unpack_entries): chain entries directly.  based on a patch 	  by
Sokolov Yura &lt;funny.falcon AT gmail.com&gt;.</p>

<p>* st.c (unpack_entries): use union instead of casted pointer. 	  patched
by Sokolov Yura &lt;funny.falcon AT gmail.com&gt;.</p>

<p>* st.c: use PACKED_ENT and FIND_ENTRY.  patched by Sokolov 	  Yura
&lt;funny.falcon AT gmail.com&gt;.</p>

<p>* st.c (unpack_entries): reallocate bins if packed array size 	  is not
same as initial bins size.  based on a patch by 	  Sokolov Yura
&lt;funny.falcon AT gmail.com&gt;.</p>

<p>Mon Mar  5 11:51:48 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/math.rb: remove description about 	 
BigMath#log. patched by Sho Hashimoto [ruby-dev:45307] [Bug #6112]</p>

<p>* string.c (str_byteslice): fix typo.</p>

<p>Sun Mar  4 23:21:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_tokadd_string): regexp engine doesn&#39;t need 	 
terminators to be escaped.  [ruby-core:40364][Bug #5484]</p>

<p>Sat Mar  3 22:51:46 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (rb_run_exec_options_err): chdir at last to interpret 	 
relative pathnames from the current directory of the parent process.</p>

<p>Sat Mar  3 12:20:44 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strftime.c: reassigned some variables.</p>

<p>Sat Mar  3 12:12:16 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_<code>parse,strptime</code>.c: [ruby-dev:45303].</p>

<p>Sat Mar  3 10:09:21 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/xmlrpc/client.rb (initialize): net/http defaults to 1_2 in 1.8+, 	 
so we can safely remove the call to enable it.</p>

<p>Sat Mar  3 08:42:25 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/xmlrpc/client.rb (new2): use URI for uri parsing. 	*
test/xmlrpc/test_client.rb: test that query params are passed to the 	 
client constructor.</p>

<p>Sat Mar  3 08:20:10 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/xmlrpc/client.rb (new2): raises an ArgumentError on bad 	 
arguments. 	* test/xmlrpc/test_client.rb: tests for bad uris</p>

<p>Sat Mar  3 08:08:11 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/xmlrpc/client.rb (new2): fix custom port specification when an 	 
SSL uri is used. 	* test/xmlrpc/test_client.rb: tests for
XMLRPC::Client.new2</p>

<p>Sat Mar  3 08:03:29 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/syck/rubyext.c (mktime_do): use ISDIGIT(). 	  [ruby-core:43060] [Bug
#6108]</p>

<p>* ext/syck/token.c (sycklex_yaml_utf8): cast as unsigned char. 	 
[ruby-core:43060] [Bug #6108]</p>

<p>Sat Mar  3 06:57:14 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (ruby_pc): make configurable.  [Bug #6051]</p>

<p>Fri Mar  2 17:49:03 2012  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* .travis.yml (branches): Enable TravisCI for ruby_1_9_3.</p>

<p>Fri Mar  2 17:13:33 2012  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* test/ruby/test_array.rb (test_combination2): Make the test case for 	 
[ruby-core:29240] more descriptive. 	  cf. <a
href="http://bugs.jruby.org/6518">bugs.jruby.org/6518</a></p>

<p>Fri Mar  2 16:37:11 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (file_expand_path): use wcscasecmp().</p>

<p>Fri Mar  2 16:36:31 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (native_cond_timeout): cast explicitly to suppress 	  a
warning.</p>

<p>Fri Mar  2 16:35:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (pipe_open): cmd is no longer used if fork is available.</p>

<p>Thu Mar  1 16:13:18 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h (rb_file_const, rb_file_load_ok): moved functions for 	 
internal use only.</p>

<p>Thu Mar  1 15:40:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/makedirs.bat: new command to make intermediate 	  directories, and
not to report any errors if the directory 	  already exists.</p>

<p>* win32/Makefile.sub (MAKEDIRS): enable command extensions.</p>

<p>Thu Mar  1 01:25:43 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (is_onechar_cclass): optimize character class 	  Merge Onigmo
27278c12e6674043cc8affca6507e20e119a86ee.</p>

<p>* regparse.c (is_onechar_cclass): [bug] unexpected match occurs when a 	 
char class contains no char</p>

<p>* enc/unicode.c (init_case_fold_table): define the sizes of case 	 
folding tables in casefold.h</p>

<p>Wed Feb 29 16:11:34 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (MAKEDIRS): use mkdir of cmd.exe instead of ruby. 	 
[Bug #6103] [ruby-core:43012]</p>

<p>* win32/README.win32: added a notice about command extension of cmd.exe.</p>

<p>Wed Feb 29 15:39:39 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io.rb (TestIO#test_readpartial_locktmp): skip on 	 
windows because of the platform restriction.</p>

<p>Wed Feb 29 15:38:50 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/memory_status.rb (Memory): syntax error.</p>

<p>Wed Feb 29 13:06:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/memory_status.rb: use /proc/self/status if it is in 	  the
expected format.</p>

<p>Wed Feb 29 06:14:51 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: reverted r34825.</p>

<p>Tue Feb 28 23:20:01 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* Makefile.in (PLATFORM_DIR): add a variable for `win32` directory. 	*
Makefile.in (clean-platform): add new target. 	  It cleans `win32`
directory.</p>

<p>* common.mk (clean): add a dependency for `win32` directory. 	* common.mk
(distclean): ditto. 	* common.mk (distclean-platform): add new target. 	 
It cleans `win32` directory. 	* common.mk ($(PLATFORM_D)): add new target
to make `win32` directory. 	* common.mk (win32/win32.$(OBJEXT)): move
win32.o into `win32` 	  directory. 	* common.mk (win32/file.$(OBJEXT)): add
new target for win32/file.c.</p>

<p>* configure.in: move win32.o into `win32` directory and add 	 
win32/file.o to MISSING.</p>

<p>* file.c (file_load_ok, rb_file_load_ok): replace static 	  file_load_ok()
with public rb_file_load_ok(). 	  It&#39;s to link Windows implementation
in win32/file.c. 	* file.c (rb_find_file_ext_safe): ditto. 	* file.c
(rb_find_file_safe): ditto.</p>

<p>* win32/file.c (rb_file_load_ok): new file. Add Windows specific 	 
optimized implementation of rb_file_load_ok(). We created a 	  separated
file to avoid too many #ifdef macro which is unreadable.</p>

<p>* win32/Makefile.sub (PLATFORM_DIR): add a variable for `win32` 	 
directory. 	* win32/Makefile.sub (MISSING): move win32.obj into `win32` 	 
directory and add win32/file.obj to MISSING. 	* win32/Makefile.sub
(MAKEDIRS): replace MINIRUBY with BASERUBY. 	  It&#39;s because miniruby
doesn&#39;t exist when making `win32` directory. 	* win32/Makefile.sub
(clean-platform): add new target to clean `win32` 	  directory. 	*
win32/Makefile.sub (<code>$(srcdir)</code>.c{}.obj): make it not match 	  win32/file.c
to build properly. 	* win32/Makefile.sub (win32/win32.$(OBJEXT)): move
win32.obj into 	 `win32` directory.</p>

<p>Patch created with Luis Lavena. 	  [ruby-core:42480] [Feature #5999]</p>

<p>Tue Feb 28 20:27:25 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: [ruby-core:42998]</p>

<p>Tue Feb 28 18:47:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_binwrite, rb_io_syswrite): use shared frozen source 	  strings.</p>

<p>* io.c (io_fread, io_getpartial, rb_io_sysread): set buffer size 	  after
check if readable, which can cause thread switch. 	  [ruby-dev:45297][Bug
#6099]</p>

<p>Tue Feb 28 17:16:01 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/time.rb (Time#xmlschema): use strftime specifiers instead of 	 
fractional exponential calculation which yields undesirable 	  result. 
[ruby-core:42997][Bug #6100]</p>

<p>Tue Feb 28 14:15:29 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/protocol.rb: Add OpenTimeout subclass of Timeout::Error 	*
lib/net/pop.rb:  Modernize Timeout usage.  Patch by Eric Wong. 	  Use
Net::OpenTimeout instead of Timeout::Error.  [Bug #5765] 	*
lib/net/http.rb:  ditto 	* lib/net/smtp.rb:  ditto 	* lib/net/telnet.rb: 
ditto</p>

<p>Tue Feb 28 13:51:12 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Retry HTTP requests for additional network errors. 	 
Introduce OpenTimeout subclass of Timeout::Error.  [Bug #6001] 	*
test/net/http/test_http.rb:  Reduce timeout to 0.01s for faster test 	*
test/net/http/test_https.rb:  ditto</p>

<p>Tue Feb 28 11:44:49 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (debugflags): check if -ggdb is accepted. 	 
[ruby-core:42875][Bug #6080]</p>

<p>Tue Feb 28 10:28:51 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: default open YAML files with utf8 external 	 
encoding. [ruby-core:42967] 	* test/psych/test_tainted.rb: ditto</p>

<p>Mon Feb 27 23:46:09 2012  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* parse.y (opt_bv_decl): allow newline at the end.  [ruby-dev:45292]</p>

<p>Mon Feb 27 20:43:05 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_set_pos): add rdoc about textmode.</p>

<p>* test/ruby/test_io.rb (TestIO#test_setpos): use binmode.</p>

<p>Mon Feb 27 17:00:15 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* string.c (rb_str_crypt): Update rdoc and state that this 	  function is
system dependent.  Reviewed by nobu, thanks to 	  @takai.</p>

<p>Mon Feb 27 17:03:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (GetVpValueWithPrec): since methods 	  can
be overridden, so should not make an assumption on the type 	  of results. 
[ruby-core:42969][Bug #6093]</p>

<p>Mon Feb 27 10:54:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (try_cppflags, try_cflags, try_ldflags): replace the 	 
target flags if the given flag is accepted.</p>

<p>Mon Feb 27 10:53:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_specification.rb
(test_self_from_yaml_syck_default_key_bug): 	  ignore the test for too old
versions.</p>

<p>Mon Feb 27 10:53:12 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#puke): skips with no 	  messages
should be trivial.</p>

<p>Mon Feb 27 10:50:23 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c, process.c, time.c, ext: use rb_sys_fail_str instead of 	 
rb_sys_fail.</p>

<p>Mon Feb 27 10:48:49 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/openssl/extconf.rb: suppress useless deprecation warnings 	  from
OpenSSL added by Apple.</p>

<p>Sun Feb 26 23:29:49 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (add_code_range_to_buf0): wrong condition of duplicated 	 
warnings.</p>

<p>Sun Feb 26 11:26:44 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_compile_each): call on special object instead of 	 
self.  since stabby lambda is a syntax, so it should not be 	  affected by
the context.  [ruby-core:42349][Bug #5966]</p>

<p>* insns.def (send): no special deal for FCALL.  self should be put 	  on
TOS instead.</p>

<p>Sun Feb 26 05:35:43 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* error.c (report_bug): use buf and snprintf to avoid consuming stack. 	 
[ruby-dev:45272] [Bug #6058]</p>

<p>Sat Feb 25 17:41:19 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb (headers): try ambiguous headers at last.</p>

<p>Sat Feb 25 17:07:15 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/fileutils.rb: use chomp(?/) instead of sub to optimize and avoid 	 
to regexping invalid string.</p>

<p>Sat Feb 25 16:18:24 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* complex.c (nucomp_marshal_load): raise error on invalid data. 	 
reported by John Firebaugh [ruby-core:42860] [Bug #6076]</p>

<p>Sat Feb 25 14:46:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dl/dl.c (Init_dl): support intrinsic types, size_t, ptrdiff_t 	  and
intptr_t.  [ruby-core:42460][Feature #5992]</p>

<p>* ext/fiddle/fiddle.c (Init_fiddle): ditto.</p>

<p>* ext/dl/lib/dl/cparser.rb (DL::CParser#parse_ctype): ditto.</p>

<p>Sat Feb 25 11:08:28 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/curses.c (Init_curses): use rb_define_const once for 	 
Curses::VERSION.</p>

<p>* ext/dbm/dbm.c (Init_dbm): ditto for DBM::VERSION.</p>

<p>Sat Feb 25 10:34:22 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/curses.c (Init_curses): make Curses::VERSION 	 
understandable without context.</p>

<p>* ext/dbm/dbm.c (Init_dbm): ditto for DBM::VERSION.</p>

<p>Sat Feb 25 07:53:58 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_tokadd_string): insert a backslash only if 	  quoted by
single quotes.  [ruby-dev:45281] [Bug #6069]</p>

<p>Sat Feb 25 07:53:49 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (dir_inspect), io.c (rb_io_inspect): keep encoding of path. 	 
[Bug #6072]</p>

<p>Sat Feb 25 07:53:40 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (dir_initialize): keep path in original encoding.</p>

<p>* error.c (syserr_initialize): prefer the encoding of message over 	 
locale.  [ruby-dev:45279][Bug #6071]</p>

<p>Sat Feb 25 06:55:29 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (utime_internal): fix a variable missed to replace. 	 
[ruby-core:42864] [Bug #6077]</p>

<p>Fri Feb 24 18:21:55 2012  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* test/zlib/test_zlib.rb (TestZlibGzipReader#test_encoding): Add 	 
encoding testcases for GzipReader#read.  read() emits 	 
Encoding.default_external in contrast to read(size) emits BINARY. 	  See
also: <a href="http://bugs.jruby.org/6208">bugs.jruby.org/6208</a></p>

<p>Fri Feb 24 17:56:39 2012  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* test/ruby/test_literal.rb (TestRubyLiteral#test_special_const): 	  test
for <a
href="https://bugs.php.net/bug.php?id=61095">bugs.php.net/bug.php?id=61095</a></p>

<p>Fri Feb 24 16:48:29 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c, file.c, io.c (rb_sys_fail_path): use rb_sys_fail_str.</p>

<p>* error.c: new functions to deal exceptions with string instances.</p>

<p>* dir.c, file.c, io.c: use rb_sys_fail_path.</p>

<p>Fri Feb 24 15:49:07 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (__builtin_unreachable): check for clang. 	 
[ruby-core:42849]</p>

<p>* include/ruby/ruby.h (UNREACHABLE): fallback definition.</p>

<p>Fri Feb 24 13:54:33 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c: prevent a memory leak by protecting calls to 	 
handler callbacks. 	* test/psych/test_parser.rb: test to demonstrate leak.</p>

<p>Fri Feb 24 12:07:34 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/net/http.rb: Fix documentation. Patched from Florian Mhun 	  via <a
href="http://github.com/ruby/ruby/pull/96">github.com/ruby/ruby/pull/96</a></p>

<p>Fri Feb 24 11:48:07 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* string.c (rb_str_prepend): Fix documentation for String#prepend. 	 
Patched from Franck Verrot via <a
href="http://github.com/ruby/ruby/pull/98">github.com/ruby/ruby/pull/98</a>
	  and Andrew Horsman via <a
href="http://github.com/ruby/ruby/pull/55">github.com/ruby/ruby/pull/55</a></p>

<p>Fri Feb 24 10:08:33 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb (Net::HTTP#transport_request):  Fix infinite loop 	 
upon EOFError or Errno::ECONNRESET where count is reset to 0. 	*
test/net/http/test_http.rb (class TestNetHTTPKeepAlive):  Test for 	 
above.</p>

<p>Fri Feb 24 09:05:40 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* complex.c (Init_Complex):  Document Complex::I.  Patch by Sylvain 	 
Daubert.  [Feature #5623]</p>

<p>Fri Feb 24 08:52:09 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_tokadd_string, parser_yylex): insert a backslash 	  if
the next character is non-ascii.  [ruby-dev:45278] [Bug #6069]</p>

<p>Fri Feb 24 08:13:20 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/profiler.rb:  Add Profiler documentation by Gonzalo Rodriguez. 	 
[Bug #5816]</p>

<p>Fri Feb 24 08:08:38 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c: set parser encoding based on the YAML input 	 
rather than user configuration. 	* test/psych/test_encoding.rb:
corresponding tests. 	* test/psych/test_parser.rb: ditto 	*
test/psych/test_tainted.rb: ditto</p>

<p>Fri Feb 24 08:02:52 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* hash.c (Init_Hash):  Add section on how objects are used as Hash keys 	 
and how to use custom classes as Hash keys.</p>

<p>Fri Feb 24 07:36:11 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c (rb_obj_eql):  Improve equality documentation by adding an 	 
example of equal? vs == and recommending eql? be aliased to == when 	 
overridden.</p>

<p>Fri Feb 24 07:21:15 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c (rb_obj_hash):  Added note that the hash value is not 	 
deterministic on Marc-Andre&#39;s suggestion.  Expanded description of 	 
the purpose of the hash method.  [Bug #6068]</p>

<p>Thu Feb 23 23:01:21 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: unused macro removed.</p>

<p>Thu Feb 23 22:26:53 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/test_curses.rb: new file.</p>

<p>Thu Feb 23 19:57:56 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/rain.rb: trap SIGHUP, SIGINT, SIGQUIT and SIGTERM only.</p>

<p>Thu Feb 23 19:56:48 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* signal.c (sig_trap): show signal name on error.</p>

<p>Thu Feb 23 12:21:48 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: use DBM_SUFFIX only to detect header of 	  Berkeley
DB.</p>

<p>Thu Feb 23 10:00:18 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* io.c (rb_io_f_sync):  Fix double-negative typo.  [ruby-trunk - #5837]</p>

<p>Thu Feb 23 09:57:21 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* load.c (rb_f_require):  Add note to require for scope of items in the 	 
loaded file.  [ruby-trunk - #5910]</p>

<p>Thu Feb 23 03:58:08 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/ostruct.rb (delete_field): Bug fix so previous value is 	  returned.
Patch by Nick Recobra [Bug #6063]</p>

<p>Thu Feb 23 02:33:00 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_extract_modeenc): fail only if conflicting 	  text/binary
modes given explicitly.  [ruby-dev:45268][Bug #6055]</p>

<p>Wed Feb 22 23:27:08 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/iconv/test_option.rb: enabled.  [ruby-core:42802][Bug #6061]</p>

<p>Wed Feb 22 21:45:56 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/curses.c: use defined() to suppress a warning.</p>

<p>Wed Feb 22 21:44:29 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/extconf.rb: refactored.</p>

<p>Wed Feb 22 20:42:28 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/extconf.rb: try to distinguish curses_version is a 	 
function or variable.</p>

<p>* ext/curses/curses.c (Init_curses): refine Curses::VERSION.</p>

<p>Wed Feb 22 19:47:03 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/extconf.rb: show the chosen header and library.</p>

<p>Wed Feb 22 19:22:31 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* reverted 34739 for test/date.</p>

<p>Wed Feb 22 19:08:55 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/extconf.rb: refactored.</p>

<p>Wed Feb 22 18:44:41 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb (setup_options): add option “–retry” as opposite 	  for
“–no-retry”</p>

<p>Wed Feb 22 18:34:02 2012  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb (setup_options): add option “–show-skip” to 	  cancel
“–hide-skip” (-q)</p>

<p>Wed Feb 22 17:36:22 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_s_foreach): argument check before making Enumerator. 	 
[ruby-dev:31525]</p>

<p>Wed Feb 22 17:07:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_s_foreach): return enumerator including keyword 	 
arguments.  [ruby-dev:45267][Bug #6054]</p>

<p>Wed Feb 22 12:15:16 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: allow llvm-gcc because it work fine with r34278.</p>

<p>Wed Feb 22 10:57:08 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (fetch_token): don&#39;t use // comment.</p>

<p>Wed Feb 22 10:32:11 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/mkmf/test_framework.rb: try CoreFoundation framework, than 	  Cocoa
which is dependent on QuickTime SDK which has separated 	  since Xcode 4.3.</p>

<p>Wed Feb 22 10:18:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (test-all, test-ruby): more dependencies.</p>

<p>Wed Feb 22 06:48:55 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* file.c (rb_f_test):  Fix formatting of Kernel#test rdoc.</p>

<p>Wed Feb 22 06:12:15 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: check DBM_SUFFIX for Mac OS X. 	  Its ndbm.h
doesn&#39;t include db.h.</p>

<p>Wed Feb 22 06:02:42 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/dbm.c (fdbm_initialize): disable Berkeley DB error messages.</p>

<p>* ext/dbm/extconf.rb: check DBC type for above.</p>

<p>[ruby-dev:45269]</p>

<p>Tue Feb 21 20:23:47 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_any_hash): treat Qundef like as other special constants.</p>

<p>* hash.c (hash_foreach_iter): fix signature.</p>

<p>Tue Feb 21 19:39:34 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/curses.c (Init_curses): use curses_version() for 	 
Curses::VERSION.</p>

<p>Tue Feb 21 18:21:25 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c : remove gc_clear_mark_on_sweep_slots() and use 	  rest_sweep()
instead of it, because some dead objects might be 	  marked in next the
mark phase by false pointers. 	  [ruby-core:42672]</p>

<p>Tue Feb 21 16:08:17 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (rb_hash_proc): get wrapped pointer properly.  [Bug #6048]</p>

<p>Tue Feb 21 14:41:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* template/ruby.pc.in: added rubylibprefix, <code>rubylib,vendor,site</code>dir 	 
and <code>ruby,vendor,site</code>archdir.  [ruby-core:42766][Feature #6052]</p>

<p>Tue Feb 21 09:13:25 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* proc.c (method_hash, proc_hash): Fix <code>Unbound</code>Method#hash 	  [Bug
#6048]. Isolate hash computation for proc</p>

<p>* internal.h: Declaration for above</p>

<p>* vm_method.c (rb_method_definition_hash): Computation for 	  hash part of
a method definition</p>

<p>* method.h: Declaration for above</p>

<p>* test/ruby/test_method.rb: Test for above</p>

<p>Tue Feb 21 02:56:15 2012  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* enumerator.c (enumerator_rewind): update the documentation. 	  fixed:
#6053</p>

<p>Mon Feb 20 23:38:35 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* enc/depend: ignore mktable.c because it&#39;s not encoding library. 	 
[ruby-core:42760] [Bug #6049]</p>

<p>Mon Feb 20 21:40:53 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/extconf.rb: fold too long lines.</p>

<p>Mon Feb 20 21:16:48 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* lib/fileutils.rb: revert a line modified accidentally at r34669. 	  This
fixes mingw test errors in TestDir_M17N. 	  [ruby-core:42728] [Feature
#4970]</p>

<p>Mon Feb 20 21:09:27 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/curses.c (Init_curses): define Curses::VERSION.</p>

<p>Mon Feb 20 21:08:00 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/curses/extconf.rb: restore $libs and $defs for each 	 
header/library choice.</p>

<p>Mon Feb 20 19:57:26 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: weaken header/library consistency check if db is 	 
“ndbm”.  It seems several (possibly historical) distributions 	  provide
libndbm.  However the content of libndbm vary: Berkeley DB, 	  GDBM or even
4.3BSD NDBM.  (Mandriva, Tru64 UNIX, OpenSuSE, 	  SCO OpenServer, …) 	 
“ndbm” is not searched automatically now (dblib doesn&#39;t contain it) 	 
but configure –with-dbm-type=ndbm choose libndbm and ndbm.h.</p>

<p>Mon Feb 20 19:15:57 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: refine variable names.</p>

<p>Mon Feb 20 15:50:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: check if -fstack-protector is really available.</p>

<p>Sun Feb 19 23:43:38 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: show header and library found.</p>

<p>Sun Feb 19 23:01:01 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/dbm.c (Init_dbm): refine DBM::VERSION definition.</p>

<p>* ext/dbm/extconf.rb: provide RUBYDBM_GDBM_HEADER macro.</p>

<p>Sun Feb 19 17:07:27 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/dbm/test_dbm.rb (test_dbmfile_suffix): check pag and dir is 	 
empty for 4.3BSD ndbm.</p>

<p>Sun Feb 19 03:00:30 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/dbm/test_dbm.rb (test_dbmfile_suffix): check magic numbers.</p>

<p>Sun Feb 19 01:05:41 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: detect GDBM&#39;s ndbm.h by testing dbm_clearerr is
	  an empty macro.</p>

<p>Sun Feb 19 00:25:55 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: don&#39;t choose &#39;dbm&#39; if <em>GDB_H</em> is
defined which 	  is available since GDBM 1.9 because &#39;gdbm_compat&#39;
is appropriate 	  choice since GDBM 1.8.1.</p>

<p>Sat Feb 18 23:27:00 2012  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* random.c: remove a duplicated comment.</p>

<p>Sat Feb 18 18:43:13 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb (dblib): prefer recent GDBM over older GDBM. 	 
(have_declared_libvar): new function to check a declared variable 	  exists
in a library. 	  (have_undeclared_libvar): renamed from renamed from
have_libvar. 	  (headers.db_check2): check that GDBM version variable if
GDBM header 	  is chosen.</p>

<p>* ext/dbm/dbm.c (Init_dbm): use HAVE_DECLARED_LIBVAR_GDBM_VERSION and 	 
HAVE_UNDECLARED_LIBVAR_GDBM_VERSION macro.</p>

<p>Sat Feb 18 13:53:01 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/dbm/test_dbm.rb (test_dbmfile_suffix): DBM::VERSION should 	  be
Berkeley DB if foo.db is created by DBM.open.</p>

<p>Sat Feb 18 13:40:37 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/dbm/test_dbm.rb (test_dbmfile_suffix): test dbm file suffix.</p>

<p>Sat Feb 18 12:50:59 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/dbm.c (DBM::VERSION): define it by detecting <em>GDBM_H</em> or
	  _DBM_IOERR.</p>

<p>Sat Feb 18 07:52:45 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/enc-unicode.rb: don&#39;t use 1.9 feature on tools.</p>

<p>Sat Feb 18 02:48:39 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/fileutils.rb: refactored FileUtil methods to use the 	 
`define_command` API.  Patch from 7rans &lt;transfire@gmail.com&gt; 	*
test/fileutils/test_dryrun.rb: corresponding test refactoring 	*
test/fileutils/test_nowrite.rb: ditto 	* test/fileutils/test_verbose.rb:
ditto</p>

<p>Fri Feb 17 21:39:36 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: remove dbm.</p>

<p>Fri Feb 17 21:18:39 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: refine header/library mismatch detection. 	  check
only for ndbm.h except libc.  check <em>GDBM_H</em> for gdbm. 	  check
_DBM_IOERR for the original ndbm.</p>

<p>Fri Feb 17 20:30:44 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: don&#39;t check libdbm.  It is not a ndbm 	 
implementation.  (libdbm in Version 7 Unix is database library 	  for
single database per process.)</p>

<p>Fri Feb 17 15:38:53 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Merge Onigmo-5.13.1. [ruby-dev:45057] [Feature #5820] 	  <a
href="https://github.com/k-takata/Onigmo">github.com/k-takata/Onigmo</a> 	 
cp reg<code>comp,enc,error,exec,parse,syntax</code>.c reg<code>enc,int,parse</code>.h 	  cp
oniguruma.h 	  cp tool/enc-unicode.rb 	  cp -r enc/</p>

<p>Fri Feb 17 15:20:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enum.c (enum_each_slice): arrays to be yielded can be newly 	  created
in the block.</p>

<p>* enum.c: move work variables to objects not to let called blocks 	 
access stack area out of scope.  [Bug #5801]</p>

<p>Fri Feb 17 12:35:55 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: remove borders from the commit message which is used 	 
when the commit doesn&#39;t change ChangeLog.</p>

<p>Fri Feb 17 11:50:11 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (btest, btest-ruby, test-sample test-knownbugs) 	  (test-all,
test-ruby): depend on prog.</p>

<p>Fri Feb 17 09:56:22 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (create_header): log the content of header.</p>

<p>Fri Feb 17 09:44:55 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/transcode-tblgen.rb (import_ucm): don&#39;t use h because the 	 
script should work with ruby 1.8.</p>

<p>* tool/enc-unicode.rb: ditto.</p>

<p>Fri Feb 17 07:33:29 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enum.c (id_lshift): use constant ID.</p>

<p>Fri Feb 17 07:30:53 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: refactored to split too long conditions.</p>

<p>Fri Feb 17 00:23:25 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/dbm/test_dbm.rb: fix skip condition for libgdbm 1.8.0 or prior. 	 
reported by Bohuslav Kabrda. 	  [ruby-core:42685] [ruby-trunk - Bug #6036]</p>

<p>Fri Feb 17 00:04:21 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: check <em>DB_H</em> macro unavailable except 	 
Berkeley DB library.</p>

<p>Thu Feb 16 05:41:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* insns.def (splatarray): make new array if flag is set.</p>

<p>* compile.c (iseq_compile_each): make new array with 	  splat.
[ruby-core:21901][Feature #1125]</p>

<p>Thu Feb 16 00:14:04 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* lib/abbrev.rb (Array#abbrev): add missing &#39;“&#39; in documentation.</p>

<p>Wed Feb 15 22:20:19 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* cont.c (rb_fiber_reset_root_local_storage): add a new function to 	 
restore rb_thread_t::local_storage.</p>

<p>* cont.c (rb_obj_is_fiber): add a new function to tell finalizer to 	 
prevent fibers from destroy.</p>

<p>* gc.c (rb_objspace_call_finalizer): don&#39;t sweep fibers at finalizing
	  objspace.</p>

<p>* internal.h (rb_fiber_reset_root_local_storage, rb_obj_is_fiber): 	  add
prototypes.</p>

<p>* vm.c (ruby_vm_destruct): reset main thread&#39;s local_storage before 	 
free main thread. rb_thread_t::local_storage is replaced by fiber&#39;s 	 
local storage when forked from fiber, and it should be already freed 	 
when the fiber was destroyed. [ruby-core:41456] [Bug #5700]</p>

<p>* test/ruby/test_fiber.rb (test_fork_from_fiber): add test for fork 	 
from fiber.</p>

<p>Wed Feb 15 19:57:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/fiddle/closure.c (callback): deal with unsigned integers. 	 
[ruby-core:42458][Bug #5991][Bug #6022]</p>

<p>* ext/fiddle/conversions.c (value_to_generic, generic_to_value): 	  ditto.</p>

<p>* ext/fiddle/closure.c (callback): same as r34506.</p>

<p>Wed Feb 15 17:41:31 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (io_strsetbuf): call rb_str_modify to make str independent 	 
before calling rb_str_set_len for r34580.</p>

<p>Wed Feb 15 12:30:10 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (Init_zlib):  Added Zlib::TEXT and note that 	 
Zlib::ASCII is deprecated in zlib 1.2.3 and newer.</p>

<p>Wed Feb 15 12:24:40 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c:  Move constant descriptions to constants.  Remove 	 
extra comment block at the top of Init_zlib().</p>

<p>Wed Feb 15 12:30:46 2012  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/ostruct.rb: Create getters and setters after dup. 	  [Bug #6028]
[rubyspecs:0380bcc]</p>

<p>Wed Feb 15 10:59:52 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (HEAP_BITMAP_LIMIT): HEAP_BITMAP_LIMIT is computed on the 	  basis
of HEAP_SIZE because it must covers a whole heap block. 	  [ruby-trunk -
Bug #6006]</p>

<p>Wed Feb 15 09:27:45 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (Init_zlib):  Added Zlib::FIXED and Zlib::RLE 	 
strategies. 	* NEWS:  Add note about the new Zlib constants.</p>

<p>Wed Feb 15 09:11:36 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c:  Improve documentation.  [ruby-trunk - Bug #5948]</p>

<p>Wed Feb 15 07:28:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* encoding.c (Init_Encoding):  Add IO example of internal and external 	 
encoding.  Fixed a typo in the force_encoding example.  [#5949]</p>

<p>Wed Feb 15 06:58:21 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* encoding.c (Init_Encoding):  Add Encoding documentation. 	  [ruby-trunk
- Bug #5949] 	* encoding.c (rb_set_default_external):  Fix typo in
documentation.</p>

<p>Tue Feb 14 20:22:11 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (CEILDIV): rename to a appropriate name.</p>

<p>Tue Feb 14 18:07:20 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (assign_heap_slot): SEGV happens cause on 64-bit platform 	 
sometime there should be `objs-=2` instead of `objs–`. 	  [Bug #6006] 	 
patched by Sokolov Yura. <a
href="https://github.com/ruby/ruby/pull/92">github.com/ruby/ruby/pull/92</a></p>

<p>Tue Feb 14 16:00:30 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_setstrbuf): cut down the buffer if longer.</p>

<p>Tue Feb 14 15:06:37 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit/assertions.rb (build_message): skip escaped 	  question
marks.</p>

<p>Tue Feb 14 12:10:04 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (autoload_const_set, autoload_require): fix 	  signatures.</p>

<p>Tue Feb 14 05:23:40 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* process.c (proc_wait):  Change typo “SystemError” to 	 
“SystemCallError”.  [ruby-trunk - Bug #5962] 	* process.c (proc_wait2): 
ditto</p>

<p>Tue Feb 14 05:18:24 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enumerator.c:  Document use of Enumerator.new for creating a lazy 	 
enumeration for filtering/chaining.  [ruby-trunk - Feature #707]</p>

<p>Mon Feb 13 23:01:50 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* vm_method.c (rb_method_boundp): 	  obj.respond_to?(:a_protected_method)
should return false because 	  calling a protected method may cause
NoMethodError if called 	  from outside the class inheritance tree. 
Kernel#respond_to? is 	  mostly used to test if it is safe to call a
method, so the false 	  positive should be avoided. [ruby-dev:40461]
[ruby-dev:41739] 	  [ruby-dev:41837]</p>

<p>Mon Feb 13 21:52:06 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (HEAP_OBJ_LIMIT, HEAP_BITMAP_LIMIT): HEAP_OBJ_LIMIT used 	 
`sizeof(struct heaps_slot)` while heap is currently allocated 	  with
`struct heaps_header`. 	  HEAP_BITMAP_LIMIT were calculated from 	 
`HEAP_OBJ_LIMIT/sizeof(uintptr_t)` - one Byte for each object, 	  not one
Bit. [Bug #6006] 	  patched by Sokolov Yura. <a
href="https://github.com/ruby/ruby/pull/92">github.com/ruby/ruby/pull/92</a></p>

<p>Mon Feb 13 18:30:32 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (io_setstrbuf): defer resizing buffer string until data is 	  read
actually.</p>

<p>Mon Feb 13 10:24:39 2012  Loren Segal  &lt;lsegal@soen.ca&gt;</p>

<p>* io.c (Init_IO): use directive hack to make ARGF documentable 	  in other
tools.  [ruby-core:42515][Bug #6007]</p>

<p>Sun Feb 12 20:43:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_event_hook_func_t): add argument names.</p>

<p>Sun Feb 12 16:30:23 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* tool/merger.rb (#default_merge_branch): Add support for 	  Subversion
1.7 which adopted a whole new working directory 	  structure.</p>

<p>Sun Feb 12 15:14:41 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* benchmark/driver.rb: suppress unused/shadowing variable warnings.</p>

<p>Sun Feb 12 03:14:40 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* vm_eval.c (check_funcall):  Call respond_to? with matching arity for 	 
legacy single-argument implementations.  [ruby-trunk - Bug #6000]</p>

<p>Sat Feb 11 12:04:05 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (defined_expr): guard the whole expression. 	  [<a
href="Bug#5786">ruby-dev:45021]</a></p>

<p>Sat Feb 11 08:34:42 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (rb_inflate_add_dictionary):  Added 	 
Zlib::Inflate#add_dictionary to allow users to pre-specify 	  for using
during #inflate.  [ruby-trunk - Feature #5937]</p>

<p>Sat Feb 11 08:23:02 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (do_inflate):  Inflate more data if buffered data 	 
exists.  Allows Zlib::Inflate#set_dictionary to work. 	  [ruby-trunk - Bug
#5929]</p>

<p>Sat Feb 11 06:00:48 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* dir.c (fnmatch): The * needs to be escaped to avoid formatting in 	 
fnmatch comment. 	  patched by @dalton. <a
href="https://github.com/ruby/ruby/pull/91">github.com/ruby/ruby/pull/91</a></p>

<p>Fri Feb 10 03:41:31 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c: removed external encoding setter, allow parser 	  to
be reused. 	* ext/psych/lib/psych/parser.rb: added external encoding
setter. 	* test/psych/test_parser.rb: test parser reuse</p>

<p>Fri Feb 10 01:30:41 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dl/dl.h (ALIGN_OF): use offsetof().</p>

<p>* ext/dl/dl.h (DLALIGN): round up at once and get rid of overflow.</p>

<p>Fri Feb 10 00:47:07 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (assert_no_memory_leak): new assertion to 	  check
memory leak by invoking child ruby process and watch its 	  memory size.</p>

<p>Thu Feb  9 23:41:44 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/pathname/test_pathname.rb (test_binread): add assertion to 	  check
encoding.</p>

<p>Thu Feb  9 16:48:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dl/dl.c (Init_dl): fix mangled document.</p>

<p>Thu Feb  9 16:10:34 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/memory_status.rb (Memory::Win32): 64bit support.</p>

<p>Thu Feb  9 16:08:55 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/dl/lib/value.rb (DL::ValueUtil.<code>unsigned_value,signed_value</code>): 	 
currently pack/unpack does not accept “q!” and “Q!”.</p>

<p>Thu Feb  9 16:01:29 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/fiddle/conversions.c (value_to_generic): src is not guaranteed as 	 
a Bignum if the type is LONG_LONG.  it may be a Fixnum if the value 	  is
small.</p>

<p>Thu Feb  9 11:32:36 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/dl/lib/types.rb: Win64 support.</p>

<p>Thu Feb  9 04:12:29 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/pathname/test_pathname.rb: not read but binread. 	  patched by
Benoit Daloze, [ruby-core:42440] [Bug #5984]</p>

<p>Wed Feb  8 22:29:59 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_modify_expand): fix memory leak.</p>

<p>Wed Feb  8 14:06:59 2012  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Add SSL constants and allow to unset SSL 	 
option to prevent BEAST attack. See [Bug #5353].</p>

<p>In OpenSSL, OP_DONT_INSERT_EMPTY_FRAGMENTS is used to prevent 	 
TLS-CBC-IV vulnerability described at 	  <a
href="http://www.openssl.org/~bodo/tls-cbc.txt">www.openssl.org/~bodo/tls-cbc.txt</a>
	  It&#39;s known issue of TLSv1/SSLv3 but it attracts lots of attention 	 
these days as BEAST attack. (CVE-2011-3389)</p>

<p>Until now ossl sets OP_ALL at SSLContext allocation and call 	 
SSL_CTX_set_options at connection.  SSL_CTX_set_options updates the 	 
value by using |= so bits set by OP_ALL cannot be unset afterwards.</p>

<p>This commit changes to call SSL_CTX_set_options only 1 time for each 	 
SSLContext. It sets the specified value if SSLContext#options= are 	 
called and sets OP_ALL if not.</p>

<p>To help users to unset bits in OP_ALL, this commit also adds several 	 
constant to SSL such as 	  OpenSSL::SSL::OP_DONT_INSERT_EMPTY_FRAGMENTS. 
These constants were 	  not exposed in Ruby because there&#39;s no way to
unset bits in OP_ALL 	  before.</p>

<p>Following is an example to enable 0/n split for BEAST prevention.</p>

<p>ctx.options = OP_ALL &amp; ~OP_DONT_INSERT_EMPTY_FRAGMENTS</p>

<p>* test/openssl/test_ssl.rb: Test above option exists.</p>

<p>Wed Feb 8 13:12:02 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_x509name.c: Use the numerical representation of 	 
unrecognized OIDs instead of the sn “UNDEF”.</p>

<p>* test/openssl/test_x509name.rb: Add tests for the fixed behavior.</p>

<p>Patch provided by Paul Kehrer, thank you! 	  [ruby-core:41769] [Feature
#5787]</p>

<p>Wed Feb  8 09:49:58 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: don&#39;t abort, update first.</p>

<p>Wed Feb 8 09:47:33 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_asn1.c: Call INT2NUM only once for GeneralString. 	 
Thanks to Mantas Mikulenas for noticing and providing a patch! 	 
[ruby-core:42358] [Bug #5972]</p>

<p>Wed Feb 8 09:19:00 2012  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_cipher.c: Add warning about key as IV.</p>

<p>Tue Feb  7 20:08:12 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* error.c (exc_inspect): Fix typo. patch from Trent Ogren 	  via <a
href="https://github.com/ruby/ruby/pull/90">github.com/ruby/ruby/pull/90</a></p>

<p>Tue Feb  7 19:37:35 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c: refactor packed entries using structs.</p>

<p>Tue Feb  7 14:52:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c (st_update): table can be unpacked in the callback.</p>

<p>* st.c (st_foreach): should not yield same pair when checking 	  after
unpacking.</p>

<p>Mon Feb  6 21:55:13 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: abort if the working directory is dirty.</p>

<p>* tool/merger.rb: update the working directory after commit.</p>

<p>Mon Feb  6 00:16:27 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* encoding.c (rb_enc_compatible): return ASCII-8BIT even if 2nd string 	 
is ascii only string. [ruby-core:42354] [Bug #5968]</p>

<p>Fri Feb  3 07:16:47 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/webrick.rb:  Moved proxy rewriting to WEBrick::HTTPProxy. 	*
lib/webrick/httpproxy.rb:  Add examples of creating a proxy server 	  and
response rewriting using HTTPProxy.</p>

<p>Fri Feb  3 06:53:22 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl_x509store.c:  Add class documentation for 	 
OpenSSL::X509::Store</p>

<p>Thu Feb  2 22:28:13 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/net/http/test_https_proxy.rb 	 
(HTTPSProxyTest#test_https_proxy_authentication): 	  add workaround to
avoid to hang up without openssl. 	  see [ruby-dev:45021][Bug #5786]</p>

<p>* test/resolv/test_dns.rb (TestResolvDNS#test_query_ipv4_address): 	 
ditto.</p>

<p>Thu Feb  2 21:48:18 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/parsers/baseparser.rb: use meaningful names.</p>

<p>Thu Feb  2 21:38:52 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/parsers/baseparser.rb, test/rexml/test_namespace.rb: 	  fix
the default xml namespace URI validation. 	  [ruby-dev:45169] [Bug #5956] 	
Reported by Miho Hiramatsu. Thanks!!!</p>

<p>Thu Feb  2 17:51:02 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (argf_next_argv): reset ARGF.next_p on ARGV.replace. 	  r34409
breaks replacing ARGV. 	  [ruby-dev:45160] [Bug #5952]</p>

<p>Thu Feb  2 16:21:01 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/net/http/test_http.rb (TestNetHTTPKeepAlive#*): remove debug 	 
output.</p>

<p>Thu Feb  2 01:24:34 2012  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* parse.y (debug_lines, coverage): set file path encoding for coverage 	 
result.  [ruby-dev:44950]</p>

<p>Wed Feb  1 14:38:31 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/tempfile.rb (Tempfile#unlink, Tempfile::Remover#call): Just 	  call
File.unlink and ignore ENOENT because existence check 	  before unlinking
does not help in terms of race condition.</p>

<p>* lib/tempfile.rb (Tempfile#unlink, Tempfile::Remover#call): My 	  comment
about thread safeness is obsolete.</p>

<p>Wed Feb  1 09:50:10 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* doc/re.rdoc (Repetition): fix typo.  reported by Ori Avtalion 	  and
patched by Zachary Scott.  [Bug #5947]</p>

<p>Wed Feb  1 06:38:54 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (argf_close): skip stdin, which should be readable again. 	 
[ruby-dev:45160] [Bug #5952]</p>

<p>* io.c (argf_readlines): reinitialize after all read to be 	  readable
again.</p>

<p>Tue Jan 31 21:27:43 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* configure.in (HEAP_ALIGN_LOG): HEAP_ALIGN_LOG should be page 	  size in
OpenBSD. [ruby-core:42158][Bug #5901]</p>

<p>* gc.c : avoid to redefine.</p>

<p>Tue Jan 31 14:27:22 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/envutil.rb (EnvUtil.invoke_ruby): yield also child pid 	  in
block form.</p>

<p>Mon Jan 30 19:08:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (vm_call0): should pass block to enumerators.  patched 	  by
Kazuki Tsujimoto.  [ruby-dev:44961][Bug #5731]</p>

<p>* vm_eval.c (method_missing), vm_insnhelper.c (vm_call_method): 	  ditto. 
patched by satoshi shiba.</p>

<p>Mon Jan 30 12:31:05 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* file.c (append_fspath): need to set the encoding to result always.</p>

<p>Mon Jan 30 10:38:37 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/irb/test_completion.rb: skip if cannot load irb/completion 	 
(maybe readline does not exist).</p>

<p>Sun Jan 29 22:47:19 2012  Yutaka Kanemoto  &lt;kanemoto@ruby-lang.org&gt;</p>

<p>* tool/config.<code>guess,sub</code>: updated to automake-1.11.2.</p>

<p>Sun Jan 29 12:17:56 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (readline_attempted_completion_function): 	 
respect encodings.  [Bug #5941]</p>

<p>Sat Jan 28 09:33:33 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* win32/win32.c (rb_w32_read): fix an issue that $stdin.read doesn&#39;t 	
terminate by CTRL-C on Windows. 	  [ruby-dev:45149] [Bug #5812]</p>

<p>Sat Jan 28 08:18:11 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/ruby/test_thread.rb 	 
(TestThreadGroup#test_thread_timer_and_interrupt): skip exit status 	 
assertion because we cannot get signal status on Windows.</p>

<p>* win32/win32.c (CreateChild): create process group to receive the 	 
signal by GenerateConsoleCtrlEvent().</p>

<p>* win32/win32.c (kill): use CTRL_BREAK_EVENT instead of CTRL_C_EVENT 	  if
a process group is specified. CTRL_C_EVENT signal cannot be 	  generated
for process groups for the specification. 	  [ruby-dev:45149] [Bug #5812]</p>

<p>Sat Jan 28 07:46:03 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* thread_win32.c (rb_w32_wait_events_blocking): use 	 
ruby_thread_from_native() instead of GET_THREAD() because 	  GET_THREAD()
doesn&#39;t always return the current thread and 	 
WaitForMultipleObjects() at rb_w32_read() doesn&#39;t return by 	 
Thread#kill. This fixes TestQueue#test_thr_kill failure on 	  Windows.</p>

<p>* thread_win32.c (rb_w32_wait_events): use ruby_thread_from_native() 	 
instead of GET_THREAD() for consistency with the above change.</p>

<p>* thread_win32.c (rb_w32_sleep): ditto.</p>

<p>* thread_win32.c (rb_w32_Sleep): ditto. 	  [ruby-dev:45149] [Bug #5812]</p>

<p>Sat Jan 28 07:28:48 2012  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* test/zlib/test_zlib.rb (TestZlibGzipReader#test_reader_wrap): set 	 
binmode explicitly for fixing test error on Windows. This is consistent 	 
with r34243. 	  [ruby-dev:45149] [Bug #5812]</p>

<p>Sat Jan 28 05:53:34 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/irb/completion.rb (IRB::InputCompletor::CompletionProc): 	  ignore
non-string name modules.  [ruby-core:42244][Bug #5938]</p>

<p>Fri Jan 27 16:31:45 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (HEAP_ALIGN, HEAP_ALIGN_MASK): DRY, let compiler calculate 	  from
HEAP_ALIGN_LOG.</p>

<p>Thu Jan 26 11:03:37 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/matrix.rb:  Clean up extra whitespace in output documentation.</p>

<p>Thu Jan 26 03:24:02 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (io_getch): default delegating method 	  for
StringIO.  <a
href="https://github.com/nobu/io-console/issues/4">github.com/nobu/io-console/issues/4</a></p>

<p>* ext/stringio/stringio.c: moved some methods to hidden modules.</p>

<p>Wed Jan 25 13:27:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_file_s_basename): ignore non-ascii extension in 	  different
encoding, which cannot match.</p>

<p>* file.c (rmext): no extension to strip if empty string.</p>

<p>* file.c (rb_enc_path_next, rb_enc_path_skip_prefix) 	 
(rb_enc_path_last_separator, rb_enc_path_end) 	  (ruby_enc_find_basename,
ruby_enc_find_extname): encoding-aware 	  path handling functions.</p>

<p>* file.c (rb_home_dir, file_expand_path, rb_realpath_internal) 	 
(rb_file_s_basename, rb_file_dirname, rb_file_s_extname) 	  (rb_file_join):
should respect the encodings of arguments than 	  file system encoding. 
[ruby-dev:45145] [Bug #5919]</p>

<p>* dir.c (check_dirname, ruby_glob0): ditto.</p>

<p>* ext/pathname/pathname.c (path_sub_ext): ditto.</p>

<p>Tue Jan 24 14:20:42 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (rb_iter_break_value): new function to break a block with 	  the
value.  [ruby-dev:45132] [Feature #5895]</p>

<p>Tue Jan 24 12:58:41 2012  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* object.c (rb_Hash): add Kernel#Hash conversion method like 	  Array() or
Float().  a patch from Run Paint Run Run.  Fix #3131</p>

<p>Tue Jan 24 11:38:05 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/common.rb (URI.encode_www_form_component): initialize on 	 
requiring to support JRuby, which runs parallel multithreads. 	 
[ruby-core:42222] [Bug #5925]</p>

<p>* lib/uri/common.rb (URI.decode_www_form_component): initialize on</p>

<p>Mon Jan 23 20:33:11 2012  Jason Kay  &lt;geniture@me.com&gt;</p>

<p>* lib/net/http.rb (Net::HTTP#connect): Writing entire packet at 	  once to
avoid incomplete transmission.  Current code using 	  writeline was causing
sub-optimal conversing with a proxy due to 	  the connect tunnel request
headers being split over multiple 	  packets. The modification I made
allows the connect request to 	  be written as one packet, avoiding
problems and optimizing the 	  conversation.</p>

<p><a
href="https://github.com/ruby/ruby/pull/72">github.com/ruby/ruby/pull/72</a>
	  [Feature #5460]</p>

<p>Mon Jan 23 17:06:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/mailto.rb (URI::MailTo.build): follow Array#to_s change of 	 
Ruby 1.9; use Array#join. [Bug #5840]</p>

<p>Mon Jan 23 16:42:28 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (extract_binmode): raise an exception if binmode/textmode 	  is
specified with both vmode and opthash. 	  [ruby-core:42199] [Bug #5918]</p>

<p>Mon Jan 23 16:35:27 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_extract_modeenc): set ASCII-8BIT if binmode is specified 	 
with opthash. [ruby-core:42197] [Bug #5917]</p>

<p>Mon Jan 23 10:08:00 2012  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>* test/cgi/test_cgi_util.rb (test_cgi_escape_preserve_encoding): 	  add a
test for CGI::escape to preserve encoding.</p>

<p>* test/cgi/test_cgi_util.rb (test_cgi_unescape_preserve_encoding): 	  add
a test for CGI::unescape to preserve encoding.</p>

<p>Mon Jan 23 00:45:34 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* misc/rdoc-mode.el (rdoc-imenu-create-index): Add imenu support 	  to
rdoc-mode.</p>

<p>* misc/rdoc-mode.el (rdoc-mode): Fix regexp patterns containing 	  “s ”
where CR/LF is not supposed to match.</p>

<p>Sun Jan 22 15:41:26 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_intern3): split to registration check and new 	 
registration.</p>

<p>* parse.y (rb_intern_str): make interned string shared with the 	  given
string.</p>

<p>* parse.y (rb_intern3, rb_intern_str): check the coderange first.</p>

<p>Sat Jan 21 22:21:07 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (FIXNUM_P): simple flag should be int.</p>

<p>Sat Jan 21 21:51:19 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* encoding.c (rb_enc_compatible): fix segv on symbols. 	 
[ruby-core:42204] [Bug #5921]</p>

<p>Sat Jan 21 11:43:45 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (dir_chdir, check_dirname): get rid of optimization-out.</p>

<p>Fri Jan 20 20:47:37 2012  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>* lib/cgi/util.rb (CGI.escape): support a string with invalid byte 	 
sequence.  [Bug #5913]</p>

<p>* test/cgi/test_cgi_util.rb 	 
(test_cgi_escape_with_invalid_byte_sequence): test for the above 	  change.</p>

<p>Fri Jan 20 17:37:37 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm.c (vm_exec): remove workaround for LLVM because r34278 fixes it.</p>

<p>* vm_insnhelper.c (vm_call_cfunc): ditto.</p>

<p>Fri Jan 20 14:31:43 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP#transport_request): retry a idempotent 	 
request automatically. [ruby-dev:45030] [Bug #5790] 	  [ruby-core:41821]
[Bug #5813]</p>

<p>* lib/net/http.rb (Net::HTTP#keep_alive_timeout=): added to specify 	  the
second to reconnect the TCP connection on Keep-Alive. 	  The default value
is 2 second because current servers uses 2 sec. 	  <a
href="http://ftp-admin.blogspot.com/2009/09/keepalivetimeout2.html">ftp-admin.blogspot.com/2009/09/keepalivetimeout2.html</a></p>

<p>* lib/net/http.rb (Net::HTTP#begin_transport): reconnect TCP 	  connection
on keep-alive timeout.</p>

<p>Thu Jan 19 07:53:09 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_strptime.c: moved detector of leftover.</p>

<p>Thu Jan 19 07:10:47 2012  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_parse.c: [ruby-core:42173].</p>

<p>Wed Jan 18 18:11:02 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* misc/rdoc-mode.el (rdoc-mode): Add provide so that requiring 	  this
library succeeds.</p>

<p>Wed Jan 18 18:06:45 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/curses/curses.c (cWindow, cMouseEvent): made typed data.</p>

<p>Wed Jan 18 12:49:15 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: Added support for loading 	 
subclasses of String with ivars 	*
ext/psych/lib/psych/visitors/yaml_tree.rb: Added support for dumping 	 
subclasses of String with ivars 	* test/psych/test_string.rb: corresponding
tests</p>

<p>Wed Jan 18 10:39:47 2012  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: Added ability to load array 	 
subclasses with ivars. 	* ext/psych/lib/psych/visitors/yaml_tree.rb: Added
ability to dump 	  array subclasses with ivars. 	*
test/psych/test_array.rb: corresponding tests</p>

<p>Tue Jan 17 17:18:41 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (SPT_TYPE): enable as SPT_REUSEARGV on Darwin.</p>

<p>* missing/setproctitle.c (ruby_init_setproctitle): changed prefix.</p>

<p>Tue Jan 17 12:32:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (aligned_malloc, aligned_free): covered missing defined 	 
operators and fixes for cygwin.</p>

<p>Tue Jan 17 10:54:46 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c (do_hash): it&#39;s the time to remove cast to unsigned int.</p>

<p>Tue Jan 17 07:30:12 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* st.c (unpack_entries): Fix r34310: on unpacking, the position of 	  a
hash must be do_hash-ed value.</p>

<p>* st.c (add_packed_direct): ditto.</p>

<p>Mon Jan 16 16:41:53 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb (Regexp): fix incorrect options when casting to 	  a
Regexp, and suppress encoding option warnings. 	  <a
href="https://github.com/ruby/ruby/pull/82">github.com/ruby/ruby/pull/82</a></p>

<p>Mon Jan 16 11:22:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_chsize): no need to get the current file size.</p>

<p>Mon Jan 16 00:41:33 2012  Sokolov Yura  &lt;funny.falcon@gmail.com&gt;</p>

<p>* st.c: st use function instead of macro.  In my current 	  environment
(Ubuntu 11.04 32bit gcc-4.5.2) it gives 4% 	  performance improvement.</p>

<p><a
href="https://github.com/ruby/ruby/pull/77">github.com/ruby/ruby/pull/77</a></p>

<p>Sun Jan 15 14:09:48 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* object.c (rb_inspect): raise the result is not compatible with 	  the
default external encoding. [ruby-core:42095] [Bug #5848] 	  If the default
external encoding is ASCII compatible, the encoding of 	  inspected result
must be compatible with it. 	  If the default external encoding is ASCII
incompatible, 	  the result must be ASCII only.</p>

<p>Sun Jan 15 13:21:50 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json/parser/parser.rl (json_string_unescape): workaround fix 	  for
over optimization of GCC 4.7. [ruby-core:42085] [Bug #5888] 	  <a
href="http://gcc.gnu.org/bugzilla/show_bug.cgi?id=51862">gcc.gnu.org/bugzilla/show_bug.cgi?id=51862</a></p>

<p>Sat Jan 14 22:24:09 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dl/callback/mkcallback.rb (gencallback): suppress unused 	 
variables.</p>

<p>Sat Jan 14 21:56:43 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (iseq_data_to_ary): check line info table boundary.  line 	 
number 0 means no line number info is needed.  [ruby-dev:45130] 	  [Bug
#5894]</p>

<p>Sat Jan 14 18:24:13 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* error.c (exc_equal): clear rb_thread_t::errinfo when ignore 	  an
exception under rb_protect(). [ruby-core:41979] [Bug #5865]</p>

<p>Sat Jan 14 12:02:55 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (rb_enc_vsprintf): relaxed the restriction.  since the 	 
implementation deeply depends on plain char, so wchar_t based 	  encodings
are not supported.</p>

<p>Sat Jan 14 12:00:20 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (exc_equal): ignore exceptions during implicit 	  conversion. 
[ruby-core:41979] [Bug #5865]</p>

<p>Sat Jan 14 05:58:54 2012  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* io.c (rb_io_s_read):  Fix formatting of open_args comment.  Reported 	 
by Adam Prescott.</p>

<p>Fri Jan 13 18:41:19 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (rb_enc_vsprintf): can be used for ASCII compatible 	 
encodings only.</p>

<p>Fri Jan 13 18:29:06 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_mutex_unlock_th): simplified.</p>

<p>* thread.c (rb_barrier_waiting): fix potential overflows.</p>

<p>Fri Jan 13 17:23:38 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (load_unlock): update loading table at once.</p>

<p>Fri Jan 13 16:44:45 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (exc_equal): try implicit conversion for delegator. 	 
[ruby-core:41979] [Bug #5865]</p>

<p>Fri Jan 13 03:46:53 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/shellwords.rb (Shellwords#shellescape): shellescape() now 	 
stringifies the given object using to_s.</p>

<p>* lib/shellwords.rb (Shellwords#shelljoin): shelljoin() accepts 	 
non-string objects in the given array, each of which is 	  stringified
using to_s.</p>

<p>* lib/shellwords.rb: Fix rdoc markups.</p>

<p>Fri Jan 13 03:38:36 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/shellwords.rb (Shellwords#shellsplit): Fix a bug where 	 
consecutive backslashes in double quotes are all removed except 	  the one
at the tail.</p>

<p>Fri Jan 13 03:28:00 2012  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* ext/socket/extconf.rb (if ipv6): only define _WIN32_WINNT if was not 	 
previously defined. This solve warnings with multiple defines in 	  command
line with GCC 4.6.1</p>

<p>Thu Jan 12 18:44:31 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb: fix r33904 and revert r33905.  initialize global 	 
variables with init_mkmf before initializing constants. 	  [ruby-dev:45124]
[Bug #5879]</p>

<p>Thu Jan 12 13:51:00 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* cont.c (cont_restore_0): prevent optimizing out `sp&#39;. sp is used for
	  reserving a memory space with ALLOCA_N for restoring machine stack 	 
stored in cont-&gt;machine_stack, but clang optimized out it (and 	  maybe
#5851 is also caused by this). 	  This affected
TestContinuation#test_check_localvars.</p>

<p>* cont.c (cont_restore_1): revert workaround introduced in r32201.</p>

<p>Thu Jan 12 02:14:43 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* object.c: Added examples for Object#is_a? and 	  Object#instance_of?
patched from Manoj Kumar. 	  [Bug #5880] [ruby-core:42057]</p>

<p>Thu Jan 12 00:57:48 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* lib/mkmf.rb: verbose-mode can use by RM, RMDIRS, etc. 	  (e.g. make V=1
realclean)</p>

<p>Wed Jan 11 23:40:21 2012  Naohisa Goto 
&lt;ngoto@gen-info.osaka-u.ac.jp&gt;</p>

<p>* string.c (rb_str_concat): set array element after definition 	  to fix
compile error with Fujitsu C Compiler 5.6 on Solaris 10 	  on Sparc.  [Bug
#5878] [ruby-dev:45123]</p>

<p>Wed Jan 11 22:52:51 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* gc.c (ruby_mimmalloc): don&#39;t set allocated size to header. 	 
ruby_mimmalloc() doesn&#39;t increment allocated_size/allocations and 	 
decrement them in ruby_xfree() cause inconsistency.</p>

<p>* gc.c (ruby_xfree): don&#39;t decrement allocated_size/allocations if 	 
allocated size record is 0.</p>

<p>Wed Jan 11 22:36:43 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/readline/test_readline.rb (test_completion_proc_empty_result): 	 
ensure clearance of Readline&#39;s line_buffer after the test.</p>

<p>Tue Jan 10 21:57:38 2012  Hiroshi Shirosaki &lt;h.shirosaki@gmail.com&gt;</p>

<p>* ext/dbm/dbm.c (Init_dbm): fix a build error on mswin32. 	  use `extern
__declspec(dllimport)` for dll link with VC. 	  [ruby-core:41996] [Bug
#5869]</p>

<p>Tue Jan 10 15:31:55 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm.c (vm_exec): refix r34162; suppress warning and add description.</p>

<p>Tue Jan 10 15:13:58 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (readline_attempted_completion_function): 	  use
rb_memerror().</p>

<p>Tue Jan 10 12:49:42 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c: in fact, i686-linux doesn&#39;t need to define _XOPEN_SOURCE 600.</p>

<p>Tue Jan 10 12:44:11 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c (ruby_mimmalloc): defined for objects need not rb_objspace, 	  but
should return pointer suitable for ruby_xfree; 	  main vm and main thread.
	  patched by Sokolov Yura. <a
href="https://github.com/ruby/ruby/pull/79">github.com/ruby/ruby/pull/79</a></p>

<p>* internal.h: ditto.</p>

<p>* vm.c (Init_BareVM): use ruby_mimmalloc.</p>

<p>* ext/dl/cfunc.c: #include &lt;ruby/util.h&gt;.</p>

<p>* ext/syslog/syslog.c: use xfree because it is allocated by 	 
ruby_strdup.</p>

<p>Tue Jan 10 12:13:56 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* ext/readline/readline.c (readline_attempted_completion_function): 	  fix
compile error.</p>

<p>Tue Jan 10 10:41:11 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (readline_attempted_completion_function): 	 
empty completion result does not mean memory error.</p>

<p>Tue Jan 10 02:19:22 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (test_autoclose_true_closed_by_finalizer, 	 
test_autoclose_true_closed_by_finalizer): skip if IO objects are 	  not
recycled yet. [ruby-dev:45098] [Bug #5850]</p>

<p>Tue Jan 10 00:41:28 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* lib/tempfile.rb (Tempfile#_close): clear @tempfile and @<a
href="1">data</a> even 	  when exception is raised at @tempfile.close.
[ruby-dev:45113]</p>

<p>* lib/tempfile.rb (Tempfile#unlink): fix a typo.</p>

<p>Tue Jan 10 00:32:17 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* gc.c (run_finalizer): clear rb_thread_t::errinfo when ignore 	  an
exception under rb_protect(). [ruby-dev:45113]</p>

<p>Mon Jan  9 23:37:43 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* ext/readline/readline.c (readline_attempted_completion_function): 	  fix
typos.</p>

<p>Mon Jan  9 20:55:34 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c : don&#39;t embed struct heaps_slot to a heap block because it 	 
can causes copy-on-write of memory page on heap block when its 	  free_next
is rewritten.</p>

<p>Mon Jan  9 20:26:33 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/pathname/pathname.c (path_entries): add document suggested by 	  the
thread [ruby-core:41959] [Bug #5859].</p>

<p>Mon Jan  9 20:14:13 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/lib/socket.rb (family_addrinfo): don&#39;t require protocol 	
equality.  For example, protocol 0 and IPPROTO_TCP is not problem 	  for
TCP.</p>

<p>Mon Jan  9 20:08:52 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/lib/socket.rb (family_addrinfo): return the given 	  addrinfo
object. 	  Patch by Ippei Obayashi.  [ruby-dev:45095] [Bug #5845]</p>

<p>Mon Jan  9 19:40:20 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/zlib/test_zlib.rb (TestZlibGzipWriter#test_writer_wrap): set 	 
binmode explicitly.</p>

<p>Mon Jan  9 14:42:41 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: free_slots is changed Singly linked list. clear 	  free_slots
before sweep.</p>

<p>Mon Jan  9 07:46:17 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c: i686-linux needs to define _XOPEN_SOURCE 600 for posix_memalign.</p>

<p>Mon Jan  9 04:24:59 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c (rb_objspace_free): global_List is allocated with xmalloc. 	 
patched by Sokolov Yura.  <a
href="https://github.com/ruby/ruby/pull/78">github.com/ruby/ruby/pull/78</a></p>

<p>* dln_find.c: remove useless replacement of free.</p>

<p>* ext/readline/readline.c (readline_attempted_completion_function): 	 
strings for readline must allocated with malloc.</p>

<p>* process.c (run_exec_dup2): use free; see also r20950.</p>

<p>* re.c (onig_new_with_source): use malloc for oniguruma.</p>

<p>* vm.c (ruby_vm_destruct): use free for VMs.</p>

<p>* vm.c (thread_free): use free for threads.</p>

<p>Mon Jan  9 04:24:59 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* dln_find.c: remove useless replacement of free.</p>

<p>* ext/readline/readline.c (filename_completion_proc_call): 	  matches
should use xfree.</p>

<p>* ext/readline/readline.c (username_completion_proc_call): ditto.</p>

<p>Mon Jan  9 01:12:35 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* numeric.c (rb_enc_uint_char): raise RangeError when added codepoint 	 
is invalid. [Feature #5855] [Bug #5863] [Bug #5864]</p>

<p>* string.c (rb_str_concat): ditto.</p>

<p>* string.c (rb_str_concat): set encoding as ASCII-8BIT when the string 	 
is US-ASCII and the argument is an integer greater than 127.</p>

<p>* regenc.c (onigenc_mb2_code_to_mbclen): rearrange error code.</p>

<p>* enc/euc_jp.c (code_to_mbclen): ditto.</p>

<p>* enc/shift_jis.c (code_to_mbclen): ditto.</p>

<p>Sun Jan  8 20:31:45 2012  Narihiro Nakamura  &lt;narihiro@netlab.jp&gt;</p>

<p>* gc.c : consider header bytes which are used by malloc.</p>

<p>Sun Jan  8 11:54:43 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (aligned_free): support MinGW. Patch by Hiroshi Shirosaki.</p>

<p>Sun Jan  8 11:43:05 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (slot_sweep): add a assertion instead of a debug print.</p>

<p>Sun Jan  8 01:18:19 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/-ext-/old_thread_select/test_old_thread_select.rb: 	  avoid
platform bug. [Bug #5858] [ruby-dev:45108]</p>

<p>Sun Jan  8 00:46:34 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* gc.c: get rid of implicit narrowing conversion.</p>

<p>Sun Jan  8 00:10:10 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: check posix_memalign(3) and memalign(3).</p>

<p>* gc.c (aligned_malloc): use configure&#39;s result instead of 	 
_POSIX_C_SOURCE and _XOPEN_SOURCE because they can&#39;t be used 	  to
check availability at least on FreeBSD.</p>

<p>Sat Jan  7 22:25:50 2012  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c: use Bitmap Marking algorithm to avoid copy-on-write of 	  memory
pages. See [ruby-dev:45085] [Feature #5839] 	  [ruby-core:41916].</p>

<p>* include/ruby/ruby.h : FL_MARK rename to FL_RESERVED1.</p>

<p>* node.h : ditto.</p>

<p>* debug.c : ditto.</p>

<p>* object.c (rb_obj_clone): FL_MARK move to a bitmap.</p>

<p>* class.c (rb_singleton_class_clone): ditto.</p>

<p>Sat Jan  7 00:47:07 2012  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* configure.in: always define CANONICALIZATION_FOR_MATHN. 	 
[ruby-dev:45100] [Bug #5852]</p>

<p>Fri Jan  6 23:11:20 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* include/ruby/version.h: RUBY_API_VERSION 2.0.0</p>

<p>Fri Jan  6 12:24:11 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* object.c (rb_inspect): raises Encoding::CompatibilityError if the 	 
result is incompatible with the default external encoding. 	 
[ruby-core:41931] [Bug #5848]</p>

<p>Thu Jan  5 15:26:15 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (check_valid_dir): strict checking of root. 	 
GetDriveType() succeeds with non root directory as the argument, 	  even if
MSDN says that the API needs the root directory. 	  this patch fixes a
failure of test/ruby/test_file_exhaustive.rb.</p>

<p>Thu Jan  5 12:15:55 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* file.c (rb_file_join): separator is appended by array length - 1 	 
times. patched by Benoit Daloze [ruby-core:41901] [Bug #5841]</p>

<p>Thu Jan  5 11:47:54 2012  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/common.rb (URI::Parser#initialize_regexp): 	  use A z instead of
^ $. [Bug #5843]</p>

<p>Wed Jan  4 17:55:53 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* array.c (rb_ary_sample): add example for Array#sample 	  based on patch
from <a
href="https://github.com/ruby/ruby/pull/74">github.com/ruby/ruby/pull/74</a></p>

<p>Wed Jan  4 14:24:33 2012  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (str_nth_len): count ascii-only run at the end.  this 	  bug
appears only when single-byte-optimization is disabled due 	  to unknown
coderange.  [ruby-core:41896] [Bug #5836]</p>

<p>Wed Jan  4 11:32:07 2012  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (check_valid_dir): special case for a root directory. 	 
Reported by Masateru OKAMOTO at [Bug #5819].</p>

<p>Wed Jan  4 00:19:54 2012  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/parsers/baseparser.rb: use private instead of _xxx 	  method
name. This is Ruby code not Python code. 	  refs #5696</p>

<p>Tue Jan  3 23:57:37 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/rexml/parsers/baseparser.rb: rexml BaseParser uses 	  instance_eval
unnecessarily on listener add. 	  patch from Charles Nutter. [Bug #5696]
[ruby-core:41437]</p>

<p>Tue Jan  3 20:44:13 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* README: add comment for Git user. patch from Arun Agrawal. 	* README.ja:
ditto.</p>

<p>Tue Jan  3 15:58:22 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* thread.c: changed documentation for “thread-local” variables. 	  patch
from Julien Ammous.</p>

<p>Tue Jan  3 15:50:12 2012  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* process.c: Fix typo. patch from Aviv Ben-Yosef.</p>

<p>Tue Jan  3 13:43:37 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* tool/merger.rb: allow r0123 style revision number.</p>

<p>Tue Jan  3 11:17:55 2012  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* tool/merger.rb (#version_up): version.h date should be Japanese 	 
locale date.</p>

<p>Mon Jan  2 22:08:00 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* tool/file2lastrev.rb (VCS::detect): Add support for Subversion 	  1.7
which adopted a whole new working directory structure.</p>

<p>* tool/file2lastrev.rb (VCS::detect): Simply use .each instead of 	 
.sort.reverse_each which looks too arbitrary.  If you want SVN 	  to be
tried first, then you just have to register it first as it 	  is right now.</p>

<p>Mon Jan  2 20:53:36 2012  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/securerandom.rb (random_bytes): use IO#read instead of 	 
IO#readpartial to make the intent more clear.</p>

<p>Mon Jan  2 15:26:39 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* test/ruby/test_object.rb (test_send_with_block): add a normal case.</p>

<p>Mon Jan  2 15:18:54 2012  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* test/ruby/test_object.rb (test_send_with_block): moved from 	 
bootstraptest/test_flow.rb.</p>

<p>Mon Jan  2 15:10:11 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* lib/test/unit/parallel.rb: use pack(“m0”) instead of 	 
pack(“m”).gsub(“n”,“”). 	* lib/test/unit.rb
(Test::Unit::Runner::Worker#run): ditto.</p>

<p>Mon Jan  2 15:05:09 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner::Worker#run): use 	  File.basename
with suffix instead of gsub.</p>

<p>Mon Jan  2 14:55:28 2012  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner#_run_parallel): find may 	  return
nil and nil can not dup.</p>

<p>Sun Jan  1 12:23:10 2012  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* lib/shellwords.rb (Shellwords#shellescape): Drop the //n flag 	  that
only causes warnings with no real effect.  [Bug #5637]</p>

<p>Sat Dec 31 06:28:37 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (rb_barrier_waiting): save the number of waiting threads 	  in
RBASIC()-&gt;flags. [ruby-dev:45002] [Bug #5768]</p>

<p>* thread.c (rb_barrier_wait): increment and decrement around 	 
rb_mutex_lock, and use rb_barrier_waiting().</p>

<p>* thread.c (rb_barrier_release): use rb_barrier_waiting().</p>

<p>* thread.c (rb_barrier_destroy): ditto.</p>

<p>Mon Dec 26 17:20:10 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm.c (vm_exec): add guard to prevent optimization for LLVM clang.</p>

<p>Fri Dec 30 17:01:12 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* vm_eval.c (rb_f_send): fix obj.send() documentation issue. 	 [Bug #5125]
[ruby-core:38633]</p>

<p>Thu Dec 29 22:36:16 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Runner::Worker#_run_parallels): fix 	 
premature exit when all workers&#39; status are :ready or :prepare. 	 
[ruby-dev:45061] [Bug #5822]</p>

<p>Thu Dec 29 01:51:13 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* include/ruby/ruby.h: fix #error pragma. LLP64 platform is supported.</p>

<p>* include/ruby/st.h: ditto.</p>

<p>Wed Dec 28 11:22:45 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/fileutils.rb (FileUtils::Entry_#entries): use utility method 	 
instead of typoed regexp.  [ruby-core:41829] [Bug #5817]</p>

<p>Wed Dec 28 02:08:04 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* vm_insnhelper.c (unknown_keyword_error): add GC guard to prevent 	 
intermediate object from GC.</p>

<p>Tue Dec 27 22:34:54 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb (Worker#close): “closing IO if IO is closed” 	  should
be “closing IO if IO isn&#39;t closed”</p>

<p>Tue Dec 27 22:04:27 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* st.c (st_update): new function to lookup the given key and 	  update the
value.  [ruby-dev:44998]</p>

<p>Tue Dec 27 21:17:33 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* node.h (rb_args_info): change pre_args_num and post_args_num as 	  int,
to match with rb_iseq_t.</p>

<p>* parse.y (new_args_gen): check overflow.</p>

<p>Mon Dec 26 22:38:35 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* vm_insnhelper.c (unknown_keyword_error): make it kind a error 	  message
when unknown keyword is given.  It require more work. 	  See
[ruby-core:40518] and [ruby-core:40541] in detail.</p>

<p>Mon Dec 26 22:31:07 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* vm_core.h (struct rb_iseq_struct), compile.c (iseq_set_arguments), 	 
iseq.c (rb_iseq_parameters), vm_insnhelper.c 	 
(vm_callee_setup_arg_complex): support Method#parameters for keyword 	 
arguments.  The provisional spec is what Benoit Daloze proposed. 	 
[ruby-core:40541]</p>

<p>* test/ruby/test_keyword.rb: add a test for above.</p>

<p>Mon Dec 26 22:15:27 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* vm_core.h (struct rb_iseq_struct), compile.c (iseq_set_arguments, 	 
iseq_compile_each), vm_insnhelper.c (vm_callee_setup_arg_complex): 	 
implement keyword arguments.  See [ruby-core:40290] 	  The feature is
promised to be included in 2.0, but the detail spec 	  is still under
discussion; this commit is a springboard for further 	  discussion.  Please
try it and give us feedback. 	  This commit includes fixes for some
problems reported by Benoit 	  Daloze &lt;eregontp AT gmail.com&gt;
[ruby-core:40518] and Marc-Andre 	  Lafortune &lt;ruby-core-mailing-list AT
marc-andre.ca&gt; 	  [ruby-core:41772].</p>

<p>* iseq.c (iseq_free, prepare_iseq_build): bookkeeping.</p>

<p>* test/ruby/test_keyword.rb: add tests for keyword arguments.</p>

<p>* test/ripper/dummyparser.rb (class DummyParser): temporal fix for 	 
ripper test.</p>

<p>Mon Dec 26 22:00:17 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* node.h, node.c, parse.y: implement a parser part for keyword 	 
arguments. 	  This is a preparation for keyword argument (see
[ruby-core:40290]).</p>

<p>* gc.c (gc_mark_children): bookkeeping.</p>

<p>Mon Dec 26 21:03:18 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* node.h, parse.y (new_args_gen), compile.c (iseq_set_arguments): use 	 
struct rb_args_info instead of NODEs. 	  This is a preparation for keyword
argument (see [ruby-core:40290]).</p>

<p>* node.c (dump_node), gc.c (gc_mark_children, obj_free): bookkeeping.</p>

<p>Mon Dec 26 20:59:51 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* node.h, parse.y (lambda, f_larglist): remove NEW_LAMBDA hack. 	  This is
a preparation for keyword argument (see [ruby-core:40290]).</p>

<p>Mon Dec 26 22:01:19 2011  Hiroshi Shirosaki &lt;h.shirosaki@gmail.com&gt;</p>

<p>* io.c (rb_sys_fail_path): move the definition. 	  Move above for using it
in set_binary_mode_with_seek_cur().</p>

<p>* io.c (set_binary_mode_with_seek_cur): fix improper seek cursor. 	 
Seeking file cursor with setting binary mode has possibility to 	  cause
infinite loop. Fixed the bug and refined error handling. 	  Introduced at
r34043.</p>

<p>And cleanups as below. 	  Remove unnecessary parentheses of `fptr`. 	 
Use return value of setmode().</p>

<p>* test/ruby/test_io_m17n.rb 	 
(TestIO_M17N#test_seek_with_setting_binmode): add a test for above. 	 
[ruby-core:41671] [Bug #5714]</p>

<p>Mon Dec 26 17:01:14 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (LIBRUBY_A): depends on main.o since r33774. 	 
[ruby-core:41786] [Bug #5796]</p>

<p>Mon Dec 26 13:07:08 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io.rb (TestIO#test_autoclose): Tempfile.new doesn&#39;t 	
accept the block argument.</p>

<p>Mon Dec 26 13:06:52 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb: Avoid zombie processes on “–separate” option 	  added
at r34121.</p>

<p>Mon Dec 26 04:01:23 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_cipher.c: Update and complete documentation.</p>

<p>Sun Dec 25 23:16:11 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* test/testunit/test_parallel.rb (test_separate): Test for “–separate” 	 
option (r34121)</p>

<p>Sun Dec 25 22:39:49 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb (_run_parallel): 	  New option “–separate” for
test/unit; when running tests with this 	  option, a job process will be
restarted after one test file has done. 	  This means all test files will
run with separated process.</p>

<p>* lib/test/unit/parallel.rb: Fix for above. Now parallel.rb puts 	 
“ready!” for first ready, “ready” for afters.</p>

<p>Sun Dec 25 00:02:15 2011  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* configure.in: change –with-ntver to –with-winnt-ver to be more 	 
descriptive in the context. [ruby-core:41794]</p>

<p>Sat Dec 24 23:25:15 2011  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* configure.in: add –with-ntver option to match win32/configure.bat 	 
functionality. Set 0x0501 as default. [ruby-core:35010] 	 
[ruby-core:35035]</p>

<p>Sat Dec 24 12:38:53 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (proc_call): get rid of optimization-out by clang.</p>

<p>* proc.c (rb_proc_call, rb_proc_call_with_block): ditto.</p>

<p>Sat Dec 24 10:56:32 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (readline_readline): check if outstream 	  is
closed to get rid of a bug of readline 6.  [ruby-dev:45043] 	  [Bug #5803]</p>

<p>Sat Dec 24 06:59:49 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/readline/test_readline.rb (test_line_buffer__point): use 	  lambda
not to exit entire method by “return”.  or “next” for 	  proc. 
[ruby-dev:45042] [Bug #5802]</p>

<p>Sat Dec 24 01:20:39 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm_eval.c (send_internal): PASS_PASSED_BLOCK_TH must be placed 	  just
before calling rb_call0.</p>

<p>* bootstraptest/test_flow.rb: add a test for above.</p>

<p>Sat Dec 24 00:55:16 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/tempfile.rb (Tempfile#initialize): warn if a block is given.</p>

<p>Fri Dec 23 16:14:30 2011  TAKAO Kouji  &lt;kouji@takao7.net&gt;</p>

<p>* ext/readline/readline.c (readline_attempted_completion_function): 	  in
Readline module with GNU Readline 6 case, Readline module 	  resets
completion_append_character to “ ”, after it executes 	  completion. So,
Readline module stores 	  completion_append_character, and Readline module
always sets it 	  after Readline module executes completion.
[ruby-dev:43456] 	  [Feature #4635]</p>

<p>Fri Dec 23 15:59:05 2011  TAKAO Kouji  &lt;kouji@takao7.net&gt;</p>

<p>* ext/readline/readline.c (Init_readline): libedit check 	 
rl_getc_function only when rl_initialize() is called, and 	 
using_history() call rl_initialize(). This assignment should be 	  placed
before using_history(). [ruby-core:40641] [Bug #5539]</p>

<p>Fri Dec 23 10:14:47 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/thread/test_queue.rb (test_thr_kill): show the number of loop 	 
run when the test failed.</p>

<p>Fri Dec 23 09:23:48 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/test_pty.rb (test_pty_check_default): call PTY.check until 	  “cat”
command is finished.</p>

<p>Fri Dec 23 06:03:00 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* common.mk: add “check succeeded” message.</p>

<p>* README, README.ja: follow above change.</p>

<p>Fri Dec 23 06:00:39 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* ext/bigdecimal/bigdecimal.h: add satisfy cc-mode comment. 	* util.c:
ditto.</p>

<p>Fri Dec 23 00:08:25 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/test_pty.rb (test_pty_check_default): “cat” may not terminated 	 
in the 0.1 second.</p>

<p>Thu Dec 22 23:37:25 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_thread.rb (test_condvar_timed_wait): don&#39;t test the 	
maximum sleep time.  Ruby is not a real-time system.</p>

<p>Thu Dec 22 22:37:45 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* thread_pthread.c (ping_signal_thread_list): remove return value. 	*
thread_pthread.c (check_signal_thread_list): add a new function to 	  check
if signal thread list is empty. 	* thread_pthread.c (thread_timer): check
signal thread list after 	  timer_thread_function(). main thread might be
added into signal thread 	  list during timer_thread_function().</p>

<p>Thu Dec 22 00:40:24 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (VpMult, VpCtoV, VpSqrt): remove assigned 	 
but unused variables.</p>

<p>Wed Dec 21 18:28:22 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk (newline.c, miniprelude.c): revert r33949 because the change 	
broke mswin build, and the changer said no reason about the change. 	 
[ruby-dev:45016] [Bug #5783]</p>

<p>Wed Dec 21 12:35:24 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_s_allocate): follow 	 
Allocation Framework.  [Bug #5775]</p>

<p>Wed Dec 21 02:25:36 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/emitter.c: fixing clang warnings. Thanks Joey!</p>

<p>Wed Dec 21 01:06:00 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* ext/bigdecimal/README: Update redmine.ruby-lang.org to
bugs.ruby-lang.org 	* ext/socket/ancdata.c: ditto 	*
test/-ext-/wait_for_single_fd/test_wait_for_single_fd.rb: ditto 	*
test/syck/test_yaml.rb: ditto 	* doc/ChangeLog-1.9.3: ditto</p>

<p>Tue Dec 20 23:50:12 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* PStore content update perf optimization. Patch by Masaki Matsushita. 	 
See #5248.</p>

<p>* lib/pstore.rb (save_data):</p>

<p>* Delete inadequate Marshal check.</p>

<p>* Deferred file truncation: when writing the new content, truncate 	   
the saved file to the data size after writing the data, instead of 	   
truncating whole bytes before writing data.</p>

<p>* Deferred MD5 calculation: when comparing MD5 hash to check the 	   
content modification, calculate MD5 hash of new data iif the 	    content
length is differ from the old one.</p>

<p>* Compare content size with String#bytesize instead of String#size.</p>

<p>Tue Dec 20 21:00:30 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: uses to_integer instead. 	*
test/date/test_switch_hitter.rb: added a test.</p>

<p>Tue Dec 20 15:04:18 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* Make sure to clear $! when ignoring an exception</p>

<p>* ext/openssl/ossl.c (ossl_pem_passwd_cb0, ossl_verify_cb): 	 
pem_passwd_cb and verify_cb ignores the exception raised in a 	  callback
proc so it should clear $! for subsequent execution.</p>

<p>That&#39;s said, both subsequent processes for pem_passwd_cb and 	 
verify_cb raises another exception before leaking $! to Ruby world. 	  We
cannot test this fix in Ruby land.</p>

<p>* test/openssl/test_pkey_rsa.rb 	 
(test_read_private_key_pem_pw_exception): Test for pem_passwd_cb + 	 
exception.</p>

<p>Tue Dec 20 11:49:13 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/date/test_date_base.rb (test_jd): tests for 	  [ruby-dev:45008].</p>

<p>Tue Dec 20 10:20:48 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/date/date_core.c (wholenum): fix the type of the return value.</p>

<p>Tue Dec 20 05:03:24 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* README.ja:  Update redmine.ruby-lang.org to bugs.ruby-lang.org 	*
README:  ditto 	* common.mk:  ditto 	* man/erb.1:  ditto 	* man/irb.1: 
ditto 	* man/ri.1:  ditto 	* man/ruby.1:  ditto 	* sparc.c:  ditto 	*
tool/install-sh:  ditto</p>

<p>Tue Dec 20 02:15:18 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c:  [ruby-dev:45008].</p>

<p>Sun Dec 18 18:52:37 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* vm.c (vm_define_method): improve guard of iseq from GC.  Fix 	  failure
or segmentation fault in test_singleton_method(TestGc) 	  on sparc
Solaris10 compiled with Oracle Solaris Studio 12.2. 	  [Bug #5762]
[ruby-dev:45000] [Bug #4178]</p>

<p>Sun Dec 18 14:34:31 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (Init_bigdecimal): does not follow 	 
allocation framework right now.  [ruby-core:41710] [Bug #5773]</p>

<p>Sun Dec 18 12:42:48 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: BigDecimals can be restored 	 
from YAML. 	* ext/psych/lib/psych/visitors/yaml_tree.rb: BigDecimals can be
dumped 	  to YAML. 	* test/psych/test_numeric.rb: tests for BigDecimal
serialization</p>

<p>Sun Dec 18 12:03:13 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: Strings that look like dates 	 
should be treated as strings and not dates.</p>

<p>* test/psych/test_scalar_scanner.rb: corresponding tests.</p>

<p>Sun Dec 18 09:43:21 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/thread/test_queue.rb (test_thr_kill): extend timeout. 	  this test
takes a long time at slow machine.</p>

<p>Sun Dec 18 09:36:51 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/ruby/envutil.rb (invoke_ruby): remove :timeout option before 	 
pass it to Kernel#spawn.</p>

<p>Fri Dec 16 17:18:38 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* README, README.ja: &#39;make check&#39; is preferable to &#39;make
test&#39;.</p>

<p>Thu Dec 15 23:16:13 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* error.c (builtin_type_name): don&#39;t return pointer to the buffer of 	
temporary String object.</p>

<p>Thu Dec 15 17:56:58 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (argf_type): make typed data.</p>

<p>Thu Dec 15 17:40:28 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_check_type): fix typo.</p>

<p>Thu Dec 15 14:48:35 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/strscan/strscan.c: use typed data with 	  onig_region_memsize().</p>

<p>Thu Dec 15 14:33:33 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_check_typeddata): refine error message with 	  including
expected struct name.</p>

<p>Thu Dec 15 13:15:51 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* regcomp.c (onig_region_memsize): implemented for memsize_of().</p>

<p>* ext/objspace/objspace.c (memsize_of): use it.</p>

<p>Thu Dec 15 10:44:54 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_reject_bang, rb_ary_delete_if): update rdoc. 	 
documentation from Thomas Leitner &lt;t_leitner AT gmx.at&gt; in 	 
[ruby-core:41616].  [Bug #5752]</p>

<p>Thu Dec 15 10:10:43 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/test_require.rb (test_race_exception): get rid of 	 
not-guaranteed timing issue.  [ruby-core:41655] [Bug #5754]</p>

<p>Wed Dec 14 21:58:42 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io_m17n.rb 	  (TestIO_M17N#test_<code>cs</code>): only for Windows.</p>

<p>Wed Dec 14 19:57:23 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk,Makefile.in,win32/Makefile.sub (ECHO1): move platform 	 
specific hack from common.mk to Makefile.in (and win32/Makefile.sub). 	 
[Bug #5711]</p>

<p>* lib/mkmf.rb: we can generate Makefile as we like.</p>

<p>Wed Dec 14 19:22:33 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c, include/ruby/win32.h (rb_w32_fd_is_text): new function.</p>

<p>* win32/win32.c (init_stdhandle): set default mode of stdin as binmode.</p>

<p>* io.c (set_binary_mode_with_seek_cur): new function to replace 	 
SET_BINARY_MODE_WITH_SEEK_CUR macro.  now returns previous mode of the 	 
fd and take care of LF in rbuf.</p>

<p>* io.c (do_writeconv): set text mode when needed.</p>

<p>* io.c (io_read): need to change the mode of the IO to binmode 	 
temporally when the length for IO#read, because IO#read with length 	  must
behave so.</p>

<p>* test/ruby/test_io_m17n.rb (TestIO_M17N#test_<code>read_with_length,</code>): tests
for 	  above changes.</p>

<p>all patches are written by Hiroshi Shirosaki. [ruby-core:41496] 	[Feature
#5714]</p>

<p>Wed Dec 14 15:28:31 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c (str_encode): about the extension of :fallback 	  option
since 1.9.3.</p>

<p>Wed Dec 14 12:19:59 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (load_unlock): release loading barrier and then remove it 	  from
loading_table if it is not in-use.  [Bug #5754]</p>

<p>* thread.c (rb_barrier_release, rb_barrier_destroy): return 	  whether any
other threads are waiting on it.</p>

<p>Wed Dec 14 11:23:45 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (ubf_select): call rb_thread_wakeup_timer_thread() 	 
only when it is not timer_thread. [Bug #5757] [ruby-dev:44985] 	  patched
by Tomoyuki Chikanaga.</p>

<p>Wed Dec 14 10:20:08 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (load_lock): delete the loading barrier if it has been 	 
destroyed.</p>

<p>* thread.c (rb_barrier_wait): return nil for recursive lock 	  instead of
false, to distinguish it from destroyed barrier.</p>

<p>Wed Dec 14 01:24:55 2011  okkez  &lt;okkez000@gmail.com&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): fix memory 	  leak.
[ruby-dev:44904] [Bug #5688]</p>

<p>Wed Dec 14 00:01:15 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (primary): point method name line.  [ruby-core:40936] 	  [Bug
#5614]</p>

<p>Tue Dec 13 23:43:48 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* error.c (name_err_mesg_to_str): clear rb_thread_t::errinfo when 	 
ignore exception under rb_protect(). [ruby-core:41612] [Bug #5755]</p>

<p>* test/ruby/test_exception.rb (test_exception_in_name_error_to_str): 	 
add a corresponding test.</p>

<p>Tue Dec 13 16:13:29 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (load_unlock): all threads requiring one file should 	  share
same loading barrier, so it must be kept alive while those 	  are waiting
on it.  [ruby-core:41618] [Bug #5754]</p>

<p>Tue Dec 13 07:30:14 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/webrick/httpresponse.rb (setup_header): 1xx responses 	  are allowed
to have Keep-Alive connections.</p>

<p>* test/webrick/test_httpresponse.rb: corresponding test.</p>

<p>Tue Dec 13 07:13:28 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/webrick/httpresponse.rb (setup_header): 204 and 304 responses 	  are
allowed to have a Keep-Alive connection. [ruby-core:41581]</p>

<p>* test/webrick/test_httpresponse.rb: corresponding test.</p>

<p>Tue Dec 13 06:29:39 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_magic_comment): should pass the proper value. 	 
[ruby-dev:44984][Bug #5753]</p>

<p>Tue Dec 13 05:50:07 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_yield_setup_block_args): splat single 	  argument if
optional arguments are defined not only mandatory or 	  post arguments. 
[ruby-core:41557] [Bug #5730]</p>

<p>Mon Dec 12 22:35:39 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* parse.y (stmt_or_begin): changed the error message for BEGIN not 	  at
toplevel.  [ruby-dev:44963] [Bug #5738]</p>

<p>Mon Dec 12 17:29:01 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* README: Fixed SupportedPlatforms URL in the README. 	  patched by
eMxyzptlk. <a
href="https://github.com/ruby/ruby/pull/62">github.com/ruby/ruby/pull/62</a></p>

<p>Mon Dec 12 17:26:51 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (rb_feature_p): lazy assigned load_path searched in 	 
loading_table were not expanded, but all features, pushed to 	  loading
table, are expanded.  a patch by Yura Sokolov 	  &lt;funny.falcon AT
gmail.com&gt; in [ruby-core:41545]. [Bug #5727]</p>

<p>Mon Dec 12 15:41:03 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_truncate): fix typo.  patched by 	  Nick
Howard &lt;ndh AT baroquebobcat.com&gt;. 	  <a
href="https://github.com/ruby/ruby/pull/65">github.com/ruby/ruby/pull/65</a></p>

<p>Sun Dec 11 12:19:17 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb: includes the sequence number of UID in a error 	 
message.  suggested by art lussos. 	  [ruby-core:41413] [Feature #5692]</p>

<p>Sun Dec 11 11:42:10 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* ext/syslog/syslog.c: fix a typo. [ruby-core:41585] [Bug #5740]</p>

<p>Sun Dec 11 10:48:16 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (exit_initialize): deal with true and false as well as 	 
Kernel#exit.  [ruby-dev:44951] [Bug #5728]</p>

<p>Sun Dec 11 10:37:47 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_check_to_int): new function to convert a VALUE to 	  an
Integer if possible, but returns nil instead of raising an 	  exception
otherwise.</p>

<p>Sun Dec 11 10:34:39 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_exit_status_code): extract from rb_f_exit_bang and 	 
rb_f_exit.  assume 0 to be success in Kernel#exit! too.</p>

<p>Fri Dec  9 19:24:31 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* enc/trans/iso-8859-16-tbl.rb: add ISO-8859-16 converter.</p>

<p>* enc/trans/single_byte.trans: ditto.</p>

<p>Fri Dec  9 14:28:40 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* file.c (file_path_convert): don&#39;t convert it when the path string is
	  ascii only. [ruby-core:41556] [Bug #5733] 	  tests are contributed by
nobu.</p>

<p>Fri Dec  9 08:00:15 2011  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* include/ruby/win32.h: undef stat to silence mingw-w64 stat 	 
redefinition warnings (GCC 4.6.3).</p>

<p>Thu Dec  8 23:38:24 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* variable.c (set_const_visibility): clear inline-cache when
constant&#39;s 	  visibility is modified. [ruby-dev:44929]</p>

<p>* test/ruby/test_module.rb (test_private_constants_clear_inlinecache): 	 
add test for it.</p>

<p>Thu Dec  8 23:26:11 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extract_makefile): should sort after map, not before 	 
it.  in this case there is no difference, but we should write better 	 
code.  this bad smell was caught by nagachika.</p>

<p>Thu Dec  8 22:31:13 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extract_makefile): need to sort the array of current 	 
srcs before comparing to the sorted old srcs. 	  fixed the problem that the
configuring stage of exts were always 	  run, introduced at r33801.</p>

<p>Thu Dec  8 13:26:24 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rexml/test_order.rb (OrderTester#test_more_ordering): use 	 
Zlib::GzipReader.open instead of Zlib::GzipReader.new with File.new. 	 
fixed a test error on Windows introduced at r33946.</p>

<p>Thu Dec  8 13:11:26 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_process.rb (<a href="gu">TestProcess#test_sete</a>id):
silently 	  skip if not implemented such functions (such as, on Windows). 	
fixed test errors on Windows introduced at r33953.</p>

<p>Thu Dec  8 12:57:50 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/socket/extconf.rb: forgotten to define HAVE_SOCKETPAIR for 	 
windows. 	  fixed test errors on Windows introduced at r33947.</p>

<p>Thu Dec  8 12:11:06 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_WERROR_FLAG): append all warning flags which 	  are
enabled to compile, so that printf format modifiers properly 	  fail. 
[ruby-core:41351] [Bug #5679]</p>

<p>Thu Dec  8 07:20:15 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/re.rdoc:  Document difference between match and =~, options with 	 
Regexp.new and global variables.  Patch by Sylvain Daubert. 	  [Ruby 1.9 -
Bug #5709]</p>

<p>Thu Dec  8 06:53:10 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* doc/re.rdoc:  Fix example code to match documentation.  Patch by 	 
Jarno Lamberg.  [Ruby 1.9 - Bug #5624]</p>

<p>Wed Dec  7 19:04:22 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (rpath): fix typo in the help string.  a patch from 	  Yuji
Yamano &lt;yyamano AT kt.rim.or.jp&gt; in [ruby-list:48568].</p>

<p>Wed Dec  7 18:55:56 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (vm_set_top_stack, vm_set_eval_stack): check for stack 	  overflow
with stack_max before push new frame. [ruby-core:41520] 	  [Bug #5720]</p>

<p>* vm.c (vm_set_main_stack): no stack overflow chances after 	 
vm_set_eval_stack().</p>

<p>Wed Dec  7 09:58:15 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c:  Document +@, -@, hash, INFINITY, Nan. 	 
Patch by Sylvain Daubert.  [Ruby 1.9 - Feature #5622]</p>

<p>Wed Dec  7 09:48:00 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* io.c (Init_IO):  Mention io/console methods.  [Ruby 1.9 - Bug #5602] 	*
ext/io/console/console.c:  Mention that io/console must be required 	 
similar to lib/time.rb</p>

<p>Wed Dec  7 08:04:31 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb (module Psych): parse and load methods take 	  an
optional file name that is used when raising Psych::SyntaxError 	 
exceptions 	* ext/psych/lib/psych/syntax_error.rb (module Psych): allow nil
file 	  names and handle nil file names in the exception message 	*
test/psych/test_exception.rb (module Psych): Tests for changes.</p>

<p>Tue Dec  6 18:26:33 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/dbm.c: use db_version() instead of DB_VERSION_STRING to 	 
detect runtime Berkeley DB version. 	  use dpversion instead of
_QDBM_VERSION to detect runtime QDBM 	  version. 	  [ruby-dev:44948]</p>

<p>Tue Dec  6 12:30:41 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: detect gdbm_version in libgdbm.</p>

<p>* ext/dbm/dbm.c: make DBM::VERSION more informative for gdbm, qdbm and 	 
Berkeley DB 1.x.  [ruby-dev:44944]</p>

<p>Tue Dec  6 07:26:37 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* range.c:  Improve documentation for Range.  Patch by Chris Zetter. 	 
[Ruby 1.9 - Bug #5656]</p>

<p>Mon Dec  5 19:08:04 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* regparse.c (PFETCH_READY): separate gcc specific trick.</p>

<p>Mon Dec  5 19:01:59 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (proc_seteuid_m): fix argument.</p>

<p>* test/ruby/test_process.rb (test_geteuid): fix typo.</p>

<p>* test/ruby/test_process.rb (test_getegid, <a href="eg">test_set</a>uid):
add.</p>

<p>Mon Dec  5 18:56:55 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bignum.c (big_rshift), compile.c (validate_label, 	 
iseq_build_from_ary_exception), cont.c (cont_capture), dir.c 	 
(dir_open_dir), gc.c (objspace_each_objects), io.c (pipe_open) 	 
(rb_io_advise), parse.y (parser_compile_string) 	 
(rb_parser_compile_file), proc.c (binding_free), process.c 	 
(rb_proc_exec_n, rb_seteuid_core, proc_setegid, rb_setegid_core) 	 
(p_uid_exchange, p_gid_exchange), regparse.c (strdup_with_null), 	 
signal.c (sig_dfl), vm.c (rb_iseq_eval, rb_iseq_eval_main), 	 
vm_insnhelper.c (vm_expandarray): suppress 	  unused-but-set-variable
warnings.</p>

<p>* class.c (rb_obj_methods), compile.c (iseq_compile_each), 	 
iseq.c(iseq_load, rb_iseq_parameters), pack.c (pack_pack), 	  regcomp.c
(is_not_included, update_string_node_case_fold), 	  transcode.c
(rb_econv_open0, make_replacement), 	  vm_eval.c (raise_method_missing):
remove unused variable.</p>

<p>* signal.c (reserved_signal_p): static.</p>

<p>Mon Dec  5 14:27:23 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/substsubst.h,win32subst.h,win32.h, ext/socket/rubysocket.h: revert 	 
r33876.  [ruby-core:41475] [Bug #5706]</p>

<p>* ext/socket/extconf.rb: the alternative hack for [Bug #5675].</p>

<p>Mon Dec  5 10:18:45 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/zlib/zlib.c (rb_gzreader_initialize): revert a part of r33937. 	 
1st, to change the mode of an IO is very sensitive problem, so 	  the
maintainer of this library should judge it. 	  2nd, usually
Zlib::GzipReader.new is not called directly.  #initialize 	  is called via
.open, and in the method the I/O is opened in binary 	  mode, so there is
no problem without changing the mode in #initialize.</p>

<p>Sun Dec  4 22:53:12 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/tempfile.rb: don&#39;t use lock directory.  [ruby-dev:39197]</p>

<p>Sun Dec  4 22:34:43 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/tempfile.rb (Tempfile::MAX_TRY): remove unused constant.</p>

<p>Sun Dec  4 12:11:28 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* lib/pp.rb: fix rdoc.</p>

<p>Sun Dec  4 12:03:16 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/delegate.rb (Delegator#methods): Kernel#methods receives 	  zero or
one argument. [ruby-core:37118] [Bug #4882]</p>

<p>Sun Dec  4 10:15:00 2011  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* ext/zlib/zlib.c (rb_gzreader_initialize): use binary mode by default 	 
under Windows. Patch by Hiroshi Shirosaki. [ruby-core:40706] 	  [Feature
#5562]</p>

<p>* include/ruby/encoding.h (void rb_econv_binmode): define NEWLINE 	 
decorator.</p>

<p>* io.c (rb_cloexec_fcntl_dupfd): Introduce NEED_READCONV and 	 
NEED_WRITECONV to replace universal newline decorator by CRLF only 	  when
required to improve file reading and writing under Windows. 	  Patch by
Hiroshi Shirosaki. [ruby-core:40706] [Feature #5562] 	* io.c
(do_writeconv): adjust binary mode if required. 	* io.c (read_all,
appendline, swallow, rb_io_getline_1): ditto. 	* io.c (io_getc,
rb_io_each_codepoint, rb_io_ungetc): ditto. 	* io.c (rb_io_binmode,
rb_io_ascii8bit_binmode): ditto. 	* io.c (rb_io_extract_modeenc,
rb_sysopen): ditto. 	* io.c (pipe_open, prep_stdio, io_encoding_set):
ditto. 	* io.c (rb_io_s_pipe, copy_stream_body): ditto.</p>

<p>* test/ruby/test_io_m17n.rb (EOT): add test for pipe and stdin in 	 
binary mode.</p>

<p>* win32/win32.c (init_stdhandle): remove O_BINARY from stdhandle 	 
initialization. 	* win32/win32.c (rb_w32_write): use FTEXT mode
accordingly.</p>

<p>Sat Dec  3 20:49:16 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* variable.c (set_const_visibility): print a warning when no argument 	 
is passwd to Module#private_constant.  [ruby-list:48558]</p>

<p>* vm_method.c (set_method_visibility): ditto for 	 
Module#private_class_method.</p>

<p>Sat Dec  3 20:43:14 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* variable.c (set_const_visibility): Module#private_constant has 	 
changed the visibility of only the first argument.  Now it changes 	  all
of them.  [ruby-list:48558]</p>

<p>* test/ruby/test_module.rb: add a test for above.</p>

<p>Sat Dec  3 07:17:29 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (CFLAGS): append ARCH_FLAG.</p>

<p>* configure.in (ARCH_FLAG): exclude from CFLAGS.</p>

<p>* configure.in (UNIVERSAL_INTS): include short int.  fix for 	  test/mkmf.</p>

<p>Fri Dec  2 15:48:08 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (VpAllocReal): reduce extra frac.</p>

<p>Fri Dec  2 15:41:24 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: check whether -pie or -Wl,-pie is valid as 	  LDFLAGS. 
[ruby-core:41438] [Bug#5697]</p>

<p>* configure.in: use $linker_flag for LDFLAGS option which is not 	 
limited to particular platforms.</p>

<p>Thu Dec  1 23:21:58 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* thread_pthread.c (thread_timer): call prctl(PR_SET_NAME) only if 	 
PR_SET_NAME is available.</p>

<p>Thu Dec  1 22:31:16 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (linux_get_maxfd): change local variable name.</p>

<p>Thu Dec  1 16:59:24 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/extconf.rb: add arguments for macro calls. 	 
[ruby-core:41370] [Bug#5681]</p>

<p>Thu Dec  1 16:20:16 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (MakeMakefile#try_func): fix broken patch at r33834.</p>

<p>Thu Dec  1 14:43:17 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.h (Real): suppress false warning from 	 
clang.  [ruby-core:41418] [Bug#5693]</p>

<p>Thu Dec  1 10:31:55 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (LDFLAGS): -fstack-protector is always needed to 	  link
static library created with it.  [ruby-core:41387] 	  [Bug#5686]</p>

<p>Thu Dec  1 07:03:51 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: add sys/prctl.h test. 	* thread_pthread.c (thread_timer):
call prctl(PR_SET_NAME) to change 	  thread name. It may help to debug.</p>

<p>Wed Nov 30 23:35:45 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* variable.c (rb_path2class): don&#39;t raise NameError when the middle 	 
constant of the path is not defined but defined on toplevel. 	 
[ruby-core:41410] [Bug #5691]</p>

<p>Wed Nov 30 20:02:02 2011  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* transcode.c: Simplified rb_econv_binmode, avoided a warning on cygwin.</p>

<p>Wed Nov 30 08:57:07 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/mkmf.rb:  Use MakeMakefile&#39;s rm_f to avoid conflict with Rake or
	  FileUtils. 	* test/ruby/test_module.rb:  Hide MakeMakefile&#39;s
inclusion in Object</p>

<p>Wed Nov 30 09:12:43 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rdoc/encoding.rb (RDoc::Encoding.read_file): fixup newline chars 	 
on Windows. 	  see <a
href="https://github.com/rdoc/rdoc/issues/87">github.com/rdoc/rdoc/issues/87</a></p>

<p>* test/rdoc/test_rdoc_markup_pre_process.rb 	 
(TestRDocMarkupPreProcess#test_include_file, 	 
TestRDocMarkupPreProcess#test_include_file_encoding_incompatible): 	 
follow above change.</p>

<p>Wed Nov 30 09:09:37 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c (parse): parse method can take an option file 	  name
for use in exception messages. 	* test/psych/test_parser.rb: corresponding
tests.</p>

<p>Tue Nov 29 09:07:59 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/mkmf.rb:  Fix indentations of constants at end of module. 	 
Document some constants.</p>

<p>Tue Nov 29 09:58:23 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_write_error2): suppress unused variable warning.</p>

<p>Tue Nov 29 07:45:26 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/mkmf.rb:  Wrap comments to 78 columns and clean up formatting.</p>

<p>Tue Nov 29 05:54:18 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/mkmf.rb:  Wrap mkmf.rb in module MakeMakefile to clean up Object 	 
documentation.  [Ruby 1.9 - Feature #5658] 	* ext/extmk.rb:  Use
MakeMakefile::CONFIG instead of Object::CONFIG 	* test/mkmf/base.rb:  ditto</p>

<p>Tue Nov 29 00:08:57 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* common.mk (INSTRUBY_ARGS): added –mantype to apply mdoc2man.rb 	  to man
pages.  Fixes #5598. 	  (do-install-nodoc, do-install-local,
do-install-man, 	  dont-install-nodoc, dont-install-local,
dont-install-man): 	  No longer needs –mantype.</p>

<p>Reported by Rainer Orth &lt;ro AT cebitec.uni-bielefeld.de&gt;, 	  patch
by George Koehler &lt;xkernigh AT netscape.net&gt;.</p>

<p>Mon Nov 28 22:26:31 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rake/test_rake_directory_task.rb 	 
(TestRakeDirectoryTask#test_directory_win32): shouldn&#39;t create any 	 
file/directory on root directory.  create on @tempdir (= Dir.pwd). 	  see
<a
href="https://github.com/jimweirich/rake/issues/91">github.com/jimweirich/rake/issues/91</a></p>

<p>Mon Nov 28 12:57:29 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_write_error2): fwrite() returns ssize_t.</p>

<p>Mon Nov 28 12:47:19 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* parse.y (nodetype, nodeline): static.  these functions are for 	 
debugging, and not intend to be public.</p>

<p>Mon Nov 28 12:37:54 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* gc.c (initial_params): static.  it seems to be forgotten at r33501.</p>

<p>Mon Nov 28 12:32:24 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/win32.h, win32/win32.c (GetCurrentThreadHandle): remove 	 
unused old API.</p>

<p>Mon Nov 28 12:29:20 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/mkexports.rb (Exports#initialize): remove old symbol name.</p>

<p>Mon Nov 28 12:15:28 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/mkexports.rb (Exports#read_substitution): need to read 	  from
subst.h too.  [Bug #5675]</p>

<p>Mon Nov 28 11:46:35 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_flush): release GVL during fsync() on Windows.</p>

<p>Mon Nov 28 11:00:25 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/subst.h: typo of r33876.</p>

<p>Mon Nov 28 10:36:00 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/subst.h: moved Windows specific substitutions from 	 
win32.h.</p>

<p>* ext/socket/rubysocket.h: include ruby/subst.h.  [Bug #5675]</p>

<p>Mon Nov 28 10:20:58 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/<code>Makeilfe.sub,win32.c</code> (FILE_COUNT, FILE_READPTR): move the 	 
definitions from config.h to win32.c.  I dared to have left such 	  macros,
for other future compiler support. 	  [ruby-core:41313] [Bug #5674]</p>

<p>Mon Nov 28 09:28:30 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_uchmod): typo.  [Bug#5671] [ruby-dev:44898]</p>

<p>* test/ruby/test_file.rb (TestFile#test_chmod_m17n): test of above bug.</p>

<p>Sun Nov 27 21:25:33 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: added -fno-strict-overflow. it suppress annoying 	 
-Wstrict-overflow warning.</p>

<p>Sun Nov 27 20:58:02 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_write_error2): get rid of warning on linux. fwrite 	  of glibc
is tagged __attribute__ ((<em>warn_unused_result</em>)) 	  if
_FORTIFY_SOURCE != 0. 	* vm_dump.c (rb_vm_bugreport): ditto.</p>

<p>Sun Nov 27 19:09:02 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (stack_protector): disable on mingw.  [Bug#5676]</p>

<p>* Makefile.in (DLDFLAGS): also needs -fstack-protector. 	  [Bug#5676]</p>

<p>Sun Nov 27 14:13:33 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: add -fstack-protector into XLDFLAGS as well as 	  XCFLAGS
if stack-protector is used.</p>

<p>Sun Nov 27 13:09:25 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: workaround to avoid MacOS X build error. 	  Maybe autoconf
2.61 is slightly buggy. [ruby-core:41316]</p>

<p>Sun Nov 27 04:57:11 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (–no-undefined): r33840 breaks FreeBSD and DragonFly 	 
with gcc 4.4 or later. Their environ is in /usr/libexec/ld-elf.so.1, 	  so
it will be false negative.</p>

<p>Sun Nov 27 04:55:45 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP::SSL_IVNAMES): rerefix 33701. 	 
SSL_ATTRIBUTES stores names for set_params, they are symbol. 	  SSL_IVNAMES
stores instance variable names.</p>

<p>Sun Nov 27 00:16:07 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (copy_stream_body): use 0666 for permission argument for open. 	 
[ruby-core:40865]</p>

<p>Sat Nov 26 23:01:38 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_engine.rb: remove side effect of generic engine 	 
load by explicitly loading software-based “openssl” engine for 	  all
tests.</p>

<p>Sat Nov 26 20:41:48 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP.get_response): enable use_ssl 	  if given URI
object is https. 	  patched by Mark Ferlatte [ruby-core:40665] [Bug #5545]</p>

<p>* lib/net/http.rb (Net::HTTP.post_form): ditto.</p>

<p>Sat Nov 26 20:01:18 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP::SSL_ATTRIBUTES): refix 33701. 	  store
instance variable symbol names.</p>

<p>Sat Nov 26 15:40:25 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (script): should be ./configure</p>

<p>Sat Nov 26 15:39:18 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (before_script): wrong name, sorry.</p>

<p>Sat Nov 26 15:31:34 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml (before-script): autoconf required.</p>

<p>Sat Nov 26 15:24:05 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* .travis.yml: Travis enable.</p>

<p>Sat Nov 26 10:47:50 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/extconf.rb: remove checks for available functions. 	*
ext/openssl/missing.h: ditto. 	  Thanks, Tim Mooney for reporting this! 	 
[Bug #5432] [ruby-core:40088]</p>

<p>Sat Nov 26 10:22:28 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: add comment on where to find implementation 	 
of OpenSSL::SSL::SSLSocket#session.</p>

<p>Sat Nov 26 05:00:25 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (–no-undefined): RUBY_TRY_CFLAGS does nothing for 	  linker
flags.  use RUBY_TRY_LDFLAGS.</p>

<p>Fri Nov 25 11:37:07 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (ioctl_narg_len, linux_iocparm_len): reinstantiate linux 	 
specific narg length calculation. 	* test/ruby/test_io.rb
(test_ioctl_linux2): add new test for old and 	  unstructured ioctl.</p>

<p>Fri Nov 25 10:39:14 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* Makefile.in (EXTLDFLAGS): export it. 	* configure.in: add –no-undefined
if –enable-shared is specified. 	  Gentoo enabled this option long time.
Also, export EXTLDFALGS.</p>

<p>Fri Nov 25 08:48:35 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: turn on PIE if –enable-shared is not specified.</p>

<p>Fri Nov 25 08:05:07 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: add -fstack-protector. It help to protect us from 	  stack
smashing attack.</p>

<p>Fri Nov 25 08:03:28 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: add -D_FORTIFY_SOURCE=2. It provide some compile 	  time
and runtime check for security.</p>

<p>Fri Nov 25 08:00:23 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/mkmf.rb: get rid of warnings of mkmf.rb if -Wmissing-declarations 	 
and/or -Wold-style-definition warnings if specified. 	  Patch by Nikolai
Weibull. Thank you! [Bug #5459] [ruby-core:40200]</p>

<p>Fri Nov 25 07:46:09 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: add -Wall always.</p>

<p>Thu Nov 24 20:02:40 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/openssl/test_engine.rb: use IO#reopen to restore stderr.</p>

<p>Thu Nov 24 19:59:56 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_io_reopen): re-initialize buffering mode for stdout and 	 
stderr.</p>

<p>Thu Nov 24 11:12:48 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_io_fsync,rb_io_fdatasync): release GVL during fsync(). 	 
fsync() and fdatasync() may take a long time on slow disks and/or 	  if
there is much dirty data. 	  Patch by Eric Wong. [Feature #5665]
[ruby-core:41247]</p>

<p>Thu Nov 24 10:05:02 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_engine.rb: Suppress output from &#39;openssl&#39; 	 
engine&#39;s RC4 cipher. 	  [Bug #5633] [ruby-core:41026]</p>

<p>Thu Nov 24 08:05:02 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_pkey_dsa.c: remove redundant colon from error 	 
message. 	* ext/openssl/ossl_ssl.c: ditto. 	* ext/openssl/ossl_pkey_rsa:
ditto. 	  patched by Eric Hodel [Bug #5604] [ruby-core:40896]</p>

<p>Wed Nov 23 20:03:43 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (ioctl_narg_len): don&#39;t use _IOC_SIZE macro on Linux. 	  On
Linux some constants for ioctl(2) doesn&#39;t include the size of 	  its
return value and 16bit value; for example FIONREAD 0x541B. 	  Moreover the
manual, ioctl_list(2),  says “Note  that  the  size 	  bits  are  very
unreliable: in lots of cases they are wrong, 	  either because of buggy
macros using sizeof(sizeof(struct)), 	  or because of legacy values.” 	  So
we shouldn&#39;t use it.</p>

<p>Tue Nov 22 18:07:32 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (_pioinfo): need to declare _pioinfo() before using 	 
_osfhnd and other macros which uses _pioinfo() internally.</p>

<p>Tue Nov 22 17:49:45 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (_pioinfo): make an inline function.</p>

<p>Tue Nov 22 11:26:08 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>Tue Nov 22 11:33:58 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (dupfd): argument of _osfhnd and so on should not 	  have
side effect.</p>

<p>Tue Nov 22 11:26:08 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big_divide): refix of r33536. Don&#39;t change behavior of
Bignum#/. 	  [ruby-core:40429] [Bug #5490]</p>

<p>Tue Nov 22 10:46:57 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* numeric.c (ruby_float_step): improve floating point calculations. 	 
[ruby-core:35753] [Bug #4576]</p>

<p>* numeric.c (ruby_float_step): correct the error of floating point 	 
numbers on the excluding case. 	  patched by Masahiro Tanaka
[ruby-core:39608]</p>

<p>* numeric.c (ruby_float_step): use the end value when the current 	  value
is greater than or equal to the end value. 	  patched by Akira Tanaka
[ruby-core:39612]</p>

<p>Tue Nov 22 06:59:21 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_io.rb (test_fcntl_dupfd): there is no known platform 	 
which don&#39;t have F_DUPFD.  [ruby-dev:44874]</p>

<p>Tue Nov 22 04:46:22 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: remove autoload from psych 	*
ext/psych/lib/psych/json.rb: ditto</p>

<p>Tue Nov 22 00:44:59 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_io.rb (test_fcntl_dupfd): the argument of F_DUPFD is 	 
minimum file descriptor.</p>

<p>Tue Nov 22 00:25:17 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (linux_get_maxfd): get rid of a warning.</p>

<p>Mon Nov 21 23:39:14 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (linux_get_maxfd): new function to find maximum fd on Linux. 	 
(rb_close_before_exec): use linux_get_maxfd.</p>

<p>Mon Nov 21 06:16:24 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* cont.c (fiber_switch): ignore fiber context switch 	  because
destination fiber is same as current fiber. 	  With out this, it may segv
on FreeBSD 9. 	  patched by Koichi Sasada.</p>

<p>Sun Nov 20 23:22:42 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb (extract_makefile, extmake): regenerate makefiles 	  if
globbed source file list is changed.</p>

<p>* lib/mkmf.rb (create_makefile): store ORIG_SRCS.</p>

<p>Sun Nov 20 22:43:03 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* enc/unicode.c (PROPERTY_NAME_MAX_SIZE): +1. 	  reported by Ken Takata.
[ruby-dev:44894][Bug #5652]</p>

<p>Sun Nov 20 11:01:28 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/set.rb (SortedSet.setup): remove old_init after initialize 	  method
is redefined.  The remove before redefinition makes the 	  warning
prevention fragile.  [ruby-dev:44892]</p>

<p>Sun Nov 20 04:01:45 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (enc/unicode/name2ctype.h): remove duplicated 	  ifdefs.</p>

<p>Sat Nov 19 19:31:47 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* time.c (TIME_COPY_GMT): copy vtm.utc_offset and vtm.zone too. 	  patch
by Tomoyuki Chikanaga. 	  [ruby-dev:44827] [Bug #5586]</p>

<p>Sat Nov 19 16:36:57 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/net/http/test_http.rb: remove temporally files in ensure clause.</p>

<p>Sat Nov 19 08:18:41 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/net/http/test_http.rb: remove temporally files.</p>

<p>Fri Nov 18 17:18:16 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (console_raw, console_set_raw) 	 
(console_getch): optional parameters.  [EXPERIMENTAL]</p>

<p>Fri Nov 18 16:12:11 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (console_cooked, console_set_cooked): 	  new
methods to reset cooked mode.  [EXPERIMENTAL]</p>

<p>Fri Nov 18 13:20:26 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/unit/assertions.rb (MINI_DIR): quick dirty hack to get rid of 	 
warnings when using assert/assert_respond_to.</p>

<p>Fri Nov 18 13:03:38 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (rb_cloexec_open): set O_NOINHERIT instead of O_CLOEXEC if it is 	 
available (for Windows).</p>

<p>* win32/win32.c (fcntl): on F_DUPFD, determine the inheritance of the 	 
new handle by O_NOINHERIT flag of original fd.</p>

<p>Fri Nov 18 08:00:41 2011  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 2.8.1 (r6750) 	* test/minitest/*:
ditto 	* configure.in: Improved gcc-llvm error message to help people
migrate.</p>

<p>Thu Nov 17 20:43:34 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: revert a part of the patch in [ruby-dev:41531]. 	 
don&#39;t use db.h with other headers.  [ruby-dev:44884].</p>

<p>Thu Nov 17 20:23:03 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* <a href="23">benchmark/bm_io_select</a>.rb: use Process::RLIMIT_NOFILE
only when 	  it is defined.  if it is not defined, assume 64 as the max of
fds.</p>

<p>Thu Nov 17 10:36:46 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb (load_file): make sure opened yaml files are 	 
also closed. [ruby-core:41088]</p>

<p>Wed Nov 16 18:13:52 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (LIBRUBY_A): check if generated linked library is 	  valid
for extconf.</p>

<p>Wed Nov 16 13:51:40 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big2ulong): need to calc in unsigned long, because 	  the
range of VALUE is larger than it on LLP64 platform, such as Win64. 	  this
change fixes the failures of test/-ext-/num2int.</p>

<p>Wed Nov 16 12:02:47 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/webrick/test_cgi.rb (TestWEBrickCGI#start_cgi_server): there are 	 
no guarantee of existence of <a href="'LIBPATHENV'">RbConfig::CONFIG</a>. 	
it only exists in Unix-like environments.</p>

<p>* test/webrick/test_filehandler.rb 	 
(WEBrick::TestFileHandler#test_script_disclosure): ditto.</p>

<p>Wed Nov 16 11:34:20 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (argf_next_argv): wrong timing of setting ecflags. 	  fixed the
failure of TestArgf#test_textmode introduced at r33662.</p>

<p>Wed Nov 16 10:45:00 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/-test-/num2int/num2int.c: remove an unnecessary and wrong decl 	  of
rb_stdout.  it&#39;s declared in ruby.h correctly.</p>

<p>Wed Nov 16 10:26:41 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big2ull): add a cast to get rid of a VC++ warning.</p>

<p>Wed Nov 16 09:39:27 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/minitest/unit.rb (assert_raises): experimental fix to run 	 
correctly on chkbuild over 64bit linux. call exception_details only 	  when
the detail is really needed to avoid create needless inspect 	  under
ulimit-ed environment.</p>

<p>Wed Nov 16 06:34:30 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_thread.rb (test_condvar_timed_wait): use 	 
assert_operator.</p>

<p>Tue Nov 15 21:56:25 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_sleep.rb (test_sleep_5sec): 0.1sec tolerance is too 	 
small for busy environment.</p>

<p>Tue Nov 15 20:08:55 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c, thread.c, ext/pty/pty.c, ext/fiddle/closure.c: use 	  __linux__
macro for consistency.</p>

<p>Tue Nov 15 14:45:15 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/ruby.h(NUM2LONG, NUM2INT, NUM2SHORT, NUM2LL, 	  INT2NUM,
UINT2NUM, LONG2NUM, ULONG2NUM, NUM2CHR): wrap by 	  macros.</p>

<p>Tue Nov 15 13:38:14 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* include/ruby/defines.h (FLUSH_REGISTER_WINDOWS): move sparc asm code 	 
to a separate file sparc.c for preventing inlining optimization. 	  Patched
by Jurij Smakov. [Bug #5244] [ruby-core:40685] 	* sparc.c
(rb_sparc_flush_register_windows): ditto. 	* configure.in: ditto.</p>

<p>Tue Nov 15 13:11:35 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/ruby.h: get rid of gcc specific rb_long2int(), 	 
NUM2LONG(), NUM2INT(), NUM2SHORT(), NUM2LL(), INT2NUM(), 	  UINT2NUM(),
LONG2NUM(), ULONG2NUM() and NUM2CHR() 	  implementation. Because 1) They
don&#39;t make any better code 	  at all. 2) Inline function have a better
debugger supoort.</p>

<p>Tue Nov 15 09:58:25 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (TestIO#test_fcntl_dupfd): fix OpenBSD test 	 
failure. [ruby-dev:44872]</p>

<p>Tue Nov 15 09:50:21 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regcomp.c (print_indent_tree): fix double printing of ENCLOSE_OPTION 	 
children bug. patched by Suraj Kurapati. [ruby-core:40964]</p>

<p>Tue Nov 15 01:53:48 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (test_fcntl_dupfd): fix test error on 	 
SnowLeopard. Pointed out by CHIKANAGA Tomoyuki. [ruby-dev:44866]</p>

<p>Mon Nov 14 22:06:02 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/openssl/ossl_pkey.c (ossl_pkey_new_from_file): set close-on-exec 	 
flag.</p>

<p>* ext/openssl/ossl_x509cert.c (rb_fd_fix_cloexec): ditto.</p>

<p>Mon Nov 14 14:54:17 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* bignum.c (rb_big2ull): fix 32bit platform breakage. we must 	  not
assume sizeof(VALUE) == sizeof(LONG_LONG). 	*
test/-ext-/num2int/test_num2int.rb (class TestNum2int): 	  fix false
assumption on 32bit platform.</p>

<p>Mon Nov 14 14:52:54 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* numeric.c (rb_fix2ushort): fix typo. use num rb_num2ushort() 	  instead
of num2uint().</p>

<p>Sun Nov 13 10:31:03 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/ruby.h: add #ifdef comment.</p>

<p>Sun Nov 13 10:28:18 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/ruby.h: add NUM2SHORT(), NUM2USHORT() macros. 	* numeric.c:
ditto.</p>

<p>* test/-ext-/num2int/test_num2int.rb: add testcases for NUM2SHORT(). 	*
ext/-test-/num2int/num2int.c: ditto.</p>

<p>Sun Nov 13 10:23:48 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* bignum.c (rb_big2ull): fix off-by-twice bug of NUM2ULL. 	*
test/-ext-/num2int/test_num2int.rb (class TestNum2int): 	  fix a testcase
too.</p>

<p>Sun Nov 13 10:22:44 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/-ext-/num2int/test_num2int.rb (class TestNum2int): 	  add FIXNUM
tests.</p>

<p>Sun Nov 13 09:57:29 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* numeric.c (check_uint): fix off-by-one bug of NUM2UINT. 	* bignum.c
(rb_big2ulong): fix off-by-one bug of NUM2ULONG.</p>

<p>* test/-ext-/num2int/test_num2int.rb: add a testcase for NUM2INT() 	 
NUM2UINT(), NUM2LONG(), NUM2ULONG(), NUM2LL and NUM2ULL(). 	*
ext/-test-/num2int/depend: ditto. 	* ext/-test-/num2int/extconf.rb: ditto.
	* ext/-test-/num2int/num2int.c: ditto.</p>

<p>Sun Nov 13 23:47:29 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dbm/extconf.rb: use convertible_int.</p>

<p>Sun Nov 13 23:45:57 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (checking_for): should not modify the result.</p>

<p>* lib/mkmf.rb (have_struct_member): accept compiler options.</p>

<p>* lib/mkmf.rb (convertible_int): add restricted support of struct 	 
member, and TYPEOF_ macro.</p>

<p>Sun Nov 13 23:21:24 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/gdbm/gdbm.c (fgdbm_reorganize): set close-on-exec flag after 	 
gdbm_reorganize().  gdbm_reorganize() opens a new database internally.</p>

<p>Sun Nov 13 19:57:18 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: rollback for each headers for each libraries.</p>

<p>Sun Nov 13 16:24:48 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: treat libc as a choice for a library which 	 
provide ndbm API.</p>

<p>Sun Nov 13 15:40:43 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: duplicate $libs and $defs when save them.</p>

<p>Sun Nov 13 12:43:48 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: rollback $libs and $defs when db detection is 	 
failed.  It fixes -lgdbm -lqdbm when the system has qdbm and gdbm 	 
without gdbm_compat.</p>

<p>Sat Nov 12 21:14:51 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/webrick/test_cgi.rb (class TestWEBrickCGI): respect 	  <a
href=""LIBPATHENV"">RbConfig::CONFIG</a>. [Bug #5135] [ruby-core:38653] 	*
test/webrick/test_filehandler.rb (class WEBrick): ditto.</p>

<p>Sat Nov 12 20:57:29 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (test_fcntl_dupfd): skip if Fcntl::DUPFD 	  is not
defined. Pointed out by CHIKANAGA Tomoyuki. Thanks.</p>

<p>Sat Nov 12 17:26:10 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (do_ioctl, ioctl_narg_len, setup_narg, rb_ioctl): use 	 
ioctl_req_t.</p>

<p>Sat Nov 12 17:01:49 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dbm/extconf.rb (headers.db_check): reduce duplicated code.</p>

<p>Sat Nov 12 15:59:42 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: dbm_clearerr should be available in all ndbm 	 
implementation.  If it is not available, it is caused by 	  header/library
mismatch such that Berkeley DB header &amp; gdbm library.</p>

<p>* ext/dbm/dbm.c (fdbm_store): use dbm_clearerr() unconditionally. 	  gdbm
1.9 provides it as a real function instead of a empty macro.</p>

<p>Sat Nov 12 13:35:33 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* bootstraptest/runner.rb: don&#39;t suppress SIGINT. 	  [Feature #5612]
[ruby-dev:44856]</p>

<p>Sat Nov 12 11:20:36 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (fcntl_narg_len): introduce narg calculation for fcntl instead 	 
of hard coded 256. 	* io.c (setup_narg): ditto.</p>

<p>Sat Nov 12 11:19:35 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (test_fcntl_dupfd): add another fcntl test.</p>

<p>Sat Nov 12 11:18:17 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/ruby/test_io.rb (test_fcntl_lock_freebsd): add a testcase 	  of
fcntl lock for freebsd.</p>

<p>Sat Nov 12 11:16:32 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (ioctl_narg_len): Linux doesn&#39;t have IOCPARM_LEN macro, but 	 
has _IOC_SIZE. support it.</p>

<p>Sat Nov 12 11:13:18 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (rb_ioctl): don&#39;t expose our sanity check value to ruby script.
	  It may change string value meaning if the value is string. 	  (e.g.
MacOS X has F_GETPATH ioctl) 	* io.c (rb_fcntl): ditto.</p>

<p>Sat Nov 12 11:06:02 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (ioctl_req_t): Type of req argument of ioctl() depend on platform.
	  Moreover almost all linux ioctl can&#39;t be represented by 32bit
integer 	  (i.e. MSB is 1). We need wrap ioctl argument type. 	  [Bug
#5429] [ruby-dev:44589] 	* io.c (struct ioctl_arg): ditto. 	* io.c
(rb_ioctl): ditto. 	* test/ruby/test_io.rb (test_ioctl_linux): add a
testcase for ioctl</p>

<p>Sat Nov 12 11:00:42 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (struct io_cntl_arg): remove io_p member. 	* io.c (nogvl_fcntl,
do_fcntl, rb_fcntl): separated from ioctl functions. 	* io.c
(nogvl_io_cntl): remove fcntl depended logic. 	* io.c (io_cntl): ditto. 	*
io.c (rb_io_ctl): ditto. 	* io.c (rb_io_ioctl): ditto.</p>

<p>Sat Nov 12 10:59:49 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (setup_narg): fix off by one bug.</p>

<p>Sat Nov 12 10:56:43 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (+setup_narg): factor out length calculation logic. 	* io.c
(rb_io_ctl): ditto.</p>

<p>Sat Nov 12 10:52:17 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (+ioctl_narg_len) new helper function. 	* io.c (rb_io_ctl):
don&#39;t use ioctl specific length check 	  if caller is fcntl.</p>

<p>Fri Nov 11 23:00:46 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: db_prefix is not required now.</p>

<p>Fri Nov 11 21:13:30 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/gdbm/gdbm.c (fgdbm_initialize): use GDBM_CLOEXEC if available.</p>

<p>Fri Nov 11 21:00:05 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: fix dbm_pagfno and dbm_dirfno detection with 	 
Berkeley DB.  Macro definitions needs arguments to detect correctly. 	 
SIZEOF_DSIZE needs -DDB_DBM_HSEARCH because db.h defines datum type 	  only
if DB_DBM_HSEARCH is defined.</p>

<p>Fri Nov 11 18:41:57 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (proc_seteuid): separate an internal wrapper function 	  from
the method implementation.</p>

<p>Fri Nov 11 17:21:15 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (have_library, find_library, have_func): allow 	  arguments
of function to be checked.</p>

<p>Fri Nov 11 17:09:45 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_dump.c (HAVE_BACKTRACE): fallback to 0.</p>

<p>* vm_dump.c (rb_vm_bugreport): show “Other runtime information” 	  header
only when available.</p>

<p>* vm_dump.c (rb_vm_bugreport): get rid of modifying the content of 	  VM
directly.</p>

<p>* vm_dump.c (rb_vm_bugreport): check if vm is non-null. 	  Pointed out by
Ikegami Daisuke &lt;ikegami.da@gmail.com&gt;. 	  Thank you.</p>

<p>Fri Nov 11 12:36:37 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* io.c (pipe_open): Remove fflush(stdin). it&#39;s no effect. 	  Pointed
out by Ikegami Daisuke &lt;ikegami.da@gmail.com&gt;. 	  Thank you.</p>

<p>Fri Nov 11 07:33:30 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb (Net::HTTP::SSL_ATTRIBUTES):  Use symbol keys instead 	 
of string keys to avoid duplicating parameters in 	 
OpenSSL::SSL:SSLContext#set_params.</p>

<p>Thu Nov 10 15:02:37 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (have_library, have_func, have_var, have_header): 	  add
compiler option parameter.</p>

<p>Thu Nov 10 07:45:16 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/lib/openssl/ssl.rb (class OpenSSL::SSL::SSLContext): 	 
Document #set_params.</p>

<p>Wed Nov  9 11:36:53 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (gvl_yield): don&#39;t prevent concurrent
sched_yield(). 	  [Bug #5130] [ruby-core:38647]</p>

<p>Wed Nov  9 23:20:22 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_update_max_fd): fstat(2) can fail with other than 	  EBADF. 
[ruby-dev:44837] [Bug #5593].  Cf. 	  <a
href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/fstat.html">pubs.opengroup.org/onlinepubs/9699919799/functions/fstat.html</a></p>

<p>* io.c (rb_sysopen): max fd is updated in rb_sysopen_internal() 	 
already.</p>

<p>Wed Nov  9 22:13:38 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_file.rb (TestFile#test_utime_with_minus_time_segv): 	 
fixed previous commit.</p>

<p>Wed Nov  9 19:53:45 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_file.rb (TestFile#test_utime_with_minus_time_segv): 	 
add test for r33685.</p>

<p>Wed Nov  9 19:00:44 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_fiber.rb: add tests for r33684 (Fiber#resume).</p>

<p>Wed Nov  9 16:40:49 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (unixtime_to_filetime): should check the return value 	 
of localtime().  reported by snowjail at gmail.com. 	  [ruby-dev:44838]
[Bug #5596]</p>

<p>Thu Nov  9 13:17:25 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* cont.c (rb_fiber_m_transfer, rb_fiber_resume): prohibit using 	 
“resume” after “transfer” method are used.  You should not mix 	  “resume”
fiber and “transfer” fiber. 	  [Bug #5526]</p>

<p>* NEWS: add information about this change.</p>

<p>Wed Nov  9 11:40:37 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* template/Doxyfile.tmpl (INCLUDE_PATH): add srcdir and include. 	 
[ruby-core:40843] [Bug #5597]</p>

<p>Wed Nov  9 11:02:54 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (do_select): fix cast, tv_sec is time_t.</p>

<p>Wed Nov  9 10:32:20 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: should not use test -e for portability. 	 
[ruby-core:40841] [Bug #5594]</p>

<p>Wed Nov  9 04:52:16 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/tree_builder.rb: dump complex numbers, 	  rationals,
etc with reference ids. 	* ext/psych/lib/psych/visitors/yaml_tree.rb: ditto
	* ext/psych/lib/psych/visitors/to_ruby.rb: loading complex numbers, 	 
rationals, etc with reference ids. 	* test/psych/test_object_references.rb:
corresponding tests</p>

<p>Tue Nov  8 23:34:37 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dbm/dbm.c (fdbm_fetch, fdbm_key, fdbm_delete, fdbm_store) 	 
(fdbm_has_key, fdbm_has_value): get rid of overflow.</p>

<p>* ext/gdbm/gdbm.c (rb_gdbm_fetch2, rb_gdbm_nextkey) 	  (rb_gdbm_delete,
fgdbm_store, fgdbm_has_key): ditto.</p>

<p>* ext/dbm/dbm.c (fdbm_delete_if): hide intermediate objects.</p>

<p>* ext/gdbm/gdbm.c (fgdbm_delete_if): ditto.</p>

<p>* ext/dbm/extconf.rb: check size of datum.dsize to get rid of 	  overflow.</p>

<p>Tue Nov  8 23:30:21 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* addr2line.c (PATH_MAX): define if not defined. [ruby-core:40840]</p>

<p>Tue Nov  8 23:26:49 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/tk/tcltklib.c (rb_thread_critical): fix type.</p>

<p>* ext/tk/tcltklib.c (eventloop_sleep, lib_eventloop_core): int is 	 
enough for micro seconds.  may need to check overflow in the 	  setter
though.</p>

<p>* ext/tk/tcltklib.c (RSTRING_LENINT): check overflow if necessary.</p>

<p>* ext/tk/tcltklib.c (RbTk_ALLOC_N): wrapper for ckalloc() which 	  takes
an int.</p>

<p>* ext/tk/tcltklib.c (ip_ruby_cmd_receiver_get, tcltklib_compile_info): 	 
get rid overflow.</p>

<p>* ext/tk/tcltklib.c (tcltklib_compile_info): constified.</p>

<p>Tue Nov  8 20:50:45 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/dbm/test_dbm.rb: split tests for read only database.</p>

<p>* test/gdbm/test_gdbm.rb: ditto.</p>

<p>Tue Nov  8 18:59:07 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/pty/pty.c (MasterDevice): define only when used. 	  (SlaveDevice):
ditto. 	  (deviceNo): ditto.</p>

<p>Tue Nov  8 17:59:24 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_long2int): define as a macro always, so 	  that
cpp conditionals can tell if it is provided.</p>

<p>Tue Nov  8 17:30:50 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (cpp_command): remove multiple -arch flags since cpp 	 
cannot work.</p>

<p>Tue Nov  8 14:50:55 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (io_fwrite): call rb_w32_write_console() only if FMODE_TTY is 	 
set.  this is the one of the reason of IO writing slowness of Windows 	  in
1.9.3 or later.</p>

<p>Tue Nov  8 11:01:04 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/pty/pty.c (get_device_once): FreeBSD 8 supported O_CLOEXEC flag 	 
for posix_openpt, but FreeBSD 9&#39;s posix_openpt doesn&#39;t support 	 
O_CLOEXEC and fails if specified.</p>

<p>Tue Nov  8 02:36:45 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/encoding.h (ECONV_NEWLINE_DECORATOR_READ_MASK, 	 
ECONV_NEWLINE_DECORATOR_WRITE_MASK): new macro.</p>

<p>* io.c (rb_io_extract_modeenc, pipe_open, prep_stdio, argf_next_argv): 	 
set TEXTMODE_NEWLINE_DECORATOR_ON_WRITE for textmode on creating IO 	  if
the flag is available.</p>

<p>* io.c (make_writeconv): drop decorators for reading.</p>

<p>* io.c (make_readconv): drop decorators for writing.</p>

<p>* io.c (do_writeconv): existing writeconv is not the condition to raise 	 
ArgumentError.  should check textmode or not.</p>

<p>* test/ruby/test_io_m17n.rb 	 
(TestIO_M17N#test_<code>cr,lf,crlf</code>_decorator_on_stdout): test above 	  changes.</p>

<p>Mon Nov  7 22:03:47 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/gdbm/gdbm.c (fgdbm_initialize): set close-on-exec flag.</p>

<p>Mon Nov  7 20:31:52 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: make sure strings that look 	 
like base 60 numbers are serialized as quoted strings. 	*
test/psych/test_string.rb: test for change.</p>

<p>Mon Nov  7 20:26:37 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* test/psych/test_yamlstore.rb: make test case inherit from MiniTest, 	 
load psych/helper so that psych is loaded.</p>

<p>Mon Nov  7 20:18:29 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* test/psych/test_yamldbm.rb: Test case should inherit from MiniTest, 	 
load psych/helper so that psych and friends are loaded.</p>

<p>Mon Nov  7 20:15:44 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/extconf.rb: check dbm_pagfno() and dbm_dirfno().</p>

<p>* ext/dbm/dbm.c: use above to set close-on-exec flag.</p>

<p>Mon Nov  7 20:05:16 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (io_fflush): remove fsync().</p>

<p>* io.c (rb_io_flush, rb_io_rewind): fsync() here.</p>

<p>these changes reduces fsync() calls to improve performance. 	first
reported at [ruby-list:48515] by ak7 at mail.goo.ne.jp . 	[Bug #5585]</p>

<p>Mon Nov  7 19:43:10 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_close_before_exec): use F_MAXFD if available. 	  F_MAXFD is
available on NetBSD since NetBSD 2.0.</p>

<p>Mon Nov  7 19:25:16 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io_m17n.rb 	 
(TestIO_M17N#test_default_stdout_stderr_mode): new test for 	 
r33627-33629.  see [backport #5565]</p>

<p>Mon Nov  7 01:14:22 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/debug.rb: add help for &#39;pp&#39; and &#39;<a
href="estart">r</a>&#39;. patch 	  from Sho Hashimoto. [Bug #5093]
[ruby-dev:44222]</p>

<p>Sun Nov  6 14:49:58 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/rubysocket.h (rsock_recvmsg): declared.</p>

<p>* ext/socket/ancdata.c (rsock_recvmsg): extracted from 	 
nogvl_recvmsg_func. 	  (nogvl_recvmsg_func): use rsock_recvmsg.</p>

<p>* ext/socket/unixsocket.c (recvmsg_blocking): use rsock_recvmsg.</p>

<p>Sun Nov  6 03:22:36 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_engine.rb: add test for engine cipher. RC4 is used 	 
because AES is not supported by the “openssl” engine currently.</p>

<p>Sun Nov  6 00:11:52 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/test/unit.rb (Test::Unit::Options#non_options): <a
href=":ruby">options</a> 	  should be an array.  This fixes 	  “./ruby
test/runner.rb test/testunit/test_parallel.rb” 	  [ruby-dev:44782]</p>

<p>Sat Nov  5 20:30:30 2011  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* insns.def: Some fixes and tweaks to English explanations</p>

<p>Sat Nov  5 19:11:50 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_cloexec_fcntl_dupfd): don&#39;t clear try_dupfd_cloexec if 	 
fcntl(F_DUPFD) failed as fcntl(F_DUPFD_CLOEXEC).</p>

<p>Sat Nov  5 18:05:12 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/socket.c (rsock_socketpair0): refactored.</p>

<p>Sat Nov  5 17:55:52 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/init.c (rsock_socket0): don&#39;t clear try_sock_cloexec if 	
SOCK_CLOEXEC is not a reason for EINVAL.</p>

<p>Sat Nov  5 16:27:52 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* ext/pathname/lib/pathname.rb, ext/tk/lib/multi-tk.rb, 	 
ext/tk/sample/demos-en/widget, lib/benchmark.rb, lib/irb/cmd/fork.rb, 	 
lib/mkmf.rb, lib/net/ftp.rb, lib/net/smtp.rb, lib/open3.rb, 	 
lib/pstore.rb, lib/rexml/element.rb, lib/rexml/light/node.rb, 	 
lib/rinda/tuplespace.rb, lib/rss/maker/base.rb, 	  lib/rss/maker/entry.rb,
lib/scanf.rb, lib/set.rb, lib/shell.rb, 	  lib/shell/command-processor.rb,
lib/shell/process-controller.rb, 	  lib/shell/system-command.rb,
lib/uri/common.rb: remove unused block 	  arguments to avoid creating Proc
objects.</p>

<p>Sat Nov  5 15:45:04 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/init.c (rsock_socket0): extract single socket() call with 	 
CLOEXEC handling from rsock_socket.</p>

<p>Sat Nov  5 13:49:40 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* lib/pathname.rb (Pathname#find): return an enumerator if 	  no block is
given.</p>

<p>* test/pathname/test_pathname.rb: add tests for above.</p>

<p>[ruby-dev:44797] [Feature #5572]</p>

<p>Sat Nov  5 11:18:12 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/socket.c (rsock_socketpair0): don&#39;t clear 	 
try_sock_cloexec if SOCK_CLOEXEC is not a reason for EINVAL.</p>

<p>Fri Nov  4 14:08:19 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_pkey_rsa.c (rsa_generate): [SECURITY] Set RSA 	 
exponent value correctly.  Awful bug.  This bug caused exponent of 	 
generated key to be always &#39;1&#39;.  By default, and regardless of e 	 
given as a parameter.</p>

<p>!!! Keys generated by this code (trunk after 2011-09-01) must be 	 
re-generated !!! (ruby_1_9_3 is safe)</p>

<p>* test/openssl/test_pkey_rsa.rb: Add tests for default exponent and 	 
specifying exponent by a parameter.</p>

<p>Fri Nov  4 01:31:25 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_engine.rb: add first tests for builtin “openssl” 	 
engine.</p>

<p>Fri Nov  4 08:41:26 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/extconf.rb: 	* ext/openssl/ossl_engine.c: add some missing
OpenSSL engines. 	  Thanks, Yui Naruse, for providing the patch! 	  [Bug
#5548] [ruby-core:40670]</p>

<p>Fri Nov  4 04:54:10 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/configure.bat: disable delayed expansion of enironment variable. 	
[Bug #5517] [ruby-core:40531]</p>

<p>Fri Nov  4 03:45:22 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (make_writeconv): fixed typo of previous commit.</p>

<p>Fri Nov  4 01:56:30 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (make_writeconv): unversal_newline converter is for reading. 	  so,
if the io is text mode and has ECONV_UNIVERSAL_NEWLINE_DECORATOR 	  flag,
use crlf_newline converter for writing. 	  this change fixes the problem
about the luck of CR up Kernel.p and 	  Kernel.puts to stdout/stderr on
Windows.</p>

<p>Fri Nov  4 01:04:48 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (Init_readline): like r18313, libedit&#39;s 	 
replace_history_entry may use offset instead of which. 	  so introduce
history_replace_offset_func and initialize it.</p>

<p>* ext/readline/readline.c (hist_set): use history_replace_offset_func.</p>

<p>Fri Nov  4 00:53:35 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/readline/readline.c (Init_readline): fix wrong condition.</p>

<p>Thu Nov  3 23:53:04 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* encoding.c (rb_locale_charmap): ignore calling nl_langinfo_codeset() 	 
on Windows except cygwin. [experimental]</p>

<p>Thu Nov  3 22:45:09 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/socket.c (rsock_socketpair0): extracted from 	 
rsock_socketpair to set close-on-exec flag for each socketpair() 	  call.</p>

<p>Thu Nov  3 22:12:41 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* ext/socket/init.c (rsock_socket): set close-on-exec flag when 	 
SOCK_CLOEXEC is not available.</p>

<p>Thu Nov  3 08:36:00 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_engine.rb: call Engine::cleanup on exit. 	  Patch
provided by Yui Naruse, thanks! 	  [Bug #5547] [ruby-core:40669]</p>

<p>Wed Nov  2 21:36:00 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* complex.c (nucomp_rationalize): fix function.  [ruby-core:40667] 	  [Bug
#5546]</p>

<p>Wed Nov  2 08:16:45 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/webrick/utils.rb: fix fcntl call.</p>

<p>* lib/drb/unix.rb: ditto.</p>

<p>Wed Nov  2 00:43:59 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/psych/test_yamldbm.rb: avoid platform dependency. 	  patch by
Naohisa Goto. [ruby-dev:44763] [Bug #5535] 	* test/syck/test_yamldbm.rb:
ditto.</p>

<p>Wed Nov  2 00:14:15 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* test/ruby/test_marshal.rb: renamed methods duplicated with those 	  of
marshaltestlib.rb.</p>

<p>Tue Nov  1 22:08:27 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: reject llvm-gcc.</p>

<p>Tue Nov  1 21:39:00 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (rb_cloexec_pipe): remove workaround of r33587. 	  The bug of
NetBSD is fixed on Mon Oct 31 21:31:29 UTC 2011. 	  <a
href="http://gnats.netbsd.org/cgi-bin/query-pr-single.pl?number=45545">gnats.netbsd.org/cgi-bin/query-pr-single.pl?number=45545</a></p>

<p>Tue Nov  1 19:49:08 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_io_reopen): call rb_fd_fix_cloexec instead of 	 
rb_maygvl_fd_fix_cloexec.</p>

<p>Tue Nov  1 19:00:30 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_io_reopen): call rb_maygvl_fd_fix_cloexec after freopen().</p>

<p>Tue Nov  1 17:17:26 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* file.c (file_expand_path): reset coderange after expanding path.</p>

<p>Tue Nov  1 14:55:29 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (nogvl_io_cntl): rb_cloexec_fcntl_dupfd&#39;s 2nd argument is int.</p>

<p>* process.c (move_fds_to_avoid_crash): ditto.</p>

<p>Tue Nov  1 13:14:33 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vsnprintf.c (BSD_vfprintf): support &#39;ll&#39; prefix.</p>

<p>* vsnprintf.c (__sfeof): rename to avoid the collision with NetBSD&#39;s 	
one.</p>

<p>* vsnprintf.c (__sferror): ditto.</p>

<p>* vsnprintf.c (__sclearerr): ditto.</p>

<p>* vsnprintf.c (__sfileno): ditto.</p>

<p>Tue Nov  1 12:36:16 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* internal.h (rb_maygvl_fd_fix_cloexec): change the visibility for 	 
ext/socket.</p>

<p>Tue Nov  1 12:00:53 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_maygvl_fd_fix_cloexec): renamed from fd_set_cloexec.</p>

<p>* internal.h (rb_maygvl_fd_fix_cloexec): declared.</p>

<p>* ext/socket/init.c (cloexec_accept): use rb_maygvl_fd_fix_cloexec. 	 
(rsock_s_accept_nonblock): use rb_update_max_fd. 	  (rsock_s_accept): use
rb_update_max_fd.</p>

<p>Tue Nov  1 08:24:40 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/init.c (cloexec_accept): new function to use accept4 if 	 
available. 	  (rsock_s_accept_nonblock): use cloexec_accept. 	 
(accept_blocking): ditto.</p>

<p>* ext/socket/extconf.rb: check accept4.</p>

<p>Tue Nov  1 07:31:55 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/ancdata.c (nogvl_recvmsg_func): use MSG_CMSG_CLOEXEC if 	 
available.</p>

<p>* ext/socket/unixsocket.c (recvmsg_blocking): ditto.</p>

<p>Tue Nov  1 05:59:41 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/socket.c (rsock_socketpair): use SOCK_CLOEXEC if 	 
available.</p>

<p>Tue Nov  1 02:56:17 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ruby.c (load_file_internal): convert the encoding of load path if 	 
needed by platform.  calling open() was replaced by rb_cloexec_open() 	  at
r33549, but the function expected UTF-8 pathname on Windows. 	  (open()
expected “locale” pathname.) 	  reported by taco via IRC.</p>

<p>* ruby.c (load_file): change the type of the 2nd parameter to pass its 	 
encoding to load_file_internal().</p>

<p>* ruby.c (process_options, rb_load_file): follow above change. 	  NOTE: we
should pass encoding information to rb_load_file().</p>

<p>Mon Oct 31 23:49:38 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/socket.c (rsock_socketpair): extracted from 	 
rsock_sock_s_socketpair.</p>

<p>Mon Oct 31 23:31:53 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/init.c (rsock_socket): use SOCK_CLOEXEC if available.</p>

<p>Mon Oct 31 21:47:44 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (rb_cloexec_pipe): NetBSD 6.0 will support pipe2(2), 	  but its
return value is -1 or larger than 0.</p>

<p>Mon Oct 31 22:04:54 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/dbm/dbm.c (fdbm_initialize): use O_CLOEXEC if available.</p>

<p>Mon Oct 31 21:47:48 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_fd_fix_cloexec): renamed from 	 
rb_fd_set_cloexec.</p>

<p>* io.c: follow the above renaming.</p>

<p>* ext/pty/pty.c: ditto.</p>

<p>* ext/socket/init.c: ditto.</p>

<p>* ext/socket/socket.c: ditto.</p>

<p>* ext/socket/ancdata.c: ditto.</p>

<p>* ext/socket/unixsocket.c: ditto.</p>

<p>Mon Oct 31 21:02:43 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb (Resolv::DNS): retry IO.select for premature wakeup.</p>

<p>Mon Oct 31 20:14:22 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (fd_set_cloexec): clear CLOEXEC flag for standard file 	 
descriptors. 	  (rb_cloexec_dup): use rb_cloexec_fcntl_dupfd. 	 
(rb_cloexec_fcntl_dupfd): use F_DUPFD_CLOEXEC if available.</p>

<p>Mon Oct 31 19:14:11 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/resolv/test_dns.rb: don&#39;t check maximum slept time. 	  ruby
doesn&#39;t guarantee the maximum time because it is not a 	  realtime
application.</p>

<p>Mon Oct 31 13:10:06 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (setfl): extract from fcntl().</p>

<p>* win32/win32.c (dupfd): new function to support F_DUPFD. based on a 	 
patch written by akr.</p>

<p>* win32/win32.c (fcntl): use above functions.</p>

<p>* include/ruby/win32.h (F_DUPFD): define. [experimental]</p>

<p>* include/ruby/win32.h (F_SETFL): change the value to correspond with 	 
other platforms.</p>

<p>Mon Oct 31 12:37:50 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/pty/pty.c (get_device_once): use O_CLOEXEC for posix_openpt if 	 
available.</p>

<p>Mon Oct 31 12:05:24 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_cloexec_dup2): check oldfd == newfd at first. 	  pointed by
KOSAKI Motohiro.  [ruby-dev:44713]</p>

<p>Mon Oct 31 10:50:26 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* io.c (rb_cloexec_fcntl_dupfd): this function needs F_DUPFD.</p>

<p>* io.c (nogvl_io_cntl): use rb_cloexec_fcntl_dupfd() only if the 	 
platform has F_DUPFD.</p>

<p>Mon Oct 31 00:50:00 2011  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* configure.in: check -fno-omit-frame-pointer acceptance and usage 	 
under MinGW. [ruby-core:39957] [Bug #5407]</p>

<p>Mon Oct 31 00:16:11 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_cloexec_fcntl_dupfd): declared.</p>

<p>* io.c (rb_cloexec_fcntl_dupfd): new function. 	  (nogvl_io_cntl): use
rb_cloexec_fcntl_dupfd.</p>

<p>* process.c (move_fds_to_avoid_crash): use rb_cloexec_fcntl_dupfd.</p>

<p>Sun Oct 30 22:46:46 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: check pipe2.</p>

<p>* io.c (rb_cloexec_pipe): use pipe2 if available.</p>

<p>Sun Oct 30 22:32:44 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ruby.c (fill_standard_fds): use fstat() instead of fcntl(F_GETFD) 	  for
MinGW.  reported by Luis Lavena.  [ruby-core:40526] [Bug #5516]</p>

<p>Sun Oct 30 21:12:47 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_cloexec_pipe): declared.</p>

<p>* io.c (rb_cloexec_pipe): new function. 	  (rb_pipe): use rb_cloexec_pipe.</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): use 	 
rb_cloexec_pipe.</p>

<p>Sun Oct 30 20:06:07 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_cloexec_dup): refine control flow. 	  (rb_cloexec_dup2): ditto.</p>

<p>Sun Oct 30 18:45:50 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ruby.c (fill_standard_fds): new function to open closed standard 	  file
descriptors. 	  (ruby_sysinit): call fill_standard_fds.</p>

<p>Sun Oct 30 10:50:36 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (install_recursive, bin-comm): split mere 	  string
not path name.  [ruby-core:40462] [Bug #5492]</p>

<p>Sun Oct 30 10:47:20 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_cloexec_dup, rb_cloexec_dup2): CLOEXEC has been set if 	  dup3
succeeded.</p>

<p>Sun Oct 30 09:58:48 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_cloexec_dup): don&#39;t allocate standard file descriptors.</p>

<p>Sun Oct 30 08:29:51 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_cloexec_dup2): don&#39;t set CLOEXEC for standard file 	 
descriptors.</p>

<p>Sun Oct 30 07:47:10 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* configure.in: check dup3.</p>

<p>* io.c (rb_cloexec_dup2): use dup3 if available.</p>

<p>Sat Oct 29 22:06:37 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_cloexec_dup2): declared.</p>

<p>* io.c (rb_cloexec_dup2): new function. 	  (io_reopen): use
rb_cloexec_dup2.</p>

<p>Sat Oct 20 21:08:18 2011  Tajima Akio &lt;artonx@yahoo.co.jp&gt;</p>

<p>* win32/Makefile.sub (CONFIG_H): have stdint.h if VC2010. 	  [Bug #5243]</p>

<p>Sat Oct 29 20:59:08 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_cloexec_dup): use F_DUPFD_CLOEXEC if available.</p>

<p>Sat Oct 29 20:00:26 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_cloexec_dup): declared.</p>

<p>* io.c (rb_cloexec_dup): new function. 	  (ruby_dup): use rb_cloexec_dup.</p>

<p>* ext/pty/pty.c (pty_getpty): use rb_cloexec_dup.</p>

<p>* ext/openssl/ossl_bio.c (ossl_obj2bio): ditto.</p>

<p>Sat Oct 29 16:11:34 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/sdbm/_sdbm.c (sdbm_prep): use O_CLOEXEC if available.</p>

<p>Sat Oct 29 14:26:56 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_cloexec_open): use O_CLOEXEC if available.</p>

<p>Sat Oct 29 12:57:15 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* process.c (ruby_setsid): use rb_cloexec_open. 	  (rb_daemon): ditto.</p>

<p>* ruby.c (load_file_internal): ditto.</p>

<p>* file.c (rb_file_s_truncate): ditto. 	  (file_load_ok): ditto.</p>

<p>* random.c (fill_random_seed): ditto.</p>

<p>* ext/pty/pty.c (chfunc): ditto. 	  (get_device_once): ditto.</p>

<p>* ext/io/console/console.c (console_dev): ditto.</p>

<p>Sat Oct 29 10:40:19 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_cloexec_open): declared.</p>

<p>* io.c (fd_set_cloexec): extracted from rb_fd_set_cloexec. 	 
(rb_cloexec_open): new function. 	  (sysopen_func): use rb_cloexec_open. 	 
(rb_sysopen_internal): use rb_update_max_fd instead of 	 
rb_fd_set_cloexec.</p>

<p>Sat Oct 29 09:05:07 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread_pthread.h: no Structured Exception Handling like macros. 	 
[ruby-core:40432] [Bug #5491]</p>

<p>Fri Oct 28 22:05:34 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/sdbm/_sdbm.c: RCS $Id$ removed.</p>

<p>Thu Oct 27 18:58:00 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* parse.y (parser_nextc): set encoding for the buffer of ripper.</p>

<p>Fri Oct 28 06:06:08 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/sdbm/_sdbm.c (sdbm_prep): set FD_CLOEXEC flags for file 	 
descriptors. 	  (fd_set_cloexec): new function.</p>

<p>Fri Oct 28 03:01:27 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* vm_insnhelper.c (vm_call_cfunc): adding back useless hack.  For some 	 
reason, this fixes CFP errors on OS X 10.7.</p>

<p>Fri Oct 28 00:09:31 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/sdbm/_sdbm.c (sdbm_prep): refactored for less nesting.</p>

<p>Thu Oct 27 18:28:18 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_DEFINE_IF): revert r33534 partially to get 	  rid of
AS_ECHO which is not available in autoconf 2.61. 	  [ruby-dev:44702]</p>

<p>Thu Oct 27 16:10:46 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big_divide): raise ZeroDivisionError if divisor is 	  zero,
as well as Fixnum.  [ruby-core:40429] [Bug #5490]</p>

<p>Thu Oct 27 14:56:22 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_FUNC_ATTRIBUTE): unset temporary variable.</p>

<p>* configure.in (RUBY_STACK_GROW_DIRECTION): substitute CPU name as 	 
shell variable name.  based on the patch by The Written Word Inc. at 	 
[ruby-core:40421].  [Bug #5488]</p>

<p>Thu Oct 27 09:57:56 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (SIZE_MAX): define SIZE_MAX if not defined. 	 
patched by The Written Word Inc. [ruby-core:40422] [Bug #5489]</p>

<p>Thu Oct 27 08:47:38 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/psych/parser.c: remove unused variable.</p>

<p>Thu Oct 27 08:38:41 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/extconf.rb: add -Wall flag by default when compiler is 	 
GCC.</p>

<p>Wed Oct 26 15:24:25 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_file_join): honor input encodings than ASCII-8BIT. 	 
[ruby-core:40338] [Bug #5483]</p>

<p>Tue Oct 25 21:52:31 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/defines.h: use “__sparc” instead of “sparc” and 	 
“__sparc__”.</p>

<p>* dln.c: ditto.</p>

<p>[ruby-dev:44694]</p>

<p>Tue Oct 25 06:34:39 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* re.c (match_aref):  Use &lt;code&gt; around indexing examples to prevent
	  hyperlinks.  [ruby-talk:389396]</p>

<p>Mon Oct 24 23:55:31 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* complex.c: use “__sun” instead of “__sun__” to detect SunOS.</p>

<p>* math.c: ditto.</p>

<p>* hash.c: ditto.</p>

<p>* atomic.h: ditto.</p>

<p>* ext/io/wait/wait.c: ditto.</p>

<p>[ruby-dev:44693]</p>

<p>Mon Oct 24 22:45:37 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c: use “__sun” instead of “sun” to detect SunOS.</p>

<p>* dln.c: ditto.</p>

<p>* cont.c: ditto.</p>

<p>* ext/sdbm/_sdbm.c: ditto.</p>

<p>[ruby-dev:44693]</p>

<p>Mon Oct 24 22:38:08 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/pty/pty.c (get_device_once): delay rb_fd_set_cloexec() until 	 
grantpt() on Solaris.  grantpt() doesn&#39;t work with CLOEXEC on 	 
Solaris 10. 	  reported by Naohisa GOTO.  [ruby-dev:44688] [Bug #5475]</p>

<p>Mon Oct 24 08:18:14 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (copy_stream_fallback_body): check nil for EOF of read method. 	 
patch by Eric Wong.  [ruby-core:39134] [Bug #5237]</p>

<p>Sun Oct 23 18:21:23 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* ext/tk/MANUAL_tcltklib.eng: fix typo.</p>

<p>Sun Oct 23 18:03:31 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (rb_infinity, rb_nan): aggregated member initializers 	  need
braces.</p>

<p>Sun Oct 23 16:43:43 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/io/wait/wait.c: ioctl(2) is declared in unistd.h on Solaris.</p>

<p>Sun Oct 23 16:33:35 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/tk/MANUAL_tcltklib.eng: fix typo. reported by Mimura-san. 	 
[ruby-dev:44683] [Bug #5471]</p>

<p>Sun Oct 23 08:01:29 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_fd_set_cloexec): set close-on-exec flag only if F_GETFD is 	 
defined.  reported by Luis Lavena.  [ruby-core:40281] [Bug #5470]</p>

<p>Sat Oct 22 19:48:50 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/openssl/test_ssl.rb (test_multibyte_read_write): start server 	 
for each length to avoid race condition.</p>

<p>Sat Oct 22 18:49:24 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_fd_set_cloexec): declared.</p>

<p>* io.c (rb_fd_set_cloexec): new function. 	  (ruby_dup): call
rb_fd_set_cloexec to set close-on-exec flag. 	  (rb_sysopen_internal):
ditto. 	  (rb_pipe): ditto. 	  (io_reopen): ditto. 	  (io_cntl): ditto.</p>

<p>* process.c (rb_f_exec): change the default :close_others option to 	 
true. 	  (rb_f_system): ditto. 	  (move_fds_to_avoid_crash): call
rb_fd_set_cloexec to set 	  close-on-exec flag. 	  (ruby_setsid): ditto. 	 
(rb_daemon): ditto.</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): call 	 
rb_fd_set_cloexec to set close-on-exec flag.</p>

<p>* ruby.c (load_file_internal): ditto.</p>

<p>* file.c (rb_file_s_truncate): ditto. 	  (file_load_ok): ditto.</p>

<p>* random.c (fill_random_seed): ditto.</p>

<p>* ext/pty/pty.c (chfunc): ditto. 	  (get_device_once): ditto.</p>

<p>* ext/openssl/ossl_bio.c (ossl_obj2bio): ditto.</p>

<p>* ext/socket/init.c (rsock_socket): ditto. 	  (rsock_s_accept_nonblock):
ditto. 	  (rsock_s_accept): ditto.</p>

<p>* ext/socket/socket.c (rsock_sock_s_socketpair): ditto.</p>

<p>* ext/socket/ancdata.c (discard_cmsg): ditto. 	 
(make_io_for_unix_rights): ditto.</p>

<p>* ext/socket/unixsocket.c (unix_recv_io): ditto.</p>

<p>* ext/io/console/console.c (console_dev): ditto.</p>

<p>[ruby-core:38140] [Feature #5041]</p>

<p>Sat Oct 22 17:46:27 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb: fix a exception name in previous patch.</p>

<p>Sat Oct 22 17:43:33 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/resolv.rb: make timeout configurable for DNS query. 	  patch by Eric
Wong.  [ruby-core:38533] [Feature #5100]</p>

<p>Sat Oct 22 02:07:48 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* numeric.c (rb_infinity, rb_nan): use union to prevent bus error 	 
caused by misalignment.  [Bug #5469] [ruby-dev:44657]</p>

<p>* include/ruby/missing.h (INFINITY, NAN): ditto</p>

<p>Fri Oct 21 22:02:17 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (initial_params): pack in a struct.</p>

<p>* gc.c (rb_gc_set_params): set parameters always. 	  [ruby-dev:44648] [Bug
#5467]</p>

<p>Fri Oct 21 12:10:20 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* atomic.h: change Solaris checking macro because atomic_ops can work 	 
not only with Sun Studio but also with Fujitsu C Compiler.</p>

<p>Fri Oct 21 02:11:00 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ns_spki.c: Complete documentation. 	*
test/openssl/test_ns_spki.rb: Integrate SPKI#to_text.</p>

<p>Thu Oct 20 22:47:28 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (socklist_insert, socklist_lookup, socklist_delete): 	 
new functions to wrap of st_insert(), st_lookup() and st_delete() to 	 
socklist. 	  allocating socklist is deferred until it is really needed.</p>

<p>* win32/win32.c (exit_handler): delete socklist only if it is 	 
initialized.</p>

<p>* win32/win32.c (rb_w32_sysinit, StartSockets): refactoring: move 	 
initialization of select_mutex to StartSockets().</p>

<p>* win32/win32.c (exit_handler): refactoring: delete select_mutex only 	 
if winsock is used.</p>

<p>Thu Oct 20 22:38:53 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_pkcs5.c: add note on timing attacks and general 	 
documentation.</p>

<p>Thu Oct 20 21:19:15 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* vm_eval.c (check_funcall): set array elements one-by-one to fix 	 
compile error with Fujitsu C Compiler 5.6 on Solaris 10 on Sparc. 	  [Bug
#5464] [ruby-dev:44632]</p>

<p>Thu Oct 20 13:09:35 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/defines.h (flush_register_windows): use software 	  trap on
Debian Sparc 32-bit userspace.  [Bug #5244]</p>

<p>Thu Oct 20 12:28:22 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_pkcs5.rb: add RFC 6070 tests for PBKDF2 with 	 
HMAC-SHA1</p>

<p>Thu Oct 20 11:42:23 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (mmprepare): fix for fragmental size.</p>

<p>* util.c (mmswap_, mmrot3_): portability improvement.</p>

<p>Thu Oct 20 05:58:02 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl_ns_spki.c (Init_ossl_ns_spki):  Stub documentation 	 
for Netscape SPKI.</p>

<p>Thu Oct 20 05:13:39 2011  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 2.6.2 (r6712) 	* test/minitest/*:
ditto</p>

<p>Thu Oct 20 06:55:32 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* lib/openssl/buffering.rb: Force multi-byte strings to be treated as 	 
binary data. 	* test/openssl/test_ssl.rb: Add test for it.</p>

<p>Thanks to Niklas Baumstark for reporting the issue!</p>

<p>[Ruby 1.9 - Bug #5233] [ruby-core:39120]</p>

<p>Wed Oct 19 17:06:54 2011  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* version.h (RUBY_VERSION): finally declare start of 2.0 work!</p>

<p>Wed Oct 19 11:48:44 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* error.c (Init_Exception):  Document $! and $@.  Provide 	 
recommendations for creating exceptions for a library.</p>

<p>Wed Oct 19 11:25:46 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* error.c (Init_Exception):  Add hierarchy of Exception subclasses. 	 
Based on patch by Sylvain Daubert.  [Ruby 1.9 - Bug #5438]</p>

<p>Wed Oct 19 11:04:47 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enum.c: Reformat block args to a single standard, { |args| … }. 	  Patch
by b t.  [Ruby 1.9 - Bug #5393]</p>

<p>Wed Oct 19 12:11:26 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Remove set, but unused variables. 	 
ext/openssl/ossl_pkey.c: ditto</p>

<p>* ext/openssl/ossl_pkey_dh.c: Make functions passed to 	 
rb_thread_blocking_region return VALUE instead of void. 	 
ext/openssl/ossl_pkey_dsa.c: ditto 	  ext/openssl/ossl_pkey_rsa.c: ditto</p>

<p>Tue Oct 18 23:28:53 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (identhash): share with type_numhash.</p>

<p>* st.c (st_hashtype_num): rename from type_numhash.</p>

<p>Tue Oct 18 23:07:30 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_core.h (ruby_current_thread): probeprofiler has been removed 	  long
ago.</p>

<p>Tue Oct 18 23:05:49 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/ripper/eventids2.c (ripper_init_eventids2): separate 	 
initializations of IDs and objects.</p>

<p>* ext/ripper/tools/generate.rb (generate_eventids1): ditto.</p>

<p>* parse.y (Init_ripper, InitVM_ripper): fix inversed roles.</p>

<p>Sun Oct 16 19:46:16 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.gemspec (files): fixed typo, and 	  removed
nonexistent file.</p>

<p>* ext/bigdecimal/bigdecimal.gemspec (homepage): added.</p>

<p>* ext/io/console/io-console.gemspec (homepage): ditto.</p>

<p>Fri Oct 14 12:13:57 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/pty/pty.c (pty_check): should return nil until the child 	 
terminates or stops.  [ruby-dev:44600] [Bug #2642]</p>

<p>Fri Oct 14 11:19:37 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/intern.h (rb_ary_rotate): export.</p>

<p>Fri Oct 14 05:58:05 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* atomic.h (ATOMIC_INC, ATOMIC_DEC): return old values. 	 
[ruby-dev:44596] [Bug #5439]</p>

<p>* signal.c (ruby_atomic_exchange): no needs to define on the 	  platforms
where atomic.h is available.</p>

<p>Thu Oct 13 19:29:40 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* atomic.h (ATOMIC_*): use atomic_ops(3C) when SunStudio on Solaris. 	 
[ruby-dev:44596] [Bug #5439]</p>

<p>Thu Oct 13 18:13:04 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* atomic.h(ATOMIC_SET): add cast to void to prevent misuse. 	 
[ruby-dev:44596] [Bug #5439]</p>

<p>Thu Oct 13 18:04:27 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (rb_gc_finalize_deferred, rb_objspace_call_finalizer): 	  should
use ATOMIC_EXCHANGE() to check the previous value. 	  [ruby-dev:44596] [Bug
#5439]</p>

<p>Wed Oct 12 23:39:58 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* test/openssl/test_ssl.rb: Move duplicated tests for SSL::Session to 	 
test_ssl_session.rb</p>

<p>Tue Oct 11 08:49:40 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c (rb_ary_initialize):  Improve explanation of Array.new 	 
parameters.  Patch by Alvaro Pereyra Rabanal.  [Ruby 1.9 - Bug #5425] 	*
array.c (rb_ary_s_try_convert):  Fix typo (try =&gt; tries) 	* array.c
(rb_ary_rindex):  Add spacing for block. 	* array.c (rb_ary_uniq_bang): 
Describe block 	* array.c (rb_ary_uniq):  ditto</p>

<p>Tue Oct 11 07:55:38 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c:  Add a description to Array, minor cleanups.  Patch by 	 
Andrea Singh.  [Ruby 1.9 - Bug #5412]</p>

<p>Tue Oct 11 06:09:52 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/pp.rb:  Move PP documentation to top of class PP.  Patch by 	 
Sylvain Daubert.  [Ruby 1.9 - Bug #5430]</p>

<p>Tue Oct 11 06:06:29 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/coverage/coverage.c (Init_coverage):  Change list format and 	 
describe Coverage.result output.  Patch by Sylvain Daubert. 	  [Ruby 1.9 -
Bug #5428]</p>

<p>Tue Oct 11 05:53:23 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c (Init_Object):  Add reference to BasicObject, brief 	 
explanation of constant lookup.  Based on patch by Alvaro Pereyra 	 
Rabanal. 	  [Ruby 1.9 - Bug #5426]</p>

<p>Sun Oct  9 11:06:52 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* test/psych/test_yamldbm.rb: don&#39;t run test if the system 	 
don&#39;t support yaml/dbm.</p>

<p>* test/syck/test_yamldbm.rb: ditto.</p>

<p>Sat Oct  8 08:54:56 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enum.c (group_by):  Improve group_by description.  Patch by b t. 	 
[#5411]</p>

<p>Sat Oct  8 03:17:51 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/shell.rb:  Document some methods of Shell.  Patch by Carol 	 
Nichols.  [Ruby 1.9 - Bug #5417]</p>

<p>Fri Oct  7 17:54:28 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/test/unit/assertions.rb (assert_send, assert_not_send): 	 
parenthesize non-empty arguments.</p>

<p>Fri Oct  7 06:35:50 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c:  Use + for arguments described in documentation to allow 	 
rdoc -C2 to work better.  Remove &lt;code&gt; from method references to 	 
allow cross-references in HTML documentation.</p>

<p>Thu Oct  6 18:46:23 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* vm_eval.c (make_no_method_exception): fix typo.</p>

<p>* vm_insnhelper.c, vm_insnhelper.h: ditto.</p>

<p>Thu Oct  6 16:29:30 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (make_no_method_execption): extract from 	 
raise_method_missing().</p>

<p>* vm_eval.c (send_internal): remove inadvertent symbol creation 	  from
public_send.  based on a patch by Jeremy Evans &lt;code AT 	 
jeremyevans.net&gt; in [ruby-core:38576]. [Feature #5112]</p>

<p>* vm_insnhelper.c (vm_call_method): remove inadvertent symbol 	  creation
from send and __send__, too.</p>

<p>Thu Oct  6 14:59:11 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/time.rb:  Clean up Time documentation.  Patch by Jake Goulding. 	 
[Ruby 1.9 - Bug #5416]</p>

<p>Thu Oct  6 10:00:54 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enum.c (group_by):  Improve documentation based on patch by b t.</p>

<p>Thu Oct  6 09:56:30 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* enum.c:  Clean up wording in Enumerable documentation.  Patch by b t. 	 
[Ruby 1.9 - Bug #5411]</p>

<p>Thu Oct  6 09:17:18 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* time.c (Init_Time):  Remove editorial comments from Time 	 
documentation, fix link.</p>

<p>Thu Oct  6 09:14:20 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* time.c (Init_Time):  Improve Time documentation.  Patch by Shane 	 
Emmons.  [Ruby 1.9 - Bug #5404] 	* lib/time.rb:  Improve time.rb
documentation including Time.strptime. 	  Patch by Shane Emmons.  [Ruby 1.9
- Bug #5402]</p>

<p>Thu Oct  6 08:54:05 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* random.c:  Improve documentation of Random.  Patch by Gregory 	 
Parkhurst.  [Ruby 1.9 - Bug #5410]</p>

<p>Thu Oct  6 01:44:51 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* cont.c (cont_mark): mark original Thread object from saved_thread. 	 
[ruby-dev:44571] [Bug #5386]</p>

<p>Wed Oct  5 16:33:04 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_cfunc): remove useless hack.</p>

<p>Wed Oct  5 05:56:39 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* hash.c (Init_Hash):  Improve Hash documentation.  Patch by Alvaro 	 
Pereyra Rabanal.  [Ruby 1.9 - Bug #5405]</p>

<p>Wed Oct  5 05:47:59 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* random.c (Init_Random):  Add a top-level comment for Random.  Patch 	 
by Brett Bim.  [Ruby 1.9 - Bug #5403]</p>

<p>Wed Oct  5 02:50:27 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/syntax_error.rb: Add file, line, offset, and 	 
message attributes during parse failure. 	* ext/psych/parser.c: Update
parser to raise exception with correct 	  values. 	*
test/psych/test_exception.rb: corresponding tests.</p>

<p>Wed Oct  5 01:52:16 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/parser.c (parse): Use context_mark for indicating error 	 
line and column.</p>

<p>Wed Oct  5 01:22:08 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: use normal begin / rescue 	 
since postfix rescue cannot receive the exception class. Thanks 	 
nagachika!</p>

<p>Tue Oct  4 21:10:08 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (class_alloc): allocate extra memory after containing 	  object
setup to get rid of rare-but-potential memory leak.</p>

<p>* gc.c (gc_mark_children): skip marking extended members if ptr is 	 
NULL.</p>

<p>Tue Oct  4 16:17:50 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/time.rb (Time.strptime): use Time.at if <a href=":seconds">d</a> is
set. 	  Reported by Christopher Eberz. [ruby-core:39903] Bug #5399</p>

<p>Tue Oct  4 11:44:10 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c (rb_gc_set_params): ruby_verbose can be Qnil, so use RTEST.</p>

<p>Tue Oct  4 08:33:41 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/etc/etc.c:  Document Etc, Etc.sysconfdir, Etc.systmpdir.  Patch 	 
by mathew murphy.  [Ruby 1.9 - Bug #5396]</p>

<p>Tue Oct  4 08:21:51 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/shellwords.rb:  Update toplevel comment with an example.  Patch 	 
by Samnang Chhun.  [Ruby 1.9 - Bug #5388]</p>

<p>Tue Oct  4 08:15:50 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* proc.c (proc_call):  Update documentation to match argument handling 	 
of proc/Proc.new/lambda/-&gt;()</p>

<p>Tue Oct  4 07:59:16 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* proc.c (proc_call):  Fix documentation of Proc#call vs Proc#===. 	 
[Ruby 1.9 - Bug #5349]</p>

<p>Tue Oct  4 07:43:18 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c (rb_ary_initialize):  Make Array.new description match 	 
call-seq.  Patch by Henry Maddocks.  [Ruby 1.9 - Bug #5344]</p>

<p>Tue Oct  4 07:35:23 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c (rb_ary_initialize):  Add output for examples.  Patch by 	 
Jonathan Mukai.  [Ruby 1.9 - Bug #5216]</p>

<p>Tue Oct  4 07:30:50 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* array.c (rb_ary_s_create):  Add example results for Array::[].  Patch 	 
by Jonathan Mukai.  [Ruby 1.9 - Bug #5215]</p>

<p>Tue Oct  4 07:15:17 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Update to RubyGems 1.8.11.  Move Deprecate into the 	 
Gem namespace.</p>

<p>Tue Oct  4 06:43:47 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: update psych version. 	*
ext/psych/psych.gemspec: generate new gemspec for new version.</p>

<p>Tue Oct  4 06:29:55 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: calling `yaml` rather than `to_yaml`. 	*
ext/psych/lib/psych/nodes/node.rb: Rename `to_yaml` to just `yaml` 	  in
order to avoid YAML::ENGINE switching from replacing this method. 	*
test/psych/helper.rb: fix tests for method name change. 	*
test/psych/test_document.rb: ditto 	* test/psych/visitors/test_emitter.rb:
ditto</p>

<p>Tue Oct  4 06:20:19 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: Match values against the 	 
floating point spec defined in YAML to avoid erroneous parses. 	*
test/psych/test_numeric.rb: corresponding test.</p>

<p>Tue Oct  4 05:59:24 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: ToRuby visitor can be 	 
constructed with a ScalarScanner. 	*
ext/psych/lib/psych/visitors/yaml_tree.rb: ScalarScanner can be 	  passed
to the YAMLTree visitor.</p>

<p>Tue Oct  4 05:47:23 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: Define Regexp::NOENCODING 	 
for 1.9.2 backwards compatibility. 	*
ext/psych/lib/psych/visitors/yaml_tree.rb: Fix Date string 	  generation
for 1.9.2 backwards compatibility.</p>

<p>Mon Oct  3 23:56:39 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* gc.c (rb_gc_set_params): output GC parameter change messages only 	  if
-w/-v options are specified. these messages are output to stderr, 	  not to
stdout. [ruby-core:39795] [Bug #5380]</p>

<p>* test/ruby/test_gc.rb (test_gc_parameter): add test for it.</p>

<p>Sun Oct  2 20:05:32 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (rb_thread_mark), cont.c (cont_mark): revert r33369 and r33371 	 
that may cause SEGV in certain environments.</p>

<p>Sun Oct  2 12:14:06 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/psych/test_yamldbm.rb: add test case. 	* test/syck/test_yamldbm.rb:
ditto.</p>

<p>Sun Oct  2 11:28:09 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* lib/yaml/store.rb: make initialize method signature match the 	 
superclass signature.</p>

<p>Sun Oct  2 10:44:01 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* io.c: fix documentation of ARGF.lineno=.</p>

<p>Sat Oct  1 20:03:19 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (have_framework): try as Objective-C. 	  <a
href="https://twitter.com/nagachika/status/120294447660539904">twitter.com/nagachika/status/120294447660539904</a></p>

<p>Sun Oct  2 08:43:25 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (rb_thread_mark), cont.c (cont_mark): self pointer should not 	  be
marked by itself. Patch by Koichi Sasada. 	  [ruby-dev:44567] [Bug #5386]</p>

<p>Sun Oct  2 00:42:14 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (rb_thread_mark): rb_thread_t needs self to be marked. 	 
[ruby-dev:44566] [Bug #5386]</p>

<p>Sat Oct  1 09:48:53 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* gc.c (add_heap_slots, init_heap): reset heaps_inc zero when 	  heap
slots are expanded by environment variable RUBY_HEAP_MIN_SLOTS. 	 
[ruby-core:39777] [Bug #5380]</p>

<p>* test/ruby/test_gc.rb (test_gc_parameter): add test for it.</p>

<p>* test/ruby/envutil.rb (assert_normal_exit): add :child_env option to 	 
enable pass environment variables to child process.</p>

<p>Thu Sep 29 13:17:51 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (ary_join_1): should not copy the encoding of non-string 	 
element after string element.  [ruby-core:39776] [Bug #5379]</p>

<p>Thu Sep 29 11:53:56 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (slot_sweep, rb_gc_finalize_deferred) 	 
(rb_objspace_call_finalizer, rb_gc): run finalizers 	  sequentially. 
[ruby-dev:44562]</p>

<p>Thu Sep 29 20:37:38 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/gdbm/gdbm.c (rb_gdbm_fatal): adjust argument type.</p>

<p>Thu Sep 29 20:10:42 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (is_id_value, is_live_object): extract from id2ref().</p>

<p>* gc.c (run_finalizer): use object instead of object id.</p>

<p>Thu Sep 29 20:07:36 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* use RB_TYPE_P which is optimized for constant types, instead of 	 
comparison with TYPE.</p>

<p>Wed Sep 28 09:20:37 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (pthread_np.h): needs pthread.h to be included 	 
previously on OpenBSD.  a patch by George Koehler &lt;xkernigh AT 	 
netscape.net&gt; at [ruby-core:39752].  [Bug #5376]</p>

<p>Wed Sep 28 04:41:35 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/psych/test_yamlstore.rb: use tmpdir for tmpfile. 	*
test/syck/test_yamlstore.rb: ditto.</p>

<p>Wed Sep 28 04:10:46 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/bigdecimal/README: update report to.</p>

<p>Tue Sep 28 04:05:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal_en.html: removed because this file isn&#39;t 	
maintained now.</p>

<p>* ext/bigdecimal/bigdecimal_ja.html: ditto.</p>

<p>Tue Sep 27 09:55:40 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c: make native_fd_select(). 	* thread.c (do_select):
remove #ifdef _WIN32. Instead, use 	  native_fd_select() always.</p>

<p>Tue Sep 27 09:44:59 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (do_select): remove cygwin specific hack. It&#39;s layer 	 
violation and too large hack. 	* thread.c (cmp_tv, subtract_tv): removed.</p>

<p>Tue Sep 27 03:50:19 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/rexml/test_sax.rb: add require &#39;rexml/document&#39;.</p>

<p>Tue Sep 27 03:32:27 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/psych/test_yamldbm.rb: fix #setup and #teardown. 	  [Bug #5370]
[ruby-core:39730] 	* test/syck/test_yamldbm.rb: ditto.</p>

<p>Mon Sep 26 11:27:38 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/httputils.rb: Add MIME Type definition of .js and .svg. 	 
patched by Hal Brodigan. [ruby-core:39704] [Bug #5365]</p>

<p>Mon Sep 26 09:20:44 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: remove DJGPP support. It&#39;s not longer supported 	 
since ruby 1.9.0.</p>

<p>Mon Sep 26 09:07:46 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* include/ruby/defines.h: remove NextStep, OpenStep, Rhapsody 	  support.
Last activity of their OSes are 7 years ago. 	* configure.in: ditto. 	*
dir.c: ditto. 	* ext/tk/extconf.rb: ditto.</p>

<p>Mon Sep 26 09:02:49 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: remove a code for human68k. it&#39;s no longer 	 
supported since r19677.</p>

<p>Sun Sep 25 23:43:32 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_asn1.c: fix int_ossl_asn1_decode0_cons when being 	 
fed arbitrary string values. 	  Clearly distinguish between the cases
“universal, infinite and 	  not a SEQUENCE or SET” and “universal SEQUENCE
or SET, possibly 	  infinite”. Raise error for universal tags that are not
infinite. 	* test/openssl/test_asn1.rb: add a test for this.</p>

<p>Thanks to Hiroshi Yoshida for reporting this bug. 	  [Bug #5363]
[ruby-dev:44542]</p>

<p>Sun Sep 25 20:57:18 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/syck/test/yamldbm.rb: add test for Syck::DBM. 	*
test/psych/test_yamldbm.rb: add test for Psych::DBM. 	*
test/psych/test_yamlstore.rb: add test for Psych::PStore.</p>

<p>Sun Sep 25 20:54:10 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/yaml/dbm/dbm.rb: fix #update, add #key for using instead #index. 	 
[Bug #<a href="ruby-dev:44485">5305]</a></p>

<p>Sun Sep 25 16:54:33 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* encoding.c (require_enc): reject only loading from untrusted 	  load
paths.  [ruby-dev:44541] [Bug #5279]</p>

<p>* transcode.c (load_transcoder_entry): ditto.</p>

<p>Sun Sep 25 16:45:05 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: ignore all warnings from an arbitrary 	  header in
/usr/local/include.</p>

<p>Sun Sep 25 03:43:03 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* enum.c (slice_before_i): use rb_attr_get to suppress wrong warning 	 
for internal instance variable slicebefore_initial_state.</p>

<p>Fri Sep 23 14:20:14 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_asn1.c: remove unused variable.</p>

<p>Fri Sep 23 13:46:59 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_ssl_session.rb: execute test_session_exts_read 	  only
for OpenSSL versions &gt;= 0.9.8k. Thanks, Eric Wong, for 	  reporting
this. 	  [Bug #4961] [ruby-core:37726]</p>

<p>Fri Sep 23 11:59:08 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_ssl_session.rb: ensure server calls callbacks in 	 
test_ctx_server_session_cb. Thanks to Eric Wong for the patch. 	  [Bug
#5336] [ruby-core:39619]</p>

<p>Thu Sep 22 02:53:19 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_cfunc): suppress a warning.  note that 	 
`volatile type *var&#39; doesn&#39;t make var itself volatile.</p>

<p>Thu Sep 22 01:52:48 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* thread_pthread.c (ubf_select): activate timer thread when interrupt 	 
blocking thread. 	  A patch created by Koichi Sasada. [ruby-core:39634]
[Bug #5343] 	  to cover race condition, timer thread periodically send
SIGVTARLM to 	  threads in signal thread list. so you should activate timer
thread 	  when interrupt a thread.</p>

<p>Wed Sep 21 16:55:26 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/io/wait/test_io_wait.rb (TestIOWait#setup): of course, the 	 
behavior of mingw is just same with mswin.</p>

<p>Tue Sep 20 18:08:51 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_get_cvar_base): reduce duplicated checks and 	  move
a warning outside the loop.</p>

<p>Mon Sep 19 18:55:51 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* lib/fileutils.rb (module FileUtils): improve performance of 	 
FileUtils.compare_stream. a patch by Masaki Matsushita. 	  [Feature #5337]
[ruby-core:39622]</p>

<p>Mon Sep 19 18:42:58 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* test/-ext-/old_thread_select/test_old_thread_select.rb: 	  select() with
timeout may return early in old Linux kernels 	  with 250 Hz tickrate and
no dynticks, so skip everything older 	  than 2.6.32 (which has long term
support). 	  And, Make the timing assertions consistently use
assert_operator with 	  timing difference in error message 	  Patch by Eric
Wong. [Bug #5335] [ruby-core:39618]</p>

<p>Mon Sep 19 09:28:06 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/openssl/test_ssl.rb (class OpenSSL):  Test 	 
OpenSSL::SSL::SSLSocket#session and #session=.</p>

<p>Mon Sep 19 07:54:17 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_obj_clone): singleton class should be attached 	  singleton
object to.  a patch by Satoshi Shiba &lt;shiba AT rvm.jp&gt; 	  at
[ruby-dev:44460].  [Bug #5274]</p>

<p>Sat Sep 17 23:34:10 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_data_type): inherit the core type in ripper so 	  that
checks in core would work.  [ruby-core:39591] [Bug #5331]</p>

<p>Sat Sep 17 12:44:04 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* lib/find.rb (Find.find): add documentation that Find.find 	  without
block returns an enumerator.</p>

<p>Thu Sep 15 11:39:43 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (mark_entry, mark_key, mark_keyvalue): adjust callback 	  argument
types.</p>

<p>Thu Sep 15 01:44:10 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/tk/*: Change encoding from EUC-JP to UTF-8</p>

<p>Wed Sep 14 11:43:37 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_fd_rcopy): added an argument guard. 	  Patch by NAKAMURA
Usaku. [Bug #5306] [ruby-core:39435]</p>

<p>Tue Sep 13 20:21:49 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/pstore.rb, test/test_pstore.rb: suppress warnings with -v.</p>

<p>* lib/pstore.rb (PStore): always open in binary mode even if 	  default
encodings are set.  [Bug #5311] [ruby-core:39503]</p>

<p>Tue Sep 13 05:37:15 2011  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* io.c (Init_IO): update BINARY comment.  it should not change the 	 
encoding of the result to ASCII-8BIT.  [ruby-talk:387719]</p>

<p>Mon Sep 12 19:55:00 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_select): fix to ignore an argument 	  modification
of rb_thread_fd_select(). 	  based on a patch by Eric Wong. [Bug #5306]
[ruby-core:39435] 	* thread.c (rb_fd_rcopy): New. for reverse fd copy.</p>

<p>* test/-ext-/old_thread_select/test_old_thread_select.rb
	(test_old_select_false_positive): test for bug5306.</p>

<p>* ext/-test-/old_thread_select/old_thread_select.c (fdset2array): 	  New.
convert fdsets to array. 	*
ext/-test-/old_thread_select/old_thread_select.c (old_thread_select): 	 
return &#39;read&#39;, &#39;write&#39;, &#39;except&#39; argument of
rb_thread_select() 	  to ruby script.</p>

<p>Mon Sep 12 13:38:12 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* README.EXT, README.EXT.ja (2.2.2), parse.y (rb_check_id): add 	 
documents for rb_check_id().</p>

<p>Mon Sep 12 12:53:39 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rake/file_list.rb (Rake::FileList#egrep): there is no need to 	 
open files in binary mode. 	  see more details in <a
href="https://github.com/jimweirich/rake/issues/74">github.com/jimweirich/rake/issues/74</a></p>

<p>Mon Sep 12 12:42:36 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/test_exception.rb (TestException#test_exit_success_p): 	 
assert also the cases when exiting with true and false.</p>

<p>* lib/test/unit/assertions.rb (assert_send): make arguments in 	  the
default message clearer.</p>

<p>Sun Sep 11 05:23:14 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/matrix.rb: Deal with subclasses of Matrix [redmine #5307]</p>

<p>Sat Sep 10 13:38:20 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* dir.c (dir_s_aref): 	* dir.c (dir_entries): Two small documentation
fixes. 	  A patch from Aaron Lerch. [Bug #5302] [ruby-core:39404]</p>

<p>Sat Sep 10 08:30:03 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (GC_PROFILE_MORE_DETAIL, CALC_EXACT_MALLOC_SIZE): 	  define macros
only if they are not defined. 	  fixes: [Ruby 1.9 - Feature #5291]</p>

<p>Sat Sep 10 08:25:47 2011  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* parse.y (bv_decls): parse.y relies on $$ = $1 before action 	  routines.
a patch from Michael Edgar.  [Bug #5303] 	  [ruby-core:39429]</p>

<p>Sat Sep 10 01:37:55 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* sample/drb/dhasenc.rb: coding cookie of Emacs is coding, 	  not
encoding.</p>

<p>* sample/mine.rb: ditto.</p>

<p>Fri Sep  9 21:56:40 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_sqrt): Fix comment. 	 
BigDecimal#sqrt requires argument. Reported by Makoto Kishimoto. 	  Thanks
for your contribution. [Bug #5267] [ruby-dev:44452]</p>

<p>Fri Sep  9 11:00:55 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* test/rubygems/test_gem_commands_help_command.rb: Add one 	  `require`
because if run test-all with test/unit parallel 	  running, sometimes this
test fails by some constants not found. 	  The error reason is some worker
doesn&#39;t require the file needed by 	  this test. This issue is related
to [ruby-core:36168].</p>

<p>Fri Sep  9 10:22:03 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_select): fix a typo to initialize efds 	  properly. 
[Bug #5299] [ruby-core:39380]</p>

<p>Fri Sep  9 02:02:09 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* template/yarvarch.ja: 	  Change encoding from Shift_JIS to UTF-8</p>

<p>Thu Sep  9 01:14:00 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* sample/drb/README.rd.ja: 	* sample/drb/dhasenc.rb: 	* sample/mine.rb: 	 
Change encoding from EUC-JP to UTF-8</p>

<p>Thu Sep  8 21:03:22 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf-utf8/nkf.c: import nkf 2.1.2 (be9c280) 	  Bump version
number/release date only.</p>

<p>Thu Sep  8 12:43:18 2011  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (Init_GC): defined GC::Profiler.raw_data. based on the 	  patch by
Eric Hodel. [ruby-core:37857] [Bug #4991]</p>

<p>Thu Sep  8 09:02:53 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (id2ref): objects which are unmarked but not in sweep_slots 	  are
not dead.</p>

<p>Thu Sep  8 07:44:25 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c (rb_declare_transcoder, load_transcoder_entry): no 	  longer
need to limit the length of transcoder library name.</p>

<p>Thu Sep  8 07:36:36 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/syck/lib/syck/types.rb: use toplevel Syck. 	  for the case someone
define Syck::Syck (or YAML::Syck).</p>

<p>Thu Sep  8 07:33:12 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (id2ref): unmarked object is already dead while lazy 	  sweeping,
and to it cannot come back since other objects 	  referred from it might
have been freed already.</p>

<p>Wed Sep  8 03:48:00 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/readline/README.ja: 	  Change encoding from EUC-JP to UTF-8</p>

<p>Wed Sep  8 02:59:00 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* test/rexml/test_encoding.rb: 	  Add require &#39;require
&#39;rexml/document&#39;</p>

<p>Wed Sep  8 02:53:00 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* ext/nkf/nkf-utf8/nkf.c: 	  Change encoding from ISO-2022 to UTF-8</p>

<p>Wed Sep  7 23:41:24 2011  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/parsers/baseparser.rb, test/rexml/test_comment.rb: 	  allow a
single hyphen in comment. [Bug #5278] [ruby-core:39289] 	  Reported by
Thomas Fritzsche. Thanks!!!</p>

<p>Wed Sep  7 17:27:18 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/yaml.rb: explicitly specify ::Object to avoid the collision with 	 
Syck::Object.</p>

<p>Tue Sep  6 21:06:49 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb (_run_suites): Now reports are written the 	  following
order: Skip, Failure, Error. [Feature #5282]</p>

<p>* test_sorting.rb: test for above.</p>

<p>* test4test_sorting.rb: Ditto.</p>

<p>* lib/test/unit.rb (run): Put RUBY_DESCRIPTION before quitting. 	 
[Feature #5282]</p>

<p>Tue Sep  6 21:13:47 2011  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (INSNS): change command line option -Ks to -Ku 	  for
generate *.inc. because insns.def encoding has been changed SJIS 	  to
UTF-8. if $BASERUBY is 1.9, -Ks cause an error. [Feature #5128] 	  (same as
r33194)</p>

<p>Tue Sep  6 15:55:24 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c (load_transcoder_entry): concatenate paths directly.</p>

<p>* encoding.c (load_encoding): predefined encoding names are safe. 	 
[ruby-dev:44469] [Bug #5279]</p>

<p>* transcode.c (load_transcoder_entry): ditto.</p>

<p>Tue Sep  6 12:07:10 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c: enabled econv newline option.</p>

<p>Tue Sep  6 06:44:57 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c (dbl2ival): Fix Float#divmod and #round for 32 bit 	 
platform. part 1 of [bug #5276]</p>

<p>Tue Sep  6 06:44:25 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c (flo_round): Fix criteria for 32 bits platform 	  part 2 of
[bug #5276]</p>

<p>Tue Sep  6 05:37:11 2011  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* test/rinda/test_rinda.rb (test_core_03_notify): Fixed test failures 	 
[ruby-dev:44430] [Ruby 1.9 - Bug #372]</p>

<p>Mon Sep  5 20:59:30 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* insns.def: change encoding pragma for emacs (shift_jis to utf-8).</p>

<p>Mon Sep  5 19:32:15 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* Makefile.in (INSNS): change command line option -Ks to -Ku for 	 
generate *.inc. because insns.def encoding has been changed SJIS to 	 
UTF-8. if $BASERUBY is 1.9, -Ks cause an error. [Feature #5128]</p>

<p>Mon Sep  5 18:10:56 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c (rb_econv_binmode): newline decorators are 	  exclusive.</p>

<p>Mon Sep  5 15:03:37 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_security.rb 	 
(test_class_build_self_signed_cert): reset <a href=":trust_dir">opt</a> to
apply 	  temporary Gem.user_home.</p>

<p>Mon Sep  5 10:04:35 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* README.ja, README.EXT.ja: resolve conflicts. [ruby-dev:44459]</p>

<p>Mon Sep  5 05:13:22 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c (flo_round): Make Float#round round big values [bug 	  #5272]</p>

<p>Mon Sep  5 04:28:25 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c (int_round): Integer#round always returns an Integer [Bug 	 
#5271]</p>

<p>Sun Sep  4 22:28:50 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (default_port, default_imap_port, 	  default_tls_port,
default_ssl_port, default_imaps_port): 	  added methods for consistency
with Net::POP. 	  based on the patch by art lussos.  [ruby-core:38997] [Bug
#5198]</p>

<p>Sun Sep  4 21:19:19 2011  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>* Change encoding from EUC-JP to UTF-8. [Feature #5128]</p>

<p>Sun Sep  4 00:47:39 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* test/ruby/test_fiber.rb (TestFiber#test_no_valid_cfp): 	  add a test.
Unlike TestThread#test_no_valid_cfp, 	  this test succeeds even if win32ole
is required (see r33153).</p>

<p>Sun Sep  4 00:11:49 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (rb_const_set): show the previous definition 	  location. 
[EXPERIMENTAL]</p>

<p>Sat Sep  3 23:56:24 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (sizeof_struct_dirent_too_small): check if struct 	 
dirent.d_name is too small.</p>

<p>* configure.in (RUBY_MINGW32): take tool prefix from CC.</p>

<p>Sat Sep  3 23:52:08 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (argf_next_argv): open in default text mode. 	  [ruby-core:39234]
[Bug #5268]</p>

<p>Sat Sep  3 18:40:57 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* lib/thread.rb (SizedQueue#max=): raise ArgumentError if max is not 	 
positive number. patch by Masaki Matsushita. 	  [ruby-dev:44449] [Bug
#5259]</p>

<p>* test/thread/test_queue.rb (test_sized_queue_initialize, 	 
test_sized_queue_assign_max): add tests for it.</p>

<p>Fri Sep  2 21:11:16 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (validate_enc_binmode, prep_stdio): default to text mode on 	 
dosish platforms.  [ruby-core:38822] [Bug #5164]</p>

<p>* transcode.c (rb_econv_prepare_options): keep default ecflags 	 
unchanged if no options.</p>

<p>Fri Sep  2 14:36:47 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_search_const_defined_class): search 	  ancestors
only when global scope.  [ruby-core:39227] [Bug #5264]</p>

<p>Fri Sep  2 09:58:08 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_tokadd_string, parser_yylex): ignore a backslash 	 
which prefixes an non-ascii character, which has no escape 	  syntax. 
[ruby-core:39222] [Ruby 1.9 - Bug #5262]</p>

<p>Fri Sep  2 04:05:25 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb: emit strings tagged as 	 
ascii-8bit as binary in YAML. 	* test/psych/test_string.rb: corresponding
test.</p>

<p>Fri Sep  2 01:07:14 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (flo_round): substitute machine dependent magic number.</p>

<p>Thu Sep  1 17:31:22 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* insns.def (defineclass), vm_insnhelper.c (vm_get_cvar_base): see 	  also
inherited constants for classes without superclass and 	  modules. 
[ruby-core:37698] [Bug #3423]</p>

<p>Thu Sep  1 16:18:44 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* Release GVL while OpenSSL&#39;s public key generation.</p>

<p>t = Thread.new { print “.”; sleep 0.1 } 	    key =
OpenSSL::PKey::RSA.new(2048) 	    #=&gt; Thread t works in parallel with
public key generation if 		OS/machine allows it.</p>

<p>This works with OpenSSL &gt;= 0.9.8. From this version, it has new 	 
public key generation function which allows us to interrupt the 	 
execution while pkey generation iterations.</p>

<p>* ext/openssl/extconf.rb: Check existence of OpenSSL&#39;s new public key
	  generation function. (DH_generate_parameters_ex, 	 
DSA_generate_parameters_ex and RSA_generate_key_ex.</p>

<p>* ext/openssl/ossl_pkey.<code>h,c</code> (ossl_generate_cb_2, 	 
ossl_generate_cb_stop): Added new callback function for OpenSSL pkey 	 
generation which handles Thread interruption by Ruby. 	 
ossl_generate_cb_stop is the unblock function(ubf) for Ruby which 	  sets a
stop flag. New pkey generation callback ossl_generate_cb_2 	  checks the
stop flag at each iterations of OpenSSL and interrupts 	  pkey generation
when the flag is set.</p>

<p>* ext/openssl/ossl_pkey_dsa.c (dsa_generate): Call 	 
rb_thread_blocking_region with the above unblock function to release 	  GVL
while pkey generation.</p>

<p>* ext/openssl/ossl_pkey_rsa.c (rsa_generate): ditto.</p>

<p>* ext/openssl/ossl_pkey_dh.c (dh_generate): ditto.</p>

<p>* test/openssl/test_pkey_<code>dh,dsa,rsa</code>.rb: Test it.</p>

<p>Thu Sep  1 14:06:54 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_thread.rb (TestThread#test_no_valid_cfp): skip when 	 
win32ole is required.  in such case, win32ole redefines 	 
Thread#initialize, and the block argument becomes to be not the top 	  of
the thread, then this testcase always fails.</p>

<p>Thu Sep  1 10:20:50 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io_m17n.rb (TestIO_M17N#test_<code>default_mode_on_dosish,</code>): sorry for wrong test 	 
committed in r33144.  I&#39;d misunderstood the spec of ruby&#39;s
universal 	  newline.</p>

<p>Thu Sep  1 09:27:57 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* variable.c (rb_autoloading_value): Fix the order of definitions. 	  It
is used by autoload_defined_p.</p>

<p>Wed Aug 31 17:28:23 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* variable.c (rb_autoload): There was a chance to run GC (from 	 
rb_str_new2()) before finishing autoload_data_i construction. It 	  caused
SEGV at rb_gc_mark() at autoload_i_mark.</p>

<p>* variable.c (rb_autoload_load): Move RB_GC_GUARD() to proper 	  position
based on suggestion by CHIKANAGA Tomoyuki at 	 <a
href="http://d.hatena.ne.jp/nagachika/20110826/ruby_trunk_changes_33070_33078">d.hatena.ne.jp/nagachika/20110826/ruby_trunk_changes_33070_33078</a></p>

<p>* variable.c (autoload_defined_p): Fix incompatible autoload behavior 	 
that causes Rails crash. Class definition instruction defined in 	 
&#39;defineclass&#39; in insns.def always invokes rb_autoload_load for a 	 
constant. It&#39;s invoked for every class definition regardless of 	 
existence of autoload definition. rb_autoload_load checks if a 	  constant
is defined as autoloaded, but new thread-safe autoload 	  returned
different value if the constant is under autoloading.</p>

<p>Wed Aug 31 17:20:56 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* Re-apply r33078, thread-safe autoload which is reverted at r33093.</p>

<p>Wed Aug 31 16:28:04 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_io_m17n.rb (TestIO_M17N#test_<code>default_mode_on_dosish,</code>): tests for [Bug #5164].</p>

<p>Wed Aug 31 15:54:11 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json: Merge json gem v1.5.4 (3dab4c5a6a97fac03dac).</p>

<p>Wed Aug 31 13:09:41 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c (flo_round): Avoid overflow by optimizing for trivial 	  cases
[Bug #5227]</p>

<p>Wed Aug 31 00:50:01 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_select_with_thread): and my typo. we all must 	 
be more careful.</p>

<p>Wed Aug 31 00:48:38 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_select): critical typo in r33117.</p>

<p>Wed Aug 31 00:30:49 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/-ext-/old_thread_select/test_old_thread_select.rb 	 
(TestOldThreadSelect#test_old_select_read_timeout): if the machine 	  is
fast enough, the time used by code around IO.select may be smaller 	  than
Time implement threshold.</p>

<p>Wed Aug 31 00:04:38 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/-test-/old_thread_select/old_thread_select.c (old_thread_select): 	 
typo.</p>

<p>* test/-ext-/old_thread_select/test_old_thread_select.rb 	 
(TestOldThreadSelect#test_old_select_signal_safe): use SIGINT instead 	  of
SIGUSR1 because the former is general and the latter is platform 	 
dependent.</p>

<p>Tue Aug 30 23:59:36 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c, include/ruby/intern.h (rb_w32_fd_copy): implement 	  for
rb_thread_select() in thread.c.  the use of rb_fd_copy() is 	  introduced
in r33117. 	  [Bug #5251] [ruby-core:39195]</p>

<p>* thread.c (rb_thread_select): must call rb_fd_init() before using 	 
rb_fdset_t.  see the implementations of rb_fd_init()s if you want to 	 
know the reason.</p>

<p>Tue Aug 30 22:34:45 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/dl/test_callback.rb (test_callback_with_string): prevents 	 
temporary string from GC.</p>

<p>Tue Aug 30 22:25:38 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_call_cfunc): revert r33112.  RB_GC_GUARD macro 	 
protect a VALUE from GC.  It&#39;s not for general anti-optimizing 	 
purpose.</p>

<p>Tue Aug 30 11:06:19 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/json: Merge json gem 1.5.4+ (2149f4185c598fb97db1). 	  [Bug #5173]
[ruby-core:38866]</p>

<p>Tue Aug 30 09:57:50 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* lib/thread.rb (Queue#pop): fix a race against Thread.wakeup. 	  Patch by
Masaki Matsushita &lt;glass.saga at gmail dot com&gt; 	  [Bug #5195]
[ruby-dev:44400]</p>

<p>Tue Aug 30 09:48:07 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* cont.c (fiber_entry): fix stack allocation failure on Debian 	 
GNU/kFreeBSD. 	  Patch by Lucas Nussbaum &lt;lucas at lucas-nussbaum dot
net&gt;. 	  [Bug #5241] [ruby-core:39147]</p>

<p>Tue Aug 30 09:28:01 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread.c (rb_thread_select): rewrite by using 	  rb_thread_fd_select().
old one is EINTR unsafe. 	  Patch by Eric Wong. [Bug #5229]
[ruby-core:39102]</p>

<p>* test/-ext-/old_thread_select/test_old_thread_select.rb: 	  a testcase
for rb_thread_select(). 	*
ext/-test-/old_thread_select/old_thread_select.c: ditto. 	*
ext/-test-/old_thread_select/depend: ditto. 	*
ext/-test-/old_thread_select/extconf.rb: ditto.</p>

<p>Tue Aug 30 09:08:22 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: fix a build failure on GNU Hurd. 	  Patch by Samuel
Thibault &lt;sthibault at debian dot org&gt;. Thank you! 	  [Bug #5250]
[ruby-core:39185]</p>

<p>Sun Aug 29 23:22:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* test/ruby/test_numeric.rb (test_num2long): modify a test against the 	 
change by r33108.</p>

<p>Sun Aug 29 09:58:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (bit_coerce): A Fixnum and a Bignum are only permitted for 	
bitwise arithmetic with a Fixnum.  #1792</p>

<p>* test/ruby/test_fixnum.rb: add tests for the above change.</p>

<p>* bignum.c (bit_coerce): A Fixnum and a Bignum are only permitted for 	
bitwise arithmetic with a Bignum.  #1792</p>

<p>* test/ruby/test_bignum.rb: add tests for the above change.</p>

<p>Sun Aug 28 15:38:17 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* ext/date/date_parse.c (date_zone_to_diff): keep a temporary string 	 
stored in variable while the contents buffer is being used.</p>

<p>* ext/date/date_parse.c (date_zone_to_diff): get rid of out of bounds 	 
memory read. [ruby-dev:44409] [Bug #5213]</p>

<p>Sun Aug 28 05:29:50 2011  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 2.5.1 (r6596) 	* test/minitest/*:
ditto</p>

<p>Sat Aug 27 20:46:05 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (rb_vm_rewrite_dfp_in_errinfo): change return type 	  to suppress a
warning.</p>

<p>* vm_core.h: ditto.</p>

<p>Sat Aug 27 19:04:06 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* internal.h (rb_strftime_timespec): moved from time.c and define only 	 
if ruby/encoding.h is included.</p>

<p>* internal.h (rb_strftime): ditto.</p>

<p>Sat Aug 27 18:53:51 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* proc.c (proc_new): force to rewrite errinfo when calling Proc.new in
ensure. 	  [Bug #5234] [ruby-core:39125] 	  This code will be removed after
changing throw mechanism (see r33064).</p>

<p>* vm.c (rb_vm_rewrite_dfp_in_errinfo): new function.</p>

<p>* vm.c (vm_make_env_each): changed accordingly.</p>

<p>* vm_core.h: ditto.</p>

<p>* bootstraptest/test_flow.rb: add tests for above.</p>

<p>Sat Aug 27 18:44:06 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* internal.h (rb_strftime_timespec): move to time.c because it depends 	 
encoding.h.</p>

<p>Sat Aug 27 18:17:58 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): get enc argument to specify 	 
the encoding of the format. On Windows (at least Japanese Windows), 	 
Time#strftime(“%Z”) includes non ASCII in locale encoding (CP932). 	  So
convert locale to default internal. [ruby-core:39092] [Bug #5226]</p>

<p>* strftime.c (rb_strftime): ditto.</p>

<p>* strftime.c (rb_strftime_timespec): ditto.</p>

<p>* internal.h (rb_strftime_timespec): follow above.</p>

<p>* time.c (rb_strftime_alloc): ditto.</p>

<p>* time.c (strftimev): ditto.</p>

<p>* time.c (time_strftime): ditto.</p>

<p>* time.c (time_to_s): the resulted string of Time#to_s is always 	  ascii
only, so this should be US-ASCII.</p>

<p>* time.c (time_asctime): ditto.</p>

<p>Sat Aug 27 11:18:12 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* Revert r33078. It caused a Rails application NoMethodError.</p>

<p>/home/nahi/git/emptyApp/ruby/1.9.1/gems/rack-mount-0.6.14/lib/rack/mount/utils.rb:157:
warning: toplevel constant ScanError referenced by Regin::Parser::ScanError
	
/home/nahi/git/emptyApp/ruby/1.9.1/gems/rack-mount-0.6.14/lib/rack/mount/vendor/regin/regin/parser.rb:17:in
`parse_regexp&#39;: undefined method `scan_str&#39; for
#&lt;Regin::Parser:0x00000002344548&gt; (NoMethodError)</p>

<p>Sat Aug 27 08:44:58 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc:  Import RDoc 3.9.4.  Typo and grammar fixes by Luke Gruber. 	 
[Ruby 1.9 - Bug #5203]</p>

<p>Sat Aug 27 07:53:34 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/open-uri.rb:  Fix indentation of OpenURI::OpenRead#open.  Use ++ 	 
instead of `&#39; for method arguments in open-uri.rb</p>

<p>Sat Aug 27 07:22:07 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/pathname/lib/pathname.rb:  Fix typos and grammar mistakes.  Patch 	 
by Luke Gruber.  [#5203] 	* ext/pty/lib/expect.rb:  ditto 	* lib/mathn.rb: 
ditto 	* lib/net/http.rb:  ditto 	* lib/open-uri.rb:  ditto 	*
lib/ostruct.rb:  ditto 	* lib/tempfile.rb:  ditto 	* lib/thread.rb:  ditto
	* lib/weakref.rb:  ditto 	* sample/webrick/httpproxy.rb:  ditto</p>

<p>Sat Aug 27 04:03:18 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (iseq_data_to_ary): fix type of variable 	  (long -&gt; unsigned
long) to suppress a warning.</p>

<p>Sat Aug 27 04:02:11 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: add a decl. of rb_autoloading_value().</p>

<p>Fri Aug 26 19:12:08 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* variable.c: Make autoload thread-safe. See #921.</p>

<p>What&#39;s the problem? 	    autoload is thread unsafe. When we define a
constant to be 	    autoloaded, we expect the constant construction is
invariant. But 	    current autoload implementation allows other threads to
access the 	    constant while the first thread is loading a file.</p>

<p>What&#39;s happening inside? 	    The current implementation uses Qundef
as a marker of autoload in 	    Constant table. Once the first thread find
Qundef as a value at 	    constant lookup, it starts loading a defined
feature. Generally a 	    loaded file overrides the Qundef in Constant
table by module/class 	    declaration at very beginning lines of the file,
so other threads 	    can see the new Module/Class object before feature
loading is 	    finished. It breaks invariant construction.</p>

<p>How to solve? 	    To ensure invariant constant construction, we need to
override 	    Qundef with defined Object after the feature loading. For
keeping 	    Qundef in Constant table, I expanded autoload_data struct in 	
Module to have a slot for keeping the defined object while feature 	   
loading. And changed Module&#39;s constant lookup/update logic a 	   
little so that the slot is only visible from the thread which 	    invokes
feature loading. (== the first thread which accessed the 	    autoload
constant)</p>

<p>Evaluation? 	    All test passes (bootstrap test, test-all and RubySpec)
and added 	    8 tests for threading behavior. Extra logics are executed
only 	    when Qundef is found, so no perf drop should happen except 	   
autoloading.</p>

<p>* variable.c (rb_autoload): Prepare new autoload_data struct.</p>

<p>* variable.c (rb_autoload_load): Load feature and update Constant 	  table
after feature loading is finished.</p>

<p>* variable.c (rb_const_get_0): When the fetched constant is under 	 
autoloading, it returns the object only for the thread which starts 	 
autoloading.</p>

<p>* variable.c (rb_const_defined_0): Ditto.</p>

<p>* variable.c (rb_const_set): When the specified constant is under 	 
autoloading, it sets the object only for the thread which starts 	 
autoloading. Otherwise, simply overrides Qundef with constant 	  override
warning.</p>

<p>* vm_insnhelper.c (vm_get_ev_const): Apply same change as 	 
rb_const_get_0 in variable.c.</p>

<p>* test/ruby/test_autoload.rb: Added tests for threading behavior.</p>

<p>Fri Aug 26 10:10:37 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Update to RubyGems 1.8.10.  Fixes security issue in 	 
creating ruby-format gemspecs.  Fixes Gem.dir not being at the front 	  of
Gem.path to fix uninstall and cleanup commands.  Fixes gem 	  uninstall
stopping on the first missing gem.</p>

<p>Fri Aug 26 08:21:10 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* time.c (strftimev): Make Time#to_s default to US-ASCII encoding but 	 
respect Encoding.default_internal. [ruby-core:39092] 	*
test/ruby/test_time.rb (class TestTime): Corresponding test.</p>

<p>Thu Aug 25 09:43:16 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/lib/openssl/bn.rb:  Hide copyright info from RDoc. 	*
ext/openssl/lib/openssl/digest.rb:  ditto 	*
ext/openssl/lib/openssl/x509.rb:  ditto 	*
ext/openssl/lib/openssl/cipher.rb:  ditto</p>

<p>Thu Aug 25 09:25:48 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/openssl/ossl_digest.c:  Document OpenSSL::Digest::digest and add 	 
an example to OpenSSL::Digest.  Patch by Sylvain Daubert. 	  [Ruby 1.9 -
Bug #5166] 	* ext/openssl/lib/openssl/digest.rb (module OpenSSL):  ditto</p>

<p>Thu Aug 25 08:19:43 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (vm_make_env_each): work around to solve Bug #2729. 	  fixes: Bug
#2729 	  a patch from Kazuki Tsujimoto &lt;kazuki@callcc.net&gt; 	  This
problem is caused by changing dfp (dynamic env pointer) 	  from saved dfp. 
Saved dfp is pointed env in VM stack.  However, 	  the dfp can be moved
because VM copies env from VM stack to 	  the heap.  At this copying, dfp
was also changed.  To solve this 	  problem, I&#39;ll try to change throw
mechanism (not save target dfp, 	  but save target cfp).</p>

<p>* bootstraptest/test_flow.rb: add a test for above.</p>

<p>Thu Aug 25 07:57:33 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* numeric.c (int_round): Fix Integer#round [ruby-core:39096]</p>

<p>Thu Aug 25 07:00:00 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.h, vm_insnhelper.c, vm.c, vm_method.c, insns.def: 	 
Manage a redefinition of special methods for each classes. 	  A patch from
Joel Gouly &lt;joel.gouly@gmail.com&gt;.  Thanks!</p>

<p>Thu Aug 25 06:51:08 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: Fixing psych version number. 	*
ext/psych/psych.gemspec: updating the gemspec.</p>

<p>Thu Aug 25 06:11:35 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/nodes/node.rb: default `to_yaml` encoding to be 	 
UTF-8. 	* test/psych/test_encoding.rb: test yaml dump encoding.</p>

<p>Thu Aug 25 01:24:33 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* test/fileutils/test_fileutils.rb (test_chmod_symbol_mode): Solaris 	 
seems to behave the same as FreeBSD.</p>

<p>Thu Aug 25 01:11:36 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* test/ruby/test_rubyoptions.rb (test_script_from_stdin): slave pty 	 
should be manipulated because master pty may not be a tty on some 	 
environment (e.g. Solaris). [Bug:#5222] [ruby-dev:44420]</p>

<p>Wed Aug 24 15:13:56 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.h, iseq.c, compile.c: Change the line number data structure 	  to
solve an issue reported at [ruby-dev:44413] [Ruby 1.9 - Bug #5217]. 	 
Before this fix, each instruction has an information including 	  line
number (iseq::iseq_insn_info_table).  Instead of this data 	  structure,
recording only line number changing places 	  (iseq::iseq_line_info_table).
	  The order of entries in iseq_line_info_table is ascending order of 	 
iseq_line_info_table_entry::position.  You can get a line number 	  by an
iseq and a program counter with this data structure. 	  This fix reduces
memory consumption of iseq (bytecode). 	  On my measurement, a rails
application consumes 21.8MB for 	  iseq with this fix on the 32bit CPU. 
Without this fix, it 	  consumes 24.7MB for iseq [ruby-dev:44415].</p>

<p>* proc.c: ditto.</p>

<p>* vm_insnhelper.c: ditto.</p>

<p>* vm_method.c: ditto.</p>

<p>* vm.c (rb_vm_get_sourceline): change to use rb_iseq_line_no().</p>

<p>Wed Aug 24 09:49:10 2011  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* insns.def (defined): fix to checking class variable. 	  A patch by
Magnus Holm &lt;judofyr@gmail.com&gt;.  Thanks!</p>

<p>* test/ruby/test_variable.rb: add a test for above.</p>

<p>Wed Aug 24 08:53:06 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc:  Update to RDoc 3.9.3.  Fixes RDoc with `ruby -Ku`.  Allows 	 
HTTPS image paths to be turned into &lt;img&gt; tags.  Prevents special 	 
markup inside &lt;tt&gt; from being processed.</p>

<p>Wed Aug 24 07:57:43 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Update to RubyGems 1.8.9.  Fixes uninstalling multiple 	 
gems and gem cleanup.</p>

<p>Wed Aug 24 06:45:20 2011  Ryan Davis  &lt;ryand-ruby@zenspider.com&gt;</p>

<p>* lib/minitest/*: Imported minitest 2.5.0 (r6557) 	* test/minitest/*:
ditto</p>

<p>Wed Aug 24 00:38:22 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* thread.c (update_coverage): skip coverage count up if the current 	 
line is out of the way.  rb_sourceline() is unreliable when source 	  code
is big.  [ruby-dev:44413]</p>

<p>* test/coverage/test_coverage.rb: add a test for above.</p>

<p>Tue Aug 23 15:23:56 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* load.c (rb_f_require):  Improve documentation of Kernel#require. 	 
[Ruby 1.9 - Bug #5210]</p>

<p>Tue Aug 23 11:27:26 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/zlib/zlib.c (gzfile_read_header): Ensure that each section of 	 
gzip header is readable to avoid SEGV.</p>

<p>* test/zlib/test_zlib.rb (test_corrupted_header): Test it.</p>

<p>Mon Aug 22 23:43:33 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* sprintf.c (rb_str_format): add RB_GC_GUARD to prevent temporary 	 
strings from GC.</p>

<p>Sun Aug 21 17:49:53 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* iseq.c (iseq_s_disasm): remove variable which is no longer used 	  since
r33013.</p>

<p>Sun Aug 21 14:20:58 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* configure.in: use LD_LIBRARY_PATH_64 on 64-bit Solaris.</p>

<p>Sat Aug 20 13:19:52 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* iseq.c (iseq_s_disasm): fix a bug that may cause SEGV.</p>

<p>* test/ruby/test_method.rb (test_body): add a test for the above change.</p>

<p>Sat Aug 20 10:43:24 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_read): return new string if nil 	  is
explicitly given as a buffer ([Bug #5207]), otherwise set the 	  encoding. 
also removed dead code.</p>

<p>Fri Aug 19 14:25:51 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (proc_spawn_v, proc_spawn): should not wait the 	  spawned
process.</p>

<p>* process.c (proc_spawn_v): fix missing argument, and try with 	  /bin/sh
only if failed with ENOEXEC.</p>

<p>Fri Aug 19 14:12:57 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (idle): raises a Net::IMAP::Error when the 	  connection
is closed.  based on the patch by Hugo Barauna. 	  [Bug #5190]
[ruby-core:38930]</p>

<p>Fri Aug 19 13:18:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* configure.in: defines _DARWIN_UNLIMITED_SELECT if the target_os 	  is
darwin.</p>

<p>Fri Aug 19 13:14:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* thread.c: add a description for the behavior of select(2) on 	  Mac OS X
10.7 (Lion).</p>

<p>Fri Aug 19 11:28:58 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/imap.rb (msg_att): accepts extra space before &#39;)&#39;. 	 
based on the patch by art lussos.  [Bug #5163] [ruby-core:38820]</p>

<p>Wed Aug 17 23:01:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (cannot_be_coerced_into_BigDecimal): 	 
remove duplication.</p>

<p>Wed Aug 17 15:27:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (cannot_be_coerced_into_BigDecimal): 	  add
a new function for raising error when an object cannot coerce 	  into
BigDecimal.  [Bug #5172]</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimalValueWithPrec): use 	 
cannot_be_coerced_into_BigDecimal function.</p>

<p>* ext/bigdecimal/bigdecimal.c (BigMath_s_exp): ditto.</p>

<p>* ext/bigdecimal/bigdecimal.c (BigMath_s_log): ditto.</p>

<p>* test/bigdecimal/test_bigdecimal.rb: test for the above changes.</p>

<p>* test/bigdecimal/testbase.rb (under_gc_stress): add a new utility 	 
method to run tests under the condition of GC.stress = true.</p>

<p>Wed Aug 17 10:16:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* rational.c (nurat_coerce): Rational#coerce should converts itself 	 
into Complex if the argument is a Complex with non-zero imaginary 	  part. 
[Bug #5020] [ruby-dev:44088]</p>

<p>* test/ruby/test_rational.rb (test_coerce): test for the above change.</p>

<p>Wed Aug 17 06:33:19 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_x509cert.c: Add class documentation for 	 
OpenSSL::X509::Certificate.</p>

<p>Wed Aug 17 04:54:25 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_pkey.c: corrected docs, OpenSSL::PKey::DH does 	 
<strong>not</strong> support #sign/verify.</p>

<p>Tue Aug 16 18:56:54 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (ruby_threadptr_data_type): rename to hide. 	  [ruby-core:38972]</p>

<p>Tue Aug 16 18:52:08 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/mkexports.rb (Exports::Mswin#each_export): exclude Init_ 	  and
<em>threadptr</em> functions, as well as mingw.</p>

<p>Tue Aug 16 09:31:44 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/dl:  Add documentation.  Patch by Vincent Batts. 	  [Ruby 1.9 - Bug
#5192]</p>

<p>Tue Aug 16 08:48:26 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/.document (fiddle):  Remove duplicate entry 	* ext/fiddle:  Complete
documentation of Fiddle.  Patch by Vincent 	  Batts.  [#5192]</p>

<p>Tue Aug 16 08:00:15 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/socket:  Make Socket documentation appear.  Add documentation for 	 
Socket, TCPServer, SOCKSSocket.  Patch by Sylvain Daubert. 	  [Ruby 1.9 -
Feature #5182]</p>

<p>Mon Aug 15 09:58:55 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Support disabling OpenSSL compression.</p>

<p>* test/openssl/test_ssl.rb: Add a test for it. 	  Thanks to Eric Wong for
the patch. 	  [Ruby 1.9 - Feature #5183] [ruby-core:38911]</p>

<p>Sun Aug 14 05:57:01 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/socket/test_socket.rb (test_connect_timeout): added a test 	  based
on a patch by Eric Wong.  [ruby-core:38910]</p>

<p>Sat Aug 13 22:17:27 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb: do not make the entries related to sitedir and 	 
verdordir if disabled by –without options.  [ruby-core:38922] 	  [Bug
#5187]</p>

<p>Sat Aug 13 17:03:22 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: [ruby-core:38861]</p>

<p>Sat Aug 13 09:39:07 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* test/date/test_*.rb: added tests.</p>

<p>Sat Aug 13 09:36:19 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* ext/date/date_parse.c (parse_ddd_cb): fix r32896. RB_GC_GUARD 	 
insertion position was mistaken. [ruby-dev:44337] [Bug #5152]</p>

<p>Sat Aug 13 09:26:24 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/core_ext.rb: Make Kernel#y private. 	 
[ruby-core:38913]</p>

<p>* test/psych/test_yaml.rb: corresponding test.</p>

<p>Sat Aug 13 09:05:16 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c (date_strftime_alloc): followed the change 	  of
r32885.</p>

<p>* doc/NEWS-1.9.3: followed the above change.</p>

<p>Sat Aug 13 08:55:38 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych/scalar_scanner.rb: Only consider strings 	  with
fewer than 2 dots to be numbers. [ruby-core:38915]</p>

<p>Sat Aug 13 08:47:20 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: [ruby-core:38855].</p>

<p>Sat Aug 13 03:41:37 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/uri/common.rb:  Fix documentation of URI::Parser.new.  Patch by 	 
Steve Klabnik.  [Ruby 1.9 - Bug #5177]</p>

<p>Sat Aug 13 02:19:57 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/digest/digest.c:  Add documentation for the Digest module.  Patch 	 
by Sylvain Daubert.  [Ruby 1.9 - Bug #5167]</p>

<p>Sat Aug 13 01:56:11 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rake:  Update to Rake 0.9.2.2.  Prevent pollution of toplevel 	 
namespace by Commands.  Remove unused variable and debugging 	  statement
in tests.</p>

<p>Fri Aug 12 11:39:35 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: Describe “no” configure option for site_ruby 	  and
vendor_ruby. Patch by Vit Ondruch. [Bug #<a
href="ruby-core:38921">5187]</a></p>

<p>Fri Aug 12 09:00:24 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Import RubyGems 1.8.8.  Fixes encoding of YAML gemspec 	 
from gems.  Github Issue #149</p>

<p>Fri Aug 12 08:17:46 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/ipsocket.c (init_inetsock_internal): use SOMAXCONN for 	 
listen backlog.</p>

<p>* ext/socket/unixsocket.c (rsock_init_unixsock): ditto.</p>

<p>* ext/socket/lib/socket.rb (Addrinfo#listen): ditto. 	 
(Socket.tcp_server_sockets_port0): ditto.</p>

<p>* ext/socket/mkconstants.rb: define SOMAXCONN as 5 if not available.</p>

<p>[ruby-core:38493]</p>

<p>Fri Aug 12 03:24:35 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc:  Import RDoc 3.9.2.  Fixes TIDYLINK for HTML output.</p>

<p>Thu Aug 11 15:37:42 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* variable.c (autoload_delete): An autoload entry is still in a 	 
RCLASS_IV_TBL, not in a RCLASS_CONST_TBL, so take back the table 	  changed
in r29600. And an autoload entry keeps not a 	  rb_const_entry_t but a NODE
so remove rb_const_entry_t thing added 	  in r29602.</p>

<p>Thu Aug 11 15:07:36 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (link_command): use LIBRUBYARG in rbconfig for 	  unbundled
extensions.  [ruby-core:38802] [Bug #5147]</p>

<p>* lib/mkmf.rb (init_mkmf): revert r32902.  [ruby-core:38903]</p>

<p>Wed Aug 10 23:03:55 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/lib/socket.rb: fix argument check in the previous commit.</p>

<p>Wed Aug 10 22:12:28 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/lib/socket.rb (Socket.tcp): add :connect_timeout option. 	 
(Addrinfo#connect_from): add :timeout option. 	  (Addrinfo#connect): ditto.
	  (Addrinfo#connect_to): ditto. 	  [ruby-core:38538]</p>

<p>Wed Aug 10 21:27:19 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/net/pop.rb: fix typo in document.</p>

<p>* lib/net/http.rb: ditto.</p>

<p>* lib/net/imap.rb: ditto.</p>

<p>Wed Aug 10 19:30:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* complex.c (nucomp_rationalize): calls rationalize of real part if 	 
imaginary part is exactly zero.  The patch is made by Marc-Andre 	 
Lafortune.  fixes [Bug #5178] [ruby-core:38885]</p>

<p>* test/ruby/test_complex.rb (test_rationalize): add a test for the 	 
above change.</p>

<p>* complex.c (nucomp_to_r): fix RDoc comment.  The patch is made by 	 
Marc-Andre Lafortune.</p>

<p>Wed Aug 10 14:11:07 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (init_mkmf): set $LIBRUBYARG regardless of shared 	  option.
[ruby-core:38802] [Bug #5147]</p>

<p>Wed Aug 10 02:53:27 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb: come back autoload. OpenSSL constant is used 	  some
places, so it leads mistakes like HTTP.start.</p>

<p>Tue Aug  9 22:57:45 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* ext/date/date_parse.c (date_zone_to_diff): add RB_GC_GUARD. 	 
[ruby-dev:44337] [Bug #5152]</p>

<p>* ext/date/data_parse.c (parse_ddd_cb): ditto.</p>

<p>Tue Aug  9 14:25:47 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/fiddle/conversions.c (generic_to_value): ffi_arg and ffi_sarg 	 
should be used to handle shorter return value. fix [Bug #3861] 	 
[ruby-core:32504]</p>

<p>* ext/fiddle/closure.c (callback): ditto</p>

<p>* ext/fiddle/conversions.h (fiddle_generic): ditto</p>

<p>* ext/fiddle/conversions.c (value_to_generic): char, short and int 	  are
strictly distinguished on big-endian CPU, e.g. sparc64.</p>

<p>Tue Aug  9 11:21:08 2011  Narihiro Nakamura  &lt;authornari@gmail.com&gt;</p>

<p>* gc.c (gc_lazy_sweep): if sweep target slots are not found, we 	  try
heap_increment() because it might be able to expand the 	  heap. [Bug
#5127] [ruby-dev:44285]</p>

<p>* gc.c (gc_clear_mark_on_sweep_slots): if a sweeping was 	  interrupted,
we expand the heap if at all possible.</p>

<p>Tue Aug  9 12:20:33 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* test/fiddle/helper.rb (libc_so, libm_so): Solaris support added. 	 
[ruby-core:38853] [Bug #5168]</p>

<p>* test/dl/test_base.rb (libc_so, libm_so): on Solaris, remove libc 	  and
libm version numbers for detecting default libc and libm.</p>

<p>Tue Aug  9 09:18:04 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/zlib/zlib.c (gzfile_wrap):  Document encoding options.</p>

<p>* ext/zlib/zlib.c (rb_gzwriter_s_open): ditto</p>

<p>* ext/zlib/zlib.c (rb_gzreader_s_open): ditto</p>

<p>Sun Aug  7 23:31:32 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* time.c (rb_strftime_alloc): raise ERANGE if width is too large. 	  Patch
by Nobuyoshi Nakada. [Bug #4457] [ruby-dev:43285]</p>

<p>* test/ruby/test_time.rb (class TestTime): add a test for the 	  above
change.</p>

<p>Sun Aug  7 22:51:45 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* ext/openssl/ossl_asn1.c (decode_eoc): remove unused variables. 	  Patch
by Eric Wong. [Feature #5157] [ruby-core:38798]</p>

<p>* ext/openssl/ossl_asn1.c (ossl_asn1_decode): ditto.</p>

<p>* ext/openssl/ossl_pkey.c (ossl_pkey_new_from_data): ditto.</p>

<p>Sun Aug  7 22:37:08 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* configure.in: add -Wunused-variable to default CFLAGS. 	  Patch by Eric
Wong. [Feature #5157] [ruby-core:38798]</p>

<p>Sun Aug  7 15:37:35 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/digest/sha2/sha2ossl.c: use original SHA384_Final on DragonFly.</p>

<p>Sun Aug  7 14:08:16 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* ext/objspace/objspace.c: fix typos in a document.</p>

<p>Sun Aug  7 07:14:57 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* cont.c (HAVE_GETCONTEXT): see getcontext(3) because DragonFly BSD 	  x64
port doesn&#39;t have it.</p>

<p>Sun Aug  7 00:42:55 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/tk/lib/tk/wm.rb (Tk::Wm.command): Add the missing receiver 	  before
calling epath. patched by flori 	 <a
href="https://github.com/flori/ruby/commit/aa9474d32e5f2c57f8b0e2e0c528a03f06a4d433">github.com/flori/ruby/commit/aa9474d32e5f2c57f8b0e2e0c528a03f06a4d433</a></p>

<p>Sat Aug  6 07:06:34 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* marshal.c (w_object):  Fix exception message when _dump_data is not 	 
defined on a T_DATA object.</p>

<p>Fri Aug  5 22:16:20 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* numeric.c (rb_infinity, rb_nan): use WORDS_BIGENDIAN to get endian. 	 
fix [Bug #5160] [ruby-dev:44356]</p>

<p>Fri Aug  5 17:14:11 2011  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* test/test_syslog.rb (TestSyslog#test_log): Do not be too 	  specific
about the log line format.  Fixes #5081.</p>

<p>Fri Aug  5 15:57:10 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* complex.c (f_signbit): fix compile error in gcc4 on Solaris with 	 
CFLAGS=“-std=gnu99”.  [ruby-dev:44355] fix [Bug #5159]</p>

<p>* math.c: ditto.</p>

<p>Fri Aug  5 15:55:33 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/test_object.rb: tests that respond_to? returns false.</p>

<p>Fri Aug  5 13:32:43 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/xmlrpc/client.rb, lib/xmlrpc/server.rb: should use 	 
String#bytesize instead of String#size.</p>

<p>Fri Aug  5 12:18:20 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (check_funcall): try respond_to? first if redefined. 	  [Bug
#5158]</p>

<p>Fri Aug  5 09:48:22 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Import RubyGems 1.8.7: 	  Added missing require for `gem
uninstall –format-executable`.</p>

<p>The correct name of the executable being uninstalled is now displayed 	 
with –format-executable.</p>

<p>Fixed `gem unpack uninstalled_gem` default version picker.</p>

<p>RubyGems no longer claims a nonexistent gem can be uninstalled.</p>

<p>`gem which` no longer claims directories are requirable files.</p>

<p>`gem cleanup` continues cleaning up gems if one can&#39;t be uninstalled
	  due to permissions.  Issue #82.</p>

<p>Gem repository directories are no longer created world-writable. 	 
Patch by Sakuro OZAWA.  [Ruby 1.9 - Bug #4930]</p>

<p>Fri Aug  5 07:00:31 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/io/console/test_io_console.rb (test_noctty): daemon() on 	  Fedora
Rawhide seems not to detach the controlling terminal, 	  when the argument
noclose is non-zero.  ref: [Bug #5135]</p>

<p>Thu Aug  4 23:48:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* thread_pthread.c (native_cond_signal): retry to call pthread_cond_signal
	  and pthread_cond_broadcast if they return EAGAIN in 	 
native_cond_signal and native_cond_broadcast, respectively. 	  It is for
the pthread implementation of Mac OS X 10.7 (Lion). 	  fixes #5155. 
[ruby-dev:44342].</p>

<p>* thread_pthread.c (native_cond_broadcast): ditto.</p>

<p>* thread_pthread.c (struct cached_thread_entry): stop using 	 
pthread_cond_t and its functions directly.</p>

<p>* thread_pthread.c (register_cached_thread_and_wait): ditto.</p>

<p>* thread_pthread.c (use_cached_thread): ditto.</p>

<p>Thu Aug  4 20:29:41 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* configure.in: when Solaris cc, use $(CC) to link shared libs.</p>

<p>Thu Aug  4 20:19:11 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* error.c (report_bug): use a small message buffer instead of BUFSIZ. 	 
It is needed for avoiding nested SIGSEGV on Linux. 	  Note: BUFSIZ is not
proper buffer size. It&#39;s unrelated with maximum 	  filename length. :-/
	  [Bug #5139] [ruby-dev:44315]</p>

<p>Thu Aug  4 16:08:45 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (gem): install all gemspecs under lib and ext.</p>

<p>* tool/rbinstall.rb (Gem::Specification): may not be defined when 	 
cross-compiling and BASERUBY is 1.8.</p>

<p>Thu Aug  4 11:30:36 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/missing.h: define __syscall on OpenBSD as r32702.</p>

<p>Thu Aug  4 03:02:54 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* tool/rbinstall.rb: use rubygems to load gemspecs, copy actual 	 
gemspecs on install rather than generate fake ones for all gems.</p>

<p>Thu Aug  4 02:45:10 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* configure.in: set CXX variable to the C++ compiler that matches the 	  C
compiler specified by CC variable (e.g. use g++-4.2 for gcc-4.2).</p>

<p>Thu Aug  4 02:21:10 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (link_command): use static library only for bundled 	 
extensions.  [Bug #5147]</p>

<p>Thu Aug  4 02:02:10 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/psych.gemspec: installing psych as a gem.</p>

<p>Wed Aug  3 16:01:35 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* util.c, include/ruby/util.h (ruby_add_suffix): remove the function. 	 
[Bug #5153] [ruby-core:38736]</p>

<p>* io.c (argf_next_argv): remove the call of above function.</p>

<p>* ext/-test-/add_suffix, test/-ext-/test_add_suffix.rb: remove the test 	 
extension module because this is only for testing ruby_add_suffix().</p>

<p>* LEGAL: remove the mention about a part of util.c, because now we 	 
removed the part.</p>

<p>* io.c (argf_next_argv): now the new filename is not guaranteed to 	  use,
so should check the return value of rename(2).</p>

<p>* test/ruby/test_argf.rb (TestArgf#test_inplace_rename_impossible): 	  now
we expect same result with other platforms on no_safe_rename 	  platforms
(=Windows).</p>

<p>Wed Aug  3 09:18:08 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* test/xmlrpc/webrick_testing.rb (WEBrick_Testing#start_server): 	  Like
r32795, bind address should be specified.</p>

<p>Wed Aug  3 07:46:30 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* encoding.c (enc_find): mistakenly remained !.  [Bug #5150]</p>

<p>Wed Aug  3 00:11:08 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/prettyprint.rb: update document.  [ruby-core:36776]</p>

<p>Tue Aug  2 22:04:46 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c (init_heap): allocate sigaltstack after heaps are allocated. 	 
[ruby-dev:44315] [Bug #5139]</p>

<p>* vm.c (thread_free): use free because objspace is not ready.</p>

<p>* vm.c (th_init): use malloc because objspace is not ready.</p>

<p>Tue Aug  2 20:10:16 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* test/testunit/test_parallel.rb: pass “–ruby” option to 	 
test/testunit/tests_for_parallel/runner.rb. [Bug #5132] [ruby-dev:44303]</p>

<p>Tue Aug  2 15:53:37 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* encoding.c (str_to_encoding): rename from to_encoding and 	  use
str_to_encindex.</p>

<p>* encoding.c (str_to_encindex): split from to_encoding.</p>

<p>* encoding.c (rb_to_encoding): use str_to_encoding.</p>

<p>* encoding.c (rb_obj_encoding): don&#39;t bypass rb_encoding*. 	  If it
uses rb_encoding*, it bypass encindex. If it uses encindex, 	  it
doesn&#39;t bypass.</p>

<p>* encoding.c (enc_find): add shortcut for encoding object, use 	 
str_to_encindex, and avoid bypass rb_encoding*.</p>

<p>Tue Aug  2 12:03:16 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (recursive_hash): hash value of emptied hash should be 	  equal
to an empty hash.  [ruby-core:38650]</p>

<p>Tue Aug  2 11:42:15 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_enc_symname2_p): :! is valid symbol.  [Bug #5136]</p>

<p>Tue Aug  2 07:33:29 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* test/net/http/test_http.rb
(TestNetHTTP_version_1_1_methods#test_timeout_during_HTTP_session): 	  If
you connect to localhost, you should listen localhost.</p>

<p>* test/net/http/test_https.rb
(TestNetHTTPS#test_timeout_during_SSL_handshake): 	  ditto.</p>

<p>Tue Aug  2 06:18:15 2011  Luis Lavena  &lt;luislavena@gmail.com&gt;</p>

<p>* lib/rubygems/installer.rb (class Gem): Correct path check on Windows 	 
Possible fix for [Ruby 1.9 - Bug #5111] 	*
test/rubygems/test_gem_installer.rb (load Gem): ditto</p>

<p>Mon Aug  1 20:12:03 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/ruby/test_process.rb (TestProcess#windows?): new method.</p>

<p>* test/ruby/test_process.rb (TestProcess#*): use above method.</p>

<p>* test/ruby/test_process.rb (TestProcess#test_execopts_redirect): 	 
windows doesn&#39;t support FD_CLOEXEC.</p>

<p>Mon Aug  1 15:45:23 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rake/test_rake_functional.rb:  Don&#39;t assume the binary name of
	  ruby is “ruby”.  [Ruby 1.9 - Bug #5114] 	* test/rake/helper.rb:  ditto</p>

<p>Mon Aug  1 15:31:14 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* test/io/console/test_io_console.rb (TestIO_Console#test_sync): 	  Skip
when PTY allocation failed (that&#39;s not our fault).</p>

<p>Mon Aug  1 15:04:12 2011  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* test/xmlrpc/test_webrick_server.rb (Test_Webrick#setup_http_server): 	 
XMLRPC::Client.new3(), when called without host: argument, tries 	  to 
connect to  a host  where “localhost”  resolves to.   On the 	  other  hand
a  WEBrick::HTTPServer.new(), when  called  without 	  BindAddress: 
argument, tries  to listen  all the  address where 	 
getaddrinfo(AF_UNSPEC) resolves to.   This is a mismatch because 	 
“localhost” might not resolve to one of those listening sockets. 	  We 
would  better explicitly  specify  “localhost”  here and  if 	  failed,
just skip the whole test.</p>

<p>Mon Aug  1 14:24:56 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc.rb:  Import RDoc 3.9.1.  Fixes bugs in the RDoc::Markup 	 
parser.</p>

<p>Mon Aug  1 12:00:35 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* insns.def (concatstrings): don&#39;t use initial ASCII-8BIT string. 	 
[ruby-core:38635] [Bug #5126]</p>

<p>Sun Jul 31 22:57:16 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* enc/Makefile.in (ECHO1): Same as the recent fix in common.mk. 	  “:” in
a make variable replacement cause a syntax error with 	  /usr/ccs/bin/make
on Solaris.  Uses $(NULLCMD) instead.</p>

<p>Sun Jul 31 21:16:02 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* complex.c (f_signbit): gcc4 on Solaris DOES have signbit but does 	  not
have it on header.</p>

<p>* math.c: ditto.</p>

<p>Sun Jul 31 21:09:04 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* common.mk (node_name.inc): Use $(Q) for consistency.</p>

<p>* Makefile.in (INSNS): ditto.</p>

<p>Sun Jul 31 21:19:51 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* lib/mkmf.rb (configuration:ECHO1): Same as the recent fix in 	 
common.mk. 	  “:” in a make variable replacement cause a syntax error with
	  /usr/ccs/bin/make on Solaris.  Uses $(NULLCMD) instead.</p>

<p>Sun Jul 31 20:39:12 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* common.mk (ECHO1): nmake does not allow parenthesis in make variable 	 
replacement.</p>

<p>Sun Jul 31 23:06:57 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (check_env): print debug messages to stderr. 	[Feature #4871]
[ruby-dev:43743]</p>

<p>Sun Jul 31 22:50:23 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c (vm_make_env_each): don&#39;t save prev env value. 	It is no longer
used. [Feature #4871] [ruby-dev:43743]</p>

<p>* vm.c (check_env): changed accordingly.</p>

<p>Sun Jul 31 20:21:36 2011  “Yuki Sonoda (Yugui)”  &lt;yugui@yugui.jp&gt;</p>

<p>* common.mk (ECHO1): “:” in a make variable replacement cause a syntax 	 
error with /usr/ccs/bin/make on Solaris.  Uses $(NULLCMD) instead.</p>

<p>* configure.in (NULLCMD): new check.</p>

<p>* Makefile.in (NULLCMD): Reflects checking in configure.</p>

<p>* win32/Makefile.sub (NULLCMD): new assignment.</p>

<p>Sun Jul 31 18:58:59 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_pipe): pipe on cygwin can succeed half but fail 	  half.</p>

<p>Sun Jul 31 11:31:07 2011  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm.c: check if cfp is valid. [Bug #5083] [ruby-dev:44208]</p>

<p>Sun Jul 31 09:18:28 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rdoc:  Update to RDoc 3.9.  Fixed `ri []`, stopdoc creating an 	 
object reference, nodoc for class aliases, verbatim === lines.</p>

<p>Sun Jul 31 01:29:08 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_each_byte): remove unused variable e.</p>

<p>Sat Jul 31 01:23:45 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* test/bigdecimal/test_bigdecimal.rb (test_version): removed.</p>

<p>Sat Jul 30 23:19:09 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* defs/default_gems: separate from tool/rbinstall.rb.</p>

<p>Sat Jul 30 23:14:44 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_each_byte): rbuf can be refreshed during yield. 	  [Bug
#5119]</p>

<p>Sat Jul 30 22:35:50 2011  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* strftime.c (NEEDS): avoid SEGV due to integer overflow in 	 
sparc-solaris2.10 and i686-linux.  fix [Bug #4456] [ruby-dev:43284]</p>

<p>Sat Jul 30 17:26:26 2011  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* test/win32ole/test_win32ole_variant.rb: use skip method to skip the
test.</p>

<p>* test/win32ole/test_win32ole_variant_outarg.rb: ditto.</p>

<p>Sat Jul 30 14:27:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (BigDecimal_version): version 1.1.0.</p>

<p>* ext/bigdecimal/bigdecimal.gemspec: turn into a default gem.</p>

<p>* tool/rbinstall.rb: ditto.</p>

<p>Sat Jul 30 11:21:55 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm_core.h (ALT_STACK_SIZE): use MINSIGSTKSZ*2 instead of SIGSTKSZ*2. 	 
[ruby-core:38607]</p>

<p>Sat Jul 30 10:39:14 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm.c (th_init): preallocate alternative stack. 	  NoMemoryError is
better than rb_bug, of course. 	  Patch by Eric Wong. [<a
href="ruby-core:38594">ruby-core:38572]</a>.</p>

<p>* signal.c (rb_register_sigaltstack): ditto.</p>

<p>* vm_core.h: moved ALT_STACK_SIZE definition from signal.c. 	* vm.c
(thread_free): use xfree() instead of free().</p>

<p>Sat Jul 30 07:20:49 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/lib/socket.rb (udp_server_sockets): unused variable 	 
removed. 	  patch by Jeremy Evans.  [ruby-core:38600]</p>

<p>Fri Jul 29 23:56:32 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* lib/securerandom.rb: call OpenSSL::Random.seed at the 	 
SecureRandom.random_bytes call. 	  based on the patch by Masahiro Tomita. 
[ruby-dev:44270]</p>

<p>Fri Jul 29 23:53:48 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_set_len): new function to set array length.</p>

<p>* vm_eval.c (method_missing): set the length of argv array, to mark 	 
arguments.</p>

<p>* vm_eval.c (rb_apply): get rid of too large alloca.</p>

<p>Fri Jul 29 20:48:39 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/mkconstants.rb: fix typos.</p>

<p>Fri Jul 29 20:28:56 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/mkconstants.rb: use whitespaces as a separator.</p>

<p>Fri Jul 29 18:59:07 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/mkconstants.rb: add documents for constants. 	  patch by Eric
Hodel.  [ruby-core:37853] [Bug #4989]</p>

<p>Fri Jul 29 16:00:43 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (enable_pthread): use -pthread on OpenBSD without 	 
explicit option. patched by Jeremy Evans. [ruby-core:38572]</p>

<p>Thu Jul 28 23:36:28 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* ext/fiddle/closure.c (callback): use rb_ary_tmp_new() instead of 	 
xmalloc() to allocate an array for arguments of callback procedure, 	  to
prevent arguments from being swept by GC. [ruby-core:38546] 	  [Bug #4929]</p>

<p>Thu Jul 28 22:36:06 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_cipher.c (ossl_cipher_initialize): Avoid possible 	 
SEGV from AES encryption/decryption. Processing data by 	  Cipher#update
without initializing key (meaningless usage of Cipher 	  object since we
don&#39;t offer a way to export a key) could cause SEGV.</p>

<p>In OpenSSL, the EVP which has EVP_CIPH_RAND_KEY flag (such as DES3) 	 
allows uninitialized key, but other EVPs (such as AES) does not 	  allow
it. Calling EVP_CipherUpdate() without initializing key causes 	  SEGV so
we set the data filled with “0” as the key by default. See 	  #2768.</p>

<p>* test/openssl/test_cipher.rb: test it.</p>

<p>Thu Jul 28 14:25:08 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/rubygems/user_interaction.rb (Gem::StreamUI#tty?): typo.</p>

<p>Thu Jul 28 12:32:53 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dl/callback/mkcallback.rb (gencallback): use PTR2NUM.</p>

<p>* ext/dl/cptr.c (rb_dlptr_aref, rb_dlptr_aset): check NULL pointer 	 
dereference.</p>

<p>* ext/dl/cptr.c (rb_dlptr_s_to_ptr): use rb_check_funcall.</p>

<p>* ext/dl/cptr.c (rb_dlptr_s_to_ptr): fix wrapping condition.</p>

<p>Thu Jul 28 04:53:31 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/delegate.rb:  Move file-level documentation to the appropriate 	 
classes.</p>

<p>Thu Jul 28 02:15:04 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/dl/cfunc.c (dlcfunc_mark), ext/dl/cptr.c (dlptr_mark): 	  workaround
to mark wrapped object.  this is not a true fix, 	  because [Bug #4929] is
caused by the interface design of DL.</p>

<p>Thu Jul 28 00:28:15 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/fileutils/test_fileutils.rb: add OpenBSD case. 	  patched by Jeremy
Evans [ruby-core:38530] see #5097</p>

<p>* test/ruby/test_process.rb: ditto.</p>

<p>Wed Jul 27 22:46:59 2011  CHIKANAGA Tomoyuki  &lt;nagachika00@gmail.com&gt;</p>

<p>* test/rinda/test_rinda.rb (test_remote_array_and_hash): 	  add local
variables to protect objects from GC. [ruby-dev:44253] 	  [Bug #5104]</p>

<p>Wed Jul 27 17:55:54 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/missing.h: define __syscall if the platform has 	 
__syscall in the library but doesn&#39;t define it in headers 	  for
example Mac OS X.</p>

<p>Wed Jul 27 15:39:14 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* object.c:  Add usage documentation for BasicObject.  Based on patch 	 
by Thomas Sawyer.  [Ruby 1.9 - Bug #5067]</p>

<p>Wed Jul 27 12:24:17 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/uninstaller.rb:  Add missing require and update 	 
messaging to avoid confusion with uninstall –format-executable. 	  [Ruby
1.9 - Bug #4062]</p>

<p>Wed Jul 27 09:34:24 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems:  Update to RubyGems 1.8.6.1.</p>

<p>Wed Jul 27 09:27:59 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_pkcs12.rb: Add test and intermediate certificates. 	 
[ Ruby 1.9 - Feature #3793 ] [ruby-core:32088]</p>

<p>Wed Jul 27 01:05:32 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval_error.c (rb_print_undef_str): new function to raise 	  NameError
for undefined method.</p>

<p>* load.c (rb_mod_autoload_p), object.c (rb_mod_const_get), 	  variable.c
(rb_f_untrace_var, set_const_visibility), vm_method.c 	 
(rb_mod_<code>remove,undef,alias</code>_method, set_method_visibility): 	  remove
inadvertent symbol creation.  based on the first patch by 	  Jeremy Evans
at [ruby-core:38447].  [Feature #5089]</p>

<p>* vm_method.c (obj_respond_to): fix the respond_to_missing? override 	 
case.  based on the patch by Jeremy Evans at [ruby-core:38417]. 	  [Feature
#5072]</p>

<p>* parse.y (rb_check_id): make the given name a symbol or a string. 	 
based on the second patch by Jeremy Evans at [ruby-core:38447]</p>

<p>Wed Jul 27 00:50:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/util.rb (Rational#to_d): 	  zero or
negative precision is error.  fixes #5098. 	  [ruby-dev:44210]</p>

<p>* test/bigdecimal/test_bigdecimal_util.rb: add test for the above 	 
change.</p>

<p>Wed Jul 27 00:48:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/util.rb (Float#to_d): modified for 	 
specifying precision.  fixes #5098.  [ruby-dev:44210]</p>

<p>* test/bigdecimal/test_bigdecimal_util.rb: add test for the above 	 
change.</p>

<p>Wed Jul 27 00:45:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/util.rb (Integer#to_d): added 	  for
symmetry to BigDecimal() function with an Integer. 	  fixes #5098. 
[ruby-dev:44210]</p>

<p>* test/bigdecimal/test_bigdecimal_util.rb: add test for the above 	 
change.</p>

<p>Wed Jul 27 00:30:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ext/bigdecimal/lib/bigdecimal/util.rb (BigDecimal#to_d): added 	  for
adapting other Numeric subclasses.  [ruby-dev:44245]</p>

<p>* test/bigdecimal/test_bigdecimal_util.rb: test for the above change.</p>

<p>Wed Jul 27 00:27:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bigdecimal/bigdecimal.c (VpDup) a new function for duplicating 	  a
BigDecimal.</p>

<p>* bigdecimal/bigdecimal.c (BigDecimal_new): support generating a new 	 
BigDecimal from another BigDecimal using BigDecimal global function 	  or
constructor.  [ruby-dev:44245]</p>

<p>Tue Jul 26 23:33:24 2011  Igor Zubkov  &lt;igor.zubkov@gmail.com&gt;</p>

<p>* array.c: Fix typo. <a
href="https://github.com/ruby/ruby/pull/36">github.com/ruby/ruby/pull/36</a></p>

<p>Mon Jul 25 23:51:01 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* proc.c: pre-allocate the unlinked_method_entry_list_entry struct to 	 
avoid memory allocation during GC.  based on a patch from Eric Wong. 	 
[ruby-core:38498]</p>

<p>Mon Jul 25 23:39:33 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/rake/test_rake_directory_task.rb (TestRakeDirectoryTask# 	 
test_directory_win32): fixed wrong test.</p>

<p>Mon Jul 25 22:36:11 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* proc.c (struct METHOD), gc.c (gc_marks), vm_method.c 	 
(rb_gc_mark_unlinked_live_method_entries): fix SEGV bug. 	 
rb_method_entry_t was free&#39;d even when the method is still on the 	 
stack if it is BMETHOD (i.e., Method#call).  This is because 	 
rb_method_entry_t is embedded in struct METHOD.  This commit 	  separates
them and marks the live method entries. 	  See [ruby-core:38449] in detail.
fix [Bug #5047] [ruby-core:38171]</p>

<p>Mon Jul 25 22:14:37 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* lib/xmlrpc/client.rb: Fix possible HTTP header formatting failure by 	 
&#39;Basic&#39; header. Long username caused the base64 String truncation
in 	  HTTP header which is not allowed. See #5046.</p>

<p>* test/xmlrpc/test_webrick_server.rb: test it.</p>

<p>Mon Jul 25 15:04:33 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/openssl/lib/openssl.rb: End of transition period introduced by 	 
[ruby-dev:38018]. From the next version of 1.9.3, you should use 	   
require “openssl” 	  instead of 	    require “openssl/ssl” 	  and 	   
require “openssl/x509”</p>

<p>Mon Jul 25 13:46:38 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/openssl/lib/openssl/x509.rb: Cosmetic change: move definition 	 
introduced in r30152 to x509-internal.rb.</p>

<p>Mon Jul 25 13:09:42 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_ssl_shutdown): Avoid randomly generated 	 
SSLError from SSLSocket just after invoking SSLSocket#close. 	 
OpenSSL&#39;s SSL_shutdown could try to send alert packet and it might 	 
set SSLerr(global error stack) as the result. It causes the next 	  SSL
read/write operation to fail by unrelated reason.</p>

<p>By design, we&#39;re ignoring any error at SSL_shutdown() so we clear 	 
global error stack after SSL_shutdown is called. See #5039.</p>

<p>Sun Jul 24 20:29:53 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/extconf.rb: refine the recvmsg test.</p>

<p>Sun Jul 24 20:02:31 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/extconf.rb: fix the recvmsg test.</p>

<p>Sun Jul 24 08:42:51 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/extconf.rb: test recvmsg allocates file descriptors for 	  fd
passing even with MSG_PEEK.</p>

<p>* ext/socket/ancdata.c: use the above test result.</p>

<p>Sun Jul 24 01:04:50 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/rubygems/specification.rb:  Restore behavior of 	 
Gem::Specification#loaded.  [Ruby 1.9 - Bug #5032]</p>

<p>Sun Jul 24 00:05:00 2011  Jeremy Evans 
&lt;merch-redmine@jeremyevans.net&gt;</p>

<p>* error.c (rb_name_error_str): new function to raise NameError 	  with the
name string but not ID.</p>

<p>* object.c, proc.c, variable.c: more removal of inadvertent symbol 	 
creation.  [Feature #5079]</p>

<p>Sat Jul 23 21:14:00 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* lib/cmath.rb (cbrt): should return a real number if possible.</p>

<p>Sat Jul 23 20:12:52 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/rake/test_rake_functional.rb (setup): Use __FILE__ for the base 	 
directory. Current directory is not the top source directory when 	  the
building process runs on other than there.</p>

<p>* test/rake/test_rake_rake_test_loader.rb: ditto.</p>

<p>* test/rake/test_rake_task_argument_parsing.rb 	 
(test_terminal_width_using_hardcoded_80): hardcoded 80 is used 	  when
app.unix? is false.</p>

<p>Sat Jul 23 20:11:50 2011  Tadayoshi Funaba  &lt;tadf@dotrb.org&gt;</p>

<p>* ext/date/date_core.c: an issue that is same as  [ruby-dev:44071]. 	*
ext/date/date_strftime.c: identical to [ruby-dev:44112].</p>

<p>Sat Jul 23 19:12:53 2011  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* test/win32ole/test_err_in_callback.rb (test_err_in_callback): 	  skip
test if ADODB.connection is not available.</p>

<p>Sat Jul 23 15:37:04 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* parse.y (rb_enc_symname_type): :$a!, @a! and so on are not 	  valid
symbols, so they should be inspected with quotes.</p>

<p>Sat Jul 23 17:06:25 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_update_max_fd): validate fd.</p>

<p>* ext/socket/rubysocket.h (rsock_discard_cmsg_resource): add 	  msg_peek_p
argument for the declaration.</p>

<p>* ext/socket/ancdata.c (discard_cmsg): add msg_peek_p argument. 	  assume
FreeBSD, NetBSD and MacOS X doesn&#39;t generate passed fd 	  when
MSG_PEEK. 	  (rsock_discard_cmsg_resource): add msg_peek_p argument. 	 
(bsock_recvmsg_internal): call rsock_discard_cmsg_resource with 	 
msg_peek_p argument.</p>

<p>* ext/socket/unixsocket.c (unix_recv_io): call 	 
rsock_discard_cmsg_resource with msg_peek_p argument.</p>

<p>Sat Jul 23 14:38:28 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* test/rake*: Remove dependencies on flexmock and session gems. 	  [Ruby
1.9 - Bug #4987]</p>

<p>Sat Jul 23 12:19:04 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_check_id): take care of attrset ID created 	  implicitly by
local ID.  [Bug #5084]</p>

<p>* parse.y (rb_check_id): conversion condition was inverse. 	  [Bug #5084]</p>

<p>Fri Jul 22 21:46:54 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* vm_insnhelper.c (vm_call_cfunc): added volatile for a workaround 	  of
cfp consistency error problem on OS X 10.7 (Lion). It&#39;s 	  suspected
llvm optimization bug. 	  [Bug #5074] [ruby-dev:44185]</p>

<p>Fri Jul 22 21:18:20 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/generic.rb (WFKV_): unroll the loop of regexp.</p>

<p>* lib/uri/generic.rb (URI.decode_www_form_component): ditto.</p>

<p>Fri Jul 22 21:06:39 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_mod_<code>const,cvar</code>_defined, rb_obj_ivar_defined): 	  avoid
inadvertent symbol creation in reflection methods.  based 	  on a patch by
Jeremy Evans at [ruby-core:38367].  [Feature #5072]</p>

<p>* vm_method.c (rb_mod_method_defined) 	 
(rb_mod_<code>public,private,protected</code>_method_defined) 	  (obj_respond_to):
ditto.</p>

<p>* parse.y (rb_check_id): new function returns already interned ID 	  or 0.</p>

<p>Fri Jul 22 20:44:49 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_is_global_id, rb_is_attrset_id): add missing 	  predicates.</p>

<p>Fri Jul 22 20:24:38 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/ruby/test_object.rb (TestObject#test_respond_to_missing): 	  2nd
argument of respond_to_missing? is not optional.</p>

<p>Fri Jul 22 19:05:47 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (rb_enc_symname2_p): get rid of potential out-of-bound 	 
access.</p>

<p>Fri Jul 22 13:55:59 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* lib/net/http.rb:  Net::HTTP#finish is used to manually close 	 
connections.  [Ruby 1.9 - Bug #5045]</p>

<p>Fri Jul 22 13:51:29 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* ext/readline/readline.c:  Add examples for Readline.completion_proc=. 	 
[Ruby 1.9 - Bug #5057]</p>

<p>Fri Jul 22 13:03:12 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_hmac.c: Revert checking return type of 	  HMAC_Init_ex
as it is not compatible with OpenSSL &lt; 1.0.0.</p>

<p>Fri Jul 22 12:10:21 2011  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* tool/rbinstall.rb (default gems):  Install executables into the fake 	 
gem dir for Gem.bin_path.  [#4485]</p>

<p>Fri Jul 22 11:20:20 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_digest.c: Check return value of EVP_DigestInit_ex. 	*
ext/openssl/ossl_hmac.c: Check return value of HMAC_Init_ex. 	  Thanks,
Jared Jennings, for the patch. 	  [ Ruby 1.9 - Bug #4944 ]
[ruby-core:37670]</p>

<p>Fri Jul 22 09:09:43 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* ext/openssl/ossl_engine.c: Avoid double free of ENGINE reference. 	*
test/openssl/test_engine.rb: Add a test for it. 	  Thanks to Ippei Obayashi
for providing the patch. 	  [ Ruby 1.9 - Bug #5062 ] [ruby-dev:44173]</p>

<p>Fri Jul 22 06:37:13 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/csv.rb: Do not modify CSV.generate&#39;s argument [ruby-core:38356]</p>

<p>Thu Jul 21 20:59:59 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* ext/socket/ancdata.c (discard_cmsg): workaround for MacOS X Lion.</p>

<p>Thu Jul 21 20:02:11 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* thread.c (set_trace_func, thread_set_trace_func_m): reset tracing 	 
state when set_trace_func hook is removed.  This is workaround patch 	  to
force to reset tracing state that is broken by continuation call. 	  a
patch from James M. Lawrence.  [Feature #4347] [ruby-core:34998]</p>

<p>* test/ruby/test_continuation.rb (class TestContinuation): add a test 	 
for above.  a patch from James M. Lawrence.</p>

<p>Thu Jul 21 19:27:19 2011  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>* node.c (dump_node): add today&#39;s knowledge.  “init arguments (m)” and
	  “init arguments (p)” of compile.c indicates a Ruby code that 	 
evaluates multiple assignments that is in method or block 	  parameters: 
def foo((m1,m2), (m3,m4), *r, (p1,p2), (p3,p4)); end 	  The former (init
arguments (m)) evaluates the multiple assignments 	  before rest argument,
that are (m1,m2) and (m3,m4).  The letter 	  (init arguments (p)) does ones
after rest argument, that are 	  (p1,p2) and (p3, p4).</p>

<p>Thu Jul 21 18:11:07 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* enum.c (enum_inject): remove empty line to notify rdoc 	 
Enumerable#reduce is alias. patched by milki@github. 	  <a
href="https://github.com/ruby/ruby/pull/26">github.com/ruby/ruby/pull/26</a></p>

<p>Thu Jul 21 17:30:21 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_delete_at_m): use simple array literal in rdoc. 	 
patched by samuel tonini. [ruby-core:38310] [Bug #5066]</p>

<p>Thu Jul 21 17:14:21 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/webrick/httprequest.rb (WEBrick::HTTPRequest#each): 	  Allow
HTTP/0.9 request which doesn&#39;t has any header or body. 	  patched by
Felix Jodoin. [ruby-core:38040] [Bug #5022]</p>

<p>Wed Jul 20 23:02:18 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* io.c (rb_update_max_fd): remove parentheses. they are not in 	  macro.</p>

<p>Wed Jul 20 22:22:23 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* include/ruby/intern.h (rb_update_max_fd): declaration moved from 	 
internal.h.</p>

<p>* file.c: ditto.</p>

<p>* io.c: call rb_update_max_fd for each new fds.</p>

<p>* process.c: ditto.</p>

<p>* random.c: ditto.</p>

<p>* ruby.c: ditto.</p>

<p>* ext/io/console/console.c: ditto.</p>

<p>* ext/openssl/ossl_bio.c: ditto.</p>

<p>* ext/pty/pty.c: ditto.</p>

<p>* ext/socket/init.c: ditto.</p>

<p>* ext/socket/socket.c: ditto.</p>

<p>* ext/socket/ancdata.c: ditto.</p>

<p>* ext/socket/unixsocket.c: ditto.</p>

<p>Wed Jul 20 15:16:22 2011  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/dl/handle.c (dlhandle_sym): clear previous error with dlerror() 	 
before calling dlsym(). [ruby-dev:44091] [Bug #5021]</p>

<p>Wed Jul 20 07:16:26 2011  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* NEWS: mention Kernel#warn.  [ruby-core:38119] [Feature #5029]</p>

<p>Tue Jul 19 16:40:45 2011  TAKANO Mitsuhiro (takano32)  &lt;tak@no32.tk&gt;</p>

<p>* cont.c (cont_save_thread): fix missing semicolon.</p>

<p>Tue Jul 19 16:25:15 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (UPDATE_MAXFD): removed.</p>

<p>Tue Jul 19 16:07:45 2011  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* io.c (rb_update_max_fd): new function.</p>

<p>* internal.h (rb_update_max_fd): declare rb_update_max_fd.</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): update max fd when 	 
timer thread pipe is created.</p>

<p>Mon Jul 18 13:36:47 2011  Aaron Patterson
&lt;aaron@tenderlovemaking.com&gt;</p>

<p>* ext/psych/lib/psych.rb: define a new BadAlias error class.</p>

<p>* ext/psych/lib/psych/visitors/to_ruby.rb: raise an exception when 	 
deserializing an alias that does not exist.</p>

<p>* test/psych/test_merge_keys.rb: corresponding test.</p>

<p>Mon Jul 18 00:00:46 2011  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* ext/curses/curses.c: added the new class Curses::Pad, which 	  supports
scrolling.  patch by Eric Hodel.  [Feature #4896] 	  [ruby-core:37206]</p>

<p>Sun Jul 17 16:26:40 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_check_trusted): new function to check an object is 	 
trusted.</p>

<p>* struct.c (rb_struct_modify), time.c (time_modify): check by the 	  above
function to show proper class names.  [Bug #5036]</p>

<p>Sun Jul 17 15:30:04 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_warn_m): accept multiple args in like puts.  rdoc 	  patch
by Erik Price at [ruby-core:38119].  [Feature #5029]</p>

<p>Sun Jul 17 07:56:31 2011  Martin Bosslet 
&lt;Martin.Bosslet@googlemail.com&gt;</p>

<p>* test/openssl/test_ssl_session.rb: add PEM SSL session without TLS 	 
extensions. Use this as the default for the tests to ensure 	 
compatibility with OpenSSL 0.9.7. 	  [ Ruby 1.9 - Bug #4961 ]
[ruby-core:37726]</p>

<p>Sat Jul 16 17:29:20 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_UNIVERSAL_ARCH): restore arch flag. 	  Bug #4977</p>

<p>Sat Jul 16 06:27:51 2011  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/uri/common.rb (module): Remove optional parser argument to 	 
Kernel#URI 	  [ruby-core:38061]</p>

<p>* lib/uri/generic.rb (module): ditto</p>

<p>Sat Jul 16 03:19:45 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (is_socket, is_console): add prototypes to fix compile 	 
problem with gcc introduced at r32549. 	  reported by Jon Forums. [Bug
#5030] [ruby-core:38079]</p>

<p>Sat Jul 16 00:55:38 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* time.c (time_dup): used rb_obj_class() instead of CLASS_OF(). 	  The
patch is made by Kazuki Tsujimoto. [Bug #5012] [ruby-dev:44071]</p>

<p>* test/ruby/test_time.rb (TestTime#test_getlocal_dont_share_eigenclass): 	
added a new test for eigenclass of time object.</p>

<p>Fri Jul 15 19:11:00 2011  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (bigsub_int): add RB_GC_GUARD.  This patch is made by 	  Makoto
Kishimoto.  fixes #4223 [ruby-dev:42907]</p>

<p>* bignum.c (bigadd_int): ditto.</p>

<p>Fri Jul 15 14:27:53 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c, include/ruby/win32.h (rb_w32_io_cancelable_p): renamed 	 
from rb_w32_has_cancel_io().  now it takes a parameter as fd to check 	 
the fd is console or not, because we cannot cancel console input even 	  if
we have cancel_io function.</p>

<p>* io.c (WAIT_FD_IN_WIN32): call above function instead of the old one, 	 
so now we can kill the thread which calls STDIN.gets. 	  the problem was
reported by ko1 via IRC.</p>

<p>Fri Jul 15 09:10:41 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/digest/sha2/sha2.c (SHA256_Update, SHA512_Update): avoid Bus 	 
Error caused by unalignment access on Sparc-Solaris (and possibly on 	 
other similar environment.) This patch just do memcpy always instead 	  of
checking architecture. I see no perf drop on my 64bit env. For 	  more
details, see #4320.</p>

<p>* test/digest/test_digest.rb: add test for unalignment access.</p>

<p>Fri Jul 15 01:51:25 2011  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* regint.h (PLATFORM_UNALIGNED_WORD_ACCESS): Power PC does not 	  allow
unaligned word access.</p>

<p>* st.c (UNALIGNED_WORD_ACCESS): x86_64 allows unaligned word 	  access as
well as i386.</p>

<p>Thu Jul 14 12:19:34 2011  Hiroshi Nakamura  &lt;nahi@ruby-lang.org&gt;</p>

<p>* ext/openssl/ossl.c (ossl_verify_cb): trap the exception from 	  verify
callback of SSLContext and X509Store and make the 	  verification fail
normally. Raising exception directly from callback 	  causes orphan
resources in OpenSSL stack. Patched by Ippei Obayashi. 	  See #4445.</p>

<p>* test/openssl/test_ssl.rb 	 
(test_exception_in_verify_callback_is_ignored): test it.</p>

<p>Tue Jul 12 23:41:49 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* NEWS: add a description of Signal.trap change.</p>

<p>Tue Jul 12 20:02:35 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (reserved_signal_p): reverted a part of r32523. 	  chikanaga
noticed trap(:CHLD) has some realworld usecase. 	* test/ruby/test_signal.rb
(TestSignal#test_reserved_signal): 	  ditto.</p>

<p>Tue Jul 12 17:12:45 2011  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_add_method): should not call method_added hook 	  for
undef operation. [Bug #5015]</p>

<p>Tue Jul 12 16:58:44 2011  Shota Fukumori  &lt;sorah@tubusu.net&gt;</p>

<p>* lib/test/unit.rb(Test::Unit::Options#process_args): Fix bug. 	  Fix
process_args didn&#39;t return `@option` after r30939.</p>

<p>Tue Jul 12 14:07:46 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (install_sighandler): fixed a race.</p>

<p>Tue Jul 12 13:49:32 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* signal.c (sig_trap): don&#39;t permit to change a signal handler which 	
the interpreter reserved. 	* signal.c (reserved_signal_p): ditto. 	  [Bug
#2616] [ruby-core:27625]</p>

<p>* test/ruby/test_signal.rb (TestSignal#test_reserved_signal): 	  added a
test for reserved signal.</p>

<p>Tue Jul 12 11:58:28 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/setup.mak: support x86-amd64 cross compile environment.</p>

<p>Mon Jul 11 23:22:28 2011  Yutaka Kanemoto  &lt;kanemoto@ruby-lang.org&gt;</p>

<p>* time.c: can&#39;t compile time.c on AIX due to missing declaration for 	
ffs(). It is declared in strings.h on AIX.</p>

<p>Mon Jul 11 15:54:24 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* process.c: removed signal() macro. It&#39;s no longer used.</p>

<p>Mon Jul 11 15:02:24 2011  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* numeric.c (rb_num2ull): use FIX2LONG instead of FIX2ULONG. see 	 
rb_num2ulong(). fixed the problem of ObjectSpace._id2ref of IL32LLP64 	 
platforms, introduced at r32433.</p>

<p>Mon Jul 11 05:38:05 2011  Yutaka Kanemoto  &lt;kanemoto@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (get_stack): need to adjust stack addr for 	  [Bug
#1813] on AIX.</p>

<p>Mon Jul 11 01:16:27 2011  KOSAKI Motohiro 
&lt;kosaki.motohiro@gmail.com&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): removed 	 
rb_disable_interrupt()/rb_enable_interrupt(). 	* vm_core.h: ditto. 	*
process.c (static void before_exec): ditto. 	* process.c (static void
after_exec): ditto. 	  [Bug #4765] [ruby-dev:43571]</p>

<p>* eval_intern.h: removed rb_trap_restore_mask(). 	* vm_eval.c
(rb_throw_obj): ditto. 	* eval.c (setup_exception): ditto.</p>

<p>* signal.c: removed trap_last_mask. 	* signal.c (trap_restore_mask):
removed. 	* signal.c (init_sigchld): comment clarification why signal block
	  is needed. and removed trap_last_mask operation. 	* signal.c
(trap_ensure): removed trap_last_mask operation.</p>

<p>* signal.c (rb_disable_interrupt, rb_enable_interrupt): made 	  static and
removed sigdelset(SIGVTALRM) and sigdelset(SIGSEGV).</p>

<p>* process.c (rb_syswait): removed implicit signal handler change.</p>

<p>Sun Jul 10 23:49:12 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* docs/NEWS-1.9.3: moved from NEWS.</p>

<p>* docs/ChangeLog-1.9.3: merged ChangeLog for 1.9.3.</p>

<p>* NEWS: NEWS for 1.9.4 that describes changes since 1.9.3</p>

<p>* ChangeLog: new ChangeLog for 1.9.4.</p>

<p>Sun Jul 10 23:30:52 2011  Yuki Sonoda (Yugui)  &lt;yugui@yugui.jp&gt;</p>

<p>* version.h (RUBY_VERSION): ruby_1_9_3 branch was forked.</p>

<p>For the changes before 1.9.3, see doc/ChangeLog-1.9.3 For the changes
before 1.8.0, see doc/ChangeLog-1.8.0</p>

<p>Local variables: coding: us-ascii add-log-time-format: (lambda ()</p>

<pre class="code ruby"><code class="ruby">(let* ((time (current-time))</code></pre>

<p>(system-time-locale “C”) 	 (diff (+ (cadr time) 32400)) 	 (lo (% diff
65536)) 	 (hi (+ (car time) (/ diff 65536))))</p>

<pre class="code ruby"><code class="ruby">(format-time-string &quot;%a %b %e %H:%M:%S %Y&quot; (list hi lo) t)))</code></pre>

<p>indent-tabs-mode: t tab-width: 8 change-log-indent-text: 2 end: vim:
tabstop=8 shiftwidth=2</p>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>