<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Benchmark &mdash; benchmark Ruby-2.0.0 p247</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Benchmark",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.0.0</a> &raquo; 
          <a href='index.html'>benchmark</a> &raquo; 
          <a href='_index.html'>Index (B)</a> &raquo; 
          <span class='title'>Benchmark</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: Benchmark</h1>

<div class="box_info">



  <dl>
    <dt>Defined in:</dt>
    <dd>benchmark.rb</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The Benchmark module provides methods to measure and report the time used
to execute Ruby code.</p>
<ul><li>
<p>Measure the time to construct the string given by the expression
<code>&quot;a&quot;*1_000_000</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_puts'>puts</span> <span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_measure'>measure</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='op'>*</span><span class='int'>1_000_000</span> <span class='rbrace'>}</span>
</code></pre>

<p>On my machine (FreeBSD 3.2 on P5, 100MHz) this generates:</p>

<pre class="code ruby"><code class="ruby">1.166667   0.050000   1.216667 (  0.571355)</code></pre>

<p>This report shows the user CPU time, system CPU time, the sum of the user
and system CPU times, and the elapsed real time. The unit of time is
seconds.</p>
</li><li>
<p>Do some experiments sequentially using the <a href="#bm-instance_method" title="Benchmark#bm (method)">#bm</a> method:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='int'>50000</span>
<span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_bm'>bm</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span> <span class='lbrace'>{</span> <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_n'>n</span><span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>   <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span> <span class='lbrace'>{</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>The result:</p>

<pre class="code ruby"><code class="ruby">    user     system      total        real
1.033333   0.016667   1.016667 (  0.492106)
1.483333   0.000000   1.483333 (  0.694605)
1.516667   0.000000   1.516667 (  0.711077)</code></pre>
</li><li>
<p>Continuing the previous example, put a label in each report:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='int'>50000</span>
<span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_bm'>bm</span><span class='lparen'>(</span><span class='int'>7</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>for:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='lbrace'>{</span> <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_n'>n</span><span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>times:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>   <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>upto:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>  <span class='lbrace'>{</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>
</li></ul>

<p>The result:</p>

<pre class="code ruby"><code class="ruby">             user     system      total        real
for:     1.050000   0.000000   1.050000 (  0.503462)
times:   1.533333   0.016667   1.550000 (  0.735473)
upto:    1.500000   0.016667   1.516667 (  0.711239)</code></pre>
<ul><li>
<p>The times for some benchmarks depend on the order in which items are run. 
These differences are due to the cost of memory allocation and garbage
collection. To avoid these discrepancies, the #bmbm method is provided. 
For example, to compare ways to sort an array of floats:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_array'>array</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='int'>1000000</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_rand'>rand</span> <span class='rbrace'>}</span>

<span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_bmbm'>bmbm</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sort!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_array'>array</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sort</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>  <span class='lbrace'>{</span> <span class='id identifier rubyid_array'>array</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>  <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>The result:</p>

<pre class="code ruby"><code class="ruby">Rehearsal -----------------------------------------
sort!  11.928000   0.010000  11.938000 ( 12.756000)
sort   13.048000   0.020000  13.068000 ( 13.857000)
------------------------------- total: 25.006000sec

            user     system      total        real
sort!  12.959000   0.010000  12.969000 ( 13.793000)
sort   12.007000   0.000000  12.007000 ( 12.791000)</code></pre>
</li><li>
<p>Report statistics of sequential experiments with unique labels, using the
#benchmark method:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'>Benchmark</span>         <span class='comment'># we need the CAPTION and FORMAT constants
</span>
<span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='int'>50000</span>
<span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_benchmark'>benchmark</span><span class='lparen'>(</span><span class='const'>CAPTION</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='const'>FORMAT</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;total:</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;avg:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
  <span class='id identifier rubyid_tf'>tf</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>for:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='lbrace'>{</span> <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_n'>n</span><span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_tt'>tt</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>times:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>   <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_tu'>tu</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>upto:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>  <span class='lbrace'>{</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_tftttu'>tftttu</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_tftttu'>tftttu</span><span class='rparen'>)</span><span class='op'>/</span><span class='int'>3</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</code></pre>

<p>The result:</p>

<pre class="code ruby"><code class="ruby">             user     system      total        real
for:     1.016667   0.016667   1.033333 (  0.485749)
times:   1.450000   0.016667   1.466667 (  0.681367)
upto:    1.533333   0.000000   1.533333 (  0.722166)
&gt;total:  4.000000   0.033333   4.033333 (  1.889282)
&gt;avg:    1.333333   0.011111   1.344444 (  0.629761)</code></pre>
</li></ul>


  </div>
</div>
<div class="tags">
  
</div>
<h2>Defined Under Namespace</h2>

  <p class='children'><strong class='classes'>Classes:</strong>
    <a href="Benchmark/Job.html" title="Benchmark::Job (class)">Job</a>,
    <a href="Benchmark/Report.html" title="Benchmark::Report (class)">Report</a>,
    <a href="Benchmark/Tms.html" title="Benchmark::Tms (class)">Tms</a>
  </p>

<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='BENCHMARK_VERSION-constant'>
      BENCHMARK_VERSION =
    </dt>
    <dd>
            <pre class='code'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2002-04-25</span><span class='tstring_end'>&quot;</span></span></pre>
    </dd>
    <dt id='CAPTION-constant'>
      CAPTION =
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>The default caption string (heading above the output times).</p>


  </div>
</div>
<div class="tags">
  
</div>      <pre class='code'><span class='const'>Benchmark</span><span class='op'>::</span><span class='const'>Tms</span><span class='op'>::</span><span class='const'>CAPTION</span></pre>
    </dd>
    <dt id='FORMAT-constant'>
      FORMAT =
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>The default format string used to display times.  See also
<a href="Benchmark/Tms.html#format-instance_method" title="Benchmark::Tms#format (method)">Tms#format</a>.</p>


  </div>
</div>
<div class="tags">
  
</div>      <pre class='code'><span class='const'>Benchmark</span><span class='op'>::</span><span class='const'>Tms</span><span class='op'>::</span><span class='const'>FORMAT</span></pre>
    </dd>
  </dl>





<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#benchmark-class_method" title=".benchmark (class method)">.<strong>benchmark</strong>(caption = &quot;&quot;, label_width = nil, format = nil, *labels)  </a>
      </span>
      
      <span class='mod_func note title'>mod_func</span>

      <span class='summary_desc'>
        <div class='inline'>
<p>Invokes the block with a <a href="Benchmark/Report.html" title="Benchmark::Report (class)">Report</a> object, which may be used to
collect and report on the results of individual benchmark tests.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#bm-class_method" title=".bm (class method)">.<strong>bm</strong>(label_width = 0, *labels, &amp;blk)  </a>
      </span>
      
      <span class='mod_func note title'>mod_func</span>

      <span class='summary_desc'>
        <div class='inline'>
<p>A simple interface to the <a href="#benchmark-instance_method" title="Benchmark#benchmark (method)">#benchmark</a> method, <a href="#bm-instance_method" title="Benchmark#bm (method)">#bm</a> is generates
sequential reports with labels.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#bmbm-class_method" title=".bmbm (class method)">.<strong>bmbm</strong>(width = 0)  </a>
      </span>
      
      <span class='mod_func note title'>mod_func</span>

      <span class='summary_desc'>
        <div class='inline'>
<p>Sometimes benchmark results are skewed because code executed earlier
encounters different garbage collection overheads than that run later.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#measure-class_method" title=".measure (class method)">.<strong>measure</strong>(label = &quot;&quot;)  </a>
      </span>
      
      <span class='mod_func note title'>mod_func</span>

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the time used to execute the given block as a <a href="Benchmark/Tms.html" title="Benchmark::Tms (class)">Tms</a>
object.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#realtime-class_method" title=".realtime (class method)">.<strong>realtime</strong>  </a>
      </span>
      
      <span class='mod_func note title'>mod_func</span>

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the elapsed real time used to execute the given block.</p>
</div>
      </span>
    </li>
  </ul>

<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="benchmark-class_method">
  <h3 class='signature first'>
  .<strong>benchmark</strong>(caption = &quot;&quot;, label_width = nil, format = nil, *labels)   <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Invokes the block with a <a href="Benchmark/Report.html" title="Benchmark::Report (class)">Report</a> object, which may be used to
collect and report on the results of individual benchmark tests. Reserves
<code>label_width</code> leading spaces for labels on each line. Prints
<code>caption</code> at the top of the report, and uses <code>format</code>
to format each line. Returns an array of <a href="Benchmark/Tms.html" title="Benchmark::Tms (class)">Tms</a> objects.</p>

<p>If the block returns an array of <a href="Benchmark/Tms.html" title="Benchmark::Tms (class)">Tms</a> objects, these will be
used to format additional lines of output. If <code>label</code> parameters
are given, these are used to label these extra lines.</p>

<p><em>Note</em>: Other methods provide a simpler interface to this one, and
are suitable for nearly all benchmarking requirements.  See the examples in
Benchmark, and the <a href="#bm-instance_method" title="Benchmark#bm (method)">#bm</a> and <a href="#bmbm-instance_method" title="Benchmark#bmbm (method)">#bmbm</a> methods.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'>Benchmark</span>          <span class='comment'># we need the CAPTION and FORMAT constants
</span>
<span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='int'>50000</span>
<span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_benchmark'>benchmark</span><span class='lparen'>(</span><span class='const'>CAPTION</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='const'>FORMAT</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;total:</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;avg:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
  <span class='id identifier rubyid_tf'>tf</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>for:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='lbrace'>{</span> <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_n'>n</span><span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_tt'>tt</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>times:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>   <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_tu'>tu</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>upto:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>  <span class='lbrace'>{</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_tftttu'>tftttu</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_tftttu'>tftttu</span><span class='rparen'>)</span><span class='op'>/</span><span class='int'>3</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</code></pre>

<p>Generates:</p>

<pre class="code ruby"><code class="ruby">             user     system      total        real
for:     1.016667   0.016667   1.033333 (  0.485749)
times:   1.450000   0.016667   1.466667 (  0.681367)
upto:    1.533333   0.000000   1.533333 (  0.722166)
&gt;total:  4.000000   0.033333   4.033333 (  1.889282)
&gt;avg:    1.333333   0.011111   1.344444 (  0.629761)</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'benchmark.rb', line 166</span>

<span class='kw'>def</span> <span class='id identifier rubyid_benchmark'>benchmark</span><span class='lparen'>(</span><span class='id identifier rubyid_caption'>caption</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_label_width'>label_width</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_format'>format</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_labels'>labels</span><span class='rparen'>)</span> <span class='comment'># :yield: report
</span>    <span class='id identifier rubyid_sync'>sync</span> <span class='op'>=</span> <span class='const'>STDOUT</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span>
    <span class='const'>STDOUT</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_label_width'>label_width</span> <span class='op'>||=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_label_width'>label_width</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_format'>format</span> <span class='op'>||=</span> <span class='const'>FORMAT</span>
    <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='op'>*</span><span class='id identifier rubyid_label_width'>label_width</span> <span class='op'>+</span> <span class='id identifier rubyid_caption'>caption</span> <span class='kw'>unless</span> <span class='id identifier rubyid_caption'>caption</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_report'>report</span> <span class='op'>=</span> <span class='const'>Report</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_label_width'>label_width</span><span class='comma'>,</span> <span class='id identifier rubyid_format'>format</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_report'>report</span><span class='rparen'>)</span>
    <span class='const'>Array</span> <span class='op'>===</span> <span class='id identifier rubyid_results'>results</span> <span class='kw'>and</span> <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_grep'>grep</span><span class='lparen'>(</span><span class='const'>Tms</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
      <span class='id identifier rubyid_print'>print</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_labels'>labels</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span> <span class='op'>||</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_label'>label</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ljust'>ljust</span><span class='lparen'>(</span><span class='id identifier rubyid_label_width'>label_width</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_format'>format</span><span class='lparen'>(</span><span class='id identifier rubyid_format'>format</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span>
  <span class='kw'>ensure</span>
    <span class='const'>STDOUT</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span> <span class='op'>=</span> <span class='id identifier rubyid_sync'>sync</span> <span class='kw'>unless</span> <span class='id identifier rubyid_sync'>sync</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="bm-class_method">
  <h3 class='signature'>
  .<strong>bm</strong>(label_width = 0, *labels, &amp;blk)   <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>A simple interface to the <a href="#benchmark-instance_method" title="Benchmark#benchmark (method)">#benchmark</a> method, <a href="#bm-instance_method" title="Benchmark#bm (method)">#bm</a> is generates
sequential reports with labels.  The parameters have the same meaning as
for <a href="#benchmark-instance_method" title="Benchmark#benchmark (method)">#benchmark</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='int'>50000</span>
<span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_bm'>bm</span><span class='lparen'>(</span><span class='int'>7</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>for:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='lbrace'>{</span> <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_n'>n</span><span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>times:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>   <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>upto:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>  <span class='lbrace'>{</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='semicolon'>;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>Generates:</p>

<pre class="code ruby"><code class="ruby">             user     system      total        real
for:     1.050000   0.000000   1.050000 (  0.503462)
times:   1.533333   0.016667   1.550000 (  0.735473)
upto:    1.500000   0.016667   1.516667 (  0.711239)</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


205
206
207</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'benchmark.rb', line 205</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bm'>bm</span><span class='lparen'>(</span><span class='id identifier rubyid_label_width'>label_width</span> <span class='op'>=</span> <span class='int'>0</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_labels'>labels</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span><span class='rparen'>)</span> <span class='comment'># :yield: report
</span>    <span class='id identifier rubyid_benchmark'>benchmark</span><span class='lparen'>(</span><span class='const'>CAPTION</span><span class='comma'>,</span> <span class='id identifier rubyid_label_width'>label_width</span><span class='comma'>,</span> <span class='const'>FORMAT</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_labels'>labels</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span><span class='rparen'>)</span>
  <span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="bmbm-class_method">
  <h3 class='signature'>
  .<strong>bmbm</strong>(width = 0)   <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sometimes benchmark results are skewed because code executed earlier
encounters different garbage collection overheads than that run later.
<a href="#bmbm-instance_method" title="Benchmark#bmbm (method)">#bmbm</a> attempts to minimize this effect by running the tests twice, the
first time as a rehearsal in order to get the runtime environment stable,
the second time for real. <code>GC.start</code> is executed before the start of each
of the real timings; the cost of this is not included in the timings. In
reality, though, there&#39;s only so much that <a href="#bmbm-instance_method" title="Benchmark#bmbm (method)">#bmbm</a> can do, and the
results are not guaranteed to be isolated from garbage collection and other
effects.</p>

<p>Because <a href="#bmbm-instance_method" title="Benchmark#bmbm (method)">#bmbm</a> takes two passes through the tests, it can calculate the
required label width.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>benchmark</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_array'>array</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='int'>1000000</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_rand'>rand</span> <span class='rbrace'>}</span>

<span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_bmbm'>bmbm</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sort!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_array'>array</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sort</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>  <span class='lbrace'>{</span> <span class='id identifier rubyid_array'>array</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>  <span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>Generates:</p>

<pre class="code ruby"><code class="ruby">Rehearsal -----------------------------------------
sort!  11.928000   0.010000  11.938000 ( 12.756000)
sort   13.048000   0.020000  13.068000 ( 13.857000)
------------------------------- total: 25.006000sec

            user     system      total        real
sort!  12.959000   0.010000  12.969000 ( 13.793000)
sort   12.007000   0.000000  12.007000 ( 12.791000)</code></pre>

<p><a href="#bmbm-instance_method" title="Benchmark#bmbm (method)">#bmbm</a> yields a <a href="Benchmark/Job.html" title="Benchmark::Job (class)">Job</a> object and returns an array of
<a href="Benchmark/Tms.html" title="Benchmark::Tms (class)">Tms</a> objects.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'benchmark.rb', line 247</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bmbm'>bmbm</span><span class='lparen'>(</span><span class='id identifier rubyid_width'>width</span> <span class='op'>=</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='comment'># :yield: job
</span>    <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_width'>width</span><span class='rparen'>)</span>
    <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_job'>job</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_width'>width</span> <span class='op'>=</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_width'>width</span> <span class='op'>+</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sync'>sync</span> <span class='op'>=</span> <span class='const'>STDOUT</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span>
    <span class='const'>STDOUT</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span> <span class='op'>=</span> <span class='kw'>true</span>

    <span class='comment'># rehearsal
</span>    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Rehearsal </span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_ljust'>ljust</span><span class='lparen'>(</span><span class='id identifier rubyid_width'>width</span><span class='op'>+</span><span class='const'>CAPTION</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_ets'>ets</span> <span class='op'>=</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='const'>Tms</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_sum'>sum</span><span class='comma'>,</span><span class='lparen'>(</span><span class='id identifier rubyid_label'>label</span><span class='comma'>,</span><span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span><span class='op'>|</span>
      <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_label'>label</span><span class='period'>.</span><span class='id identifier rubyid_ljust'>ljust</span><span class='lparen'>(</span><span class='id identifier rubyid_width'>width</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_measure'>measure</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_format'>format</span>
      <span class='id identifier rubyid_sum'>sum</span> <span class='op'>+</span> <span class='id identifier rubyid_res'>res</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_format'>format</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>total: %tsec</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ets'>ets</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n\n</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_rjust'>rjust</span><span class='lparen'>(</span><span class='id identifier rubyid_widthCAPTION'>widthCAPTION</span><span class='period'>.</span><span class='id identifier rubyid_length2'>length2</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='comment'># take
</span>    <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='op'>*</span><span class='id identifier rubyid_width'>width</span> <span class='op'>+</span> <span class='const'>CAPTION</span>
    <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_label'>label</span><span class='comma'>,</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span>
      <span class='const'>GC</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>
      <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_label'>label</span><span class='period'>.</span><span class='id identifier rubyid_ljust'>ljust</span><span class='lparen'>(</span><span class='id identifier rubyid_width'>width</span><span class='rparen'>)</span>
      <span class='const'>Benchmark</span><span class='period'>.</span><span class='id identifier rubyid_measure'>measure</span><span class='lparen'>(</span><span class='id identifier rubyid_label'>label</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span> <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_res'>res</span> <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
  <span class='kw'>ensure</span>
    <span class='const'>STDOUT</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span> <span class='op'>=</span> <span class='id identifier rubyid_sync'>sync</span> <span class='kw'>unless</span> <span class='id identifier rubyid_sync'>sync</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="measure-class_method">
  <h3 class='signature'>
  .<strong>measure</strong>(label = &quot;&quot;)   <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the time used to execute the given block as a <a href="Benchmark/Tms.html" title="Benchmark::Tms (class)">Tms</a>
object.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


279
280
281
282
283
284
285
286
287
288
289</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'benchmark.rb', line 279</span>

<span class='kw'>def</span> <span class='id identifier rubyid_measure'>measure</span><span class='lparen'>(</span><span class='id identifier rubyid_label'>label</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'># :yield:
</span>    <span class='id identifier rubyid_t0'>t0</span><span class='comma'>,</span> <span class='id identifier rubyid_r0'>r0</span> <span class='op'>=</span> <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
    <span class='kw'>yield</span>
    <span class='id identifier rubyid_t1'>t1</span><span class='comma'>,</span> <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
    <span class='const'>Benchmark</span><span class='op'>::</span><span class='const'>Tms</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_t1'>t1</span><span class='period'>.</span><span class='id identifier rubyid_utime'>utime</span>  <span class='op'>-</span> <span class='id identifier rubyid_t0'>t0</span><span class='period'>.</span><span class='id identifier rubyid_utime'>utime</span><span class='comma'>,</span>
                       <span class='id identifier rubyid_t1'>t1</span><span class='period'>.</span><span class='id identifier rubyid_stime'>stime</span>  <span class='op'>-</span> <span class='id identifier rubyid_t0'>t0</span><span class='period'>.</span><span class='id identifier rubyid_stime'>stime</span><span class='comma'>,</span>
                       <span class='id identifier rubyid_t1'>t1</span><span class='period'>.</span><span class='id identifier rubyid_cutime'>cutime</span> <span class='op'>-</span> <span class='id identifier rubyid_t0'>t0</span><span class='period'>.</span><span class='id identifier rubyid_cutime'>cutime</span><span class='comma'>,</span>
                       <span class='id identifier rubyid_t1'>t1</span><span class='period'>.</span><span class='id identifier rubyid_cstime'>cstime</span> <span class='op'>-</span> <span class='id identifier rubyid_t0'>t0</span><span class='period'>.</span><span class='id identifier rubyid_cstime'>cstime</span><span class='comma'>,</span>
                       <span class='id identifier rubyid_r1'>r1</span> <span class='op'>-</span> <span class='id identifier rubyid_r0'>r0</span><span class='comma'>,</span>
                       <span class='id identifier rubyid_label'>label</span><span class='rparen'>)</span>
  <span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="realtime-class_method">
  <h3 class='signature'>
  .<strong>realtime</strong>   <span class="extras">(mod_func)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the elapsed real time used to execute the given block.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


294
295
296
297
298</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'benchmark.rb', line 294</span>

<span class='kw'>def</span> <span class='id identifier rubyid_realtime'>realtime</span> <span class='comment'># :yield:
</span>    <span class='id identifier rubyid_r0'>r0</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
    <span class='kw'>yield</span>
    <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_r0'>r0</span>
  <span class='kw'>end</span></pre>
  </div>
</div>
</section>
<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.8.7.6 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>