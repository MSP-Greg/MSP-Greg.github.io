<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Gem::DependencyResolver &mdash; rubygems Ruby-2.0.0 p648</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Gem::DependencyResolver",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Ruby-2.0.0</a> &raquo; 
          <a href='../index.html'>rubygems</a> &raquo; 
          <a href='../_index.html'>Index (D)</a> &raquo; 
          <a href="../Gem.html" title="Gem (module)">Gem</a> &raquo; 
          <span class='title'>DependencyResolver</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: Gem::DependencyResolver</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'>Object</span>
      <ul class='fullTree'>
        <li>Object</li>
        <li class='next'>Gem::DependencyResolver</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <div class='box_max'>
        <a href="DependencyResolver/APISet.html" title="Gem::DependencyResolver::APISet (class)">APISet</a>,
    <a href="DependencyResolver/APISpecification.html" title="Gem::DependencyResolver::APISpecification (class)">APISpecification</a>,
    <a href="DependencyResolver/ActivationRequest.html" title="Gem::DependencyResolver::ActivationRequest (class)">ActivationRequest</a>,
    <a href="DependencyResolver/CurrentSet.html" title="Gem::DependencyResolver::CurrentSet (class)">CurrentSet</a>,
    <a href="DependencyResolver/DependencyConflict.html" title="Gem::DependencyResolver::DependencyConflict (class)">DependencyConflict</a>,
    <a href="DependencyResolver/DependencyRequest.html" title="Gem::DependencyResolver::DependencyRequest (class)">DependencyRequest</a>,
    <a href="DependencyResolver/IndexSet.html" title="Gem::DependencyResolver::IndexSet (class)">IndexSet</a>,
    <a href="DependencyResolver/IndexSpecification.html" title="Gem::DependencyResolver::IndexSpecification (class)">IndexSpecification</a>
      </div>
    </td>
  </tr>




  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/ruby/ruby/blob/ruby_2_0_0/lib/rubygems/dependency_resolver.rb#L64'>lib/rubygems/dependency_resolver.rb</a></div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Given a set of <a href="Dependency.html" title="Gem::Dependency (class)">Dependency</a> objects as <code>needed</code> and a way
to query the set of available specs via <code>set</code>, calculates a set
of ActivationRequest objects which indicate all the specs that should be
activated to meet the all the requirements.</p>


  </div>
</div>
<div class="tags">
  
</div>


<h2>Instance Attribute Summary <small><a href='#' class='summary_toggle'>collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#conflicts-instance_method" title="#conflicts (instance method)">#<strong>conflicts</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Contains all the conflicts encountered while doing resolution</p>
</div>
      </span>
    </li>
  </ul>


<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#for_current_gems-class_method" title=".for_current_gems (class method)">.<strong>for_current_gems</strong>(needed)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Provide a DependencyResolver that queries only against the already
installed gems.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(needed, set = IndexSet.new)  &#x21d2; DependencyResolver </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Create DependencyResolver object which will resolve the tree starting with
<code>needed</code> Depedency objects.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#requests-instance_method" title="#requests (instance method)">#<strong>requests</strong>(s, act)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#resolve-instance_method" title="#resolve (instance method)">#<strong>resolve</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Proceed with resolution! Returns an array of ActivationRequest objects.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#resolve_for-instance_method" title="#resolve_for (instance method)">#<strong>resolve_for</strong>(needed, specs)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The meat of the algorithm.</p>
</div>
      </span>
    </li>
  </ul>


<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(needed, set = IndexSet.new)  &#x21d2; <tt><a href="" title="Gem::DependencyResolver (class)">DependencyResolver</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Create DependencyResolver object which will resolve the tree starting with
<code>needed</code> Depedency objects.</p>

<p><code>set</code> is an object that provides where to look for
specifications to satisify the Dependencies. This defaults to IndexSet,
which will query rubygems.org.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_0_0/lib/rubygems/dependency_resolver.rb#L260'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


260
261
262
263
264
265</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/dependency_resolver.rb', line 260</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_needed'>needed</span><span class='comma'>,</span> <span class='id identifier rubyid_set'>set</span><span class='op'>=</span><span class='const'>IndexSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>
  <span class='ivar'>@set</span> <span class='op'>=</span> <span class='id identifier rubyid_set'>set</span> <span class='op'>||</span> <span class='const'><a href="DependencyResolver/IndexSet.html" title="Gem::DependencyResolver::IndexSet (class)">IndexSet</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolver/IndexSet.html#new-class_method" title="Gem::DependencyResolver::IndexSet.new (method)">new</a></span> <span class='comment'># Allow nil to mean IndexSet
</span>  <span class='ivar'>@needed</span> <span class='op'>=</span> <span class='id identifier rubyid_needed'>needed</span>

  <span class='ivar'>@conflicts</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="conflicts-instance_method">
  <h3 class='signature first'>
  #<strong>conflicts</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Contains all the conflicts encountered while doing resolution</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_0_0/lib/rubygems/dependency_resolver.rb#L276'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


276</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/dependency_resolver.rb', line 276</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:conflicts</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="for_current_gems-class_method">
  <h3 class='signature first'>
  .<strong>for_current_gems</strong>(needed)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Provide a DependencyResolver that queries only against the already
installed gems.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_0_0/lib/rubygems/dependency_resolver.rb#L270'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


270
271
272</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/dependency_resolver.rb', line 270</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_for_current_gems'>for_current_gems</span><span class='lparen'>(</span><span class='id identifier rubyid_needed'>needed</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_needed'>needed</span><span class='comma'>,</span> <span class='const'><a href="DependencyResolver/CurrentSet.html" title="Gem::DependencyResolver::CurrentSet (class)">CurrentSet</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="Gem::DependencyResolver.new (method)">new</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="requests-instance_method">
  <h3 class='signature first'>
  #<strong>requests</strong>(s, act)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_0_0/lib/rubygems/dependency_resolver.rb#L437'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


437
438
439
440
441
442
443
444
445
446
447</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/dependency_resolver.rb', line 437</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_requests'>requests</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_act'>act</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_dependencies'>dependencies</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:runtime</span>
    <span class='id identifier rubyid_reqs'>reqs</span> <span class='op'>&lt;&lt;</span> <span class='const'><a href="DependencyResolver/DependencyRequest.html" title="Gem::DependencyResolver::DependencyRequest (class)">DependencyRequest</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolver/DependencyRequest.html#new-class_method" title="Gem::DependencyResolver::DependencyRequest.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='id identifier rubyid_act'>act</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@set</span><span class='period'>.</span><span class='id identifier rubyid_prefetch'>prefetch</span><span class='lparen'>(</span><span class='id identifier rubyid_reqs'>reqs</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_reqs'>reqs</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="resolve-instance_method">
  <h3 class='signature'>
  #<strong>resolve</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Proceed with resolution! Returns an array of ActivationRequest objects.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_0_0/lib/rubygems/dependency_resolver.rb#L281'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


281
282
283
284
285
286
287
288
289
290
291
292
293</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/dependency_resolver.rb', line 281</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_resolve'>resolve</span>
  <span class='ivar'>@conflicts</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_needed'>needed</span> <span class='op'>=</span> <span class='ivar'>@needed</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span> <span class='const'><a href="DependencyResolver/DependencyRequest.html" title="Gem::DependencyResolver::DependencyRequest (class)">DependencyRequest</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolver/DependencyRequest.html#new-class_method" title="Gem::DependencyResolver::DependencyRequest.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_resolve_for'>resolve_for</span> <span class='id identifier rubyid_needed'>needed</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'><a href="DependencyResolver/DependencyConflict.html" title="Gem::DependencyResolver::DependencyConflict (class)">DependencyConflict</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="DependencyResolutionError.html" title="Gem::DependencyResolutionError (class)">DependencyResolutionError</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolutionError.html#new-class_method" title="Gem::DependencyResolutionError.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_res'>res</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="resolve_for-instance_method">
  <h3 class='signature'>
  #<strong>resolve_for</strong>(needed, specs)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The meat of the algorithm. Given <code>needed</code> DependencyRequest
objects and <code>specs</code> being a list to ActivationRequest, calculate
a new list of ActivationRequest objects.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_0_0/lib/rubygems/dependency_resolver.rb#L453'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/dependency_resolver.rb', line 453</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_resolve_for'>resolve_for</span><span class='lparen'>(</span><span class='id identifier rubyid_needed'>needed</span><span class='comma'>,</span> <span class='id identifier rubyid_specs'>specs</span><span class='rparen'>)</span>
  <span class='kw'>until</span> <span class='id identifier rubyid_needed'>needed</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_dep'>dep</span> <span class='op'>=</span> <span class='id identifier rubyid_needed'>needed</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>

    <span class='comment'># If there is already a spec activated for the requested name...
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_existing'>existing</span> <span class='op'>=</span> <span class='id identifier rubyid_specs'>specs</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_dep'>dep</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span>

      <span class='comment'># then we&#39;re done since this new dep matches the
</span>      <span class='comment'># existing spec.
</span>      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_dep'>dep</span><span class='period'>.</span><span class='id identifier rubyid_matches_spec?'>matches_spec?</span> <span class='id identifier rubyid_existing'>existing</span>

      <span class='comment'># There is a conflict! We return the conflict
</span>      <span class='comment'># object which will be seen by the caller and be
</span>      <span class='comment'># handled at the right level.
</span>
      <span class='comment'># If the existing activation indicates that there
</span>      <span class='comment'># are other possibles for it, then issue the conflict
</span>      <span class='comment'># on the dep for the activation itself. Otherwise, issue
</span>      <span class='comment'># it on the requester&#39;s request itself.
</span>      <span class='comment'>#
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_existing'>existing</span><span class='period'>.</span><span class='id identifier rubyid_others_possible?'>others_possible?</span>
        <span class='id identifier rubyid_conflict'>conflict</span> <span class='op'>=</span> <span class='const'><a href="DependencyResolver/DependencyConflict.html" title="Gem::DependencyResolver::DependencyConflict (class)">DependencyConflict</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolver/DependencyConflict.html#new-class_method" title="Gem::DependencyResolver::DependencyConflict.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_dep'>dep</span><span class='comma'>,</span> <span class='id identifier rubyid_existing'>existing</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_depreq'>depreq</span> <span class='op'>=</span> <span class='id identifier rubyid_existing'>existing</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_requester'>requester</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span>
        <span class='id identifier rubyid_conflict'>conflict</span> <span class='op'>=</span> <span class='const'><a href="DependencyResolver/DependencyConflict.html" title="Gem::DependencyResolver::DependencyConflict (class)">DependencyConflict</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolver/DependencyConflict.html#new-class_method" title="Gem::DependencyResolver::DependencyConflict.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_depreq'>depreq</span><span class='comma'>,</span> <span class='id identifier rubyid_existing'>existing</span><span class='comma'>,</span> <span class='id identifier rubyid_dep'>dep</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='ivar'>@conflicts</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_conflict'>conflict</span>

      <span class='kw'>return</span> <span class='id identifier rubyid_conflict'>conflict</span>
    <span class='kw'>end</span>

    <span class='comment'># Get a list of all specs that satisfy dep
</span>    <span class='id identifier rubyid_possible'>possible</span> <span class='op'>=</span> <span class='ivar'>@set</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span><span class='lparen'>(</span><span class='id identifier rubyid_dep'>dep</span><span class='rparen'>)</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_possible'>possible</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='kw'>when</span> <span class='int'>0</span>
      <span class='comment'># If there are none, then our work here is done.
</span>      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="UnsatisfiableDepedencyError.html" title="Gem::UnsatisfiableDepedencyError (class)">UnsatisfiableDepedencyError</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="UnsatisfiableDepedencyError.html#new-class_method" title="Gem::UnsatisfiableDepedencyError.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_dep'>dep</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='int'>1</span>
      <span class='comment'># If there is one, then we just add it to specs
</span>      <span class='comment'># and process the specs dependencies by adding
</span>      <span class='comment'># them to needed.
</span>
      <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='id identifier rubyid_possible'>possible</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='id identifier rubyid_act'>act</span> <span class='op'>=</span>  <span class='const'><a href="DependencyResolver/ActivationRequest.html" title="Gem::DependencyResolver::ActivationRequest (class)">ActivationRequest</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolver/ActivationRequest.html#new-class_method" title="Gem::DependencyResolver::ActivationRequest.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_dep'>dep</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_specs'>specs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_act'>act</span>

      <span class='comment'># Put the deps for at the beginning of needed
</span>      <span class='comment'># rather than the end to match the depth first
</span>      <span class='comment'># searching done by the multiple case code below.
</span>      <span class='comment'>#
</span>      <span class='comment'># This keeps the error messages consistent.
</span>      <span class='id identifier rubyid_needed'>needed</span> <span class='op'>=</span> <span class='id identifier rubyid_requests'>requests</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_act'>act</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_needed'>needed</span>
    <span class='kw'>else</span>
      <span class='comment'># There are multiple specs for this dep. This is
</span>      <span class='comment'># the case that this class is built to handle.
</span>
      <span class='comment'># Sort them so that we try the highest versions
</span>      <span class='comment'># first.
</span>      <span class='id identifier rubyid_possible'>possible</span> <span class='op'>=</span> <span class='id identifier rubyid_possible'>possible</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='rbrace'>}</span>

      <span class='comment'># We track the conflicts seen so that we can report them
</span>      <span class='comment'># to help the user figure out how to fix the situation.
</span>      <span class='id identifier rubyid_conflicts'>conflicts</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

      <span class='comment'># To figure out which to pick, we keep resolving
</span>      <span class='comment'># given each one being activated and if there isn&#39;t
</span>      <span class='comment'># a conflict, we know we&#39;ve found a full set.
</span>      <span class='comment'>#
</span>      <span class='comment'># We use an until loop rather than #reverse_each
</span>      <span class='comment'># to keep the stack short since we&#39;re using a recursive
</span>      <span class='comment'># algorithm.
</span>      <span class='comment'>#
</span>      <span class='kw'>until</span> <span class='id identifier rubyid_possible'>possible</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_possible'>possible</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span>

        <span class='comment'># Recursively call #resolve_for with this spec
</span>        <span class='comment'># and add it&#39;s dependencies into the picture...
</span>
        <span class='id identifier rubyid_act'>act</span> <span class='op'>=</span> <span class='const'><a href="DependencyResolver/ActivationRequest.html" title="Gem::DependencyResolver::ActivationRequest (class)">ActivationRequest</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="DependencyResolver/ActivationRequest.html#new-class_method" title="Gem::DependencyResolver::ActivationRequest.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_dep'>dep</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_try'>try</span> <span class='op'>=</span> <span class='id identifier rubyid_requests'>requests</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_act'>act</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_needed'>needed</span>

        <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_resolve_for'>resolve_for</span><span class='lparen'>(</span><span class='id identifier rubyid_try'>try</span><span class='comma'>,</span> <span class='id identifier rubyid_specs'>specs</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid_act'>act</span><span class='rbracket'>]</span><span class='rparen'>)</span>

        <span class='comment'># While trying to resolve these dependencies, there may
</span>        <span class='comment'># be a conflict!
</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'><a href="DependencyResolver/DependencyConflict.html" title="Gem::DependencyResolver::DependencyConflict (class)">DependencyConflict</a></span>
          <span class='comment'># The conflict might be created not by this invocation
</span>          <span class='comment'># but rather one up the stack, so if we can&#39;t attempt
</span>          <span class='comment'># to resolve this conflict (conflict isn&#39;t with the spec s)
</span>          <span class='comment'># then just return it so the caller can try to sort it out.
</span>          <span class='kw'>return</span> <span class='id identifier rubyid_res'>res</span> <span class='kw'>unless</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_for_spec?'>for_spec?</span> <span class='id identifier rubyid_s'>s</span>

          <span class='comment'># Otherwise, this is a conflict that we can attempt to fix
</span>          <span class='id identifier rubyid_conflicts'>conflicts</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='rbracket'>]</span>

          <span class='comment'># Optimization:
</span>          <span class='comment'>#
</span>          <span class='comment'># Because the conflict indicates the dependency that trigger
</span>          <span class='comment'># it, we can prune possible based on this new information.
</span>          <span class='comment'>#
</span>          <span class='comment'># This cuts down on the number of iterations needed.
</span>          <span class='id identifier rubyid_possible'>possible</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_dependency'>dependency</span><span class='period'>.</span><span class='id identifier rubyid_matches_spec?'>matches_spec?</span> <span class='id identifier rubyid_x'>x</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='comment'># No conflict, return the specs
</span>          <span class='kw'>return</span> <span class='id identifier rubyid_res'>res</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='comment'># We tried all possibles and nothing worked, so we let the user
</span>      <span class='comment'># know and include as much information about the problem since
</span>      <span class='comment'># the user is going to have to take action to fix this.
</span>      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="ImpossibleDependenciesError.html" title="Gem::ImpossibleDependenciesError (class)">ImpossibleDependenciesError</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="ImpossibleDependenciesError.html#new-class_method" title="Gem::ImpossibleDependenciesError.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_dep'>dep</span><span class='comma'>,</span> <span class='id identifier rubyid_conflicts'>conflicts</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_specs'>specs</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>