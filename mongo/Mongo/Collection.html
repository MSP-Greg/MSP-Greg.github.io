<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongo::Collection &mdash; Mongo master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongo::Collection",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongo master</a> &raquo; 
      <a href='../_index.html#alpha_C'>Index (C)</a> &raquo; 
        <a href="../Mongo.html" title="Mongo (module)">Mongo</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Collection&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongo::Collection</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="Collection/Helpers.html" title="Mongo::Collection::Helpers (module)"><code>Helpers</code></a>,
        <a href="Collection/QueryableEncryption.html" title="Mongo::Collection::QueryableEncryption (module)"><code>QueryableEncryption</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Collection/View.html" title="Mongo::Collection::View (class)"><code>View</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          Forwardable
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Collection/Helpers.html" title="Mongo::Collection::Helpers (module)"><code>Helpers</code></a>,
          <a href="Collection/QueryableEncryption.html" title="Mongo::Collection::QueryableEncryption (module)"><code>QueryableEncryption</code></a>,
          <a href="Retryable.html" title="Mongo::Retryable (module)"><code>Retryable</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L29'>lib/mongo/collection.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/helpers.rb#L19'>lib/mongo/collection/helpers.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/queryable_encryption.rb#L18'>lib/mongo/collection/queryable_encryption.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view.rb#L29'>lib/mongo/collection/view.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/aggregation.rb#L19'>lib/mongo/collection/view/aggregation.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/change_stream.rb#L21'>lib/mongo/collection/view/change_stream.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/explainable.rb#L19'>lib/mongo/collection/view/explainable.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/immutable.rb#L19'>lib/mongo/collection/view/immutable.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/iterable.rb#L19'>lib/mongo/collection/view/iterable.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/map_reduce.rb#L19'>lib/mongo/collection/view/map_reduce.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/readable.rb#L19'>lib/mongo/collection/view/readable.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/writable.rb#L19'>lib/mongo/collection/view/writable.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/builder/aggregation.rb#L19'>lib/mongo/collection/view/builder/aggregation.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/builder/map_reduce.rb#L19'>lib/mongo/collection/view/builder/map_reduce.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection/view/change_stream/retryable.rb#L19'>lib/mongo/collection/view/change_stream/retryable.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Represents a collection in the database and operations that can directly be applied to one.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='CAPPED-constant' class='summary_signature'>CAPPED =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The capped option.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L38-L38'># File 'lib/mongo/collection.rb', line 38</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capped</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='CHANGEABLE_OPTIONS-constant' class='summary_signature'>CHANGEABLE_OPTIONS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><a href="Options.html" title="Mongo::Options (module)"><code>Options</code></a> that can be updated on a new <code>Collection</code> instance via the #with method.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L63-L63'># File 'lib/mongo/collection.rb', line 63</a>    <pre class='code ruby'>[ <span class='symbeg'>:</span><span class='id identifier rubyid_read'>read</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_read_concern'><a href="#read_concern-instance_method" title="Mongo::Collection#read_concern (method)">read_concern</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span> ].<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='CREATE_COLLECTION_OPTIONS-constant' class='summary_signature nodoc'>CREATE_COLLECTION_OPTIONS =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><a href="Options.html" title="Mongo::Options (module)"><code>Options</code></a> map to transform create collection options.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L68-L76'># File 'lib/mongo/collection.rb', line 68</a>    <pre class='code ruby'>{
  <span class='symbeg'>:</span><span class='id identifier rubyid_time_series'>time_series</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_timeseries'>timeseries</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_expire_after'>expire_after</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_expireAfterSeconds'>expireAfterSeconds</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_clustered_index'>clustered_index</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_clusteredIndex'>clusteredIndex</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_change_stream_pre_and_post_images'>change_stream_pre_and_post_images</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_changeStreamPreAndPostImages'>changeStreamPreAndPostImages</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_encrypted_fields'>encrypted_fields</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_encryptedFields'>encryptedFields</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_validator'>validator</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_validator'>validator</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_view_on'>view_on</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_viewOn'>viewOn</span>
}</pre>
  </li>
  <li>
    <span id='NS-constant' class='summary_signature'>NS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The ns field constant.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L43-L43'># File 'lib/mongo/collection.rb', line 43</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ns</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
  <h3 class='inherited'><a href="Collection/QueryableEncryption.html" title="Mongo::Collection::QueryableEncryption (module)"><code>QueryableEncryption</code></a> - Included</h3>
  <p  class='inherited'>
    <a class='nodoc' href="Collection/QueryableEncryption.html#QE2_MIN_WIRE_VERSION-constant" title="Mongo::Collection::QueryableEncryption::QE2_MIN_WIRE_VERSION (constant)">QE2_MIN_WIRE_VERSION</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(database, name, options = {})  &#x21d2; Collection </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Instantiate a new collection.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#capped%3F-instance_method" title="#capped? (instance method)">#<strong>capped?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Is the collection capped?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#database-instance_method" title="#database (instance method)">#<strong>database</strong>  &#x21d2; Mongo::Database </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; String </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  &#x21d2; Hash </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#system_collection%3F-instance_method" title="#system_collection? (instance method)">#<strong>system_collection?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the collection is a system collection.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#==-instance_method" title="#== (instance method)">#<strong>==</strong>(other)  &#x21d2; true | false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Check if a collection is equal to another object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#aggregate-instance_method" title="#aggregate (instance method)">#<strong>aggregate</strong>(pipeline, options = {})  &#x21d2; View::Aggregation </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Perform an aggregation on the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#bulk_write-instance_method" title="#bulk_write (instance method)">#<strong>bulk_write</strong>(requests, options = {})  &#x21d2; BulkWrite::Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Execute a batch of bulk write operations.</p></div>
    </div>
  </li>
  <li class='deprecated'>
    <span class='summary_signature deprecated'>
      <a href="#count-instance_method" title="#count (instance method)">#<strong>count</strong>(filter = nil, options = {})  &#x21d2; Integer </a>
    </span>
    <span class='deprecated note title'>deprecated</span>
    <span class='summary_desc'><strong>Deprecated.</strong>
      <div class='inline'>
<p>Use #count_documents or estimated_document_count instead. However, note that the following operators will need to be substituted when switching to #count_documents:</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='gvar'>$where</span> <span class='id identifier rubyid_should'>should</span> <span class='id identifier rubyid_be'>be</span> <span class='id identifier rubyid_replaced'>replaced</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$expr</span> (<span class='id identifier rubyid_only'>only</span> <span class='id identifier rubyid_works'>works</span> <span class='id identifier rubyid_on'>on</span> <span class='float'>3.6</span><span class='op'>+</span>)
<span class='op'>*</span> <span class='gvar'>$near</span> <span class='id identifier rubyid_should'>should</span> <span class='id identifier rubyid_be'>be</span> <span class='id identifier rubyid_replaced'>replaced</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$geoWithin</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$center</span>
<span class='op'>*</span> <span class='gvar'>$nearSphere</span> <span class='id identifier rubyid_should'>should</span> <span class='id identifier rubyid_be'>be</span> <span class='id identifier rubyid_replaced'>replaced</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$geoWithin</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$centerSphere</span></code></pre>
</div>    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#count_documents-instance_method" title="#count_documents (instance method)">#<strong>count_documents</strong>(filter = {}, options = {})  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Gets the number of documents matching the query.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create-instance_method" title="#create (instance method)">#<strong>create</strong>(opts = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Force the collection to be created in the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete_many-instance_method" title="#delete_many (instance method)">#<strong>delete_many</strong>(filter = nil, options = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Remove documents from the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete_one-instance_method" title="#delete_one (instance method)">#<strong>delete_one</strong>(filter = nil, options = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Remove a document from the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#distinct-instance_method" title="#distinct (instance method)">#<strong>distinct</strong>(field_name, filter = nil, options = {})  &#x21d2; Array&lt;Object&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a list of distinct values for a specific field.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#drop-instance_method" title="#drop (instance method)">#<strong>drop</strong>(opts = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Drop the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#estimated_document_count-instance_method" title="#estimated_document_count (instance method)">#<strong>estimated_document_count</strong>(options = {})  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Gets an estimate of the number of documents in the collection using the collection metadata.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#find-instance_method" title="#find (instance method)">#<strong>find</strong>(filter = nil, options = {})  &#x21d2; CollectionView </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Find documents in the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#find_one_and_delete-instance_method" title="#find_one_and_delete (instance method)">#<strong>find_one_and_delete</strong>(filter, options = {})  &#x21d2; BSON::Document<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Finds a single document in the database via findAndModify and deletes it, returning the original document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#find_one_and_replace-instance_method" title="#find_one_and_replace (instance method)">#<strong>find_one_and_replace</strong>(filter, replacement, options = {})  &#x21d2; BSON::Document </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Finds a single document and replaces it, returning the original doc unless otherwise specified.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#find_one_and_update-instance_method" title="#find_one_and_update (instance method)">#<strong>find_one_and_update</strong>(filter, update, options = {})  &#x21d2; BSON::Document </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Finds a single document via findAndModify and updates it, returning the original doc unless otherwise specified.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#indexes-instance_method" title="#indexes (instance method)">#<strong>indexes</strong>(options = {})  &#x21d2; Index::View </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a view of all indexes for this collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#insert_many-instance_method" title="#insert_many (instance method)">#<strong>insert_many</strong>(documents, options = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Insert the provided documents into the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#insert_one-instance_method" title="#insert_one (instance method)">#<strong>insert_one</strong>(document, opts = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Insert a single document into the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a pretty printed string inspection for the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#namespace-instance_method" title="#namespace (instance method)">#<strong>namespace</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the fully qualified namespace of the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#parallel_scan-instance_method" title="#parallel_scan (instance method)">#<strong>parallel_scan</strong>(cursor_count, options = {})  &#x21d2; Array&lt;Cursor&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Execute a parallel scan on the collection view.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#read_concern-instance_method" title="#read_concern (instance method)">#<strong>read_concern</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the effective read concern for this collection instance.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#read_preference-instance_method" title="#read_preference (instance method)">#<strong>read_preference</strong>  &#x21d2; Hash </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the effective read preference for this collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#replace_one-instance_method" title="#replace_one (instance method)">#<strong>replace_one</strong>(filter, replacement, options = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Replaces a single document in the collection with the new document.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#search_indexes-instance_method" title="#search_indexes (instance method)">#<strong>search_indexes</strong>(options = {})  &#x21d2; SearchIndex::View </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a view of all search indexes for this collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#server_selector-instance_method" title="#server_selector (instance method)">#<strong>server_selector</strong>  &#x21d2; Mongo::ServerSelector </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the server selector for this collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#update_many-instance_method" title="#update_many (instance method)">#<strong>update_many</strong>(filter, update, options = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Update documents in the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#update_one-instance_method" title="#update_one (instance method)">#<strong>update_one</strong>(filter, update, options = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Update a single document in the collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#watch-instance_method" title="#watch (instance method)">#<strong>watch</strong>(pipeline = [], options = {})  &#x21d2; ChangeStream </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>As of version 3.6 of the MongoDB server, a “$changeStream“ pipeline stage is supported in the aggregation framework.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#with-instance_method" title="#with (instance method)">#<strong>with</strong>(new_options)  &#x21d2; Mongo::Collection </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#write_concern-instance_method" title="#write_concern (instance method)">#<strong>write_concern</strong>  &#x21d2; Mongo::WriteConcern </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the effective write concern on this collection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#write_concern_with_session-instance_method" title="#write_concern_with_session (instance method)">#<strong>write_concern_with_session</strong>(session)  &#x21d2; Mongo::WriteConcern </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the write concern to use for an operation on this collection, given a session.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="Collection/Helpers.html" title="Mongo::Collection::Helpers (module)"><code>Helpers</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Collection/Helpers.html#do_drop-instance_method" title="Mongo::Collection::Helpers#do_drop (method)">#do_drop</a></td>
      <td><div class='inline'><p>Executes drop operation and and ignores NamespaceNotFound error.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited nodoc'><a href="Collection/QueryableEncryption.html" title="Mongo::Collection::QueryableEncryption (module)"><code>QueryableEncryption</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Collection/QueryableEncryption.html#maybe_create_qe_collections-instance_method" title="Mongo::Collection::QueryableEncryption#maybe_create_qe_collections (method)">#maybe_create_qe_collections</a></td>
      <td><div class='inline'><p>Creates auxiliary collections and indices for queryable encryption if necessary.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Collection/QueryableEncryption.html#maybe_drop_emm_collections-instance_method" title="Mongo::Collection::QueryableEncryption#maybe_drop_emm_collections (method)">#maybe_drop_emm_collections</a></td>
      <td><div class='inline'><p>Drops auxiliary collections and indices for queryable encryption if necessary.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="Collection/QueryableEncryption.html#check_wire_version!-instance_method" title="Mongo::Collection::QueryableEncryption#check_wire_version! (method)">#check_wire_version!</a></td>
      <td><div class='inline'><p>Creating encrypted collections is only supported on 7.0.0 and later (wire version 21+).</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="Collection/QueryableEncryption.html#create_operation_for-instance_method" title="Mongo::Collection::QueryableEncryption#create_operation_for (method)">#create_operation_for</a></td>
      <td><div class='inline'><p>Returns a new create operation for the given collection.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="Collection/QueryableEncryption.html#emm_collections-instance_method" title="Mongo::Collection::QueryableEncryption#emm_collections (method)">#emm_collections</a></td>
      <td><div class='inline'><p>Checks if names for auxiliary collections are set and returns them, otherwise returns default names.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="Collection/QueryableEncryption.html#encrypted_fields_for_drop_from_map-instance_method" title="Mongo::Collection::QueryableEncryption#encrypted_fields_for_drop_from_map (method)">#encrypted_fields_for_drop_from_map</a></td>
      <td><div class='inline'><p>Tries to return the encrypted fields from the <code>{encrypted_fields_map</code>} value, for the current namespace.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="Collection/QueryableEncryption.html#encrypted_fields_from-instance_method" title="Mongo::Collection::QueryableEncryption#encrypted_fields_from (method)">#encrypted_fields_from</a></td>
      <td><div class='inline'><p>Tries to return the encrypted fields from the argument.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="Retryable.html" title="Mongo::Retryable (module)"><code>Retryable</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Retryable.html#read_worker-instance_method" title="Mongo::Retryable#read_worker (method)">#read_worker</a></td>
      <td><div class='inline'><p>Returns the read worker for handling retryable reads.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Retryable.html#select_server-instance_method" title="Mongo::Retryable#select_server (method)">#select_server</a></td>
      <td><div class='inline'><p>This is a separate method to make it possible for the test suite to assert that server selection is performed during retry attempts.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Retryable.html#write_worker-instance_method" title="Mongo::Retryable#write_worker (method)">#write_worker</a></td>
      <td><div class='inline'><p>Returns the write worker for handling retryable writes.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(database, name, options = {})  &#x21d2; <code>Collection</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Instantiate a new collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Instantiate a new collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'>Collection</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>database</span>
    <span class='type'>(<a href="Database.html" title="Mongo::Database (class)">Mongo::Database</a>)</span>
&mdash;    <div class='inline'>
<p>The collection’s database.</p>
</div>
  </li>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<code>String</code>, <a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The collection name.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The collection options.</p>
</div>
  </li>
  <li>
    <span class='name'>opts</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>a customizable set of options</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:read_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read concern options hash, with the following optional keys:</p>
<ul><li>
<p><strong>:level</strong> – the read preference level as a symbol; valid values</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_are'>are</span> <span class='op'>*</span><span class='symbeg'>:</span><span class='id identifier rubyid_local'>local</span><span class='op'>*</span><span class='comma'>,</span> <span class='op'>*</span><span class='symbeg'>:</span><span class='id identifier rubyid_majority'>majority</span><span class='op'>*</span><span class='comma'>,</span> <span class='kw'>and</span> <span class='op'>*</span><span class='symbeg'>:</span><span class='id identifier rubyid_snapshot'>snapshot</span><span class='op'>*</span></code></pre>
</li></ul>
</div>        </li>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference options. The hash may have the following items:</p>
<ul><li>
<p><strong>:mode</strong> – read preference specified as a symbol; valid values are <strong>:primary</strong>, <strong>:primary_preferred</strong>, <strong>:secondary</strong>, <strong>:secondary_preferred</strong> and <strong>:nearest</strong>.</p>
</li><li>
<p><strong>:tag_sets</strong> – an array of hashes.</p>
</li><li>
<p><strong>:local_threshold</strong>.</p>
</li></ul>
</div>        </li>
    </ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="Error/InvalidCollectionName.html" title="Mongo::Error::InvalidCollectionName (class)">Error::InvalidCollectionName</a>)</span>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L158-L174'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='158' data-end='174'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 158</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span><span class='comma'>,</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/InvalidCollectionName.html" title="Mongo::Error::InvalidCollectionName (class)">InvalidCollectionName</a></span>.<span class='id identifier rubyid_new'><a href="Error/InvalidCollectionName.html#new-class_method" title="Mongo::Error::InvalidCollectionName.new (method)">new</a></span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span>] <span class='op'>!=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>]
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>If :write and :write_concern are both given, they must be identical: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_inspect'><a href="#inspect-instance_method" title="Mongo::Collection#inspect (method)">inspect</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='ivar'>@database</span> <span class='op'>=</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>
  <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_freeze'>freeze</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_dup'>dup</span>
<span class='embdoc_beg'>=begin WriteConcern object support
</span><span class='embdoc'>  if @options[:write_concern].is_a?(WriteConcern::Base)
</span><span class='embdoc'>    # Cache the instance so that we do not needlessly reconstruct it.
</span><span class='embdoc'>    @write_concern = @options[:write_concern]
</span><span class='embdoc'>    @options[:write_concern] = @write_concern.options
</span><span class='embdoc'>  end
</span><span class='embdoc_end'>=end
</span>  <span class='ivar'>@options</span>.<span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="capped?-instance_method">
  <h3 class='signature ro first'>
    #<strong>capped?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is the collection capped?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the collection capped?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_capped?'>capped?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the collection is capped.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L316-L320'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='316' data-end='320'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 316</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_capped?'>capped?</span>
  <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_list_collections'>list_collections</span>(<span class='label'>filter:</span> { <span class='label'>name:</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span> })
    .<span class='id identifier rubyid_first'>first</span>
    <span class='op'>&amp;.</span><span class='id identifier rubyid_dig'>dig</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>options</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'><a href="#CAPPED-constant" title="Mongo::Collection::CAPPED (constant)">CAPPED</a></span>) <span class='op'>||</span> <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="database-instance_method">
  <h3 class='signature ro'>
    #<strong>database</strong>  &#x21d2; <a href="Database.html" title="Mongo::Database (class)">Mongo::Database</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Database.html" title="Mongo::Database (class)">Mongo::Database</a>)</span>
&mdash;    <div class='inline'>
<p>The database the collection resides in.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L46-L46'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='46' data-end='46'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 46</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_database'>database</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="name-instance_method">
  <h3 class='signature ro'>
    #<strong>name</strong>  &#x21d2; <code>String</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The name of the collection.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L49-L49'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='49' data-end='49'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 49</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="options-instance_method">
  <h3 class='signature ro'>
    #<strong>options</strong>  &#x21d2; <code>Hash</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The collection options.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L52-L52'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='52' data-end='52'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 52</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_options'>options</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="system_collection?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>system_collection?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the collection is a system collection.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Boolean</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the system is a system collection.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L1152-L1154'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1152' data-end='1154'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 1152</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_system_collection?'>system_collection?</span>
  <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>system.</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="==-instance_method">
  <h3 class='signature  first'>
    #<strong>==</strong>(other)  &#x21d2; <code>true</code> | <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Check if a collection is equal to another object. Will check the name and the database for equality.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Check collection equality.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>other</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The object to check.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the objects are equal.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L89-L92'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='89' data-end='92'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 89</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>==</span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Collection</span>)
  <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="aggregate-instance_method">
  <h3 class='signature '>
    #<strong>aggregate</strong>(pipeline, options = {})  &#x21d2; <a href="Collection/View/Aggregation.html" title="Mongo::Collection::View::Aggregation (class)">View::Aggregation</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Perform an aggregation on the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Perform an aggregation.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_aggregate'>aggregate</span>([ { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$group</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$city</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tpop</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$sum</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$pop</span><span class='tstring_end'>&quot;</span></span> }}} ])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>pipeline</span>
    <span class='type'>(<code>Array</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The aggregation pipeline.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The aggregation options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:allow_disk_use</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Set to true if disk usage is allowed during the aggregation.</p>
</div>        </li>
        <li>
          <span class='name'>:batch_size</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of documents to return per batch.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for the aggregation.</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the pipeline. See the server documentation for details.</p>
</div>        </li>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time in milliseconds to allow the aggregation to run.</p>
</div>        </li>
        <li>
          <span class='name'>:use_cursor</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Indicates whether the command will request that the server provide results using a cursor. Note that as of server version 3.6, aggregations always provide results using a cursor and this option is therefore not valid.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Collection/View/Aggregation.html" title="Mongo::Collection::View::Aggregation (class)">View::Aggregation</a>)</span>
&mdash;    <div class='inline'>
<p>The aggregation object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L540-L542'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='540' data-end='542'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 540</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_aggregate'>aggregate</span>(<span class='id identifier rubyid_pipeline'>pipeline</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_aggregate'><a href="Collection/View/Readable.html#aggregate-instance_method" title="Mongo::Collection::View::Readable#aggregate (method)">aggregate</a></span>(<span class='id identifier rubyid_pipeline'>pipeline</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bulk_write-instance_method">
  <h3 class='signature '>
    #<strong>bulk_write</strong>(requests, options = {})  &#x21d2; <a href="BulkWrite/Result.html" title="Mongo::BulkWrite::Result (class)">BulkWrite::Result</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Execute a batch of bulk write operations.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Execute a bulk write.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_bulk_write'>bulk_write</span>(<span class='id identifier rubyid_operations'>operations</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>requests</span>
    <span class='type'>(<code>Enumerable</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The bulk write requests.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:ordered</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether the operations should be executed in order.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Can be <code>:w</code> =&gt; Integer, <code>:fsync</code> =&gt; Boolean, <code>:j</code> =&gt; Boolean.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for the set of operations.</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="BulkWrite/Result.html" title="Mongo::BulkWrite::Result (class)">BulkWrite::Result</a>)</span>
&mdash;    <div class='inline'>
<p>The result of the operation.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L871-L873'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='871' data-end='873'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 871</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bulk_write'>bulk_write</span>(<span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="BulkWrite.html" title="Mongo::BulkWrite (class)">BulkWrite</a></span>.<span class='id identifier rubyid_new'><a href="BulkWrite.html#new-class_method" title="Mongo::BulkWrite.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_execute'><a href="BulkWrite.html#execute-instance_method" title="Mongo::BulkWrite#execute (method)">execute</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="count-instance_method">
  <h3 class='signature deprecated'>
    #<strong>count</strong>(filter = nil, options = {})  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'>
<p>Use #count_documents or estimated_document_count instead. However, note that the following operators will need to be substituted when switching to #count_documents:</p>

<pre class="code ruby"><code class="ruby"><span class='op'>*</span> <span class='gvar'>$where</span> <span class='id identifier rubyid_should'>should</span> <span class='id identifier rubyid_be'>be</span> <span class='id identifier rubyid_replaced'>replaced</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$expr</span> (<span class='id identifier rubyid_only'>only</span> <span class='id identifier rubyid_works'>works</span> <span class='id identifier rubyid_on'>on</span> <span class='float'>3.6</span><span class='op'>+</span>)
<span class='op'>*</span> <span class='gvar'>$near</span> <span class='id identifier rubyid_should'>should</span> <span class='id identifier rubyid_be'>be</span> <span class='id identifier rubyid_replaced'>replaced</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$geoWithin</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$center</span>
<span class='op'>*</span> <span class='gvar'>$nearSphere</span> <span class='id identifier rubyid_should'>should</span> <span class='id identifier rubyid_be'>be</span> <span class='id identifier rubyid_replaced'>replaced</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$geoWithin</span> <span class='id identifier rubyid_with'><a href="#with-instance_method" title="Mongo::Collection#with (method)">with</a></span> <span class='gvar'>$centerSphere</span></code></pre>
</div></div>

<p>Gets an estimated number of matching documents in the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the count.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_count'>count</span>(<span class='label'>name:</span> <span class='int'>1</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>A filter for matching documents.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The count options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use.</p>
</div>        </li>
        <li>
          <span class='name'>:limit</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum number of documents to count.</p>
</div>        </li>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run.</p>
</div>        </li>
        <li>
          <span class='name'>:skip</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of documents to skip before counting.</p>
</div>        </li>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference options.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'>
<p>The document count.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L644-L646'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='644' data-end='646'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 644</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_count'>count</span>(<span class='id identifier rubyid_filter'>filter</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_filter'>filter</span> <span class='op'>||</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_count'><a href="Collection/View/Readable.html#count-instance_method" title="Mongo::Collection::View::Readable#count (method)">count</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="count_documents-instance_method">
  <h3 class='signature '>
    #<strong>count_documents</strong>(filter = {}, options = {})  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Gets the number of documents matching the query. Unlike the deprecated #count method, this will return the exact number of documents matching the filter (or exact number of documents in the collection, if no filter is provided) rather than an estimate.</p>

<p>Use #estimated_document_count to retrieve an estimate of the number of documents in the collection using the collection metadata.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>A filter for matching documents.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p><a href="Options.html" title="Mongo::Options (module)"><code>Options</code></a> for the operation.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:skip</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of documents to skip.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Override default index selection and force MongoDB to use a specific index for the query. Requires server version 3.6+.</p>
</div>        </li>
        <li>
          <span class='name'>:limit</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>Max number of docs to count.</p>
</div>        </li>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run.</p>
</div>        </li>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference options.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'>
<p>The document count.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.6.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L674-L676'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='674' data-end='676'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 674</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_count_documents'>count_documents</span>(<span class='id identifier rubyid_filter'>filter</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_count_documents'><a href="Collection/View/Readable.html#count_documents-instance_method" title="Mongo::Collection::View::Readable#count_documents (method)">count_documents</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create-instance_method">
  <h3 class='signature '>
    #<strong>create</strong>(opts = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Force the collection to be created in the database.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Force the collection to be created.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_create'>create</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>opts</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options for the create operation.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>opts</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:capped</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Create a fixed-sized collection.</p>
</div>        </li>
        <li>
          <span class='name'>:change_stream_pre_and_post_images</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Used to enable pre- and post-images on the created collection. The hash may have the following items:</p>
<ul><li>
<p><strong>:enabled</strong> – true or false.</p>
</li></ul>
</div>        </li>
        <li>
          <span class='name'>:clustered_index</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Create a clustered index. This option specifies how this collection should be clustered on _id. The hash may have the following items:</p>
<ul><li>
<p><strong>:key</strong> – The clustered index key field. Must be set to { _id: 1 }.</p>
</li><li>
<p><strong>:unique</strong> – Must be set to true. The collection will not accept inserted or updated documents where the clustered index key value matches an existing value in the index.</p>
</li><li>
<p><strong>:name</strong> – Optional. A name that uniquely identifies the clustered index.</p>
</li></ul>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use when creating the collection. This option will not be sent to the server when calling collection methods.</p>
</div>        </li>
        <li>
          <span class='name'>:encrypted_fields</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Hash describing encrypted fields for queryable encryption.</p>
</div>        </li>
        <li>
          <span class='name'>:expire_after</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>Number indicating after how many seconds old time-series data should be deleted.</p>
</div>        </li>
        <li>
          <span class='name'>:max</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum number of documents in a capped collection. The size limit takes precedents over max.</p>
</div>        </li>
        <li>
          <span class='name'>:pipeline</span>
          <span class='type'>(<code>Array</code>&lt;<code>Hash</code>&gt;)</span>
            &mdash; <div class='inline'>
<p>An array of pipeline stages. A view will be created by applying this pipeline to the view_on collection or view.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for the operation.</p>
</div>        </li>
        <li>
          <span class='name'>:size</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The size of the capped collection.</p>
</div>        </li>
        <li>
          <span class='name'>:time_series</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Create a time-series collection. The hash may have the following items:</p>
<ul><li>
<p><strong>:timeField</strong> – The name of the field which contains the date in each time series document.</p>
</li><li>
<p><strong>:metaField</strong> – The name of the field which contains metadata in each time series document.</p>
</li><li>
<p><strong>:granularity</strong> – Set the granularity to the value that is the closest match to the time span between consecutive incoming measurements. Possible values are “seconds” (default), “minutes”, and “hours”.</p>
</li></ul>
</div>        </li>
        <li>
          <span class='name'>:validator</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Hash describing document validation options for the collection.</p>
</div>        </li>
        <li>
          <span class='name'>:view_on</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The name of the source collection or view from which to create a view.</p>
</div>        </li>
        <li>
          <span class='name'>:write</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Deprecated. Equivalent to <code>:write_concern</code> option.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Can be <code>:w</code> =&gt; Integer|String, <code>:fsync</code> =&gt; Boolean, <code>:j</code> =&gt; Boolean.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The result of the command.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L377-L419'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='377' data-end='419'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 377</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span>(<span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> {})
  <span class='comment'># Passing read options to create command causes it to break.
</span>  <span class='comment'># Filter the read options out. Session is also excluded here as it gets
</span>  <span class='comment'># used by the call to with_session and should not be part of the
</span>  <span class='comment'># operation. If it gets passed to the operation it would fail BSON
</span>  <span class='comment'># serialization.
</span>  <span class='comment'># TODO put the list of read options in a class-level constant when
</span>  <span class='comment'># we figure out what the full set of them is.
</span>  <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> <span class='const'>Hash</span>[<span class='kw'>self</span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_opts'>opts</span>).<span class='id identifier rubyid_reject'>reject</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>read</span><span class='words_sep'> </span><span class='tstring_content'>read_preference</span><span class='words_sep'> </span><span class='tstring_content'>read_concern</span><span class='words_sep'> </span><span class='tstring_content'>session</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_to_s'>to_s</span>)
  <span class='kw'>end</span>]
  <span class='comment'># Converting Ruby options to server style.
</span>  <span class='const'><a href="#CREATE_COLLECTION_OPTIONS-constant" title="Mongo::Collection::CREATE_COLLECTION_OPTIONS (constant)">CREATE_COLLECTION_OPTIONS</a></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ruby_key'>ruby_key</span><span class='comma'>,</span> <span class='id identifier rubyid_server_key'>server_key</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_ruby_key'>ruby_key</span>)
      <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='id identifier rubyid_server_key'>server_key</span>] <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_ruby_key'>ruby_key</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_operation'>operation</span> <span class='op'>=</span> { <span class='symbeg'>:</span><span class='id identifier rubyid_create'>create</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span> }.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
  <span class='id identifier rubyid_operation'>operation</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span>)
  <span class='id identifier rubyid_operation'>operation</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>)
  <span class='id identifier rubyid_client'>client</span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_with_session'>with_session</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_session'>session</span><span class='op'>|</span>
    <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>]
      <span class='const'><a href="WriteConcern.html" title="Mongo::WriteConcern (module)">WriteConcern</a></span>.<span class='id identifier rubyid_get'><a href="WriteConcern.html#get-instance_method" title="Mongo::WriteConcern#get (method)">get</a></span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>])
    <span class='kw'>else</span>
      <span class='kw'>self</span>.<span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Context.html" title="Mongo::Operation::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Context.html#new-class_method" title="Mongo::Operation::Context.new (method)">new</a></span>(<span class='label'>client:</span> <span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span>)
    <span class='id identifier rubyid_maybe_create_qe_collections'>maybe_create_qe_collections</span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_encrypted_fields'>encrypted_fields</span>]<span class='comma'>,</span> <span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_encrypted_fields'>encrypted_fields</span><span class='op'>|</span>
      <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Create.html" title="Mongo::Operation::Create (class)">Create</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Specifiable.html#initialize-instance_method" title="Mongo::Operation::Specifiable#initialize (method)">new</a></span>(
        <span class='label'>selector:</span> <span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span>
        <span class='label'>db_name:</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='comma'>,</span>
        <span class='label'>write_concern:</span> <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span><span class='comma'>,</span>
        <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span>
        <span class='comment'># Note that these are collection options, collation isn&#39;t
</span>        <span class='comment'># taken from options passed to the create method.
</span>        <span class='label'>collation:</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_collation'>collation</span>] <span class='op'>||</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>collation</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span>
        <span class='label'>encrypted_fields:</span> <span class='id identifier rubyid_encrypted_fields'>encrypted_fields</span><span class='comma'>,</span>
        <span class='label'>validator:</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_validator'>validator</span>]<span class='comma'>,</span>
      ).<span class='id identifier rubyid_execute'>execute</span>(<span class='id identifier rubyid_next_primary'>next_primary</span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span>)<span class='comma'>,</span> <span class='label'>context:</span> <span class='id identifier rubyid_context'>context</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_many-instance_method">
  <h3 class='signature '>
    #<strong>delete_many</strong>(filter = nil, options = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Remove documents from the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Remove multiple documents from the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_delete_many'>delete_many</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The response from the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L915-L917'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='915' data-end='917'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 915</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_many'>delete_many</span>(<span class='id identifier rubyid_filter'>filter</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_delete_many'>delete_many</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_one-instance_method">
  <h3 class='signature '>
    #<strong>delete_one</strong>(filter = nil, options = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Remove a document from the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Remove a single document from the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_delete_one'>delete_one</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The response from the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L893-L895'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='893' data-end='895'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 893</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_one'>delete_one</span>(<span class='id identifier rubyid_filter'>filter</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_delete_one'>delete_one</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="distinct-instance_method">
  <h3 class='signature '>
    #<strong>distinct</strong>(field_name, filter = nil, options = {})  &#x21d2; <code>Array</code>&lt;<code>Object</code>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a list of distinct values for a specific field.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the distinct values.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_distinct'>distinct</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>field_name</span>
    <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a>, <code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The name of the field.</p>
</div>
  </li>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>The documents from which to retrieve the distinct values.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The distinct command options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run.</p>
</div>        </li>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference options.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Array</code>&lt;<code>Object</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The list of distinct values.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L716-L718'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='716' data-end='718'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 716</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_distinct'>distinct</span>(<span class='id identifier rubyid_field_name'>field_name</span><span class='comma'>,</span> <span class='id identifier rubyid_filter'>filter</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_filter'>filter</span> <span class='op'>||</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_distinct'><a href="Collection/View/Readable.html#distinct-instance_method" title="Mongo::Collection::View::Readable#distinct (method)">distinct</a></span>(<span class='id identifier rubyid_field_name'>field_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="drop-instance_method">
  <h3 class='signature '>
    #<strong>drop</strong>(opts = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>An error returned if the collection doesn’t exist is suppressed.</p>
</div>
  </div>


<p>Drop the collection. Will also drop all indexes associated with the collection, as well as associated queryable encryption collections.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Drop the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_drop'>drop</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>opts</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options for the drop operation.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>opts</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for the operation.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options.</p>
</div>        </li>
        <li>
          <span class='name'>:encrypted_fields</span>
          <span class='type'>(<code>Hash</code> | <code>nil</code>)</span>
            &mdash; <div class='inline'>
<p>Encrypted fields hash that was provided to ‘create` collection helper.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The result of the command.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L439-L458'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='439' data-end='458'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 439</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_drop'>drop</span>(<span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_client'>client</span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_with_session'>with_session</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_session'>session</span><span class='op'>|</span>
    <span class='id identifier rubyid_maybe_drop_emm_collections'>maybe_drop_emm_collections</span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_encrypted_fields'>encrypted_fields</span>]<span class='comma'>,</span> <span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_temp_write_concern'>temp_write_concern</span> <span class='op'>=</span> <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>
      <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>]
        <span class='const'><a href="WriteConcern.html" title="Mongo::WriteConcern (module)">WriteConcern</a></span>.<span class='id identifier rubyid_get'><a href="WriteConcern.html#get-instance_method" title="Mongo::WriteConcern#get (method)">get</a></span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>])
      <span class='kw'>else</span>
        <span class='id identifier rubyid_temp_write_concern'>temp_write_concern</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Context.html" title="Mongo::Operation::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Context.html#new-class_method" title="Mongo::Operation::Context.new (method)">new</a></span>(<span class='label'>client:</span> <span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span>)
      <span class='id identifier rubyid_operation'>operation</span> <span class='op'>=</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Drop.html" title="Mongo::Operation::Drop (class)">Drop</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Specifiable.html#initialize-instance_method" title="Mongo::Operation::Specifiable#initialize (method)">new</a></span>({
        <span class='label'>selector:</span> { <span class='symbeg'>:</span><span class='id identifier rubyid_drop'>drop</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span> }<span class='comma'>,</span>
        <span class='label'>db_name:</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='comma'>,</span>
        <span class='label'>write_concern:</span> <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span><span class='comma'>,</span>
        <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span>
      })
      <span class='id identifier rubyid_do_drop'>do_drop</span>(<span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="estimated_document_count-instance_method">
  <h3 class='signature '>
    #<strong>estimated_document_count</strong>(options = {})  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Gets an estimate of the number of documents in the collection using the collection metadata.</p>

<p>Use #count_documents to retrieve the exact number of documents in the collection, or to count documents matching a filter.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p><a href="Options.html" title="Mongo::Options (module)"><code>Options</code></a> for the operation.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run for on the server.</p>
</div>        </li>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference options.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'>
<p>The document count.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.6.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L695-L697'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='695' data-end='697'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 695</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_estimated_document_count'>estimated_document_count</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_estimated_document_count'><a href="Collection/View/Readable.html#estimated_document_count-instance_method" title="Mongo::Collection::View::Readable#estimated_document_count (method)">estimated_document_count</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="find-instance_method">
  <h3 class='signature '>
    #<strong>find</strong>(filter = nil, options = {})  &#x21d2; <code>CollectionView</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Find documents in the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Find documents in the collection by a selector.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_find'>find</span>(<span class='label'>name:</span> <span class='int'>1</span>)</code></pre>
        <p class='example_title'><div class='inline'>
<p>Get all documents in a collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_find'>find</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>The filter to use in the find.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options for the find.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:allow_disk_use</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>When set to true, the server can write temporary data to disk while executing the find operation. This option is only available on MongoDB server versions 4.4 and newer.</p>
</div>        </li>
        <li>
          <span class='name'>:allow_partial_results</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Allows the query to get partial results if some shards are down.</p>
</div>        </li>
        <li>
          <span class='name'>:batch_size</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of documents returned in each batch of results from MongoDB.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:cursor_type</span>
          <span class='type'>(<code>:tailable</code>, <code>:tailable_await</code>)</span>
            &mdash; <div class='inline'>
<p>The type of cursor to use.</p>
</div>        </li>
        <li>
          <span class='name'>:limit</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The max number of docs to return from the query.</p>
</div>        </li>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the query to run, in milliseconds.</p>
</div>        </li>
        <li>
          <span class='name'>:modifiers</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>A document containing meta-operators modifying the output or behavior of a query.</p>
</div>        </li>
        <li>
          <span class='name'>:no_cursor_timeout</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>The server normally times out idle cursors after an inactivity period (10 minutes) to prevent excess memory use. Set this option to prevent that.</p>
</div>        </li>
        <li>
          <span class='name'>:oplog_replay</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>For internal replication use only, applications should not set this option.</p>
</div>        </li>
        <li>
          <span class='name'>:projection</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The fields to include or exclude from each doc in the result set.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:skip</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of docs to skip before returning results.</p>
</div>        </li>
        <li>
          <span class='name'>:sort</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The key and direction pairs by which the result set will be sorted.</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>CollectionView</code>)</span>
&mdash;    <div class='inline'>
<p>The collection view.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L505-L507'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='505' data-end='507'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 505</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_find'>find</span>(<span class='id identifier rubyid_filter'>filter</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_filter'>filter</span> <span class='op'>||</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="find_one_and_delete-instance_method">
  <h3 class='signature '>
    #<strong>find_one_and_delete</strong>(filter, options = {})  &#x21d2; <code>BSON::Document</code><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Finds a single document in the database via findAndModify and deletes it, returning the original document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Find one document and delete it.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_find_one_and_delete'>find_one_and_delete</span>(<span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run in milliseconds.</p>
</div>        </li>
        <li>
          <span class='name'>:projection</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The fields to include or exclude in the returned doc.</p>
</div>        </li>
        <li>
          <span class='name'>:sort</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The key and direction pairs by which the result set will be sorted.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Defaults to the collection’s write concern.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>BSON::Document</code>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>The document, if found.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L1053-L1055'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1053' data-end='1055'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 1053</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_find_one_and_delete'>find_one_and_delete</span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_find_one_and_delete'>find_one_and_delete</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="find_one_and_replace-instance_method">
  <h3 class='signature '>
    #<strong>find_one_and_replace</strong>(filter, replacement, options = {})  &#x21d2; <code>BSON::Document</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Finds a single document and replaces it, returning the original doc unless otherwise specified.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Find a document and replace it, returning the original.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_find_one_and_replace'>find_one_and_replace</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test1</span><span class='tstring_end'>&#39;</span></span> })</code></pre>
        <p class='example_title'><div class='inline'>
<p>Find a document and replace it, returning the new document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_find_one_and_replace'>find_one_and_replace</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test1</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_return_document'>return_document</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>replacement</span>
    <span class='type'>(<code>BSON::Document</code>)</span>
&mdash;    <div class='inline'>
<p>The replacement document.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run in milliseconds.</p>
</div>        </li>
        <li>
          <span class='name'>:projection</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The fields to include or exclude in the returned doc.</p>
</div>        </li>
        <li>
          <span class='name'>:sort</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The key and direction pairs by which the result set will be sorted.</p>
</div>        </li>
        <li>
          <span class='name'>:return_document</span>
          <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
            &mdash; <div class='inline'>
<p>Either <code>:before</code> or <code>:after</code>.</p>
</div>        </li>
        <li>
          <span class='name'>:upsert</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether to upsert if the document doesn’t exist.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Defaults to the collection’s write concern.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>BSON::Document</code>)</span>
&mdash;    <div class='inline'>
<p>The document.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L1131-L1133'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1131' data-end='1133'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 1131</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_find_one_and_replace'>find_one_and_replace</span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_replacement'>replacement</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_find_one_and_update'><a href="#find_one_and_update-instance_method" title="Mongo::Collection#find_one_and_update (method)">find_one_and_update</a></span>(<span class='id identifier rubyid_replacement'>replacement</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="find_one_and_update-instance_method">
  <h3 class='signature '>
    #<strong>find_one_and_update</strong>(filter, update, options = {})  &#x21d2; <code>BSON::Document</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Finds a single document via findAndModify and updates it, returning the original doc unless otherwise specified.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Find a document and update it, returning the original.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_find_one_and_update'>find_one_and_update</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$set</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test1</span><span class='tstring_end'>&#39;</span></span> }})</code></pre>
        <p class='example_title'><div class='inline'>
<p>Find a document and update it, returning the updated document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_find_one_and_update'>find_one_and_update</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$set</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test1</span><span class='tstring_end'>&#39;</span></span> }}<span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_return_document'>return_document</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>update</span>
    <span class='type'>(<code>Hash</code> | <code>Array</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The update document or pipeline.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run in milliseconds.</p>
</div>        </li>
        <li>
          <span class='name'>:projection</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The fields to include or exclude in the returned doc.</p>
</div>        </li>
        <li>
          <span class='name'>:sort</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The key and direction pairs by which the result set will be sorted.</p>
</div>        </li>
        <li>
          <span class='name'>:return_document</span>
          <span class='type'>(<a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
            &mdash; <div class='inline'>
<p>Either <code>:before</code> or <code>:after</code>.</p>
</div>        </li>
        <li>
          <span class='name'>:upsert</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether to upsert if the document doesn’t exist.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Defaults to the collection’s write concern.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:array_filters</span>
          <span class='type'>(<code>Array</code>)</span>
            &mdash; <div class='inline'>
<p>A set of filters specifying to which array elements an update should apply.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>BSON::Document</code>)</span>
&mdash;    <div class='inline'>
<p>The document.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L1093-L1095'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1093' data-end='1095'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 1093</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_find_one_and_update'>find_one_and_update</span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_find_one_and_update'>find_one_and_update</span>(<span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="indexes-instance_method">
  <h3 class='signature '>
    #<strong>indexes</strong>(options = {})  &#x21d2; <a href="Index/View.html" title="Mongo::Index::View (class)">Index::View</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a view of all indexes for this collection. Can be iterated or has more operations.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the index view.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_indexes'>indexes</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p><a href="Options.html" title="Mongo::Options (module)"><code>Options</code></a> for getting a list of all indexes.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Index/View.html" title="Mongo::Index::View (class)">Index::View</a>)</span>
&mdash;    <div class='inline'>
<p>The index view.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L733-L735'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='733' data-end='735'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 733</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_indexes'>indexes</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Index.html" title="Mongo::Index (module)">Index</a></span><span class='op'>::</span><span class='const'><a href="Index/View.html" title="Mongo::Index::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Index/View.html#new-class_method" title="Mongo::Index::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="insert_many-instance_method">
  <h3 class='signature '>
    #<strong>insert_many</strong>(documents, options = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Insert the provided documents into the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Insert documents into the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_insert_many'>insert_many</span>([{ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>documents</span>
    <span class='type'>(<code>Enumerable</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The documents to insert.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The insert options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:ordered</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether the operations should be executed in order.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for the operation.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Can be <code>:w</code> =&gt; Integer, <code>:fsync</code> =&gt; Boolean, <code>:j</code> =&gt; Boolean.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The database response wrapper.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L843-L848'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='843' data-end='848'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 843</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_insert_many'>insert_many</span>(<span class='id identifier rubyid_documents'>documents</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="QueryCache.html" title="Mongo::QueryCache (module)">QueryCache</a></span>.<span class='id identifier rubyid_clear_namespace'><a href="QueryCache.html#clear_namespace-class_method" title="Mongo::QueryCache.clear_namespace (method)">clear_namespace</a></span>(<span class='id identifier rubyid_namespace'><a href="#namespace-instance_method" title="Mongo::Collection#namespace (method)">namespace</a></span>)

  <span class='id identifier rubyid_inserts'>inserts</span> <span class='op'>=</span> <span class='id identifier rubyid_documents'>documents</span>.<span class='id identifier rubyid_map'>map</span>{ <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span> { <span class='symbeg'>:</span><span class='id identifier rubyid_insert_one'><a href="#insert_one-instance_method" title="Mongo::Collection#insert_one (method)">insert_one</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_doc'>doc</span> }}
  <span class='id identifier rubyid_bulk_write'><a href="#bulk_write-instance_method" title="Mongo::Collection#bulk_write (method)">bulk_write</a></span>(<span class='id identifier rubyid_inserts'>inserts</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="insert_one-instance_method">
  <h3 class='signature '>
    #<strong>insert_one</strong>(document, opts = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Insert a single document into the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Insert a document into the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_insert_one'>insert_one</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>document</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The document to insert.</p>
</div>
  </li>
  <li>
    <span class='name'>opts</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The insert options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>opts</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for the operation.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Can be <code>:w</code> =&gt; Integer, <code>:fsync</code> =&gt; Boolean, <code>:j</code> =&gt; Boolean.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The database response wrapper.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L790-L820'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='790' data-end='820'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 790</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_insert_one'>insert_one</span>(<span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> {})
  <span class='const'><a href="QueryCache.html" title="Mongo::QueryCache (module)">QueryCache</a></span>.<span class='id identifier rubyid_clear_namespace'><a href="QueryCache.html#clear_namespace-class_method" title="Mongo::QueryCache.clear_namespace (method)">clear_namespace</a></span>(<span class='id identifier rubyid_namespace'><a href="#namespace-instance_method" title="Mongo::Collection#namespace (method)">namespace</a></span>)

  <span class='id identifier rubyid_client'>client</span>.<span class='id identifier rubyid_with_session'>with_session</span>(<span class='id identifier rubyid_opts'>opts</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_session'>session</span><span class='op'>|</span>
    <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>]
      <span class='const'><a href="WriteConcern.html" title="Mongo::WriteConcern (module)">WriteConcern</a></span>.<span class='id identifier rubyid_get'><a href="WriteConcern.html#get-instance_method" title="Mongo::WriteConcern#get (method)">get</a></span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>])
    <span class='kw'>else</span>
      <span class='id identifier rubyid_write_concern_with_session'><a href="#write_concern_with_session-instance_method" title="Mongo::Collection#write_concern_with_session (method)">write_concern_with_session</a></span>(<span class='id identifier rubyid_session'>session</span>)
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_document'>document</span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Document to be inserted cannot be nil</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Context.html" title="Mongo::Operation::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Context.html#new-class_method" title="Mongo::Operation::Context.new (method)">new</a></span>(<span class='label'>client:</span> <span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span>)
    <span class='id identifier rubyid_write_with_retry'>write_with_retry</span>(<span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span><span class='comma'>,</span> <span class='label'>context:</span> <span class='id identifier rubyid_context'>context</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_connection'>connection</span><span class='comma'>,</span> <span class='id identifier rubyid_txn_num'>txn_num</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='op'>|</span>
      <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Insert.html" title="Mongo::Operation::Insert (class)">Insert</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Specifiable.html#initialize-instance_method" title="Mongo::Operation::Specifiable#initialize (method)">new</a></span>(
        <span class='symbeg'>:</span><span class='id identifier rubyid_documents'>documents</span> <span class='op'>=&gt;</span> [ <span class='id identifier rubyid_document'>document</span> ]<span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_db_name'>db_name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_coll_name'>coll_name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span><span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_bypass_document_validation'>bypass_document_validation</span> <span class='op'>=&gt;</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_bypass_document_validation'>bypass_document_validation</span>]<span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_id_generator'>id_generator</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_client'>client</span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_id_generator'>id_generator</span>]<span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_txn_num'>txn_num</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_txn_num'>txn_num</span><span class='comma'>,</span>
        <span class='symbeg'>:</span><span class='id identifier rubyid_comment'>comment</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_comment'>comment</span>]
      ).<span class='id identifier rubyid_execute_with_connection'>execute_with_connection</span>(<span class='id identifier rubyid_connection'>connection</span><span class='comma'>,</span> <span class='label'>context:</span> <span class='id identifier rubyid_context'>context</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature '>
    #<strong>inspect</strong>  &#x21d2; <code>String</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a pretty printed string inspection for the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Inspect the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_inspect'>inspect</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The collection inspection.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L767-L769'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='767' data-end='769'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 767</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Mongo::Collection:0x</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> namespace=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_namespace'><a href="#namespace-instance_method" title="Mongo::Collection#namespace (method)">namespace</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="namespace-instance_method">
  <h3 class='signature '>
    #<strong>namespace</strong>  &#x21d2; <code>String</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the fully qualified namespace of the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the fully qualified namespace.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_namespace'>namespace</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The collection namespace.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L1143-L1145'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1143' data-end='1145'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 1143</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_namespace'>namespace</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parallel_scan-instance_method">
  <h3 class='signature '>
    #<strong>parallel_scan</strong>(cursor_count, options = {})  &#x21d2; <code>Array</code>&lt;<a href="Cursor.html" title="Mongo::Cursor (class)">Cursor</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Execute a parallel scan on the collection view.</p>

<p>Returns a list of up to cursor_count cursors that can be iterated concurrently. As long as the collection is not modified during scanning, each document appears once in one of the cursors’ result sets.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Execute a parallel collection scan.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_parallel_scan'>parallel_scan</span>(<span class='int'>2</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>cursor_count</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'>
<p>The max number of cursors to return.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The parallel scan command options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the command to run in milliseconds.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Array</code>&lt;<a href="Cursor.html" title="Mongo::Cursor (class)">Cursor</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>An array of cursors.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L938-L940'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='938' data-end='940'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 938</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parallel_scan'>parallel_scan</span>(<span class='id identifier rubyid_cursor_count'>cursor_count</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>({}<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_parallel_scan'>parallel_scan</span><span class='comma'>,</span> <span class='id identifier rubyid_cursor_count'>cursor_count</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="read_concern-instance_method">
  <h3 class='signature '>
    #<strong>read_concern</strong>  &#x21d2; <code>Hash</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the effective read concern for this collection instance.</p>

<p>If a read concern was provided in collection options, that read concern will be returned, otherwise the database’s effective read concern will be returned.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the read concern.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_read_concern'>read_concern</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The read concern.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.2.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L188-L190'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='188' data-end='190'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 188</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_read_concern'>read_concern</span>
  <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_read_concern'>read_concern</span>] <span class='op'>||</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_read_concern'>read_concern</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="read_preference-instance_method">
  <h3 class='signature '>
    #<strong>read_preference</strong>  &#x21d2; <code>Hash</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the effective read preference for this collection.</p>

<p>If a read preference was provided in collection options, that read preference will be returned, otherwise the database’s effective read preference will be returned.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the read preference.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_read_preference'>read_preference</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The read preference.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L216-L218'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='216' data-end='218'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 216</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_read_preference'>read_preference</span>
  <span class='ivar'>@read_preference</span> <span class='op'>||=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_read'>read</span>] <span class='op'>||</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_read_preference'>read_preference</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="replace_one-instance_method">
  <h3 class='signature '>
    #<strong>replace_one</strong>(filter, replacement, options = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Replaces a single document in the collection with the new document.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Replace a single document.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_replace_one'>replace_one</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test1</span><span class='tstring_end'>&#39;</span></span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>replacement</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The replacement document..</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:upsert</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether to upsert if the document doesn’t exist.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The response from the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L965-L967'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='965' data-end='967'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 965</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_replace_one'>replace_one</span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_replacement'>replacement</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_replace_one'>replace_one</span>(<span class='id identifier rubyid_replacement'>replacement</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="search_indexes-instance_method">
  <h3 class='signature '>
    #<strong>search_indexes</strong>(options = {})  &#x21d2; <a href="SearchIndex/View.html" title="Mongo::SearchIndex::View (class)">SearchIndex::View</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Only one of id or name may be given; it is an error to specify both, although both may be omitted safely.</p>
</div>
  </div>


<p>Get a view of all search indexes for this collection. Can be iterated or operated on directly. If id or name are given, the iterator will return only the indicated index. For all other operations, id and name are ignored.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options to use to configure the view.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:id</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The id of the specific index to query (optional)</p>
</div>        </li>
        <li>
          <span class='name'>:name</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The name of the specific index to query (optional)</p>
</div>        </li>
        <li>
          <span class='name'>:aggregate</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The options hash to pass to the aggregate command (optional)</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="SearchIndex/View.html" title="Mongo::SearchIndex::View (class)">SearchIndex::View</a>)</span>
&mdash;    <div class='inline'>
<p>The search index view.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L755-L757'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='755' data-end='757'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 755</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_search_indexes'>search_indexes</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="SearchIndex.html" title="Mongo::SearchIndex (module)">SearchIndex</a></span><span class='op'>::</span><span class='const'><a href="SearchIndex/View.html" title="Mongo::SearchIndex::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="SearchIndex/View.html#new-class_method" title="Mongo::SearchIndex::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_selector-instance_method">
  <h3 class='signature '>
    #<strong>server_selector</strong>  &#x21d2; <a href="ServerSelector.html" title="Mongo::ServerSelector (module)">Mongo::ServerSelector</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the server selector for this collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the server selector.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_server_selector'>server_selector</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="ServerSelector.html" title="Mongo::ServerSelector (module)">Mongo::ServerSelector</a>)</span>
&mdash;    <div class='inline'>
<p>The server selector.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L200-L202'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='200' data-end='202'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 200</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_server_selector'>server_selector</span>
  <span class='ivar'>@server_selector</span> <span class='op'>||=</span> <span class='const'><a href="ServerSelector.html" title="Mongo::ServerSelector (module)">ServerSelector</a></span>.<span class='id identifier rubyid_get'><a href="ServerSelector.html#get-instance_method" title="Mongo::ServerSelector#get (method)">get</a></span>(<span class='id identifier rubyid_read_preference'><a href="#read_preference-instance_method" title="Mongo::Collection#read_preference (method)">read_preference</a></span> <span class='op'>||</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_server_selector'>server_selector</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="update_many-instance_method">
  <h3 class='signature '>
    #<strong>update_many</strong>(filter, update, options = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Update documents in the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Update multiple documents in the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_update_many'>update_many</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$set</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test1</span><span class='tstring_end'>&#39;</span></span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>update</span>
    <span class='type'>(<code>Hash</code> | <code>Array</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The update document or pipeline.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:upsert</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether to upsert if the document doesn’t exist.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:array_filters</span>
          <span class='type'>(<code>Array</code>)</span>
            &mdash; <div class='inline'>
<p>A set of filters specifying to which array elements an update should apply.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The response from the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L994-L996'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='994' data-end='996'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 994</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_update_many'>update_many</span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_update_many'>update_many</span>(<span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="update_one-instance_method">
  <h3 class='signature '>
    #<strong>update_one</strong>(filter, update, options = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Update a single document in the collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Update a single document in the collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_update_one'>update_one</span>({ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$set</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test1</span><span class='tstring_end'>&#39;</span></span>})</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filter</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The filter to use.</p>
</div>
  </li>
  <li>
    <span class='name'>update</span>
    <span class='type'>(<code>Hash</code> | <code>Array</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The update document or pipeline.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:upsert</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether to upsert if the document doesn’t exist.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:array_filters</span>
          <span class='type'>(<code>Array</code>)</span>
            &mdash; <div class='inline'>
<p>A set of filters specifying to which array elements an update should apply.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>Hash</code> | <code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for this operation. May be specified as a Hash (e.g. { _id: 1 }) or a String (e.g. “<em>id</em>”).</p>
</div>        </li>
        <li>
          <span class='name'>:let</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Mapping of variables to use in the command. See the server documentation for details.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The response from the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L1023-L1025'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1023' data-end='1025'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 1023</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_update_one'>update_one</span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_find'><a href="#find-instance_method" title="Mongo::Collection#find (method)">find</a></span>(<span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>).<span class='id identifier rubyid_update_one'>update_one</span>(<span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="watch-instance_method">
  <h3 class='signature '>
    #<strong>watch</strong>(pipeline = [], options = {})  &#x21d2; <code>ChangeStream</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>A change stream only allows ‘majority’ read concern.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This helper method is preferable to running a raw aggregation with a $changeStream stage, for the purpose of supporting resumability.</p>
</div>
  </div>


<p>As of version 3.6 of the MongoDB server, a “$changeStream“ pipeline stage is supported in the aggregation framework. This stage allows users to request that notifications are sent for all changes to a particular collection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get change notifications for a given collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_watch'>watch</span>([{ <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$match</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> { <span class='label'>operationType:</span> { <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$in</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> [<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>insert</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>replace</span><span class='tstring_end'>&#39;</span></span>] } } }])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>pipeline</span>
    <span class='type'>(<code>Array</code>&lt;<code>Hash</code>&gt;)</span>
    <em class='default'>(defaults to: <tt>[]</tt>)</em>
&mdash;    <div class='inline'>
<p>Optional additional filter operators.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The change stream options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:full_document</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>Allowed values: nil, ‘default’, ‘updateLookup’, ‘whenAvailable’, ‘required’.</p>

<p>The default is to not send a value (i.e. nil), which is equivalent to ‘default’. By default, the change notification for partial updates will include a delta describing the changes to the document.</p>

<p>When set to ‘updateLookup’, the change notification for partial updates will include both a delta describing the changes to the document as well as a copy of the entire document that was changed from some time after the change occurred.</p>

<p>When set to ‘whenAvailable’, configures the change stream to return the post-image of the modified document for replace and update change events if the post-image for this event is available.</p>

<p>When set to ‘required’, the same behavior as ‘whenAvailable’ except that an error is raised if the post-image is not available.</p>
</div>        </li>
        <li>
          <span class='name'>:full_document_before_change</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>Allowed values: nil, ‘whenAvailable’, ‘required’, ‘off’.</p>

<p>The default is to not send a value (i.e. nil), which is equivalent to ‘off’.</p>

<p>When set to ‘whenAvailable’, configures the change stream to return the pre-image of the modified document for replace, update, and delete change events if it is available.</p>

<p>When set to ‘required’, the same behavior as ‘whenAvailable’ except that an error is raised if the pre-image is not available.</p>
</div>        </li>
        <li>
          <span class='name'>:resume_after</span>
          <span class='type'>(<code>BSON::Document</code>, <code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Specifies the logical starting point for the new change stream.</p>
</div>        </li>
        <li>
          <span class='name'>:max_await_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time for the server to wait on new documents to satisfy a change stream query.</p>
</div>        </li>
        <li>
          <span class='name'>:batch_size</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of documents to return per batch.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>BSON::Document</code>, <code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:start_at_operation_time</span>
          <span class='type'>(<code>BSON::Timestamp</code>)</span>
            &mdash; <div class='inline'>
<p>Only return changes that occurred at or after the specified timestamp. Any command run against the server will return a cluster time that can be used here. Only recognized by server versions 4.0+.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:show_expanded_events</span>
          <span class='type'>(<code>Boolean</code>)</span>
            &mdash; <div class='inline'>
<p>Enables the server to send the ‘expanded’ list of change stream events. The list of additional events included with this flag set are: createIndexes, dropIndexes, modify, create, shardCollection, reshardCollection, refineCollectionShardKey.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>ChangeStream</code>)</span>
&mdash;    <div class='inline'>
<p>The change stream object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.5.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L611-L615'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='611' data-end='615'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 611</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_watch'>watch</span>(<span class='id identifier rubyid_pipeline'>pipeline</span> <span class='op'>=</span> []<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_view_options'>view_options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_view_options'>view_options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_await_data'>await_data</span>] <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_max_await_time_ms'>max_await_time_ms</span>]
  <span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span><span class='op'>::</span><span class='const'><a href="Collection/View/ChangeStream.html" title="Mongo::Collection::View::ChangeStream (class)">ChangeStream</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View/ChangeStream.html#new-class_method" title="Mongo::Collection::View::ChangeStream.new (method)">new</a></span>(<span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_view_options'>view_options</span>)<span class='comma'>,</span> <span class='id identifier rubyid_pipeline'>pipeline</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="with-instance_method">
  <h3 class='signature '>
    #<strong>with</strong>(new_options)  &#x21d2; <code>Collection</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get a collection with a changed read concern.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_with'>with</span>(<span class='label'>read_concern:</span> { <span class='label'>level:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_majority'>majority</span> })</code></pre>
        <p class='example_title'><div class='inline'>
<p>Get a collection with a changed write concern.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_with'>with</span>(<span class='label'>write_concern:</span> { <span class='label'>w:</span>  <span class='int'>3</span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>new_options</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The new options to use.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>new_options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference options. The hash may have the following items:</p>
<ul><li>
<p><strong>:mode</strong> – read preference specified as a symbol; valid values are <strong>:primary</strong>, <strong>:primary_preferred</strong>, <strong>:secondary</strong>, <strong>:secondary_preferred</strong> and <strong>:nearest</strong>.</p>
</li><li>
<p><strong>:tag_sets</strong> – an array of hashes.</p>
</li><li>
<p><strong>:local_threshold</strong>.</p>
</li></ul>
</div>        </li>
        <li>
          <span class='name'>:read_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read concern options hash, with the following optional keys:</p>
<ul><li>
<p><strong>:level</strong> – the read preference level as a symbol; valid values</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_are'>are</span> <span class='op'>*</span><span class='symbeg'>:</span><span class='id identifier rubyid_local'>local</span><span class='op'>*</span><span class='comma'>,</span> <span class='op'>*</span><span class='symbeg'>:</span><span class='id identifier rubyid_majority'>majority</span><span class='op'>*</span><span class='comma'>,</span> <span class='kw'>and</span> <span class='op'>*</span><span class='symbeg'>:</span><span class='id identifier rubyid_snapshot'>snapshot</span><span class='op'>*</span></code></pre>
</li></ul>
</div>        </li>
        <li>
          <span class='name'>:write</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Deprecated. Equivalent to <code>:write_concern</code> option.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Can be <code>:w</code> =&gt; Integer|String, <code>:fsync</code> =&gt; Boolean, <code>:j</code> =&gt; Boolean.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Collection</code>)</span>
&mdash;    <div class='inline'>
<p>A new collection instance.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L294-L306'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='294' data-end='306'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 294</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_with'>with</span>(<span class='id identifier rubyid_new_options'>new_options</span>)
  <span class='id identifier rubyid_new_options'>new_options</span>.<span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/UnchangeableCollectionOption.html" title="Mongo::Error::UnchangeableCollectionOption (class)">UnchangeableCollectionOption</a></span>.<span class='id identifier rubyid_new'><a href="Error/UnchangeableCollectionOption.html#new-class_method" title="Mongo::Error::UnchangeableCollectionOption.new (method)">new</a></span>(<span class='id identifier rubyid_k'>k</span>) <span class='kw'>unless</span> <span class='const'><a href="#CHANGEABLE_OPTIONS-constant" title="Mongo::Collection::CHANGEABLE_OPTIONS (constant)">CHANGEABLE_OPTIONS</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_k'>k</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span> <span class='op'>=</span> <span class='ivar'>@options</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_new_options'>new_options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>]
    <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span>)
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_new_options'>new_options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span>]
    <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>)
  <span class='kw'>end</span>
  <span class='const'>Collection</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongo::Collection.new (method)">new</a></span>(<span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span><span class='comma'>,</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Collection#name (method)">name</a></span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_update'>update</span>(<span class='id identifier rubyid_new_options'>new_options</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="write_concern-instance_method">
  <h3 class='signature '>
    #<strong>write_concern</strong>  &#x21d2; <a href="WriteConcern.html" title="Mongo::WriteConcern (module)">Mongo::WriteConcern</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the effective write concern on this collection.</p>

<p>If a write concern was provided in collection options, that write concern will be returned, otherwise the database’s effective write concern will be returned.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the write concern.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'>collection</span>.<span class='id identifier rubyid_write_concern'>write_concern</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="WriteConcern.html" title="Mongo::WriteConcern (module)">Mongo::WriteConcern</a>)</span>
&mdash;    <div class='inline'>
<p>The write concern.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L232-L235'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='232' data-end='235'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 232</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_write_concern'>write_concern</span>
  <span class='ivar'>@write_concern</span> <span class='op'>||=</span> <span class='const'><a href="WriteConcern.html" title="Mongo::WriteConcern (module)">WriteConcern</a></span>.<span class='id identifier rubyid_get'><a href="WriteConcern.html#get-instance_method" title="Mongo::WriteConcern#get (method)">get</a></span>(
    <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'>write_concern</span>] <span class='op'>||</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write'>write</span>] <span class='op'>||</span> <span class='id identifier rubyid_database'><a href="#database-instance_method" title="Mongo::Collection#database (method)">database</a></span>.<span class='id identifier rubyid_write_concern'>write_concern</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="write_concern_with_session-instance_method">
  <h3 class='signature nodoc'>
    #<strong>write_concern_with_session</strong>(session)  &#x21d2; <a href="WriteConcern.html" title="Mongo::WriteConcern (module)">Mongo::WriteConcern</a> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the write concern to use for an operation on this collection, given a session.</p>

<p>If the session is in a transaction and the collection has an unacknowledged write concern, remove the write concern’s <code>:w</code> option. Otherwise, return the unmodified write concern.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="WriteConcern.html" title="Mongo::WriteConcern (module)">Mongo::WriteConcern</a>)</span>
&mdash;    <div class='inline'>
<p>The write concern.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/collection.rb#L248-L258'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='248' data-end='258'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/collection.rb', line 248</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_write_concern_with_session'>write_concern_with_session</span>(<span class='id identifier rubyid_session'>session</span>)
  <span class='id identifier rubyid_wc'>wc</span> <span class='op'>=</span> <span class='id identifier rubyid_write_concern'><a href="#write_concern-instance_method" title="Mongo::Collection#write_concern (method)">write_concern</a></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_session'>session</span>.<span class='id identifier rubyid_in_transaction?'>in_transaction?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_wc'>wc</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_wc'>wc</span>.<span class='id identifier rubyid_acknowledged?'>acknowledged?</span>
      <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='id identifier rubyid_wc'>wc</span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Collection#options (method)">options</a></span>.<span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_w'>w</span>)
      <span class='kw'>return</span> <span class='const'><a href="WriteConcern.html" title="Mongo::WriteConcern (module)">WriteConcern</a></span>.<span class='id identifier rubyid_get'><a href="WriteConcern.html#get-instance_method" title="Mongo::WriteConcern#get (method)">get</a></span>(<span class='id identifier rubyid_opts'>opts</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_wc'>wc</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>