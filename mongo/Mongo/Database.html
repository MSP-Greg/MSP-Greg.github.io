<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongo::Database &mdash; Mongo master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongo::Database",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongo master</a> &raquo; 
      <a href='../_index.html#alpha_D'>Index (D)</a> &raquo; 
        <a href="../Mongo.html" title="Mongo (module)">Mongo</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Database&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongo::Database</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Database/View.html" title="Mongo::Database::View (class)"><code>View</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          Forwardable
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Retryable.html" title="Mongo::Retryable (module)"><code>Retryable</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L26'>lib/mongo/database.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database/view.rb#L21'>lib/mongo/database/view.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Represents a database on the db server and operations that can execute on it at this level.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ADMIN-constant' class='summary_signature'>ADMIN =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The admin database name.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L33-L33'># File 'lib/mongo/database.rb', line 33</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>admin</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='COMMAND-constant' class='summary_signature'>COMMAND =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The “collection” that database commands operate against.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L38-L38'># File 'lib/mongo/database.rb', line 38</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$cmd</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='DATABASES-constant' class='summary_signature'>DATABASES =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Databases constant.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L54-L54'># File 'lib/mongo/database.rb', line 54</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>databases</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='DEFAULT_OPTIONS-constant' class='summary_signature'>DEFAULT_OPTIONS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The default database options.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L43-L43'># File 'lib/mongo/database.rb', line 43</a>    <pre class='code ruby'><span class='const'><a href="Options.html" title="Mongo::Options (module)">Options</a></span><span class='op'>::</span><span class='const'><a href="Options/Redacted.html" title="Mongo::Options::Redacted (class)">Redacted</a></span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongo::Database.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_database'>database</span> <span class='op'>=&gt;</span> <span class='const'><a href="#ADMIN-constant" title="Mongo::Database::ADMIN (constant)">ADMIN</a></span>).<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='NAME-constant' class='summary_signature deprecated'>NAME =</span>
    <div class='docstring'>
  <div class='discussion'>
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'></div></div>

<p><code>Database</code> name field constant.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L49-L49'># File 'lib/mongo/database.rb', line 49</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='NAMESPACES-constant' class='summary_signature'>NAMESPACES =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The name of the collection that holds all the collection names.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L59-L59'># File 'lib/mongo/database.rb', line 59</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>system.namespaces</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#create-class_method" title=".create (class method)">.<strong>create</strong>(client)  &#x21d2; Database </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Create a database for the provided client, for use when we don’t want the client’s original database instance to be the same.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(client, name, options = {})  &#x21d2; Database </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Instantiate a new database object.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#client-instance_method" title="#client (instance method)">#<strong>client</strong>  &#x21d2; Client </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; String </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  &#x21d2; Hash </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#==-instance_method" title="#== (instance method)">#<strong>==</strong>(other)  &#x21d2; true, false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Check equality of the database object against another.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(collection_name, options = {})  &#x21d2; Mongo::Collection </a>
      (also: #collection)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a collection in this database by the provided name.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#aggregate-instance_method" title="#aggregate (instance method)">#<strong>aggregate</strong>(pipeline, options = {})  &#x21d2; Collection::View::Aggregation </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Perform an aggregation on the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#cluster-instance_method" title="#cluster (instance method)">#<strong>cluster</strong>  &#x21d2; Mongo::Server </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#collection-instance_method" title="#collection (instance method)">#<strong>collection</strong>(collection_name, options = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#[]-instance_method" title="Mongo::Database#[] (method)">#[]</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#collection_names-instance_method" title="#collection_names (instance method)">#<strong>collection_names</strong>(options = {})  &#x21d2; Array&lt;String&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the names of the non-system collections in the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#collections-instance_method" title="#collections (instance method)">#<strong>collections</strong>(options = {})  &#x21d2; Array&lt;Mongo::Collection&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get all the non-system collections that belong to this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#command-instance_method" title="#command (instance method)">#<strong>command</strong>(operation, opts = {})  &#x21d2; Mongo::Operation::Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Execute a command on the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#drop-instance_method" title="#drop (instance method)">#<strong>drop</strong>(options = {})  &#x21d2; Result </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Drop the database and all its associated information.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#fs-instance_method" title="#fs (instance method)">#<strong>fs</strong>(options = {})  &#x21d2; Grid::FSBucket </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the <a href="Grid.html" title="Mongo::Grid (module)"><code>Grid</code></a> “filesystem” for this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a pretty printed string inspection for the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#list_collections-instance_method" title="#list_collections (instance method)">#<strong>list_collections</strong>(options = {})  &#x21d2; Array&lt;Hash&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get info on all the non-system collections in the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#operation_timeouts-instance_method" title="#operation_timeouts (instance method)">#<strong>operation_timeouts</strong>(opts)  &#x21d2; Hash </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#read_command-instance_method" title="#read_command (instance method)">#<strong>read_command</strong>(operation, opts = {})  &#x21d2; Hash </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Execute a read command on the database, retrying the read if necessary.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#timeout_ms-instance_method" title="#timeout_ms (instance method)">#<strong>timeout_ms</strong>  &#x21d2; Integer | nil </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#users-instance_method" title="#users (instance method)">#<strong>users</strong>  &#x21d2; View::User </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the user view for this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#watch-instance_method" title="#watch (instance method)">#<strong>watch</strong>(pipeline = [], options = {})  &#x21d2; ChangeStream </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>As of version 3.6 of the MongoDB server, a “$changeStream“ pipeline stage is supported in the aggregation framework.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Retryable.html" title="Mongo::Retryable (module)"><code>Retryable</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Retryable.html#read_worker-instance_method" title="Mongo::Retryable#read_worker (method)">#read_worker</a></td>
      <td><div class='inline'><p>Returns the read worker for handling retryable reads.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Retryable.html#select_server-instance_method" title="Mongo::Retryable#select_server (method)">#select_server</a></td>
      <td><div class='inline'><p>This is a separate method to make it possible for the test suite to assert that server selection is performed during retry attempts.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Retryable.html#write_worker-instance_method" title="Mongo::Retryable#write_worker (method)">#write_worker</a></td>
      <td><div class='inline'><p>Returns the write worker for handling retryable writes.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(client, name, options = {})  &#x21d2; <code>Database</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Instantiate a new database object.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Instantiate the database.</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'>Database</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_test'>test</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>client</span>
    <span class='type'>(<a href="Client.html" title="Mongo::Client (class)">Mongo::Client</a>)</span>
&mdash;    <div class='inline'>
<p>The driver client.</p>
</div>
  </li>
  <li>
    <span class='name'>name</span>
    <span class='type'>(<code>String</code>, <a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the database.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:timeout_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The operation timeout in milliseconds. Must be a non-negative integer. An explicit value of 0 means infinite. The default value is unset which means the value is inherited from the client.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>Mongo::Database::InvalidName</code>)</span>
&mdash;    <div class='inline'>
<p>If the name is nil.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L369-L377'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='369' data-end='377'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 369</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span><span class='comma'>,</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/InvalidDatabaseName.html" title="Mongo::Error::InvalidDatabaseName (class)">InvalidDatabaseName</a></span>.<span class='id identifier rubyid_new'><a href="Error/InvalidDatabaseName.html#new-class_method" title="Mongo::Error::InvalidDatabaseName.new (method)">new</a></span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span>
  <span class='kw'>if</span> <span class='const'><a href="Lint.html" title="Mongo::Lint (module)">Lint</a></span>.<span class='id identifier rubyid_enabled?'><a href="Lint.html#enabled%3F-class_method" title="Mongo::Lint.enabled? (method)">enabled?</a></span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span>(<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>String</span>) <span class='op'>||</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span>))
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Database name must be a string or a symbol: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='ivar'>@client</span> <span class='op'>=</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>
  <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_freeze'>freeze</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>.<span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="create-class_method">
  <h3 class='signature nodoc first'>
    .<strong>create</strong>(client)  &#x21d2; <code>Database</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Create a database for the provided client, for use when we don’t want the client’s original database instance to be the same.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Create a database for the client.</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'>Database</span>.<span class='id identifier rubyid_create'>create</span>(<span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>client</span>
    <span class='type'>(<a href="Client.html" title="Mongo::Client (class)">Client</a>)</span>
&mdash;    <div class='inline'>
<p>The client to create on.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Database</code>)</span>
&mdash;    <div class='inline'>
<p>The database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L550-L553'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='550' data-end='553'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 550</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_create'>create</span>(<span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>)
  <span class='id identifier rubyid_database'>database</span> <span class='op'>=</span> <span class='const'>Database</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongo::Database.new (method)">new</a></span>(<span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span><span class='comma'>,</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_database'>database</span>]<span class='comma'>,</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
  <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='symbeg'>:</span><span class='ivar'>@database</span><span class='comma'>,</span> <span class='id identifier rubyid_database'>database</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="client-instance_method">
  <h3 class='signature ro first'>
    #<strong>client</strong>  &#x21d2; <a href="Client.html" title="Mongo::Client (class)">Client</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Client.html" title="Mongo::Client (class)">Client</a>)</span>
&mdash;    <div class='inline'>
<p>client The database client.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L62-L62'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='62' data-end='62'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 62</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_client'>client</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="name-instance_method">
  <h3 class='signature ro'>
    #<strong>name</strong>  &#x21d2; <code>String</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>name The name of the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L65-L65'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='65' data-end='65'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 65</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="options-instance_method">
  <h3 class='signature ro'>
    #<strong>options</strong>  &#x21d2; <code>Hash</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>options The options.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L68-L68'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='68' data-end='68'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 68</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_options'>options</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="==-instance_method">
  <h3 class='signature  first'>
    #<strong>==</strong>(other)  &#x21d2; <code>true</code>, <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Check equality of the database object against another. Will simply check if the names are the same.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Check database equality.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_database'>database</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>other</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The object to check against.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>, <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the objects are equal.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L95-L98'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='95' data-end='98'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 95</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>==</span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Database</span>)
  <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="[]-instance_method">
  <h3 class='signature '>
    #<strong>[]</strong>(collection_name, options = {})  &#x21d2; <a href="Collection.html" title="Mongo::Collection (class)">Mongo::Collection</a> 
    <span class='aliases'>Also known as: <span class='names'>#collection</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a collection in this database by the provided name.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get a collection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_database'>database</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_users'><a href="#users-instance_method" title="Mongo::Database#users (method)">users</a></span>]</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>collection_name</span>
    <span class='type'>(<code>String</code>, <a href="../Symbol.html" title="Symbol (class)">Symbol</a>)</span>
&mdash;    <div class='inline'>
<p>The name of the collection.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options to the collection.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Collection.html" title="Mongo::Collection (class)">Mongo::Collection</a>)</span>
&mdash;    <div class='inline'>
<p>The collection object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L111-L116'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='111' data-end='116'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 111</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>[]</span>(<span class='id identifier rubyid_collection_name'>collection_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_server_api'>server_api</span>]
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The :server_api option cannot be specified for collection objects. It can only be specified on Client level</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='const'><a href="Collection.html" title="Mongo::Collection (class)">Collection</a></span>.<span class='id identifier rubyid_new'><a href="Collection.html#new-class_method" title="Mongo::Collection.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_collection_name'>collection_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="aggregate-instance_method">
  <h3 class='signature '>
    #<strong>aggregate</strong>(pipeline, options = {})  &#x21d2; <a href="Collection/View/Aggregation.html" title="Mongo::Collection::View::Aggregation (class)">Collection::View::Aggregation</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Perform an aggregation on the database.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Perform an aggregation.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_collection'><a href="#collection-instance_method" title="Mongo::Database#collection (method)">collection</a></span>.<span class='id identifier rubyid_aggregate'>aggregate</span>([ { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$listLocalSessions</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> {} } ])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>pipeline</span>
    <span class='type'>(<code>Array</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>The aggregation pipeline.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The aggregation options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:allow_disk_use</span>
          <span class='type'>(<code>true</code>, <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Set to true if disk usage is allowed during the aggregation.</p>
</div>        </li>
        <li>
          <span class='name'>:batch_size</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of documents to return per batch.</p>
</div>        </li>
        <li>
          <span class='name'>:bypass_document_validation</span>
          <span class='type'>(<code>true</code>, <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether or not to skip document level validation.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:max_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time to allow the query to run, in milliseconds. This option is deprecated, use <code>:timeout_ms</code> instead.</p>
</div>        </li>
        <li>
          <span class='name'>:timeout_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The operation timeout in milliseconds. Must be a non-negative integer. An explicit value of 0 means infinite. The default value is unset which means the value is inherited from the database or the client.</p>
</div>        </li>
        <li>
          <span class='name'>:hint</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The index to use for the aggregation.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Collection/View/Aggregation.html" title="Mongo::Collection::View::Aggregation (class)">Collection::View::Aggregation</a>)</span>
&mdash;    <div class='inline'>
<p>The aggregation object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.10.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L457-L459'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='457' data-end='459'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 457</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_aggregate'>aggregate</span>(<span class='id identifier rubyid_pipeline'>pipeline</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Database/View.html" title="Mongo::Database::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Database/View.html#new-class_method" title="Mongo::Database::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>).<span class='id identifier rubyid_aggregate'><a href="Database/View.html#aggregate-instance_method" title="Mongo::Database::View#aggregate (method)">aggregate</a></span>(<span class='id identifier rubyid_pipeline'>pipeline</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cluster-instance_method">
  <h3 class='signature '>
    #<strong>cluster</strong>  &#x21d2; <a href="Server.html" title="Mongo::Server (class)">Mongo::Server</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Server.html" title="Mongo::Server (class)">Mongo::Server</a>)</span>
&mdash;    <div class='inline'>
<p>Get the primary server from the cluster.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L81-L82'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='81' data-end='82'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 81</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_def_delegators'>def_delegators</span> <span class='symbeg'>:</span><span class='id identifier rubyid_cluster'>cluster</span><span class='comma'>,</span>
               <span class='symbeg'>:</span><span class='id identifier rubyid_next_primary'>next_primary</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collection-instance_method">
  <h3 class='signature '>
    #<strong>collection</strong>(collection_name, options = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#[]-instance_method" title="Mongo::Database#[] (method)">#[]</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L117-L117'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='117' data-end='117'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 117</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_collection'>collection</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>[]</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collection_names-instance_method">
  <h3 class='signature '>
    #<strong>collection_names</strong>(options = {})  &#x21d2; <code>Array</code>&lt;<code>String</code>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The set of returned collection names depends on the version of MongoDB server that fulfills the request.</p>
</div>
  </div>


<p>Get all the names of the non-system collections in the database.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>See</span> <span class='label'>https:</span><span class='tstring'><span class='regexp_beg'>/</span><span class='regexp_end'>/mongodb</span></span>.<span class='id identifier rubyid_com'>com</span><span class='op'>/</span><span class='id identifier rubyid_docs'>docs</span><span class='op'>/</span><span class='id identifier rubyid_manual'>manual</span><span class='op'>/</span><span class='id identifier rubyid_reference'>reference</span><span class='op'>/</span><span class='id identifier rubyid_command'><a href="#command-instance_method" title="Mongo::Database#command (method)">command</a></span><span class='op'>/</span><span class='id identifier rubyid_listCollections'>listCollections</span><span class='op'>/</span>
<span class='kw'>for</span> <span class='id identifier rubyid_more'>more</span> <span class='id identifier rubyid_information'>information</span> <span class='kw'>and</span> <span class='id identifier rubyid_usage'>usage</span>.</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:filter</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>A filter on the collections returned.</p>
</div>        </li>
        <li>
          <span class='name'>:authorized_collections</span>
          <span class='type'>(<code>true</code>, <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>A flag, when set to true and used with nameOnly: true, that allows a user without the required privilege to run the command when access control is enforced</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:timeout_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The operation timeout in milliseconds. Must be a non-negative integer. An explicit value of 0 means infinite. The default value is unset which means the value is inherited from the database or the client.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Array</code>&lt;<code>String</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>Names of the collections.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L143-L145'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='143' data-end='145'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 143</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_collection_names'>collection_names</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Database/View.html" title="Mongo::Database::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Database/View.html#new-class_method" title="Mongo::Database::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>).<span class='id identifier rubyid_collection_names'><a href="Database/View.html#collection_names-instance_method" title="Mongo::Database::View#collection_names (method)">collection_names</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collections-instance_method">
  <h3 class='signature '>
    #<strong>collections</strong>(options = {})  &#x21d2; <code>Array</code>&lt;<a href="Collection.html" title="Mongo::Collection (class)">Mongo::Collection</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The set of returned collections depends on the version of MongoDB server that fulfills the request.</p>
</div>
  </div>


<p>Get all the non-system collections that belong to this database.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>See</span> <span class='label'>https:</span><span class='tstring'><span class='regexp_beg'>/</span><span class='regexp_end'>/mongodb</span></span>.<span class='id identifier rubyid_com'>com</span><span class='op'>/</span><span class='id identifier rubyid_docs'>docs</span><span class='op'>/</span><span class='id identifier rubyid_manual'>manual</span><span class='op'>/</span><span class='id identifier rubyid_reference'>reference</span><span class='op'>/</span><span class='id identifier rubyid_command'><a href="#command-instance_method" title="Mongo::Database#command (method)">command</a></span><span class='op'>/</span><span class='id identifier rubyid_listCollections'>listCollections</span><span class='op'>/</span>
<span class='kw'>for</span> <span class='id identifier rubyid_more'>more</span> <span class='id identifier rubyid_information'>information</span> <span class='kw'>and</span> <span class='id identifier rubyid_usage'>usage</span>.</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:filter</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>A filter on the collections returned.</p>
</div>        </li>
        <li>
          <span class='name'>:authorized_collections</span>
          <span class='type'>(<code>true</code>, <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>A flag, when set to true and used with name_only: true, that allows a user without the required privilege to run the command when access control is enforced.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:timeout_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The operation timeout in milliseconds. Must be a non-negative integer. An explicit value of 0 means infinite. The default value is unset which means the value is inherited from the database or the client.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Array</code>&lt;<a href="Collection.html" title="Mongo::Collection (class)">Mongo::Collection</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>The collections.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L204-L206'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='204' data-end='206'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 204</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_collections'>collections</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_collection_names'><a href="#collection_names-instance_method" title="Mongo::Database#collection_names (method)">collection_names</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>).<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span><span class='op'>|</span> <span class='id identifier rubyid_collection'><a href="#collection-instance_method" title="Mongo::Database#collection (method)">collection</a></span>(<span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span>) }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="command-instance_method">
  <h3 class='signature '>
    #<strong>command</strong>(operation, opts = {})  &#x21d2; <a href="Operation/Result.html" title="Mongo::Operation::Result (class)">Mongo::Operation::Result</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Execute a command on the database.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Execute a command.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_database'>database</span>.<span class='id identifier rubyid_command'>command</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_hello'>hello</span> <span class='op'>=&gt;</span> <span class='int'>1</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>operation</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The command to execute.</p>
</div>
  </li>
  <li>
    <span class='name'>opts</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The command options.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>a customizable set of options</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>opts</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference for this command.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for this command.</p>
</div>        </li>
        <li>
          <span class='name'>:execution_options</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p><a href="Options.html" title="Mongo::Options (module)"><code>Options</code></a> to pass to the code that executes this command. This is an internal option and is subject to change.</p>
<ul><li>
<p><code>:deserialize_as_bson</code> [ Boolean ] Whether to deserialize the response to this command using BSON types intead of native Ruby types wherever possible.</p>
</li></ul>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Operation/Result.html" title="Mongo::Operation::Result (class)">Mongo::Operation::Result</a>)</span>
&mdash;    <div class='inline'>
<p>The result of the command execution.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L230-L260'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='230' data-end='260'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 230</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_command'>command</span>(<span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_execution_opts'>execution_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_execution_options'>execution_options</span>) <span class='op'>||</span> {}

  <span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span>].<span class='id identifier rubyid_in_transaction?'>in_transaction?</span>
    <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span>].<span class='id identifier rubyid_txn_read_preference'>txn_read_preference</span>
  <span class='kw'>else</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span> <span class='op'>||=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_read'>read</span>] <span class='op'>||</span> <span class='const'><a href="ServerSelector.html" title="Mongo::ServerSelector (module)">ServerSelector</a></span><span class='op'>::</span><span class='const'><a href="ServerSelector.html#PRIMARY-constant" title="Mongo::ServerSelector::PRIMARY (constant)">PRIMARY</a></span>
  <span class='const'><a href="Lint.html" title="Mongo::Lint (module)">Lint</a></span>.<span class='id identifier rubyid_validate_underscore_read_preference'><a href="Lint.html#validate_underscore_read_preference-class_method" title="Mongo::Lint.validate_underscore_read_preference (method)">validate_underscore_read_preference</a></span>(<span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span>)
  <span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> <span class='const'><a href="ServerSelector.html" title="Mongo::ServerSelector (module)">ServerSelector</a></span>.<span class='id identifier rubyid_get'><a href="ServerSelector.html#get-instance_method" title="Mongo::ServerSelector#get (method)">get</a></span>(<span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span>)

  <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>.<span class='id identifier rubyid_with_session'>with_session</span>(<span class='id identifier rubyid_opts'>opts</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_session'>session</span><span class='op'>|</span>
    <span class='id identifier rubyid_server'>server</span> <span class='op'>=</span> <span class='id identifier rubyid_selector'>selector</span>.<span class='id identifier rubyid_select_server'>select_server</span>(<span class='id identifier rubyid_cluster'><a href="#cluster-instance_method" title="Mongo::Database#cluster (method)">cluster</a></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span>)
    <span class='id identifier rubyid_op'>op</span> <span class='op'>=</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Command.html" title="Mongo::Operation::Command (class)">Command</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Specifiable.html#initialize-instance_method" title="Mongo::Operation::Specifiable#initialize (method)">new</a></span>(
      <span class='symbeg'>:</span><span class='id identifier rubyid_selector'>selector</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_db_name'>db_name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span><span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_read'>read</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_session'>session</span>
    )

    <span class='id identifier rubyid_op'>op</span>.<span class='id identifier rubyid_execute'>execute</span>(<span class='id identifier rubyid_server'>server</span><span class='comma'>,</span>
      <span class='label'>context:</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Context.html" title="Mongo::Operation::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Context.html#new-class_method" title="Mongo::Operation::Context.new (method)">new</a></span>(
        <span class='label'>client:</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span><span class='comma'>,</span>
        <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span>
        <span class='label'>operation_timeouts:</span> <span class='id identifier rubyid_operation_timeouts'><a href="#operation_timeouts-instance_method" title="Mongo::Database#operation_timeouts (method)">operation_timeouts</a></span>(<span class='id identifier rubyid_opts'>opts</span>)
      )<span class='comma'>,</span>
      <span class='label'>options:</span> <span class='id identifier rubyid_execution_opts'>execution_opts</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="drop-instance_method">
  <h3 class='signature '>
    #<strong>drop</strong>(options = {})  &#x21d2; <code>Result</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Drop the database and all its associated information.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Drop the database.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_database'>database</span>.<span class='id identifier rubyid_drop'>drop</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The options for the operation.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for the operation.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options.</p>
</div>        </li>
        <li>
          <span class='name'>:timeout_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The operation timeout in milliseconds. Must be a non-negative integer. An explicit value of 0 means infinite. The default value is unset which means the value is inherited from the database or the client.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Result</code>)</span>
&mdash;    <div class='inline'>
<p>The result of the command.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L329-L351'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='329' data-end='351'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 329</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_drop'>drop</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_operation'>operation</span> <span class='op'>=</span> { <span class='symbeg'>:</span><span class='id identifier rubyid_dropDatabase'>dropDatabase</span> <span class='op'>=&gt;</span> <span class='int'>1</span> }
  <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>.<span class='id identifier rubyid_with_session'>with_session</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_session'>session</span><span class='op'>|</span>
    <span class='id identifier rubyid_write_concern'>write_concern</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'>write_concern</span>]
      <span class='const'><a href="WriteConcern.html" title="Mongo::WriteConcern (module)">WriteConcern</a></span>.<span class='id identifier rubyid_get'><a href="WriteConcern.html#get-instance_method" title="Mongo::WriteConcern#get (method)">get</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_write_concern'>write_concern</span>])
    <span class='kw'>else</span>
      <span class='kw'>self</span>.<span class='id identifier rubyid_write_concern'>write_concern</span>
    <span class='kw'>end</span>
    <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/DropDatabase.html" title="Mongo::Operation::DropDatabase (class)">DropDatabase</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Specifiable.html#initialize-instance_method" title="Mongo::Operation::Specifiable#initialize (method)">new</a></span>({
      <span class='label'>selector:</span> <span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span>
      <span class='label'>db_name:</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span><span class='comma'>,</span>
      <span class='label'>write_concern:</span> <span class='id identifier rubyid_write_concern'>write_concern</span><span class='comma'>,</span>
      <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span>
    }).<span class='id identifier rubyid_execute'>execute</span>(
      <span class='id identifier rubyid_next_primary'>next_primary</span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span>)<span class='comma'>,</span>
      <span class='label'>context:</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Context.html" title="Mongo::Operation::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Context.html#new-class_method" title="Mongo::Operation::Context.new (method)">new</a></span>(
        <span class='label'>client:</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span><span class='comma'>,</span>
        <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span>
        <span class='label'>operation_timeouts:</span> <span class='id identifier rubyid_operation_timeouts'><a href="#operation_timeouts-instance_method" title="Mongo::Database#operation_timeouts (method)">operation_timeouts</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
      )
    )
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fs-instance_method">
  <h3 class='signature '>
    #<strong>fs</strong>(options = {})  &#x21d2; <a href="Grid/FSBucket.html" title="Mongo::Grid::FSBucket (class)">Grid::FSBucket</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the <a href="Grid.html" title="Mongo::Grid (module)"><code>Grid</code></a> “filesystem” for this database.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The GridFS options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:bucket_name</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The prefix for the files and chunks collections.</p>
</div>        </li>
        <li>
          <span class='name'>:chunk_size</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>Override the default chunk size.</p>
</div>        </li>
        <li>
          <span class='name'>:fs_name</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The prefix for the files and chunks collections.</p>
</div>        </li>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:write</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Deprecated. Equivalent to <code>:write_concern</code> option.</p>
</div>        </li>
        <li>
          <span class='name'>:write_concern</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The write concern options. Can be <code>:w</code> =&gt; Integer|String, <code>:fsync</code> =&gt; Boolean, <code>:j</code> =&gt; Boolean.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Grid/FSBucket.html" title="Mongo::Grid::FSBucket (class)">Grid::FSBucket</a>)</span>
&mdash;    <div class='inline'>
<p>The GridFS for the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L411-L413'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='411' data-end='413'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 411</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_fs'>fs</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Grid.html" title="Mongo::Grid (module)">Grid</a></span><span class='op'>::</span><span class='const'><a href="Grid/FSBucket.html" title="Mongo::Grid::FSBucket (class)">FSBucket</a></span>.<span class='id identifier rubyid_new'><a href="Grid/FSBucket.html#new-class_method" title="Mongo::Grid::FSBucket.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature '>
    #<strong>inspect</strong>  &#x21d2; <code>String</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a pretty printed string inspection for the database.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Inspect the database.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_database'>database</span>.<span class='id identifier rubyid_inspect'>inspect</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The database inspection.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L387-L389'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='387' data-end='389'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 387</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Mongo::Database:0x</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> name=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="list_collections-instance_method">
  <h3 class='signature '>
    #<strong>list_collections</strong>(options = {})  &#x21d2; <code>Array</code>&lt;<code>Hash</code>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The set of collections returned, and the schema of the information hash per collection, depends on the MongoDB server version that fulfills the request.</p>
</div>
  </div>


<p>Get info on all the non-system collections in the database.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>See</span> <span class='label'>https:</span><span class='tstring'><span class='regexp_beg'>/</span><span class='regexp_end'>/mongodb</span></span>.<span class='id identifier rubyid_com'>com</span><span class='op'>/</span><span class='id identifier rubyid_docs'>docs</span><span class='op'>/</span><span class='id identifier rubyid_manual'>manual</span><span class='op'>/</span><span class='id identifier rubyid_reference'>reference</span><span class='op'>/</span><span class='id identifier rubyid_command'><a href="#command-instance_method" title="Mongo::Database#command (method)">command</a></span><span class='op'>/</span><span class='id identifier rubyid_listCollections'>listCollections</span><span class='op'>/</span>
<span class='kw'>for</span> <span class='id identifier rubyid_more'>more</span> <span class='id identifier rubyid_information'>information</span> <span class='kw'>and</span> <span class='id identifier rubyid_usage'>usage</span>.</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:filter</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>A filter on the collections returned.</p>
</div>        </li>
        <li>
          <span class='name'>:name_only</span>
          <span class='type'>(<code>true</code>, <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Indicates whether command should return just collection/view names and type or return both the name and other information</p>
</div>        </li>
        <li>
          <span class='name'>:authorized_collections</span>
          <span class='type'>(<code>true</code>, <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>A flag, when set to true and used with nameOnly: true, that allows a user without the required privilege to run the command when access control is enforced.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:timeout_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The operation timeout in milliseconds. Must be a non-negative integer. An explicit value of 0 means infinite. The default value is unset which means the value is inherited from the database or the client.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Array</code>&lt;<code>Hash</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>Array of information hashes, one for each collection in the database.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.5</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L176-L178'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='176' data-end='178'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 176</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_list_collections'>list_collections</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='const'><a href="Database/View.html" title="Mongo::Database::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Database/View.html#new-class_method" title="Mongo::Database::View.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>).<span class='id identifier rubyid_list_collections'><a href="Database/View.html#list_collections-instance_method" title="Mongo::Database::View#list_collections (method)">list_collections</a></span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="operation_timeouts-instance_method">
  <h3 class='signature nodoc'>
    #<strong>operation_timeouts</strong>(opts)  &#x21d2; <code>Hash</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>timeout_ms value set on the operation level (if any), and/or timeout_ms that is set on collection/database/client level (if any).</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L567-L576'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='567' data-end='576'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 567</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_operation_timeouts'>operation_timeouts</span>(<span class='id identifier rubyid_opts'>opts</span>)
  <span class='comment'># TODO: We should re-evaluate if we need two timeouts separately.
</span>  {}.<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_timeout_ms'><a href="#timeout_ms-instance_method" title="Mongo::Database#timeout_ms (method)">timeout_ms</a></span>].<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_result'>result</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_inherited_timeout_ms'>inherited_timeout_ms</span>] <span class='op'>=</span> <span class='id identifier rubyid_timeout_ms'><a href="#timeout_ms-instance_method" title="Mongo::Database#timeout_ms (method)">timeout_ms</a></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_result'>result</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_operation_timeout_ms'>operation_timeout_ms</span>] <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_timeout_ms'><a href="#timeout_ms-instance_method" title="Mongo::Database#timeout_ms (method)">timeout_ms</a></span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="read_command-instance_method">
  <h3 class='signature nodoc'>
    #<strong>read_command</strong>(operation, opts = {})  &#x21d2; <code>Hash</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Execute a read command on the database, retrying the read if necessary.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>operation</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The command to execute.</p>
</div>
  </li>
  <li>
    <span class='name'>opts</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The command options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>opts</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:read</span>
          <span class='type'>(<code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The read preference for this command.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use for this command.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:timeout_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The operation timeout in milliseconds. Must be a non-negative integer. An explicit value of 0 means infinite. The default value is unset which means the value is inherited from the database or the client.</p>
</div>        </li>
        <li>
          <span class='name'>:op_name</span>
          <span class='type'>(<code>String</code> | <code>nil</code>)</span>
            &mdash; <div class='inline'>
<p>The name of the operation for tracing purposes.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The result of the command execution.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L280-L310'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='280' data-end='310'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 280</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_read_command'>read_command</span>(<span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span>].<span class='id identifier rubyid_in_transaction?'>in_transaction?</span>
    <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span>].<span class='id identifier rubyid_txn_read_preference'>txn_read_preference</span>
  <span class='kw'>else</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span> <span class='op'>||=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_read'>read</span>] <span class='op'>||</span> <span class='const'><a href="ServerSelector.html" title="Mongo::ServerSelector (module)">ServerSelector</a></span><span class='op'>::</span><span class='const'><a href="ServerSelector.html#PRIMARY-constant" title="Mongo::ServerSelector::PRIMARY (constant)">PRIMARY</a></span>
  <span class='const'><a href="Lint.html" title="Mongo::Lint (module)">Lint</a></span>.<span class='id identifier rubyid_validate_underscore_read_preference'><a href="Lint.html#validate_underscore_read_preference-class_method" title="Mongo::Lint.validate_underscore_read_preference (method)">validate_underscore_read_preference</a></span>(<span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span>)
  <span class='id identifier rubyid_preference'>preference</span> <span class='op'>=</span> <span class='const'><a href="ServerSelector.html" title="Mongo::ServerSelector (module)">ServerSelector</a></span>.<span class='id identifier rubyid_get'><a href="ServerSelector.html#get-instance_method" title="Mongo::ServerSelector#get (method)">get</a></span>(<span class='id identifier rubyid_txn_read_pref'>txn_read_pref</span>)

  <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>.<span class='id identifier rubyid_with_session'>with_session</span>(<span class='id identifier rubyid_opts'>opts</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_session'>session</span><span class='op'>|</span>
    <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Context.html" title="Mongo::Operation::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Context.html#new-class_method" title="Mongo::Operation::Context.new (method)">new</a></span>(
      <span class='label'>client:</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span><span class='comma'>,</span>
      <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span>
      <span class='label'>operation_timeouts:</span> <span class='id identifier rubyid_operation_timeouts'><a href="#operation_timeouts-instance_method" title="Mongo::Database#operation_timeouts (method)">operation_timeouts</a></span>(<span class='id identifier rubyid_opts'>opts</span>)
    )
    <span class='id identifier rubyid_operation'>operation</span> <span class='op'>=</span> <span class='const'><a href="Operation.html" title="Mongo::Operation (module)">Operation</a></span><span class='op'>::</span><span class='const'><a href="Operation/Command.html" title="Mongo::Operation::Command (class)">Command</a></span>.<span class='id identifier rubyid_new'><a href="Operation/Specifiable.html#initialize-instance_method" title="Mongo::Operation::Specifiable#initialize (method)">new</a></span>(
      <span class='label'>selector:</span> <span class='id identifier rubyid_operation'>operation</span>.<span class='id identifier rubyid_dup'>dup</span><span class='comma'>,</span>
      <span class='label'>db_name:</span> <span class='id identifier rubyid_name'><a href="#name-instance_method" title="Mongo::Database#name (method)">name</a></span><span class='comma'>,</span>
      <span class='label'>read:</span> <span class='id identifier rubyid_preference'>preference</span><span class='comma'>,</span>
      <span class='label'>session:</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span>
      <span class='label'>comment:</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_comment'>comment</span>]<span class='comma'>,</span>
    )
    <span class='id identifier rubyid_op_name'>op_name</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_op_name'>op_name</span>] <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_tracer'>tracer</span>.<span class='id identifier rubyid_trace_operation'>trace_operation</span>(<span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='label'>op_name:</span> <span class='id identifier rubyid_op_name'>op_name</span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_read_with_retry'>read_with_retry</span>(<span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='id identifier rubyid_preference'>preference</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='op'>|</span>
        <span class='id identifier rubyid_operation'>operation</span>.<span class='id identifier rubyid_execute'>execute</span>(<span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='label'>context:</span> <span class='id identifier rubyid_context'>context</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="timeout_ms-instance_method">
  <h3 class='signature nodoc'>
    #<strong>timeout_ms</strong>  &#x21d2; <code>Integer</code> | <code>nil</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p><a href="Operation.html" title="Mongo::Operation (module)"><code>Operation</code></a> timeout that is for this database or for the corresponding client.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L559-L561'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='559' data-end='561'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 559</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_timeout_ms'>timeout_ms</span>
  <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_timeout_ms'>timeout_ms</span>] <span class='op'>||</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Database#client (method)">client</a></span>.<span class='id identifier rubyid_timeout_ms'>timeout_ms</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="users-instance_method">
  <h3 class='signature '>
    #<strong>users</strong>  &#x21d2; <code>View::User</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the user view for this database.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the user view.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_database'>database</span>.<span class='id identifier rubyid_users'>users</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>View::User</code>)</span>
&mdash;    <div class='inline'>
<p>The user view.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L423-L425'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='423' data-end='425'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 423</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_users'>users</span>
  <span class='const'><a href="Auth.html" title="Mongo::Auth (module)">Auth</a></span><span class='op'>::</span><span class='const'><a href="Auth/User.html" title="Mongo::Auth::User (class)">User</a></span><span class='op'>::</span><span class='const'><a href="Auth/User/View.html" title="Mongo::Auth::User::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Auth/User/View.html#new-class_method" title="Mongo::Auth::User::View.new (method)">new</a></span>(<span class='kw'>self</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="watch-instance_method">
  <h3 class='signature '>
    #<strong>watch</strong>(pipeline = [], options = {})  &#x21d2; <code>ChangeStream</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>A change stream only allows ‘majority’ read concern.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This helper method is preferable to running a raw aggregation with a $changeStream stage, for the purpose of supporting resumability.</p>
</div>
  </div>


<p>As of version 3.6 of the MongoDB server, a “$changeStream“ pipeline stage is supported in the aggregation framework. As of version 4.0, this stage allows users to request that notifications are sent for all changes that occur in the client’s database.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get change notifications for a given database..</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_database'>database</span>.<span class='id identifier rubyid_watch'>watch</span>([{ <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$match</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> { <span class='label'>operationType:</span> { <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$in</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> [<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>insert</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>replace</span><span class='tstring_end'>&#39;</span></span>] } } }])</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>pipeline</span>
    <span class='type'>(<code>Array</code>&lt;<code>Hash</code>&gt;)</span>
    <em class='default'>(defaults to: <tt>[]</tt>)</em>
&mdash;    <div class='inline'>
<p>Optional additional filter operators.</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p>The change stream options.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:full_document</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>Allowed values: nil, ‘default’, ‘updateLookup’, ‘whenAvailable’, ‘required’.</p>

<p>The default is to not send a value (i.e. nil), which is equivalent to ‘default’. By default, the change notification for partial updates will include a delta describing the changes to the document.</p>

<p>When set to ‘updateLookup’, the change notification for partial updates will include both a delta describing the changes to the document as well as a copy of the entire document that was changed from some time after the change occurred.</p>

<p>When set to ‘whenAvailable’, configures the change stream to return the post-image of the modified document for replace and update change events if the post-image for this event is available.</p>

<p>When set to ‘required’, the same behavior as ‘whenAvailable’ except that an error is raised if the post-image is not available.</p>
</div>        </li>
        <li>
          <span class='name'>:full_document_before_change</span>
          <span class='type'>(<code>String</code>)</span>
            &mdash; <div class='inline'>
<p>Allowed values: nil, ‘whenAvailable’, ‘required’, ‘off’.</p>

<p>The default is to not send a value (i.e. nil), which is equivalent to ‘off’.</p>

<p>When set to ‘whenAvailable’, configures the change stream to return the pre-image of the modified document for replace, update, and delete change events if it is available.</p>

<p>When set to ‘required’, the same behavior as ‘whenAvailable’ except that an error is raised if the pre-image is not available.</p>
</div>        </li>
        <li>
          <span class='name'>:resume_after</span>
          <span class='type'>(<code>BSON::Document</code>, <code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>Specifies the logical starting point for the new change stream.</p>
</div>        </li>
        <li>
          <span class='name'>:max_await_time_ms</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The maximum amount of time for the server to wait on new documents to satisfy a change stream query.</p>
</div>        </li>
        <li>
          <span class='name'>:batch_size</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p>The number of documents to return per batch.</p>
</div>        </li>
        <li>
          <span class='name'>:collation</span>
          <span class='type'>(<code>BSON::Document</code>, <code>Hash</code>)</span>
            &mdash; <div class='inline'>
<p>The collation to use.</p>
</div>        </li>
        <li>
          <span class='name'>:session</span>
          <span class='type'>(<a href="Session.html" title="Mongo::Session (class)">Session</a>)</span>
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>        </li>
        <li>
          <span class='name'>:start_at_operation_time</span>
          <span class='type'>(<code>BSON::Timestamp</code>)</span>
            &mdash; <div class='inline'>
<p>Only return changes that occurred after the specified timestamp. Any command run against the server will return a cluster time that can be used here. Only recognized by server versions 4.0+.</p>
</div>        </li>
        <li>
          <span class='name'>:comment</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>A user-provided comment to attach to this command.</p>
</div>        </li>
        <li>
          <span class='name'>:show_expanded_events</span>
          <span class='type'>(<code>Boolean</code>)</span>
            &mdash; <div class='inline'>
<p>Enables the server to send the ‘expanded’ list of change stream events. The list of additional events included with this flag set are: createIndexes, dropIndexes, modify, create, shardCollection, reshardCollection, refineCollectionShardKey.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>ChangeStream</code>)</span>
&mdash;    <div class='inline'>
<p>The change stream object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.6.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/database.rb#L526-L535'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='526' data-end='535'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/database.rb', line 526</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_watch'>watch</span>(<span class='id identifier rubyid_pipeline'>pipeline</span> <span class='op'>=</span> []<span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_view_options'>view_options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_view_options'>view_options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cursor_type'>cursor_type</span>] <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tailable_await'>tailable_await</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_max_await_time_ms'>max_await_time_ms</span>]

  <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'><a href="Collection.html" title="Mongo::Collection (class)">Collection</a></span><span class='op'>::</span><span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span><span class='op'>::</span><span class='const'><a href="Collection/View/ChangeStream.html" title="Mongo::Collection::View::ChangeStream (class)">ChangeStream</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View/ChangeStream.html#new-class_method" title="Mongo::Collection::View::ChangeStream.new (method)">new</a></span>(
    <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'><a href="Collection.html" title="Mongo::Collection (class)">Collection</a></span><span class='op'>::</span><span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span>.<span class='id identifier rubyid_new'><a href="Collection/View.html#new-class_method" title="Mongo::Collection::View.new (method)">new</a></span>(<span class='id identifier rubyid_collection'><a href="#collection-instance_method" title="Mongo::Database#collection (method)">collection</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><a href="#COMMAND-constant" title="Mongo::Database::COMMAND (constant)">COMMAND</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>.aggregate</span><span class='tstring_end'>&quot;</span></span>)<span class='comma'>,</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_view_options'>view_options</span>)<span class='comma'>,</span>
    <span class='id identifier rubyid_pipeline'>pipeline</span><span class='comma'>,</span>
    <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'><a href="Collection.html" title="Mongo::Collection (class)">Collection</a></span><span class='op'>::</span><span class='const'><a href="Collection/View.html" title="Mongo::Collection::View (class)">View</a></span><span class='op'>::</span><span class='const'><a href="Collection/View/ChangeStream.html" title="Mongo::Collection::View::ChangeStream (class)">ChangeStream</a></span><span class='op'>::</span><span class='const'><a href="Collection/View/ChangeStream.html#DATABASE-constant" title="Mongo::Collection::View::ChangeStream::DATABASE (constant)">DATABASE</a></span><span class='comma'>,</span>
    <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Database#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>