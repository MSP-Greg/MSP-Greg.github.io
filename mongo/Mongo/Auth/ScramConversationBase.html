<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongo::Auth::ScramConversationBase &mdash; Mongo master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongo::Auth::ScramConversationBase",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Mongo master</a> &raquo; 
      <a href='../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../Mongo.html" title="Mongo (module)">Mongo</a> &raquo; 
        <a href="../Auth.html" title="Mongo::Auth (module)">Auth</a> &raquo; 
      <span class='title'><a class='nodoc' id='t2_doc_top' href='#'>ScramConversationBase&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongo::Auth::ScramConversationBase  <span class='private note title'>Private</span>
</h1>
  <div class='note nodoc inline-block'>
    <strong>Do not use.  This class is for internal use only.</strong>
  </div>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Subclasses:</div>
        <div class='box_22'>
          <span class='nodoc_h'>Mongo::Auth::Scram256::Conversation</span>, <span class='nodoc_h'>Mongo::Auth::Scram::Conversation</span>
        </div>
      </td>
    </tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="SaslConversationBase.html" title="Mongo::Auth::SaslConversationBase (class)"><code>SaslConversationBase</code></a>,
          <a href="ConversationBase.html" title="Mongo::Auth::ConversationBase (class)"><code>ConversationBase</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="SaslConversationBase.html" title="Mongo::Auth::SaslConversationBase (class)"><code>SaslConversationBase</code></a>,
          <a href="ConversationBase.html" title="Mongo::Auth::ConversationBase (class)"><code>ConversationBase</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="SaslConversationBase.html" title="Mongo::Auth::SaslConversationBase (class)">Mongo::Auth::SaslConversationBase</a></span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'><a href="ConversationBase.html" title="Mongo::Auth::ConversationBase (class)">Mongo::Auth::ConversationBase</a></li>
          <li class='next'><a href="SaslConversationBase.html" title="Mongo::Auth::SaslConversationBase (class)">Mongo::Auth::SaslConversationBase</a></li>
          <li class='next'>Mongo::Auth::ScramConversationBase</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L25'>lib/mongo/auth/scram_conversation_base.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Defines common behavior around authentication conversations between the client and the server.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full nodoc'>
  <li>
    <span id='MIN_ITER_COUNT-constant' class='summary_signature nodoc'>MIN_ITER_COUNT =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The minimum iteration count for SCRAM-SHA-1 and SCRAM-SHA-256.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L28-L28'># File 'lib/mongo/auth/scram_conversation_base.rb', line 28</a>    <pre class='code ruby'><span class='int'>4096</span></pre>
  </li>
</ul>
  <h3 class='inherited'><a href="SaslConversationBase.html" title="Mongo::Auth::SaslConversationBase (class)"><code>SaslConversationBase</code></a> - Inherited</h3>
  <p  class='inherited'>
    <a class='nodoc' href="SaslConversationBase.html#CLIENT_CONTINUE_MESSAGE-constant" title="Mongo::Auth::SaslConversationBase::CLIENT_CONTINUE_MESSAGE (constant)">CLIENT_CONTINUE_MESSAGE</a>, 
    <a class='nodoc' href="SaslConversationBase.html#CLIENT_FIRST_MESSAGE-constant" title="Mongo::Auth::SaslConversationBase::CLIENT_FIRST_MESSAGE (constant)">CLIENT_FIRST_MESSAGE</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(user, connection, client_nonce: nil)  &#x21d2; ScramConversationBase </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Create the new conversation.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="ConversationBase.html" title="Mongo::Auth::ConversationBase (class)"><code>ConversationBase</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="ConversationBase.html#new-class_method" title="Mongo::Auth::ConversationBase.new (method)">.new</a></td>
      <td><div class='inline'><p>Create the new conversation.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#client_nonce-instance_method" title="#client_nonce (instance method)">#<strong>client_nonce</strong>  &#x21d2; String </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#id-instance_method" title="#id (instance method)">#<strong>id</strong>  &#x21d2; Integer </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the id of the conversation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#server_verified%3F-instance_method" title="#server_verified? (instance method)">#<strong>server_verified?</strong>  &#x21d2; true | fase </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the client verified the ServerSignature from the server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro priv nodoc'>
      <a href="#auth_message-instance_method" title="#auth_message (instance method)">#<strong>auth_message</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Auth.html" title="Mongo::Auth (module)"><code>::Mongo::Auth</code></a> message algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro priv nodoc'>
      <a href="#iterations-instance_method" title="#iterations (instance method)">#<strong>iterations</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the iterations from the server response.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro priv nodoc'>
      <a href="#payload_data-instance_method" title="#payload_data (instance method)">#<strong>payload_data</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the data from the returned payload.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro priv nodoc'>
      <a href="#salt-instance_method" title="#salt (instance method)">#<strong>salt</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Gets the salt from the server response.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro priv nodoc'>
      <a href="#server_nonce-instance_method" title="#server_nonce (instance method)">#<strong>server_nonce</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the server nonce from the payload.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="ConversationBase.html" title="Mongo::Auth::ConversationBase (class)"><code>ConversationBase</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro nodoc' href="ConversationBase.html#connection-instance_method" title="Mongo::Auth::ConversationBase#connection (method)">#connection</a>,
        <a class='i_m ro nodoc' href="ConversationBase.html#user-instance_method" title="Mongo::Auth::ConversationBase#user (method)">#user</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#continue-instance_method" title="#continue (instance method)">#<strong>continue</strong>(reply_document, connection)  &#x21d2; Protocol::Message </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Continue the SCRAM conversation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#finalize-instance_method" title="#finalize (instance method)">#<strong>finalize</strong>(connection)  &#x21d2; Protocol::Message </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Finalize the SCRAM conversation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#process_continue_response-instance_method" title="#process_continue_response (instance method)">#<strong>process_continue_response</strong>(reply_document)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Processes the second response from the server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#speculative_auth_document-instance_method" title="#speculative_auth_document (instance method)">#<strong>speculative_auth_document</strong>  &#x21d2; Hash | nil </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the hash to provide to the server in the handshake as value of the speculativeAuthenticate key.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#cache_key-instance_method" title="#cache_key (instance method)">#<strong>cache_key</strong>(*extra)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#check_server_signature-instance_method" title="#check_server_signature (instance method)">#<strong>check_server_signature</strong>(payload_data)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Looks for field ‘v’ in payload data, if it is present verifies the server signature.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_empty_message-instance_method" title="#client_empty_message (instance method)">#<strong>client_empty_message</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the empty client message.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_final-instance_method" title="#client_final (instance method)">#<strong>client_final</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> final implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_final_message-instance_method" title="#client_final_message (instance method)">#<strong>client_final_message</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the final client message.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_first_message_options-instance_method" title="#client_first_message_options (instance method)">#<strong>client_first_message_options</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_first_payload-instance_method" title="#client_first_payload (instance method)">#<strong>client_first_payload</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_key-instance_method" title="#client_key (instance method)">#<strong>client_key</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> key algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_proof-instance_method" title="#client_proof (instance method)">#<strong>client_proof</strong>(key, signature)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> proof algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#client_signature-instance_method" title="#client_signature (instance method)">#<strong>client_signature</strong>(key, message)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> signature algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#compare_digest-instance_method" title="#compare_digest (instance method)">#<strong>compare_digest</strong>(a, b)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#first_bare-instance_method" title="#first_bare (instance method)">#<strong>first_bare</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>First bare implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#h-instance_method" title="#h (instance method)">#<strong>h</strong>(string)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>H algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#hmac-instance_method" title="#hmac (instance method)">#<strong>hmac</strong>(data, key)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>HMAC algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#parse_payload-instance_method" title="#parse_payload (instance method)">#<strong>parse_payload</strong>(payload)  &#x21d2; Hash </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Parses a payload like a=value,b=value2 into a hash like <code>=&gt; ‘value’, ‘b’ =&gt; ‘value2’</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#server_key-instance_method" title="#server_key (instance method)">#<strong>server_key</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Server.html" title="Mongo::Server (class)"><code>::Mongo::Server</code></a> key algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#server_signature-instance_method" title="#server_signature (instance method)">#<strong>server_signature</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="../Server.html" title="Mongo::Server (class)"><code>::Mongo::Server</code></a> signature algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#stored_key-instance_method" title="#stored_key (instance method)">#<strong>stored_key</strong>(key)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Stored key algorithm implementation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#without_proof-instance_method" title="#without_proof (instance method)">#<strong>without_proof</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the without proof message.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#xor-instance_method" title="#xor (instance method)">#<strong>xor</strong>(first, second)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>XOR operation for two strings.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="SaslConversationBase.html" title="Mongo::Auth::SaslConversationBase (class)"><code>SaslConversationBase</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="SaslConversationBase.html#start-instance_method" title="Mongo::Auth::SaslConversationBase#start (method)">#start</a></td>
      <td><div class='inline'><p>Start the SASL conversation.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="SaslConversationBase.html#auth_mechanism_name-instance_method" title="Mongo::Auth::SaslConversationBase#auth_mechanism_name (method)">#auth_mechanism_name</a></td>
      <td><div class='inline'><p>Gets the auth mechanism name for the conversation class.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv nodoc' href="SaslConversationBase.html#client_first_document-instance_method" title="Mongo::Auth::SaslConversationBase#client_first_document (method)">#client_first_document</a>,
        <a class='i_m priv nodoc' href="SaslConversationBase.html#client_first_message_options-instance_method" title="Mongo::Auth::SaslConversationBase#client_first_message_options (method)">#client_first_message_options</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="SaslConversationBase.html#validate_server_nonce!-instance_method" title="Mongo::Auth::SaslConversationBase#validate_server_nonce! (method)">#validate_server_nonce!</a></td>
      <td><div class='inline'><p>Helper method to validate that server nonce starts with the client nonce.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited nodoc'><a href="ConversationBase.html" title="Mongo::Auth::ConversationBase (class)"><code>ConversationBase</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="ConversationBase.html#build_message-instance_method" title="Mongo::Auth::ConversationBase#build_message (method)">#build_message</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="ConversationBase.html#speculative_auth_document-instance_method" title="Mongo::Auth::ConversationBase#speculative_auth_document (method)">#speculative_auth_document</a></td>
      <td><div class='inline'><p>Returns the hash to provide to the server in the handshake as value of the speculativeAuthenticate key.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="ConversationBase.html#validate_external_auth_source-instance_method" title="Mongo::Auth::ConversationBase#validate_external_auth_source (method)">#validate_external_auth_source</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="auth_message-instance_method">
  <h3 class='signature ro priv  nodoc first'>
    #<strong>auth_message</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Auth.html" title="Mongo::Auth (module)"><code>::Mongo::Auth</code></a> message algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L164-L164'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='164' data-end='164'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 164</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_auth_message'>auth_message</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_nonce-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>client_nonce</strong>  &#x21d2; <code>String</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>client_nonce The client nonce.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L44-L44'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='44' data-end='44'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 44</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_client_nonce'>client_nonce</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="id-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>id</strong>  &#x21d2; <code>Integer</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the id of the conversation.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the id of the conversation.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_conversation'>conversation</span>.<span class='id identifier rubyid_id'>id</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'>
<p>The conversation id.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L52-L52'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='52' data-end='52'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 52</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="iterations-instance_method">
  <h3 class='signature ro priv  nodoc'>
    #<strong>iterations</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the iterations from the server response.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L288-L288'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='288' data-end='288'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 288</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_iterations'>iterations</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="payload_data-instance_method">
  <h3 class='signature ro priv  nodoc'>
    #<strong>payload_data</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the data from the returned payload.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L295-L295'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='295' data-end='295'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 295</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_payload_data'>payload_data</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="salt-instance_method">
  <h3 class='signature ro priv  nodoc'>
    #<strong>salt</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Gets the salt from the server response.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L309-L309'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='309' data-end='309'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 309</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_salt'>salt</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_nonce-instance_method">
  <h3 class='signature ro priv  nodoc'>
    #<strong>server_nonce</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the server nonce from the payload.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L302-L302'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='302' data-end='302'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 302</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server_nonce'>server_nonce</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_verified?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>server_verified?</strong>  &#x21d2; <code>true</code> | <code>fase</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the client verified the ServerSignature from the server.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>fase</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the server’s signature was verified.</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="https://jira.mongodb.org/browse/SECURITY-621" target="_parent" title="https://jira.mongodb.org/browse/SECURITY-621">https://jira.mongodb.org/browse/SECURITY-621</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L59-L61'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='59' data-end='61'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 59</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_server_verified?'>server_verified?</span>
  <span class='op'>!</span><span class='op'>!</span><span class='ivar'>@server_verified</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="cache_key-instance_method">
  <h3 class='signature priv  nodoc first'>
    #<strong>cache_key</strong>(*extra)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L312-L314'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='312' data-end='314'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 312</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cache_key'>cache_key</span>(<span class='op'>*</span><span class='id identifier rubyid_extra'>extra</span>)
  [<span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='id identifier rubyid_salt'><a href="#salt-instance_method" title="Mongo::Auth::ScramConversationBase#salt (method)">salt</a></span><span class='comma'>,</span> <span class='id identifier rubyid_iterations'><a href="#iterations-instance_method" title="Mongo::Auth::ScramConversationBase#iterations (method)">iterations</a></span><span class='comma'>,</span> <span class='ivar'>@mechanism</span>] <span class='op'>+</span> <span class='id identifier rubyid_extra'>extra</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="check_server_signature-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>check_server_signature</strong>(payload_data)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Looks for field ‘v’ in payload data, if it is present verifies the server signature. If verification succeeds, sets @server_verified to true. If verification fails, raises InvalidSignature.</p>

<p>This method can be called from different conversation steps depending on whether the short SCRAM conversation is used.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L205-L213'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='205' data-end='213'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 205</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_check_server_signature'>check_server_signature</span>(<span class='id identifier rubyid_payload_data'><a href="#payload_data-instance_method" title="Mongo::Auth::ScramConversationBase#payload_data (method)">payload_data</a></span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_verifier'>verifier</span> <span class='op'>=</span> <span class='id identifier rubyid_payload_data'><a href="#payload_data-instance_method" title="Mongo::Auth::ScramConversationBase#payload_data (method)">payload_data</a></span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span>]
    <span class='kw'>if</span> <span class='id identifier rubyid_compare_digest'><a href="#compare_digest-instance_method" title="Mongo::Auth::ScramConversationBase#compare_digest (method)">compare_digest</a></span>(<span class='id identifier rubyid_verifier'>verifier</span><span class='comma'>,</span> <span class='id identifier rubyid_server_signature'><a href="#server_signature-instance_method" title="Mongo::Auth::ScramConversationBase#server_signature (method)">server_signature</a></span>)
      <span class='ivar'>@server_verified</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="../Error/InvalidSignature.html" title="Mongo::Error::InvalidSignature (class)">InvalidSignature</a></span>.<span class='id identifier rubyid_new'><a href="../Error/InvalidSignature.html#new-class_method" title="Mongo::Error::InvalidSignature.new (method)">new</a></span>(<span class='id identifier rubyid_verifier'>verifier</span><span class='comma'>,</span> <span class='id identifier rubyid_server_signature'><a href="#server_signature-instance_method" title="Mongo::Auth::ScramConversationBase#server_signature (method)">server_signature</a></span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_empty_message-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_empty_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the empty client message.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L171-L173'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='171' data-end='173'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 171</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_empty_message'>client_empty_message</span>
  <span class='const'>BSON</span><span class='op'>::</span><span class='const'>Binary</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongo::Auth::ScramConversationBase.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_final-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_final</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> final implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-7" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-7">http://tools.ietf.org/html/rfc5802#section-7</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L193-L197'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='193' data-end='197'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 193</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_final'>client_final</span>
  <span class='ivar'>@client_final</span> <span class='op'>||=</span> <span class='id identifier rubyid_client_proof'><a href="#client_proof-instance_method" title="Mongo::Auth::ScramConversationBase#client_proof (method)">client_proof</a></span>(<span class='id identifier rubyid_client_key'><a href="#client_key-instance_method" title="Mongo::Auth::ScramConversationBase#client_key (method)">client_key</a></span><span class='comma'>,</span>
    <span class='id identifier rubyid_client_signature'><a href="#client_signature-instance_method" title="Mongo::Auth::ScramConversationBase#client_signature (method)">client_signature</a></span>(<span class='id identifier rubyid_stored_key'><a href="#stored_key-instance_method" title="Mongo::Auth::ScramConversationBase#stored_key (method)">stored_key</a></span>(<span class='id identifier rubyid_client_key'><a href="#client_key-instance_method" title="Mongo::Auth::ScramConversationBase#client_key (method)">client_key</a></span>)<span class='comma'>,</span>
    <span class='id identifier rubyid_auth_message'><a href="#auth_message-instance_method" title="Mongo::Auth::ScramConversationBase#auth_message (method)">auth_message</a></span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_final_message-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_final_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the final client message.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L182-L184'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='182' data-end='184'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 182</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_final_message'>client_final_message</span>
  <span class='const'>BSON</span><span class='op'>::</span><span class='const'>Binary</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongo::Auth::ScramConversationBase.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_without_proof'><a href="#without_proof-instance_method" title="Mongo::Auth::ScramConversationBase#without_proof (method)">without_proof</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>,p=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_client_final'><a href="#client_final-instance_method" title="Mongo::Auth::ScramConversationBase#client_final (method)">client_final</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_first_message_options-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_first_message_options</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L148-L150'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='148' data-end='150'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 148</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_first_message_options'>client_first_message_options</span>
  {<span class='label'>skipEmptyExchange:</span> <span class='kw'>true</span>}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_first_payload-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_first_payload</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L153-L155'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='153' data-end='155'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 153</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_first_payload'>client_first_payload</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n,,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_first_bare'><a href="#first_bare-instance_method" title="Mongo::Auth::ScramConversationBase#first_bare (method)">first_bare</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_key-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_key</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> key algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L222-L226'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='222' data-end='226'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 222</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_key'>client_key</span>
  <span class='ivar'>@client_key</span> <span class='op'>||=</span> <span class='const'><a href="CredentialCache.html" title="Mongo::Auth::CredentialCache (module)">CredentialCache</a></span>.<span class='id identifier rubyid_cache'>cache</span>(<span class='id identifier rubyid_cache_key'><a href="#cache_key-instance_method" title="Mongo::Auth::ScramConversationBase#cache_key (method)">cache_key</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_client_key'>client_key</span>)) <span class='kw'>do</span>
    <span class='id identifier rubyid_hmac'><a href="#hmac-instance_method" title="Mongo::Auth::ScramConversationBase#hmac (method)">hmac</a></span>(<span class='id identifier rubyid_salted_password'>salted_password</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Client Key</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_proof-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_proof</strong>(key, signature)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> proof algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L235-L237'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='235' data-end='237'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 235</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_proof'>client_proof</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_signature'>signature</span>)
  <span class='ivar'>@client_proof</span> <span class='op'>||=</span> <span class='const'>Base64</span>.<span class='id identifier rubyid_strict_encode64'>strict_encode64</span>(<span class='id identifier rubyid_xor'><a href="#xor-instance_method" title="Mongo::Auth::ScramConversationBase#xor (method)">xor</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_signature'>signature</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_signature-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>client_signature</strong>(key, message)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Client.html" title="Mongo::Client (class)"><code>::Mongo::Client</code></a> signature algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L246-L248'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='246' data-end='248'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 246</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_signature'>client_signature</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>)
  <span class='ivar'>@client_signature</span> <span class='op'>||=</span> <span class='id identifier rubyid_hmac'><a href="#hmac-instance_method" title="Mongo::Auth::ScramConversationBase#hmac (method)">hmac</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="compare_digest-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>compare_digest</strong>(a, b)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L371-L375'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='371' data-end='375'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 371</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_compare_digest'>compare_digest</span>(<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)
  <span class='id identifier rubyid_check'>check</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='op'>^</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_bytesize'>bytesize</span>
  <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_bytes'>bytes</span>.<span class='id identifier rubyid_zip'>zip</span>(<span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_bytes'>bytes</span>){ <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span> <span class='id identifier rubyid_check'>check</span> <span class='op'>|=</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>^</span> <span class='id identifier rubyid_y'>y</span>.<span class='id identifier rubyid_to_i'>to_i</span> }
  <span class='id identifier rubyid_check'>check</span> <span class='op'>==</span> <span class='int'>0</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="continue-instance_method">
  <h3 class='signature nodoc'>
    #<strong>continue</strong>(reply_document, connection)  &#x21d2; <a href="../Protocol/Message.html" title="Mongo::Protocol::Message (class)">Protocol::Message</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Continue the SCRAM conversation. This sends the client final message to the server after setting the reply from the previous server communication.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>reply_document</span>
    <span class='type'>(<code>BSON::Document</code>)</span>
&mdash;    <div class='inline'>
<p>The reply document of the previous message.</p>
</div>
  </li>
  <li>
    <span class='name'>connection</span>
    <span class='type'>(<a href="../Server/Connection.html" title="Mongo::Server::Connection (class)">Server::Connection</a>)</span>
&mdash;    <div class='inline'>
<p>The connection being authenticated.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Protocol/Message.html" title="Mongo::Protocol::Message (class)">Protocol::Message</a>)</span>
&mdash;    <div class='inline'>
<p>The next message to send.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L73-L94'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='73' data-end='94'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 73</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_continue'>continue</span>(<span class='id identifier rubyid_reply_document'>reply_document</span><span class='comma'>,</span> <span class='id identifier rubyid_connection'>connection</span>)
  <span class='ivar'>@id</span> <span class='op'>=</span> <span class='id identifier rubyid_reply_document'>reply_document</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>conversationId</span><span class='tstring_end'>&#39;</span></span>]
  <span class='id identifier rubyid_payload_data'><a href="#payload_data-instance_method" title="Mongo::Auth::ScramConversationBase#payload_data (method)">payload_data</a></span> <span class='op'>=</span> <span class='id identifier rubyid_reply_document'>reply_document</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>payload</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_data'>data</span>
  <span class='id identifier rubyid_parsed_data'>parsed_data</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_payload'><a href="#parse_payload-instance_method" title="Mongo::Auth::ScramConversationBase#parse_payload (method)">parse_payload</a></span>(<span class='id identifier rubyid_payload_data'><a href="#payload_data-instance_method" title="Mongo::Auth::ScramConversationBase#payload_data (method)">payload_data</a></span>)
  <span class='ivar'>@server_nonce</span> <span class='op'>=</span> <span class='id identifier rubyid_parsed_data'>parsed_data</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r</span><span class='tstring_end'>&#39;</span></span>)
  <span class='ivar'>@salt</span> <span class='op'>=</span> <span class='const'>Base64</span>.<span class='id identifier rubyid_strict_decode64'>strict_decode64</span>(<span class='id identifier rubyid_parsed_data'>parsed_data</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span>))
  <span class='ivar'>@iterations</span> <span class='op'>=</span> <span class='id identifier rubyid_parsed_data'>parsed_data</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>i</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_to_i'>to_i</span>.<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>&lt;</span> <span class='const'><a href="#MIN_ITER_COUNT-constant" title="Mongo::Auth::ScramConversationBase::MIN_ITER_COUNT (constant)">MIN_ITER_COUNT</a></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="../Error/InsufficientIterationCount.html" title="Mongo::Error::InsufficientIterationCount (class)">InsufficientIterationCount</a></span>.<span class='id identifier rubyid_new'><a href="../Error/InsufficientIterationCount.html#new-class_method" title="Mongo::Error::InsufficientIterationCount.new (method)">new</a></span>(
        <span class='const'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="../Error/InsufficientIterationCount.html" title="Mongo::Error::InsufficientIterationCount (class)">InsufficientIterationCount</a></span>.<span class='id identifier rubyid_message'><a href="../Error/InsufficientIterationCount.html#message-class_method" title="Mongo::Error::InsufficientIterationCount.message (method)">message</a></span>(<span class='const'><a href="#MIN_ITER_COUNT-constant" title="Mongo::Auth::ScramConversationBase::MIN_ITER_COUNT (constant)">MIN_ITER_COUNT</a></span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span>))
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='ivar'>@auth_message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_first_bare'><a href="#first_bare-instance_method" title="Mongo::Auth::ScramConversationBase#first_bare (method)">first_bare</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_payload_data'><a href="#payload_data-instance_method" title="Mongo::Auth::ScramConversationBase#payload_data (method)">payload_data</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_without_proof'><a href="#without_proof-instance_method" title="Mongo::Auth::ScramConversationBase#without_proof (method)">without_proof</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_validate_server_nonce!'>validate_server_nonce!</span>

  <span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> <span class='const'><a href="SaslConversationBase.html#CLIENT_CONTINUE_MESSAGE-constant" title="Mongo::Auth::SaslConversationBase::CLIENT_CONTINUE_MESSAGE (constant)">CLIENT_CONTINUE_MESSAGE</a></span>.<span class='id identifier rubyid_merge'>merge</span>(
    <span class='label'>payload:</span> <span class='id identifier rubyid_client_final_message'><a href="#client_final_message-instance_method" title="Mongo::Auth::ScramConversationBase#client_final_message (method)">client_final_message</a></span><span class='comma'>,</span>
    <span class='label'>conversationId:</span> <span class='id identifier rubyid_id'><a href="#id-instance_method" title="Mongo::Auth::ScramConversationBase#id (method)">id</a></span><span class='comma'>,</span>
  )
  <span class='id identifier rubyid_build_message'>build_message</span>(<span class='id identifier rubyid_connection'>connection</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_auth_source'>auth_source</span><span class='comma'>,</span> <span class='id identifier rubyid_selector'>selector</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="finalize-instance_method">
  <h3 class='signature nodoc'>
    #<strong>finalize</strong>(connection)  &#x21d2; <a href="../Protocol/Message.html" title="Mongo::Protocol::Message (class)">Protocol::Message</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Finalize the SCRAM conversation. This is meant to be iterated until the provided reply indicates the conversation is finished.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>connection</span>
    <span class='type'>(<a href="../Server/Connection.html" title="Mongo::Server::Connection (class)">Server::Connection</a>)</span>
&mdash;    <div class='inline'>
<p>The connection being authenticated.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Protocol/Message.html" title="Mongo::Protocol::Message (class)">Protocol::Message</a>)</span>
&mdash;    <div class='inline'>
<p>The next message to send.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L111-L117'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='111' data-end='117'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 111</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_finalize'>finalize</span>(<span class='id identifier rubyid_connection'>connection</span>)
  <span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> <span class='const'><a href="SaslConversationBase.html#CLIENT_CONTINUE_MESSAGE-constant" title="Mongo::Auth::SaslConversationBase::CLIENT_CONTINUE_MESSAGE (constant)">CLIENT_CONTINUE_MESSAGE</a></span>.<span class='id identifier rubyid_merge'>merge</span>(
    <span class='label'>payload:</span> <span class='id identifier rubyid_client_empty_message'><a href="#client_empty_message-instance_method" title="Mongo::Auth::ScramConversationBase#client_empty_message (method)">client_empty_message</a></span><span class='comma'>,</span>
    <span class='label'>conversationId:</span> <span class='id identifier rubyid_id'><a href="#id-instance_method" title="Mongo::Auth::ScramConversationBase#id (method)">id</a></span><span class='comma'>,</span>
  )
  <span class='id identifier rubyid_build_message'>build_message</span>(<span class='id identifier rubyid_connection'>connection</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_auth_source'>auth_source</span><span class='comma'>,</span> <span class='id identifier rubyid_selector'>selector</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="first_bare-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>first_bare</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>First bare implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-7" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-7">http://tools.ietf.org/html/rfc5802#section-7</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L257-L259'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='257' data-end='259'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 257</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_first_bare'>first_bare</span>
  <span class='ivar'>@first_bare</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_encoded_name'>encoded_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>,r=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_client_nonce'><a href="#client_nonce-instance_method" title="Mongo::Auth::ScramConversationBase#client_nonce (method)">client_nonce</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="h-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>h</strong>(string)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>H algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-2.2" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-2.2">http://tools.ietf.org/html/rfc5802#section-2.2</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L268-L270'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='268' data-end='270'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 268</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_h'>h</span>(<span class='id identifier rubyid_string'>string</span>)
  <span class='id identifier rubyid_digest'>digest</span>.<span class='id identifier rubyid_digest'>digest</span>(<span class='id identifier rubyid_string'>string</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="hmac-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>hmac</strong>(data, key)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>HMAC algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-2.2" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-2.2">http://tools.ietf.org/html/rfc5802#section-2.2</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L279-L281'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='279' data-end='281'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 279</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_hmac'>hmac</span>(<span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span>)
  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>HMAC</span>.<span class='id identifier rubyid_digest'>digest</span>(<span class='id identifier rubyid_digest'>digest</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_payload-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>parse_payload</strong>(payload)  &#x21d2; <code>Hash</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Parses a payload like a=value,b=value2 into a hash like <code>=&gt; ‘value’, ‘b’ =&gt; ‘value2’</code>.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>payload</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The payload to parse.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>Parsed key-value pairs.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L138-L146'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='138' data-end='146'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 138</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_payload'>parse_payload</span>(<span class='id identifier rubyid_payload'>payload</span>)
  <span class='const'>Hash</span>[<span class='id identifier rubyid_payload'>payload</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> }.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span>
    <span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_pair'>pair</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="../Error/InvalidServerAuthResponse.html" title="Mongo::Error::InvalidServerAuthResponse (class)">InvalidServerAuthResponse</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload malformed: missing key</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
    [<span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>]
  <span class='kw'>end</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_continue_response-instance_method">
  <h3 class='signature nodoc'>
    #<strong>process_continue_response</strong>(reply_document)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Processes the second response from the server.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>reply_document</span>
    <span class='type'>(<code>BSON::Document</code>)</span>
&mdash;    <div class='inline'>
<p>The reply document of the continue response.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L100-L103'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='100' data-end='103'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 100</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_continue_response'>process_continue_response</span>(<span class='id identifier rubyid_reply_document'>reply_document</span>)
  <span class='id identifier rubyid_payload_data'><a href="#payload_data-instance_method" title="Mongo::Auth::ScramConversationBase#payload_data (method)">payload_data</a></span> <span class='op'>=</span> <span class='id identifier rubyid_parse_payload'><a href="#parse_payload-instance_method" title="Mongo::Auth::ScramConversationBase#parse_payload (method)">parse_payload</a></span>(<span class='id identifier rubyid_reply_document'>reply_document</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>payload</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_data'>data</span>)
  <span class='id identifier rubyid_check_server_signature'><a href="#check_server_signature-instance_method" title="Mongo::Auth::ScramConversationBase#check_server_signature (method)">check_server_signature</a></span>(<span class='id identifier rubyid_payload_data'><a href="#payload_data-instance_method" title="Mongo::Auth::ScramConversationBase#payload_data (method)">payload_data</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_key-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>server_key</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Server.html" title="Mongo::Server (class)"><code>::Mongo::Server</code></a> key algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L323-L327'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='323' data-end='327'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 323</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_server_key'>server_key</span>
  <span class='ivar'>@server_key</span> <span class='op'>||=</span> <span class='const'><a href="CredentialCache.html" title="Mongo::Auth::CredentialCache (module)">CredentialCache</a></span>.<span class='id identifier rubyid_cache'>cache</span>(<span class='id identifier rubyid_cache_key'><a href="#cache_key-instance_method" title="Mongo::Auth::ScramConversationBase#cache_key (method)">cache_key</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_server_key'>server_key</span>)) <span class='kw'>do</span>
    <span class='id identifier rubyid_hmac'><a href="#hmac-instance_method" title="Mongo::Auth::ScramConversationBase#hmac (method)">hmac</a></span>(<span class='id identifier rubyid_salted_password'>salted_password</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Server Key</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_signature-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>server_signature</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="../Server.html" title="Mongo::Server (class)"><code>::Mongo::Server</code></a> signature algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L336-L338'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='336' data-end='338'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 336</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_server_signature'>server_signature</span>
  <span class='ivar'>@server_signature</span> <span class='op'>||=</span> <span class='const'>Base64</span>.<span class='id identifier rubyid_strict_encode64'>strict_encode64</span>(<span class='id identifier rubyid_hmac'><a href="#hmac-instance_method" title="Mongo::Auth::ScramConversationBase#hmac (method)">hmac</a></span>(<span class='id identifier rubyid_server_key'><a href="#server_key-instance_method" title="Mongo::Auth::ScramConversationBase#server_key (method)">server_key</a></span><span class='comma'>,</span> <span class='id identifier rubyid_auth_message'><a href="#auth_message-instance_method" title="Mongo::Auth::ScramConversationBase#auth_message (method)">auth_message</a></span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="speculative_auth_document-instance_method">
  <h3 class='signature nodoc'>
    #<strong>speculative_auth_document</strong>  &#x21d2; <code>Hash</code> | <code>nil</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the hash to provide to the server in the handshake as value of the speculativeAuthenticate key.</p>

<p>If the auth mechanism does not support speculative authentication, this method returns nil.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>Speculative authentication document.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L126-L128'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='126' data-end='128'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 126</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_speculative_auth_document'>speculative_auth_document</span>
  <span class='id identifier rubyid_client_first_document'>client_first_document</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>db:</span> <span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_auth_source'>auth_source</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stored_key-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>stored_key</strong>(key)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Stored key algorithm implementation.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-3" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-3">http://tools.ietf.org/html/rfc5802#section-3</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L347-L349'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='347' data-end='349'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 347</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_stored_key'>stored_key</span>(<span class='id identifier rubyid_key'>key</span>)
  <span class='id identifier rubyid_h'><a href="#h-instance_method" title="Mongo::Auth::ScramConversationBase#h (method)">h</a></span>(<span class='id identifier rubyid_key'>key</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="without_proof-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>without_proof</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the without proof message.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://tools.ietf.org/html/rfc5802#section-7" target="_parent" title="http://tools.ietf.org/html/rfc5802#section-7">http://tools.ietf.org/html/rfc5802#section-7</a></li>
      </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L358-L360'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='358' data-end='360'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 358</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_without_proof'>without_proof</span>
  <span class='ivar'>@without_proof</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c=biws,r=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_server_nonce'><a href="#server_nonce-instance_method" title="Mongo::Auth::ScramConversationBase#server_nonce (method)">server_nonce</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="xor-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>xor</strong>(first, second)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>XOR operation for two strings.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/auth/scram_conversation_base.rb#L367-L369'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='367' data-end='369'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/auth/scram_conversation_base.rb', line 367</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_xor'>xor</span>(<span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='id identifier rubyid_second'>second</span>)
  <span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_bytes'>bytes</span>.<span class='id identifier rubyid_zip'>zip</span>(<span class='id identifier rubyid_second'>second</span>.<span class='id identifier rubyid_bytes'>bytes</span>).<span class='id identifier rubyid_map'>map</span>{ <span class='op'>|</span>(<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>)<span class='op'>|</span> (<span class='id identifier rubyid_a'>a</span> <span class='op'>^</span> <span class='id identifier rubyid_b'>b</span>).<span class='id identifier rubyid_chr'>chr</span> }.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>