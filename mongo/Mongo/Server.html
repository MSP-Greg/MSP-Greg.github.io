<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongo::Server &mdash; Mongo master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongo::Server",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Mongo master</a> &raquo; 
      <a href='../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../Mongo.html" title="Mongo (module)">Mongo</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Server&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongo::Server</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Server/AppMetadata.html" title="Mongo::Server::AppMetadata (class)"><code>AppMetadata</code></a>,
        <a href="Server/Connection.html" title="Mongo::Server::Connection (class)"><code>Connection</code></a>,
        <a href="Server/ConnectionBase.html" title="Mongo::Server::ConnectionBase (class)"><code>ConnectionBase</code></a>,
        <a href="Server/ConnectionCommon.html" title="Mongo::Server::ConnectionCommon (class)"><code>ConnectionCommon</code></a>,
        <a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)"><code>ConnectionPool</code></a>,
        <a href="Server/Description.html" title="Mongo::Server::Description (class)"><code>Description</code></a>,
        <a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)"><code>Monitor</code></a>,
        <a href="Server/PendingConnection.html" title="Mongo::Server::PendingConnection (class)"><code>PendingConnection</code></a>,
        <a href="Server/PushMonitor.html" title="Mongo::Server::PushMonitor (class)"><code>PushMonitor</code></a>,
        <a href="Server/RoundTripTimeAverager.html" title="Mongo::Server::RoundTripTimeAverager (class)"><code>RoundTripTimeAverager</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          Forwardable
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Event/Publisher.html" title="Mongo::Event::Publisher (module)"><code>Event::Publisher</code></a>,
          <a href="Monitoring/Publishable.html" title="Mongo::Monitoring::Publishable (module)"><code>Monitoring::Publishable</code></a>,
          <a href="Loggable.html" title="Mongo::Loggable (module)"><code>Loggable</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L24'>lib/mongo/server.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/app_metadata.rb#L22'>lib/mongo/server/app_metadata.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/connection.rb#L19'>lib/mongo/server/connection.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/connection_base.rb#L19'>lib/mongo/server/connection_base.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/connection_common.rb#L19'>lib/mongo/server/connection_common.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/connection_pool.rb#L19'>lib/mongo/server/connection_pool.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/description.rb#L19'>lib/mongo/server/description.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/monitor.rb#L19'>lib/mongo/server/monitor.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/pending_connection.rb#L19'>lib/mongo/server/pending_connection.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/push_monitor.rb#L19'>lib/mongo/server/push_monitor.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/round_trip_time_averager.rb#L19'>lib/mongo/server/round_trip_time_averager.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/app_metadata/environment.rb#L18'>lib/mongo/server/app_metadata/environment.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/app_metadata/platform.rb#L18'>lib/mongo/server/app_metadata/platform.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/app_metadata/truncator.rb#L18'>lib/mongo/server/app_metadata/truncator.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/connection_pool/generation_manager.rb#L19'>lib/mongo/server/connection_pool/generation_manager.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/connection_pool/populator.rb#L19'>lib/mongo/server/connection_pool/populator.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/description/features.rb#L19'>lib/mongo/server/description/features.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/description/load_balancer.rb#L19'>lib/mongo/server/description/load_balancer.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/monitor/app_metadata.rb#L19'>lib/mongo/server/monitor/app_metadata.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/monitor/connection.rb#L19'>lib/mongo/server/monitor/connection.rb</a>,<br/> <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server/push_monitor/connection.rb#L19'>lib/mongo/server/push_monitor/connection.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Represents a single server on the server side that can be standalone, part of a replica set, or a mongos.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='CONNECT_TIMEOUT-constant' class='summary_signature'>CONNECT_TIMEOUT =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The default time in seconds to timeout a connection attempt.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.4.3</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L32-L32'># File 'lib/mongo/server.rb', line 32</a>    <pre class='code ruby'><span class='int'>10</span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
  <h3 class='inherited'><a href="Loggable.html" title="Mongo::Loggable (module)"><code>Loggable</code></a> - Included</h3>
  <p  class='inherited'>
    <a href="Loggable.html#PREFIX-constant" title="Mongo::Loggable::PREFIX (constant)">PREFIX</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(address, cluster, monitoring, event_listeners, options = {})  &#x21d2; Server </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Instantiate a new server object.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#address-instance_method" title="#address (instance method)">#<strong>address</strong>  &#x21d2; String </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#cluster-instance_method" title="#cluster (instance method)">#<strong>cluster</strong>  &#x21d2; Cluster </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li class='deprecated'>
    <span class='summary_signature ro deprecated'>
      <a href="#connectable%3F-instance_method" title="#connectable? (instance method)">#<strong>connectable?</strong>  &#x21d2; true, false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='deprecated note title'>deprecated</span>
    <span class='summary_desc'><strong>Deprecated.</strong>
      <div class='inline'>
<p>No longer necessary with <code>Server</code> Selection specification.</p>
</div>    </span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#connected%3F-instance_method" title="#connected? (instance method)">#<strong>connected?</strong>  &#x21d2; true|false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the server is connected.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#description-instance_method" title="#description (instance method)">#<strong>description</strong>  &#x21d2; Server::Description </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#force_load_balancer%3F-instance_method" title="#force_load_balancer? (instance method)">#<strong>force_load_balancer?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns whether this server is forced to be a load balancer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#monitor-instance_method" title="#monitor (instance method)">#<strong>monitor</strong>  &#x21d2; nil | Monitor </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#monitoring-instance_method" title="#monitoring (instance method)">#<strong>monitoring</strong>  &#x21d2; Monitoring </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  &#x21d2; Hash </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#retry_reads%3F-instance_method" title="#retry_reads? (instance method)">#<strong>retry_reads?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the server supports modern read retries.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#retry_writes%3F-instance_method" title="#retry_writes? (instance method)">#<strong>retry_writes?</strong>  &#x21d2; true, false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Will writes sent to this server be retried.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#round_trip_time_averager-instance_method" title="#round_trip_time_averager (instance method)">#<strong>round_trip_time_averager</strong>  &#x21d2; RoundTripTimeAverager </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#scan_semaphore-instance_method" title="#scan_semaphore (instance method)">#<strong>scan_semaphore</strong>  &#x21d2; Semaphore </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited'><a href="Event/Publisher.html" title="Mongo::Event::Publisher (module)"><code>Event::Publisher</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro' href="Event/Publisher.html#event_listeners-instance_method" title="Mongo::Event::Publisher#event_listeners (method)">#event_listeners</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="Monitoring/Publishable.html" title="Mongo::Monitoring::Publishable (module)"><code>Monitoring::Publishable</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro' href="Monitoring/Publishable.html#monitoring-instance_method" title="Mongo::Monitoring::Publishable#monitoring (method)">#monitoring</a>,
        <a class='i_m ro priv' href="Monitoring/Publishable.html#monitoring%3F-instance_method" title="Mongo::Monitoring::Publishable#monitoring? (method)">#monitoring?</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#==-instance_method" title="#== (instance method)">#<strong>==</strong>(other)  &#x21d2; true, false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Is this server equal to another?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#clear_connection_pool-instance_method" title="#clear_connection_pool (instance method)">#<strong>clear_connection_pool</strong>(service_id: nil, interrupt_in_use_connections: false)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#clear_description-instance_method" title="#clear_description (instance method)">#<strong>clear_description</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Clear the servers description so that it is considered unknown and can be safely disconnected.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  </a>
    </span>
  </li>
  <li class='deprecated'>
    <span class='summary_signature deprecated'>
      <a href="#compressor-instance_method" title="#compressor (instance method)">#<strong>compressor</strong>  &#x21d2; String | nil </a>
    </span>
    <span class='deprecated note title'>deprecated</span>
    <span class='summary_desc'><strong>Deprecated.</strong>
      <div class='inline'></div>    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#disconnect!-instance_method" title="#disconnect! (instance method)">#<strong>disconnect!</strong>  &#x21d2; true </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Disconnect the driver from this server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#handle_auth_failure!-instance_method" title="#handle_auth_failure! (instance method)">#<strong>handle_auth_failure!</strong>  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Handle authentication failure.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#handle_handshake_failure!-instance_method" title="#handle_handshake_failure! (instance method)">#<strong>handle_handshake_failure!</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Handle handshake failure.</p></div>
    </div>
  </li>
  <li class='deprecated'>
    <span class='summary_signature deprecated'>
      <a href="#heartbeat_frequency-instance_method" title="#heartbeat_frequency (instance method)">#<strong>heartbeat_frequency</strong>  </a>
      (also: #heartbeat_frequency_seconds)
    </span>
    <span class='deprecated note title'>deprecated</span>
    <span class='summary_desc'><strong>Deprecated.</strong>
      <div class='inline'></div>    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#heartbeat_frequency_seconds-instance_method" title="#heartbeat_frequency_seconds (instance method)">#<strong>heartbeat_frequency_seconds</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#heartbeat_frequency-instance_method" title="Mongo::Server#heartbeat_frequency (method)">#heartbeat_frequency</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a pretty printed server inspection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#last_scan-instance_method" title="#last_scan (instance method)">#<strong>last_scan</strong>  &#x21d2; Time | nil </a>
    </span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#last_scan_monotime-instance_method" title="#last_scan_monotime (instance method)">#<strong>last_scan_monotime</strong>  &#x21d2; Float | nil </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#matches_tag_set%3F-instance_method" title="#matches_tag_set? (instance method)">#<strong>matches_tag_set?</strong>(tag_set)  &#x21d2; true, false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Determine if the provided tags are a subset of the server’s tags.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#next_connection_id-instance_method" title="#next_connection_id (instance method)">#<strong>next_connection_id</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pool-instance_method" title="#pool (instance method)">#<strong>pool</strong>  &#x21d2; Mongo::Server::ConnectionPool </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the connection pool for this server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#pool_internal-instance_method" title="#pool_internal (instance method)">#<strong>pool_internal</strong>  &#x21d2; Server::ConnectionPool | nil </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Internal driver method to retrieve the connection pool for this server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#publish_opening_event-instance_method" title="#publish_opening_event (instance method)">#<strong>publish_opening_event</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Publishes the server opening event.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reconnect!-instance_method" title="#reconnect! (instance method)">#<strong>reconnect!</strong>  &#x21d2; true </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Restart the server monitor.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#start_monitoring-instance_method" title="#start_monitoring (instance method)">#<strong>start_monitoring</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Start monitoring the server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#status-instance_method" title="#status (instance method)">#<strong>status</strong>  &#x21d2; String </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#summary-instance_method" title="#summary (instance method)">#<strong>summary</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unknown!-instance_method" title="#unknown! (instance method)">#<strong>unknown!</strong>(options = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Marks server unknown and publishes the associated SDAM event (server description changed).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#update_description-instance_method" title="#update_description (instance method)">#<strong>update_description</strong>(description)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#update_last_scan-instance_method" title="#update_last_scan (instance method)">#<strong>update_last_scan</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#with_connection-instance_method" title="#with_connection (instance method)">#<strong>with_connection</strong>(connection_global_id: nil, &amp;block)  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Execute a block of code with a connection, that is checked out of the server’s pool and then checked back in.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Event/Publisher.html" title="Mongo::Event::Publisher (module)"><code>Event::Publisher</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Event/Publisher.html#publish-instance_method" title="Mongo::Event::Publisher#publish (method)">#publish</a></td>
      <td><div class='inline'><p>Publish the provided event.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="Monitoring/Publishable.html" title="Mongo::Monitoring::Publishable (module)"><code>Monitoring::Publishable</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Monitoring/Publishable.html#publish_cmap_event-instance_method" title="Mongo::Monitoring::Publishable#publish_cmap_event (method)">#publish_cmap_event</a>,
        <a class='i_m deprecated' href="Monitoring/Publishable.html#publish_event-instance_method" title="Mongo::Monitoring::Publishable#publish_event (method)">#publish_event</a>,
        <a class='i_m ' href="Monitoring/Publishable.html#publish_sdam_event-instance_method" title="Mongo::Monitoring::Publishable#publish_sdam_event (method)">#publish_sdam_event</a>,
        <a class='i_m priv' href="Monitoring/Publishable.html#command_completed-instance_method" title="Mongo::Monitoring::Publishable#command_completed (method)">#command_completed</a>,
        <a class='i_m priv' href="Monitoring/Publishable.html#command_failed-instance_method" title="Mongo::Monitoring::Publishable#command_failed (method)">#command_failed</a>,
        <a class='i_m priv' href="Monitoring/Publishable.html#command_started-instance_method" title="Mongo::Monitoring::Publishable#command_started (method)">#command_started</a>,
        <a class='i_m priv' href="Monitoring/Publishable.html#command_succeeded-instance_method" title="Mongo::Monitoring::Publishable#command_succeeded (method)">#command_succeeded</a>,
        <a class='i_m priv' href="Monitoring/Publishable.html#duration-instance_method" title="Mongo::Monitoring::Publishable#duration (method)">#duration</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="Loggable.html" title="Mongo::Loggable (module)"><code>Loggable</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Loggable.html#log_debug-instance_method" title="Mongo::Loggable#log_debug (method)">#log_debug</a></td>
      <td><div class='inline'><p>Convenience method to log debug messages with the standard prefix.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Loggable.html#log_error-instance_method" title="Mongo::Loggable#log_error (method)">#log_error</a></td>
      <td><div class='inline'><p>Convenience method to log error messages with the standard prefix.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Loggable.html#log_fatal-instance_method" title="Mongo::Loggable#log_fatal (method)">#log_fatal</a></td>
      <td><div class='inline'><p>Convenience method to log fatal messages with the standard prefix.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Loggable.html#log_info-instance_method" title="Mongo::Loggable#log_info (method)">#log_info</a></td>
      <td><div class='inline'><p>Convenience method to log info messages with the standard prefix.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Loggable.html#log_warn-instance_method" title="Mongo::Loggable#log_warn (method)">#log_warn</a></td>
      <td><div class='inline'><p>Convenience method to log warn messages with the standard prefix.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Loggable.html#logger-instance_method" title="Mongo::Loggable#logger (method)">#logger</a></td>
      <td><div class='inline'><p>Get the logger instance.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Loggable.html#_mongo_log_prefix-instance_method" title="Mongo::Loggable#_mongo_log_prefix (method)">#_mongo_log_prefix</a>,
        <a class='i_m priv' href="Loggable.html#format_message-instance_method" title="Mongo::Loggable#format_message (method)">#format_message</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="address-instance_method">
  <h3 class='signature ro first'>
    #<strong>address</strong>  &#x21d2; <code>String</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The configured address for the server.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L106-L106'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='106' data-end='106'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 106</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cluster-instance_method">
  <h3 class='signature ro'>
    #<strong>cluster</strong>  &#x21d2; <a href="Cluster.html" title="Mongo::Cluster (class)">Cluster</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Cluster.html" title="Mongo::Cluster (class)">Cluster</a>)</span>
&mdash;    <div class='inline'>
<p>cluster The server cluster.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L109-L109'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='109' data-end='109'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 109</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_cluster'>cluster</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connectable?-instance_method">
  <h3 class='signature ro  deprecated'>
    #<strong>connectable?</strong>  &#x21d2; <code>true</code>, <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'>
<p>No longer necessary with <code>Server</code> Selection specification.</p>
</div></div>

<p>Determine if a connection to the server is able to be established and messages can be sent to it.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the server connectable?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_connectable?'>connectable?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>, <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the server is connectable.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L261-L261'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='261' data-end='261'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 261</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connectable?'>connectable?</span><span class='semicolon'>;</span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connected?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>connected?</strong>  &#x21d2; <code>true</code>|<code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the server is connected.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>|<code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the server is connected.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.7.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L320-L322'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='320' data-end='322'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 320</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connected?'>connected?</span>
  <span class='ivar'>@connected</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="description-instance_method">
  <h3 class='signature ro'>
    #<strong>description</strong>  &#x21d2; <a href="Server/Description.html" title="Mongo::Server::Description (class)">Server::Description</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Server/Description.html" title="Mongo::Server::Description (class)">Server::Description</a>)</span>
&mdash;    <div class='inline'>
<p>description The server description the monitor refreshes.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L123-L123'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='123' data-end='123'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 123</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_description'>description</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="force_load_balancer?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>force_load_balancer?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns whether this server is forced to be a load balancer.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether this server is forced to be a load balancer.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L130-L132'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='130' data-end='132'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 130</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_force_load_balancer?'>force_load_balancer?</span>
  <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_connect'>connect</span>] <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_load_balanced'>load_balanced</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="monitor-instance_method">
  <h3 class='signature ro'>
    #<strong>monitor</strong>  &#x21d2; <code>nil</code> | <a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Monitor</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>nil</code> | <a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Monitor</a>)</span>
&mdash;    <div class='inline'>
<p>monitor The server monitor. nil if the servenr was created with monitoring_io: false option.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L113-L113'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='113' data-end='113'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 113</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_monitor'>monitor</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="monitoring-instance_method">
  <h3 class='signature ro'>
    #<strong>monitoring</strong>  &#x21d2; <a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a>)</span>
&mdash;    <div class='inline'>
<p>monitoring The monitoring.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L119-L119'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='119' data-end='119'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 119</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_monitoring'>monitoring</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="options-instance_method">
  <h3 class='signature ro'>
    #<strong>options</strong>  &#x21d2; <code>Hash</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The options hash.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L116-L116'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='116' data-end='116'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 116</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_options'>options</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="retry_reads?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>retry_reads?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the server supports modern read retries.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L543-L545'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='543' data-end='545'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 543</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_retry_reads?'>retry_reads?</span>
  <span class='op'>!</span><span class='op'>!</span>(<span class='id identifier rubyid_features'>features</span>.<span class='id identifier rubyid_sessions_enabled?'>sessions_enabled?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_logical_session_timeout'>logical_session_timeout</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="retry_writes?-instance_method">
  <h3 class='signature ro'>
    #<strong>retry_writes?</strong>  &#x21d2; <code>true</code>, <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Retryable.html" title="Mongo::Retryable (module)"><code>Retryable</code></a> writes are only available on server versions 3.6+ and with sharded clusters or replica sets.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Some of the conditions in this method automatically return false for for load balanced topologies. The conditions in this method should always be true, since load-balanced topologies are only available on MongoDB 5.0+, and not for standalone topologies. Therefore, we can assume that retry writes are enabled.</p>
</div>
  </div>


<p>Will writes sent to this server be retried.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Will writes be retried.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_retry_writes?'>retry_writes?</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>, <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If writes will be retried.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.5.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L564-L566'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='564' data-end='566'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 564</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_retry_writes?'>retry_writes?</span>
  <span class='op'>!</span><span class='op'>!</span>(<span class='id identifier rubyid_features'>features</span>.<span class='id identifier rubyid_sessions_enabled?'>sessions_enabled?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_logical_session_timeout'>logical_session_timeout</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_standalone?'>standalone?</span>) <span class='op'>||</span> <span class='id identifier rubyid_load_balancer?'>load_balancer?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="round_trip_time_averager-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>round_trip_time_averager</strong>  &#x21d2; <a href="Server/RoundTripTimeAverager.html" title="Mongo::Server::RoundTripTimeAverager (class)">RoundTripTimeAverager</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Server/RoundTripTimeAverager.html" title="Mongo::Server::RoundTripTimeAverager (class)">RoundTripTimeAverager</a>)</span>
&mdash;    <div class='inline'>
<p>Round trip time averager object.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L233-L233'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='233' data-end='233'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 233</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_round_trip_time_averager'>round_trip_time_averager</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="scan_semaphore-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>scan_semaphore</strong>  &#x21d2; <a href="Semaphore.html" title="Mongo::Semaphore (class)">Semaphore</a>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Semaphore.html" title="Mongo::Semaphore (class)">Semaphore</a>)</span>
&mdash;    <div class='inline'>
<p><a href="Semaphore.html" title="Mongo::Semaphore (class)"><code>Semaphore</code></a> to signal to request an immediate scan of this server by its monitor, if one is running.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L229-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='229' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 229</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_scan_semaphore'>scan_semaphore</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="==-instance_method">
  <h3 class='signature  first'>
    #<strong>==</strong>(other)  &#x21d2; <code>true</code>, <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is this server equal to another?</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Is the server equal to the other?</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>other</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The object to compare to.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>, <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the servers are equal.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L245-L248'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='245' data-end='248'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 245</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>==</span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Server</span>)
  <span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clear_connection_pool-instance_method">
  <h3 class='signature nodoc'>
    #<strong>clear_connection_pool</strong>(service_id: nil, interrupt_in_use_connections: false)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>:service_id</span>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>Close connections with the specified service id only.</p>
</div>
  </li>
  <li>
    <span class='name'>:interrupt_in_use_connections</span>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether or not the cleared connections should be interrupted as well.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L667-L677'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='667' data-end='677'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 667</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_connection_pool'>clear_connection_pool</span>(<span class='label'>service_id:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>interrupt_in_use_connections:</span> <span class='kw'>false</span>)
  <span class='ivar'>@pool_lock</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='comment'># A server being marked unknown after it is closed is technically
</span>    <span class='comment'># incorrect but it does not meaningfully alter any state.
</span>    <span class='comment'># Because historically the driver permitted servers to be marked
</span>    <span class='comment'># unknown at any time, continue doing so even if the pool is closed.
</span>    <span class='kw'>if</span> <span class='ivar'>@pool</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@pool</span>.<span class='id identifier rubyid_closed?'>closed?</span>
      <span class='ivar'>@pool</span>.<span class='id identifier rubyid_disconnect!'><a href="#disconnect!-instance_method" title="Mongo::Server#disconnect! (method)">disconnect!</a></span>(<span class='label'>service_id:</span> <span class='id identifier rubyid_service_id'>service_id</span><span class='comma'>,</span> <span class='label'>interrupt_in_use_connections:</span> <span class='id identifier rubyid_interrupt_in_use_connections'>interrupt_in_use_connections</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clear_description-instance_method">
  <h3 class='signature nodoc'>
    #<strong>clear_description</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Clear the servers description so that it is considered unknown and can be safely disconnected.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L657-L659'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='657' data-end='659'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 657</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_description'>clear_description</span>
  <span class='ivar'>@description</span> <span class='op'>=</span> <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'><a href="Server/Description.html" title="Mongo::Server::Description (class)">Description</a></span>.<span class='id identifier rubyid_new'><a href="Server/Description.html#new-class_method" title="Mongo::Server::Description.new (method)">new</a></span>(<span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span><span class='comma'>,</span> {})
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close-instance_method">
  <h3 class='signature '>
    #<strong>close</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L294-L312'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='294' data-end='312'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 294</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>
    <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>.<span class='id identifier rubyid_stop!'>stop!</span>
  <span class='kw'>end</span>

  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='id identifier rubyid__pool'>_pool</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@pool_lock</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id identifier rubyid__pool'>_pool</span><span class='comma'>,</span> <span class='ivar'>@pool</span> <span class='op'>=</span> <span class='ivar'>@pool</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># TODO: change this to _pool.close in RUBY-3174.
</span>  <span class='comment'># Clear the pool. If the server is not unknown then the
</span>  <span class='comment'># pool will stay ready. Stop the background populator thread.
</span>  <span class='id identifier rubyid__pool'>_pool</span><span class='op'>&amp;.</span><span class='id identifier rubyid_close'>close</span>(<span class='label'>stay_ready:</span> <span class='kw'>true</span>)

  <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="compressor-instance_method">
  <h3 class='signature deprecated'>
    #<strong>compressor</strong>  &#x21d2; <code>String</code> | <code>nil</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'></div></div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Compression is negotiated for each connection separately.</p>
</div>
  </div>


<p>The compressor negotiated by the server monitor, if any.</p>

<p>This attribute is nil if no server check has not yet completed, and if no compression was negatiated.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>The negotiated compressor.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L181-L187'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='181' data-end='187'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 181</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_compressor'>compressor</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>
    <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>.<span class='id identifier rubyid_compressor'>compressor</span>
  <span class='kw'>else</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disconnect!-instance_method">
  <h3 class='signature '>
    #<strong>disconnect!</strong>  &#x21d2; <code>true</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Disconnect the driver from this server.</p>

<p>Disconnects all idle connections to this server in its connection pool, if any exist. Stops the populator of the connection pool, if it is running. Does not immediately close connections which are presently checked out (i.e. in use) - such connections will be closed when they are returned to their respective connection pools. Stop the server’s background monitor.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>)</span>
&mdash;    <div class='inline'>
<p>Always true.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L275-L292'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='275' data-end='292'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 275</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_disconnect!'>disconnect!</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>
    <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>.<span class='id identifier rubyid_stop!'>stop!</span>
  <span class='kw'>end</span>

  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='comment'># The current CMAP spec requires a pool to be mostly unusable
</span>  <span class='comment'># if its server is unknown (or, therefore, disconnected).
</span>  <span class='comment'># However any outstanding operations should continue to completion,
</span>  <span class='comment'># and their connections need to be checked into the pool to be
</span>  <span class='comment'># torn down. Because of this cleanup requirement we cannot just
</span>  <span class='comment'># close the pool and set it to nil here, to be recreated the next
</span>  <span class='comment'># time the server is discovered.
</span>  <span class='id identifier rubyid_pool_internal'><a href="#pool_internal-instance_method" title="Mongo::Server#pool_internal (method)">pool_internal</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_clear'>clear</span>

  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="handle_auth_failure!-instance_method">
  <h3 class='signature '>
    #<strong>handle_auth_failure!</strong>  &#x21d2; <code>Object</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Handle authentication failure.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Handle possible authentication failure.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_handle_auth_failure!'>handle_auth_failure!</span> <span class='kw'>do</span>
  <span class='const'><a href="Auth.html" title="Mongo::Auth (module)">Auth</a></span>.<span class='id identifier rubyid_get'><a href="Auth.html#get-instance_method" title="Mongo::Auth#get (method)">get</a></span>(<span class='id identifier rubyid_user'>user</span>).<span class='id identifier rubyid_login'>login</span>(<span class='kw'>self</span>)
<span class='kw'>end</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The result of the block execution.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="Auth/Unauthorized.html" title="Mongo::Auth::Unauthorized (class)">Auth::Unauthorized</a>)</span>
&mdash;    <div class='inline'>
<p>If the authentication failed.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.3.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L524-L538'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='524' data-end='538'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 524</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_auth_failure!'>handle_auth_failure!</span>
  <span class='kw'>yield</span>
<span class='kw'>rescue</span> <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/SocketTimeoutError.html" title="Mongo::Error::SocketTimeoutError (class)">SocketTimeoutError</a></span>
  <span class='comment'># possibly cluster is slow, do not give up on it
</span>  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>rescue</span> <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/SocketError.html" title="Mongo::Error::SocketError (class)">SocketError</a></span><span class='comma'>,</span> <span class='const'><a href="Auth.html" title="Mongo::Auth (module)">Auth</a></span><span class='op'>::</span><span class='const'><a href="Auth/Unauthorized.html" title="Mongo::Auth::Unauthorized (class)">Unauthorized</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='comment'># non-timeout network error or auth error, clear the pool and mark the
</span>  <span class='comment'># topology as unknown
</span>  <span class='id identifier rubyid_unknown!'><a href="#unknown!-instance_method" title="Mongo::Server#unknown! (method)">unknown!</a></span>(
    <span class='label'>generation:</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_generation'>generation</span><span class='comma'>,</span>
    <span class='label'>service_id:</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_service_id'>service_id</span><span class='comma'>,</span>
    <span class='label'>stop_push_monitor:</span> <span class='kw'>true</span><span class='comma'>,</span>
  )
  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="handle_handshake_failure!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>handle_handshake_failure!</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Handle handshake failure.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.7.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L501-L510'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='501' data-end='510'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 501</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_handshake_failure!'>handle_handshake_failure!</span>
  <span class='kw'>yield</span>
<span class='kw'>rescue</span> <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/SocketError.html" title="Mongo::Error::SocketError (class)">SocketError</a></span><span class='comma'>,</span> <span class='const'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span><span class='op'>::</span><span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/SocketTimeoutError.html" title="Mongo::Error::SocketTimeoutError (class)">SocketTimeoutError</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_unknown!'><a href="#unknown!-instance_method" title="Mongo::Server#unknown! (method)">unknown!</a></span>(
    <span class='label'>generation:</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_generation'>generation</span><span class='comma'>,</span>
    <span class='label'>service_id:</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_service_id'>service_id</span><span class='comma'>,</span>
    <span class='label'>stop_push_monitor:</span> <span class='kw'>true</span><span class='comma'>,</span>
  )
  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="heartbeat_frequency-instance_method">
  <h3 class='signature deprecated'>
    #<strong>heartbeat_frequency</strong>  
    <span class='aliases'>Also known as: <span class='names'>#heartbeat_frequency_seconds</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'></div></div>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L159-L161'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='159' data-end='161'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 159</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_heartbeat_frequency'>heartbeat_frequency</span>
  <span class='id identifier rubyid_cluster'><a href="#cluster-instance_method" title="Mongo::Server#cluster (method)">cluster</a></span>.<span class='id identifier rubyid_heartbeat_interval'>heartbeat_interval</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="heartbeat_frequency_seconds-instance_method">
  <h3 class='signature '>
    #<strong>heartbeat_frequency_seconds</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#heartbeat_frequency-instance_method" title="Mongo::Server#heartbeat_frequency (method)">#heartbeat_frequency</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L164-L164'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='164' data-end='164'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 164</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='symbeg'>:</span><span class='id identifier rubyid_heartbeat_frequency_seconds'>heartbeat_frequency_seconds</span> <span class='symbeg'>:</span><span class='id identifier rubyid_heartbeat_frequency'><a href="#heartbeat_frequency-instance_method" title="Mongo::Server#heartbeat_frequency (method)">heartbeat_frequency</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature '>
    #<strong>inspect</strong>  &#x21d2; <code>String</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a pretty printed server inspection.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the server inspection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_inspect'>inspect</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>The nice inspection string.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L355-L357'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='355' data-end='357'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 355</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Mongo::Server:0x</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> address=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span>.<span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span>.<span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'><a href="#status-instance_method" title="Mongo::Server#status (method)">status</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="last_scan-instance_method">
  <h3 class='signature '>
    #<strong>last_scan</strong>  &#x21d2; <code>Time</code> | <code>nil</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Time</code> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>last_scan The time when the last server scan completed, or nil if the server has not been scanned yet.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.4.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L138-L144'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='138' data-end='144'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 138</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_last_scan'>last_scan</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>.<span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>.<span class='id identifier rubyid_last_update_time'>last_update_time</span>
  <span class='kw'>else</span>
    <span class='ivar'>@last_scan</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="last_scan_monotime-instance_method">
  <h3 class='signature nodoc'>
    #<strong>last_scan_monotime</strong>  &#x21d2; <code>Float</code> | <code>nil</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Float</code> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>last_scan_monotime The monotonic time when the last server scan completed, or nil if the server has not been scanned yet.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L149-L155'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='149' data-end='155'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 149</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_last_scan_monotime'>last_scan_monotime</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>.<span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>.<span class='id identifier rubyid_last_update_monotime'>last_update_monotime</span>
  <span class='kw'>else</span>
    <span class='ivar'>@last_scan_monotime</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="matches_tag_set?-instance_method">
  <h3 class='signature '>
    #<strong>matches_tag_set?</strong>(tag_set)  &#x21d2; <code>true</code>, <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Determine if the provided tags are a subset of the server’s tags.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Are the provided tags a subset of the server’s tags.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_matches_tag_set?'>matches_tag_set?</span>({ <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rack</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nyc</span><span class='tstring_end'>&#39;</span></span> })</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>tag_set</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>The tag set to compare to the server’s tags.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>, <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>If the provided tags are a subset of the server’s tags.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L461-L465'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='461' data-end='465'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 461</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_matches_tag_set?'>matches_tag_set?</span>(<span class='id identifier rubyid_tag_set'>tag_set</span>)
  <span class='id identifier rubyid_tag_set'>tag_set</span>.<span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_all?'>all?</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='id identifier rubyid_tags'>tags</span>[<span class='id identifier rubyid_k'>k</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_tags'>tags</span>[<span class='id identifier rubyid_k'>k</span>] <span class='op'>==</span> <span class='id identifier rubyid_tag_set'>tag_set</span>[<span class='id identifier rubyid_k'>k</span>]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="next_connection_id-instance_method">
  <h3 class='signature nodoc'>
    #<strong>next_connection_id</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L680-L682'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='680' data-end='682'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 680</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_next_connection_id'>next_connection_id</span>
  <span class='ivar'>@connection_id_gen</span>.<span class='id identifier rubyid_next_id'>next_id</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pool-instance_method">
  <h3 class='signature '>
    #<strong>pool</strong>  &#x21d2; <a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">Mongo::Server::ConnectionPool</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the connection pool for this server.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Get the connection pool for the server.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_pool'>pool</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">Mongo::Server::ConnectionPool</a>)</span>
&mdash;    <div class='inline'>
<p>The connection pool.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L424-L435'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='424' data-end='435'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 424</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pool'>pool</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_unknown?'>unknown?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="Error/ServerNotUsable.html" title="Mongo::Error::ServerNotUsable (class)">ServerNotUsable</a></span><span class='comma'>,</span> <span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span>
  <span class='kw'>end</span>

  <span class='ivar'>@pool_lock</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='id identifier rubyid_connected?'><a href="#connected%3F-instance_method" title="Mongo::Server#connected? (method)">connected?</a></span> <span class='op'>?</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span> <span class='op'>:</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>populator_io:</span> <span class='kw'>false</span>)
    <span class='ivar'>@pool</span> <span class='op'>||=</span> <span class='const'><a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">ConnectionPool</a></span>.<span class='id identifier rubyid_new'><a href="Server/ConnectionPool.html#new-class_method" title="Mongo::Server::ConnectionPool.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span>).<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pool'>pool</span><span class='op'>|</span>
      <span class='id identifier rubyid_pool'>pool</span>.<span class='id identifier rubyid_ready'>ready</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pool_internal-instance_method">
  <h3 class='signature nodoc'>
    #<strong>pool_internal</strong>  &#x21d2; <a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">Server::ConnectionPool</a> | <code>nil</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Internal driver method to retrieve the connection pool for this server.</p>

<p>Unlike <code>pool</code>, <code>pool_internal</code> will not create a pool if one does not already exist.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">Server::ConnectionPool</a> | <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>The connection pool, if one exists.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L445-L449'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='445' data-end='449'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 445</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pool_internal'>pool_internal</span>
  <span class='ivar'>@pool_lock</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='ivar'>@pool</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="publish_opening_event-instance_method">
  <h3 class='signature nodoc'>
    #<strong>publish_opening_event</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Publishes the server opening event.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L340-L345'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='340' data-end='345'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 340</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_publish_opening_event'>publish_opening_event</span>
  <span class='id identifier rubyid_publish_sdam_event'>publish_sdam_event</span>(
    <span class='const'><a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a></span><span class='op'>::</span><span class='const'><a href="Monitoring.html#SERVER_OPENING-constant" title="Mongo::Monitoring::SERVER_OPENING (constant)">SERVER_OPENING</a></span><span class='comma'>,</span>
    <span class='const'><a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a></span><span class='op'>::</span><span class='const'><a href="Monitoring/Event.html" title="Mongo::Monitoring::Event (module)">Event</a></span><span class='op'>::</span><span class='const'><a href="Monitoring/Event/ServerOpening.html" title="Mongo::Monitoring::Event::ServerOpening (class)">ServerOpening</a></span>.<span class='id identifier rubyid_new'><a href="Monitoring/Event/ServerOpening.html#new-class_method" title="Mongo::Monitoring::Event::ServerOpening.new (method)">new</a></span>(<span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span><span class='comma'>,</span> <span class='id identifier rubyid_cluster'><a href="#cluster-instance_method" title="Mongo::Server#cluster (method)">cluster</a></span>.<span class='id identifier rubyid_topology'>topology</span>)
  )
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reconnect!-instance_method">
  <h3 class='signature '>
    #<strong>reconnect!</strong>  &#x21d2; <code>true</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Restart the server monitor.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Restart the server monitor.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_reconnect!'>reconnect!</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>)</span>
&mdash;    <div class='inline'>
<p>Always true.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.1.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L475-L480'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='475' data-end='480'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 475</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reconnect!'>reconnect!</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_monitoring_io'>monitoring_io</span>] <span class='op'>!=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>.<span class='id identifier rubyid_restart!'>restart!</span>
  <span class='kw'>end</span>
  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_monitoring-instance_method">
  <h3 class='signature nodoc'>
    #<strong>start_monitoring</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Start monitoring the server.</p>

<p>Used internally by the driver to add a server to a cluster while delaying monitoring until the server is in the cluster.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L330-L335'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='330' data-end='335'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 330</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_start_monitoring'>start_monitoring</span>
  <span class='id identifier rubyid_publish_opening_event'><a href="#publish_opening_event-instance_method" title="Mongo::Server#publish_opening_event (method)">publish_opening_event</a></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_monitoring_io'>monitoring_io</span>] <span class='op'>!=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span>.<span class='id identifier rubyid_run!'>run!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="status-instance_method">
  <h3 class='signature nodoc'>
    #<strong>status</strong>  &#x21d2; <code>String</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'>
<p>String representing server status (e.g. PRIMARY).</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L362-L387'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='362' data-end='387'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 362</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_status'>status</span>
  <span class='kw'>case</span>
  <span class='kw'>when</span> <span class='id identifier rubyid_load_balancer?'>load_balancer?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LB</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_primary?'>primary?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PRIMARY</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_secondary?'>secondary?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SECONDARY</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_standalone?'>standalone?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>STANDALONE</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_arbiter?'>arbiter?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ARBITER</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_ghost?'>ghost?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GHOST</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_other?'>other?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OTHER</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_mongos?'>mongos?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MONGOS</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_unknown?'>unknown?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UNKNOWN</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='comment'># Since the summary method is often used for debugging, do not raise
</span>    <span class='comment'># an exception in case none of the expected types matched
</span>    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="summary-instance_method">
  <h3 class='signature '>
    #<strong>summary</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This method is experimental and subject to change.</p>
</div>
  </div>


  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.7.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L393-L414'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='393' data-end='414'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 393</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_summary'>summary</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Mongo::Server#status (method)">status</a></span> <span class='op'>=</span> <span class='kw'>self</span>.<span class='id identifier rubyid_status'><a href="#status-instance_method" title="Mongo::Server#status (method)">status</a></span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_replica_set_name'>replica_set_name</span>
    <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Mongo::Server#status (method)">status</a></span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> replica_set=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_replica_set_name'>replica_set_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_running?'>running?</span>
    <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Mongo::Server#status (method)">status</a></span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> NO-MONITORING</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@pool</span>
    <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Mongo::Server#status (method)">status</a></span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> pool=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@pool</span>.<span class='id identifier rubyid_summary'>summary</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_address_bit'>address_bit</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span>.<span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span>.<span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nil</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Server address=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address_bit'>address_bit</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'><a href="#status-instance_method" title="Mongo::Server#status (method)">status</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unknown!-instance_method">
  <h3 class='signature '>
    #<strong>unknown!</strong>(options = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Marks server unknown and publishes the associated SDAM event (server description changed).</p>

<p>If the generation is passed in options, the server will only be marked unknown if the passed generation is no older than the current generation of the server’s connection pool.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'>
<p><a href="Options.html" title="Mongo::Options (module)"><code>Options</code></a>.</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:generation</span>
          <span class='type'>(<code>Integer</code>)</span>
            &mdash; <div class='inline'>
<p><a href="Server/Connection.html" title="Mongo::Server::Connection (class)"><code>Server::Connection</code></a> pool generation of the connection that was used for the operation that produced the error.</p>
</div>        </li>
        <li>
          <span class='name'>:keep_connection_pool</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Usually when the new server description is unknown, the connection pool on the respective server is cleared. Set this option to true to keep the existing connection pool (required when handling not master errors on 4.2+ servers).</p>
</div>        </li>
        <li>
          <span class='name'>:topology_version</span>
          <span class='type'>(<a href="TopologyVersion.html" title="Mongo::TopologyVersion (class)">TopologyVersion</a>)</span>
            &mdash; <div class='inline'>
<p>Topology version of the error response that is causing the server to be marked unknown.</p>
</div>        </li>
        <li>
          <span class='name'>:stop_push_monitor</span>
          <span class='type'>(<code>true</code> | <code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether to stop the <a href="Server/PushMonitor.html" title="Mongo::Server::PushMonitor (class)"><code>Server::PushMonitor</code></a> associated with the server, if any.</p>
</div>        </li>
        <li>
          <span class='name'>:service_id</span>
          <span class='type'>(<code>Object</code>)</span>
            &mdash; <div class='inline'>
<p>Discard state for the specified service id only.</p>
</div>        </li>
    </ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.4.0, SDAM events are sent as of version 2.7.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L592-L642'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='592' data-end='642'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 592</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unknown!'>unknown!</span>(<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_pool'><a href="#pool-instance_method" title="Mongo::Server#pool (method)">pool</a></span> <span class='op'>=</span> <span class='id identifier rubyid_pool_internal'><a href="#pool_internal-instance_method" title="Mongo::Server#pool_internal (method)">pool_internal</a></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_load_balancer?'>load_balancer?</span>
    <span class='comment'># When the client is in load-balanced topology, servers (the one and
</span>    <span class='comment'># only that can be) starts out as a load balancer and stays as a
</span>    <span class='comment'># load balancer indefinitely. As such it is not marked unknown.
</span>    <span class='comment'>#
</span>    <span class='comment'># However, this method also clears connection pool for the server
</span>    <span class='comment'># when the latter is marked unknown, and this part needs to happen
</span>    <span class='comment'># when the server is a load balancer.
</span>    <span class='comment'>#
</span>    <span class='comment'># It is possible for a load balancer server to not have a service id,
</span>    <span class='comment'># for example if there haven&#39;t been any successful connections yet to
</span>    <span class='comment'># this server, but the server can still be marked unknown if one
</span>    <span class='comment'># of such connections failed midway through its establishment.
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_service_id'>service_id</span> <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_service_id'>service_id</span>]
      <span class='id identifier rubyid_pool'><a href="#pool-instance_method" title="Mongo::Server#pool (method)">pool</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_disconnect!'><a href="#disconnect!-instance_method" title="Mongo::Server#disconnect! (method)">disconnect!</a></span>(<span class='label'>service_id:</span> <span class='id identifier rubyid_service_id'>service_id</span>)
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_generation'>generation</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_generation'>generation</span>] <span class='op'>&lt;</span> <span class='id identifier rubyid_pool'><a href="#pool-instance_method" title="Mongo::Server#pool (method)">pool</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_generation'>generation</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_topology_version'>topology_version</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>.<span class='id identifier rubyid_topology_version'>topology_version</span> <span class='op'>&amp;&amp;</span>
    <span class='op'>!</span><span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_topology_version'>topology_version</span>].<span class='id identifier rubyid_gt?'>gt?</span>(<span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>.<span class='id identifier rubyid_topology_version'>topology_version</span>)
  <span class='kw'>then</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_stop_push_monitor'>stop_push_monitor</span>]
    <span class='id identifier rubyid_monitor'><a href="#monitor-instance_method" title="Mongo::Server#monitor (method)">monitor</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_stop_push_monitor!'>stop_push_monitor!</span>
  <span class='kw'>end</span>

  <span class='comment'># SDAM flow will update description on the server without in-place
</span>  <span class='comment'># mutations and invoke SDAM transitions as needed.
</span>  <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> {}
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_service_id'>service_id</span>]
    <span class='id identifier rubyid_config'>config</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>serviceId</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_service_id'>service_id</span>]
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_topology_version'>topology_version</span>]
    <span class='id identifier rubyid_config'>config</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>topologyVersion</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_topology_version'>topology_version</span>]
  <span class='kw'>end</span>
  <span class='id identifier rubyid_new_description'>new_description</span> <span class='op'>=</span> <span class='const'><a href="Server/Description.html" title="Mongo::Server::Description (class)">Description</a></span>.<span class='id identifier rubyid_new'><a href="Server/Description.html#new-class_method" title="Mongo::Server::Description.new (method)">new</a></span>(<span class='id identifier rubyid_address'><a href="#address-instance_method" title="Mongo::Server#address (method)">address</a></span><span class='comma'>,</span> <span class='id identifier rubyid_config'>config</span><span class='comma'>,</span>
    <span class='label'>load_balancer:</span> <span class='id identifier rubyid_load_balancer?'>load_balancer?</span><span class='comma'>,</span>
    <span class='label'>force_load_balancer:</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_connect'>connect</span>] <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_load_balanced'>load_balanced</span><span class='comma'>,</span>
  )
  <span class='id identifier rubyid_cluster'><a href="#cluster-instance_method" title="Mongo::Server#cluster (method)">cluster</a></span>.<span class='id identifier rubyid_run_sdam_flow'>run_sdam_flow</span>(<span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span><span class='comma'>,</span> <span class='id identifier rubyid_new_description'>new_description</span><span class='comma'>,</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Server#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="update_description-instance_method">
  <h3 class='signature nodoc'>
    #<strong>update_description</strong>(description)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L645-L651'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='645' data-end='651'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 645</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_update_description'>update_description</span>(<span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>)
  <span class='id identifier rubyid_pool'><a href="#pool-instance_method" title="Mongo::Server#pool (method)">pool</a></span> <span class='op'>=</span> <span class='id identifier rubyid_pool_internal'><a href="#pool_internal-instance_method" title="Mongo::Server#pool_internal (method)">pool_internal</a></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_pool'><a href="#pool-instance_method" title="Mongo::Server#pool (method)">pool</a></span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>.<span class='id identifier rubyid_unknown?'>unknown?</span>
    <span class='id identifier rubyid_pool'><a href="#pool-instance_method" title="Mongo::Server#pool (method)">pool</a></span>.<span class='id identifier rubyid_ready'>ready</span>
  <span class='kw'>end</span>
  <span class='ivar'>@description</span> <span class='op'>=</span> <span class='id identifier rubyid_description'><a href="#description-instance_method" title="Mongo::Server#description (method)">description</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="update_last_scan-instance_method">
  <h3 class='signature nodoc'>
    #<strong>update_last_scan</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L685-L688'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='685' data-end='688'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 685</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_update_last_scan'>update_last_scan</span>
  <span class='ivar'>@last_scan</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>
  <span class='ivar'>@last_scan_monotime</span> <span class='op'>=</span> <span class='const'><a href="Utils.html" title="Mongo::Utils (module)">Utils</a></span>.<span class='id identifier rubyid_monotonic_time'>monotonic_time</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="with_connection-instance_method">
  <h3 class='signature '>
    #<strong>with_connection</strong>(connection_global_id: nil, &amp;block)  &#x21d2; <code>Object</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Execute a block of code with a connection, that is checked out of the server’s pool and then checked back in.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Send a message with the connection.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_with_connection'>with_connection</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_connection'>connection</span><span class='op'>|</span>
  <span class='id identifier rubyid_connection'>connection</span>.<span class='id identifier rubyid_dispatch'>dispatch</span>([ <span class='id identifier rubyid_command'>command</span> ])
<span class='kw'>end</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Object</code>)</span>
&mdash;    <div class='inline'>
<p>The result of the block execution.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.3.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/server.rb#L493-L495'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='493' data-end='495'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/server.rb', line 493</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_with_connection'>with_connection</span>(<span class='label'>connection_global_id:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_pool'><a href="#pool-instance_method" title="Mongo::Server#pool (method)">pool</a></span>.<span class='id identifier rubyid_with_connection'>with_connection</span>(<span class='label'>connection_global_id:</span> <span class='id identifier rubyid_connection_global_id'>connection_global_id</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>