<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Mongo::Error::SdamErrorDetection &mdash; Mongo master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongo::Error::SdamErrorDetection",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Mongo master</a> &raquo; 
      <a href='../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../Mongo.html" title="Mongo (module)">Mongo</a> &raquo; 
        <a href="../Error.html" title="Mongo::Error (class)">Error</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>SdamErrorDetection&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Mongo::Error::SdamErrorDetection</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="OperationFailure.html" title="Mongo::Error::OperationFailure (class)"><code>OperationFailure</code></a>,
          <a href="OperationFailure/Family.html" title="Mongo::Error::OperationFailure::Family (module)"><code>OperationFailure::Family</code></a>,
          <a href="Parser.html" title="Mongo::Error::Parser (class)"><code>Parser</code></a>,
          <a href="ServerTimeoutError.html" title="Mongo::Error::ServerTimeoutError (class)"><code>ServerTimeoutError</code></a>
      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/error/sdam_error_detection.rb#L12'>lib/mongo/error/sdam_error_detection.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Although not_master? and node_recovering? methods of this module are part of the public API, the fact that these methods are defined on this module and not on the classes which include this module is not part of the public API.</p>
</div>
  </div>


  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='NODE_RECOVERING_CODES-constant' class='summary_signature nodoc'>NODE_RECOVERING_CODES =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/error/sdam_error_detection.rb#L18-L18'># File 'lib/mongo/error/sdam_error_detection.rb', line 18</a>    <pre class='code ruby'>[<span class='int'>11600</span><span class='comma'>,</span> <span class='int'>11602</span><span class='comma'>,</span> <span class='int'>13436</span><span class='comma'>,</span> <span class='int'>189</span><span class='comma'>,</span> <span class='int'>91</span><span class='comma'>,</span> <span class='int'>10058</span>].<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='NODE_SHUTTING_DOWN_CODES-constant' class='summary_signature nodoc'>NODE_SHUTTING_DOWN_CODES =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/error/sdam_error_detection.rb#L21-L21'># File 'lib/mongo/error/sdam_error_detection.rb', line 21</a>    <pre class='code ruby'>[<span class='int'>11600</span><span class='comma'>,</span> <span class='int'>91</span>].<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='NOT_MASTER_CODES-constant' class='summary_signature nodoc'>NOT_MASTER_CODES =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.0.0</p>
</div>
  </li>
</ul>

</div>
    <a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/error/sdam_error_detection.rb#L15-L15'># File 'lib/mongo/error/sdam_error_detection.rb', line 15</a>    <pre class='code ruby'>[<span class='int'>10107</span><span class='comma'>,</span> <span class='int'>13435</span>].<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#node_recovering%3F-instance_method" title="#node_recovering? (instance method)">#<strong>node_recovering?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the error is a “node is recovering” error, or one of its variants.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#node_shutting_down%3F-instance_method" title="#node_shutting_down? (instance method)">#<strong>node_shutting_down?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the error is a “node is shutting down” type error.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#not_master%3F-instance_method" title="#not_master? (instance method)">#<strong>not_master?</strong>  &#x21d2; true | false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the error is a “not master” error, or one of its variants.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->
<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="node_recovering?-instance_method">
  <h3 class='signature ro first'>
    #<strong>node_recovering?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the error is a “node is recovering” error, or one of its variants.</p>

<p>See <a href="https://github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.md#not-writable-primary-and-node-is-recovering">github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.md#not-writable-primary-and-node-is-recovering</a></p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the error is a node is recovering.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.8.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/error/sdam_error_detection.rb#L53-L65'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='53' data-end='65'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/error/sdam_error_detection.rb', line 53</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_node_recovering?'>node_recovering?</span>
  <span class='comment'># Require the error to be communicated at the top level of the response
</span>  <span class='comment'># for it to influence SDAM state. See DRIVERS-1376 / RUBY-2516.
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_document'>document</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_document'>document</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ok</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>==</span> <span class='int'>1</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_code'>code</span>
    <span class='const'><a href="#NODE_RECOVERING_CODES-constant" title="Mongo::Error::SdamErrorDetection::NODE_RECOVERING_CODES (constant)">NODE_RECOVERING_CODES</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_code'>code</span>)
  <span class='kw'>elsif</span> <span class='id identifier rubyid_message'>message</span>
    <span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>node is recovering</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>not master or secondary</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>else</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="node_shutting_down?-instance_method">
  <h3 class='signature ro'>
    #<strong>node_shutting_down?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the error is a “node is shutting down” type error.</p>

<p>See <a href="https://github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.md#not-writable-primary-and-node-is-recovering">github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.md#not-writable-primary-and-node-is-recovering</a></p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the error is a node is shutting down.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.9.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/error/sdam_error_detection.rb#L74-L80'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='74' data-end='80'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/error/sdam_error_detection.rb', line 74</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_node_shutting_down?'>node_shutting_down?</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_code'>code</span> <span class='op'>&amp;&amp;</span> <span class='const'><a href="#NODE_SHUTTING_DOWN_CODES-constant" title="Mongo::Error::SdamErrorDetection::NODE_SHUTTING_DOWN_CODES (constant)">NODE_SHUTTING_DOWN_CODES</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_code'>code</span>)
    <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="not_master?-instance_method">
  <h3 class='signature ro'>
    #<strong>not_master?</strong>  &#x21d2; <code>true</code> | <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the error is a “not master” error, or one of its variants.</p>

<p>See <a href="https://github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.md#not-writable-primary-and-node-is-recovering">github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.md#not-writable-primary-and-node-is-recovering</a></p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code> | <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>Whether the error is a not master.</p>
</div>
  </li>
</ul>
<p class='tag_title'>Since:</p>
<ul class='since'>
  <li>
    <div class='inline'>
<p>2.8.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/error/sdam_error_detection.rb#L30-L44'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='30' data-end='44'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/error/sdam_error_detection.rb', line 30</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_not_master?'>not_master?</span>
  <span class='comment'># Require the error to be communicated at the top level of the response
</span>  <span class='comment'># for it to influence SDAM state. See DRIVERS-1376 / RUBY-2516.
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_document'>document</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_document'>document</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ok</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>==</span> <span class='int'>1</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_node_recovering?'><a href="#node_recovering%3F-instance_method" title="Mongo::Error::SdamErrorDetection#node_recovering? (method)">node_recovering?</a></span>
    <span class='kw'>false</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_code'>code</span>
    <span class='const'><a href="#NOT_MASTER_CODES-constant" title="Mongo::Error::SdamErrorDetection::NOT_MASTER_CODES (constant)">NOT_MASTER_CODES</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_code'>code</span>)
  <span class='kw'>elsif</span> <span class='id identifier rubyid_message'>message</span>
    <span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>not master</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>else</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>