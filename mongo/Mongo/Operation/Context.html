<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Mongo::Operation::Context &mdash; Mongo master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Mongo::Operation::Context",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Mongo master</a> &raquo; 
      <a href='../../_index.html#alpha_C'>Index (C)</a> &raquo; 
        <a href="../../Mongo.html" title="Mongo (module)">Mongo</a> &raquo; 
        <a class='nodoc' href="../Operation.html" title="Mongo::Operation (module)">Operation</a> &raquo; 
      <span class='title'><a class='nodoc' id='t2_doc_top' href='#'>Context&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Mongo::Operation::Context  <span class='private note title'>Private</span>
</h1>
  <div class='note nodoc inline-block'>
    <strong>Do not use.  This class is for internal use only.</strong>
  </div>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="../CsotTimeoutHolder.html" title="Mongo::CsotTimeoutHolder (class)"><code>::Mongo::CsotTimeoutHolder</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="../CsotTimeoutHolder.html" title="Mongo::CsotTimeoutHolder (class)"><code>::Mongo::CsotTimeoutHolder</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../CsotTimeoutHolder.html" title="Mongo::CsotTimeoutHolder (class)">Mongo::CsotTimeoutHolder</a></span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'><a href="../CsotTimeoutHolder.html" title="Mongo::CsotTimeoutHolder (class)">Mongo::CsotTimeoutHolder</a></li>
          <li class='next'>Mongo::Operation::Context</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L37'>lib/mongo/operation/context.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>Context</code> for operations.</p>

<p>Holds various objects needed to make decisions about operation execution in a single container, and provides facade methods for the contained objects.</p>

<p>The context contains parameters for operations, and as such while an operation is being prepared nothing in the context should change. When the result of the operation is being processed, the data returned by the context may change (for example, because a transaction is aborted), but at that point the operation should no longer read anything from the context. Because context data may change during operation execution, context objects should not be reused for multiple operations.</p>

  </div>
</div>
<div class='tags'>
  
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(client: nil, session: nil, connection_global_id: nil, operation_timeouts: {}, view: nil, options: nil)  &#x21d2; Context </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="../CsotTimeoutHolder.html" title="Mongo::CsotTimeoutHolder (class)"><code>::Mongo::CsotTimeoutHolder</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="../CsotTimeoutHolder.html#new-class_method" title="Mongo::CsotTimeoutHolder.new (method)">.new</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#aborting_transaction%3F-instance_method" title="#aborting_transaction? (instance method)">#<strong>aborting_transaction?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#any_retry_writes%3F-instance_method" title="#any_retry_writes? (instance method)">#<strong>any_retry_writes?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#client-instance_method" title="#client (instance method)">#<strong>client</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#committing_transaction%3F-instance_method" title="#committing_transaction? (instance method)">#<strong>committing_transaction?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#decrypt%3F-instance_method" title="#decrypt? (instance method)">#<strong>decrypt?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#encrypt%3F-instance_method" title="#encrypt? (instance method)">#<strong>encrypt?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#in_transaction%3F-instance_method" title="#in_transaction? (instance method)">#<strong>in_transaction?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#legacy_retry_writes%3F-instance_method" title="#legacy_retry_writes? (instance method)">#<strong>legacy_retry_writes?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#modern_retry_writes%3F-instance_method" title="#modern_retry_writes? (instance method)">#<strong>modern_retry_writes?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#retry%3F-instance_method" title="#retry? (instance method)">#<strong>retry?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether the operation is a retry (true) or an initial attempt (false).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#session-instance_method" title="#session (instance method)">#<strong>session</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#starting_transaction%3F-instance_method" title="#starting_transaction? (instance method)">#<strong>starting_transaction?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#view-instance_method" title="#view (instance method)">#<strong>view</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="../CsotTimeoutHolder.html" title="Mongo::CsotTimeoutHolder (class)"><code>::Mongo::CsotTimeoutHolder</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro nodoc' href="../CsotTimeoutHolder.html#csot%3F-instance_method" title="Mongo::CsotTimeoutHolder#csot? (method)">#csot?</a>,
        <a class='i_m ro nodoc' href="../CsotTimeoutHolder.html#deadline-instance_method" title="Mongo::CsotTimeoutHolder#deadline (method)">#deadline</a>,
        <a class='i_m ro nodoc' href="../CsotTimeoutHolder.html#operation_timeouts-instance_method" title="Mongo::CsotTimeoutHolder#operation_timeouts (method)">#operation_timeouts</a>,
        <a class='i_m ro nodoc' href="../CsotTimeoutHolder.html#timeout%3F-instance_method" title="Mongo::CsotTimeoutHolder#timeout? (method)">#timeout?</a>,
        <a class='i_m ro nodoc' href="../CsotTimeoutHolder.html#timeout_expired%3F-instance_method" title="Mongo::CsotTimeoutHolder#timeout_expired? (method)">#timeout_expired?</a>,
        <a class='i_m ro nodoc' href="../CsotTimeoutHolder.html#timeout_sec-instance_method" title="Mongo::CsotTimeoutHolder#timeout_sec (method)">#timeout_sec</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#connection_global_id-instance_method" title="#connection_global_id (instance method)">#<strong>connection_global_id</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#decrypt-instance_method" title="#decrypt (instance method)">#<strong>decrypt</strong>(cmd)  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#encrypt-instance_method" title="#encrypt (instance method)">#<strong>encrypt</strong>(db_name, cmd)  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#encrypter-instance_method" title="#encrypter (instance method)">#<strong>encrypter</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#refresh-instance_method" title="#refresh (instance method)">#<strong>refresh</strong>(connection_global_id: @connection_global_id, timeout_ms: nil, view: nil)  &#x21d2; Operation::Context </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a new <code>Context</code> with the deadline refreshed and relative to the current moment.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#server_api-instance_method" title="#server_api (instance method)">#<strong>server_api</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#with-instance_method" title="#with (instance method)">#<strong>with</strong>(**opts)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a new context with the parameters changed as per the provided arguments.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="../CsotTimeoutHolder.html" title="Mongo::CsotTimeoutHolder (class)"><code>::Mongo::CsotTimeoutHolder</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="../CsotTimeoutHolder.html#check_timeout!-instance_method" title="Mongo::CsotTimeoutHolder#check_timeout! (method)">#check_timeout!</a></td>
      <td><div class='inline'><p>Check whether the operation timeout expired, and raises an appropriate error if yes.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="../CsotTimeoutHolder.html#remaining_timeout_ms-instance_method" title="Mongo::CsotTimeoutHolder#remaining_timeout_ms (method)">#remaining_timeout_ms</a>,
        <a class='i_m nodoc' href="../CsotTimeoutHolder.html#remaining_timeout_ms!-instance_method" title="Mongo::CsotTimeoutHolder#remaining_timeout_ms! (method)">#remaining_timeout_ms!</a>,
        <a class='i_m nodoc' href="../CsotTimeoutHolder.html#remaining_timeout_sec-instance_method" title="Mongo::CsotTimeoutHolder#remaining_timeout_sec (method)">#remaining_timeout_sec</a>,
        <a class='i_m nodoc' href="../CsotTimeoutHolder.html#remaining_timeout_sec!-instance_method" title="Mongo::CsotTimeoutHolder#remaining_timeout_sec! (method)">#remaining_timeout_sec!</a>,
        <a class='i_m priv nodoc' href="../CsotTimeoutHolder.html#calculate_deadline-instance_method" title="Mongo::CsotTimeoutHolder#calculate_deadline (method)">#calculate_deadline</a>,
        <a class='i_m priv nodoc' href="../CsotTimeoutHolder.html#calculate_deadline_from_timeout_ms-instance_method" title="Mongo::CsotTimeoutHolder#calculate_deadline_from_timeout_ms (method)">#calculate_deadline_from_timeout_ms</a>,
        <a class='i_m priv nodoc' href="../CsotTimeoutHolder.html#check_no_override_inside_transaction!-instance_method" title="Mongo::CsotTimeoutHolder#check_no_override_inside_transaction! (method)">#check_no_override_inside_transaction!</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="aborting_transaction?-instance_method">
  <h3 class='signature ro  nodoc first'>
    #<strong>aborting_transaction?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L105-L107'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='105' data-end='107'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 105</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_aborting_transaction?'>aborting_transaction?</span>
  <span class='id identifier rubyid_in_transaction?'><a href="#in_transaction%3F-instance_method" title="Mongo::Operation::Context#in_transaction? (method)">in_transaction?</a></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_session'><a href="#session-instance_method" title="Mongo::Operation::Context#session (method)">session</a></span>.<span class='id identifier rubyid_aborting_transaction?'>aborting_transaction?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="any_retry_writes?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>any_retry_writes?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L117-L119'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='117' data-end='119'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 117</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_any_retry_writes?'>any_retry_writes?</span>
  <span class='id identifier rubyid_modern_retry_writes?'><a href="#modern_retry_writes%3F-instance_method" title="Mongo::Operation::Context#modern_retry_writes? (method)">modern_retry_writes?</a></span> <span class='op'>||</span> <span class='id identifier rubyid_legacy_retry_writes?'><a href="#legacy_retry_writes%3F-instance_method" title="Mongo::Operation::Context#legacy_retry_writes? (method)">legacy_retry_writes?</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>client</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L68-L68'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='68' data-end='68'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 68</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_client'>client</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="committing_transaction?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>committing_transaction?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L101-L103'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='101' data-end='103'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 101</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_committing_transaction?'>committing_transaction?</span>
  <span class='id identifier rubyid_in_transaction?'><a href="#in_transaction%3F-instance_method" title="Mongo::Operation::Context#in_transaction? (method)">in_transaction?</a></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_session'><a href="#session-instance_method" title="Mongo::Operation::Context#session (method)">session</a></span>.<span class='id identifier rubyid_committing_transaction?'>committing_transaction?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="decrypt?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>decrypt?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L155-L157'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='155' data-end='157'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 155</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_decrypt?'>decrypt?</span>
  <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_encrypter'><a href="#encrypter-instance_method" title="Mongo::Operation::Context#encrypter (method)">encrypter</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="encrypt?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>encrypt?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L147-L149'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='147' data-end='149'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 147</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_encrypt?'>encrypt?</span>
  <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_encrypter'><a href="#encrypter-instance_method" title="Mongo::Operation::Context#encrypter (method)">encrypter</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_encrypt?'>encrypt?</span> <span class='op'>||</span> <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="in_transaction?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>in_transaction?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L93-L95'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='93' data-end='95'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 93</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_in_transaction?'>in_transaction?</span>
  <span class='id identifier rubyid_session'><a href="#session-instance_method" title="Mongo::Operation::Context#session (method)">session</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_in_transaction?'>in_transaction?</span> <span class='op'>||</span> <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="legacy_retry_writes?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>legacy_retry_writes?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L113-L115'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='113' data-end='115'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 113</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_legacy_retry_writes?'>legacy_retry_writes?</span>
  <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Operation::Context#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_retry_writes'>retry_writes</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span>.<span class='id identifier rubyid_max_write_retries'>max_write_retries</span> <span class='op'>&gt;</span> <span class='int'>0</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="modern_retry_writes?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>modern_retry_writes?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L109-L111'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='109' data-end='111'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 109</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_modern_retry_writes?'>modern_retry_writes?</span>
  <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Operation::Context#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_retry_writes'>retry_writes</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="options-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>options</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L71-L71'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='71' data-end='71'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 71</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_options'>options</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="retry?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>retry?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether the operation is a retry (true) or an initial attempt (false).</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L130-L132'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='130' data-end='132'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 130</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_retry?'>retry?</span>
  <span class='op'>!</span><span class='op'>!</span><span class='ivar'>@is_retry</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>session</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L69-L69'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='69' data-end='69'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 69</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_session'>session</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="starting_transaction?-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>starting_transaction?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L97-L99'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='97' data-end='99'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 97</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_starting_transaction?'>starting_transaction?</span>
  <span class='id identifier rubyid_session'><a href="#session-instance_method" title="Mongo::Operation::Context#session (method)">session</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_starting_transaction?'>starting_transaction?</span> <span class='op'>||</span> <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="view-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>view</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L70-L70'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='70' data-end='70'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 70</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_view'>view</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="connection_global_id-instance_method">
  <h3 class='signature nodoc first'>
    #<strong>connection_global_id</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L89-L91'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='89' data-end='91'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 89</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_global_id'>connection_global_id</span>
  <span class='ivar'>@connection_global_id</span> <span class='op'>||</span> <span class='id identifier rubyid_session'><a href="#session-instance_method" title="Mongo::Operation::Context#session (method)">session</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_pinned_connection_global_id'>pinned_connection_global_id</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="decrypt-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>decrypt</strong>(cmd)   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L159-L161'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='159' data-end='161'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 159</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_decrypt'>decrypt</span>(<span class='id identifier rubyid_cmd'>cmd</span>)
  <span class='id identifier rubyid_encrypter'><a href="#encrypter-instance_method" title="Mongo::Operation::Context#encrypter (method)">encrypter</a></span>.<span class='id identifier rubyid_decrypt'>decrypt</span>(<span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='kw'>self</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="encrypt-instance_method">
  <h3 class='signature ro  nodoc'>
    #<strong>encrypt</strong>(db_name, cmd)   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L151-L153'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='151' data-end='153'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 151</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_encrypt'>encrypt</span>(<span class='id identifier rubyid_db_name'>db_name</span><span class='comma'>,</span> <span class='id identifier rubyid_cmd'>cmd</span>)
  <span class='id identifier rubyid_encrypter'><a href="#encrypter-instance_method" title="Mongo::Operation::Context#encrypter (method)">encrypter</a></span>.<span class='id identifier rubyid_encrypt'>encrypt</span>(<span class='id identifier rubyid_db_name'>db_name</span><span class='comma'>,</span> <span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='kw'>self</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="encrypter-instance_method">
  <h3 class='signature nodoc'>
    #<strong>encrypter</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L163-L169'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='163' data-end='169'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 163</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_encrypter'>encrypter</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_encrypter'>encrypter</span>
    <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span>.<span class='id identifier rubyid_encrypter'>encrypter</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span><span class='op'>::</span><span class='const'><a href="../Error/InternalDriverError.html" title="Mongo::Error::InternalDriverError (class)">InternalDriverError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Encrypter should only be accessed when encryption is to be performed</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature nodoc'>
    #<strong>inspect</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L171-L173'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='171' data-end='173'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 171</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'> connection_global_id=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection_global_id'><a href="#connection_global_id-instance_method" title="Mongo::Operation::Context#connection_global_id (method)">connection_global_id</a></span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> deadline=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_deadline'>deadline</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> options=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Operation::Context#options (method)">options</a></span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> operation_timeouts=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_operation_timeouts'>operation_timeouts</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="refresh-instance_method">
  <h3 class='signature nodoc'>
    #<strong>refresh</strong>(connection_global_id: @connection_global_id, timeout_ms: nil, view: nil)  &#x21d2; <a href="" title="Mongo::Operation::Context (class)">Operation::Context</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a new <code>Context</code> with the deadline refreshed and relative to the current moment.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="" title="Mongo::Operation::Context (class)">Operation::Context</a>)</span>
&mdash;    <div class='inline'>
<p>the refreshed context</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L77-L87'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='77' data-end='87'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 77</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>(<span class='label'>connection_global_id:</span> <span class='ivar'>@connection_global_id</span><span class='comma'>,</span> <span class='label'>timeout_ms:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>view:</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_operation_timeouts'>operation_timeouts</span> <span class='op'>=</span> <span class='ivar'>@operation_timeouts</span>
  <span class='id identifier rubyid_operation_timeouts'>operation_timeouts</span> <span class='op'>=</span> <span class='id identifier rubyid_operation_timeouts'>operation_timeouts</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>operation_timeout_ms:</span> <span class='id identifier rubyid_timeout_ms'>timeout_ms</span>) <span class='kw'>if</span> <span class='id identifier rubyid_timeout_ms'>timeout_ms</span>

  <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Mongo::Operation::Context.new (method)">new</a></span>(<span class='label'>client:</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span><span class='comma'>,</span>
                 <span class='label'>session:</span> <span class='id identifier rubyid_session'><a href="#session-instance_method" title="Mongo::Operation::Context#session (method)">session</a></span><span class='comma'>,</span>
                 <span class='label'>connection_global_id:</span> <span class='id identifier rubyid_connection_global_id'><a href="#connection_global_id-instance_method" title="Mongo::Operation::Context#connection_global_id (method)">connection_global_id</a></span><span class='comma'>,</span>
                 <span class='label'>operation_timeouts:</span> <span class='id identifier rubyid_operation_timeouts'>operation_timeouts</span><span class='comma'>,</span>
                 <span class='label'>view:</span> <span class='id identifier rubyid_view'><a href="#view-instance_method" title="Mongo::Operation::Context#view (method)">view</a></span> <span class='op'>||</span> <span class='kw'>self</span>.<span class='id identifier rubyid_view'><a href="#view-instance_method" title="Mongo::Operation::Context#view (method)">view</a></span><span class='comma'>,</span>
                 <span class='label'>options:</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Operation::Context#options (method)">options</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_api-instance_method">
  <h3 class='signature nodoc'>
    #<strong>server_api</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L121-L127'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='121' data-end='127'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 121</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_server_api'>server_api</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span>
    <span class='id identifier rubyid_client'><a href="#client-instance_method" title="Mongo::Operation::Context#client (method)">client</a></span>.<span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Operation::Context#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_server_api'>server_api</span>]
  <span class='kw'>elsif</span> <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Operation::Context#options (method)">options</a></span>
    <span class='id identifier rubyid_options'><a href="#options-instance_method" title="Mongo::Operation::Context#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_server_api'>server_api</span>]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="with-instance_method">
  <h3 class='signature nodoc'>
    #<strong>with</strong>(**opts)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a new context with the parameters changed as per the provided arguments.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>opts</span>
    <span class='type'>(<code>Hash</code>)</span>
&mdash;    <div class='inline'>
<p>a customizable set of options</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>**opts</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:is_retry</span>
          <span class='type'>(<code>true</code>|<code>false</code>)</span>
            &mdash; <div class='inline'>
<p>Whether the operation is a retry or a first attempt.</p>
</div>        </li>
    </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/operation/context.rb#L139-L145'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='139' data-end='145'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/mongo/operation/context.rb', line 139</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_with'>with</span>(<span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span>)
  <span class='id identifier rubyid_dup'>dup</span>.<span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_copy'>copy</span><span class='op'>|</span>
    <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='id identifier rubyid_copy'>copy</span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>