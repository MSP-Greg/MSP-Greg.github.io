<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: ChangeLog &mdash; Ruby-2.4.0</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../css/common.css' />

<script type='text/javascript'>
  var pathId = "ChangeLog",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../index.html'>Home</a> &raquo; 
          <a href='index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='_index.html'>Index</a> &raquo; 
          <span class='title'>File: ChangeLog</span>
                </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="file_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='file'>

<p>Mon Aug  1 12:16:19 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* ext/json/*, test/json/json_parser_test.rb: Update json-2.0.2.</p>

<p>Sun Jul 31 16:17:23 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/win32/resolv/resolv.c (get_dns_server_list): [Win32] get DNS 	 
servers only for connected network devices by GetNetworkParams 	  API. 
[Bug #12604]</p>

<p>Sat Jul 30 12:13:26 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c (String#downcase), NEWS: Mentioned that case mapping for all 	 
of ISO-8859-1~16 is now supported. [ci skip]</p>

<p>Sat Jul 30 12:00:01 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_2.c, test/ruby/enc/test_case_comprehensive.rb: 	  Implement
non-ASCII case conversion for ISO-8859-2, by Yushiro Ishii.</p>

<p>Fri Jul 29 20:57:12 2016  chuanshuo  &lt;lilijreey@126.com&gt;</p>

<p>* *.c: rename rb_funcall2 to rb_funcallv, except for extensions 	  which
are/will be/may be gems.  [Fix GH-1406]</p>

<p>Fri Jul 29 10:51:34 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* proc.c (env_write): remove unused function.</p>

<p>Fri Jul 29 10:49:52 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h (VM_LOCAL_P): should return an integer value. 	  reported at 	
<a
href="http://d.hatena.ne.jp/nagachika/20160728/ruby_trunk_changes_55764_55770">d.hatena.ne.jp/nagachika/20160728/ruby_trunk_changes_55764_55770</a></p>

<p>Fri Jul 29 04:23:08 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h (VM_ENV_LOCAL_P): return truthy (0 or not) value.</p>

<p>* vm.c (rb_vm_make_proc_lambda): use VM_ENV_ESCAPED_P() macro.</p>

<p>Fri Jul 29 03:49:04 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c, internal.h: remove RubyVM::Env class and all of env objects 	  are
imemo objects (imemo_env).</p>

<p>* NEWS: describe this change. I believe nobody touch these objects 	 
because there are no method defined.</p>

<p>* vm_core.h: remove the following definitions. 	  * rb_cEnv decl. 	  *
GetEnvPtr() because Env is no longer T_DATA object.</p>

<p>* vm_core.h (rb_env_t): fix layout for imemo values.</p>

<p>* vm_core.h (vm_assert_env): added.</p>

<p>* vm_core.h (vm_env_new): added.</p>

<p>Thu Jul 28 19:53:21 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_core.h: revisit the structure of frame, block and env. 	  [Bug
#12628]</p>

<p>This patch introduce many changes.</p>

<p>* Introduce concept of “Block Handler (BH)” to represent 	    passed
blocks.</p>

<p>* move rb_control_frame_t::flag to <a href="0">ep</a> (as a special
local 	    variable). This flags represents not only frame type, but also 	
env flags such as escaped.</p>

<p>* rename `rb_block_t` to `struct rb_block`.</p>

<p>* Make Proc, Binding and RubyVM::Env objects wb-protected.</p>

<p>Check [Bug #12628] for more details.</p>

<p>Thu Jul 28 15:05:12 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (ruby_fl_type): use __extension__ to get rid 	  of
pedantic warning against RUBY_FL_USER19. 	  <a
href="https://github.com/skylightio/skylight-ruby/issues/64">github.com/skylightio/skylight-ruby/issues/64</a></p>

<p>* include/ruby/ruby.h (rb_mul_size_overflow): ditto for use of 	  int128.</p>

<p>Wed Jul 27 10:32:59 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/windows_1253.c: Remove dead code found by Coverity Scan.</p>

<p>Tue Jul 26 22:43:36 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (run_finalizer): make saved running finalizer state 	  volatile to
ensure not to be clobbered by longjmp.</p>

<p>Tue Jul 26 19:26:00 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_insnhelper.c: introduce rb_vm_pop_frame() and use it 	  instead of
setting rb_thread_t::cfp directly.</p>

<p>* vm_insnhelper.c (vm_pop_frame): return the result of 	  finish frame or
not.</p>

<p>Tue Jul 26 19:06:39 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (rb_raw_obj_info): support to show Proc obj.</p>

<p>Tue Jul 26 18:55:55 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (gc_mark): add `inline&#39; explicitly. 	  I expected to inline
this function implicitly at the loop 	  (ex: marking T_ARRAY objects) but
sometimes it remains as 	  normal call.</p>

<p>Tue Jul 26 16:33:16 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/windows_1257.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for Windows-1257, by Sho Koike.</p>

<p>Tue Jul 26 16:19:41 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/windows_1250.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for Windows-1250, by Sho Koike.</p>

<p>* ChangeLog: Fixed order of previous two entries.</p>

<p>Tue Jul 26 15:54:17 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/windows_1253.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for Windows-1253, by Takumi Koyama.</p>

<p>Tue Jul 26 15:30:37 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/windows_1251.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for Windows-1251, by Shunsuke Sato.</p>

<p>Tue Jul 26 13:04:59 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Add explicit skip test for 	 
availability of Unicode data files.</p>

<p>Mon Jul 25 21:33:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* range.c (check_step_domain): check step argument domain by &lt;=&gt; 	 
method, instead of &lt; and &gt;.</p>

<p>Mon Jul 25 21:11:32 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* doc/maintainers.rdoc: fix filenames.</p>

<p>Mon Jul 25 16:59:00 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* debug.c (ruby_debug_printf): use rb_raw_obj_info() 	  instead of
rb_inspect() because it is more robust way 	  to see object internal.</p>

<p>Sun Jul 24 16:33:13 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* regenc.h/c, include/ruby/oniguruma.h, enc/ascii.c, big5.c, cp949.c, 	 
emacs_mule.c, euc_jp.c, euc_kr.c, euc_tw.c, gb18030.c, gbk.c, 	 
iso_8859_1|2|3|4|5|6|7|8|9|10|11|13|14|15|16.c, koi8_r.c, koi8_u.c, 	 
shift_jis.c, unicode.c, us_ascii.c, utf_16|32be|le.c, utf_8.c, 	 
windows_1250|51|52|53|54|57.c, windows_31j.c, unicode.c: 	  Remove
conditional compilation macro ONIG_CASE_MAPPING. [Feature #12386].</p>

<p>Sun Jul 24 12:53:42 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/maintainers.rdoc: xmlrpc is bundled gem from Ruby 2.4.</p>

<p>Sun Jul 24 12:07:39 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/maintainers.rdoc: Update OpenSSL maintainer.</p>

<p>Sat Jul 23 22:43:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h (Check_Type): inline check for the object type.</p>

<p>Sat Jul 23 04:06:04 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RTEST, NIL_P): use RUBY prefixed name in 	  macros.</p>

<p>Sat Jul 23 01:41:29 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* lib/webrick/httpservlet/cgihandler.rb (do_GET): delete HTTP_PROXY 	*
test/webrick/test_cgi.rb (test_cgi_env): new test 	*
test/webrick/webrick.cgi (do_GET): new endpoint to dump env 	 
[ruby-core:76511] [Bug #12610]</p>

<p>Fri Jul 22 19:55:20 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm.c (vm_set_main_stack): remove unnecessary check.  toplevel 	  binding
must be initialized.  [Bug #12611] (N1)</p>

<p>* win32/win32.c (w32_symlink): fix return type.  [Bug #12611] (N3)</p>

<p>* string.c (rb_str_split_m): simplify the condition. 	  [Bug #12611](N4)</p>

<p>Fri Jul 22 17:13:37 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c (String#dump): Change escaping of non-ASCII characters in 	 
UTF-8 to use upper-case four-digit hexadecimal escapes without braces 	 
where possible [Feature #12419].</p>

<p>* test/ruby/test_string.rb (test_dump): Add tests for above.</p>

<p>Fri Jul 22 10:35:35 2016  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/rexml/attribute.rb (REXML::Attribute#to_string): Fix wrong 	  entry
reference name of double quote. 	  [Bug #<a
href="ruby-core:76509">12609]</a> 	  Patch by Joseph Marrero. Thanks!!!</p>

<p>Fri Jul 22 10:32:13 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* template/unicode_norm_gen.tmpl: Remove 	 
UnicodeNormalize::UNICODE_VERSION at origin [Feature #12546].</p>

<p>Fri Jul 22 09:23:51 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* LEGAL: Added entries for files under the USD license. 	  [Bug #<a
href="ruby-core:76428">12598]</a>[ci skip]</p>

<p>Fri Jul 22 09:19:57 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* LEGAL: Added entry for
`lib/rdoc/generator/template/darkfish/css/fonts.css` 	  [Misc #<a
href="ruby-core:76255">12550]</a>[ci skip]</p>

<p>Fri Jul 22 06:28:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (run_finalizer): push and exec tag just once, instead of 	 
protecting for each finalizer.</p>

<p>* gc.c (gc_start_internal, rb_gc_start): set finalizing flag 	  whenever
calling deferred finalizers not to recurse.</p>

<p>Thu Jul 21 22:26:40 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* missing/strl<code>cat,cpy</code>.c: Update latest upstream files. 	  [Misc #<a
href="ruby-core:74487">12205]</a> 	* LEGAL: Update license for
missing/strl<code>cat,cpy</code>.c.</p>

<p>Thu Jul 21 21:53:30 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* LEGAL: added file list with Public domain license. 	 
[ruby-core:76254][Bug #12549]</p>

<p>Wed Jul 20 17:44:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enumerator.c (lazy_uniq): new method Enumerator::Lazy#uniq. 	  [Feature
#11090]</p>

<p>* enum.c (enum_uniq): new method Enumerable#uniq. 	  [Feature #11090]</p>

<p>Wed Jul 20 17:35:23 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (rb_hash_add_new_element): add new element or do nothing 	  if it
is contained already.</p>

<p>* array.c (ary_add_hash, ary_add_hash_by): use 	  rb_hash_add_new_element.</p>

<p>Tue Jul 19 18:21:17 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* lib/unicode_normalize/tables.rb: Remove 	 
UnicodeNormalize::UNICODE_VERSION (#12546).</p>

<p>Tue Jul 19 15:38:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (rb_local_constants_i): exclude private constants 	  when
excluding inherited constants too.  [Bug #12345]</p>

<p>Sun Jul 17 23:42:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (num_finite_p, num_infinite_p): Add Numeric#finite? and 	 
Numeric#infinite?  [Feature #12039] [ruby-core:73618]</p>

<p>* complex.c (rb_complex_finite_p): Add Complex#finite?</p>

<p>* complex.c (rb_complex_infinite_p): Add Complex#infinite?</p>

<p>* test/ruby/test_bignum.rb: Add test for Integer#finite? and 	 
Integer#infinite?</p>

<p>* test/ruby/test_fixnum.rb: ditto.</p>

<p>* test/ruby/test_rational.rb: Add test for Rational#finite? and 	 
Rational#infinite?</p>

<p>* test/ruby/test_complex.rb: Add test for Complex#finite? and 	 
Complex#infinite?</p>

<p>Sun Jul 17 20:59:24 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk, enc/depend (casefold.h, name2ctype.h): move to 	  unicode
data directory per version.</p>

<p>Sat Jul 16 06:26:00 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk, enc/Makefile.in: moved timestamp files for 	  directories
under the specific directory, to get rid of match 	  with files under the
source directory.</p>

<p>Fri Jul 15 22:05:13 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c (str_buf_cat): Fix potential integer overflow of capa. 	  In
addition, termlen is used instead of +1.</p>

<p>Fri Jul 15 21:30:38 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c (str_buf_cat): Fix capa size for embed string. 	  Fix bug in
r55547. [Bug #12536]</p>

<p>Fri Jul 15 18:13:15 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* gems/bundled_gems: update latest gems.</p>

<p>Fri Jul 15 17:08:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (ruby_strtod): do not underflow only by preceeding zeros, 	 
which may be canceled out by the exponent. 	  <a
href="http://twitter.com/kazuho/status/753829998767714305">twitter.com/kazuho/status/753829998767714305</a></p>

<p>Fri Jul 15 09:53:48 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/unicode/case-folding.rb, tool/enc-unicode.rb: check if 	  Unicode
versions are consistent with each other.</p>

<p>Fri Jul 15 08:25:15 2016  Jeremy Evans &lt;code@jeremyevans.net&gt;</p>

<p>* string.c (STR_BUF_MIN_SIZE): reduce from 128 to 127 	  [ruby-core:76371]
[Feature #12025] 	* string.c (rb_str_buf_new): adjust for above reduction</p>

<p>Thu Jul 14 17:26:00 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (enc/unicode/name2ctype.h): remove stale recipe, 	  which
did not support Unicode age properties.</p>

<p>* common.mk (enc/unicode/name2ctype.h): update by –header option 	  of
tool/enc-unicode.rb.  enc/unicode/name2ctype.kwd file has not 	  been used.</p>

<p>* common.mk (enc/unicode/name2ctype.kwd): rule to create from 	  Unicode
data files, used only when the target does not exist.</p>

<p>Thu Jul 14 13:10:54 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/json/lib/json/ext: remove stale directory.  bundled 	  extension
libraries are placed under the directory for each 	  architectures, but not
mixed with plain text script libraries.</p>

<p>Thu Jul 14 12:48:47 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* ext/json/*<strong>/</strong>.rb: merge original files from upstream
repository. 	  It only fixes styles of frozen string literal.</p>

<p>Wed Jul 13 22:23:03 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/json/json_common_interface_test.rb: use assert_raise instead of 	 
assert_raises.</p>

<p>Wed Jul 13 22:14:23 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/lib/test/unit.rb: added test files with `_test` suffix for json 	 
upstream. 	* test/json: merge original test files from json upstream.</p>

<p>Wed Jul 13 18:09:42 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_9.c, test/ruby/enc/test_case_comprehensive.rb: 	  Implement
non-ASCII case conversion for ISO-8859-9, by Kazuki Iijima.</p>

<p>* enc/iso_8859_9.c: Exclude dotless i/I with dot from case-insensitive 	 
matching because they are not a case pair.</p>

<p>* test/ruby/enc/test_iso_8859.rb: Make test coverage for ISO-8859-9 	  a
bit more complete.</p>

<p>Wed Jul 13 17:21:24 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/windows_1252.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for Windows-1252, by Serina Tai.</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Fix order of encodings.</p>

<p>Wed Jul 13 16:19:14 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_7.c, test/ruby/enc/test_case_comprehensive.rb: 	  Implement
non-ASCII case conversion for ISO-8859-7, by Kosuke Kurihara.</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Fix order of encodings.</p>

<p>Wed Jul 13 16:08:08 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (gc_mark_roots): should mark the VM object itself to mark 	 
singleton class of the VM object. 	  Before this patch, we only set mark
bit for the VM object and 	  invoke mark function separately. 	  [Bug
#12583]</p>

<p>* test/ruby/test_gc.rb: add a test.</p>

<p>Wed Jul 13 15:59:59 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* math.c (_USE_MATH_DEFINES): it must be set before including internal.h 	
because internal.h includes ruby.h, ruby.h includes win32.h, and 	  win32.h
includes system&#39;s math.h. 	  this change is to get rid of a compiler
warning (redefinition of 	  a macro) introduced at r55641.</p>

<p>Wed Jul 13 15:19:03 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_1.c, enc/iso_8859_4.c: Avoid setting modification flag if 	
there is no modification.</p>

<p>Wed Jul 13 14:40:04 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_5.c, test/ruby/enc/test_case_comprehensive.rb: 	  Implement
non-ASCII case conversion for ISO-8859-5, by Masaru Onodera.</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Fix order of encodings.</p>

<p>Wed Jul 13 14:28:33 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* math.c (rb_math_sqrt): r55646 must use f_signbit.</p>

<p>Wed Jul 13 14:22:50 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* iseq.c (Init_ISeq): undef ISeq.translate and ISeq.load_iseq 	  to
prevent calling super classes&#39; methods.</p>

<p>Without this patch, you can write workaround like:</p>

<p>class &lt;&lt; RubyVM::InstructionSequence 	      def translate; end 	
undef translate 	    end</p>

<p>* test/ruby/test_iseq.rb: add a test.</p>

<p>Wed Jul 13 14:16:03 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_method.c (method_entry_get_without_cache): check 	  undefined method
even if ruby_running is FALSE.</p>

<p>We haven&#39;t call “undef”ed methods before ruby_running. 	  So that
this issue does not make troubles.</p>

<p>Wed Jul 13 14:15:22 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/windows_1254.c: Adjust variable/macro names.</p>

<p>Wed Jul 13 13:19:12 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_9.c, enc/windows_1254.c: Split Windows-1254 from 	 
ISO-8859-9 to be able to implement different case conversions.</p>

<p>Wed Jul 13 13:08:30 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_7.c, enc/windows_1253.c: Split Windows-1253 from 	 
ISO-8859-7 to be able to implement different case conversions.</p>

<p>Wed Jul 13 10:50:12 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_13.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for ISO-8859-13, by Kanon Shindo.</p>

<p>Wed Jul 13 10:31:39 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_13.c, enc/windows_1257.c: Split Windows-1257 from 	 
ISO-8859-13 to be able to implement different case conversions.</p>

<p>Wed Jul 13 09:02:30 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_3.c, test/ruby/enc/test_case_comprehensive.rb: 	  Implement
non-ASCII case conversion for ISO-8859-3, by Takuya Miyamoto.</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Extend special treatment 	 
for Turkic.</p>

<p>* enc/iso_8859_3.c: Exclude dotless i/I with dot from case-insensitive 	 
matching because they are not a case pair.</p>

<p>Wed Jul 13 08:40:21 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_iso_8859.rb: Exclude dotless i/I with dot from 	 
case-insensitive matching because they are not a case pair.</p>

<p>Tue Jul 12 23:13:43 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* math.c (rb_math_sqrt): [EXPERIMENTAL] move Complex sqrt support 	  from
mathn.rb.</p>

<p>Tue Jul 12 01:25:09 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* configure.in, lib/mkmf.rb, win32/Makefile.sub (CSRCFLAG): make the 	 
compiler option replacable in Makefile.</p>

<p>* win32/Makefile.sub (OUTFLAG, COUTFLAG): ditto.</p>

<p>* win32/Makeile.sub, win32/setup.mak (CC): should not append `-nologo` 	 
option forcely.</p>

<p>Mon Jul 11 18:05:40 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_1.c: Moved test for lowercase characters without 	 
uppercase equivalent.</p>

<p>Mon Jul 11 17:49:25 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_4.c, enc/iso_8859_10.c, enc/iso_8859_14.c, 	 
enc/iso_8859_15.c, enc/iso_8859_16.c: Replace case-by-case code with 	 
lookup in ENC_ISO_8859_xx_TO_LOWER_CASE table.</p>

<p>Mon Jul 11 16:00:56 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_each, strio_readlines): convert 	 
arguments just once before reading, instead of conversions for 	  each
lines, as r55603.</p>

<p>Sun Jul 10 19:53:41 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_10.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for ISO-8859-10, by Toya Hosokawa.</p>

<p>Sun Jul 10 19:33:47 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Changed testing logic to 	 
catch unintended modifications of characters that do not have a case 	 
equivalent in the respective encoding. 	* enc/iso_8859_1.c,
enc/iso_8859_15.c: Fixed unintended modifications of 	  micro sign and y
with diaeresis.</p>

<p>Sun Jul 10 17:05:36 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_4.c, test/ruby/enc/test_case_comprehensive.rb: 	  Implement
non-ASCII case conversion for ISO-8859-4, by Kotaro Yoshida.</p>

<p>Sun Jul 10 16:17:47 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Fixed a comment 	  (message
belongs to last commit). [ci skip]</p>

<p>Sun Jul 10 14:27:25 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (ruby_dtoa): [EXPERIMENTAL] adjust the case that the 	  Float
value is close to the exact but unrepresentable middle 	  value of two
values in the given precision, as r55604.</p>

<p>Sun Jul 10 08:57:20 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* thread.c: Fixed implicit conversion error with Apple clang-800.0.31</p>

<p>Sat Jul  9 12:43:09 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/getoptlong.rb: use false instead of FALSE.</p>

<p>Fri Jul  8 21:49:28 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* thread.c (rb_wait_for_single_fd): Clean up fds.revents every time 	 
before calling ppoll(2). [Bug #12575] [ruby-dev:49725]</p>

<p>Fri Jul  8 14:16:48 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_args.c (vm_caller_setup_arg_block): call rb_sym_to_proc() 	  directly
to reduce method dispatch overhead.</p>

<p>Fri Jul  8 08:43:31 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_s_read): add description of pipes to the documentation 	  of
IO.read.</p>

<p>Fri Jul  8 03:54:22 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_args.c (setup_parameters_complex): don&#39;t raise ArgumentError 	 
if an array is given for instance_exec with optional argument. 	 
[ruby-core:76300] [Bug #12568] 	  <a
href="https://github.com/rails/rails/pull/25699">github.com/rails/rails/pull/25699</a></p>

<p>Fri Jul  8 00:47:36 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_eval.c (yield_under): change prototype to get argc/argv.</p>

<p>* vm_eval.c (specific_eval): change for above.</p>

<p>* vm_eval.c (rb_obj_instance_exec): avoid object allocation.</p>

<p>* vm_eval.c (rb_mod_module_exec): ditto.</p>

<p>Thu Jul  7 20:08:37 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm_args.c (vm_caller_setup_arg_block): disable symbol block 	  argument
optimization when tail call optimization is enabled, 	  in order to avoid
SEGV.  [ruby-core:76288] [Bug #12565]</p>

<p>Thu Jul  7 16:37:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (flo_round): [EXPERIMENTAL] adjust the case that the 	 
receiver is close to the exact but unrepresentable middle value 	  of two
values in the given precision. 	  <a
href="http://d.hatena.ne.jp/hnw/20160702">d.hatena.ne.jp/hnw/20160702</a></p>

<p>Thu Jul  7 16:31:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_io_s_foreach, rb_io_s_readlines): convert arguments 	  just
once before reading, instead of conversions for each lines.</p>

<p>Wed Jul  6 19:54:17 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_14.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for ISO-8859-14, by Yutaro Tada.</p>

<p>Wed Jul  6 19:24:48 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_1.c, enc/iso_8859_15.c, enc/iso_8859_16.c: 	  Align
indenting to onigmo convention.</p>

<p>Wed Jul  6 18:59:13 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_15.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for ISO-8859-15, by Maho Harada.</p>

<p>Wed Jul  6 18:34:21 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_16.c, test/ruby/enc/test_case_comprehensive.rb: 	 
Implement non-ASCII case conversion for ISO-8859-16, by Satoshi Kayama.</p>

<p>Wed Jul  6 14:44:56 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (create_makefile): store $headers in LOCAL_HDRS for 	 
depend files.</p>

<p>* ext/digest/digest_conf.rb (digest_conf): add implementation 	  specific
headers to $header.</p>

<p>* ext/digest/<code>md5,rmd160,sha1,sha2</code>/depend: add LOCAL_HDRS to the 	 
dependencies.</p>

<p>Wed Jul  6 08:59:35 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/http/generic_rquest.rb (write_header): A Request-Line must 	 
not contain CR or LF.</p>

<p>Wed Jul  6 07:11:27 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/ftp.rb (putline): raise an ArgumentError when 	  CR or LF is
included in a line.</p>

<p>Tue Jul  5 20:49:30 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* ext/json/*, test/json/*: Update json-2.0.1. 	  Changes of 2.0.0: <a
href="https://github.com/flori/json/blob/f679ebd0c69a94e3e70a897ac9a229f5779c2ee1/CHANGES.md#2015-09-11-200">github.com/flori/json/blob/f679ebd0c69a94e3e70a897ac9a229f5779c2ee1/CHANGES.md#2015-09-11-200</a>
	  Changes of 2.0.1: <a
href="https://github.com/flori/json/blob/f679ebd0c69a94e3e70a897ac9a229f5779c2ee1/CHANGES.md#2016-07-01-201">github.com/flori/json/blob/f679ebd0c69a94e3e70a897ac9a229f5779c2ee1/CHANGES.md#2016-07-01-201</a>
	  [Feature #<a href="ruby-dev:49706">12542]</a>[fix GH-1395]</p>

<p>Tue Jul  5 19:39:49 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c (rb_str_change_terminator_length): New function to change 	 
termlen and resize heap for the terminator. This is split from 	 
rb_str_fill_terminator (str_fill_term) because filling terminator 	  and
changing terminator length are different things. [Bug #12536]</p>

<p>* internal.h: declaration for rb_str_change_terminator_length.</p>

<p>* string.c (str_fill_term): Simplify only to zero-fill the terminator. 	 
For non-shared strings, it assumes that (capa + termlen) bytes of 	  heap
is allocated. This partially reverts r55557.</p>

<p>* encoding.c (rb_enc_associate_index): rb_str_change_terminator_length 	 
is used, and it should be called whenever the termlen is changed.</p>

<p>* string.c (str_capacity): New static function to return capacity 	  of a
string with the given termlen, because the termlen may 	  sometimes be
different from TERM_LEN(str) especially during 	  changing termlen or
filling terminator with specific termlen.</p>

<p>* string.c (rb_str_capacity): Use str_capacity.</p>

<p>Tue Jul  5 11:07:14 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* pack.c (pack_pack): use union instead of bare variable to ease 	 
optimizations and avoid assigning x87 floating point number. 	 
[ruby-core:74496] [Bug #12209]</p>

<p>* pack.c (pack_unpack): ditto.</p>

<p>Mon Jul  4 13:56:34 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* process.c: define sig_t if not exist. 	  at least Solaris 10 and 11
doesn&#39;t have sig_t.</p>

<p>Mon Jul  4 13:08:48 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* random.c (random_ulong_limited): avoid left shift count &gt;= width of 	
type on 32bit environment.</p>

<p>Sun Jul  3 18:51:42 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb, test_regex_casefold.rb, 	 
test/test_unicode_normalize.rb: Replace UNICODE_VERSION from 	 
UnicodeNormalize with <a href="'UNICODE_VERSION'">RbConfig::CONFIG</a> from
	  feature 12460.</p>

<p>Sun Jul  3 06:04:09 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* process.c (disable_child_handler_fork_child): simplify 	 
[ruby-core:75781] [Misc #12439]</p>

<p>Sun Jul  3 05:25:46 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* tool/asm_parse.rb: add description 	* tool/change_maker.rb: ditto 	*
tool/downloader.rb: ditto 	* tool/eval.rb: ditto 	* tool/expand-config.rb:
ditto 	* tool/extlibs.rb: ditto 	* tool/fake.rb: ditto 	*
tool/file2lastrev.rb: ditto 	* tool/gem-unpack.rb: ditto 	*
tool/gen_dummy_probes.rb: ditto 	* tool/gen_ruby_tapset.rb: ditto 	*
tool/generic_erb.rb: ditto 	* tool/id2token.rb: ditto 	* tool/ifchange:
ditto 	* tool/insns2vm.rb: ditto 	* tool/instruction.rb: ditto 	*
tool/jisx0208.rb: ditto 	* tool/merger.rb: ditto 	* tool/mkrunnable.rb:
ditto 	* tool/node_name.rb: ditto 	* tool/parse.rb: ditto 	*
tool/rbinstall.rb: ditto 	* tool/rbuninstall.rb: ditto 	* tool/rmdirs:
ditto 	* tool/runruby.rb: ditto 	* tool/strip-rdoc.rb: ditto 	*
tool/vcs.rb: ditto 	* tool/vtlh.rb: ditto 	* tool/ytab.sed: ditto 	*
tool/enc-unicode.rb: fix typo 	* tool/mk_call_iseq_optimized.rb: ditto 	*
tool/update-deps: ditto 	  [ruby-core:76215] [Bug #12539] 	  by Noah Gibbs
&lt;the.codefolio.guy@gmail.com&gt;</p>

<p>Sat Jul  2 18:04:24 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/mailto.rb (initialize): RFC3986_Parser#split sets opaque 	  only
if the URI has path-rootless, not path-empty. 	  [ruby-core:76055] [Bug
#12498] 	  patched by Chris Heisterkamp &lt;cheister@squareup.com&gt;</p>

<p>Sat Jul  2 04:26:14 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regcomp.c (noname_disable_map): don&#39;t optimize out group 0 	 
Ruby&#39;s Regexp doesn&#39;t allow normal numbered groups if the regexp 	 
has named groups. On such case it optimizes out related NT_ENCLOSE. 	  But
even on the case it can use g&lt;0&gt;. 	  This fix not to remove
NT_ENCLOSE whose regnum is 0. 	  [ruby-core:75828] [Bug #12454]</p>

<p>Sat Jul  2 03:09:27 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c: Partially reverts r55547 and r55555. 	  ChangeLog about the
reverted changes are also deleted in this file. 	  [Bug #12536]
[ruby-dev:49699] [ruby-dev:49702]</p>

<p>Sat Jul  2 02:22:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c (str_fill_term): When termlen increases, re-allocation 	  of
memory for termlen should always be needed. 	  In this fix, if possible,
decrease capa instead of realloc. 	  [Bug #12536] [ruby-dev:49699]</p>

<p>Fri Jul  1 20:20:20 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c: Specify termlen as far as possible. 	  Additional fix for [Bug
#12536] [ruby-dev:49699].</p>

<p>* string.c (str_new_static): Specify termlen from the given encoding 	 
when creating a new String object is needed.</p>

<p>* string.c (rb_tainted_str_new_with_enc): New function to create a 	 
tainted String object with the given encoding. This means that 	  the
termlen is correctly specified. Currently static function. 	  The function
name might be renamed to rb_tainted_enc_str_new 	  or
rb_enc_tainted_str_new.</p>

<p>* string.c (rb_external_str_new_with_enc): Use encoding by using the 	 
above rb_tainted_str_new_with_enc().</p>

<p>Fri Jul  1 19:38:57 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* test/fiddle/test_pointer.rb (test_to_str, test_to_s, test_aref_aset): 	 
Attempt to use independent strings for destructive tests that 	  directly
modify values on memory by using Fiddle::Pointer. 	  [Bug #12537]
[ruby-dev:49700]</p>

<p>Fri Jul  1 18:20:00 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* .gdbinit (rb_ps_thread): show the detail of cfunc in ruby level 	 
backtrace.</p>

<p>Fri Jul  1 13:26:39 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c (rb_str_subseq, str_substr): When RSTRING_EMBED_LEN_MAX 	  is
used, TERM_LEN(str) should be considered with it because 	  embedded
strings are also processed by TERM_FILL. 	  Additional fix for [Bug #12536]
[ruby-dev:49699].</p>

<p>Fri Jul  1 12:11:01 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* .gdbinit (rb_count_objects): added gdb version of count_objects().</p>

<p>Fri Jul  1 04:32:52 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* .gdbinit (rb_ps_thread): show ruby level backtrace. 	  Usually you can
call `rb_ps` to show ruby level backtraces 	  for all living threads. 	 
Note that it can call with core file like `gcore &lt;pid&gt;` 	  and `gdb
ruby core.&lt;pid&gt;`.</p>

<p>Thu Jun 30 19:15:13 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* string.c: Fix memory corruptions when using UTF-16/32 strings. 	  [Bug
#12536] [ruby-dev:49699]</p>

<p>* string.c (rb_str_new_with_class): Use TERM_LEN of the “obj”.</p>

<p>* string.c (rb_str_plus, rb_str_justify): Use str_new0 which is aware 	 
of termlen.</p>

<p>* string.c (str_shared_replace): Copy <tt>termlen bytes instead of </tt>1.</p>

<p>* string.c (rb_str_times): termlen should not be included in capa.</p>

<p>* string.c (RESIZE_CAPA_TERM): When using RSTRING_EMBED_LEN_MAX, 	 
termlen should be counted with it because embedded strings are 	  also
processed by TERM_FILL.</p>

<p>* string.c (rb_str_capacity, str_shared_replace, str_buf_cat): ditto.</p>

<p>* string.c (rb_str_drop_bytes, rb_str_setbyte, str_byte_substr): ditto.</p>

<p>Wed Jun 29 22:24:37 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* ext/psych/lib/psych_jars.rb: removed needless file required to JRuby.</p>

<p>Wed Jun 29 22:21:38 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c: The “reuse” behavior of d2i_ functions does 	 
not work well with OpenSSL 1.0.0t. So avoid it.</p>

<p>Wed Jun 29 15:18:28 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* insns.def (opt_succ): optimize like r55515. (but this argument is 	 
constant)</p>

<p>Wed Jun 29 12:41:58 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* test/ruby/test_refinement.rb: skip 	  test_prepend_after_refine_wb_miss
on ARM or MIPS. 	  [ruby-core:76031] [Bug #12491]</p>

<p>Wed Jun 29 08:45:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (passed_block): convert passed block symbol to proc. 	  based on
the patch by Daisuke Sato in [ruby-dev:49695]. 	  [Bug #12531]</p>

<p>Wed Jun 29 03:34:41 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big2ulong): the old logic seems to try to avoid 	 
calculating `-(long)(num-1)-1` if `num` is not LONG_MIN. (Note that 	 
`-LONG_MIN` may be larger than LONG_MAX) But C compilers can 	  optimize it
into single NEG instruction. 	  Therefore those two conditions can be
single if-body.</p>

<p>* bignum.c (rb_big2long): ditto.</p>

<p>* bignum.c (rb_big2ull): ditto.</p>

<p>* bignum.c (rb_big2ll): ditto.</p>

<p>Tue Jun 28 22:55:00 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/pstore.rb (PStore::CHECKSUM_ALGO): extract the algorithm for 	 
checksum, instead of qualified names for each times.</p>

<p>Tue Jun 28 22:29:36 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bootstraptest/runner.rb: do not use safe navigation operator. 	  this
runner may run on older ruby.  partially revert r53110 	  (GH-1142 patched
by @mlarraz).</p>

<p>Tue Jun 28 22:09:09 2017  Akio Tajima &lt;artonx@yahoo.co.jp&gt;</p>

<p>* lib/fileutils.rb: rescue Errno:EACCES for chown. 	  [Bug #12520]</p>

<p>Tue Jun 28 18:38:09 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* ext/digest/md5/md5ossl.h: Remove excess semicolons. 	  Suppress warning
on Solaris with Oracle Solaris Studio 12. 	  [ruby-dev:49692] [Bug #12524]</p>

<p>* ext/digest/md5/md5cc.h: ditto. 	* ext/digest/sha1/sha1cc.h: ditto. 	*
ext/digest/sha1/sha1ossl.h: ditto. 	* ext/digest/sha2/sha2cc.h: ditto. 	*
ext/digest/sha2/sha2ossl.h: ditto. 	* ext/openssl/ossl_pkey_rsa.c: ditto.</p>

<p>Tue Jun 28 15:56:48 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: noting to test if 	  Unicode
data files are available. 	  [ruby-core:76160] [Bug #12433]</p>

<p>* test/test_unicode_normalize.rb: ditto.</p>

<p>Tue Jun 28 15:20:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb (Net::HTTP#proxy_uri): cache the case no proxy 	  is
used.</p>

<p>Tue Jun 28 09:56:29 2016  Stefan Schussler 
&lt;mail@stefanschuessler.de&gt;</p>

<p>* object.c (rb_mod_eqq): [DOC] Fix typo in RDoc.  [Fix GH-1393]</p>

<p>Tue Jun 28 02:41:32 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* insns.def (opt_plus): use `- 1` instead of `&amp; (~1)` to allow 	 
compilers to use x86 LEA instruction (3 operand). 	  Even if 3 operand
LEA&#39;s latency is 3 cycle after SandyBridge, 	  it reduces code size and
can be faster because of super scalar.</p>

<p>* insns.def (opt_plus): calculate and use rb_int2big. 	  On positive
Fixnum overflow, `recv - 1 + obj` doesn&#39;t carry 	  because recv&#39;s
msb and obj&#39;s msb are 0, and resulted msb is 1. 	  Therefore simply
rshift and cast as signed long works fine. 	  On negative Fixnum overflow,
it will carry because both arguments&#39; 	  msb are 1, and resulted msb is
also 1. 	  In this case it needs to restore carried sign bit after rshift.</p>

<p>Mon Jun 27 16:58:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/fileutils.rb (FileUtils#install): accecpt symbolic mode, as 	  well
as chmod.</p>

<p>* lib/fileutils.rb (FileUtils#install): add owner and group 	  options.</p>

<p>Mon Jun 27 08:56:55 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (ADD_TRACE): ignore trace instruction on non-positive 	  line.</p>

<p>* parse.y (coverage): get rid of ArgumentError when the starting 	  line
number is not positive.  [ruby-core:76141] [Bug #12517]</p>

<p>Sun Jun 26 10:20:25 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/win32/lib/Win32API.rb (Win32API#initialize): Cygwin 	  2.5.2-1
(perhaps) seems to no longer append “.dll” suffix 	  implicitly.</p>

<p>* ext/win32/lib/win32/resolv.rb (Win32::Resolv): ditto.  Fix the 	  error
reported by yamataka AT u08.itscom.net in 	  [ruby-list:50339], and pointed
out and patched by cerberus AT 	  m3.kcn.ne.jp in [ruby-list:50341].</p>

<p>Sat Jun 25 10:07:52 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* test/openssl/test_ocsp.rb: Ignore errors caused by bugs that exist in 	 
LibreSSL &gt;= 2.3.1.</p>

<p>Sat Jun 25 02:33:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (vm_respond_to): try method_missing if respond_to? 	  is
undefined, as if it is the default definition. 	  [ruby-core:75377] [Bug
#12353]</p>

<p>Fri Jun 24 17:04:21 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* ext/psych/*, test/psych/*: Update psych 2.1.0 	  This version fixed [Bug
#<a href="ruby-core:72850">11988]</a></p>

<p>Fri Jun 24 13:12:41 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: 	  Update rubygems
2.6.5 and 2.6.6. 	  Release note of 2.6.5: <a
href="https://github.com/rubygems/rubygems/commit/656f5d94dc888d78d0d00f3598a4fa37391aac80">github.com/rubygems/rubygems/commit/656f5d94dc888d78d0d00f3598a4fa37391aac80</a>
	  Release note of 2.6.6: <a
href="https://github.com/rubygems/rubygems/commit/ccb9c3300c063f5b5656669972d24a10ef8afbf5">github.com/rubygems/rubygems/commit/ccb9c3300c063f5b5656669972d24a10ef8afbf5</a></p>

<p>Fri Jun 24 09:17:15 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (lib/unicode_normalize/tables.rb): should not depend 	  on
Unicode data files unless ALWAYS_UPDATE_UNICODE=yes, to get 	  rid of
downloading Unicode data unnecessary.  [ruby-dev:49681]</p>

<p>* common.mk (enc/unicode/casefold.h): update Unicode files in a 	 
sub-make, not to let the header depend on the files always.</p>

<p>* enc/unicode/case-folding.rb: if gperf is not usable, assume the 	 
existing file is OK.</p>

<p>Tue Jun 21 19:44:54 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_regex_casefold.rb: Add Windows-1251, KOI8-R, and 	 
KOI8-U to encodings; definitely removed EUC-JP.</p>

<p>Tue Jun 21 19:32:23 2016  Mark St.Godard  &lt;markstgodard@gmail.com&gt;</p>

<p>* lib/webrick/httprequest.rb (setup_forwarded_info): Use the first 	 
value in X-Forwarded-Proto, if header contains multiple comma 	  separated
values.  Some middlewares may add these values to the 	  list, not
replacing.  [Fix GH-1386]</p>

<p>Tue Jun 21 17:17:42 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/test_io.rb: Skip test_readpartial_with_not_empty_buffer, 	 
test_read_buffer_error, test_read_unlocktmp_ensure, 	 
test_readpartial_unlocktmp_ensure, and 	  test_sysread_unlocktmp_ensure on
cygwin, 	  because these tests repeatedly hang. This makes test_io.rb 	 
complete in finite time on cygwin.</p>

<p>* ChangeLog: Fix test_in.rb -&gt; test_io.rb (two instances).</p>

<p>Tue Jun 21 16:38:14 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_casemap): do not put code with side effects 	  inside
RSTRING_PTR() macro which evaluates the argument multiple 	  times.</p>

<p>Tue Jun 21 16:13:45 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_casemap): fix memory leak.</p>

<p>Tue Jun 21 16:12:21 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_casemap): int is too small for string size.</p>

<p>Tue Jun 21 15:42:22 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/test_io.rb: Skip test_read_buffer_error on cygwin, 	  because
this test repeatedly hangs.</p>

<p>Tue Jun 21 15:35:14 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* LEGAL: Added filenames and copyrights for some files in 	 
enc/trans/JIS.</p>

<p>Tue Jun 21 00:56:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (get_special_folder): fix calling convention of 	 
SHGetPathFromIDListEx, which should be WINAPI.  pointed out by 	  @arton at
<a
href="http://twitter.com/arton/status/744884064277016576">twitter.com/arton/status/744884064277016576</a></p>

<p>Tue Jun 21 00:22:02 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in, include/ruby/defines.h (RUBY_USE_SETJMPEX): 	  include
setjmpex.h only when using setjmpex() for RUBY_SETJMP. 	  the header of
mingw32 overrides setjmp() by setjmpex().</p>

<p>Mon Jun 20 18:39:16 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/test_io.rb: Skip test_open_fifo_does_not_block_other_threads 	
on cygwin. Fifos seem to work okay in cygwin, but this test repeatedly 	 
hangs.</p>

<p>Mon Jun 20 13:35:06 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* vm.c (invoke_bmethod, invoke_block_from_c_0): revert r52104 	  partially
to avoid “self has wrong type to call super in this 	  context” errors. 	 
[ruby-core:72724] [Bug #11954]</p>

<p>Mon Jun 20 12:53:38 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* test/rubygems/test_gem_remote_fetcher.rb: OpenSSL::PKey::DH#priv_key= 	 
is not defined when ext/openssl is built with OpenSSL 1.1.0. 	  <a
href="https://github.com/rubygems/rubygems/pull/1648">github.com/rubygems/rubygems/pull/1648</a>
	  [ruby-core:75225] [Feature #12324]</p>

<p>Sun Jun 19 21:25:43 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c: Add OCSP::SingleResponse that represents an 	 
OCSP SingleResponse structure. Also add two new methods #responses 	  and
#find_response to OCSP::BasicResponse. A BasicResponse has one or 	  more
SingleResponse. We have OCSP::BasicResponse#status that returns 	  them as
an array of arrays, each containing the content of a 	  SingleResponse, but
this is not useful. When validating an OCSP 	  response, we need to look
into the each SingleResponse and check their 	  validity but it is not
simple. For example, when validating for a 	  certificate &#39;cert&#39;,
the code would be like:</p>

<p># certid_target is an OpenSSL::OCSP::CertificateId for cert 	    basic
= res.basic 	    result = basic.status.any? do |ary| 	      <a
href="0">ary</a>.cmp(certid_target) &amp;&amp; 	        <a href="4">ary</a>
&lt;= Time.now &amp;&amp; (!<a href="5">ary</a> || Time.now &lt;= <a
href="5">ary</a>) 	    end</p>

<p>Adding OCSP::SingleResponse at the same time allows exposing 	 
OCSP_check_validity(). With this, the code above can be rewritten as:</p>

<p>basic = res.basic 	    single = basic.find_response(certid_target) 	  
result = single.check_validity</p>

<p>* test/openssl/test_ocsp.rb: Test this.</p>

<p>Sun Jun 19 18:40:19 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c (ossl_ocspbres_add_status): Allow specifying 	 
the times (thisUpdate, nextUpdate and revocationTime) with Time 	  objects.
Currently they accepts only relative seconds from the current 	  time. This
is inconvenience, especially for revocationTime. When 	  Integer is passed,
they are still treated as relative times. Since the 	  type check is
currently done with rb_Integer(), this is a slightly 	  incompatible
change. Hope no one passes a relative time as String or 	  Time object… 	 
Also, allow passing nil as nextUpdate. It is optional.</p>

<p>* ext/openssl/ruby_missing.h: Define RB_INTEGER_TYPE_P() if not defined. 	
openssl gem will be released before Ruby 2.4.0.</p>

<p>Sun Jun 19 18:39:38 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c: Implement OCSP::<code>CertificateId,Request,</code>#initialize_copy. 	  [ruby-core:75504] [Bug #12381]</p>

<p>* test/openssl/test_ocsp.rb: Test them.</p>

<p>Sun Jun 19 18:29:50 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkey_dh.c, ext/openssl/ossl_pkey_dsa.c, 	 
ext/openssl/ossl_pkey_ec.c, ext/openssl/ossl_pkey_rsa.c: Implement 	 
initialize_copy method for OpenSSL::PKey::*. 	  [ruby-core:75504] [Bug
#12381]</p>

<p>* test/openssl/test_pkey_dh.rb, test/openssl/test_pkey_dsa.rb, 	 
test/openssl/test_pkey_ec.rb, test/openssl/test_pkey_rsa.rb: Test they 	 
actually copy the OpenSSL objects, and modifications to cloned object 	 
don&#39;t affect the original object.</p>

<p>Sun Jun 19 16:55:16 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/test_dir_m17n.rb: Skip tests with non-UTF-8 encodings 	  on
cygwin. Cygwin can use the Unicode PUA (private use area) to store 	  bytes
from non-UTF-8 filenames (see 	  <a
href="https://cygwin.com/cygwin-ug-net/using-specialnames.html#pathnames-specialchars">cygwin.com/cygwin-ug-net/using-specialnames.html#pathnames-specialchars</a>),
	  but we are not supporting this. [Bug #12443]</p>

<p>Sun Jun 19 15:01:18 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* localeinit.c: Fix filesystem encoding for cygwin to UTF-8 (see 	  <a
href="https://cygwin.com/cygwin-ug-net/using-specialnames.html#pathnames-unusual">cygwin.com/cygwin-ug-net/using-specialnames.html#pathnames-unusual</a>)</p>

<p>Sun Jun 19 14:31:07 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkey.h, ext/openssl/ossl_pkey_dh.c, 	 
ext/openssl/ossl_pkey_dsa.c, ext/openssl/ossl_pkey_rsa.c: A few days 	 
ago, OpenSSL changed <code>DH,DSA,RSA</code><em>get0</em>*() to take const BIGNUM **.
	  <a
href="https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=fd809cfdbd6e32b6b67b68c59f6d55fbed7a9327">git.openssl.org/gitweb/?p=openssl.git;a=commit;h=fd809cfdbd6e32b6b67b68c59f6d55fbed7a9327</a>
	  [ruby-core:75225] [Feature #12324]</p>

<p>Sun Jun 19 11:19:43 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (rb_path_to_class): consider the string length 	  instead of
a terminator.</p>

<p>* variable.c (rb_path_to_class): search the constant at once 	  instead of
checking if defined and then getting it.</p>

<p>Sat Jun 18 14:01:40 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/rubygems/test_gem_installer.rb: Fixed broken test with extension 	 
build. <a
href="https://github.com/rubygems/rubygems/pull/1645">github.com/rubygems/rubygems/pull/1645</a></p>

<p>Sat Jun 18 13:59:54 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: Update rubygems 	 
HEAD(2c6d256). It contains to update vendored Molinillo to 0.5.0. 	  <a
href="https://github.com/rubygems/rubygems/pull/1638">github.com/rubygems/rubygems/pull/1638</a></p>

<p>Sat Jun 18 10:13:37 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (build-ext), ext/extmk.rb: use variable EXTENCS 	  different
than ENCOBJS, to get rid of circular dependency. 	  build libencs when
linking encodings statically. 	  [ruby-core:75618] [Bug #12401]</p>

<p>Sat Jun 18 08:52:46 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_getline): fix pointer index 	  overflow. 
reported by Guido Vranken &lt;guido AT guidovranken.nl&gt;.</p>

<p>Thu Jun 16 16:35:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (Init_class_hierarchy): prevent rb_cObject which is the 	  class
tree root, from GC.  [ruby-dev:49666] [Bug #12492]</p>

<p>Thu Jun 16 12:17:52 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (tr_trans): adjust buffer size by processed and rest 	 
lengths, instead of doubling repeatedly.</p>

<p>Thu Jun 16 11:15:25 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (tr_trans): consider terminator length and fix heap 	 
overflow.  reported by Guido Vranken &lt;guido AT guidovranken.nl&gt;.</p>

<p>Thu Jun 16 00:02:32 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c (ossl_ocspreq_verify, ossl_ocspbres_verify): 	 
Use ossl_clear_error() so that they don&#39;t print warnings to stderr and
	  leak errors in the OpenSSL error queue. Also, check the return value 	 
of OCSP_*_verify() correctly. They can return -1 on verification 	 
failure.</p>

<p>Wed Jun 15 19:52:23 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c (ossl_ocspreq_sign, ossl_ocspbres_sign): Allow 	
specifying hash algorithm used in signing. They are hard coded to use 	 
SHA-1. 	  Based on a patch provided by Tim Shirley
&lt;tidoublemy@gmail.com&gt;. 	  [ruby-core:70915] [Feature #11552] [GH
ruby/openssl#28]</p>

<p>* test/openssl/test_ocsp.rb: Test sign-verify works.</p>

<p>Wed Jun 15 01:46:16 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c: [DOC] fix rdoc directive, and an example of negative 	 
value.  [ruby-core:76025] [Bug #12487]</p>

<p>Wed Jun 15 01:44:42 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb: provide Unicode Version information as 	  <a
href="'UNICODE_VERSION'">RbConfig::CONFIG</a>. 	  [ruby-core:75845]
[Feature #12460]</p>

<p>Wed Jun 15 00:01:18 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb 	 
(TestComprehensiveCaseFold::read_data): use A and z instead of 	  ^ and $
in regexp.</p>

<p>Tue Jun 14 23:43:00 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/backward.h (rb_cFixnum, rb_cBignum): remove the 	  backward
compatibility macros, to fail incompatible extension 	  libraries early. 
[Bug #12427]</p>

<p>Tue Jun 14 22:22:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): limit the result string 	  size
by the format length, to get rid of unlimited memory use.</p>

<p>Tue Jun 14 22:11:11 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c (ossl_ocspcid_get_issuer_name_hash, 	 
ossl_ocspcid_get_issuer_key_hash, ossl_ocspcid_get_hash_algorithm): 	  Add
accessor methods OCSP::CertificateId#issuer_name_hash, 	  #issuer_key_hash,
#hash_algorithm. 	  Based on a patch provided by Paul Kehrer
&lt;paul.l.kehrer@gmail.com&gt;. 	  [ruby-core:48062] [Feature #7181]</p>

<p>* test/openssl/test_ocsp.rb: Test these new methods.</p>

<p>Tue Jun 14 22:07:25 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/date/date_strftime.c (date_strftime_with_tmx): reject too 	  large
precision to get rid of buffer overflow. 	  reported by Guido Vranken
&lt;guido AT guidovranken.nl&gt;.</p>

<p>Tue Jun 14 21:40:42 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ocsp.c (ossl_ocspbres_to_der, ossl_ocspcid_to_der): 	 
Implement #to_der methods for OCSP::BasicResponse and 	 
OCSP::CertificateId.</p>

<p>(ossl_ocspreq_initialize, ossl_ocspres_initialize): Use GetOCSP*() 	 
instead of raw DATA_PTR().</p>

<p>(ossl_ocspbres_initialize, ossl_ocspcid_initialize): Allow 	 
initializing from DER string.</p>

<p>(Init_ossl_ocsp): Define new #to_der methods.</p>

<p>* test/openssl/test_ocsp.rb: Test these changes. Also add missing tests 	 
for OCSP::<code>Response,Request</code>#to_der.</p>

<p>Tue Jun 14 21:35:00 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/openssl_missing.h (DH_set0_pqg, RSA_set0_key): 	 
DH_set0_pqg() allows &#39;q&#39; to be NULL. Fix a typo in RSA_set0_key().
	  Fixes r55285.  [ruby-core:75225] [Feature #12324]</p>

<p>Mon Jun 14 10:19:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* NEWS: describe Integer#digits.</p>

<p>Mon Jun 13 21:09:40 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread.c (debug_deadlock_check): show thread lock dependency and 	 
backtrace [Feature #8214] [ruby-dev:47217]</p>

<p>* thread.c (thread_status_name): show “sleep_forever” instead of 	 
“sleep” if called from inspect.</p>

<p>Mon Jun 13 20:50:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (reg_named_capture_assign_iter): remove named capture 	 
conflict warnings.  it is just annoying rather than useful. 	 
[ruby-core:75416] [Bug #12359]</p>

<p>Mon Jun 13 20:04:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (rb_int_digits, rb_fix_digits, rb_int_digits_bigbase): 	  Add
Integer#digits to extract columns in place-value notation 	  [Feature
#12447] [ruby-core:75799]</p>

<p>* test/ruby/test_integer.rb: Add tests for the above change.</p>

<p>* test/ruby/test_bignum.rb: ditto.</p>

<p>Mon Jun 13 20:34:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RUBY_INTEGER_UNIFICATION): macro to tell if 	 
Integer is integrated.  [ruby-core:75718][Bug #12427]</p>

<p>* include/ruby/backward.h, internal.h (rb_cFixnum, rb_cBignum): 	 
fallback to rb_cInteger.</p>

<p>* bignum.c, numeric.c, ext/json/generator/generator.<code>c,h</code>: use the 	 
macro.</p>

<p>Mon Jun 13 16:58:53 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Add tests for full Unicode 	 
swapcase.</p>

<p>Sun Jun 12 14:48:00 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Add tests for ASCII-only 	 
swapcase; store calculated values in hashes.</p>

<p>Sun Jun 12 14:05:45 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_cipher.c (ossl_cipher_get_auth_tag, 	 
ossl_cipher_set_auth_tag): Check if the cipher flags retrieved by 	 
EVP_CIPHER_CTX_flags() includes EVP_CIPH_FLAG_AEAD_CIPHER to see if 	  the
cipher supports AEAD. AES-GCM was the only supported in OpenSSL 	  1.0.1.</p>

<p>(Init_ossl_cipher): Fix doc; OpenSSL::Cipher::AES.new(128, :GCM)
can&#39;t 	  work.</p>

<p>* ext/openssl/openssl_missing.h: Define EVP_CTRL_AEAD_<code>GET,SET</code>_TAG if 	 
missing. They are added in OpenSSL 1.1.0, and have the same value as 	 
EVP_CTRL_GCM_<code>GET,SET</code>_TAG and EVP_CTRL_CCM_<code>GET,SET</code>_TAG.</p>

<p>Sun Jun 12 13:47:42 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* test/openssl/test_engine.rb (test_openssl_engine_builtin, 	 
test_openssl_engine_by_id_string): Skip test if &#39;openssl&#39; engine is
	  already loaded. And test the number increased by Engine.load<code>_by_id,</code>, 	
not the total count of loaded engines. Previously, we called 	 
OpenSSL::Engine.cleanup every time running a test case, but we no 	  longer
can do it. 	  [ruby-core:75225] [Feature #12324]</p>

<p>Sun Jun 12 09:24:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (append_fspath): normalize directory name to be appended 	  on OS
X.  [ruby-core:75957] [Ruby trunk Bug#12483] 	  <a
href="https://github.com/rails/rails/issues/25303#issuecomment-224834804">github.com/rails/rails/issues/25303#issuecomment-224834804</a></p>

<p>Sat Jun 11 23:07:32 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* lib/forwardable.rb (_delegator_method): get rid of a warning which 	 
causes test failures introduced at r55376.</p>

<p>Sat Jun 11 18:37:58 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>* ext/json/lib/*.rb: Removed some comments. Because these are unnecessary
	  class description. [ci skip][Bug #<a href="ruby-core:74835">12255]</a></p>

<p>Sat Jun 11 15:19:38 2016  takiy33  &lt;takiy33@users.noreply.github.com&gt;</p>

<p>* lib/net/smtp.rb: [DOC] Remove dead link on documentation for 	  Japanese
of SMTP.  [Fix GH-1380]</p>

<p>Sat Jun 11 15:02:45 2016  Grant Hutchins  &lt;github@nertzy.com&gt;</p>

<p>* string.c (rb_str_oct): [DOC] fix typo, hornored -&gt; honored. 	  [Fix
GH-1379]</p>

<p>Sat Jun 11 14:04:19 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/objspace/objspace_dump.c: generate valid JSON for dump_all.</p>

<p>Sat Jun 11 13:52:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/forwardable.rb (_delegator_method): remove __send__ call if 	 
possible, so that more optimizations will be enabled.</p>

<p>Sat Jun 11 11:24:36 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/iso_8859.h (SHARP_s): name frequently used codepoint.</p>

<p>Sat Jun 11 09:58:45 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_1.c: Revert to older version of code.</p>

<p>Sat Jun 11 09:46:17 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/iso_8859_1.c: Implement non-ASCII case mapping.</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Tests for above.</p>

<p>* string.c: Add iso-8859-1 to supported encodings.</p>

<p>Sat Jun 11 09:31:28 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/forwardable.rb (_delegator_method): leave the backtrace 	  untouched
during accessor.  forwardable.rb does not appear in 	  the backtrace during
delegated method because of tail-call 	  optimization.</p>

<p>Sat Jun 11 01:38:31 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* include/ruby/defines.h (GCC_VERSION_SINCE): Fix logic error by 	  adding
parentheses. Fix failures of TestMkmf::TestConvertible 	  with GCC 3.4.3 on
Solaris 10. [Bug #12479] [ruby-dev:49660]</p>

<p>Fri Jun 10 21:54:24 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/forwardable.rb (Forwardable._delegator_method): extract 	  method
generator and deal with non-module objects. 	  [ruby-dev:49656] [Bug
#12478]</p>

<p>Fri Jun 10 17:35:11 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Special-case :ascii option in rb_str_capitalize_bang and 	 
rb_str_swapcase_bang.</p>

<p>Fri Jun 10 17:12:24 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Special-case :ascii option in rb_str_upcase_bang (retry).</p>

<p>Fri Jun 10 14:48:36 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* hash.c (get_env_cstr): ensure NUL-terminated. 	  [ruby-dev:49655] [Bug
#12475]</p>

<p>* string.c (rb_str_fill_terminator): return the pointer to the 	 
NUL-terminated content.</p>

<p>Thu Jun  9 21:42:00 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_asn1.c (asn1integer_to_num): Use 	 
ASN1_ENUMERATED_to_BN() to convert an ASN1_ENUMERATED to a BN. 	  Starting
from OpenSSL 1.1.0, ASN1_INTEGER_to_BN() rejects 	  non-ASN1_INTEGER
objects. The format of INTEGER and ENUMERATED are 	  almost identical so
they behaved in the same way in OpenSSL &lt;= 1.0.2. 	  [ruby-core:75225]
[Feature #12324]</p>

<p>* test/openssl/test_asn1.rb (test_decode_enumerated): Test that it 	 
works.</p>

<p>Thu Jun  9 21:10:04 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* tool/ifchange: fix timestamp error when target without 	  directory.</p>

<p>Thu Jun  9 19:46:22 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ssl.c: Add define guards for OPENSSL_NO_EC. 	 
SSL_CTX_set_ecdh_auto() is defined even when ECDH is disabled in 	 
OpenSSL&#39;s configuration. This fixes r55214.</p>

<p>* test/openssl/test_pair.rb (test_ecdh_curves): Skip if the OpenSSL does 	
not support ECDH.</p>

<p>* test/openssl/utils.rb (start_server): Ignore error in 	 
SSLContext#ecdh_curves=.</p>

<p>Thu Jun  9 18:12:42 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* Makefile.in (un-runnable): fail with proper error message. 	 
[ruby-core:75905] [Bug #12472]</p>

<p>Thu Jun  9 15:32:17 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (RBCONFIG): use ifchange tool to see if the content is 	 
changed and update the timestamp file.</p>

<p>* tool/mkconfig.rb: remove ifchange features.</p>

<p>* tool/ifchange: make target directory if it does not exist with 	  its
parent directories.</p>

<p>* win32/ifchange.bat: drop support for command.com used on old 	  systems.</p>

<p>Thu Jun  9 15:03:35 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Check for CRYPTO_malloc() and SSL_new(). 	 
OpenSSL_add_all_digests() and SSL_library_init() are deprecated and 	 
converted to macros in OpenSSL 1.1.0. 	  [ruby-core:75225] [Feature #12324]</p>

<p>Wed Jun  8 23:09:51 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* string.c (rb_str_ascii_casemap): fix compile error.</p>

<p>Wed Jun  8 22:22:24 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Revert previous commit (possibility of endless loop).</p>

<p>Wed Jun  8 21:57:41 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Special-case :ascii option in rb_str_upcase_bang.</p>

<p>Wed Jun  8 21:28:36 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: New static function rb_str_ascii_casemap; special-casing 	 
:ascii option in rb_str_upcase_bang and rb_str_downcase_bang.</p>

<p>* regenc.c: Fix a bug (wrong use of unnecessary slack at end of string).</p>

<p>* regenc.h -&gt; include/ruby/oniguruma.h: Move declaration of 	 
onigenc_ascii_only_case_map so that it is visible in string.c.</p>

<p>Wed Jun  8 20:33:44 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* include/ruby/intern.h: Remove excess semicolons in PUREFUNC(). 	  Fix
failure of TestMkmf::TestConvertible on Solaris with 	  Oracle Solaris
Studio 12. [ruby-dev:49651] [Bug #12470] 	* internal.h: ditto.</p>

<p>Wed Jun  8 16:03:09 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* lib/net/smtp.rb (getok, get_response): raise an ArgumentError when 	  CR
or LF is included in a line, because they are not allowed in 	  RFC5321. 
Thanks, Jeremy Daer.</p>

<p>Tue Jun  7 21:27:25 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* test/rubygems/*_<code>cert,cert_32</code>.pem: Regenerate test certificates for 	 
OpenSSL 1.1.0. This is already in upstream. 	  <a
href="https://github.com/rubygems/rubygems/commit/9be5c53939440a61c4bba73cfffbeb5cfadf72be">github.com/rubygems/rubygems/commit/9be5c53939440a61c4bba73cfffbeb5cfadf72be</a>
	  [ruby-core:75225] [Feature #12324]</p>

<p>Tue Jun  7 21:27:17 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* test/open-uri/test_ssl.rb: Regenerate test certificates. The test CA 	 
certificate was incorrectly generated. A CA certificate must have the 	 
basic constraints extension with cA bit set to TRUE. OpenSSL &lt;= 1.0.2 	 
allowed the error when the certificate is in the trusted store but 	 
OpenSSL 1.1.0 no longer does. 	  [ruby-core:75225] [Feature #12324]</p>

<p>Tue Jun  7 21:20:38 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* test/openssl/test_x509name.rb: Don&#39;t register OID for
&#39;emailAddress&#39; 	  and &#39;serialNumber&#39;. A recent change in
OpenSSL made OBJ_create() 	  reject an already existing OID. They were
needed to run tests with 	  OpenSSL 0.9.6 which is now unsupported. 	  <a
href="https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=52832e470f5fe8c222249ae5b539aeb3c74cdb25">git.openssl.org/gitweb/?p=openssl.git;a=commit;h=52832e470f5fe8c222249ae5b539aeb3c74cdb25</a>
	  [ruby-core:75225] [Feature #12324]</p>

<p>* test/openssl/test_ssl_session.rb (test_server_session): Duplicate 	 
SSL::Session before re-adding to the session store. OpenSSL 1.1.0 	  starts
rejecting SSL_SESSION once removed by SSL_CTX_remove_session(). 	  <a
href="https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=7c2d4fee2547650102cd16d23f8125b76112ae75">git.openssl.org/gitweb/?p=openssl.git;a=commit;h=7c2d4fee2547650102cd16d23f8125b76112ae75</a></p>

<p>* test/openssl/test_pkey_ec.rb (setup): Remove X25519 from @keys. X25519 	
is new in OpenSSL 1.1.0 but this is for key agreement and not for 	 
signing.</p>

<p>* test/openssl/test_pair.rb, test/openssl/test_ssl.rb, 	 
test/openssl/utils.rb: Set security level to 0 when using aNULL cipher 	 
suites.</p>

<p>* test/openssl/utils.rb: Use 1024 bits DSA key for client certificates.</p>

<p>* test/openssl/test_engine.rb: Run each test in separate process. 	  We
can no longer cleanup engines explicitly as ENGINE_cleanup() was 	 
removed. 	  <a
href="https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=6d4fb1d59e61aacefa25edc4fe5acfe1ac93f743">git.openssl.org/gitweb/?p=openssl.git;a=commit;h=6d4fb1d59e61aacefa25edc4fe5acfe1ac93f743</a></p>

<p>* ext/openssl/ossl_engine.c (ossl_engine_s_cleanup): Add a note to the 	 
RDoc for Engine.cleanup.</p>

<p>* ext/openssl/lib/openssl/digest.rb: Don&#39;t define constants for DSS, 	
DSS1 and SHA(-0) when using with OpenSSL 1.1.0. They are removed.</p>

<p>* test/openssl/test_digest.rb, test/openssl/test_pkey_dsa.rb, 	 
test/openssl/test_pkey_dsa.rb, test/openssl/test_ssl.rb, 	 
test/openssl/test_x509cert.rb, test/openssl/test_x509req.rb: Don&#39;t 	 
test unsupported hash functions.</p>

<p>Tue Jun  7 17:49:52 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive: Change test for encodings 	 
without any non-ASCII case conversions from ASCII-only test 	  to full
test.</p>

<p>Tue Jun  7 17:18:39 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c (rb_str_upcase_bang, rb_str_capitalize_bang, 	 
rb_str_swapcase_bang): Switch to use primitive.</p>

<p>Tue Jun  7 16:44:16 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c (rb_str_downcase_bang): Switch to use primitive except if 	 
conversion can be done ASCII-only.</p>

<p>Tue Jun  7 16:13:36 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive: Add regression tests for 	 
current ASCII-only case conversion.</p>

<p>Tue Jun  7 15:28:38 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive: Fix method name 	 
(generate_casefold_tests -&gt; generate_case_mapping_tests).</p>

<p>Tue Jun  7 15:05:13 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* regenc.h/c: Rename onigenc_not_support_case_map to 	 
onigenc_ascii_only_case_map.</p>

<p>* regenc.h: Add definition of onigenc_single_byte_ascii_only_case_map.</p>

<p>* enc/iso_8859_X.c, windows_125X.c, ascii.c, us-ascii.c, koi8_x.c: 	 
Replace onigenc_not_support_case_map by 	 
onigenc_single_byte_ascii_only_case_map.</p>

<p>* enc/big5.c, cp949.c, emacs_mule.c, euc_X.c, gbX.c, shift_jis.c, 	 
windows_31j.c: Replace onigenc_not_support_case_map by 	 
onigenc_ascii_only_case_map.</p>

<p>Tue Jun  7 14:57:09 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Check for SSL_CTX_set_min_proto_version() 	 
macro added in OpenSSL 1.1.0. Version-specific methods, such as 	 
TLSv1_method(), are deprecated in OpenSSL 1.1.0. We need to use 	 
version-flexible methods (TLS_*method() or SSLv23_*method()) and 	  disable
other protocol versions as necessary. 	  [ruby-core:75225] [Feature #12324]</p>

<p>* ext/openssl/ossl_ssl.c: Use SSL_CTX_set_<code>min,max</code>_proto_version() to 	 
fix the protocol version.</p>

<p>Tue Jun  7 12:55:34 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* regenc.c (onigenc_not_support_case_map): Move to end of file; 	 
(onigenc_single_byte_ascii_only_case_map): Add new function.</p>

<p>Tue Jun  7 09:26:37 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* regenc.c (onigenc_not_support_case_map): Rewrite to work correctly 	  in
ASCII range.</p>

<p>Mon Jun  6 23:00:00 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* appveyor.yml: Update libressl version to 2.3.5.</p>

<p>Mon Jun  6 18:37:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_throw_start): check if the iseq is symbol 	  proc,
class definition should not be a symbol proc. 	  [ruby-core:75856] [Bug
#12462]</p>

<p>Mon Jun  6 18:36:34 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Added UTF-16BE/LE and UTF-32BE/LE to supported encodings 	 
for Unicode case mapping.</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Tests for above 	 
functionality; fixed an encoding issue in assertion error message.</p>

<p>Mon Jun  6 17:29:35 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Speed up testing for small 	 
encodings by preselecting codepoints.</p>

<p>Mon Jun  6 17:10:50 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_cipher.c (ossl_cipher_free): Use EVP_CIPHER_CTX_free()
	  to free EVP_CIPHER_CTX allocated by EVP_CIPHER_CTX_new(). 	 
[ruby-core:75225] [Feature #12324]</p>

<p>Mon Jun  6 13:37:08 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c Change rb_str_casemap to use encoding primitive 	  case_map
instead of directly calling onigenc_unicode_case_map.</p>

<p>Mon Jun  6 13:16:46 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_mapping.rb: 	  Remove :lithuanian guard for
Unicode case mapping.</p>

<p>Mon Jun  6 10:39:56 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/openssl_missing.h: Include ruby/config.h. r55285 added 	 
some inline functions but VC does not recognize &#39;inline&#39; keyword.</p>

<p>Mon Jun  6 09:25:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (thread_start_func_2): report raised exception if 	 
report_on_exception flag is set.  [Feature #6647]</p>

<p>Mon Jun  6 01:36:24 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Check existence of SSL_is_server(). This 	 
function was introduced in OpenSSL 1.0.2. 	  [ruby-core:75225] [Feature
#12324]</p>

<p>* ext/openssl/openssl_missing.h: Implement SSL_is_server() if missing.</p>

<p>* ext/openssl/ossl_ssl.c (ssl_info_cb): Use SSL_is_server() to see if 	 
the SSL is server. The state machine in OpenSSL was rewritten and 	 
SSL_get_state() no longer returns SSL_ST_ACCEPT.</p>

<p>(ossl_ssl_cipher_to_ary, ossl_sslctx_session_get_cb): Add some 	 
`const`s to suppress warning.</p>

<p>Mon Jun  6 01:18:10 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_asn1.c (decode_bool): Do the same thing as 	 
d2i_ASN1_BOOLEAN() does by ourselves. This function is removed in 	 
OpenSSL 1.1.0. 	  [ruby-core:75225] [Feature #12324]</p>

<p>Mon Jun  6 00:34:16 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Check existence of accessor functions that 	 
don&#39;t exist in OpenSSL 0.9.8. OpenSSL 1.1.0 made most of its 	 
structures opaque and requires use of these accessor functions. 	 
[ruby-core:75225] [Feature #12324]</p>

<p>* <a href="ch">ext/openssl/openssl_missing.</a>: Implement them if
missing.</p>

<p>* ext/openssl/ossl*.c: Use these accessor functions.</p>

<p>* test/openssl/test_hmac.rb: Add missing test for HMAC#reset.</p>

<p>Mon Jun  6 00:00:13 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* <a href="ch">ext/openssl/openssl_missing.</a>: Implement
EVP_PKEY_get0_*() and 	  <code>RSA,DSA,EC_KEY,DH</code><em>get0</em>*() functions. 	 
OpenSSL 1.1.0 makes EVP_PKEY/RSA/DSA/DH opaque. We used to provide 	 
setter methods for each parameter of each PKey type, for example 	 
PKey::RSA#e=, but this is no longer possible because the new API 	 
RSA_set0_key() requires the &#39;n&#39; at the same time. This commit adds
	  deprecation warning to them and adds PKey::<strong>#set_</strong>
methods as direct 	  wrapper for those new APIs. For example, &#39;rsa.e =
3&#39; now needs to be 	  rewritten as &#39;rsa.set_key(rsa.n, 3,
rsa.d)&#39;. 	  [ruby-core:75225] [Feature #12324]</p>

<p>* <a href="ch">ext/openssl/ossl_pkey*.</a>: Use the new accessor
functions. Implement 	  RSA#set_<code>key,factors,crt_params</code>,
DSA#set_<code>key,pqg</code>, DH#set_<code>key,pqg</code>. 	  Emit a warning with rb_warning()
when old setter methods are used.</p>

<p>* test/drb/ut_array_drbssl.rb, test/drb/ut_drb_drbssl.rb, 	 
test/rubygems/test_gem_remote_fetcher.rb: Don&#39;t set a priv_key for DH 	
object that are used in tmp_dh_callback. Generating a new key pair 	  every
time should be fine - actually the private exponent is ignored 	  in
OpenSSL &gt;= 1.0.2f/1.0.1r even if we explicitly set. 	  <a
href="https://www.openssl.org/news/secadv/20160128.txt">www.openssl.org/news/secadv/20160128.txt</a></p>

<p>Sun Jun  5 22:06:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* configure.in: Fix the timing to detect the appropriate C++ compiler 	 
in OS X.</p>

<p>Sun Jun  5 21:42:24 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Check absence of CRYPTO_lock() to see if the 	 
OpenSSL has the new threading API. In OpenSSL &lt;= 1.0.2, an application 	
had to set locking callbacks to use OpenSSL in a multi-threaded 	 
environment. OpenSSL 1.1.0 now finds pthreads or Windows threads so we 	 
don&#39;t need to do something special. 	  [ruby-core:75225] [Feature
#12324]</p>

<p>Also check existence of *_up_ref(). Some structures in OpenSSL have 	  a
reference counter. We used to increment it with CRYPTO_add() which 	  is a
part of the old API.</p>

<p>* ext/openssl/openssl_missing.h: Implement *_up_ref() if missing.</p>

<p>* ext/openssl/ossl.c: Don&#39;t set locking callbacks if unneeded.</p>

<p>* ext/openssl/ossl_pkey.c, ext/openssl/ossl_ssl.c, 	 
ext/openssl/ossl_x509cert.c, ext/openssl/ossl_x509crl.c, 	 
ext/openssl/ossl_x509store.c: Use *_up_ref() instead of CRYPTO_add().</p>

<p>Sun Jun  5 21:38:13 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Check if RAND_pseudo_bytes() is usable. It is 	 
marked as deprecated in OpenSSL 1.1.0. 	  [ruby-core:75225] [Feature
#12324]</p>

<p>* ext/openssl/ossl_rand.c: Disable Random.pseudo_bytes if 	 
RAND_pseudo_bytes() is unavailable.</p>

<p>* test/openssl/test_random.rb: Don&#39;t test Random.pseudo_bytes if not 	
defined.</p>

<p>Sun Jun  5 19:06:40 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* NEWS: Add news about Unicode-wide case mapping for 	 
String/Symbol#upcase/downcase/swapcase/capitalize(!).</p>

<p>Sun Jun  5 15:24:33 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: 	  Remove :lithuanian guard
for Unicode case mapping.</p>

<p>Sun Jun  5 14:46:34 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Remove :lithuanian guard for Unicode case mapping.</p>

<p>Sat Jun  4 10:54:52 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* missing/crypt.h (struct crypt_data): remove unnecessary member 	 
“initialized”.</p>

<p>* missing/crypt.c (des_setkey_r): nothing to be initialized in 	 
crypt_data.</p>

<p>* configure.in (struct crypt_data): check for “initialized” in 	  struct
crypt_data, which may be only in glibc, and isn&#39;t on AIX 	  at least.</p>

<p>Sat Jun  4 10:38:39 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c: unify MAX_PATH, _MAX_PATH, and MAXPATHLEN to 	  PATH_MAX,
except for MAX_PATH in get_special_folder for an API 	  limit.</p>

<p>Fri Jun  3 21:27:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (process_options): rb_str_conv_enc() never set encoding 	  of the
source string, but returns the string itself if the 	  conversion failed. 
then the instance variable does not need to 	  be set again.</p>

<p>Fri Jun  3 18:04:37 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ruby.c (process_options): need to duplicate path before passing it to 	 
rb_str_conv_enc() because the function might call rb_enc_associate() 	 
internally.  this fixes test failures on Windows introduced at r55260.</p>

<p>Fri Jun  3 17:44:25 2016  Reiner Herrmann  &lt;reiner@reiner-h.de&gt;</p>

<p>* lib/mkmf.rb (create_makefile): sort lists of source and object 	  files
in generated Makefile, unless given by extconf.rb. 	  [Fix GH-1367]</p>

<p>Thu Jun  2 21:18:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/win32.c (get_special_folder): use SHGetPathFromIDListEx if 	 
available instead of old SHGetPathFromIDListW, to check the 	  buffer size.</p>

<p>Thu Jun  2 17:05:19 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (ruby_init_loadpath_safe): remove MAXPATHLEN restriction 	  for
Windows 10.</p>

<p>Thu Jun  2 16:51:35 2016  Koichi ITO  &lt;koic.ito@gmail.com&gt;</p>

<p>* misc/ruby-mode.el (ruby-here-doc-beg-re), 	  (ruby-here-doc-beg-match,
ruby-parse-partial): Support for 	  `squiggly heredoc&#39; syntax in
ruby-mode.  [Fix GH-1372]</p>

<p>Thu Jun  2 10:24:48 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Raise ArgumentError when invalid string is detected in 	  case
mapping methods.</p>

<p>* enc/unicode.c: Check for invalid string and signal with negative 	 
length value.</p>

<p>* test/ruby/enc/test_case_mapping.rb: Add tests for above.</p>

<p>* test/ruby/test_m17n_comb.rb: Add a message to clarify test failure.</p>

<p>Wed Jun  1 21:41:05 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Check existence of ASN1_TIME_adj(). The old 	 
ASN1_TIME_set() is not Year 2038 ready on sizeof(time_t) == 4 	 
environment. This function was added in OpenSSL 1.0.0. 	  [ruby-core:45552]
[Bug #6571]</p>

<p>* ext/openssl/ossl_asn1.c (ossl_time_split): Added. Split the argument 	 
(Time) into the number of days elapsed since the epoch and the 	  remainder
seconds to conform to ASN1_TIME_adj(). 	  (obj_to_asn1utime,
obj_to_asn1gtime): Use ossl_time_split() and 	  ASN1_*TIME_adj().</p>

<p>* ext/openssl/ossl_asn1.h: Add the function prototype for 	 
ossl_time_split().</p>

<p>* <a href="ch">ext/openssl/ossl_x509.</a>: Add ossl_x509_time_adjust().
Similarly to 	  obj_to_asn1*time(), use X509_time_adj_ex() instead of
X509_time_adj().</p>

<p>* ext/openssl/ossl_x509cert.c, ext/openssl/ossl_x509crl.c, 	 
ext/openssl/ossl_x509revoked.c: Use ossl_x509_time_adjust().</p>

<p>Wed Jun  1 15:58:20 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: revert r55237.  replace crypt, not crypt_r, and 	  check
if crypt is broken more.</p>

<p>* missing/crypt.c: move crypt_r.c</p>

<p>* string.c (rb_str_crypt): use crypt_r if provided by the system.</p>

<p>Wed Jun  1 14:07:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* missing/crypt_r.c (a64toi): initialize statically and fix out of 	 
bounds access when salt is not 7bit clean.</p>

<p>Wed Jun  1 11:34:59 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (MISSING): fixed build error introduced at r55237.</p>

<p>Wed Jun  1 09:48:06 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_crypt): use reentrant crypt_r.</p>

<p>Wed Jun  1 09:37:26 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* missing/crypt.c (des_setkey): void function never returns any value.</p>

<p>Wed Jun  1 09:16:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* crypt.h: separate header file from missing/crypt.c.</p>

<p>* missing/crypt.c (crypt_r, setkey_r, encrypt_r): add reentrant 	 
versions.</p>

<p>Wed Jun  1 02:25:38 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* missing/crypt.c: fix size macros to use configured values 	  for
platforms long is larger than 32bit. 	  [ruby-core:75792] [Bug #12446]</p>

<p>Tue May 31 17:28:46 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb (OptionParser::Completion.candidate): get rid of 	  nil
as key names.  [ruby-core:75773] [Bug #12438]</p>

<p>* lib/optparse.rb (OptionParser#make_switch): char class option 	  cannot
be NoArgument, default to RequiredArgument.</p>

<p>Tue May 31 00:30:11 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/socket/raddrinfo.c (host_str, port_str): Use StringValueCStr 	 
instead of (Safe)StringValue, to detect NUL byte in the string.</p>

<p>Mon May 30 22:02:01 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_asn1.c (time_to_time_t): Use NUM2TIMET() instead of 	 
NUM2LONG(). time_t may be larger than long. 	  [ruby-core:45552] [Bug
#6571]</p>

<p>Mon May 30 21:15:37 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Document current behavior for other case mapping methods 	  on
String. [ci skip]</p>

<p>Mon May 30 20:00:25 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Document current situation for String#downcase. [ci skip]</p>

<p>Mon May 30 18:29:28 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_sslctx_s_alloc): Enable the automatic 	 
curve selection for ECDH by calling SSL_CTX_set_ecdh_auto(). With 	  this a
TLS server automatically selects a curve which both the client 	  and the
server support to use in ECDH. This changes the default 	  behavior but
users can still disable ECDH by excluding &#39;ECDH&#39; cipher 	  suites
from the cipher list (with SSLContext#ciphers=). This commit 	  also
deprecate #tmp_ecdh_callback=. It was added in Ruby 2.3.0. It 	  wraps
SSL_CTX_set_tmp_ecdh_callback() which will be removed in OpenSSL 	  1.1.0.
Its callback receives two values &#39;is_export&#39; and
&#39;keylength&#39; 	  but both are completely useless for determining a
curve to use in 	  ECDH. The automatic curve selection was introduced to
replace this.</p>

<p>(ossl_sslctx_setup): Deprecate SSLContext#tmp_ecdh_callback=. Emit a 	 
warning if this is in use.</p>

<p>(ossl_sslctx_set_ecdh_curves): Add SSLContext#ecdh_curves=. Wrap 	 
SSL_CTX_set1_curves_list(). If it is not available, this falls back 	  to
SSL_CTX_set_tmp_ecdh().</p>

<p>(Init_ossl_ssl): Define SSLContext#ecdh_curves=.</p>

<p>* ext/openssl/extconf.rb: Check the existence of EC_curve_nist2nid(), 	 
SSL_CTX_set1_curves_list(), SSL_CTX_set_ecdh_auto() and 	 
SSL_CTX_set_tmp_ecdh_callback().</p>

<p>* <a href="ch">ext/openssl/openssl_missing.</a>: Implement
EC_curve_nist2nid() if 	  missing.</p>

<p>* test/openssl/test_pair.rb (test_ecdh_callback): Use 	 
EnvUtil.suppress_warning to suppress deprecated warning.</p>

<p>(test_ecdh_curves): Test that SSLContext#ecdh_curves= works.</p>

<p>* test/openssl/utils.rb (start_server): Use SSLContext#ecdh_curves=.</p>

<p>Mon May 30 16:28:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/raddrinfo.c (host_str, port_str): use RSTRING_LEN 	  instead
of strlen, since RSTRING_PTR StringValueCStr may not be 	  NUL-terminated
when SHARABLE_MIDDLE_SUBSTRING=1.  reported by 	  @tmtms, <a
href="http://twitter.com/tmtms/status/736910516229005312">twitter.com/tmtms/status/736910516229005312</a></p>

<p>Mon May 30 16:20:26 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (str_fill_term): return new pointer reallocated by 	  filling
terminator.</p>

<p>Mon May 30 14:54:58 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (enc_subseq): share the return value and 	  the
buffer as possible.</p>

<p>Mon May 30 14:50:25 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (str_substr, rb_str_aref): refactor not to create 	 
unnecessary empty string.</p>

<p>* string.c (str_byte_substr, str_byte_aref): ditto.</p>

<p>Mon May 30 00:09:37 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/-test-/auto_ext.rb: fixed a heedless bug introduced at r55198. 	 
this change will make RubyCI green.</p>

<p>Sun May 29 22:58:19 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regexec.c (ONIGENC_IS_MBC_ASCII_WORD): redefine optimized one. 	  WORD
of Ruby&#39;s ascii compatible encoding is always [a-zA-Z0-9_].</p>

<p>Sun May 29 22:44:19 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regexec.c (match_at): make compilers optimize harder.</p>

<p>Sun May 29 12:08:42 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/-test-/auto_ext.rb (auto_ext): utility method to create 	  extension
libraries for tests.</p>

<p>Sat May 28 20:40:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* misc/ruby-additional.el (ruby-insert-heredoc-code-block): insert 	  here
document code block for assert_separately mainly.</p>

<p>Sat May 28 20:34:19 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/test_unicode_normalize.rb: Add test to check for availability of 	 
Unicode data file; refactoring; fix an error with tests for destructive 	 
method (unicode_normalize!).</p>

<p>Sat May 28 19:08:36 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Add error messages to tests 	 
for data file availability; refactoring.</p>

<p>Sat May 28 14:00:10 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/lib/openssl/ssl.rb (SSLSocket): Move the implementation of 	
SSLSocket#initialize to C. Initialize the SSL (OpenSSL object) in it. 	 
Currently this is delayed until ossl_ssl_setup(), which is called from 	 
SSLSocket#accept or #connect. Say we call SSLSocket#hostname= with an 	 
illegal value. We expect an exception to be raised in #hostname= but 	 
actually we get it in the later SSLSocket#connect. Because the SSL is 	 
not ready at #hostname=, the actual call of SSL_set_tlsext_host_name() 	 
is also delayed. 	  This also fixes: [ruby-dev:49376] [Bug #11724]</p>

<p>* ext/openssl/ossl_ssl.c (ossl_ssl_initialize): Added. Almost the same 	 
as the Ruby version but this instantiate the SSL object at the same 	 
time.</p>

<p>(ossl_ssl_setup): Adjust to the changes. Just set the underlying IO to 	
the SSL.</p>

<p>(ssl_started): Added. Make use of SSL_get_fd(). This returns -1 if not 	
yet set by SSL_set_fd().</p>

<p>(ossl_ssl_data_get_struct): Removed. Now GetSSL() checks that the SSL 	 
exists.</p>

<p>(ossl_ssl_set_session): Don&#39;t call ossl_ssl_setup() here as now the
	  SSL is already instantiated in #initialize.</p>

<p>(ossl_ssl_shutdown, ossl_start_ssl, ossl_ssl_read_internal, 	  
ossl_ssl_write_internal, ossl_ssl_stop, ossl_ssl_get_cert, 	  
ossl_ssl_get_peer_cert, ossl_ssl_get_peer_cert_chain, 	  
ossl_ssl_get_version, ossl_ssl_get_cipher, ossl_ssl_get_state, 	  
ossl_ssl_pending, ossl_ssl_session_reused, 	   ossl_ssl_get_verify_result,
ossl_ssl_get_client_ca_list, 	   ossl_ssl_npn_protocol,
ossl_ssl_alpn_protocol, ossl_ssl_tmp_key): Use 	  GetSSL() instead of
ossl_ssl_data_get_struct(). Use ssl_started().</p>

<p>(Init_ossl_ssl): Add method declarations of SSLSocket#<code>initialize,</code>.</p>

<p>* ext/openssl/ossl_ssl.h (GetSSL): Check that the SSL is not NULL. It 	 
should not be NULL because we now set it in #initialize.</p>

<p>* ext/openssl/ossl_ssl_session.c (ossl_ssl_session_initialize): No need 	 
to check if the SSL is NULL.</p>

<p>Sat May 28 10:47:40 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* gems/bundled_gems: Update latest releases, power_assert-0.3.0, 	 
test-unit 3.1.9, minitest 5.9.0, did_you_mean 1.0.1</p>

<p>Sat May 28 10:45:40 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* addr2line.c: drop support for ATARI ST platform. It was 	  discontinued
more than two decades ago. [fix GH-1350] Patch by 	  @cremno 	*
include/ruby/ruby.h: ditto. 	* io.c: ditto.</p>

<p>Sat May 28 10:39:47 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Converted exception for 	 
unavailable Unicode data files to failed assertion.</p>

<p>Sat May 28 10:26:18 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/cgi/util.rb: added missing quote. 	  [fix GH-1363][ci skip] Patch by
@dwaller</p>

<p>Fri May 27 17:38:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (rb_local_constants_i): exclude hidden constants. 	 
[ruby-core:75575] [Bug #12389]</p>

<p>Fri May 27 17:09:44 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c (str_transcode0): scrub in the given encoding when 	  the
source encoding is given, not in the encoding of the 	  receiver. 
[ruby-core:75732] [Bug #12431]</p>

<p>Fri May 27 15:07:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args): remove nul padding which 	  caused
syntax error if fmt is not a string literal.</p>

<p>* include/ruby/ruby.h (rb_scan_args_verify): suppress array-bounds 	 
warnings by old clang.</p>

<p>* include/ruby/ruby.h (rb_scan_args0): make extractor macros 	  inline
functions, which do not validate the format and are 	  unnecessary to be
expanded.</p>

<p>Fri May 27 01:00:36 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* symbol.c (is_identchar): use ISDIGIT instead of rb_enc_isalnum. 	 
Though rb_enc_isalnum is encoding aware function, its argument here 	  is
*m, which is a single byte. Therefore ISDIGIT is faster.</p>

<p>* symbol.c (is_special_global_name): ditto.</p>

<p>* symbol.c (rb_enc_symname_type): ditto.</p>

<p>Fri May 27 00:39:40 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args): add nul padding here to 	  apply to
all references.</p>

<p>* include/ruby/ruby.h (rb_scan_args_verify): move length mismatch 	  check
outside conditional operators.</p>

<p>Thu May 26 14:21:10 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkey_dh.c (ossl_dh_compute_key): Check that the DH 	 
has &#39;p&#39; (the prime) before calling DH_size(). We can create a DH
with 	  no parameter but DH_size() does not check and dereferences NULL. 	 
[ruby-core:75720] [Bug #12428]</p>

<p>* ext/openssl/ossl_pkey_dsa.c (ossl_dsa_sign): Ditto. DSA_size() does 	 
not check dsa-&gt;q.</p>

<p>* ext/openssl/ossl_pkey_rsa.c (ossl_rsa_public_encrypt, 	 
ossl_rsa_public_decrypt, ossl_rsa_private_encrypt, 	 
ossl_rsa_private_decrypt): Ditto. RSA_size() does not check rsa-&gt;n.</p>

<p>Thu May 26 14:13:52 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args_count): verify length with 	  counting
variables together.</p>

<p>Thu May 26 09:45:41 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_comprehensive.rb: Add set of comprehensive 	 
(across most Unicode characters; later across most character encodings) 	 
tests for case mapping.</p>

<p>Thu May 26 05:00:13 2016  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* class.c (rb_define_class): Fix documentation.</p>

<p>Wed May 25 20:50:12 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (unescape_nonascii): scan hex up to only 3 characters. 	  [Bug
#12420] [Bug #12423]</p>

<p>Wed May 25 19:07:19 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Handle DOTLESS_i by hand because it isn&#39;t involved in
folding.</p>

<p>Wed May 25 18:30:53 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (fetch_token_in_cc): raise error if given octal escaped 	 
character is too big. [Bug #12420] [Bug #12423]</p>

<p>Wed May 25 17:45:15 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl, test/openssl: Drop OpenSSL &lt; 0.9.8 support.</p>

<p>Wed May 25 17:43:30 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/openssl_missing.h, ext/openssl/ossl.h: Remove 	  unnecessary
&#39;extern “C”&#39; blocks. We don&#39;t use C++ and these headers 	  are
local to ext/openssl, so there is no need to enclose with it.</p>

<p>Wed May 25 17:42:58 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: Remove check of OPENSSL_FIPS macro. This is 	 
unneeded because we can check the macro directly in source code, 	  just as
we already do for OPENSSL_NO_* macros.</p>

<p>* ext/openssl/ossl.c: Replace occurrences of HAVE_OPENSSL_FIPS with 	 
OPENSSL_FIPS.</p>

<p>Wed May 25 17:13:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_scan_args): merge code for n_trail.</p>

<p>Wed May 25 17:11:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args_validate): move failed 	  condition to
the terminal.  [ruby-core:75714] [Bug #12426]</p>

<p>Wed May 25 13:13:37 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regcomp.c: remove condition for debug output because prelude 	 
doesn&#39;t use regexp now.</p>

<p>Wed May 25 13:10:30 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regcomp.c (compile_length_tree): return error code immediately 	  if
compile_length_tree raised error [Bug #12418]</p>

<p>Wed May 25 08:01:39 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Fix flag error for switch from titlecase to lowercase.</p>

<p>* test/ruby/enc/test_case_mapping.rb: Tests for above error.</p>

<p>Wed May 25 01:13:55 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkey_ec.c (ec_key_new_from_group): Create a new 	 
EC_KEY on given EC group. Extracted from ossl_ec_key_initialize(). 	 
(ossl_ec_key_s_generate): Added. Create a new EC instance and 	  generate a
random private and public key. 	  (ossl_ec_key_initialize): Use
ec_key_new_from_group(). 	  (Init_ossl_ec): Define the new method
EC.generate. This change is 	  for consistency with other PKey types. 
[ruby-core:45541] [Bug #6567]</p>

<p>* test/openssl/test_pkey_ec.rb: Test that EC.generate works.</p>

<p>Wed May 25 00:37:16 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkey_ec.c (ossl_ec_key_generate_key): Fix up RDoc. 	 
(Init_ossl_ec): Rename EC#generate_key to EC#generate_key!. Make the 	  old
name an alias of #generate_key!. This change is for consistency 	  with
other PKey types.  [ruby-core:45541] [Bug #6567]</p>

<p>* test/openssl/test_pkey_ec.rb: Use EC#generate_key! instead of 	 
EC#generate_key.</p>

<p>Wed May 25 00:23:05 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args_set): check the arity after 	 
adjusting argc for an option hash, for optimization in simpler 	  cases.</p>

<p>Wed May 25 00:21:52 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (XCFLAGS): merge flags only for ruby itself from 	 
ruby_cflags.</p>

<p>Tue May 24 22:04:15 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_cipher.c (ossl_cipher_set_key, ossl_cipher_set_iv): 	 
Reject too long values as well as too short ones. Currently they 	  just
truncate the input but this would hide bugs and lead to 	  unexpected
encryption/decryption results.</p>

<p>* test/openssl/test_cipher.rb: Test that Cipher#key= and #iv= reject 	 
Strings with invalid length.</p>

<p>Tue May 24 21:32:21 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_x509ext.c (ossl_x509ext_set_value): Use 	 
ASN1_OCTET_STRING_set() instead of M_ASN1_OCTET_STRING_set(). Macros 	 
prefixed by “M_” are discouraged to be used from outside OpenSSL 	  <a
href="1">library</a>. 	  (ossl_x509ext_get_value): Likewise, use
ASN1_STRING_print() instead 	  of M_ASN1_OCTET_STRING_print(). 	  [1] <a
href="https://git.openssl.org/gitweb/?p=openssl.git;a=blob;f=CHANGES;h=bf61913d7b01212b4d8b2f3c13d71d645914f67c;hb=b6079a7835f61daa9fb2cbf9addfa86049523933#l878">git.openssl.org/gitweb/?p=openssl.git;a=blob;f=CHANGES;h=bf61913d7b01212b4d8b2f3c13d71d645914f67c;hb=b6079a7835f61daa9fb2cbf9addfa86049523933#l878</a></p>

<p>* ext/openssl/ossl.h: Include openssl/asn1.h instead of 	 
openssl/asn1_mac.h. It just includes openssl/asn1.h and defines some 	 
additional “M_” macros.</p>

<p>Tue May 24 18:52:11 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args_verify): verify the format to 	  scan
if no invalid chars and variable argument length matching, 	  at the
compile time if possible.</p>

<p>Tue May 24 17:18:46 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/defines.h (ERRORFUNC, WARNINGFUNC): add fallback 	 
definitions.</p>

<p>Tue May 24 16:37:43 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (ruby_cflags): separate from optflags [Bug #12409] 	 
-fexcess-precision=standard and -fp-model precise are set to this now.</p>

<p>* configure.in (cflags): use ruby_cflags.</p>

<p>Tue May 24 16:20:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (ERRORFUNC, WARNINGFUNC): __error__ and __warning__ 	 
attributes take a parenthesized string literal.</p>

<p>Tue May 24 12:35:56 2016  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>* common.mk: sort lines, and add missing dependencies suggested 	  by
tool/update-deps</p>

<p>Mon May 23 21:33:36 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/missing.h (isfinite): move from numeric.c.</p>

<p>Mon May 23 21:09:06 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl.c (Init_openssl): Avoid reference to unset global 	 
variable. ossl_raise() may be called before dOSSL is set. Since 	  global
variables default to 0 and the default value of dOSSL set in 	 
Init_openssl() is also Qfalse, there is no real issue but confusing. 	 
Patch by Bertram Scharpf &lt;software@bertram-scharpf.de&gt; 	 
[ruby-core:58264] [Bug #9101]</p>

<p>Mon May 23 20:32:16 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_asn1.c, ext/openssl/ossl_bn.c, 	 
ext/openssl/ossl_cipher.c, ext/openssl/ossl_digest.c 	 
ext/openssl/ossl_engine.c, ext/openssl/ossl_ns_spki.c 	 
ext/openssl/ossl_pkcs12.c, ext/openssl/ossl_pkcs7.c 	 
ext/openssl/ossl_pkey.c, ext/openssl/ossl_pkey_ec.c 	 
ext/openssl/ossl_rand.c, ext/openssl/ossl_ssl.c 	 
ext/openssl/ossl_x509attr.c, ext/openssl/ossl_x509cert.c 	 
ext/openssl/ossl_x509ext.c, ext/openssl/ossl_x509store.c: Use 	 
StringValueCStr() where NUL-terminated string is expected.</p>

<p>Mon May 23 20:20:12 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (isfinite): get rid of a warning on 	 
cygwin. [Bug #<a href="ruby-core:75691">12417]</a></p>

<p>Mon May 23 19:41:27 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_rand.c (ossl_rand_egd, ossl_rand_egd_bytes): 	 
RAND_egd<code>_bytes,</code>() return -1 on failure, not 0. 	  Patch by cremno phobia
&lt;cremno@mail.ru&gt; 	  [ruby-core:63795] [Bug #10053] 	 
(ossl_pseudo_bytes): Similar, RAND_pseudo_bytes() may return 0 or 	  -1 on
failure.</p>

<p>Mon May 23 15:52:07 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (isfinite): isfinite does not always 	 
exist.  fixed build error on Windows introduced at r55123.</p>

<p>Mon May 23 13:19:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args0): make compile error if the 	  format
is wrong or does not match with the variable argument 	  length if
possible.</p>

<p>Mon May 23 12:47:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args0): raise fatal error if 	  variable
argument length does not match, it is a bug in the code 	  which uses
rb_scan_args, not a runtime error.</p>

<p>Mon May 23 12:30:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/bigdecimal/bigdecimal.c (GetVpValueWithPrec): consider 	  non-finite
float values not to raise FloatDomainError. 	  [ruby-core:75682] [Bug
#12414]</p>

<p>Mon May 23 12:21:18 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_fill): suppress warnings: &#39;item&#39; may be used 	 
uninitialized in this function</p>

<p>Mon May 23 07:41:49 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* dir.c (dir_close): update RDoc for 2.3 #close change 	 
[ruby-core:75679] [Bug #12413]</p>

<p>Sun May 22 20:01:21 2016  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* lib/drb/timeridconv.rb: use finalizer trick instead of thread.</p>

<p>* test/drb/ut_timerholder.rb: ditto.</p>

<p>Sun May 22 17:25:18 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_options.rb: adjust test class name 	  to match
file name</p>

<p>Sun May 22 17:24:07 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* rename test/ruby/enc/test_casing_options.rb to test_case_options.rb 	 
for consistency</p>

<p>Sun May 22 17:06:55 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* transcode.c (enc_arg, str_transcode_enc_args, econv_args): 	  remove
volatile, and add GC guards in callers. 	  [ruby-core:75664] [Bug #12411]</p>

<p>Sun May 22 16:27:00 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/-test-/integer/core_ext.c: move testutil/integer.c.</p>

<p>* test/lib/-test-/integer.rb: extract implementation details from 	 
test/unit/assertions.rb.  [Bug #12408]</p>

<p>Sun May 22 14:57:43 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* include/ruby/oniguruma.h: Extend OnigEncodingTypeDefine to define a 	 
new encoding primitive &#39;case_map&#39; for case mapping</p>

<p>* enc/utf-8.c, utf_16be/le.c, utf_32be/le.c: 	  add
onigenc_unicode_case_map as case_map primitive</p>

<p>* enc/ascii.c, big5.c, cp949.c, emacs_mule.c, euc_jp/kr/tw.c, gb18030.c, 	
gbk.c, iso_8859_1/2/3/4/5/6/7/8/9/10/11/13/14/15/16.c, koi8_r/u.c, 	 
shift_jis.c, us_ascii.c, windows_1250/1251/1252.c: 	  add
onigenc_not_support_case_map as case_map primitive</p>

<p>Sun May 22 14:45:45 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* regenc.h/c: Define new function onigenc_not_support_case_map</p>

<p>Sun May 22 12:14:06 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args): use original rb_scan_args 	  when
fmt is dynamic.</p>

<p>Sun May 22 11:41:12 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* class.c (rb_scan_args): moved to bottom of the file to make the 	 
effect of `#undef rb_scan_args` the minimum.</p>

<p>* include/ruby/ruby.h (rb_scan_args): overwrite only if GCC and 	 
optimized. Visual C++ 14 or later can compile it but make it 	 
conservative.</p>

<p>Sat May 21 22:45:50 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args): don&#39;t use ALWAYS_INLINE with 	 
`inline`.  if gcc needs this duplication, do in ALWAYS_INLINE macro.</p>

<p>Sat May 21 21:11:56 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_scan_args): use <em>VA_ARGS</em> instead of 	 
va_arg to allow compilers optimize more aggressive. 	  <a
href="https://gustedt.wordpress.com/2011/07/10/avoid-writing-va_arg-functions">gustedt.wordpress.com/2011/07/10/avoid-writing-va_arg-functions</a>/
	  rb_scan_args is now expected to be statically resolved.</p>

<p>Sun May 22 02:41:52 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/zlib/zlib.c: remove hacky macro introduced at r30437.</p>

<p>* ext/zlib/zlib.c (gzfile_make_header): cast as long (instead of int).</p>

<p>* ext/zlib/zlib.c (gzfile_make_footer): ditto.</p>

<p>Sat May 21 21:07:18 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (ALWAYS_INLINE): force compilers the function inlined.</p>

<p>Sat May 21 16:16:03 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_ssl_stop): Don&#39;t free the SSL struct 	 
here. Since some methods such as SSLSocket#connect releases GVL, 	  there
is a chance of use after free if we free the SSL from another 	  thread.
SSLSocket#stop was documented as “prepares it for another 	  connection” so
this is a slightly incompatible change. However when 	  this sentence was
added (r30090, Add toplevel documentation for 	  OpenSSL, 2010-12-06), it
didn&#39;t actually. The current behavior is 	  from r40304 (Correct
shutdown behavior w.r.t GC., 2013-04-15). 	  [ruby-core:74978] [Bug #12292]</p>

<p>* ext/openssl/lib/openssl/ssl.rb (sysclose): Update doc.</p>

<p>* test/openssl/test_ssl.rb: Test this.</p>

<p>Sat May 21 14:41:14 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl.c: [DOC] Fix SSL client example. The variable name 	 
was wrong. Patch by Andreas Tiefenthaler &lt;at@an-ti.eu&gt; (@pxlpnk). 	 
[GH ruby/openssl#32]</p>

<p>Sat May 21 14:25:38 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkey_ec.c: rename PKey::EC#private_key? and 	 
#public_key? to #private? and #public? for consistency with other 	  PKey
types. Old names remain as alias.  [ruby-core:45541] [Bug #6567]</p>

<p>* test/openssl/test_pkey_ec.rb (test_check_key): check private? and 	 
public? works correctly.</p>

<p>Sat May 21 12:40:36 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/lib/openssl/buffering.rb (read_nonblock, readpartial): 	 
Remove impossible EOFError raise. Patch by Zach Anker 	 
&lt;zanker@squareup.com&gt;.  [GH ruby/openssl#23]</p>

<p>Sat May 21 11:18:42 2016  Evgeni Golov  &lt;evgeni@golov.de&gt;</p>

<p>* lib/ipaddr.rb: [DOC] fix documentation of IN6MASK to mention 	  IPv6. 
[Fix GH-1349]</p>

<p>Sat May 21 11:12:53 2016  Dan Martinez  &lt;dfm@razorwind.org&gt;</p>

<p>* io.c (Init_IO): [DOC] define dummy ARGF instead of ARGF.class to 	 
re-enable the generation of ARGF documentation.  [Fix GH-1358]</p>

<p>Sat May 21 11:07:29 2016  0x01f7  &lt;souk.0x01f7@gmail.com&gt;</p>

<p>* doc/syntax/methods.rdoc (Method Names): add proper closing tag. 	  [Fix
GH-1356]</p>

<p>Sat May 21 09:26:28 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_CHECK_SETJMP): fix missing macro definition 	  for
the configured result.  fix up r55021.</p>

<p>Sat May 21 00:36:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_execarg_commandline): build command line string 	  from
argument vector in rb_execarg. 	  [ruby-core:75611] [Bug #12398]</p>

<p>Fri May 20 23:25:42 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl.c (ossl_pem_passwd_value): Added. Convert the 	 
argument to String with StringValue() and validate the length is in 	 
4..PEM_BUFSIZE. PEM_BUFSIZE is a macro defined in OpenSSL headers. 	 
(ossl_pem_passwd_cb): When reading/writing encrypted PEM format, we 	  used
to pass the password to PEM_def_callback() directly but it was 	 
problematic. It is not NUL character safe. And surprisingly, it 	  silently
truncates the password to 1024 bytes.  [GH ruby/openssl#51]</p>

<p>* ext/openssl/ossl.h: Add function prototype declaration of newly 	  added
ossl_pem_passwd_value().</p>

<p>* ext/openssl/ossl_pkey.c (ossl_pkey_new_from_data): Use 	 
ossl_pem_passwd_value() to validate the password String.</p>

<p>* ext/openssl/ossl_pkey_dsa.c (ossl_dsa_initialize, ossl_dsa_export): 	 
ditto.</p>

<p>* ext/openssl/ossl_pkey_ec.c (ossl_ec_key_initialize, 	 
ossl_ec_key_to_string): ditto.</p>

<p>* ext/openssl/ossl_pkey_rsa.c (ossl_rsa_initialize, ossl_rsa_export): 	 
ditto.</p>

<p>* test/openssl/test_pkey_<code>dsa,ec,rsa</code>.rb: test this.</p>

<p>Fri May 20 23:45:53 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* id_table.c (list_id_table_init): When unaligned word access is 	 
prohibited and sizeof(VALUE) is 8 (64-bit machines), 	  capa should always
be even number for 8-byte word alignment 	  of the values of a table. This
code assumes that sizeof(ID) is 4, 	  sizeof(VALUE) is 8, and xmalloc()
returns 8-byte aligned memory. 	  This fixes bus error on 64-bit SPARC
Solaris 10. 	  [Bug #<a href="ruby-dev:49631">12406]</a></p>

<p>Fri May 20 22:30:09 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* symbol.h (rb_id2sym): Use HAVE_BUILTIN___BUILTIN_CONSTANT_P</p>

<p>Fri May 20 22:19:00 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* ext/date/date_core.c: [DOC] fix typos. 	  [fix GH-1360] patched by
@soundasleep</p>

<p>Fri May 20 21:26:58 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* include/ruby/defines.h (RB_GNUC_EXTENSION, RB_GNUC_EXTENSION_BLOCK): 	 
macros for skipping __extension__ on non-GCC compilers. 	* eval_error.c
(warn_print): use RB_GNUC_EXTENSION_BLOCK instead of 	  __extension__
because __extension__ is a GNU extension. 	  Fix compile error on Solaris
10 with Oracle Solaris Studio 12.x. 	  [Bug #12397] [ruby-dev:49629]. 	*
internal.h (rb_fstring_cstr, rb_fstring_enc_cstr): ditto 	*
include/ruby/encoding.h (rb_enc_str_new, rb_enc_str_new_cstr): ditto 	*
include/ruby/intern.h (rb_str_new, rb_str_new_cstr, 	  rb_usascii_str_new,
rb_utf8_str_new, rb_tainted_str_new_cstr, 	  rb_usascii_str_new_cstr,
rb_utf8_str_new_cstr, 	  rb_external_str_new_cstr, rb_locale_str_new_cstr,
	  rb_str_buf_new_cstr, rb_str_cat_cstr, rb_exc_new_cstr): ditto</p>

<p>Fri May 20 21:17:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/win32ole/win32ole.c (fole_missing): make substring or dup to 	 
share the content if possible.</p>

<p>Fri May 20 19:48:48 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h (NEW_PARTIAL_MEMO_FOR): shrink buffer array not to 	  mark
non-VALUE fields.  fix check_rvalue_consistency abort with 	 
RGENGC_CHECK_MODE=2.</p>

<p>* internal.h (NEW_CMP_OPT_MEMO): exclude struct cmp_opt_data from 	  the
valid array range.</p>

<p>* enum.c (slicewhen_i): exclude inverted too.</p>

<p>Thu May 19 21:21:57 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* re.c (rb_reg_match_m_p): [DOC] fix return value in rdoc.</p>

<p>* test/ruby/test_regexp.rb (TestRegexp#test_match_p): add some 	  tests
from document.</p>

<p>Thu May 19 13:22:44 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl.c (Init_openssl): register an ex_data index for 	 
X509_STORE and X509_STORE_CTX respectively. Since they don&#39;t share 	 
the ex_data index registry, we can&#39;t use the same index. 	 
(ossl_verify_cb): use the the correct index.</p>

<p>* ext/openssl/ossl_ssl.c (ossl_ssl_verify_callback): ditto.</p>

<p>* ext/openssl/ossl_x509store.c (ossl_x509store_set_vfy_cb): ditto. 	 
(ossl_x509stctx_verify): ditto.</p>

<p>* ext/openssl/ossl.h (void ossl_clear_error): add extern declarations 	 
of ossl_store_<code>ctx_,</code>ex_verify_cb_idx.</p>

<p>* ext/openssl/openssl_missing.c: remove X509_STORE_set_ex_data and 	 
X509_STORE_get_ex_data.</p>

<p>* ext/openssl/openssl_missing.h: implement X509_STORE_get_ex_data, 	 
X509_STORE_set_ex_data and X509_STORE_get_ex_new_index as macros.</p>

<p>Thu May 19 13:11:35 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_x509attr.c (ossl_x509attr_set_value): check that the 	 
argument is an OpenSSL::ASN1::Data before converting to ASN1_TYPE. 	  This
fixes SEGV on OpenSSL::X509::Attribute#value=(non-asn1-value).</p>

<p>* test/openssl/test_x509attr.rb: add tests for OpenSSL::X509::Attribute.</p>

<p>Thu May 19 12:10:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* re.c (rb_reg_match_m_p): fix match against empty string. 	 
rb_str_offset returns the end when the position exceeds the 	  length.  fix
the range parameter of onig_search. 	  [ruby-core:75604] [Bug #12394]</p>

<p>Thu May 19 11:37:36 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* re.c (rb_reg_match_m_p): should return false if no match, as the 	 
document says.  [Feature #8110]</p>

<p>Thu May 19 00:17:01 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (reg_names_iter): specify capacify</p>

<p>Wed May 18 21:29:59 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* thread.c (recursive_list_access): a object id may be a Bignum.  so, 	 
the list must be a objhash, instead of a identhash. 	  this fixes many test
errors on mswin64 CI.</p>

<p>Wed May 18 19:33:54 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (rb_reg_match_m_p): Introduce Regexp#match?, which returns 	  bool
and doesn&#39;t save backref.</p>

<p>Wed May 18 16:52:03 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkcs12.c (ossl_pkcs12_initialize): pop errors 	  leaked
by PKCS12_parse(). This is a bug in OpenSSL, which exists 	  in the
versions before the version 1.0.0t, 1.0.1p, 1.0.2d.</p>

<p>Wed May 18 16:04:54 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/downloader.rb (Downloader::RubyGems.download): verify gems 	  only
if RubyGems is 2.4 or later.  old RubyGems fails to verify 	  almost all of
bundled gems.</p>

<p>Wed May 18 14:52:38 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_modify_expand): check integer overflow. 	 
[ruby-core:75592] [Bug #12390]</p>

<p>Wed May 18 13:11:44 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (match_ary_subseq): get subseq of match array without creating 	 
temporary array.</p>

<p>* re.c (match_ary_aref): get element(s) of match array without creating 	 
temporary array.</p>

<p>* re.c (match_aref): Use match_ary_subseq with handling irregulars.</p>

<p>* re.c (match_values_at): Use match_ary_aref.</p>

<p>Wed May 18 13:03:07 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_x509cert.c (ossl_x509_verify): X509_verify() 	  family
may put errors on 0 return (0 means verification failure). 	  Clear OpenSSL
error queue before return to Ruby. Since the queue is 	  thread global,
remaining errors in the queue can cause an unexpected 	  error in the next
OpenSSL operation.  [ruby-core:48284] [Bug #7215]</p>

<p>* ext/openssl/ossl_x509crl.c (ossl_x509crl_verify): ditto.</p>

<p>* ext/openssl/ossl_x509req.c (ossl_x509req_verify): ditto.</p>

<p>* ext/openssl/ossl_x509store.c (ossl_x509stctx_verify): ditto.</p>

<p>* ext/openssl/ossl_pkey_dh.c (dh_generate): clear the OpenSSL error 	 
queue before re-raising exception.</p>

<p>* ext/openssl/ossl_pkey_dsa.c (dsa_generate): ditto.</p>

<p>* ext/openssl/ossl_pkey_rsa.c (rsa_generate): ditto.</p>

<p>* ext/openssl/ossl_ssl.c (ossl_start_ssl): ditto.</p>

<p>* test/openssl: check that OpenSSL.errors is empty every time after 	 
running a test case.</p>

<p>Wed May 18 12:07:42 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl.c (ossl_clear_error): Extracted from 	 
ossl_make_error(). This prints errors in the OpenSSL error queue if 	 
OpenSSL.debug is true, and clears the queue. 	  (ossl_make_error): use
ossl_clear_error().</p>

<p>* ext/openssl/ossl.h: add prototype declaration of ossl_make_error(). 	 
(OSSL_BIO_reset) use ossl_clear_error() to clear the queue. Clearing 	 
silently makes debugging difficult.</p>

<p>* ext/openssl/ossl_engine.c (ossl_engine_s_by_id): ditto.</p>

<p>* ext/openssl/ossl_ns_spki.c (ossl_spki_initialize): ditto.</p>

<p>* ext/openssl/ossl_pkcs7.c (ossl_pkcs7_verify): ditto.</p>

<p>* ext/openssl/ossl_pkey_dsa.c (ossl_dsa_initialize): ditto.</p>

<p>* ext/openssl/ossl_pkey_ec.c (ossl_ec_key_initialize): ditto. 	 
(ossl_ec_group_initialize): ditto.</p>

<p>* ext/openssl/ossl_ssl.c (ossl_ssl_shutdown): ditto.</p>

<p>Wed May 18 11:53:49 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_pkey_ec.c (ossl_ec_point_mul): Validate the 	 
arguments before passing to EC_POINT(s)_mul(). Add description of this 	 
method.  [ruby-core:65152] [Bug #10268]</p>

<p>* test/openssl/test_pkey_ec.rb (test_ec_point_mul): Test that 	 
OpenSSL::PKey::EC::Point#mul works.</p>

<p>Wed May 18 11:19:59 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/ossl_bn.c (try_convert_to_bnptr): Extracted from 	 
GetBNPtr(). This doesn&#39;t raise exception but returns NULL on error. 	 
(GetBNPtr): Raise TypeError if conversion fails. 	  (ossl_bn_eq): Implement
BN#==. 	  (ossl_bn_eql): #eql? should not raise TypeError even if the
argument 	  is not compatible with BN. 	  (ossl_bn_hash): Implement
BN#hash.</p>

<p>* ext/openssl/ossl_bn.c (Init_ossl_bn): Define #== and #hash.</p>

<p>* test/openssl/test_bn.rb: Test BN#eql?, #== and #hash</p>

<p>Wed May 18 10:17:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RB_INTEGER_TYPE_P): new macro and 	  underlying
inline function to check if the object is an 	  Integer (Fixnum or Bignum).</p>

<p>Wed May 18 09:52:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* enum.c (enum_sum, hash_sum, hash_sum_i, enum_sum_i, sum_iter): 	 
Optimize for hashes when each method isn&#39;t redefined.</p>

<p>Wed May 18 09:14:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* enum.c (enum_sum, int_range_sum): Extract int_range_sum from 	 
enum_sum.</p>

<p>Wed May 18 03:16:06 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* re.c (match_values_at): fix regression at r55036. 	  MatchData#values_at
accepts Range.</p>

<p>Wed May 18 02:02:58 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (match_aref): remove useless condition and call rb_fix2int. 	 
rb_reg_nth_match handles negative index.</p>

<p>Wed May 18 01:57:43 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (match_values_at): MatchData#values_at supports named captures 	 
[Feature #9179]</p>

<p>* re.c (namev_to_backref_number): separated.</p>

<p>Wed May 18 00:05:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* enum.c (enum_sum): Optimize for a range from int to int.</p>

<p>* test/ruby/test_enum.rb (test_range_sum): Move from test_range.rb, 	  and
add assertions for some conditions.</p>

<p>* test/ruby/test_enum.rb (test_hash_sum): Move from test_hash.rb.</p>

<p>* test/ruby/test_hash.rb, test/ruby/test_range.rb: Remove test_sum.</p>

<p>Tue May 17 23:08:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* enum.c (enum_sum): [DOC] Write documentation.</p>

<p>Tue May 17 22:53:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* enum.c (enum_sum): Implement Enumerable#sum.</p>

<p>* test/ruby/test_enum.rb (test_sum): Test sum for Enumerable.</p>

<p>* test/ruby/test_hash.rb (test_sum): Test sum for Hash.</p>

<p>* test/ruby/test_range.rb (test_sum): Test sum for Range.</p>

<p>Tue May 17 22:11:41 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* object.c, numeric.c, enum.c, ext/-test-/bignum/mul.c, 	 
lib/rexml/quickpath.rb, lib/rexml/text.rb, lib/rexml/xpath_parser.rb, 	 
lib/rubygems/specification.rb, lib/uri/generic.rb, 	 
bootstraptest/test_eval.rb, basictest/test.rb, 	 
test/-ext-/bignum/test_big2str.rb, test/-ext-/bignum/test_div.rb, 	 
test/-ext-/bignum/test_mul.rb, test/-ext-/bignum/test_str2big.rb, 	 
test/csv/test_data_converters.rb, test/date/test_date.rb, 	 
test/json/test_json_generate.rb, test/minitest/test_minitest_mock.rb, 	 
test/openssl/test_cipher.rb, test/rexml/test_jaxen.rb, 	 
test/ruby/test_array.rb, test/ruby/test_basicinstructions.rb, 	 
test/ruby/test_bignum.rb, test/ruby/test_case.rb, 	 
test/ruby/test_class.rb, test/ruby/test_complex.rb, 	 
test/ruby/test_enum.rb, test/ruby/test_eval.rb, 	  test/ruby/test_iseq.rb,
test/ruby/test_literal.rb, 	  test/ruby/test_math.rb,
test/ruby/test_module.rb, 	  test/ruby/test_numeric.rb,
test/ruby/test_range.rb, 	  test/ruby/test_rational.rb,
test/ruby/test_refinement.rb, 	  test/ruby/test_rubyvm.rb,
test/ruby/test_struct.rb, 	  test/ruby/test_variable.rb,
test/rubygems/test_gem_specification.rb, 	  test/thread/test_queue.rb: Use
Integer instead of Fixnum and Bignum.</p>

<p>Tue May 17 15:26:10 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* [Feature #12005] Unify Fixnum and Bignum into Integer</p>

<p>* include/ruby/ruby.h (rb_class_of): Return rb_cInteger for fixnums.</p>

<p>* insns.def (INTEGER_REDEFINED_OP_FLAG): Unified from 	 
FIXNUM_REDEFINED_OP_FLAG and BIGNUM_REDEFINED_OP_FLAG.</p>

<p>* vm_core.h: Ditto.</p>

<p>* vm_insnhelper.c (opt_eq_func): Use INTEGER_REDEFINED_OP_FLAG instead 	 
of FIXNUM_REDEFINED_OP_FLAG.</p>

<p>* vm.c (vm_redefinition_check_flag): Use rb_cInteger instead of 	 
rb_cFixnum and rb_cBignum. 	  (C): Use Integer instead of Fixnum and
Bignum.</p>

<p>* numeric.c (fix_succ): Removed. 	  (Init_Numeric): Define Fixnum as
Integer.</p>

<p>* bignum.c (bignew): Use rb_cInteger instead of rb_cBignum. 	 
(rb_int_coerce): replaced from rb_big_coerce and return fixnums 	  as-is. 	
(Init_Bignum): Define Bignum as Integer. 	  Don&#39;t define ===.</p>

<p>* error.c (builtin_class_name): Return “Integer” for fixnums.</p>

<p>* sprintf.c (ruby__sfvextra): Use rb_cInteger instead of rb_cFixnum.</p>

<p>* ext/-test-/testutil: New directory to test. 	  Currently it provides
utilities for fixnum and bignum.</p>

<p>* ext/json/generator/generator.c: Define mInteger_to_json.</p>

<p>* lib/mathn.rb (Fixnum#/): Redefinition removed.</p>

<p>Tue May 17 11:58:58 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_CHECK_BUILTIN_SETJMP): declare t as NORETURN 	  to
suppress warnings by -Wsuggest-attribute=noreturn. 	  [ruby-core:75510]
[Bug #12383]</p>

<p>Tue May 17 10:40:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_CHECK_SETJMP): needs the header and proper 	 
arguments for builtin setjmp functions.</p>

<p>Mon May 16 20:00:30 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.h: Additional uses of ONIG_CASE_MAPPING compilation switch</p>

<p>Mon May 16 19:46:33 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* include/ruby/oniguruma.h: Introducing ONIG_CASE_MAPPING compilation 	 
switch</p>

<p>* include/ruby/oniguruma.h, enc/unicode.h: Using ONIG_CASE_MAPPING 	 
compilation switch</p>

<p>Mon May 16 19:29:31 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* gems/bundled_gems: Update xmlrpc-0.1.1. xmlrpc-0.1.0 didn&#39;t allow 	 
to install on 2.4.0dev.</p>

<p>Mon May 16 13:28:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (FUNC_STDCALL, FUNC_CDECL, FUNC_FASTCALL): set 	  macro
names explicitly to the old names, which are accidentally 	  changed at
r54985, for backward compatibilities. 	  fiddle also depends on these names
to fallback to ANSI names. 	  [ruby-core:75494] [Bug #12377]</p>

<p>Mon May 16 11:39:02 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/xmlrpc.rb, lib/xmlrpc/*, test/xmlrpc: XMLRPC is bundled gem 	  on
Ruby 2.4. It is extracted to <a
href="https://github.com/ruby/xmlrpc">github.com/ruby/xmlrpc</a> 	 
[Feature #<a href="ruby-core:74239">12160]</a> 	* gems/bundled_gems: ditto.</p>

<p>Mon May 16 06:06:21 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* proc.c: fix RDoc of Proc#===/call/yield/[] 	  [Bug #12332]</p>

<p>Sun May 15 20:55:31 2016  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* lib/drb/timeridconv.rb: don&#39;t use keeper thread. [Bug #12342]</p>

<p>* test/drb/ut_timerholder.rb: ditto.</p>

<p>Sun May 15 16:15:25 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_entry): extract rb_ary_elt to organize if-conditions 	 
and check whether is embedded at once.</p>

<p>Sun May 15 10:57:26 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_get_ev_const): warn deprecated constant even 	  in
the class context.  [ruby-core:75505] [Bug #12382]</p>

<p>Sun May 15 03:13:01 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* iseq.h (struct iseq_compile_data): use struct rb_id_table 	  instead of
st_table.</p>

<p>* iseq.c (prepare_iseq_build): don&#39;t allocate ivar_cache_table 	 
until it has at least one element.</p>

<p>* iseq.c (compile_data_free): free ivar_cache_table only if it 	  is
allocated.</p>

<p>* compile.c (get_ivar_ic_value): allocate if the table is not 	  allocated
yet.</p>

<p>Sat May 14 09:04:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (pkg_config): use xsystem consistently to set up 	  library
path environment variable as well as latter pkg-config 	  calls. 
[ruby-dev:49619] [Bug #12379]</p>

<p>Sat May 14 00:16:54 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (make_seed_value): append leading-zero-guard and get 	  rid of
making a local copy of the seed.</p>

<p>Fri May 13 08:46:42 2016  cremno  &lt;cremno@mail.ru&gt;</p>

<p>* NEWS: drop FreeBSD &lt; 4 support.  [Fix GH-1339] 	  The most recent
version affected by this is 3.5 and was released 	  in 2000. 	  <a
href="https://www.freebsd.org/releases/3.5R/announce.html">www.freebsd.org/releases/3.5R/announce.html</a>
	  <a
href="https://en.wikipedia.org/wiki/History_of_FreeBSD#Version_history">en.wikipedia.org/wiki/History_of_FreeBSD#Version_history</a></p>

<p>Fri May 13 03:12:09 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/defines.h (GCC_VERSION_SINCE): moved from internal.h.</p>

<p>Fri May 13 03:11:20 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (__builtin_constant_p): check.</p>

<p>* internal.h: Use HAVE_BUILTIN___BUILTIN_CONSTANT_P</p>

<p>Fri May 13 03:10:39 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: use alternative keyword 	  to avoid macros conflicts with
them.</p>

<p>Thu May 12 01:54:08 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/mkmf.rb (try_func): get rid of conflict of declarations of 	 
main().  checking local symbol reference does not make sense.</p>

<p>Thu May 12 00:18:19 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/Makefile.sub (HAVE_QSORT_S): use qsort_s only for Visual Studio 	 
2012 or later, because VS2010 seems to causes a SEGV in 	 
test/ruby/test_enum.rb.</p>

<p>Wed May 11 23:59:47 2016  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_getivar): describe fast-path explicit 	  (compiler
friendly). [Bug #12274].</p>

<p>Wed May 11 21:30:07 2016  Masaya Tarui  &lt;tarui@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_compile_each): share InlineCache during same 	  instance
variable accesses. Reducing memory consumption, 	  rising cache hit rate
and rising branch prediction hit rate 	  are expected. A part of [Bug
#12274].</p>

<p>* iseq.h (struct iseq_compile_data): introduce instance 	  variable IC
table for sharing.</p>

<p>* iseq.c (prepare_iseq_build, compile_data_free): 	  construct/destruct
above table.</p>

<p>Wed May 11 17:18:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* util.c (ruby_qsort): use qsort_s if available, for Microsoft 	  Visual
Studio 2005 (msvcr80.dll) and mingw.</p>

<p>Wed May 11 10:33:26 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>* COPYING: Remove trailing-whitespaces. 	  [ci skip][fix GH-1348]</p>

<p>Tue May 10 21:05:45 2016  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* insns.def (defineclass): Also raise an error when redeclaring the 	 
superclass of a class as Object and it has another superclass. 	  [Bug
#12367] [ruby-core:75446]</p>

<p>* test/ruby/test_class.rb: test for above.</p>

<p>Tue May 10 14:57:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (obj_random_bytes): base on bytes method instead of 	  rand
method, not to call toplevel rand method.</p>

<p>Tue May 10 13:07:28 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (-fexcess-precision=standard): before r54895 -std=c99 	  is
specified and it implied -fexcess-precision=standard. 	  Now with
-std=gnu99, it should be explicitly specified. 	  <a
href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html">gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html</a></p>

<p>Mon May  9 10:51:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_atfork_internal): move th to an argument.</p>

<p>* thread.c (rb_thread_atfork): do not repeat GET_THREAD().</p>

<p>Mon May  9 10:46:36 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_atfork, rb_thread_atfork_before_exec): do 	  nothing
unless working fork is available.</p>

<p>* thread_sync.c (rb_mutex_abandon_all): define only if working 	  fork is
available.</p>

<p>* thread_sync.c (rb_mutex_abandon_keeping_mutexes): ditto.</p>

<p>* thread_sync.c (rb_mutex_abandon_locking_mutex): ditto.</p>

<p>* thread_win32.c (gvl_init): never used.</p>

<p>Mon May  9 07:18:06 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/<code>defines,ruby</code>.h: need to define function attributes 	 
alternatives in defines.h instead of ruby.h, because they are used 	  in
oniguruma.h and the header used without including ruby.h at 	  encoding
library sources.</p>

<p>Mon May  9 06:30:12 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (CONSTFUNC, PUREFUNC): fixed build errors on 	 
non-gcc build environments introduced at r54952.</p>

<p>Mon May  9 02:51:51 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c (rb_gc_unprotect_logging): throw rb_memerror when it cannot 	 
allocate memory. This is pointed out by Facebook&#39;s Infer.</p>

<p>* gc.c (gc_prof_setup_new_record): ditto.</p>

<p>* regparse.c (parse_regexp): ditto.</p>

<p>* util.c (MALLOC): use xmalloc and xfree like above.</p>

<p>Mon May  9 02:39:16 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: check function attribute const and pure, 	  and define
CONSTFUNC and PUREFUNC if available. 	  Note that I don&#39;t add those
options as default because 	  it still shows many false-positive (it seems
not to consider 	  longjmp).</p>

<p>* vm_eval.c (stack_check): get rb_thread_t* as an argument 	  to avoid
duplicate call of GET_THREAD().</p>

<p>Sun May  8 21:01:14 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/openssl/extconf.rb: assume it doesn&#39;t have SSLv2 related 	 
functions when OPENSSL_NO_SSL2 is defined. 	  Usually openssl&#39;s header
and the library (libssl) have the same 	  set of functions, but on some
environment the library has functions 	  whose headers doesn&#39;t declare.
(openssl/opensslconf.h and libssl.so 	  aren&#39;t be synchronized) 	  To
detect such case explicitly check feature macro and remove 	  related
functions.</p>

<p>Sun May  8 18:51:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_home_dir_of): return the default home path if the 	  user
name is the current user name, on platforms where struct 	  pwd is not
supported.  a temporary measure against 	  [Bug #12226].</p>

<p>Sun May  8 08:51:38 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: add -Wsuggest-attribute=format and suppress warnings.</p>

<p>Sun May  8 08:31:03 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: add -Wsuggest-attribute=noreturn and suppress warnings.</p>

<p>Sun May  8 08:19:16 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: add -Werror=implicit-int to avoid missing type of 	 
function declaration.</p>

<p>Sat May  7 22:22:37 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/webrick/ssl.rb: Accept string value for SSLCertName. It is used 	 
to invoke ssl server with command line. 	  [fix GH-1329] Patch by @kerlin
	* test/webrick/test_ssl_server.rb: Added test for GH-1329</p>

<p>Sat May  7 21:55:12 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/webrick/test_ssl_server.rb: Added basic test for `webrick/ssl`</p>

<p>Sat May  7 16:22:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (int_pair_to_real_inclusive): optimize to multiply 	  without
Bignum.</p>

<p>Sat May  7 07:58:02 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* process.c (rb_exec_getargs): honor the expected argument types 	  over
the conversion method.  the basic language functionality 	  should be
robust.  [ruby-core:75388] [Bug #12355]</p>

<p>Fri May  6 08:16:26 2016  David Silva 
&lt;david.silva@digital.cabinet-office.gov.uk&gt;</p>

<p>* enum.c (enum_find): [DOC] add more examples to the documentation 	  of
Enumerable#detect, to show that it equals to Enumerable#find. 	  [Fix
GH-1340]</p>

<p>Thu May  5 18:08:31 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* test/ruby/test_complexrational.rb: Remove duplicated raise.</p>

<p>Thu May  5 14:41:05 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_sub): Fix a special match variable name. 	  [ci skip]</p>

<p>Thu May  5 12:22:17 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (rb_eval_cmd, rb_catch_obj): use TH_JUMP_TAG with the 	  same
rb_thread_t used for TH_PUSH_TAG, instead of JUMP_TAG with 	  the current
thread global variable.</p>

<p>Thu May  5 10:49:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* random.c (fill_random_bytes_syscall): use arc4random_buf if 	 
available.</p>

<p>Wed May  4 23:13:58 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* numeric.c (fix_plus): Remove rb_nucomp_add prototype 	  declaration.</p>

<p>* numeric.c (fix_mul): Remove rb_nucomp_mul prototype 	  declaration.</p>

<p>* internal.h (rb_nucomp_add, rb_nucomp_mul): add prototype 	 
declarations.</p>

<p>Wed May  4 18:38:00 2016  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* lib/net/http/header.rb (Net::HTTPHeader#<code>each_header,each_name,</code>): Return 	  sized
enumerators.</p>

<p>* test/net/http/test_httpheader.rb: add test for above.</p>

<p>Wed May  4 17:53:15 2016  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* lib/set.rb
(Set#<code>delete_if,keep_if,collect!,reject!,select!,classify,divide</code>, 	 
SortedSet#<code>delete_if,keep_if</code>): Return sized enumerators.</p>

<p>* test/test_set.rb: add test for above.</p>

<p>Tue May  3 23:25:48 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* numeric.c: [DOC] Update result of 123456789 ** -2. 	  [ruby-dev:49606]
[Bug #12339]</p>

<p>Tue May  3 23:13:16 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* internal.h (RCOMPLEX_SET_IMAG): undef RCOMPLEX_SET_IMAG 	  instead of
duplicated undef RCOMPLEX_SET_REAL.</p>

<p>Tue May  3 22:55:07 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* complex.c (rb_complex_set_imag): Fix to properly set imag 	  of complex.</p>

<p>Tue May  3 22:19:55 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (warnflags): use -std=gnu99 instead of 	 
-std=iso9899:1999. [Feature #12336]</p>

<p>Tue May  3 22:10:09 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (count_utf8_lead_bytes_with_word): Use __builtin_popcount 	 
only if it can use SSE 4.2 POPCNT whose latency is 3 cycle.</p>

<p>* internal.h (rb_popcount64): use __builtin_popcountll because now 	  it
is in fast path.</p>

<p>Tue May  3 14:19:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (new_if_gen): set newline flag to NODE_IF to trace all 	 
if/elsif statements.  [ruby-core:67720] [Bug #10763]</p>

<p>Tue May  3 05:35:54 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* process.c (disable_child_handler_fork_child): 	  initialize handler for
SIGPIPE for !POSIX_SIGNAL</p>

<p>Mon May  2 23:03:42 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c, include/ruby/win32.h (rb_w32_utruncate): implements new 	
truncate alternative which accepts UTF-8 path.</p>

<p>* file.c (truncate): use above function. 	  [Bug #12340]</p>

<p>Mon May  2 20:59:21 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (str_coderange): to avoid function call when the string already 	 
has coderange information.</p>

<p>* re.c (rb_reg_prepare_enc): add shortcut path when the regexp has 	  the
same encoding of given string.</p>

<p>* re.c (rb_reg_prepare_re): avoid duplicated allocation of 	 
onig_errmsg_buffer.</p>

<p>Mon May  2 12:34:52 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_refinement.rb (test_inspect): Use Integer instead of 	 
Fixnum.</p>

<p>Mon May  2 06:58:38 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* complex.c: Don&#39;t refer rb_cFixnum and rb_cBignum. 	  (k_fixnum_p):
Use FIXNUM_P. 	  (k_bignum_p): Use RB_TYPE_P.</p>

<p>Mon May  2 01:27:59 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_numeric.rb (test_step): Use Integer::FIXNUM_MAX.</p>

<p>Mon May  2 01:15:01 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_module.rb (test_name): Use Integer instead of Fixnum.</p>

<p>Mon May  2 01:00:04 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/lib/test/unit/assertions.rb (assert_fixnum): Defined. 	 
(assert_bignum): Defined.</p>

<p>* test/ruby/test_bignum.rb: Use assert_bignum.</p>

<p>* test/ruby/test_integer_comb.rb: Use assert_fixnum and assert_bignum.</p>

<p>* test/ruby/test_optimization.rb: Ditto.</p>

<p>Mon May  2 00:41:53 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* vm_trace.c (recalc_remove_ruby_vm_event_flags): Add a cast to 	  avoid
signed integer overflow.</p>

<p>Mon May  2 00:06:04 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/lib/envutil.rb: Define Integer::<code>FIXNUM_MIN,FIXNUM_MAX</code>.</p>

<p>* test/ruby/test_bignum.rb: Use Integer::<code>FIXNUM_MIN,FIXNUM_MAX</code>.</p>

<p>* test/ruby/test_bignum.rb: Ditto.</p>

<p>* test/ruby/test_integer_comb.rb: Ditto.</p>

<p>* test/ruby/test_marshal.rb: Ditto.</p>

<p>* test/ruby/test_optimization.rb: Ditto.</p>

<p>Sun May  1 23:59:59 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* array.c (rb_ary_sum): fix for mathn</p>

<p>* test/ruby/test_array.rb (test_sum): ditto.</p>

<p>Sun May  1 23:51:54 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* test/lib/test/unit.rb (Options#non_options): fixed wrong regexp. 	  if
both positives and negatives were specified, positives had to 	  be
specified from the beginning.</p>

<p>Sun May  1 21:00:07 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c: drop Win2K support.</p>

<p>Sun May  1 20:39:47 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* cont.c, hash.c, random.c, win32/win32.c: cleanup some Win9x/ME/NT4 	 
support leftovers. 	  [fix GH-1328] patched by @cremno</p>

<p>Sun May  1 07:30:44 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (search_nonascii): use nlz on big endian environments.</p>

<p>* internal.h (nlz_intptr): defined.</p>

<p>Sun May  1 00:03:30 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (__builtin_ctz): check.</p>

<p>* configure.in (__builtin_ctzll): check.</p>

<p>* internal.h (rb_popcount32): defined for ntz_int32. 	  it can use
__builtin_popcount but this function is not used on 	  GCC environment
because it uses __builtin_ctz. 	  When another function uses this, using
__builtin_popcount 	  should be re-considered.</p>

<p>* internal.h (rb_popcount64): ditto.</p>

<p>* internal.h (ntz_int32): defined for ntz_intptr.</p>

<p>* internal.h (ntz_int64): defined for ntz_intptr.</p>

<p>* internal.h (ntz_intptr): defined as ntz for uintptr_t.</p>

<p>* string.c (search_nonascii): unroll and use ntz.</p>

<p>Sat Apr 30 21:54:13 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (Init_Numeric): Gather Fixnum method definitions.</p>

<p>Sat Apr 30 21:28:14 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_div): Define Integer#/.</p>

<p>* bignum.c (rb_big_div): Don&#39;t define Bignum#/.</p>

<p>* lib/mathn.rb (Integer#/): Replace Integer#/ instead of Bignum#/.</p>

<p>Sat Apr 30 21:11:08 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_plus): Define Integer#+.</p>

<p>* bignum.c (rb_big_plus): Don&#39;t define Bignum#+.</p>

<p>Sat Apr 30 21:01:20 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_minus): Define Integer#-.</p>

<p>* bignum.c (rb_big_minus): Don&#39;t define Bignum#-.</p>

<p>Sat Apr 30 20:53:33 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_mul): Define Integer#*.</p>

<p>* bignum.c (rb_big_mul): Don&#39;t define Bignum#*.</p>

<p>Sat Apr 30 20:30:44 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_modulo): Define Integer#%.</p>

<p>* bignum.c (rb_big_modulo): Don&#39;t define Bignum#%.</p>

<p>Sat Apr 30 20:17:08 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_equal): Define Integer#==.</p>

<p>* bignum.c (rb_big_eq): Don&#39;t define Bignum#==.</p>

<p>Sat Apr 30 19:41:15 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_gt): Define Integer#&gt;.</p>

<p>* bignum.c (rb_big_gt): Don&#39;t define Bignum#&gt;. 	  Renamed from
big_gt.</p>

<p>* internal.h (rb_big_gt): Declared.</p>

<p>Sat Apr 30 19:24:40 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_ge): Define Integer#&gt;=.</p>

<p>* bignum.c (rb_big_ge): Don&#39;t define Bignum#&gt;=. 	  Renamed from
big_ge.</p>

<p>* internal.h (rb_big_ge): Declared.</p>

<p>Sat Apr 30 19:20:40 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/standard_library.rdoc: Remove obsoleted classes and modules.</p>

<p>Sat Apr 30 19:09:23 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_lt): Define Integer#&lt;.</p>

<p>* bignum.c (rb_big_lt): Don&#39;t define Bignum#&lt;. 	  Renamed from
big_lt.</p>

<p>* internal.h (rb_big_lt): Declared.</p>

<p>Sat Apr 30 18:44:05 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_le): Define Integer#&lt;=.</p>

<p>* bignum.c (rb_big_le): Don&#39;t define Bignum#&lt;=. 	  Renamed from
big_le.</p>

<p>* internal.h (rb_big_le): Declared.</p>

<p>Sat Apr 30 18:11:44 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (Init_Bignum): Define Integer::GMP_VERSION.</p>

<p>Sat Apr 30 16:58:18 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_remainder): Define Integer#remainder.</p>

<p>* bignum.c (rb_big_remainder): Don&#39;t define Bignum#remainder.</p>

<p>* internal.h (rb_big_remainder): Declared.</p>

<p>Sat Apr 30 15:29:24 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_uminus): <code>Fixnum,Bignum</code>#-@ is unified into 	 
Integer.</p>

<p>* bignum.c (rb_big_uminus): Don&#39;t define Bignum#-@.</p>

<p>Sat Apr 30 14:42:20 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_idiv): <code>Fixnum,Bignum</code>#div is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_idiv): Don&#39;t define Bignum#div.</p>

<p>Sat Apr 30 14:25:55 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_modulo): <code>Fixnum,Bignum</code>#modulo is unified into 	 
Integer.</p>

<p>* bignum.c (rb_big_modulo): Don&#39;t define Bignum#modulo.</p>

<p>Sat Apr 30 14:04:30 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_divmod): <code>Fixnum,Bignum</code>#divmod is unified into 	 
Integer.</p>

<p>* bignum.c (rb_big_divmod): Don&#39;t define Bignum#divmod.</p>

<p>Sat Apr 30 13:20:00 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_fdiv): <code>Fixnum,Bignum</code>#fdiv is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_fdiv): Don&#39;t define Bignum#fdiv.</p>

<p>Sat Apr 30 12:25:43 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_pow): <code>Fixnum,Bignum</code>#** is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_pow): Don&#39;t define Bignum#**.</p>

<p>Sat Apr 30 12:28:59 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* bignum.c (rb_big_comp): Renamed from rb_big_neg.</p>

<p>* numeric.c (fix_comp): Renamed from fix_rev.</p>

<p>Sat Apr 30 12:25:43 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_comp): <code>Fixnum,Bignum</code>#~ is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_neg): Don&#39;t define Bignum#~.</p>

<p>* internal.h (rb_big_neg): Declared.</p>

<p>Sat Apr 30 12:07:42 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_and): <code>Fixnum,Bignum</code>#&amp; is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_and): Don&#39;t define Bignum#&amp;.</p>

<p>Sat Apr 30 11:56:15 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/thread: removed dummy extension library.  thread_sync.c 	  provides
“thread.rb” already.</p>

<p>Sat Apr 30 11:53:48 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_or): <code>Fixnum,Bignum</code>#| is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_or): Don&#39;t define Bignum#|.</p>

<p>Sat Apr 30 11:18:47 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* vm_trace.c: Fix typos. [ci skip]</p>

<p>Sat Apr 30 10:09:04 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/pty/pty.c (establishShell): honor USER environment variable 	  and
login name over uid, one uid can be shared by some login 	  names.</p>

<p>Fri Apr 29 22:40:28 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* doc/maintainers.rdoc (ext/io/nonblock): still maintained, as 	  well as
ext/io/wait, which is the origin.</p>

<p>Fri Apr 29 21:18:12 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* doc/maintainers.rdoc (ext/win32): of course, it&#39;s still maintained.</p>

<p>Fri Apr 29 21:03:10 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* gems/bundled_gems: Update latest gems, test-unit-3.1.8 and rake-11.1.2.</p>

<p>Fri Apr 29 20:43:02 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/maintainers.rdoc: Update latest maintainers list on Ruby 2.4</p>

<p>Fri Apr 29 19:52:45 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/maintainers.rdoc: Removed deprecated entries. These are already
deleted.</p>

<p>Fri Apr 29 19:48:45 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/maintainers.rdoc: Removed Ruby 1.8 entries. It&#39;s not necessary
to 	  Ruby 2.4 or later.</p>

<p>Thu Apr 28 17:03:17 2016  Nicholas Maccharoli 
&lt;nmaccharoli@gmail.com&gt;</p>

<p>* hash.c (rb_hash_update_<code>block,func</code>_callback): dry up hash 	  update
callback code.  [Fix GH-1338]</p>

<p>Thu Apr 28 16:52:05 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (rb_reg_prepare_enc): use rb_enc_asciicompat(enc) instead of 	 
rb_enc_str_asciicompat_p(str) to avoid useless rb_enc_get(str) call.</p>

<p>Thu Apr 28 16:33:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb: [DOC] fix example code.  base on the code by 	  Semyon
Gaivoronskiy in [ruby-core:75224].  [Bug #12323]</p>

<p>Thu Apr 28 09:33:03 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: Update rubygems-2.6.4.
	  Please see entries of 2.6.4 on 	  <a
href="https://github.com/rubygems/rubygems/blob/master/History.txt">github.com/rubygems/rubygems/blob/master/History.txt</a></p>

<p>Thu Apr 28 04:49:07 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* configure.in (rb_cv_lgamma_r_pm0): check if lgamma_r(+0.0) 	  returns
positive infinity, in addition to lgamma_r(-0.0). 	  AIX returns an
incorrect result of negative infinity.</p>

<p>* math.c (ruby_lgamma_r): handle +0.0, in addition to -0.0.</p>

<p>Thu Apr 28 01:11:14 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* time.c: define _DEFAULT_SOURCE because glibc 2.20 deprecates 	 
_BSD_SOURCE. 	  <a
href="https://sourceware.org/glibc/wiki/Release/2.20">sourceware.org/glibc/wiki/Release/2.20</a></p>

<p>Thu Apr 28 00:27:55 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_xor): <code>Fixnum,Bignum</code>#^ is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_xor): Don&#39;t define Bignum#^.</p>

<p>Wed Apr 27 20:53:59 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_aref): <code>Fixnum,Bignum</code>#[] is unified into 	  Integer.</p>

<p>* bignum.c (rb_big_aref): Don&#39;t define Bignum#&lt;&lt;.</p>

<p>* internal.h (rb_big_aref): Declared.</p>

<p>Wed Apr 27 16:10:35 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/instruction.rb: fix to follow current implementation.</p>

<p>Wed Apr 27 15:47:54 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_s_new): warn if a block is given, 	  as
well as IO.new.</p>

<p>Wed Apr 27 14:29:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (ruby_only_for_internal_use): raise fatal error when 	 
deprecated function only for internal use is called, not just a 	  warning.</p>

<p>Tue Apr 26 23:42:30 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* tool/redmine-backporter.rb (rel): should not raise exceptions even if 	 
the user input is wrong.  only reports the error and continue process.</p>

<p>Tue Apr 26 23:35:23 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (process_options): convert -e script to the encoding 	  given by
a command line option on Windows.  assume it is the 	  expected encoding. 
[ruby-dev:49461] [Bug #11900]</p>

<p>Tue Apr 26 21:11:02 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_lshift): <code>Fixnum,Bignum</code>#&lt;&lt; is unified into 	 
Integer.</p>

<p>* bignum.c (rb_big_lshift): Don&#39;t define Bignum#&lt;&lt;.</p>

<p>Tue Apr 26 20:59:40 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_rshift): <code>Fixnum,Bignum</code>#&gt;&gt; is unified into 	 
Integer.</p>

<p>* bignum.c (rb_big_rshift): Don&#39;t define Bignum#&gt;&gt;.</p>

<p>Tue Apr 26 20:46:16 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_size): <code>Fixnum,Bignum</code>#size is unified into Integer.</p>

<p>* bignum.c (rb_big_size_m): Don&#39;t define Bignum#size.</p>

<p>* internal.h (rb_big_size_m): Declared.</p>

<p>Tue Apr 26 20:09:08 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (rb_int_bit_length): <code>Fixnum,Bignum</code>#bit_length is 	  unified
into Integer.</p>

<p>* bignum.c (rb_big_bit_length): Don&#39;t define Bignum#bit_length.</p>

<p>* internal.h (rb_big_bit_length): Declared.</p>

<p>Tue Apr 26 19:56:16 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* numeric.c (int_abs): Integer#<code>abs,magnitude</code> moved from 	  Fixnum and
Bignum.</p>

<p>* bignum.c (rb_big_abs): Don&#39;t define Bignum#<code>abs,magnitude</code>.</p>

<p>* internal.h (rb_big_abs): Declared.</p>

<p>Mon Apr 25 14:39:11 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/rbconfig/sizeof/extconf.rb: just check the existence of each 	 
types, to reduce configuration time, especially cross-compiling.</p>

<p>* template/sizes.c.tmpl: calculate sizes of checked types at 	 
compilation time.</p>

<p>Mon Apr 25 11:27:27 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>* doc/extension.rdoc: Improvements to english grammars. 	  [Bug #<a
href="ruby-core:74792">12246]</a>[ci skip]</p>

<p>Mon Apr 25 11:17:50 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>* encoding.c: Fix return value of `Encoding::ISO8859_1.name` 	  [Bug #<a
href="ruby-core:75147">12313]</a>[ci skip] 	* ext/bigdecimal/bigdecimal.c:
Fix code sample of `BigDecimal.new`</p>

<p>Sun Apr 24 23:29:16 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* configure.in: add missing -lm for AIX.</p>

<p>Sun Apr 24 18:33:58 2016  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>* vm_insnhelper.c (INLINE): disable r54738 if <em>NO_INLINE</em> is
defined. 	  It caused “undefined reference to `vm_getivar&#39;”.</p>

<p>Sun Apr 24 09:32:12 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* test/ruby/test_array.rb: Add test cases for Array#sum with 	 
non-numeric objects.</p>

<p>Sun Apr 24 04:21:27 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (INLINE): define as `inline` when it is optimized. 	 
define as `static inline` when it is not optimized to keep 	  the symbol
generated.</p>

<p>* vm_insnhelper.c (vm_getivar): use `INLINE` to force inline 	  so that a
compiler inlines it into vm_getinstancevariable 	  and optimizes out
is_attr and related branches.</p>

<p>* vm_insnhelper.c (vm_getivar): use `inline` to recommend inline. 	 
Without this vm1_ivar_set is degraded.</p>

<p>benchmark results: 	  minimum results in each 5 measurements. 	 
Execution time (sec) 	  name    ruby 2.4.0dev (2016-04-23 trunk 54727)
[x86_64-linux]   ruby 2.4.0dev (2016-04-23 trunk 54733) [x86_64-linux]     
built-ruby 	  loop_whileloop 0.641                                         
0.642 0.646 	  vm1_ivar* 1.002                                             
0.999 0.831 	  vm1_ivar_set* 0.369                                         
1.106 0.362</p>

<p>Speedup ratio: compare with the result of `ruby 2.4.0dev (2016-04-23 	 
trunk 54727) [x86_64-linux]&#39; (greater is better) 	  name    ruby
2.4.0dev (2016-04-23 trunk 54733) [x86_64-linux] 	  built-ruby 	 
loop_whileloop 	  0.998        0.991 	  vm1_ivar* 	  1.003        1.205 	 
vm1_ivar_set* 	  0.334        1.018</p>

<p>Sat Apr 23 18:01:21 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* vm_insnhelper.c (vm_getivar): specify inline instead of static inline. 	
vm_getivar is called by vm_call_ivar and vm_getinstancevariable. 	  At
least with GCC 4.8 and 5.3 on Linux, they are inlining it into 	 
vm_call_ivar but not vm_getinstancevariable. 	  By `inline`, they correctly
inline it and gains performance.</p>

<p>Speedup ratio: compare with the result of `ruby 2.4.0dev (2016-04-23 	 
trunk 54727) [x86_64-linux]&#39; (greater is better) 	  name    built-ruby
	  loop_whileloop       1.001 	  vm1_ivar*            1.189 	 
vm1_ivar_set*        1.024</p>

<p>Note the `inline`&#39;s meaning is different between old GCC 	  and C99.
Old GCC&#39;s inline means C99&#39;s extern inline. 	  <a
href="https://gcc.gnu.org/onlinedocs/gcc/Inline.html">gcc.gnu.org/onlinedocs/gcc/Inline.html</a>
	  Since Ruby specify -std=iso9899:1999, it works like C99.</p>

<p>Sat Apr 23 16:11:39 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_mul_size_overflow): use UNLIKELY 	  by user side
to improve generality.</p>

<p>Sat Apr 23 16:10:02 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RB_LIKELY): use prefix in ruby.h.</p>

<p>* intern.h (LIKELY): define with RB_LIKELY.</p>

<p>Sat Apr 23 13:27:25 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* NEWS: Add descriptions for Time#to_time updates. 	  [Bug #12271]</p>

<p>Sat Apr 23 13:21:24 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* NEWS: Add descriptions for DateTime#to_time updates. 	  [Bug #12189]</p>

<p>Sat Apr 23 11:21:27 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>* ext/date/date_core.c (Init_date_core): [DOC] Convert DateTime 	 
documentation to RDoc from Markdown. 	  [ruby-core:75136] [Bug #12311]</p>

<p>Sat Apr 23 09:03:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c: cygwin does not use w32_cmdvector, command line can be 	  other
than UTF-8.  [ruby-dev:49519] [Bug #12184]</p>

<p>Sat Apr 23 01:00:03 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* configure.in: don&#39;t use the system-provided round(3) on AIX. 	  In
AIX, round(0.49999999999999994) returns 1.0. 	  Use round() in numeric.c
instead.</p>

<p>Fri Apr 22 21:00:44 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/ruby/test_time_tz.rb: Tests depends on Europe/Moscow removed 	  to
avoid test failures due to the tzdata change. 	  <a
href="https://github.com/eggert/tz/commit/8ee11a301cf173afb0c76e0315b9f9ec8ebb9d95">github.com/eggert/tz/commit/8ee11a301cf173afb0c76e0315b9f9ec8ebb9d95</a>
	  Found by naruse.</p>

<p>Fri Apr 22 20:18:40 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_mul_size_overflow): added to handle 	  mul
overflow efficiently.</p>

<p>* include/ruby/ruby.h (rb_alloc_tmp_buffer2): use rb_mul_size_overflow 	 
and avoid division where it can define DSIZE_T.</p>

<p>* gc.c (xmalloc2_size): moved from ruby.h and use rb_mul_size_overflow.</p>

<p>Fri Apr 22 20:34:04 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* time.c (time_asctime): [DOC] add ctime example, not only 	  asctime. 
[ruby-core:75126] [Bug #12310]</p>

<p>Fri Apr 22 18:44:32 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* variable.c: use uint32_t instead of long to avoid confusion about 	  the
type of ivtbl-&gt;numiv.</p>

<p>Fri Apr 22 15:09:27 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval_jump.c (exec_end_procs_chain): restore previous error info 	  for
each end procs.  [ruby-core:75038] [Bug #12302]</p>

<p>Fri Apr 22 15:04:56 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* tool/redmine-backporter.rb: the fullpath of merger.rb is too long to 	 
copy&amp;paste on Windows.  show shorter name instead on the platform. 	 
I&#39;m sure that the user of this command on Windows is only me.</p>

<p>Fri Apr 22 14:52:04 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: remove temporary file.</p>

<p>Fri Apr 22 11:27:03 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/net/http.rb: Improve documentation for SSL requests via GET method.
	  [fix GH-1325][ci skip] Patch by @jsyeo</p>

<p>Fri Apr 22 10:51:13 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/webrick/ssl.rb: Support to add SSLCiphers option. 	  [fix GH-1321]
Patch by @rhadoo</p>

<p>Fri Apr 22 10:43:19 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* file.c, win32/file.c: Removed obsoleted safe level checks. 	  [fix
GH-1327] Patch by @cremno</p>

<p>Fri Apr 22 10:01:48 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* benchmark/bm_so_meteor_contest.rb: fix a typo. 	  [fix GH-1330][ci skip]
Patch by @sachin21</p>

<p>Fri Apr 22 04:57:01 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c (rb_alloc_tmp_buffer_with_count): added like xmalloc2 to 	  avoid
duplicated check of size.</p>

<p>* gc.c (ruby_xmalloc2): added to keep separate layers.</p>

<p>* include/ruby/ruby.h (rb_alloc_tmp_buffer2): added to check 	  the size
more statically.</p>

<p>Fri Apr 22 04:54:40 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (LIKELY): moved from internal.h.</p>

<p>* include/ruby/ruby.h (UNLIKELY): ditto.</p>

<p>Thu Apr 21 01:44:19 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* gc.c (objspace_malloc_prepare): remove size check because it is 	  used
by objspace_xmalloc and objspace_xcalloc. 	  objspace_xmalloc introduces
its own check in this commit. 	  objspace_xcalloc checks with xmalloc2_size
(ruby_xmalloc2_size).</p>

<p>* gc.c (objspace_xmalloc0): common xmalloc function.</p>

<p>* gc.c (objspace_xmalloc): introduce its own size check.</p>

<p>* gc.c (objspace_xmalloc2): separated from ruby_xmalloc2 to clarify 	  the
layer who has the responsibility to check the size.</p>

<p>* gc.c (objspace_xrealloc): remove duplicated size check.</p>

<p>* gc.c (ruby_xmalloc2): use objspace_xmalloc2.</p>

<p>* include/ruby/ruby.h (ruby_xmalloc2_size): follow the size limit 	  as
SSIZE_MAX. Note that ISO C says size_t is unsigned integer.</p>

<p>Thu Apr 21 12:14:04 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: check if succeeded in creating config.h.</p>

<p>* tool/ifchange: ignore failures when TEST_COLORS unmatched. just 	  use
the default value if expected name is not contained in it. 	 
[ruby-core:75046] [Bug #12303]</p>

<p>Wed Apr 20 17:33:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/cgi/escape/escape.c (cgiesc_unescape): define unescape 	  method
instead of _unescape, and should pass the optional 	  argument to the super
method.</p>

<p>* lib/cgi/util.rb (CGI::Util#_unescape): remove intermediate 	  method.</p>

<p>Wed Apr 20 15:52:28 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (syntax_error_initialize): move the default message, 	  “compile
error”, from parse.y.  the default parameter should 	  belong to the class
definition.</p>

<p>* parse.y (yycompile0): use the default parameter.</p>

<p>Wed Apr 20 10:25:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (append_compile_error): use rb_syntax_error_append.</p>

<p>* error.c (rb_syntax_error_append): append messages into a 	  SyntaxError
exception instance.</p>

<p>* parse.y (yycompile0): make new SyntaxError instance in main 	  mode,
otherwise error_buffer should be a SyntaxError if error 	  has occurred.</p>

<p>Tue Apr 19 17:42:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (err_vcatf): rename, and separate appending message from 	 
creating a string buffer.</p>

<p>* error.c (rb_syntax_error_append): merge rb_error_vsprintf and 	 
rb_compile_err_append.</p>

<p>* parse.y (parser_compile_error): use rb_syntax_error_append.</p>

<p>Tue Apr 19 13:46:19 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (append_compile_error, compile_bug): pass iseq and get 	 
error info and file from it, not by the thread error info.</p>

<p>* error.c (rb_report_bug_valist): take va_list instead of variadic 	 
arguments, and just report the bug but not abort.</p>

<p>Tue Apr 19 13:18:12 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* lib/time.rb: revert r54167 because it would break 	  backward
compatibilities, and it is documented that 	  Time.parse does not take into
account time zone 	  abbreations other than ones described in RFC 822</p>

<p>Tue Apr 19 13:12:03 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* ChangeLog: Fix dates of previous commits</p>

<p>Tue Apr 19 12:45:03 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* ChangeLog: Add descriptions for logger updates 	* NEWS: Add descriptions
for logger updates</p>

<p>Tue Apr 19 12:45:02 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* lib/logger.rb: Add shift_period_suffix option</p>

<p>Tue Apr 19 12:45:01 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* lib/logger.rb: Allow specifying logger parameters in constructor 	  such
as level, progname, datetime_format, formatter.</p>

<p>Mon Apr 18 16:07:01 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_peephole_optimize): should not replace the 	  current
target INSN, not to follow the replaced dangling link in 	  the caller. 
[ruby-core:74993] [Bug #11816]</p>

<p>Mon Apr 18 12:56:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (flo_truncate): add an optional parameter, digits, as 	  well
as Float#round.  [Feature #12245]</p>

<p>* numeric.c (int_truncate): add an optional parameter, digits, as 	  well
as Integer#round.  [Feature #12245]</p>

<p>Sun Apr 17 04:18:56 2016  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* tool/redmine-backporter.rb: revisions are strings.</p>

<p>Sat Apr 16 14:26:49 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* ext/date/date_core.c : remove not used f_getlocal macro. 	  After r54553
f_getlocal macro is not used.</p>

<p>Sat Apr 16 14:15:24 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* ext/date/date_core.c : remove not used f_utc6 macro. 	  After r54169
f_utc6 macro is not used.</p>

<p>Sat Apr 16 10:00:11 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* struct.c (struct_make_members_list, rb_struct_s_def): member 	  names
should be unique. [ruby-core:74971] [Bug #12291]</p>

<p>* struct.c (struct_make_members_list): extract making member name 	  list
from char* va_list, with creating symbols without 	  intermediate IDs.</p>

<p>Sat Apr 16 01:33:27 2016  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* tool/redmine-backporter.rb: sort revisions.</p>

<p>Sat Apr 16 01:16:02 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* array.c (rb_ary_sum): Don&#39;t yield same element twice. 	  Found by
nagachika.</p>

<p>Sat Apr 16 01:03:32 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* array.c (rb_ary_sum): Fix SEGV by [1/2r, 1].sum.</p>

<p>Fri Apr 15 23:52:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* rational.c (rb_rational_plus): rename from rb_rational_add 	  to be
aligned with rb_fix_plus.</p>

<p>* array.c (rb_ary_sum): ditto.</p>

<p>* internal.h: ditto.</p>

<p>Fri Apr 15 23:42:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* rational.c (rb_rational_add): rename from nurat_add.</p>

<p>* array.c (rb_ary_sum): use rb_rational_add directly.</p>

<p>* test/ruby/test_array.rb (test_sum): add assertions for an array of 	 
Rational values.</p>

<p>Fri Apr 15 22:31:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* array.c (rb_ary_sum): apply the precision compensated algorithm 	  for
an array in which Rational and Float values are mixed.</p>

<p>* test/ruby/test_array.rb (test_sum): add assertions for the above 	 
change.</p>

<p>Fri Apr 15 22:30:01 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_setname): defer setting native thread name 	  set in
initialize until the native thread is created. 	  [ruby-core:74963] [Bug
#12290]</p>

<p>Fri Apr 15 20:27:16 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/irb/ext/save-history.rb: Fix NoMethodError when method is not
defined.</p>

<p>Fri Apr 15 15:38:58 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* common.mk (benchmark): order options for built-ruby and compare-ruby.</p>

<p>Fri Apr 15 14:14:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* test/ruby/test_array.rb (test_sum): add assertions for Rational and 	 
Complex numbers.</p>

<p>Fri Apr 15 10:07:11 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (console_key_pressed_p): raise the same 	 
exception, “unknown virtual key code”, for names with nul chars. 	  though
console_win32_vk() considers the length and can deal with 	  nul chars,
rb_sprintf() raised at PRIsVALUE previously, so quote 	  it if it is
unprintable.</p>

<p>Fri Apr 15 09:02:58 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/console/console.c (rb_sym2str): fallback definition for 	  older
ruby.  [ruby-core:74953] [Bug #12284]</p>

<p>Thu Apr 14 21:46:36 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* array.c (rb_ary_sum): Support the optional argument, init, and 	  block.</p>

<p>Thu Apr 14 19:02:41 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/irb/ext/save-history.rb: suppress warning: method redefined; 	 
discarding old save_history=.</p>

<p>Thu Apr 14 14:58:14 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/tk/tkutil/tkutil.c (tk_hash_kv): the third argument can be 	  nil
not only an Array.  reported by @windwiny at 	  <a
href="https://github.com/ruby/ruby/commit/cdaa94e#commitcomment-17096618">github.com/ruby/ruby/commit/cdaa94e#commitcomment-17096618</a></p>

<p>Thu Apr 14 14:28:55 2016  cremno phobia  &lt;cremno@mail.ru&gt;</p>

<p>* cont.c (fiber_initialize_machine_stack_context): fix wrong 	  _MSC_VER
check, should be decimal but not hexadecimal. 	  [ruby-core:74936] [Bug
#12279]</p>

<p>Wed Apr 13 22:51:38 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* array.c (rb_ary_sum): Array#sum is implemented. 	  Kahan&#39;s
compensated summation algorithm for precise sum of float 	  numbers is
moved from ary_inject_op in enum.c.</p>

<p>* enum.c (ary_inject_op): Don&#39;t specialize for float numbers.</p>

<p>[ruby-core:74569] [Feature #12217] proposed by mrkn.</p>

<p>Wed Apr 13 15:56:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (flo_ceil): add an optional parameter, digits, as 	  well as
Float#round.  [Feature #12245]</p>

<p>* numeric.c (flo_floor): add an optional parameter, digits, as 	  well as
Float#round.  [Feature #12245]</p>

<p>* numeric.c (int_ceil): add an optional parameter, digits, as 	  well as
Integer#round.  [Feature #12245]</p>

<p>* numeric.c (int_floor): add an optional parameter, digits, as 	  well as
Integer#round.  [Feature #12245]</p>

<p>Wed Apr 13 14:47:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (Init_File): add alias File.empty? to File.zero?. 	  [Feature
#9969]</p>

<p>Wed Apr 13 14:36:24 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (assign_in_cond): allow multiple assignment in 	  conditional
expression.  [Feature #10617]</p>

<p>Wed Apr 13 14:11:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big_size): add wrapper function of BIGSIZE and 	  rename
the method function with _m suffix.</p>

<p>* numeric.c (int_round_zero_p): extracted from rb_int_round. 	  optimize
for Bignum, and convert VALUE returned by Numeric#size 	  to long.</p>

<p>Wed Apr 13 12:00:08 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* test/ruby/test_basicinstructions.rb: add a test to check access 	 
instance variables on special const objects.</p>

<p>All of such objects are frozen, so that we can not set instance 	 
variables for them. But we can read instance variables and return 	 
default value (nil).</p>

<p>Tue Apr 12 20:40:35 2016  Kaneko Yuichiro  &lt;spiketeika@gmail.com&gt;</p>

<p>* ext/date/date_core.c (time_to_time): should preserve timezone 	  info. 
[ruby-core:74889] [Bug #12271]</p>

<p>Tue Apr 12 11:51:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (new_label_body): initialize bit fields, since 	 
compile_data_alloc does not clear the memory.  [Bug #12082]</p>

<p>Mon Apr 11 20:18:43 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm_backtrace.c (frame2klass): filter only for imemo_ment. 	 
T_IMEMO/imemo_iseq can be passed here.</p>

<p>Mon Apr 11 17:43:04 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_optimize): disable tail call optimization in 	  rescued,
rescue, and ensure blocks. 	  [ruby-core:73871] [Bug #12082]</p>

<p>Mon Apr 11 06:54:39 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (apply2files): apply to a VALUE vector instead of a 	  temporary
array.</p>

<p>Sun Apr 10 20:54:16 2016  Joe Swatosh  &lt;joe.swatosh@gmail.com&gt;</p>

<p>* ext/win32/lib/win32/registry.rb (DeleteValue, DeleteKey): fix 	  API
names.  [ruby-core:74863] [Bug #12264]</p>

<p>Sun Apr 10 17:47:42 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (rb_realpath_internal): no argument conversions since 	  this
internal function does not need to_path and encoding 	  conversions, not to
be affected by the default internal 	  encoding.</p>

<p>Sat Apr  9 10:03:12 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* load.c (rb_f_load): raise with the original path name before 	  encoding
conversion.</p>

<p>Sat Apr  9 02:05:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_cstr_parse_inum): [EXPERIMENTAL] new function to 	  parse
integer in C-string with length.  the name and the 	  arguments may be
changed in the future.</p>

<p>* bignum.c (rb_str_to_inum): preserve encoding of the argument in 	  error
messages, and no longer needs to copy non-terminated 	  strings.</p>

<p>* bignum.c (rb_str2big_<code>poweroftwo,normal,karatsuba,gmp</code>): ditto.</p>

<p>Thu Apr  7 19:04:03 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* doc/regexp.rdoc (comments): [DOC] terminators cannot appear in 	 
comments.  [ruby-core:74838] [Bug #12256]</p>

<p>Thu Apr  7 11:24:14 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/tk/tkutil/tkutil.c (cbsubst_initialize): fix out-of-bound 	  access
when no arguments given.  `p Tk::Event.new` crashed.</p>

<p>Fri Apr  1 01:26:00 2016  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* ext/coverage/coverage.c: Fully reset coverage to not persist global
state. 	  It was returning old file coverages as empty arrays to the user.
	  [ruby-core:74596] [Bug #12220]</p>

<p>* ext/coverage/coverage.c (rb_coverages): remove unused static state.</p>

<p>* thread.c: Moved and renamed coverage_clear_result_i to reset_coverage_i.</p>

<p>* test/coverage/test_coverage.rb: improve precision of tests.</p>

<p>Wed Apr  6 22:41:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (rb_cv_lgamma_r_m0): fix the condition for 	 
lgamma_r(-0.0).  [Bug #12249]</p>

<p>Wed Apr  6 17:38:42 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* tool/downloader.rb (RubyGems.download): follow the change of the 	 
rubygems ssl_certs directory tree introduced by previous commit.</p>

<p>Wed Apr  6 15:00:27 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: Update rubygems-2.6.3.
	  Please see entries of 2.6.3 on 	  <a
href="https://github.com/rubygems/rubygems/blob/master/History.txt">github.com/rubygems/rubygems/blob/master/History.txt</a></p>

<p>Wed Apr  6 14:13:28 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (rb_cv_lgamma_r_m0): check if lgamma_r(-0.0) 	  returns
negative infinity.  [Bug #12249]</p>

<p>* math.c (ruby_lgamma_r): define by the configured result.</p>

<p>Wed Apr  6 10:56:15 2016  Anton Davydov  &lt;antondavydov.o@gmail.com&gt;</p>

<p>* lib/logger.rb (Logger#level=): remove unnecessary local 	  variable.</p>

<p>* lib/logger.rb (Logger#initialize, Logger#reopen): [DOC] mention 	  the
default values.  cherrypicked from [GH-1319].</p>

<p>Wed Apr  6 10:17:53 2016  cremno phobia  &lt;cremno@mail.ru&gt;</p>

<p>* math.c (ruby_lgamma_r): missing/lgamma_r.c is used on Windows, 	  since
msvcrt does not provide it.</p>

<p>* missing/lgamma_r.c (lgamma_r): fix lgamma(-0.0). 	  [ruby-core:74823]
[Bug #12249]</p>

<p>Wed Apr  6 01:22:55 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* math.c (ruby_lgamma_r): mswin&#39;s lgamma_r also seems to be wrong. 	 
cf. [Bug #12249]</p>

<p>Wed Apr  6 00:53:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* math.c (ruby_lgamma_r): fix lgamma(-0.0) on mingw and OSX.</p>

<p>* math.c (ruby_tgamma): fix tgamma(-0.0) on mingw. 	  [ruby-core:74817]
[Bug #12249]</p>

<p>Tue Apr  5 14:50:28 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf-utf8/nkf.c (mime_putc): fix typo. 	  [Bug #12202]
[ruby-core:74802]</p>

<p>Tue Apr  5 00:06:44 2016  Aeris  &lt;aeris@imirhil.fr&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_ssl_tmp_key): Access to ephemeral 	  TLS
session key in case of forward secrecy cipher.  Only 	  available since
OpenSSL 1.0.2.  [Fix GH-1318]</p>

<p>* ext/openssl/extconf.rb: Check for SSL_get_server_tmp_key.</p>

<p>Mon Apr  4 23:37:05 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_core.h (rb_vm_struct): make at_exit a single linked list but 	  not
RArray, not to mark the registered functions by the write 	  barrier. 
based on the patches by Evan Phoenix. 	  [ruby-core:73908] [Bug #12095]</p>

<p>Mon Apr  4 17:43:45 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: change default value of 	  RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO 0.3
-&gt; 0.2 	  RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO 0.8 -&gt; 0.65</p>

<p>These values are same as Ruby 2.0.0.</p>

<p>This change cause GC counts. 	  However, generational GC reduced each
(minor) GC time and 	  increase memory locality. So that not so big impact
on my 	  benchmarking results. 	  (surprisingly, this fix speed up programs
on some cases)</p>

<p>You can change these values by environment variables 	  if you feel
wrong.</p>

<p>Mon Apr  4 17:36:52 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (get_envparam_double): take an upper_bound.</p>

<p>And also take an accept_zero flag which allow to accept zero 	  even if
lower_bound is set.</p>

<p>* gc.c (ruby_gc_set_params): fix parameters.</p>

<p>RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO set 0.9 as
<strong>lower_bound</strong>, so that 	  it should be upper_bound. 	  Set
RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO as lower bound.</p>

<p>Also set lower/upper bound of RUBY_GC_HEAP_FREE_SLOTS_GOAL_RATIO to 	 
RUBY_GC_HEAP_FREE_SLOTS_MIN/MAX_RATIO.</p>

<p>Mon Apr  4 16:41:32 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* vm.c (Init_VM): should pass tokens.</p>

<p>Sun Apr  3 09:34:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (flodivmod): round division if it is a finite number 	  and
module is required.</p>

<p>* numeric.c (dbl2ival): do not round here.</p>

<p>* numeric.c (flo_ceil): use dbl2ival.</p>

<p>* numeric.c (flo_round): round explicitly.</p>

<p>Sat Apr  2 15:24:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/intern.h (rb_check_arity): returns argc.</p>

<p>Fri Apr  1 20:58:33 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Data generation to implement 	 
swapcase functionality for titlecase characters. Swapcase isn&#39;t defined
	  by Unicode, because the purpose/usage of swapcase is unclear anyway. 	 
The implementation follows a proposal from Nobu, swapping the case of 	 
each component of a titlecase character individually. 	  This means that
the titlecase characters have to be decomposed.</p>

<p>* enc/unicode.c: Code using the above data.</p>

<p>* test/ruby/enc/test_case_mapping.rb: Tests for the above.</p>

<p>Fri Apr  1 14:55:28 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* configure.in (AC_CONFIG_FILES): $srcdir/.git can be a file pointing 	 
the real git_dir, such as when the git working tree is a “linked 	  working
tree” (a working tree created by git-worktree). So use 	  git-rev-parse
–git-dir to check if $srcdir is the top-level of a git 	  repository, not
just checking if the $srcdir/.git directory does exist 	  or not. 
[ruby-core:74759] [Bug #12239]</p>

<p>* tool/change_maker.rb: use tool/vcs.rb to detect VCS. This used to have 	
its own VCS detection code, while we have tool/vcs.rb.</p>

<p>* tool/vcs.rb (detect): remove code duplication</p>

<p>Fri Apr  1 04:50:44 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_sslctx_s_alloc): 	  enable
SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER by default 	  [Bug #12126]</p>

<p>Fri Apr  1 01:13:55 2016  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* thread.c (update_coverage): Do not track coverage in loaded files 	 
after Coverage.result. Avoids out-of-bounds access. [Bug #12237]</p>

<p>* ext/coverage/coverage.c (coverage_clear_result_i): document.</p>

<p>Thu Mar 31 19:16:16 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: need to set initial value of GC_HEAP_FREE_SLOTS_GOAL_RATIO.</p>

<p>Thu Mar 31 17:50:27 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: change additional allocation policy.</p>

<p>Introduce new environment variable 	  RUBY_GC_HEAP_FREE_SLOTS_GOAL_RATIO
(goal_ratio) to calculate the 	  ratio of additional memory.</p>

<p>Before this change, we add pages with the following formula 	  (when
free_slots &lt; total_pages * RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO): 	   
next_pages = total_pages * RUBY_GC_HEAP_GROWTH_FACTOR</p>

<p>This addition can allocate too much.</p>

<p>With this change, we increase pages to satisfy the following formula: 	 
next_free_slots = next_total_slots * goal_ratio 	  where 	   
next_free_slots = free_slots + adding_slots 	    next_total_slots =
total_slots + adding_slots.</p>

<p>If you want to prepare many free slots, increase this ratio.</p>

<p>If this variable is 0, then simply multiply 	 
RUBY_GC_HEAP_GROWTH_FACTOR.</p>

<p>* gc.c (get_envparam_double): enable to accept 0.</p>

<p>Thu Mar 31 17:48:25 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (gc_marks_finish): fix syntax error.</p>

<p>Thu Mar 31 16:49:36 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: simplify allocate/free detecting logic at the end of marking.</p>

<p>Before this change, heap_pages_min_slots are calculated at the 	 
beginning sweeping phase. And this value is used at the end of 	 
<strong>next</strong> marking phase.</p>

<p>To simplify it, we use this value at the end of this marking phase. 	 
It means that we don&#39;t need to store this value as global state.</p>

<p>Also heap_pages_max_slots is calculated at the begging of sweeping 	 
phase and used at the end of sweeping phase. 	  To simplify this logic, we
introduced new global value 	  heap_pages_freeable_pages it means extra
pages count we can free. 	  gc_sweep_step() checks this value and moves
empty pages to tomb_heap 	  not more than this value.</p>

<p>Because of this fix, heap_pages_swept_slots is no longer needed.</p>

<p>* gc.c (rb_objspace_t::heap_pages): restruct the objspace global 	 
status.</p>

<p>remove the following fields 	    * swept_slots (and
heap_pages_swept_slots) 	    * min_free_slots (and
heap_pages_min_free_slots) 	    * max_free_slots (and
heap_pages_max_free_slots) 	  And add the following filed. 	    *
freeable_pages (and heap_pages_freeable_pages)</p>

<p>* gc.c (heap_pages_free_unused_pages): unlink tomb heap pages 	  because
tomb heap should have only freeable pages.</p>

<p>* gc.c (heap_extend_pages): add parameters for future extension.</p>

<p>Thu Mar 31 16:43:02 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: add GC parameters to configure the following values: 	  *
RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO: 	    allocate additional pages when free
slots is lower than 	    the value (total_slots * (this ratio)). 	  *
RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO: 	    allow to free pages when free slots
is greater than 	    the value (total_slots * (this ratio)).</p>

<p>Before this change, these values are hard coded.</p>

<p>* gc.c (ruby_gc_params_t): ditto.</p>

<p>* gc.c (ruby_gc_set_params): ditto.</p>

<p>Thu Mar 31 15:59:17 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (gc_verify_heap_page): check the number of zombies.</p>

<p>* gc.c (gc_verify_heap_pages): check also tomb heap.</p>

<p>Thu Mar 31 15:48:18 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c (gc_page_sweep): return free slots count.</p>

<p>* gc.c (gc_sweep_step): use returned free slots count.</p>

<p>* gc.c (gc_sweep_step): change variable name `next&#39; 	  to
`next_sweep_page&#39;.</p>

<p>Thu Mar 31 11:33:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/date/date_core.c (d_lite_strftime, dt_lite_strftime): [DOC] 	  fix
indent not to be a big sole verbatim.</p>

<p>Thu Mar 31 11:18:19 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/date/date_core.c (Init_date_core): [DOC] fix misplaced doc 	  of
DateTime.  [ruby-core:74729] [Bug #12233]</p>

<p>Thu Mar 31 03:41:02 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf-utf8/nkf.c: Merge upstream 69f7e74dde. 	  fix indent.</p>

<p>Wed Mar 30 16:33:19 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* extension.rdoc, extension.ja.rdoc: [DOC] Fix some errors. 	  Renamed
files, wrong method names or argument types; the example 	  GetDBM macro is
now updated to the current version of the actual 	  code.  patch by Marcus
Stollsteimer in [ruby-core:74690]. 	  [Bug #12228]</p>

<p>Wed Mar 30 09:46:01 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/open-uri.rb: Use `userinfo` for authenticated proxy. 	  [fix
GH-1148] Patch by @SokichiFujita 	* test/open-uri/test_open-uri.rb: ditto.
	  [fix GH-1309] Patch by @jdamick</p>

<p>Wed Mar 30 01:56:06 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* ext/nkf/nkf-utf8/nkf.c: Merge upstream 4f3edf80a0. 	  patched by Anton
Sivakov [Bug #12201] [Bug #12202]</p>

<p>Wed Mar 30 01:54:30 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/redmine-backporter.rb: add given revision to current changesets 	 
on associating the revision to the related ticket.</p>

<p>Wed Mar 30 01:53:17 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: update revision.h before merge.</p>

<p>Tue Mar 29 19:33:54 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* addr2line.c: define toupper for its use. fix r54391.</p>

<p>Tue Mar 29 19:23:46 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (rb_isupper, rb_islower, rb_isalpha, rb_isdigit, 	 
rb_isalnum, rb_isxdigit, rb_isblank, rb_isspace, rb_isblank, 	  rb_iscntrl,
rb_isprint, rb_ispunct, rb_isgraph, 	  rb_tolower, rb_toupper): use inline
function to avoid function call.</p>

<p>* include/ruby/ruby.h (rb_isascii): use inline function to clarify 	  the
logic.</p>

<p>Tue Mar 29 18:56:55 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/redmine-backporter.rb (backport): show merger.rb&#39;s path.</p>

<p>* tool/redmine-backporter.rb (show): show current issue again if no 	 
ticket number is given.</p>

<p>* tool/redmine-backporter.rb (rel): show error message if current 	 
bugs.ruby-lang.org doesn&#39;t support the API.</p>

<p>Tue Mar 29 18:54:34 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* tool/merger.rb: support to backport header as backport identifier. 	 
Now you can specify by &#39;merge revision(s) 49254: [Backport
#10738]&#39;.</p>

<p>Tue Mar 29 16:53:44 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Tweaked handling of 6 	 
special cases in CaseUnfold_11_Table.</p>

<p>* enc/unicode.c: Adjustments for above.</p>

<p>* test/ruby/enc/test_case_mapping.rb: Tests for the above: Some tests in 	
test_titlecase activated; test_greek added. A test in test_cherokee fixed.</p>

<p>Tue Mar 29 13:31:00 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Cleaned up some comments.</p>

<p>Tue Mar 29 13:24:56 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Removing data for idempotent 	 
titlecasing.</p>

<p>* enc/unicode.c: Adjust code to data removal.</p>

<p>Tue Mar 29 12:45:18 2016  Laurent Arnoud  &lt;laurent@spkdev.net&gt;</p>

<p>* lib/webrick/httpresponse.rb: Move error_body to method. It allow to 	 
override the body more easily. [fix GH-1307] 	*
test/webrick/test_httpresponse.rb: ditto.</p>

<p>Tue Mar 29 06:40:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (rb_compile_err_append): rb_thread_t::base_block is no 	  longer
used.</p>

<p>* iseq.c (rb_iseq_compile_with_option): ditto, no protection is 	  needed.</p>

<p>Tue Mar 29 06:39:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (struct parser_params): move parse_in_eval flag from 	 
rb_thread_t.</p>

<p>* parse.y (rb_parser_set_context): set parsing context, not only 	  mild
error flag.</p>

<p>* iseq.c (rb_iseq_compile_with_option): the parser now refers no 	  thread
local states to be restored.</p>

<p>* vm_eval.c (eval_string_with_cref): ditto.</p>

<p>Mon Mar 28 21:24:02 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* numeric.c (int_pos_p): fix typos.</p>

<p>Mon Mar 28 14:54:49 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Refactoring in preparation for data reduction for 	 
titlecase.</p>

<p>Mon Mar 28 14:36:36 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Minor refactoring for I WITH DOT ABOVE.</p>

<p>Mon Mar 28 14:26:24 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Removed code now covered by data from table.</p>

<p>Mon Mar 28 11:49:21 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Adding comments. [ci skip]</p>

<p>Mon Mar 28 11:30:23 2016  Shinichi Maeshima  &lt;netwillnet@gmail.com&gt;</p>

<p>* lib/rubygems.rb: Fix `Gem.find_spec_for_exe` picks oldest gem. 	  <a
href="https://github.com/travis-ci/travis-ci/issues/5798">github.com/travis-ci/travis-ci/issues/5798</a>
	  <a
href="https://github.com/rubygems/rubygems/pull/1566">github.com/rubygems/rubygems/pull/1566</a>
	* test/rubygems/test_gem.rb: ditto.</p>

<p>Mon Mar 28 11:26:31 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: Update rubygems-2.6.2.
	  Please see entries of 2.6.2 on 	  <a
href="https://github.com/rubygems/rubygems/blob/master/History.txt">github.com/rubygems/rubygems/blob/master/History.txt</a></p>

<p>Mon Mar 28 11:02:31 2016  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>* lib/rubygems/test_case.rb: Fix test on Windows for inconsistent temp
path. 	  <a
href="https://github.com/rubygems/rubygems/pull/1554">github.com/rubygems/rubygems/pull/1554</a>
	  [Bug #<a href="ruby-core:74431">12193]</a></p>

<p>Mon Mar 28 08:19:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (rb_str_format): refactor floating point format of 	  Rational
by using generic Integer functions.</p>

<p>* sprintf.c (rb_str_format): fix buffer overflow, length must be 	 
greater than precision.  reported by William Bowling &lt;will AT 	 
wbowling.info&gt;.</p>

<p>Sun Mar 27 12:13:37 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (rb_str_format): convert Rational to floating point 	  format
by using generic Integer functions, not by methods which 	  can be
overwritten.</p>

<p>Sat Mar 26 10:55:12 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (rb_int2str): conversion function to String for 	  generic
Integer.</p>

<p>* numeric.c (rb_int_round): rounding function for generic 	  Integers.</p>

<p>* numeric.c (rb_int_<code>uminus,plus,minus,mul,idiv,modulo</code>): basic 	 
arithmetic functions for generic Integers.</p>

<p>* numeric.c (FIXNUM_<code>POSITIVE,NEGATIVE,ZERO</code>_P): predict macros 	  only
for Fixnum.</p>

<p>Sat Mar 26 06:34:24 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* localeinit.c (rb_locale_charmap_index): fix prototype. 	  patched by
Andreas Schwab [Bug #12218]</p>

<p>Fri Mar 25 16:40:48 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_mapping.rb: Additional tests title case; 	  some
not yet activated.</p>

<p>Fri Mar 25 13:38:11 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* ext/openssl/extconf.rb: check SSL_CTX_set_next_proto_select_cb 	 
function rather than OPENSSL_NPN_NEGOTIATED macro. it exists 	  even if it
is disabled by OpenSSL configuration. 	  [ruby-core:74384] [Bug #12182]</p>

<p>* ext/openssl/ossl_ssl.c: update #ifdef(s) as above.</p>

<p>* test/openssl/test_ssl.rb: skip NPN tests if NPN is disabled.</p>

<p>Fri Mar 25 11:08:37 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/uri/http.rb (URI::HTTP#initialize): [DOC] fix example, 	  missing
mandatory arguments.  [ruby-core:74540] [Bug #12215]</p>

<p>Fri Mar 25 01:50:58 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (reserve_stack): fix reserving position where 	  the
stack growing bottom to top. [Bug #12118]</p>

<p>Fri Mar 25 01:10:42 2016  Sebastian Schuberth  &lt;sschuberth@gmail.com&gt;</p>

<p>* lib/mkmf.rb (find_executable0): On Windows, it is actually valid 	  to
surround individual PATH directory entries with double 	  quotes. Remove
these before joining the path as otherwise the 	  literal quotes would
become part of the path, resulting in the 	  executable not to be found. 
[Fix GH-1305]</p>

<p>Thu Mar 24 22:38:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (FMT, FMTV): remove recursive-assignments to get rid 	  of
undefined behavior.  [ruby-core:74532] [Bug #12213]</p>

<p>Thu Mar 24 17:44:02 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (FMT_PADDING): extract format for padding.</p>

<p>* strftime.c (FMT_PRECISION): extract precision formula.</p>

<p>* strftime.c (FMTV): append formatted string to expand the result.</p>

<p>Thu Mar 24 14:20:21 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (STRFTIME): deal with case conversion flags for 	  recursive
formats.</p>

<p>Thu Mar 24 12:43:26 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/date/date_core.c (dt_lite_iso8601): strftimev() always 	  returns a
String, so append them directly.</p>

<p>* ext/date/date_core.c (d_lite_jisx0301, iso8601_timediv), 	 
(dt_lite_jisx0301): format by the format string in local buffer 	  to
prevent intermediate strings from GC.</p>

<p>* ext/date/date_core.c (mk_inspect_raw, mk_inspect): inspect by 	 
“%+”PRIsVALUE, to prevent intermediate strings from GC.</p>

<p>Thu Mar 24 11:43:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): remove unnecessary 	  check, as
`s` equals to `endp` when recursed STRFTIME resized 	  the capacity same as
the size.</p>

<p>Wed Mar 23 21:48:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* enum.c (ary_inject_op): put subtract operation out of if-clause.</p>

<p>Wed Mar 23 21:38:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* enum.c (ary_inject_op): Use Kahan&#39;s compensated summation algorithm
	  for summing up float values.</p>

<p>Wed Mar 23 20:56:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* strftime.c (rb_strftime_with_timespec): append formatted results 	  to
the given string with expanding, and also deal with NUL chars.</p>

<p>* strftime.c (rb_strftime, rb_strftime_timespec): return formatted 	 
string, not the length put in the given buffer.</p>

<p>* time.c (rb_strftime_alloc): no longer needs to retry with 	 
reallocating buffers.</p>

<p>* time.c (time_strftime): no longer needs to split by NUL chars.</p>

<p>Wed Mar 23 14:23:54 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/rdoc/ri/driver.rb (interactive): rescue NotFoundError raised in 	 
expand_name. (display_name rescues NotFoundError by itself, 	  the original
logic looks buggy…)</p>

<p>Wed Mar 23 11:44:53 2016  cremno  &lt;cremno@mail.ru&gt;</p>

<p>* marshal.c (r_long): cast to `signed char`, which is used 	  already,
instead of SIGN_EXTEND_CHAR.</p>

<p>* parse.y: SIGN_EXTEND_CHAR is no longer used.  [Fix GH-1302]</p>

<p>Wed Mar 23 11:38:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* cygwin/GNUmakefile.in (MSYS2_ARG_CONV_EXCL_PARAM): 	  * add missing
parentheses and remove double quotes. 	  * rename to get rid of recursive
references. 	  * as –excludes-dir option is for a path name, its argument 	
should be converted. 	  [ruby-dev:49526] [Bug #12199]</p>

<p>Wed Mar 23 10:39:38 2016  Koichi ITO  &lt;koic.ito@gmail.com&gt;</p>

<p>* variable.c: Added documentation about order of `Module#constants` 	  [ci
skip][Bug #<a href="ruby-dev:49505">12121]</a>[fix GH-1301]</p>

<p>Tue Mar 22 21:08:30 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* include/ruby/oniguruma.h: Additional flag for characters that are
titlecase.</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Using above flag in data.</p>

<p>* enc/unicode.c: Marking capitalized character as unmodified if it is 	 
already titlecase.</p>

<p>* test/ruby/enc/test_case_mapping.rb: Tests for above functionality.</p>

<p>Tue Mar 22 14:18:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (lambda_body, parser_yylex): warn mismatched indentation 	  of
lambda block.</p>

<p>Tue Mar 22 11:36:49 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* time.c (wmul): wrong condition. 	  fixed many test failures on 32bit and
LLP64 platforms.</p>

<p>Tue Mar 22 10:31:34 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* time.c (wdiv, wmod): wdivmod0() assumes the 3rd and the 4th arguments 	 
are valid pointers. 	  maybe checking them in wdivmod0() is better manner,
but I guess that 	  passing real dummy pointers may be faster than checking
and branching 	  in wdivmod0(). 	  this commit fixes SEGV on 32bit and
LLP64 platforms.</p>

<p>Tue Mar 22 10:24:04 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* time.c (divmodv): void function never returns any value.</p>

<p>Tue Mar 22 10:11:01 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/lib/test/unit.rb (Test::Unit::StatusLine#failed): print 	  failed
messages only if replacing mode, otherwise defer them 	  until the end, to
get rid of interleaving failures with progress 	  messages.  refix r54195.</p>

<p>Tue Mar 22 03:45:03 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* time.c (MUL_OVERFLOW_FIXWV_P): defined for FIXWV.</p>

<p>* time.c (wmul): use MUL_OVERFLOW_FIXWV_P and only switch.</p>

<p>* time.c (wmul): use mul which has Fixnum optimization.</p>

<p>* time.c (rb_time_magnify): If WIDEVALUE_IS_WIDER, wmul() has the same 	 
optimized logic, else mul() has also the similar logic for Fixnum.</p>

<p>* time.c (rb_time_unmagnify): almost ditto.</p>

<p>Tue Mar 22 03:10:09 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* time.c (divmodv): add the case both arguments are Fixnum.</p>

<p>* time.c (wquo): use quo which has Fixnum optimization.</p>

<p>* time.c (wdivmod0): added for WIDEVALUE_IS_WIDER.</p>

<p>* time.c (wdivmod): use wdivmod0 and divmodv. 	  divmodv has Fixnum
optimization.</p>

<p>* time.c (wdiv): use wdivmod0 and div to avoid the use of divmodv which 	 
calls id_quo whose return value is array.</p>

<p>* time.c (wmod): use wdivmod0 and mod to avoid the use of divmodv which 	 
calls id_quo whose return value is array.</p>

<p>Mon Mar 21 22:32:50 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* internal.h (rb_fix_divmod_fix): like r54213, use FIX2NUM only if 	  x ==
FIXNUM_MIN &amp;&amp; y == -1. This must be a rare case and it is 	 
expected compiler to handle well.</p>

<p>Mon Mar 21 22:15:11 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* time.c (mod): Add Fixnum case.</p>

<p>* time.c (quo): c can be Fixnum except a == FIXNUM_MIN &amp;&amp; b == -1.
	  Such case can be optimized out because quo()&#39;s argument is constant.</p>

<p>Mon Mar 21 22:09:24 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h (rb_fix_mul_fix): multiply converted values, not 	  object
VALUEs.</p>

<p>Mon Mar 21 20:18:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk (TEST_EXCLUDES, EXCLUDE_TESTFRAMEWORK): use full spell 	  long
option.</p>

<p>* cygwin/GNUmakefile.in (MSYS2_ARG_CONV_EXCL): suppress path name 	 
conversions by msys2.  [ruby-dev:49525] [Bug #12199]</p>

<p>Mon Mar 21 19:09:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (enc_succ_alnum_char): try to skip an invalid character 	  gap
between GREEK CAPITAL RHO and SIGMA. 	  [ruby-core:74478] [Bug #12204]</p>

<p>Mon Mar 21 18:55:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* node.c (rb_gc_mark_node): NODE_MATCH2 can have nd_args, u3, 	  since
r54100.</p>

<p>Sun Mar 20 21:17:13 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* internal.h (rb_int128t2big): declare only when HAVE_INT128_T. 	  fixed a
compile error with VC++ introduced at r54203.</p>

<p>Sun Mar 20 20:10:14 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* internal.h (DLONG): defined if long is 32bit (and LONG_LONG is 64bit; 	 
but LONG_LONG is always defined as 64bit), or there&#39;s int128_t.</p>

<p>* internal.h (DL2NUM): defined if DLONG is defined.</p>

<p>* internal.h (rb_fix_mul_fix): defined for `Fixnum * Fixnum`.</p>

<p>* insns.def (opt_mul): use rb_fix_mul_fix().</p>

<p>* numeric.c (fix_mul): ditto.</p>

<p>* time.c (mul): ditto.</p>

<p>Sun Mar 20 18:53:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (fix_gt, fix_ge, fix_lt, fix_le): optimize comparisons 	 
Fixnum against Bignum by rb_big_cmp in inversed order without 	  new Bignum
instance.</p>

<p>Sun Mar 20 18:44:52 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* time.c (add): remove FIXABLE() which is in LONG2NUM().</p>

<p>* time.c (sub): ditto.</p>

<p>* time.c (mul): ditto.</p>

<p>Sun Mar 20 04:46:02 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* bignum.c (rb_big_cmp): reduce the code.</p>

<p>* bignum.c (rb_big_eq): If normalized bignum is still bignum, 	  it must
be larger than fixnum.</p>

<p>Sat Mar 20 00:58:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* include/ruby/intern.h (rb_big_odd_p, rb_big_even_p): move to 	 
internal.h so that they are exported only for ruby itself.</p>

<p>* internal.h (rb_big_odd_p, rb_big_even_p): ditto.</p>

<p>Sat Mar 19 21:56:23 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/lib/test/unit.rb (Test::Unit::StatusLine#failed): defer 	  failed
messages until the end in verbose mode, to get rid of 	  interleaving
failures with progress messages.</p>

<p>Sat Mar 19 21:53:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (fix_cmp): invert the result as the comparison is 	  inverted.</p>

<p>Sat Mar 19 18:32:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (int_to_f): raise NotImplementedError when a receiver 	  class
is unknown.</p>

<p>* test/-ext-/integer/test_my_integer.rb (test_my_integer_to_f): modify 	 
a test for the above change.</p>

<p>Sat Mar 19 18:21:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (Bignum#&lt;=&gt;): remove it because they are unified with 	 
Integer#&lt;=&gt;.</p>

<p>* numeric.c (Integer#&lt;=&gt;, Fixnum#&lt;=&gt;): move &lt;=&gt; method
from Fixnum to 	  Integer.</p>

<p>* numeric.c (int_cmp): add this method for Integer#&lt;=&gt;.</p>

<p>* test/-ext-/integer/test_my_integer.rb (test_my_integer_cmp): add a 	 
test to examine Integer#&lt;=&gt; for unknown subclasses.</p>

<p>Sat Mar 19 14:46:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (rb_iseq_compile_with_option): make the parser in mild 	  error.</p>

<p>* load.c (rb_load_internal0): ditto.</p>

<p>* parse.y (yycompile0): return the error message within the error 	  to be
raised.  [Feature #11951]</p>

<p>* parse.y (parser_compile_error): accumulate error messages in the 	 
error_buffer.</p>

<p>Sat Mar 19 03:57:13 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* time.c (LOCALTIME): organize #ifdefs.</p>

<p>* time.c (GMTIME): define only ifndef HAVE_STRUCT_TM_TM_GMTOFF.</p>

<p>Sat Mar 19 03:53:31 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (rb_cv_member_struct_tm_tm_gmtoff): For Linux (glibc) 	 
define _BSD_SOURCE for time.h to define struct tm.tm_gmtoff.</p>

<p>* time.c: define _BSD_SOURCE at the top.</p>

<p>Sat Mar 19 03:00:50 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/-ext-/time/test_new.rb (test_timespec_new): change a gmtoff 	  test
to a better one that does not depend on whether the current 	  time is in
summer time or not.</p>

<p>Fri Mar 19 00:00:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (rb_big_to_f, Bignum#to_f): removed them because they are 	 
unified with int_to_f and Integer#to_f.</p>

<p>* numeric.c (int_to_f): treat Bignum values directly.</p>

<p>Fri Mar 18 23:41:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (int_to_f, fix_to_f): rename fix_to_f to int_to_f, and add 	 
treatment for subclasses which don&#39;t have definitions of to_f method.</p>

<p>* numeric.c (Integer#to_f, Fixnum#to_f): move to_f method from Fixnum 	 
to Integer.</p>

<p>* ext/-test-/integer/my_integer.c: define helper class for testing 	  to_f
method for a subclass of Integer.</p>

<p>* ext/-test-/integer/extconf.rb: ditto.</p>

<p>* ext/-test-/integer/init.c: ditto.</p>

<p>* test/-ext-/integer/test_my_integer.rb: examine to_f method for a 	 
subclass of Integer.</p>

<p>Fri Mar 18 22:32:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* include/ruby/intern.h (rb_big_hash): Move to internal.h.</p>

<p>* internal.h: ditto.</p>

<p>Fri Mar 18 22:10:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (Bignum#eql?): remove its definition because it is unified 	 
with Numeric#eql?.</p>

<p>* numeric.c (num_eql): treat Bignum values directly.</p>

<p>Fri Mar 18 21:57:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (rb_big_to_s, Bignum#to_s): remove its definition because 	  it
is unified with Integer#to_s.</p>

<p>* numeric.c (int_to_s): treat Bignum values directly.</p>

<p>Fri Mar 18 21:30:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (int_to_s): Move from fix_to_s.</p>

<p>* numeric.c (Integer#to_s): Move from Fixnum#to_s.</p>

<p>Fri Mar 18 16:22:24 2016  Victor Nawothnig 
&lt;Victor.Nawothnig@gmail.com&gt;</p>

<p>* parse.y (parse_numvar): NTH_REF must be less than a half of 	  INT_MAX,
as it is left-shifted to be ORed with back-ref flag. 	  [ruby-core:74444]
[Bug#12192] [Fix GH-1296]</p>

<p>Fri Mar 18 12:25:30 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* gc.c (tick): fix missing close parenthesis.  [Fix GH-1291]</p>

<p>Fri Mar 18 10:24:12 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* ext/date/date_core.c (datetime_to_time): preserve timezone info 	  [Bug
#12189] [Fix GH-1295]</p>

<p>Fri Mar 18 10:17:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (rb_big_hash): make it public function to be available in 	 
other source files, and remove documentation comment for Bignum#hash.</p>

<p>* bignum.c (Bignum#hash): remove its definition because it is unified 	 
with Object#hash.</p>

<p>* include/ruby/intern.h (rb_big_hash): add a prototype declaration.</p>

<p>* hash.c (any_hash): treat Bignum values directly.</p>

<p>Fri Mar 18 02:35:12 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* lib/time.rb (parse, strptime): Fix Time.parse/strptime does not 	  have
compatibility with DateTime.parse/strptime in terms of parsing 	  timezone
[Bug #12190] [Fix GH-1297]</p>

<p>Fri Mar 18 02:17:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (fix_zero_p, fix_even_p, fix_odd_p): remove needless 	 
functions.</p>

<p>Fri Mar 18 02:15:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* numeric.c (int_even_p): treat Fixnum and Bignum values directly.</p>

<p>Fri Mar 18 02:07:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (Bignum#even?, Bignum#odd?): remove definitions 	  because they
are unified with Integer#even? and Integer#odd?.</p>

<p>* numeric.c (Fixnum#zero?, Fixnum#even?, Fixnum#odd?): remove 	 
definitions because they are unified with Numeric#zero?, 	  Integer#even?,
and Integer#odd?.</p>

<p>* numeric.c (num_zero_p, int_odd_p): treat Fixnum and 	  Bignum values
directly.</p>

<p>* test/ruby/test_integer.rb (test_odd_p_even_p): remove meaningless 	 
test case.</p>

<p>Fri Mar 18 01:51:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* bignum.c (rb_big_even_p, rb_big_odd_p): make them public functions 	  to
be available in other source files.</p>

<p>* include/ruby/intern.h (rb_big_even_p, rb_big_odd_p): add prototype 	 
declarations.</p>

<p>Fri Mar 18 00:25:56 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* enum.c (ary_inject_op): Implement the specialized code for sum of 	 
float numbers.</p>

<p>Fri Mar 18 00:15:05 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* numeric.c (num_step): use rb_equal for zero check. rb_num_coerce_cmp 	 
created an object which caused extra overhead.</p>

<p>Thu Mar 17 22:21:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/ruby.h (RB_GC_GUARD_PTR): remove intermediate 	  macro, and
expand for each RB_GC_GUARD.  [Fix GH-1293]</p>

<p>Thu Mar 17 22:08:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (iseq_specialized_instruction): move specialization 	  for
opt_newarray_max/min from translation phase.</p>

<p>Thu Mar 17 21:52:09 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* array.c, enum.c: make rdoc format consistent.</p>

<p>Thu Mar 17 21:47:57 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* NEWS: add Array#max, #min, and the optimization.  [Feature #12172]</p>

<p>Thu Mar 17 21:45:02 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* compile.c (NODE_CALL): add optimization shortcut for Array#max/min. 	 
Now `[x, y].max` is optimized so that a temporal array object is not 	 
created in some condition.  [Feature #12172]</p>

<p>* insns.def (opt_newarray_max, opt_newarray_min): added.</p>

<p>Thu Mar 17 21:35:52 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_max, rb_ary_min): implement Array#max and min with 	 
arguments.  replace super call with rb_nmin_run.</p>

<p>* enum.c (nmin_run): exported (as rb_nmin_run).</p>

<p>* internal.h: added a prototype for rb_nmin_run.</p>

<p>Thu Mar 17 21:24:52 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_max, rb_ary_min): implement a block by itself instead 	 
of delegating Enumerable#max/min.</p>

<p>Thu Mar 17 21:09:34 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* array.c (rb_ary_max, rb_ary_min): Array#max and Array#min added. 	 
[Feature #12172]</p>

<p>* internal.h (OPTIMIZED_CMP): moved from enum.c so that array.c can 	  use
it.</p>

<p>* test/ruby/test_array.rb (test_max, test_min): tests for Array#max 	  and
Array#min.</p>

<p>* test/ruby/test_enum.rb (test_max, test_min): revised a bit to test 	 
Enumerable#max and #min explicitly.</p>

<p>Thu Mar 17 21:02:42 2016  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>* internal.c: struct cmp_opt_data added for refactoring out a data 	 
structure for CMP_OPTIMIZABLE</p>

<p>* array.c (struct ary_sort_data): use struct cmp_opt_data.</p>

<p>* enum.c (struct min_t, max_t, min_max_t): use struct cmp_opt_data.</p>

<p>Thu Mar 17 20:55:21 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* enum.c (ary_inject_op): Extracted from enum_inject.</p>

<p>Thu Mar 17 18:39:04 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* enum.c (enum_inject): Implement the specialized code for sum of 	 
integers including Bignums.</p>

<p>* internal.h (rb_fix_plus): Declared to be usable from enum_inject.</p>

<p>* numeric.c (rb_fix_plus): Defined.</p>

<p>Thu Mar 17 17:20:28 2016  Anton Davydov  &lt;antondavydov.o@gmail.com&gt;</p>

<p>* thread_sync.c: [DOC] Update documentation for Queue class 	 
description.  [Fix GH-1292]</p>

<p>Thu Mar 17 17:14:51 2016  Dinar Valeev  &lt;dvaleev@suse.com&gt;</p>

<p>* gc.c (tick): Use __builtin_ppc_get_timebase for POWER arch. 	  [Fix
GH-1291]</p>

<p>Thu Mar 17 11:51:48 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/securerandom.rb (gen_random): to avoid blocking on Windows. 	  On
Windows OpenSSL RAND_bytes (underlying implementation is 	  RAND_poll in
crypto/rand/rand_win.c) may be blocked at 	  NetStatisticsGet. 	  <a
href="https://wiki.openssl.org/index.php/Random_Numbers#Windows_Issues">wiki.openssl.org/index.php/Random_Numbers#Windows_Issues</a>
	  Instead of this, use Random.raw_seed directly (whose implementation 	 
CryptGenRandom is one of the source of 	  entropy of RAND_poll on Windows).
	  <a
href="https://wiki.openssl.org/index.php/Random_Numbers">wiki.openssl.org/index.php/Random_Numbers</a>
	  Note: CryptGenRandom function is PRNG and doesn&#39;t check its entropy,
	  so it won&#39;t block. [Bug #12139] 	  <a
href="https://msdn.microsoft.com/ja-jp/library/windows/desktop/aa379942.aspx">msdn.microsoft.com/ja-jp/library/windows/desktop/aa379942.aspx</a>
	  <a
href="https://tools.ietf.org/html/rfc4086#section-7.1.3">tools.ietf.org/html/rfc4086#section-7.1.3</a>
	  <a
href="https://eprint.iacr.org/2007/419.pdf">eprint.iacr.org/2007/419.pdf</a>
	  <a
href="http://www.cs.huji.ac.il/~dolev/pubs/thesis/msc-thesis-leo.pdf">www.cs.huji.ac.il/~dolev/pubs/thesis/msc-thesis-leo.pdf</a></p>

<p>Thu Mar 17 12:09:00 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Fixed two macro definitions. 	*
test/ruby/enc/test_case_mapping.rb: Test cases that detected 	  the above
bugs.</p>

<p>Thu Mar 17 11:36:27 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/option.c (inspect_tcpi_msec): more accurate condition 	  for
TCPI msec member inspection function. 	  [ruby-core:74388] [Bug #12185]</p>

<p>Thu Mar 17 08:13:43 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/-ext-/time/test_new.rb (test_timespec_new): Time#gmtoff values 	 
are the same only when both or neither of the Time objects are in 	  summer
time (daylight-saving time).</p>

<p>Thu Mar 17 07:17:36 2016  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* marshal.c (r_object0):  raise ArgumentError when linking to undefined 	 
object.</p>

<p>Thu Mar 17 00:45:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* test/ruby/test_bignum.rb: Make sure to use Bignum values in the tests.</p>

<p>Wed Mar 16 23:10:25 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* defs/keywords (alias, undef): symbol literals are allowed.</p>

<p>* parse.y (parse_percent): should parse symbol literals for alias 	  and
undef.  [ruby-dev:47681] [Bug #8851]</p>

<p>Wed Mar 16 21:39:39 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* enc/trans/JIS: update Unicode&#39;s notice. [Bug #11844]</p>

<p>Wed Mar 16 20:03:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* proc.c (proc_binding): proc from symbol can not make a binding. 	 
[ruby-core:74100] [Bug #12137]</p>

<p>Wed Mar 16 18:42:45 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_mapping.rb: Fixed and activated a test for
Cherokee.</p>

<p>Wed Mar 16 17:58:56 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_mapping.rb: Fixed a logical error.</p>

<p>Wed Mar 16 17:57:34 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_mapping.rb: Adding tests for Cherokee. 	  One
test not yet working. 	  (with Kimihito Matsui)</p>

<p>Wed Mar 16 15:44:05 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_mapping.rb: Adding tests for actual Unicode 	 
case mapping. Fixing some aliasing issues. 	  (with Kimihito Matsui)</p>

<p>Tue Mar 15 21:38:28 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* enum.c (enum_inject): Consider redefinition of Fixnum#+. 	 
[ruby-dev:49510] [Bug#12178] Reported by usa.</p>

<p>Tue Mar 15 20:32:57 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* enum.c (enum_inject): Implement the specialized code for :+ operator 	 
for Fixnums.</p>

<p>Tue Mar 15 20:21:01 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* enum.c (enum_inject): Implement the specialized code for self is an 	 
array and a symbol operator is given.</p>

<p>Tue Mar 15 16:29:51 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Eliminating common code. 	  (with Kimihito Matsui)</p>

<p>Tue Mar 15 16:17:09 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Expansion of some code repetition in preparation for 	 
elimination of common code pieces. 	  (with Kimihito Matsui)</p>

<p>Tue Mar 15 13:49:23 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Additional macros and code to use mapping data in 	 
CaseMappingSpecials array. 	  (with Kimihito Matsui)</p>

<p>Tue Mar 15 13:41:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h (rb_gc_mark_global_tbl): should be private, 	  but was
accidentally exported.</p>

<p>Tue Mar 15 12:51:06 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>* doc/extension.ja.rdoc: Fix RDoc markup in doc/extension*.rdoc. 	  [ci
skip][Bug #<a href="ruby-core:74143">12143]</a> 	* doc/extension.rdoc:
ditto.</p>

<p>Tue Mar 15 09:56:41 2016  Ian Lunderskov  &lt;ian.lunderskov@gmail.com&gt;</p>

<p>* time.c: Minor typo in Time#dst? documentation. 	  [ci skip][fix GH-1290]</p>

<p>Tue Mar 15 04:36:41 2016  Charles Oliver Nutter 
&lt;headius@headius.com&gt;</p>

<p>* test/ruby/test_rubyoptions.rb (test_disable): add tests for 	 
–disable-gems and –disable-did_you_mean.</p>

<p>Tue Mar 15 03:35:04 2016  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>* marshal.c (r_object0): Fix Marshal crash for corrupt extended object.</p>

<p>Tue Mar 15 01:22:27 2016  Charles Oliver Nutter 
&lt;headius@headius.com&gt;</p>

<p>* test/ruby/test_rubyoptions.rb: make version matching support 	 
JRuby&#39;s version output.</p>

<p>Mon Mar 14 19:05:39 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* bignum.c (big2str_2bdigits): reduce div instruction.</p>

<p>Mon Mar 14 18:39:53 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* include/ruby/oniguruma.h, enc/unicode.c: Adjusting flag assignments 	 
and macros to work with unified CaseMappingSpecials array. 	  (with
Kimihito Matsui)</p>

<p>Mon Mar 14 16:53:37 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (compile_named_capture_assign): optimize named capture 	 
assignments, by replacing repeating global variable accesses 	  with `dup`,
and by returning the matched result instead of 	  re-getting it from the
MatchData.</p>

<p>* parse.y (reg_named_capture_assign_gen): build just assignment 	  nodes
for the optimization.</p>

<p>Mon Mar 14 16:02:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* file.c (ruby_is_fd_loadable): now return -1 if loadable but 	  may
block.</p>

<p>* ruby.c (open_load_file): wait to read by the result of 	 
ruby_is_fd_loadable, without fstat.</p>

<p>Mon Mar 14 13:38:38 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* numeric.c (fix2str): improve r54092 like rb_int2big().</p>

<p>Mon Mar 14 10:02:23 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* ext/openssl/ossl_ssl.c (ossl_sslctx_setup): document as MT-unsafe 	 
[ruby-core:73803] [Bug #12069]</p>

<p>Sun Mar 13 09:43:23 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/win32.h (O_SHARE_DELETE): change to fit Fixnum 	  limit. 
[ruby-core:74285] [Bug #12171]</p>

<p>Sun Mar 13 09:15:45 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (rb_fix2str): fix edge case, accidentally generated 	  wrong
Fixnum from LONG_MIN.</p>

<p>Sat Mar 12 09:50:27 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (rb_f_catch): [DOC] fix malformed RDoc syntax,
“<code>...</code>” 	  cannot enclose non-identifier characters. 	  a patch
by Sebastian S in [ruby-core:74278].  [Bug#12170]</p>

<p>Sat Mar 12 02:44:48 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* test/lib/test/unit.rb: describe !/REGEXP/ in the help message.</p>

<p>Fri Mar 11 17:03:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/lib/test/unit.rb (Options#non_options): make regexp name 	  options
prefixed with “!” negative filters.</p>

<p>* common.mk (TEST_EXCLUDES): use negative filter to exclude memory 	  leak
tests.  -x option excludes test files, not test methods.</p>

<p>Fri Mar 11 16:11:27 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Streamlining approach to 	 
case mapping data not available from case folding by unifying all 	  three
cases (special title, special upper, special lower). 	* enc/unicode.c:
Adjust macro names for above (macros are currently inactive). 	  (with
Kimihito Matsui)</p>

<p>Thu Mar 10 17:34:16 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (prepare_iseq_build): enable coverage by coverage_enabled 	 
option, not by parse_in_eval flag in the thread context.</p>

<p>* iseq.h (rb_compile_option_struct): add coverage_enabled flag.</p>

<p>* parse.y (yycompile0): set coverage_enabled flag if coverage 	  array is
made.</p>

<p>Thu Mar 10 15:19:54 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* node.c (dump_option): nd_compile_option is a hidden hash object, 	 
cannot call inspect on it.</p>

<p>Thu Mar 10 09:49:54 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/socket/test_socket.rb (test_udp_recvmsg_truncation): 	  AIX does
not set the MSG_TRUNC flag for a message partially read 	  by recvmsg(2)
with the MSG_PEEK flag set.</p>

<p>Wed Mar  9 16:48:45 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: fix my last commit (syntax error).</p>

<p>Wed Mar  9 16:41:44 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: fix output messages.</p>

<p>* benchmark/memory_wrapper.rb: use respond_to? because 	  member? does not
work well.</p>

<p>Wed Mar  9 16:20:25 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: support memory usage benchmark. 	  use `–<a
href="target">measure-target=</a>&#39;. 	  Now, we can use the following
targets: 	    * real (default): real time which returns process time in
sec. 	    * peak: peak memory usage (physical memory) in bytes. 	    *
size: last memory usage (physical memory) in bytes.</p>

<p>* benchmark/memory_wrapper.rb: ditto.</p>

<p>Wed Mar  9 15:04:22 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/bm_vm3_gc_old_full.rb: add GC.start benchmark.</p>

<p>* benchmark/bm_vm3_gc_old_immediate.rb: ditto.</p>

<p>* benchmark/bm_vm3_gc_old_lazy.rb: ditto.</p>

<p>Wed Mar  9 14:59:11 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* benchmark/driver.rb: exit benchmarking if a benchmark process 	 
receives signals.</p>

<p>Wed Mar  9 13:22:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* test/lib/memory_status.rb: make Memory::Status independent of 	 
MiniTest::Skip.</p>

<p>* test/lib/test/unit/assertions.rb (assert_no_memory_leak): skip 	  if
Memory::Status is not available.</p>

<p>Wed Mar  9 09:19:55 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/io/wait/test_io_wait.rb (test_wait_readwrite_timeout): 	  select(2)
in AIX returns “readable” for the write-side fd 	  of a pipe, so it is not
possible to use a pipe to test 	  the read-write timeout of IO#wait on AIX.</p>

<p>Wed Mar  9 03:35:22 2016  Charles Oliver Nutter 
&lt;headius@headius.com&gt;</p>

<p>* test/ruby/test_require.rb (test_require_with_loaded_features_pop): 	 
Only remove PATH so threads don&#39;t accidentally double-pop.</p>

<p>Wed Mar  9 00:29:46 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_method.c (rb_alias): the original name should be properly 	 
available method_added method, set the name before calling the 	  hook.</p>

<p>Wed Mar  9 00:07:03 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/logger.rb (Logger::LogDevice#initialize): define using 	  keyword
arguments.</p>

<p>Tue Mar  8 23:37:07 2016  Charles Oliver Nutter 
&lt;headius@headius.com&gt;</p>

<p>* test/ruby/test_array.rb: split out the test for no stack error 	  on
large input for test_permutation, test_repeated_permutation, 	  and
test_repeated_combination, and make them all timeout:30.</p>

<p>Tue Mar  8 17:20:21 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* intern.h (rb_divmod): assume compilers `/` and `%` comply C99 	  and
reduce branching. If a compiler doesn&#39;t comply, add #ifdefs.</p>

<p>* intern.h (rb_div): added for Ruby&#39;s behavior.</p>

<p>* intern.h (rb_mod): added for Ruby&#39;s behavior.</p>

<p>* insns.def (opt_div): use rb_div.</p>

<p>* insns.def (opt_mod): use rb_mod.</p>

<p>* numeric.c (fixdivmod): removed.</p>

<p>* numeric.c (fix_divide): use rb_div.</p>

<p>* numeric.c (fix_mod): use rb_mod.</p>

<p>* numeric.c (fix_divmod): use rb_divmod.</p>

<p>Tue Mar  8 17:53:09 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* insns.def (opt_mod): show its method name on ZeroDivisionError. 	  [Bug
#12158]</p>

<p>Tue Mar  8 17:33:38 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_write_console): now no need to check 	 
ERROR_CALL_NOT_IMPLEMENTED because it is for old Win9X.</p>

<p>Tue Mar  8 16:54:29 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (rb_w32_write_console): stop the VT100 emulation if the 	 
console supports it natively.</p>

<p>Tue Mar  8 08:13:01 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/net/imap/test_imap.rb (test_idle_timeout): Because of the 	 
timeout specified in “imap.idle(0.2)”, there is no guarantee that 	  the
server thread has done all the work before the client thread 	  performs
the assertions. It depends on the thread scheduling. 	  Add checks to avoid
false positives (on AIX, particularly).</p>

<p>Tue Mar  8 00:42:22 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* ruby.c (warn_cr_in_shebang): meaningless check on DOSISH platforms. 	 
fixed a test failure introduced at r53998.</p>

<p>Tue Mar  8 00:27:53 2016  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb: fix method name typo. 	 
[ruby-core:72513] [Bug #11893] The patch provided by Akira Matsuda.</p>

<p>Tue Mar  8 00:25:08 2016  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/tk/lib/tkextlib/tcllib/toolbar.rb: fix method name typo. 	 
[ruby-core:72511] [Bug #11891] The patch provided by Akira Matsuda.</p>

<p>Tue Mar  8 00:21:58 2016  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/tk/lib/tkextlib/blt/tree.rb: fix method name typo. 	 
[ruby-core:72510] [Bug #11890] The patch provided by Akira Matsuda.</p>

<p>Tue Mar  8 00:11:47 2016  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* ext/tk/lib/tk/menubar.rb: fix a typo in font name. [ruby-core:72505] 	 
[Bug #11886] The patch provided by Akira Matsuda.</p>

<p>* ext/tk/sample/*.rb: ditto.</p>

<p>Mon Mar  7 13:32:58 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* class.c (rb_define_class, rb_define_class_id_under): raise 	 
ArgumentError if super is 0, deprecated behavior which has been 	  warned
long time.</p>

<p>Mon Mar  7 13:28:30 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* internal.h: move function declarations for class internals from 	 
include/ruby/intern.h.</p>

<p>Mon Mar  7 10:58:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/win32ole/win32ole_event.c (rescue_callback): use 	 
rb_write_error_str instead of rb_write_error, to respect 	  the encoding
and prevent the message from GC.</p>

<p>* internal.h (rb_write_error_str): export.</p>

<p>Mon Mar  7 01:38:41 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/ruby/test_process.rb (test_execopts_gid): Skip a test 	  that is
known to fail on AIX. AIX allows setgid to 	  a supplementary group, but
Ruby does not allow the “-e” 	  option when setgid&#39;ed, so the test does
not work as intended.</p>

<p>Sun Mar  6 22:43:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* io.c (rb_obj_display): [DOC] fix output of Array, as Array#to_s 	  is
same as Array#inspect since 1.9.</p>

<p>Sat Mar  5 09:50:58 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/socket/test_addrinfo.rb (test_ipv6_address_predicates): 	 
IN6_IS_ADDR_V4COMPAT and IN6_IS_ADDR_V4MAPPED are broken 	  on AIX, so skip
related tests.</p>

<p>Sat Mar  5 09:17:54 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/rinda/test_rinda.rb (test_make_socket_ipv4_multicast): 	  The fifth
argument to getsockopt(2) should be modified to 	  indicate the actual size
of the value on return, 	  but not in AIX. This is a know bug. Skip related
tests. 	* test/rinda/test_rinda.rb (test_ring_server_ipv4_multicast): 	 
ditto. 	* test/rinda/test_rinda.rb (test_make_socket_unicast): ditto. 	*
test/socket/test_basicsocket.rb (test_getsockopt): ditto. 	*
test/socket/test_sockopt.rb (test_bool): ditto.</p>

<p>Sat Mar  5 07:36:27 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/-ext-/float/test_nextafter.rb: In AIX, 	 
nextafter(+0.0,-0.0)=+0.0, and nextafter(-0.0,+0.0)=-0.0, 	  but they
should return -0.0 and +0.0, respectively. This is 	  a known bug in
nextafter(3) on AIX, so skip related tests.</p>

<p>Sat Mar  5 07:14:10 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* test/zlib/test_zlib.rb (test_adler32_combine, test_crc32_combine): 	 
Skip two tests on AIX because zconf.h in zlib does not correctly 	 
recognize _LARGE_FILES in AIX. The problem was already reported 	  to zlib,
and skip these tests until it is fixed.</p>

<p>Sat Mar  5 03:07:40 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>* thread_pthread.c (getstack): __pi_stacksize returned by 	 
pthread_getthrds_np() is wrong on AIX. Use 	  __pi_stackend -
__pi_stackaddr instead.</p>

<p>Fri Mar  4 19:19:42 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: use 2 bits with unsigned int for rb_objspace::flags::mode 	 
because it always returns 0 to 2 (non-negative value).</p>

<p>Fri Mar  4 18:42:08 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: rename “enum gc_stat” to “enum gc_mode” 	  because there is a same
name (no related) function gc_stat().</p>

<p>Also gc_stat_* are renamed to gc_mode_*, 	  gc_stat_transition() to
gc_mode_transition(), 	  rb_objspace::flags::stat is renamed to
rb_objspace::flags::mode.</p>

<p>Change rb_objspace::flags::mode from 2 bits to 3 bits because VC++ 	 
returns negative enum value with 2 bits.</p>

<p>* gc.c (gc_mode): add a macro to access rb_objspace::flags::mode 	  with
verification code (verification is enabled only on 	  RGENGC_CHECK_MODE
&gt; 0).</p>

<p>* gc.c (gc_mode_set): same macro for setter.</p>

<p>Fri Mar  4 09:28:18 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: Update rubygems-2.6.1.
	  Please see entries of 2.6.0 and 2.6.1 on 	  <a
href="https://github.com/rubygems/rubygems/blob/master/History.txt">github.com/rubygems/rubygems/blob/master/History.txt</a>
	  [fix GH-1270] Patch by @segiddins</p>

<p>Thu Mar  3 14:09:00 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/ostruct.rb (modifiable?, new_ostruct_member!, table!): 	  rename
methods for internal use with suffixes and make private, 	 
[ruby-core:71069] [Bug #11587]</p>

<p>Wed Mar  2 16:28:48 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (method_missing): call by found method entry and get 	  rid of
searching the same method entry twice.</p>

<p>* vm_eval.c (vm_call0_body): calling method_missing method is 	 
method_missing().</p>

<p>Wed Mar  2 15:13:33 2016  herwinw  &lt;herwin@quarantainenet.nl&gt;</p>

<p>* lib/xmlrpc.rb: Removed broken parser named XMLScanStreamParser. 	 
It&#39;s not works with current Ruby version. 	  [fix <a
href="ruby-core:59588">GH-1271]</a>[Bug #9369] 	* lib/xmlrpc/config.rb:
ditto. 	* lib/xmlrpc/parser.rb: ditto.</p>

<p>Wed Mar  2 15:08:33 2016  herwinw  &lt;herwin@quarantainenet.nl&gt;</p>

<p>* lib/xmlrpc.rb: Removed broken parser named XMLTreeParser. 	  Required
gem of its parser didn&#39;t compile on newer Ruby versions. 	  [fix <a
href="ruby-core:59590">GH-1271]</a>[Bug #9370] 	* lib/xmlrpc/config.rb:
ditto. 	* lib/xmlrpc/parser.rb: ditto.</p>

<p>Tue Mar  1 11:25:48 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/fileutils.rb: use keyword arguments instead of option 	  hashes.</p>

<p>Mon Feb 29 16:50:20 2016  hanachin  &lt;hanachin@gmail.com&gt;</p>

<p>* array.c (rb_ary_push_m): [DOC] Remove trailing comma from 	  Array#push
example, as other Array examples doesn&#39;t put trailing 	  comma.  [Fix
GH-1279]</p>

<p>Mon Feb 29 16:31:01 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* common.mk, tool/mkconfig.rb: set cross_compiling option from 	 
Makefile, but not from rbconfig.rb, which is just going to be 	  created by
this command.</p>

<p>Sun Feb 28 23:13:49 2016  C.J. Collier 
&lt;cjcollier@linuxfoundation.org&gt;</p>

<p>* configure.in: Add summary to end of configure output. 	  [Fix GH-1275]</p>

<p>Sun Feb 28 20:23:36 2016  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* lib/drb/drb.rb (error_print): Add verbose failure messages and 	  avoid
infamous DRb::DRbConnError. [Feature #12101]</p>

<p>Sun Feb 28 13:40:46 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (nometh_err_initialize): add private_call? parameter.</p>

<p>* error.c (nometh_err_private_call_p): add private_call? method, 	  to
tell if the exception raised in private form FCALL or VCALL. 	  [Feature
#12043]</p>

<p>* vm_eval.c (make_no_method_exception): append private_call? 	  argument.</p>

<p>* vm_insnhelper.c (ci_missing_reason): copy FCALL flag.</p>

<p>Sun Feb 28 10:19:47 2016  Ryan T. Hosford  &lt;tad.hosford@gmail.com&gt;</p>

<p>* array.c (rb_ary_and): clarify that set intersection returns the 	 
unique elements common to both arrays.</p>

<p>* array.c (rb_ary_or): clarify that union preserves the order from 	  the
given arrays.</p>

<p>Sat Feb 27 17:05:29 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Reducing size of TitleCase 	 
table by eliminating duplicates. 	  (with Kimihito Matsui)</p>

<p>Fri Feb 26 14:40:48 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (num_step_scan_args): comparison String with Numeric 	  should
raise TypeError. it is an invalid type, but not a 	  mismatch the number of
arguments.  [ruby-core:62430] [Bug #9810]</p>

<p>Fri Feb 26 14:39:39 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* doc/extension.rdoc, doc/extension.ja.rdoc: add editor local 	 
variables, with commenting out by :enddoc: directives which are 	  just
ignored unless code object mode.  [Bug #12111]</p>

<p>Fri Feb 26 12:25:56 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/extension.ja.rdoc: removed rendering error caused by editor specific
	  configuration on <a
href="http://docs.ruby-lang.org/en/trunk/extension_rdoc.html">docs.ruby-lang.org/en/trunk/extension_rdoc.html</a>
. 	  [Bug #<a href="ruby-core:73990">12111]</a></p>

<p>Fri Feb 26 11:21:41 2016  herwinw  &lt;herwin@quarantainenet.nl&gt;</p>

<p>* lib/xmlrpc.rb: Removed references to NQXML. It&#39;s obsoleted parser. 	
[fix <a href="ruby-core:59593">GH-1245]</a>[Feature #9371] 	*
lib/xmlrpc/config.rb: ditto. 	* lib/xmlrpc/parser.rb: ditto.</p>

<p>Fri Feb 26 11:10:19 2016  Rick Salevsky  &lt;rsalevsky@suse.com&gt;</p>

<p>* lib/tmpdir.rb: Unify to coding-style for method definition. 	  [fix
GH-1252]</p>

<p>Fri Feb 26 11:02:04 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* README.md: update markdown syntax for anchor tag. 	  [fix GH-1265] Patch
by @lukBarros</p>

<p>Fri Feb 26 10:52:29 2016  Alex Boyd  &lt;alex@opengroove.org&gt;</p>

<p>* lib/irb.rb: avoid to needless truncation when using back_trace_limit
option. 	  [fix <a href="ruby-core:72773">GH-1205]</a>[Bug #11969]</p>

<p>Fri Feb 26 08:11:58 2016  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>* gem_prelude.rb: Reduce system calls by activating the `did_you_mean` 	 
gem before requiring the gem.  Activating the gem puts the gem on 	  the
load path, where simply requiring the file will search every gem 	 
that&#39;s installed until it can find a gem that contains the 	 
`did_you_mean` file.</p>

<p>Thu Feb 25 19:04:13 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb: Adding possibility for debugging output 	 
for TitleCase table in casefold.h. 	  (with Kimihito Matsui)</p>

<p>Wed Feb 24 22:31:13 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* include/ruby/oniguruma.h: Rearranging flag assignments and making 	 
space for titlecase indices; adding additional macros to add or 	  extract
titlecase index; adding comments for better documentation. 	*
enc/unicode.c: Moving some macros to include/ruby/oniguruma.h; 	 
activating use of titlecase indices. 	  (with Kimihito Matsui)</p>

<p>Wed Feb 24 21:03:04 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* random.c (limited_rand): Add a specialized path for when the limit fits
	  in 32 bit.</p>

<p>Tue Feb 23 21:52:24 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Outputting actual titlecase 	 
data (new table, with indices from other tables). 	* enc/unicode.c:
Ignoring titlecase data indices for the moment. 	  (with Kimihito Matsui)</p>

<p>Tue Feb 23 15:21:14 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Reading casing data from 	 
SpecialCasing.txt. 	  (with Kimihito Matsui)</p>

<p>Mon Feb 22 18:33:55 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Adding flag for title-case, 	 
not yet operational. 	  (with Kimihito Matsui)</p>

<p>Mon Feb 22 18:17:03 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Fixed bug that avoided
inclusion 	  of compatibility characters in upper-/lower-case mappings. 	 
(with Kimihito Matsui)</p>

<p>Sun Feb 21 13:57:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* cgi/escape/escape.c: Optimize CGI.unescape performance by C ext 	  for
ASCII-compatible encodings.  [Fix GH-1250]</p>

<p>Sun Feb 21 13:56:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* cgi/escape/escape.c: Optimize CGI.unescapeHTML performance by C 	  ext
for ASCII-compatible encodings.  [Fix GH-1242]</p>

<p>Sat Feb 20 15:38:16 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* doc/extension.rdoc: update paths for defs/ directory</p>

<p>Sat Feb 20 14:44:15 2016  Lucas Buchala  &lt;lucasbuchala@gmail.com&gt;</p>

<p>* vm_eval.c (rb_mod_module_eval): [DOC] Fix documentation 	  signature for
Module#module_eval.  [Fix GH-1258]</p>

<p>Sat Feb 20 14:40:44 2016  Adam O&#39;Connor  &lt;northband@gmail.com&gt;</p>

<p>* README.md: a few grammatical changes to the main Ruby README.md. 	  [Fix
GH-1259]</p>

<p>Sat Feb 20 13:04:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (push_pattern, push_glob): deal with read paths as UTF-8 	  to
stat later, on Windows as well as OS X. 	  [ruby-core:73868] [Bug #12081]</p>

<p>Sat Feb 20 01:53:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_mod_const_get): make error message at uninterned 	  string
consistent with symbols.  [ruby-dev:49498] [Bug #12089]</p>

<p>Fri Feb 19 23:37:52 2016  Masahiro Tomita  &lt;tommy@tmtm.org&gt;</p>

<p>* lib/find.rb (Find#find): raise with the given path name if it 	  does
not exist.  [ruby-dev:49497] [Bug #12087]</p>

<p>Fri Feb 19 12:44:57 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Activated use of case mapping data in CaseUnfold_11
array. 	  (with Kimihito Matsui)</p>

<p>Fri Feb 19 11:08:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/extmk.rb: add cygwin case, nothing excluded. 	  [ruby-core:73806]
[Bug#12071]</p>

<p>Thu Feb 18 21:32:15 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* man/irb.1: fix output in EXAMPLES.</p>

<p>Thu Feb 18 21:05:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (sym_match_m): delegate to String#match but not 	  String#=~. 
[ruby-core:72864] [Bug #11991]</p>

<p>Thu Feb 18 14:15:38 2016  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>* re.c: Add MatchData#named_captures 	  [Feature #11999] [ruby-core:72897]</p>

<p>* test/ruby/test_regexp.rb(test_match_data_named_captures): Test for
above.</p>

<p>* NEWS: News about MatchData#named_captures.</p>

<p>Wed Feb 17 21:41:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* defs/id.def (predefined): add idLASTLINE and idBACKREF for $_ 	  and $~
respectively.</p>

<p>* parse.y: use idLASTLINE and idBACKREF instead of rb_intern.</p>

<p>Wed Feb 17 20:23:38 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_init): fix segfault and memory leak, consider 	  wide
char encoding terminator.</p>

<p>Wed Feb 17 12:14:59 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (rb_str_init): introduce String.new(capacity: size) 	  [Feature
#12024]</p>

<p>Tue Feb 16 19:10:08 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, casefold.h: Used only first element 	 
(rather than all) of target in CaseUnfold_11 array. 	  (with Kimihito
Matsui)</p>

<p>Tue Feb 16 18:24:38 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* numeric.c (compare_with_zero): fix variable name, rb_cmperr 	  requires
VALUEs but not an ID.</p>

<p>Tue Feb 16 17:34:18 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* dir.c (rb_dir_s_empty_p): add Dir.empty? method, which tells the 	 
argument is the name of an empty directory.  [Feature #10121]</p>

<p>Tue Feb 16 09:51:20 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (without_destdir): just strip a drive letter 	  which
is prepended by with_destdir. 	  pointed out by @DavidEGrayson. 	  <a
href="https://github.com/ruby/ruby/commit/0e5f9ae#commitcomment-16101763">github.com/ruby/ruby/commit/0e5f9ae#commitcomment-16101763</a></p>

<p>Tue Feb 16 04:42:13 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* insns.def (opt_plus): simply use LONG2NUM() instead of wrongly 	 
complex overflow case.</p>

<p>* insns.def (opt_sub): ditto.</p>

<p>Tue Feb 16 02:49:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/rbinstall.rb (without_destdir): compare with the destdir 	  after
stripping a drive letter, on dosish platforms. 	  pointed out by
@DavidEGrayson. 	  <a
href="https://github.com/ruby/ruby/commit/d0cf23b#commitcomment-16100407">github.com/ruby/ruby/commit/d0cf23b#commitcomment-16100407</a></p>

<p>Mon Feb 15 15:44:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parse_ident): allow keyword arguments just after a 	  method
where the same name local variable is defined. 	  [ruby-core:73816]
[Bug#12073]</p>

<p>Mon Feb 15 14:43:28 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb: Added debugging option 	  (with Kimihito
Matsui)</p>

<p>Sun Feb 14 17:31:50 2016  Lars Kanis  &lt;lars@greiz-reinsdorf.de&gt;</p>

<p>* lib/mkmf.rb (with_<code>cpp,c,ld</code>flags): copy caller strings not to 	  be
modified, in append_<code>cpp,c,ld</code>flags respectively. 	  [Fix GH-1246]</p>

<p>Sun Feb 14 16:18:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (setup_exception): set the cause only if it is explicitly 	 
given or not set yet.  [Bug #12068]</p>

<p>Sat Feb 13 21:44:58 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>* hash.c (rb_hash_invert): [DOC] more examples.</p>

<p>Sat Feb 13 17:30:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/uri/generic.rb (URI::Generic#find_proxy): support CIDR in 	 
no_proxy.  [ruby-core:73769] [Feature#12062]</p>

<p>Sat Feb 13 17:11:58 2016  Fabian Wiesel  &lt;fabian.wiesel@sap.com&gt;</p>

<p>* lib/uri/generic.rb (find_proxy): exclude white-spaces and allow 	  for a
leading dot in the domain name in no_proxy. 	  [ruby-core:54542] [Feature
#8317]</p>

<p>Fri Feb 12 12:20:56 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* error.c (name_err_initialize, nometh_err_initialize): [DOC] fix 	 
argument positions.  optional parameters except for the message 	  are
placed at the last.</p>

<p>Fri Feb 12 11:49:49 2016  Anthony Dmitriyev  &lt;antstorm@gmail.com&gt;</p>

<p>* net/ftp.rb: add NullSocket#closed? to fix closing not opened 	 
connection.  [Fix GH-1232]</p>

<p>Fri Feb 12 11:17:38 2016  Bogdan  &lt;bogdanvlviv@gmail.com&gt;</p>

<p>* re.c (rb_reg_initialize_m): [DOC] fix missing right bracket. 	  [Fix
GH-1243]</p>

<p>Thu Feb 11 14:57:58 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_CHECK_SIZEOF, RUBY_DEFINT): fix for types 	  which
are conditionally available depending on architectures 	  when universal
binary, e.g., __int128.</p>

<p>Thu Feb 11 06:26:18 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (RUBY_DEFINT): use Parameter Expansion.</p>

<p>Thu Feb 11 05:33:24 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in (int128_t): don&#39;t check HAVE_XXX (for example 	 
HAVE___INT128) because RUBY_CHECK_SIZEOF() don&#39;t define it for 	 
config.h and use of $ac_cv_sizeof___int128 alternates the check. 	  (and
don&#39;t need to define because users shouldn&#39;t know that)</p>

<p>Wed Feb 10 12:03:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in (ARFLAGS): check if deterministic mode flag is 	 
effective, which is on by default on Ubuntu.</p>

<p>Tue Feb  9 16:36:23 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>* lib/logger.rb: Remove block from Logger.add as it&#39;s not needed 	 
patch provided by Daniel Lobato Garcia [fix GH-1240] [Bug #12054]</p>

<p>Tue Feb  9 14:32:23 2016  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* ext/zlib/zlib.c: Document mtime header behavior with patch by @schneems
	  Fixes [GH-1129]: <a
href="https://github.com/ruby/ruby/pull/1129">github.com/ruby/ruby/pull/1129</a></p>

<p>Tue Feb  9 13:52:49 2016  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>* re.c: Remove deprecated kcode argument from Regexp.new and compile 	 
patch provided by Dylan Pulliam [Bug #11495]</p>

<p>Mon Feb  8 21:26:19 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb, enc/unicode/casefold.h: Flags for 	 
upper/lower conversion added (titlecase and SpecialCasing still missing) 	 
(with Kimihito Matsui)</p>

<p>Mon Feb  8 20:43:57 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c, enc/unicode.c: Disassociating ONIGENC_CASE_FOLD flag from 	 
ONIGENC_CASE_DOWNCASE. 	  (with Kimihito Matsui)</p>

<p>Mon Feb  8 13:00:17 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Shortened macros for enc/unicode/casefold.h to 	 
single-letter; use flags in casefold.h for logic.</p>

<p>* enc/unicode/case-folding.rb: Added flag for case folding. 	  Changed
parameter passing.</p>

<p>* enc/unicode/casefold.h: New flags added. 	  (with Kimihito Matsui)</p>

<p>Mon Feb  8 10:30:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (feature_option): raise a runtime error if ambiguous 	  feature
name is given, in the future.  [Bug #12050]</p>

<p>Mon Feb  8 09:43:57 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: Removed enc/unicode/casefold.h from automatic build because 	
some CI systems don&#39;t have gperf. Creation of enc/unicode/casefold.h 	 
is now possible with make unicode-up. This is intended as a temporary
measure.</p>

<p>Sun Feb  7 22:10:08 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: Added two more precondition files for enc/unicode/casefold.h</p>

<p>* enc/unicode.c: Added shortening macros for enc/unicode/casefold.h</p>

<p>* enc/unicode/case-folding.rb: Fixed file encoding for CaseFolding.txt 	 
to ASCII-8BIT (should fix some ci errors). Clarified usage. Created 	 
class MapItem. Partially implemented class CaseMapping. 	  (with Kimihito
Matsui)</p>

<p>Sun Feb  7 14:12:32 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb: Fixing parameter passing. 	  (with Kimihito
Matsui)</p>

<p>Sun Feb  7 11:44:03 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode/case-folding.rb: New classes CaseMapping/CaseMappingDummy 	 
to pass as parameters; not yet implemented or used. 	  (with Kimihito
Matsui)</p>

<p>Sun Feb  7 11:16:00 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: using new option in recipe for enc/unicode/casefold.h</p>

<p>* enc/unicode/case-folding.rb: Correctly specify argument to new option. 	
(with Kimihito Matsui)</p>

<p>Sun Feb  7 10:43:27 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>(this commit message applies to the previous commit) 	* common.mk:
explicit recipe for enc/unicode/casefold.h</p>

<p>* enc/unicode/case-folding.rb: Adding -m option to prepare for using 	 
multiple data files. 	  (with Kimihito Matsui)</p>

<p>Sat Feb  6 22:30:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/cgi/util.rb (escapeHTML, unescapeHTML): consider 	 
ASCII-incompatible encodings.  [Fix GH-1239]</p>

<p>Sat Feb  6 15:18:28 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_regex_casefold.rb: Added data-based testing for 	 
String#downcase :fold.</p>

<p>* enc/unicode.c: Fixed a range error (lowest non-ASCII character affected
	  by case operations is U+00B5, MICRO SIGN)</p>

<p>* test/ruby/enc/test_case_mapping.rb: Explicit test for case folding of 	 
MICRO SIGN to Greek mu. 	  (with Kimihito Matsui)</p>

<p>Sat Feb  6 14:51:23 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_regex_casefold.rb: Tests for three case folding 	 
primitives (mbc_case_fold, get_case_fold_codes_by_str, 	 
apply_all_case_fold) in the various encodings. Currently only known 	  good
encodings are tested to avoid test failures. For bug hunting, 	  start by
adding more encodings with 	  generate_test_casefold encoding 	  (with
Kimihito Matsui)</p>

<p>Sat Feb  6 14:37:16 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c, test/ruby/enc/test_case_mapping.rb: Implemented :fold 	 
option for String#downcase by using case folding data from 	  regular
expression engine, and added a few simple tests. 	  (with Kimihito Matsui)</p>

<p>Fri Feb  5 20:08:59 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_case_mapping.rb: added tests for :ascii option. 	 
(with Kimihito Matsui)</p>

<p>Fri Feb  5 12:22:20 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* insns.def (opt_mult): Use int128_t for overflow detection.</p>

<p>* bignum.c (rb_uint128t2big): added for opt_mult.</p>

<p>* bignum.c (rb_uint128t2big): added for rb_uint128t2big..</p>

<p>* configure.in: define int128_t, uint128_t and related MACROs. 	 
Initially introduced by r41379 but reverted by r50749.</p>

<p>Thu Feb  4 21:05:17 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Activated :ascii flag for ASCII-only case conversion 	 
(with Kimihito Matsui)</p>

<p>Thu Feb  4 17:38:01 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* re.c (reg_set_source): make source string frozen without 	  copying.</p>

<p>* re.c (rb_reg_initialize_m): refactor initialization with 	  encoding.</p>

<p>Thu Feb  4 15:35:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* string.c (rb_fstring_enc_new, rb_fstring_enc_cstr): functions to 	  make
fstring with encoding.</p>

<p>Thu Feb  4 14:42:29 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: Added Unicode data file SpecialCasing.txt to be additionally
	  downloaded (with Kimihito Matsui)</p>

<p>Thu Feb  4 12:39:08 2016  joker1007  &lt;kakyoin.hierophant@gmail.com&gt;</p>

<p>* cgi/escape/escape.c: Optimize CGI.escape performance by C ext 	  for
ASCII-compatible encodings.  [Fix GH-1238]</p>

<p>Thu Feb  4 11:53:56 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: Introduce two variables (UNICODE_DATA_DIR and 	 
UNICODE_SRC_DATA_DIR) to eliminate repetitions.</p>

<p>Wed Feb  3 12:13:20 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* string.c (str_new_frozen): if the given string is embeddedable 	  but
not embedded, embed a new copied string. [Bug #11946]</p>

<p>Wed Feb  3 08:25:38 2016  boshan  &lt;boshan@subsplash.com&gt;</p>

<p>* ext/openssl/ossl_pkey.c (Init_ossl_pkey): [DOC] Fix typo 	  “encrypted”
to “decrypted”.  [Fix GH-1235]</p>

<p>Wed Feb  3 08:21:32 2016  Seiei Miyagi  &lt;hanachin@gmail.com&gt;</p>

<p>* ext/ripper/lib/ripper/lexer.rb (on_heredoc_dedent): Fix 	  Ripper.lex
error in dedenting squiggly heredoc.  heredoc tree is 	  also an array of
Elem in the outer tree.  [Fix GH-1234]</p>

<p>Wed Feb  3 02:33:39 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c (rb_reg_prepare_enc): use already compiled US-ASCII regexp 	  if
given string is ASCII only. 	  121.2s to 113.9s on my x86_64-freebsd10.2
Intel Core i5 661</p>

<p>Tue Feb  2 13:02:03 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* re.c: Introduce RREGEXP_PTR. 	  patch by dbussink. 	  partially merge <a
href="https://github.com/ruby/ruby/pull/497">github.com/ruby/ruby/pull/497</a></p>

<p>* include/ruby/ruby.h: ditto.</p>

<p>* gc.c: ditto.</p>

<p>* ext/strscan/strscan.c: ditto.</p>

<p>* parse.y: ditto.</p>

<p>* string.c: ditto.</p>

<p>Tue Feb  2 09:08:27 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems/specification.rb: `coding` is effective only first 	  line
except shebang.</p>

<p>* lib/rubygems/package.rb, lib/rubygems/package/*: ditto.</p>

<p>Mon Feb  1 21:41:58 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: Update rubygems-2.5.2.
	  It supports to enable frozen string literal and add `–norc` option for 	
disable to `.gemrc` configuration. 	  See 2.5.2 release notes for other
fixes and enhancements. 	  <a
href="https://github.com/rubygems/rubygems/blob/a8aa3bac723f045c52471c7b9328310a048561e0/History.txt#L3">github.com/rubygems/rubygems/blob/a8aa3bac723f045c52471c7b9328310a048561e0/History.txt#L3</a></p>

<p>Sun Jan 31 12:33:13 2016  Dan Kreiger  &lt;dan@dankreiger.com&gt;</p>

<p>* test/drb/ut_large.rb (multiply, avg, median): add additional 	  math
operations to DRbLarge.  [Fix GH-1086]</p>

<p>Sun Jan 31 12:19:15 2016  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_file_exhaustive.rb (test_lstat): Add lacking test 	  for
File#lstat.  [Fix GH-1231]</p>

<p>Sun Jan 31 12:15:33 2016  Prayag Verma  &lt;prayag.verma@gmail.com&gt;</p>

<p>* doc/standard_library.rdoc: fix typo  [Fix GH-1230] 	  Spelling mistakes
- 	  outputing &gt; outputting 	  publich &gt; publish</p>

<p>Sat Jan 30 15:18:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_eval.c (rb_check_funcall_with_hook): also should call the 	  given
hook before returning Qundef when overridden respond_to? 	  method returned
false.  [ruby-core:73556] [Bug #12030]</p>

<p>Fri Jan 29 17:40:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* win32/file.c (rb_readlink): drop garbage after the substitute 	  name,
as rb_w32_read_reparse_point returns the expected buffer 	  size but
“??&quot; prefix is dropped from the result.</p>

<p>* win32/win32.c (w32_readlink): ditto, including NUL-terminator.</p>

<p>Fri Jan 29 17:07:27 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* win32/win32.c (fileattr_to_unixmode, rb_w32_reparse_symlink_p): volume 	
mount point should be treated as directory, not symlink. 	 
[ruby-core:72483] [Bug #11874]</p>

<p>* win32/win32.c (rb_w32_read_reparse_point): check the reparse point is 	 
a volume mount point or not.</p>

<p>* win32/file.c (rb_readlink): follow above change (but this pass won&#39;t
	  be used).</p>

<p>Fri Jan 29 16:17:07 2016  Lucas Buchala  &lt;lucasbuchala@gmail.com&gt;</p>

<p>* enum.c (enum_take_while, enum_drop_while): rename block 	  parameter to
obj, since they are generic objects.  [Fix GH-1226]</p>

<p>Fri Jan 29 14:15:26 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/erb.rb (ERB::Compiler#detect_magic_comment): allow 	 
frozen-string-literal in comment as well as encoding.</p>

<p>* lib/erb.rb (ERB#def_method): insert def line just before the 	  first
non-comment and non-empty line, not to leave duplicated 	  and stale magic
comments.</p>

<p>Fri Jan 29 11:13:33 2016  Jeremy Evans  &lt;code@jeremyevans.net&gt;</p>

<p>* lib/erb.rb (ERB#set_eoutvar): explicitly make mutable string as 	  a
buffer to make ERB work with –enable-frozen-string-literal. 	 
[ruby-core:73561] [Bug #12031]</p>

<p>Fri Jan 29 10:44:56 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/net/http/header.rb: Warn nil variable on HTTP Header. 	  It caused
to NoMethodError. [fix GH-952][fix GH-641] Patch by @teosz 	*
test/net/http/test_httpheader.rb: Added test for nil HTTP Header.</p>

<p>Thu Jan 28 17:31:43 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/socket.c (sock_gethostname): support unlimited size 	 
hostname.</p>

<p>Wed Jan 27 21:03:45 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/-ext-/string/test_capacity.rb: Added missing library.</p>

<p>Wed Jan 27 18:53:40 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Fixed bit mask in macro OnigCodePointCount</p>

<p>Wed Jan 27 17:54:42 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Protect code point count by macro, in order to 	  be able
to use the remaining bits for flags. 	  (with Kimihito Matsui)</p>

<p>Wed Jan 27 16:34:35 2016  boshan  &lt;boshan@subsplash.com&gt;</p>

<p>* lib/tempfile.rb (Tempfile#initialize): [DOC] the first parameter 	 
`basename` is optional and defaulted to an empty string since 	  [GH-523]. 
[Fix GH-1225]</p>

<p>Wed Jan 27 16:25:54 2016  Koichi ITO  &lt;koic.ito@gmail.com&gt;</p>

<p>* array.c (rb_ary_dig): [DOC] fix the exception class to be raised 	  when
intermediate object does not have dig method.  TypeError 	  will be raised
now.  [Fix GH-1224]</p>

<p>Tue Jan 26 19:36:15 2016  Aggelos Avgerinos 
&lt;evaggelos.avgerinos@gmail.com&gt;</p>

<p>* array.c (permute0, rpermute0): [DOC] Substitute indexes -&gt; 	  indices
in documentation for consistency.  [Fix GH-1222]</p>

<p>Tue Jan 26 15:21:37 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* compile.c (caller_location): use rb_fstring_cstr for “&lt;compiled&gt;”
	  (it is converted to fstring anyways inside rb_iseq_new_with_opt) 	*
iseq.c (iseqw_s_compile): ditto 	* iseq.c (rb_iseq_new_main): use
rb_fstring_cstr for “&lt;main&gt;” 	* vm.c (Init_VM): ditto, share with
with above 	* iseq.c (iseqw_s_compile_file): rb_fstring before
rb_io_t-&gt;pathv 	  share “&lt;main&gt;” with above 	* vm.c
(rb_binding_add_dynavars): fstring “&lt;temp&gt;” immediately</p>

<p>Tue Jan 26 15:14:01 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>* compile.c (iseq_peephole_optimize): don&#39;t apply tailcall 	 
optimization to send/invokesuper instructions with blockiseq. 	  This is a
follow-up to the changes in r51903; blockiseq is now 	  the third operand
of send/invokesuper instructions. 	  [ruby-core:73413] [Bug #12018]</p>

<p>Tue Jan 26 14:26:46 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* signal.c (sig_list): use fstring for hash key 	*
test/ruby/test_signal.rb (test_signal_list_dedupe_keys): added</p>

<p>Tue Jan 26 13:08:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* signal.c (rb_f_kill): should immediately deliver reserved 	  signals
SIGILL and SIGFPE, not only SIGSEGV and SIGBUS.</p>

<p>Tue Jan 26 07:57:28 2016  Joseph Tibbertsma 
&lt;josephtibbertsma@gmail.com&gt;</p>

<p>* gc.c (RVALUE_PAGE_WB_UNPROTECTED): fix a typo of argument name. 	  [Fix
GH-1221]</p>

<p>Mon Jan 25 17:26:54 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* ruby_assert.h (RUBY_ASSERT_WHEN): fix reference to macro name 	*
vm_core.h: include ruby_assert.h before using 	  [ruby-core:73371]</p>

<p>Mon Jan 25 15:55:30 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* symbol.c (sym_check_asciionly): more informative error message 	  with
the encoding name and the inspected content. 	  [ruby-core:73398] [Feature
#12016]</p>

<p>Mon Jan 25 09:38:26 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/ruby/test_string.rb: added testcase for next!, succ and succ! 	 
[fix GH-1213] Patch by @K0mAtoru</p>

<p>Mon Jan 25 09:32:25 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/webrick/httpservlet/filehandler.rb: fix documentation for namespace.
	  [fix GH-1219][ci skip] Patch by @leafac</p>

<p>Sun Jan 24 19:34:23 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* vm_insnhelper.c (vm_check_if_namespace): tiny size reduction</p>

<p>Sun Jan 24 18:12:36 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: Simplifying Unicode data file download logic to make 	  it
more reliable (including additional fix not in r53633) [Bug #12007]</p>

<p>Sun Jan 24 16:54:11 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/io/wait/wait.c (io_wait_readwrite): [EXPERIMENTAL] allow to 	  wait
for multiple modes, readable and writable, at once.  the 	  arguments may
change in the future.  [Feature #12013]</p>

<p>Sat Jan 23 22:30:59 2016  K0mA  &lt;mctj1218@gmail.com&gt;</p>

<p>* test/ruby/test_array.rb (test_keep_if): Add test for 	  Array#keep_if
separate from Array#select!  [Fix GH-1218]</p>

<p>Sat Jan 23 20:54:26 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* common.mk: revert r53633. It broke rubyci and travis. 	  <a
href="https://travis-ci.org/ruby/ruby/builds/104259623">travis-ci.org/ruby/ruby/builds/104259623</a></p>

<p>Sat Jan 23 20:10:29 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* range.c (range_eqq): revert r51585 because rb_call_super() is 	  called
in range_include() and thus r51585 doesn&#39;t work when the 	  receiver
Range object consists of non linear objects such as Date 	  objects. 	 
[ruby-core:72908] [Bug #12003]</p>

<p>Sat Jan 23 18:37:37 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* ChangeLog: Fixing wrong time on previous commit, and adding 	  previous
commit message to svn [ci skip]</p>

<p>Sat Jan 23 18:30:30 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: Simplifying Unicode data file download logic to make 	  it
more reliable [Bug #12007]</p>

<p>Sat Jan 23 16:29:42 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* tool/downloader.rb: Fixed a logical error, improved documentation</p>

<p>Sat Jan 23 11:42:43 2016  Peter Suschlik  &lt;ps@neopoly.de&gt;</p>

<p>* README.md: Use SVG Travis badge over PNG for better quality and 	 
device support.  [Fix GH-1214] [Fix GH-1216]</p>

<p>Sat Jan 23 11:29:16 2016  Pascal Betz 
&lt;pascal.betz@simplificator.com&gt;</p>

<p>* lib/csv.rb: Update documentation of CSV header converter for 	  r45498,
[GH-575].  [Fix GH-1215]</p>

<p>Fri Jan 22 17:36:46 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* vm_core.h (VM_ASSERT): use RUBY_ASSERT instead of rb_bug.</p>

<p>* error.c (rb_assert_failure): assertion with stack dump.</p>

<p>* ruby_assert.h (RUBY_ASSERT): new header for the assertion.</p>

<p>Fri Jan 22 00:25:57 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* regparse.c (fetch_name_with_level): allow non word characters 	  at the
first character.  [Feature #11949]</p>

<p>* regparse.c (fetch_name): ditto.</p>

<p>Thu Jan 21 17:34:01 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* marshal.c (r_object0): honor Marshal.load post proc 	  value for
TYPE_LINK.  by Hiroshi Nakamura &lt;nahi@ruby-lang.org&gt; 	  <a
href="https://github.com/ruby/ruby/pull/1204">github.com/ruby/ruby/pull/1204</a>
fix GH-1204</p>

<p>Thu Jan 21 16:37:50 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* Makefile.in (update-rubyspec): fix r53208 like r53451.</p>

<p>Wed Jan 20 20:58:25 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* common.mk, Makefile.in: update-config_files is only for Unix 	 
platforms.</p>

<p>Wed Jan 20 17:13:39 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/extlibs.rb: add –cache option to change cache directory.</p>

<p>Tue Jan 19 17:03:40 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* common.mk: Added Unicode data file CaseFolding.txt to be additionally 	 
downloaded (with Kimihito Matsui)</p>

<p>Tue Jan 19 10:09:58 2016  Sho Hashimoto  &lt;sho-h@ruby-lang.org&gt;</p>

<p>* lib/shell.rb (Shell.debug_output_exclusive_unlock): remove 	  because
Mutex#exclusive_unlock was already deleted. [fix GH-1185]</p>

<p>Tue Jan 19 09:38:27 2016  Nick Cox  &lt;nick@nickcox.me&gt;</p>

<p>* vm_method.c: fix grammar in respond_to? warning. 	  [fix GH-1047]</p>

<p>Mon Jan 18 14:37:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_here_document): an escaped newline is not an 	  actual
newline, and the rest part should not be dedented. 	  [ruby-core:72855]
[Bug #11989]</p>

<p>Mon Jan 18 12:04:34 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/ruby/test_string.rb: Added extra testcase for test_rstrip_bang 	 
and test_lstrip_bang. [fix GH-1178] Patch by @Matrixbirds</p>

<p>Mon Jan 18 11:47:27 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* string.c: fix a typo. [fix GH-1202][ci skip] Patch by @sunboshan</p>

<p>Sun Jan 17 21:15:30 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* configure.in: improve ICC (Intel C Compiler) support.</p>

<p>* configure.in (CXX): The name of icc&#39;s c++ compiler is `icpc`.</p>

<p>* configure.in (warnings): Add `-diag-disable=2259` to suppress 	  noisy
warnings: “non-pointer conversion from ”…“ to ”…“ may 	  lose significant
bits”.</p>

<p>* configure.in (optflags): Add `-fp-model precise` like -fno-fast-math.</p>

<p>* lib/mkmf.rb: icc supports -Werror=division-by-zero 	  and
-Werror=deprecated-declarations, but doesn&#39;t support 	 
-Wdivision-by-zero and -Wdeprecated-declarations.</p>

<p>Sun Jan 17 20:40:10 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Any kind of option is now taking the new code path for 	 
upcase/downcase/capitalize/swapcase. :lithuanian can be used for 	  testing
if no specific option is desired. 	* test/ruby/enc/test_case_mapping.rb:
Adjusted to above. 	  (with Kimihito Matsui)</p>

<p>Sun Jan 17 20:10:10 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Fixed a logical error and some comments. 	*
test/ruby/enc/test_case_mapping.rb: Made tests more general. 	  (with
Kimihito Matsui)</p>

<p>Sun Jan 17 17:41:41 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Removed artificial expansion for Turkic, 	  added
hand-coded support for Turkic, fixed logic for swapcase. 	* string.c: Made
use of new case mapping code possible from upcase, 	  capitalize, and
swapcase (with :lithuanian as a guard). 	*
test/ruby/enc/test_case_mapping.rb: Adjusted for above. 	  (with Kimihito
Matsui)</p>

<p>Sun Jan 17 15:30:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/option.c (sockopt_bool): relax boolean size to be one 	  too
not only sizeof(int).  Winsock getsockopt() returns a single 	  byte as a
boolean socket option.  [ruby-core:72730] [Bug #11958]</p>

<p>Sun Jan 17 14:43:01 2016  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_env.rb: [Fix GH-1201] 	  * Extract test code for
ENV#keep_if from ENV#select_bang 	  * Add a test case for
ENV#select_bang,keep_if</p>

<p>Sun Jan 17 14:42:25 2016  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_env.rb: [Fix GH-1201] 	  * Extract test code for
ENV#delete_if from ENV#reject_bang 	  * Add a test case for
ENV#reject_bang,delete_if</p>

<p>Sun Jan 17 14:40:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ext/socket/option.c (check_size): extract a macro to check 	  binary
data size, with a consistent message.</p>

<p>* ext/socket/option.c (sockopt_byte): fix error message, 	  sizeof(int)
differs from sizeof(unsigned char) in general.</p>

<p>Sat Jan 16 21:16:21 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (xstring): reset heredoc indent after dedenting, 	  so that
following string literal would not be dedented. 	  [ruby-core:72857] [Bug
#11990]</p>

<p>Sat Jan 16 17:24:24 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* enc/unicode.c: Artificial mapping to test buffer expansion code. 	*
string.c: Fixed buffer expansion logic. 	*
test/ruby/enc/test_case_mapping.rb: Tests for above. 	  (with Kimihito
Matsui)</p>

<p>Sat Jan 16 16:47:14 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* ext/openssl/lib/openssl/pkey.rb: Added 2048 bit DH parameter. 	*
test/openssl/test_pkey_dh.rb: ditto.</p>

<p>Sat Jan 16 10:51:19 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* enc/unicode.c: fix implicit conversion error with clang. fixup r53548.
	* string.c: ditto.</p>

<p>Sat Jan 16 10:31:00 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* common.mk: test-sample was changed to test-basic. 	  [Feature #<a
href="ruby-core:72823">11982]</a> 	* basictest/runner.rb: ditto. rename
from tool/rubytest.rb. 	* basictest/test.rb: ditto. rename from
sample/test.rb. 	* defs/gmake.mk: picked from r53540 	* sample/test.rb:
backward compatibility for chkbuild.</p>

<p>Sat Jan 16 10:23:23 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c, enc/unicode.c: New code path as a preparation for Unicode-wide
	  case mapping. The code path is currently guarded by the :lithuanian 	 
option to avoid accidental problems in daily use. 	*
test/ruby/enc/test_case_mapping.rb: Test for above. 	* string.c: function
&#39;check_case_options&#39;: fixed logical errors 	  (with Kimihito
Matsui)</p>

<p>Fri Jan 15 20:20:20 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>* regint.h (PLATFORM_UNALIGNED_WORD_ACCESS): The value of 	 
UNALIGNED_WORD_ACCESS should be used to determine whether 	  unaligned word
access is allowed or not. After this commit, 	  ./configure
CPPFLAGS=“-DUNALIGNED_WORD_ACCESS=0” disables 	  unaligned word access even
on platforms that support the feature.</p>

<p>Fri Jan 15 16:12:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (string1): reset heredoc indent for each string literal 	  so
that concatenated string would not be dedented. 	  [ruby-core:72857] [Bug
#11990]</p>

<p>Thu Jan 14 20:01:00 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* lib/uri/generic.rb (URI::Generic#to_s): change encoding to 	  UTF-8 as
Ruby 2.2/ by Koichi ITO &lt;koic.ito@gmail.com&gt; 	  <a
href="https://github.com/ruby/ruby/pull/1188">github.com/ruby/ruby/pull/1188</a>
fix GH-1188</p>

<p>Thu Jan 14 17:36:16 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (rb_f_global_variables): add matched back references 	  only,
as well as defined? operator.</p>

<p>Thu Jan 14 16:12:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* sprintf.c (rb_str_format): format exact number more exactly.</p>

<p>Thu Jan 14 15:08:43 2016  Tony Arcieri  &lt;bascule@gmail.com&gt;</p>

<p>* Remove 512-bit DH group. It&#39;s affected by LogJam Attack. 	  <a
href="https://weakdh.org">weakdh.org</a>/ 	  [fix GH-1196][Bug #<a
href="ruby-core:72766">11968]</a></p>

<p>Thu Jan 14 11:44:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* variable.c (rb_f_global_variables): add $1..$9 only if $~ is 	  set. 
fix the condition removed at r14014.</p>

<p>Wed Jan 13 17:21:45 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* .travis.yml: removed commented-out code.</p>

<p>Wed Jan 13 17:14:54 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* .travis.yml: removed osx code. follow up with r53517</p>

<p>Wed Jan 13 16:56:19 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* iseq.c (rb_iseq_mark): mark parent iseq to prevent dynamically 	 
generated iseq by eval from GC.  [ruby-core:72620] [Bug #11928]</p>

<p>Wed Jan 13 03:42:58 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* class.c (Init_class_hierarchy): resolve name for rb_cObject ASAP 	*
object.c (rb_mod_const_set): move name resolution to rb_const_set 	*
variable.c (rb_const_set): do class resolution here 	  [ruby-core:72807]
[Bug #11977]</p>

<p>Wed Jan 13 00:37:12 2016  Satoshi Ohmori  &lt;sachin21dev@gmail.com&gt;</p>

<p>* man/ruby.1: fix double word typo.  [Fix GH-1194]</p>

<p>Tue Jan 12 21:01:09 2016  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* common.mk: update URL and name for the Ruby spec suite.</p>

<p>Tue Jan 12 19:52:19 2016  sorah (Shota Fukumori)  &lt;her@sorah.jp&gt;</p>

<p>* lib/forwardable.rb: Convert given accessors to String.</p>

<p>r53381 changed to accept only Symbol or String for accessors, but 	 
there are several rubygems that pass classes (e.g. Array, 	  Hash, …) as
accessors. Prior r53381, it was accepted because Class#to_s 	  returns its
class name. After r53381 given accessors are checked 	  with define_method,
but it accepts only Symbol or String, otherwise 	  raises TypeError.</p>

<p>def_delegator Foo, :some_method</p>

<p>This change is to revert unexpected incompatibility. But this behavior 	
may change in the future.</p>

<p>Mon Jan 12 18:41:41 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: made a variable name more grammatically correct</p>

<p>Mon Jan 12 18:34:34 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: minor grammar fix [ci skip]</p>

<p>Mon Jan 12 16:09:09 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* test/ruby/enc/test_casing_options.rb: Tests for option 	 
parsing/checking for upcase/downcase/capitalize/swapcase 	  (see r53503;
with Kimihito Matsui)</p>

<p>Mon Jan 12 16:03:03 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* string.c: Added option parsing/checking for upcase/downcase/ 	 
capitalize/swapcase (with Kimihito Matsui)</p>

<p>Mon Jan 11 21:28:28 2016  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* include/ruby/oniguruma.h: Added flags needed for upcase/downcase 	 
Unicode addition (with Kimihito Matsui)</p>

<p>Mon Jan 11 09:50:24 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: check if the API version number is consistent with 	  the
program version number.</p>

<p>Sun Jan 10 20:57:25 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (compile_massign_lhs): when index ends with splat, 	  append
rhs value to it like POSTARG, since VM_CALL_ARGS_SPLAT 	  splats the last
argument only.  [ruby-core:72777] [Bug #11970]</p>

<p>Sun Jan 10 15:45:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/missing.h (explicit_bzero_by_memset_s): remove 	  inline
implementation by memset_s, which needs a macro before 	  including headers
and can cause problems in extension libraries 	  by the order of the macro
and headers.</p>

<p>Sun Jan 10 13:41:36 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* io.c (rb_deferr): remove long obsolete global</p>

<p>Sun Jan 10 09:14:42 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* ext/psych/lib/psych/visitors/yaml_tree.rb (visit_String): 	  eliminate
chomp 	* lib/net/http.rb (connect): eliminate delete 	*
lib/net/http/header.rb (basic_encode): ditto 	* lib/net/imap.rb
(authenticate): eliminate gsub 	  (self.encode_utf7): shorten delete arg 	*
lib/net/smtp.rb (base64_encode): eliminate gsub 	* lib/open-uri.rb
(OpenURI.open_http): eliminate delete 	* lib/rss/rss.rb: ditto 	*
lib/securerandom.rb (base64): ditto 	  (urlsafe_base64): eliminate delete!
	* lib/webrick/httpauth/digestauth.rb (split_param_value): 	  eliminate
chop 	* lib/webrick/httpproxy.rb (do_CONNECT): eliminate delete 	 
(setup_upstream_proxy_authentication): ditto 	  [ruby-core:72666] [Feature
#11938]</p>

<p>Sat Jan  9 23:19:14 2016  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_hash.rb (test_try_convert): Add test for 	 
Hash.try_convert.  [Fix GH-1190]</p>

<p>Sat Jan  9 23:15:25 2016  Jon Moss 
&lt;maclover7@users.noreply.github.com&gt;</p>

<p>* ext/openssl/ossl.c: Add missing variables to documentation 	  examples. 
[Fix GH-1189]</p>

<p>Sat Jan  9 18:25:57 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* symbol.h (is_attrset_id): ASET is an attrset ID.  fix 	  unexpected safe
call instead of an ordinary ASET.</p>

<p>Sat Jan  9 10:44:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in, win32/setup.mak: extract RUBY_PROGRAM_VERSION from 	 
RUBY_VERSION in version.h instead of RUBY_API_VERSION numbers in 	 
include/ruby/version.h, and cut it into version numbers.</p>

<p>Sat Jan  9 07:13:33 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: rename PAGE_* to HEAP_PAGE_* because PAGE_SIZE is used 	  in Mac
OS X.</p>

<p>* test/ruby/test_gc.rb: catch up this fix.</p>

<p>Sat Jan  9 05:45:40 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: PAGE_BITMAP_PLANES (the number of bitmap) is 4, not 3.</p>

<p>Sat Jan  9 05:42:57 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: rename constant names HEAP_* to PAGE_*.</p>

<p>Keys of GC::INTERNAL_CONSTANTS are also renamed.</p>

<p>* test/ruby/test_gc.rb: catch up this fix.</p>

<p>Fri Jan  8 22:30:06 2016  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>* doc/regexp.rdoc: [DOC] Elaborate on the G anchor. [ci skip]</p>

<p>Fri Jan  8 19:49:27 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: remove heap_page::body. Instead of this field, 	  heap_page::start
field works well.</p>

<p>Fri Jan  8 19:31:52 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: rename rb_heap_t::page_length to rb_heap_t::total_pages.</p>

<p>`page_length&#39; is not clear (we may understand with length of 	  a
page).</p>

<p>Fri Jan  8 17:07:14 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>* gc.c: remove heap_page::heap. This field is only used to recognize 	 
whether a page is in a tomb or not. Instead of this field, 	 
heap_page::flags::in_tomb (1 bit field) is added.</p>

<p>Also type of heap_page::(total|free|final)_slots are changed from 	  int
to short. 2B is enough for them.</p>

<p>Fri Jan  8 09:33:59 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* iseq.c (rb_iseq_compile_with_option): move variable initialization 	 
code to avoid maybe-uninitialized warnings by gcc 4.8.</p>

<p>Fri Jan  8 00:03:22 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enum.c (enum_min, enum_max): do the same optimization as r53454.</p>

<p>Thu Jan  7 22:32:21 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* ruby.h: undef HAVE_BUILTIN___BUILTIN_CHOOSE_EXPR_CONSTANT_P 	  and
HAVE_BUILTIN___BUILTIN_TYPES_COMPATIBLE_P on C++. 	  [ruby-core:72736] [Bug
#11962]</p>

<p>Thu Jan  7 22:02:21 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>* enum.c (enum_minmax): optimize object comparison in 	 
Enumerable#minmax.</p>

<p>Thu Jan  7 14:49:12 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* thread.c (rb_thread_pending_interrupt_p): no pending interrupt 	  before
initialization.</p>

<p>* thread.c (thread_raise_m, rb_thread_kill): uninitialized thread 	 
cannot interrupt.  [ruby-core:72732] [Bug #11959]</p>

<p>Thu Jan  7 11:34:14 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* include/ruby/backward.h (ruby_show_copyright_to_die): for source 	  code
backward compatibility.</p>

<p>* ruby.c (process_options): return Qtrue to exit the process 	 
successfully.</p>

<p>* version.c (ruby_show_copyright): no longer exit.</p>

<p>Wed Jan  6 17:22:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/optparse.rb (OptionParser#order!): add `into` optional 	  keyword
argument to store the results.  [Feature #11191]</p>

<p>Tue Jan  5 21:44:37 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* ChangeLog: fix wrong class name.</p>

<p>Tue Jan  5 21:43:50 2016  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_string.rb(test_chr): added test for String#chr 	  [fix
GH-1179]</p>

<p>Tue Jan  5 21:32:26 2016  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_numeric.rb (test_nonzero_p): added test for
Numeric#nonzero? 	  [fix GH-1187]</p>

<p>Tue Jan  5 11:47:23 2016  Damir Gaynetdinov 
&lt;damir.gaynetdinov@gmail.com&gt;</p>

<p>* doc/marshal.rdoc: Clarify object references example, that the 	 
reference is same object.  [Fix GH-1156]</p>

<p>Tue Jan  5 05:06:51 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* ext/stringio/stringio.c (strio_binmode): implement to set encoding 	*
test/stringio/test_stringio.rb (test_binmode): new test 	 
[ruby-core:72699] [Bug #11945]</p>

<p>Mon Jan  4 15:44:37 2016  Sho Hashimoto  &lt;sho-h@ruby-lang.org&gt;</p>

<p>* variable.c (rb_mod_deprecate_constant): [DOC] added 	  documentation for
Module#deprecate_constant. [ci skip]</p>

<p>Mon Jan  4 15:36:38 2016  Sho Hashimoto  &lt;sho-h@ruby-lang.org&gt;</p>

<p>* thread_sync.c: [DOC] remove SizedQueue#close argument. 	  [ci skip]</p>

<p>Mon Jan  4 10:14:24 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* test/coverage/test_coverage.rb: ignored test when enabled to coverage. 	
It lead to crash with `make test-all`.</p>

<p>Mon Jan  4 08:10:44 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* insns.def (opt_case_dispatch): Move a comment to the 	  appropriate
position. 	  [ci skip]</p>

<p>Sun Jan  3 23:55:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/rubygems/security.rb (DIGEST_ALGORITHM, KEY_ALGORITHM): 	  should
check same name as the used constants. 	  [ruby-core:72674] [Bug #11940]</p>

<p>Sun Jan  3 19:22:01 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* aclocal.m4: add fallback file for non-aclocal environments. 	 
[ruby-core:72683] [Bug #11942]</p>

<p>Sun Jan  3 13:56:49 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>* eval_error.c (rb_print_undef): Use `rb_method_visibility_t` 	  instead
of `int`. 	* eval_intern.h (rb_print_undef): ditto 	* proc.c
(mnew_internal): ditto 	* vm_method.c (rb_export_method): ditto 	  [Misc
#11649] [ruby-core:71311] [fix GH-1078]</p>

<p>Sun Jan  3 12:12:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* acinclude.m4: rename aclocal.m4, which should be generated by 	 
aclocal.  [ruby-core:72675] [Bug #11941]</p>

<p>Sat Jan  2 21:07:55 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* thread_sync.c (queue_do_pop): avoid cast with Qfalse 	 
(rb_szqueue_push): ditto, use queue_sleep wrapper</p>

<p>Sat Jan  2 16:16:14 2016  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>* lib/erb.rb: Allow ERB subclass to add token easily. 	  [Feature #11936]</p>

<p>* test/erb/test_erb.rb: ditto.</p>

<p>Sat Jan  2 14:44:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (regexp): set_yylval_num sets u1, should use nd_tag 	  instead
of nd_state.  [ruby-core:72638] [Bug #11932]</p>

<p>Sat Jan  2 02:27:22 2016  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/ostruct.rb: Fix case of frozen object with initializer. 	  Bug
revealed by RubySpec [ruby-core:72639]</p>

<p>Fri Jan  1 22:01:52 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>* NEWS: mention CSV&#39;s liberal_parsing option.</p>

<p>Fri Jan  1 19:38:23 2016  okkez  &lt;okkez000@gmail.com&gt;</p>

<p>* doc/NEWS-2.3.0: fix double words typo. 	  [ci skip][fix GH-1183]</p>

<p>Fri Jan  1 15:28:56 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (remove_unreachable_chunk): decrease count of 	  call_info in
removed instructions.  fix up r53402.</p>

<p>Fri Jan  1 12:05:53 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* compile.c (remove_unreachable_chunk): remove unreferred label 	  to
optimize away unreachable chunk.</p>

<p>Fri Jan  1 11:42:57 2016  James Edward Gray II 
&lt;james@graysoftinc.com&gt;</p>

<p>* lib/csv.rb (CSV): Add a liberal_parsing option. 	  Patch by Braden
Anderson. [#11839] 	* test/csv/test_features.rb:  test liberal_parsing</p>

<p>Fri Jan  1 10:27:28 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* tool/mkconfig.rb (RbConfig): prefix SDKROOT to oldincludedir 	  not
includedir, the latter is outside the ruby installation. 	 
[ruby-core:72496] [Bug #11881]</p>

<p>Fri Jan  1 08:53:02 2016  Yuki Kurihara  &lt;co000ri@gmail.com&gt;</p>

<p>* test/ruby/test_lazy_enumerator.rb (test_take_bad_arg): Add test 	  code
in case of Enumerator::Lazy#take called with negative number. 	 
[ruby-dev:49467] [Bug #11933]</p>

<p>Fri Jan  1 05:06:20 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (parser_here_document): update indent for each line in 	 
indented here document with single-quotes. 	  [ruby-core:72479] [Bug
#11871]</p>

<p>Fri Jan  1 03:26:44 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/ostruct.rb (freeze): define deferred accessors before 	  freezing to
get rid of an error when just reading frozen 	  OpenStruct.</p>

<p>Thu Dec 31 14:36:45 2015  Marc-Andre Lafortune 
&lt;ruby-core@marc-andre.ca&gt;</p>

<p>* lib/ostruct.rb: Fix new_ostruct_member to correctly avoid 	 
redefinition [#11901]</p>

<p>Thu Dec 31 02:45:12 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>* test/ruby/test_module.rb (test_classpath): r53376 may change 	  the
order of m.constants. 	  `make TESTS=&#39;-v ruby/test_class.rb
ruby/test_module.rb&#39; test-all` 	  may fail after that. 	  <a
href="http://rubyci.s3.amazonaws.com/tk2-243-31075/ruby-trunk/log/20151230T164202Z.log.html.gz">rubyci.s3.amazonaws.com/tk2-243-31075/ruby-trunk/log/20151230T164202Z.log.html.gz</a></p>

<p>Thu Dec 31 02:20:00 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>* common.mk (help): Fix typo.</p>

<p>Wed Dec 30 20:53:09 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/net/http/responses.rb: Added new response class for 451 status code.
	* lib/net/http.rb: documentation for HTTPUnavailableForLegalReasons</p>

<p>Wed Dec 30 20:45:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* lib/webrick/httpstatus.rb: Added HTTP 451 Status Code. 	  [fix GH-1167]
Patch by @MuhammetDilmac 	  <a
href="https://tools.ietf.org/html/draft-tbray-http-legally-restricted-status-00">tools.ietf.org/html/draft-tbray-http-legally-restricted-status-00</a></p>

<p>Wed Dec 30 20:25:52 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/syntax/calling_methods.rdoc: fix old operator for safe navigation 	 
operator. [ci skip][fix GH-1182] Patch by @dougo</p>

<p>Wed Dec 30 16:43:23 2015  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_string.rb (test_ord): Add test for String#ord. 	  [Fix
GH-1181]</p>

<p>Wed Dec 30 11:28:57 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/forwardable.rb (def_instance_delegator): adjust backtrace of 	 
method body by tail call optimization.  adjusting the delegated 	  target
is still done by deleting backtrace.</p>

<p>* lib/forwardable.rb (def_single_delegator): ditto.</p>

<p>Wed Dec 30 11:18:42 2015  Elliot Winkler  &lt;elliot.winkler@gmail.com&gt;</p>

<p>* lib/forwardable.rb (def_instance_delegator) fix delegating to 	 
&#39;args&#39; and &#39;block&#39;, clashing with local variables in
generated 	  methods.  [ruby-core:72579] [Bug #11916]</p>

<p>* lib/forwardable.rb (def_single_delegator): ditto.</p>

<p>Wed Dec 30 09:58:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* object.c (rb_class_inherited_p): search the corresponding 	  ancestor to
prepended module from prepending class itself. 	  [ruby-core:72493] [Bug
#11878]</p>

<p>Wed Dec 30 09:20:00 2015  Yuki Kurihara  &lt;co000ri@gmail.com&gt;</p>

<p>* test/stringio/test_io.rb (test_flag): add assertion for error when 	 
text and binary mode are mixed. 	  [ruby-dev:49465] [Feature #11921]</p>

<p>Wed Dec 30 08:43:59 2015  Yuki Kurihara  &lt;co000ri@gmail.com&gt;</p>

<p>* test/stringio/test_stringio.rb (test_initialize): add test for 	 
StringIO#initialize.  [ruby-core:72585] [Feature #11920]</p>

<p>Wed Dec 30 05:19:24 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* class.c (struct clone_const_arg): adjust for id_table 	  (clone_const):
ditto 	  (clone_const_i): ditto 	  (rb_mod_init_copy): ditto 	 
(rb_singleton_class_clone_and_attach): ditto 	  (rb_include_class_new):
ditto 	  (include_modules_at): ditto 	* constant.h (rb_free_const_table):
ditto 	* gc.c (free_const_entry_i): ditto 	  (rb_free_const_table): ditto 	
(obj_memsize_of): ditto 	  (mark_const_entry_i): ditto 	  (mark_const_tbl):
ditto 	* internal.h (struct rb_classext_struct): ditto 	* object.c
(rb_mod_const_set): resolve class name on assignment 	* variable.c
(const_update): replace with const_tbl_update 	  (const_tbl_update): new
function 	  (fc_i): adjust for id_table 	  (find_class_path): ditto 	 
(autoload_const_set): st_update =&gt; const_tbl_update 	 
(rb_const_remove): adjust for id_table 	  (sv_i): ditto 	 
(rb_local_constants_i): ditto 	  (rb_local_constants): ditto 	 
(rb_mod_const_at): ditto 	  (rb_mod_const_set): ditto 	  (rb_const_lookup):
ditto 	  [ruby-core:72112] [Feature #11614]</p>

<p>Wed Dec 30 04:10:13 2015  CHIKANAGA Tomoyuki 
&lt;nagachika@ruby-lang.org&gt;</p>

<p>* thread_pthread.c (rb_thread_create_timer_thread): destroy attr even 	 
if pthread_create() failed.</p>

<p>Wed Dec 30 02:55:09 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* thread_pthread.c (setup_communication_pipe): delay setting owner 	 
(rb_thread_create_timer_thread): until thread creation succeeds 	 
[ruby-core:72590] [Bug #11922]</p>

<p>Tue Dec 29 19:12:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* ruby.c (proc_options): -W command line option should be able to 	 
override -w in RUBYOPT environment variable.</p>

<p>Tue Dec 29 17:54:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* eval.c (ignored_block): warn if a block is given to `using`, 	  which is
probably for `Module.new`.</p>

<p>Tue Dec 29 12:48:34 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* lib/ostruct.rb (OpenStruct): make respond_to? working on 	 
just-allocated objects for workaround of Psych. 	  [ruby-core:72501] [Bug
#11884]</p>

<p>Tue Dec 29 10:35:00 2015  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>* test/mkmf/test_have_func.rb (test_have_func): 	  Add assertion to
examine the existence of HAVE_RUBY_INIT.</p>

<p>* test/mkmf/test_have_func.rb (test_not_have_func): 	  Add assertion to
examine the absence of HAVE_RUBY_INIT.</p>

<p>Tue Dec 29 06:50:42 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* thread_sync.c: static classes</p>

<p>Tue Dec 29 05:30:30 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* lib/resolv.rb (Resolv::IPv6.create): avoid modifying frozen 	*
test/resolv/test_dns.rb (test_ipv6_create): test for above 	  [Bug #11910]
[ruby-core:72559]</p>

<p>Mon Dec 28 14:55:57 2015  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_string.rb (TestString#test_rstrip_bang): Add test 	  for
String#rstrip!.  [Fix GH-1176]</p>

<p>Mon Dec 28 09:18:53 2015  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_string.rb (TestString#test_lstrip_bang): Add test 	  for
String#lstrip!.  [Fix GH-1176]</p>

<p>Sun Dec 27 23:32:26 2015  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* ext/win32ole/win32ole.c (ole_variant2val): refactoring.</p>

<p>Sun Dec 27 21:14:42 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* process.c (rb_execarg_parent_start1): need to convert the encoding to 	 
ospath&#39;s one.</p>

<p>Sun Dec 27 20:54:22 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>* process.c: use rb_w32_uchdir() instead of plain chdir() on Windows. 	 
reported by naruse via twitter.</p>

<p>* process.c (rb_execarg_addopt): need to convert the encoding to 	 
ospath&#39;s one.</p>

<p>Sun Dec 27 20:00:31 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* enc/x_emoji.h: fix dead-link.</p>

<p>Sun Dec 27 19:55:55 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>* doc/NEWS-2.3.0: fix a typo.</p>

<p>Sun Dec 27 18:08:15 2015  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* string.c (rb_str_lstrip_bang, rb_str_rstrip_bang): [DOC] Fix 	  ruby-doc
comments for String#rstrip! and lstrip!.  It looks like 	  dropped bang. 
[Fix GH-1175]</p>

<p>Sun Dec 27 15:14:20 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>* io.c (io_getpartial): remove unused kwarg from template 	*
test/ruby/test_io.rb (test_readpartial_bad_args): new 	  [Bug #11885]</p>

<p>Sun Dec 27 11:50:53 2015  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_string.rb (test_rstrip, test_lstrip): Add tests 	  for
String#lstrip and rstrip.  The test cases are used from 	  string.c
ruby-doc comments.  [Fix GH-1174]</p>

<p>Sun Dec 27 11:47:46 2015  Kuniaki IGARASHI  &lt;igaiga@gmail.com&gt;</p>

<p>* test/ruby/test_string.rb (test_insert): Add test for 	  String#insert. 
The test cases are written in string.c 	  comments as a reference.  [Fix
GH-1173]</p>

<p>Sun Dec 27 11:03:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* parse.y (show_bitstack): trace stack_type value if yydebug.</p>

<p>Sun Dec 27 10:03:14 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* enc/depend (enc, trans): fix version dependency, shared object 	  files
depend on the RUBY_SO_NAME value for runtime link.</p>

<p>Sun Dec 27 09:47:20 2015  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>* ext/win32ole/win32ole.c (ole_vstr2wc, ole_variant2val): fix blank 	 
string conversion. 	  [Bug #11880] 	  Thanks Akio Tajima for the patch!</p>

<p>Sun Dec 27 09:34:53 2015  craft4coder  &lt;yooobuntu@163.com&gt;</p>

<p>* doc/extension.rdoc: [DOC] `nul` should be uppercase. 	  change
&#39;nul&#39; =&gt; &#39;NUL&#39;.  [Fix GH-1172]</p>

<p>Sat Dec 26 18:29:01 2015  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>* lib/xmlrpc/client.rb: Support SSL options in async methods of 	 
XMLRPC::Client. 	  [Bug #11489] 	  Reported by Aleksandar Kostadinov.
Thanks!!!</p>

<p>Sat Dec 26 11:26:38 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* miniinit.c (Init_enc): add some common aliases of built-in 	  encodings.
[ruby-core:72481] [Bug #11872]</p>

<p>Fri Dec 25 22:43:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>* configure.in: extract RUBY_RELEASE_DAY at generating Makefile.</p>

<p>* version.h (RUBY_RELEASE_DATE): construct from RUBY_RELEASE_YEAR, 	 
RUBY_RELEASE_MONTH, and RUBY_RELEASE_DAY.</p>

<p>Fri Dec 25 21:33:06 2015  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>* version.h (RUBY_VERSION): 2.4.0 development has started.</p>

<p>Fri Dec 25 14:12:12 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>* doc/ChangeLog-2.3.0, ext/tk/lib/tkextlib/SUPPORT_STATUS, 	 
include/ruby/version.h: minor grammar fixes [ci skip]</p>

<p>Fri Dec 25 08:23:22 2015  Tadashi Saito  &lt;tad.a.digger@gmail.com&gt;</p>

<p>* compile.c, cont.c, doc, man: fix common misspelling. 	 
[ruby-core:72466] [Bug #11870]</p>

<p>For the changes before 2.3.0, see doc/ChangeLog-2.3.0 For the changes
before 2.2.0, see doc/ChangeLog-2.2.0 For the changes before 2.1.0, see
doc/ChangeLog-2.1.0 For the changes before 2.0.0, see doc/ChangeLog-2.0.0
For the changes before 1.9.3, see doc/ChangeLog-1.9.3 For the changes
before 1.8.0, see doc/ChangeLog-1.8.0</p>

<p>Local variables: coding: us-ascii add-log-time-format: (lambda ()</p>

<pre class="code ruby"><code class="ruby">(let* ((time (current-time))</code></pre>

<p>(system-time-locale “C”) 	 (diff (+ (cadr time) 32400)) 	 (lo (% diff
65536)) 	 (hi (+ (car time) (/ diff 65536))))</p>

<pre class="code ruby"><code class="ruby">(format-time-string &quot;%a %b %e %H:%M:%S %Y&quot; (list hi lo) t)))</code></pre>

<p>indent-tabs-mode: t tab-width: 8 change-log-indent-text: 2 end: vim:
tabstop=8 shiftwidth=2</p>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>