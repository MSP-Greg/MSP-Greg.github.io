<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: IO &mdash; Core Ruby-2.4.0 d2016-08-01</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "IO",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='index.html'>Core</a> &raquo; 
          <a href='_index.html'>Index (I)</a> &raquo; 
          <span class='title'>IO</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: IO</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'><a href="Object.html" title="Object (class)">Object</a></span>
      <ul class='fullTree'>
        <li><a href="Object.html" title="Object (class)">Object</a></li>
        <li class='next'>IO</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Child Modules:</td>
    <td>
      <div class='box_max'>
        <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a>,
    <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a>
      </div>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <div class='box_max'>
        <a href="IO/EAGAINWaitReadable.html" title="IO::EAGAINWaitReadable (class)">EAGAINWaitReadable</a>,
    <a href="IO/EAGAINWaitWritable.html" title="IO::EAGAINWaitWritable (class)">EAGAINWaitWritable</a>,
    <a href="IO/EINPROGRESSWaitReadable.html" title="IO::EINPROGRESSWaitReadable (class)">EINPROGRESSWaitReadable</a>,
    <a href="IO/EINPROGRESSWaitWritable.html" title="IO::EINPROGRESSWaitWritable (class)">EINPROGRESSWaitWritable</a>
      </div>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Includes:</td>
    <td>
      <div class='box_max'>
        <a href="Enumerable.html" title="Enumerable (module)">Enumerable</a>, <a href="File/Constants.html" title="File::Constants (module)">File::Constants</a>
      </div>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Direct Subclasses:</td>
    <td>
      <a href="File.html" title="File (class)">File</a>
    </td>
  </tr>


  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
<a href='https://github.com/ruby/ruby/blob/trunk/io.c#L12256'>io.c</a><span class='defines'>,<br /><a href='https://github.com/ruby/ruby/blob/trunk/file.c#L1119'>file.c</a>,<br/> <a href='https://github.com/ruby/ruby/blob/trunk/prelude.rb#L18'>prelude.rb</a></span>
</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The IO class is the basis for all input and output in Ruby. An I/O stream
may be <em>duplexed</em> (that is, bidirectional), and so may use more than
one native operating system stream.</p>

<p>Many of the examples in this section use the File class, the only standard
subclass of IO. The two classes are closely associated.  Like the File
class, the Socket library subclasses from IO (such as TCPSocket or
UDPSocket).</p>

<p>The <a href="Kernel.html#open-class_method" title="Kernel.open (method)">Kernel.open</a> method can create an IO (or File) object for these types
of arguments:</p>
<ul><li>
<p>A plain string represents a filename suitable for the underlying operating
system.</p>
</li><li>
<p>A string starting with <code>&quot;|&quot;</code> indicates a subprocess.
The remainder of the string following the <code>&quot;|&quot;</code> is
invoked as a process with appropriate input/output channels connected to
it.</p>
</li><li>
<p>A string equal to <code>&quot;|-&quot;</code> will create another Ruby
instance as a subprocess.</p>
</li></ul>

<p>The IO may be opened with different file modes (read-only, write-only) and
encodings for proper conversion.  See <a href="#new-class_method" title="IO.new (method)">IO.new</a> for these options.  See
<a href="Kernel.html#open-class_method" title="Kernel.open (method)">Kernel.open</a> for details of the various command formats described above.</p>

<p><a href="#popen-class_method" title="IO.popen (method)">IO.popen</a>, the Open3 library, or  <a href="Process.html#spawn-class_method" title="Process.spawn (method)">Process.spawn</a> may also be used to
communicate with subprocesses through an IO.</p>

<p>Ruby will convert pathnames between different operating system conventions
if possible.  For instance, on a Windows system the filename
<code>&quot;/gumby/ruby/test.rb&quot;</code> will be opened as
<code>&quot;\gumby\ruby\test.rb&quot;</code>.  When specifying a
Windows-style filename in a Ruby string, remember to escape the
backslashes:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c:\\gumby\\ruby\\test.rb</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>Our examples here will use the Unix-style forward slashes;
<a href="File.html#ALT_SEPARATOR-constant" title="File::ALT_SEPARATOR (constant)">File::ALT_SEPARATOR</a> can be used to get the platform-specific separator
character.</p>

<p>The global constant ARGF (also accessible as $&lt;) provides an IO-like
stream which allows access to all files mentioned on the command line (or
STDIN if no files are mentioned). <a href="ARGF.html#path-instance_method" title="ARGF#path (method)">ARGF#path</a> and its alias <a href="ARGF.html#filename-instance_method" title="ARGF#filename (method)">ARGF#filename</a>
are provided to access the name of the file currently being read.</p>

<h4 id="label-io-2Fconsole">io/console</h4>

<p>The io/console extension provides methods for interacting with the console.
The console can be accessed from console or the standard
input/output/error IO objects.</p>

<p>Requiring io/console adds the following methods:</p>
<ul><li>
<p>console</p>
</li><li>
<p>#raw</p>
</li><li>
<p>#raw!</p>
</li><li>
<p>#cooked</p>
</li><li>
<p>#cooked!</p>
</li><li>
<p>#getch</p>
</li><li>
<p>#echo=</p>
</li><li>
<p>#echo?</p>
</li><li>
<p>#noecho</p>
</li><li>
<p>#winsize</p>
</li><li>
<p>#winsize=</p>
</li><li>
<p>#iflush</p>
</li><li>
<p>#ioflush</p>
</li><li>
<p>#oflush</p>
</li></ul>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>io/console</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_rows'>rows</span><span class='comma'>,</span> <span class='id identifier rubyid_columns'>columns</span> <span class='op'>=</span> <span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_winsize'>winsize</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Your screen is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_columns'>columns</span><span class='embexpr_end'>}</span><span class='tstring_content'> wide and </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rows'>rows</span><span class='embexpr_end'>}</span><span class='tstring_content'> tall</span><span class='tstring_end'>&quot;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>
<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='EWOULDBLOCKWaitReadable-constant'>
      EWOULDBLOCKWaitReadable
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>:EAGAINWaitReadable</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='EWOULDBLOCKWaitWritable-constant'>
      EWOULDBLOCKWaitWritable
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>:EAGAINWaitWritable</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='SEEK_CUR-constant'>
      SEEK_CUR
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>Set I/O position from the current position</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='SEEK_DATA-constant'>
      SEEK_DATA
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>Set I/O position to the next location containing data</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='SEEK_END-constant'>
      SEEK_END
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>Set I/O position from the end</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='SEEK_HOLE-constant'>
      SEEK_HOLE
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>Set I/O position to the next hole</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
    <dt id='SEEK_SET-constant'>
      SEEK_SET
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>Set I/O position from the beginning</p>


  </div>
</div>
<div class="tags">
  
</div>    </dd>
  </dl>



  
  
  <h3 class="inherited">Constants included
     from <a href="File/Constants.html" title="File::Constants (module)">File::Constants</a></h3>
  <p class="inherited"><a href="File/Constants.html#APPEND-constant" title="File::Constants::APPEND (constant)">File::Constants::APPEND</a>, <a href="File/Constants.html#BINARY-constant" title="File::Constants::BINARY (constant)">File::Constants::BINARY</a>, <a href="File/Constants.html#CREAT-constant" title="File::Constants::CREAT (constant)">File::Constants::CREAT</a>, <a href="File/Constants.html#DIRECT-constant" title="File::Constants::DIRECT (constant)">File::Constants::DIRECT</a>, <a href="File/Constants.html#DSYNC-constant" title="File::Constants::DSYNC (constant)">File::Constants::DSYNC</a>, <a href="File/Constants.html#EXCL-constant" title="File::Constants::EXCL (constant)">File::Constants::EXCL</a>, <a href="File/Constants.html#LOCK_EX-constant" title="File::Constants::LOCK_EX (constant)">File::Constants::LOCK_EX</a>, <a href="File/Constants.html#LOCK_NB-constant" title="File::Constants::LOCK_NB (constant)">File::Constants::LOCK_NB</a>, <a href="File/Constants.html#LOCK_SH-constant" title="File::Constants::LOCK_SH (constant)">File::Constants::LOCK_SH</a>, <a href="File/Constants.html#LOCK_UN-constant" title="File::Constants::LOCK_UN (constant)">File::Constants::LOCK_UN</a>, <a href="File/Constants.html#NOATIME-constant" title="File::Constants::NOATIME (constant)">File::Constants::NOATIME</a>, <a href="File/Constants.html#NOCTTY-constant" title="File::Constants::NOCTTY (constant)">File::Constants::NOCTTY</a>, <a href="File/Constants.html#NOFOLLOW-constant" title="File::Constants::NOFOLLOW (constant)">File::Constants::NOFOLLOW</a>, <a href="File/Constants.html#NONBLOCK-constant" title="File::Constants::NONBLOCK (constant)">File::Constants::NONBLOCK</a>, <a href="File/Constants.html#NULL-constant" title="File::Constants::NULL (constant)">File::Constants::NULL</a>, <a href="File/Constants.html#RDONLY-constant" title="File::Constants::RDONLY (constant)">File::Constants::RDONLY</a>, <a href="File/Constants.html#RDWR-constant" title="File::Constants::RDWR (constant)">File::Constants::RDWR</a>, <a href="File/Constants.html#RSYNC-constant" title="File::Constants::RSYNC (constant)">File::Constants::RSYNC</a>, <a href="File/Constants.html#SHARE_DELETE-constant" title="File::Constants::SHARE_DELETE (constant)">File::Constants::SHARE_DELETE</a>, <a href="File/Constants.html#SYNC-constant" title="File::Constants::SYNC (constant)">File::Constants::SYNC</a>, <a href="File/Constants.html#TMPFILE-constant" title="File::Constants::TMPFILE (constant)">File::Constants::TMPFILE</a>, <a href="File/Constants.html#TRUNC-constant" title="File::Constants::TRUNC (constant)">File::Constants::TRUNC</a>, <a href="File/Constants.html#WRONLY-constant" title="File::Constants::WRONLY (constant)">File::Constants::WRONLY</a></p>



<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#binread-class_method" title="binread (class method)">.<strong>binread</strong>(name, [length [, offset]])  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Opens the file, optionally seeks to the given <em>offset</em>, then returns
<em>length</em> bytes (defaulting to the rest of the file).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#binwrite-class_method" title="binwrite (class method)">.<strong>binwrite</strong>(name, string, [offset])  &#x21d2; Fixnum </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Same as <a href="#write-class_method" title="IO.write (method)">IO.write</a> except opening the file in binary mode and ASCII-8BIT
encoding (“wb:ASCII-8BIT”).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#copy_stream-class_method" title="copy_stream (class method)">.<strong>copy_stream</strong>(src, dst)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p><a href="#copy_stream-class_method" title="IO.copy_stream (method)">IO.copy_stream</a> copies <em>src</em> to <em>dst</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#for_fd-class_method" title="for_fd (class method)">.<strong>for_fd</strong>(fd, mode[, opt])  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Synonym for <a href="#new-class_method" title="IO.new (method)">IO.new</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#foreach-class_method" title="foreach (class method)">.<strong>foreach</strong>(name, sep = $/[, open_args]) {|line| ... } &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Executes the block for every line in the named I/O port, where lines are
separated by <em>sep</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(fd[, mode][, opt])  &#x21d2; IO </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a new IO object (a stream) for the given integer file descriptor
<code>fd</code> and <code>mode</code> string.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#open-class_method" title="open (class method)">.<strong>open</strong>(fd, mode = &quot;r&quot;[, opt])  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>With no associated block, <a href="#open-class_method" title="IO.open (method)">IO.open</a> is a synonym for <a href="#new-class_method" title="IO.new (method)">IO.new</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#pipe-class_method" title="pipe (class method)">.<strong>pipe</strong>  &#x21d2; Array, write_io </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a pair of pipe endpoints (connected to each other) and returns them
as a two-element array of <code>IO</code> objects: <code>[</code>
<em>read_io</em>, <em>write_io</em> <code>]</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#popen-class_method" title="popen (class method)">.<strong>popen</strong>([env,], mode = &quot;r&quot;[, opt])  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Runs the specified command as a subprocess; the subprocess&#39;s standard
input and output will be connected to the returned <code>IO</code> object.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#read-class_method" title="read (class method)">.<strong>read</strong>(name, [length [, offset]][, opt])  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Opens the file, optionally seeks to the given <code>offset</code>, then
returns <code>length</code> bytes (defaulting to the rest of the file).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#readlines-class_method" title="readlines (class method)">.<strong>readlines</strong>(name, sep = $/[, open_args])  &#x21d2; Array </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads the entire file specified by <em>name</em> as individual lines, and
returns those lines in an array.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#select-class_method" title="select (class method)">.<strong>select</strong>(read_array[, write_array [, error_array [, timeout]]])  &#x21d2; Array<sup>?</sup> </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Calls select(2) system call.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sysopen-class_method" title="sysopen (class method)">.<strong>sysopen</strong>(path, [mode, [perm]])  &#x21d2; Fixnum </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Opens the given path, returning the underlying file descriptor as a
<a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Object::Fixnum</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#try_convert-class_method" title="try_convert (class method)">.<strong>try_convert</strong>(obj)  &#x21d2; IO<sup>?</sup> </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Try to convert <em>obj</em> into an IO, using to_io method.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#write-class_method" title="write (class method)">.<strong>write</strong>(name, string, [offset])  &#x21d2; Fixnum </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Opens the file, optionally seeks to the given <em>offset</em>, writes
<em>string</em>, then returns the length written.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#%3C%3C-instance_method" title="#&lt;&lt; (instance method)">#<strong>&lt;&lt;</strong>(obj)  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>String Output—Writes <em>obj</em> to <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#advise-instance_method" title="#advise (instance method)">#<strong>advise</strong>(advice, offset = 0, len = 0)  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Announce an intention to access data from the current file in a specific
pattern.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#autoclose%3D-instance_method" title="#autoclose= (instance method)">#<strong>autoclose=</strong>(bool)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets auto-close flag.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#autoclose%3F-instance_method" title="#autoclose? (instance method)">#<strong>autoclose?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns <code>true</code> if the underlying file descriptor of <em>ios</em>
will be closed automatically at its finalization, otherwise
<code>false</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#binmode-instance_method" title="#binmode (instance method)">#<strong>binmode</strong>  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Puts <em>ios</em> into binary mode.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#binmode%3F-instance_method" title="#binmode? (instance method)">#<strong>binmode?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns <code>true</code> if <em>ios</em> is binmode.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#bytes-instance_method" title="#bytes (instance method)">#<strong>bytes</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>This is a deprecated alias for <code>each_byte</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#chars-instance_method" title="#chars (instance method)">#<strong>chars</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>This is a deprecated alias for <code>each_char</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Closes <em>ios</em> and flushes any pending writes to the operating system.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close_on_exec%3D-instance_method" title="#close_on_exec= (instance method)">#<strong>close_on_exec=</strong>(bool)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets a close-on-exec flag.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close_on_exec%3F-instance_method" title="#close_on_exec? (instance method)">#<strong>close_on_exec?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns <code>true</code> if <em>ios</em> will be closed on exec.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close_read-instance_method" title="#close_read (instance method)">#<strong>close_read</strong>  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Closes the read end of a duplex I/O stream (i.e., one that contains both a
read and a write stream, such as a pipe).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close_write-instance_method" title="#close_write (instance method)">#<strong>close_write</strong>  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Closes the write end of a duplex I/O stream (i.e., one that contains both a
read and a write stream, such as a pipe).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#closed%3F-instance_method" title="#closed? (instance method)">#<strong>closed?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns <code>true</code> if <em>ios</em> is completely closed (for duplex
streams, both reader and writer), <code>false</code> otherwise.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#codepoints-instance_method" title="#codepoints (instance method)">#<strong>codepoints</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>This is a deprecated alias for <code>each_codepoint</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong>(sep = $/) {|line| ... } &#x21d2; IO </a>
        (also: #each_line)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Executes the block for every line in <em>ios</em>, where lines are
separated by <em>sep</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#each_byte-instance_method" title="#each_byte (instance method)">#<strong>each_byte</strong> {|byte| ... } &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Calls the given block once for each byte (0..255) in <em>ios</em>, passing
the byte as an argument.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#each_char-instance_method" title="#each_char (instance method)">#<strong>each_char</strong> {|c| ... } &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Calls the given block once for each character in <em>ios</em>, passing the
character as an argument.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#each_codepoint-instance_method" title="#each_codepoint (instance method)">#<strong>each_codepoint</strong> {|c| ... } &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Passes the <a href="Integer.html" title="Integer (class)">Integer</a> ordinal of each character in <em>ios</em>, passing the
codepoint as an argument.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#each_line-instance_method" title="#each_line (instance method)">#<strong>each_line</strong>(sep = $/) {|line| ... } &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#each-instance_method" title="IO#each (method)">#each</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#eof-instance_method" title="#eof (instance method)">#<strong>eof</strong>  &#x21d2; Boolean </a>
        (also: #eof?)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if <em>ios</em> is at end of file that means there are no more
data to read.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#eof%3F-instance_method" title="#eof? (instance method)">#<strong>eof?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#eof-instance_method" title="IO#eof (method)">#eof</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#external_encoding-instance_method" title="#external_encoding (instance method)">#<strong>external_encoding</strong>  &#x21d2; Encoding </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the Encoding object that represents the encoding of the file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#fcntl-instance_method" title="#fcntl (instance method)">#<strong>fcntl</strong>(integer_cmd, arg)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Provides a mechanism for issuing low-level commands to control or query
file-oriented I/O streams.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#fdatasync-instance_method" title="#fdatasync (instance method)">#<strong>fdatasync</strong>  &#x21d2; 0<sup>?</sup> </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Immediately writes all buffered data in <em>ios</em> to disk.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#fileno-instance_method" title="#fileno (instance method)">#<strong>fileno</strong>  &#x21d2; Fixnum </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#to_i-instance_method" title="IO#to_i (method)">#to_i</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#flush-instance_method" title="#flush (instance method)">#<strong>flush</strong>  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Flushes any buffered data within <em>ios</em> to the underlying operating
system (note that this is Ruby internal buffering only; the OS may buffer
the data as well).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#fsync-instance_method" title="#fsync (instance method)">#<strong>fsync</strong>  &#x21d2; 0<sup>?</sup> </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Immediately writes all buffered data in <em>ios</em> to disk.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#getbyte-instance_method" title="#getbyte (instance method)">#<strong>getbyte</strong>  &#x21d2; Fixnum<sup>?</sup> </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Gets the next 8-bit byte (0..255) from <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#getc-instance_method" title="#getc (instance method)">#<strong>getc</strong>  &#x21d2; String<sup>?</sup> </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads a one-character string from <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#gets-instance_method" title="#gets (instance method)">#<strong>gets</strong>(sep = $/)  &#x21d2; String<sup>?</sup> </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads the next “line&#39;&#39; from the I/O stream; lines are separated by
<em>sep</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Return a string describing this IO object.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#internal_encoding-instance_method" title="#internal_encoding (instance method)">#<strong>internal_encoding</strong>  &#x21d2; Encoding </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the Encoding of the internal string if conversion is specified.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ioctl-instance_method" title="#ioctl (instance method)">#<strong>ioctl</strong>(integer_cmd, arg)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Provides a mechanism for issuing low-level commands to control or query I/O
devices.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#isatty-instance_method" title="#isatty (instance method)">#<strong>isatty</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#tty%3F-instance_method" title="IO#tty? (method)">#tty?</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#lineno-instance_method" title="#lineno (instance method)">#<strong>lineno</strong>  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current line number in <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#lineno%3D-instance_method" title="#lineno= (instance method)">#<strong>lineno=</strong>(integer)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Manually sets the current line number to the given value.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#lines-instance_method" title="#lines (instance method)">#<strong>lines</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>This is a deprecated alias for <code>each_line</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#pid-instance_method" title="#pid (instance method)">#<strong>pid</strong>  &#x21d2; Fixnum </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the process ID of a child process associated with <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#pos-instance_method" title="#pos (instance method)">#<strong>pos</strong>  &#x21d2; Integer </a>
        (also: #tell)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current offset (in bytes) of <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#pos%3D-instance_method" title="#pos= (instance method)">#<strong>pos=</strong>(integer)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Seeks to the given position (in bytes) in <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#print-instance_method" title="#print (instance method)">#<strong>print</strong>()  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Writes the given object(s) to <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#printf-instance_method" title="#printf (instance method)">#<strong>printf</strong>(format_string[, obj, ...])  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Formats and writes to <em>ios</em>, converting parameters under control of
the format string.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#putc-instance_method" title="#putc (instance method)">#<strong>putc</strong>(obj)  &#x21d2; Object </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>If <em>obj</em> is <a href="Numeric.html" title="Numeric (class)">Numeric</a>, write the character whose code is the
least-significant byte of <em>obj</em>, otherwise write the first byte of
the string representation of <em>obj</em> to <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#puts-instance_method" title="#puts (instance method)">#<strong>puts</strong>(obj, ...)  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Writes the given objects to <em>ios</em> as with <a href="#print-instance_method" title="IO#print (method)">#print</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#read-instance_method" title="#read (instance method)">#<strong>read</strong>([length [, outbuf]])  &#x21d2; String, ... </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads <em>length</em> bytes from the I/O stream.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#read_nonblock-instance_method" title="#read_nonblock (instance method)">#<strong>read_nonblock</strong>(maxlen[, options])  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads at most <em>maxlen</em> bytes from <em>ios</em> using the read(2)
system call after O_NONBLOCK is set for the underlying file descriptor.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#readbyte-instance_method" title="#readbyte (instance method)">#<strong>readbyte</strong>  &#x21d2; Fixnum </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads a byte as with <a href="#getbyte-instance_method" title="IO#getbyte (method)">#getbyte</a>, but raises an <a href="EOFError.html" title="EOFError (class)">EOFError</a> on end of file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#readchar-instance_method" title="#readchar (instance method)">#<strong>readchar</strong>  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads a one-character string from <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#readline-instance_method" title="#readline (instance method)">#<strong>readline</strong>(sep = $/)  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads a line as with <a href="#gets-instance_method" title="IO#gets (method)">#gets</a>, but raises an <a href="EOFError.html" title="EOFError (class)">EOFError</a> on end of file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#readlines-instance_method" title="#readlines (instance method)">#<strong>readlines</strong>(sep = $/)  &#x21d2; Array </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads all of the lines in <em>ios</em>, and returns them in
<em>anArray</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#readpartial-instance_method" title="#readpartial (instance method)">#<strong>readpartial</strong>(maxlen)  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads at most <em>maxlen</em> bytes from the I/O stream.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#reopen-instance_method" title="#reopen (instance method)">#<strong>reopen</strong>(other_IO)  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reassociates <em>ios</em> with the I/O stream given in <em>other_IO</em> or
to a new stream opened on <em>path</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rewind-instance_method" title="#rewind (instance method)">#<strong>rewind</strong>  &#x21d2; 0 </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Positions <em>ios</em> to the beginning of input, resetting
<code>lineno</code> to zero.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#seek-instance_method" title="#seek (instance method)">#<strong>seek</strong>(amount, whence = IO.SEEK_SET)  &#x21d2; 0 </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Seeks to a given offset <em>anInteger</em> in the stream according to the
value of <em>whence</em>:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#set_encoding-instance_method" title="#set_encoding (instance method)">#<strong>set_encoding</strong>(ext_enc)  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>If single argument is specified, read string from io is tagged with the
encoding specified.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#stat-instance_method" title="#stat (instance method)">#<strong>stat</strong>  &#x21d2; stat </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns status information for <em>ios</em> as an object of type
<a href="File/Stat.html" title="File::Stat (class)">File::Stat</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sync-instance_method" title="#sync (instance method)">#<strong>sync</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the current “sync mode&#39;&#39; of <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sync%3D-instance_method" title="#sync= (instance method)">#<strong>sync=</strong>(boolean)  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Sets the “sync mode&#39;&#39; to <code>true</code> or <code>false</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sysread-instance_method" title="#sysread (instance method)">#<strong>sysread</strong>(maxlen[, outbuf])  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads <em>maxlen</em> bytes from <em>ios</em> using a low-level read and
returns them as a string.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sysseek-instance_method" title="#sysseek (instance method)">#<strong>sysseek</strong>(offset, whence = IO.SEEK_SET)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Seeks to a given <em>offset</em> in the stream according to the value of
<em>whence</em> (see <a href="#seek-instance_method" title="IO#seek (method)">#seek</a> for values of <em>whence</em>).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#syswrite-instance_method" title="#syswrite (instance method)">#<strong>syswrite</strong>(string)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Writes the given string to <em>ios</em> using a low-level write.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#tell-instance_method" title="#tell (instance method)">#<strong>tell</strong>  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#pos-instance_method" title="IO#pos (method)">#pos</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_i-instance_method" title="#to_i (instance method)">#<strong>to_i</strong>  &#x21d2; Fixnum </a>
        (also: #fileno)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an integer representing the numeric file descriptor for
<em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_io-instance_method" title="#to_io (instance method)">#<strong>to_io</strong>  &#x21d2; IO </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#tty%3F-instance_method" title="#tty? (instance method)">#<strong>tty?</strong>  &#x21d2; Boolean </a>
        (also: #isatty)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns <code>true</code> if <em>ios</em> is associated with a terminal
device (tty), <code>false</code> otherwise.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ungetbyte-instance_method" title="#ungetbyte (instance method)">#<strong>ungetbyte</strong>(string)  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Pushes back bytes (passed as a parameter) onto <em>ios</em>, such that a
subsequent buffered read will return it.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ungetc-instance_method" title="#ungetc (instance method)">#<strong>ungetc</strong>(string)  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Pushes back one character (passed as a parameter) onto <em>ios</em>, such
that a subsequent buffered character read will return it.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#write-instance_method" title="#write (instance method)">#<strong>write</strong>(string)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Writes the given string to <em>ios</em>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#write_nonblock-instance_method" title="#write_nonblock (instance method)">#<strong>write_nonblock</strong>(string)  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Writes the given string to <em>ios</em> using the write(2) system call
after O_NONBLOCK is set for the underlying file descriptor.</p>
</div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Enumerable.html" title="Enumerable (module)">Enumerable</a></h3>
  <p class="inherited"><a href="Enumerable.html#all%3F-instance_method" title="Enumerable#all? (method)">#all?</a>, <a href="Enumerable.html#any%3F-instance_method" title="Enumerable#any? (method)">#any?</a>, <a href="Enumerable.html#chunk-instance_method" title="Enumerable#chunk (method)">#chunk</a>, <a href="Enumerable.html#chunk_while-instance_method" title="Enumerable#chunk_while (method)">#chunk_while</a>, <a href="Enumerable.html#count-instance_method" title="Enumerable#count (method)">#count</a>, <a href="Enumerable.html#cycle-instance_method" title="Enumerable#cycle (method)">#cycle</a>, <a href="Enumerable.html#drop-instance_method" title="Enumerable#drop (method)">#drop</a>, <a href="Enumerable.html#drop_while-instance_method" title="Enumerable#drop_while (method)">#drop_while</a>, <a href="Enumerable.html#each_cons-instance_method" title="Enumerable#each_cons (method)">#each_cons</a>, <a href="Enumerable.html#each_entry-instance_method" title="Enumerable#each_entry (method)">#each_entry</a>, <a href="Enumerable.html#each_slice-instance_method" title="Enumerable#each_slice (method)">#each_slice</a>, <a href="Enumerable.html#each_with_index-instance_method" title="Enumerable#each_with_index (method)">#each_with_index</a>, <a href="Enumerable.html#each_with_object-instance_method" title="Enumerable#each_with_object (method)">#each_with_object</a>, <a href="Enumerable.html#find-instance_method" title="Enumerable#find (method)">#find</a>, <a href="Enumerable.html#find_index-instance_method" title="Enumerable#find_index (method)">#find_index</a>, <a href="Enumerable.html#first-instance_method" title="Enumerable#first (method)">#first</a>, <a href="Enumerable.html#flat_map-instance_method" title="Enumerable#flat_map (method)">#flat_map</a>, <a href="Enumerable.html#grep-instance_method" title="Enumerable#grep (method)">#grep</a>, <a href="Enumerable.html#grep_v-instance_method" title="Enumerable#grep_v (method)">#grep_v</a>, <a href="Enumerable.html#group_by-instance_method" title="Enumerable#group_by (method)">#group_by</a>, <a href="Enumerable.html#inject-instance_method" title="Enumerable#inject (method)">#inject</a>, <a href="Enumerable.html#lazy-instance_method" title="Enumerable#lazy (method)">#lazy</a>, <a href="Enumerable.html#map-instance_method" title="Enumerable#map (method)">#map</a>, <a href="Enumerable.html#max-instance_method" title="Enumerable#max (method)">#max</a>, <a href="Enumerable.html#max_by-instance_method" title="Enumerable#max_by (method)">#max_by</a>, <a href="Enumerable.html#member%3F-instance_method" title="Enumerable#member? (method)">#member?</a>, <a href="Enumerable.html#min-instance_method" title="Enumerable#min (method)">#min</a>, <a href="Enumerable.html#min_by-instance_method" title="Enumerable#min_by (method)">#min_by</a>, <a href="Enumerable.html#minmax-instance_method" title="Enumerable#minmax (method)">#minmax</a>, <a href="Enumerable.html#minmax_by-instance_method" title="Enumerable#minmax_by (method)">#minmax_by</a>, <a href="Enumerable.html#none%3F-instance_method" title="Enumerable#none? (method)">#none?</a>, <a href="Enumerable.html#one%3F-instance_method" title="Enumerable#one? (method)">#one?</a>, <a href="Enumerable.html#partition-instance_method" title="Enumerable#partition (method)">#partition</a>, <a href="Enumerable.html#reject-instance_method" title="Enumerable#reject (method)">#reject</a>, <a href="Enumerable.html#reverse_each-instance_method" title="Enumerable#reverse_each (method)">#reverse_each</a>, <a href="Enumerable.html#select-instance_method" title="Enumerable#select (method)">#select</a>, <a href="Enumerable.html#slice_after-instance_method" title="Enumerable#slice_after (method)">#slice_after</a>, <a href="Enumerable.html#slice_before-instance_method" title="Enumerable#slice_before (method)">#slice_before</a>, <a href="Enumerable.html#slice_when-instance_method" title="Enumerable#slice_when (method)">#slice_when</a>, <a href="Enumerable.html#sort-instance_method" title="Enumerable#sort (method)">#sort</a>, <a href="Enumerable.html#sort_by-instance_method" title="Enumerable#sort_by (method)">#sort_by</a>, <a href="Enumerable.html#sum-instance_method" title="Enumerable#sum (method)">#sum</a>, <a href="Enumerable.html#take-instance_method" title="Enumerable#take (method)">#take</a>, <a href="Enumerable.html#take_while-instance_method" title="Enumerable#take_while (method)">#take_while</a>, <a href="Enumerable.html#to_a-instance_method" title="Enumerable#to_a (method)">#to_a</a>, <a href="Enumerable.html#to_h-instance_method" title="Enumerable#to_h (method)">#to_h</a>, <a href="Enumerable.html#uniq-instance_method" title="Enumerable#uniq (method)">#uniq</a>, <a href="Enumerable.html#zip-instance_method" title="Enumerable#zip (method)">#zip</a></p>

  
  
  
  
  
  <h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(fd[, mode][, opt])  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a new IO object (a stream) for the given integer file descriptor
<code>fd</code> and <code>mode</code> string.  <code>opt</code> may be used
to specify parts of <code>mode</code> in a more readable fashion.  See also
<a href="#sysopen-class_method" title="IO.sysopen (method)">sysopen</a> and <a href="#for_fd-class_method" title="IO.for_fd (method)">for_fd</a>.</p>

<p><a href="#new-class_method" title="IO.new (method)">new</a> is called by various File and IO opening methods such as
<a href="#open-class_method" title="IO.open (method)">open</a>, <a href="Kernel.html#open-class_method" title="Kernel.open (method)">Kernel.open</a>, and <a href="File.html#open-class_method" title="File.open (method)">File.open</a>.</p>

<h4 id="label-Open+Mode">Open Mode</h4>

<p>When <code>mode</code> is an integer it must be combination of the modes
defined in <a href="File/Constants.html" title="File::Constants (module)">File::Constants</a> (<code>File::RDONLY</code>, +File::WRONLY |
File::CREAT+).  See the open(2) man page for more information.</p>

<p>When <code>mode</code> is a string it must be in one of the following
forms:</p>

<pre class="code ruby"><code class="ruby">fmode
fmode &quot;:&quot; ext_enc
fmode &quot;:&quot; ext_enc &quot;:&quot; int_enc
fmode &quot;:&quot; &quot;BOM|UTF-*&quot;</code></pre>

<p><code>fmode</code> is an IO open mode string, <code>ext_enc</code> is the
external encoding for the IO and <code>int_enc</code> is the internal
encoding.</p>

<h5 id="label-IO+Open+Mode">IO Open Mode</h5>

<p>Ruby allows the following open modes:</p>

<pre class="code ruby"><code class="ruby">&quot;r&quot;  Read-only, starts at beginning of file  (default mode).

&quot;r+&quot; Read-write, starts at beginning of file.

&quot;w&quot;  Write-only, truncates existing file
     to zero length or creates a new file for writing.

&quot;w+&quot; Read-write, truncates existing file to zero length
     or creates a new file for reading and writing.

&quot;a&quot;  Write-only, each write call appends data at end of file.
     Creates a new file for writing if file does not exist.

&quot;a+&quot; Read-write, each write call appends data at end of file.
   Creates a new file for reading and writing if file does
   not exist.</code></pre>

<p>The following modes must be used separately, and along with one or more of
the modes seen above.</p>

<pre class="code ruby"><code class="ruby">&quot;b&quot;  Binary file mode
     Suppresses EOL &lt;-&gt; CRLF conversion on Windows. And
     sets external encoding to ASCII-8BIT unless explicitly
     specified.

&quot;t&quot;  Text file mode</code></pre>

<p>When the open mode of original IO is read only, the mode cannot be changed
to be writable.  Similarly, the open mode cannot be changed from write only
to readable.</p>

<p>When such a change is attempted the error is raised in different locations
according to the platform.</p>

<h4 id="label-IO+Encoding">IO Encoding</h4>

<p>When <code>ext_enc</code> is specified, strings read will be tagged by the
encoding when reading, and strings output will be converted to the
specified encoding when writing.</p>

<p>When <code>ext_enc</code> and <code>int_enc</code> are specified read
strings will be converted from <code>ext_enc</code> to <code>int_enc</code>
upon input, and written strings will be converted from <code>int_enc</code>
to <code>ext_enc</code> upon output.  See Encoding for further details of
transcoding on input and output.</p>

<p>If “BOM|UTF-8”, “BOM|UTF-16LE” or “BOM|UTF16-BE” are used, ruby checks for
a Unicode BOM in the input document to help determine the encoding.  For
UTF-16 encodings the file open mode must be binary.  When present, the BOM
is stripped and the external encoding from the BOM is used.  When the BOM
is missing the given Unicode encoding is used as <code>ext_enc</code>. 
(The BOM-set encoding option is case insensitive, so “bom|utf-8” is also
valid.)</p>

<h4 id="label-Options">Options</h4>

<p><code>opt</code> can be used instead of <code>mode</code> for improved
readability.  The following keys are supported:</p>
<dl class="rdoc-list note-list"><dt>:mode 
<dd>
<p>Same as <code>mode</code> parameter</p>
</dd><dt>:flags 
<dd>
<p>Specifies file open flags as integer. If <code>mode</code> parameter is
given, this parameter will be bitwise-ORed.</p>
</dd><dt>:external_encoding 
<dd>
<p>External encoding for the IO.  “-” is a synonym for the default external
encoding.</p>
</dd><dt>:internal_encoding 
<dd>
<p>Internal encoding for the IO.  “-” is a synonym for the default internal
encoding.</p>

<p>If the value is nil no conversion occurs.</p>
</dd><dt>:encoding 
<dd>
<p>Specifies external and internal encodings as “extern:intern”.</p>
</dd><dt>:textmode 
<dd>
<p>If the value is truth value, same as “t” in argument <code>mode</code>.</p>
</dd><dt>:binmode 
<dd>
<p>If the value is truth value, same as “b” in argument <code>mode</code>.</p>
</dd><dt>:autoclose 
<dd>
<p>If the value is <code>false</code>, the <code>fd</code> will be kept open
after this IO instance gets finalized.</p>
</dd></dl>

<p>Also, <code>opt</code> can have same keys in <a href="String.html#encode-instance_method" title="String#encode (method)">String#encode</a> for
controlling conversion between the external encoding and the internal
encoding.</p>

<h4 id="label-Example+1">Example 1</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_sysopen'><a href="#sysopen-class_method" title="IO.sysopen (method)">sysopen</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/dev/tty</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>w</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_fd'>fd</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>w</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='gvar'>$stderr</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>World</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Hello</span>
<span class='const'>World</span>
</code></pre>

<h4 id="label-Example+2">Example 2</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fcntl</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='const'><a href="top-level-namespace.html#STDERR-constant" title="STDERR (constant)">STDERR</a></span><span class='period'>.</span><span class='id identifier rubyid_fcntl'>fcntl</span><span class='lparen'>(</span><span class='const'>Fcntl</span><span class='op'>::</span><span class='const'>F_DUPFD</span><span class='rparen'>)</span>
<span class='id identifier rubyid_io'>io</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_fd'>fd</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w:UTF-16LE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>cr_newline:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, World!</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='const'><a href="top-level-namespace.html#STDERR-constant" title="STDERR (constant)">STDERR</a></span><span class='period'>.</span><span class='id identifier rubyid_fcntl'>fcntl</span><span class='lparen'>(</span><span class='const'>Fcntl</span><span class='op'>::</span><span class='const'>F_DUPFD</span><span class='rparen'>)</span>
<span class='id identifier rubyid_io'>io</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_fd'>fd</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>cr_newline:</span> <span class='kw'>true</span><span class='comma'>,</span>
            <span class='label'>external_encoding:</span> <span class='const'><a href="Encoding.html" title="Encoding (class)">Encoding</a></span><span class='op'>::</span><span class='const'>UTF_16LE</span><span class='rparen'>)</span>
<span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, World!</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>Both of above print “Hello, World!” in UTF-16LE to standard error output
with converting EOL generated by <code>puts</code> to CR.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L7724'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7724
7725
7726
7727
7728
7729
7730
7731
7732
7733
7734
7735
7736
7737
7738
7739
7740
7741
7742
7743
7744
7745
7746
7747
7748
7749
7750
7751
7752
7753
7754
7755
7756
7757
7758
7759
7760
7761
7762
7763
7764
7765
7766
7767
7768
7769
7770
7771
7772
7773
7774
7775
7776
7777
7778
7779
7780
7781</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 7724</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_initialize(int argc, VALUE *argv, VALUE io)
{
    VALUE fnum, vmode;
    rb_io_t *fp;
    int fd, fmode, oflags = O_RDONLY;
    convconfig_t convconfig;
    VALUE opt;
#if defined(HAVE_FCNTL) &amp;&amp; defined(F_GETFL)
    int ofmode;
#else
    struct stat st;
#endif


    argc = rb_scan_args(argc, argv, &quot;11:&quot;, &amp;fnum, &amp;vmode, &amp;opt);
    rb_io_extract_modeenc(&amp;vmode, 0, opt, &amp;oflags, &amp;fmode, &amp;convconfig);

    fd = NUM2INT(fnum);
    if (rb_reserved_fd_p(fd)) {
	rb_raise(rb_eArgError, &quot;The given fd is not accessible because RubyVM reserves it&quot;);
    }
#if defined(HAVE_FCNTL) &amp;&amp; defined(F_GETFL)
    oflags = fcntl(fd, F_GETFL);
    if (oflags == -1) rb_sys_fail(0);
#else
    if (fstat(fd, &amp;st) == -1) rb_sys_fail(0);
#endif
    rb_update_max_fd(fd);
#if defined(HAVE_FCNTL) &amp;&amp; defined(F_GETFL)
    ofmode = rb_io_oflags_fmode(oflags);
    if (NIL_P(vmode)) {
	fmode = ofmode;
    }
    else if ((~ofmode &amp; fmode) &amp; FMODE_READWRITE) {
	VALUE error = INT2FIX(EINVAL);
	rb_exc_raise(rb_class_new_instance(1, &amp;error, rb_eSystemCallError));
    }
#endif
    if (!NIL_P(opt) &amp;&amp; rb_hash_aref(opt, sym_autoclose) == Qfalse) {
	fmode |= FMODE_PREP;
    }
    MakeOpenFile(io, fp);
    fp-&gt;fd = fd;
    fp-&gt;mode = fmode;
    fp-&gt;encs = convconfig;
    clear_codeconv(fp);
    io_check_tty(fp);
    if (fileno(stdin) == fd)
	fp-&gt;stdio_file = stdin;
    else if (fileno(stdout) == fd)
	fp-&gt;stdio_file = stdout;
    else if (fileno(stderr) == fd)
	fp-&gt;stdio_file = stderr;

    if (fmode &amp; FMODE_SETENC_BY_BOM) io_set_encoding_by_bom(io);
    return io;
}
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="binread-class_method">
  <h3 class='signature first'>
  .<strong>binread</strong>(name, [length [, offset]])  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Opens the file, optionally seeks to the given <em>offset</em>, then returns
<em>length</em> bytes (defaulting to the rest of the file).
<code>binread</code> ensures the file is closed before returning. The open
mode would be “rb:ASCII-8BIT”.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_binread'>binread</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>           <span class='comment'>#=&gt; &quot;This is line one\nThis is line two\nThis is line three\nAnd so on...\n&quot;
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_binread'>binread</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>20</span><span class='rparen'>)</span>       <span class='comment'>#=&gt; &quot;This is line one\nThi&quot;
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_binread'>binread</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>20</span><span class='comma'>,</span> <span class='int'>10</span><span class='rparen'>)</span>   <span class='comment'>#=&gt; &quot;ne one\nThis is line &quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L9924'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9924
9925
9926
9927
9928
9929
9930
9931
9932
9933
9934
9935
9936
9937
9938
9939
9940
9941
9942
9943
9944
9945
9946
9947
9948
9949
9950
9951
9952
9953
9954
9955
9956
9957
9958</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 9924</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_binread(int argc, VALUE *argv, VALUE io)
{
    VALUE offset;
    struct foreach_arg arg;
    enum {
	fmode = FMODE_READABLE|FMODE_BINMODE,
	oflags = O_RDONLY
#ifdef O_BINARY
		|O_BINARY
#endif
    };
    convconfig_t convconfig = {NULL, NULL, 0, Qnil};

    rb_scan_args(argc, argv, &quot;12&quot;, NULL, NULL, &amp;offset);
    FilePathValue(argv[0]);
    convconfig.enc = rb_ascii8bit_encoding();
    arg.io = rb_io_open_generic(argv[0], oflags, fmode, &amp;convconfig, 0);
    if (NIL_P(arg.io)) return Qnil;
    arg.argv = argv+1;
    arg.argc = (argc &gt; 1) ? 1 : 0;
    if (!NIL_P(offset)) {
	struct seek_arg sarg;
	int state = 0;
	sarg.io = arg.io;
	sarg.offset = offset;
	sarg.mode = SEEK_SET;
	rb_protect(seek_before_access, (VALUE)&amp;sarg, &amp;state);
	if (state) {
	    rb_io_close(arg.io);
	    rb_jump_tag(state);
	}
    }
    return rb_ensure(io_s_read, (VALUE)&amp;arg, rb_io_close, arg.io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="binwrite-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>binwrite</strong>(name, string, [offset])  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
    <span class='overload'>.<strong>binwrite</strong>(name, string, [offset], open_args)  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Same as <a href="#write-class_method" title="IO.write (method)">write</a> except opening the file in binary mode and ASCII-8BIT
encoding (“wb:ASCII-8BIT”).</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L10069'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


10069
10070
10071
10072
10073</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 10069</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_binwrite(int argc, VALUE *argv, VALUE io)
{
    return io_s_write(argc, argv, 1);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="copy_stream-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>copy_stream</strong>(src, dst)  </span>
    <span class='overload'>.<strong>copy_stream</strong>(src, dst, copy_length)  </span>
    <span class='overload'>.<strong>copy_stream</strong>(src, dst, copy_length, src_offset)  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p><a href="#copy_stream-class_method" title="IO.copy_stream (method)">copy_stream</a> copies <em>src</em> to <em>dst</em>. <em>src</em> and
<em>dst</em> is either a filename or an IO.</p>

<p>This method returns the number of bytes copied.</p>

<p>If optional arguments are not given, the start position of the copy is the
beginning of the filename or the current file offset of the IO. The end
position of the copy is the end of file.</p>

<p>If <em>copy_length</em> is given, No more than <em>copy_length</em> bytes
are copied.</p>

<p>If <em>src_offset</em> is given, it specifies the start position of the
copy.</p>

<p>When <em>src_offset</em> is specified and <em>src</em> is an IO,
<a href="#copy_stream-class_method" title="IO.copy_stream (method)">copy_stream</a> doesn&#39;t move the current file offset.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L10769'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


10769
10770
10771
10772
10773
10774
10775
10776
10777
10778
10779
10780
10781
10782
10783
10784
10785
10786
10787
10788
10789
10790
10791
10792
10793
10794
10795
10796</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 10769</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_copy_stream(int argc, VALUE *argv, VALUE io)
{
    VALUE src, dst, length, src_offset;
    struct copy_stream_struct st;

    MEMZERO(&amp;st, struct copy_stream_struct, 1);

    rb_scan_args(argc, argv, &quot;22&quot;, &amp;src, &amp;dst, &amp;length, &amp;src_offset);

    st.src = src;
    st.dst = dst;

    if (NIL_P(length))
        st.copy_length = (off_t)-1;
    else
        st.copy_length = NUM2OFFT(length);

    if (NIL_P(src_offset))
        st.src_offset = (off_t)-1;
    else
        st.src_offset = NUM2OFFT(src_offset);

    rb_fd_init(&amp;st.fds);
    rb_ensure(copy_stream_body, (VALUE)&amp;st, copy_stream_finalize, (VALUE)&amp;st);

    return OFFT2NUM(st.total);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="for_fd-class_method">
  <h3 class='signature'>
  .<strong>for_fd</strong>(fd, mode[, opt])  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Synonym for <a href="#new-class_method" title="IO.new (method)">new</a>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L7745'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7745
7746
7747
7748
7749
7750
7751</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 7745</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_for_fd(int argc, VALUE *argv, VALUE klass)
{
    VALUE io = rb_obj_alloc(klass);
    rb_io_initialize(argc, argv, io);
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="foreach-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>foreach</strong>(name, sep = $/[, open_args]) {|line| ... } &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>.<strong>foreach</strong>(name, limit[, open_args]) {|line| ... } &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>.<strong>foreach</strong>(name, sep, limit[, open_args]) {|line| ... } &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>.<strong>foreach</strong>(...)  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Executes the block for every line in the named I/O port, where lines are
separated by <em>sep</em>.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_foreach'>foreach</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GOT </span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span> <span class='rbrace'>}</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">GOT This is line one
GOT This is line two
GOT This is line three
GOT And so on...</code></pre>

<p>If the last argument is a hash, it&#39;s the keyword argument to open. See
<a href="#read-class_method" title="IO.read (method)">read</a> for detail.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L9767'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9767
9768
9769
9770
9771
9772
9773
9774
9775
9776
9777
9778
9779
9780
9781
9782</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 9767</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_foreach(int argc, VALUE *argv, VALUE self)
{
    VALUE opt;
    int orig_argc = argc;
    struct foreach_arg arg;
    struct getline_arg garg;

    argc = rb_scan_args(argc, argv, &quot;13:&quot;, NULL, NULL, NULL, NULL, &amp;opt);
    RETURN_ENUMERATOR(self, orig_argc, argv);
    extract_getline_args(argc-1, argv+1, &amp;garg.rs, &amp;garg.limit);
    open_key_args(argc, argv, opt, &amp;arg);
    if (NIL_P(arg.io)) return Qnil;
    check_getline_args(&amp;garg.rs, &amp;garg.limit, garg.io = arg.io);
    return rb_ensure(io_s_foreach, (VALUE)&amp;garg, rb_io_close, arg.io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="open-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>open</strong>(fd, mode = &quot;r&quot;[, opt])  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>.<strong>open</strong>(fd, mode = &quot;r&quot;[, opt]) {|io| ... } &#x21d2; <tt><a href="Object.html" title="Object (class)">Object</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>With no associated block, <a href="#open-class_method" title="IO.open (method)">open</a> is a synonym for <a href="#new-class_method" title="IO.new (method)">new</a>.  If the
optional code block is given, it will be passed <code>io</code> as an
argument, and the IO object will automatically be closed when the block
terminates. In this instance, <a href="#open-class_method" title="IO.open (method)">open</a> returns the value of the block.</p>

<p>See <a href="#new-class_method" title="IO.new (method)">new</a> for a description of the <code>fd</code>, <code>mode</code>
and <code>opt</code> parameters.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L6419'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6419
6420
6421
6422
6423
6424
6425
6426
6427
6428
6429</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 6419</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_open(int argc, VALUE *argv, VALUE klass)
{
    VALUE io = rb_class_new_instance(argc, argv, klass);

    if (rb_block_given_p()) {
	return rb_ensure(rb_yield, io, io_close, io);
    }

    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="pipe-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>pipe</strong>  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt>, <tt>write_io</tt> </span>
    <span class='overload'>.<strong>pipe</strong>(ext_enc)  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt>, <tt>write_io</tt> </span>
    <span class='overload'>.<strong>pipe</strong>(&quot;ext_enc:int_enc&quot;[, opt])  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt>, <tt>write_io</tt> </span>
    <span class='overload'>.<strong>pipe</strong>(ext_enc, int_enc[, opt])  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt>, <tt>write_io</tt> </span>
    <span class='overload'>.<strong>pipe</strong>(...) {|read_io, write_io| ... } </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a pair of pipe endpoints (connected to each other) and returns them
as a two-element array of <code>IO</code> objects: <code>[</code>
<em>read_io</em>, <em>write_io</em> <code>]</code>.</p>

<p>If a block is given, the block is called and returns the value of the
block. <em>read_io</em> and <em>write_io</em> are sent to the block as
arguments. If read_io and write_io are not closed when the block exits,
they are closed. i.e. closing read_io and/or write_io doesn&#39;t cause an
error.</p>

<p>Not available on all platforms.</p>

<p>If an encoding (encoding name or encoding object) is specified as an
optional argument, read string from pipe is tagged with the encoding
specified. If the argument is a colon separated two encoding names “A:B”,
the read string is converted from encoding A (external encoding) to
encoding B (internal encoding), then tagged with B. If two optional
arguments are specified, those must be encoding objects or encoding names,
and the first one is the external encoding, and the second one is the
internal encoding. If the external encoding and the internal encoding is
specified, optional hash argument specify the conversion option.</p>

<p>In the example below, the two processes close the ends of the pipe that
they are not using. This is not just a cosmetic nicety. The read end of a
pipe will not generate an end of file condition if there are any writers
with the pipe still open. In the case of the parent process, the
<code>rd.read</code> will never return if it does not first issue a
<code>wr.close</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rd'>rd</span><span class='comma'>,</span> <span class='id identifier rubyid_wr'>wr</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'>pipe</span>

<span class='kw'>if</span> <span class='id identifier rubyid_fork'>fork</span>
  <span class='id identifier rubyid_wr'>wr</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Parent got: &lt;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rd'>rd</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_rd'>rd</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='const'><a href="Process.html" title="Process (module)">Process</a></span><span class='period'>.</span><span class='id identifier rubyid_wait'><a href="Process.html#wait-class_method" title="Process.wait (method)">wait</a></span>
<span class='kw'>else</span>
  <span class='id identifier rubyid_rd'>rd</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sending message to parent</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_wr'>wr</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hi Dad</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_wr'>wr</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">Sending message to parent
Parent got: &lt;Hi Dad&gt;</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L9606'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9606
9607
9608
9609
9610
9611
9612
9613
9614
9615
9616
9617
9618
9619
9620
9621
9622
9623
9624
9625
9626
9627
9628
9629
9630
9631
9632
9633
9634
9635
9636
9637
9638
9639
9640
9641
9642
9643
9644
9645
9646
9647
9648
9649
9650
9651
9652
9653
9654
9655
9656
9657
9658
9659
9660
9661
9662
9663
9664
9665
9666
9667
9668
9669
9670
9671
9672
9673
9674
9675
9676
9677
9678
9679
9680
9681
9682
9683</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 9606</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_pipe(int argc, VALUE *argv, VALUE klass)
{
    int pipes[2], state;
    VALUE r, w, args[3], v1, v2;
    VALUE opt;
    rb_io_t *fptr, *fptr2;
    struct io_encoding_set_args ies_args;
    int fmode = 0;
    VALUE ret;

    argc = rb_scan_args(argc, argv, &quot;02:&quot;, &amp;v1, &amp;v2, &amp;opt);
    if (rb_pipe(pipes) == -1)
        rb_sys_fail(0);

    args[0] = klass;
    args[1] = INT2NUM(pipes[0]);
    args[2] = INT2FIX(O_RDONLY);
    r = rb_protect(io_new_instance, (VALUE)args, &amp;state);
    if (state) {
	close(pipes[0]);
	close(pipes[1]);
	rb_jump_tag(state);
    }
    GetOpenFile(r, fptr);

    ies_args.fptr = fptr;
    ies_args.v1 = v1;
    ies_args.v2 = v2;
    ies_args.opt = opt;
    rb_protect(io_encoding_set_v, (VALUE)&amp;ies_args, &amp;state);
    if (state) {
	close(pipes[1]);
        io_close(r);
	rb_jump_tag(state);
    }

    args[1] = INT2NUM(pipes[1]);
    args[2] = INT2FIX(O_WRONLY);
    w = rb_protect(io_new_instance, (VALUE)args, &amp;state);
    if (state) {
	close(pipes[1]);
	if (!NIL_P(r)) rb_io_close(r);
	rb_jump_tag(state);
    }
    GetOpenFile(w, fptr2);
    rb_io_synchronized(fptr2);

    extract_binmode(opt, &amp;fmode);
#if DEFAULT_TEXTMODE
    if ((fptr-&gt;mode &amp; FMODE_TEXTMODE) &amp;&amp; (fmode &amp; FMODE_BINMODE)) {
	fptr-&gt;mode &amp;= ~FMODE_TEXTMODE;
	setmode(fptr-&gt;fd, O_BINARY);
    }
#if defined(RUBY_TEST_CRLF_ENVIRONMENT) || defined(_WIN32)
    if (fptr-&gt;encs.ecflags &amp; ECONV_DEFAULT_NEWLINE_DECORATOR) {
	fptr-&gt;encs.ecflags |= ECONV_UNIVERSAL_NEWLINE_DECORATOR;
    }
#endif
#endif
    fptr-&gt;mode |= fmode;
#if DEFAULT_TEXTMODE
    if ((fptr2-&gt;mode &amp; FMODE_TEXTMODE) &amp;&amp; (fmode &amp; FMODE_BINMODE)) {
	fptr2-&gt;mode &amp;= ~FMODE_TEXTMODE;
	setmode(fptr2-&gt;fd, O_BINARY);
    }
#endif
    fptr2-&gt;mode |= fmode;

    ret = rb_assoc_new(r, w);
    if (rb_block_given_p()) {
	VALUE rw[2];
	rw[0] = r;
	rw[1] = w;
	return rb_ensure(rb_yield, ret, pipe_pair_close, (VALUE)rw);
    }
    return ret;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="popen-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>popen</strong>([env,], mode = &quot;r&quot;[, opt])  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>.<strong>popen</strong>([env,], mode = &quot;r&quot;[, opt]) {|io| ... } &#x21d2; <tt><a href="Object.html" title="Object (class)">Object</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Runs the specified command as a subprocess; the subprocess&#39;s standard
input and output will be connected to the returned <code>IO</code> object.</p>

<p>The PID of the started process can be obtained by <a href="#pid-instance_method" title="IO#pid (method)">#pid</a> method.</p>

<p><em>cmd</em> is a string or an array as follows.</p>

<pre class="code ruby"><code class="ruby">cmd:
  &quot;-&quot;                                      : fork
  commandline                              : command line string which is passed to a shell
  [env, cmdname, arg1, ..., opts]          : command name and zero or more arguments (no shell)
  [env, [cmdname, argv0], arg1, ..., opts] : command name, argv[0] and zero or more arguments (no shell)
(env and opts are optional.)</code></pre>

<p>If <em>cmd</em> is a <a href="String.html" title="String (class)">String</a> “<code>-</code>&#39;&#39;, then a new
instance of Ruby is started as the subprocess.</p>

<p>If <em>cmd</em> is an <a href="Array.html" title="Array (class)">Array</a> of <a href="String.html" title="String (class)">String</a>, then it will be used as the
subprocess&#39;s <code>argv</code> bypassing a shell. The array can
contains a hash at first for environments and a hash at last for options
similar to <code>spawn</code>.</p>

<p>The default mode for the new file object is “r&#39;&#39;, but <em>mode</em>
may be set to any of the modes listed in the description for class IO. The
last argument <em>opt</em> qualifies <em>mode</em>.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># set IO encoding
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>nkf -e filename</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:external_encoding</span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EUC-JP</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_nkf_io'>nkf_io</span><span class='op'>|</span>
  <span class='id identifier rubyid_euc_jp_string'>euc_jp_string</span> <span class='op'>=</span> <span class='id identifier rubyid_nkf_io'>nkf_io</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
<span class='rbrace'>}</span>

<span class='comment'># merge standard output and standard error using
</span><span class='comment'># spawn option.  See the document of Kernel.spawn.
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ls</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:err</span><span class='op'>=&gt;</span><span class='lbracket'>[</span><span class='symbol'>:child</span><span class='comma'>,</span> <span class='symbol'>:out</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_ls_io'>ls_io</span><span class='op'>|</span>
  <span class='id identifier rubyid_ls_result_with_error'>ls_result_with_error</span> <span class='op'>=</span> <span class='id identifier rubyid_ls_io'>ls_io</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
<span class='rbrace'>}</span>

<span class='comment'># spawn options can be mixed with IO options
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ls</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:err</span><span class='op'>=&gt;</span><span class='lbracket'>[</span><span class='symbol'>:child</span><span class='comma'>,</span> <span class='symbol'>:out</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_ls_io'>ls_io</span><span class='op'>|</span>
  <span class='id identifier rubyid_ls_result_with_error'>ls_result_with_error</span> <span class='op'>=</span> <span class='id identifier rubyid_ls_io'>ls_io</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
<span class='rbrace'>}</span>
</code></pre>

<p>Raises exceptions which <a href="#pipe-class_method" title="IO.pipe (method)">pipe</a> and <a href="Kernel.html#spawn-class_method" title="Kernel.spawn (method)">Kernel.spawn</a> raise.</p>

<p>If a block is given, Ruby will run the command as a child connected to Ruby
with a pipe. Ruby&#39;s end of the pipe will be passed as a parameter to
the block. At the end of block, Ruby closes the pipe and sets
<code>$?</code>. In this case <a href="#popen-class_method" title="IO.popen (method)">popen</a> returns the value of the block.</p>

<p>If a block is given with a <em>cmd</em> of “<code>-</code>&#39;&#39;, the
block will be run in two separate processes: once in the parent, and once
in a child. The parent process will be passed the pipe object as a
parameter to the block, the child version of the block will be passed
<code>nil</code>, and the child&#39;s standard in and standard out will be
connected to the parent through the pipe. Not available on all platforms.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uname</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Parent is </span><span class='embexpr_beg'>#{</span><span class='const'><a href="Process.html" title="Process (module)">Process</a></span><span class='period'>.</span><span class='id identifier rubyid_pid'><a href="Process.html#pid-class_method" title="Process.pid (method)">pid</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>date</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span> <span class='rbrace'>}</span>
<span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><a href="Process.html" title="Process (module)">Process</a></span><span class='period'>.</span><span class='id identifier rubyid_pid'><a href="Process.html#pid-class_method" title="Process.pid (method)">pid</a></span><span class='embexpr_end'>}</span><span class='tstring_content'> is here, f is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
<span class='id identifier rubyid_p'>p</span> <span class='gvar'>$?</span>
<span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='qwords_beg'>%w&quot;</span><span class='tstring_content'>sed</span><span class='words_sep'> </span><span class='tstring_content'>-e</span><span class='words_sep'> </span><span class='tstring_content'>s|^|&lt;foo&gt;|</span><span class='words_sep'> </span><span class='tstring_content'>-e</span><span class='words_sep'> </span><span class='tstring_content'>s&amp;$&amp;;zot;&amp;</span><span class='words_sep'>&quot;</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r+</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_write'>close_write</span><span class='semicolon'>;</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>
<span class='rbrace'>}</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">[&quot;Linux\n&quot;]
Parent is 21346
Thu Jan 15 22:41:19 JST 2009
21346 is here, f is #&lt;IO:fd 3&gt;
21352 is here, f is nil
#&lt;Process::Status: pid 21352 exit 0&gt;
&lt;foo&gt;bar;zot;</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L6279'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6279
6280
6281
6282
6283
6284
6285
6286
6287
6288
6289
6290
6291
6292
6293
6294
6295
6296
6297
6298
6299
6300
6301
6302
6303
6304
6305
6306
6307
6308
6309
6310
6311
6312
6313
6314
6315
6316
6317
6318
6319
6320
6321
6322
6323
6324
6325
6326
6327
6328
6329
6330
6331
6332
6333
6334
6335
6336
6337
6338
6339
6340
6341
6342
6343
6344</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 6279</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_popen(int argc, VALUE *argv, VALUE klass)
{
    const char *modestr;
    VALUE pname, pmode = Qnil, port, tmp, opt = Qnil, env = Qnil, execarg_obj = Qnil;
    int oflags, fmode;
    convconfig_t convconfig;

    if (argc &gt; 1 &amp;&amp; !NIL_P(opt = rb_check_hash_type(argv[argc-1]))) --argc;
    if (argc &gt; 1 &amp;&amp; !NIL_P(env = rb_check_hash_type(argv[0]))) --argc, ++argv;
    switch (argc) {
      case 2:
	pmode = argv[1];
      case 1:
	pname = argv[0];
	break;
      default:
	{
	    int ex = !NIL_P(opt);
	    rb_error_arity(argc + ex, 1 + ex, 2 + ex);
	}
    }

    tmp = rb_check_array_type(pname);
    if (!NIL_P(tmp)) {
	long len = RARRAY_LEN(tmp);
#if SIZEOF_LONG &gt; SIZEOF_INT
	if (len &gt; INT_MAX) {
	    rb_raise(rb_eArgError, &quot;too many arguments&quot;);
	}
#endif
	execarg_obj = rb_execarg_new((int)len, RARRAY_CONST_PTR(tmp), FALSE);
	RB_GC_GUARD(tmp);
    }
    else {
	SafeStringValue(pname);
	execarg_obj = Qnil;
	if (!is_popen_fork(pname))
	    execarg_obj = rb_execarg_new(1, &amp;pname, TRUE);
    }
    if (!NIL_P(execarg_obj)) {
	if (!NIL_P(opt))
	    opt = rb_execarg_extract_options(execarg_obj, opt);
	if (!NIL_P(env))
	    rb_execarg_setenv(execarg_obj, env);
    }
    rb_io_extract_modeenc(&amp;pmode, 0, opt, &amp;oflags, &amp;fmode, &amp;convconfig);
    modestr = rb_io_oflags_modestr(oflags);

    port = pipe_open(execarg_obj, modestr, fmode, &amp;convconfig);
    if (NIL_P(port)) {
	/* child */
	if (rb_block_given_p()) {
	    rb_yield(Qnil);
            rb_io_flush(rb_stdout);
            rb_io_flush(rb_stderr);
	    _exit(0);
	}
	return Qnil;
    }
    RBASIC_SET_CLASS(port, klass);
    if (rb_block_given_p()) {
	return rb_ensure(rb_yield, port, pipe_close, port);
    }
    return port;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="read-class_method">
  <h3 class='signature'>
  .<strong>read</strong>(name, [length [, offset]][, opt])  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Opens the file, optionally seeks to the given <code>offset</code>, then
returns <code>length</code> bytes (defaulting to the rest of the file). 
<code>read</code> ensures the file is closed before returning.</p>

<p>If <code>name</code> starts with a pipe character
(<code>&quot;|&quot;</code>), a subprocess is created in the same way as
<a href="Kernel.html#open-class_method" title="Kernel.open (method)">Kernel.open</a>, and its output is returned.</p>

<h4 id="label-Options">Options</h4>

<p>The options hash accepts the following keys:</p>
<dl class="rdoc-list note-list"><dt>encoding
<dd>
<p>string or encoding</p>

<p>Specifies the encoding of the read string.  <code>encoding:</code> will be
ignored if <code>length</code> is specified.  See Encoding.aliases for
possible encodings.</p>
</dd><dt>mode
<dd>
<p>string</p>

<p>Specifies the mode argument for open().  It must start with an “r”
otherwise it will cause an error. See IO.new for the list of possible
modes.</p>
</dd><dt>open_args
<dd>
<p>array of strings</p>

<p>Specifies arguments for open() as an array.  This key can not be used in
combination with either <code>encoding:</code> or <code>mode:</code>.</p>
</dd></dl>

<p>Examples:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>              <span class='comment'>#=&gt; &quot;This is line one\nThis is line two\nThis is line three\nAnd so on...\n&quot;
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>20</span><span class='rparen'>)</span>          <span class='comment'>#=&gt; &quot;This is line one\nThi&quot;
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>20</span><span class='comma'>,</span> <span class='int'>10</span><span class='rparen'>)</span>      <span class='comment'>#=&gt; &quot;ne one\nThis is line &quot;
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>binfile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; &quot;\xF7\x00\x00\x0E\x12&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L9885'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9885
9886
9887
9888
9889
9890
9891
9892
9893
9894
9895
9896
9897
9898
9899
9900
9901
9902
9903
9904
9905
9906
9907
9908</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 9885</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_read(int argc, VALUE *argv, VALUE io)
{
    VALUE opt, offset;
    struct foreach_arg arg;

    argc = rb_scan_args(argc, argv, &quot;13:&quot;, NULL, NULL, &amp;offset, NULL, &amp;opt);
    open_key_args(argc, argv, opt, &amp;arg);
    if (NIL_P(arg.io)) return Qnil;
    if (!NIL_P(offset)) {
	struct seek_arg sarg;
	int state = 0;
	sarg.io = arg.io;
	sarg.offset = offset;
	sarg.mode = SEEK_SET;
	rb_protect(seek_before_access, (VALUE)&amp;sarg, &amp;state);
	if (state) {
	    rb_io_close(arg.io);
	    rb_jump_tag(state);
	}
	if (arg.argc == 2) arg.argc = 1;
    }
    return rb_ensure(io_s_read, (VALUE)&amp;arg, rb_io_close, arg.io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="readlines-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>readlines</strong>(name, sep = $/[, open_args])  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt> </span>
    <span class='overload'>.<strong>readlines</strong>(name, limit[, open_args])  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt> </span>
    <span class='overload'>.<strong>readlines</strong>(name, sep, limit[, open_args])  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads the entire file specified by <em>name</em> as individual lines, and
returns those lines in an array. Lines are separated by <em>sep</em>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span></code></pre>

<p>If the last argument is a hash, it&#39;s the keyword argument to open. See
<a href="#read-class_method" title="IO.read (method)">read</a> for detail.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L9808'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9808
9809
9810
9811
9812
9813
9814
9815
9816
9817
9818
9819
9820
9821</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 9808</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_readlines(int argc, VALUE *argv, VALUE io)
{
    VALUE opt;
    struct foreach_arg arg;
    struct getline_arg garg;

    argc = rb_scan_args(argc, argv, &quot;13:&quot;, NULL, NULL, NULL, NULL, &amp;opt);
    extract_getline_args(argc-1, argv+1, &amp;garg.rs, &amp;garg.limit);
    open_key_args(argc, argv, opt, &amp;arg);
    if (NIL_P(arg.io)) return Qnil;
    check_getline_args(&amp;garg.rs, &amp;garg.limit, garg.io = arg.io);
    return rb_ensure(io_s_readlines, (VALUE)&amp;garg, rb_io_close, arg.io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="select-class_method">
  <h3 class='signature'>
  .<strong>select</strong>(read_array[, write_array [, error_array [, timeout]]])  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Calls select(2) system call. It monitors given arrays of <code>IO</code>
objects, waits until one or more of <code>IO</code> objects are ready for
reading, are ready for writing, and have pending exceptions respectively,
and returns an array that contains arrays of those IO objects.  It will
return <code>nil</code> if optional <em>timeout</em> value is given and no
<code>IO</code> object is ready in <em>timeout</em> seconds.</p>

<p><a href="#select-class_method" title="IO.select (method)">select</a> peeks the buffer of <code>IO</code> objects for testing
readability. If the <code>IO</code> buffer is not empty, <a href="#select-class_method" title="IO.select (method)">select</a>
immediately notifies readability. This “peek” only happens for
<code>IO</code> objects. It does not happen for IO-like objects such as
<code>OpenSSL::SSL::SSLSocket</code>.</p>

<p>The best way to use <a href="#select-class_method" title="IO.select (method)">select</a> is invoking it after nonblocking methods
such as <code>read_nonblock</code>, <code>write_nonblock</code>, etc. The
methods raise an exception which is extended by <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a> or
<a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a>. The modules notify how the caller should wait with
<a href="#select-class_method" title="IO.select (method)">select</a>. If <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a> is raised, the caller should wait for
reading. If <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a> is raised, the caller should wait for
writing.</p>

<p>So, blocking read (<code>readpartial</code>) can be emulated using
<code>read_nonblock</code> and <a href="#select-class_method" title="IO.select (method)">select</a> as follows:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>begin</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_io_like'>io_like</span><span class='period'>.</span><span class='id identifier rubyid_read_nonblock'>read_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_maxlen'>maxlen</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a></span>
  <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_io_like'>io_like</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>rescue</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a></span>
  <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_io_like'>io_like</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>end</span>
</code></pre>

<p>Especially, the combination of nonblocking methods and <a href="#select-class_method" title="IO.select (method)">select</a> is
preferred for <code>IO</code> like objects such as
<code>OpenSSL::SSL::SSLSocket</code>. It has <code>to_io</code> method to
return underlying <code>IO</code> object. <a href="#select-class_method" title="IO.select (method)">select</a> calls
<code>to_io</code> to obtain the file descriptor to wait.</p>

<p>This means that readability notified by <a href="#select-class_method" title="IO.select (method)">select</a> doesn&#39;t mean
readability from <code>OpenSSL::SSL::SSLSocket</code> object.</p>

<p>The most likely situation is that <code>OpenSSL::SSL::SSLSocket</code>
buffers some data. <a href="#select-class_method" title="IO.select (method)">select</a> doesn&#39;t see the buffer. So <a href="#select-class_method" title="IO.select (method)">select</a>
can block when <code>OpenSSL::SSL::SSLSocket#readpartial</code> doesn&#39;t block.</p>

<p>However, several more complicated situations exist.</p>

<p>SSL is a protocol which is sequence of records. The record consists of
multiple bytes. So, the remote side of SSL sends a partial record,
<a href="#select-class_method" title="IO.select (method)">select</a> notifies readability but <code>OpenSSL::SSL::SSLSocket</code>
cannot decrypt a byte and <code>OpenSSL::SSL::SSLSocket#readpartial</code> will
blocks.</p>

<p>Also, the remote side can request SSL renegotiation which forces the local
SSL engine to write some data. This means
<code>OpenSSL::SSL::SSLSocket#readpartial</code> may invoke <code>write</code> system
call and it can block. In such a situation,
<code>OpenSSL::SSL::SSLSocket#read_nonblock</code> raises <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a> instead
of blocking. So, the caller should wait for ready for writability as above
example.</p>

<p>The combination of nonblocking methods and <a href="#select-class_method" title="IO.select (method)">select</a> is also useful for
streams such as tty, pipe socket socket when multiple processes read from a
stream.</p>

<p>Finally, Linux kernel developers don&#39;t guarantee that readability of
select(2) means readability of following read(2) even for a single process.
See select(2) manual on GNU/Linux system.</p>

<p>Invoking <a href="#select-class_method" title="IO.select (method)">select</a> before <a href="#readpartial-instance_method" title="IO#readpartial (method)">#readpartial</a> works well as usual. However
it is not the best way to use <a href="#select-class_method" title="IO.select (method)">select</a>.</p>

<p>The writability notified by select(2) doesn&#39;t show how many bytes
writable. <a href="#write-instance_method" title="IO#write (method)">#write</a> method blocks until given whole string is written. So,
<code>IO#write(two or more bytes)</code> can block after writability is
notified by <a href="#select-class_method" title="IO.select (method)">select</a>. <a href="#write_nonblock-instance_method" title="IO#write_nonblock (method)">#write_nonblock</a> is required to avoid the
blocking.</p>

<p>Blocking write (<code>write</code>) can be emulated using
<code>write_nonblock</code> and <a href="#select-class_method" title="IO.select (method)">select</a> as follows: <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a>
should also be rescued for SSL renegotiation in
<code>OpenSSL::SSL::SSLSocket</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>while</span> <span class='int'>0</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_bytesize'>bytesize</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_written'>written</span> <span class='op'>=</span> <span class='id identifier rubyid_io_like'>io_like</span><span class='period'>.</span><span class='id identifier rubyid_write_nonblock'>write_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a></span>
    <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_io_like'>io_like</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>retry</span>
  <span class='kw'>rescue</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a></span>
    <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_io_like'>io_like</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>retry</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_byteslice'>byteslice</span><span class='lparen'>(</span><span class='id identifier rubyid_written'>written</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</code></pre>

<h6 id="label-Parameters-3A">Parameters:</h6>
<dl class="rdoc-list note-list"><dt>read_array
<dd>
<p>an array of <code>IO</code> objects that wait until ready for read</p>
</dd><dt>write_array
<dd>
<p>an array of <code>IO</code> objects that wait until ready for write</p>
</dd><dt>error_array
<dd>
<p>an array of <code>IO</code> objects that wait for exceptions</p>
</dd><dt>timeout
<dd>
<p>a numeric value in second</p>
</dd></dl>

<h4 id="label-Example">Example</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rp'>rp</span><span class='comma'>,</span> <span class='id identifier rubyid_wp'>wp</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>
<span class='id identifier rubyid_mesg'>mesg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ping </span><span class='tstring_end'>&quot;</span></span>
<span class='int'>100</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='lbrace'>{</span>
  <span class='comment'># IO.select follows IO#read.  Not the best way to use IO.select.
</span>  <span class='id identifier rubyid_rs'>rs</span><span class='comma'>,</span> <span class='id identifier rubyid_ws'>ws</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_rp'>rp</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_wp'>wp</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_rs'>rs</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_ret'>ret</span> <span class='op'>=</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='int'>5</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_ret'>ret</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_ret'>ret</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ping</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_mesg'>mesg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pong\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>pong</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_mesg'>mesg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ping </span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='id identifier rubyid_ws'>ws</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_mesg'>mesg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='rbrace'>}</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ping'>ping</span> <span class='id identifier rubyid_pong'>pong</span>
<span class='id identifier rubyid_ping'>ping</span> <span class='id identifier rubyid_pong'>pong</span>
<span class='id identifier rubyid_ping'>ping</span> <span class='id identifier rubyid_pong'>pong</span>
<span class='lparen'>(</span><span class='id identifier rubyid_snipped'>snipped</span><span class='rparen'>)</span>
<span class='id identifier rubyid_ping'>ping</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L8882'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


8882
8883
8884
8885
8886
8887
8888
8889
8890
8891
8892
8893
8894
8895
8896
8897
8898
8899
8900
8901
8902
8903</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 8882</span></pre>
<pre class='code cpp'>

static VALUE
rb_f_select(int argc, VALUE *argv, VALUE obj)
{
    VALUE timeout;
    struct select_args args;
    struct timeval timerec;
    int i;

    rb_scan_args(argc, argv, &quot;13&quot;, &amp;args.read, &amp;args.write, &amp;args.except, &amp;timeout);
    if (NIL_P(timeout)) {
	args.timeout = 0;
    }
    else {
	timerec = rb_time_interval(timeout);
	args.timeout = &amp;timerec;
    }

    for (i = 0; i &lt; numberof(args.fdsets); ++i)
	rb_fd_init(&amp;args.fdsets[i]);

    return rb_ensure(select_call, (VALUE)&amp;args, select_end, (VALUE)&amp;args);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="sysopen-class_method">
  <h3 class='signature'>
  .<strong>sysopen</strong>(path, [mode, [perm]])  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Opens the given path, returning the underlying file descriptor as a
<a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Object::Fixnum</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_sysopen'>sysopen</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; 3
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L6441'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6441
6442
6443
6444
6445
6446
6447
6448
6449
6450
6451
6452
6453
6454
6455
6456
6457
6458
6459
6460
6461
6462
6463
6464
6465
6466</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 6441</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_sysopen(int argc, VALUE *argv)
{
    VALUE fname, vmode, vperm;
    VALUE intmode;
    int oflags, fd;
    mode_t perm;

    rb_scan_args(argc, argv, &quot;12&quot;, &amp;fname, &amp;vmode, &amp;vperm);
    FilePathValue(fname);

    if (NIL_P(vmode))
        oflags = O_RDONLY;
    else if (!NIL_P(intmode = rb_check_to_integer(vmode, &quot;to_int&quot;)))
        oflags = NUM2INT(intmode);
    else {
	SafeStringValue(vmode);
	oflags = rb_io_modestr_oflags(StringValueCStr(vmode));
    }
    if (NIL_P(vperm)) perm = 0666;
    else              perm = NUM2MODET(vperm);

    RB_GC_GUARD(fname) = rb_str_new4(fname);
    fd = rb_sysopen(fname, oflags, perm);
    return INT2NUM(fd);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="try_convert-class_method">
  <h3 class='signature'>
  .<strong>try_convert</strong>(obj)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Try to convert <em>obj</em> into an IO, using to_io method. Returns
converted IO or nil if <em>obj</em> cannot be converted for any reason.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_try_convert'>try_convert</span><span class='lparen'>(</span><span class='const'><a href="top-level-namespace.html#STDOUT-constant" title="STDOUT (constant)">STDOUT</a></span><span class='rparen'>)</span>     <span class='comment'>#=&gt; STDOUT
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_try_convert'>try_convert</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>STDOUT</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; nil
</span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>zlib</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/zz.gz</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>       <span class='comment'>#=&gt; #&lt;File:/tmp/zz.gz&gt;
</span><span class='id identifier rubyid_z'>z</span> <span class='op'>=</span> <span class='const'>Zlib</span><span class='op'>::</span><span class='const'>GzipReader</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span> <span class='comment'>#=&gt; #&lt;Zlib::GzipReader:0x81d8744&gt;
</span><span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_try_convert'>try_convert</span><span class='lparen'>(</span><span class='id identifier rubyid_z'>z</span><span class='rparen'>)</span>            <span class='comment'>#=&gt; #&lt;File:/tmp/zz.gz&gt;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L711'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


711
712
713
714
715</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 711</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_try_convert(VALUE dummy, VALUE io)
{
    return rb_io_check_io(io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="write-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>write</strong>(name, string, [offset])  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
    <span class='overload'>.<strong>write</strong>(name, string, [offset], open_args)  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Opens the file, optionally seeks to the given <em>offset</em>, writes
<em>string</em>, then returns the length written. <code>write</code>
ensures the file is closed before returning. If <em>offset</em> is not
given, the file is truncated.  Otherwise, it is not truncated.</p>

<p>If the last argument is a hash, it specifies option for internal open(). 
The key would be the following.  open_args: is exclusive to others.</p>

<pre class="code ruby"><code class="ruby">encoding: string or encoding

 specifies encoding of the read string.  encoding will be ignored
 if length is specified.

mode: string

 specifies mode argument for open().  it should start with &quot;w&quot; or &quot;a&quot; or &quot;r+&quot;
 otherwise it would cause error.

perm: fixnum

 specifies perm argument for open().

open_args: array

 specifies arguments for open() as an array.

  IO.write(&quot;testfile&quot;, &quot;0123456789&quot;, 20) # =&gt; 10
  # File could contain:  &quot;This is line one\nThi0123456789two\nThis is line three\nAnd so on...\n&quot;
  IO.write(&quot;testfile&quot;, &quot;0123456789&quot;)      #=&gt; 10
  # File would now read: &quot;0123456789&quot;</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L10053'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


10053
10054
10055
10056
10057</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 10053</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_s_write(int argc, VALUE *argv, VALUE io)
{
    return io_s_write(argc, argv, 0);
}
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="<<-instance_method">
  <h3 class='signature first'>
  #<strong>&lt;&lt;</strong>(obj)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>String Output—Writes <em>obj</em> to <em>ios</em>. <em>obj</em> will be
converted to a string using <code>to_s</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$stdout</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello </span><span class='tstring_end'>&quot;</span></span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>world!\n</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby"><span class='const'>Hello</span> <span class='id identifier rubyid_world!'>world!</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1523'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1523
1524
1525
1526
1527
1528</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1523</span></pre>
<pre class='code cpp'>

VALUE
rb_io_addstr(VALUE io, VALUE str)
{
    rb_io_write(io, str);
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="advise-instance_method">
  <h3 class='signature'>
  #<strong>advise</strong>(advice, offset = 0, len = 0)  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Announce an intention to access data from the current file in a specific
pattern. On platforms that do not support the <em>posix_fadvise(2)</em>
system call, this method is a no-op.</p>

<p><em>advice</em> is one of the following symbols:</p>
<dl class="rdoc-list note-list"><dt>:normal
<dd>
<p>No advice to give; the default assumption for an open file.</p>
</dd><dt>:sequential
<dd>
<p>The data will be accessed sequentially with lower offsets read before
higher ones.</p>
</dd><dt>:random
<dd>
<p>The data will be accessed in random order.</p>
</dd><dt>:willneed
<dd>
<p>The data will be accessed in the near future.</p>
</dd><dt>:dontneed
<dd>
<p>The data will not be accessed in the near future.</p>
</dd><dt>:noreuse
<dd>
<p>The data will only be accessed once.</p>
</dd></dl>

<p>The semantics of a piece of advice are platform-dependent. See <em>man 2
posix_fadvise</em> for details.</p>

<p>“data” means the region of the current file that begins at <em>offset</em>
and extends for <em>len</em> bytes. If <em>len</em> is 0, the region ends
at the last byte of the file. By default, both <em>offset</em> and
<em>len</em> are 0, meaning that the advice applies to the entire file.</p>

<p>If an error occurs, one of the following exceptions will be raised:</p>
<dl class="rdoc-list note-list"><dt><a href="IOError.html" title="IOError (class)">IOError</a>
<dd>
<p>The <code>IO</code> stream is closed.</p>
</dd><dt><code>Errno::EBADF</code>
<dd>
<p>The file descriptor of the current file is invalid.</p>
</dd><dt><code>Errno::EINVAL</code>
<dd>
<p>An invalid value for <em>advice</em> was given.</p>
</dd><dt><code>Errno::ESPIPE</code>
<dd>
<p>The file descriptor of the current file refers to a FIFO or pipe. (Linux
raises <code>Errno::EINVAL</code> in this case).</p>
</dd><dt><a href="TypeError.html" title="TypeError (class)">TypeError</a>
<dd>
<p>Either <em>advice</em> was not a Symbol, or one of the other arguments was
not an <code>Integer</code>.</p>
</dd><dt><a href="RangeError.html" title="RangeError (class)">RangeError</a>
<dd>
<p>One of the arguments given was too big/small.</p>
</dd><dt>This list is not exhaustive; other Errno
<dd>
<p>exceptions are also possible.</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L8717'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


8717
8718
8719
8720
8721
8722
8723
8724
8725
8726
8727
8728
8729
8730
8731
8732
8733
8734
8735
8736
8737
8738
8739</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 8717</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_advise(int argc, VALUE *argv, VALUE io)
{
    VALUE advice, offset, len;
    off_t off, l;
    rb_io_t *fptr;

    rb_scan_args(argc, argv, &quot;12&quot;, &amp;advice, &amp;offset, &amp;len);
    advice_arg_check(advice);

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);

    off = NIL_P(offset) ? 0 : NUM2OFFT(offset);
    l   = NIL_P(len)    ? 0 : NUM2OFFT(len);

#ifdef HAVE_POSIX_FADVISE
    return do_io_advise(fptr, advice, off, l);
#else
    ((void)off, (void)l);	/* Ignore all hint */
    return Qnil;
#endif
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="autoclose=-instance_method">
  <h3 class='signature'>
  #<strong>autoclose=</strong>(bool)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets auto-close flag.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/dev/null</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_for_fd'><a href="#for_fd-class_method" title="IO.for_fd (method)">for_fd</a></span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_fileno'>fileno</span><span class='rparen'>)</span>
<span class='comment'># ...
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span> <span class='comment'># may cause IOError
</span>
<span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/dev/null</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_for_fd'><a href="#for_fd-class_method" title="IO.for_fd (method)">for_fd</a></span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_fileno'>fileno</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_autoclose'>autoclose</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='comment'># ...
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span> <span class='comment'># won&#39;t cause IOError
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L7786'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7786
7787
7788
7789
7790
7791
7792
7793
7794
7795
7796</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 7786</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_set_autoclose(VALUE io, VALUE autoclose)
{
    rb_io_t *fptr;
    GetOpenFile(io, fptr);
    if (!RTEST(autoclose))
	fptr-&gt;mode |= FMODE_PREP;
    else
	fptr-&gt;mode &amp;= ~FMODE_PREP;
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="autoclose?-instance_method">
  <h3 class='signature'>
  #<strong>autoclose?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns <code>true</code> if the underlying file descriptor of <em>ios</em>
will be closed automatically at its finalization, otherwise
<code>false</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L7761'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7761
7762
7763
7764
7765
7766
7767</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 7761</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_autoclose_p(VALUE io)
{
    rb_io_t *fptr = RFILE(io)-&gt;fptr;
    rb_io_check_closed(fptr);
    return (fptr-&gt;mode &amp; FMODE_PREP) ? Qfalse : Qtrue;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="binmode-instance_method">
  <h3 class='signature'>
  #<strong>binmode</strong>  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Puts <em>ios</em> into binary mode. Once a stream is in binary mode, it
cannot be reset to nonbinary mode.</p>
<ul><li>
<p>newline conversion disabled</p>
</li><li>
<p>encoding conversion disabled</p>
</li><li>
<p>content is treated as ASCII-8BIT</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4846'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4846
4847
4848
4849
4850
4851
4852
4853
4854
4855
4856
4857</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4846</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_binmode_m(VALUE io)
{
    VALUE write_io;

    rb_io_ascii8bit_binmode(io);

    write_io = GetWriteIO(io);
    if (write_io != io)
        rb_io_ascii8bit_binmode(write_io);
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="binmode?-instance_method">
  <h3 class='signature'>
  #<strong>binmode?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns <code>true</code> if <em>ios</em> is binmode.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4865'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4865
4866
4867
4868
4869
4870
4871</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4865</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_binmode_p(VALUE io)
{
    rb_io_t *fptr;
    GetOpenFile(io, fptr);
    return fptr-&gt;mode &amp; FMODE_BINMODE ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="bytes-instance_method">
  <h3 class='signature'>
  #<strong>bytes</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>This is a deprecated alias for <code>each_byte</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3494'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3494
3495
3496
3497
3498
3499
3500
3501</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3494</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_bytes(VALUE io)
{
    rb_warn(&quot;IO#bytes is deprecated; use #each_byte instead&quot;);
    if (!rb_block_given_p())
	return rb_enumeratorize(io, ID2SYM(rb_intern(&quot;each_byte&quot;)), 0, 0);
    return rb_io_each_byte(io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="chars-instance_method">
  <h3 class='signature'>
  #<strong>chars</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>This is a deprecated alias for <code>each_char</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3648'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3648
3649
3650
3651
3652
3653
3654
3655</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3648</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_chars(VALUE io)
{
    rb_warn(&quot;IO#chars is deprecated; use #each_char instead&quot;);
    if (!rb_block_given_p())
	return rb_enumeratorize(io, ID2SYM(rb_intern(&quot;each_char&quot;)), 0, 0);
    return rb_io_each_char(io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close-instance_method">
  <h3 class='signature'>
  #<strong>close</strong>  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Closes <em>ios</em> and flushes any pending writes to the operating system.
The stream is unavailable for any further data operations; an <a href="IOError.html" title="IOError (class)">IOError</a> is
raised if such an attempt is made. I/O streams are automatically closed
when they are claimed by the garbage collector.</p>

<p>If <em>ios</em> is opened by <a href="#popen-class_method" title="IO.popen (method)">popen</a>, <code>close</code> sets
<code>$?</code>.</p>

<p>Calling this method on closed IO object is just ignored since Ruby 2.3.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4436'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4436
4437
4438
4439
4440
4441
4442
4443
4444
4445</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4436</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_close_m(VALUE io)
{
    rb_io_t *fptr = rb_io_get_fptr(io);
    if (fptr-&gt;fd &lt; 0) {
        return Qnil;
    }
    rb_io_close(io);
    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close_on_exec=-instance_method">
  <h3 class='signature'>
  #<strong>close_on_exec=</strong>(bool)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets a close-on-exec flag.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/dev/null</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_on_exec'>close_on_exec</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cat</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/proc/self/fd/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_fileno'>fileno</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'># cat: /proc/self/fd/3: No such file or directory
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_closed?'>closed?</span>                <span class='comment'>#=&gt; false
</span></code></pre>

<p>Ruby sets close-on-exec flags of all file descriptors by default since Ruby
2.0.0. So you don&#39;t need to set by yourself. Also, unsetting a
close-on-exec flag can cause file descriptor leak if another thread use
fork() and exec() (via system() method for example). If you really needs
file descriptor inheritance to child process, use spawn()&#39;s argument
such as fd=&gt;fd.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4074'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4074
4075
4076
4077
4078
4079
4080
4081
4082
4083
4084
4085
4086
4087
4088
4089
4090
4091
4092
4093
4094
4095
4096
4097
4098
4099
4100
4101
4102
4103
4104
4105
4106</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4074</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_set_close_on_exec(VALUE io, VALUE arg)
{
    int flag = RTEST(arg) ? FD_CLOEXEC : 0;
    rb_io_t *fptr;
    VALUE write_io;
    int fd, ret;

    write_io = GetWriteIO(io);
    if (io != write_io) {
        GetOpenFile(write_io, fptr);
        if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
            if ((ret = fcntl(fptr-&gt;fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
            if ((ret &amp; FD_CLOEXEC) != flag) {
                ret = (ret &amp; ~FD_CLOEXEC) | flag;
                ret = fcntl(fd, F_SETFD, ret);
                if (ret == -1) rb_sys_fail_path(fptr-&gt;pathv);
            }
        }

    }

    GetOpenFile(io, fptr);
    if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
        if ((ret = fcntl(fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
        if ((ret &amp; FD_CLOEXEC) != flag) {
            ret = (ret &amp; ~FD_CLOEXEC) | flag;
            ret = fcntl(fd, F_SETFD, ret);
            if (ret == -1) rb_sys_fail_path(fptr-&gt;pathv);
        }
    }
    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close_on_exec?-instance_method">
  <h3 class='signature'>
  #<strong>close_on_exec?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns <code>true</code> if <em>ios</em> will be closed on exec.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/dev/null</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_on_exec?'>close_on_exec?</span>                 <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_on_exec'>close_on_exec</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_on_exec?'>close_on_exec?</span>                 <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_on_exec'>close_on_exec</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_on_exec?'>close_on_exec?</span>                 <span class='comment'>#=&gt; false
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4026'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4026
4027
4028
4029
4030
4031
4032
4033
4034
4035
4036
4037
4038
4039
4040
4041
4042
4043
4044
4045
4046
4047
4048</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4026</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_close_on_exec_p(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;
    int fd, ret;

    write_io = GetWriteIO(io);
    if (io != write_io) {
        GetOpenFile(write_io, fptr);
        if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
            if ((ret = fcntl(fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
            if (!(ret &amp; FD_CLOEXEC)) return Qfalse;
        }
    }

    GetOpenFile(io, fptr);
    if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
        if ((ret = fcntl(fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
        if (!(ret &amp; FD_CLOEXEC)) return Qfalse;
    }
    return Qtrue;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close_read-instance_method">
  <h3 class='signature'>
  #<strong>close_read</strong>  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Closes the read end of a duplex I/O stream (i.e., one that contains both a
read and a write stream, such as a pipe). Will raise an <a href="IOError.html" title="IOError (class)">IOError</a> if the
stream is not duplexed.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'><a href="#popen-class_method" title="IO.popen (method)">popen</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/bin/sh</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r+</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_read'>close_read</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">prog.rb:3:in `readlines&#39;: not opened for reading (IOError)
    from prog.rb:3</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4533'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4533
4534
4535
4536
4537
4538
4539
4540
4541
4542
4543
4544
4545
4546
4547
4548
4549
4550
4551
4552
4553
4554
4555
4556
4557
4558
4559
4560
4561
4562
4563
4564
4565
4566
4567
4568
4569
4570
4571
4572</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4533</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_close_read(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;

    fptr = rb_io_get_fptr(rb_io_taint_check(io));
    if (fptr-&gt;fd &lt; 0) return Qnil;
    if (is_socket(fptr-&gt;fd, fptr-&gt;pathv)) {
#ifndef SHUT_RD
# define SHUT_RD 0
#endif
        if (shutdown(fptr-&gt;fd, SHUT_RD) &lt; 0)
            rb_sys_fail_path(fptr-&gt;pathv);
        fptr-&gt;mode &amp;= ~FMODE_READABLE;
        if (!(fptr-&gt;mode &amp; FMODE_WRITABLE))
            return rb_io_close(io);
        return Qnil;
    }

    write_io = GetWriteIO(io);
    if (io != write_io) {
	rb_io_t *wfptr;
	wfptr = rb_io_get_fptr(rb_io_taint_check(write_io));
	wfptr-&gt;pid = fptr-&gt;pid;
	fptr-&gt;pid = 0;
        RFILE(io)-&gt;fptr = wfptr;
	/* bind to write_io temporarily to get rid of memory/fd leak */
	fptr-&gt;tied_io_for_writing = 0;
	RFILE(write_io)-&gt;fptr = fptr;
	rb_io_fptr_cleanup(fptr, FALSE);
	/* should not finalize fptr because another thread may be reading it */
        return Qnil;
    }

    if ((fptr-&gt;mode &amp; (FMODE_DUPLEX|FMODE_WRITABLE)) == FMODE_WRITABLE) {
	rb_raise(rb_eIOError, &quot;closing non-duplex IO for reading&quot;);
    }
    return rb_io_close(io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close_write-instance_method">
  <h3 class='signature'>
  #<strong>close_write</strong>  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Closes the write end of a duplex I/O stream (i.e., one that contains both a
read and a write stream, such as a pipe). Will raise an <a href="IOError.html" title="IOError (class)">IOError</a> if the
stream is not duplexed.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'><a href="#popen-class_method" title="IO.popen (method)">popen</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/bin/sh</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r+</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_write'>close_write</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>nowhere</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">prog.rb:3:in `write&#39;: not opened for writing (IOError)
    from prog.rb:3:in `print&#39;
    from prog.rb:3</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4593'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4593
4594
4595
4596
4597
4598
4599
4600
4601
4602
4603
4604
4605
4606
4607
4608
4609
4610
4611
4612
4613
4614
4615
4616
4617
4618
4619
4620
4621
4622
4623
4624</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4593</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_close_write(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;

    write_io = GetWriteIO(io);
    fptr = rb_io_get_fptr(rb_io_taint_check(write_io));
    if (fptr-&gt;fd &lt; 0) return Qnil;
    if (is_socket(fptr-&gt;fd, fptr-&gt;pathv)) {
#ifndef SHUT_WR
# define SHUT_WR 1
#endif
        if (shutdown(fptr-&gt;fd, SHUT_WR) &lt; 0)
            rb_sys_fail_path(fptr-&gt;pathv);
        fptr-&gt;mode &amp;= ~FMODE_WRITABLE;
        if (!(fptr-&gt;mode &amp; FMODE_READABLE))
	    return rb_io_close(write_io);
        return Qnil;
    }

    if ((fptr-&gt;mode &amp; (FMODE_DUPLEX|FMODE_READABLE)) == FMODE_READABLE) {
	rb_raise(rb_eIOError, &quot;closing non-duplex IO for writing&quot;);
    }

    if (io != write_io) {
	fptr = rb_io_get_fptr(rb_io_taint_check(io));
	fptr-&gt;tied_io_for_writing = 0;
    }
    rb_io_close(write_io);
    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="closed?-instance_method">
  <h3 class='signature'>
  #<strong>closed?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns <code>true</code> if <em>ios</em> is completely closed (for duplex
streams, both reader and writer), <code>false</code> otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>         <span class='comment'>#=&gt; nil
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_closed?'>closed?</span>       <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'><a href="#popen-class_method" title="IO.popen (method)">popen</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/bin/sh</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r+</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_write'>close_write</span>   <span class='comment'>#=&gt; nil
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_closed?'>closed?</span>       <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close_read'>close_read</span>    <span class='comment'>#=&gt; nil
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_closed?'>closed?</span>       <span class='comment'>#=&gt; true
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4496'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4496
4497
4498
4499
4500
4501
4502
4503
4504
4505
4506
4507
4508
4509
4510
4511
4512
4513</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4496</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_closed(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;
    rb_io_t *write_fptr;

    write_io = GetWriteIO(io);
    if (io != write_io) {
        write_fptr = RFILE(write_io)-&gt;fptr;
        if (write_fptr &amp;&amp; 0 &lt;= write_fptr-&gt;fd) {
            return Qfalse;
        }
    }

    fptr = rb_io_get_fptr(io);
    return 0 &lt;= fptr-&gt;fd ? Qfalse : Qtrue;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="codepoints-instance_method">
  <h3 class='signature'>
  #<strong>codepoints</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>This is a deprecated alias for <code>each_codepoint</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3776'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3776
3777
3778
3779
3780
3781
3782
3783</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3776</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_codepoints(VALUE io)
{
    rb_warn(&quot;IO#codepoints is deprecated; use #each_codepoint instead&quot;);
    if (!rb_block_given_p())
	return rb_enumeratorize(io, ID2SYM(rb_intern(&quot;each_codepoint&quot;)), 0, 0);
    return rb_io_each_codepoint(io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="each-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>each</strong>(sep = $/) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each</strong>(limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each</strong>(sep, limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each</strong>(...)  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(sep = $/) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(sep, limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(...)  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
  <span class='aliases'>Also known as: <span class='names'><span>each_line</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Executes the block for every line in <em>ios</em>, where lines are
separated by <em>sep</em>. <em>ios</em> must be opened for reading or an
<a href="IOError.html" title="IOError (class)">IOError</a> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_lineno'>lineno</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line'>line</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">1: This is line one
2: This is line two
3: This is line three
4: And so on...</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3423'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3423
3424
3425
3426
3427
3428
3429
3430
3431
3432
3433
3434
3435
3436
3437</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3423</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_each_line(int argc, VALUE *argv, VALUE io)
{
    VALUE str, rs;
    long limit;

    RETURN_ENUMERATOR(io, argc, argv);
    prepare_getline_args(argc, argv, &amp;rs, &amp;limit, io);
    if (limit == 0)
	rb_raise(rb_eArgError, &quot;invalid limit: 0 for each_line&quot;);
    while (!NIL_P(str = rb_io_getline_1(rs, limit, io))) {
	rb_yield(str);
    }
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="each_byte-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>each_byte</strong> {|byte| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_byte</strong>  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Calls the given block once for each byte (0..255) in <em>ios</em>, passing
the byte as an argument. The stream must be opened for reading or an
<a href="IOError.html" title="IOError (class)">IOError</a> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_checksum'>checksum</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_each_byte'>each_byte</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_checksum'>checksum</span> <span class='op'>^=</span> <span class='id identifier rubyid_x'>x</span> <span class='rbrace'>}</span>   <span class='comment'>#=&gt; #&lt;File:testfile&gt;
</span><span class='id identifier rubyid_checksum'>checksum</span>                           <span class='comment'>#=&gt; 12
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3469'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3469
3470
3471
3472
3473
3474
3475
3476
3477
3478
3479
3480
3481
3482
3483
3484
3485
3486
3487
3488</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3469</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_each_byte(VALUE io)
{
    rb_io_t *fptr;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);

    do {
	while (fptr-&gt;rbuf.len &gt; 0) {
	    char *p = fptr-&gt;rbuf.ptr + fptr-&gt;rbuf.off++;
	    fptr-&gt;rbuf.len--;
	    rb_yield(INT2FIX(*p &amp; 0xff));
	    errno = 0;
	}
	rb_io_check_byte_readable(fptr);
	READ_CHECK(fptr);
    } while (io_fillbuf(fptr) &gt;= 0);
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="each_char-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>each_char</strong> {|c| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_char</strong>  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Calls the given block once for each character in <em>ios</em>, passing the
character as an argument. The stream must be opened for reading or an
<a href="IOError.html" title="IOError (class)">IOError</a> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_each_char'>each_char</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>   <span class='comment'>#=&gt; #&lt;File:testfile&gt;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3625'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3625
3626
3627
3628
3629
3630
3631
3632
3633
3634
3635
3636
3637
3638
3639
3640
3641
3642</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3625</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_each_char(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;
    VALUE c;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    enc = io_input_encoding(fptr);
    READ_CHECK(fptr);
    while (!NIL_P(c = io_getc(fptr, enc))) {
        rb_yield(c);
    }
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="each_codepoint-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>each_codepoint</strong> {|c| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>codepoints</strong> {|c| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_codepoint</strong>  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
    <span class='overload'>#<strong>codepoints</strong>  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Passes the <a href="Integer.html" title="Integer (class)">Integer</a> ordinal of each character in <em>ios</em>, passing the
codepoint as an argument. The stream must be opened for reading or an
<a href="IOError.html" title="IOError (class)">IOError</a> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3673'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3673
3674
3675
3676
3677
3678
3679
3680
3681
3682
3683
3684
3685
3686
3687
3688
3689
3690
3691
3692
3693
3694
3695
3696
3697
3698
3699
3700
3701
3702
3703
3704
3705
3706
3707
3708
3709
3710
3711
3712
3713
3714
3715
3716
3717
3718
3719
3720
3721
3722
3723
3724
3725
3726
3727
3728
3729
3730
3731
3732
3733
3734
3735
3736
3737
3738
3739
3740
3741
3742
3743
3744
3745
3746
3747
3748
3749
3750
3751
3752
3753
3754
3755
3756
3757
3758
3759
3760
3761
3762
3763
3764
3765
3766
3767
3768
3769
3770</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3673</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_each_codepoint(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;
    unsigned int c;
    int r, n;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    READ_CHECK(fptr);
    if (NEED_READCONV(fptr)) {
	SET_BINARY_MODE(fptr);
	r = 1;		/* no invalid char yet */
	for (;;) {
	    make_readconv(fptr, 0);
	    for (;;) {
		if (fptr-&gt;cbuf.len) {
		    if (fptr-&gt;encs.enc)
			r = rb_enc_precise_mbclen(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
						  fptr-&gt;cbuf.ptrfptr-&gt;cbuf.offfptr-&gt;cbuf.len,
						  fptr-&gt;encs.enc);
		    else
			r = ONIGENC_CONSTRUCT_MBCLEN_CHARFOUND(1);
		    if (!MBCLEN_NEEDMORE_P(r))
			break;
		    if (fptr-&gt;cbuf.len == fptr-&gt;cbuf.capa) {
			rb_raise(rb_eIOError, &quot;too long character&quot;);
		    }
		}
		if (more_char(fptr) == MORE_CHAR_FINISHED) {
                    clear_readconv(fptr);
		    if (!MBCLEN_CHARFOUND_P(r)) {
			enc = fptr-&gt;encs.enc;
			goto invalid;
		    }
		    return io;
		}
	    }
	    if (MBCLEN_INVALID_P(r)) {
		enc = fptr-&gt;encs.enc;
		goto invalid;
	    }
	    n = MBCLEN_CHARFOUND_LEN(r);
	    if (fptr-&gt;encs.enc) {
		c = rb_enc_codepoint(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
				     fptr-&gt;cbuf.ptrfptr-&gt;cbuf.offfptr-&gt;cbuf.len,
				     fptr-&gt;encs.enc);
	    }
	    else {
		c = (unsigned char)fptr-&gt;cbuf.ptr[fptr-&gt;cbuf.off];
	    }
	    fptr-&gt;cbuf.off += n;
	    fptr-&gt;cbuf.len -= n;
	    rb_yield(UINT2NUM(c));
	}
    }
    NEED_NEWLINE_DECORATOR_ON_READ_CHECK(fptr);
    enc = io_input_encoding(fptr);
    while (io_fillbuf(fptr) &gt;= 0) {
	r = rb_enc_precise_mbclen(fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off,
				  fptr-&gt;rbuf.ptrfptr-&gt;rbuf.offfptr-&gt;rbuf.len, enc);
	if (MBCLEN_CHARFOUND_P(r) &amp;&amp;
	    (n = MBCLEN_CHARFOUND_LEN(r)) &lt;= fptr-&gt;rbuf.len) {
	    c = rb_enc_codepoint(fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off,
				 fptr-&gt;rbuf.ptrfptr-&gt;rbuf.offfptr-&gt;rbuf.len, enc);
	    fptr-&gt;rbuf.off += n;
	    fptr-&gt;rbuf.len -= n;
	    rb_yield(UINT2NUM(c));
	}
	else if (MBCLEN_INVALID_P(r)) {
	  invalid:
	    rb_raise(rb_eArgError, &quot;invalid byte sequence in %s&quot;, rb_enc_name(enc));
	}
	else if (MBCLEN_NEEDMORE_P(r)) {
	    char cbuf[8], *p = cbuf;
	    int more = MBCLEN_NEEDMORE_LEN(r);
	    if (more &gt; numberof(cbuf)) goto invalid;
	    more += n = fptr-&gt;rbuf.len;
	    if (more &gt; numberof(cbuf)) goto invalid;
	    while ((n = (int)read_buffered_data(p, more, fptr)) &gt; 0 &amp;&amp;
		   (p += n, (more -= n) &gt; 0)) {
		if (io_fillbuf(fptr) &lt; 0) goto invalid;
		if ((n = fptr-&gt;rbuf.len) &gt; more) n = more;
	    }
	    r = rb_enc_precise_mbclen(cbuf, p, enc);
	    if (!MBCLEN_CHARFOUND_P(r)) goto invalid;
	    c = rb_enc_codepoint(cbuf, p, enc);
	    rb_yield(UINT2NUM(c));
	}
	else {
	    continue;
	}
    }
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="each_line-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>each</strong>(sep = $/) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each</strong>(limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each</strong>(sep, limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each</strong>(...)  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(sep = $/) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(sep, limit) {|line| ... } &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>each_line</strong>(...)  &#x21d2; <tt><a href="Enumerator.html" title="Enumerator (class)">Enumerator</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#each-instance_method" title="IO#each (method)">#each</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="eof-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>eof</strong>  &#x21d2; <tt>Boolean</tt> </span>
    <span class='overload'>#<strong>eof?</strong>  &#x21d2; <tt>Boolean</tt> </span>
  <span class='aliases'>Also known as: <span class='names'><span>eof?</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if <em>ios</em> is at end of file that means there are no more
data to read. The stream must be opened for reading or an <a href="IOError.html" title="IOError (class)">IOError</a> will be
raised.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_dummy'>dummy</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_eof'>eof</span>   <span class='comment'>#=&gt; true
</span></code></pre>

<p>If <em>ios</em> is a stream such as pipe or socket, <a href="#eof%3F-instance_method" title="IO#eof? (method)">#eof?</a> blocks until
the other end sends some data or closes it.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>
<span class='const'><a href="Thread.html" title="Thread (class)">Thread</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Thread.html#new-class_method" title="Thread.new (method)">new</a></span> <span class='lbrace'>{</span> <span class='id identifier rubyid_sleep'>sleep</span> <span class='int'>1</span><span class='semicolon'>;</span> <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_eof?'>eof?</span>  <span class='comment'>#=&gt; true after 1 second blocking
</span>
<span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>
<span class='const'><a href="Thread.html" title="Thread (class)">Thread</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Thread.html#new-class_method" title="Thread.new (method)">new</a></span> <span class='lbrace'>{</span> <span class='id identifier rubyid_sleep'>sleep</span> <span class='int'>1</span><span class='semicolon'>;</span> <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_eof?'>eof?</span>  <span class='comment'>#=&gt; false after 1 second blocking
</span>
<span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>
<span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_eof?'>eof?</span>  <span class='comment'># blocks forever
</span></code></pre>

<p>Note that <a href="#eof%3F-instance_method" title="IO#eof? (method)">#eof?</a> reads data to the input byte buffer. So <a href="#sysread-instance_method" title="IO#sysread (method)">#sysread</a>
may not behave as you intend with <a href="#eof%3F-instance_method" title="IO#eof? (method)">#eof?</a>, unless you call <a href="#rewind-instance_method" title="IO#rewind (method)">#rewind</a>
first (which is not available for some streams).</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1815'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1815
1816
1817
1818
1819
1820
1821
1822
1823
1824
1825
1826
1827
1828
1829
1830
1831
1832
1833
1834
1835</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1815</span></pre>
<pre class='code cpp'>

VALUE
rb_io_eof(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    if (READ_CHAR_PENDING(fptr)) return Qfalse;
    if (READ_DATA_PENDING(fptr)) return Qfalse;
    READ_CHECK(fptr);
#if defined(RUBY_TEST_CRLF_ENVIRONMENT) || defined(_WIN32)
    if (!NEED_READCONV(fptr) &amp;&amp; NEED_NEWLINE_DECORATOR_ON_READ(fptr)) {
	return eof(fptr-&gt;fd) ? Qtrue : Qfalse;
    }
#endif
    if (io_fillbuf(fptr) &lt; 0) {
	return Qtrue;
    }
    return Qfalse;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="eof?-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>eof</strong>  &#x21d2; <tt>Boolean</tt> </span>
    <span class='overload'>#<strong>eof?</strong>  &#x21d2; <tt>Boolean</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#eof-instance_method" title="IO#eof (method)">#eof</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="external_encoding-instance_method">
  <h3 class='signature'>
  #<strong>external_encoding</strong>  &#x21d2; <tt><a href="Encoding.html" title="Encoding (class)">Encoding</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the Encoding object that represents the encoding of the file. If io
is write mode and no encoding is specified, returns <code>nil</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L10806'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


10806
10807
10808
10809
10810
10811
10812
10813
10814
10815
10816
10817
10818
10819
10820
10821</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 10806</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_external_encoding(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (fptr-&gt;encs.enc2) {
	return rb_enc_from_encoding(fptr-&gt;encs.enc2);
    }
    if (fptr-&gt;mode &amp; FMODE_WRITABLE) {
	if (fptr-&gt;encs.enc)
	    return rb_enc_from_encoding(fptr-&gt;encs.enc);
	return Qnil;
    }
    return rb_enc_from_encoding(io_read_encoding(fptr));
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="fcntl-instance_method">
  <h3 class='signature'>
  #<strong>fcntl</strong>(integer_cmd, arg)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Provides a mechanism for issuing low-level commands to control or query
file-oriented I/O streams. Arguments and results are platform dependent. If
<em>arg</em> is a number, its value is passed directly. If it is a string,
it is interpreted as a binary sequence of bytes (<a href="Array.html#pack-instance_method" title="Array#pack (method)">Array#pack</a> might be a
useful way to build this string). On Unix platforms, see
<code>fcntl(2)</code> for details. Not implemented on all platforms.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L9306'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9306
9307
9308
9309
9310
9311
9312
9313</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 9306</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_fcntl(int argc, VALUE *argv, VALUE io)
{
    VALUE req, arg;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;req, &amp;arg);
    return rb_fcntl(io, req, arg);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="fdatasync-instance_method">
  <h3 class='signature'>
  #<strong>fdatasync</strong>  &#x21d2; <tt>0</tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Immediately writes all buffered data in <em>ios</em> to disk.</p>

<p>If the underlying operating system does not support <em>fdatasync(2)</em>,
<a href="#fsync-instance_method" title="IO#fsync (method)">#fsync</a> is called instead (which might raise a <a href="NotImplementedError.html" title="NotImplementedError (class)">NotImplementedError</a>).</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1952'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1965
1966
1967
1968</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1952</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_fdatasync(VALUE io)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);

    if (io_fflush(fptr) &lt; 0)
        rb_sys_fail(0);

    if ((int)rb_thread_io_blocking_region(nogvl_fdatasync, fptr, fptr-&gt;fd) == 0)
	return INT2FIX(0);

    /* fall back */
    return rb_io_fsync(io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="fileno-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>fileno</strong>  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
    <span class='overload'>#<strong>to_i</strong>  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#to_i-instance_method" title="IO#to_i (method)">#to_i</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="flush-instance_method">
  <h3 class='signature'>
  #<strong>flush</strong>  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Flushes any buffered data within <em>ios</em> to the underlying operating
system (note that this is Ruby internal buffering only; the OS may buffer
the data as well).</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no newline</span><span class='tstring_end'>&quot;</span></span>
<span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_no'>no</span> <span class='id identifier rubyid_newline'>newline</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1579'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1579
1580
1581
1582
1583</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1579</span></pre>
<pre class='code cpp'>

VALUE
rb_io_flush(VALUE io)
{
    return rb_io_flush_raw(io, 1);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="fsync-instance_method">
  <h3 class='signature'>
  #<strong>fsync</strong>  &#x21d2; <tt>0</tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Immediately writes all buffered data in <em>ios</em> to disk. Note that
<code>fsync</code> differs from using <a href="#sync%3D-instance_method" title="IO#sync= (method)">#sync=</a>. The latter ensures that
data is flushed from Ruby&#39;s buffers, but does not guarantee that the
underlying operating system actually writes it to disk.</p>

<p><a href="NotImplementedError.html" title="NotImplementedError (class)">NotImplementedError</a> is raised if the underlying operating system does not
support <em>fsync(2)</em>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1907'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1907
1908
1909
1910
1911
1912
1913
1914
1915
1916
1917
1918
1919
1920</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1907</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_fsync(VALUE io)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);

    if (io_fflush(fptr) &lt; 0)
        rb_sys_fail(0);
    if ((int)rb_thread_io_blocking_region(nogvl_fsync, fptr, fptr-&gt;fd) &lt; 0)
	rb_sys_fail_path(fptr-&gt;pathv);
    return INT2FIX(0);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="getbyte-instance_method">
  <h3 class='signature'>
  #<strong>getbyte</strong>  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Gets the next 8-bit byte (0..255) from <em>ios</em>. Returns
<code>nil</code> if called at end of file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getbyte'>getbyte</span>   <span class='comment'>#=&gt; 84
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getbyte'>getbyte</span>   <span class='comment'>#=&gt; 104
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3847'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3847
3848
3849
3850
3851
3852
3853
3854
3855
3856
3857
3858
3859
3860
3861
3862
3863
3864
3865
3866
3867
3868
3869
3870</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3847</span></pre>
<pre class='code cpp'>

VALUE
rb_io_getbyte(VALUE io)
{
    rb_io_t *fptr;
    int c;

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);
    READ_CHECK(fptr);
    if (fptr-&gt;fd == 0 &amp;&amp; (fptr-&gt;mode &amp; FMODE_TTY) &amp;&amp; RB_TYPE_P(rb_stdout, T_FILE)) {
        rb_io_t *ofp;
        GetOpenFile(rb_stdout, ofp);
        if (ofp-&gt;mode &amp; FMODE_TTY) {
            rb_io_flush(rb_stdout);
        }
    }
    if (io_fillbuf(fptr) &lt; 0) {
	return Qnil;
    }
    fptr-&gt;rbuf.off++;
    fptr-&gt;rbuf.len--;
    c = (unsigned char)fptr-&gt;rbuf.ptr[fptr-&gt;rbuf.off-1];
    return INT2FIX(c &amp; 0xff);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="getc-instance_method">
  <h3 class='signature'>
  #<strong>getc</strong>  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads a one-character string from <em>ios</em>. Returns <code>nil</code> if
called at end of file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getc'>getc</span>   <span class='comment'>#=&gt; &quot;h&quot;
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getc'>getc</span>   <span class='comment'>#=&gt; &quot;e&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3798'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3798
3799
3800
3801
3802
3803
3804
3805
3806
3807
3808
3809
3810</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3798</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_getc(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    enc = io_input_encoding(fptr);
    READ_CHECK(fptr);
    return io_getc(fptr, enc);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="gets-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>gets</strong>(sep = $/)  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt><sup>?</sup> </span>
    <span class='overload'>#<strong>gets</strong>(limit)  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt><sup>?</sup> </span>
    <span class='overload'>#<strong>gets</strong>(sep, limit)  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt><sup>?</sup> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads the next “line&#39;&#39; from the I/O stream; lines are separated by
<em>sep</em>. A separator of <code>nil</code> reads the entire contents,
and a zero-length separator reads the input a paragraph at a time (two
successive newlines in the input separate paragraphs). The stream must be
opened for reading or an <a href="IOError.html" title="IOError (class)">IOError</a> will be raised. The line read in will be
returned and also assigned to <code>$_</code>. Returns <code>nil</code> if
called at end of file.  If the first argument is an integer, or optional
second argument is given, the returning string would not be longer than the
given value in bytes.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span><span class='gvar'>$_</span>                          <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span>
<span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span><span class='lparen'>(</span><span class='int'>4</span><span class='rparen'>)</span><span class='comment'>#=&gt; &quot;This&quot;
</span></code></pre>

<p>If IO contains multibyte characters byte then <code>gets(1)</code> returns
character entirely:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Russian characters take 2 bytes
</span><span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_write'><a href="#write-class_method" title="IO.write (method)">write</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\u{442 435 441 442}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_open'><a href="File.html#open-class_method" title="File.open (method)">open</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='comment'>#=&gt; &quot;\u0442&quot;
</span><span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_open'><a href="File.html#open-class_method" title="File.open (method)">open</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='comment'>#=&gt; &quot;\u0442&quot;
</span><span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_open'><a href="File.html#open-class_method" title="File.open (method)">open</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='comment'>#=&gt; &quot;\u0442\u0435&quot;
</span><span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_open'><a href="File.html#open-class_method" title="File.open (method)">open</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span><span class='lparen'>(</span><span class='int'>4</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='comment'>#=&gt; &quot;\u0442\u0435&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3258'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3258
3259
3260
3261
3262
3263
3264
3265
3266
3267</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3258</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_gets_m(int argc, VALUE *argv, VALUE io)
{
    VALUE str;

    str = rb_io_getline(argc, argv, io);
    rb_lastline_set(str);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="inspect-instance_method">
  <h3 class='signature'>
  #<strong>inspect</strong>  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Return a string describing this IO object.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L2036'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2036
2037
2038
2039
2040
2041
2042
2043
2044
2045
2046
2047
2048
2049
2050
2051
2052
2053
2054
2055
2056
2057
2058
2059
2060
2061
2062
2063</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 2036</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_inspect(VALUE obj)
{
    rb_io_t *fptr;
    VALUE result;
    static const char closed[] = &quot; (closed)&quot;;

    fptr = RFILE(obj)-&gt;fptr;
    if (!fptr) return rb_any_to_s(obj);
    result = rb_str_new_cstr(&quot;#&lt;&quot;);
    rb_str_append(result, rb_class_name(CLASS_OF(obj)));
    rb_str_cat2(result, &quot;:&quot;);
    if (NIL_P(fptr-&gt;pathv)) {
        if (fptr-&gt;fd &lt; 0) {
	    rb_str_cat(result, closed+1, strlen(closed)-1);
        }
        else {
	    rb_str_catf(result, &quot;fd %d&quot;, fptr-&gt;fd);
        }
    }
    else {
	rb_str_append(result, fptr-&gt;pathv);
        if (fptr-&gt;fd &lt; 0) {
	    rb_str_cat(result, closed, strlen(closed));
        }
    }
    return rb_str_cat2(result, &quot;&gt;&quot;);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="internal_encoding-instance_method">
  <h3 class='signature'>
  #<strong>internal_encoding</strong>  &#x21d2; <tt><a href="Encoding.html" title="Encoding (class)">Encoding</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the Encoding of the internal string if conversion is specified. 
Otherwise returns nil.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L10831'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


10831
10832
10833
10834
10835
10836
10837
10838
10839</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 10831</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_internal_encoding(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (!fptr-&gt;encs.enc2) return Qnil;
    return rb_enc_from_encoding(io_read_encoding(fptr));
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="ioctl-instance_method">
  <h3 class='signature'>
  #<strong>ioctl</strong>(integer_cmd, arg)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Provides a mechanism for issuing low-level commands to control or query I/O
devices. Arguments and results are platform dependent. If <em>arg</em> is a
number, its value is passed directly. If it is a string, it is interpreted
as a binary sequence of bytes. On Unix platforms, see <code>ioctl(2)</code>
for details. Not implemented on all platforms.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L9218'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9218
9219
9220
9221
9222
9223
9224
9225</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 9218</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_ioctl(int argc, VALUE *argv, VALUE io)
{
    VALUE req, arg;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;req, &amp;arg);
    return rb_ioctl(io, req, arg);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="isatty-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>isatty</strong>  &#x21d2; <tt>Boolean</tt> </span>
    <span class='overload'>#<strong>tty?</strong>  &#x21d2; <tt>Boolean</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#tty%3F-instance_method" title="IO#tty? (method)">#tty?</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="lineno-instance_method">
  <h3 class='signature'>
  #<strong>lineno</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current line number in <em>ios</em>.  The stream must be opened
for reading. <code>lineno</code> counts the number of times <a href="#gets-instance_method" title="IO#gets (method)">#gets</a> is
called rather than the number of newlines encountered.  The two values will
differ if <a href="#gets-instance_method" title="IO#gets (method)">#gets</a> is called with a separator other than newline.</p>

<p>Methods that use <code>$/</code> like <a href="#each-instance_method" title="IO#each (method)">#each</a>, <a href="#lines-instance_method" title="IO#lines (method)">#lines</a> and <a href="#readline-instance_method" title="IO#readline (method)">#readline</a>
will also increment <code>lineno</code>.</p>

<p>See also the <code>$.</code> variable.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_lineno'>lineno</span>   <span class='comment'>#=&gt; 0
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>     <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_lineno'>lineno</span>   <span class='comment'>#=&gt; 1
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>     <span class='comment'>#=&gt; &quot;This is line two\n&quot;
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_lineno'>lineno</span>   <span class='comment'>#=&gt; 2
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3291'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3291
3292
3293
3294
3295
3296
3297
3298
3299</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3291</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_lineno(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);
    return INT2NUM(fptr-&gt;lineno);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="lineno=-instance_method">
  <h3 class='signature'>
  #<strong>lineno=</strong>(integer)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Manually sets the current line number to the given value. <code>$.</code>
is updated only on the next read.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>                     <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span><span class='gvar'>$.</span>                         <span class='comment'>#=&gt; 1
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_lineno'>lineno</span> <span class='op'>=</span> <span class='int'>1000</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_lineno'>lineno</span>                   <span class='comment'>#=&gt; 1000
</span><span class='gvar'>$.</span>                         <span class='comment'>#=&gt; 1         # lineno of last read
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>                     <span class='comment'>#=&gt; &quot;This is line two\n&quot;
</span><span class='gvar'>$.</span>                         <span class='comment'>#=&gt; 1001      # lineno of last read
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3318'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3318
3319
3320
3321
3322
3323
3324
3325
3326
3327</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3318</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_set_lineno(VALUE io, VALUE lineno)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);
    fptr-&gt;lineno = NUM2INT(lineno);
    return lineno;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="lines-instance_method">
  <h3 class='signature'>
  #<strong>lines</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>This is a deprecated alias for <code>each_line</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3443'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3443
3444
3445
3446
3447
3448
3449
3450</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3443</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_lines(int argc, VALUE *argv, VALUE io)
{
    rb_warn(&quot;IO#lines is deprecated; use #each_line instead&quot;);
    if (!rb_block_given_p())
	return rb_enumeratorize(io, ID2SYM(rb_intern(&quot;each_line&quot;)), argc, argv);
    return rb_io_each_line(argc, argv, io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="pid-instance_method">
  <h3 class='signature'>
  #<strong>pid</strong>  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the process ID of a child process associated with <em>ios</em>.
This will be set by <a href="#popen-class_method" title="IO.popen (method)">popen</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_pipe'>pipe</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_popen'><a href="#popen-class_method" title="IO.popen (method)">popen</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>if</span> <span class='id identifier rubyid_pipe'>pipe</span>
  <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>In parent, child pid is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pipe'>pipe</span><span class='period'>.</span><span class='id identifier rubyid_pid'>pid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>else</span>
  <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>In child, pid is </span><span class='embexpr_beg'>#{</span><span class='gvar'>$$</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">In child, pid is 26209
In parent, child pid is 26209</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L2017'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2017
2018
2019
2020
2021
2022
2023
2024
2025
2026</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 2017</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_pid(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (!fptr-&gt;pid)
	return Qnil;
    return PIDT2NUM(fptr-&gt;pid);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="pos-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>pos</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> </span>
    <span class='overload'>#<strong>tell</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> </span>
  <span class='aliases'>Also known as: <span class='names'><span>tell</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current offset (in bytes) of <em>ios</em>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_pos'>pos</span>    <span class='comment'>#=&gt; 0
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_pos'>pos</span>    <span class='comment'>#=&gt; 17
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1598'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1598
1599
1600
1601
1602
1603
1604
1605
1606
1607
1608
1609</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1598</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_tell(VALUE io)
{
    rb_io_t *fptr;
    off_t pos;

    GetOpenFile(io, fptr);
    pos = io_tell(fptr);
    if (pos &lt; 0 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);
    pos -= fptr-&gt;rbuf.len;
    return OFFT2NUM(pos);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="pos=-instance_method">
  <h3 class='signature'>
  #<strong>pos=</strong>(integer)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Seeks to the given position (in bytes) in <em>ios</em>. It is not
guaranteed that seeking to the right position when <em>ios</em> is
textmode.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='int'>17</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>   <span class='comment'>#=&gt; &quot;This is line two\n&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1692'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1692
1693
1694
1695
1696
1697
1698
1699
1700
1701
1702
1703
1704</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1692</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_set_pos(VALUE io, VALUE offset)
{
    rb_io_t *fptr;
    off_t pos;

    pos = NUM2OFFT(offset);
    GetOpenFile(io, fptr);
    pos = io_seek(fptr, pos, SEEK_SET);
    if (pos &lt; 0 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);

    return OFFT2NUM(pos);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="print-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>print</strong>()  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>print</strong>(obj, ...)  &#x21d2; <tt>nil</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes the given object(s) to <em>ios</em>. The stream must be opened for
writing. If the output field separator (<code>$,</code>) is not
<code>nil</code>, it will be inserted between each object. If the output
record separator (<code>$\</code>) is not <code>nil</code>, it will be
appended to the output. If no arguments are given, prints <code>$_</code>.
Objects that aren&#39;t strings will be converted by calling their
<code>to_s</code> method. With no argument, prints the contents of the
variable <code>$_</code>. Returns <code>nil</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is </span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>100</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> percent.\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">This is 100 percent.</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L6976'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6976
6977
6978
6979
6980
6981
6982
6983
6984
6985
6986
6987
6988
6989
6990
6991
6992
6993
6994
6995
6996
6997
6998
6999</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 6976</span></pre>
<pre class='code cpp'>

VALUE
rb_io_print(int argc, const VALUE *argv, VALUE out)
{
    int i;
    VALUE line;

    /* if no argument given, print `$_&#39; */
    if (argc == 0) {
	argc = 1;
	line = rb_lastline_get();
	argv = &amp;line;
    }
    for (i=0; i&lt;argc; i++) {
	if (!NIL_P(rb_output_fs) &amp;&amp; i&gt;0) {
	    rb_io_write(out, rb_output_fs);
	}
	rb_io_write(out, argv[i]);
    }
    if (argc &gt; 0 &amp;&amp; !NIL_P(rb_output_rs)) {
	rb_io_write(out, rb_output_rs);
    }

    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="printf-instance_method">
  <h3 class='signature'>
  #<strong>printf</strong>(format_string[, obj, ...])  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Formats and writes to <em>ios</em>, converting parameters under control of
the format string. See <a href="Kernel.html#sprintf-class_method" title="Kernel.sprintf (method)">Kernel.sprintf</a> for details.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L6917'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6917
6918
6919
6920
6921
6922</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 6917</span></pre>
<pre class='code cpp'>

VALUE
rb_io_printf(int argc, const VALUE *argv, VALUE out)
{
    rb_io_write(out, rb_f_sprintf(argc, argv));
    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="putc-instance_method">
  <h3 class='signature'>
  #<strong>putc</strong>(obj)  &#x21d2; <tt><a href="Object.html" title="Object (class)">Object</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>If <em>obj</em> is <a href="Numeric.html" title="Numeric (class)">Numeric</a>, write the character whose code is the
least-significant byte of <em>obj</em>, otherwise write the first byte of
the string representation of <em>obj</em> to <em>ios</em>. Note: This
method is not safe for use with multi-byte characters as it will truncate
them.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_putc'>putc</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span>
<span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_putc'>putc</span> <span class='int'>65</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby"><span class='const'>AA</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L7049'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7049
7050
7051
7052
7053
7054
7055
7056
7057
7058
7059
7060
7061
7062</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 7049</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_putc(VALUE io, VALUE ch)
{
    VALUE str;
    if (RB_TYPE_P(ch, T_STRING)) {
	str = rb_str_substr(ch, 0, 1);
    }
    else {
	char c = NUM2CHR(ch);
	str = rb_str_new(&amp;c, 1);
    }
    rb_io_write(io, str);
    return ch;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="puts-instance_method">
  <h3 class='signature'>
  #<strong>puts</strong>(obj, ...)  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes the given objects to <em>ios</em> as with <a href="#print-instance_method" title="IO#print (method)">#print</a>. Writes a
record separator (typically a newline) after any that do not already end
with a newline sequence. If called with an array argument, writes each
element on a new line. If called without arguments, outputs a single record
separator.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>this</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_this'>this</span>
<span class='id identifier rubyid_is'>is</span>
<span class='id identifier rubyid_a'>a</span>
<span class='id identifier rubyid_test'>test</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L7141'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7141
7142
7143
7144
7145
7146
7147
7148
7149
7150
7151
7152
7153
7154
7155
7156
7157
7158
7159
7160
7161
7162
7163
7164
7165
7166
7167
7168
7169
7170</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 7141</span></pre>
<pre class='code cpp'>

VALUE
rb_io_puts(int argc, const VALUE *argv, VALUE out)
{
    int i;
    VALUE line;

    /* if no argument given, print newline. */
    if (argc == 0) {
	rb_io_write(out, rb_default_rs);
	return Qnil;
    }
    for (i=0; i&lt;argc; i++) {
	if (RB_TYPE_P(argv[i], T_STRING)) {
	    line = argv[i];
	    goto string;
	}
	if (rb_exec_recursive(io_puts_ary, argv[i], out)) {
	    continue;
	}
	line = rb_obj_as_string(argv[i]);
      string:
	rb_io_write(out, line);
	if (RSTRING_LEN(line) == 0 ||
            !str_end_with_asciichar(line, &#39;\n&#39;)) {
	    rb_io_write(out, rb_default_rs);
	}
    }

    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="read-instance_method">
  <h3 class='signature'>
  #<strong>read</strong>([length [, outbuf]])  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt>, ... 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads <em>length</em> bytes from the I/O stream.</p>

<p><em>length</em> must be a non-negative integer or <code>nil</code>.</p>

<p>If <em>length</em> is a positive integer, it tries to read <em>length</em>
bytes without any conversion (binary mode). It returns <code>nil</code> or
a string whose length is 1 to <em>length</em> bytes. <code>nil</code> means
it met EOF at beginning. The 1 to <em>length</em>-1 bytes string means it
met EOF after reading the result. The <em>length</em> bytes string means it
doesn&#39;t meet EOF. The resulted string is always ASCII-8BIT encoding.</p>

<p>If <em>length</em> is omitted or is <code>nil</code>, it reads until EOF
and the encoding conversion is applied. It returns a string even if EOF is
met at beginning.</p>

<p>If <em>length</em> is zero, it returns <code>&quot;&quot;</code>.</p>

<p>If the optional <em>outbuf</em> argument is present, it must reference a
String, which will receive the data. The <em>outbuf</em> will contain only
the received data after the method call even if it is not empty at the
beginning.</p>

<p>At end of file, it returns <code>nil</code> or <code>&quot;&quot;</code>
depend on <em>length</em>. <code><em>ios</em>.read()</code> and
<code><em>ios</em>.read(nil)</code> returns <code>&quot;&quot;</code>.
<code><em>ios</em>.read(<em>positive-integer</em>)</code> returns
<code>nil</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span>   <span class='comment'>#=&gt; &quot;This is line one&quot;
</span>
<span class='comment'># reads whole file
</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>file</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='comment'># This returns a string even if the file is empty.
</span>  <span class='comment'>#...
</span><span class='rbrace'>}</span>

<span class='comment'># iterate over fixed length records.
</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fixed-record-file</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='kw'>while</span> <span class='id identifier rubyid_record'>record</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='int'>256</span><span class='rparen'>)</span>
    <span class='comment'>#...
</span>  <span class='kw'>end</span>
<span class='rbrace'>}</span>

<span class='comment'># iterate over variable length records.
</span><span class='comment'># record is prefixed by 32-bit length.
</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>variable-record-file</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
  <span class='kw'>while</span> <span class='id identifier rubyid_len'>len</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='int'>4</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_len'>len</span> <span class='op'>=</span> <span class='id identifier rubyid_len'>len</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>N</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='comment'># 32-bit length
</span>    <span class='id identifier rubyid_record'>record</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_len'>len</span><span class='rparen'>)</span> <span class='comment'># This returns a string even if len is 0.
</span>  <span class='kw'>end</span>
<span class='rbrace'>}</span></code></pre>

<p>Note that this method behaves like fread() function in C. This means it
retry to invoke read(2) system call to read data with the specified length
(or until EOF). This behavior is preserved even if <em>ios</em> is
non-blocking mode. (This method is non-blocking flag insensitive as other
methods.) If you need the behavior like single read(2) system call,
consider readpartial, read_nonblock and sysread.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L2783'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2783
2784
2785
2786
2787
2788
2789
2790
2791
2792
2793
2794
2795
2796
2797
2798
2799
2800
2801
2802
2803
2804
2805
2806
2807
2808
2809
2810
2811
2812
2813
2814
2815
2816
2817
2818
2819
2820
2821
2822
2823
2824
2825
2826
2827
2828
2829</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 2783</span></pre>
<pre class='code cpp'>

static VALUE
io_read(int argc, VALUE *argv, VALUE io)
{
    rb_io_t *fptr;
    long n, len;
    VALUE length, str;
#if defined(RUBY_TEST_CRLF_ENVIRONMENT) || defined(_WIN32)
    int previous_mode;
#endif

    rb_scan_args(argc, argv, &quot;02&quot;, &amp;length, &amp;str);

    if (NIL_P(length)) {
	GetOpenFile(io, fptr);
	rb_io_check_char_readable(fptr);
	return read_all(fptr, remain_size(fptr), str);
    }
    len = NUM2LONG(length);
    if (len &lt; 0) {
	rb_raise(rb_eArgError, &quot;negative length %ld given&quot;, len);
    }

    io_setstrbuf(&amp;str,len);

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);
    if (len == 0) {
	io_set_read_length(str, 0);
	return str;
    }

    READ_CHECK(fptr);
#if defined(RUBY_TEST_CRLF_ENVIRONMENT) || defined(_WIN32)
    previous_mode = set_binary_mode_with_seek_cur(fptr);
#endif
    n = io_fread(str, 0, len, fptr);
    io_set_read_length(str, n);
#if defined(RUBY_TEST_CRLF_ENVIRONMENT) || defined(_WIN32)
    if (previous_mode == O_TEXT) {
	setmode(fptr-&gt;fd, O_TEXT);
    }
#endif
    if (n == 0) return Qnil;
    OBJ_TAINT(str);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="read_nonblock-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>read_nonblock</strong>(maxlen[, options])  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> </span>
    <span class='overload'>#<strong>read_nonblock</strong>(maxlen, outbuf[, options])  &#x21d2; <tt>outbuf</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads at most <em>maxlen</em> bytes from <em>ios</em> using the read(2)
system call after O_NONBLOCK is set for the underlying file descriptor.</p>

<p>If the optional <em>outbuf</em> argument is present, it must reference a
String, which will receive the data. The <em>outbuf</em> will contain only
the received data after the method call even if it is not empty at the
beginning.</p>

<p>read_nonblock just calls the read(2) system call. It causes all errors the
read(2) system call causes: <code>Errno::EWOULDBLOCK</code>, <code>Errno::EINTR</code>, etc. The
caller should care such errors.</p>

<p>If the exception is <code>Errno::EWOULDBLOCK</code> or <code>Errno::EAGAIN</code>, it is extended
by <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a>. So <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a> can be used to rescue the
exceptions for retrying read_nonblock.</p>

<p>read_nonblock causes EOFError on EOF.</p>

<p>If the read byte buffer is not empty, read_nonblock reads from the buffer
like readpartial. In this case, the read(2) system call is not called.</p>

<p>When read_nonblock raises an exception kind of <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a>,
read_nonblock should not be called until io is readable for avoiding busy
loop. This can be done as follows.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># emulates blocking read (readpartial).
</span><span class='kw'>begin</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_read_nonblock'>read_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_maxlen'>maxlen</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a></span>
  <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_select'><a href="#select-class_method" title="IO.select (method)">select</a></span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_io'>io</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>end</span>
</code></pre>

<p>Although <a href="#read_nonblock-instance_method" title="IO#read_nonblock (method)">#read_nonblock</a> doesn&#39;t raise <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a>.
<code>OpenSSL::Buffering#read_nonblock</code> can raise <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a>. If IO and
SSL should be used polymorphically, <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a> should be rescued
too. See the document of <code>OpenSSL::Buffering#read_nonblock</code> for sample
code.</p>

<p>Note that this method is identical to readpartial except the non-blocking
flag is set.</p>

<p>By specifying <tt>exception: false</tt>, the options hash allows you to indicate
that read_nonblock should not raise an <a href="IO/WaitReadable.html" title="IO::WaitReadable (module)">WaitReadable</a> exception, but
return the symbol :wait_readable instead.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/prelude.rb#L73'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


73
74
75</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'prelude.rb', line 73</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_read_nonblock'>read_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_len'>len</span><span class='comma'>,</span> <span class='id identifier rubyid_buf'>buf</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___read_nonblock'>__read_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_len'>len</span><span class='comma'>,</span> <span class='id identifier rubyid_buf'>buf</span><span class='comma'>,</span> <span class='id identifier rubyid_exception'>exception</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="readbyte-instance_method">
  <h3 class='signature'>
  #<strong>readbyte</strong>  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads a byte as with <a href="#getbyte-instance_method" title="IO#getbyte (method)">#getbyte</a>, but raises an <a href="EOFError.html" title="EOFError (class)">EOFError</a> on end of file.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3880'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3880
3881
3882
3883
3884
3885
3886
3887
3888
3889</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3880</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_readbyte(VALUE io)
{
    VALUE c = rb_io_getbyte(io);

    if (NIL_P(c)) {
	rb_eof_error();
    }
    return c;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="readchar-instance_method">
  <h3 class='signature'>
  #<strong>readchar</strong>  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads a one-character string from <em>ios</em>. Raises an <a href="EOFError.html" title="EOFError (class)">EOFError</a> on end
of file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readchar'>readchar</span>   <span class='comment'>#=&gt; &quot;h&quot;
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readchar'>readchar</span>   <span class='comment'>#=&gt; &quot;e&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3824'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3824
3825
3826
3827
3828
3829
3830
3831
3832
3833</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3824</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_readchar(VALUE io)
{
    VALUE c = rb_io_getc(io);

    if (NIL_P(c)) {
	rb_eof_error();
    }
    return c;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="readline-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>readline</strong>(sep = $/)  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> </span>
    <span class='overload'>#<strong>readline</strong>(limit)  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> </span>
    <span class='overload'>#<strong>readline</strong>(sep, limit)  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads a line as with <a href="#gets-instance_method" title="IO#gets (method)">#gets</a>, but raises an <a href="EOFError.html" title="EOFError (class)">EOFError</a> on end of file.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3339'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3339
3340
3341
3342
3343
3344
3345
3346
3347
3348</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3339</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_readline(int argc, VALUE *argv, VALUE io)
{
    VALUE line = rb_io_gets_m(argc, argv, io);

    if (NIL_P(line)) {
	rb_eof_error();
    }
    return line;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="readlines-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>readlines</strong>(sep = $/)  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt> </span>
    <span class='overload'>#<strong>readlines</strong>(limit)  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt> </span>
    <span class='overload'>#<strong>readlines</strong>(sep, limit)  &#x21d2; <tt><a href="Array.html" title="Array (class)">Array</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads all of the lines in <em>ios</em>, and returns them in
<em>anArray</em>. Lines are separated by the optional <em>sep</em>. If
<em>sep</em> is <code>nil</code>, the rest of the stream is returned as a
single record.  If the first argument is an integer, or optional second
argument is given, the returning string would not be longer than the given
value in bytes. The stream must be opened for reading or an <a href="IOError.html" title="IOError (class)">IOError</a> will
be raised.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3370'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3370
3371
3372
3373
3374
3375
3376
3377
3378</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3370</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_readlines(int argc, VALUE *argv, VALUE io)
{
    VALUE rs;
    long limit;

    prepare_getline_args(argc, argv, &amp;rs, &amp;limit, io);
    return io_readlines(rs, limit, io);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="readpartial-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>readpartial</strong>(maxlen)  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> </span>
    <span class='overload'>#<strong>readpartial</strong>(maxlen, outbuf)  &#x21d2; <tt>outbuf</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads at most <em>maxlen</em> bytes from the I/O stream. It blocks only if
<em>ios</em> has no data immediately available. It doesn&#39;t block if
some data available. If the optional <em>outbuf</em> argument is present,
it must reference a String, which will receive the data. The
<em>outbuf</em> will contain only the received data after the method call
even if it is not empty at the beginning. It raises <a href="EOFError.html" title="EOFError (class)">EOFError</a> on end of
file.</p>

<p>readpartial is designed for streams such as pipe, socket, tty, etc. It
blocks only when no data immediately available. This means that it blocks
only when following all conditions hold.</p>
<ul><li>
<p>the byte buffer in the IO object is empty.</p>
</li><li>
<p>the content of the stream is empty.</p>
</li><li>
<p>the stream is not reached to EOF.</p>
</li></ul>

<p>When readpartial blocks, it waits data or EOF on the stream. If some data
is reached, readpartial returns with the data. If EOF is reached,
readpartial raises EOFError.</p>

<p>When readpartial doesn&#39;t blocks, it returns or raises immediately. If
the byte buffer is not empty, it returns the data in the buffer. Otherwise
if the stream has some content, it returns the data in the stream.
Otherwise if the stream is reached to EOF, it raises EOFError.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>           <span class='comment'>#               buffer          pipe content
</span><span class='id identifier rubyid_w'>w</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&quot;</span></span>               <span class='comment'>#               &quot;&quot;              &quot;abc&quot;.
</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_readpartial'>readpartial</span><span class='lparen'>(</span><span class='int'>4096</span><span class='rparen'>)</span>      <span class='comment'>#=&gt; &quot;abc&quot;       &quot;&quot;              &quot;&quot;
</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_readpartial'>readpartial</span><span class='lparen'>(</span><span class='int'>4096</span><span class='rparen'>)</span>      <span class='comment'># blocks because buffer and pipe is empty.
</span>
<span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>           <span class='comment'>#               buffer          pipe content
</span><span class='id identifier rubyid_w'>w</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&quot;</span></span>               <span class='comment'>#               &quot;&quot;              &quot;abc&quot;
</span><span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>                  <span class='comment'>#               &quot;&quot;              &quot;abc&quot; EOF
</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_readpartial'>readpartial</span><span class='lparen'>(</span><span class='int'>4096</span><span class='rparen'>)</span>      <span class='comment'>#=&gt; &quot;abc&quot;       &quot;&quot;              EOF
</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_readpartial'>readpartial</span><span class='lparen'>(</span><span class='int'>4096</span><span class='rparen'>)</span>      <span class='comment'># raises EOFError
</span>
<span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>           <span class='comment'>#               buffer          pipe content
</span><span class='id identifier rubyid_w'>w</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abc\ndef\n</span><span class='tstring_end'>&quot;</span></span>        <span class='comment'>#               &quot;&quot;              &quot;abc\ndef\n&quot;
</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>                   <span class='comment'>#=&gt; &quot;abc\n&quot;     &quot;def\n&quot;         &quot;&quot;
</span><span class='id identifier rubyid_w'>w</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ghi\n</span><span class='tstring_end'>&quot;</span></span>             <span class='comment'>#               &quot;def\n&quot;         &quot;ghi\n&quot;
</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_readpartial'>readpartial</span><span class='lparen'>(</span><span class='int'>4096</span><span class='rparen'>)</span>      <span class='comment'>#=&gt; &quot;def\n&quot;     &quot;&quot;              &quot;ghi\n&quot;
</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_readpartial'>readpartial</span><span class='lparen'>(</span><span class='int'>4096</span><span class='rparen'>)</span>      <span class='comment'>#=&gt; &quot;ghi\n&quot;     &quot;&quot;              &quot;&quot;
</span></code></pre>

<p>Note that readpartial behaves similar to sysread. The differences are:</p>
<ul><li>
<p>If the byte buffer is not empty, read from the byte buffer instead of
“sysread for buffered IO (IOError)”.</p>
</li><li>
<p>It doesn&#39;t cause <code>Errno::EWOULDBLOCK</code> and <code>Errno::EINTR</code>.  When
readpartial meets EWOULDBLOCK and EINTR by read system call, readpartial
retry the system call.</p>
</li></ul>

<p>The latter means that readpartial is nonblocking-flag insensitive. It
blocks on the situation <a href="#sysread-instance_method" title="IO#sysread (method)">#sysread</a> causes <code>Errno::EWOULDBLOCK</code> as if the
fd is blocking mode.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L2612'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2612
2613
2614
2615
2616
2617
2618
2619
2620
2621</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 2612</span></pre>
<pre class='code cpp'>

static VALUE
io_readpartial(int argc, VALUE *argv, VALUE io)
{
    VALUE ret;

    ret = io_getpartial(argc, argv, io, Qnil, 0);
    if (NIL_P(ret))
        rb_eof_error();
    return ret;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="reopen-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>reopen</strong>(other_IO)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>reopen</strong>(path, mode_str)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reassociates <em>ios</em> with the I/O stream given in <em>other_IO</em> or
to a new stream opened on <em>path</em>. This may dynamically change the
actual class of this stream.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f1'>f1</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f2'>f2</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f2'>f2</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span><span class='id identifier rubyid_f2'>f2</span><span class='period'>.</span><span class='id identifier rubyid_reopen'>reopen</span><span class='lparen'>(</span><span class='id identifier rubyid_f1'>f1</span><span class='rparen'>)</span>     <span class='comment'>#=&gt; #&lt;File:testfile&gt;
</span><span class='id identifier rubyid_f2'>f2</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L6773'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6773
6774
6775
6776
6777
6778
6779
6780
6781
6782
6783
6784
6785
6786
6787
6788
6789
6790
6791
6792
6793
6794
6795
6796
6797
6798
6799
6800
6801
6802
6803
6804
6805
6806
6807
6808
6809
6810
6811
6812
6813
6814
6815
6816
6817
6818
6819
6820
6821
6822
6823
6824
6825
6826
6827
6828
6829
6830
6831
6832
6833
6834
6835
6836
6837
6838
6839
6840
6841
6842
6843
6844
6845
6846
6847
6848
6849
6850
6851
6852
6853
6854
6855
6856
6857
6858
6859</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 6773</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_reopen(int argc, VALUE *argv, VALUE file)
{
    VALUE fname, nmode, opt;
    int oflags;
    rb_io_t *fptr;

    if (rb_scan_args(argc, argv, &quot;11:&quot;, &amp;fname, &amp;nmode, &amp;opt) == 1) {
	VALUE tmp = rb_io_check_io(fname);
	if (!NIL_P(tmp)) {
	    return io_reopen(file, tmp);
	}
    }

    FilePathValue(fname);
    rb_io_taint_check(file);
    fptr = RFILE(file)-&gt;fptr;
    if (!fptr) {
	fptr = RFILE(file)-&gt;fptr = ZALLOC(rb_io_t);
    }

    if (!NIL_P(nmode) || !NIL_P(opt)) {
	int fmode;
	convconfig_t convconfig;

	rb_io_extract_modeenc(&amp;nmode, 0, opt, &amp;oflags, &amp;fmode, &amp;convconfig);
	if (IS_PREP_STDIO(fptr) &amp;&amp;
            ((fptr-&gt;mode &amp; FMODE_READWRITE) &amp; (fmode &amp; FMODE_READWRITE)) !=
            (fptr-&gt;mode &amp; FMODE_READWRITE)) {
	    rb_raise(rb_eArgError,
		     &quot;%s can&#39;t change access mode from \&quot;%s\&quot; to \&quot;%s\&quot;&quot;,
		     PREP_STDIO_NAME(fptr), rb_io_fmode_modestr(fptr-&gt;mode),
		     rb_io_fmode_modestr(fmode));
	}
	fptr-&gt;mode = fmode;
	fptr-&gt;encs = convconfig;
    }
    else {
	oflags = rb_io_fmode_oflags(fptr-&gt;mode);
    }

    fptr-&gt;pathv = fname;
    if (fptr-&gt;fd &lt; 0) {
        fptr-&gt;fd = rb_sysopen(fptr-&gt;pathv, oflags, 0666);
	fptr-&gt;stdio_file = 0;
	return file;
    }

    if (fptr-&gt;mode &amp; FMODE_WRITABLE) {
        if (io_fflush(fptr) &lt; 0)
            rb_sys_fail(0);
    }
    fptr-&gt;rbuf.off = fptr-&gt;rbuf.len = 0;

    if (fptr-&gt;stdio_file) {
	int e = rb_freopen(rb_str_encode_ospath(fptr-&gt;pathv),
			   rb_io_oflags_modestr(oflags),
			   fptr-&gt;stdio_file);
	if (e) rb_syserr_fail_path(e, fptr-&gt;pathv);
        fptr-&gt;fd = fileno(fptr-&gt;stdio_file);
        rb_fd_fix_cloexec(fptr-&gt;fd);
#ifdef USE_SETVBUF
        if (setvbuf(fptr-&gt;stdio_file, NULL, _IOFBF, 0) != 0)
            rb_warn(&quot;setvbuf() can&#39;t be honoured for %&quot;PRIsVALUE, fptr-&gt;pathv);
#endif
        if (fptr-&gt;stdio_file == stderr) {
            if (setvbuf(fptr-&gt;stdio_file, NULL, _IONBF, BUFSIZ) != 0)
                rb_warn(&quot;setvbuf() can&#39;t be honoured for %&quot;PRIsVALUE, fptr-&gt;pathv);
        }
        else if (fptr-&gt;stdio_file == stdout &amp;&amp; isatty(fptr-&gt;fd)) {
            if (setvbuf(fptr-&gt;stdio_file, NULL, _IOLBF, BUFSIZ) != 0)
                rb_warn(&quot;setvbuf() can&#39;t be honoured for %&quot;PRIsVALUE, fptr-&gt;pathv);
        }
    }
    else {
	int tmpfd = rb_sysopen(fptr-&gt;pathv, oflags, 0666);
	int err = 0;
	if (rb_cloexec_dup2(tmpfd, fptr-&gt;fd) &lt; 0)
	    err = errno;
	(void)close(tmpfd);
	if (err) {
	    rb_syserr_fail_path(err, fptr-&gt;pathv);
	}
    }

    return file;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="rewind-instance_method">
  <h3 class='signature'>
  #<strong>rewind</strong>  &#x21d2; <tt>0</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Positions <em>ios</em> to the beginning of input, resetting
<code>lineno</code> to zero.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readline'>readline</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_rewind'>rewind</span>     <span class='comment'>#=&gt; 0
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_lineno'>lineno</span>     <span class='comment'>#=&gt; 0
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readline'>readline</span>   <span class='comment'>#=&gt; &quot;This is line one\n&quot;
</span></code></pre>

<p>Note that it cannot be used with streams such as pipes, ttys, and sockets.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1724'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1724
1725
1726
1727
1728
1729
1730
1731
1732
1733
1734
1735
1736
1737
1738
1739
1740</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1724</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_rewind(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (io_seek(fptr, 0L, 0) &lt; 0 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);
    if (io == ARGF.current_file) {
	ARGF.lineno -= fptr-&gt;lineno;
    }
    fptr-&gt;lineno = 0;
    if (fptr-&gt;readconv) {
	clear_readconv(fptr);
    }

    return INT2FIX(0);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="seek-instance_method">
  <h3 class='signature'>
  #<strong>seek</strong>(amount, whence = IO.SEEK_SET)  &#x21d2; <tt>0</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Seeks to a given offset <em>anInteger</em> in the stream according to the
value of <em>whence</em>:</p>

<pre class="code ruby"><code class="ruby">:CUR or IO::SEEK_CUR  | Seeks to _amount_ plus current position
----------------------+--------------------------------------------------
:END or IO::SEEK_END  | Seeks to _amount_ plus end of stream (you
                      | probably want a negative value for _amount_)
----------------------+--------------------------------------------------
:SET or IO::SEEK_SET  | Seeks to the absolute location given by _amount_</code></pre>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_seek'>seek</span><span class='lparen'>(</span><span class='op'>-</span><span class='int'>13</span><span class='comma'>,</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="#SEEK_END-constant" title="IO::SEEK_END (constant)">SEEK_END</a></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; 0
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_readline'>readline</span>                  <span class='comment'>#=&gt; &quot;And so on...\n&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1666'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1666
1667
1668
1669
1670
1671
1672
1673
1674
1675
1676
1677</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1666</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_seek_m(int argc, VALUE *argv, VALUE io)
{
    VALUE offset, ptrname;
    int whence = SEEK_SET;

    if (rb_scan_args(argc, argv, &quot;11&quot;, &amp;offset, &amp;ptrname) == 2) {
	whence = interpret_seek_whence(ptrname);
    }

    return rb_io_seek(io, offset, whence);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="set_encoding-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>set_encoding</strong>(ext_enc)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>set_encoding</strong>(&quot;ext_enc:int_enc&quot;)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>set_encoding</strong>(ext_enc, int_enc)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>set_encoding</strong>(&quot;ext_enc:int_enc&quot;, opt)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
    <span class='overload'>#<strong>set_encoding</strong>(ext_enc, int_enc, opt)  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>If single argument is specified, read string from io is tagged with the
encoding specified.  If encoding is a colon separated two encoding names
“A:B”, the read string is converted from encoding A (external encoding) to
encoding B (internal encoding), then tagged with B.  If two arguments are
specified, those must be encoding objects or encoding names, and the first
one is the external encoding, and the second one is the internal encoding.
If the external encoding and the internal encoding is specified, optional
hash argument specify the conversion option.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L10860'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


10860
10861
10862
10863
10864
10865
10866
10867
10868
10869
10870
10871
10872
10873
10874</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 10860</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_set_encoding(int argc, VALUE *argv, VALUE io)
{
    rb_io_t *fptr;
    VALUE v1, v2, opt;

    if (!RB_TYPE_P(io, T_FILE)) {
        return rb_funcallv(io, id_set_encoding, argc, argv);
    }

    argc = rb_scan_args(argc, argv, &quot;11:&quot;, &amp;v1, &amp;v2, &amp;opt);
    GetOpenFile(io, fptr);
    io_encoding_set(fptr, v1, v2, opt);
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="stat-instance_method">
  <h3 class='signature'>
  #<strong>stat</strong>  &#x21d2; <tt><a href="#stat-instance_method" title="IO#stat (method)">stat</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns status information for <em>ios</em> as an object of type
<a href="File/Stat.html" title="File::Stat (class)">File::Stat</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_stat'>stat</span>
<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%o</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_mode'>mode</span>   <span class='comment'>#=&gt; &quot;100644&quot;
</span><span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_blksize'>blksize</span>       <span class='comment'>#=&gt; 4096
</span><span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_atime'>atime</span>         <span class='comment'>#=&gt; Wed Apr 09 08:53:54 CDT 2003
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/file.c#L1119'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'file.c', line 1119</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_stat(VALUE obj)
{
    rb_io_t *fptr;
    struct stat st;

    GetOpenFile(obj, fptr);
    if (fstat(fptr-&gt;fd, &amp;st) == -1) {
	rb_sys_fail_path(fptr-&gt;pathv);
    }
    return rb_stat_new(&amp;st);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="sync-instance_method">
  <h3 class='signature'>
  #<strong>sync</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the current “sync mode&#39;&#39; of <em>ios</em>. When sync mode is
true, all output is immediately flushed to the underlying operating system
and is not buffered by Ruby internally. See also <a href="#fsync-instance_method" title="IO#fsync (method)">#fsync</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span>   <span class='comment'>#=&gt; false
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1850'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1850
1851
1852
1853
1854
1855
1856
1857
1858</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1850</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_sync(VALUE io)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);
    return (fptr-&gt;mode &amp; FMODE_SYNC) ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="sync=-instance_method">
  <h3 class='signature'>
  #<strong>sync=</strong>(boolean)  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets the “sync mode&#39;&#39; to <code>true</code> or <code>false</code>.
When sync mode is true, all output is immediately flushed to the underlying
operating system and is not buffered internally. Returns the new state. See
also <a href="#fsync-instance_method" title="IO#fsync (method)">#fsync</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_sync'>sync</span> <span class='op'>=</span> <span class='kw'>true</span>
</code></pre>

<p><em>(produces no output)</em></p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1877'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1877
1878
1879
1880
1881
1882
1883
1884
1885
1886
1887
1888
1889
1890
1891</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1877</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_set_sync(VALUE io, VALUE sync)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);
    if (RTEST(sync)) {
	fptr-&gt;mode |= FMODE_SYNC;
    }
    else {
	fptr-&gt;mode &amp;= ~FMODE_SYNC;
    }
    return sync;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="sysread-instance_method">
  <h3 class='signature'>
  #<strong>sysread</strong>(maxlen[, outbuf])  &#x21d2; <tt><a href="String.html" title="String (class)">String</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads <em>maxlen</em> bytes from <em>ios</em> using a low-level read and
returns them as a string.  Do not mix with other methods that read from
<em>ios</em> or you may get unpredictable results. If the optional
<em>outbuf</em> argument is present, it must reference a String, which will
receive the data. The <em>outbuf</em> will contain only the received data
after the method call even if it is not empty at the beginning. Raises
<a href="SystemCallError.html" title="SystemCallError (class)">SystemCallError</a> on error and <a href="EOFError.html" title="EOFError (class)">EOFError</a> at end of file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_sysread'>sysread</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span>   <span class='comment'>#=&gt; &quot;This is line one&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4724'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4724
4725
4726
4727
4728
4729
4730
4731
4732
4733
4734
4735
4736
4737
4738
4739
4740
4741
4742
4743
4744
4745
4746
4747
4748
4749
4750
4751
4752
4753
4754
4755
4756
4757
4758
4759
4760
4761
4762
4763
4764
4765
4766
4767
4768
4769
4770
4771
4772
4773
4774</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4724</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_sysread(int argc, VALUE *argv, VALUE io)
{
    VALUE len, str;
    rb_io_t *fptr;
    long n, ilen;
    struct read_internal_arg arg;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;len, &amp;str);
    ilen = NUM2LONG(len);

    io_setstrbuf(&amp;str,ilen);
    if (ilen == 0) return str;

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);

    if (READ_DATA_BUFFERED(fptr)) {
	rb_raise(rb_eIOError, &quot;sysread for buffered IO&quot;);
    }

    /*
     * FIXME: removing rb_thread_wait_fd() here changes sysread semantics
     * on non-blocking IOs.  However, it&#39;s still currently possible
     * for sysread to raise Errno::EAGAIN if another thread read()s
     * the IO after we return from rb_thread_wait_fd() but before
     * we call read()
     */
    rb_thread_wait_fd(fptr-&gt;fd);

    rb_io_check_closed(fptr);

    io_setstrbuf(&amp;str, ilen);
    rb_str_locktmp(str);
    arg.fd = fptr-&gt;fd;
    arg.str_ptr = RSTRING_PTR(str);
    arg.len = ilen;
    rb_ensure(read_internal_call, (VALUE)&amp;arg, rb_str_unlocktmp, str);
    n = arg.len;

    if (n == -1) {
	rb_sys_fail_path(fptr-&gt;pathv);
    }
    io_set_read_length(str, n);
    if (n == 0 &amp;&amp; ilen &gt; 0) {
	rb_eof_error();
    }
    OBJ_TAINT(str);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="sysseek-instance_method">
  <h3 class='signature'>
  #<strong>sysseek</strong>(offset, whence = IO.SEEK_SET)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Seeks to a given <em>offset</em> in the stream according to the value of
<em>whence</em> (see <a href="#seek-instance_method" title="IO#seek (method)">#seek</a> for values of <em>whence</em>). Returns the
new offset into the file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_sysseek'>sysseek</span><span class='lparen'>(</span><span class='op'>-</span><span class='int'>13</span><span class='comma'>,</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="#SEEK_END-constant" title="IO::SEEK_END (constant)">SEEK_END</a></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; 53
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_sysread'>sysread</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span>                  <span class='comment'>#=&gt; &quot;And so on.&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4639'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4639
4640
4641
4642
4643
4644
4645
4646
4647
4648
4649
4650
4651
4652
4653
4654
4655
4656
4657
4658
4659
4660
4661
4662
4663
4664</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4639</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_sysseek(int argc, VALUE *argv, VALUE io)
{
    VALUE offset, ptrname;
    int whence = SEEK_SET;
    rb_io_t *fptr;
    off_t pos;

    if (rb_scan_args(argc, argv, &quot;11&quot;, &amp;offset, &amp;ptrname) == 2) {
	whence = interpret_seek_whence(ptrname);
    }
    pos = NUM2OFFT(offset);
    GetOpenFile(io, fptr);
    if ((fptr-&gt;mode &amp; FMODE_READABLE) &amp;&amp;
        (READ_DATA_BUFFERED(fptr) || READ_CHAR_PENDING(fptr))) {
	rb_raise(rb_eIOError, &quot;sysseek for buffered IO&quot;);
    }
    if ((fptr-&gt;mode &amp; FMODE_WRITABLE) &amp;&amp; fptr-&gt;wbuf.len) {
	rb_warn(&quot;sysseek for buffered IO&quot;);
    }
    errno = 0;
    pos = lseek(fptr-&gt;fd, pos, whence);
    if (pos == -1 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);

    return OFFT2NUM(pos);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="syswrite-instance_method">
  <h3 class='signature'>
  #<strong>syswrite</strong>(string)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes the given string to <em>ios</em> using a low-level write. Returns
the number of bytes written. Do not mix with other methods that write to
<em>ios</em> or you may get unpredictable results. Raises <a href="SystemCallError.html" title="SystemCallError (class)">SystemCallError</a>
on error.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>out</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>w</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_syswrite'>syswrite</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ABCDEF</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; 6
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4679'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4679
4680
4681
4682
4683
4684
4685
4686
4687
4688
4689
4690
4691
4692
4693
4694
4695
4696
4697
4698
4699
4700
4701
4702
4703
4704</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4679</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_syswrite(VALUE io, VALUE str)
{
    rb_io_t *fptr;
    long n;

    if (!RB_TYPE_P(str, T_STRING))
	str = rb_obj_as_string(str);

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);
    rb_io_check_writable(fptr);

    str = rb_str_new_frozen(str);

    if (fptr-&gt;wbuf.len) {
	rb_warn(&quot;syswrite for buffered IO&quot;);
    }

    n = rb_write_internal(fptr-&gt;fd, RSTRING_PTR(str), RSTRING_LEN(str));
    RB_GC_GUARD(str);

    if (n == -1) rb_sys_fail_path(fptr-&gt;pathv);

    return LONG2FIX(n);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="tell-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>pos</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> </span>
    <span class='overload'>#<strong>tell</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#pos-instance_method" title="IO#pos (method)">#pos</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="to_i-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>fileno</strong>  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
    <span class='overload'>#<strong>to_i</strong>  &#x21d2; <tt><a href="Object.html#Fixnum-constant" title="Object::Fixnum (constant)">Fixnum</a></tt> </span>
  <span class='aliases'>Also known as: <span class='names'><span>fileno</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an integer representing the numeric file descriptor for
<em>ios</em>.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$stdin</span><span class='period'>.</span><span class='id identifier rubyid_fileno'>fileno</span>    <span class='comment'>#=&gt; 0
</span><span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_fileno'>fileno</span>   <span class='comment'>#=&gt; 1
</span></code></pre>


  </div>
</div>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1985'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1985
1986
1987
1988
1989
1990
1991
1992
1993
1994</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1985</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_fileno(VALUE io)
{
    rb_io_t *fptr = RFILE(io)-&gt;fptr;
    int fd;

    rb_io_check_closed(fptr);
    fd = fptr-&gt;fd;
    return INT2FIX(fd);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="to_io-instance_method">
  <h3 class='signature'>
  #<strong>to_io</strong>  &#x21d2; <tt><a href="" title="IO (class)">IO</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns <em>ios</em>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L2072'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2072
2073
2074
2075
2076</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 2072</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_to_io(VALUE io)
{
    return io;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="tty?-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>isatty</strong>  &#x21d2; <tt>Boolean</tt> </span>
    <span class='overload'>#<strong>tty?</strong>  &#x21d2; <tt>Boolean</tt> </span>
  <span class='aliases'>Also known as: <span class='names'><span>isatty</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns <code>true</code> if <em>ios</em> is associated with a terminal
device (tty), <code>false</code> otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_isatty'>isatty</span>   <span class='comment'>#=&gt; false
</span><span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/dev/tty</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_isatty'>isatty</span>   <span class='comment'>#=&gt; true
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L4000'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


4000
4001
4002
4003
4004
4005
4006
4007
4008
4009</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 4000</span></pre>
<pre class='code cpp'>

static VALUE
rb_io_isatty(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (isatty(fptr-&gt;fd) == 0)
	return Qfalse;
    return Qtrue;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="ungetbyte-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>ungetbyte</strong>(string)  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>ungetbyte</strong>(integer)  &#x21d2; <tt>nil</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Pushes back bytes (passed as a parameter) onto <em>ios</em>, such that a
subsequent buffered read will return it. Only one byte may be pushed back
before a subsequent read operation (that is, you will be able to read only
the last of several bytes that have been pushed back). Has no effect with
unbuffered reads (such as <a href="#sysread-instance_method" title="IO#sysread (method)">#sysread</a>).</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; #&lt;File:testfile&gt;
</span><span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getbyte'>getbyte</span>              <span class='comment'>#=&gt; 0x38
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_ungetbyte'>ungetbyte</span><span class='lparen'>(</span><span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>             <span class='comment'>#=&gt; nil
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getbyte'>getbyte</span>                  <span class='comment'>#=&gt; 0x38
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3908'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3908
3909
3910
3911
3912
3913
3914
3915
3916
3917
3918
3919
3920
3921
3922
3923
3924
3925</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3908</span></pre>
<pre class='code cpp'>

VALUE
rb_io_ungetbyte(VALUE io, VALUE b)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);
    if (NIL_P(b)) return Qnil;
    if (FIXNUM_P(b)) {
	char cc = FIX2INT(b);
	b = rb_str_new(&amp;cc, 1);
    }
    else {
	SafeStringValue(b);
    }
    io_ungetbyte(b, fptr);
    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="ungetc-instance_method">
  <h3 class='signature'>
  #<strong>ungetc</strong>(string)  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Pushes back one character (passed as a parameter) onto <em>ios</em>, such
that a subsequent buffered character read will return it. Only one
character may be pushed back before a subsequent read operation (that is,
you will be able to read only the last of several characters that have been
pushed back). Has no effect with unbuffered reads (such as <a href="#sysread-instance_method" title="IO#sysread (method)">#sysread</a>).</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="File.html#new-class_method" title="File.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='comment'>#=&gt; #&lt;File:testfile&gt;
</span><span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getc'>getc</span>                 <span class='comment'>#=&gt; &quot;8&quot;
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_ungetc'>ungetc</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span>                <span class='comment'>#=&gt; nil
</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_getc'>getc</span>                     <span class='comment'>#=&gt; &quot;8&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L3943'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3943
3944
3945
3946
3947
3948
3949
3950
3951
3952
3953
3954
3955
3956
3957
3958
3959
3960
3961
3962
3963
3964
3965
3966
3967
3968
3969
3970
3971
3972
3973
3974
3975
3976
3977
3978
3979
3980
3981
3982
3983
3984
3985
3986</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 3943</span></pre>
<pre class='code cpp'>

VALUE
rb_io_ungetc(VALUE io, VALUE c)
{
    rb_io_t *fptr;
    long len;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);
    if (NIL_P(c)) return Qnil;
    if (FIXNUM_P(c)) {
	c = rb_enc_uint_chr(FIX2UINT(c), io_read_encoding(fptr));
    }
    else if (RB_TYPE_P(c, T_BIGNUM)) {
	c = rb_enc_uint_chr(NUM2UINT(c), io_read_encoding(fptr));
    }
    else {
	SafeStringValue(c);
    }
    if (NEED_READCONV(fptr)) {
	SET_BINARY_MODE(fptr);
        len = RSTRING_LEN(c);
#if SIZEOF_LONG &gt; SIZEOF_INT
	if (len &gt; INT_MAX)
	    rb_raise(rb_eIOError, &quot;ungetc failed&quot;);
#endif
        make_readconv(fptr, (int)len);
        if (fptr-&gt;cbuf.capa - fptr-&gt;cbuf.len &lt; len)
            rb_raise(rb_eIOError, &quot;ungetc failed&quot;);
        if (fptr-&gt;cbuf.off &lt; len) {
            MEMMOVE(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.capa-fptr-&gt;cbuf.len,
                    fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
                    char, fptr-&gt;cbuf.len);
            fptr-&gt;cbuf.off = fptr-&gt;cbuf.capa-fptr-&gt;cbuf.len;
        }
        fptr-&gt;cbuf.off -= (int)len;
        fptr-&gt;cbuf.len += (int)len;
        MEMMOVE(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off, RSTRING_PTR(c), char, len);
    }
    else {
	NEED_NEWLINE_DECORATOR_ON_READ_CHECK(fptr);
        io_ungetbyte(c, fptr);
    }
    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="write-instance_method">
  <h3 class='signature'>
  #<strong>write</strong>(string)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes the given string to <em>ios</em>. The stream must be opened for
writing. If the argument is not a string, it will be converted to a string
using <code>to_s</code>. Returns the number of bytes written.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is a test\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>That was </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes of data</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p><em>produces:</em></p>

<pre class="code ruby"><code class="ruby">This is a test
That was 15 bytes of data</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/io.c#L1495'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1495
1496
1497
1498
1499</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'io.c', line 1495</span></pre>
<pre class='code cpp'>

static VALUE
io_write_m(VALUE io, VALUE str)
{
    return io_write(io, str, 0);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="write_nonblock-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>write_nonblock</strong>(string)  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> </span>
    <span class='overload'>#<strong>write_nonblock</strong>(string[, options])  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes the given string to <em>ios</em> using the write(2) system call
after O_NONBLOCK is set for the underlying file descriptor.</p>

<p>It returns the number of bytes written.</p>

<p>write_nonblock just calls the write(2) system call. It causes all errors
the write(2) system call causes: <code>Errno::EWOULDBLOCK</code>, <code>Errno::EINTR</code>, etc.
The result may also be smaller than string.length (partial write). The
caller should care such errors and partial write.</p>

<p>If the exception is <code>Errno::EWOULDBLOCK</code> or <code>Errno::EAGAIN</code>, it is extended
by <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a>. So <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a> can be used to rescue the
exceptions for retrying write_nonblock.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Creates a pipe.
</span><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_pipe'><a href="#pipe-class_method" title="IO.pipe (method)">pipe</a></span>

<span class='comment'># write_nonblock writes only 65536 bytes and return 65536.
</span><span class='comment'># (The pipe size is 65536 bytes on this environment.)
</span><span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span>  <span class='comment'>#100000
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_write_nonblock'>write_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span>     <span class='comment'>#=&gt; 65536
</span>
<span class='comment'># write_nonblock cannot write a byte and raise EWOULDBLOCK (EAGAIN).
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_write_nonblock'>write_nonblock</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>   <span class='comment'># Resource temporarily unavailable (Errno::EAGAIN)
</span></code></pre>

<p>If the write buffer is not empty, it is flushed at first.</p>

<p>When write_nonblock raises an exception kind of <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a>,
write_nonblock should not be called until io is writable for avoiding busy
loop. This can be done as follows.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>begin</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write_nonblock'>write_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'><a href="" title="IO (class)">IO</a></span><span class='op'>::</span><span class='const'><a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a></span><span class='comma'>,</span> <span class='const'><a href="Errno.html" title="Errno (module)">Errno</a></span><span class='op'>::</span><span class='const'>EINTR</span>
  <span class='const'><a href="" title="IO (class)">IO</a></span><span class='period'>.</span><span class='id identifier rubyid_select'><a href="#select-class_method" title="IO.select (method)">select</a></span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_io'>io</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>end</span>
</code></pre>

<p>Note that this doesn&#39;t guarantee to write all data in string. The
length written is reported as result and it should be checked later.</p>

<p>On some platforms such as Windows, write_nonblock is not supported
according to the kind of the IO object. In such cases, write_nonblock
raises <code>Errno::EBADF</code>.</p>

<p>By specifying <tt>exception: false</tt>, the options hash allows you to indicate
that write_nonblock should not raise an <a href="IO/WaitWritable.html" title="IO::WaitWritable (module)">WaitWritable</a> exception, but
return the symbol :wait_writable instead.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/prelude.rb#L131'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


131
132
133</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'prelude.rb', line 131</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_write_nonblock'>write_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_buf'>buf</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___write_nonblock'>__write_nonblock</span><span class='lparen'>(</span><span class='id identifier rubyid_buf'>buf</span><span class='comma'>,</span> <span class='id identifier rubyid_exception'>exception</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>