<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: GC &mdash; Core Ruby-2.4.0 d2016-07-27</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "GC",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='index.html'>Core</a> &raquo; 
          <a href='_index.html'>Index (G)</a> &raquo; 
          <span class='title'>GC</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: GC</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>

  <tr>
    <td class='box_1'>Child Modules:</td>
    <td>
      <a href="GC/Profiler.html" title="GC::Profiler (module)">Profiler</a>
    </td>
  </tr>




  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L9495'>gc.c</a></div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The GC module provides an interface to Ruby&#39;s mark and sweep garbage
collection mechanism.</p>

<p>Some of the underlying methods are also available via the ObjectSpace
module.</p>

<p>You may obtain information about the operation of the GC through
<a href="GC/Profiler.html" title="GC::Profiler (module)">Profiler</a>.</p>


  </div>
</div>
<div class="tags">
  
</div>
<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='INTERNAL_CONSTANTS-constant'>
      INTERNAL_CONSTANTS
    </dt>
    <dd>
          </dd>
    <dt id='OPTS-constant'>
      OPTS
    </dt>
    <dd>
          </dd>
  </dl>





<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#add_stress_to_class-class_method" title=".add_stress_to_class (class method)">.<strong>add_stress_to_class</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#count-class_method" title="count (class method)">.<strong>count</strong>  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The number of times GC occurred.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#disable-class_method" title="disable (class method)">.<strong>disable</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Disables garbage collection, returning <code>true</code> if garbage
collection was already disabled.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#enable-class_method" title="enable (class method)">.<strong>enable</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Enables garbage collection, returning <code>true</code> if garbage
collection was previously disabled.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#latest_gc_info-class_method" title="latest_gc_info (class method)">.<strong>latest_gc_info</strong>  &#x21d2; {:gc_by=&gt;:newobj} </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns information about the most recent garbage collection.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#malloc_allocated_size-class_method" title="malloc_allocated_size (class method)">.<strong>malloc_allocated_size</strong>  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the size of memory allocated by malloc().</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#malloc_allocations-class_method" title="malloc_allocations (class method)">.<strong>malloc_allocations</strong>  &#x21d2; Integer </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the number of malloc() allocations.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#remove_stress_to_class-class_method" title=".remove_stress_to_class (class method)">.<strong>remove_stress_to_class</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#start-class_method" title="#start (class method)">.<strong>start</strong>  &#x21d2; nil </a>
        (also: #garbage_collect)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Initiates garbage collection, unless manually disabled.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#stat-class_method" title="stat (class method)">.<strong>stat</strong>  &#x21d2; Hash </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a Hash containing information about the GC.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#stress-class_method" title="stress (class method)">.<strong>stress</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns current status of GC stress mode.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#stress%3D-class_method" title="stress= (class method)">.<strong>stress=</strong>(flag)  &#x21d2; flag </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Updates the GC stress mode.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#verify_internal_consistency-class_method" title="verify_internal_consistency (class method)">.<strong>verify_internal_consistency</strong>  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Verify internal consistency.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#garbage_collect-instance_method" title="#garbage_collect (instance method)">#<strong>garbage_collect</strong>  &#x21d2; nil </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#start-class_method" title="GC.start (method)">GC.start</a>.</p>
</div>
      </span>
    </li>
  </ul>


<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="add_stress_to_class-class_method">
  <h3 class='signature first'>
  .<strong>add_stress_to_class</strong>(*args)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L9393'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9393
9394
9395
9396
9397
9398
9399
9400
9401
9402
9403</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 9393</span>

static VALUE
rb_gcdebug_add_stress_to_class(int argc, VALUE *argv, VALUE self)
{
    rb_objspace_t *objspace = &amp;rb_objspace;

    if (!stress_to_class) {
	stress_to_class = rb_ary_tmp_new(argc);
    }
    rb_ary_cat(stress_to_class, argv, argc);
    return self;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="count-class_method">
  <h3 class='signature'>
  .<strong>count</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The number of times GC occurred.</p>

<p>It returns the number of times GC occurred since the process started.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L6656'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6656
6657
6658
6659
6660</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 6656</span>

static VALUE
gc_count(VALUE self)
{
    return SIZET2NUM(rb_gc_count());
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="disable-class_method">
  <h3 class='signature'>
  .<strong>disable</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Disables garbage collection, returning <code>true</code> if garbage
collection was already disabled.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="" title="GC (module)">GC</a></span><span class='period'>.</span><span class='id identifier rubyid_disable'>disable</span>   <span class='comment'>#=&gt; false
</span><span class='const'><a href="" title="GC (module)">GC</a></span><span class='period'>.</span><span class='id identifier rubyid_disable'>disable</span>   <span class='comment'>#=&gt; true
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L7263'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7263
7264
7265
7266
7267
7268
7269
7270
7271
7272
7273</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 7263</span>

VALUE
rb_gc_disable(void)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    int old = dont_gc;

    gc_rest(objspace);

    dont_gc = TRUE;
    return old ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="enable-class_method">
  <h3 class='signature'>
  .<strong>enable</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Enables garbage collection, returning <code>true</code> if garbage
collection was previously disabled.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="" title="GC (module)">GC</a></span><span class='period'>.</span><span class='id identifier rubyid_disable'><a href="#disable-class_method" title="GC.disable (method)">disable</a></span>   <span class='comment'>#=&gt; false
</span><span class='const'><a href="" title="GC (module)">GC</a></span><span class='period'>.</span><span class='id identifier rubyid_enable'>enable</span>    <span class='comment'>#=&gt; true
</span><span class='const'><a href="" title="GC (module)">GC</a></span><span class='period'>.</span><span class='id identifier rubyid_enable'>enable</span>    <span class='comment'>#=&gt; false
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L7241'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7241
7242
7243
7244
7245
7246
7247
7248
7249</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 7241</span>

VALUE
rb_gc_enable(void)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    int old = dont_gc;

    dont_gc = FALSE;
    return old ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="latest_gc_info-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>latest_gc_info</strong>  &#x21d2; <tt>{:gc_by=&gt;:newobj}</tt> </span>
    <span class='overload'>.<strong>latest_gc_info</strong>(hash)  &#x21d2; <tt><a href="Hash.html" title="Hash (class)">Hash</a></tt> </span>
    <span class='overload'>.<strong>latest_gc_info</strong>(:major_by)  &#x21d2; <tt>:malloc</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns information about the most recent garbage collection.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L6771'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6771
6772
6773
6774
6775
6776
6777
6778
6779
6780
6781
6782
6783
6784
6785
6786
6787
6788</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 6771</span>

static VALUE
gc_latest_gc_info(int argc, VALUE *argv, VALUE self)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    VALUE arg = Qnil;

    if (rb_scan_args(argc, argv, &quot;01&quot;, &amp;arg) == 1) {
	if (!SYMBOL_P(arg) &amp;&amp; !RB_TYPE_P(arg, T_HASH)) {
	    rb_raise(rb_eTypeError, &quot;non-hash or symbol given&quot;);
	}
    }

    if (arg == Qnil) {
	arg = rb_hash_new();
    }

    return gc_info_decode(objspace, arg, 0);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="malloc_allocated_size-class_method">
  <h3 class='signature'>
  .<strong>malloc_allocated_size</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the size of memory allocated by malloc().</p>

<p>Only available if ruby was built with <code>CALC_EXACT_MALLOC_SIZE</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L8051'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


8051
8052
8053
8054
8055</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 8051</span>

static VALUE
gc_malloc_allocated_size(VALUE self)
{
    return UINT2NUM(rb_objspace.malloc_params.allocated_size);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="malloc_allocations-class_method">
  <h3 class='signature'>
  .<strong>malloc_allocations</strong>  &#x21d2; <tt><a href="Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the number of malloc() allocations.</p>

<p>Only available if ruby was built with <code>CALC_EXACT_MALLOC_SIZE</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L8066'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


8066
8067
8068
8069
8070</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 8066</span>

static VALUE
gc_malloc_allocations(VALUE self)
{
    return UINT2NUM(rb_objspace.malloc_params.allocations);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="remove_stress_to_class-class_method">
  <h3 class='signature'>
  .<strong>remove_stress_to_class</strong>(*args)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L9405'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9405
9406
9407
9408
9409
9410
9411
9412
9413
9414
9415
9416
9417
9418
9419
9420</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 9405</span>

static VALUE
rb_gcdebug_remove_stress_to_class(int argc, VALUE *argv, VALUE self)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    int i;

    if (stress_to_class) {
	for (i = 0; i &lt; argc; ++i) {
	    rb_ary_delete_same(stress_to_class, argv[i]);
	}
	if (RARRAY_LEN(stress_to_class) == 0) {
	    stress_to_class = 0;
	}
    }
    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="start-class_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>start</strong>  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>garbage_collect</strong>  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>start</strong>(full_mark:true, immediate_sweep:true)  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>garbage_collect</strong>(full_mark:true, immediate_sweep:true)  &#x21d2; <tt>nil</tt> </span>
  <span class='aliases'>Also known as: <span class='names'><span>garbage_collect</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Initiates garbage collection, unless manually disabled.</p>

<p>This method is defined with keyword arguments that default to true:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='const'><a href="" title="GC (module)">GC</a></span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span><span class='lparen'>(</span><span class='label'>full_mark:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>immediate_sweep:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='semicolon'>;</span> <span class='kw'>end</span>
</code></pre>

<p>Use full_mark: false to perform a minor GC. Use immediate_sweep: false to
defer sweeping (use lazy sweep).</p>

<p>Note: These keyword arguments are implementation and version dependent.
They are not guaranteed to be future-compatible, and may be ignored if the
underlying implementation does not support them.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L6569'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


6569
6570
6571
6572
6573
6574
6575
6576
6577
6578
6579
6580
6581
6582
6583
6584
6585
6586
6587
6588
6589
6590
6591
6592
6593
6594
6595
6596
6597
6598
6599</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 6569</span>

static VALUE
gc_start_internal(int argc, VALUE *argv, VALUE self)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    int full_mark = TRUE, immediate_mark = TRUE, immediate_sweep = TRUE;
    VALUE opt = Qnil;
    static ID keyword_ids[3];

    rb_scan_args(argc, argv, &quot;0:&quot;, &amp;opt);

    if (!NIL_P(opt)) {
	VALUE kwvals[3];

	if (!keyword_ids[0]) {
	    keyword_ids[0] = rb_intern(&quot;full_mark&quot;);
	    keyword_ids[1] = rb_intern(&quot;immediate_mark&quot;);
	    keyword_ids[2] = rb_intern(&quot;immediate_sweep&quot;);
	}

	rb_get_kwargs(opt, keyword_ids, 0, 3, kwvals);

	if (kwvals[0] != Qundef) full_mark = RTEST(kwvals[0]);
	if (kwvals[1] != Qundef) immediate_mark = RTEST(kwvals[1]);
	if (kwvals[2] != Qundef) immediate_sweep = RTEST(kwvals[2]);
    }

    garbage_collect(objspace, full_mark, immediate_mark, immediate_sweep, GPR_FLAG_METHOD);
    gc_finalize_deferred(objspace);

    return Qnil;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="stat-class_method">
  <h3 class='signature'>
  <span class='overload'>.<strong>stat</strong>  &#x21d2; <tt><a href="Hash.html" title="Hash (class)">Hash</a></tt> </span>
    <span class='overload'>.<strong>stat</strong>(hash)  &#x21d2; <tt><a href="Hash.html" title="Hash (class)">Hash</a></tt> </span>
    <span class='overload'>.<strong>stat</strong>(:key)  &#x21d2; <tt><a href="Numeric.html" title="Numeric (class)">Numeric</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a Hash containing information about the GC.</p>

<p>The hash includes information about internal statistics about GC such as:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
    <span class='symbol'>:count</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:heap_allocated_pages</span><span class='op'>=&gt;</span><span class='int'>24</span><span class='comma'>,</span>
    <span class='symbol'>:heap_sorted_length</span><span class='op'>=&gt;</span><span class='int'>24</span><span class='comma'>,</span>
    <span class='symbol'>:heap_allocatable_pages</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:heap_available_slots</span><span class='op'>=&gt;</span><span class='int'>9783</span><span class='comma'>,</span>
    <span class='symbol'>:heap_live_slots</span><span class='op'>=&gt;</span><span class='int'>7713</span><span class='comma'>,</span>
    <span class='symbol'>:heap_free_slots</span><span class='op'>=&gt;</span><span class='int'>2070</span><span class='comma'>,</span>
    <span class='symbol'>:heap_final_slots</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:heap_marked_slots</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:heap_eden_pages</span><span class='op'>=&gt;</span><span class='int'>24</span><span class='comma'>,</span>
    <span class='symbol'>:heap_tomb_pages</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:total_allocated_pages</span><span class='op'>=&gt;</span><span class='int'>24</span><span class='comma'>,</span>
    <span class='symbol'>:total_freed_pages</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:total_allocated_objects</span><span class='op'>=&gt;</span><span class='int'>7796</span><span class='comma'>,</span>
    <span class='symbol'>:total_freed_objects</span><span class='op'>=&gt;</span><span class='int'>83</span><span class='comma'>,</span>
    <span class='symbol'>:malloc_increase_bytes</span><span class='op'>=&gt;</span><span class='int'>2389312</span><span class='comma'>,</span>
    <span class='symbol'>:malloc_increase_bytes_limit</span><span class='op'>=&gt;</span><span class='int'>16777216</span><span class='comma'>,</span>
    <span class='symbol'>:minor_gc_count</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:major_gc_count</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:remembered_wb_unprotected_objects</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:remembered_wb_unprotected_objects_limit</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:old_objects</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:old_objects_limit</span><span class='op'>=&gt;</span><span class='int'>0</span><span class='comma'>,</span>
    <span class='symbol'>:oldmalloc_increase_bytes</span><span class='op'>=&gt;</span><span class='int'>2389760</span><span class='comma'>,</span>
    <span class='symbol'>:oldmalloc_increase_bytes_limit</span><span class='op'>=&gt;</span><span class='int'>16777216</span>
<span class='rbrace'>}</span>
</code></pre>

<p>The contents of the hash are implementation specific and may be changed in
the future.</p>

<p>This method is only expected to work on C Ruby.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L7147'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7147
7148
7149
7150
7151
7152
7153
7154
7155
7156
7157
7158
7159
7160
7161
7162
7163
7164
7165
7166
7167</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 7147</span>

static VALUE
gc_stat(int argc, VALUE *argv, VALUE self)
{
    VALUE arg = Qnil;

    if (rb_scan_args(argc, argv, &quot;01&quot;, &amp;arg) == 1) {
	if (SYMBOL_P(arg)) {
	    size_t value = gc_stat_internal(arg);
	    return SIZET2NUM(value);
	}
	else if (!RB_TYPE_P(arg, T_HASH)) {
	    rb_raise(rb_eTypeError, &quot;non-hash or symbol given&quot;);
	}
    }

    if (arg == Qnil) {
        arg = rb_hash_new();
    }
    gc_stat_internal(arg);
    return arg;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="stress-class_method">
  <h3 class='signature'>
  .<strong>stress</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns current status of GC stress mode.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L7189'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7189
7190
7191
7192
7193
7194</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 7189</span>

static VALUE
gc_stress_get(VALUE self)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    return ruby_gc_stress_mode;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="stress=-class_method">
  <h3 class='signature'>
  .<strong>stress=</strong>(flag)  &#x21d2; <tt>flag</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Updates the GC stress mode.</p>

<p>When stress mode is enabled, the GC is invoked at every GC opportunity: all
memory and object allocations.</p>

<p>Enabling stress mode will degrade performance, it is only for debugging.</p>

<p>flag can be true, false, or a fixnum bit-ORed following flags.</p>

<pre class="code ruby"><code class="ruby"><span class='int'>0x01</span><span class='op'>::</span> <span class='id identifier rubyid_no'>no</span> <span class='id identifier rubyid_major'>major</span> <span class='const'><a href="" title="GC (module)">GC</a></span>
<span class='int'>0x02</span><span class='op'>::</span> <span class='id identifier rubyid_no'>no</span> <span class='id identifier rubyid_immediate'>immediate</span> <span class='id identifier rubyid_sweep'>sweep</span>
<span class='int'>0x04</span><span class='op'>::</span> <span class='id identifier rubyid_full'>full</span> <span class='id identifier rubyid_mark'>mark</span> <span class='id identifier rubyid_after'>after</span> <span class='id identifier rubyid_malloc'>malloc</span><span class='op'>/</span><span class='id identifier rubyid_calloc'>calloc</span><span class='op'>/</span><span class='id identifier rubyid_realloc'>realloc</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L7220'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


7220
7221
7222
7223
7224
7225
7226</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 7220</span>

static VALUE
gc_stress_set_m(VALUE self, VALUE flag)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    gc_stress_set(objspace, flag);
    return flag;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="verify_internal_consistency-class_method">
  <h3 class='signature'>
  .<strong>verify_internal_consistency</strong>  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Verify internal consistency.</p>

<p>This method is implementation specific. Now this method checks generational
consistency if RGenGC is supported.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/gc.c#L5174'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


5174
5175
5176
5177
5178
5179
5180
5181
5182
5183
5184
5185
5186
5187
5188
5189
5190
5191
5192
5193
5194
5195
5196
5197
5198
5199
5200
5201
5202
5203
5204
5205
5206
5207
5208
5209
5210
5211
5212
5213
5214
5215
5216
5217
5218
5219
5220
5221
5222
5223
5224
5225
5226
5227
5228
5229
5230
5231
5232
5233
5234
5235
5236
5237
5238
5239
5240
5241
5242
5243
5244
5245
5246
5247
5248
5249
5250</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'gc.c', line 5174</span>

static VALUE
gc_verify_internal_consistency(VALUE dummy)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    struct verify_internal_consistency_struct data = {0};
    struct each_obj_args eo_args;

    data.objspace = objspace;
    gc_report(5, objspace, &quot;gc_verify_internal_consistency: start\n&quot;);

    /* check relations */

    eo_args.callback = verify_internal_consistency_i;
    eo_args.data = (void *)&amp;data;
    objspace_each_objects((VALUE)&amp;eo_args);

    if (data.err_count != 0) {
#if RGENGC_CHECK_MODE &gt;= 5
	objspace-&gt;rgengc.error_count = data.err_count;
	gc_marks_check(objspace, NULL, NULL);
	allrefs_dump(objspace);
#endif
	rb_bug(&quot;gc_verify_internal_consistency: found internal inconsistency.&quot;);
    }

    /* check heap_page status */
    gc_verify_heap_pages(objspace);

    /* check counters */

    if (!is_lazy_sweeping(heap_eden) &amp;&amp; !finalizing) {
	if (objspace_live_slots(objspace) != data.live_object_count) {
	    fprintf(stderr, &quot;heap_pages_final_slots: %d, objspace-&gt;profile.total_freed_objects: %d\n&quot;,
		    (int)heap_pages_final_slots, (int)objspace-&gt;profile.total_freed_objects);
	    rb_bug(&quot;inconsistent live slot nubmer: expect %&quot;PRIuSIZE&quot;, but %&quot;PRIuSIZE&quot;.&quot;, objspace_live_slots(objspace), data.live_object_count);
	}
    }

#if USE_RGENGC
    if (!is_marking(objspace)) {
	if (objspace-&gt;rgengc.old_objects != data.old_object_count) {
	    rb_bug(&quot;inconsistent old slot nubmer: expect %&quot;PRIuSIZE&quot;, but %&quot;PRIuSIZE&quot;.&quot;, objspace-&gt;rgengc.old_objects, data.old_object_count);
	}
	if (objspace-&gt;rgengc.uncollectible_wb_unprotected_objects != data.remembered_shady_count) {
	    rb_bug(&quot;inconsistent old slot nubmer: expect %&quot;PRIuSIZE&quot;, but %&quot;PRIuSIZE&quot;.&quot;, objspace-&gt;rgengc.uncollectible_wb_unprotected_objects, data.remembered_shady_count);
	}
    }
#endif

    if (!finalizing) {
	size_t list_count = 0;

	{
	    VALUE z = heap_pages_deferred_final;
	    while (z) {
		list_count++;
		z = RZOMBIE(z)-&gt;next;
	    }
	}

	if (heap_pages_final_slots != data.zombie_object_count ||
	    heap_pages_final_slots != list_count) {

	    rb_bug(&quot;inconsistent finalizing object count:\n&quot;
		   &quot;  expect %&quot;PRIuSIZE&quot;\n&quot;
		   &quot;  but    %&quot;PRIuSIZE&quot; zombies\n&quot;
		   &quot;  heap_pages_deferred_final list has %&quot;PRIuSIZE&quot; items.&quot;,
		   heap_pages_final_slots,
		   data.zombie_object_count,
		   list_count);
	}
    }

    gc_report(5, objspace, &quot;gc_verify_internal_consistency: OK\n&quot;);

    return Qnil;
}
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="garbage_collect-instance_method">
  <h3 class='signature first'>
  <span class='overload'>#<strong>start</strong>  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>garbage_collect</strong>  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>start</strong>(full_mark:true, immediate_sweep:true)  &#x21d2; <tt>nil</tt> </span>
    <span class='overload'>#<strong>garbage_collect</strong>(full_mark:true, immediate_sweep:true)  &#x21d2; <tt>nil</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#start-class_method" title="GC.start (method)">start</a>.</p>


  </div>
</div>

</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>