<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: RDoc::Servlet &mdash; rdoc Ruby-2.4.0 d2016-08-01</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "RDoc::Servlet",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='../index.html'>rdoc</a> &raquo; 
          <a href='../_index.html'>Index (S)</a> &raquo; 
          <a href="../RDoc.html" title="RDoc (module)">RDoc</a> &raquo; 
          <span class='title'>Servlet</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: RDoc::Servlet</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'>WEBrick::HTTPServlet::AbstractServlet</span>
      <ul class='fullTree'>
        <li>Object</li>
        <li class='next'>WEBrick::HTTPServlet::AbstractServlet</li>
        <li class='next'>RDoc::Servlet</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>





  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L28'>lib/rdoc/servlet.rb</a></div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This is a WEBrick servlet that allows you to browse ri documentation.</p>

<p>You can show documentation through either `ri â€“server` or, with RubyGems
2.0 or newer, `gem server`.  For ri, the server runs on port 8214 by
default.  For RubyGems the server runs on port 8808 by default.</p>

<p>You can use this servlet in your own project by mounting it on a WEBrick
server:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>webrick</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_server'>server</span> <span class='op'>=</span> <span class='const'>WEBrick</span><span class='op'>::</span><span class='const'>HTTPServer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='label'>Port:</span> <span class='int'>8000</span>

<span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_mount'>mount</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Servlet</span>
</code></pre>

<p>If you want to mount the servlet some other place than the root, provide
the base path when mounting:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_mount'>mount</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rdoc</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Servlet</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rdoc</span><span class='tstring_end'>&#39;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>


<h2>Instance Attribute Summary <small><a href='#' class='summary_toggle'>collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#asset_dirs-instance_method" title="#asset_dirs (instance method)">#<strong>asset_dirs</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Maps an asset type to its path on the filesystem</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>An <a href="Options.html" title="RDoc::Options (class)">Options</a> instance used for rendering options</p>
</div>
      </span>
    </li>
  </ul>


<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#get_instance-class_method" title=".get_instance (class method)">.<strong>get_instance</strong>(server, *options)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates an instance of this servlet that shares cached data between
requests.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(server, stores, cache, mount_path = nil, extra_doc_dirs = [])  &#x21d2; Servlet </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a new WEBrick servlet.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#asset-instance_method" title="#asset (instance method)">#<strong>asset</strong>(generator_name, req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Serves the asset at the path in <code>req</code> for
<code>generator_name</code> via <code>res</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#do_GET-instance_method" title="#do_GET (instance method)">#<strong>do_GET</strong>(req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>GET request entry point.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#documentation_page-instance_method" title="#documentation_page (instance method)">#<strong>documentation_page</strong>(store, generator, path, req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Fills in <code>res</code> with the class, module or page for
<code>req</code> from <code>store</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#documentation_search-instance_method" title="#documentation_search (instance method)">#<strong>documentation_search</strong>(store, generator, req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates the JSON search index on <code>res</code> for the given
<code>store</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#documentation_source-instance_method" title="#documentation_source (instance method)">#<strong>documentation_source</strong>(path)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the <a href="Store.html" title="RDoc::Store (class)">Store</a> and path relative to <code>mount_path</code> for
documentation at <code>path</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#error-instance_method" title="#error (instance method)">#<strong>error</strong>(exception, req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Generates an error page for the <code>exception</code> while handling
<code>req</code> on <code>res</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#generator_for-instance_method" title="#generator_for (instance method)">#<strong>generator_for</strong>(store)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Instantiates a Darkfish generator for <code>store</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#if_modified_since-instance_method" title="#if_modified_since (instance method)">#<strong>if_modified_since</strong>(req, res, path = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Handles the If-Modified-Since HTTP header on <code>req</code> for
<code>path</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#installed_docs-instance_method" title="#installed_docs (instance method)">#<strong>installed_docs</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an Array of installed documentation.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#not_found-instance_method" title="#not_found (instance method)">#<strong>not_found</strong>(generator, req, res, message = nil)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a 404 page built by <code>generator</code> for <code>req</code> on
<code>res</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ri_paths-instance_method" title="#ri_paths (instance method)">#<strong>ri_paths</strong>(&amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Enumerates the ri paths.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#root-instance_method" title="#root (instance method)">#<strong>root</strong>(req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Generates the root page on <code>res</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#root_search-instance_method" title="#root_search (instance method)">#<strong>root_search</strong>(req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Generates a search index for the root page on <code>res</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#show_documentation-instance_method" title="#show_documentation (instance method)">#<strong>show_documentation</strong>(req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Displays documentation for <code>req</code> on <code>res</code>, whether
that be HTML or some asset.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#store_for-instance_method" title="#store_for (instance method)">#<strong>store_for</strong>(source_name)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns an <a href="Store.html" title="RDoc::Store (class)">Store</a> for the given <code>source_name</code>
(&#39;ruby&#39; or a gem name).</p>
</div>
      </span>
    </li>
  </ul>



  <h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(server, stores, cache, mount_path = nil, extra_doc_dirs = [])  &#x21d2; <tt><a href="" title="RDoc::Servlet (class)">Servlet</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a new WEBrick servlet.</p>

<p>Use <code>mount_path</code> when mounting the servlet somewhere other than
/.</p>

<p>Use <code>extra_doc_dirs</code> for additional documentation directories.</p>

<p><code>server</code> is provided automatically by WEBrick when mounting. 
<code>stores</code> and <code>cache</code> are provided automatically by
the servlet.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L63'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 63</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_stores'>stores</span><span class='comma'>,</span> <span class='id identifier rubyid_cache'>cache</span><span class='comma'>,</span> <span class='id identifier rubyid_mount_path'>mount_path</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_extra_doc_dirs'>extra_doc_dirs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>super</span> <span class='id identifier rubyid_server'>server</span>

  <span class='ivar'>@cache</span>      <span class='op'>=</span> <span class='id identifier rubyid_cache'>cache</span>
  <span class='ivar'>@mount_path</span> <span class='op'>=</span> <span class='id identifier rubyid_mount_path'>mount_path</span>
  <span class='ivar'>@extra_doc_dirs</span> <span class='op'>=</span> <span class='id identifier rubyid_extra_doc_dirs'>extra_doc_dirs</span>
  <span class='ivar'>@stores</span>     <span class='op'>=</span> <span class='id identifier rubyid_stores'>stores</span>

  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@options</span><span class='period'>.</span><span class='id identifier rubyid_op_dir'>op_dir</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_darkfish_dir'>darkfish_dir</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='comment'># HACK dup
</span>  <span class='gvar'>$LOAD_PATH</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
    <span class='id identifier rubyid_darkfish_dir'>darkfish_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rdoc/generator/template/darkfish/</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span> <span class='id identifier rubyid_darkfish_dir'>darkfish_dir</span>
    <span class='ivar'>@options</span><span class='period'>.</span><span class='id identifier rubyid_template_dir'>template_dir</span> <span class='op'>=</span> <span class='id identifier rubyid_darkfish_dir'>darkfish_dir</span>
    <span class='kw'>break</span>
  <span class='kw'>end</span>

  <span class='ivar'>@asset_dirs</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:darkfish</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_darkfish_dir'>darkfish_dir</span><span class='comma'>,</span>
    <span class='symbol'>:json_index</span> <span class='op'>=&gt;</span>
      <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>../generator/template/json_index/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="asset_dirs-instance_method">
  <h3 class='signature first'>
  #<strong>asset_dirs</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Maps an asset type to its path on the filesystem</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L36'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


36</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 36</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:asset_dirs</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="options-instance_method">
  <h3 class='signature'>
  #<strong>options</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>An <a href="Options.html" title="RDoc::Options (class)">Options</a> instance used for rendering options</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L41'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


41</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 41</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:options</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="get_instance-class_method">
  <h3 class='signature first'>
  .<strong>get_instance</strong>(server, *options)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates an instance of this servlet that shares cached data between
requests.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L47'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


47
48
49
50
51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 47</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_instance'>get_instance</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_options'>options</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_stores'>stores</span> <span class='op'>=</span> <span class='ivar'>@server_stores</span><span class='lbracket'>[</span><span class='id identifier rubyid_server'>server</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_stores'>stores</span><span class='comma'>,</span> <span class='ivar'>@cache</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_options'>options</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="asset-instance_method">
  <h3 class='signature first'>
  #<strong>asset</strong>(generator_name, req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Serves the asset at the path in <code>req</code> for
<code>generator_name</code> via <code>res</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L94'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


94
95
96
97
98
99
100
101
102
103
104
105
106
107
108</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 94</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_asset'>asset</span> <span class='id identifier rubyid_generator_name'>generator_name</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_asset_dir'>asset_dir</span> <span class='op'>=</span> <span class='ivar'>@asset_dirs</span><span class='lbracket'>[</span><span class='id identifier rubyid_generator_name'>generator_name</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_asset_path'>asset_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='id identifier rubyid_asset_dir'>asset_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>

  <span class='id identifier rubyid_if_modified_since'>if_modified_since</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='id identifier rubyid_asset_path'>asset_path</span>

  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='id identifier rubyid_asset_path'>asset_path</span>

  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
                     <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>css$</span><span class='regexp_end'>/</span></span> <span class='kw'>then</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text/css</span><span class='tstring_end'>&#39;</span></span>
                     <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>js$</span><span class='regexp_end'>/</span></span>  <span class='kw'>then</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/javascript</span><span class='tstring_end'>&#39;</span></span>
                     <span class='kw'>else</span>             <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/octet-stream</span><span class='tstring_end'>&#39;</span></span>
                     <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="do_GET-instance_method">
  <h3 class='signature'>
  #<strong>do_GET</strong>(req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>GET request entry point.  Fills in <code>res</code> for the path, etc. in
<code>req</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L113'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 113</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_do_GET'>do_GET</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='ivar'>@mount_path</span><span class='embexpr_end'>}</span><span class='regexp_end'>/o</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@mount_path</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_root'><a href="../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rdoc.css</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/js/darkfish.js</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/js/jquery.js</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/js/search.js</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
       <span class='tstring'><span class='regexp_beg'>%r%</span><span class='tstring_content'>^/images/</span><span class='regexp_end'>%</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_asset'>asset</span> <span class='symbol'>:darkfish</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/js/navigation.js</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/js/searcher.js</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_asset'>asset</span> <span class='symbol'>:json_index</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/js/search_index.js</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_root_search'>root_search</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_show_documentation'>show_documentation</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>WEBrick</span><span class='op'>::</span><span class='const'>HTTPStatus</span><span class='op'>::</span><span class='const'>NotFound</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_generator'>generator</span> <span class='op'>=</span> <span class='id identifier rubyid_generator_for'>generator_for</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_not_found'>not_found</span> <span class='id identifier rubyid_generator'>generator</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
<span class='kw'>rescue</span> <span class='const'>WEBrick</span><span class='op'>::</span><span class='const'>HTTPStatus</span><span class='op'>::</span><span class='const'>Status</span>
  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="documentation_page-instance_method">
  <h3 class='signature'>
  #<strong>documentation_page</strong>(store, generator, path, req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Fills in <code>res</code> with the class, module or page for
<code>req</code> from <code>store</code>.</p>

<p><code>path</code> is relative to the mount_path and is used to determine
the class, module or page name (/RDoc/Servlet.html becomes RDoc::Servlet).
<code>generator</code> is used to create the page.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L146'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


146
147
148
149
150
151
152
153
154
155
156</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 146</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_documentation_page'>documentation_page</span> <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='id identifier rubyid_generator'>generator</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.html$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>::</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_find_class_or_module'>find_class_or_module</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_generate_class'>generate_class</span> <span class='id identifier rubyid_klass'>klass</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_find_text_page'>find_text_page</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>_([^_]*)$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.\1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_generate_page'>generate_page</span> <span class='id identifier rubyid_page'>page</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_not_found'>not_found</span> <span class='id identifier rubyid_generator'>generator</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="documentation_search-instance_method">
  <h3 class='signature'>
  #<strong>documentation_search</strong>(store, generator, req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates the JSON search index on <code>res</code> for the given
<code>store</code>.  <code>generator</code> must respond to #json_index to
build.  <code>req</code> is ignored.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L162'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


162
163
164
165
166
167
168
169
170</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 162</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_documentation_search'>documentation_search</span> <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='id identifier rubyid_generator'>generator</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_json_index'>json_index</span> <span class='op'>=</span> <span class='ivar'>@cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_store'>store</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span> <span class='symbol'>:json_index</span> <span class='kw'>do</span>
    <span class='ivar'>@cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_store'>store</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:json_index</span><span class='rbracket'>]</span> <span class='op'>=</span>
      <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span> <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_json_index'>json_index</span><span class='period'>.</span><span class='id identifier rubyid_build_index'>build_index</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/javascript</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>var search_data = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_json_index'>json_index</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="documentation_source-instance_method">
  <h3 class='signature'>
  #<strong>documentation_source</strong>(path)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the <a href="Store.html" title="RDoc::Store (class)">RDoc::Store</a> and path relative to <code>mount_path</code> for
documentation at <code>path</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L176'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


176
177
178
179
180
181
182
183
184
185
186
187
188
189</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 176</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_documentation_source'>documentation_source</span> <span class='id identifier rubyid_path'>path</span>
  <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_source_name'>source_name</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>3</span>

  <span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='ivar'>@stores</span><span class='lbracket'>[</span><span class='id identifier rubyid_source_name'>source_name</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span> <span class='kw'>if</span> <span class='id identifier rubyid_store'>store</span>

  <span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='id identifier rubyid_store_for'>store_for</span> <span class='id identifier rubyid_source_name'>source_name</span>

  <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_load_all'>load_all</span>

  <span class='ivar'>@stores</span><span class='lbracket'>[</span><span class='id identifier rubyid_source_name'>source_name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="error-instance_method">
  <h3 class='signature'>
  #<strong>error</strong>(exception, req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Generates an error page for the <code>exception</code> while handling
<code>req</code> on <code>res</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L194'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 194</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_exception'>exception</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_backtrace'>backtrace</span> <span class='op'>=</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text/html</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>500</span>
  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;-BODY</span>
<span class='tstring_content'>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta content=&quot;text/html; charset=UTF-8&quot; http-equiv=&quot;Content-Type&quot;&gt;

&lt;title&gt;Error - </span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_html_escape'>html_escape</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/title&gt;

&lt;link type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@mount_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>/rdoc.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Error&lt;/h1&gt;

&lt;p&gt;While processing &lt;code&gt;</span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_html_escape'>html_escape</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_request_uri'>request_uri</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/code&gt; the
RDoc (</span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_html_escape'>html_escape</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>VERSION</span><span class='embexpr_end'>}</span><span class='tstring_content'>) server has encountered a
&lt;code&gt;</span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_html_escape'>html_escape</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/code&gt;
exception:

&lt;pre&gt;</span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_html_escape'>html_escape</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/pre&gt;

&lt;p&gt;Please report this to the
&lt;a href=&quot;https://github.com/rdoc/rdoc/issues&quot;&gt;RDoc issues tracker&lt;/a&gt;.  Please
include the RDoc version, the URI above and exception class, message and
backtrace.  If you&#39;re viewing a gem&#39;s documentation, include the gem name and
version.  If you&#39;re viewing Ruby&#39;s documentation, include the version of ruby.

&lt;p&gt;Backtrace:

&lt;pre&gt;</span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_html_escape'>html_escape</span> <span class='id identifier rubyid_backtrace'>backtrace</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/pre&gt;

&lt;/body&gt;
&lt;/html&gt;
</span><span class='heredoc_end'>  BODY
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="generator_for-instance_method">
  <h3 class='signature'>
  #<strong>generator_for</strong>(store)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Instantiates a Darkfish generator for <code>store</code></p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L237'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 237</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_generator_for'>generator_for</span> <span class='id identifier rubyid_store'>store</span>
  <span class='id identifier rubyid_generator'>generator</span> <span class='op'>=</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Generator</span><span class='op'>::</span><span class='const'>Darkfish</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='ivar'>@options</span>
  <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_file_output'>file_output</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_asset_rel_path'>asset_rel_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_rdoc'>rdoc</span> <span class='op'>=</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>RDoc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_rdoc'>rdoc</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span>     <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span>
  <span class='id identifier rubyid_rdoc'>rdoc</span><span class='period'>.</span><span class='id identifier rubyid_generator'>generator</span> <span class='op'>=</span> <span class='id identifier rubyid_generator'>generator</span>
  <span class='id identifier rubyid_rdoc'>rdoc</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span>   <span class='op'>=</span> <span class='ivar'>@options</span>

  <span class='ivar'>@options</span><span class='period'>.</span><span class='id identifier rubyid_main_page'>main_page</span> <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_main'>main</span>
  <span class='ivar'>@options</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span>     <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span>

  <span class='id identifier rubyid_generator'>generator</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="if_modified_since-instance_method">
  <h3 class='signature'>
  #<strong>if_modified_since</strong>(req, res, path = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Handles the If-Modified-Since HTTP header on <code>req</code> for
<code>path</code>.  If the file has not been modified a Not Modified
response is returned.  If the file has been modified a Last-Modified header
is added to <code>res</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L258'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


258
259
260
261
262
263
264
265
266
267
268
269
270
271</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 258</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_if_modified_since'>if_modified_since</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_last_modified'>last_modified</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_stat'>stat</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_mtime'>mtime</span> <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span>

  <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>last-modified</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_last_modified'>last_modified</span><span class='period'>.</span><span class='id identifier rubyid_httpdate'>httpdate</span>

  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ims'>ims</span> <span class='op'>=</span> <span class='id identifier rubyid_req'>req</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>if-modified-since</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_ims'>ims</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span> <span class='id identifier rubyid_ims'>ims</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_ims'>ims</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_last_modified'>last_modified</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>WEBrick</span><span class='op'>::</span><span class='const'>HTTPStatus</span><span class='op'>::</span><span class='const'>NotModified</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="installed_docs-instance_method">
  <h3 class='signature'>
  #<strong>installed_docs</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an Array of installed documentation.</p>

<p>Each entry contains the documentation name (gem name, &#39;Ruby
Documentation&#39;, etc.), the path relative to the mount point, whether
the documentation exists, the type of documentation (See
<a href="RI.html" title="RDoc::RI (module)">RI</a>::Paths#each) and the filesystem to the <a href="Store.html" title="RDoc::Store (class)">RDoc::Store</a> for the
documentation.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L281'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 281</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_installed_docs'>installed_docs</span>
  <span class='id identifier rubyid_extra_counter'>extra_counter</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_ri_paths'>ri_paths</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='op'>|</span>
    <span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span>
    <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_cache_path'>cache_path</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
    <span class='kw'>when</span> <span class='symbol'>:gem</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_gem_path'>gem_path</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span><span class='lbracket'>[</span><span class='tstring'><span class='regexp_beg'>%r%</span><span class='tstring_content'>/([^/]*)/ri$</span><span class='regexp_end'>%</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span>
      <span class='lbracket'>[</span><span class='id identifier rubyid_gem_path'>gem_path</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_path'>gem_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_exists'>exists</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='symbol'>:system</span> <span class='kw'>then</span>
      <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Ruby Documentation</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_exists'>exists</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='symbol'>:site</span> <span class='kw'>then</span>
      <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Site Documentation</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>site/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_exists'>exists</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='symbol'>:home</span> <span class='kw'>then</span>
      <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Home Documentation</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>home/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_exists'>exists</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='symbol'>:extra</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_extra_counter'>extra_counter</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_load_cache'>load_cache</span> <span class='kw'>if</span> <span class='id identifier rubyid_exists'>exists</span>
      <span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Extra Documentation</span><span class='tstring_end'>&quot;</span></span>
      <span class='lbracket'>[</span><span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>extra-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_extra_counter'>extra_counter</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_exists'>exists</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="not_found-instance_method">
  <h3 class='signature'>
  #<strong>not_found</strong>(generator, req, res, message = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a 404 page built by <code>generator</code> for <code>req</code> on
<code>res</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L309'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


309
310
311
312
313</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 309</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_not_found'>not_found</span> <span class='id identifier rubyid_generator'>generator</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_message'>message</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The page &lt;kbd&gt;</span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_h'>h</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/kbd&gt; was not found</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_generate_servlet_not_found'>generate_servlet_not_found</span> <span class='id identifier rubyid_message'>message</span>
  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>404</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="ri_paths-instance_method">
  <h3 class='signature'>
  #<strong>ri_paths</strong>(&amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Enumerates the ri paths.  See <a href="RI.html" title="RDoc::RI (module)">RI</a>::Paths#each</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L318'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


318
319
320</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 318</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ri_paths'>ri_paths</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>RI</span><span class='op'>::</span><span class='const'>Paths</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbol'>:all</span><span class='comma'>,</span> <span class='op'>*</span><span class='ivar'>@extra_doc_dirs</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='comment'>#TODO: pass extra_dirs
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="root-instance_method">
  <h3 class='signature'>
  #<strong>root</strong>(req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Generates the root page on <code>res</code>.  <code>req</code> is ignored.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L325'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


325
326
327
328
329
330
331</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 325</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_root'><a href="../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_generator'>generator</span> <span class='op'>=</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Generator</span><span class='op'>::</span><span class='const'>Darkfish</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='ivar'>@options</span>

  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_generate_servlet_root'>generate_servlet_root</span> <span class='id identifier rubyid_installed_docs'>installed_docs</span>

  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text/html</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="root_search-instance_method">
  <h3 class='signature'>
  #<strong>root_search</strong>(req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Generates a search index for the root page on <code>res</code>. 
<code>req</code> is ignored.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L336'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 336</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_root_search'>root_search</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_search_index'>search_index</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_info'>info</span>         <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_installed_docs'>installed_docs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_href'>href</span><span class='comma'>,</span> <span class='id identifier rubyid_exists'>exists</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_exists'>exists</span>

    <span class='id identifier rubyid_search_index'>search_index</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_name'>name</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
    <span class='kw'>when</span> <span class='symbol'>:gem</span>
      <span class='id identifier rubyid_gemspec'>gemspec</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r%</span><span class='tstring_content'>/doc/([^/]*?)/ri$</span><span class='regexp_end'>%</span></span><span class='comma'>,</span>
                          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/specifications/\1.gemspec</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

      <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span> <span class='id identifier rubyid_gemspec'>gemspec</span>

      <span class='id identifier rubyid_path'>path</span>    <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span>
      <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_summary'>summary</span>
    <span class='kw'>when</span> <span class='symbol'>:system</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_path'>path</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Documentation for the Ruby standard library</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:site</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_path'>path</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>site</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Documentation for non-gem libraries</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:home</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_path'>path</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>home</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Documentation from your home directory</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:extra</span>
      <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_info'>info</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_comment'>comment</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:index</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
      <span class='symbol'>:searchIndex</span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_search_index'>search_index</span><span class='comma'>,</span>
      <span class='symbol'>:longSearchIndex</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_search_index'>search_index</span><span class='comma'>,</span>
      <span class='symbol'>:info</span>            <span class='op'>=&gt;</span> <span class='id identifier rubyid_info'>info</span><span class='comma'>,</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>var search_data = </span><span class='embexpr_beg'>#{</span><span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span> <span class='id identifier rubyid_index'>index</span><span class='embexpr_end'>}</span><span class='tstring_content'>;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/javascript</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="show_documentation-instance_method">
  <h3 class='signature'>
  #<strong>show_documentation</strong>(req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Displays documentation for <code>req</code> on <code>res</code>, whether
that be HTML or some asset.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L386'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 386</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_show_documentation'>show_documentation</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_documentation_source'>documentation_source</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>

  <span class='id identifier rubyid_if_modified_since'>if_modified_since</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_cache_path'>cache_path</span>

  <span class='id identifier rubyid_generator'>generator</span> <span class='op'>=</span> <span class='id identifier rubyid_generator_for'>generator_for</span> <span class='id identifier rubyid_store'>store</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_path'>path</span>
  <span class='kw'>when</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index.html</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_generate_index'>generate_index</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>table_of_contents.html</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_generator'>generator</span><span class='period'>.</span><span class='id identifier rubyid_generate_table_of_contents'>generate_table_of_contents</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>js/search_index.js</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_documentation_search'>documentation_search</span> <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='id identifier rubyid_generator'>generator</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_documentation_page'>documentation_page</span> <span class='id identifier rubyid_store'>store</span><span class='comma'>,</span> <span class='id identifier rubyid_generator'>generator</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>end</span>
<span class='kw'>ensure</span>
  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text/html</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="store_for-instance_method">
  <h3 class='signature'>
  #<strong>store_for</strong>(source_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns an <a href="Store.html" title="RDoc::Store (class)">RDoc::Store</a> for the given <code>source_name</code>
(&#39;ruby&#39; or a gem name).</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rdoc/servlet.rb#L410'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rdoc/servlet.rb', line 410</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_store_for'>store_for</span> <span class='id identifier rubyid_source_name'>source_name</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_source_name'>source_name</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>home</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>RI</span><span class='op'>::</span><span class='const'>Paths</span><span class='period'>.</span><span class='id identifier rubyid_home_dir'>home_dir</span><span class='comma'>,</span> <span class='symbol'>:home</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>RI</span><span class='op'>::</span><span class='const'>Paths</span><span class='period'>.</span><span class='id identifier rubyid_system_dir'>system_dir</span><span class='comma'>,</span> <span class='symbol'>:system</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>site</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>RI</span><span class='op'>::</span><span class='const'>Paths</span><span class='period'>.</span><span class='id identifier rubyid_site_dir'>site_dir</span><span class='comma'>,</span> <span class='symbol'>:site</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^extra-(\d+)$</span><span class='regexp_end'>/</span></span> <span class='kw'>then</span>
    <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='backref'>$1</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>-</span> <span class='int'>1</span>
    <span class='id identifier rubyid_ri_dir'>ri_dir</span> <span class='op'>=</span> <span class='id identifier rubyid_installed_docs'>installed_docs</span><span class='lbracket'>[</span><span class='id identifier rubyid_index'>index</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span>
    <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_ri_dir'>ri_dir</span><span class='comma'>,</span> <span class='symbol'>:extra</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_ri_dir'>ri_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_ri_paths'>ri_paths</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_dir'>dir</span><span class='comma'>,</span> <span class='id identifier rubyid_dir_type'>dir_type</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_dir_type'>dir_type</span> <span class='op'>==</span> <span class='symbol'>:gem</span>

      <span class='id identifier rubyid_source_name'>source_name</span> <span class='op'>==</span> <span class='id identifier rubyid_dir'>dir</span><span class='lbracket'>[</span><span class='tstring'><span class='regexp_beg'>%r%</span><span class='tstring_content'>/([^/]*)/ri$</span><span class='regexp_end'>%</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>WEBrick</span><span class='op'>::</span><span class='const'>HTTPStatus</span><span class='op'>::</span><span class='const'>NotFound</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find gem \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_name'>source_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;. Are you sure you installed it?</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_ri_dir'>ri_dir</span>

    <span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'><a href="RDoc.html" title="RDoc::RDoc (class)">RDoc</a></span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_ri_dir'>ri_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_store'>store</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_cache_path'>cache_path</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>WEBrick</span><span class='op'>::</span><span class='const'>HTTPStatus</span><span class='op'>::</span><span class='const'>NotFound</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find documentation for \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_name'>source_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;. Please run `gem rdoc --ri gem_name`</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>