<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: WEBrick::CGI &mdash; webrick Ruby-2.4.0 d2016-08-03</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "WEBrick::CGI",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='../index.html'>webrick</a> &raquo; 
          <a href='../_index.html'>Index (C)</a> &raquo; 
          <a href="../WEBrick.html" title="WEBrick (module)">WEBrick</a> &raquo; 
          <span class='title'>CGI</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: WEBrick::CGI</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'>Object</span>
      <ul class='fullTree'>
        <li>Object</li>
        <li class='next'>WEBrick::CGI</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <div class='box_max'>
        <a href="CGI/Socket.html" title="WEBrick::CGI::Socket (class)">Socket</a>
      </div>
    </td>
  </tr>
  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/ruby/ruby/blob/trunk/lib/webrick/cgi.rb#L31'>lib/webrick/cgi.rb</a></div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A CGI library using WEBrick requests and responses.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>MyCGI</span> <span class='op'>&lt;</span> <span class='const'><a href="../WEBrick.html" title="WEBrick (module)">WEBrick</a></span><span class='op'>::</span><span class='const'>CGI</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_do_GET'>do_GET</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>it worked!</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>200</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>MyCGI</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>
<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='CGIError-constant'>
      CGIError =
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>The CGI error exception class</p>


  </div>
</div>
<div class="tags">
  
</div>      <pre class='code'><span class='const'>Class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>StandardError</span><span class='rparen'>)</span></pre>
    </dd>
  </dl>



<h2>Instance Attribute Summary <small><a href='#' class='summary_toggle'>collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#config-instance_method" title="#config (instance method)">#<strong>config</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The CGI configuration.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The CGI logger</p>
</div>
      </span>
    </li>
  </ul>


<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(*args)  &#x21d2; CGI </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a new CGI interface.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#%5B%5D-instance_method" title="#[] (instance method)">#<strong>[]</strong>(key)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Reads <code>key</code> from the configuration</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#service-instance_method" title="#service (instance method)">#<strong>service</strong>(req, res)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Services the request <code>req</code> which will fill in the response
<code>res</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#start-instance_method" title="#start (instance method)">#<strong>start</strong>(env = ENV, stdin = $stdin, stdout = $stdout)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Starts the CGI process with the given environment <code>env</code> and
standard input and output <code>stdin</code> and <code>stdout</code>.</p>
</div>
      </span>
    </li>
  </ul>


<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(*args)  &#x21d2; <tt><a href="" title="WEBrick::CGI (class)">CGI</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a new CGI interface.</p>

<p>The first argument in <code>args</code> is a configuration hash which would
update <a href="Config.html#HTTP-constant" title="WEBrick::Config::HTTP (constant)">WEBrick::Config::HTTP</a>.</p>

<p>Any remaining arguments are stored in the <code>@options</code> instance
variable for use by a subclass.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/webrick/cgi.rb#L56'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/webrick/cgi.rb', line 56</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>MOD_RUBY</span><span class='rparen'>)</span>
    <span class='kw'>unless</span> <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GATEWAY_INTERFACE</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='const'>Apache</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_setup_cgi_env'>setup_cgi_env</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>HTTP/(\d\.\d)</span><span class='regexp_end'>}</span></span> <span class='op'>=~</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SERVER_PROTOCOL</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_httpv'>httpv</span> <span class='op'>=</span> <span class='backref'>$1</span>
  <span class='kw'>end</span>
  <span class='ivar'>@config</span> <span class='op'>=</span> <span class='const'><a href="../WEBrick.html" title="WEBrick (module)">WEBrick</a></span><span class='op'>::</span><span class='const'><a href="Config.html" title="WEBrick::Config (module)">Config</a></span><span class='op'>::</span><span class='const'><a href="Config.html#HTTP-constant" title="WEBrick::Config::HTTP (constant)">HTTP</a></span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span>
    <span class='symbol'>:ServerSoftware</span> <span class='op'>=&gt;</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SERVER_SOFTWARE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>null</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:HTTPVersion</span>    <span class='op'>=&gt;</span> <span class='const'><a href="HTTPVersion.html" title="WEBrick::HTTPVersion (class)">HTTPVersion</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="HTTPVersion.html#new-class_method" title="WEBrick::HTTPVersion.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_httpv'>httpv</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='symbol'>:RunOnCGI</span>       <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>   <span class='comment'># to detect if it runs on CGI.
</span>    <span class='symbol'>:NPH</span>            <span class='op'>=&gt;</span> <span class='kw'>false</span>   <span class='comment'># set true to run as NPH script.
</span>  <span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:Logger</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><a href="../WEBrick.html" title="WEBrick (module)">WEBrick</a></span><span class='op'>::</span><span class='const'><a href="BasicLog.html" title="WEBrick::BasicLog (class)">BasicLog</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="BasicLog.html#new-class_method" title="WEBrick::BasicLog.new (method)">new</a></span><span class='lparen'>(</span><span class='gvar'>$stderr</span><span class='rparen'>)</span>
  <span class='ivar'>@logger</span> <span class='op'>=</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:Logger</span><span class='rbracket'>]</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="config-instance_method">
  <h3 class='signature first'>
  #<strong>config</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The CGI configuration.  This is based on <a href="Config.html#HTTP-constant" title="WEBrick::Config::HTTP (constant)">WEBrick::Config::HTTP</a></p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/webrick/cgi.rb#L40'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


40</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/webrick/cgi.rb', line 40</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:config</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="logger-instance_method">
  <h3 class='signature'>
  #<strong>logger</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The CGI logger</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/webrick/cgi.rb#L45'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


45</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/webrick/cgi.rb', line 45</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:logger</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="[]-instance_method">
  <h3 class='signature first'>
  #<strong>[]</strong>(key)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads <code>key</code> from the configuration</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/webrick/cgi.rb#L82'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


82
83
84</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/webrick/cgi.rb', line 82</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>[]</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="service-instance_method">
  <h3 class='signature'>
  #<strong>service</strong>(req, res)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Services the request <code>req</code> which will fill in the response
<code>res</code>.  See <a href="HTTPServlet.html" title="WEBrick::HTTPServlet (module)">HTTPServlet</a>::AbstractServlet#service for
details.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/webrick/cgi.rb#L157'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


157
158
159
160
161
162
163
164
165</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/webrick/cgi.rb', line 157</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_service'>service</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_method_name'>method_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>do_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>-</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid___send__'>__send__</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="HTTPStatus.html" title="WEBrick::HTTPStatus (module)">HTTPStatus</a></span><span class='op'>::</span><span class='const'>MethodNotAllowed</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unsupported method `</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="start-instance_method">
  <h3 class='signature'>
  #<strong>start</strong>(env = ENV, stdin = $stdin, stdout = $stdout)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Starts the CGI process with the given environment <code>env</code> and
standard input and output <code>stdin</code> and <code>stdout</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/webrick/cgi.rb#L90'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/webrick/cgi.rb', line 90</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='op'>=</span><span class='const'>ENV</span><span class='comma'>,</span> <span class='id identifier rubyid_stdin'>stdin</span><span class='op'>=</span><span class='gvar'>$stdin</span><span class='comma'>,</span> <span class='id identifier rubyid_stdout'>stdout</span><span class='op'>=</span><span class='gvar'>$stdout</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="../WEBrick.html" title="WEBrick (module)">WEBrick</a></span><span class='op'>::</span><span class='const'><a href="" title="WEBrick::CGI (class)">CGI</a></span><span class='op'>::</span><span class='const'><a href="CGI/Socket.html" title="WEBrick::CGI::Socket (class)">Socket</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="CGI/Socket.html#new-class_method" title="WEBrick::CGI::Socket.new (method)">new</a></span><span class='lparen'>(</span><span class='ivar'>@config</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_stdin'>stdin</span><span class='comma'>,</span> <span class='id identifier rubyid_stdout'>stdout</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='const'><a href="HTTPRequest.html" title="WEBrick::HTTPRequest (class)">HTTPRequest</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="HTTPRequest.html#new-class_method" title="WEBrick::HTTPRequest.new (method)">new</a></span><span class='lparen'>(</span><span class='ivar'>@config</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='const'><a href="HTTPResponse.html" title="WEBrick::HTTPResponse (class)">HTTPResponse</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="HTTPResponse.html#new-class_method" title="WEBrick::HTTPResponse.new (method)">new</a></span><span class='lparen'>(</span><span class='ivar'>@config</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:NPH</span><span class='rbracket'>]</span> <span class='kw'>or</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>MOD_RUBY</span><span class='rparen'>)</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_setup_header'>setup_header</span>
      <span class='kw'>unless</span> <span class='ivar'>@header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>status</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_phrase'>phrase</span> <span class='op'>=</span> <span class='const'><a href="HTTPStatus.html" title="WEBrick::HTTPStatus (module)">HTTPStatus</a></span><span class='op'>::</span><span class='id identifier rubyid_reason_phrase'><a href="HTTPStatus.html#reason_phrase-class_method" title="WEBrick::HTTPStatus.reason_phrase (method)">reason_phrase</a></span><span class='lparen'>(</span><span class='ivar'>@status</span><span class='rparen'>)</span>
        <span class='ivar'>@header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>status</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@status</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_phrase'>phrase</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='kw'>super</span>
    <span class='kw'>end</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_status_line'>status_line</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_sock'>sock</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_script_name'>script_name</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SCRIPT_NAME</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='gvar'>$0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_path_info'>path_info</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PATH_INFO</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_query_string'>query_string</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>QUERY_STRING</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>REMOTE_USER</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span> <span class='op'>=</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_request_uri'>request_uri</span> <span class='op'>=</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_request_uri'>request_uri</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_request_http_version'>request_http_version</span> <span class='op'>=</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_http_version'>http_version</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_keep_alive'>keep_alive</span> <span class='op'>=</span> <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_keep_alive?'>keep_alive?</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_service'>service</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'><a href="HTTPStatus.html" title="WEBrick::HTTPStatus (module)">HTTPStatus</a></span><span class='op'>::</span><span class='const'><a href="HTTPStatus/Error.html" title="WEBrick::HTTPStatus::Error (class)">Error</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ex'>ex</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_set_error'>set_error</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'><a href="HTTPStatus.html" title="WEBrick::HTTPStatus (module)">HTTPStatus</a></span><span class='op'>::</span><span class='const'><a href="HTTPStatus/Status.html" title="WEBrick::HTTPStatus::Status (class)">Status</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ex'>ex</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='id identifier rubyid_ex'>ex</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ex'>ex</span>
    <span class='ivar'>@logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_set_error'>set_error</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_fixup'>fixup</span>
    <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>MOD_RUBY</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_setup_header'>setup_header</span>
      <span class='const'>Apache</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_status_line'>status_line</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_reason_phrase'>reason_phrase</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='const'>Apache</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span>
      <span class='id identifier rubyid_table'>table</span> <span class='op'>=</span> <span class='const'>Apache</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_headers_out'>headers_out</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='op'>|</span>
        <span class='kw'>case</span> <span class='id identifier rubyid_key'>key</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^content-encoding$</span><span class='regexp_end'>/i</span></span>
          <span class='const'>Apache</span><span class='op'>::</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_content_encoding'>content_encoding</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^content-type$</span><span class='regexp_end'>/i</span></span>
          <span class='const'>Apache</span><span class='op'>::</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
        <span class='kw'>end</span>
      <span class='rbrace'>}</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_cookies'>cookies</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_cookie'>cookie</span><span class='op'>|</span>
        <span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Set-Cookie</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cookie'>cookie</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
      <span class='const'>Apache</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_send_http_header'>send_http_header</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_send_body'>send_body</span><span class='lparen'>(</span><span class='id identifier rubyid_sock'>sock</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_send_response'>send_response</span><span class='lparen'>(</span><span class='id identifier rubyid_sock'>sock</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>