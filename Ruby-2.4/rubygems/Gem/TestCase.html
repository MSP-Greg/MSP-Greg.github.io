<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Gem::TestCase &mdash; rubygems Ruby-2.4.0 d2016-07-07</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Gem::TestCase",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='../index.html'>rubygems</a> &raquo; 
          <a href='../_index.html'>Index (T)</a> &raquo; 
        #  <a href="../Gem.html" title="Gem (module)">Gem</a> &raquo; 
          <span class='title'>TestCase</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: Gem::TestCase</h1>

<div class="box_info">
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class='inheritName'>MiniTest::Unit::TestCase</span>
        <ul class='fullTree'>
          <li>Object</li>
            <li class='next'>MiniTest::Unit::TestCase</li>
            <li class='next'>Gem::TestCase</li>
        </ul>
        <a href='#' class='inheritanceTree'>show all</a>
    </dd>
  </dl>

  <dl>
      <dt>Includes:</dt>
      <dd><a href="DefaultUserInteraction.html" title="Gem::DefaultUserInteraction (module)">DefaultUserInteraction</a></dd>
  </dl>


  <dl>
    <dt>Defined in:</dt>
    <dd>rubygems/test_case.rb</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>RubyGemTestCase provides a variety of methods for testing rubygems and
gem-related behavior in a sandbox.  Through RubyGemTestCase you can install
and uninstall gems, fetch remote gems through a stub fetcher and be assured
your normal set of gems is not affected.</p>

<p>Tests are always run at a safe level of 1.</p>


  </div>
</div>
<div class="tags">
  
</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><a href="InstallerTestCase.html" title="Gem::InstallerTestCase (class)">InstallerTestCase</a>, <a href="Package/TarTestCase.html" title="Gem::Package::TarTestCase (class)">Package::TarTestCase</a></p>
</div>

<h2>Defined Under Namespace</h2>

  <p class='children'><strong class='classes'>Classes:</strong>
    <a href="TestCase/SpecFetcherSetup.html" title="Gem::TestCase::SpecFetcherSetup (class)">SpecFetcherSetup</a>,
    <a href="TestCase/StaticSet.html" title="Gem::TestCase::StaticSet (class)">StaticSet</a>
  </p>

<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='bad_rake-classvariable'>
      @@bad_rake =
    </dt>
    <dd>
            <pre class='code'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rubybin'>rubybin</span><span class='embexpr_end'>}</span><span class='tstring_content'> \&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>../../../test/rubygems/bad_rake.rb</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span></pre>
    </dd>
    <dt id='good_rake-classvariable'>
      @@good_rake =
    </dt>
    <dd>
            <pre class='code'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rubybin'>rubybin</span><span class='embexpr_end'>}</span><span class='tstring_content'> \&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>../../../test/rubygems/good_rake.rb</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span></pre>
    </dd>
    <dt id='initial_reset-classvariable'>
      @@initial_reset =
    </dt>
    <dd>
            <pre class='code'><span class='kw'>false</span></pre>
    </dd>
    <dt id='project_dir-classvariable'>
      @@project_dir =
    </dt>
    <dd>
            <pre class='code'><span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_pwd'>pwd</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span></pre>
    </dd>
    <dt id='ruby-classvariable'>
      @@ruby =
    </dt>
    <dd>
            <pre class='code'><span class='id identifier rubyid_rubybin'>rubybin</span></pre>
    </dd>
    <dt id='PRIVATE_KEY_PASSPHRASE-constant'>
      PRIVATE_KEY_PASSPHRASE =
    </dt>
    <dd>
      <div class="docstring">
  <div class="discussion">
    
<p>:stopdoc: only available in RubyGems tests</p>


  </div>
</div>
<div class="tags">
  
</div>      <pre class='code'><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Foo bar</span><span class='tstring_end'>&#39;</span></span></pre>
    </dd>
  </dl>





<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#cert_path-class_method" title=".cert_path (class method)">.<strong>cert_path</strong>(cert_name)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the path to the certificate named <code>cert_name</code> from
<code>test/rubygems/</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#key_path-class_method" title=".key_path (class method)">.<strong>key_path</strong>(key_name)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the path to the key named <code>key_name</code> from
<code>test/rubygems</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#load_cert-class_method" title=".load_cert (class method)">.<strong>load_cert</strong>(cert_name)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Loads certificate named <code>cert_name</code> from
<code>test/rubygems/</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#load_key-class_method" title=".load_key (class method)">.<strong>load_key</strong>(key_name, passphrase = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Loads an RSA private key named <code>key_name</code> with
<code>passphrase</code> in <code>test/rubygems/</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#make_command-class_method" title=".make_command (class method)">.<strong>make_command</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the make command for the current platform.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#process_based_port-class_method" title=".process_based_port (class method)">.<strong>process_based_port</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Allows tests to use a random (but controlled) port number instead of a
hardcoded one.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#rubybin-class_method" title=".rubybin (class method)">.<strong>rubybin</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Finds the path to the Ruby executable</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#vc_windows%3F-class_method" title=".vc_windows? (class method)">.<strong>vc_windows?</strong>  &#x21d2; Boolean </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns whether or not we&#39;re on a version of Ruby built with VC++ (or
Borland) versus Cygwin, Mingw, etc.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#win_platform%3F-class_method" title=".win_platform? (class method)">.<strong>win_platform?</strong>  &#x21d2; Boolean </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Is this test being run on a Windows platform?</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#add_to_fetcher-instance_method" title="#add_to_fetcher (instance method)">#<strong>add_to_fetcher</strong>(spec, path = nil, repo = @gem_repo)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Add <code>spec</code> to <code>@fetcher</code> serving the data in the file
<code>path</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#all_spec_names-instance_method" title="#all_spec_names (instance method)">#<strong>all_spec_names</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#assert_activate-instance_method" title="#assert_activate (instance method)">#<strong>assert_activate</strong>(expected, *specs)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#assert_contains_make_command-instance_method" title="#assert_contains_make_command (instance method)">#<strong>assert_contains_make_command</strong>(target, output, msg = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#assert_path_exists-instance_method" title="#assert_path_exists (instance method)">#<strong>assert_path_exists</strong>(path, msg = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>TODO: move to minitest</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#build_rake_in-instance_method" title="#build_rake_in (instance method)">#<strong>build_rake_in</strong>(good = true)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Allows the proper version of <code>rake</code> to be used for the test.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#common_installer_setup-instance_method" title="#common_installer_setup (instance method)">#<strong>common_installer_setup</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#common_installer_teardown-instance_method" title="#common_installer_teardown (instance method)">#<strong>common_installer_teardown</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create_tmpdir-instance_method" title="#create_tmpdir (instance method)">#<strong>create_tmpdir</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>creates a temporary directory with hax TODO: deprecate and remove</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#dep-instance_method" title="#dep (instance method)">#<strong>dep</strong>(name, *requirements)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Construct a new <a href="Dependency.html" title="Gem::Dependency (class)">Dependency</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#dependency_request-instance_method" title="#dependency_request (instance method)">#<strong>dependency_request</strong>(dep, from_name, from_version, parent = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Constructs a <a href="Resolver/DependencyRequest.html" title="Gem::Resolver::DependencyRequest (class)">Resolver::DependencyRequest</a> from a <a href="Dependency.html" title="Gem::Dependency (class)">Dependency</a>
<code>dep</code>, a <code>from_name</code> and <code>from_version</code>
requesting the dependency and a <code>parent</code> DependencyRequest</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#enable_shared-instance_method" title="#enable_shared (instance method)">#<strong>enable_shared</strong>(value)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sets the ENABLE_SHARED entry in <code>RbConfig::CONFIG</code> to <code>value</code>
and restores the original value when the block ends</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#git_gem-instance_method" title="#git_gem (instance method)">#<strong>git_gem</strong>(name = &#39;a&#39;, version = 1)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>A git_gem is used with a gem dependencies file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#have_git%3F-instance_method" title="#have_git? (instance method)">#<strong>have_git?</strong>  &#x21d2; Boolean </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Skips this test unless you have a git executable</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#install_default_gems-instance_method" title="#install_default_gems (instance method)">#<strong>install_default_gems</strong>(*specs)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Installs the provided default specs including writing the spec file</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#install_default_specs-instance_method" title="#install_default_specs (instance method)">#<strong>install_default_specs</strong>(*specs)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Install the provided default specs</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#install_gem-instance_method" title="#install_gem (instance method)">#<strong>install_gem</strong>(spec, options = {})  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Builds and installs the <a href="Specification.html" title="Gem::Specification (class)">Specification</a> <code>spec</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#install_gem_user-instance_method" title="#install_gem_user (instance method)">#<strong>install_gem_user</strong>(spec)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Builds and installs the <a href="Specification.html" title="Gem::Specification (class)">Specification</a> <code>spec</code> into the
user dir</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#install_specs-instance_method" title="#install_specs (instance method)">#<strong>install_specs</strong>(*specs)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Install the provided specs</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#loaded_spec_names-instance_method" title="#loaded_spec_names (instance method)">#<strong>loaded_spec_names</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#make_command-instance_method" title="#make_command (instance method)">#<strong>make_command</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the make command for the current platform.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#mu_pp-instance_method" title="#mu_pp (instance method)">#<strong>mu_pp</strong>(obj)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Enables pretty-print for all tests</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new_default_spec-instance_method" title="#new_default_spec (instance method)">#<strong>new_default_spec</strong>(name, version, deps = nil, *files)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new_spec-instance_method" title="#new_spec (instance method)">#<strong>new_spec</strong>(name, version, deps = nil, *files)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>new_spec is deprecated as it is never used.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#nmake_found%3F-instance_method" title="#nmake_found? (instance method)">#<strong>nmake_found?</strong>  &#x21d2; Boolean </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns whether or not the nmake command could be found.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#parse_make_command_line-instance_method" title="#parse_make_command_line (instance method)">#<strong>parse_make_command_line</strong>(line)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#process_based_port-instance_method" title="#process_based_port (instance method)">#<strong>process_based_port</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>See <a href="#process_based_port-class_method" title="Gem::TestCase.process_based_port (method)">TestCase.process_based_port</a></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#quick_gem-instance_method" title="#quick_gem (instance method)">#<strong>quick_gem</strong>(name, version = &#39;2&#39;)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a <a href="Specification.html" title="Gem::Specification (class)">Specification</a> with a minimum of extra work.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#quick_spec-instance_method" title="#quick_spec (instance method)">#<strong>quick_spec</strong>(name, version = &#39;2&#39;)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>TODO:  remove in RubyGems 3.0</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#read_binary-instance_method" title="#read_binary (instance method)">#<strong>read_binary</strong>(path)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Reads a binary file at <code>path</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#read_cache-instance_method" title="#read_cache (instance method)">#<strong>read_cache</strong>(path)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Reads a Marshal file at <code>path</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#refute_path_exists-instance_method" title="#refute_path_exists (instance method)">#<strong>refute_path_exists</strong>(path, msg = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>TODO: move to minitest</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#req-instance_method" title="#req (instance method)">#<strong>req</strong>(*requirements)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Constructs a new <a href="Requirement.html" title="Gem::Requirement (class)">Requirement</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#save_gemspec-instance_method" title="#save_gemspec (instance method)">#<strong>save_gemspec</strong>(name = &#39;a&#39;, version = 1, directory = &#39;.&#39;)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>create_gemspec creates gem specification in given <code>direcotry</code> or
&#39;.&#39; for the given <code>name</code> and <code>version</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#save_loaded_features-instance_method" title="#save_loaded_features (instance method)">#<strong>save_loaded_features</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#scan_make_command_lines-instance_method" title="#scan_make_command_lines (instance method)">#<strong>scan_make_command_lines</strong>(output)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#setup-instance_method" title="#setup (instance method)">#<strong>setup</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p><a href="#setup-instance_method" title="Gem::TestCase#setup (method)">#setup</a> prepares a sandboxed location to install gems.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#spec-instance_method" title="#spec (instance method)">#<strong>spec</strong>(name, version, &amp;block)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Constructs a new <a href="Specification.html" title="Gem::Specification (class)">Specification</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#spec_fetcher-instance_method" title="#spec_fetcher (instance method)">#<strong>spec_fetcher</strong>(repository = @gem_repo)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a SpecFetcher pre-filled with the gems or specs defined in the
block.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#teardown-instance_method" title="#teardown (instance method)">#<strong>teardown</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p><a href="#teardown-instance_method" title="Gem::TestCase#teardown (method)">#teardown</a> restores the process to its original state and removes the
tempdir unless the <code>KEEP_FILES</code> environment variable was set.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#uninstall_gem-instance_method" title="#uninstall_gem (instance method)">#<strong>uninstall_gem</strong>(spec)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Uninstalls the <a href="Specification.html" title="Gem::Specification (class)">Specification</a> <code>spec</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#unresolved_names-instance_method" title="#unresolved_names (instance method)">#<strong>unresolved_names</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_build_gem-instance_method" title="#util_build_gem (instance method)">#<strong>util_build_gem</strong>(spec)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Builds a gem from <code>spec</code> and places it in <code>File.join
@gemhome, &#39;cache&#39;</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_clear_gems-instance_method" title="#util_clear_gems (instance method)">#<strong>util_clear_gems</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Removes all installed gems from <code>@gemhome</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_gem-instance_method" title="#util_gem (instance method)">#<strong>util_gem</strong>(name, version, deps = nil, &amp;block)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a gem with <code>name</code>, <code>version</code> and
<code>deps</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_gzip-instance_method" title="#util_gzip (instance method)">#<strong>util_gzip</strong>(data)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Gzips <code>data</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_make_gems-instance_method" title="#util_make_gems (instance method)">#<strong>util_make_gems</strong>(prerelease = false)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Creates several default gems which all have a lib/code.rb file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_remove_gem-instance_method" title="#util_remove_gem (instance method)">#<strong>util_remove_gem</strong>(spec)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_restore_RUBY_VERSION-instance_method" title="#util_restore_RUBY_VERSION (instance method)">#<strong>util_restore_RUBY_VERSION</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_set_arch-instance_method" title="#util_set_arch (instance method)">#<strong>util_set_arch</strong>(arch)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Set the platform to <code>arch</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_set_RUBY_VERSION-instance_method" title="#util_set_RUBY_VERSION (instance method)">#<strong>util_set_RUBY_VERSION</strong>(version, patchlevel = nil, revision = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_setup_fake_fetcher-instance_method" title="#util_setup_fake_fetcher (instance method)">#<strong>util_setup_fake_fetcher</strong>(prerelease = false)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sets up a fake fetcher using the gems from <a href="#util_make_gems-instance_method" title="Gem::TestCase#util_make_gems (method)">#util_make_gems</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_setup_spec_fetcher-instance_method" title="#util_setup_spec_fetcher (instance method)">#<strong>util_setup_spec_fetcher</strong>(*specs)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sets up <a href="SpecFetcher.html" title="Gem::SpecFetcher (class)">SpecFetcher</a> to return information from the gems in
<code>specs</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_spec-instance_method" title="#util_spec (instance method)">#<strong>util_spec</strong>(name, version = 2, deps = nil)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a spec with <code>name</code>, <code>version</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#util_zip-instance_method" title="#util_zip (instance method)">#<strong>util_zip</strong>(data)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Deflates <code>data</code></p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#v-instance_method" title="#v (instance method)">#<strong>v</strong>(string)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Construct a new <a href="Version.html" title="Gem::Version (class)">Version</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#vc_windows%3F-instance_method" title="#vc_windows? (instance method)">#<strong>vc_windows?</strong>  &#x21d2; Boolean </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns whether or not we&#39;re on a version of Ruby built with VC++ (or
Borland) versus Cygwin, Mingw, etc.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#vendor_gem-instance_method" title="#vendor_gem (instance method)">#<strong>vendor_gem</strong>(name = &#39;a&#39;, version = 1)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>A vendor_gem is used with a gem dependencies file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#wait_for_child_process_to_exit-instance_method" title="#wait_for_child_process_to_exit (instance method)">#<strong>wait_for_child_process_to_exit</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>In case we&#39;re building docs in a background process, this method waits
for that process to exit (or if it&#39;s already been reaped, or never
happened, swallows the <code>Errno::ECHILD</code> error).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#win_platform%3F-instance_method" title="#win_platform? (instance method)">#<strong>win_platform?</strong>  &#x21d2; Boolean </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Is this test being run on a Windows platform?</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#write_file-instance_method" title="#write_file (instance method)">#<strong>write_file</strong>(path)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Writes a binary file to <code>path</code> which is relative to
<code>@gemhome</code></p>
</div>
      </span>
    </li>
  </ul>


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="DefaultUserInteraction.html" title="Gem::DefaultUserInteraction (module)">DefaultUserInteraction</a></h3>
  <p class="inherited"><a href="DefaultUserInteraction.html#ui-class_method" title="Gem::DefaultUserInteraction.ui (method)">.ui</a>, <a href="DefaultUserInteraction.html#ui-instance_method" title="Gem::DefaultUserInteraction#ui (method)">#ui</a>, <a href="DefaultUserInteraction.html#ui%3D-instance_method" title="Gem::DefaultUserInteraction#ui= (method)">#ui=</a>, <a href="DefaultUserInteraction.html#ui%3D-class_method" title="Gem::DefaultUserInteraction.ui= (method)">.ui=</a>, <a href="DefaultUserInteraction.html#use_ui-class_method" title="Gem::DefaultUserInteraction.use_ui (method)">.use_ui</a>, <a href="DefaultUserInteraction.html#use_ui-instance_method" title="Gem::DefaultUserInteraction#use_ui (method)">#use_ui</a></p>

  <h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="cert_path-class_method">
  <h3 class='signature first'>
  .<strong>cert_path</strong>(cert_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the path to the certificate named <code>cert_name</code> from
<code>test/rubygems/</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1431
1432
1433
1434
1435
1436
1437
1438
1439
1440
1441</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1431</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cert_path'>cert_path</span> <span class='id identifier rubyid_cert_name'>cert_name</span>
  <span class='kw'>if</span> <span class='int'>32</span> <span class='op'>==</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>2</span><span class='op'>**</span><span class='int'>32</span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='int'>32</span><span class='rparen'>)</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_cert_file'>cert_file</span> <span class='op'>=</span>
      <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>../../../test/rubygems/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cert_name'>cert_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_cert_32.pem</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                       <span class='kw'>__FILE__</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_cert_file'>cert_file</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_cert_file'>cert_file</span>
  <span class='kw'>end</span>

  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>../../../test/rubygems/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cert_name'>cert_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_cert.pem</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="key_path-class_method">
  <h3 class='signature'>
  .<strong>key_path</strong>(key_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the path to the key named <code>key_name</code> from
<code>test/rubygems</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1457
1458
1459</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1457</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_key_path'>key_path</span> <span class='id identifier rubyid_key_name'>key_name</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>../../../test/rubygems/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key_name'>key_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_key.pem</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="load_cert-class_method">
  <h3 class='signature'>
  .<strong>load_cert</strong>(cert_name)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Loads certificate named <code>cert_name</code> from
<code>test/rubygems/</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1419
1420
1421
1422
1423
1424
1425</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1419</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_cert'>load_cert</span> <span class='id identifier rubyid_cert_name'>cert_name</span>
  <span class='id identifier rubyid_cert_file'>cert_file</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_path'>cert_path</span> <span class='id identifier rubyid_cert_name'>cert_name</span>

  <span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='id identifier rubyid_cert_file'>cert_file</span>

  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_cert'>cert</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="load_key-class_method">
  <h3 class='signature'>
  .<strong>load_key</strong>(key_name, passphrase = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Loads an RSA private key named <code>key_name</code> with
<code>passphrase</code> in <code>test/rubygems/</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1446
1447
1448
1449
1450
1451
1452</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1446</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_key'>load_key</span> <span class='id identifier rubyid_key_name'>key_name</span><span class='comma'>,</span> <span class='id identifier rubyid_passphrase'>passphrase</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_key_file'>key_file</span> <span class='op'>=</span> <span class='id identifier rubyid_key_path'>key_path</span> <span class='id identifier rubyid_key_name'>key_name</span>

  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='id identifier rubyid_key_file'>key_file</span>

  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_passphrase'>passphrase</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="make_command-class_method">
  <h3 class='signature'>
  .<strong>make_command</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the make command for the current platform. For versions of Ruby
built on MS Windows with VC++ or Borland it will return &#39;nmake&#39;. On
all other platforms, including Cygwin, it will return &#39;make&#39;.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1151
1152
1153</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1151</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_make_command'>make_command</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>make</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MAKE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id identifier rubyid_vc_windows?'>vc_windows?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nmake</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>make</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="process_based_port-class_method">
  <h3 class='signature'>
  .<strong>process_based_port</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows tests to use a random (but controlled) port number instead of a
hardcoded one. This helps CI tools when running parallels builds on the
same builder slave.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1184
1185
1186</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1184</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_process_based_port'>process_based_port</span>
  <span class='cvar'>@@process_based_port</span> <span class='op'>||=</span> <span class='int'>8000</span> <span class='op'>+</span> <span class='gvar'>$$</span> <span class='op'>%</span> <span class='int'>1000</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="rubybin-class_method">
  <h3 class='signature'>
  .<strong>rubybin</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Finds the path to the Ruby executable</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1217</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rubybin'>rubybin</span>
  <span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RUBY</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_ruby'>ruby</span> <span class='kw'>if</span> <span class='id identifier rubyid_ruby'>ruby</span>
  <span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_rubyexe'>rubyexe</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ruby'>ruby</span><span class='embexpr_end'>}</span><span class='tstring_content'>.exe</span><span class='tstring_end'>&quot;</span></span>

  <span class='int'>3</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_ruby'>ruby</span> <span class='kw'>and</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_executable?'>executable?</span> <span class='id identifier rubyid_ruby'>ruby</span> <span class='kw'>and</span> <span class='op'>!</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span> <span class='id identifier rubyid_ruby'>ruby</span>
      <span class='kw'>return</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_ruby'>ruby</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_rubyexe'>rubyexe</span> <span class='kw'>and</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_executable?'>executable?</span> <span class='id identifier rubyid_rubyexe'>rubyexe</span>
      <span class='kw'>return</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_rubyexe'>rubyexe</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_ruby'>ruby</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rbconfig</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bindir</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
              <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby_install_name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>+</span>
              <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EXEEXT</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>LoadError</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="vc_windows?-class_method">
  <h3 class='signature'>
  .<strong>vc_windows?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns whether or not we&#39;re on a version of Ruby built with VC++ (or
Borland) versus Cygwin, Mingw, etc.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1134
1135
1136</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1134</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_vc_windows?'>vc_windows?</span>
  <span class='const'>RUBY_PLATFORM</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mswin</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="win_platform?-class_method">
  <h3 class='signature'>
  .<strong>win_platform?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Is this test being run on a Windows platform?</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1119
1120
1121</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1119</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_win_platform?'>win_platform?</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_win_platform?'>win_platform?</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section><h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="add_to_fetcher-instance_method">
  <h3 class='signature first'>
  #<strong>add_to_fetcher</strong>(spec, path = nil, repo = @gem_repo)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Add <code>spec</code> to <code>@fetcher</code> serving the data in the file
<code>path</code>. <code>repo</code> indicates which repo to make
<code>spec</code> appear to be in.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1012
1013
1014
1015</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1012</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_to_fetcher'>add_to_fetcher</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_repo'>repo</span><span class='op'>=</span><span class='ivar'>@gem_repo</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>||=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_cache_file'>cache_file</span>
  <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@gem_repo</span><span class='embexpr_end'>}</span><span class='tstring_content'>gems/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_file_name'>file_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_read_binary'>read_binary</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="all_spec_names-instance_method">
  <h3 class='signature'>
  #<strong>all_spec_names</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


603
604
605</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 603</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_spec_names'>all_spec_names</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:full_name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="assert_activate-instance_method">
  <h3 class='signature'>
  #<strong>assert_activate</strong>(expected, *specs)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_activate'>assert_activate</span> <span class='id identifier rubyid_expected'>expected</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_specs'>specs</span>
  <span class='id identifier rubyid_specs'>specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_spec'>spec</span>
    <span class='kw'>when</span> <span class='const'>String</span> <span class='kw'>then</span>
      <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_find_by_name'>find_by_name</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_activate'>activate</span>
    <span class='kw'>when</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_activate'>activate</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_flunk'>flunk</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_loaded'>loaded</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_loaded_specs'>loaded_specs</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:full_name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='id identifier rubyid_expected'>expected</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='comma'>,</span> <span class='id identifier rubyid_loaded'>loaded</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='kw'>if</span> <span class='id identifier rubyid_expected'>expected</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="assert_contains_make_command-instance_method">
  <h3 class='signature'>
  #<strong>assert_contains_make_command</strong>(target, output, msg = nil)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 168</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_contains_make_command'>assert_contains_make_command</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\n</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Expected output containing make command &quot;%s&quot;: %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
        <span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%s %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span><span class='id identifier rubyid_make_command'>make_command</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rstrip'>rstrip</span><span class='comma'>,</span>
        <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
      <span class='rbracket'>]</span>
    <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Expected make command &quot;%s&quot;: %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
        <span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%s %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span><span class='id identifier rubyid_make_command'>make_command</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rstrip'>rstrip</span><span class='comma'>,</span>
        <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
      <span class='rbracket'>]</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_scan_make_command_lines'>scan_make_command_lines</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
    <span class='id identifier rubyid_make'>make</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_make_command_line'>parse_make_command_line</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_make'>make</span><span class='lbracket'>[</span><span class='symbol'>:targets</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_make'>make</span><span class='comma'>,</span> <span class='id identifier rubyid_line'>line</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
      <span class='kw'>true</span>
    <span class='kw'>else</span>
      <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="assert_path_exists-instance_method">
  <h3 class='signature'>
  #<strong>assert_path_exists</strong>(path, msg = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>TODO: move to minitest</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


112
113
114
115</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 112</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_path_exists'>assert_path_exists</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Expected path &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to exist</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="build_rake_in-instance_method">
  <h3 class='signature'>
  #<strong>build_rake_in</strong>(good = true)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Allows the proper version of <code>rake</code> to be used for the test.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1198</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_rake_in'>build_rake_in</span><span class='lparen'>(</span><span class='id identifier rubyid_good'>good</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_gem_ruby'>gem_ruby</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_ruby'>ruby</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='cvar'>@@ruby</span>
  <span class='id identifier rubyid_env_rake'>env_rake</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rake</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rake'>rake</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_good'>good</span> <span class='op'>?</span> <span class='cvar'>@@good_rake</span> <span class='op'>:</span> <span class='cvar'>@@bad_rake</span><span class='rparen'>)</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rake</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_rake'>rake</span>
  <span class='kw'>yield</span> <span class='id identifier rubyid_rake'>rake</span>
<span class='kw'>ensure</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_ruby'>gem_ruby</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_env_rake'>env_rake</span>
    <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rake</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_env_rake'>env_rake</span>
  <span class='kw'>else</span>
    <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rake</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="common_installer_setup-instance_method">
  <h3 class='signature'>
  #<strong>common_installer_setup</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 415</span>

<span class='kw'>def</span> <span class='id identifier rubyid_common_installer_setup'>common_installer_setup</span>
  <span class='id identifier rubyid_common_installer_teardown'>common_installer_teardown</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_post_build'>post_build</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_installer'>installer</span><span class='op'>|</span>
    <span class='ivar'>@post_build_hook_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_installer'>installer</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_post_install'>post_install</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_installer'>installer</span><span class='op'>|</span>
    <span class='ivar'>@post_install_hook_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_installer'>installer</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_post_uninstall'>post_uninstall</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_uninstaller'>uninstaller</span><span class='op'>|</span>
    <span class='ivar'>@post_uninstall_hook_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_uninstaller'>uninstaller</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_pre_install'>pre_install</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_installer'>installer</span><span class='op'>|</span>
    <span class='ivar'>@pre_install_hook_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_installer'>installer</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_pre_uninstall'>pre_uninstall</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_uninstaller'>uninstaller</span><span class='op'>|</span>
    <span class='ivar'>@pre_uninstall_hook_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_uninstaller'>uninstaller</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="common_installer_teardown-instance_method">
  <h3 class='signature'>
  #<strong>common_installer_teardown</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


441
442
443
444
445
446
447
448
449
450</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 441</span>

<span class='kw'>def</span> <span class='id identifier rubyid_common_installer_teardown'>common_installer_teardown</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_post_build_hooks'>post_build_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_post_install_hooks'>post_install_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_done_installing_hooks'>done_installing_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_post_reset_hooks'>post_reset_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_post_uninstall_hooks'>post_uninstall_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_pre_install_hooks'>pre_install_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_pre_reset_hooks'>pre_reset_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_pre_uninstall_hooks'>pre_uninstall_hooks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="create_tmpdir-instance_method">
  <h3 class='signature'>
  #<strong>create_tmpdir</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>creates a temporary directory with hax TODO: deprecate and remove</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


554
555
556
557
558
559
560</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 554</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_tmpdir'>create_tmpdir</span>
  <span class='id identifier rubyid_tmpdir'>tmpdir</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_tmpdir'>tmpdir</span> <span class='kw'>do</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_pwd'>pwd</span> <span class='kw'>end</span> <span class='comment'># HACK OSX /private/tmp
</span>  <span class='id identifier rubyid_tmpdir'>tmpdir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test_rubygems_</span><span class='embexpr_beg'>#{</span><span class='gvar'>$$</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="dep-instance_method">
  <h3 class='signature'>
  #<strong>dep</strong>(name, *requirements)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Construct a new <a href="Dependency.html" title="Gem::Dependency (class)">Dependency</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1250
1251
1252</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1250</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dep'>dep</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_requirements'>requirements</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Dependency</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_requirements'>requirements</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="dependency_request-instance_method">
  <h3 class='signature'>
  #<strong>dependency_request</strong>(dep, from_name, from_version, parent = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Constructs a <a href="Resolver/DependencyRequest.html" title="Gem::Resolver::DependencyRequest (class)">Resolver::DependencyRequest</a> from a <a href="Dependency.html" title="Gem::Dependency (class)">Dependency</a>
<code>dep</code>, a <code>from_name</code> and <code>from_version</code>
requesting the dependency and a <code>parent</code> DependencyRequest</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dependency_request'>dependency_request</span> <span class='id identifier rubyid_dep'>dep</span><span class='comma'>,</span> <span class='id identifier rubyid_from_name'>from_name</span><span class='comma'>,</span> <span class='id identifier rubyid_from_version'>from_version</span><span class='comma'>,</span> <span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_remote'>remote</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Source</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='ivar'>@uri</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_parent'>parent</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_parent_dep'>parent_dep</span> <span class='op'>=</span> <span class='id identifier rubyid_dep'>dep</span> <span class='id identifier rubyid_from_name'>from_name</span><span class='comma'>,</span> <span class='id identifier rubyid_from_version'>from_version</span>
    <span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Resolver</span><span class='op'>::</span><span class='const'>DependencyRequest</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_parent_dep'>parent_dep</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Resolver</span><span class='op'>::</span><span class='const'>IndexSpecification</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> \
    <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_from_name'>from_name</span><span class='comma'>,</span> <span class='id identifier rubyid_from_version'>from_version</span><span class='comma'>,</span> <span class='id identifier rubyid_remote'>remote</span><span class='comma'>,</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Platform</span><span class='op'>::</span><span class='const'>RUBY</span>
  <span class='id identifier rubyid_activation'>activation</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Resolver</span><span class='op'>::</span><span class='const'>ActivationRequest</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_parent'>parent</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Resolver</span><span class='op'>::</span><span class='const'>DependencyRequest</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_dep'>dep</span><span class='comma'>,</span> <span class='id identifier rubyid_activation'>activation</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="enable_shared-instance_method">
  <h3 class='signature'>
  #<strong>enable_shared</strong>(value)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets the ENABLE_SHARED entry in <code>RbConfig::CONFIG</code> to <code>value</code>
and restores the original value when the block ends</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


121
122
123
124
125
126
127
128
129
130
131
132</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 121</span>

<span class='kw'>def</span> <span class='id identifier rubyid_enable_shared'>enable_shared</span> <span class='id identifier rubyid_value'>value</span>
  <span class='id identifier rubyid_enable_shared'>enable_shared</span> <span class='op'>=</span> <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ENABLE_SHARED</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ENABLE_SHARED</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>

  <span class='kw'>yield</span>
<span class='kw'>ensure</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_enable_shared'>enable_shared</span> <span class='kw'>then</span>
    <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>enable_shared</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_enable_shared'>enable_shared</span>
  <span class='kw'>else</span>
    <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>enable_shared</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="git_gem-instance_method">
  <h3 class='signature'>
  #<strong>git_gem</strong>(name = &#39;a&#39;, version = 1)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>A git_gem is used with a gem dependencies file.  The gem created here has
no files, just a gem specification for the given <code>name</code> and
<code>version</code>.</p>

<p>Yields the <code>specification</code> to the block, if given</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 458</span>

<span class='kw'>def</span> <span class='id identifier rubyid_git_gem'>git_gem</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_have_git?'>have_git?</span>

  <span class='id identifier rubyid_directory'>directory</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>git</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_directory'>directory</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='id identifier rubyid_directory'>directory</span>

  <span class='id identifier rubyid_git_spec'>git_spec</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_specification'>specification</span><span class='op'>|</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_specification'>specification</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>

  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='id identifier rubyid_directory'>directory</span>

  <span class='id identifier rubyid_gemspec'>gemspec</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gemspec</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_open'>open</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_directory'>directory</span><span class='comma'>,</span> <span class='id identifier rubyid_gemspec'>gemspec</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_git_spec'>git_spec</span><span class='period'>.</span><span class='id identifier rubyid_to_ruby'>to_ruby</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_head'>head</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span> <span class='id identifier rubyid_directory'>directory</span> <span class='kw'>do</span>
    <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.git</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
      <span class='id identifier rubyid_system'>system</span> <span class='ivar'>@git</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>init</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--quiet</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_system'>system</span> <span class='ivar'>@git</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>config</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user.name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RubyGems Tests</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_system'>system</span> <span class='ivar'>@git</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>config</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user.email</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems@example</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_system'>system</span> <span class='ivar'>@git</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_gemspec'>gemspec</span>
    <span class='id identifier rubyid_system'>system</span> <span class='ivar'>@git</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>commit</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-m</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a non-empty commit message</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--quiet</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_head'>head</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>git</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rev-parse</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_git_spec'>git_spec</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_directory'>directory</span><span class='comma'>,</span> <span class='id identifier rubyid_head'>head</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="have_git?-instance_method">
  <h3 class='signature'>
  #<strong>have_git?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Skips this test unless you have a git executable</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


496
497
498
499
500</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 496</span>

<span class='kw'>def</span> <span class='id identifier rubyid_have_git?'>have_git?</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_in_path?'>in_path?</span> <span class='ivar'>@git</span>

  <span class='id identifier rubyid_skip'>skip</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cannot find git executable, use GIT environment variable to set</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="install_default_gems-instance_method">
  <h3 class='signature'>
  #<strong>install_default_gems</strong>(*specs)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Installs the provided default specs including writing the spec file</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


707
708
709
710
711
712
713
714
715</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 707</span>

<span class='kw'>def</span> <span class='id identifier rubyid_install_default_gems'>install_default_gems</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_specs'>specs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_install_default_specs'>install_default_specs</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_specs'>specs</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_specs'>specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_loaded_from'>loaded_from</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
      <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_to_ruby_for_cache'>to_ruby_for_cache</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="install_default_specs-instance_method">
  <h3 class='signature'>
  #<strong>install_default_specs</strong>(*specs)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Install the provided default specs</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


720
721
722
723
724
725
726</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 720</span>

<span class='kw'>def</span> <span class='id identifier rubyid_install_default_specs'>install_default_specs</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_specs'>specs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_specs'>specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='id identifier rubyid_installer'>installer</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Installer</span><span class='period'>.</span><span class='id identifier rubyid_for_spec'>for_spec</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='symbol'>:install_as_default</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_installer'>installer</span><span class='period'>.</span><span class='id identifier rubyid_install'>install</span>
    <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_register_default_spec'>register_default_spec</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="install_gem-instance_method">
  <h3 class='signature'>
  #<strong>install_gem</strong>(spec, options = {})  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Builds and installs the <a href="Specification.html" title="Gem::Specification (class)">Specification</a> <code>spec</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 513</span>

<span class='kw'>def</span> <span class='id identifier rubyid_install_gem'>install_gem</span> <span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems/installer</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_gem'>gem</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gems</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gem</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_gem'>gem</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_use_ui'>use_ui</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>MockGemUi</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span>
      <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span> <span class='ivar'>@tempdir</span> <span class='kw'>do</span>
        <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Package</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span> <span class='id identifier rubyid_spec'>spec</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_gem'>gem</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_cache_file'>cache_file</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Installer</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='id identifier rubyid_gem'>gem</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:wrappers</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_install'>install</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="install_gem_user-instance_method">
  <h3 class='signature'>
  #<strong>install_gem_user</strong>(spec)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Builds and installs the <a href="Specification.html" title="Gem::Specification (class)">Specification</a> <code>spec</code> into the
user dir</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


534
535
536</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 534</span>

<span class='kw'>def</span> <span class='id identifier rubyid_install_gem_user'>install_gem_user</span> <span class='id identifier rubyid_spec'>spec</span>
  <span class='id identifier rubyid_install_gem'>install_gem</span> <span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='symbol'>:user_install</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="install_specs-instance_method">
  <h3 class='signature'>
  #<strong>install_specs</strong>(*specs)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Install the provided specs</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


696
697
698
699
700
701
702</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 696</span>

<span class='kw'>def</span> <span class='id identifier rubyid_install_specs'>install_specs</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_specs'>specs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_specs'>specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Installer</span><span class='period'>.</span><span class='id identifier rubyid_for_spec'>for_spec</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_install'>install</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_searcher'>searcher</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="loaded_spec_names-instance_method">
  <h3 class='signature'>
  #<strong>loaded_spec_names</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


728
729
730</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 728</span>

<span class='kw'>def</span> <span class='id identifier rubyid_loaded_spec_names'>loaded_spec_names</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_loaded_specs'>loaded_specs</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:full_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="make_command-instance_method">
  <h3 class='signature'>
  #<strong>make_command</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the make command for the current platform. For versions of Ruby
built on MS Windows with VC++ or Borland it will return &#39;nmake&#39;. On
all other platforms, including Cygwin, it will return &#39;make&#39;.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1160
1161
1162</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_make_command'>make_command</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>make</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MAKE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id identifier rubyid_vc_windows?'>vc_windows?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nmake</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>make</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="mu_pp-instance_method">
  <h3 class='signature'>
  #<strong>mu_pp</strong>(obj)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Enables pretty-print for all tests</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


565
566
567
568
569
570</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 565</span>

<span class='kw'>def</span> <span class='id identifier rubyid_mu_pp'>mu_pp</span><span class='lparen'>(</span><span class='id identifier rubyid_obj'>obj</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'>String</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'>PP</span><span class='period'>.</span><span class='id identifier rubyid_pp'>pp</span> <span class='id identifier rubyid_obj'>obj</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_force_encoding'>force_encoding</span><span class='lparen'>(</span><span class='const'>Encoding</span><span class='period'>.</span><span class='id identifier rubyid_default_external'>default_external</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>defined?</span> <span class='const'>Encoding</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_chomp'>chomp</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="new_default_spec-instance_method">
  <h3 class='signature'>
  #<strong>new_default_spec</strong>(name, version, deps = nil, *files)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 788</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new_default_spec'>new_default_spec</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_deps'>deps</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_files'>files</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='id identifier rubyid_util_spec'>util_spec</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_deps'>deps</span>

  <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_loaded_from'>loaded_from</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@default_spec_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_name'>spec_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_files'>files</span> <span class='op'>=</span> <span class='id identifier rubyid_files'>files</span>

  <span class='id identifier rubyid_lib_dir'>lib_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>default_gems</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lib</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='gvar'>$LOAD_PATH</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span><span class='lparen'>(</span><span class='id identifier rubyid_lib_dir'>lib_dir</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
    <span class='id identifier rubyid_rb_path'>rb_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_lib_dir'>lib_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_rb_path'>rb_path</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_rb_path'>rb_path</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>w</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rb'>rb</span><span class='op'>|</span>
      <span class='id identifier rubyid_rb'>rb</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'># </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec'>spec</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="new_spec-instance_method">
  <h3 class='signature'>
  #<strong>new_spec</strong>(name, version, deps = nil, *files)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>new_spec is deprecated as it is never used.</p>

<p>TODO:  remove in RubyGems 3.0</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 748</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new_spec'>new_spec</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_deps'>deps</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_files'>files</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems/specification</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span>    <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Platform</span><span class='op'>::</span><span class='const'>RUBY</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>        <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>     <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span>      <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A User</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span>       <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example@example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_homepage'>homepage</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_summary'>summary</span>     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>this is a summary</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is a test description</span><span class='tstring_end'>&quot;</span></span>

    <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_deps'>deps</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='op'>|</span>
      <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_add_dependency'>add_dependency</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;= 0</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_files'>files</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='kw'>yield</span> <span class='id identifier rubyid_s'>s</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_loaded_from'>loaded_from</span> <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_file'>spec_file</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_write_file'>write_file</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_file'>spec_file</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
      <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_to_ruby_for_cache'>to_ruby_for_cache</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_util_build_gem'>util_build_gem</span> <span class='id identifier rubyid_spec'>spec</span>

    <span class='id identifier rubyid_cache_file'>cache_file</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gems</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gem</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span> <span class='id identifier rubyid_cache_file'>cache_file</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mv'>mv</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_cache_file'>cache_file</span><span class='comma'>,</span> <span class='id identifier rubyid_cache_file'>cache_file</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm'>rm</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_file'>spec_file</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec'>spec</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="nmake_found?-instance_method">
  <h3 class='signature'>
  #<strong>nmake_found?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns whether or not the nmake command could be found.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1167
1168
1169</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1167</span>

<span class='kw'>def</span> <span class='id identifier rubyid_nmake_found?'>nmake_found?</span>
  <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nmake /? 1&gt;NUL 2&gt;&amp;1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="parse_make_command_line-instance_method">
  <h3 class='signature'>
  #<strong>parse_make_command_line</strong>(line)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_make_command_line'>parse_make_command_line</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_shellsplit'>shellsplit</span>

  <span class='id identifier rubyid_targets'>targets</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_macros'>macros</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_arg'>arg</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A(\w+)=</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_macros'>macros</span><span class='lbracket'>[</span><span class='backref'>$1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='backref'>$&#39;</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_targets'>targets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_arg'>arg</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_targets'>targets</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_targets'>targets</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='lbrace'>{</span>
    <span class='symbol'>:command</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_command'>command</span><span class='comma'>,</span>
    <span class='symbol'>:targets</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_targets'>targets</span><span class='comma'>,</span>
    <span class='symbol'>:macros</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_macros'>macros</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="process_based_port-instance_method">
  <h3 class='signature'>
  #<strong>process_based_port</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>See <a href="#process_based_port-class_method" title="Gem::TestCase.process_based_port (method)">process_based_port</a></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1191
1192
1193</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1191</span>

<span class='kw'>def</span> <span class='id identifier rubyid_process_based_port'>process_based_port</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_process_based_port'>process_based_port</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="quick_gem-instance_method">
  <h3 class='signature'>
  #<strong>quick_gem</strong>(name, version = &#39;2&#39;)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a <a href="Specification.html" title="Gem::Specification (class)">Specification</a> with a minimum of extra work. 
<code>name</code> and <code>version</code> are the gem&#39;s name and
version,  platform, author, email, homepage, summary and description are
defaulted.  The specification is yielded for customization.</p>

<p>The gem is added to the installed gems in <code>@gemhome</code> and the
runtime.</p>

<p>Use this with <a href="#write_file-instance_method" title="Gem::TestCase#write_file (method)">#write_file</a> to build an installed gem.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 617</span>

<span class='kw'>def</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems/specification</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span>    <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Platform</span><span class='op'>::</span><span class='const'>RUBY</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>        <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>     <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span>      <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A User</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span>       <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example@example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_homepage'>homepage</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_summary'>summary</span>     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>this is a summary</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is a test description</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='comment'># HACK: force specs to (re-)load before we write
</span>
  <span class='id identifier rubyid_written_path'>written_path</span> <span class='op'>=</span> <span class='id identifier rubyid_write_file'>write_file</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_file'>spec_file</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_to_ruby_for_cache'>to_ruby_for_cache</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_loaded_from'>loaded_from</span> <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_loaded_from'>loaded_from</span> <span class='op'>=</span> <span class='id identifier rubyid_written_path'>written_path</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_spec'>spec</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="quick_spec-instance_method">
  <h3 class='signature'>
  #<strong>quick_spec</strong>(name, version = &#39;2&#39;)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>TODO:  remove in RubyGems 3.0</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


649
650
651</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 649</span>

<span class='kw'>def</span> <span class='id identifier rubyid_quick_spec'>quick_spec</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_util_spec'>util_spec</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="read_binary-instance_method">
  <h3 class='signature'>
  #<strong>read_binary</strong>(path)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads a binary file at <code>path</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


584
585
586</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 584</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_binary'>read_binary</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_read_binary'>read_binary</span> <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="read_cache-instance_method">
  <h3 class='signature'>
  #<strong>read_cache</strong>(path)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads a Marshal file at <code>path</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


575
576
577
578
579</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 575</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_cache'>read_cache</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="refute_path_exists-instance_method">
  <h3 class='signature'>
  #<strong>refute_path_exists</strong>(path, msg = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>TODO: move to minitest</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


135
136
137
138</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_refute_path_exists'>refute_path_exists</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Expected path &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to not exist</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_refute'>refute</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="req-instance_method">
  <h3 class='signature'>
  #<strong>req</strong>(*requirements)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Constructs a new <a href="Requirement.html" title="Gem::Requirement (class)">Requirement</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1277
1278
1279
1280</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1277</span>

<span class='kw'>def</span> <span class='id identifier rubyid_req'>req</span> <span class='op'>*</span><span class='id identifier rubyid_requirements'>requirements</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_requirements'>requirements</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Requirement</span> <span class='op'>===</span> <span class='id identifier rubyid_requirements'>requirements</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Requirement</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='id identifier rubyid_requirements'>requirements</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="save_gemspec-instance_method">
  <h3 class='signature'>
  #<strong>save_gemspec</strong>(name = &#39;a&#39;, version = 1, directory = &#39;.&#39;)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>create_gemspec creates gem specification in given <code>direcotry</code> or
&#39;.&#39; for the given <code>name</code> and <code>version</code>.</p>

<p>Yields the <code>specification</code> to the block, if given</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1342</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save_gemspec'>save_gemspec</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_directory'>directory</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_vendor_spec'>vendor_spec</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_specification'>specification</span><span class='op'>|</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_specification'>specification</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_open'>open</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_directory'>directory</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gemspec</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_vendor_spec'>vendor_spec</span><span class='period'>.</span><span class='id identifier rubyid_to_ruby'>to_ruby</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_vendor_spec'>vendor_spec</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_directory'>directory</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="save_loaded_features-instance_method">
  <h3 class='signature'>
  #<strong>save_loaded_features</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


736
737
738
739
740
741</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 736</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save_loaded_features'>save_loaded_features</span>
  <span class='id identifier rubyid_old_loaded_features'>old_loaded_features</span> <span class='op'>=</span> <span class='gvar'>$LOADED_FEATURES</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>yield</span>
<span class='kw'>ensure</span>
  <span class='gvar'>$LOADED_FEATURES</span><span class='period'>.</span><span class='id identifier rubyid_replace'>replace</span> <span class='id identifier rubyid_old_loaded_features'>old_loaded_features</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="scan_make_command_lines-instance_method">
  <h3 class='signature'>
  #<strong>scan_make_command_lines</strong>(output)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


140
141
142</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 140</span>

<span class='kw'>def</span> <span class='id identifier rubyid_scan_make_command_lines'>scan_make_command_lines</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_make_command'>make_command</span><span class='embexpr_end'>}</span><span class='tstring_content'>(?:[[:blank:]].*)?$</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="setup-instance_method">
  <h3 class='signature'>
  #<strong>setup</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p><a href="#setup-instance_method" title="Gem::TestCase#setup (method)">#setup</a> prepares a sandboxed location to install gems.  All installs are
directed to a temporary directory.  All install plugins are removed.</p>

<p>If the <code>RUBY</code> environment variable is set the given path is used
for <a href="../Gem.html#ruby-class_method" title="Gem.ruby (method)">Gem.ruby</a>.  The local platform is set to <code>i386-mswin32</code> for
Windows or <code>i686-darwin8.10.1</code> otherwise.</p>

<p>If the <code>KEEP_FILES</code> environment variable is set the files will
not be removed from <code>/tmp/test_rubygems_#{$$}.#{Time.now.to_i}</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 217</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup'>setup</span>
  <span class='kw'>super</span>

  <span class='ivar'>@orig_gem_home</span>   <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_HOME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@orig_gem_path</span>   <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_PATH</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@orig_gem_vendor</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_VENDOR</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@orig_gem_spec_cache</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_SPEC_CACHE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@orig_rubygems_gemdeps</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBYGEMS_GEMDEPS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@orig_rubygems_host</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBYGEMS_HOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_REQUIREMENT_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_k'>k</span>
  <span class='kw'>end</span>
  <span class='ivar'>@orig_gem_env_requirements</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span>

  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_VENDOR</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='ivar'>@current_dir</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_pwd'>pwd</span>
  <span class='ivar'>@fetcher</span>     <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@ui</span>          <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>MockGemUi</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_tmpdir'>tmpdir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_tmpdir'>tmpdir</span>
  <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span>

  <span class='kw'>if</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>KEEP_FILES</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>then</span>
    <span class='ivar'>@tempdir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test_rubygems_</span><span class='embexpr_beg'>#{</span><span class='gvar'>$$</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='ivar'>@tempdir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test_rubygems_</span><span class='embexpr_beg'>#{</span><span class='gvar'>$$</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@tempdir</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span>

  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='ivar'>@tempdir</span>

  <span class='comment'># This makes the tempdir consistent on OS X.
</span>  <span class='comment'># File.expand_path Dir.tmpdir                      #=&gt; &quot;/var/...&quot;
</span>  <span class='comment'># Dir.chdir Dir.tmpdir do File.expand_path &#39;.&#39; end #=&gt; &quot;/private/var/...&quot;
</span>  <span class='comment'># TODO use File#realpath above instead of #expand_path once 1.8 support is
</span>  <span class='comment'># dropped.
</span>  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span> <span class='ivar'>@tempdir</span> <span class='kw'>do</span>
    <span class='ivar'>@tempdir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@tempdir</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span>
  <span class='kw'>end</span>

  <span class='comment'># This makes the tempdir consistent on Windows.
</span>  <span class='comment'># Dir.tmpdir may return short path name, but Dir[Dir.tmpdir] returns long
</span>  <span class='comment'># path name. https://bugs.ruby-lang.org/issues/10819
</span>  <span class='comment'># File.expand_path or File.realpath doesn&#39;t convert path name to long path
</span>  <span class='comment'># name. Only Dir[] (= Dir.glob) works.
</span>  <span class='comment'># Short and long path name is specific to Windows filesystem.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_win_platform?'>win_platform?</span>
    <span class='ivar'>@tempdir</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='lbracket'>[</span><span class='ivar'>@tempdir</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='ivar'>@tempdir</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span>
  <span class='kw'>end</span>

  <span class='ivar'>@gemhome</span>  <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gemhome</span><span class='tstring_end'>&#39;</span></span>
  <span class='ivar'>@userhome</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>userhome</span><span class='tstring_end'>&#39;</span></span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GEM_SPEC_CACHE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>spec_cache</span><span class='tstring_end'>&#39;</span></span>

  <span class='ivar'>@orig_ruby</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBY</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>then</span>
                 <span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_ruby'>ruby</span>
                 <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBY</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
                 <span class='id identifier rubyid_ruby'>ruby</span>
               <span class='kw'>end</span>

  <span class='ivar'>@git</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GIT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>git</span><span class='tstring_end'>&#39;</span></span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_ensure_gem_subdirectories'>ensure_gem_subdirectories</span> <span class='ivar'>@gemhome</span>

  <span class='ivar'>@orig_LOAD_PATH</span> <span class='op'>=</span> <span class='gvar'>$LOAD_PATH</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='gvar'>$LOAD_PATH</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
    <span class='lparen'>(</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_s'>s</span> <span class='op'>?</span> <span class='id identifier rubyid_s'>s</span> <span class='op'>:</span> <span class='id identifier rubyid_expand_path'>expand_path</span><span class='period'>.</span><span class='id identifier rubyid_untaint'>untaint</span>
  <span class='rbrace'>}</span>

  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span> <span class='ivar'>@tempdir</span>

  <span class='ivar'>@orig_ENV_HOME</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@userhome</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@user_home</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@gemdeps</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@env_requirements_by_name</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_instance_variable</span><span class='comma'>,</span> <span class='symbol'>:@ruby_version</span> <span class='kw'>if</span>
    <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variables'>instance_variables</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='symbol'>:@ruby_version</span>

  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='ivar'>@gemhome</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='ivar'>@userhome</span>

  <span class='ivar'>@orig_gem_private_key_passphrase</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_PRIVATE_KEY_PASSPHRASE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_PRIVATE_KEY_PASSPHRASE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>PRIVATE_KEY_PASSPHRASE</span>

  <span class='ivar'>@default_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span>
  <span class='ivar'>@default_spec_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@default_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>specifications</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>default</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@default_dir</span><span class='comma'>,</span> <span class='ivar'>@default_dir</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='ivar'>@default_spec_dir</span>

  <span class='comment'># We use Gem::Specification.reset the first time only so that if there
</span>  <span class='comment'># are unresolved deps that leak into the whole test suite, they&#39;re at least
</span>  <span class='comment'># reported once.
</span>  <span class='kw'>if</span> <span class='cvar'>@@initial_reset</span>
    <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_unresolved_deps'>unresolved_deps</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span> <span class='comment'># done to avoid cross-test warnings
</span>  <span class='kw'>else</span>
    <span class='cvar'>@@initial_reset</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
  <span class='kw'>end</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_use_paths'>use_paths</span><span class='lparen'>(</span><span class='ivar'>@gemhome</span><span class='rparen'>)</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Security</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_loaded_specs'>loaded_specs</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_clear_default_specs'>clear_default_specs</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_unresolved_deps'>unresolved_deps</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_verbose'>verbose</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_update_sources'>update_sources</span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>RemoteFetcher</span><span class='period'>.</span><span class='id identifier rubyid_fetcher'>fetcher</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>FakeFetcher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='ivar'>@gem_repo</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://gems.example.com/</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@uri</span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span> <span class='ivar'>@gem_repo</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_sources'>sources</span><span class='period'>.</span><span class='id identifier rubyid_replace'>replace</span> <span class='lbracket'>[</span><span class='ivar'>@gem_repo</span><span class='rbracket'>]</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_searcher'>searcher</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>SpecFetcher</span><span class='period'>.</span><span class='id identifier rubyid_fetcher'>fetcher</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@orig_BASERUBY</span> <span class='op'>=</span> <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BASERUBY</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BASERUBY</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby_install_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='ivar'>@orig_arch</span> <span class='op'>=</span> <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arch</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_win_platform?'>win_platform?</span>
    <span class='id identifier rubyid_util_set_arch'>util_set_arch</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>i386-mswin32</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_util_set_arch'>util_set_arch</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>i686-darwin8.10.1</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@marshal_version</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Marshal</span><span class='op'>::</span><span class='const'>MAJOR_VERSION</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='const'>Marshal</span><span class='op'>::</span><span class='const'>MINOR_VERSION</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@orig_LOADED_FEATURES</span> <span class='op'>=</span> <span class='gvar'>$LOADED_FEATURES</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="spec-instance_method">
  <h3 class='signature'>
  #<strong>spec</strong>(name, version, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Constructs a new <a href="Specification.html" title="Gem::Specification (class)">Specification</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1285
1286
1287</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1285</span>

<span class='kw'>def</span> <span class='id identifier rubyid_spec'>spec</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='lparen'>(</span><span class='id identifier rubyid_version'>version</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="spec_fetcher-instance_method">
  <h3 class='signature'>
  #<strong>spec_fetcher</strong>(repository = @gem_repo)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a SpecFetcher pre-filled with the gems or specs defined in the
block.</p>

<p>Yields a <code>fetcher</code> object that responds to <code>spec</code> and
<code>gem</code>.  <code>spec</code> adds a specification to the
SpecFetcher while <code>gem</code> adds both a specification and the gem
data to the RemoteFetcher so the built gem can be downloaded.</p>

<p>If only the a-3 gem is supposed to be downloaded you can save setup time by
creating only specs for the other versions:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_fetcher'>fetcher</span><span class='op'>|</span>
  <span class='id identifier rubyid_fetcher'>fetcher</span><span class='period'>.</span><span class='id identifier rubyid_spec'>spec</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>1</span>
  <span class='id identifier rubyid_fetcher'>fetcher</span><span class='period'>.</span><span class='id identifier rubyid_spec'>spec</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='int'>3</span> <span class='comment'># dependency on b = 3
</span>  <span class='id identifier rubyid_fetcher'>fetcher</span><span class='period'>.</span><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>3</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='comment'># spec is a Gem::Specification
</span>    <span class='comment'># ...
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1309
1310
1311
1312
1313</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1309</span>

<span class='kw'>def</span> <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span> <span class='id identifier rubyid_repository'>repository</span> <span class='op'>=</span> <span class='ivar'>@gem_repo</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>TestCase</span><span class='op'>::</span><span class='const'>SpecFetcherSetup</span><span class='period'>.</span><span class='id identifier rubyid_declare'>declare</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_repository'>repository</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec_fetcher_setup'>spec_fetcher_setup</span><span class='op'>|</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_spec_fetcher_setup'>spec_fetcher_setup</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="teardown-instance_method">
  <h3 class='signature'>
  #<strong>teardown</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p><a href="#teardown-instance_method" title="Gem::TestCase#teardown (method)">#teardown</a> restores the process to its original state and removes the
tempdir unless the <code>KEEP_FILES</code> environment variable was set.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 357</span>

<span class='kw'>def</span> <span class='id identifier rubyid_teardown'>teardown</span>
  <span class='gvar'>$LOAD_PATH</span><span class='period'>.</span><span class='id identifier rubyid_replace'>replace</span> <span class='ivar'>@orig_LOAD_PATH</span> <span class='kw'>if</span> <span class='ivar'>@orig_LOAD_PATH</span>
  <span class='kw'>if</span> <span class='ivar'>@orig_LOADED_FEATURES</span>
    <span class='kw'>if</span> <span class='ivar'>@orig_LOAD_PATH</span>
      <span class='id identifier rubyid_paths'>paths</span> <span class='op'>=</span> <span class='ivar'>@orig_LOAD_PATH</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span>
      <span class='lparen'>(</span><span class='gvar'>$LOADED_FEATURES</span> <span class='op'>-</span> <span class='ivar'>@orig_LOADED_FEATURES</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_feat'>feat</span><span class='op'>|</span>
        <span class='kw'>unless</span> <span class='id identifier rubyid_paths'>paths</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span> <span class='id identifier rubyid_feat'>feat</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='rbrace'>}</span>
          <span class='gvar'>$LOADED_FEATURES</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_feat'>feat</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='gvar'>$LOADED_FEATURES</span><span class='period'>.</span><span class='id identifier rubyid_replace'>replace</span> <span class='ivar'>@orig_LOADED_FEATURES</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@orig_BASERUBY</span>
    <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BASERUBY</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_BASERUBY</span>
  <span class='kw'>else</span>
    <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BASERUBY</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arch</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_arch</span>

  <span class='kw'>if</span> <span class='kw'>defined?</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>RemoteFetcher</span> <span class='kw'>then</span>
    <span class='const'>Gem</span><span class='op'>::</span><span class='const'>RemoteFetcher</span><span class='period'>.</span><span class='id identifier rubyid_fetcher'>fetcher</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span> <span class='ivar'>@current_dir</span>

  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_rf'>rm_rf</span> <span class='ivar'>@tempdir</span> <span class='kw'>unless</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>KEEP_FILES</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='ivar'>@orig_gem_env_requirements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='const'>ENV</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>
  <span class='kw'>end</span>

  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_HOME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='ivar'>@orig_gem_home</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_PATH</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='ivar'>@orig_gem_path</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_VENDOR</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_gem_vendor</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_SPEC_CACHE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_gem_spec_cache</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBYGEMS_GEMDEPS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_rubygems_gemdeps</span>
  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBYGEMS_HOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_rubygems_host</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>=</span> <span class='ivar'>@orig_ruby</span> <span class='kw'>if</span> <span class='ivar'>@orig_ruby</span>

  <span class='kw'>if</span> <span class='ivar'>@orig_ENV_HOME</span> <span class='kw'>then</span>
    <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_ENV_HOME</span>
  <span class='kw'>else</span>
    <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOME</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@default_dir</span><span class='comma'>,</span> <span class='kw'>nil</span>

  <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_PRIVATE_KEY_PASSPHRASE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@orig_gem_private_key_passphrase</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid__clear_load_cache'>_clear_load_cache</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_unresolved_deps'>unresolved_deps</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="uninstall_gem-instance_method">
  <h3 class='signature'>
  #<strong>uninstall_gem</strong>(spec)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Uninstalls the <a href="Specification.html" title="Gem::Specification (class)">Specification</a> <code>spec</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


540
541
542
543
544
545
546
547
548</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 540</span>

<span class='kw'>def</span> <span class='id identifier rubyid_uninstall_gem'>uninstall_gem</span> <span class='id identifier rubyid_spec'>spec</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems/uninstaller</span><span class='tstring_end'>&#39;</span></span>

  <span class='const'>Class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>Gem</span><span class='op'>::</span><span class='const'>Uninstaller</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_ask_if_ok'>ask_if_ok</span> <span class='id identifier rubyid_spec'>spec</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='symbol'>:executables</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbol'>:user_install</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uninstall'>uninstall</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="unresolved_names-instance_method">
  <h3 class='signature'>
  #<strong>unresolved_names</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


732
733
734</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 732</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unresolved_names'>unresolved_names</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_unresolved_deps'>unresolved_deps</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_s</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_build_gem-instance_method">
  <h3 class='signature'>
  #<strong>util_build_gem</strong>(spec)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Builds a gem from <code>spec</code> and places it in <code>File.join
@gemhome, &#39;cache&#39;</code>.  Automatically creates files based on
<code>spec.files</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 657</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_build_gem'>util_build_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dir'>dir</span> <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_gem_dir'>gem_dir</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='id identifier rubyid_dir'>dir</span>

  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span> <span class='id identifier rubyid_dir'>dir</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_file'>file</span>
      <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
      <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_fp'>fp</span><span class='op'>|</span> <span class='id identifier rubyid_fp'>fp</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'># </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_use_ui'>use_ui</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>MockGemUi</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span>
      <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Package</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span> <span class='id identifier rubyid_spec'>spec</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_cache'>cache</span> <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_cache_file'>cache_file</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mv'>mv</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_cache'>cache</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_cache'>cache</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_clear_gems-instance_method">
  <h3 class='signature'>
  #<strong>util_clear_gems</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Removes all installed gems from <code>@gemhome</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


685
686
687
688
689
690
691</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 685</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_clear_gems'>util_clear_gems</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_rf'>rm_rf</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@gemhome</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gems</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'># TODO: use Gem::Dirs
</span>  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir'>mkdir</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@gemhome</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gems</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_rf'>rm_rf</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@gemhome</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>specifications</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir'>mkdir</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@gemhome</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>specifications</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_gem-instance_method">
  <h3 class='signature'>
  #<strong>util_gem</strong>(name, version, deps = nil, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a gem with <code>name</code>, <code>version</code> and
<code>deps</code>.  The specification will be yielded before gem creation
for customization.  The gem will be placed in <code>File.join @tempdir,
&#39;gems&#39;</code>.  The specification and .gem file location are
returned.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 846</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_gem'>util_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_deps'>deps</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='comment'># TODO: deprecate
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deps or block, not both</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_deps'>deps</span> <span class='kw'>and</span> <span class='id identifier rubyid_block'>block</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_deps'>deps</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_block'>block</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
      <span class='comment'># Since Hash#each is unordered in 1.8, sort
</span>      <span class='comment'># the keys and iterate that way so the tests are
</span>      <span class='comment'># deterministic on all implementations.
</span>      <span class='id identifier rubyid_deps'>deps</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span>
        <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_add_dependency'>add_dependency</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_deps'>deps</span><span class='lbracket'>[</span><span class='id identifier rubyid_n'>n</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;= 0</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_util_build_gem'>util_build_gem</span> <span class='id identifier rubyid_spec'>spec</span>

  <span class='id identifier rubyid_cache_file'>cache_file</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@tempdir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gems</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gem</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span> <span class='id identifier rubyid_cache_file'>cache_file</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mv'>mv</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_cache_file'>cache_file</span><span class='comma'>,</span> <span class='id identifier rubyid_cache_file'>cache_file</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm'>rm</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_file'>spec_file</span>

  <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_loaded_from'>loaded_from</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='lbracket'>[</span><span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_cache_file'>cache_file</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_gzip-instance_method">
  <h3 class='signature'>
  #<strong>util_gzip</strong>(data)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Gzips <code>data</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


878
879
880
881
882
883
884
885
886</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 878</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_gzip'>util_gzip</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_out'>out</span> <span class='op'>=</span> <span class='const'>StringIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='const'>Zlib</span><span class='op'>::</span><span class='const'>GzipWriter</span><span class='period'>.</span><span class='id identifier rubyid_wrap'>wrap</span> <span class='id identifier rubyid_out'>out</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_out'>out</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_make_gems-instance_method">
  <h3 class='signature'>
  #<strong>util_make_gems</strong>(prerelease = false)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates several default gems which all have a lib/code.rb file.  The gems
are not installed but are available in the cache dir.</p>
<dl class="rdoc-list note-list"><dt><code>@a1</code>
<dd>
<p>gem a version 1, this is the best-described gem.</p>
</dd><dt><code>@a2</code>
<dd>
<p>gem a version 2</p>
</dd><dt>+@a3a
<dd>
<p>gem a version 3.a</p>
</dd><dt><code>@a_evil9</code>
<dd>
<p>gem a_evil version 9, use this to ensure similarly-named gems</p>
</dd></dl>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_don'>don</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>t collide with a.</span></span></code></pre>
<dl class="rdoc-list note-list"><dt><code>@b2</code>
<dd>
<p>gem b version 2</p>
</dd><dt><code>@c1_2</code>
<dd>
<p>gem c version 1.2</p>
</dd><dt><code>@pl1</code>
<dd>
<p>gem pl version 1, this gem has a legacy platform of i386-linux.</p>
</dd></dl>

<p>Additional <code>prerelease</code> gems may also be created:</p>
<dl class="rdoc-list note-list"><dt><code>@a2_pre</code>
<dd>
<p>gem a version 2.a</p>
</dd></dl>

<p>TODO: nuke this and fix tests. this should speed up a lot</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 906</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_make_gems'>util_make_gems</span><span class='lparen'>(</span><span class='id identifier rubyid_prerelease'>prerelease</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='ivar'>@a1</span> <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_files'>files</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib/code.rb</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_require_paths'>require_paths</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='op'>::</span><span class='const'>TODAY</span> <span class='op'>-</span> <span class='int'>86400</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_homepage'>homepage</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://a.example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>example@example.com</span><span class='words_sep'> </span><span class='tstring_content'>example2@example.com</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_authors'>authors</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>Example</span><span class='words_sep'> </span><span class='tstring_content'>Example2</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;-DESC</span>
<span class='tstring_content'>This line is really, really long.  So long, in fact, that it is more than eighty characters long!  The purpose of this line is for testing wrapping behavior because sometimes people don&#39;t wrap their text to eighty characters.  Without the wrapping, the text might not look good in the RSS feed.

Also, a list:
* An entry that\&#39;s actually kind of sort
* an entry that\&#39;s really long, which will probably get wrapped funny.  That&#39;s ok, somebody wasn&#39;t thinking straight when they made it more than eighty characters.
</span><span class='heredoc_end'>    DESC
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_init'>init</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_files'>files</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib/code.rb</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_require_paths'>require_paths</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib</span><span class='words_sep'>]</span>
  <span class='kw'>end</span>

  <span class='ivar'>@a2</span>      <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='op'>&amp;</span><span class='id identifier rubyid_init'>init</span><span class='rparen'>)</span>
  <span class='ivar'>@a3a</span>     <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>3.a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='op'>&amp;</span><span class='id identifier rubyid_init'>init</span><span class='rparen'>)</span>
  <span class='ivar'>@a_evil9</span> <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a_evil</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>9</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_init'>init</span><span class='rparen'>)</span>
  <span class='ivar'>@b2</span>      <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='op'>&amp;</span><span class='id identifier rubyid_init'>init</span><span class='rparen'>)</span>
  <span class='ivar'>@c1_2</span>    <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>c</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1.2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='op'>&amp;</span><span class='id identifier rubyid_init'>init</span><span class='rparen'>)</span>
  <span class='ivar'>@x</span>       <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>x</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='op'>&amp;</span><span class='id identifier rubyid_init'>init</span><span class='rparen'>)</span>
  <span class='ivar'>@dep_x</span>   <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dep_x</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_files'>files</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib/code.rb</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_require_paths'>require_paths</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_add_dependency'>add_dependency</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>x</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;= 1</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@pl1</span>     <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pl</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='comment'># l for legacy
</span>    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_files'>files</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib/code.rb</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_require_paths'>require_paths</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>lib</span><span class='words_sep'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Platform</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>i386-linux</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@original_platform</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>i386-linux</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_prerelease'>prerelease</span>
    <span class='ivar'>@a2_pre</span> <span class='op'>=</span> <span class='id identifier rubyid_quick_gem'>quick_gem</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2.a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_init'>init</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@a2_pre</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'> </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_util_build_gem'>util_build_gem</span> <span class='ivar'>@a2_pre</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@a1</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>      </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@a2</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>      </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@a3a</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>     </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@a_evil9</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'> </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@b2</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>      </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@c1_2</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>    </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@pl1</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>     </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@x</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>       </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_file'>write_file</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='op'>*</span><span class='words_beg'>%W[</span><span class='tstring_content'>gems</span><span class='words_sep'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@dep_x</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='words_sep'>   </span><span class='tstring_content'>lib</span><span class='words_sep'> </span><span class='tstring_content'>code.rb</span><span class='words_sep'>]</span><span class='rparen'>)</span>

  <span class='lbracket'>[</span><span class='ivar'>@a1</span><span class='comma'>,</span> <span class='ivar'>@a2</span><span class='comma'>,</span> <span class='ivar'>@a3a</span><span class='comma'>,</span> <span class='ivar'>@a_evil9</span><span class='comma'>,</span> <span class='ivar'>@b2</span><span class='comma'>,</span> <span class='ivar'>@c1_2</span><span class='comma'>,</span> <span class='ivar'>@pl1</span><span class='comma'>,</span> <span class='ivar'>@x</span><span class='comma'>,</span> <span class='ivar'>@dep_x</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='id identifier rubyid_util_build_gem'>util_build_gem</span> <span class='id identifier rubyid_spec'>spec</span>
  <span class='kw'>end</span>

  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_r'>rm_r</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='ivar'>@gemhome</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gems</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@pl1</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_remove_gem-instance_method">
  <h3 class='signature'>
  #<strong>util_remove_gem</strong>(spec)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


677
678
679
680</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 677</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_remove_gem'>util_remove_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='rparen'>)</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_rf'>rm_rf</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_cache_file'>cache_file</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_rf'>rm_rf</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_file'>spec_file</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_restore_RUBY_VERSION-instance_method">
  <h3 class='signature'>
  #<strong>util_restore_RUBY_VERSION</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1104</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_restore_RUBY_VERSION'>util_restore_RUBY_VERSION</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='symbol'>:RUBY_VERSION</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='symbol'>:RUBY_PATCHLEVEL</span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>RUBY_PATCHLEVEL</span><span class='rparen'>)</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='symbol'>:RUBY_REVISION</span>   <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>RUBY_REVISION</span><span class='rparen'>)</span>

  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span> <span class='symbol'>:RUBY_VERSION</span><span class='comma'>,</span>    <span class='ivar'>@RUBY_VERSION</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span> <span class='symbol'>:RUBY_PATCHLEVEL</span><span class='comma'>,</span> <span class='ivar'>@RUBY_PATCHLEVEL</span> <span class='kw'>if</span>
    <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@RUBY_PATCHLEVEL</span><span class='rparen'>)</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span> <span class='symbol'>:RUBY_REVISION</span><span class='comma'>,</span>   <span class='ivar'>@RUBY_REVISION</span>   <span class='kw'>if</span>
    <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@RUBY_REVISION</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_set_arch-instance_method">
  <h3 class='signature'>
  #<strong>util_set_arch</strong>(arch)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Set the platform to <code>arch</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


973
974
975
976
977
978
979
980
981</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 973</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_set_arch'>util_set_arch</span><span class='lparen'>(</span><span class='id identifier rubyid_arch'>arch</span><span class='rparen'>)</span>
  <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arch</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_arch'>arch</span>
  <span class='id identifier rubyid_platform'>platform</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Platform</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_arch'>arch</span>

  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@platforms</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Platform</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@local</span><span class='comma'>,</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_platform'>platform</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_set_RUBY_VERSION-instance_method">
  <h3 class='signature'>
  #<strong>util_set_RUBY_VERSION</strong>(version, patchlevel = nil, revision = nil)  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1085</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_set_RUBY_VERSION'>util_set_RUBY_VERSION</span><span class='lparen'>(</span><span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_patchlevel'>patchlevel</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_revision'>revision</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variables'>instance_variables</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='symbol'>:@ruby_version</span> <span class='kw'>or</span>
     <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_instance_variables'>instance_variables</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@ruby_version</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_instance_variable</span><span class='comma'>,</span> <span class='symbol'>:@ruby_version</span>
  <span class='kw'>end</span>

  <span class='ivar'>@RUBY_VERSION</span>    <span class='op'>=</span> <span class='const'>RUBY_VERSION</span>
  <span class='ivar'>@RUBY_PATCHLEVEL</span> <span class='op'>=</span> <span class='const'>RUBY_PATCHLEVEL</span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>RUBY_PATCHLEVEL</span><span class='rparen'>)</span>
  <span class='ivar'>@RUBY_REVISION</span>   <span class='op'>=</span> <span class='const'>RUBY_REVISION</span>   <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>RUBY_REVISION</span><span class='rparen'>)</span>

  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='symbol'>:RUBY_VERSION</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='symbol'>:RUBY_PATCHLEVEL</span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>RUBY_PATCHLEVEL</span><span class='rparen'>)</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='symbol'>:RUBY_REVISION</span>   <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>RUBY_REVISION</span><span class='rparen'>)</span>

  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span> <span class='symbol'>:RUBY_VERSION</span><span class='comma'>,</span>    <span class='id identifier rubyid_version'>version</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span> <span class='symbol'>:RUBY_PATCHLEVEL</span><span class='comma'>,</span> <span class='id identifier rubyid_patchlevel'>patchlevel</span> <span class='kw'>if</span> <span class='id identifier rubyid_patchlevel'>patchlevel</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span> <span class='symbol'>:RUBY_REVISION</span><span class='comma'>,</span>   <span class='id identifier rubyid_revision'>revision</span>   <span class='kw'>if</span> <span class='id identifier rubyid_revision'>revision</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_setup_fake_fetcher-instance_method">
  <h3 class='signature'>
  #<strong>util_setup_fake_fetcher</strong>(prerelease = false)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets up a fake fetcher using the gems from <a href="#util_make_gems-instance_method" title="Gem::TestCase#util_make_gems (method)">#util_make_gems</a>.  Optionally
additional <code>prerelease</code> gems may be included.</p>

<p>Gems created by this method may be fetched using <a href="RemoteFetcher.html" title="Gem::RemoteFetcher (class)">RemoteFetcher</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 989</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_setup_fake_fetcher'>util_setup_fake_fetcher</span><span class='lparen'>(</span><span class='id identifier rubyid_prerelease'>prerelease</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>zlib</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems/remote_fetcher</span><span class='tstring_end'>&#39;</span></span>

  <span class='ivar'>@fetcher</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>FakeFetcher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_util_make_gems'>util_make_gems</span><span class='lparen'>(</span><span class='id identifier rubyid_prerelease'>prerelease</span><span class='rparen'>)</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>

  <span class='ivar'>@all_gems</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@a1</span><span class='comma'>,</span> <span class='ivar'>@a2</span><span class='comma'>,</span> <span class='ivar'>@a3a</span><span class='comma'>,</span> <span class='ivar'>@a_evil9</span><span class='comma'>,</span> <span class='ivar'>@b2</span><span class='comma'>,</span> <span class='ivar'>@c1_2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
  <span class='ivar'>@all_gem_names</span> <span class='op'>=</span> <span class='ivar'>@all_gems</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_gem'>gem</span><span class='op'>|</span> <span class='id identifier rubyid_gem'>gem</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_gem_names'>gem_names</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@a1</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='comma'>,</span> <span class='ivar'>@a2</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='comma'>,</span> <span class='ivar'>@a3a</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='comma'>,</span> <span class='ivar'>@b2</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='rbracket'>]</span>
  <span class='ivar'>@gem_names</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_names'>gem_names</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>RemoteFetcher</span><span class='period'>.</span><span class='id identifier rubyid_fetcher'>fetcher</span> <span class='op'>=</span> <span class='ivar'>@fetcher</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_setup_spec_fetcher-instance_method">
  <h3 class='signature'>
  #<strong>util_setup_spec_fetcher</strong>(*specs)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets up <a href="SpecFetcher.html" title="Gem::SpecFetcher (class)">SpecFetcher</a> to return information from the gems in
<code>specs</code>. Best used with <code>@all_gems</code> from
<a href="#util_setup_fake_fetcher-instance_method" title="Gem::TestCase#util_setup_fake_fetcher (method)">#util_setup_fake_fetcher</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1021</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_setup_spec_fetcher'>util_setup_spec_fetcher</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_specs'>specs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_specs'>all_specs</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span> <span class='op'>+</span> <span class='id identifier rubyid_specs'>specs</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid__resort!'>_resort!</span> <span class='id identifier rubyid_all_specs'>all_specs</span>

  <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>SpecFetcher</span><span class='period'>.</span><span class='id identifier rubyid_fetcher'>fetcher</span>

  <span class='id identifier rubyid_prerelease'>prerelease</span><span class='comma'>,</span> <span class='id identifier rubyid_all'>all</span> <span class='op'>=</span> <span class='id identifier rubyid_all_specs'>all_specs</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_prerelease?'>prerelease?</span>  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_latest'>latest</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid__latest_specs'>_latest_specs</span> <span class='id identifier rubyid_all_specs'>all_specs</span>

  <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span><span class='period'>.</span><span class='id identifier rubyid_specs'>specs</span><span class='lbracket'>[</span><span class='ivar'>@uri</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span><span class='period'>.</span><span class='id identifier rubyid_specs'>specs</span><span class='lbracket'>[</span><span class='ivar'>@uri</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name_tuple'>name_tuple</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span><span class='period'>.</span><span class='id identifier rubyid_latest_specs'>latest_specs</span><span class='lbracket'>[</span><span class='ivar'>@uri</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_latest'>latest</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span><span class='period'>.</span><span class='id identifier rubyid_latest_specs'>latest_specs</span><span class='lbracket'>[</span><span class='ivar'>@uri</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name_tuple'>name_tuple</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span><span class='period'>.</span><span class='id identifier rubyid_prerelease_specs'>prerelease_specs</span><span class='lbracket'>[</span><span class='ivar'>@uri</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_prerelease'>prerelease</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='id identifier rubyid_spec_fetcher'>spec_fetcher</span><span class='period'>.</span><span class='id identifier rubyid_prerelease_specs'>prerelease_specs</span><span class='lbracket'>[</span><span class='ivar'>@uri</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name_tuple'>name_tuple</span>
  <span class='kw'>end</span>

  <span class='comment'># HACK for test_download_to_cache
</span>  <span class='kw'>unless</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>RemoteFetcher</span> <span class='op'>===</span> <span class='ivar'>@fetcher</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_marshal_version'>marshal_version</span>

    <span class='id identifier rubyid_specs'>specs</span> <span class='op'>=</span> <span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name_tuple'>name_tuple</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_s_zip'>s_zip</span> <span class='op'>=</span> <span class='id identifier rubyid_util_gzip'>util_gzip</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>NameTuple</span><span class='period'>.</span><span class='id identifier rubyid_to_basic'>to_basic</span> <span class='id identifier rubyid_specs'>specs</span>

    <span class='id identifier rubyid_latest_specs'>latest_specs</span> <span class='op'>=</span> <span class='id identifier rubyid_latest'>latest</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
      <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name_tuple'>name_tuple</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_l_zip'>l_zip</span> <span class='op'>=</span> <span class='id identifier rubyid_util_gzip'>util_gzip</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>NameTuple</span><span class='period'>.</span><span class='id identifier rubyid_to_basic'>to_basic</span> <span class='id identifier rubyid_latest_specs'>latest_specs</span>

    <span class='id identifier rubyid_prerelease_specs'>prerelease_specs</span> <span class='op'>=</span> <span class='id identifier rubyid_prerelease'>prerelease</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name_tuple'>name_tuple</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_p_zip'>p_zip</span> <span class='op'>=</span> <span class='id identifier rubyid_util_gzip'>util_gzip</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>NameTuple</span><span class='period'>.</span><span class='id identifier rubyid_to_basic'>to_basic</span> <span class='id identifier rubyid_prerelease_specs'>prerelease_specs</span>

    <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@gem_repo</span><span class='embexpr_end'>}</span><span class='tstring_content'>specs.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gz</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>            <span class='op'>=</span> <span class='id identifier rubyid_s_zip'>s_zip</span>
    <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@gem_repo</span><span class='embexpr_end'>}</span><span class='tstring_content'>latest_specs.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gz</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>     <span class='op'>=</span> <span class='id identifier rubyid_l_zip'>l_zip</span>
    <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@gem_repo</span><span class='embexpr_end'>}</span><span class='tstring_content'>prerelease_specs.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gz</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_p_zip'>p_zip</span>

    <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_marshal_version'>marshal_version</span>

    <span class='id identifier rubyid_all_specs'>all_specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
      <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@gem_repo</span><span class='embexpr_end'>}</span><span class='tstring_content'>quick/Marshal.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.gemspec.rz</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span> <span class='id identifier rubyid_spec'>spec</span>
      <span class='id identifier rubyid_data_deflate'>data_deflate</span> <span class='op'>=</span> <span class='const'>Zlib</span><span class='op'>::</span><span class='const'>Deflate</span><span class='period'>.</span><span class='id identifier rubyid_deflate'>deflate</span> <span class='id identifier rubyid_data'>data</span>
      <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_data_deflate'>data_deflate</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>nil</span> <span class='comment'># force errors
</span><span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_spec-instance_method">
  <h3 class='signature'>
  #<strong>util_spec</strong>(name, version = 2, deps = nil)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a spec with <code>name</code>, <code>version</code>. 
<code>deps</code> can specify the dependency or a <code>block</code> can be
given for full customization of the specification.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 811</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_spec'>util_spec</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_deps'>deps</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='comment'># :yields: specification
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deps or block, not both</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_deps'>deps</span> <span class='kw'>and</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span>    <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Platform</span><span class='op'>::</span><span class='const'>RUBY</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>        <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>     <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span>      <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A User</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span>       <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example@example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_homepage'>homepage</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://example.com</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_summary'>summary</span>     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>this is a summary</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is a test description</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>yield</span> <span class='id identifier rubyid_s'>s</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_deps'>deps</span> <span class='kw'>then</span>
    <span class='comment'># Since Hash#each is unordered in 1.8, sort the keys and iterate that
</span>    <span class='comment'># way so the tests are deterministic on all implementations.
</span>    <span class='id identifier rubyid_deps'>deps</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span>
      <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_add_dependency'>add_dependency</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_deps'>deps</span><span class='lbracket'>[</span><span class='id identifier rubyid_n'>n</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;= 0</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_spec'>spec</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="util_zip-instance_method">
  <h3 class='signature'>
  #<strong>util_zip</strong>(data)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Deflates <code>data</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1081
1082
1083</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1081</span>

<span class='kw'>def</span> <span class='id identifier rubyid_util_zip'>util_zip</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='const'>Zlib</span><span class='op'>::</span><span class='const'>Deflate</span><span class='period'>.</span><span class='id identifier rubyid_deflate'>deflate</span> <span class='id identifier rubyid_data'>data</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="v-instance_method">
  <h3 class='signature'>
  #<strong>v</strong>(string)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Construct a new <a href="Version.html" title="Gem::Version (class)">Version</a>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1318
1319
1320</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1318</span>

<span class='kw'>def</span> <span class='id identifier rubyid_v'>v</span> <span class='id identifier rubyid_string'>string</span>
  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Version</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='id identifier rubyid_string'>string</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="vc_windows?-instance_method">
  <h3 class='signature'>
  #<strong>vc_windows?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns whether or not we&#39;re on a version of Ruby built with VC++ (or
Borland) versus Cygwin, Mingw, etc.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1142
1143
1144</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vc_windows?'>vc_windows?</span>
  <span class='const'>RUBY_PLATFORM</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mswin</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="vendor_gem-instance_method">
  <h3 class='signature'>
  #<strong>vendor_gem</strong>(name = &#39;a&#39;, version = 1)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>A vendor_gem is used with a gem dependencies file.  The gem created here
has no files, just a gem specification for the given <code>name</code> and
<code>version</code>.</p>

<p>Yields the <code>specification</code> to the block, if given</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1328
1329
1330
1331
1332
1333
1334</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1328</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vendor_gem'>vendor_gem</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_directory'>directory</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>vendor</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>

  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='id identifier rubyid_directory'>directory</span>

  <span class='id identifier rubyid_save_gemspec'>save_gemspec</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='comma'>,</span> <span class='id identifier rubyid_directory'>directory</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="wait_for_child_process_to_exit-instance_method">
  <h3 class='signature'>
  #<strong>wait_for_child_process_to_exit</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>In case we&#39;re building docs in a background process, this method waits
for that process to exit (or if it&#39;s already been reaped, or never
happened, swallows the <code>Errno::ECHILD</code> error).</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1174
1175
1176
1177</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1174</span>

<span class='kw'>def</span> <span class='id identifier rubyid_wait_for_child_process_to_exit'>wait_for_child_process_to_exit</span>
  <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span> <span class='kw'>if</span> <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:fork</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECHILD</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="win_platform?-instance_method">
  <h3 class='signature'>
  #<strong>win_platform?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Is this test being run on a Windows platform?</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1126
1127
1128</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 1126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_win_platform?'>win_platform?</span>
  <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_win_platform?'>win_platform?</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="write_file-instance_method">
  <h3 class='signature'>
  #<strong>write_file</strong>(path)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes a binary file to <code>path</code> which is relative to
<code>@gemhome</code></p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


591
592
593
594
595
596
597
598
599
600
601</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/test_case.rb', line 591</span>

<span class='kw'>def</span> <span class='id identifier rubyid_write_file'>write_file</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='ivar'>@gemhome</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span> <span class='kw'>unless</span> <span class='const'>Pathname</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_absolute?'>absolute?</span>
  <span class='id identifier rubyid_dir'>dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span> <span class='id identifier rubyid_path'>path</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span> <span class='id identifier rubyid_dir'>dir</span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span> <span class='id identifier rubyid_dir'>dir</span>

  <span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_io'>io</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>
<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.8.7.6 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>