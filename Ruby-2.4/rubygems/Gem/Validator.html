<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Gem::Validator &mdash; rubygems Ruby-2.4.0 d2016-07-07</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Gem::Validator",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='../index.html'>rubygems</a> &raquo; 
          <a href='../_index.html'>Index (V)</a> &raquo; 
        #  <a href="../Gem.html" title="Gem (module)">Gem</a> &raquo; 
          <span class='title'>Validator</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: Gem::Validator</h1>

<div class="box_info">
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class='inheritName'>Object</span>
        <ul class='fullTree'>
          <li>Object</li>
            <li class='next'>Gem::Validator</li>
        </ul>
        <a href='#' class='inheritanceTree'>show all</a>
    </dd>
  </dl>

  <dl>
      <dt>Includes:</dt>
      <dd><a href="UserInteraction.html" title="Gem::UserInteraction (module)">UserInteraction</a></dd>
  </dl>


  <dl>
    <dt>Defined in:</dt>
    <dd>rubygems/validator.rb</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Validator performs various gem file and gem database validation</p>


  </div>
</div>
<div class="tags">
  
</div>
<h2>Defined Under Namespace</h2>

  <p class='children'><strong class='classes'>Classes:</strong>
    <a href="Validator/ErrorData.html" title="Gem::Validator::ErrorData (class)">ErrorData</a>
  </p>





<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#alien-instance_method" title="#alien (instance method)">#<strong>alien</strong>(gems = [])  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Checks the gem directory for the following potential
inconsistencies/problems:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#find_files_for_gem-instance_method" title="#find_files_for_gem (instance method)">#<strong>find_files_for_gem</strong>(gem_directory)  </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#verify_gem-instance_method" title="#verify_gem (instance method)">#<strong>verify_gem</strong>(gem_data)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Given a gem file&#39;s contents, validates against its own MD5 checksum</p>
<dl class="rdoc-list note-list"><dt>gem_data
<dd><dl class="rdoc-list label-list"><dt>String
<dd>
<p>Contents of the gem file</p>
</dd></dl>
</dd></dl>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#verify_gem_file-instance_method" title="#verify_gem_file (instance method)">#<strong>verify_gem_file</strong>(gem_path)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Given the path to a gem file, validates against its own MD5 checksum</p>
</div>
      </span>
    </li>
  </ul>


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="UserInteraction.html" title="Gem::UserInteraction (module)">UserInteraction</a></h3>
  <p class="inherited"><a href="UserInteraction.html#alert-instance_method" title="Gem::UserInteraction#alert (method)">#alert</a>, <a href="UserInteraction.html#alert_error-instance_method" title="Gem::UserInteraction#alert_error (method)">#alert_error</a>, <a href="UserInteraction.html#alert_warning-instance_method" title="Gem::UserInteraction#alert_warning (method)">#alert_warning</a>, <a href="UserInteraction.html#ask-instance_method" title="Gem::UserInteraction#ask (method)">#ask</a>, <a href="UserInteraction.html#ask_for_password-instance_method" title="Gem::UserInteraction#ask_for_password (method)">#ask_for_password</a>, <a href="UserInteraction.html#ask_yes_no-instance_method" title="Gem::UserInteraction#ask_yes_no (method)">#ask_yes_no</a>, <a href="UserInteraction.html#choose_from_list-instance_method" title="Gem::UserInteraction#choose_from_list (method)">#choose_from_list</a>, <a href="UserInteraction.html#say-instance_method" title="Gem::UserInteraction#say (method)">#say</a>, <a href="UserInteraction.html#terminate_interaction-instance_method" title="Gem::UserInteraction#terminate_interaction (method)">#terminate_interaction</a>, <a href="UserInteraction.html#verbose-instance_method" title="Gem::UserInteraction#verbose (method)">#verbose</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="DefaultUserInteraction.html" title="Gem::DefaultUserInteraction (module)">DefaultUserInteraction</a></h3>
  <p class="inherited"><a href="DefaultUserInteraction.html#ui-class_method" title="Gem::DefaultUserInteraction.ui (method)">.ui</a>, <a href="DefaultUserInteraction.html#ui-instance_method" title="Gem::DefaultUserInteraction#ui (method)">#ui</a>, <a href="DefaultUserInteraction.html#ui%3D-instance_method" title="Gem::DefaultUserInteraction#ui= (method)">#ui=</a>, <a href="DefaultUserInteraction.html#ui%3D-class_method" title="Gem::DefaultUserInteraction.ui= (method)">.ui=</a>, <a href="DefaultUserInteraction.html#use_ui-class_method" title="Gem::DefaultUserInteraction.use_ui (method)">.use_ui</a>, <a href="DefaultUserInteraction.html#use_ui-instance_method" title="Gem::DefaultUserInteraction#use_ui (method)">#use_ui</a></p>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="alien-instance_method">
  <h3 class='signature first'>
  #<strong>alien</strong>(gems = [])  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Checks the gem directory for the following potential
inconsistencies/problems:</p>
<ul><li>
<p>Checksum gem itself</p>
</li><li>
<p>For each file in each gem, check consistency of installed versions</p>
</li><li>
<p>Check for files that aren&#39;t part of the gem but are in the gems
directory</p>
</li><li>
<p>1 cache - 1 spec - 1 directory.</p>
</li></ul>

<p>returns a hash of ErrorData objects, keyed on the problem gem&#39;s name.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/validator.rb', line 85</span>

<span class='kw'>def</span> <span class='id identifier rubyid_alien'>alien</span><span class='lparen'>(</span><span class='id identifier rubyid_gems'>gems</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>

  <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Specification</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_default_gem?'>default_gem?</span>

    <span class='id identifier rubyid_gem_name'>gem_name</span>      <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_file_name'>file_name</span>
    <span class='id identifier rubyid_gem_path'>gem_path</span>      <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_cache_file'>cache_file</span>
    <span class='id identifier rubyid_spec_path'>spec_path</span>     <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_spec_file'>spec_file</span>
    <span class='id identifier rubyid_gem_directory'>gem_directory</span> <span class='op'>=</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_full_gem_path'>full_gem_path</span>

    <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span> <span class='id identifier rubyid_gem_directory'>gem_directory</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='rbracket'>]</span> <span class='op'>=</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Gem registered but doesn&#39;t exist at </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_directory'>gem_directory</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>

    <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_spec_path'>spec_path</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_spec_path'>spec_path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Spec file missing for installed gem</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
      <span class='id identifier rubyid_verify_gem_file'>verify_gem_file</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_path'>gem_path</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_good'>good</span><span class='comma'>,</span> <span class='id identifier rubyid_gone'>gone</span><span class='comma'>,</span> <span class='id identifier rubyid_unreadable'>unreadable</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span>

      <span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_gem_path'>gem_path</span><span class='comma'>,</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_binary_mode'>binary_mode</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
        <span class='id identifier rubyid_package'>package</span> <span class='op'>=</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Package</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_gem_path'>gem_path</span>

        <span class='id identifier rubyid_good'>good</span><span class='comma'>,</span> <span class='id identifier rubyid_gone'>gone</span> <span class='op'>=</span> <span class='id identifier rubyid_package'>package</span><span class='period'>.</span><span class='id identifier rubyid_contents'>contents</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_file_name'>file_name</span><span class='op'>|</span>
          <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_directory'>gem_directory</span><span class='comma'>,</span> <span class='id identifier rubyid_file_name'>file_name</span><span class='rparen'>)</span>
        <span class='rbrace'>}</span>

        <span class='id identifier rubyid_gone'>gone</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
          <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing file</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_good'>good</span><span class='comma'>,</span> <span class='id identifier rubyid_unreadable'>unreadable</span> <span class='op'>=</span> <span class='id identifier rubyid_good'>good</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_file_name'>file_name</span><span class='op'>|</span>
          <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_readable?'>readable?</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_directory'>gem_directory</span><span class='comma'>,</span> <span class='id identifier rubyid_file_name'>file_name</span><span class='rparen'>)</span>
        <span class='rbrace'>}</span>

        <span class='id identifier rubyid_unreadable'>unreadable</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
          <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unreadable file</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_good'>good</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
          <span class='kw'>begin</span>
            <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_data'>data</span> <span class='comment'># HACK `gem check -a mkrf`
</span>
            <span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='id identifier rubyid_gem_directory'>gem_directory</span><span class='comma'>,</span> <span class='id identifier rubyid_entry'>entry</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

            <span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_binary_mode'>binary_mode</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
              <span class='kw'>unless</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='op'>==</span> <span class='id identifier rubyid_data'>data</span> <span class='kw'>then</span>
                <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_entry'>entry</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Modified from original</span><span class='tstring_end'>&quot;</span></span>
              <span class='kw'>end</span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_installed_files'>installed_files</span> <span class='op'>=</span> <span class='id identifier rubyid_find_files_for_gem'>find_files_for_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_directory'>gem_directory</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_extras'>extras</span> <span class='op'>=</span> <span class='id identifier rubyid_installed_files'>installed_files</span> <span class='op'>-</span> <span class='id identifier rubyid_good'>good</span> <span class='op'>-</span> <span class='id identifier rubyid_unreadable'>unreadable</span>

      <span class='id identifier rubyid_extras'>extras</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_extra'>extra</span><span class='op'>|</span>
        <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_extra'>extra</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Extra file</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>rescue</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>VerificationError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_path'>gem_path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_subhash'>subhash</span><span class='op'>|</span>
    <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_subhash'>subhash</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span>
      <span class='const'>ErrorData</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_errors'>errors</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="find_files_for_gem-instance_method">
  <h3 class='signature'>
  #<strong>find_files_for_gem</strong>(gem_directory)   <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


47
48
49
50
51
52
53
54
55
56
57</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/validator.rb', line 47</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_files_for_gem'>find_files_for_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_directory'>gem_directory</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_installed_files'>installed_files</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='const'>Find</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='id identifier rubyid_gem_directory'>gem_directory</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file_name'>file_name</span><span class='op'>|</span>
    <span class='id identifier rubyid_fn'>fn</span> <span class='op'>=</span> <span class='id identifier rubyid_file_name'>file_name</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_directory'>gem_directory</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='op'>..</span><span class='id identifier rubyid_file_name'>file_name</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\/</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_installed_files'>installed_files</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_fn'>fn</span> <span class='kw'>unless</span>
      <span class='id identifier rubyid_fn'>fn</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>CVS</span><span class='regexp_end'>/</span></span> <span class='op'>||</span> <span class='id identifier rubyid_fn'>fn</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span><span class='lparen'>(</span><span class='id identifier rubyid_file_name'>file_name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_installed_files'>installed_files</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="verify_gem-instance_method">
  <h3 class='signature'>
  #<strong>verify_gem</strong>(gem_data)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Given a gem file&#39;s contents, validates against its own MD5 checksum</p>
<dl class="rdoc-list note-list"><dt>gem_data
<dd><dl class="rdoc-list label-list"><dt>String
<dd>
<p>Contents of the gem file</p>
</dd></dl>
</dd></dl>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


26
27
28
29</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/validator.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_verify_gem'>verify_gem</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_data'>gem_data</span><span class='rparen'>)</span>
  <span class='comment'># TODO remove me? The code here only validate an MD5SUM that was
</span>  <span class='comment'># in some old formatted gems, but hasn&#39;t been for a long time.
</span><span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="verify_gem_file-instance_method">
  <h3 class='signature'>
  #<strong>verify_gem_file</strong>(gem_path)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Given the path to a gem file, validates against its own MD5 checksum</p>
<dl class="rdoc-list note-list"><dt>gem_path
<dd><dl class="rdoc-list label-list"><dt>String
<dd>
<p>Path to gem file</p>
</dd></dl>
</dd></dl>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


36
37
38
39
40
41
42
43</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'rubygems/validator.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_verify_gem_file'>verify_gem_file</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_path'>gem_path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_gem_path'>gem_path</span><span class='comma'>,</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_binary_mode'>binary_mode</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
    <span class='id identifier rubyid_gem_data'>gem_data</span> <span class='op'>=</span> <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
    <span class='id identifier rubyid_verify_gem'>verify_gem</span> <span class='id identifier rubyid_gem_data'>gem_data</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span><span class='comma'>,</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EINVAL</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>VerificationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>missing gem file </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_path'>gem_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>
<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.8.7.6 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>