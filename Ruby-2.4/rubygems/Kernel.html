<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Kernel &mdash; rubygems Ruby-2.4.0 d2016-08-03</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Kernel",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='index.html'>rubygems</a> &raquo; 
          <a href='_index.html'>Index (K)</a> &raquo; 
          <span class='title'>Kernel</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: Kernel</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
<a href='https://github.com/ruby/ruby/blob/trunk/lib/rubygems/core_ext/kernel_gem.rb#L8'>lib/rubygems/core_ext/kernel_gem.rb</a><span class='defines'>,<br /><a href='https://github.com/ruby/ruby/blob/trunk/lib/rubygems/core_ext/kernel_require.rb#L10'>lib/rubygems/core_ext/kernel_require.rb</a></span>
</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>RubyGems adds the <a href="#gem-instance_method" title="Kernel#gem (method)">#gem</a> method to allow activation of specific gem
versions and overrides the <a href="#require-instance_method" title="Kernel#require (method)">#require</a> method on Kernel to make gems appear
as if they live on the <code>$LOAD_PATH</code>.  See the documentation of
these methods for further detail.</p>


  </div>
</div>
<div class="tags">
  
</div>
<h2 id='t2_cnst'>Constant Summary<small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <dl class="constants summary full">
    <dt id='RUBYGEMS_ACTIVATION_MONITOR-constant'>
      RUBYGEMS_ACTIVATION_MONITOR =
    </dt>
    <dd>
            <pre class='code'><span class='const'>Monitor</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span></pre>
    </dd>
  </dl>





<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#gem-instance_method" title="#gem (instance method)"><strong>gem</strong>(gem_name, *requirements)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Use <a href="#gem-instance_method" title="Kernel#gem (method)">#gem</a> to activate a specific version of <code>gem_name</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#require-instance_method" title="#require (instance method)"><strong>require</strong>(path)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>When RubyGems is required, <a href="#require-instance_method" title="Kernel#require (method)">#require</a> is replaced with our own which
is capable of loading gems on demand.</p>
</div>
      </span>
    </li>
  </ul>


<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="gem-instance_method">
  <h3 class='signature first'>
  <strong>gem</strong>(gem_name, *requirements)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Use <a href="#gem-instance_method" title="Kernel#gem (method)">#gem</a> to activate a specific version of <code>gem_name</code>.</p>

<p><code>requirements</code> is a list of version requirements that the
specified gem must match, most commonly “= example.version.number”.  See
<a href="Gem/Requirement.html" title="Gem::Requirement (class)">Gem::Requirement</a> for how to specify a version requirement.</p>

<p>If you will be activating the latest version of a gem, there is no need to
call <a href="#gem-instance_method" title="Kernel#gem (method)">#gem</a>, <a href="#require-instance_method" title="Kernel#require (method)">#require</a> will do the right thing for you.</p>

<p><a href="#gem-instance_method" title="Kernel#gem (method)">#gem</a> returns true if the gem was activated, otherwise false.  If
the gem could not be found, didn&#39;t match the version requirements, or a
different version was already activated, an exception will be raised.</p>

<p><a href="#gem-instance_method" title="Kernel#gem (method)">#gem</a> should be called <strong>before</strong> any require
statements (otherwise RubyGems may load a conflicting library version).</p>

<p><a href="#gem-instance_method" title="Kernel#gem (method)">#gem</a> only loads prerelease versions when prerelease
<code>requirements</code> are given:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rake</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;= 1.1.a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt; 2</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>In older RubyGems versions, the environment variable GEM_SKIP could be used
to skip activation of specified gems, for example to test out changes that
haven&#39;t been installed yet.  Now RubyGems defers to -I and the RUBYLIB
environment variable to skip activation of a gem.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby">GEM_SKIP=libA:libB ruby -I../libA -I../libB ./mycode.rb</code></pre>


  </div>
</div>
<div class="tags">
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<tt><a href="Gem/LoadError.html" title="Gem::LoadError (class)">Gem::LoadError</a></tt>)</span>
  </li>
</ul>

</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rubygems/core_ext/kernel_gem.rb#L44'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/core_ext/kernel_gem.rb', line 44</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_gem'>gem</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_requirements'>requirements</span><span class='rparen'>)</span> <span class='comment'># :doc:
</span>  <span class='id identifier rubyid_skip_list'>skip_list</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GEM_SKIP</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>:</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/LoadError.html" title="Gem::LoadError (class)">LoadError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>skipping </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_skip_list'>skip_list</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_gem_name'>gem_name</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_gem_name'>gem_name</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/Dependency.html" title="Gem::Dependency (class)">Dependency</a></span>
    <span class='kw'>unless</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/Deprecate.html" title="Gem::Deprecate (module)">Deprecate</a></span><span class='period'>.</span><span class='id identifier rubyid_skip'><a href="Gem/Deprecate.html#skip-class_method" title="Gem::Deprecate.skip (method)">skip</a></span>
      <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='period'>.</span><span class='id identifier rubyid_location_of_caller'><a href="Gem.html#location_of_caller-class_method" title="Gem.location_of_caller (method)">location_of_caller</a></span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>:Warning: Kernel.gem no longer </span><span class='tstring_end'>&quot;</span></span>\
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>accepts a Gem::Dependency object, please pass the name </span><span class='tstring_end'>&quot;</span></span>\
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>and requirements directly</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_requirements'>requirements</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_name'>gem_name</span><span class='period'>.</span><span class='id identifier rubyid_requirement'>requirement</span>
    <span class='id identifier rubyid_gem_name'>gem_name</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_name'>gem_name</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_dep'>dep</span> <span class='op'>=</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/Dependency.html" title="Gem::Dependency (class)">Dependency</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Gem/Dependency.html#new-class_method" title="Gem::Dependency.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_requirements'>requirements</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_loaded'>loaded</span> <span class='op'>=</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='period'>.</span><span class='id identifier rubyid_loaded_specs'><a href="Gem.html#loaded_specs-class_method" title="Gem.loaded_specs (method)">loaded_specs</a></span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_loaded'>loaded</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_dep'>dep</span><span class='period'>.</span><span class='id identifier rubyid_matches_spec?'>matches_spec?</span><span class='lparen'>(</span><span class='id identifier rubyid_loaded'>loaded</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='id identifier rubyid_dep'>dep</span><span class='period'>.</span><span class='id identifier rubyid_to_spec'>to_spec</span>

  <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem.html#LOADED_SPECS_MUTEX-constant" title="Gem::LOADED_SPECS_MUTEX (constant)">LOADED_SPECS_MUTEX</a></span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span>
    <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_activate'>activate</span>
  <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_spec'>spec</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="require-instance_method">
  <h3 class='signature'>
  <strong>require</strong>(path)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>When RubyGems is required, <a href="#require-instance_method" title="Kernel#require (method)">#require</a> is replaced with our own which
is capable of loading gems on demand.</p>

<p>When you call <code>require &#39;x&#39;</code>, this is what happens:</p>
<ul><li>
<p>If the file can be loaded from the existing Ruby loadpath, it is.</p>
</li><li>
<p>Otherwise, installed gems are searched for a file that matches. If it&#39;s
found in gem &#39;y&#39;, that gem is activated (added to the loadpath).</p>
</li></ul>

<p>The normal <code>require</code> functionality of returning false if that
file has already been loaded is preserved.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/lib/rubygems/core_ext/kernel_require.rb#L39'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/core_ext/kernel_require.rb', line 39</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_require'>require</span> <span class='id identifier rubyid_path'>path</span>
  <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_enter'>enter</span>

  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_to_path'>to_path</span> <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:to_path</span>

  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='period'>.</span><span class='id identifier rubyid_find_unresolved_default_spec'><a href="Gem.html#find_unresolved_default_spec-class_method" title="Gem.find_unresolved_default_spec (method)">find_unresolved_default_spec</a></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_spec'>spec</span>
    <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='period'>.</span><span class='id identifier rubyid_remove_unresolved_default_spec'><a href="Gem.html#remove_unresolved_default_spec-class_method" title="Gem.remove_unresolved_default_spec (method)">remove_unresolved_default_spec</a></span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_gem'>gem</span><span class='lparen'>(</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># If there are no unresolved deps, then we can use just try
</span>  <span class='comment'># normal require handle loading a gem from the rescue below.
</span>
  <span class='kw'>if</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/Specification.html" title="Gem::Specification (class)">Specification</a></span><span class='period'>.</span><span class='id identifier rubyid_unresolved_deps'><a href="Gem/Specification.html#unresolved_deps-class_method" title="Gem::Specification.unresolved_deps (method)">unresolved_deps</a></span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>then</span>
    <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_exit'>exit</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_gem_original_require'>gem_original_require</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># If path is for a gem that has already been loaded, don&#39;t
</span>  <span class='comment'># bother trying to find it in an unresolved gem, just go straight
</span>  <span class='comment'># to normal require.
</span>  <span class='comment'>#--
</span>  <span class='comment'># TODO request access to the C implementation of this to speed up RubyGems
</span>
  <span class='id identifier rubyid_spec'>spec</span> <span class='op'>=</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/Specification.html" title="Gem::Specification (class)">Specification</a></span><span class='period'>.</span><span class='id identifier rubyid_find_active_stub_by_path'><a href="Gem/Specification.html#find_active_stub_by_path-class_method" title="Gem::Specification.find_active_stub_by_path (method)">find_active_stub_by_path</a></span> <span class='id identifier rubyid_path'>path</span>

  <span class='kw'>begin</span>
    <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_exit'>exit</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_gem_original_require'>gem_original_require</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_spec'>spec</span>

  <span class='comment'># Attempt to find path in any unresolved gems...
</span>
  <span class='id identifier rubyid_found_specs'>found_specs</span> <span class='op'>=</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/Specification.html" title="Gem::Specification (class)">Specification</a></span><span class='period'>.</span><span class='id identifier rubyid_find_in_unresolved'><a href="Gem/Specification.html#find_in_unresolved-class_method" title="Gem::Specification.find_in_unresolved (method)">find_in_unresolved</a></span> <span class='id identifier rubyid_path'>path</span>

  <span class='comment'># If there are no directly unresolved gems, then try and find path
</span>  <span class='comment'># in any gems that are available via the currently unresolved gems.
</span>  <span class='comment'># For example, given:
</span>  <span class='comment'>#
</span>  <span class='comment'>#   a =&gt; b =&gt; c =&gt; d
</span>  <span class='comment'>#
</span>  <span class='comment'># If a and b are currently active with c being unresolved and d.rb is
</span>  <span class='comment'># requested, then find_in_unresolved_tree will find d.rb in d because
</span>  <span class='comment'># it&#39;s a dependency of c.
</span>  <span class='comment'>#
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_found_specs'>found_specs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_found_specs'>found_specs</span> <span class='op'>=</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/Specification.html" title="Gem::Specification (class)">Specification</a></span><span class='period'>.</span><span class='id identifier rubyid_find_in_unresolved_tree'><a href="Gem/Specification.html#find_in_unresolved_tree-class_method" title="Gem::Specification.find_in_unresolved_tree (method)">find_in_unresolved_tree</a></span> <span class='id identifier rubyid_path'>path</span>

    <span class='id identifier rubyid_found_specs'>found_specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_found_spec'>found_spec</span><span class='op'>|</span>
      <span class='id identifier rubyid_found_spec'>found_spec</span><span class='period'>.</span><span class='id identifier rubyid_activate'>activate</span>
    <span class='kw'>end</span>

  <span class='comment'># We found path directly in an unresolved gem. Now we figure out, of
</span>  <span class='comment'># the possible found specs, which one we should activate.
</span>  <span class='kw'>else</span>

    <span class='comment'># Check that all the found specs are just different
</span>    <span class='comment'># versions of the same gem
</span>    <span class='id identifier rubyid_names'>names</span> <span class='op'>=</span> <span class='id identifier rubyid_found_specs'>found_specs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='kw'>then</span>
      <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_exit'>exit</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/LoadError.html" title="Gem::LoadError (class)">LoadError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> found in multiple gems: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='comment'># Ok, now find a gem that has no conflicts, starting
</span>    <span class='comment'># at the highest version.
</span>    <span class='id identifier rubyid_valid'>valid</span> <span class='op'>=</span> <span class='id identifier rubyid_found_specs'>found_specs</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_has_conflicts?'>has_conflicts?</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_valid'>valid</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_le'>le</span> <span class='op'>=</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'><a href="Gem/LoadError.html" title="Gem::LoadError (class)">LoadError</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unable to find a version of &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to activate</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_le'>le</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_exit'>exit</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_le'>le</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_valid'>valid</span><span class='period'>.</span><span class='id identifier rubyid_activate'>activate</span>
  <span class='kw'>end</span>

  <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_exit'>exit</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_gem_original_require'>gem_original_require</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'>LoadError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_load_error'>load_error</span>
  <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_enter'>enter</span>

  <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_load_error'>load_error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>or</span>
        <span class='lparen'>(</span><span class='id identifier rubyid_load_error'>load_error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_end_with?'>end_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='const'><a href="Gem.html" title="Gem (module)">Gem</a></span><span class='period'>.</span><span class='id identifier rubyid_try_activate'><a href="Gem.html#try_activate-class_method" title="Gem.try_activate (method)">try_activate</a></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_require_again'>require_again</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>ensure</span>
    <span class='const'><a href="#RUBYGEMS_ACTIVATION_MONITOR-constant" title="Kernel::RUBYGEMS_ACTIVATION_MONITOR (constant)">RUBYGEMS_ACTIVATION_MONITOR</a></span><span class='period'>.</span><span class='id identifier rubyid_exit'>exit</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_gem_original_require'>gem_original_require</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_require_again'>require_again</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_load_error'>load_error</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>