<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: OpenSSL::SSL::SSLSocket &mdash; openssl Ruby-2.4.0 d2016-07-07</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL::SSL::SSLSocket",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../../index.html'>Home</a> &raquo; 
          <a href='../../../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='../../index.html'>openssl</a> &raquo; 
          <a href='../../_index.html'>Index (S)</a> &raquo; 
        #  <a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a> &raquo; 
        #  <a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a> &raquo; 
          <span class='title'>SSLSocket</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: OpenSSL::SSL::SSLSocket</h1>

<div class="box_info">
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class='inheritName'>Object</span>
        <ul class='fullTree'>
          <li>Object</li>
            <li class='next'>OpenSSL::SSL::SSLSocket</li>
        </ul>
        <a href='#' class='inheritanceTree'>show all</a>
    </dd>
  </dl>

  <dl>
      <dt>Includes:</dt>
      <dd><a href="../Buffering.html" title="OpenSSL::Buffering (module)">Buffering</a>, <a href="SocketForwarder.html" title="OpenSSL::SSL::SocketForwarder (module)">SocketForwarder</a></dd>
  </dl>


  <dl>
    <dt>Defined in:</dt>
    <dd>openssl/ossl_ssl.c<span class='defines'>,<br />
  openssl/lib/openssl/ssl.rb</span>
</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The following attributes are available but don&#39;t show up in rdoc.</p>
<ul><li>
<p>io, context, sync_close</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
</div>


  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <a href="../Buffering.html" title="OpenSSL::Buffering (module)">Buffering</a></h3>
  <p class="inherited"><a href="../Buffering.html#BLOCK_SIZE-constant" title="OpenSSL::Buffering::BLOCK_SIZE (constant)">Buffering::BLOCK_SIZE</a></p>

<h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#context-instance_method" title="#context (instance method)">#<strong>context</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#hostname-instance_method" title="#hostname (instance method)">#<strong>hostname</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#io-instance_method" title="#io (instance method)">#<strong>io</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sync_close-instance_method" title="#sync_close (instance method)">#<strong>sync_close</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
  </ul>


  
  
  <h3 class="inherited">Attributes included from <a href="../Buffering.html" title="OpenSSL::Buffering (module)">Buffering</a></h3>
  <p class="inherited"><a href="../Buffering.html#sync-instance_method" title="OpenSSL::Buffering#sync (method)">#sync</a></p>

<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(io)  &#x21d2; aSSLSocket </a>
      </span>
      <span class='note title constructor'>constructor</span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a new SSL socket from <code>io</code> which must be a real ruby
object (not an IO-like object that responds to read/write).</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#accept-instance_method" title="#accept (instance method)">#<strong>accept</strong>  &#x21d2; self </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Waits for a SSL/TLS client to initiate a handshake.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#accept_nonblock-instance_method" title="#accept_nonblock (instance method)">#<strong>accept_nonblock</strong>([options])  &#x21d2; self </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Initiates the SSL/TLS handshake as a server in non-blocking manner.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#alpn_protocol-instance_method" title="#alpn_protocol (instance method)">#<strong>alpn_protocol</strong>  &#x21d2; String </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the ALPN protocol string that was finally selected by the client
during the handshake.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#cert-instance_method" title="#cert (instance method)">#<strong>cert</strong>  &#x21d2; cert<sup>?</sup> </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>The X509 certificate for this socket endpoint.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#cipher-instance_method" title="#cipher (instance method)">#<strong>cipher</strong>  &#x21d2; Array, ... </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>The cipher being used for the current connection</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#client_ca-instance_method" title="#client_ca (instance method)">#<strong>client_ca</strong>  &#x21d2; Array, ... </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the list of client CAs.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#client_cert_cb-instance_method" title="#client_cert_cb (instance method)">#<strong>client_cert_cb</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#connect-instance_method" title="#connect (instance method)">#<strong>connect</strong>  &#x21d2; self </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Initiates an SSL/TLS handshake with a server.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#connect_nonblock-instance_method" title="#connect_nonblock (instance method)">#<strong>connect_nonblock</strong>([options])  &#x21d2; self </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Initiates the SSL/TLS handshake as a client in non-blocking manner.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#npn_protocol-instance_method" title="#npn_protocol (instance method)">#<strong>npn_protocol</strong>  &#x21d2; String </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the protocol string that was finally selected by the client during
the handshake.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#peer_cert-instance_method" title="#peer_cert (instance method)">#<strong>peer_cert</strong>  &#x21d2; cert<sup>?</sup> </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>The X509 certificate for this socket&#39;s peer.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#peer_cert_chain-instance_method" title="#peer_cert_chain (instance method)">#<strong>peer_cert_chain</strong>  &#x21d2; Array, ... </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>The X509 certificate chain for this socket&#39;s peer.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#pending-instance_method" title="#pending (instance method)">#<strong>pending</strong>  &#x21d2; Integer </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>The number of bytes that are immediately available for reading</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#post_connection_check-instance_method" title="#post_connection_check (instance method)">#<strong>post_connection_check</strong>(hostname)  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Perform hostname verification after an SSL connection is established</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#session-instance_method" title="#session (instance method)">#<strong>session</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#session%3D-instance_method" title="#session (instance method)">#<strong>session</strong>( = session)  &#x21d2; session </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sets the Session to be used when the connection is established.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#session_get_cb-instance_method" title="#session_get_cb (instance method)">#<strong>session_get_cb</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#session_new_cb-instance_method" title="#session_new_cb (instance method)">#<strong>session_new_cb</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#session_reused%3F-instance_method" title="#session_reused? (instance method)">#<strong>session_reused?</strong>  &#x21d2; Boolean </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if a reused session was negotiated during the handshake.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ssl_version-instance_method" title="#ssl_version (instance method)">#<strong>ssl_version</strong>  &#x21d2; String </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a String representing the SSL/TLS version that was negotiated for
the connection, for example “TLSv1.2”.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#state-instance_method" title="#state (instance method)">#<strong>state</strong>  &#x21d2; String </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>A description of the current connection state.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#stop-instance_method" title="#stop (instance method)">#<strong>stop</strong>  &#x21d2; nil </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sends “close notify” to the peer and tries to shut down the SSL connection
gracefully.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sysclose-instance_method" title="#sysclose (instance method)">#<strong>sysclose</strong>  &#x21d2; nil </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Sends “close notify” to the peer and tries to shut down the SSL connection
gracefully.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sysread-instance_method" title="#sysread (instance method)">#<strong>sysread</strong>(length)  &#x21d2; String </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Reads <code>length</code> bytes from the SSL connection.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sysread_nonblock-instance_method" title="#sysread_nonblock (instance method)">#<strong>sysread_nonblock</strong>(length)  &#x21d2; String </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>A non-blocking version of <a href="#sysread-instance_method" title="OpenSSL::SSL::SSLSocket#sysread (method)">#sysread</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#syswrite-instance_method" title="#syswrite (instance method)">#<strong>syswrite</strong>(string)  &#x21d2; Integer </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Writes <code>string</code> to the SSL connection.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#syswrite_nonblock-instance_method" title="#syswrite_nonblock (instance method)">#<strong>syswrite_nonblock</strong>(string)  &#x21d2; Integer </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Writes <code>string</code> to the SSL connection in a non-blocking manner.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#tmp_dh_callback-instance_method" title="#tmp_dh_callback (instance method)">#<strong>tmp_dh_callback</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#tmp_ecdh_callback-instance_method" title="#tmp_ecdh_callback (instance method)">#<strong>tmp_ecdh_callback</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#tmp_key-instance_method" title="#tmp_key (instance method)">#<strong>tmp_key</strong>  &#x21d2; PKey<sup>?</sup> </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the ephemeral key used in case of forward secrecy cipher</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_io-instance_method" title="#to_io (instance method)">#<strong>to_io</strong>  </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#using_anon_cipher%3F-instance_method" title="#using_anon_cipher? (instance method)">#<strong>using_anon_cipher?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='note title private'>private</span>
      

      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#verify_result-instance_method" title="#verify_result (instance method)">#<strong>verify_result</strong>  &#x21d2; Integer </a>
      </span>
      

      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the result of the peer certificates verification.</p>
</div>
      </span>
    </li>
  </ul>


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="SocketForwarder.html" title="OpenSSL::SSL::SocketForwarder (module)">SocketForwarder</a></h3>
  <p class="inherited"><a href="SocketForwarder.html#addr-instance_method" title="OpenSSL::SSL::SocketForwarder#addr (method)">#addr</a>, <a href="SocketForwarder.html#closed%3F-instance_method" title="OpenSSL::SSL::SocketForwarder#closed? (method)">#closed?</a>, <a href="SocketForwarder.html#do_not_reverse_lookup%3D-instance_method" title="OpenSSL::SSL::SocketForwarder#do_not_reverse_lookup= (method)">#do_not_reverse_lookup=</a>, <a href="SocketForwarder.html#fcntl-instance_method" title="OpenSSL::SSL::SocketForwarder#fcntl (method)">#fcntl</a>, <a href="SocketForwarder.html#getsockopt-instance_method" title="OpenSSL::SSL::SocketForwarder#getsockopt (method)">#getsockopt</a>, <a href="SocketForwarder.html#peeraddr-instance_method" title="OpenSSL::SSL::SocketForwarder#peeraddr (method)">#peeraddr</a>, <a href="SocketForwarder.html#setsockopt-instance_method" title="OpenSSL::SSL::SocketForwarder#setsockopt (method)">#setsockopt</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../Buffering.html" title="OpenSSL::Buffering (module)">Buffering</a></h3>
  <p class="inherited"><a href="../Buffering.html#%3C%3C-instance_method" title="OpenSSL::Buffering#&lt;&lt; (method)">#<<</a>, <a href="../Buffering.html#close-instance_method" title="OpenSSL::Buffering#close (method)">#close</a>, <a href="../Buffering.html#consume_rbuff-instance_method" title="OpenSSL::Buffering#consume_rbuff (method)">#consume_rbuff</a>, <a href="../Buffering.html#do_write-instance_method" title="OpenSSL::Buffering#do_write (method)">#do_write</a>, <a href="../Buffering.html#each-instance_method" title="OpenSSL::Buffering#each (method)">#each</a>, <a href="../Buffering.html#each_byte-instance_method" title="OpenSSL::Buffering#each_byte (method)">#each_byte</a>, <a href="../Buffering.html#eof%3F-instance_method" title="OpenSSL::Buffering#eof? (method)">#eof?</a>, <a href="../Buffering.html#fill_rbuff-instance_method" title="OpenSSL::Buffering#fill_rbuff (method)">#fill_rbuff</a>, <a href="../Buffering.html#flush-instance_method" title="OpenSSL::Buffering#flush (method)">#flush</a>, <a href="../Buffering.html#getc-instance_method" title="OpenSSL::Buffering#getc (method)">#getc</a>, <a href="../Buffering.html#gets-instance_method" title="OpenSSL::Buffering#gets (method)">#gets</a>, <a href="../Buffering.html#initialize-instance_method" title="OpenSSL::Buffering#initialize (method)">#initialize</a>, <a href="../Buffering.html#print-instance_method" title="OpenSSL::Buffering#print (method)">#print</a>, <a href="../Buffering.html#printf-instance_method" title="OpenSSL::Buffering#printf (method)">#printf</a>, <a href="../Buffering.html#puts-instance_method" title="OpenSSL::Buffering#puts (method)">#puts</a>, <a href="../Buffering.html#read-instance_method" title="OpenSSL::Buffering#read (method)">#read</a>, <a href="../Buffering.html#read_nonblock-instance_method" title="OpenSSL::Buffering#read_nonblock (method)">#read_nonblock</a>, <a href="../Buffering.html#readchar-instance_method" title="OpenSSL::Buffering#readchar (method)">#readchar</a>, <a href="../Buffering.html#readline-instance_method" title="OpenSSL::Buffering#readline (method)">#readline</a>, <a href="../Buffering.html#readlines-instance_method" title="OpenSSL::Buffering#readlines (method)">#readlines</a>, <a href="../Buffering.html#readpartial-instance_method" title="OpenSSL::Buffering#readpartial (method)">#readpartial</a>, <a href="../Buffering.html#ungetc-instance_method" title="OpenSSL::Buffering#ungetc (method)">#ungetc</a>, <a href="../Buffering.html#write-instance_method" title="OpenSSL::Buffering#write (method)">#write</a>, <a href="../Buffering.html#write_nonblock-instance_method" title="OpenSSL::Buffering#write_nonblock (method)">#write_nonblock</a></p>

  <h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  <span class='overload'>.<strong>new</strong>(io)  &#x21d2; <tt>aSSLSocket</tt> </span>
    <span class='overload'>.<strong>new</strong>(io, ctx)  &#x21d2; <tt>aSSLSocket</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a new SSL socket from <code>io</code> which must be a real ruby
object (not an IO-like object that responds to read/write).</p>

<p>If <code>ctx</code> is provided the SSL Sockets initial params will be
taken from the context.</p>

<p>The <a href="../Buffering.html" title="OpenSSL::Buffering (module)">Buffering</a> module provides additional IO methods.</p>

<p>This method will freeze the SSLContext if one is provided; however, session
management is still allowed in the frozen SSLContext.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1388
1389
1390
1391
1392
1393
1394
1395
1396
1397
1398
1399
1400
1401
1402
1403
1404
1405
1406
1407
1408
1409
1410
1411
1412
1413
1414
1415
1416
1417
1418
1419
1420
1421
1422
1423
1424
1425</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1388</span>

static VALUE
ossl_ssl_initialize(int argc, VALUE *argv, VALUE self)
{
    VALUE io, v_ctx, verify_cb;
    SSL *ssl;
    SSL_CTX *ctx;

    TypedData_Get_Struct(self, SSL, &amp;ossl_ssl_type, ssl);
    if (ssl)
	ossl_raise(eSSLError, &quot;SSL already initialized&quot;);

    if (rb_scan_args(argc, argv, &quot;11&quot;, &amp;io, &amp;v_ctx) == 1)
	v_ctx = rb_funcall(cSSLContext, rb_intern(&quot;new&quot;), 0);

    GetSSLCTX(v_ctx, ctx);
    ossl_ssl_set_ctx(self, v_ctx);
    ossl_sslctx_setup(v_ctx);

    if (rb_respond_to(io, rb_intern(&quot;nonblock=&quot;)))
	rb_funcall(io, rb_intern(&quot;nonblock=&quot;), 1, Qtrue);
    ossl_ssl_set_io(self, io);

    ossl_ssl_set_sync_close(self, Qfalse);

    ssl = SSL_new(ctx);
    if (!ssl)
	ossl_raise(eSSLError, NULL);
    RTYPEDDATA_DATA(self) = ssl;

    SSL_set_ex_data(ssl, ossl_ssl_ex_ptr_idx, (void *)self);
    SSL_set_info_callback(ssl, ssl_info_cb);
    verify_cb = ossl_sslctx_get_verify_cb(v_ctx);
    SSL_set_ex_data(ssl, ossl_ssl_ex_vcb_idx, (void *)verify_cb);

    rb_call_super(0, NULL);

    return self;
}</pre>
  </div>
</div>
</section><h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="context-instance_method">
  <h3 class='signature first'>
  #<strong>context</strong>   <span class="extras">(readonly)</span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


254</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 254</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:io</span><span class='comma'>,</span> <span class='symbol'>:context</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="hostname-instance_method">
  <h3 class='signature'>
  #<strong>hostname</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


251</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 251</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:hostname</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="io-instance_method">
  <h3 class='signature'>
  #<strong>io</strong>   <span class="extras">(readonly)</span>
  <span class='aliases'>Also known as:
    <span class='names'>
    <span>to_io</span>
</span>
  </span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


254</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 254</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:io</span><span class='comma'>,</span> <span class='symbol'>:context</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="sync_close-instance_method">
  <h3 class='signature'>
  #<strong>sync_close</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


255</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 255</span>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:sync_close</span></pre>
  </div>
</div>
</section><h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="accept-instance_method">
  <h3 class='signature first'>
  #<strong>accept</strong>  &#x21d2; <tt>self</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Waits for a SSL/TLS client to initiate a handshake.  The handshake may be
started after unencrypted data has been sent over the socket.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1584
1585
1586
1587
1588
1589
1590</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1584</span>

static VALUE
ossl_ssl_accept(VALUE self)
{
    ossl_ssl_setup(self);

    return ossl_start_ssl(self, SSL_accept, &quot;SSL_accept&quot;, Qfalse);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="accept_nonblock-instance_method">
  <h3 class='signature'>
  #<strong>accept_nonblock</strong>([options])  &#x21d2; <tt>self</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Initiates the SSL/TLS handshake as a server in non-blocking manner.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># emulates blocking accept
</span><span class='kw'>begin</span>
  <span class='id identifier rubyid_ssl'>ssl</span><span class='period'>.</span><span class='id identifier rubyid_accept_nonblock'>accept_nonblock</span>
<span class='kw'>rescue</span> <span class='const'>IO</span><span class='op'>::</span><span class='const'>WaitReadable</span>
  <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_s2'>s2</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>rescue</span> <span class='const'>IO</span><span class='op'>::</span><span class='const'>WaitWritable</span>
  <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_s2'>s2</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>end</span>
</code></pre>

<p>By specifying <tt>exception: false</tt>, the options hash allows you to indicate
that accept_nonblock should not raise an <code>IO::WaitReadable</code> or
<code>IO::WaitWritable</code> exception, but return the symbol :wait_readable or
:wait_writable instead.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1614
1615
1616
1617
1618
1619
1620
1621
1622
1623</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1614</span>

static VALUE
ossl_ssl_accept_nonblock(int argc, VALUE *argv, VALUE self)
{
    VALUE opts;

    rb_scan_args(argc, argv, &quot;0:&quot;, &amp;opts);
    ossl_ssl_setup(self);

    return ossl_start_ssl(self, SSL_accept, &quot;SSL_accept&quot;, opts);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="alpn_protocol-instance_method">
  <h3 class='signature'>
  #<strong>alpn_protocol</strong>  &#x21d2; <tt>String</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the ALPN protocol string that was finally selected by the client
during the handshake.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


2122
2123
2124
2125
2126
2127
2128
2129
2130
2131
2132
2133
2134
2135
2136</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 2122</span>

static VALUE
ossl_ssl_alpn_protocol(VALUE self)
{
    SSL *ssl;
    const unsigned char *out;
    unsigned int outlen;

    GetSSL(self, ssl);

    SSL_get0_alpn_selected(ssl, &amp;out, &amp;outlen);
    if (!outlen)
	return Qnil;
    else
	return rb_str_new((const char *) out, outlen);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="cert-instance_method">
  <h3 class='signature'>
  #<strong>cert</strong>  &#x21d2; <tt>cert</tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The X509 certificate for this socket endpoint.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1832
1833
1834
1835
1836
1837
1838
1839
1840
1841
1842
1843
1844
1845
1846
1847
1848
1849
1850</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1832</span>

static VALUE
ossl_ssl_get_cert(VALUE self)
{
    SSL *ssl;
    X509 *cert = NULL;

    GetSSL(self, ssl);

    /*
     * Is this OpenSSL bug? Should add a ref?
     * TODO: Ask for.
     */
    cert = SSL_get_certificate(ssl); /* NO DUPs =&gt; DON&#39;T FREE. */

    if (!cert) {
        return Qnil;
    }
    return ossl_x509_new(cert);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="cipher-instance_method">
  <h3 class='signature'>
  #<strong>cipher</strong>  &#x21d2; <tt>Array</tt>, ... 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The cipher being used for the current connection</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1930
1931
1932
1933
1934
1935
1936
1937
1938
1939
1940
1941</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1930</span>

static VALUE
ossl_ssl_get_cipher(VALUE self)
{
    SSL *ssl;
    SSL_CIPHER *cipher;

    GetSSL(self, ssl);

    cipher = (SSL_CIPHER *)SSL_get_current_cipher(ssl);

    return ossl_ssl_cipher_to_ary(cipher);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="client_ca-instance_method">
  <h3 class='signature'>
  #<strong>client_ca</strong>  &#x21d2; <tt>Array</tt>, <tt>...</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the list of client CAs. Please note that in contrast to
<code>SSLContext#client_ca=</code> no array of <a href="../X509/Certificate.html" title="OpenSSL::X509::Certificate (class)">X509::Certificate</a> is returned but
<a href="../X509/Name.html" title="OpenSSL::X509::Name (class)">X509::Name</a> instances of the CA&#39;s subject distinguished name.</p>

<p>In server mode, returns the list set by <code>SSLContext#client_ca=</code>. In client
mode, returns the list of client CAs sent from the server.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


2077
2078
2079
2080
2081
2082
2083
2084
2085
2086
2087</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 2077</span>

static VALUE
ossl_ssl_get_client_ca_list(VALUE self)
{
    SSL *ssl;
    STACK_OF(X509_NAME) *ca;

    GetSSL(self, ssl);

    ca = SSL_get_client_CA_list(ssl);
    return ossl_x509name_sk2ary(ca);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="client_cert_cb-instance_method">
  <h3 class='signature'>
  #<strong>client_cert_cb</strong>   <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


305
306
307</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 305</span>

<span class='kw'>def</span> <span class='id identifier rubyid_client_cert_cb'>client_cert_cb</span>
  <span class='ivar'>@context</span><span class='period'>.</span><span class='id identifier rubyid_client_cert_cb'>client_cert_cb</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="connect-instance_method">
  <h3 class='signature'>
  #<strong>connect</strong>  &#x21d2; <tt>self</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Initiates an SSL/TLS handshake with a server.  The handshake may be started
after unencrypted data has been sent over the socket.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1536
1537
1538
1539
1540
1541
1542</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1536</span>

static VALUE
ossl_ssl_connect(VALUE self)
{
    ossl_ssl_setup(self);

    return ossl_start_ssl(self, SSL_connect, &quot;SSL_connect&quot;, Qfalse);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="connect_nonblock-instance_method">
  <h3 class='signature'>
  #<strong>connect_nonblock</strong>([options])  &#x21d2; <tt>self</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Initiates the SSL/TLS handshake as a client in non-blocking manner.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># emulates blocking connect
</span><span class='kw'>begin</span>
  <span class='id identifier rubyid_ssl'>ssl</span><span class='period'>.</span><span class='id identifier rubyid_connect_nonblock'>connect_nonblock</span>
<span class='kw'>rescue</span> <span class='const'>IO</span><span class='op'>::</span><span class='const'>WaitReadable</span>
  <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_s2'>s2</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>rescue</span> <span class='const'>IO</span><span class='op'>::</span><span class='const'>WaitWritable</span>
  <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_s2'>s2</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>retry</span>
<span class='kw'>end</span>
</code></pre>

<p>By specifying <tt>exception: false</tt>, the options hash allows you to indicate
that connect_nonblock should not raise an <code>IO::WaitReadable</code> or
<code>IO::WaitWritable</code> exception, but return the symbol :wait_readable or
:wait_writable instead.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1566
1567
1568
1569
1570
1571
1572
1573
1574
1575</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1566</span>

static VALUE
ossl_ssl_connect_nonblock(int argc, VALUE *argv, VALUE self)
{
    VALUE opts;
    rb_scan_args(argc, argv, &quot;0:&quot;, &amp;opts);

    ossl_ssl_setup(self);

    return ossl_start_ssl(self, SSL_connect, &quot;SSL_connect&quot;, opts);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="npn_protocol-instance_method">
  <h3 class='signature'>
  #<strong>npn_protocol</strong>  &#x21d2; <tt>String</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the protocol string that was finally selected by the client during
the handshake.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


2097
2098
2099
2100
2101
2102
2103
2104
2105
2106
2107
2108
2109
2110
2111</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 2097</span>

static VALUE
ossl_ssl_npn_protocol(VALUE self)
{
    SSL *ssl;
    const unsigned char *out;
    unsigned int outlen;

    GetSSL(self, ssl);

    SSL_get0_next_proto_negotiated(ssl, &amp;out, &amp;outlen);
    if (!outlen)
	return Qnil;
    else
	return rb_str_new((const char *) out, outlen);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="peer_cert-instance_method">
  <h3 class='signature'>
  #<strong>peer_cert</strong>  &#x21d2; <tt>cert</tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The X509 certificate for this socket&#39;s peer.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1858
1859
1860
1861
1862
1863
1864
1865
1866
1867
1868
1869
1870
1871
1872
1873
1874
1875
1876</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1858</span>

static VALUE
ossl_ssl_get_peer_cert(VALUE self)
{
    SSL *ssl;
    X509 *cert = NULL;
    VALUE obj;

    GetSSL(self, ssl);

    cert = SSL_get_peer_certificate(ssl); /* Adds a ref =&gt; Safe to FREE. */

    if (!cert) {
        return Qnil;
    }
    obj = ossl_x509_new(cert);
    X509_free(cert);

    return obj;
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="peer_cert_chain-instance_method">
  <h3 class='signature'>
  #<strong>peer_cert_chain</strong>  &#x21d2; <tt>Array</tt>, <tt>...</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The X509 certificate chain for this socket&#39;s peer.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1884
1885
1886
1887
1888
1889
1890
1891
1892
1893
1894
1895
1896
1897
1898
1899
1900
1901
1902
1903
1904
1905</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1884</span>

static VALUE
ossl_ssl_get_peer_cert_chain(VALUE self)
{
    SSL *ssl;
    STACK_OF(X509) *chain;
    X509 *cert;
    VALUE ary;
    int i, num;

    GetSSL(self, ssl);

    chain = SSL_get_peer_cert_chain(ssl);
    if(!chain) return Qnil;
    num = sk_X509_num(chain);
    ary = rb_ary_new2(num);
    for (i = 0; i &lt; num; i++){
	cert = sk_X509_value(chain, i);
	rb_ary_push(ary, ossl_x509_new(cert));
    }

    return ary;
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="pending-instance_method">
  <h3 class='signature'>
  #<strong>pending</strong>  &#x21d2; <tt><a href="../../Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The number of bytes that are immediately available for reading</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1971
1972
1973
1974
1975
1976
1977
1978
1979</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1971</span>

static VALUE
ossl_ssl_pending(VALUE self)
{
    SSL *ssl;

    GetSSL(self, ssl);

    return INT2NUM(SSL_pending(ssl));
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="post_connection_check-instance_method">
  <h3 class='signature'>
  #<strong>post_connection_check</strong>(hostname)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Perform hostname verification after an SSL connection is established</p>

<p>This method MUST be called after calling <a href="#connect-instance_method" title="OpenSSL::SSL::SSLSocket#connect (method)">#connect</a> to ensure that the
hostname of a remote peer has been verified.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


276
277
278
279
280
281
282
283
284
285
286
287
288
289</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 276</span>

<span class='kw'>def</span> <span class='id identifier rubyid_post_connection_check'>post_connection_check</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_peer_cert'>peer_cert</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Peer verification enabled, but no certificate received.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_using_anon_cipher?'>using_anon_cipher?</span>
      <span class='id identifier rubyid_msg'>msg</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> Anonymous cipher suite </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cipher'>cipher</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> was negotiated. Anonymous suites must be disabled to use peer verification.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>SSLError</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='period'>.</span><span class='id identifier rubyid_verify_certificate_identity'>verify_certificate_identity</span><span class='lparen'>(</span><span class='id identifier rubyid_peer_cert'>peer_cert</span><span class='comma'>,</span> <span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>SSLError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hostname \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hostname'>hostname</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot; does not match the server certificate</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="session-instance_method">
  <h3 class='signature'>
  #<strong>session</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


291
292
293
294
295</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 291</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session'>session</span>
  <span class='const'>SSL</span><span class='op'>::</span><span class='const'>Session</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'>SSL</span><span class='op'>::</span><span class='const'>Session</span><span class='op'>::</span><span class='const'>SessionError</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="session=-instance_method">
  <h3 class='signature'>
  #<strong>session</strong>( = session)  &#x21d2; <tt>session</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sets the Session to be used when the connection is established.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 2003</span>

static VALUE
ossl_ssl_set_session(VALUE self, VALUE arg1)
{
    SSL *ssl;
    SSL_SESSION *sess;

    GetSSL(self, ssl);
    SafeGetSSLSession(arg1, sess);

    if (SSL_set_session(ssl, sess) != 1)
        ossl_raise(eSSLError, &quot;SSL_set_session&quot;);

    return arg1;
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="session_get_cb-instance_method">
  <h3 class='signature'>
  #<strong>session_get_cb</strong>   <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


321
322
323</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 321</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session_get_cb'>session_get_cb</span>
  <span class='ivar'>@context</span><span class='period'>.</span><span class='id identifier rubyid_session_get_cb'>session_get_cb</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="session_new_cb-instance_method">
  <h3 class='signature'>
  #<strong>session_new_cb</strong>   <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


317
318
319</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 317</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session_new_cb'>session_new_cb</span>
  <span class='ivar'>@context</span><span class='period'>.</span><span class='id identifier rubyid_session_new_cb'>session_new_cb</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="session_reused?-instance_method">
  <h3 class='signature'>
  #<strong>session_reused?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if a reused session was negotiated during the handshake.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1987
1988
1989
1990
1991
1992
1993
1994
1995</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1987</span>

static VALUE
ossl_ssl_session_reused(VALUE self)
{
    SSL *ssl;

    GetSSL(self, ssl);

    return SSL_session_reused(ssl) ? Qtrue : Qfalse;
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="ssl_version-instance_method">
  <h3 class='signature'>
  #<strong>ssl_version</strong>  &#x21d2; <tt>String</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a String representing the SSL/TLS version that was negotiated for
the connection, for example “TLSv1.2”.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1914
1915
1916
1917
1918
1919
1920
1921
1922</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1914</span>

static VALUE
ossl_ssl_get_version(VALUE self)
{
    SSL *ssl;

    GetSSL(self, ssl);

    return rb_str_new2(SSL_get_version(ssl));
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="state-instance_method">
  <h3 class='signature'>
  #<strong>state</strong>  &#x21d2; <tt>String</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>A description of the current connection state.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1949
1950
1951
1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1949</span>

static VALUE
ossl_ssl_get_state(VALUE self)
{
    SSL *ssl;
    VALUE ret;

    GetSSL(self, ssl);

    ret = rb_str_new2(SSL_state_string(ssl));
    if (ruby_verbose) {
        rb_str_cat2(ret, &quot;: &quot;);
        rb_str_cat2(ret, SSL_state_string_long(ssl));
    }
    return ret;
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="stop-instance_method">
  <h3 class='signature'>
  #<strong>stop</strong>  &#x21d2; <tt>nil</tt>  <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sends “close notify” to the peer and tries to shut down the SSL connection
gracefully.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1814
1815
1816
1817
1818
1819
1820
1821
1822
1823
1824</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1814</span>

static VALUE
ossl_ssl_stop(VALUE self)
{
    SSL *ssl;

    GetSSL(self, ssl);

    ossl_ssl_shutdown(ssl);

    return Qnil;
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="sysclose-instance_method">
  <h3 class='signature'>
  #<strong>sysclose</strong>  &#x21d2; <tt>nil</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Sends “close notify” to the peer and tries to shut down the SSL connection
gracefully.</p>

<p>If sync_close is set to <code>true</code>, the underlying IO is also
closed.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


265
266
267
268
269</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 265</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sysclose'>sysclose</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_closed?'>closed?</span>
  <span class='id identifier rubyid_stop'>stop</span>
  <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span> <span class='kw'>if</span> <span class='id identifier rubyid_sync_close'>sync_close</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="sysread-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>sysread</strong>(length)  &#x21d2; <tt>String</tt> </span>
    <span class='overload'>#<strong>sysread</strong>(length, buffer)  &#x21d2; <tt>buffer</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Reads <code>length</code> bytes from the SSL connection.  If a
pre-allocated <code>buffer</code> is provided the data will be written into
it.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1708
1709
1710
1711
1712</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1708</span>

static VALUE
ossl_ssl_read(int argc, VALUE *argv, VALUE self)
{
    return ossl_ssl_read_internal(argc, argv, self, 0);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="sysread_nonblock-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>sysread_nonblock</strong>(length)  &#x21d2; <tt>String</tt>  <span class="extras">(<span class='prvt'>private</span>)</span></span>
    <span class='overload'>#<strong>sysread_nonblock</strong>(length, buffer)  &#x21d2; <tt>buffer</tt> </span>
    <span class='overload'>#<strong>sysread_nonblock</strong>(length[, buffer [, opts]))  &#x21d2; <tt>buffer</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>A non-blocking version of <a href="#sysread-instance_method" title="OpenSSL::SSL::SSLSocket#sysread (method)">#sysread</a>.  Raises an SSLError if reading would
block.  If “exception: false” is passed, this method returns a symbol of
:wait_readable, :wait_writable, or nil, rather than raising an exception.</p>

<p>Reads <code>length</code> bytes from the SSL connection.  If a
pre-allocated <code>buffer</code> is provided the data will be written into
it.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1727
1728
1729
1730
1731</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1727</span>

static VALUE
ossl_ssl_read_nonblock(int argc, VALUE *argv, VALUE self)
{
    return ossl_ssl_read_internal(argc, argv, self, 1);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="syswrite-instance_method">
  <h3 class='signature'>
  #<strong>syswrite</strong>(string)  &#x21d2; <tt><a href="../../Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes <code>string</code> to the SSL connection.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1784
1785
1786
1787
1788</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1784</span>

static VALUE
ossl_ssl_write(VALUE self, VALUE str)
{
    return ossl_ssl_write_internal(self, str, Qfalse);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="syswrite_nonblock-instance_method">
  <h3 class='signature'>
  #<strong>syswrite_nonblock</strong>(string)  &#x21d2; <tt><a href="../../Integer.html" title="Integer (class)">Integer</a></tt>  <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Writes <code>string</code> to the SSL connection in a non-blocking manner. 
Raises an SSLError if writing would block.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


1797
1798
1799
1800
1801
1802
1803
1804
1805</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 1797</span>

static VALUE
ossl_ssl_write_nonblock(int argc, VALUE *argv, VALUE self)
{
    VALUE str, opts;

    rb_scan_args(argc, argv, &quot;1:&quot;, &amp;str, &amp;opts);

    return ossl_ssl_write_internal(self, str, opts);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="tmp_dh_callback-instance_method">
  <h3 class='signature'>
  #<strong>tmp_dh_callback</strong>   <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


309
310
311</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 309</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tmp_dh_callback'>tmp_dh_callback</span>
  <span class='ivar'>@context</span><span class='period'>.</span><span class='id identifier rubyid_tmp_dh_callback'>tmp_dh_callback</span> <span class='op'>||</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>DEFAULT_TMP_DH_CALLBACK</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="tmp_ecdh_callback-instance_method">
  <h3 class='signature'>
  #<strong>tmp_ecdh_callback</strong>   <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


313
314
315</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 313</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tmp_ecdh_callback'>tmp_ecdh_callback</span>
  <span class='ivar'>@context</span><span class='period'>.</span><span class='id identifier rubyid_tmp_ecdh_callback'>tmp_ecdh_callback</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="tmp_key-instance_method">
  <h3 class='signature'>
  #<strong>tmp_key</strong>  &#x21d2; <tt><a href="../PKey.html" title="OpenSSL::PKey (module)">PKey</a></tt><sup>?</sup> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the ephemeral key used in case of forward secrecy cipher</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


2146
2147
2148
2149
2150
2151
2152
2153
2154
2155
2156</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 2146</span>

static VALUE
ossl_ssl_tmp_key(VALUE self)
{
    SSL *ssl;
    EVP_PKEY *key;

    GetSSL(self, ssl);
    if (!SSL_get_server_tmp_key(ssl, &amp;key))
	return Qnil;
    return ossl_pkey_new(key);
}</pre>
  </div>
</div>
</section>  <section class='method_details' id="to_io-instance_method">
  <h3 class='signature'>
  #<strong>to_io</strong>  
</h3>
<div class='source_code h'>
  <pre class='lines_num'>


256</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 256</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:io</span><span class='comma'>,</span> <span class='symbol'>:context</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="using_anon_cipher?-instance_method">
  <h3 class='signature'>
  #<strong>using_anon_cipher?</strong>  &#x21d2; <tt>Boolean</tt>  <span class="extras">(<span class='prvt'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


299
300
301
302
303</pre>
  <div class='lines_code'>
      <pre class='code'><span class='info file'># File 'openssl/lib/openssl/ssl.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_using_anon_cipher?'>using_anon_cipher?</span>
  <span class='id identifier rubyid_ctx'>ctx</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>SSLContext</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_ctx'>ctx</span><span class='period'>.</span><span class='id identifier rubyid_ciphers'>ciphers</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>aNULL</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_ctx'>ctx</span><span class='period'>.</span><span class='id identifier rubyid_ciphers'>ciphers</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cipher'>cipher</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
  </div>
</div>
</section>  <section class='method_details' id="verify_result-instance_method">
  <h3 class='signature'>
  #<strong>verify_result</strong>  &#x21d2; <tt><a href="../../Integer.html" title="Integer (class)">Integer</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the result of the peer certificates verification.  See verify(1)
for error values and descriptions.</p>

<p>If no peer certificate was presented X509_V_OK is returned.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


2056
2057
2058
2059
2060
2061
2062
2063
2064</pre>
  <div class='lines_code'>
      <pre class='code cpp'><span class='info file'># File 'openssl/ossl_ssl.c', line 2056</span>

static VALUE
ossl_ssl_get_verify_result(VALUE self)
{
    SSL *ssl;

    GetSSL(self, ssl);

    return INT2FIX(SSL_get_verify_result(ssl));
}</pre>
  </div>
</div>
</section>
<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.8.7.6 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>