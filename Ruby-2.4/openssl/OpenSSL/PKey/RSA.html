<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: OpenSSL::PKey::RSA &mdash; openssl Ruby-2.4.0 d2016-08-04</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL::PKey::RSA",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../../index.html'>Home</a> &raquo; 
          <a href='../../../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='../../index.html'>openssl</a> &raquo; 
          <a href='../../_index.html'>Index (R)</a> &raquo; 
          <a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a> &raquo; 
          <a href="../PKey.html" title="OpenSSL::PKey (module)">PKey</a> &raquo; 
          <span class='title'>RSA</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: OpenSSL::PKey::RSA</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'><a href="PKey.html" title="OpenSSL::PKey::PKey (class)">PKey</a></span>
      <ul class='fullTree'>
        <li>Object</li>
        <li class='next'><a href="PKey.html" title="OpenSSL::PKey::PKey (class)">PKey</a></li>
        <li class='next'>OpenSSL::PKey::RSA</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>
  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L684'>ext/openssl/ossl_pkey_rsa.c</a></div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>RSA is an asymmetric public key algorithm that has been formalized in RFC
3447. It is in widespread use in public key infrastuctures (PKI) where
certificates (cf. <a href="../X509.html" title="OpenSSL::X509 (module)">X509</a>::Certificate) often are issued on the
basis of a public/private RSA key pair. RSA is used in a wide field of
applications such as secure (symmetric) key exchange, e.g. when
establishing a secure TLS/SSL connection. It is also used in various
digital signature schemes.</p>


  </div>
</div>
<div class="tags">
  
</div>




<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#generate-class_method" title="generate (class method)">.<strong>generate</strong>(size)  &#x21d2; RSA </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Generates an RSA keypair.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(key_size)  &#x21d2; RSA </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Generates or loads an RSA keypair.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#export-instance_method" title="#export (instance method)">#<strong>export</strong>([cipher, pass_phrase])  &#x21d2; PEM-format String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#to_s-instance_method" title="OpenSSL::PKey::RSA#to_s (method)">#to_s</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#params-instance_method" title="#params (instance method)">#<strong>params</strong>  &#x21d2; Hash </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>THIS METHOD IS INSECURE, PRIVATE INFORMATION CAN LEAK OUT!!!</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#private%3F-instance_method" title="#private? (instance method)">#<strong>private?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Does this keypair contain a private key?</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#private_decrypt-instance_method" title="#private_decrypt (instance method)">#<strong>private_decrypt</strong>(string)  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Decrypt <code>string</code>, which has been encrypted with the public key,
with the private key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#private_encrypt-instance_method" title="#private_encrypt (instance method)">#<strong>private_encrypt</strong>(string)  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Encrypt <code>string</code> with the private key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#public%3F-instance_method" title="#public? (instance method)">#<strong>public?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The return value is always true since every private key is also a public
key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#public_decrypt-instance_method" title="#public_decrypt (instance method)">#<strong>public_decrypt</strong>(string)  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Decrypt <code>string</code>, which has been encrypted with the private key,
with the public key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#public_encrypt-instance_method" title="#public_encrypt (instance method)">#<strong>public_encrypt</strong>(string)  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Encrypt <code>string</code> with the public key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#public_key-instance_method" title="#public_key (instance method)">#<strong>public_key</strong>  &#x21d2; RSA </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Makes new RSA instance containing the public key from the private key.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#set_crt_params-instance_method" title="#set_crt_params (instance method)">#<strong>set_crt_params</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#set_factors-instance_method" title="#set_factors (instance method)">#<strong>set_factors</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#set_key-instance_method" title="#set_key (instance method)">#<strong>set_key</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_der-instance_method" title="#to_der (instance method)">#<strong>to_der</strong>  &#x21d2; DER-format String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Outputs this keypair in DER encoding.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_pem-instance_method" title="#to_pem (instance method)">#<strong>to_pem</strong>([cipher, pass_phrase])  &#x21d2; PEM-format String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#to_s-instance_method" title="OpenSSL::PKey::RSA#to_s (method)">#to_s</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>([cipher, pass_phrase])  &#x21d2; PEM-format String </a>
        (also: #export, #to_pem)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Outputs this keypair in PEM encoding.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_text-instance_method" title="#to_text (instance method)">#<strong>to_text</strong>  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>THIS METHOD IS INSECURE, PRIVATE INFORMATION CAN LEAK OUT!!!</p>
</div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <a href="PKey.html" title="OpenSSL::PKey::PKey (class)">PKey</a></h3>
  <p class="inherited"><a href="PKey.html#sign-instance_method" title="OpenSSL::PKey::PKey#sign (method)">#sign</a>, <a href="PKey.html#verify-instance_method" title="OpenSSL::PKey::PKey#verify (method)">#verify</a></p>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  <span class='overload'>.<strong>new</strong>(key_size)  &#x21d2; <tt><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></tt> </span>
    <span class='overload'>.<strong>new</strong>(encoded_key)  &#x21d2; <tt><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></tt> </span>
    <span class='overload'>.<strong>new</strong>(encoded_key, pass_phrase)  &#x21d2; <tt><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Generates or loads an RSA keypair.  If an integer <code>key_size</code> is
given it represents the desired key size.  Keys less than 1024 bits should
be considered insecure.</p>

<p>A key can instead be loaded from an <code>encoded_key</code> which must be
PEM or DER encoded.  A <code>pass_phrase</code> can be used to decrypt the
key.  If none is given OpenSSL will prompt for the pass phrase.</p>

<h2 id="label-Examples">Examples</h2>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../PKey.html" title="OpenSSL::PKey (module)">PKey</a></span><span class='op'>::</span><span class='const'><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='int'>2048</span>
<span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../PKey.html" title="OpenSSL::PKey (module)">PKey</a></span><span class='op'>::</span><span class='const'><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rsa.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../PKey.html" title="OpenSSL::PKey (module)">PKey</a></span><span class='op'>::</span><span class='const'><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rsa.pem</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my pass phrase</span><span class='tstring_end'>&#39;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L220'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 220</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_initialize(int argc, VALUE *argv, VALUE self)
{
    EVP_PKEY *pkey;
    RSA *rsa;
    BIO *in;
    VALUE arg, pass;

    GetPKey(self, pkey);
    if(rb_scan_args(argc, argv, &quot;02&quot;, &amp;arg, &amp;pass) == 0) {
	rsa = RSA_new();
    }
    else if (FIXNUM_P(arg)) {
	rsa = rsa_generate(FIX2INT(arg), NIL_P(pass) ? RSA_F4 : NUM2ULONG(pass));
	if (!rsa) ossl_raise(eRSAError, NULL);
    }
    else {
	pass = ossl_pem_passwd_value(pass);
	arg = ossl_to_der_if_possible(arg);
	in = ossl_obj2bio(arg);
	rsa = PEM_read_bio_RSAPrivateKey(in, NULL, ossl_pem_passwd_cb, (void *)pass);
	if (!rsa) {
	    OSSL_BIO_reset(in);
	    rsa = PEM_read_bio_RSA_PUBKEY(in, NULL, NULL, NULL);
	}
	if (!rsa) {
	    OSSL_BIO_reset(in);
	    rsa = d2i_RSAPrivateKey_bio(in, NULL);
	}
	if (!rsa) {
	    OSSL_BIO_reset(in);
	    rsa = d2i_RSA_PUBKEY_bio(in, NULL);
	}
	if (!rsa) {
	    OSSL_BIO_reset(in);
	    rsa = PEM_read_bio_RSAPublicKey(in, NULL, NULL, NULL);
	}
	if (!rsa) {
	    OSSL_BIO_reset(in);
	    rsa = d2i_RSAPublicKey_bio(in, NULL);
	}
	BIO_free(in);
	if (!rsa) {
	    ossl_raise(eRSAError, &quot;Neither PUB key nor PRIV key&quot;);
	}
    }
    if (!EVP_PKEY_assign_RSA(pkey, rsa)) {
	RSA_free(rsa);
	ossl_raise(eRSAError, NULL);
    }

    return self;
}
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="generate-class_method">
  <h3 class='signature first'>
  <span class='overload'>.<strong>generate</strong>(size)  &#x21d2; <tt><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></tt> </span>
    <span class='overload'>.<strong>generate</strong>(size, exponent)  &#x21d2; <tt><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Generates an RSA keypair.  <code>size</code> is an integer representing the
desired key size.  Keys smaller than 1024 should be considered insecure. 
<code>exponent</code> is an odd number normally 3, 17, or 65537.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L179'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 179</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_s_generate(int argc, VALUE *argv, VALUE klass)
{
/* why does this method exist?  why can&#39;t initialize take an optional exponent? */
    RSA *rsa;
    VALUE size, exp;
    VALUE obj;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;size, &amp;exp);

    rsa = rsa_generate(NUM2INT(size), NIL_P(exp) ? RSA_F4 : NUM2ULONG(exp)); /* err handled by rsa_instance */
    obj = rsa_instance(klass, rsa);

    if (obj == Qfalse) {
	RSA_free(rsa);
	ossl_raise(eRSAError, NULL);
    }

    return obj;
}
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="export-instance_method">
  <h3 class='signature first'>
  <span class='overload'>#<strong>export</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
    <span class='overload'>#<strong>to_pem</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
    <span class='overload'>#<strong>to_s</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#to_s-instance_method" title="OpenSSL::PKey::RSA#to_s (method)">#to_s</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="params-instance_method">
  <h3 class='signature'>
  #<strong>params</strong>  &#x21d2; <tt>Hash</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>THIS METHOD IS INSECURE, PRIVATE INFORMATION CAN LEAK OUT!!!</p>

<p>Stores all parameters of key to the hash.  The hash has keys &#39;n&#39;,
&#39;e&#39;, &#39;d&#39;, &#39;p&#39;, &#39;q&#39;, &#39;dmp1&#39;,
&#39;dmq1&#39;, &#39;iqmp&#39;.</p>

<p>Don&#39;t use :-)) (It&#39;s up to you)</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L552'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 552</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_get_params(VALUE self)
{
    RSA *rsa;
    VALUE hash;
    const BIGNUM *n, *e, *d, *p, *q, *dmp1, *dmq1, *iqmp;

    GetRSA(self, rsa);
    RSA_get0_key(rsa, &amp;n, &amp;e, &amp;d);
    RSA_get0_factors(rsa, &amp;p, &amp;q);
    RSA_get0_crt_params(rsa, &amp;dmp1, &amp;dmq1, &amp;iqmp);

    hash = rb_hash_new();
    rb_hash_aset(hash, rb_str_new2(&quot;n&quot;), ossl_bn_new(n));
    rb_hash_aset(hash, rb_str_new2(&quot;e&quot;), ossl_bn_new(e));
    rb_hash_aset(hash, rb_str_new2(&quot;d&quot;), ossl_bn_new(d));
    rb_hash_aset(hash, rb_str_new2(&quot;p&quot;), ossl_bn_new(p));
    rb_hash_aset(hash, rb_str_new2(&quot;q&quot;), ossl_bn_new(q));
    rb_hash_aset(hash, rb_str_new2(&quot;dmp1&quot;), ossl_bn_new(dmp1));
    rb_hash_aset(hash, rb_str_new2(&quot;dmq1&quot;), ossl_bn_new(dmq1));
    rb_hash_aset(hash, rb_str_new2(&quot;iqmp&quot;), ossl_bn_new(iqmp));

    return hash;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="private?-instance_method">
  <h3 class='signature'>
  #<strong>private?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Does this keypair contain a private key?</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L320'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


320
321
322
323
324
325
326
327
328</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 320</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_is_private(VALUE self)
{
    RSA *rsa;

    GetRSA(self, rsa);

    return RSA_PRIVATE(self, rsa) ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="private_decrypt-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>private_decrypt</strong>(string)  &#x21d2; <tt>String</tt> </span>
    <span class='overload'>#<strong>private_decrypt</strong>(string, padding)  &#x21d2; <tt>String</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Decrypt <code>string</code>, which has been encrypted with the public key,
with the private key.  <code>padding</code> defaults to PKCS1_PADDING.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L515'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 515</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_private_decrypt(int argc, VALUE *argv, VALUE self)
{
    RSA *rsa;
    const BIGNUM *rsa_n;
    int buf_len, pad;
    VALUE str, buffer, padding;

    GetRSA(self, rsa);
    RSA_get0_key(rsa, &amp;rsa_n, NULL, NULL);
    if (!rsa_n)
	ossl_raise(eRSAError, &quot;incomplete RSA&quot;);
    if (!RSA_PRIVATE(self, rsa))
	ossl_raise(eRSAError, &quot;private key needed.&quot;);
    rb_scan_args(argc, argv, &quot;11&quot;, &amp;buffer, &amp;padding);
    pad = (argc == 1) ? RSA_PKCS1_PADDING : NUM2INT(padding);
    StringValue(buffer);
    str = rb_str_new(0, ossl_rsa_buf_size(rsa));
    buf_len = RSA_private_decrypt(RSTRING_LENINT(buffer), (unsigned char *)RSTRING_PTR(buffer),
				  (unsigned char *)RSTRING_PTR(str), rsa, pad);
    if (buf_len &lt; 0) ossl_raise(eRSAError, NULL);
    rb_str_set_len(str, buf_len);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="private_encrypt-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>private_encrypt</strong>(string)  &#x21d2; <tt>String</tt> </span>
    <span class='overload'>#<strong>private_encrypt</strong>(string, padding)  &#x21d2; <tt>String</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Encrypt <code>string</code> with the private key.  <code>padding</code>
defaults to PKCS1_PADDING. The encrypted string output can be decrypted
using <a href="#public_decrypt-instance_method" title="OpenSSL::PKey::RSA#public_decrypt (method)">#public_decrypt</a>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L481'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 481</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_private_encrypt(int argc, VALUE *argv, VALUE self)
{
    RSA *rsa;
    const BIGNUM *rsa_n;
    int buf_len, pad;
    VALUE str, buffer, padding;

    GetRSA(self, rsa);
    RSA_get0_key(rsa, &amp;rsa_n, NULL, NULL);
    if (!rsa_n)
	ossl_raise(eRSAError, &quot;incomplete RSA&quot;);
    if (!RSA_PRIVATE(self, rsa))
	ossl_raise(eRSAError, &quot;private key needed.&quot;);
    rb_scan_args(argc, argv, &quot;11&quot;, &amp;buffer, &amp;padding);
    pad = (argc == 1) ? RSA_PKCS1_PADDING : NUM2INT(padding);
    StringValue(buffer);
    str = rb_str_new(0, ossl_rsa_buf_size(rsa));
    buf_len = RSA_private_encrypt(RSTRING_LENINT(buffer), (unsigned char *)RSTRING_PTR(buffer),
				  (unsigned char *)RSTRING_PTR(str), rsa, pad);
    if (buf_len &lt; 0) ossl_raise(eRSAError, NULL);
    rb_str_set_len(str, buf_len);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="public?-instance_method">
  <h3 class='signature'>
  #<strong>public?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The return value is always true since every private key is also a public
key.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L301'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


301
302
303
304
305
306
307
308
309
310
311
312</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 301</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_is_public(VALUE self)
{
    RSA *rsa;

    GetRSA(self, rsa);
    /*
     * This method should check for n and e.  BUG.
     */
    (void)rsa;
    return Qtrue;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="public_decrypt-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>public_decrypt</strong>(string)  &#x21d2; <tt>String</tt> </span>
    <span class='overload'>#<strong>public_decrypt</strong>(string, padding)  &#x21d2; <tt>String</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Decrypt <code>string</code>, which has been encrypted with the private key,
with the public key.  <code>padding</code> defaults to PKCS1_PADDING.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L449'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 449</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_public_decrypt(int argc, VALUE *argv, VALUE self)
{
    RSA *rsa;
    const BIGNUM *rsa_n;
    int buf_len, pad;
    VALUE str, buffer, padding;

    GetRSA(self, rsa);
    RSA_get0_key(rsa, &amp;rsa_n, NULL, NULL);
    if (!rsa_n)
	ossl_raise(eRSAError, &quot;incomplete RSA&quot;);
    rb_scan_args(argc, argv, &quot;11&quot;, &amp;buffer, &amp;padding);
    pad = (argc == 1) ? RSA_PKCS1_PADDING : NUM2INT(padding);
    StringValue(buffer);
    str = rb_str_new(0, ossl_rsa_buf_size(rsa));
    buf_len = RSA_public_decrypt(RSTRING_LENINT(buffer), (unsigned char *)RSTRING_PTR(buffer),
				 (unsigned char *)RSTRING_PTR(str), rsa, pad);
    if (buf_len &lt; 0) ossl_raise(eRSAError, NULL);
    rb_str_set_len(str, buf_len);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="public_encrypt-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>public_encrypt</strong>(string)  &#x21d2; <tt>String</tt> </span>
    <span class='overload'>#<strong>public_encrypt</strong>(string, padding)  &#x21d2; <tt>String</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Encrypt <code>string</code> with the public key.  <code>padding</code>
defaults to PKCS1_PADDING. The encrypted string output can be decrypted
using <a href="#private_decrypt-instance_method" title="OpenSSL::PKey::RSA#private_decrypt (method)">#private_decrypt</a>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L417'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 417</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_public_encrypt(int argc, VALUE *argv, VALUE self)
{
    RSA *rsa;
    const BIGNUM *rsa_n;
    int buf_len, pad;
    VALUE str, buffer, padding;

    GetRSA(self, rsa);
    RSA_get0_key(rsa, &amp;rsa_n, NULL, NULL);
    if (!rsa_n)
	ossl_raise(eRSAError, &quot;incomplete RSA&quot;);
    rb_scan_args(argc, argv, &quot;11&quot;, &amp;buffer, &amp;padding);
    pad = (argc == 1) ? RSA_PKCS1_PADDING : NUM2INT(padding);
    StringValue(buffer);
    str = rb_str_new(0, ossl_rsa_buf_size(rsa));
    buf_len = RSA_public_encrypt(RSTRING_LENINT(buffer), (unsigned char *)RSTRING_PTR(buffer),
				 (unsigned char *)RSTRING_PTR(str), rsa, pad);
    if (buf_len &lt; 0) ossl_raise(eRSAError, NULL);
    rb_str_set_len(str, buf_len);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="public_key-instance_method">
  <h3 class='signature'>
  #<strong>public_key</strong>  &#x21d2; <tt><a href="" title="OpenSSL::PKey::RSA (class)">RSA</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Makes new RSA instance containing the public key from the private key.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L613'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 613</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_to_public_key(VALUE self)
{
    EVP_PKEY *pkey;
    RSA *rsa;
    VALUE obj;

    GetPKeyRSA(self, pkey);
    /* err check performed by rsa_instance */
    rsa = RSAPublicKey_dup(EVP_PKEY_get0_RSA(pkey));
    obj = rsa_instance(CLASS_OF(self), rsa);
    if (obj == Qfalse) {
	RSA_free(rsa);
	ossl_raise(eRSAError, NULL);
    }
    return obj;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="set_crt_params-instance_method">
  <h3 class='signature'>
  #<strong>set_crt_params</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L723'>GitHub</a> ]</span>

</section>
  <section class='method_details' id="set_factors-instance_method">
  <h3 class='signature'>
  #<strong>set_factors</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L722'>GitHub</a> ]</span>

</section>
  <section class='method_details' id="set_key-instance_method">
  <h3 class='signature'>
  #<strong>set_key</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L721'>GitHub</a> ]</span>

</section>
  <section class='method_details' id="to_der-instance_method">
  <h3 class='signature'>
  #<strong>to_der</strong>  &#x21d2; <tt>DER-format String</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Outputs this keypair in DER encoding.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L382'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 382</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_to_der(VALUE self)
{
    RSA *rsa;
    int (*i2d_func)_((const RSA*, unsigned char**));
    unsigned char *p;
    long len;
    VALUE str;

    GetRSA(self, rsa);
    if (RSA_HAS_PRIVATE(rsa))
	i2d_func = i2d_RSAPrivateKey;
    else
	i2d_func = (int (*)(const RSA*, unsigned char**))i2d_RSA_PUBKEY;
    if((len = i2d_func(rsa, NULL)) &lt;= 0)
	ossl_raise(eRSAError, NULL);
    str = rb_str_new(0, len);
    p = (unsigned char *)RSTRING_PTR(str);
    if(i2d_func(rsa, &amp;p) &lt; 0)
	ossl_raise(eRSAError, NULL);
    ossl_str_adjust(str, p);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="to_pem-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>export</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
    <span class='overload'>#<strong>to_pem</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
    <span class='overload'>#<strong>to_s</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#to_s-instance_method" title="OpenSSL::PKey::RSA#to_s (method)">#to_s</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="to_s-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>export</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
    <span class='overload'>#<strong>to_pem</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
    <span class='overload'>#<strong>to_s</strong>([cipher, pass_phrase])  &#x21d2; <tt>PEM-format String</tt> </span>
  <span class='aliases'>Also known as: <span class='names'><span>export</span>, <span>to_pem</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Outputs this keypair in PEM encoding.  If <code>cipher</code> and
<code>pass_phrase</code> are given they will be used to encrypt the key. 
<code>cipher</code> must be an <a href="../Cipher/Cipher.html" title="OpenSSL::Cipher::Cipher (class)">Cipher::Cipher</a> instance.</p>


  </div>
</div>
  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L340'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 340</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_export(int argc, VALUE *argv, VALUE self)
{
    RSA *rsa;
    BIO *out;
    const EVP_CIPHER *ciph = NULL;
    VALUE cipher, pass, str;

    GetRSA(self, rsa);

    rb_scan_args(argc, argv, &quot;02&quot;, &amp;cipher, &amp;pass);

    if (!NIL_P(cipher)) {
	ciph = GetCipherPtr(cipher);
	pass = ossl_pem_passwd_value(pass);
    }
    if (!(out = BIO_new(BIO_s_mem()))) {
	ossl_raise(eRSAError, NULL);
    }
    if (RSA_HAS_PRIVATE(rsa)) {
	if (!PEM_write_bio_RSAPrivateKey(out, rsa, ciph, NULL, 0,
					 ossl_pem_passwd_cb, (void *)pass)) {
	    BIO_free(out);
	    ossl_raise(eRSAError, NULL);
	}
    } else {
	if (!PEM_write_bio_RSA_PUBKEY(out, rsa)) {
	    BIO_free(out);
	    ossl_raise(eRSAError, NULL);
	}
    }
    str = ossl_membio2str(out);

    return str;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="to_text-instance_method">
  <h3 class='signature'>
  #<strong>to_text</strong>  &#x21d2; <tt>String</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>THIS METHOD IS INSECURE, PRIVATE INFORMATION CAN LEAK OUT!!!</p>

<p>Dumps all parameters of a keypair to a String</p>

<p>Don&#39;t use :-)) (It&#39;s up to you)</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_pkey_rsa.c#L587'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_pkey_rsa.c', line 587</span></pre>
<pre class='code cpp'>

static VALUE
ossl_rsa_to_text(VALUE self)
{
    RSA *rsa;
    BIO *out;
    VALUE str;

    GetRSA(self, rsa);
    if (!(out = BIO_new(BIO_s_mem()))) {
	ossl_raise(eRSAError, NULL);
    }
    if (!RSA_print(out, rsa, 0)) { /* offset = 0 */
	BIO_free(out);
	ossl_raise(eRSAError, NULL);
    }
    str = ossl_membio2str(out);

    return str;
}
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>