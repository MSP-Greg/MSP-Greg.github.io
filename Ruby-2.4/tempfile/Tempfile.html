<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Tempfile &mdash; tempfile Ruby-2.4.0 d2016-07-21</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Tempfile",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='index.html'>tempfile</a> &raquo; 
          <a href='_index.html'>Index (T)</a> &raquo; 
          <span class='title'>Tempfile</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: Tempfile</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'>File</span>
      <ul class='fullTree'>
        <li>Object</li>
        <li class='next'>File</li>
        <li class='next'>Tempfile</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <a href="Tempfile/Remover.html" title="Tempfile::Remover (class)">Remover</a>
    </td>
  </tr>




  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
tempfile.rb</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A utility class for managing temporary files. When you create a Tempfile
object, it will create a temporary file with a unique filename. A Tempfile
objects behaves just like a File object, and you can perform all the usual
file operations on it: reading data, writing data, changing its
permissions, etc. So although this class does not explicitly document all
instance methods supported by File, you can in fact call any File instance
method on a Tempfile object.</p>

<h3 id="label-Synopsis">Synopsis</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tempfile</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>      <span class='comment'># =&gt; A unique filename in the OS&#39;s temp directory,
</span>               <span class='comment'>#    e.g.: &quot;/tmp/foo.24722.0&quot;
</span>               <span class='comment'>#    This filename contains &#39;foo&#39; in its basename.
</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello world</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_rewind'>rewind</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>      <span class='comment'># =&gt; &quot;hello world&quot;
</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span>    <span class='comment'># deletes the temp file
</span></code></pre>

<h3 id="label-Good+practices">Good practices</h3>

<h4 id="label-Explicit+close">Explicit close</h4>

<p>When a Tempfile object is garbage collected, or when the Ruby interpreter
exits, its associated temporary file is automatically deleted. This means
that&#39;s it&#39;s unnecessary to explicitly delete a Tempfile after use,
though it&#39;s good practice to do so: not explicitly deleting unused
Tempfiles can potentially leave behind large amounts of tempfiles on the
filesystem until they&#39;re garbage collected. The existence of these temp
files can make it harder to determine a new Tempfile filename.</p>

<p>Therefore, one should always call <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a> or close in an ensure block,
like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>begin</span>
   <span class='comment'>#...do something with file...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
   <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span>   <span class='comment'># deletes the temp file
</span><span class='kw'>end</span></code></pre>

<h4 id="label-Unlink+after+creation">Unlink after creation</h4>

<p>On POSIX systems, it&#39;s possible to unlink a file right after creating
it, and before closing it. This removes the filesystem entry without
closing the file handle, so it ensures that only the processes that already
had the file handle open can access the file&#39;s contents. It&#39;s
strongly recommended that you do this if you do not want any other
processes to be able to read from or write to the Tempfile, and you do not
need to know the Tempfile&#39;s filename either.</p>

<p>For example, a practical use case for unlink-after-creation would be this:
you need a large byte buffer that&#39;s too large to comfortably fit in
RAM, e.g. when you&#39;re writing a web server and you want to buffer the
client&#39;s file upload data.</p>

<p>Please refer to <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a> for more information and a code example.</p>

<h3 id="label-Minor+notes">Minor notes</h3>

<p>Tempfile&#39;s filename picking method is both thread-safe and
inter-process-safe: it guarantees that no other threads or processes will
pick the same filename.</p>

<p>Tempfile itself however may not be entirely thread-safe. If you access the
same Tempfile object from multiple threads then you should protect it with
a mutex.</p>


  </div>
</div>
<div class="tags">
  
</div>




<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#create-class_method" title=".create (class method)">.<strong>create</strong>(basename, tmpdir = nil, mode: 0, **options)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a temporary file as usual File object (not Tempfile).</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(basename = &quot;&quot;, [tmpdir = Dir.tmpdir], [options])  &#x21d2; Tempfile </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a temporary file with permissions 0600 (= only readable and
writable by the owner) and opens it with mode “w+”.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#open-class_method" title=".open (class method)">.<strong>open</strong>(*args)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Creates a new Tempfile.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>(unlink_now = false)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Closes the file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close%21-instance_method" title="#close! (instance method)">#<strong>close!</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Closes and unlinks (deletes) the file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>:stopdoc:</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#length-instance_method" title="#length (instance method)">#<strong>length</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#size-instance_method" title="Tempfile#size (method)">#size</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#open-instance_method" title="#open (instance method)">#<strong>open</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Opens or reopens the file with mode “r+”.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#path-instance_method" title="#path (instance method)">#<strong>path</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the full path name of the temporary file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#size-instance_method" title="#size (instance method)">#<strong>size</strong>  </a>
        (also: #length)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the size of the temporary file.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#unlink-instance_method" title="#unlink (instance method)">#<strong>unlink</strong>  </a>
        (also: #delete)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Unlinks (deletes) the file from the filesystem.</p>
</div>
      </span>
    </li>
  </ul>



  <h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(basename = &quot;&quot;, [tmpdir = Dir.tmpdir], [options])  &#x21d2; <tt><a href="" title="Tempfile (class)">Tempfile</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a temporary file with permissions 0600 (= only readable and
writable by the owner) and opens it with mode “w+”.</p>

<p>The <code>basename</code> parameter is used to determine the name of the
temporary file. You can either pass a String or an Array with 2 String
elements. In the former form, the temporary file&#39;s base name will begin
with the given string. In the latter form, the temporary file&#39;s base
name will begin with the array&#39;s first element, and end with the second
element. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>  <span class='comment'># =&gt; something like: &quot;/tmp/hello2843-8392-92849382--0&quot;
</span>
<span class='comment'># Use the Array form to enforce an extension in the filename:
</span><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.jpg</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>  <span class='comment'># =&gt; something like: &quot;/tmp/hello2843-8392-92849382--0.jpg&quot;
</span></code></pre>

<p>The temporary file will be placed in the directory as specified by the
<code>tmpdir</code> parameter. By default, this is <code>Dir.tmpdir</code>. When $SAFE
&gt; 0 and the given <code>tmpdir</code> is tainted, it uses &#39;/tmp&#39;
as the temporary directory. Please note that ENV values are tainted by
default, and <code>Dir.tmpdir</code>&#39;s return value might come from environment
variables (e.g. <code>$TMPDIR</code>).</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home/aisaka</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>  <span class='comment'># =&gt; something like: &quot;/home/aisaka/hello2843-8392-92849382--0&quot;
</span></code></pre>

<p>You can also pass an options hash. Under the hood, Tempfile creates the
temporary file using <code>File.open</code>. These options will be passed to
<code>File.open</code>. This is mostly useful for specifying encoding options, e.g.:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home/aisaka</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:encoding</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ascii-8bit</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># You can also omit the &#39;tmpdir&#39; parameter:
</span><span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:encoding</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ascii-8bit</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Exceptions">Exceptions</h3>

<p>If <a href="#new-class_method" title="Tempfile.new (method)">new</a> cannot find a unique filename within a limited number of
tries, then it will raise an exception.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_basename'>basename</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tempfile.new doesn&#39;t call the given block.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='ivar'>@unlinked</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@mode</span> <span class='op'>=</span> <span class='id identifier rubyid_mode'>mode</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>RDWR</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>CREAT</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>EXCL</span>
  <span class='op'>::</span><span class='const'>Dir</span><span class='op'>::</span><span class='const'>Tmpname</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>|</span>
    <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:perm</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0600</span>
    <span class='ivar'>@tmpfile</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='ivar'>@mode</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='ivar'>@opts</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='kw'>end</span>
  <span class='const'>ObjectSpace</span><span class='period'>.</span><span class='id identifier rubyid_define_finalizer'>define_finalizer</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='const'>Remover</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='ivar'>@tmpfile</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='kw'>super</span><span class='lparen'>(</span><span class='ivar'>@tmpfile</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="create-class_method">
  <h3 class='signature first'>
  .<strong>create</strong>(basename, tmpdir = nil, mode: 0, **options)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a temporary file as usual File object (not Tempfile). It
doesn&#39;t use finalizer and delegation.</p>

<p>If no block is given, this is similar to <a href="#new-class_method" title="Tempfile.new (method)">new</a> except creating
File instead of Tempfile. The created file is not removed automatically.
You should use <code>File.unlink</code> to remove it.</p>

<p>If a block is given, then a File object will be constructed, and the block
is invoked with the object as the argument. The File object will be
automatically closed and the temporary file is removed after the block
terminates. The call returns the value of the block.</p>

<p>In any case, all arguments (<code>*args</code>) will be treated as
<a href="#new-class_method" title="Tempfile.new (method)">new</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home/temp</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
   <span class='comment'>#... do something with f ...
</span><span class='kw'>end</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 326</span>

<span class='kw'>def</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='const'>Dir</span><span class='op'>::</span><span class='const'>Tmpname</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_basename'>basename</span><span class='comma'>,</span> <span class='id identifier rubyid_tmpdir'>tmpdir</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>|</span>
    <span class='id identifier rubyid_mode'>mode</span> <span class='op'>|=</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>RDWR</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>CREAT</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>EXCL</span>
    <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:perm</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0600</span>
    <span class='id identifier rubyid_tmpfile'>tmpfile</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_tmpname'>tmpname</span><span class='comma'>,</span> <span class='id identifier rubyid_mode'>mode</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_tmpfile'>tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_tmpfile'>tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_closed?'>closed?</span>
      <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span> <span class='id identifier rubyid_tmpfile'>tmpfile</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tmpfile'>tmpfile</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="open-class_method">
  <h3 class='signature'>
  .<strong>open</strong>(*args)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Creates a new Tempfile.</p>

<p>If no block is given, this is a synonym for <a href="#new-class_method" title="Tempfile.new (method)">new</a>.</p>

<p>If a block is given, then a Tempfile object will be constructed, and the
block is run with said object as argument. The Tempfile object will be
automatically closed after the block terminates. The call returns the value
of the block.</p>

<p>In any case, all arguments (<code>*args</code>) will be passed to
<a href="#new-class_method" title="Tempfile.new (method)">new</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home/temp</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
   <span class='comment'>#... do something with f ...
</span><span class='kw'>end</span>

<span class='comment'># Equivalent:
</span><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home/temp</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>begin</span>
   <span class='comment'>#... do something with f ...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


290
291
292
293
294
295
296
297
298
299
300
301
302</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 290</span>

<span class='kw'>def</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tempfile'>tempfile</span> <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_tempfile'>tempfile</span><span class='rparen'>)</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_tempfile'>tempfile</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tempfile'>tempfile</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="close-instance_method">
  <h3 class='signature first'>
  #<strong>close</strong>(unlink_now = false)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Closes the file. If <code>unlink_now</code> is true, then the file will be
unlinked (deleted) after closing. Of course, you can choose to later call
<a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a> if you do not unlink it now.</p>

<p>If you don&#39;t explicitly unlink the temporary file, the removal will be
delayed until the object is finalized.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


160
161
162
163</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span><span class='lparen'>(</span><span class='id identifier rubyid_unlink_now'>unlink_now</span><span class='op'>=</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__close'>_close</span>
  <span class='id identifier rubyid_unlink'>unlink</span> <span class='kw'>if</span> <span class='id identifier rubyid_unlink_now'>unlink_now</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close!-instance_method">
  <h3 class='signature'>
  #<strong>close!</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Closes and unlinks (deletes) the file. Has the same effect as called
<code>close(true)</code>.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


167
168
169</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 167</span>

<span class='kw'>def</span> <span class='id identifier rubyid_close!'>close!</span>
  <span class='id identifier rubyid_close'>close</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="delete-instance_method">
  <h3 class='signature'>
  #<strong>delete</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="inspect-instance_method">
  <h3 class='signature'>
  #<strong>inspect</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>:stopdoc:</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


236
237
238
239
240
241
242</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 236</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_closed?'>closed?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> (closed)&gt;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="length-instance_method">
  <h3 class='signature'>
  #<strong>length</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#size-instance_method" title="Tempfile#size (method)">#size</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="open-instance_method">
  <h3 class='signature'>
  #<strong>open</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Opens or reopens the file with mode “r+”.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


142
143
144
145
146
147</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_open'>open</span>
  <span class='id identifier rubyid__close'>_close</span>
  <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='ivar'>@mode</span> <span class='op'>&amp;</span> <span class='op'>~</span><span class='lparen'>(</span><span class='const'>File</span><span class='op'>::</span><span class='const'>CREAT</span><span class='op'>|</span><span class='const'>File</span><span class='op'>::</span><span class='const'>EXCL</span><span class='rparen'>)</span>
  <span class='ivar'>@tmpfile</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='ivar'>@tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_mode'>mode</span><span class='comma'>,</span> <span class='ivar'>@opts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___setobj__'>__setobj__</span><span class='lparen'>(</span><span class='ivar'>@tmpfile</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="path-instance_method">
  <h3 class='signature'>
  #<strong>path</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the full path name of the temporary file. This will be nil if
<a href="#unlink-instance_method" title="Tempfile#unlink (method)">#unlink</a> has been called.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


220
221
222</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 220</span>

<span class='kw'>def</span> <span class='id identifier rubyid_path'>path</span>
  <span class='ivar'>@unlinked</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='ivar'>@tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="size-instance_method">
  <h3 class='signature'>
  #<strong>size</strong>  
  <span class='aliases'>Also known as: <span class='names'><span>length</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the size of the temporary file.  As a side effect, the IO buffer is
flushed before determining the size.</p>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


226
227
228
229
230
231
232</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 226</span>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_closed?'>closed?</span>
    <span class='ivar'>@tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'># File#size calls rb_io_flush_raw()
</span>  <span class='kw'>else</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_size?'>size?</span><span class='lparen'>(</span><span class='ivar'>@tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="unlink-instance_method">
  <h3 class='signature'>
  #<strong>unlink</strong>  
  <span class='aliases'>Also known as: <span class='names'><span>delete</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Unlinks (deletes) the file from the filesystem. One should always unlink
the file after using it, as is explained in the “Explicit close” good
practice section in the Tempfile overview:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>begin</span>
   <span class='comment'>#...do something with file...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
   <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span>   <span class='comment'># deletes the temp file
</span><span class='kw'>end</span></code></pre>

<h3 id="label-Unlink-before-close">Unlink-before-close</h3>

<p>On POSIX systems it&#39;s possible to unlink a file before closing it. This
practice is explained in detail in the Tempfile overview (section “Unlink
after creation”); please refer there for more information.</p>

<p>However, unlink-before-close may not be supported on non-POSIX operating
systems. Microsoft Windows is the most notable case: unlinking a non-closed
file will result in an error, which this method will silently ignore. If
you want to practice unlink-before-close whenever possible, then you should
write code like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span>   <span class='comment'># On Windows this silently fails.
</span><span class='kw'>begin</span>
   <span class='comment'>#... do something with file ...
</span><span class='kw'>ensure</span>
   <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_close!'>close!</span>   <span class='comment'># Closes the file handle. If the file wasn&#39;t unlinked
</span>                 <span class='comment'># because #unlink failed, then this method will attempt
</span>                 <span class='comment'># to do so again.
</span><span class='kw'>end</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


204
205
206
207
208
209
210
211
212
213
214
215</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'tempfile.rb', line 204</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unlink'>unlink</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@unlinked</span>
  <span class='kw'>begin</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span><span class='lparen'>(</span><span class='ivar'>@tmpfile</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span>
  <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EACCES</span>
    <span class='comment'># may not be able to unlink on Windows; just ignore
</span>    <span class='kw'>return</span>
  <span class='kw'>end</span>
  <span class='const'>ObjectSpace</span><span class='period'>.</span><span class='id identifier rubyid_undefine_finalizer'>undefine_finalizer</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@unlinked</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.4 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>