<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: WIN32OLE_TYPELIB &mdash; win32ole Ruby-2.4.0 d2016-07-21</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "WIN32OLE_TYPELIB",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Ruby-2.4.0</a> &raquo; 
          <a href='index.html'>win32ole</a> &raquo; 
          <a href='_index.html'>Index (W)</a> &raquo; 
          <span class='title'>WIN32OLE_TYPELIB</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: WIN32OLE_TYPELIB</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'>Object</span>
      <ul class='fullTree'>
        <li>Object</li>
        <li class='next'>WIN32OLE_TYPELIB</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>





  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
win32ole/win32ole_typelib.c</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p><a href="" title="WIN32OLE_TYPELIB (class)">WIN32OLE_TYPELIB</a> objects represent OLE tyblib information.</p>


  </div>
</div>
<div class="tags">
  
</div>




<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(typelib[, version1, version2])  &#x21d2; WIN32OLE_TYPELIB object </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns a new WIN32OLE_TYPELIB object.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#typelibs-class_method" title="typelibs (class method)">.<strong>typelibs</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the array of WIN32OLE_TYPELIB object.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#guid-instance_method" title="#guid (instance method)">#<strong>guid</strong>  &#x21d2; The guid string. </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns guid string which specifies type library.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the type library name with class name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#library_name-instance_method" title="#library_name (instance method)">#<strong>library_name</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns library name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#major_version-instance_method" title="#major_version (instance method)">#<strong>major_version</strong>  &#x21d2; The type library major version. </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the type library major version.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#minor_version-instance_method" title="#minor_version (instance method)">#<strong>minor_version</strong>  &#x21d2; The type library minor version. </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the type library minor version.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; The type library name </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#to_s-instance_method" title="WIN32OLE_TYPELIB#to_s (method)">#to_s</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ole_classes-instance_method" title="#ole_classes (instance method)">#<strong>ole_classes</strong>  &#x21d2; The array of WIN32OLE_TYPE object included the type library. </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Alias for <a href="#ole_types-instance_method" title="WIN32OLE_TYPELIB#ole_types (method)">#ole_types</a>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#ole_classes-instance_method" title="#ole_types (instance method)">#<strong>ole_types</strong>  &#x21d2; The array of WIN32OLE_TYPE object included the type library. </a>
        (also: #ole_classes)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the type library file path.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#path-instance_method" title="#path (instance method)">#<strong>path</strong>  &#x21d2; The type library file path. </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the type library file path.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  &#x21d2; The type library name </a>
        (also: #name)
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the type library name.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#version-instance_method" title="#version (instance method)">#<strong>version</strong>  &#x21d2; The type library version String object. </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the type library version.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#visible%3F-instance_method" title="#visible? (instance method)">#<strong>visible?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns true if the type library information is not hidden.</p>
</div>
      </span>
    </li>
  </ul>


<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(typelib[, version1, version2])  &#x21d2; <tt><a href="" title="WIN32OLE_TYPELIB (class)">WIN32OLE_TYPELIB</a> object</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns a new WIN32OLE_TYPELIB object.</p>

<p>The first argument <em>typelib</em>  specifies OLE type library name or
GUID or OLE library file. The second argument is major version or version
of the type library. The third argument is minor version. The second
argument and third argument are optional. If the first argument is type
library name, then the second and third argument are ignored.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib1'>tlib1</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib2'>tlib2</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{00020813-0000-0000-C000-000000000046}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib3'>tlib3</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{00020813-0000-0000-C000-000000000046}</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='float'>1.3</span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib4'>tlib4</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{00020813-0000-0000-C000-000000000046}</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>3</span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib5'>tlib5</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C:\\WINNT\\SYSTEM32\\SHELL32.DLL</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib1'>tlib1</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; &#39;Microsoft Excel 9.0 Object Library&#39;
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib2'>tlib2</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; &#39;Microsoft Excel 9.0 Object Library&#39;
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib3'>tlib3</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; &#39;Microsoft Excel 9.0 Object Library&#39;
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib4'>tlib4</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; &#39;Microsoft Excel 9.0 Object Library&#39;
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib5'>tlib5</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; &#39;Microsoft Shell Controls And Automation&#39;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 391</span>

static VALUE
foletypelib_initialize(VALUE self, VALUE args)
{
    VALUE found = Qfalse;
    VALUE typelib = Qnil;
    int len = 0;
    OLECHAR * pbuf;
    ITypeLib *pTypeLib;
    HRESULT hr = S_OK;

    len = RARRAY_LEN(args);
    rb_check_arity(len, 1, 3);

    typelib = rb_ary_entry(args, 0);

    SafeStringValue(typelib);

    found = oletypelib_search_registry(self, typelib);
    if (found == Qfalse) {
        found = oletypelib_search_registry2(self, args);
    }
    if (found == Qfalse) {
        pbuf = ole_vstr2wc(typelib);
        hr = LoadTypeLibEx(pbuf, REGKIND_NONE, &amp;pTypeLib);
        SysFreeString(pbuf);
        if (SUCCEEDED(hr)) {
            found = Qtrue;
            oletypelib_set_member(self, pTypeLib);
        }
    }

    if (found == Qfalse) {
        rb_raise(eWIN32OLERuntimeError, &quot;not found type library `%s`&quot;,
                 StringValuePtr(typelib));
    }
    return self;
}
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Class Method Details</h2>
  <section class='method_details first' id="typelibs-class_method">
  <h3 class='signature first'>
  .<strong>typelibs</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the array of WIN32OLE_TYPELIB object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlibs'>tlibs</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_typelibs'>typelibs</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 145</span>

static VALUE
foletypelib_s_typelibs(VALUE self)
{
    HKEY htypelib, hguid;
    DWORD i, j;
    LONG err;
    VALUE guid;
    VALUE version;
    VALUE name = Qnil;
    VALUE typelibs = rb_ary_new();
    VALUE typelib = Qnil;
    HRESULT hr;
    ITypeLib *pTypeLib;

    err = reg_open_key(HKEY_CLASSES_ROOT, &quot;TypeLib&quot;, &amp;htypelib);
    if(err != ERROR_SUCCESS) {
        return typelibs;
    }
    for(i = 0; ; i++) {
        guid = reg_enum_key(htypelib, i);
        if (guid == Qnil)
            break;
        err = reg_open_vkey(htypelib, guid, &amp;hguid);
        if (err != ERROR_SUCCESS)
            continue;
        for(j = 0; ; j++) {
            version = reg_enum_key(hguid, j);
            if (version == Qnil)
                break;
            if ( (name = reg_get_val2(hguid, StringValuePtr(version))) != Qnil ) {
                hr = oletypelib_from_guid(guid, version, &amp;pTypeLib);
                if (SUCCEEDED(hr)) {
                    typelib = create_win32ole_typelib(pTypeLib);
                    rb_ary_push(typelibs, typelib);
                }
            }
        }
        RegCloseKey(hguid);
    }
    RegCloseKey(htypelib);
    return typelibs;
}
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="guid-instance_method">
  <h3 class='signature first'>
  #<strong>guid</strong>  &#x21d2; <tt>The <a href="#guid-instance_method" title="WIN32OLE_TYPELIB#guid (method)">guid</a> string.</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns guid string which specifies type library.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_guid'>guid</span> <span class='op'>=</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_guid'>guid</span> <span class='comment'># -&gt; &#39;{00020813-0000-0000-C000-000000000046}&#39;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 438</span>

static VALUE
foletypelib_guid(VALUE self)
{
    ITypeLib *pTypeLib;
    OLECHAR bstr[80];
    VALUE guid = Qnil;
    int len;
    TLIBATTR *pTLibAttr;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    len = StringFromGUID2(&amp;pTLibAttr-&gt;guid, bstr, sizeof(bstr)/sizeof(OLECHAR));
    if (len &gt; 3) {
        guid = ole_wc2vstr(bstr, FALSE);
    }
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return guid;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="inspect-instance_method">
  <h3 class='signature'>
  #<strong>inspect</strong>  &#x21d2; <tt>String</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the type library name with class name.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span> <span class='comment'># =&gt; &quot;&lt;#WIN32OLE_TYPELIB:Microsoft Excel 9.0 Object Library&gt;&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


819
820
821
822
823</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 819</span>

static VALUE
foletypelib_inspect(VALUE self)
{
    return default_inspect(self, &quot;WIN32OLE_TYPELIB&quot;);
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="library_name-instance_method">
  <h3 class='signature'>
  #<strong>library_name</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns library name. If the method fails to access library name,
WIN32OLERuntimeError is raised.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_library_name'>library_name</span> <span class='comment'># =&gt; Excel
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 647</span>

static VALUE
foletypelib_library_name(VALUE self)
{
    HRESULT hr;
    ITypeLib *pTypeLib = NULL;
    VALUE libname = Qnil;
    BSTR bstr;

    pTypeLib = itypelib(self);
    hr = pTypeLib-&gt;lpVtbl-&gt;GetDocumentation(pTypeLib, -1,
                                            &amp;bstr, NULL, NULL, NULL);
    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to get library name&quot;);
    }
    libname = WC2VSTR(bstr);
    return libname;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="major_version-instance_method">
  <h3 class='signature'>
  #<strong>major_version</strong>  &#x21d2; <tt>The type library major <a href="#version-instance_method" title="WIN32OLE_TYPELIB#version (method)">version</a>.</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the type library major version.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_major_version'>major_version</span> <span class='comment'># -&gt; 1
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


533
534
535
536
537
538
539
540
541
542
543
544
545</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 533</span>

static VALUE
foletypelib_major_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    VALUE major;
    ITypeLib *pTypeLib;
    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);

    major =  INT2NUM(pTLibAttr-&gt;wMajorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return major;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="minor_version-instance_method">
  <h3 class='signature'>
  #<strong>minor_version</strong>  &#x21d2; <tt>The type library minor <a href="#version-instance_method" title="WIN32OLE_TYPELIB#version (method)">version</a>.</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the type library minor version.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_minor_version'>minor_version</span> <span class='comment'># -&gt; 3
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


556
557
558
559
560
561
562
563
564
565
566
567</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 556</span>

static VALUE
foletypelib_minor_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    VALUE minor;
    ITypeLib *pTypeLib;
    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    minor =  INT2NUM(pTLibAttr-&gt;wMinorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return minor;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="name-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>to_s</strong>  &#x21d2; <tt>The type library <a href="#name-instance_method" title="WIN32OLE_TYPELIB#name (method)">name</a></tt> </span>
    <span class='overload'>#<strong>name</strong>  &#x21d2; <tt>The type library <a href="#name-instance_method" title="WIN32OLE_TYPELIB#name (method)">name</a></tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#to_s-instance_method" title="WIN32OLE_TYPELIB#to_s (method)">#to_s</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="ole_classes-instance_method">
  <h3 class='signature'>
  <span class='overload'>#<strong>ole_types</strong>  &#x21d2; <tt>The array of <a href="WIN32OLE_TYPE.html" title="WIN32OLE_TYPE (class)">WIN32OLE_TYPE</a> object included the type library.</tt> </span>
    <span class='overload'>#<strong>ole_classes</strong>  &#x21d2; <tt>The array of <a href="WIN32OLE_TYPE.html" title="WIN32OLE_TYPE (class)">WIN32OLE_TYPE</a> object included the type library.</tt> </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Alias for <a href="#ole_types-instance_method" title="WIN32OLE_TYPELIB#ole_types (method)">#ole_types</a>.</p>


  </div>
</div>

</section>
  <section class='method_details' id="ole_types-instance_method">
  <h3 class='signature'>
  #<strong>ole_types</strong>  &#x21d2; <tt>The array of <a href="WIN32OLE_TYPE.html" title="WIN32OLE_TYPE (class)">WIN32OLE_TYPE</a> object included the type library.</tt> 
  <span class='aliases'>Also known as: <span class='names'><span>ole_classes</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the type library file path.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_classes'>classes</span> <span class='op'>=</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_ole_types'>ole_types</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span> <span class='comment'># -&gt; [&#39;AddIn&#39;, &#39;AddIns&#39; ...]
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


800
801
802
803
804
805
806
807
808</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 800</span>

static VALUE
foletypelib_ole_types(VALUE self)
{
    ITypeLib *pTypeLib = NULL;
    VALUE classes = rb_ary_new();
    pTypeLib = itypelib(self);
    ole_types_from_typelib(pTypeLib, classes);
    return classes;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="path-instance_method">
  <h3 class='signature'>
  #<strong>path</strong>  &#x21d2; <tt>The type library file <a href="#path-instance_method" title="WIN32OLE_TYPELIB#path (method)">path</a>.</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the type library file path.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span> <span class='comment'>#-&gt; &#39;C:\...\EXCEL9.OLB&#39;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 578</span>

static VALUE
foletypelib_path(VALUE self)
{
    TLIBATTR *pTLibAttr;
    HRESULT hr = S_OK;
    BSTR bstr;
    LCID lcid = cWIN32OLE_lcid;
    VALUE path;
    ITypeLib *pTypeLib;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    hr = QueryPathOfRegTypeLib(&amp;pTLibAttr-&gt;guid,
	                       pTLibAttr-&gt;wMajorVerNum,
			       pTLibAttr-&gt;wMinorVerNum,
			       lcid,
			       &amp;bstr);
    if (FAILED(hr)) {
	pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
	ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to QueryPathOfRegTypeTypeLib&quot;);
    }

    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    path = WC2VSTR(bstr);
    return path;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="to_s-instance_method">
  <h3 class='signature'>
  #<strong>to_s</strong>  &#x21d2; <tt>The type library <a href="#name-instance_method" title="WIN32OLE_TYPELIB#name (method)">name</a></tt> 
  <span class='aliases'>Also known as: <span class='names'><span>name</span></span>
  </span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the type library name.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># -&gt; &#39;Microsoft Excel 9.0 Object Library&#39;
</span></code></pre>


  </div>
</div>
<div class='source_code h'>
  <pre class='lines_num'>


466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 466</span>

static VALUE
foletypelib_name(VALUE self)
{
    ITypeLib *pTypeLib;
    HRESULT hr;
    BSTR bstr;
    VALUE name;
    pTypeLib = itypelib(self);
    hr = pTypeLib-&gt;lpVtbl-&gt;GetDocumentation(pTypeLib, -1,
                                            NULL, &amp;bstr, NULL, NULL);

    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to get name from ITypeLib&quot;);
    }
    name = WC2VSTR(bstr);
    return name;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="version-instance_method">
  <h3 class='signature'>
  #<strong>version</strong>  &#x21d2; <tt>The type library <a href="#version-instance_method" title="WIN32OLE_TYPELIB#version (method)">version</a> String object.</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the type library version.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='comment'>#-&gt; &quot;1.3&quot;
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


510
511
512
513
514
515
516
517
518
519
520
521
522</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 510</span>

static VALUE
foletypelib_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    ITypeLib *pTypeLib;
    VALUE version;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    version = rb_sprintf(&quot;%d.%d&quot;, pTLibAttr-&gt;wMajorVerNum, pTLibAttr-&gt;wMinorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return version;
}
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="visible?-instance_method">
  <h3 class='signature'>
  #<strong>visible?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns true if the type library information is not hidden. If wLibFlags of
TLIBATTR is 0 or LIBFLAG_FRESTRICTED or LIBFLAG_FHIDDEN, the method returns
false, otherwise, returns true. If the method fails to access the TLIBATTR
information, then WIN32OLERuntimeError is raised.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_visible?'>visible?</span> <span class='comment'># =&gt; true
</span></code></pre>


  </div>
</div>
<div class="tags">
  
</div><div class='source_code h'>
  <pre class='lines_num'>


618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635</pre>
  <div class='lines_code'>
<pre class='code cpp'
<span class='info file'># File 'win32ole/win32ole_typelib.c', line 618</span>

static VALUE
foletypelib_visible(VALUE self)
{
    ITypeLib *pTypeLib = NULL;
    VALUE visible = Qtrue;
    TLIBATTR *pTLibAttr;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);

    if ((pTLibAttr-&gt;wLibFlags == 0) ||
        (pTLibAttr-&gt;wLibFlags &amp; LIBFLAG_FRESTRICTED) ||
        (pTLibAttr-&gt;wLibFlags &amp; LIBFLAG_FHIDDEN)) {
        visible = Qfalse;
    }
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return visible;
}
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.3 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>