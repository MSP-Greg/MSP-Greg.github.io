<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: WIN32OLE_VARIANT &mdash; win32ole</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "WIN32OLE_VARIANT",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a href='../../index.html'>Home</a> &raquo; 
      <a href='../index.html'>Ruby-2.2.10</a> &raquo; 
      <a href='index.html'>win32ole</a> &raquo; 
      <a href='_index.html#alpha_W'>Index (W)</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>WIN32OLE_VARIANT&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: WIN32OLE_VARIANT</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v2_2_10/ext/win32ole/win32ole_variant.c#L697'>ext/win32ole/win32ole_variant.c</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/v2_2_10/ext/win32ole/win32ole_variant.c#L382'>ext/win32ole/win32ole_variant.c</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>WIN32OLE_VARIANT</code> objects represents OLE variant.</p>

<p>Win32OLE converts Ruby object into OLE variant automatically when invoking OLE methods. If OLE method requires the argument which is different from the variant by automatic conversion of Win32OLE, you can convert the specfied variant type by using <code>WIN32OLE_VARIANT</code> class.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_param'>param</span> <span class='op'>=</span> <span class='const'>WIN32OLE_VARIANT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_VARIANT.new (method)">new</a></span>(<span class='int'>10</span><span class='comma'>,</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html" title="WIN32OLE::VARIANT (module)">VARIANT</a></span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html#VT_R4-constant" title="WIN32OLE::VARIANT::VT_R4 (constant)">VT_R4</a></span>)
<span class='id identifier rubyid_oleobj'>oleobj</span>.<span class='id identifier rubyid_method'>method</span>(<span class='id identifier rubyid_param'>param</span>)</code></pre>

<p><code>WIN32OLE_VARIANT</code> does not support VT_RECORD variant. Use WIN32OLE_RECORD class instead of <code>WIN32OLE_VARIANT</code> if the VT_RECORD variant is needed.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='Empty-constant' class='summary_signature'>Empty =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>represents VT_EMPTY OLE object.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_2_10/ext/win32ole/win32ole_variant.c#L710'># File 'ext/win32ole/win32ole_variant.c', line 710</a>    <pre class='code c'><span class='id identifier rubyid_rb_funcall'>rb_funcall</span>(<span class='id identifier rubyid_cWIN32OLE_VARIANT'>cWIN32OLE_VARIANT</span><span class='comma'>,</span> <span class='id identifier rubyid_rb_intern'>rb_intern</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>new</span><span class='tstring_end'>&quot;</span></span>)<span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='const'>Qnil</span><span class='comma'>,</span> <span class='const'>INT2FIX</span>(<span class='const'>VT_EMPTY</span>))</pre>
  </li>
  <li>
    <span id='NoParam-constant' class='summary_signature'>NoParam =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><code>:NoParam</code>, false)</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_2_10/ext/win32ole/win32ole_variant.c#L732'># File 'ext/win32ole/win32ole_variant.c', line 732</a>    <pre class='code c'>represents VT_ERROR variant with DISP_E_PARAMNOTFOUND.
This constants is used for not specified parameter.

fso = WIN32OLE.new(&quot;Scripting.FileSystemObject&quot;)
fso.openTextFile(filename, WIN32OLE_VARIANT</pre>
  </li>
  <li>
    <span id='Nothing-constant' class='summary_signature'>Nothing =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>represents <code>Nothing</code> of <code>VB.NET</code> or VB.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_2_10/ext/win32ole/win32ole_variant.c#L722'># File 'ext/win32ole/win32ole_variant.c', line 722</a>    <pre class='code c'><span class='id identifier rubyid_rb_funcall'>rb_funcall</span>(<span class='id identifier rubyid_cWIN32OLE_VARIANT'>cWIN32OLE_VARIANT</span><span class='comma'>,</span> <span class='id identifier rubyid_rb_intern'>rb_intern</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>new</span><span class='tstring_end'>&quot;</span></span>)<span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='const'>Qnil</span><span class='comma'>,</span> <span class='const'>INT2FIX</span>(<span class='const'>VT_DISPATCH</span>))</pre>
  </li>
  <li>
    <span id='Null-constant' class='summary_signature'>Null =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>represents VT_NULL OLE object.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_2_10/ext/win32ole/win32ole_variant.c#L716'># File 'ext/win32ole/win32ole_variant.c', line 716</a>    <pre class='code c'><span class='id identifier rubyid_rb_funcall'>rb_funcall</span>(<span class='id identifier rubyid_cWIN32OLE_VARIANT'>cWIN32OLE_VARIANT</span><span class='comma'>,</span> <span class='id identifier rubyid_rb_intern'>rb_intern</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>new</span><span class='tstring_end'>&quot;</span></span>)<span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='const'>Qnil</span><span class='comma'>,</span> <span class='const'>INT2FIX</span>(<span class='const'>VT_NULL</span>))</pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#array-class_method" title="array (class method)">.<strong>array</strong>(ary, vt)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns Ruby object wrapping OLE variant whose variant type is VT_ARRAY.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(val, vartype) # = &gt; WIN32OLE_VARIANT object.))  </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns Ruby object wrapping OLE variant.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#value-instance_method" title="#value (instance method)">#<strong>value</strong>(#=&gt; Ruby object.)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns Ruby object value from OLE variant.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#value=-instance_method" title="#value= (instance method)">#<strong>value=</strong>(val #=&gt; set WIN32OLE_VARIANT value to val.)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets variant value to val.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the element of <code>WIN32OLE_VARIANT</code> object(OLE array).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#[]=-instance_method" title="#[]= (instance method)">#<strong>[]=</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the element of <code>WIN32OLE_VARIANT</code> object(OLE array) to val.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#vartype-instance_method" title="#vartype (instance method)">#<strong>vartype</strong>(#=&gt; OLE variant type.)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns OLE variant type.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(val, vartype) # = &gt; WIN32OLE_VARIANT object.))    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns Ruby object wrapping OLE variant. The first argument specifies Ruby object to convert OLE variant variable. The second argument specifies VARIANT type. In some situation, you need the <code>WIN32OLE_VARIANT</code> object to pass OLE method</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_shell'>shell</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span>.<span class='id identifier rubyid_new'><a href="WIN32OLE.html#new-class_method" title="WIN32OLE.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Shell.Application</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_folder'>folder</span> <span class='op'>=</span> <span class='id identifier rubyid_shell'>shell</span>.<span class='const'>NameSpace</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C:\\Windows</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_item'>item</span> <span class='op'>=</span> <span class='id identifier rubyid_folder'>folder</span>.<span class='const'>ParseName</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tmp.txt</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># You can&#39;t use Ruby String object to call FolderItem.InvokeVerb.
</span><span class='comment'># Instead, you have to use WIN32OLE_VARIANT object to call the method.
</span><span class='id identifier rubyid_shortcut'>shortcut</span> <span class='op'>=</span> <span class='const'>WIN32OLE_VARIANT</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Create Shortcut(\&amp;S)</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_invokeVerb'>invokeVerb</span>(<span class='id identifier rubyid_shortcut'>shortcut</span>)</code></pre>

  </div>
</div>

</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="array-class_method">
  <h3 class='signature  first'>
    .<strong>array</strong>(ary, vt)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns Ruby object wrapping OLE variant whose variant type is VT_ARRAY. The first argument should be Array object which specifies dimensions and each size of dimensions of OLE array. The second argument specifies variant type of the element of OLE array.</p>

<p>The following create 2 dimensions OLE array. The first dimensions size is 3, and the second is 4.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ole_ary'>ole_ary</span> <span class='op'>=</span> <span class='const'>WIN32OLE_VARIANT</span>.<span class='id identifier rubyid_array'>array</span>([<span class='int'>3</span><span class='comma'>,</span><span class='int'>4</span>]<span class='comma'>,</span> <span class='const'>VT_I4</span>)
<span class='id identifier rubyid_ruby_ary'>ruby_ary</span> <span class='op'>=</span> <span class='id identifier rubyid_ole_ary'>ole_ary</span>.<span class='id identifier rubyid_value'><a href="#value-instance_method" title="WIN32OLE_VARIANT#value (method)">value</a></span> <span class='comment'># =&gt; [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]</span></code></pre>

  </div>
</div>

</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="value-instance_method">
  <h3 class='signature rw first'>
    #<strong>value</strong>(#=&gt; Ruby object.)   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns Ruby object value from OLE variant.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='const'>WIN32OLE_VARIANT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_VARIANT.new (method)">new</a></span>(<span class='int'>1</span><span class='comma'>,</span> <span class='const'><a href="WIN32OLE.html" title="WIN32OLE (class)">WIN32OLE</a></span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html" title="WIN32OLE::VARIANT (module)">VARIANT</a></span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html#VT_BSTR-constant" title="WIN32OLE::VARIANT::VT_BSTR (constant)">VT_BSTR</a></span>)
<span class='id identifier rubyid_obj'>obj</span>.<span class='id identifier rubyid_value'>value</span> <span class='comment'># =&gt; &quot;1&quot; (not Fixnum object, but String object &quot;1&quot;)</span></code></pre>

  </div>
</div>

</section>

<section class='method_details' id="value=-instance_method">
  <h3 class='signature rw'>
    #<strong>value=</strong>(val #=&gt; set WIN32OLE_VARIANT value to val.)   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets variant value to val. If the val type does not match variant value type(vartype), then val is changed to match variant value type(vartype) before setting val. Thie method is not available when vartype is VT_ARRAY(except VT_UI1|VT_ARRAY). If the vartype is VT_UI1|VT_ARRAY, the val should be String object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='const'>WIN32OLE_VARIANT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_VARIANT.new (method)">new</a></span>(<span class='int'>1</span>) <span class='comment'># obj.vartype is WIN32OLE::VARIANT::VT_I4
</span><span class='id identifier rubyid_obj'>obj</span>.<span class='id identifier rubyid_value'><a href="#value-instance_method" title="WIN32OLE_VARIANT#value (method)">value</a></span> <span class='op'>=</span> <span class='float'>3.2</span> <span class='comment'># 3.2 is changed to 3 when setting value.
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_obj'>obj</span>.<span class='id identifier rubyid_value'><a href="#value-instance_method" title="WIN32OLE_VARIANT#value (method)">value</a></span> <span class='comment'># =&gt; 3</span></code></pre>

  </div>
</div>

</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="[]-instance_method">
  <h3 class='signature  first'>
    #<strong>[]</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the element of <code>WIN32OLE_VARIANT</code> object(OLE array). This method is available only when the variant type of <code>WIN32OLE_VARIANT</code> object is VT_ARRAY.</p>

<p>REMARK:</p>

<pre class="code ruby"><code class="ruby">The all indicies should be 0 or natural number and
lower than or equal to max indicies.
(This point is different with Ruby Array indicies.)

obj = WIN32OLE_VARIANT.new([[1,2,3],[4,5,6]])
p obj[0,0] # =&gt; 1
p obj[1,0] # =&gt; 4
p obj[2,0] # =&gt; WIN32OLERuntimeError
p obj[0, -1] # =&gt; WIN32OLERuntimeError</code></pre>

  </div>
</div>

</section>

<section class='method_details' id="[]=-instance_method">
  <h3 class='signature '>
    #<strong>[]=</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Set the element of <code>WIN32OLE_VARIANT</code> object(OLE array) to val. This method is available only when the variant type of <code>WIN32OLE_VARIANT</code> object is VT_ARRAY.</p>

<p>REMARK:</p>

<pre class="code ruby"><code class="ruby">The all indicies should be 0 or natural number and
lower than or equal to max indicies.
(This point is different with Ruby Array indicies.)

obj = WIN32OLE_VARIANT.new([[1,2,3],[4,5,6]])
obj[0,0] = 7
obj[1,0] = 8
p obj.value # =&gt; [[7,2,3], [8,5,6]]
obj[2,0] = 9 # =&gt; WIN32OLERuntimeError
obj[0, -1] = 9 # =&gt; WIN32OLERuntimeError</code></pre>

  </div>
</div>

</section>

<section class='method_details' id="vartype-instance_method">
  <h3 class='signature '>
    #<strong>vartype</strong>(#=&gt; OLE variant type.)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns OLE variant type.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='const'>WIN32OLE_VARIANT</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE_VARIANT.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_obj'>obj</span>.<span class='id identifier rubyid_vartype'>vartype</span> <span class='comment'># =&gt; WIN32OLE::VARIANT::VT_BSTR</span></code></pre>

  </div>
</div>

</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>