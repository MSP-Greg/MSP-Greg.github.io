<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: CVE-2013-0256 &mdash; rdoc  Ruby-master dev</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "CVE-2013-0256",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-master</a> &raquo; 
      <a href='.'>rdoc</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: CVE-2013-0256&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>

<h1 id="label-7BRDoc-7D+2.3.0+through+3.12+XSS+Exploit"><a href="RDoc.html" title="RDoc (module)"><code>RDoc</code></a> 2.3.0 through 3.12 XSS Exploit</h1>

<p><a href="RDoc.html" title="RDoc (module)"><code>RDoc</code></a> documentation generated by rdoc 2.3.0 through rdoc 3.12 and prereleases up to rdoc 4.0.0.preview2.1 are vulnerable to an XSS exploit.  This exploit may lead to cookie disclosure to third parties.</p>

<p>The exploit exists in darkfish.js which is copied from the <a href="RDoc.html" title="RDoc (module)"><code>RDoc</code></a> install location to the generated documentation.</p>

<p><a href="RDoc.html" title="RDoc (module)"><code>RDoc</code></a> is a static documentation generation tool.  Patching the library itself is insufficient to correct this exploit.  Those hosting rdoc documentation will need to apply the following patch.  If applied while ignoring whitespace, this patch will correct all affected versions:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_diff'>diff</span> <span class='op'>-</span><span class='op'>-</span><span class='id identifier rubyid_git'>git</span> <span class='id identifier rubyid_darkfish'>darkfish</span>.<span class='id identifier rubyid_js'>js</span> <span class='id identifier rubyid_darkfish'>darkfish</span>.<span class='id identifier rubyid_js'>js</span>
<span class='id identifier rubyid_index'>index</span> <span class='int'>4</span><span class='id identifier rubyid_be722f'>be722f</span><span class='op'>..</span><span class='id identifier rubyid_f26fd45'>f26fd45</span> <span class='int'>100644</span>
<span class='op'>-</span><span class='op'>-</span><span class='op'>-</span> <span class='id identifier rubyid_darkfish'>darkfish</span>.<span class='id identifier rubyid_js'>js</span>
<span class='op'>+</span><span class='op'>+</span><span class='op'>+</span> <span class='id identifier rubyid_darkfish'>darkfish</span>.<span class='id identifier rubyid_js'>js</span>
<span class='cvar'>@@</span> <span class='op'>-</span><span class='int'>109</span><span class='comma'>,</span><span class='int'>13</span> <span class='op'>+</span><span class='int'>109</span><span class='comma'>,</span><span class='int'>15</span> <span class='cvar'>@@</span> <span class='id identifier rubyid_function'>function</span> <span class='id identifier rubyid_hookSearch'>hookSearch</span>() {
 <span class='id identifier rubyid_function'>function</span> <span class='id identifier rubyid_highlightTarget'>highlightTarget</span>( <span class='id identifier rubyid_anchor'>anchor</span> ) {
   <span class='id identifier rubyid_console'>console</span>.<span class='id identifier rubyid_debug'>debug</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Highlighting target &#39;%s&#39;.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_anchor'>anchor</span> )<span class='semicolon'>;</span>

<span class='op'>-</span>  <span class='gvar'>$</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a[name=</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_anchor'>anchor</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_each'>each</span>( <span class='id identifier rubyid_function'>function</span>() {
<span class='op'>-</span>    <span class='kw'>if</span> ( <span class='op'>!</span><span class='gvar'>$</span>(<span class='id identifier rubyid_this'>this</span>).<span class='id identifier rubyid_parent'>parent</span>().<span class='id identifier rubyid_parent'>parent</span>().<span class='id identifier rubyid_hasClass'>hasClass</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>target-section</span><span class='tstring_end'>&#39;</span></span>) ) {
<span class='op'>-</span>      <span class='id identifier rubyid_console'>console</span>.<span class='id identifier rubyid_debug'>debug</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrapping the target-section</span><span class='tstring_end'>&quot;</span></span> )<span class='semicolon'>;</span>
<span class='op'>-</span>      <span class='gvar'>$</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>div.method-detail</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_unwrap'>unwrap</span>( <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>div.target-section</span><span class='tstring_end'>&#39;</span></span> )<span class='semicolon'>;</span>
<span class='op'>-</span>      <span class='gvar'>$</span>(<span class='id identifier rubyid_this'>this</span>).<span class='id identifier rubyid_parent'>parent</span>().<span class='id identifier rubyid_wrap'>wrap</span>( <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;div class=&quot;target-section&quot;&gt;&lt;/div&gt;</span><span class='tstring_end'>&#39;</span></span> )<span class='semicolon'>;</span>
<span class='op'>-</span>    } <span class='kw'>else</span> {
<span class='op'>-</span>      <span class='id identifier rubyid_console'>console</span>.<span class='id identifier rubyid_debug'>debug</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Already wrapped.</span><span class='tstring_end'>&quot;</span></span> )<span class='semicolon'>;</span>
<span class='op'>+</span>  <span class='gvar'>$</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a[name]</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_each'>each</span>( <span class='id identifier rubyid_function'>function</span>() {
<span class='op'>+</span>    <span class='kw'>if</span> ( <span class='gvar'>$</span>(<span class='id identifier rubyid_this'>this</span>).<span class='id identifier rubyid_attr'>attr</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>==</span> <span class='id identifier rubyid_anchor'>anchor</span> ) {
<span class='op'>+</span>      <span class='kw'>if</span> ( <span class='op'>!</span><span class='gvar'>$</span>(<span class='id identifier rubyid_this'>this</span>).<span class='id identifier rubyid_parent'>parent</span>().<span class='id identifier rubyid_parent'>parent</span>().<span class='id identifier rubyid_hasClass'>hasClass</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>target-section</span><span class='tstring_end'>&#39;</span></span>) ) {
<span class='op'>+</span>        <span class='id identifier rubyid_console'>console</span>.<span class='id identifier rubyid_debug'>debug</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrapping the target-section</span><span class='tstring_end'>&quot;</span></span> )<span class='semicolon'>;</span>
<span class='op'>+</span>        <span class='gvar'>$</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>div.method-detail</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_unwrap'>unwrap</span>( <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>div.target-section</span><span class='tstring_end'>&#39;</span></span> )<span class='semicolon'>;</span>
<span class='op'>+</span>        <span class='gvar'>$</span>(<span class='id identifier rubyid_this'>this</span>).<span class='id identifier rubyid_parent'>parent</span>().<span class='id identifier rubyid_wrap'>wrap</span>( <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;div class=&quot;target-section&quot;&gt;&lt;/div&gt;</span><span class='tstring_end'>&#39;</span></span> )<span class='semicolon'>;</span>
<span class='op'>+</span>      } <span class='kw'>else</span> {
<span class='op'>+</span>        <span class='id identifier rubyid_console'>console</span>.<span class='id identifier rubyid_debug'>debug</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Already wrapped.</span><span class='tstring_end'>&quot;</span></span> )<span class='semicolon'>;</span>
<span class='op'>+</span>      }
     }
   })<span class='semicolon'>;</span>
 }<span class='semicolon'>;</span></code></pre>

<p><a href="RDoc.html" title="RDoc (module)"><code>RDoc</code></a> 3.9.5, 3.12.1 and <a href="RDoc.html" title="RDoc (module)"><code>RDoc</code></a> 4.0.0.rc.2 and newer are not vulnerable to this exploit.</p>

<p>This exploit was discovered by Evgeny Ermakov &lt;corwmh@gmail.com&gt;.</p>

<p>This vulnerability has been assigned the CVE identifier CVE-2013-0256.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>