<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: OpenSSL &mdash; openssl  Ruby-master dev</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-master</a> &raquo; 
      <a href='.'>openssl</a> &raquo; 
      <a href='_index.html#alpha_O'>Index (O)</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>OpenSSL&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: OpenSSL</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="OpenSSL/ASN1.html" title="OpenSSL::ASN1 (module)"><code>ASN1</code></a>,
        <a href="OpenSSL/Buffering.html" title="OpenSSL::Buffering (module)"><code>Buffering</code></a>,
        <a href="OpenSSL/KDF.html" title="OpenSSL::KDF (module)"><code>KDF</code></a>,
        <a href="OpenSSL/Marshal.html" title="OpenSSL::Marshal (module)"><code>Marshal</code></a>,
        <a href="OpenSSL/Netscape.html" title="OpenSSL::Netscape (module)"><code>Netscape</code></a>,
        <a href="OpenSSL/OCSP.html" title="OpenSSL::OCSP (module)"><code>OCSP</code></a>,
        <a href="OpenSSL/PKCS5.html" title="OpenSSL::PKCS5 (module)"><code>PKCS5</code></a>,
        <a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)"><code>PKey</code></a>,
        <a href="OpenSSL/Random.html" title="OpenSSL::Random (module)"><code>Random</code></a>,
        <a href="OpenSSL/SSL.html" title="OpenSSL::SSL (module)"><code>SSL</code></a>,
        <a href="OpenSSL/Timestamp.html" title="OpenSSL::Timestamp (module)"><code>Timestamp</code></a>,
        <a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)"><code>X509</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="OpenSSL/BN.html" title="OpenSSL::BN (class)"><code>BN</code></a>,
        <a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)"><code>Cipher</code></a>,
        <a href="OpenSSL/Config.html" title="OpenSSL::Config (class)"><code>Config</code></a>,
        <a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)"><code>Digest</code></a>,
        <a href="OpenSSL/Engine.html" title="OpenSSL::Engine (class)"><code>Engine</code></a>,
        <a href="OpenSSL/HMAC.html" title="OpenSSL::HMAC (class)"><code>HMAC</code></a>,
        <a href="OpenSSL/PKCS12.html" title="OpenSSL::PKCS12 (class)"><code>PKCS12</code></a>,
        <a href="OpenSSL/PKCS7.html" title="OpenSSL::PKCS7 (class)"><code>PKCS7</code></a>,
        <a href="OpenSSL/Provider.html" title="OpenSSL::Provider (class)"><code>Provider</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Exceptions:</div>
      <div class='box_11'>
          <a href="OpenSSL/BNError.html" title="OpenSSL::BNError (class)"><code>BNError</code></a>,
        <a href="OpenSSL/ConfigError.html" title="OpenSSL::ConfigError (class)"><code>ConfigError</code></a>,
        <a href="OpenSSL/HMACError.html" title="OpenSSL::HMACError (class)"><code>HMACError</code></a>,
        <a href="OpenSSL/OpenSSLError.html" title="OpenSSL::OpenSSLError (class)"><code>OpenSSLError</code></a>      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/bn.rb#L16'>ext/openssl/lib/openssl/bn.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L1016'>ext/openssl/ossl.c</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl.rb#L25'>ext/openssl/lib/openssl.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/cipher.rb#L15'>ext/openssl/lib/openssl/cipher.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/digest.rb#L15'>ext/openssl/lib/openssl/digest.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/hmac.rb#L3'>ext/openssl/lib/openssl/hmac.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/marshal.rb#L14'>ext/openssl/lib/openssl/marshal.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/pkcs5.rb#L7'>ext/openssl/lib/openssl/pkcs5.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/ssl.rb#L21'>ext/openssl/lib/openssl/ssl.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/version.rb#L3'>ext/openssl/lib/openssl/version.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/x509.rb#L17'>ext/openssl/lib/openssl/x509.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>OpenSSL</code> provides SSL, TLS and general purpose cryptography.  It wraps the {<a href="https://www.openssl.org">www.openssl.org</a>/ } library.</p>

<h3 id="label-Examples">Examples</h3>

<p>All examples assume you have loaded <code>OpenSSL</code> with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openssl</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>These examples build atop each other.  For example the key created in the next is used in throughout these examples.</p>

<h4 id="label-Keys">Keys</h4>

<h5 id="label-Creating+a+Key">Creating a Key</h5>

<p>This example creates a 2048 bit RSA keypair and writes it to the current directory.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey/RSA.html" title="OpenSSL::PKey::RSA (class)">RSA</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/PKey/RSA.html#new-class_method" title="OpenSSL::PKey::RSA.new (method)">new</a></span> <span class='int'>2048</span>

<span class='const'>File</span>.<span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private_key.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_private_to_pem'>private_to_pem</span>
<span class='const'>File</span>.<span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>public_key.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_public_to_pem'>public_to_pem</span></code></pre>

<h5 id="label-Exporting+a+Key">Exporting a Key</h5>

<p>Keys saved to disk without encryption are not secure as anyone who gets ahold of the key may use it unless it is encrypted.  In order to securely export a key you may export it with a password.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cipher'>cipher</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)">Cipher</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Cipher.html#new-class_method" title="OpenSSL::Cipher.new (method)">new</a></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aes-256-cbc</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my secure password goes here</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_key_secure'>key_secure</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_private_to_pem'>private_to_pem</span> <span class='id identifier rubyid_cipher'>cipher</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>

<span class='const'>File</span>.<span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private.secure.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_key_secure'>key_secure</span></code></pre>

<p><a href="OpenSSL/Cipher.html#ciphers-class_method" title="OpenSSL::Cipher.ciphers (method)">Cipher.ciphers</a> returns a list of available ciphers.</p>

<h5 id="label-Loading+a+Key">Loading a Key</h5>

<p>A key can also be loaded from a file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key2'>key2</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a></span>.<span class='id identifier rubyid_read'><a href="OpenSSL/PKey.html#read-class_method" title="OpenSSL::PKey.read (method)">read</a></span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private_key.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_key2'>key2</span>.<span class='id identifier rubyid_public?'>public?</span> <span class='comment'># =&gt; true
</span><span class='id identifier rubyid_key2'>key2</span>.<span class='id identifier rubyid_private?'>private?</span> <span class='comment'># =&gt; true</span></code></pre>

<p>or</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key3'>key3</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a></span>.<span class='id identifier rubyid_read'><a href="OpenSSL/PKey.html#read-class_method" title="OpenSSL::PKey.read (method)">read</a></span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>public_key.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_key3'>key3</span>.<span class='id identifier rubyid_public?'>public?</span> <span class='comment'># =&gt; true
</span><span class='id identifier rubyid_key3'>key3</span>.<span class='id identifier rubyid_private?'>private?</span> <span class='comment'># =&gt; false</span></code></pre>

<h5 id="label-Loading+an+Encrypted+Key">Loading an Encrypted Key</h5>

<p>OpenSSL will prompt you for your password when loading an encrypted key. If you will not be able to type in the password you may provide it when loading the key:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key4_pem'>key4_pem</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>private.secure.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my secure password goes here</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_key4'>key4</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a></span>.<span class='id identifier rubyid_read'><a href="OpenSSL/PKey.html#read-class_method" title="OpenSSL::PKey.read (method)">read</a></span> <span class='id identifier rubyid_key4_pem'>key4_pem</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span></code></pre>

<h4 id="label-RSA+Encryption">RSA Encryption</h4>

<p>RSA provides encryption and decryption using the public and private keys. You can use a variety of padding methods depending upon the intended use of encrypted data.</p>

<h5 id="label-Encryption+-26+Decryption">Encryption &amp; Decryption</h5>

<p>Asymmetric public/private key encryption is slow and victim to attack in cases where it is used without padding or directly to encrypt larger chunks of data. Typical use cases for RSA encryption involve “wrapping” a symmetric key with the public key of the recipient who would “unwrap” that symmetric key again using their private key. The following illustrates a simplified example of such a key transport scheme. It shouldn’t be used in practice, though, standardized protocols should always be preferred.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_wrapped_key'>wrapped_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_public_encrypt'>public_encrypt</span> <span class='id identifier rubyid_key'>key</span></code></pre>

<p>A symmetric key encrypted with the public key can only be decrypted with the corresponding private key of the recipient.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_original_key'>original_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_private_decrypt'>private_decrypt</span> <span class='id identifier rubyid_wrapped_key'>wrapped_key</span></code></pre>

<p>By default <code>PKCS#1</code> padding will be used, but it is also possible to use other forms of padding, see <a href="OpenSSL/PKey/RSA.html" title="OpenSSL::PKey::RSA (class)"><code>::OpenSSL::PKey::RSA</code></a> for further details.</p>

<h5 id="label-Signatures">Signatures</h5>

<p>Using “private_encrypt” to encrypt some data with the private key is equivalent to applying a digital signature to the data. A verifying party may validate the signature by comparing the result of decrypting the signature with “public_decrypt” to the original data. However, <a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)"><code>PKey</code></a> already has methods “sign” and “verify” that handle digital signatures in a standardized way - “private_encrypt” and “public_decrypt” shouldn’t be used in practice.</p>

<p>To sign a document, a cryptographically secure hash of the document is computed first, which is then signed using the private key.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_signature'>signature</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_sign'>sign</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA256</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span></code></pre>

<p>To validate the signature, again a hash of the document is computed and the signature is decrypted using the public key. The result is then compared to the hash just computed, if they are equal the signature was valid.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_verify'>verify</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA256</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_signature'>signature</span><span class='comma'>,</span> <span class='id identifier rubyid_document'>document</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Valid</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>else</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Invalid</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<h4 id="label-PBKDF2+Password-based+Encryption">PBKDF2 Password-based Encryption</h4>

<p>If supported by the underlying OpenSSL version used, Password-based Encryption should use the features of <a href="OpenSSL/PKCS5.html" title="OpenSSL::PKCS5 (module)"><code>PKCS5</code></a>. If not supported or if required by legacy applications, the older, less secure methods specified in RFC 2898 are also supported (see below).</p>

<p><a href="OpenSSL/PKCS5.html" title="OpenSSL::PKCS5 (module)"><code>PKCS5</code></a> supports PBKDF2 as it was specified in <code>PKCS#5</code> <a href="http://www.rsa.com/rsalabs/node.asp?id=2127" target="_parent" title="v2.0">v2.0</a>. It still uses a password, a salt, and additionally a number of iterations that will slow the key derivation process down. The slower this is, the more work it requires being able to brute-force the resulting key.</p>

<h5 id="label-Encryption">Encryption</h5>

<p>The strategy is to first instantiate a <a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)"><code>Cipher</code></a> for encryption, and then to generate a random IV plus a key derived from the password using PBKDF2. PKCS <code>#5</code> v2.0 recommends at least 8 bytes for the salt, the number of iterations largely depends on the hardware being used.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cipher'>cipher</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)">Cipher</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Cipher.html#new-class_method" title="OpenSSL::Cipher.new (method)">new</a></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aes-256-cbc</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_encrypt'>encrypt</span>
<span class='id identifier rubyid_iv'>iv</span> <span class='op'>=</span> <span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_random_iv'>random_iv</span>

<span class='id identifier rubyid_pwd'>pwd</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some hopefully not to easily guessable password</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Random.html" title="OpenSSL::Random (module)">Random</a></span>.<span class='id identifier rubyid_random_bytes'><a href="OpenSSL/Random.html#random_bytes-class_method" title="OpenSSL::Random.random_bytes (method)">random_bytes</a></span> <span class='int'>16</span>
<span class='id identifier rubyid_iter'>iter</span> <span class='op'>=</span> <span class='int'>20000</span>
<span class='id identifier rubyid_key_len'>key_len</span> <span class='op'>=</span> <span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_key_len'>key_len</span>
<span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Digest.html#new-class_method" title="OpenSSL::Digest.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA256</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKCS5.html" title="OpenSSL::PKCS5 (module)">PKCS5</a></span>.<span class='id identifier rubyid_pbkdf2_hmac'><a href="OpenSSL/PKCS5.html#pbkdf2_hmac-class_method" title="OpenSSL::PKCS5.pbkdf2_hmac (method)">pbkdf2_hmac</a></span>(<span class='id identifier rubyid_pwd'>pwd</span><span class='comma'>,</span> <span class='id identifier rubyid_salt'>salt</span><span class='comma'>,</span> <span class='id identifier rubyid_iter'>iter</span><span class='comma'>,</span> <span class='id identifier rubyid_key_len'>key_len</span><span class='comma'>,</span> <span class='id identifier rubyid_digest'>digest</span>)
<span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>

<span class='const'>Now</span> <span class='id identifier rubyid_encrypt'>encrypt</span> <span class='id identifier rubyid_the'>the</span> <span class='label'>data:</span>

<span class='id identifier rubyid_encrypted'>encrypted</span> <span class='op'>=</span> <span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_update'>update</span> <span class='id identifier rubyid_document'>document</span>
<span class='id identifier rubyid_encrypted'>encrypted</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_final'>final</span></code></pre>

<h5 id="label-Decryption">Decryption</h5>

<p>Use the same steps as before to derive the symmetric AES key, this time setting the <a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)"><code>Cipher</code></a> up for decryption.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cipher'>cipher</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Cipher.html" title="OpenSSL::Cipher (class)">Cipher</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Cipher.html#new-class_method" title="OpenSSL::Cipher.new (method)">new</a></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aes-256-cbc</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_decrypt'>decrypt</span>
<span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_iv'>iv</span> <span class='op'>=</span> <span class='id identifier rubyid_iv'>iv</span> <span class='comment'># the one generated with #random_iv
</span>
<span class='id identifier rubyid_pwd'>pwd</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some hopefully not to easily guessable password</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='op'>...</span> <span class='comment'># the one generated above
</span><span class='id identifier rubyid_iter'>iter</span> <span class='op'>=</span> <span class='int'>20000</span>
<span class='id identifier rubyid_key_len'>key_len</span> <span class='op'>=</span> <span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_key_len'>key_len</span>
<span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Digest.html#new-class_method" title="OpenSSL::Digest.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA256</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKCS5.html" title="OpenSSL::PKCS5 (module)">PKCS5</a></span>.<span class='id identifier rubyid_pbkdf2_hmac'><a href="OpenSSL/PKCS5.html#pbkdf2_hmac-class_method" title="OpenSSL::PKCS5.pbkdf2_hmac (method)">pbkdf2_hmac</a></span>(<span class='id identifier rubyid_pwd'>pwd</span><span class='comma'>,</span> <span class='id identifier rubyid_salt'>salt</span><span class='comma'>,</span> <span class='id identifier rubyid_iter'>iter</span><span class='comma'>,</span> <span class='id identifier rubyid_key_len'>key_len</span><span class='comma'>,</span> <span class='id identifier rubyid_digest'>digest</span>)
<span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>

<span class='const'>Now</span> <span class='id identifier rubyid_decrypt'>decrypt</span> <span class='id identifier rubyid_the'>the</span> <span class='label'>data:</span>

<span class='id identifier rubyid_decrypted'>decrypted</span> <span class='op'>=</span> <span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_update'>update</span> <span class='id identifier rubyid_encrypted'>encrypted</span>
<span class='id identifier rubyid_decrypted'>decrypted</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cipher'>cipher</span>.<span class='id identifier rubyid_final'>final</span></code></pre>

<h4 id="label-X509+Certificates">X509 Certificates</h4>

<h5 id="label-Creating+a+Certificate">Creating a Certificate</h5>

<p>This example creates a self-signed certificate using an RSA key and a SHA1 signature.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey/RSA.html" title="OpenSSL::PKey::RSA (class)">RSA</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/PKey/RSA.html#new-class_method" title="OpenSSL::PKey::RSA.new (method)">new</a></span> <span class='int'>2048</span>
<span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Name.html" title="OpenSSL::X509::Name (class)">Name</a></span>.<span class='id identifier rubyid_parse'>parse</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/CN=nobody/DC=example</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Certificate.html" title="OpenSSL::X509::Certificate (class)">Certificate</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/Certificate.html#new-class_method" title="OpenSSL::X509::Certificate.new (method)">new</a></span>
<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>2</span>
<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>
<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_not_after'>not_after</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>3600</span>

<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span></code></pre>

<h5 id="label-Certificate+Extensions">Certificate Extensions</h5>

<p>You can add extensions to the certificate with <code>OpenSSL::SSL::ExtensionFactory</code> to indicate the purpose of the certificate.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_extension_factory'>extension_factory</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/ExtensionFactory.html" title="OpenSSL::X509::ExtensionFactory (class)">ExtensionFactory</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/ExtensionFactory.html#new-class_method" title="OpenSSL::X509::ExtensionFactory.new (method)">new</a></span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_cert'>cert</span>

<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:FALSE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span>)

<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyUsage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyEncipherment,dataEncipherment,digitalSignature</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectKeyIdentifier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>The list of supported extensions (and in some cases their possible values) can be derived from the “objects.h” file in the OpenSSL source code.</p>

<h5 id="label-Signing+a+Certificate">Signing a Certificate</h5>

<p>To sign a certificate set the issuer and use <a href="OpenSSL/X509/Certificate.html#sign-instance_method" title="OpenSSL::X509::Certificate#sign (method)">X509::Certificate#sign</a> with a digest algorithm.  This creates a self-signed cert because we’re using the same name and key to sign the certificate as was used to create the certificate.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Digest.html#new-class_method" title="OpenSSL::Digest.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA1</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>certificate.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span> <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_to_pem'>to_pem</span> <span class='kw'>end</span></code></pre>

<h5 id="label-Loading+a+Certificate">Loading a Certificate</h5>

<p>Like a key, a cert can also be loaded from a file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cert2'>cert2</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Certificate.html" title="OpenSSL::X509::Certificate (class)">Certificate</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/Certificate.html#new-class_method" title="OpenSSL::X509::Certificate.new (method)">new</a></span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>certificate.pem</span><span class='tstring_end'>&#39;</span></span></code></pre>

<h5 id="label-Verifying+a+Certificate">Verifying a Certificate</h5>

<p><code>Certificate#verify</code> will return true when a certificate was signed with the given public key.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>certificate can not be verified</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_cert2'>cert2</span>.<span class='id identifier rubyid_verify'>verify</span> <span class='id identifier rubyid_key'>key</span></code></pre>

<h4 id="label-Certificate+Authority">Certificate Authority</h4>

<p>A certificate authority (CA) is a trusted third party that allows you to verify the ownership of unknown certificates.  The CA issues key signatures that indicate it trusts the user of that key.  A user encountering the key can verify the signature by using the CA’s public key.</p>

<h5 id="label-CA+Key">CA Key</h5>

<p>CA keys are valuable, so we encrypt and save it to disk and make sure it is not readable by other users.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_key'>ca_key</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey.html" title="OpenSSL::PKey (module)">PKey</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/PKey/RSA.html" title="OpenSSL::PKey::RSA (class)">RSA</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/PKey/RSA.html#new-class_method" title="OpenSSL::PKey::RSA.new (method)">new</a></span> <span class='int'>2048</span>
<span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my secure password goes here</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_cipher'>cipher</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aes-256-cbc</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca_key.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0400</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_ca_key'>ca_key</span>.<span class='id identifier rubyid_private_to_pem'>private_to_pem</span>(<span class='id identifier rubyid_cipher'>cipher</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>)
<span class='kw'>end</span></code></pre>

<h5 id="label-CA+Certificate">CA Certificate</h5>

<p>A CA certificate is created the same way we created a certificate above, but with different extensions.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_name'>ca_name</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Name.html" title="OpenSSL::X509::Name (class)">Name</a></span>.<span class='id identifier rubyid_parse'>parse</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/CN=ca/DC=example</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_ca_cert'>ca_cert</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Certificate.html" title="OpenSSL::X509::Certificate (class)">Certificate</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/Certificate.html#new-class_method" title="OpenSSL::X509::Certificate.new (method)">new</a></span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>2</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_not_after'>not_after</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>86400</span>

<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_key'>ca_key</span>.<span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_name'>ca_name</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_name'>ca_name</span>

<span class='id identifier rubyid_extension_factory'>extension_factory</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/ExtensionFactory.html" title="OpenSSL::X509::ExtensionFactory (class)">ExtensionFactory</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/ExtensionFactory.html#new-class_method" title="OpenSSL::X509::ExtensionFactory.new (method)">new</a></span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_subject_certificate'>subject_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_issuer_certificate'>issuer_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>

<span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectKeyIdentifier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>This extension indicates the CA’s key may be used as a CA.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:TRUE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span>)</code></pre>

<p>This extension indicates the CA’s key may be used to verify signatures on both certificates and certificate revocations.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyUsage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cRLSign,keyCertSign</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span>)</code></pre>

<p>Root CA certificates are self-signed.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_ca_key'>ca_key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Digest.html#new-class_method" title="OpenSSL::Digest.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA1</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>The CA certificate is saved to disk so it may be distributed to all the users of the keys this CA will sign.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca_cert.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_to_pem'>to_pem</span>
<span class='kw'>end</span></code></pre>

<h5 id="label-Certificate+Signing+Request">Certificate Signing Request</h5>

<p>The CA signs keys through a Certificate Signing Request (CSR).  The CSR contains the information necessary to identify the key.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_csr'>csr</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Request.html" title="OpenSSL::X509::Request (class)">Request</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/Request.html#new-class_method" title="OpenSSL::X509::Request.new (method)">new</a></span>
<span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
<span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Digest.html#new-class_method" title="OpenSSL::Digest.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA1</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>A CSR is saved to disk and sent to the CA for signing.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csr.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_to_pem'>to_pem</span>
<span class='kw'>end</span></code></pre>

<h5 id="label-Creating+a+Certificate+from+a+CSR">Creating a Certificate from a CSR</h5>

<p>Upon receiving a CSR the CA will verify it before signing it.  A minimal verification would be to check the CSR’s signature.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_csr'>csr</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Request.html" title="OpenSSL::X509::Request (class)">Request</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/Request.html#new-class_method" title="OpenSSL::X509::Request.new (method)">new</a></span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csr.pem</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CSR can not be verified</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_verify'>verify</span> <span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_public_key'>public_key</span></code></pre>

<p>After verification a certificate is created, marked for various usages, signed with the CA key and returned to the requester.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_csr_cert'>csr_cert</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/Certificate.html" title="OpenSSL::X509::Certificate (class)">Certificate</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/Certificate.html#new-class_method" title="OpenSSL::X509::Certificate.new (method)">new</a></span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='int'>2</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_not_after'>not_after</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>600</span>

<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_subject'>subject</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_csr'>csr</span>.<span class='id identifier rubyid_public_key'>public_key</span>
<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>.<span class='id identifier rubyid_subject'>subject</span>

<span class='id identifier rubyid_extension_factory'>extension_factory</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509.html" title="OpenSSL::X509 (module)">X509</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/X509/ExtensionFactory.html" title="OpenSSL::X509::ExtensionFactory (class)">ExtensionFactory</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/X509/ExtensionFactory.html#new-class_method" title="OpenSSL::X509::ExtensionFactory.new (method)">new</a></span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_subject_certificate'>subject_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_csr_cert'>csr_cert</span>
<span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_issuer_certificate'>issuer_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span>

<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:FALSE</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyUsage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyEncipherment,dataEncipherment,digitalSignature</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_add_extension'>add_extension</span> \
  <span class='id identifier rubyid_extension_factory'>extension_factory</span>.<span class='id identifier rubyid_create_extension'>create_extension</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectKeyIdentifier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_ca_key'>ca_key</span><span class='comma'>,</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/Digest.html#new-class_method" title="OpenSSL::Digest.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA1</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_open'>open</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csr_cert.pem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
  <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_csr_cert'>csr_cert</span>.<span class='id identifier rubyid_to_pem'>to_pem</span>
<span class='kw'>end</span></code></pre>

<h4 id="label-SSL+and+TLS+Connections">SSL and TLS Connections</h4>

<p>Using our created key and certificate we can create an SSL or TLS connection. An <a href="OpenSSL/SSL/SSLContext.html" title="OpenSSL::SSL::SSLContext (class)"><code>::OpenSSL::SSL::SSLContext</code></a> is used to set up an SSL session.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL/SSLContext.html" title="OpenSSL::SSL::SSLContext (class)">SSLContext</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/SSL/SSLContext.html#new-class_method" title="OpenSSL::SSL::SSLContext.new (method)">new</a></span></code></pre>

<h5 id="label-SSL+Server">SSL Server</h5>

<p>An SSL server requires the certificate and private key to communicate securely with its clients:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_context'>context</span>.<span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='id identifier rubyid_cert'>cert</span>
<span class='id identifier rubyid_context'>context</span>.<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span></code></pre>

<p>Then create an <a href="OpenSSL/SSL/SSLServer.html" title="OpenSSL::SSL::SSLServer (class)"><code>::OpenSSL::SSL::SSLServer</code></a> with a TCP server socket and the context.  Use the SSLServer like an ordinary TCP server.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_tcp_server'>tcp_server</span> <span class='op'>=</span> <span class='const'>TCPServer</span>.<span class='id identifier rubyid_new'>new</span> <span class='int'>5000</span>
<span class='id identifier rubyid_ssl_server'>ssl_server</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL/SSLServer.html" title="OpenSSL::SSL::SSLServer (class)">SSLServer</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/SSL/SSLServer.html#new-class_method" title="OpenSSL::SSL::SSLServer.new (method)">new</a></span> <span class='id identifier rubyid_tcp_server'>tcp_server</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>

<span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_ssl_connection'>ssl_connection</span> <span class='op'>=</span> <span class='id identifier rubyid_ssl_server'>ssl_server</span>.<span class='id identifier rubyid_accept'>accept</span>

  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_ssl_connection'>ssl_connection</span>.<span class='id identifier rubyid_gets'>gets</span>

  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_dump'>dump</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_response'>response</span>

  <span class='id identifier rubyid_ssl_connection'>ssl_connection</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_dump'>dump</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_ssl_connection'>ssl_connection</span>.<span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span></code></pre>

<h5 id="label-SSL+client">SSL client</h5>

<p>An SSL client is created with a TCP socket and the context. <a href="OpenSSL/SSL/SSLSocket.html#connect-instance_method" title="OpenSSL::SSL::SSLSocket#connect (method)">SSL::SSLSocket#connect</a> must be called to initiate the SSL handshake and start encryption.  A key and certificate are not required for the client socket.</p>

<p>Note that <code>OpenSSL::SSL::SSLSocket#close</code> doesn’t close the underlying socket by default. Set <a href="OpenSSL/SSL/SSLSocket.html#sync_close-instance_method" title="OpenSSL::SSL::SSLSocket#sync_close (method)">SSL::SSLSocket#sync_close</a> to true if you want.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_tcp_socket'>tcp_socket</span> <span class='op'>=</span> <span class='const'>TCPSocket</span>.<span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>5000</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL/SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)">SSLSocket</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/SSL/SSLSocket.html#new-class_method" title="OpenSSL::SSL::SSLSocket.new (method)">new</a></span> <span class='id identifier rubyid_tcp_socket'>tcp_socket</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_sync_close'>sync_close</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_connect'>connect</span>

<span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello server!</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_gets'>gets</span>

<span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_close'>close</span> <span class='comment'># shutdown the TLS connection and close tcp_socket</span></code></pre>

<h5 id="label-Peer+Verification">Peer Verification</h5>

<p>An unverified SSL connection does not provide much security.  For enhanced security the client or server can verify the certificate of its peer.</p>

<p>The client can be modified to verify the server’s certificate against the certificate authority’s certificate:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_context'>context</span>.<span class='id identifier rubyid_ca_file'>ca_file</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca_cert.pem</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_context'>context</span>.<span class='id identifier rubyid_verify_mode'>verify_mode</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL.html#VERIFY_PEER-constant" title="OpenSSL::SSL::VERIFY_PEER (constant)">VERIFY_PEER</a></span>

<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_tcp_socket'>tcp_socket</span> <span class='op'>=</span> <span class='const'>TCPSocket</span>.<span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>5000</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL.html" title="OpenSSL::SSL (module)">SSL</a></span><span class='op'>::</span><span class='const'><a href="OpenSSL/SSL/SSLSocket.html" title="OpenSSL::SSL::SSLSocket (class)">SSLSocket</a></span>.<span class='id identifier rubyid_new'><a href="OpenSSL/SSL/SSLSocket.html#new-class_method" title="OpenSSL::SSL::SSLSocket.new (method)">new</a></span> <span class='id identifier rubyid_tcp_socket'>tcp_socket</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>
<span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_connect'>connect</span>

<span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello server!</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_ssl_client'>ssl_client</span>.<span class='id identifier rubyid_gets'>gets</span></code></pre>

<p>If the server certificate is invalid or <code>context.ca_file</code> is not set when verifying peers an <a href="OpenSSL/SSL/SSLError.html" title="OpenSSL::SSL::SSLError (class)"><code>::OpenSSL::SSL::SSLError</code></a> will be raised.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='LIBRESSL_VERSION_NUMBER-constant' class='summary_signature'>LIBRESSL_VERSION_NUMBER =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><code>0xMNNFF00f</code> (major minor fix 00 status).</p>

<p>See also the man page LIBRESSL_VERSION_NUMBER(3).</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L1064'># File 'ext/openssl/ossl.c', line 1064</a>    <pre class='code c'><span class='const'>LibreSSL</span> <span class='id identifier rubyid_library'>library</span> <span class='id identifier rubyid_version'>version</span> <span class='id identifier rubyid_number'>number</span> <span class='id identifier rubyid_used'>used</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_compile'>compile</span> <span class='id identifier rubyid_the'>the</span> <span class='const'>Ruby</span><span class='op'>/</span><span class='const'>OpenSSL</span>
<span class='id identifier rubyid_extension'>extension</span>. <span class='const'>This</span> <span class='id identifier rubyid_may'>may</span> <span class='id identifier rubyid_differ'>differ</span> <span class='id identifier rubyid_from'>from</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_version'>version</span> <span class='id identifier rubyid_used'>used</span> <span class='id identifier rubyid_at'>at</span> <span class='id identifier rubyid_runtime'>runtime</span>.

<span class='const'>This</span> <span class='id identifier rubyid_constant'>constant</span> <span class='id identifier rubyid_is'>is</span> <span class='id identifier rubyid_only'>only</span> <span class='id identifier rubyid_defined'>defined</span> <span class='kw'>if</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_extension'>extension</span> <span class='id identifier rubyid_was'>was</span> <span class='id identifier rubyid_compiled'>compiled</span> <span class='id identifier rubyid_against'>against</span>
<span class='const'>LibreSSL</span>. <span class='const'>The</span> <span class='id identifier rubyid_number'>number</span> <span class='id identifier rubyid_follows'>follows</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_format'>format</span></pre>
  </li>
  <li>
    <span id='OPENSSL_FIPS-constant' class='summary_signature'>OPENSSL_FIPS =</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L1074'># File 'ext/openssl/ossl.c', line 1074</a>    <pre class='code c'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>* OpenSSL 3 is FIPS-capable even when it is installed without fips option *</span><span class='regexp_end'>/</span></span>
<span class='comment'>#if OSSL_OPENSSL_PREREQ(3, 0, 0)
</span>                    <span class='const'>Qtrue</span>
<span class='comment'>#elif defined(OPENSSL_FIPS)
</span>                    <span class='const'>Qtrue</span>
<span class='comment'>#elif defined(OPENSSL_IS_AWSLC) // AWS-LC FIPS can only be enabled during compile time.
</span>                    <span class='const'>FIPS_mode</span>() <span class='op'>?</span> <span class='const'>Qtrue</span> <span class='op'>:</span> <span class='const'>Qfalse</span>
<span class='comment'>#else
</span>                    <span class='const'>Qfalse</span>
<span class='comment'>#endif</span></pre>
  </li>
  <li>
    <span id='OPENSSL_LIBRARY_VERSION-constant' class='summary_signature'>OPENSSL_LIBRARY_VERSION =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>OpenSSL library version string currently used at runtime.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L1029'># File 'ext/openssl/ossl.c', line 1029</a>    <pre class='code c'><span class='id identifier rubyid_rb_obj_freeze'>rb_obj_freeze</span>(<span class='id identifier rubyid_rb_str_new_cstr'>rb_str_new_cstr</span>(<span class='const'>OpenSSL_version</span>(<span class='const'><a href="#OPENSSL_VERSION-constant" title="OpenSSL::OPENSSL_VERSION (constant)">OPENSSL_VERSION</a></span>)))</pre>
  </li>
  <li>
    <span id='OPENSSL_VERSION-constant' class='summary_signature'>OPENSSL_VERSION =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>OpenSSL library version string used to compile the Ruby/OpenSSL extension. This may differ from the version used at runtime.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L1023'># File 'ext/openssl/ossl.c', line 1023</a>    <pre class='code c'><span class='id identifier rubyid_rb_obj_freeze'>rb_obj_freeze</span>(<span class='id identifier rubyid_rb_str_new_cstr'>rb_str_new_cstr</span>(<span class='const'>OPENSSL_VERSION_TEXT</span>))</pre>
  </li>
  <li>
    <span id='OPENSSL_VERSION_NUMBER-constant' class='summary_signature'>OPENSSL_VERSION_NUMBER =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>OpenSSL library version number used to compile the Ruby/OpenSSL extension. This may differ from the version used at runtime.</p>

<p>The version number is encoded into a single integer value. The number follows the format:</p>
<dl class="rdoc-list label-list"><dt>OpenSSL 3.0.0 or later</dt>
<dd>
<p><code>0xMNN00PP0</code> (major minor 00 patch 0)</p>
</dd><dt>OpenSSL 1.1.1 or earlier</dt>
<dd>
<p><code>0xMNNFFPPS</code> (major minor fix patch status)</p>
</dd><dt>LibreSSL</dt>
<dd>
<p><code>0x20000000</code> (a fixed value)</p>
</dd></dl>

<p>See also the man page OPENSSL_VERSION_NUMBER(3).</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L1051'># File 'ext/openssl/ossl.c', line 1051</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'><a href="#OPENSSL_VERSION_NUMBER-constant" title="OpenSSL::OPENSSL_VERSION_NUMBER (constant)">OPENSSL_VERSION_NUMBER</a></span>)</pre>
  </li>
  <li>
    <span id='VERSION-constant' class='summary_signature'>VERSION =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The version string of Ruby/OpenSSL.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/version.rb#L5-L5'># File 'ext/openssl/lib/openssl/version.rb', line 5</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>4.0.0</span><span class='tstring_end'>&quot;</span></span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#debug-class_method" title="debug (class method)">.<strong>debug</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns whether Ruby/OpenSSL’s debug mode is currently enabled.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#debug=-class_method" title="debug= (class method)">.<strong>debug=</strong>(boolean)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Turns on or off debug mode.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#fips_mode-class_method" title="fips_mode (class method)">.<strong>fips_mode</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns whether the FIPS mode is currently enabled.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#fips_mode=-class_method" title="fips_mode= (class method)">.<strong>fips_mode=</strong>(boolean)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Turns FIPS mode on or off.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#fixed_length_secure_compare-class_method" title="fixed_length_secure_compare (class method)">.<strong>fixed_length_secure_compare</strong>(string, string)  &#x21d2; Boolean </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Constant time memory comparison for fixed length strings, such as results of HMAC calculations.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#secure_compare-class_method" title="secure_compare (class method)">.<strong>secure_compare</strong>(string, string)  &#x21d2; Boolean </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Constant time memory comparison.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#Digest-class_method" title=".Digest (class method)"><strong>Digest</strong>(name)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a <a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)"><code>Digest</code></a> subclass by <em>name</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#errors-class_method" title="errors (class method)">.<strong>errors</strong>  &#x21d2; Array </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns any remaining errors held in the OpenSSL thread-local error queue and clears the queue.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->
<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="debug-class_method">
  <h3 class='signature rw  private first'>
    .<strong>debug</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='rw'>rw</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns whether Ruby/OpenSSL’s debug mode is currently enabled.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L425-L429'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='425' data-end='429'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl.c', line 425</span></pre>
<pre class='code cpp'>

static VALUE
ossl_debug_get(VALUE self)
{
    return dOSSL;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="debug=-class_method">
  <h3 class='signature rw  private'>
    .<strong>debug=</strong>(boolean)   <span class="extras">(<span class='rw'>rw</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Turns on or off debug mode. With debug mode, all errors added to the OpenSSL error queue will be printed to stderr.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L438-L444'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='438' data-end='444'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl.c', line 438</span></pre>
<pre class='code cpp'>

static VALUE
ossl_debug_set(VALUE self, VALUE val)
{
    dOSSL = RTEST(val) ? Qtrue : Qfalse;

    return val;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fips_mode-class_method">
  <h3 class='signature rw  private'>
    .<strong>fips_mode</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='rw'>rw</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns whether the FIPS mode is currently enabled.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L452-L467'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='452' data-end='467'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl.c', line 452</span></pre>
<pre class='code cpp'>

static VALUE
ossl_fips_mode_get(VALUE self)
{

#if OSSL_OPENSSL_PREREQ(3, 0, 0)
    VALUE enabled;
    enabled = EVP_default_properties_is_fips_enabled(NULL) ? Qtrue : Qfalse;
    return enabled;
#elif defined(OPENSSL_FIPS) || defined(OPENSSL_IS_AWSLC)
    VALUE enabled;
    enabled = FIPS_mode() ? Qtrue : Qfalse;
    return enabled;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fips_mode=-class_method">
  <h3 class='signature rw  private'>
    .<strong>fips_mode=</strong>(boolean)   <span class="extras">(<span class='rw'>rw</span>, <span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Turns FIPS mode on or off. Turning on FIPS mode will obviously only have an effect for FIPS-capable installations of the OpenSSL library. Trying to do so otherwise will result in an error.</p>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='const'>OpenSSL</span>.<span class='id identifier rubyid_fips_mode'><a href="#fips_mode-class_method" title="OpenSSL.fips_mode (method)">fips_mode</a></span> <span class='op'>=</span> <span class='kw'>true</span>   <span class='comment'># turn FIPS mode on
</span><span class='const'>OpenSSL</span>.<span class='id identifier rubyid_fips_mode'><a href="#fips_mode-class_method" title="OpenSSL.fips_mode (method)">fips_mode</a></span> <span class='op'>=</span> <span class='kw'>false</span>  <span class='comment'># and off again</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L481-L510'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='481' data-end='510'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl.c', line 481</span></pre>
<pre class='code cpp'>

static VALUE
ossl_fips_mode_set(VALUE self, VALUE enabled)
{
#if OSSL_OPENSSL_PREREQ(3, 0, 0)
    if (RTEST(enabled)) {
        if (!EVP_default_properties_enable_fips(NULL, 1)) {
            ossl_raise(eOSSLError, &quot;Turning on FIPS mode failed&quot;);
        }
    } else {
        if (!EVP_default_properties_enable_fips(NULL, 0)) {
            ossl_raise(eOSSLError, &quot;Turning off FIPS mode failed&quot;);
        }
    }
    return enabled;
#elif defined(OPENSSL_FIPS) || defined(OPENSSL_IS_AWSLC)
    if (RTEST(enabled)) {
        int mode = FIPS_mode();
        if(!mode &amp;&amp; !FIPS_mode_set(1)) /* turning on twice leads to an error */
            ossl_raise(eOSSLError, &quot;Turning on FIPS mode failed&quot;);
    } else {
        if(!FIPS_mode_set(0)) /* turning off twice is OK */
            ossl_raise(eOSSLError, &quot;Turning off FIPS mode failed&quot;);
    }
    return enabled;
#else
    if (RTEST(enabled))
        ossl_raise(eOSSLError, &quot;This version of OpenSSL does not support FIPS mode&quot;);
    return enabled;
#endif
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="Digest-class_method">
  <h3 class='signature private first'>
    <strong>Digest</strong>(name)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a <a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)"><code>::OpenSSL::Digest</code></a> subclass by <em>name</em></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openssl</span><span class='tstring_end'>&#39;</span></span>

<span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MD5</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; OpenSSL::Digest::MD5
</span>
<span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Foo</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; NameError: wrong constant name Foo</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl/digest.rb#L63-L65'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='63' data-end='65'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl/digest.rb', line 63</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_const_get'>const_get</span>(<span class='id identifier rubyid_name'>name</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="errors-class_method">
  <h3 class='signature private'>
    .<strong>errors</strong>  &#x21d2; <code>Array</code>  <span class="extras">(<span class='mod_func'>mod_func</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns any remaining errors held in the OpenSSL thread-local error queue and clears the queue. This should normally return an empty array.</p>

<p>This is intended for debugging Ruby/OpenSSL. If you see any errors here, it likely indicates a bug in the extension. Please file an issue at <a href="https://github.com/ruby/openssl">github.com/ruby/openssl</a>.</p>

<p>For debugging your program, <a href="#debug=-class_method" title="OpenSSL.debug= (method)">.debug=</a> may be useful.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L400-L412'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='400' data-end='412'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl.c', line 400</span></pre>
<pre class='code cpp'>

static VALUE
ossl_get_errors(VALUE _)
{
    VALUE ary;
    long e;

    ary = rb_ary_new();
    while ((e = ERR_get_error()) != 0){
        rb_ary_push(ary, rb_str_new2(ERR_error_string(e, NULL)));
    }

    return ary;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fixed_length_secure_compare-class_method">
  <h3 class='signature '>
    .<strong>fixed_length_secure_compare</strong>(string, string)  &#x21d2; <code>Boolean</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Constant time memory comparison for fixed length strings, such as results of HMAC calculations.</p>

<p>Returns <code>true</code> if the strings are identical, <code>false</code> if they are of the same length but not identical. If the length is different, ArgumentError is raised.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/ossl.c#L523-L539'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='523' data-end='539'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl.c', line 523</span></pre>
<pre class='code cpp'>

static VALUE
ossl_crypto_fixed_length_secure_compare(VALUE dummy, VALUE str1, VALUE str2)
{
    const unsigned char *p1 = (const unsigned char *)StringValuePtr(str1);
    const unsigned char *p2 = (const unsigned char *)StringValuePtr(str2);
    long len1 = RSTRING_LEN(str1);
    long len2 = RSTRING_LEN(str2);

    if (len1 != len2) {
        ossl_raise(rb_eArgError, &quot;inputs must be of equal length&quot;);
    }

    switch (CRYPTO_memcmp(p1, p2, len1)) {
      case 0: return Qtrue;
      default: return Qfalse;
    }
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="secure_compare-class_method">
  <h3 class='signature '>
    .<strong>secure_compare</strong>(string, string)  &#x21d2; <code>Boolean</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Constant time memory comparison. Inputs are hashed using SHA-256 to mask the length of the secret. Returns <code>true</code> if the strings are identical, <code>false</code> otherwise.</p>

<p>This method is expensive due to the SHA-256 hashing. In most cases, where the input lengths are known to be equal or are not sensitive, <a href="#fixed_length_secure_compare-class_method" title="OpenSSL.fixed_length_secure_compare (method)">.fixed_length_secure_compare</a> should be used instead.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/openssl/lib/openssl.rb#L36-L40'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='36' data-end='40'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/lib/openssl.rb', line 36</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_secure_compare'>secure_compare</span>(<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)
  <span class='id identifier rubyid_hashed_a'>hashed_a</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_digest'><a href="OpenSSL/Digest.html#digest-class_method" title="OpenSSL::Digest.digest (method)">digest</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA256</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span>)
  <span class='id identifier rubyid_hashed_b'>hashed_b</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'><a href="OpenSSL/Digest.html" title="OpenSSL::Digest (class)">Digest</a></span>.<span class='id identifier rubyid_digest'><a href="OpenSSL/Digest.html#digest-class_method" title="OpenSSL::Digest.digest (method)">digest</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA256</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)
  <span class='const'>OpenSSL</span>.<span class='id identifier rubyid_fixed_length_secure_compare'><a href="#fixed_length_secure_compare-class_method" title="OpenSSL.fixed_length_secure_compare (method)">fixed_length_secure_compare</a></span>(<span class='id identifier rubyid_hashed_a'>hashed_a</span><span class='comma'>,</span> <span class='id identifier rubyid_hashed_b'>hashed_b</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>==</span> <span class='id identifier rubyid_b'>b</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>