<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: NEWS &mdash; Ruby-master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "NEWS",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Ruby-master</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: NEWS&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="file_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<h1>NEWS for Ruby 3.4.0</h1>

<p>This document is a list of user-visible feature changes
since the <strong>3.3.0</strong> release, except for bug fixes.</p>

<p>Note that each entry is kept to a minimum, see links for details.</p>

<h2>Language changes</h2>

<ul>
<li><p>String literals in files without a <code>frozen_string_literal</code> comment now behave
as if they were frozen. If they are mutated a deprecation warning is emitted.
These warnings can be enabled with <code>-W:deprecated</code> or by setting <code>Warning[:deprecated] = true</code>.
To disable this change, you can run Ruby with the <code>--disable-frozen-string-literal</code>
command line argument. [<a href="https://bugs.ruby-lang.org/issues/20205">Feature #20205</a>]</p></li>
<li><p><code>it</code> is added to reference a block parameter. [<a href="https://bugs.ruby-lang.org/issues/18980">Feature #18980</a>]</p></li>
<li><p>Keyword splatting <code>nil</code> when calling methods is now supported.
<code>**nil</code> is treated similarly to <code>**{}</code>, passing no keywords,
and not calling any conversion methods.  [<a href="https://bugs.ruby-lang.org/issues/20064">Bug #20064</a>]</p></li>
<li><p>Block passing is no longer allowed in index.  [<a href="https://bugs.ruby-lang.org/issues/19918">Bug #19918</a>]</p></li>
<li><p>Keyword arguments are no longer allowed in index.  [<a href="https://bugs.ruby-lang.org/issues/20218">Bug #20218</a>]</p></li>
</ul>

<h2>Core classes updates</h2>

<p>Note: We&#39;re only listing outstanding class updates.</p>

<ul>
<li><p>Exception</p>

<ul>
<li>Exception#set_backtrace now accepts arrays of <code>Thread::Backtrace::Location</code>.
<code>Kernel#raise</code>, <code>Thread#raise</code> and <code>Fiber#raise</code> also accept this new format. [<a href="https://bugs.ruby-lang.org/issues/13557">Feature #13557</a>]</li>
</ul></li>
<li><p>Range</p>

<ul>
<li>Range#size now raises TypeError if the range is not iterable. [<a href="https://bugs.ruby-lang.org/issues/18984">Misc #18984</a>]</li>
</ul></li>
</ul>

<h2>Stdlib updates</h2>

<p>The following default gems are updated.</p>

<ul>
<li>RubyGems 3.6.0.dev</li>
<li>bundler 2.6.0.dev</li>
<li>erb 4.0.4</li>
<li>fiddle 1.1.3</li>
<li>io-console 0.7.2</li>
<li>irb 1.13.1</li>
<li>json 2.7.2</li>
<li>net-http 0.4.1</li>
<li>optparse 0.5.0</li>
<li>prism 0.28.0</li>
<li>rdoc 6.6.3.1</li>
<li>reline 0.5.5</li>
<li>resolv 0.4.0</li>
<li>stringio 3.1.1</li>
<li>strscan 3.1.1</li>
</ul>

<p>The following bundled gems are updated.</p>

<ul>
<li>minitest 5.22.3</li>
<li>rake 13.2.1</li>
<li>test-unit 3.6.2</li>
<li>net-ftp 0.3.4</li>
<li>net-imap 0.4.10</li>
<li>net-smtp 0.5.0</li>
<li>rbs 3.4.4</li>
<li>typeprof 0.21.11</li>
<li>debug 1.9.2</li>
</ul>

<p>The following bundled gems are promoted from default gems.</p>

<ul>
<li>mutex_m 0.2.0</li>
<li>getoptlong 0.2.1</li>
<li>base64 0.2.0</li>
<li>bigdecimal 3.1.8</li>
<li>observer 0.1.2</li>
<li>abbrev 0.1.2</li>
<li>resolv-replace 0.1.1</li>
<li>rinda 0.2.0</li>
<li>drb 2.2.1</li>
<li>nkf 0.2.0</li>
<li>syslog 0.1.2</li>
<li>csv 3.3.0</li>
</ul>

<p>See GitHub releases like <a href="https://github.com/ruby/logger/releases">GitHub Releases of Logger</a> or changelog for details of the default gems or bundled gems.</p>

<h2>Supported platforms</h2>

<h2>Compatibility issues</h2>

<ul>
<li>Error messages and backtrace displays have been changed.

<ul>
<li>Use a single quote instead of a backtick as a opening quote. [<a href="https://bugs.ruby-lang.org/issues/16495">Feature #16495</a>]</li>
<li>Display a class name before a method name (only when the class has a permanent name). [<a href="https://bugs.ruby-lang.org/issues/19117">Feature #19117</a>]</li>
<li><code>Kernel#caller</code>, <code>Thread::Backtrace::Location</code>&#39;s methods, etc. are also changed accordingly.
``<code>
Old:
test.rb:1:in</code>foo&#39;: undefined method <code>time&#39; for an instance of Integer
  from test.rb:2:in</code><main>&#39;</li>
</ul></li>
</ul>

<p>New:
  test.rb:1:in &#39;Object#foo&#39;: undefined method &#39;time&#39; for an instance of Integer
          from test.rb:2:in `<main>&#39;</p>

<pre class="code ruby"><code class="ruby"><span class='comment'>## Stdlib compatibility issues
</span>
<span class='comment'>## C API updates
</span>
<span class='op'>*</span> <span class='backtick'>`</span><span class='tstring_content'>rb_newobj</span><span class='tstring_end'>`</span></span> <span class='kw'>and</span> <span class='backtick'>`</span><span class='tstring_content'>rb_newobj_of</span><span class='tstring_end'>`</span></span> (<span class='kw'>and</span> <span class='id identifier rubyid_corresponding'>corresponding</span> <span class='id identifier rubyid_macros'>macros</span> {<span class='const'>RB_NEWOBJ</span>}<span class='comma'>,</span> {<span class='const'>RB_NEWOBJ_OF</span>}<span class='comma'>,</span> {<span class='const'>NEWOBJ</span>}<span class='comma'>,</span> {<span class='const'>NEWOBJ_OF</span>}) <span class='id identifier rubyid_have'>have</span> <span class='id identifier rubyid_been'>been</span> <span class='id identifier rubyid_removed'>removed</span>. [[<span class='const'>Feature</span> <span class='comment'>#20265]]
</span><span class='op'>*</span> <span class='const'>Removed</span> <span class='id identifier rubyid_deprecated'>deprecated</span> <span class='id identifier rubyid_function'>function</span> <span class='backtick'>`</span><span class='tstring_content'>rb_gc_force_recycle</span><span class='tstring_end'>`</span></span>. [[<span class='const'>Feature</span> <span class='comment'>#18290]]
</span>
<span class='comment'>## Implementation improvements
</span>
<span class='op'>*</span> {<span class='const'>Array</span><span class='comment'>#each} is rewritten in Ruby for better performance [[Feature #20182]].
</span>
<span class='comment'>## JIT
</span>
<span class='comment'>## Miscellaneous changes
</span>
<span class='op'>*</span> <span class='const'>Passing</span> <span class='id identifier rubyid_a'>a</span> <span class='id identifier rubyid_block'>block</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_a'>a</span> <span class='id identifier rubyid_method'>method</span> <span class='id identifier rubyid_which'>which</span> <span class='id identifier rubyid_doesn'>doesn</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t use the passed block will show
  a warning on verbose mode (`-w`).
  [[Feature #15554]]

* Redefining some core methods that are specially optimized by the interpeter
  and JIT like {String.freeze} or {Integer#+} now emits a performance class
  warning (`-W:performance` or `Warning[:performance] = true`).
  [[Feature #20429]]</span></code></pre>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>