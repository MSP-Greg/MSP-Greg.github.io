<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Addrinfo &mdash; socket</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Addrinfo",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-master</a> &raquo; 
      <a href='.'>socket</a> &raquo; 
      <a href='_index.html#alpha_A'>Index (A)</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Addrinfo&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Addrinfo</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L3022'>ext/socket/raddrinfo.c</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L10'>ext/socket/lib/socket.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>The Addrinfo class maps <code>struct addrinfo</code> to ruby.  This structure identifies an Internet host and a service.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#foreach-class_method" title=".foreach (class method)">.<strong>foreach</strong>(nodename, service, family = nil, socktype = nil, protocol = nil, flags = nil, timeout: nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>iterates over the list of <code>Addrinfo</code> objects obtained by <a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">.getaddrinfo</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#getaddrinfo-class_method" title="getaddrinfo (class method)">.<strong>getaddrinfo</strong>(nodename, service, family, socktype, protocol, flags)  &#x21d2; Addrinfo, ... </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a list of addrinfo objects as an array.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip-class_method" title="ip (class method)">.<strong>ip</strong>(host)  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for IP address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(sockaddr)  &#x21d2; Addrinfo </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a new instance of <code>Addrinfo</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#tcp-class_method" title="tcp (class method)">.<strong>tcp</strong>(host, port)  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for TCP address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#udp-class_method" title="udp (class method)">.<strong>udp</strong>(host, port)  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for UDP address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unix-class_method" title="unix (class method)">.<strong>unix</strong>(path [, socktype])  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for UNIX socket address.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#ip%3F-instance_method" title="#ip? (instance method)">#<strong>ip?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is internet (IPv4/IPv6) address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4%3F-instance_method" title="#ipv4? (instance method)">#<strong>ipv4?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is IPv4 address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4_loopback%3F-instance_method" title="#ipv4_loopback? (instance method)">#<strong>ipv4_loopback?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4 loopback address (127.0.0.0/8).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4_multicast%3F-instance_method" title="#ipv4_multicast? (instance method)">#<strong>ipv4_multicast?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4 multicast address (224.0.0.0/4).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4_private%3F-instance_method" title="#ipv4_private? (instance method)">#<strong>ipv4_private?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4 private address (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6%3F-instance_method" title="#ipv6? (instance method)">#<strong>ipv6?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is IPv6 address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_linklocal%3F-instance_method" title="#ipv6_linklocal? (instance method)">#<strong>ipv6_linklocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 link local address (fe80::/10).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_loopback%3F-instance_method" title="#ipv6_loopback? (instance method)">#<strong>ipv6_loopback?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 loopback address (::1).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_global%3F-instance_method" title="#ipv6_mc_global? (instance method)">#<strong>ipv6_mc_global?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast global scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_linklocal%3F-instance_method" title="#ipv6_mc_linklocal? (instance method)">#<strong>ipv6_mc_linklocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast link-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_nodelocal%3F-instance_method" title="#ipv6_mc_nodelocal? (instance method)">#<strong>ipv6_mc_nodelocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast node-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_orglocal%3F-instance_method" title="#ipv6_mc_orglocal? (instance method)">#<strong>ipv6_mc_orglocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast organization-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_sitelocal%3F-instance_method" title="#ipv6_mc_sitelocal? (instance method)">#<strong>ipv6_mc_sitelocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast site-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_multicast%3F-instance_method" title="#ipv6_multicast? (instance method)">#<strong>ipv6_multicast?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast address (ff00::/8).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_sitelocal%3F-instance_method" title="#ipv6_sitelocal? (instance method)">#<strong>ipv6_sitelocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 site local address (fec0::/10).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_unique_local%3F-instance_method" title="#ipv6_unique_local? (instance method)">#<strong>ipv6_unique_local?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 unique local address (fc00::/7, RFC4193).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_unspecified%3F-instance_method" title="#ipv6_unspecified? (instance method)">#<strong>ipv6_unspecified?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 unspecified address (::).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_v4compat%3F-instance_method" title="#ipv6_v4compat? (instance method)">#<strong>ipv6_v4compat?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4-compatible IPv6 address (::/80).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_v4mapped%3F-instance_method" title="#ipv6_v4mapped? (instance method)">#<strong>ipv6_v4mapped?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4-mapped IPv6 address (::ffff:0:0/80).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#unix%3F-instance_method" title="#unix? (instance method)">#<strong>unix?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is UNIX address.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#afamily-instance_method" title="#afamily (instance method)">#<strong>afamily</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the address family as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#bind-instance_method" title="#bind (instance method)">#<strong>bind</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket bound to self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#canonname-instance_method" title="#canonname (instance method)">#<strong>canonname</strong>  &#x21d2; String<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the canonical name as a string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect-instance_method" title="#connect (instance method)">#<strong>connect</strong>([opts]) {|socket| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket connected to the address of self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect_from-instance_method" title="#connect_from (instance method)">#<strong>connect_from</strong>([local_addr_args], [opts]) {|socket| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket connected to the address of self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect_to-instance_method" title="#connect_to (instance method)">#<strong>connect_to</strong>([remote_addr_args], [opts]) {|socket| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket connected to <em>remote_addr_args</em> and bound to self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#family_addrinfo-instance_method" title="#family_addrinfo (instance method)">#<strong>family_addrinfo</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates an <code>Addrinfo</code> object from the arguments.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#getnameinfo-instance_method" title="#getnameinfo (instance method)">#<strong>getnameinfo</strong>  &#x21d2; Array, service </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns nodename and service as a pair of strings.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a string which shows addrinfo in human-readable form.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect_sockaddr-instance_method" title="#inspect_sockaddr (instance method)">#<strong>inspect_sockaddr</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a string which shows the sockaddr in <em>addrinfo</em> with human-readable form.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip_address-instance_method" title="#ip_address (instance method)">#<strong>ip_address</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the IP address as a string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip_port-instance_method" title="#ip_port (instance method)">#<strong>ip_port</strong>  &#x21d2; port </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the port number as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip_unpack-instance_method" title="#ip_unpack (instance method)">#<strong>ip_unpack</strong>  &#x21d2; Array, port </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the IP address and port number as 2-element array.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ipv6_to_ipv4-instance_method" title="#ipv6_to_ipv4 (instance method)">#<strong>ipv6_to_ipv4</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns IPv4 address of IPv4 mapped/compatible IPv6 address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#listen-instance_method" title="#listen (instance method)">#<strong>listen</strong>(backlog = Socket::SOMAXCONN)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a listening socket bound to self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pfamily-instance_method" title="#pfamily (instance method)">#<strong>pfamily</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the protocol family as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#protocol-instance_method" title="#protocol (instance method)">#<strong>protocol</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the socket type as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#socktype-instance_method" title="#socktype (instance method)">#<strong>socktype</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the socket type as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_s-instance_method" title="#to_sockaddr (instance method)">#<strong>to_sockaddr</strong>  &#x21d2; String </a>
      (also: #to_sockaddr)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the socket address as packed struct sockaddr string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_sockaddr-instance_method" title="#to_sockaddr (instance method)">#<strong>to_sockaddr</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#to_s-instance_method" title="Addrinfo#to_s (method)">#to_s</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unix_path-instance_method" title="#unix_path (instance method)">#<strong>unix_path</strong>  &#x21d2; path </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the socket path as a string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature prot'>
      <a href="#connect_internal-instance_method" title="#connect_internal (instance method)">#<strong>connect_internal</strong>(local_addrinfo, timeout = nil)  </a>
    </span>
    <span class='note title protected'>protected</span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a new <a href="Socket.html" title="Socket (class)"><code>::Socket</code></a> connected to the address of <code>local_addrinfo</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#marshal_dump-instance_method" title="#marshal_dump (instance method)">#<strong>marshal_dump</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#marshal_load-instance_method" title="#marshal_load (instance method)">#<strong>marshal_load</strong>(ary)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    <div class='inline-block'>
      <span class='overload'>.<strong>new</strong>(sockaddr)  &#x21d2; <code>Addrinfo</code> </span>
      <span class='overload'>.<strong>new</strong>(sockaddr, family)  &#x21d2; <code>Addrinfo</code> </span>
      <span class='overload'>.<strong>new</strong>(sockaddr, family, socktype)  &#x21d2; <code>Addrinfo</code> </span>
      <span class='overload'>.<strong>new</strong>(sockaddr, family, socktype, protocol)  &#x21d2; <code>Addrinfo</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a new instance of <code>Addrinfo</code>. The instance contains sockaddr, family, socktype, protocol. sockaddr means struct sockaddr which can be used for connect(2), etc. family, socktype and protocol are integers which is used for arguments of socket(2).</p>

<p>sockaddr is specified as an array or a string. The array should be compatible to the value of <a href="IPSocket.html#addr-instance_method" title="IPSocket#addr (method)">IPSocket#addr</a> or <a href="UNIXSocket.html#addr-instance_method" title="UNIXSocket#addr (method)">UNIXSocket#addr</a>. The string should be struct sockaddr as generated by <a href="Socket.html#sockaddr_in-class_method" title="Socket.sockaddr_in (method)">Socket.sockaddr_in</a> or <a href="Socket.html#unpack_sockaddr_un-class_method" title="Socket.unpack_sockaddr_un (method)">Socket.unpack_sockaddr_un</a>.</p>

<p>sockaddr examples:</p>
<ul><li>
<p><code>[&quot;AF_INET&quot;, 46102, &quot;localhost.localdomain&quot;, &quot;127.0.0.1&quot;]</code></p>
</li><li>
<p><code>[&quot;AF_INET6&quot;, 42304, &quot;ip6-localhost&quot;, &quot;::1&quot;]</code></p>
</li><li>
<p><code>[&quot;AF_UNIX&quot;, &quot;/tmp/sock&quot;]</code></p>
</li><li>
<p><code>Socket.sockaddr_in(&quot;smtp&quot;, &quot;2001:DB8::1&quot;)</code></p>
</li><li>
<p><code>Socket.sockaddr_in(80, &quot;172.18.22.42&quot;)</code></p>
</li><li>
<p><code>Socket.sockaddr_in(80, &quot;www.ruby-lang.org&quot;)</code></p>
</li><li>
<p><code>Socket.sockaddr_un(&quot;/tmp/sock&quot;)</code></p>
</li></ul>

<p>In an AF_INET/AF_INET6 sockaddr array, the 4th element, numeric IP address, is used to construct socket address in the <code>Addrinfo</code> instance. If the 3rd element, textual host name, is non-nil, it is also recorded but used only for <a href="#inspect-instance_method" title="Addrinfo#inspect (method)">#inspect</a>.</p>

<p>family is specified as an integer to specify the protocol family such as <a href="Socket.html#PF_INET-constant" title="Socket::PF_INET (constant)">Socket::PF_INET</a>. It can be a symbol or a string which is the constant name with or without PF_ prefix such as <code>:INET</code>, <code>:INET6</code>, <code>:UNIX</code>, “PF_INET”, etc. If omitted, PF_UNSPEC is assumed.</p>

<p>socktype is specified as an integer to specify the socket type such as <a href="Socket.html#SOCK_STREAM-constant" title="Socket::SOCK_STREAM (constant)">Socket::SOCK_STREAM</a>. It can be a symbol or a string which is the constant name with or without SOCK_ prefix such as <code>:STREAM</code>, <code>:DGRAM</code>, <code>:RAW</code>, “SOCK_STREAM”, etc. If omitted, 0 is assumed.</p>

<p>protocol is specified as an integer to specify the protocol such as <a href="Socket.html#IPPROTO_TCP-constant" title="Socket::IPPROTO_TCP (constant)">Socket::IPPROTO_TCP</a>. It must be an integer, unlike family and socktype. If omitted, 0 is assumed. Note that 0 is reasonable value for most protocols, except raw socket.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L1494-L1572'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1494' data-end='1572'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1494</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_initialize(int argc, VALUE *argv, VALUE self)
{
    rb_addrinfo_t *rai;
    VALUE sockaddr_arg, sockaddr_ary, pfamily, socktype, protocol;
    int i_pfamily, i_socktype, i_protocol;
    struct sockaddr *sockaddr_ptr;
    socklen_t sockaddr_len;
    VALUE canonname = Qnil, inspectname = Qnil;

    if (check_addrinfo(self))
        rb_raise(rb_eTypeError, &quot;already initialized socket address&quot;);
    DATA_PTR(self) = rai = alloc_addrinfo();

    rb_scan_args(argc, argv, &quot;13&quot;, &amp;sockaddr_arg, &amp;pfamily, &amp;socktype, &amp;protocol);

    i_pfamily = NIL_P(pfamily) ? PF_UNSPEC : rsock_family_arg(pfamily);
    i_socktype = NIL_P(socktype) ? 0 : rsock_socktype_arg(socktype);
    i_protocol = NIL_P(protocol) ? 0 : NUM2INT(protocol);

    sockaddr_ary = rb_check_array_type(sockaddr_arg);
    if (!NIL_P(sockaddr_ary)) {
        VALUE afamily = rb_ary_entry(sockaddr_ary, 0);
        int af;
        StringValue(afamily);
        if (rsock_family_to_int(RSTRING_PTR(afamily), RSTRING_LEN(afamily), &amp;af) == -1)
            rb_raise(rb_eSocket, &quot;unknown address family: %s&quot;, StringValueCStr(afamily));
        switch (af) {
          case AF_INET: /* [&quot;AF_INET&quot;, 46102, &quot;localhost.localdomain&quot;, &quot;127.0.0.1&quot;] */
#ifdef INET6
          case AF_INET6: /* [&quot;AF_INET6&quot;, 42304, &quot;ip6-localhost&quot;, &quot;::1&quot;] */
#endif
          {
            VALUE service = rb_ary_entry(sockaddr_ary, 1);
            VALUE nodename = rb_ary_entry(sockaddr_ary, 2);
            VALUE numericnode = rb_ary_entry(sockaddr_ary, 3);
            int flags;

            service = INT2NUM(NUM2INT(service));
            if (!NIL_P(nodename))
                StringValue(nodename);
            StringValue(numericnode);
            flags = AI_NUMERICHOST;
#ifdef AI_NUMERICSERV
            flags |= AI_NUMERICSERV;
#endif

            init_addrinfo_getaddrinfo(rai, numericnode, service,
                    INT2NUM(i_pfamily ? i_pfamily : af), INT2NUM(i_socktype), INT2NUM(i_protocol),
                    INT2NUM(flags),
                    nodename, service);
            break;
          }

#ifdef HAVE_TYPE_STRUCT_SOCKADDR_UN
          case AF_UNIX: /* [&quot;AF_UNIX&quot;, &quot;/tmp/sock&quot;] */
          {
            VALUE path = rb_ary_entry(sockaddr_ary, 1);
            StringValue(path);
            init_unix_addrinfo(rai, path, SOCK_STREAM);
            break;
          }
#endif

          default:
            rb_raise(rb_eSocket, &quot;unexpected address family&quot;);
        }
    }
    else {
        StringValue(sockaddr_arg);
        sockaddr_ptr = (struct sockaddr *)RSTRING_PTR(sockaddr_arg);
        sockaddr_len = RSTRING_SOCKLEN(sockaddr_arg);
        init_addrinfo(rai, sockaddr_ptr, sockaddr_len,
                      i_pfamily, i_socktype, i_protocol,
                      canonname, inspectname);
    }

    return self;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="foreach-class_method">
  <h3 class='signature  first'>
    .<strong>foreach</strong>(nodename, service, family = nil, socktype = nil, protocol = nil, flags = nil, timeout: nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>iterates over the list of <code>Addrinfo</code> objects obtained by <a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">.getaddrinfo</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_foreach'>foreach</span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>80</span>) {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_x'>x</span> }
<span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1:80 TCP (:80)&gt;
</span><span class='comment'>#   #&lt;Addrinfo: 127.0.0.1:80 UDP (:80)&gt;
</span><span class='comment'>#   #&lt;Addrinfo: [::1]:80 TCP (:80)&gt;
</span><span class='comment'>#   #&lt;Addrinfo: [::1]:80 UDP (:80)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L230-L232'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='230' data-end='232'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 230</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_foreach'>foreach</span>(<span class='id identifier rubyid_nodename'>nodename</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span><span class='comma'>,</span> <span class='id identifier rubyid_family'>family</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_protocol'><a href="#protocol-instance_method" title="Addrinfo#protocol (method)">protocol</a></span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='const'>Addrinfo</span>.<span class='id identifier rubyid_getaddrinfo'><a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">getaddrinfo</a></span>(<span class='id identifier rubyid_nodename'>nodename</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span><span class='comma'>,</span> <span class='id identifier rubyid_family'>family</span><span class='comma'>,</span> <span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span><span class='comma'>,</span> <span class='id identifier rubyid_protocol'><a href="#protocol-instance_method" title="Addrinfo#protocol (method)">protocol</a></span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span>).<span class='id identifier rubyid_each'>each</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="getaddrinfo-class_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family, socktype, protocol, flags)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family, socktype, protocol)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family, socktype)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service)  &#x21d2; <code>Addrinfo</code>, ... </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a list of addrinfo objects as an array.</p>

<p>This method converts nodename (hostname) and service (port) to addrinfo. Since the conversion is not unique, the result is a list of addrinfo objects.</p>

<p>nodename or service can be nil if no conversion intended.</p>

<p>family, socktype and protocol are hint for preferred protocol. If the result will be used for a socket with SOCK_STREAM, SOCK_STREAM should be specified as socktype. If so, <code>getaddrinfo</code> returns addrinfo list appropriate for SOCK_STREAM. If they are omitted or nil is given, the result is not restricted.</p>

<p>Similarly, PF_INET6 as family restricts for IPv6.</p>

<p>flags should be bitwise OR of Socket::AI_??? constants such as follows. Note that the exact list of the constants depends on OS.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>AI_PASSIVE</span>      <span class='const'>Get</span> <span class='id identifier rubyid_address'>address</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_use'>use</span> <span class='id identifier rubyid_with'>with</span> <span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Addrinfo#bind (method)">bind</a></span>()
<span class='const'>AI_CANONNAME</span>    <span class='const'>Fill</span> <span class='kw'>in</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_canonical'>canonical</span> <span class='id identifier rubyid_name'>name</span>
<span class='const'>AI_NUMERICHOST</span>  <span class='const'>Prevent</span> <span class='id identifier rubyid_host'>host</span> <span class='id identifier rubyid_name'>name</span> <span class='id identifier rubyid_resolution'>resolution</span>
<span class='const'>AI_NUMERICSERV</span>  <span class='const'>Prevent</span> <span class='id identifier rubyid_service'>service</span> <span class='id identifier rubyid_name'>name</span> <span class='id identifier rubyid_resolution'>resolution</span>
<span class='const'>AI_V4MAPPED</span>     <span class='const'>Accept</span> <span class='const'>IPv4</span><span class='op'>-</span><span class='id identifier rubyid_mapped'>mapped</span> <span class='const'>IPv6</span> <span class='id identifier rubyid_addresses'>addresses</span>
<span class='const'>AI_ALL</span>          <span class='const'>Allow</span> <span class='id identifier rubyid_all'>all</span> <span class='id identifier rubyid_addresses'>addresses</span>
<span class='const'>AI_ADDRCONFIG</span>   <span class='const'>Accept</span> <span class='id identifier rubyid_only'>only</span> <span class='kw'>if</span> <span class='id identifier rubyid_any'>any</span> <span class='id identifier rubyid_address'>address</span> <span class='id identifier rubyid_is'>is</span> <span class='id identifier rubyid_assigned'>assigned</span></code></pre>

<p>Note that socktype should be specified whenever application knows the usage of the address. Some platform causes an error when socktype is omitted and servname is specified as an integer because some port numbers, 512 for example, are ambiguous without socktype.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_getaddrinfo'>getaddrinfo</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.kame.net</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>STREAM</span>)
<span class='comment'>#=&gt; [#&lt;Addrinfo: 203.178.141.194:80 TCP (www.kame.net)&gt;,
</span><span class='comment'>#    #&lt;Addrinfo: [2001:200:dff:fff1:216:3eff:feb1:44d7]:80 TCP (www.kame.net)&gt;]</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2824-L2837'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2824' data-end='2837'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2824</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_getaddrinfo(int argc, VALUE *argv, VALUE self)
{
    VALUE node, service, family, socktype, protocol, flags, opts, timeout;

    rb_scan_args(argc, argv, &quot;24:&quot;, &amp;node, &amp;service, &amp;family, &amp;socktype,
                 &amp;protocol, &amp;flags, &amp;opts);
    rb_get_kwargs(opts, &amp;id_timeout, 0, 1, &amp;timeout);
    if (timeout == Qundef) {
        timeout = Qnil;
    }

    return addrinfo_list_new(node, service, family, socktype, protocol, flags, timeout);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip-class_method">
  <h3 class='signature '>
    .<strong>ip</strong>(host)  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for IP address.</p>

<p>The port, socktype, protocol of the result is filled by zero. So, it is not appropriate to create a socket.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_ip'>ip</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1 (localhost)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2850-L2861'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2850' data-end='2861'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2850</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_ip(VALUE self, VALUE host)
{
    VALUE ret;
    rb_addrinfo_t *rai;
    ret = addrinfo_firstonly_new(host, Qnil,
            INT2NUM(PF_UNSPEC), INT2FIX(0), INT2FIX(0), INT2FIX(0));
    rai = get_addrinfo(ret);
    rai-&gt;socktype = 0;
    rai-&gt;protocol = 0;
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="tcp-class_method">
  <h3 class='signature '>
    .<strong>tcp</strong>(host, port)  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for TCP address.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'>tcp</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>smtp</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1:25 TCP (localhost:smtp)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2871-L2876'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2871' data-end='2876'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2871</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_tcp(VALUE self, VALUE host, VALUE port)
{
    return addrinfo_firstonly_new(host, port,
            INT2NUM(PF_UNSPEC), INT2NUM(SOCK_STREAM), INT2NUM(IPPROTO_TCP), INT2FIX(0));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="udp-class_method">
  <h3 class='signature '>
    .<strong>udp</strong>(host, port)  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for UDP address.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_udp'>udp</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>daytime</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1:13 UDP (localhost:daytime)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2886-L2891'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2886' data-end='2891'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2886</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_udp(VALUE self, VALUE host, VALUE port)
{
    return addrinfo_firstonly_new(host, port,
            INT2NUM(PF_UNSPEC), INT2NUM(SOCK_DGRAM), INT2NUM(IPPROTO_UDP), INT2FIX(0));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unix-class_method">
  <h3 class='signature '>
    .<strong>unix</strong>(path [, socktype])  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for UNIX socket address.</p>

<p><em>socktype</em> specifies the socket type. If it is omitted, <code>:STREAM</code> is used.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'>unix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>)         <span class='comment'>#=&gt; #&lt;Addrinfo: /tmp/sock SOCK_STREAM&gt;
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'>unix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>DGRAM</span>) <span class='comment'>#=&gt; #&lt;Addrinfo: /tmp/sock SOCK_DGRAM&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2907-L2925'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2907' data-end='2925'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2907</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_unix(int argc, VALUE *argv, VALUE self)
{
    VALUE path, vsocktype, addr;
    int socktype;
    rb_addrinfo_t *rai;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;path, &amp;vsocktype);

    if (NIL_P(vsocktype))
        socktype = SOCK_STREAM;
    else
        socktype = rsock_socktype_arg(vsocktype);

    addr = addrinfo_s_allocate(rb_cAddrinfo);
    DATA_PTR(addr) = rai = alloc_addrinfo();
    init_unix_addrinfo(rai, path, socktype);
    return addr;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="ip?-instance_method">
  <h3 class='signature ro first'>
    #<strong>ip?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is internet (IPv4/IPv6) address. returns false otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip?'>ip?</span> <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip?'>ip?</span>       <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ip?'>ip?</span>    <span class='comment'>#=&gt; false</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2279-L2285'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2279' data-end='2285'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2279</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_p(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    return IS_IP_FAMILY(family) ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is IPv4 address. returns false otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ipv4?'>ipv4?</span> <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ipv4?'>ipv4?</span>       <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ipv4?'>ipv4?</span>    <span class='comment'>#=&gt; false</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2299-L2304'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2299' data-end='2304'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2299</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_p(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return ai_get_afamily(rai) == AF_INET ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4_loopback?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4_loopback?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4 loopback address (127.0.0.0/8). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2521-L2529'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2521' data-end='2529'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2521</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_loopback_p(VALUE self)
{
    uint32_t a;
    if (!extract_in_addr(self, &amp;a)) return Qfalse;
    if ((a &amp; 0xff000000) == 0x7f000000) /* 127.0.0.0/8 */
        return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4_multicast?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4_multicast?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4 multicast address (224.0.0.0/4). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2535-L2543'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2535' data-end='2543'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2535</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_multicast_p(VALUE self)
{
    uint32_t a;
    if (!extract_in_addr(self, &amp;a)) return Qfalse;
    if ((a &amp; 0xf0000000) == 0xe0000000) /* 224.0.0.0/4 */
        return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4_private?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4_private?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4 private address (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2505-L2515'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2505' data-end='2515'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2505</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_private_p(VALUE self)
{
    uint32_t a;
    if (!extract_in_addr(self, &amp;a)) return Qfalse;
    if ((a &amp; 0xff000000) == 0x0a000000 || /* 10.0.0.0/8 */
        (a &amp; 0xfff00000) == 0xac100000 || /* 172.16.0.0/12 */
        (a &amp; 0xffff0000) == 0xc0a80000)   /* 192.168.0.0/16 */
        return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is IPv6 address. returns false otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ipv6?'>ipv6?</span> <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ipv6?'>ipv6?</span>       <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ipv6?'>ipv6?</span>    <span class='comment'>#=&gt; false</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2318-L2327'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2318' data-end='2327'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2318</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_p(VALUE self)
{
#ifdef AF_INET6
    rb_addrinfo_t *rai = get_addrinfo(self);
    return ai_get_afamily(rai) == AF_INET6 ? Qtrue : Qfalse;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_linklocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_linklocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 link local address (fe80::/10). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2596-L2602'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2596' data-end='2602'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2596</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_linklocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_LINKLOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_loopback?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_loopback?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 loopback address (::1). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2572-L2578'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2572' data-end='2578'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2572</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_loopback_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_LOOPBACK(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_global?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_global?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast global scope address. It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2704-L2710'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2704' data-end='2710'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2704</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_global_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_GLOBAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_linklocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_linklocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast link-local scope address. It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2668-L2674'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2668' data-end='2674'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2668</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_linklocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_LINKLOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_nodelocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_nodelocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast node-local scope address. It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2656-L2662'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2656' data-end='2662'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2656</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_nodelocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_NODELOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_orglocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_orglocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast organization-local scope address. It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2692-L2698'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2692' data-end='2698'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2692</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_orglocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_ORGLOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_sitelocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_sitelocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast site-local scope address. It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2680-L2686'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2680' data-end='2686'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2680</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_sitelocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_SITELOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_multicast?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_multicast?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast address (ff00::/8). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2584-L2590'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2584' data-end='2590'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2584</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_multicast_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MULTICAST(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_sitelocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_sitelocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 site local address (fec0::/10). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2608-L2614'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2608' data-end='2614'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2608</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_sitelocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_SITELOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_unique_local?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_unique_local?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 unique local address (fc00::/7, RFC4193). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2620-L2626'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2620' data-end='2626'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2620</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_unique_local_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_UNIQUE_LOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_unspecified?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_unspecified?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 unspecified address (::). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2560-L2566'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2560' data-end='2566'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2560</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_unspecified_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_UNSPECIFIED(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_v4compat?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_v4compat?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4-compatible IPv6 address (::/80). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2644-L2650'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2644' data-end='2650'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2644</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_v4compat_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_V4COMPAT(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_v4mapped?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_v4mapped?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4-mapped IPv6 address (::ffff:0:0/80). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2632-L2638'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2632' data-end='2638'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2632</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_v4mapped_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_V4MAPPED(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unix?-instance_method">
  <h3 class='signature ro'>
    #<strong>unix?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is UNIX address. returns false otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_unix?'>unix?</span> <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_unix?'>unix?</span>       <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_unix?'>unix?</span>    <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2341-L2350'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2341' data-end='2350'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2341</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_unix_p(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
#ifdef AF_UNIX
    return ai_get_afamily(rai) == AF_UNIX ? Qtrue : Qfalse;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="afamily-instance_method">
  <h3 class='signature  first'>
    #<strong>afamily</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the address family as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_afamily'>afamily</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'><a href="Socket.html#AF_INET-constant" title="Socket::AF_INET (constant)">AF_INET</a></span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2170-L2175'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2170' data-end='2175'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2170</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_afamily(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(ai_get_afamily(rai));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bind-instance_method">
  <h3 class='signature '>
    #<strong>bind</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket bound to self.</p>

<p>If a block is given, it is called with the socket and the value of the block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_udp'><a href="#udp-class_method" title="Addrinfo.udp (method)">udp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>9981</span>).<span class='id identifier rubyid_bind'>bind</span> {<span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_local_address'>local_address</span>.<span class='id identifier rubyid_connect'><a href="#connect-instance_method" title="Addrinfo#connect (method)">connect</a></span> {<span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span> }
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_recv'>recv</span>(<span class='int'>10</span>) <span class='comment'>#=&gt; &quot;hello&quot;
</span>}</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L178-L197'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='178' data-end='197'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 178</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bind'>bind</span>
  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span>.<span class='id identifier rubyid_new'><a href="Socket.html#new-class_method" title="Socket.new (method)">new</a></span>(<span class='kw'>self</span>.<span class='id identifier rubyid_pfamily'><a href="#pfamily-instance_method" title="Addrinfo#pfamily (method)">pfamily</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_protocol'><a href="#protocol-instance_method" title="Addrinfo#protocol (method)">protocol</a></span>)
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_ipv6only!'>ipv6only!</span> <span class='kw'>if</span> <span class='kw'>self</span>.<span class='id identifier rubyid_ipv6?'><a href="#ipv6%3F-instance_method" title="Addrinfo#ipv6? (method)">ipv6?</a></span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_setsockopt'>setsockopt</span>(<span class='symbeg'>:</span><span class='const'>SOCKET</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>REUSEADDR</span><span class='comma'>,</span> <span class='int'>1</span>)
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_bind'>bind</span>(<span class='kw'>self</span>)
  <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_close'>close</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_sock'>sock</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_close'>close</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sock'>sock</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="canonname-instance_method">
  <h3 class='signature '>
    #<strong>canonname</strong>  &#x21d2; <code>String</code><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the canonical name as a string.</p>

<p>nil is returned if no canonical name.</p>

<p>The canonical name is set by <a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">.getaddrinfo</a> when AI_CANONNAME is specified.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_list'>list</span> <span class='op'>=</span> <span class='const'>Addrinfo</span>.<span class='id identifier rubyid_getaddrinfo'><a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">getaddrinfo</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>INET</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>STREAM</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'><a href="Socket.html#AI_CANONNAME-constant" title="Socket::AI_CANONNAME (constant)">AI_CANONNAME</a></span>)
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_list'>list</span>[<span class='int'>0</span>] <span class='comment'>#=&gt; #&lt;Addrinfo: 221.186.184.68:80 TCP carbon.ruby-lang.org (www.ruby-lang.org)&gt;
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_list'>list</span>[<span class='int'>0</span>].<span class='id identifier rubyid_canonname'>canonname</span> <span class='comment'>#=&gt; &quot;carbon.ruby-lang.org&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2260-L2265'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2260' data-end='2265'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2260</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_canonname(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return rai-&gt;canonname;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>connect</strong>([opts]) {|socket| ... } </span>
      <span class='overload'>#<strong>connect</strong>([opts])  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket connected to the address of self.</p>

<p>The optional argument <em>opts</em> is options represented by a hash. <em>opts</em> may have following options:</p>
<dl class="rdoc-list label-list"><dt>:timeout
<dd>
<p>specify the timeout in seconds.</p>
</dd></dl>

<p>If a block is given, it is called with the socket and the value of the block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_connect'>connect</span> {<span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_read'>read</span>
}</code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L140-L142'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='140' data-end='142'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 140</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect'>connect</span>(<span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_connect_internal'><a href="#connect_internal-instance_method" title="Addrinfo#connect_internal (method)">connect_internal</a></span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_from-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>connect_from</strong>([local_addr_args], [opts]) {|socket| ... } </span>
      <span class='overload'>#<strong>connect_from</strong>([local_addr_args], [opts])  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket connected to the address of self.</p>

<p>If one or more arguments given as <em>local_addr_args</em>, it is used as the local address of the socket. <em>local_addr_args</em> is given for family_addrinfo to obtain actual address.</p>

<p>If <em>local_addr_args</em> is not given, the local address of the socket is not bound.</p>

<p>The optional last argument <em>opts</em> is options represented by a hash. <em>opts</em> may have following options:</p>
<dl class="rdoc-list label-list"><dt>:timeout
<dd>
<p>specify the timeout in seconds.</p>
</dd></dl>

<p>If a block is given, it is called with the socket and the value of the block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_connect_from'>connect_from</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span>) {<span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_read'>read</span>
}

<span class='comment'># Addrinfo object can be taken for the argument.
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_connect_from'>connect_from</span>(<span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span>)) {<span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_read'>read</span>
}</code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L117-L119'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='117' data-end='119'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 117</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect_from'>connect_from</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_connect_internal'><a href="#connect_internal-instance_method" title="Addrinfo#connect_internal (method)">connect_internal</a></span>(<span class='id identifier rubyid_family_addrinfo'><a href="#family_addrinfo-instance_method" title="Addrinfo#family_addrinfo (method)">family_addrinfo</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)<span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_internal-instance_method">
  <h3 class='signature prot'>
    #<strong>connect_internal</strong>(local_addrinfo, timeout = nil)   <span class="extras">(<span class='prot'>protected</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a new <a href="Socket.html" title="Socket (class)"><code>::Socket</code></a> connected to the address of <code>local_addrinfo</code>.</p>

<p>If <em>local_addrinfo</em> is nil, the address of the socket is not bound.</p>

<p>The <em>timeout</em> specify the seconds for timeout. <code>Errno::ETIMEDOUT</code> is raised when timeout occur.</p>

<p>If a block is given the created socket is yielded for each address.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L54-L83'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='54' data-end='83'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 54</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect_internal'>connect_internal</span>(<span class='id identifier rubyid_local_addrinfo'>local_addrinfo</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='op'>=</span><span class='kw'>nil</span>) <span class='comment'># :yields: socket
</span>  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span>.<span class='id identifier rubyid_new'><a href="Socket.html#new-class_method" title="Socket.new (method)">new</a></span>(<span class='kw'>self</span>.<span class='id identifier rubyid_pfamily'><a href="#pfamily-instance_method" title="Addrinfo#pfamily (method)">pfamily</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_protocol'><a href="#protocol-instance_method" title="Addrinfo#protocol (method)">protocol</a></span>)
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_ipv6only!'>ipv6only!</span> <span class='kw'>if</span> <span class='kw'>self</span>.<span class='id identifier rubyid_ipv6?'><a href="#ipv6%3F-instance_method" title="Addrinfo#ipv6? (method)">ipv6?</a></span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Addrinfo#bind (method)">bind</a></span> <span class='id identifier rubyid_local_addrinfo'>local_addrinfo</span> <span class='kw'>if</span> <span class='id identifier rubyid_local_addrinfo'>local_addrinfo</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_timeout'>timeout</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_connect_nonblock'>connect_nonblock</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>false</span>)
      <span class='kw'>when</span> <span class='int'>0</span> <span class='comment'># success or EISCONN, other errors raise
</span>        <span class='kw'>break</span>
      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_wait_writable'>wait_writable</span>
        <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_wait_writable'>wait_writable</span>(<span class='id identifier rubyid_timeout'>timeout</span>) <span class='kw'>or</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ETIMEDOUT</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user specified timeout</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>end</span> <span class='kw'>while</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_connect'><a href="#connect-instance_method" title="Addrinfo#connect (method)">connect</a></span>(<span class='kw'>self</span>)
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_close'>close</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_sock'>sock</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_close'>close</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sock'>sock</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_to-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>connect_to</strong>([remote_addr_args], [opts]) {|socket| ... } </span>
      <span class='overload'>#<strong>connect_to</strong>([remote_addr_args], [opts])  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket connected to <em>remote_addr_args</em> and bound to self.</p>

<p>The optional last argument <em>opts</em> is options represented by a hash. <em>opts</em> may have following options:</p>
<dl class="rdoc-list label-list"><dt>:timeout
<dd>
<p>specify the timeout in seconds.</p>
</dd></dl>

<p>If a block is given, it is called with the socket and the value of the block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span>).<span class='id identifier rubyid_connect_to'>connect_to</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>) {<span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_read'>read</span>
}</code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L163-L166'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='163' data-end='166'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 163</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect_to'>connect_to</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_remote_addrinfo'>remote_addrinfo</span> <span class='op'>=</span> <span class='id identifier rubyid_family_addrinfo'><a href="#family_addrinfo-instance_method" title="Addrinfo#family_addrinfo (method)">family_addrinfo</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_remote_addrinfo'>remote_addrinfo</span>.<span class='id identifier rubyid_connect_internal'><a href="#connect_internal-instance_method" title="Addrinfo#connect_internal (method)">connect_internal</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="family_addrinfo-instance_method">
  <h3 class='signature '>
    #<strong>family_addrinfo</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates an <code>Addrinfo</code> object from the arguments.</p>

<p>The arguments are interpreted as similar to self.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span>).<span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>)
<span class='comment'>#=&gt; #&lt;Addrinfo: 221.186.184.68:80 TCP (www.ruby-lang.org:80)&gt;
</span>
<span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock2</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'>#=&gt; #&lt;Addrinfo: /tmp/sock2 SOCK_STREAM&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L21-L43'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='21' data-end='43'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 21</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no address specified</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='const'>Addrinfo</span> <span class='op'>===</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>too many arguments</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_addrinfo'>addrinfo</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_first'>first</span>
    <span class='kw'>if</span> (<span class='kw'>self</span>.<span class='id identifier rubyid_pfamily'><a href="#pfamily-instance_method" title="Addrinfo#pfamily (method)">pfamily</a></span> <span class='op'>!=</span> <span class='id identifier rubyid_addrinfo'>addrinfo</span>.<span class='id identifier rubyid_pfamily'><a href="#pfamily-instance_method" title="Addrinfo#pfamily (method)">pfamily</a></span>) <span class='op'>||</span>
       (<span class='kw'>self</span>.<span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span> <span class='op'>!=</span> <span class='id identifier rubyid_addrinfo'>addrinfo</span>.<span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span>)
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Addrinfo type mismatch</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_addrinfo'>addrinfo</span>
  <span class='kw'>elsif</span> <span class='kw'>self</span>.<span class='id identifier rubyid_ip?'><a href="#ip%3F-instance_method" title="Addrinfo#ip? (method)">ip?</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IP address needs host and port but </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> arguments given</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>2</span>
    <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
    <span class='const'>Addrinfo</span>.<span class='id identifier rubyid_getaddrinfo'><a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">getaddrinfo</a></span>(<span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_pfamily'><a href="#pfamily-instance_method" title="Addrinfo#pfamily (method)">pfamily</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_protocol'><a href="#protocol-instance_method" title="Addrinfo#protocol (method)">protocol</a></span>)[<span class='int'>0</span>]
  <span class='kw'>elsif</span> <span class='kw'>self</span>.<span class='id identifier rubyid_unix?'><a href="#unix%3F-instance_method" title="Addrinfo#unix? (method)">unix?</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UNIX socket needs single path argument but </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> arguments given</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
    <span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unexpected family</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="getnameinfo-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>getnameinfo</strong>  &#x21d2; <code>Array</code>, <code>service</code> </span>
      <span class='overload'>#<strong>getnameinfo</strong>(flags)  &#x21d2; <code>Array</code>, <code>service</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns nodename and service as a pair of strings. This converts struct sockaddr in addrinfo to textual representation.</p>

<p>flags should be bitwise OR of Socket::NI_??? constants.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_getnameinfo'>getnameinfo</span> <span class='comment'>#=&gt; [&quot;localhost&quot;, &quot;www&quot;]
</span>
<span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_getnameinfo'>getnameinfo</span>(<span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'><a href="Socket.html#NI_NUMERICSERV-constant" title="Socket::NI_NUMERICSERV (constant)">NI_NUMERICSERV</a></span>)
<span class='comment'>#=&gt; [&quot;localhost&quot;, &quot;80&quot;]</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2367-L2390'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2367' data-end='2390'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2367</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_getnameinfo(int argc, VALUE *argv, VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    VALUE vflags;
    char hbuf[1024], pbuf[1024];
    int flags, error;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;vflags);

    flags = NIL_P(vflags) ? 0 : NUM2INT(vflags);

    if (rai-&gt;socktype == SOCK_DGRAM)
        flags |= NI_DGRAM;

    error = rb_getnameinfo(&amp;rai-&gt;addr.addr, rai-&gt;sockaddr_len,
                           hbuf, (socklen_t)sizeof(hbuf), pbuf, (socklen_t)sizeof(pbuf),
                           flags);
    if (error) {
        rsock_raise_resolution_error(&quot;getnameinfo&quot;, error);
    }

    return rb_assoc_new(rb_str_new2(hbuf), rb_str_new2(pbuf));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature '>
    #<strong>inspect</strong>  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a string which shows addrinfo in human-readable form.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_inspect'>inspect</span> <span class='comment'>#=&gt; &quot;#&lt;Addrinfo: 127.0.0.1:80 TCP (localhost)&gt;&quot;
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_inspect'>inspect</span>    <span class='comment'>#=&gt; &quot;#&lt;Addrinfo: /tmp/sock SOCK_STREAM&gt;&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L1893-L1960'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1893' data-end='1960'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1893</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_inspect(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int internet_p;
    VALUE ret;

    ret = rb_sprintf(&quot;#&lt;%s: &quot;, rb_obj_classname(self));

    inspect_sockaddr(self, ret);

    if (rai-&gt;pfamily &amp;&amp; ai_get_afamily(rai) != rai-&gt;pfamily) {
        ID id = rsock_intern_protocol_family(rai-&gt;pfamily);
        if (id)
            rb_str_catf(ret, &quot; %s&quot;, rb_id2name(id));
        else
            rb_str_catf(ret, &quot; PF_\?\?\?(%d)&quot;, rai-&gt;pfamily);
    }

    internet_p = rai-&gt;pfamily == PF_INET;
#ifdef INET6
    internet_p = internet_p || rai-&gt;pfamily == PF_INET6;
#endif
    if (internet_p &amp;&amp; rai-&gt;socktype == SOCK_STREAM &amp;&amp;
        (rai-&gt;protocol == 0 || rai-&gt;protocol == IPPROTO_TCP)) {
        rb_str_cat2(ret, &quot; TCP&quot;);
    }
    else if (internet_p &amp;&amp; rai-&gt;socktype == SOCK_DGRAM &amp;&amp;
        (rai-&gt;protocol == 0 || rai-&gt;protocol == IPPROTO_UDP)) {
        rb_str_cat2(ret, &quot; UDP&quot;);
    }
    else {
        if (rai-&gt;socktype) {
            ID id = rsock_intern_socktype(rai-&gt;socktype);
            if (id)
                rb_str_catf(ret, &quot; %s&quot;, rb_id2name(id));
            else
                rb_str_catf(ret, &quot; SOCK_\?\?\?(%d)&quot;, rai-&gt;socktype);
        }

        if (rai-&gt;protocol) {
            if (internet_p) {
                ID id = rsock_intern_ipproto(rai-&gt;protocol);
                if (id)
                    rb_str_catf(ret, &quot; %s&quot;, rb_id2name(id));
                else
                    goto unknown_protocol;
            }
            else {
              unknown_protocol:
                rb_str_catf(ret, &quot; UNKNOWN_PROTOCOL(%d)&quot;, rai-&gt;protocol);
            }
        }
    }

    if (!NIL_P(rai-&gt;canonname)) {
        VALUE name = rai-&gt;canonname;
        rb_str_catf(ret, &quot; %s&quot;, StringValueCStr(name));
    }

    if (!NIL_P(rai-&gt;inspectname)) {
        VALUE name = rai-&gt;inspectname;
        rb_str_catf(ret, &quot; (%s)&quot;, StringValueCStr(name));
    }

    rb_str_buf_cat2(ret, &quot;&gt;&quot;);
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect_sockaddr-instance_method">
  <h3 class='signature '>
    #<strong>inspect_sockaddr</strong>  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a string which shows the sockaddr in <em>addrinfo</em> with human-readable form.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_inspect_sockaddr'>inspect_sockaddr</span>     <span class='comment'>#=&gt; &quot;127.0.0.1:80&quot;
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ip6-localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_inspect_sockaddr'>inspect_sockaddr</span> <span class='comment'>#=&gt; &quot;[::1]:80&quot;
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_inspect_sockaddr'>inspect_sockaddr</span>        <span class='comment'>#=&gt; &quot;/tmp/sock&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L1973-L1977'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1973' data-end='1977'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1973</span></pre>
<pre class='code cpp'>

VALUE
rsock_addrinfo_inspect_sockaddr(VALUE self)
{
    return inspect_sockaddr(self, rb_str_new(&quot;&quot;, 0));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip_address-instance_method">
  <h3 class='signature '>
    #<strong>ip_address</strong>  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the IP address as a string.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip_address'>ip_address</span>    <span class='comment'>#=&gt; &quot;127.0.0.1&quot;
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip_address'>ip_address</span>          <span class='comment'>#=&gt; &quot;::1&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2428-L2442'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2428' data-end='2442'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2428</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_address(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    VALUE vflags;
    VALUE ret;

    if (!IS_IP_FAMILY(family))
        rb_raise(rb_eSocket, &quot;need IPv4 or IPv6 address&quot;);

    vflags = INT2NUM(NI_NUMERICHOST|NI_NUMERICSERV);
    ret = addrinfo_getnameinfo(1, &amp;vflags, self);
    return rb_ary_entry(ret, 0);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip_port-instance_method">
  <h3 class='signature '>
    #<strong>ip_port</strong>  &#x21d2; <code>port</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the port number as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip_port'>ip_port</span>    <span class='comment'>#=&gt; 80
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip_port'>ip_port</span>          <span class='comment'>#=&gt; 80</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2453-L2489'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2453' data-end='2489'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2453</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_port(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    int port;

    if (!IS_IP_FAMILY(family)) {
      bad_family:
#ifdef AF_INET6
        rb_raise(rb_eSocket, &quot;need IPv4 or IPv6 address&quot;);
#else
        rb_raise(rb_eSocket, &quot;need IPv4 address&quot;);
#endif
    }

    switch (family) {
      case AF_INET:
        if (rai-&gt;sockaddr_len != sizeof(struct sockaddr_in))
            rb_raise(rb_eSocket, &quot;unexpected sockaddr size for IPv4&quot;);
        port = ntohs(rai-&gt;addr.in.sin_port);
        break;

#ifdef AF_INET6
      case AF_INET6:
        if (rai-&gt;sockaddr_len != sizeof(struct sockaddr_in6))
            rb_raise(rb_eSocket, &quot;unexpected sockaddr size for IPv6&quot;);
        port = ntohs(rai-&gt;addr.in6.sin6_port);
        break;
#endif

      default:
        goto bad_family;
    }

    return INT2NUM(port);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip_unpack-instance_method">
  <h3 class='signature '>
    #<strong>ip_unpack</strong>  &#x21d2; <code>Array</code>, <code>port</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the IP address and port number as 2-element array.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip_unpack'>ip_unpack</span>    <span class='comment'>#=&gt; [&quot;127.0.0.1&quot;, 80]
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_ip_unpack'>ip_unpack</span>          <span class='comment'>#=&gt; [&quot;::1&quot;, 80]</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2401-L2417'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2401' data-end='2417'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2401</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_unpack(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    VALUE vflags;
    VALUE ret, portstr;

    if (!IS_IP_FAMILY(family))
        rb_raise(rb_eSocket, &quot;need IPv4 or IPv6 address&quot;);

    vflags = INT2NUM(NI_NUMERICHOST|NI_NUMERICSERV);
    ret = addrinfo_getnameinfo(1, &amp;vflags, self);
    portstr = rb_ary_entry(ret, 1);
    rb_ary_store(ret, 1, INT2NUM(atoi(StringValueCStr(portstr))));
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_to_ipv4-instance_method">
  <h3 class='signature '>
    #<strong>ipv6_to_ipv4</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns IPv4 address of IPv4 mapped/compatible IPv6 address. It returns nil if <code>self</code> is not IPv4 mapped/compatible IPv6 address.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::192.0.2.3</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>      <span class='comment'>#=&gt; #&lt;Addrinfo: 192.0.2.3&gt;
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::ffff:192.0.2.3</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span> <span class='comment'>#=&gt; #&lt;Addrinfo: 192.0.2.3&gt;
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>              <span class='comment'>#=&gt; nil
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>192.0.2.3</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>        <span class='comment'>#=&gt; nil
</span><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>      <span class='comment'>#=&gt; nil</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2722-L2741'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2722' data-end='2741'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2722</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_to_ipv4(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    struct in6_addr *addr;
    int family = ai_get_afamily(rai);
    if (family != AF_INET6) return Qnil;
    addr = &amp;rai-&gt;addr.in6.sin6_addr;
    if (IN6_IS_ADDR_V4MAPPED(addr) || IN6_IS_ADDR_V4COMPAT(addr)) {
        struct sockaddr_in sin4;
        INIT_SOCKADDR_IN(&amp;sin4, sizeof(sin4));
        memcpy(&amp;sin4.sin_addr, (char*)addr + sizeof(*addr) - sizeof(sin4.sin_addr), sizeof(sin4.sin_addr));
        return rsock_addrinfo_new((struct sockaddr *)&amp;sin4, (socklen_t)sizeof(sin4),
                                  PF_INET, rai-&gt;socktype, rai-&gt;protocol,
                                  rai-&gt;canonname, rai-&gt;inspectname);
    }
    else {
        return Qnil;
    }
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="listen-instance_method">
  <h3 class='signature '>
    #<strong>listen</strong>(backlog = Socket::SOMAXCONN)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a listening socket bound to self.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/lib/socket.rb#L200-L220'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='200' data-end='220'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 200</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_listen'>listen</span>(<span class='id identifier rubyid_backlog'>backlog</span><span class='op'>=</span><span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'>SOMAXCONN</span>)
  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span>.<span class='id identifier rubyid_new'><a href="Socket.html#new-class_method" title="Socket.new (method)">new</a></span>(<span class='kw'>self</span>.<span class='id identifier rubyid_pfamily'><a href="#pfamily-instance_method" title="Addrinfo#pfamily (method)">pfamily</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_socktype'><a href="#socktype-instance_method" title="Addrinfo#socktype (method)">socktype</a></span><span class='comma'>,</span> <span class='kw'>self</span>.<span class='id identifier rubyid_protocol'><a href="#protocol-instance_method" title="Addrinfo#protocol (method)">protocol</a></span>)
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_ipv6only!'>ipv6only!</span> <span class='kw'>if</span> <span class='kw'>self</span>.<span class='id identifier rubyid_ipv6?'><a href="#ipv6%3F-instance_method" title="Addrinfo#ipv6? (method)">ipv6?</a></span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_setsockopt'>setsockopt</span>(<span class='symbeg'>:</span><span class='const'>SOCKET</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>REUSEADDR</span><span class='comma'>,</span> <span class='int'>1</span>) <span class='kw'>unless</span> <span class='kw'>self</span>.<span class='id identifier rubyid_pfamily'><a href="#pfamily-instance_method" title="Addrinfo#pfamily (method)">pfamily</a></span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'><a href="Socket.html#PF_UNIX-constant" title="Socket::PF_UNIX (constant)">PF_UNIX</a></span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Addrinfo#bind (method)">bind</a></span>(<span class='kw'>self</span>)
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_listen'>listen</span>(<span class='id identifier rubyid_backlog'>backlog</span>)
  <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_close'>close</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_sock'>sock</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_close'>close</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sock'>sock</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="marshal_dump-instance_method">
  <h3 class='signature nodoc'>
    #<strong>marshal_dump</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L1980-L2048'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1980' data-end='2048'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1980</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_mdump(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    VALUE sockaddr, afamily, pfamily, socktype, protocol, canonname, inspectname;
    int afamily_int = ai_get_afamily(rai);
    ID id;

    id = rsock_intern_protocol_family(rai-&gt;pfamily);
    if (id == 0)
        rb_raise(rb_eSocket, &quot;unknown protocol family: %d&quot;, rai-&gt;pfamily);
    pfamily = rb_id2str(id);

    if (rai-&gt;socktype == 0)
        socktype = INT2FIX(0);
    else {
        id = rsock_intern_socktype(rai-&gt;socktype);
        if (id == 0)
            rb_raise(rb_eSocket, &quot;unknown socktype: %d&quot;, rai-&gt;socktype);
        socktype = rb_id2str(id);
    }

    if (rai-&gt;protocol == 0)
        protocol = INT2FIX(0);
    else if (IS_IP_FAMILY(afamily_int)) {
        id = rsock_intern_ipproto(rai-&gt;protocol);
        if (id == 0)
            rb_raise(rb_eSocket, &quot;unknown IP protocol: %d&quot;, rai-&gt;protocol);
        protocol = rb_id2str(id);
    }
    else {
        rb_raise(rb_eSocket, &quot;unknown protocol: %d&quot;, rai-&gt;protocol);
    }

    canonname = rai-&gt;canonname;

    inspectname = rai-&gt;inspectname;

    id = rsock_intern_family(afamily_int);
    if (id == 0)
        rb_raise(rb_eSocket, &quot;unknown address family: %d&quot;, afamily_int);
    afamily = rb_id2str(id);

    switch(afamily_int) {
#ifdef HAVE_TYPE_STRUCT_SOCKADDR_UN
      case AF_UNIX:
      {
        sockaddr = rb_str_new(rai-&gt;addr.un.sun_path, rai_unixsocket_len(rai));
        break;
      }
#endif

      default:
      {
        char hbuf[NI_MAXHOST], pbuf[NI_MAXSERV];
        int error;
        error = rb_getnameinfo(&amp;rai-&gt;addr.addr, rai-&gt;sockaddr_len,
                               hbuf, (socklen_t)sizeof(hbuf), pbuf, (socklen_t)sizeof(pbuf),
                               NI_NUMERICHOST|NI_NUMERICSERV);
        if (error) {
            rsock_raise_resolution_error(&quot;getnameinfo&quot;, error);
        }
        sockaddr = rb_assoc_new(rb_str_new_cstr(hbuf), rb_str_new_cstr(pbuf));
        break;
      }
    }

    return rb_ary_new3(7, afamily, sockaddr, pfamily, socktype, protocol, canonname, inspectname);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="marshal_load-instance_method">
  <h3 class='signature nodoc'>
    #<strong>marshal_load</strong>(ary)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2051-L2159'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2051' data-end='2159'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2051</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_mload(VALUE self, VALUE ary)
{
    VALUE v;
    VALUE canonname, inspectname;
    int afamily, pfamily, socktype, protocol;
    union_sockaddr ss;
    socklen_t len;
    rb_addrinfo_t *rai;

    if (check_addrinfo(self))
        rb_raise(rb_eTypeError, &quot;already initialized socket address&quot;);

    ary = rb_convert_type(ary, T_ARRAY, &quot;Array&quot;, &quot;to_ary&quot;);

    v = rb_ary_entry(ary, 0);
    StringValue(v);
    if (rsock_family_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;afamily) == -1)
        rb_raise(rb_eTypeError, &quot;unexpected address family&quot;);

    v = rb_ary_entry(ary, 2);
    StringValue(v);
    if (rsock_family_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;pfamily) == -1)
        rb_raise(rb_eTypeError, &quot;unexpected protocol family&quot;);

    v = rb_ary_entry(ary, 3);
    if (v == INT2FIX(0))
        socktype = 0;
    else {
        StringValue(v);
        if (rsock_socktype_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;socktype) == -1)
            rb_raise(rb_eTypeError, &quot;unexpected socktype&quot;);
    }

    v = rb_ary_entry(ary, 4);
    if (v == INT2FIX(0))
        protocol = 0;
    else {
        StringValue(v);
        if (IS_IP_FAMILY(afamily)) {
            if (rsock_ipproto_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;protocol) == -1)
                rb_raise(rb_eTypeError, &quot;unexpected protocol&quot;);
        }
        else {
            rb_raise(rb_eTypeError, &quot;unexpected protocol&quot;);
        }
    }

    v = rb_ary_entry(ary, 5);
    if (NIL_P(v))
        canonname = Qnil;
    else {
        StringValue(v);
        canonname = v;
    }

    v = rb_ary_entry(ary, 6);
    if (NIL_P(v))
        inspectname = Qnil;
    else {
        StringValue(v);
        inspectname = v;
    }

    v = rb_ary_entry(ary, 1);
    switch(afamily) {
#ifdef HAVE_TYPE_STRUCT_SOCKADDR_UN
      case AF_UNIX:
      {
        struct sockaddr_un uaddr;
        INIT_SOCKADDR_UN(&amp;uaddr, sizeof(struct sockaddr_un));

        StringValue(v);
        if (sizeof(uaddr.sun_path) &lt; (size_t)RSTRING_LEN(v))
            rb_raise(rb_eSocket,
                &quot;too long AF_UNIX path (%&quot;PRIuSIZE&quot; bytes given but %&quot;PRIuSIZE&quot; bytes max)&quot;,
                (size_t)RSTRING_LEN(v), sizeof(uaddr.sun_path));
        memcpy(uaddr.sun_path, RSTRING_PTR(v), RSTRING_LEN(v));
        len = (socklen_t)sizeof(uaddr);
        memcpy(&amp;ss, &amp;uaddr, len);
        break;
      }
#endif

      default:
      {
        VALUE pair = rb_convert_type(v, T_ARRAY, &quot;Array&quot;, &quot;to_ary&quot;);
        struct rb_addrinfo *res;
        int flags = AI_NUMERICHOST;
#ifdef AI_NUMERICSERV
        flags |= AI_NUMERICSERV;
#endif
        res = call_getaddrinfo(rb_ary_entry(pair, 0), rb_ary_entry(pair, 1),
                               INT2NUM(pfamily), INT2NUM(socktype), INT2NUM(protocol),
                               INT2NUM(flags), 1, Qnil);

        len = res-&gt;ai-&gt;ai_addrlen;
        memcpy(&amp;ss, res-&gt;ai-&gt;ai_addr, res-&gt;ai-&gt;ai_addrlen);
        rb_freeaddrinfo(res);
        break;
      }
    }

    DATA_PTR(self) = rai = alloc_addrinfo();
    init_addrinfo(rai, &amp;ss.addr, len,
                  pfamily, socktype, protocol,
                  canonname, inspectname);
    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pfamily-instance_method">
  <h3 class='signature '>
    #<strong>pfamily</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the protocol family as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_pfamily'>pfamily</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'><a href="Socket.html#PF_INET-constant" title="Socket::PF_INET (constant)">PF_INET</a></span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2186-L2191'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2186' data-end='2191'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2186</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_pfamily(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(rai-&gt;pfamily);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="protocol-instance_method">
  <h3 class='signature '>
    #<strong>protocol</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the socket type as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_protocol'>protocol</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'><a href="Socket.html#IPPROTO_TCP-constant" title="Socket::IPPROTO_TCP (constant)">IPPROTO_TCP</a></span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2218-L2223'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2218' data-end='2223'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2218</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_protocol(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(rai-&gt;protocol);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="socktype-instance_method">
  <h3 class='signature '>
    #<strong>socktype</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the socket type as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_socktype'>socktype</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'><a href="Socket.html#SOCK_STREAM-constant" title="Socket::SOCK_STREAM (constant)">SOCK_STREAM</a></span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2202-L2207'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2202' data-end='2207'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2202</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_socktype(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(rai-&gt;socktype);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_s-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>to_sockaddr</strong>  &#x21d2; <code>String</code> </span>
      <span class='overload'>#<strong>to_s</strong>  &#x21d2; <code>String</code> </span>
    </div>
    <span class='aliases'>Also known as: <span class='names'>#to_sockaddr</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the socket address as packed struct sockaddr string.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>).<span class='id identifier rubyid_to_sockaddr'><a href="#to_sockaddr-instance_method" title="Addrinfo#to_sockaddr (method)">to_sockaddr</a></span>
<span class='comment'>#=&gt; &quot;\x02\x00\x00P\x7F\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00&quot;</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2236-L2243'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2236' data-end='2243'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2236</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_to_sockaddr(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    VALUE ret;
    ret = rb_str_new((char*)&amp;rai-&gt;addr, rai-&gt;sockaddr_len);
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_sockaddr-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>to_sockaddr</strong>  &#x21d2; <code>String</code> </span>
      <span class='overload'>#<strong>to_s</strong>  &#x21d2; <code>String</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#to_s-instance_method" title="Addrinfo#to_s (method)">#to_s</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>

</section>

<section class='method_details' id="unix_path-instance_method">
  <h3 class='signature '>
    #<strong>unix_path</strong>  &#x21d2; <code>path</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the socket path as a string.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span>.<span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_unix_path'>unix_path</span>       <span class='comment'>#=&gt; &quot;/tmp/sock&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/master/ext/socket/raddrinfo.c#L2754-L2776'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2754' data-end='2776'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2754</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_unix_path(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    struct sockaddr_un *addr;
    long n;

    if (family != AF_UNIX)
        rb_raise(rb_eSocket, &quot;need AF_UNIX address&quot;);

    addr = &amp;rai-&gt;addr.un;

    n = rai_unixsocket_len(rai);
    if (n &lt; 0)
        rb_raise(rb_eSocket, &quot;too short AF_UNIX address: %&quot;PRIuSIZE&quot; bytes given for minimum %&quot;PRIuSIZE&quot; bytes.&quot;,
                 (size_t)rai-&gt;sockaddr_len, offsetof(struct sockaddr_un, sun_path));
    if ((long)sizeof(addr-&gt;sun_path) &lt; n)
        rb_raise(rb_eSocket,
            &quot;too long AF_UNIX path (%&quot;PRIuSIZE&quot; bytes given but %&quot;PRIuSIZE&quot; bytes max)&quot;,
            (size_t)n, sizeof(addr-&gt;sun_path));
    return rb_str_new(addr-&gt;sun_path, n);
}
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>