<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Net::IMAP::SASL::ScramAuthenticator &mdash; net-imap  Ruby-master dev</title>

<link rel='stylesheet'  type='text/css' href='../../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Net::IMAP::SASL::ScramAuthenticator",
    relpath = '../../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../../'>Ruby-master</a> &raquo; 
      <a href='../../../'>net-imap</a> &raquo; 
      <a href='../../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../../Net.html" title="Net (module)">Net</a> &raquo; 
        <a href="../../IMAP.html" title="Net::IMAP (class)">IMAP</a> &raquo; 
        <a href="../SASL.html" title="Net::IMAP::SASL (module)">SASL</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>ScramAuthenticator&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Net::IMAP::SASL::ScramAuthenticator</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Subclasses:</div>
        <div class='box_22'>
          <a href="ScramSHA1Authenticator.html" title="Net::IMAP::SASL::ScramSHA1Authenticator (class)">ScramSHA1Authenticator</a>, <a href="ScramSHA256Authenticator.html" title="Net::IMAP::SASL::ScramSHA256Authenticator (class)">ScramSHA256Authenticator</a>
        </div>
      </td>
    </tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="ScramAlgorithm.html" title="Net::IMAP::SASL::ScramAlgorithm (module)"><code>ScramAlgorithm</code></a>,
          <a href="GS2Header.html" title="Net::IMAP::SASL::GS2Header (module)"><code>GS2Header</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L56'>lib/net/imap/sasl/scram_authenticator.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Abstract base class for the “<code>SCRAM-*</code>” family of <a href="../SASL.html" title="Net::IMAP::SASL (module)"><code>::Net::IMAP::SASL</code></a> mechanisms, defined in <a href="https://tools.ietf.org/html/rfc5802">RFC5802</a>.  Use via <a href="../../IMAP.html#authenticate-instance_method" title="Net::IMAP#authenticate (method)">Net::IMAP#authenticate</a>.</p>

<p>Directly supported:</p>
<ul><li>
<p><code>SCRAM-SHA-1</code>   — <a href="ScramSHA1Authenticator.html" title="Net::IMAP::SASL::ScramSHA1Authenticator (class)"><code>ScramSHA1Authenticator</code></a></p>
</li><li>
<p><code>SCRAM-SHA-256</code> — <a href="ScramSHA256Authenticator.html" title="Net::IMAP::SASL::ScramSHA256Authenticator (class)"><code>ScramSHA256Authenticator</code></a></p>
</li></ul>

<p>New <code>SCRAM-*</code> mechanisms can easily be added for any hash algorithm supported by <a href="https://ruby.github.io/openssl/OpenSSL/Digest.html">OpenSSL::Digest</a>. Subclasses need only set an appropriate <code>DIGEST_NAME</code> constant.</p>

<h3 id="label-SCRAM+algorithm">SCRAM algorithm</h3>

<p>See the documentation and method definitions on <a href="ScramAlgorithm.html" title="Net::IMAP::SASL::ScramAlgorithm (module)"><code>ScramAlgorithm</code></a> for an overview of the algorithm.  The different mechanisms differ only by which hash function that is used (or by support for channel binding with <code>-PLUS</code>).</p>

<p>See also the methods on <a href="GS2Header.html" title="Net::IMAP::SASL::GS2Header (module)"><code>GS2Header</code></a>.</p>

<h4 id="label-Server+messages">Server messages</h4>

<p>As server messages are received, they are validated and loaded into the various attributes, e.g: <a href="#snonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#snonce (method)">#snonce</a>, <a href="#salt-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#salt (method)">#salt</a>, <a href="#iterations-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#iterations (method)">#iterations</a>, <code>#verifier</code>, <a href="#server_error-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#server_error (method)">#server_error</a>, etc.</p>

<p>Unlike many other <a href="../SASL.html" title="Net::IMAP::SASL (module)"><code>::Net::IMAP::SASL</code></a> mechanisms, the <code>SCRAM-*</code> family supports mutual authentication and can return server error data in the server messages. If <a href="#process-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#process (method)">#process</a> raises an <a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a> for the server-final-message, then server_error may contain error details.</p>

<h3 id="label-TLS+Channel+binding">TLS Channel binding</h3>

<p><em>The <code>SCRAM-*-PLUS</code> mechanisms and channel binding are not supported yet.</em></p>

<h3 id="label-Caching+SCRAM+secrets">Caching SCRAM secrets</h3>

<p><em>Caching of salted_password, client_key, stored_key, and server_key is not supported yet.</em></p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
  <h3 class='inherited'><a href="GS2Header.html" title="Net::IMAP::SASL::GS2Header (module)"><code>GS2Header</code></a> - Included</h3>
  <p  class='inherited'>
    <a class='nodoc' href="GS2Header.html#NO_NULL_CHARS-constant" title="Net::IMAP::SASL::GS2Header::NO_NULL_CHARS (constant)">NO_NULL_CHARS</a>, 
    <a href="GS2Header.html#RFC5801_SASLNAME-constant" title="Net::IMAP::SASL::GS2Header::RFC5801_SASLNAME (constant)">RFC5801_SASLNAME</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(username, password, **options)  &#x21d2; auth_ctx </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates an authenticator for one of the “<code>SCRAM-*</code>” <a href="../SASL.html" title="Net::IMAP::SASL (module)"><code>::Net::IMAP::SASL</code></a> mechanisms.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#authcid-instance_method" title="#authcid (instance method)">#<strong>authcid</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">#username</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#authzid-instance_method" title="#authzid (instance method)">#<strong>authzid</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Authorization identity: an identity to act as or on behalf of.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#cnonce-instance_method" title="#cnonce (instance method)">#<strong>cnonce</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>The client nonce, generated by SecureRandom.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#done%3F-instance_method" title="#done? (instance method)">#<strong>done?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Is the authentication exchange complete?</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#iterations-instance_method" title="#iterations (instance method)">#<strong>iterations</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>The iteration count for the selected hash function and user.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#min_iterations-instance_method" title="#min_iterations (instance method)">#<strong>min_iterations</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>The minimal allowed iteration count.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#password-instance_method" title="#password (instance method)">#<strong>password</strong>  </a>
      (also: #secret)
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>A password or passphrase that matches the <a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">#username</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#salt-instance_method" title="#salt (instance method)">#<strong>salt</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>The salt used by the server for this user.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#secret-instance_method" title="#secret (instance method)">#<strong>secret</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">#password</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#server_error-instance_method" title="#server_error (instance method)">#<strong>server_error</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>An error reported by the server during the SASL exchange.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#snonce-instance_method" title="#snonce (instance method)">#<strong>snonce</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>The server nonce, which must start with <a href="#cnonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#cnonce (method)">#cnonce</a></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#username-instance_method" title="#username (instance method)">#<strong>username</strong>  </a>
      (also: #authcid)
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Authentication identity: the identity that matches the <a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">#password</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro priv'>
      <a href="#server_first_message-instance_method" title="#server_first_message (instance method)">#<strong>server_first_message</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Need to store this for auth_message.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#digest-instance_method" title="#digest (instance method)">#<strong>digest</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a new <code>OpenSSL::Digest</code> object, set to the appropriate hash function for the chosen mechanism.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#initial_client_response-instance_method" title="#initial_client_response (instance method)">#<strong>initial_client_response</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-first-message</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process-instance_method" title="#process (instance method)">#<strong>process</strong>(challenge)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>responds to the server’s challenges.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#cbind_input-instance_method" title="#cbind_input (instance method)">#<strong>cbind_input</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="GS2Header.html#gs2_header-instance_method" title="Net::IMAP::SASL::GS2Header#gs2_header (method)">GS2Header#gs2_header</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#client_final_message_without_proof-instance_method" title="#client_final_message_without_proof (instance method)">#<strong>client_final_message_without_proof</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-final-message-without-proof</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#client_first_message_bare-instance_method" title="#client_first_message_bare (instance method)">#<strong>client_first_message_bare</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-first-message-bare</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#final_message_with_proof-instance_method" title="#final_message_with_proof (instance method)">#<strong>final_message_with_proof</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-final-message</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#format_message-instance_method" title="#format_message (instance method)">#<strong>format_message</strong>(hash)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_challenge-instance_method" title="#parse_challenge (instance method)">#<strong>parse_challenge</strong>(challenge)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>RFC5802 specifies “that the order of attributes in client or server messages is fixed, with the exception of extension attributes”, but this parses it simply as a hash, without respect to order.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#recv_server_final_message-instance_method" title="#recv_server_final_message (instance method)">#<strong>recv_server_final_message</strong>(server_final_message)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#recv_server_first_message-instance_method" title="#recv_server_first_message (instance method)">#<strong>recv_server_first_message</strong>(server_first_message)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>

<h3 class='inherited'><a href="ScramAlgorithm.html" title="Net::IMAP::SASL::ScramAlgorithm (module)"><code>ScramAlgorithm</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="ScramAlgorithm.html#auth_message-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#auth_message (method)">#auth_message</a>,
        <a class='i_m ' href="ScramAlgorithm.html#client_key-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#client_key (method)">#client_key</a>,
        <a class='i_m ' href="ScramAlgorithm.html#client_proof-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#client_proof (method)">#client_proof</a>,
        <a class='i_m ' href="ScramAlgorithm.html#client_signature-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#client_signature (method)">#client_signature</a>,
        <a class='i_m ' href="ScramAlgorithm.html#H-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#H (method)">#H</a>,
        <a class='i_m ' href="ScramAlgorithm.html#Hi-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#Hi (method)">#Hi</a>,
        <a class='i_m ' href="ScramAlgorithm.html#HMAC-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#HMAC (method)">#HMAC</a>,
        <a class='i_m ' href="ScramAlgorithm.html#Normalize-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#Normalize (method)">#Normalize</a>,
        <a class='i_m ' href="ScramAlgorithm.html#salted_password-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#salted_password (method)">#salted_password</a>,
        <a class='i_m ' href="ScramAlgorithm.html#server_key-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#server_key (method)">#server_key</a>,
        <a class='i_m ' href="ScramAlgorithm.html#server_signature-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#server_signature (method)">#server_signature</a>,
        <a class='i_m ' href="ScramAlgorithm.html#stored_key-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#stored_key (method)">#stored_key</a>,
        <a class='i_m ' href="ScramAlgorithm.html#XOR-instance_method" title="Net::IMAP::SASL::ScramAlgorithm#XOR (method)">#XOR</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="GS2Header.html" title="Net::IMAP::SASL::GS2Header (module)"><code>GS2Header</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="GS2Header.html#gs2_authzid-instance_method" title="Net::IMAP::SASL::GS2Header#gs2_authzid (method)">#gs2_authzid</a></td>
      <td><div class='inline'><p>The <a href="https://www.rfc-editor.org/rfc/rfc5801#section-4" target="_parent" title="RFC5801 §4">RFC5801 §4</a> <code>gs2-authzid</code> header, when <a href="#authzid-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#authzid (method)">#authzid</a> is not empty.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="GS2Header.html#gs2_cb_flag-instance_method" title="Net::IMAP::SASL::GS2Header#gs2_cb_flag (method)">#gs2_cb_flag</a></td>
      <td><div class='inline'><p>The <a href="https://www.rfc-editor.org/rfc/rfc5801#section-4" target="_parent" title="RFC5801 §4">RFC5801 §4</a> <code>gs2-cb-flag</code>:</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="GS2Header.html#gs2_header-instance_method" title="Net::IMAP::SASL::GS2Header#gs2_header (method)">#gs2_header</a></td>
      <td><div class='inline'><p>The <a href="https://www.rfc-editor.org/rfc/rfc5801#section-4" target="_parent" title="RFC5801 §4">RFC5801 §4</a> <code>gs2-header</code>, which prefixes the <a href="#initial_client_response-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#initial_client_response (method)">#initial_client_response</a>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="GS2Header.html#gs2_saslname_encode-instance_method" title="Net::IMAP::SASL::GS2Header#gs2_saslname_encode (method)">#gs2_saslname_encode</a></td>
      <td><div class='inline'><p>Encodes <code>str</code> to match RFC5801_SASLNAME.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    <div class='inline-block'>
      <span class='overload'>.<strong>new</strong>(username, password, **options)  &#x21d2; <code>auth_ctx</code> </span>
      <span class='overload'>.<strong>new</strong>(username:, password:, **options)  &#x21d2; <code>auth_ctx</code> </span>
      <span class='overload'>.<strong>new</strong>(authcid:, password:, **options)  &#x21d2; <code>auth_ctx</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates an authenticator for one of the “<code>SCRAM-*</code>” <a href="../SASL.html" title="Net::IMAP::SASL (module)"><code>::Net::IMAP::SASL</code></a> mechanisms. Each subclass defines <a href="#digest-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#digest (method)">#digest</a> to match a specific mechanism.</p>

<p>Called by <a href="../../IMAP.html#authenticate-instance_method" title="Net::IMAP#authenticate (method)">Net::IMAP#authenticate</a> and similar methods on other clients.</p>

<h4 id="label-Parameters">Parameters</h4>
<ul><li>
<p><a href="#authcid-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#authcid (method)">#authcid</a>  ― Identity whose <a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">#password</a> is used.</p>

<p>#username - An alias for #authcid.</p>
</li><li>
<p><a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">#password</a> ― Password or passphrase associated with this <a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">#username</a>.</p>
</li><li>
<p><em>optional</em> <a href="#authzid-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#authzid (method)">#authzid</a> ― Alternate identity to act as or on behalf of.</p>
</li><li>
<p><em>optional</em> <a href="#min_iterations-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#min_iterations (method)">#min_iterations</a> - Overrides the default value (4096).</p>
</li></ul>

<p>Any other keyword parameters are quietly ignored.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L80-L98'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='80' data-end='98'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 80</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'><a href="../DeprecatedClientOptions.html#initialize-instance_method" title="Net::IMAP::DeprecatedClientOptions#initialize (method)">initialize</a></span>(<span class='id identifier rubyid_username_arg'>username_arg</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_password_arg'>password_arg</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span>
               <span class='label'>authcid:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>username:</span> <span class='kw'>nil</span><span class='comma'>,</span>
               <span class='label'>authzid:</span> <span class='kw'>nil</span><span class='comma'>,</span>
               <span class='label'>password:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>secret:</span> <span class='kw'>nil</span><span class='comma'>,</span>
               <span class='label'>min_iterations:</span> <span class='int'>4096</span><span class='comma'>,</span> <span class='comment'># see both RFC5802 and RFC7677
</span>               <span class='label'>cnonce:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='comment'># must only be set in tests
</span>               <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='ivar'>@username</span> <span class='op'>=</span> <span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">username</a></span> <span class='op'>||</span> <span class='id identifier rubyid_username_arg'>username_arg</span> <span class='op'>||</span> <span class='id identifier rubyid_authcid'><a href="#authcid-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#authcid (method)">authcid</a></span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>missing username (authcid)</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@password</span> <span class='op'>=</span> <span class='id identifier rubyid_password'><a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">password</a></span> <span class='op'>||</span> <span class='id identifier rubyid_secret'><a href="#secret-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#secret (method)">secret</a></span> <span class='op'>||</span> <span class='id identifier rubyid_password_arg'>password_arg</span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>missing password</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@authzid</span> <span class='op'>=</span> <span class='id identifier rubyid_authzid'><a href="#authzid-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#authzid (method)">authzid</a></span>

  <span class='ivar'>@min_iterations</span> <span class='op'>=</span> <span class='const'>Integer</span> <span class='id identifier rubyid_min_iterations'><a href="#min_iterations-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#min_iterations (method)">min_iterations</a></span>
  <span class='ivar'>@min_iterations</span>.<span class='id identifier rubyid_positive?'>positive?</span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>min_iterations must be positive</span><span class='tstring_end'>&quot;</span></span>

  <span class='ivar'>@cnonce</span> <span class='op'>=</span> <span class='id identifier rubyid_cnonce'><a href="#cnonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#cnonce (method)">cnonce</a></span> <span class='op'>||</span> <span class='const'>SecureRandom</span>.<span class='id identifier rubyid_base64'>base64</span>(<span class='int'>32</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="authcid-instance_method">
  <h3 class='signature ro first'>
    #<strong>authcid</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">#username</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L108-L108'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='108' data-end='108'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 108</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_authcid'>authcid</span> <span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">username</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="authzid-instance_method">
  <h3 class='signature ro'>
    #<strong>authzid</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Authorization identity: an identity to act as or on behalf of.  The identity form is application protocol specific.  If not provided or left blank, the server derives an authorization identity from the authentication identity.  For example, an administrator or superuser might take on another role:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_imap'>imap</span>.<span class='id identifier rubyid_authenticate'><a href="../../IMAP.html#authenticate-instance_method" title="Net::IMAP#authenticate (method)">authenticate</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SCRAM-SHA-256</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>root</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_passwd'>passwd</span><span class='comma'>,</span> <span class='label'>authzid:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user</span><span class='tstring_end'>&quot;</span></span></code></pre>

<p>The server is responsible for verifying the client’s credentials and verifying that the identity it associates with the client’s authentication identity is allowed to act as (or on behalf of) the authorization identity.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L126-L126'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='126' data-end='126'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 126</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_authzid'>authzid</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cnonce-instance_method">
  <h3 class='signature ro'>
    #<strong>cnonce</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The client nonce, generated by SecureRandom</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L133-L133'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='133' data-end='133'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 133</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_cnonce'>cnonce</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="done?-instance_method">
  <h3 class='signature ro'>
    #<strong>done?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is the authentication exchange complete?</p>

<p>If false, another server continuation is required.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L185-L185'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='185' data-end='185'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 185</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_done?'>done?</span><span class='semicolon'>;</span> <span class='ivar'>@state</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_done'>done</span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="iterations-instance_method">
  <h3 class='signature ro'>
    #<strong>iterations</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The iteration count for the selected hash function and user</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L142-L142'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='142' data-end='142'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 142</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_iterations'>iterations</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="min_iterations-instance_method">
  <h3 class='signature ro'>
    #<strong>min_iterations</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The minimal allowed iteration count.  Lower <a href="#iterations-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#iterations (method)">#iterations</a> will raise an <a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L130-L130'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='130' data-end='130'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 130</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_min_iterations'>min_iterations</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="password-instance_method">
  <h3 class='signature ro'>
    #<strong>password</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>#secret</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A password or passphrase that matches the <a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">#username</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L111-L111'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='111' data-end='111'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 111</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_password'>password</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="salt-instance_method">
  <h3 class='signature ro'>
    #<strong>salt</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The salt used by the server for this user</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L139-L139'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='139' data-end='139'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 139</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_salt'>salt</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="secret-instance_method">
  <h3 class='signature ro'>
    #<strong>secret</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">#password</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L112-L112'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='112' data-end='112'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 112</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_secret'>secret</span> <span class='id identifier rubyid_password'><a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">password</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_error-instance_method">
  <h3 class='signature ro'>
    #<strong>server_error</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>An error reported by the server during the SASL exchange.</p>

<p>Does not include errors reported by the protocol, e.g. <a href="../NoResponseError.html" title="Net::IMAP::NoResponseError (class)"><code>::Net::IMAP::NoResponseError</code></a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L148-L148'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='148' data-end='148'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 148</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server_error'>server_error</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_first_message-instance_method">
  <h3 class='signature ro priv'>
    #<strong>server_first_message</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Need to store this for auth_message</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L190-L190'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='190' data-end='190'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 190</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server_first_message'>server_first_message</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="snonce-instance_method">
  <h3 class='signature ro'>
    #<strong>snonce</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The server nonce, which must start with <a href="#cnonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#cnonce (method)">#cnonce</a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L136-L136'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='136' data-end='136'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 136</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_snonce'>snonce</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="username-instance_method">
  <h3 class='signature ro'>
    #<strong>username</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>#authcid</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Authentication identity: the identity that matches the <a href="#password-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#password (method)">#password</a>.</p>

<p><a href="https://tools.ietf.org/html/rfc2831">RFC-2831</a> uses the term <code>username</code>. “Authentication identity” is the generic term used by <a href="https://tools.ietf.org/html/rfc4422">RFC-4422</a>. <a href="https://tools.ietf.org/html/rfc4616">RFC-4616</a> and many later RFCs abbreviate this to <a href="#authcid-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#authcid (method)">#authcid</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L107-L107'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='107' data-end='107'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 107</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_username'>username</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="cbind_input-instance_method">
  <h3 class='signature priv first'>
    #<strong>cbind_input</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="GS2Header.html#gs2_header-instance_method" title="Net::IMAP::SASL::GS2Header#gs2_header (method)">GS2Header#gs2_header</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L251-L251'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='251' data-end='251'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 251</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_cbind_input'>cbind_input</span> <span class='id identifier rubyid_gs2_header'>gs2_header</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_final_message_without_proof-instance_method">
  <h3 class='signature priv'>
    #<strong>client_final_message_without_proof</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-final-message-without-proof</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L240-L244'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='240' data-end='244'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 240</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_final_message_without_proof'>client_final_message_without_proof</span>
  <span class='ivar'>@client_final_message_without_proof</span> <span class='op'>||=</span>
    <span class='id identifier rubyid_format_message'><a href="#format_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#format_message (method)">format_message</a></span>(<span class='label'>c:</span> [<span class='id identifier rubyid_cbind_input'><a href="#cbind_input-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#cbind_input (method)">cbind_input</a></span>].<span class='id identifier rubyid_pack'>pack</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m0</span><span class='tstring_end'>&quot;</span></span>)<span class='comma'>,</span> <span class='comment'># channel-binding
</span>                   <span class='label'>r:</span> <span class='id identifier rubyid_snonce'><a href="#snonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#snonce (method)">snonce</a></span>)                   <span class='comment'># nonce
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_first_message_bare-instance_method">
  <h3 class='signature priv'>
    #<strong>client_first_message_bare</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-first-message-bare</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L225-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='225' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 225</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_first_message_bare'>client_first_message_bare</span>
  <span class='ivar'>@client_first_message_bare</span> <span class='op'>||=</span>
    <span class='id identifier rubyid_format_message'><a href="#format_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#format_message (method)">format_message</a></span>(<span class='label'>n:</span> <span class='id identifier rubyid_gs2_saslname_encode'>gs2_saslname_encode</span>(<span class='const'><a href="../SASL.html" title="Net::IMAP::SASL (module)">SASL</a></span>.<span class='id identifier rubyid_saslprep'><a href="../SASL.html#saslprep-class_method" title="Net::IMAP::SASL.saslprep (method)">saslprep</a></span>(<span class='id identifier rubyid_username'><a href="#username-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#username (method)">username</a></span>))<span class='comma'>,</span>
                   <span class='label'>r:</span> <span class='id identifier rubyid_cnonce'><a href="#cnonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#cnonce (method)">cnonce</a></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="digest-instance_method">
  <h3 class='signature '>
    #<strong>digest</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a new <code>OpenSSL::Digest</code> object, set to the appropriate hash function for the chosen mechanism.</p>

<p><em>The class’s <code>DIGEST_NAME</code> constant must be set to the name of an algorithm supported by <code>OpenSSL::Digest</code>.</em></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L155-L155'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='155' data-end='155'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 155</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_digest'>digest</span><span class='semicolon'>;</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Net::IMAP::SASL::ScramAuthenticator.new (method)">new</a></span> <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>DIGEST_NAME</span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="final_message_with_proof-instance_method">
  <h3 class='signature priv'>
    #<strong>final_message_with_proof</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-final-message</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L233-L236'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='233' data-end='236'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 233</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_final_message_with_proof'>final_message_with_proof</span>
  <span class='id identifier rubyid_proof'>proof</span> <span class='op'>=</span> [<span class='id identifier rubyid_client_proof'>client_proof</span>].<span class='id identifier rubyid_pack'>pack</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m0</span><span class='tstring_end'>&quot;</span></span>)
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_client_final_message_without_proof'><a href="#client_final_message_without_proof-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#client_final_message_without_proof (method)">client_final_message_without_proof</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>,p=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_proof'>proof</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="format_message-instance_method">
  <h3 class='signature priv'>
    #<strong>format_message</strong>(hash)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L192-L192'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='192' data-end='192'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 192</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_format_message'>format_message</span>(<span class='id identifier rubyid_hash'>hash</span>) <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_map'>map</span> { <span class='id identifier rubyid__1'>_1</span>.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span>) }.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initial_client_response-instance_method">
  <h3 class='signature '>
    #<strong>initial_client_response</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>See <a href="https://www.rfc-editor.org/rfc/rfc5802#section-7" target="_parent" title="RFC5802 §7">RFC5802 §7</a> <code>client-first-message</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L159-L161'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='159' data-end='161'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 159</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initial_client_response'>initial_client_response</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gs2_header'>gs2_header</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_client_first_message_bare'><a href="#client_first_message_bare-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#client_first_message_bare (method)">client_first_message_bare</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_challenge-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_challenge</strong>(challenge)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>RFC5802 specifies “that the order of attributes in client or server messages is fixed, with the exception of extension attributes”, but this parses it simply as a hash, without respect to order.  Note that repeated keys (violating the spec) will use the last value.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L257-L261'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='257' data-end='261'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 257</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_challenge'>parse_challenge</span>(<span class='id identifier rubyid_challenge'>challenge</span>)
  <span class='id identifier rubyid_challenge'>challenge</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span>).<span class='id identifier rubyid_to_h'>to_h</span> {<span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span> <span class='id identifier rubyid_pair'>pair</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>=</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='int'>2</span>) }
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unparsable challenge: %p</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_challenge'>challenge</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process-instance_method">
  <h3 class='signature '>
    #<strong>process</strong>(challenge)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>responds to the server’s challenges</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L164-L180'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='164' data-end='180'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 164</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process'>process</span>(<span class='id identifier rubyid_challenge'>challenge</span>)
  <span class='kw'>case</span> (<span class='ivar'>@state</span> <span class='op'>||=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_initial_client_response'><a href="#initial_client_response-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#initial_client_response (method)">initial_client_response</a></span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_initial_client_response'><a href="#initial_client_response-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#initial_client_response (method)">initial_client_response</a></span>
    <span class='id identifier rubyid_initial_client_response'><a href="#initial_client_response-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#initial_client_response (method)">initial_client_response</a></span>.<span class='id identifier rubyid_tap'>tap</span> { <span class='ivar'>@state</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server_first_message'><a href="#server_first_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#server_first_message (method)">server_first_message</a></span> }
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server_first_message'><a href="#server_first_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#server_first_message (method)">server_first_message</a></span>
    <span class='id identifier rubyid_recv_server_first_message'><a href="#recv_server_first_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#recv_server_first_message (method)">recv_server_first_message</a></span> <span class='id identifier rubyid_challenge'>challenge</span>
    <span class='id identifier rubyid_final_message_with_proof'><a href="#final_message_with_proof-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#final_message_with_proof (method)">final_message_with_proof</a></span>.<span class='id identifier rubyid_tap'>tap</span> { <span class='ivar'>@state</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server_final_message'>server_final_message</span> }
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server_final_message'>server_final_message</span>
    <span class='id identifier rubyid_recv_server_final_message'><a href="#recv_server_final_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#recv_server_final_message (method)">recv_server_final_message</a></span> <span class='id identifier rubyid_challenge'>challenge</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_tap'>tap</span> { <span class='ivar'>@state</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_done'>done</span> }
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server sent after complete, %p</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_challenge'>challenge</span>]
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ex'>ex</span>
  <span class='ivar'>@state</span> <span class='op'>=</span> <span class='id identifier rubyid_ex'>ex</span>
  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="recv_server_final_message-instance_method">
  <h3 class='signature priv'>
    #<strong>recv_server_final_message</strong>(server_final_message)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L211-L221'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='211' data-end='221'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 211</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_recv_server_final_message'>recv_server_final_message</span>(<span class='id identifier rubyid_server_final_message'>server_final_message</span>)
  <span class='id identifier rubyid_sparams'>sparams</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_challenge'><a href="#parse_challenge-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#parse_challenge (method)">parse_challenge</a></span> <span class='id identifier rubyid_server_final_message'>server_final_message</span>
  <span class='ivar'>@server_error</span> <span class='op'>=</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>e</span><span class='tstring_end'>&quot;</span></span>] <span class='kw'>and</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server error: %s</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_server_error'><a href="#server_error-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#server_error (method)">server_error</a></span>]
  <span class='id identifier rubyid_verifier'>verifier</span> <span class='op'>=</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_unpack1'>unpack1</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server did not send verifier</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_verifier'>verifier</span> <span class='op'>==</span> <span class='id identifier rubyid_server_signature'>server_signature</span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server verify failed: %p != %p</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [
      <span class='id identifier rubyid_server_signature'>server_signature</span><span class='comma'>,</span> <span class='id identifier rubyid_verifier'>verifier</span>
    ]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="recv_server_first_message-instance_method">
  <h3 class='signature priv'>
    #<strong>recv_server_first_message</strong>(server_first_message)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/net-imap/blob/v0.4.10/lib/net/imap/sasl/scram_authenticator.rb#L194-L209'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='194' data-end='209'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/net/imap/sasl/scram_authenticator.rb', line 194</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_recv_server_first_message'>recv_server_first_message</span>(<span class='id identifier rubyid_server_first_message'><a href="#server_first_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#server_first_message (method)">server_first_message</a></span>)
  <span class='ivar'>@server_first_message</span> <span class='op'>=</span> <span class='id identifier rubyid_server_first_message'><a href="#server_first_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#server_first_message (method)">server_first_message</a></span>
  <span class='id identifier rubyid_sparams'>sparams</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_challenge'><a href="#parse_challenge-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#parse_challenge (method)">parse_challenge</a></span> <span class='id identifier rubyid_server_first_message'><a href="#server_first_message-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#server_first_message (method)">server_first_message</a></span>
  <span class='ivar'>@snonce</span> <span class='op'>=</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span>] <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server did not send nonce</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@salt</span> <span class='op'>=</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_unpack1'>unpack1</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server did not send salt</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@iterations</span> <span class='op'>=</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>i</span><span class='tstring_end'>&quot;</span></span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_then'>then</span> {<span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='const'>Integer</span> <span class='id identifier rubyid_i'>i</span> } <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server did not send iteration count</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_min_iterations'><a href="#min_iterations-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#min_iterations (method)">min_iterations</a></span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_iterations'><a href="#iterations-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#iterations (method)">iterations</a></span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>too few iterations: %d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_iterations'><a href="#iterations-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#iterations (method)">iterations</a></span>]
  <span class='id identifier rubyid_mext'>mext</span> <span class='op'>=</span> <span class='id identifier rubyid_sparams'>sparams</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m</span><span class='tstring_end'>&quot;</span></span>] <span class='kw'>and</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mandatory extension: %p</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_mext'>mext</span>]
  <span class='id identifier rubyid_snonce'><a href="#snonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#snonce (method)">snonce</a></span>.<span class='id identifier rubyid_start_with?'>start_with?</span> <span class='id identifier rubyid_cnonce'><a href="#cnonce-instance_method" title="Net::IMAP::SASL::ScramAuthenticator#cnonce (method)">cnonce</a></span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SASL.html#Error-constant" title="Net::IMAP::SASL::Error (constant)">Error</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid server nonce</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>