<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: ChangeLog &mdash; Ruby-2.3.8</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ChangeLog",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a href='../index.html'>Home</a> &raquo; 
      <a href='index.html'>Ruby-2.3.8</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: ChangeLog&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="file_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>

<p>Thu Oct 18 00:33:13 2018  Kazuki Yamaguchi &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl: backport changes from openssl 2.1.2.</p>

<p>Wed Mar 28 23:08:46 2018  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	get rid of test error/failure on Windows introduced at r62955</p>

<p>	* lib/webrick/httpresponse.rb (send_body_io): use seek if 	  NotImplementedError is raised in IO.copy_stream with offset.</p>

<p>	* lib/webrick/httpservlet/filehandler.rb (multipart_body): ditto.</p>

<p>Wed Mar 28 23:08:46 2018  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	webrick: support Proc objects as body responses</p>

<p>	* lib/webrick/httpresponse.rb (send_body): call send_body_proc 	  (send_body_proc): new method 	  (class ChunkedWrapper): new class</p>

<p>	* test/webrick/test_httpresponse.rb (test_send_body_proc): new test 	  (test_send_body_proc_chunked): ditto 	  [Feature #855]</p>

<p>	webrick: favor .write over &lt;&lt; method</p>

<p>	This will make the next change to use IO.copy_stream 	easier-to-read.  When we can drop Ruby 2.4 support in a few 	years, this will allow us to use writev(2) with multiple 	arguments for headers and chunked responses.</p>

<p>	* lib/webrick/cgi.rb (write): new wrapper method 	  lib/webrick/httpresponse.rb: (send_header): use socket.write 	  (send_body_io): ditto 	  (send_body_string): ditto 	  (send_body_proc): ditto 	  (_write_data): ditto 	  (ChunkedWrapper#write): ditto 	  (_send_file): ditto</p>

<p>	webrick/httpresponse: IO.copy_stream for regular files</p>

<p>	Remove the redundant _send_file method since its functionality 	is unnecessary with IO.copy_stream.  IO.copy_stream also allows 	the use of sendfile under some OSes to speed up copies to 	non-TLS sockets.</p>

<p>	Testing with “curl &gt;/dev/null” and “ruby -run -e httpd” to 	read a 1G file over Linux loopback reveals a reduction from 	around ~0.770 to ~0.490 seconds on the client side.</p>

<p>	* lib/webrick/httpresponse.rb (send_body_io): use IO.copy_stream 	  (_send_file): remove 	  [Feature #14237]</p>

<p>	webrick: use IO.copy_stream for single range response</p>

<p>	This is also compatible with range responses generated 	by Rack::File (tested with rack 2.0.3).</p>

<p>	* lib/webrick/httpresponse.rb (send_body_io): use Content-Range 	* lib/webrick/httpservlet/filehandler.rb (make_partial_content): 	  use File object for the single range case 	* test/webrick/test_filehandler.rb (get_res_body): use send_body 	  to test result</p>

<p>	test/webrick/test_filehandler.rb: stricter multipart range test</p>

<p>	We need to ensure we generate compatibile output in 	the face of future changes</p>

<p>	* test/webrick/test_filehandler.rb (test_make_partial_content): 	  check response body</p>

<p>	webrick: quiet warning for multi-part ranges</p>

<p>	Content-Length is ignored by WEBrick::HTTPResponse even if we 	calculate it, so instead we chunk responses to HTTP/1.1 clients 	and terminate HTTP/1.0 connections.</p>

<p>	* lib/webrick/httpservlet/filehandler.rb (make_partial_content): 	  quiet warning</p>

<p>	webrick/httpresponse: make ChunkedWrapper copy_stream-compatible</p>

<p>	The .write method needs to return the number of bytes written 	to avoid confusing IO.copy_stream.</p>

<p>	* lib/webrick/httpresponse.rb (ChunkedWrapper#write): return bytes written 	  (ChunkedWrapper#&lt;&lt;): return self</p>

<p>	webrick: use IO.copy_stream for multipart response</p>

<p>	Use the new Proc response body feature to generate a multipart 	range response dynamically.  We use a flat array to minimize 	object overhead as much as possible; as many ranges may fit 	into an HTTP request header.</p>

<p>	* lib/webrick/httpservlet/filehandler.rb (multipart_body): new method 	  (make_partial_content): use multipart_body</p>

<p>Wed Mar 28 21:24:24 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	unixsocket.c: abstract namespace</p>

<p>	* ext/socket/unixsocket.c (unixsock_path_value): fix r62991 for 	  Linux abstract namespace.</p>

<p>Wed Mar 28 19:36:24 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	pack.c: fix underflow</p>

<p>	* pack.c (pack_unpack_internal): get rid of underflow. 	  <a href="https://hackerone.com/reports/298246">hackerone.com/reports/298246</a></p>

<p>Wed Mar 28 19:30:54 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	unixsocket.c: check NUL bytes</p>

<p>	* ext/socket/unixsocket.c (rsock_init_unixsock): check NUL bytes. 	  <a href="https://hackerone.com/reports/302997">hackerone.com/reports/302997</a></p>

<p>Wed Mar 28 19:29:03 2018  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	Ignore file separator from tmpfile/tmpdir name.</p>

<p>Wed Mar 28 19:24:20 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	dir.c: check NUL bytes</p>

<p>	* dir.c (GlobPathValue): should be used in rb_push_glob only. 	  other methods should use FilePathValue. 	  <a href="https://hackerone.com/reports/302338">hackerone.com/reports/302338</a></p>

<p>	* dir.c (rb_push_glob): expand GlobPathValue</p>

<p>Wed Mar 28 18:04:37 2018  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	webrick: prevent response splitting and header injection</p>

<p>	Original patch by tenderlove (with minor style adjustments).</p>

<p>	* lib/webrick/httpresponse.rb (send_header): call check_header 	  (check_header): raise on embedded CRLF in header value 	* test/webrick/test_httpresponse.rb 	  (test_prevent_response_splitting_headers): new test 	* (test_prevent_response_splitting_cookie_headers): ditto</p>

<p>Wed Mar 28 18:04:37 2018  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	webrick: use IO.copy_stream for multipart response</p>

<p>	Use the new Proc response body feature to generate a multipart 	range response dynamically.  We use a flat array to minimize 	object overhead as much as possible; as many ranges may fit 	into an HTTP request header.</p>

<p>	* lib/webrick/httpservlet/filehandler.rb (multipart_body): new method 	  (make_partial_content): use multipart_body</p>

<p>	webrick/httprequest: limit request headers size</p>

<p>	We use the same 112 KB limit started (AFAIK) by Mongrel, Thin, 	and Puma to prevent malicious users from using up all the memory 	with a single request.  This also limits the damage done by 	excessive ranges in multipart Range: requests.</p>

<p>	Due to the way we rely on IO#gets and the desire to keep 	the code simple, the actual maximum header may be 4093 bytes 	larger than 112 KB, but we&#39;re splitting hairs at that point.</p>

<p>	* lib/webrick/httprequest.rb: define MAX_HEADER_LENGTH 	  (read_header): raise when headers exceed max length</p>

<p>	webrick/httpservlet/cgihandler: reduce memory use</p>

<p>	WEBrick::HTTPRequest#body can be passed a block to process the 	body in chunks.  Use this feature to avoid building a giant 	string in memory.</p>

<p>	* lib/webrick/httpservlet/cgihandler.rb (do_GET): 	  avoid reading entire request body into memory 	  (do_POST is aliased to do_GET, so it handles bodies)</p>

<p>	webrick/httprequest: raise correct exception</p>

<p>	“BadRequest” alone does not resolve correctly, it is in the 	HTTPStatus namespace.</p>

<p>	* lib/webrick/httprequest.rb (read_chunked): use correct exception 	* test/webrick/test_httpserver.rb (test_eof_in_chunk): new test</p>

<p>	webrick/httprequest: use InputBufferSize for chunked requests</p>

<p>	While WEBrick::HTTPRequest#body provides a Proc interface 	for streaming large request bodies, clients must not force 	the server to use an excessively large chunk size.</p>

<p>	* lib/webrick/httprequest.rb (read_chunk_size): limit each 	  read and block.call to <code>:InputBufferSize</code> in config. 	* test/webrick/test_httpserver.rb (test_big_chunks): new test</p>

<p>	webrick: add test for Digest auth-int</p>

<p>	No changes to the actual code, this is a new test for 	a feature for which no tests existed.  I don&#39;t understand 	the Digest authentication code well at all, but this is 	necessary for the subsequent change.</p>

<p>	* test/webrick/test_httpauth.rb (test_digest_auth_int): new test 	  (credentials_for_request): support bodies with POST</p>

<p>	webrick/httpauth/digestauth: stream req.body</p>

<p>	WARNING! WARNING! WARNING!  LIKELY BROKEN CHANGE</p>

<p>	Pass a proc to WEBrick::HTTPRequest#body to avoid reading a 	potentially large request body into memory during 	authentication.</p>

<p>	WARNING! this will break apps completely which want to do 	something with the body besides calculating the MD5 digest 	of it.</p>

<p>	Also, keep in mind that probably nobody uses “auth-int”. 	Servers such as Apache, lighttpd, nginx don&#39;t seem to 	support it; nor does curl when using POST/PUT bodies; 	and we didn&#39;t have tests for it until now…</p>

<p>	* lib/webrick/httpauth/digestauth.rb (_authenticate): stream req.body</p>

<p>Wed Mar 28 15:48:30 2018  Kazuki Yamaguchi &lt;k@rhe.jp&gt;</p>

<p>	backport some changes from openssl gem v2.0.6 and v2.0.7. 	[Backport #13935]</p>

<p>Wed Mar 28 15:24:15 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	Fix setting method visibility on method wrapped with prepend</p>

<p>	Ignore prepended modules when looking for already defined methods on a 	class to set the visibility on. 	[Fix GH-1834]</p>

<p>	From: Dylan Thacker-Smith Dylan.Smith@shopify.com</p>

<p>Wed Mar 28 15:02:43 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	resolv.rb: close socket</p>

<p>	* lib/resolv.rb (UnconnectedUDP#lazy_initialize): store new 	  sockets before binding, so the sockets get closed when the 	  requester is closing.</p>

<p>	* lib/resolv.rb (ConnectedUDP#lazy_initialize): ditto.</p>

<p>	* lib/resolv.rb (UnconnectedUDP#close): synchronize to get rid of 	  race condition.</p>

<p>	* lib/resolv.rb (ConnectedUDP#close): ditto.</p>

<p>	[Bug #14571]</p>

<p>	From: quixoten (Devin Christensen) quixoten@gmail.com</p>

<p>Wed Mar 28 14:59:27 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	socket.c: null byte at Socket.getnameinfo</p>

<p>	* ext/socket/socket.c (sock_s_getnameinfo): check null byte. patched by 	  tommy (Masahiro Tomita) in . [Bug #13994]</p>

<p>Wed Mar 28 14:53:57 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	date_core.c: defensive code</p>

<p>	* ext/date/date_core.c (f_cmp): check comparison failure.</p>

<p>	* ext/date/date_core.c (d_lite_step): deal with the comparison 	  result more defensively. [Bug #14549]</p>

<p>Wed Mar 28 14:50:52 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	string.c: clear substring code range</p>

<p>	* string.c (str_substr): substring of broken code range string may be 	  valid or broken. patch by tommy (Masahiro Tomita) at [Bug #14388].</p>

<p>Wed Mar 28 14:48:13 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	win32.c: memcpy instead of strlcpy</p>

<p>	* win32/win32.c (cmdglob): memcpy the exact size instead of 	  strlcpy with +1.</p>

<p>	* win32/win32.c (w32_cmdvector): ditto, with NUL-terminating.</p>

<p>Wed Mar 28 14:45:02 2018  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	check array for zsuper. [Bug #14279]</p>

<p>	* compile.c (iseq_compile_each0): for zsuper (NODE_ZSUPER), we need to 	  check given argument is Array or not.</p>

<p>	* test/ruby/test_super.rb: add a test for this bug.</p>

<p>Wed Mar 28 14:40:25 2018  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	net/ftp: fix FrozenError in BufferedSocket</p>

<p>	I noticed this bug while working on something else with 	RUBYOPT=-d on, existing test cases all passed with it.</p>

<p>	Note: I use String.new because it is the local style, here, 	I prefer +&#39;&#39; (or &#39;&#39;.b, for a future commit)</p>

<p>	* lib/net/ftp.rb (BufferedSocket#read): use String.new 	* test/net/ftp/test_buffered_socket.rb (test_read_nil): new test 	  [Bug #14323]</p>

<p>Wed Mar 28 14:29:26 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	clean autogenerated files</p>

<p>	* enc/depend (clean, clean-srcs): fix path of name2ctype.h, and 	  remove casefold.h too.</p>

<p>	* enc/jis/props.h: autogenerated file. 	  [Bug #13493]</p>

<p>	Update sources and include files after update</p>

<p>	Ignore enc/jis/props.h</p>

<p>Wed Mar 28 14:14:25 2018  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>	fix SEGV touching uninitialized memory 	This function can be called from boot_defclass(). 	No assumption can be made about object internals.</p>

<p>	fix SEGV touching uninitialized memory 	This function can be called from InitVM_Object(). 	No assumption can be made about object internals.</p>

<p>	fix SEGV touching uninitialized local variable 	This imemo_name is used uninitialized because the switch 	above does not cover all possible imemo types.</p>

<p>	fix SEGV inspecting already freed objects 	obj_info() assumes the given object is alive. Passing freed 	objects to it results in SEGV.</p>

<p>	fix SEGV inspecting uninitialized objects 	obj_info() assumes the given object is alive. OTOH 	gc_writebarrier_incremental is called before or in middle of 	object initialization. Can casue SEGV.</p>

<p>Wed Mar 28 13:56:17 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	raise error if value contains CR/LF in iniheader of 	initialize_http_header</p>

<p>	like r59693, initialize_http_header also should raise error. 	[Bug #14208]</p>

<p>Wed Mar 28 13:48:35 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	parse.y: end of script at newline</p>

<p>	* parse.y (parser_yylex): deal with end of script chars just after 	  ignored newline as other places. [Bug #14206]</p>

<p>Wed Mar 28 13:42:55 2018  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	[DOC] IO.new accepts external_encoding</p>

<p>	Revert part of r61278 [Bug #13655] 	[ci skip]</p>

<p>Wed Mar 28 13:42:55 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	IO.new doesn&#39;t receive “-” as external_encoding [Bug #13655]</p>

<p>Thu Mar 22 15:38:43 2018  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	Removed the obstacle to running test-all with VC14.</p>

<p>	* test/fiddle/test_import.rb (LIBC.fprintf): VC14&#39;s <code>fprintf</code> is very distinct 	  name, then, just ignore this test.</p>

<p>Thu Mar 22 12:28:23 2018  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	merge <a href="https://github.com/ruby/openssl/commit/3af2635f117f8da563d180bc1c58702aecb16e0c">github.com/ruby/openssl/commit/3af2635f117f8da563d180bc1c58702aecb16e0c</a> 	patched by Kazuki Yamaguchi &lt;k@rhe.jp&gt;</p>

<p>	bio: prevent possible GC issue in ossl_obj2bio()</p>

<p>	Prevent the new object created by StringValue() from being GCed. 	Luckily, as none of the callers of ossl_obj2bio() reads from the 	returned BIO after possible triggering GC, this has not been a real 	problem.</p>

<p>	As a bonus, ossl_protect_obj2bio() function which is no longer used 	anywhere is removed.</p>

<p>	merge <a href="https://github.com/ruby/openssl/commit/f842b0d5c5e37527c11954a4b7a98c8d9cc57865">github.com/ruby/openssl/commit/f842b0d5c5e37527c11954a4b7a98c8d9cc57865</a> 	patched by Kazuki Yamaguchi &lt;k@rhe.jp&gt;</p>

<p>	bio: do not use the FILE BIO method in ossl_obj2bio()</p>

<p>	Read everything from an IO object into a String first and use the 	memory buffer BIO method just as we do for String inputs.</p>

<p>	For MSVC builds, the FILE BIO method uses the “UPLINK” interface that 	requires the application to provide OPENSSL_Applink() function. For us, 	the “application” means ruby.exe, in which we can&#39;t do anything. As a 	workaround, avoid using the FILE BIO method at all.</p>

<p>	Usually private keys or X.509 certificates aren&#39;t that large and the 	temporarily increased memory usage hopefully won&#39;t be an issue.</p>

<p>	ext/openssl/ossl_version.h (OpenSSL::VERSION): bump to 1.1.1.</p>

<p>Thu Mar 22 11:24:43 2018  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (set_pioinfo_extra): use more reliable way to search 	  the position of pioinfo of VC14, and also support debug library of it. 	  patched by davispuh AT gmail.com 	  [ruby-core:76644] [Bug #12644] 	  this fixes also [Bug #12631]</p>

<p>Thu Mar 22 11:24:43 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	win32.c: suppress warnings</p>

<p>	* win32/win32.c (set_pioinfo_extra): remove “/*” within comment.</p>

<p>Thu Mar 22 11:24:43 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	Support MSVC14 and 15 [Bug #11118]</p>

<p>	Search _pioinfo which is not exported after MSVC14. 	[Bug #12014] [GH-884]</p>

<p>Mon Mar 19 00:34:38 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	win32.c: unknown reparse tags</p>

<p>	* win32/win32.c (rb_w32_read_reparse_point): skip unknown reparse tags. 	  [Bug #14047]</p>

<p>Mon Mar 19 00:32:31 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_lazy_enumerator.rb: test for [Bug #14082]</p>

<p>	enum.c: check argument first</p>

<p>	* enum.c (enum_cycle_size): check an argument before the size of the 	  receiver, if it is given.</p>

<p>Mon Mar 19 00:32:31 2018  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	Fix size on Enumerable#cycle when the size is 0 [Bug #14082].</p>

<p>	Patch by Kenichi Kamiya</p>

<p>Mon Mar 19 00:28:28 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_here_document): an escaped newline is not an 	  actual newline, and the rest part should not be dedented. 	  [ruby-core:72855] [Bug #11989]</p>

<p>Mon Mar 19 00:27:06 2018  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	thread_pthread: do not corrupt stack</p>

<p>	This fixes stuck test/ruby/test_io.rb with FIBER_USE_NATIVE=0 on 	GNU/Linux because linked-list pointers used by glibc get 	corrupted when fiber stacks are copied.</p>

<p>	Thanks to wanabe for finding the bug and original patch.</p>

<p>	* thread_pthread (native_thread_init_stack): fix stack corruption 	  [Bug #13387]</p>

<p>Mon Mar 19 00:22:52 2018  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	TracePoint#enable, #disable: Don&#39;t yield any argument. [Bug #14057]</p>

<p>Mon Mar 19 00:21:00 2018  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	Clarify the behavior of IO.write without offset in write mode.</p>

<p>	<a href="https://github.com/ruby/ruby/pull/1571">github.com/ruby/ruby/pull/1571</a></p>

<p>	Patch by takanabe (Takayuki Watanabe) [fix GH-1571] 	[Bug #11638]</p>

<p>Mon Mar 19 00:16:28 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	parse.y: token info with BOM</p>

<p>	* parse.y (parser_prepare): set token_info_enabled flag first, before 	  returning at BOM. [Bug #13998]</p>

<p>Mon Mar 19 00:06:43 2018  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>	io.c: fix segfault with closing socket on Windows</p>

<p>	* io.c (fptr_finalize_flush): add an argument to keep GVL.</p>

<p>	* io.c (fptr_finalize): adjust for above change.</p>

<p>	* io.c (io_close_fptr): closing without GVL causes another exception 	  while raising exception in another thread. This causes segfault on 	  Windows. Keep GVL while closing when another thread raises. 	  [Bug #13856]</p>

<p>Mon Mar 19 00:04:08 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/forwardable.rb (_delegator_method): leave the backtrace 	  untouched during accessor.  forwardable.rb does not appear in 	  the backtrace during delegated method because of tail-call 	  optimization.</p>

<p>Sun Mar 18 23:59:32 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	dup String#partition return value</p>

<p>	* string.c (rb_str_partition): return duplicated receiver, when no 	  splits. [Bug#13925]</p>

<p>	Author: Seiei Miyagi hanachin@gmail.com</p>

<p>	dup String#rpartition return value</p>

<p>	* string.c (rb_str_rpartition): return duplicated receiver, when no 	  splits. [Bug#13925]</p>

<p>	Author: Seiei Miyagi hanachin@gmail.com</p>

<p>	dup String#split return value</p>

<p>	* string.c (rb_str_split): return duplicated receiver, when no splits. 	  patched by tompng (tomoya ishida) in , and the test case by Seiei 	  Miyagi hanachin@gmail.com. [Bug#13925] [Fix GH-1705]</p>

<p>Sun Mar 18 23:57:32 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	ruby.c: paragraph mode by -00</p>

<p>	* ruby.c (proc_options): set to paragraph mode, if -00 is given, as 	  well as perl and -R0 option in 0.49. [Bug #13736]</p>

<p>Sun Mar 18 23:55:23 2018  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	process: block/unblock signals around fork</p>

<p>	As with forking for execve(2) in spawn&#39;, we must block signals 	to ensure they are handled correctly in a freshlyfork&#39;-ed child.</p>

<p>	* process.c (retry_fork_ruby): block/unblock signals around fork 	  (rb_fork_ruby): re-enable signals in forked child</p>

<p>	* test/ruby/test_process.rb (test_forked_child_signal): new test 	  [Bug #13916]</p>

<p>	Thanks to Russell Davis for the bug report and test case.</p>

<p>Sun Mar 18 23:52:37 2018  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	vm.c: fix `cfp consistency error&#39; which occurs when raising exception 	in bmethod call event</p>

<p>	* vm.c (invoke_bmethod): set FINISH flag just before calling vm_exec. 	  [Bug #13705]</p>

<p>Sun Mar 18 23:36:24 2018  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	added workaround for APFS file format.</p>

<p>	* TestFileExhaustive#test_atime: It fails with nano-sec precise. I 	  changed to use unixtime for this assertion for APFS.</p>

<p>	* TestFileExhaustive#test_expand_path: skip assertion when given 	  invalid charactor on APFS.</p>

<p>	[Bug #13816]</p>

<p>Sun Mar 18 23:36:04 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	High Sierra&#39;s APFS cannot use invalid filenames [Bug #13816]</p>

<p>Sun Mar 18 23:31:44 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	test_framework.rb: for case-sensitive filesystem</p>

<p>	* test/mkmf/test_framework.rb (test_single_framework): fix header 	  file name for case-sensitive filesystem. it may not be same as 	  the framework name, but should be the actual file name. 	  [Bug #13489]</p>

<p>	* test/mkmf/test_framework.rb (test_multi_frameworks): ditto.</p>

<p>	test_file_exhaustive.rb: check case-sensitive fs</p>

<p>	* test/ruby/test_file_exhaustive.rb (test_expand_path): dump expanded 	  file name, not only appended char, for case-sensitive filesystem. 	  [Bug #13489]</p>

<p>Sun Mar 18 23:29:14 2018  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* test/win32ole/test_word.rb: word quit without confirmation dialog to 	  save files. [Bug #13894] Thanks to h.shirosaki.</p>

<p>Sun Mar 18 23:26:20 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	fix the case High Sierra&#39;s mincore(2) may return -128 [Bug #13895]</p>

<p>Sun Mar 18 23:23:48 2018  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	skip unless PLATFORM is darwin.</p>

<p>Sun Mar 18 23:23:48 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	Treat NULL reference case [Bug #13566]</p>

<p>	Fix C level backtrace on Darwin 	SEGV caused by invalid instruction call.</p>

<p>Sun Mar 18 23:11:29 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (ARFLAGS): check if deterministic mode flag is 	  effective, which is on by default on Ubuntu.</p>

<p>	* configure.in: use libtool on macOS to suppress a warning against 	  debug_counter.o, which has no symbols unless USE_DEBUG_COUNTER is 	  set to non-zero.</p>

<p>	* configure.in: use newer libtool only</p>

<p>Sat Feb 17 01:21:00 2018  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	Merge RubyGems 2.7.6 from upstream.</p>

<p>	It fixed some security vulnerabilities.</p>

<p>	<a href="http://blog.rubygems.org/2018/02/15/2.7.6-released.html">blog.rubygems.org/2018/02/15/2.7.6-released.html</a></p>

<p>	fix regexp literal warning.</p>

<p>	* test/rubygems/test_gem_server.rb: eliminate duplicated character class warning. 	  [Bug #14481]</p>

<p>Thu Feb  1 04:00:53 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	Remove debug print introduced in r52386</p>

<p>Wed Jan 31 22:57:42 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	configure.in: link Foundation framework</p>

<p>	* configure.in (XLDFLAGS): link against Foundation framework and 	  let __NSPlaceholderDictionary initialize, to get rid of crash 	  after fork on macOS High Sierra.  [ruby-core:83239] [Bug #14009]</p>

<p>Wed Jan 31 22:51:59 2018  Pete Higgins  &lt;pete@peterhiggins.org&gt;</p>

<p>	* thread_sync.c (Init_thread_sync): Remove confusing doc comments, 	  which are picked up by rdoc unexpectedly, from Queue and 	  SizedQueue.  [Fix GH-1450]</p>

<p>Wed Jan 31 22:48:41 2018  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	thread_pthread.c: do not wakeup inside child processes</p>

<p>	* thread_pthread.c (rb_thread_wakeup_timer_thread): check 	  ownership before incrementing 	  (rb_thread_wakeup_timer_thread_low): ditto 	  [Bug #13794] [ruby-core:83064]</p>

<p>Wed Jan 31 22:46:36 2018  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* configure.in (rb_cv_lgamma_r_pm0): check if lgamma_r(+0.0) 	  returns positive infinity, in addition to lgamma_r(-0.0). 	  AIX returns an incorrect result of negative infinity.</p>

<p>	* math.c (ruby_lgamma_r): handle +0.0, in addition to -0.0.</p>

<p>Wed Jan 31 22:32:08 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	ext: check if null byte is contained</p>

<p>	[ruby-dev:50267] [Bug #13953]</p>

<p>Wed Jan 31 22:29:57 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	string.c: fix ASCII-only on succ</p>

<p>	* string.c (str_succ): clear coderange cache when no alpha-numeric 	  character case, carried part may become ASCII-only. 	  [ruby-core:83062] [Bug #13952]</p>

<p>Wed Jan 31 22:28:20 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	pack.c: unpack “M” may be ASCII only</p>

<p>	* pack.c (pack_unpack_internal): set ASCII only properly on “M”, 	  may be ASCII only.  [ruby-core:83055] [Bug #13949]</p>

<p>Wed Jan 31 22:26:13 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	string.c: ASCII-incompatible is not ASCII only</p>

<p>	* string.c (tr_trans): ASCII-incompatible encoding strings cannot 	  be ASCII-only even if valid.  [ruby-core:83056] [Bug #13950]</p>

<p>Wed Jan 31 22:24:05 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	vm.c: fetch retval iff necessary</p>

<p>	* vm.c (rb_vm_make_jump_tag_but_local_jump): get rid of fetching 	  retval when it is not used.  it is necessary for local jump 	  state only.</p>

<p>Wed Jan 31 22:16:00 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	compile.c: fix stack consitency error</p>

<p>	* compile.c (iseq_compile_each0): fix stack consitency error on 	  attr-assign with safe navigation operator when the receiver is 	  nil, should pop it too.  [ruby-core:83078] [Bug #13964]</p>

<p>	test_call.rb: refine test_safe_call</p>

<p>	* test/ruby/test_call.rb (test_safe_call): rhs should not be 	  evaluated when the receiver is nil.  simplified the assertion 	  for  [Bug #13964].</p>

<p>Wed Jan 31 22:12:48 2018  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	adjust indent</p>

<p>	* vm_insnhelper.c (vm_call_method_each_type): adjust indent of a 	  block in switch.</p>

<p>	visibility of inherited method</p>

<p>	* vm_insnhelper.c (vm_call_method_each_type): honor the original 	  visibility of inherited methods when a refinement is defined but 	  not activated.  [ruby-core:82209] [Bug #13776]</p>

<p>	Author:    Mon_Ouie (Mon ouie) &lt;mon.ouie@gmail.com&gt;</p>

<p>Wed Jan 31 20:47:07 2018  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	HTTPHeader#add_field should allow binary [Bug #13926]</p>

<p>Wed Jan 31 20:42:11 2018  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	ri.1: rewrite ri man page</p>

<p>	* man/ri.1: update the (very outdated) ri man page: 	  * update document date 	  * fix document title formatting and volume name 	  * update descriptions and options to current ri –help text 	  * fix some mdoc formatting errors (missing escaping of `&#39;, 	    wrong macro for bullet list items) 	  * various rewordings and other improvements</p>

<p>	improve man pages</p>

<p>	* man/ruby.1, man/erb.1, man/goruby.1, man/irb.1: 	  fix document title formatting and volume name, 	  improve “REPORTING BUGS” section: fix mdoc formatting error 	  (wrong macro for bullet list items), small rewordings.</p>

<p>Wed Jan 31 20:25:09 2018  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	lib/net/imap.rb: Ignore trailing space for Microsoft Exchange Server</p>

<p>	Based on the patch by keysen (Jeremy Carlier). 	[ruby-core:81641] [Bug #13649]</p>

<p>Wed Jan 31 20:23:49 2018  sorah (Shota Fukumori)  &lt;her@sorah.jp&gt;</p>

<p>	Add documents on Process::CLOCK_* constants</p>

<p>	* process.c: Add documents on Process::CLOCK_* constants. 	  Patch by Sunao Komuro &lt;sunao-komuro@cookpad.com&gt;. 	  Closes [GH-1567] [Bug #13386]</p>

<p>Wed Jan 31 20:11:20 2018  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	ri.1: fix errors in ri man page</p>

<p>	* man/ri.1: fix some errors in ri man page (add missing options, 	  remove options that do not exist, fix formatter list).</p>

<p>	  Reported by Josh Cheek.  [ruby-core:68065] [Bug #10838]</p>

<p>Wed Jan 31 20:09:50 2018  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	date_core.c: fix error in DateTime docs</p>

<p>	* ext/date/date_core.c: [DOC] fix format string for DateTime#rfc3339. 	  Reported by Andreas Rayo Kniep.  [ruby-core:68418] [Bug #10936]</p>

<p>	* ext/date/date_core.c: [DOC] ditto for DateTime#iso8601 and 	  DateTime#xmlschema; other small improvements.</p>

<p>Wed Jan 31 20:04:47 2018  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	lib/ostruct.rb: [DOC] revise docs for OpenStruct</p>

<p>	* update paragraph on implementation: 	  define_singleton_method is used, not define_method 	* add call-seq with return values for each_pair 	* adopt description of dig from Array and Hash 	* fix description of the hash method 	* :nodoc: initialize_copy, respond_to_missing? 	* other small improvements, e.g. use the term `attribute&#39; in the docs 	  (instead of `member&#39;), which is clearer for users of the class 	* improve code examples: e.g. use more consistent style (always use 	  double quotes, drop `p&#39; and `puts&#39;, …), update inspect output, 	  use example data that is not prone to change (like population) 	* add more code examples 	* fix some small errors and grammar</p>

<p>	[ruby-core:79265] [Bug #13159]</p>

<p>Wed Jan 31 20:02:29 2018  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	rational.c: fix rdoc</p>

<p>	* rational.c: [DOC] fix wrong indentations and comment out some lines 	  in code examples to make them valid Ruby code and syntax highlighted 	  on the rendered page.</p>

<p>	[ci skip] [Bug #13233] 	Author: Marcus Stollsteimer sto.mar@web.de</p>

<p>Wed Jan 31 19:57:09 2018  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	doc: Add example for Symbol#to_s</p>

<p>	* string.c: add example for Symbol#to_s.</p>

<p>	The docs for Symbol#to_s only include an example for 	Symbol#id2name, but not for #to_s which is an alias; 	the docs should include examples for both methods.</p>

<p>	From: Marcus Stollsteimer &lt;sto.mar@web.de&gt;</p>

<p>Wed Jan 31 19:49:44 2018  Reiner Herrmann  &lt;reiner@reiner-h.de&gt;</p>

<p>	* lib/mkmf.rb (create_makefile): sort lists of source and object 	  files in generated Makefile, unless given by extconf.rb. 	  [Fix GH-1367]</p>

<p>Fri Dec 15 03:48:55 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* version.h: Bump version to 2.3.7</p>

<p>Thu Dec 14 23:53:41 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/net/ftp/test_ftp.rb (process_port_or_eprt): merge a part of 	  r56973 to pass the test introduced at previous commit.</p>

<p>Thu Dec 14 22:55:05 2017  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	Fix a command injection vulnerability in Net::FTP.</p>

<p>Thu Dec 14 22:35:19 2017  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	webrick: compile RE correctly for beginning and end match</p>

<p>	Using ^ and $ in regexps means we can accidentally get fooled 	by “%0a” in HTTP request paths being decoded to newline 	characters.  Use A and z to match beginning and end-of-string 	respectively, instead.</p>

<p>	Thanks to mame and hsbt for reporting.</p>

<p>	* lib/webrick/httpserver.rb (MountTable#compile): 	  use A and z instead of ^ and $ 	* lib/webrick/httpserver.rb (MountTable#normalize): use z instead of $ 	* test/webrick/test_httpserver.rb (test_cntrl_in_path): new test</p>

<p>Thu Dec 14 22:29:04 2017  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	webrick: do not hang acceptor on slow TLS connections</p>

<p>	OpenSSL::SSL::SSLSocket#accept may block indefinitely on clients 	which negotiate the TCP connection, but fail (or are slow) to 	negotiate the subsequent TLS handshake.  This prevents the 	multi-threaded WEBrick server from accepting other connections.</p>

<p>	Since the TLS handshake (via OpenSSL::SSL::SSLSocket#accept) 	consists of normal read/write traffic over TCP, handle it in the 	per-client thread, instead.</p>

<p>	Furthermore, using non-blocking accept() is useful for non-TLS 	sockets anyways because spurious wakeups are possible from 	select(2).</p>

<p>	* lib/webrick/server.rb (accept_client): use TCPServer#accept_nonblock 	  and remove OpenSSL::SSL::SSLSocket#accept call 	* lib/webrick/server.rb (start_thread): call OpenSSL::SSL::SSLSocket#acc ept 	* test/webrick/test_ssl_server.rb (test_slow_connect): new test 	  [ruby-core:83221] [Bug #14005]</p>

<p>	webrick: fix up r60172</p>

<p>	By making the socket non-blocking in r60172, TLS/SSL negotiation 	via the SSL_accept function must handle non-blocking sockets 	properly and retry on SSL_ERROR_WANT_READ/SSL_ERROR_WANT_WRITE. 	OpenSSL::SSL::SSLSocket#accept cannot do that properly with a 	non-blocking socket, so it must use non-blocking logic of 	OpenSSL::SSL::SSLSocket#accept_nonblock.</p>

<p>	Thanks to MSP-Greg (Greg L) for finding this.</p>

<p>	* lib/webrick/server.rb (start_thread): use SSL_accept properly 	  with non-blocking socket. 	  [Bug #14013] [Bug #14005]</p>

<p>	webrick: fix up r60172 and revert r60189</p>

<p>	Thanks to MSP-Greg (Greg L) for helping with this.</p>

<p>	* lib/webrick/server.rb (start_thread): ignore ECONNRESET, ECONNABORTED, 	  EPROTO, and EINVAL on TLS negotiation errors the same way they 	  were ignored before r60172 in the accept_client method of the 	  main acceptor thread. 	  [Bug #14013] [Bug #14005]</p>

<p>	webrick: fix up r60172 and r60208</p>

<p>	Thanks to MSP-Greg (Greg L) for helping with this.</p>

<p>	* lib/webrick/server.rb (start_thread): fix non-local return 	  introduced in r60208</p>

<p>	webrick: fix up r60172 and r60210</p>

<p>	Thanks to MSP-Greg (Greg L) for helping with this.</p>

<p>	* lib/webrick/server.rb (start_thread): properly fix non-local return 	  introduced in r60208 and r60210</p>

<p>Thu Nov 30 23:37:08 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	parse.y: fix line in rescue</p>

<p>	* parse.y (set_line_body, primary): fix line number of bodystmt as the 	  beginning of the block. [Bug #13181]</p>

<p>Thu Nov 30 23:29:00 2017  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	Merge rubygems-2.6.14 changes.</p>

<p>	It fixed <a href="http://blog.rubygems.org/2017/10/09/unsafe-object-deserialization-vulnerability.html">blog.rubygems.org/2017/10/09/unsafe-object-deserialization-vulnerability.html</a></p>

<p>Fri Sep 15 05:40:40 2017  URABE Shyouhei  &lt;shyouhei@ruby-lang.org&gt;</p>

<p>	fix –with-gmp (broken by r57490)</p>

<p>	Looking at the generated shell script (also the autoconf manual), it 	seems AC_SEARCH_LIBS() m4 macro does not define HAVE_LIBsomething C 	preprocessor macros, unlike AC_CHECK_LIB() which does define them. 	This previous change effectively killed building with GMP because 	building that mode depends on existence of HAVE_LIBGMP. [Bug #13402]</p>

<p>Thu Sep 14 20:25:55 2017  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>	lib/webrick/log.rb: sanitize any type of logs</p>

<p>	It had failed to sanitize some type of exception messages.  Reported and 	patched by Yusuke Endoh (mame) at <a href="https://hackerone.com/reports/223363">hackerone.com/reports/223363</a></p>

<p>Thu Sep 14 13:32:39 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	parse.y: empty hash in defined</p>

<p>	* parse.y (command): NODE_ARRAY with NULL is invalid.  traversal 	  in defined_expr0 is simplified than iseq_compile_each0. 	  [ruby-core:82113] [Bug #13756]</p>

<p>Thu Sep 14 13:26:31 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	string.c: fix false coderange</p>

<p>	* string.c (rb_enc_str_scrub): enc can differ from the actual encoding 	  of the string, the cached coderange is useless then. [Bug #13874]</p>

<p>Thu Sep 14 13:24:51 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	parse.y: primary should not be 0</p>

<p>	* parse.y (primary): should not be 0, since it can be a receiver. 	  [ruby-core:82447] [Bug #13836]</p>

<p>Thu Sep 14 13:19:30 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	vm_method.c: alias warning at refined method</p>

<p>	* vm_method.c (rb_method_entry_make): suppress a warning at 	  refined method which will not be redefined. 	  [ruby-core:82385] [Bug #13817]</p>

<p>Thu Sep 14 13:14:19 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c (BigDecimal_hash): st_index_t may not be 	  fixable on 64bit mswin/mingw.</p>

<p>	* ext/date/date_core.c (d_lite_hash): ditto. 	  [Backport #13877]</p>

<p>	* ext/openssl/ossl_bn.c (ossl_bn_hash): ditto.</p>

<p>Sat Sep  9 23:05:31 2017  Kazuki Yamaguchi &lt;k@rhe.jp&gt;</p>

<p>	asn1: fix out-of-bounds read in decoding constructed objects</p>

<p>	* OpenSSL::ASN1.<code>decode,decode_all,traverse</code>: have a bug of 	  out-of-bounds read. int_ossl_asn1_decode0_cons() does not give the 	  correct available length to ossl_asn1_decode() when decoding the 	  inner components of a constructed object. This can cause 	  out-of-bounds read if a crafted input given.</p>

<p>	Reference: <a href="https://hackerone.com/reports/170316">hackerone.com/reports/170316</a> 	<a href="https://github.com/ruby/openssl/commit/1648afef33c1d97fb203c82291b8a61269e85d3b">github.com/ruby/openssl/commit/1648afef33c1d97fb203c82291b8a61269e85d3b</a></p>

<p>Sat Sep  9 22:57:24 2017  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/json: bump to version 1.8.3.1. [Backport #13853]</p>

<p>Sat Sep  9 22:50:10 2017  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	A HTTP Header value must not contain CR or LF. 	to_str -&gt; to_s</p>

<p>	* lib/net/http/header.rb (set_field): <code>val</code> can not have <code>to_str</code>.</p>

<p>Sat Sep  9 22:42:22 2017  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* REXML: Fix a bug that unexpected methods can be called as a XPath 	  function. [HackerOne:249295] Reported by Andrea Jegher. Thanks!!!</p>

<p>Sat Sep  9 22:16:01 2017  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: fix several vulnerabilities in RubyGems; bump to version 	  2.5.2.1. [Backport #13842]</p>

<p>Wed Aug  9 22:27:23 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_syntax.rb (test_invalid_<code>break,next</code>): use 	  assert_in_out_err instead of assert_syntax_error because on ruby_2_3 	  assert_syntax_error uses eval.</p>

<p>Wed Aug  9 22:27:23 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each0): turned dregx context in “once” 	  into “guarded” type from “block” type, to disallow <code>next</code>, 	  <code>break</code>, <code>redo</code> as well as outside “once”. 	  [Bug #13690]</p>

<p>Wed Aug  9 21:28:34 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_process.rb (test_rlimit_<code>name,value</code>): test in UTF-8 	  encoding.  fix test failures introduced at r59531 on some platforms.</p>

<p>Wed Aug  9 21:16:22 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* marshal.c (rb_marshal_dump_limited): do not free dump_arg, which 	  may be dereferenced in check_dump_arg due to continuation, and 	  get rid of dangling pointers.</p>

<p>	* marshal.c (rb_marshal_load_with_proc): ditto for load_arg.</p>

<p>Wed Aug  9 21:13:24 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): remove unused definition of unused 	  variable derived from original patch.</p>

<p>Wed Aug  9 19:45:16 2017  sorah (Shota Fukumori)  &lt;her@sorah.jp&gt;</p>

<p>	Init_frozen_strings definition is removed in r51511. 	<a href="https://bugs.ruby-lang.org/issues/11423">bugs.ruby-lang.org/issues/11423</a></p>

<p>	Patch by Kohei Suzuki &lt;eagletmt@gmail.com&gt;</p>

<p>	* internal.h: Remove declaration of unexist function 	  [Fix GH-1558]</p>

<p>Wed Aug  9 19:34:17 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* internal.h (THROW_DATA_P): parenthesize the argument which is 	  casted.</p>

<p>Wed Aug  9 19:34:17 2017  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c: get return_value from imemo_throw_data object (THROW_DATA_VAL()). 	  imemo_throw_data (TAG_BREAK) contains returned value. 	  However, imemo_throw_data (TAG_BREAK) can skip several frames so that 	  we need to use it only once (at most internal frame). To record it, 	  we introduced THROW_DATA_CONSUMED and check it.</p>

<p>	* internal.h: define THROW_DATA_CONSUMED flag.</p>

<p>	* test/ruby/test_settracefunc.rb: add tests for [Bug #13369]</p>

<p>	* vm_insnhelper.h: add THROW_DATA_CONSUMED_P() and 	  THROW_DATA_CONSUMED_SET().</p>

<p>Wed Aug  9 19:32:17 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* random.c (get_rnd, try_get_rnd): ensure initialized to get rid 	  of crash in forked processes. [Bug #13753]</p>

<p>Wed Aug  9 19:30:34 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/strscan/strscan.c (strscan_aref): fix segfault after 	  get_byte or getch which do not apply regexp. 	  [Bug #13759]</p>

<p>Wed Aug  9 19:28:40 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in: add rpath flags which is needed for OPTDIR as well 	  as -L options, when it is given. [Bug #13411]</p>

<p>Wed Aug  9 19:14:07 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_insnhelper.c (vm_throw_start): size of catch table has been 	  included in iseq_catch_table struct, which could be NULL, since 	  2.2. e.g., proc-closure in `once&#39;. </p>

<p>Wed Aug  9 19:09:20 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* node.h (nd_line): should sign-extend.  shifting <code>VALUE</code> extends 	  with zero bits if <code>sizeof(VALUE)</code> equals to <code>sizeof(int)</code>.  the 	  zero bits are truncated if <code>sizeof(VALUE)</code> is bigger enough. 	  [ruby-core:80920] [Bug #13523]</p>

<p>Wed Aug  9 17:53:09 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): the lifetime of new_opt have to be 	  until this case block is end.  this is a part of r57971. 	  [Backport #13766]</p>

<p>Wed Aug  9 17:35:47 2017  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	this patch contains r54158, r57410, r57631 and r57954.</p>

<p>	Prevent GC by volatile [Bug #13150]</p>

<p>	test/ruby/test_marshal.rb test_context_switch (load) and test_gc (dump) 	are failed on FreeBSD 10.3 and gcc7 (FreeBSD Ports Collection) 7.0.0 	20170115 (experimental); RB_GC_GUARD looks not worked well.</p>

<p>	* include/ruby/ruby.h (RB_GC_GUARD): prevent guarded pointer from 	  optimization by using as an input to inline asm.</p>

<p>	* ruby.h: remove comment</p>

<p>	* include/ruby/ruby.h (RB_GC_GUARD): remove comment unsupported by 	  Solaris AS.</p>

<p>	Hidden objects (klass == 0) are not visible to Ruby code invoked 	from other threads or signal handlers, so they can never be 	accessed from other contexts.  This makes it safe to call 	rb_gc_force_recycle on the object slot after releasing malloc 	memory.</p>

<p>	* marshal.c (rb_marshal_dump_limited): hide dump_arg and recycle when 	  done (rb_marshal_load_with_proc): hide load_arg and recycle when done 	  [ruby-core:79518]</p>

<p>	* marshal.c (rb_marshal_dump_limited): do not free dump_arg, which 	  may be dereferenced in check_dump_arg due to continuation, and 	  get rid of dangling pointers.</p>

<p>	* marshal.c (rb_marshal_load_with_proc): ditto for load_arg.</p>

<p>Wed Aug  9 17:28:35 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* eval.c (setup_exception): make unfrozen copy of special 	  exception before setting up a cause.</p>

<p>Wed Aug  9 17:22:29 2017  TAKANO `takano32&#39; Mitsuhiro  &lt;tak@no32.tk&gt;</p>

<p>	a64: fix crash on register stack mark/sweep pass</p>

<p>	* thread_pthread.c: move &#39;register_stack_start&#39; earlier. 	  [ruby-core:79928] [Bug #13284] [Fix GH-1625]</p>

<p>	Author:    Sergei Trofimovich &lt;slyfox@gentoo.org&gt;</p>

<p>Wed Aug  9 17:10:27 2017  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* test/net/smtp/test_smtp.rb (test_tls_connect, test_tls_connect): 	  use Socket.tcp_server_sockets in case localhost is resolved to ::1.</p>

<p>Wed Aug  9 17:10:27 2017  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/smtp.rb (tlsconnect): support timeout for TLS handshake. 	  [ruby-core:76893] [Bug #12678]</p>

<p>	* lib/net/protocol.rb (ssl_socket_connect): new method to implement 	  timeout for TLS handshake.</p>

<p>	* lib/net/http.rb (connect): use Net::Protocol#ssl_socket_connect.</p>

<p>Wed Aug  9 17:08:01 2017  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	Zlib::GzipReader#pos underflows after calling #ungetbyte or #ungetc at start of file [Bug #13616]</p>

<p>	patched by Andrew Haines &lt;andrew@haines.org.nz&gt; [ruby-core:81488] 	zlib.c: fix unnormalized Fixnum</p>

<p>	* ext/zlib/zlib.c (rb_gzfile_total_out): cast to long not to 	  result in an unsigned long to normalized to Fixnum on LLP64 	  platforms.  [ruby-core:81488]</p>

<p>Wed Aug  9 17:03:00 2017  Eric Wong  &lt;normalperson@yhbt.net&gt;</p>

<p>	process.c: handle dynamic :rlimit_* symbols in spawn execopts</p>

<p>	* process.c (rb_execarg_addopt_rlimit): hoist out of rb_execarg_addopt 	  (rlimit_type_by_sym): new wrapper for dynamic symbol 	  (rb_execarg_addopt): check for dsym via rlimit_type_by_sym 	* test/ruby/test_process.rb (test_execopts_rlimit): check dsym w/o pindown 	  Add extra check for bogus rlimit args, too. 	  [ruby-core:82033] [Bug #13744] 	process.c: null bytes</p>

<p>	* process.c (rlimit_type_by_sym): prohibit null bytes in key 	  names.  [ruby-core:82033] [Bug #13744]</p>

<p>Wed Aug  9 16:56:52 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	optparse.rb: get rid of eval</p>

<p>	* lib/optparse.rb: try Float() and Integer() instead of eval, 	  which does too much things.</p>

<p>Fri Jul  7 10:58:10 2017  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	This backport of r58812 is necessary to ease backporting r59028, 	which fixes a real bug.</p>

<p>	* thread.c (struct waiting_fd): declare 	  (rb_thread_io_blocking_region): use on-stack list waiter 	  (rb_notify_fd_close): walk vm-&gt;waiting_fds instead 	  (call_without_gvl): remove old field setting 	  (th_init): ditto 	  [Feature #9632]</p>

<p>	* vm_core.h (typedef struct rb_vm_struct): add waiting_fds list</p>

<p>	* (typedef struct rb_thread_struct): remove waiting_fd field 	  (rb_vm_living_threads_init): initialize waiting_fds list</p>

<p>	This should fix bad interactions with test_race_gets_and_close 	in test/ruby/test_io.rb since we ensure rb_notify_fd_close 	continues returning the busy flag after enqueuing the interrupt.</p>

<p>	* thread.c (rb_notify_fd_close): do not enqueue multiple interrupts 	  [ruby-core:81581] [Bug #13632]</p>

<p>	* test/ruby/test_io.rb (test_single_exception_on_close): 	  new test based on script from Nikolay</p>

<p>Wed Jul  5 15:55:35 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_cipher.c: remove the encryption key initialization 	  from Cipher#initialize. This is effectively a revert of r32723 	  (“Avoid possible SEGV from AES encryption/decryption”, 2011-07-28). 	  the patch is derived from <a href="https://github.com/ruby/openssl/commit/8108e0a6db133f3375608303fdd2083eb5115062">github.com/ruby/openssl/commit/8108e0a6db133f3375608303fdd2083eb5115062</a>, 	  written by Kazuki Yamaguchi. 	  [Backport #8221]</p>

<p>Sat Jul  1 00:28:22 2017  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/psych/yaml: update libyaml to 0.1.7.</p>

<p>	* ext/psych/psych.gemspec: bump version to 2.1.0.1.</p>

<p>Fri Jun 30 22:05:39 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_precise_mbclen): check invalid multibyte char at 	  skipping strings following ?x literal string, not to stuck in a 	  infinite loop. [Bug #13672]</p>

<p>Fri Jun 30 22:00:56 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/pathname/lib/pathname.rb (Pathname#plus): UNC root pathname needs 	  a separator. File.basename returns “/” on UNC root, as well as sole 	  drive letter, even if it does not end with a separator. [Bug #13515]</p>

<p>Fri Jun 30 21:57:27 2017  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* lib/rexml/parsers/streamparser.rb: add close tag check on end of 	  document to StreamParser [Bug #13636] 	  Reported by Anton Sivakov. Thanks!!!</p>

<p>Fri Jun 30 21:54:01 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_insert): check position to insert even if no elements 	  to be inserted. [Bug #13558]</p>

<p>Fri Jun 30 21:51:40 2017  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* ext/date/date_core.c: [DOC] fix documentation for %Z format of 	  <code>Date,DateTime</code>.strftime. 	  Reported by Damon Timm. Based on a patch by nano. 	  [Bug #13231] [Fix GH-1565]</p>

<p>Fri Jun 30 21:46:50 2017  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* lib/rss/rss.rb: Accept empty text element as valid element 	  Parser has been accepted it but XML serializer wasn&#39;t accepted. 	  Reported by stefano frabetti. Thanks!!! 	  [Bug #13531]</p>

<p>Fri Jun 30 21:40:42 2017  Kazuki Yamaguchi &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl_x509store.c: clear error queue after calling 	  X509_LOOKUP_load_file()</p>

<p>	  X509_LOOKUP_load_file(), which ends up calling 	  X509_load_cert_crl_file() 	  internally, may leave error entries in the queue even when it returns 	  non-zero value (which indicates success).</p>

<p>	  This will be fixed by OpenSSL 1.1.1, but can be worked around by 	  clearing the error queue ourselves.</p>

<p>	  Fixes: [Backport #11033]</p>

<p>Fri Jun 30 21:35:16 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.c (heap_page_allocate): expand sorted pages before inserting 	  allocated new page. [Bug #12670]</p>

<p>Fri Jun 30 21:33:39 2017  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (heap_page_resurrect): do not return tomb_pages when 	  page-&gt;freelist == NULL. 	  [Bug #12670]</p>

<p>Fri Jun 30 21:23:20 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vsnprintf.c (BSD_vfprintf): sign and hex-prefix should not be counted 	  in precision. [Bug #8916]</p>

<p>Fri Jun 30 21:20:14 2017  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* thread.c (ruby_thread_stack_overflow): disable VM events when stack 	  overflow occurred; it causes another stack overflow again in making 	  backtrace object, and crashes. [Bug #13425]</p>

<p>	* vm.c (hook_before_rewind): skip rewind hooks if err is 	  SystemStackError because rewind hooks can cause stack overflow again 	  and again.</p>

<p>	* thread.c (ruby_thread_stack_overflow): do not disable all hooks. 	  Additionally, clearing ruby_vm_event_flags is not suitable way 	  to disable hooks.</p>

<p>Fri Jun 30 21:13:25 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (method_super_method): skip prepended modules and continue from 	  the super class of the original class. [Bug #13656]</p>

<p>Fri Jun 30 21:10:48 2017  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/smtp.rb (getok, get_response): raise an ArgumentError when 	  CR or LF is included in a line, because they are not allowed in 	  RFC5321.  Thanks, Jeremy Daer.</p>

<p>Fri Jun 30 21:07:56 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* eval.c (exc_setup_cause): need to unfreeze(=dup) the exception before 	  setting cause if its frozen.</p>

<p>Fri Jun 30 21:07:14 2017  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	thread.c: avoid busy looping on rb_thread_fd_close</p>

<p>	We no longer use it this function, but extensions do, and 	we need to ensure it continues to work for them.</p>

<p>	* thread.c (rb_thread_fd_close): schedule other threads in loop</p>

<p>	* ext/-test-/thread_fd_close/thread_fd_close.c: new file</p>

<p>	* ext/-test-/thread_fd_close/depend: ditto</p>

<p>	* ext/-test-/thread_fd_close/extconf.rb: ditto</p>

<p>	* test/-ext-/thread_fd_close/test_thread_fd_close.rb: new test</p>

<p>Fri Jun 30 20:34:49 2017  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* sample/pty/shl.rb: update sample 	  * Specify frozen_string_literal: true. 	  * Fix TypeError of raise. 	  * Use a character literal instead of Integer.</p>

<p>Fri Jun 30 20:31:59 2017  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* string.c: [DOC] clarify docs for String#split when called with limit 	  and capture groups. Reported by Cichol Tsai. [Bug #13621]</p>

<p>Fri Jun 30 20:23:31 2017  Takashi Kokubun  &lt;takashikkbn@gmail.com&gt;</p>

<p>	* lib/erb.rb: Allow explicit trimming carriage return when trim_mode is 	  “-”, for Windows environments. [Bug #5339]</p>

<p>	* lib/erb.rb: Allow trimming CR in all trim_modes to unify a behavior 	  with r58823 and r58825.</p>

<p>Fri Jun 30 20:16:15 2017  Takashi Kokubun  &lt;takashikkbn@gmail.com&gt;</p>

<p>	* lib/erb.rb: Allow trimming carriage return when trim_mode is “&lt;&gt;”, for 	  Windows environments. [Bug #11464]</p>

<p>Fri Jun 30 20:07:37 2017  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* util.c (ruby_strtod) Merge latest dtoa.c [Bug #13545] 	  Apply some part of <a href="http://www.netlib.org/fp/dtoa.c">www.netlib.org/fp/dtoa.c</a> with my eyes…</p>

<p>Fri Jun 30 20:00:18 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (is_case_sensitive): use getattrlist() if fgetattrlist() is 	  unavailable, on OSX 10.5. [Bug #11054]</p>

<p>Fri Jun 30 19:58:16 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/mkconfig.rb (RbConfig): prefix SDKROOT to oldincludedir 	  not includedir, the latter is outside the ruby installation. 	  [ruby-core:72496] [Bug #11881]</p>

<p>Fri Jun 30 19:56:06 2017  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (check_autoload_required): do not assume a provided feature 	  means autoload is complete, always wait if autoload is being performed 	  by another thread. [Bug #11384] Thanks to s.wanabe@gmail.com</p>

<p>Fri Jun 30 19:53:30 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (obj2uid, obj2gid): use temporary string as the buffer 	  instead of rb_alloc_tmp_buffer, which is NODE_ALLOCA since r51492. 	  [Bug #13554]</p>

<p>Fri Jun 30 19:50:25 2017  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (autoload_reset): use idempotent list_del_init</p>

<p>	* variable.c (autoload_sleep): moved code from rb_autoload_load</p>

<p>	* variable.c (autoload_sleep_done): cleanup for use with rb_ensure</p>

<p>	* variable.c (rb_autoload_load): ensure list delete happens in case the 	  thread dies during sleep</p>

<p>	* test/ruby/bug-13526.rb: new script for separate execution</p>

<p>	* test/ruby/test_autoload.rb (test_bug_13526): new test [Bug #13526]</p>

<p>Fri Jun 30 19:46:46 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* sprintf.c (rb_str_format): while “% 2f” and “% 4f” result in “ Inf” 	  and “ Inf” respectively, “% 3f” results in “Inf” (no space).</p>

<p>	* sprintf.c (rb_str_format): as for non-finite float, calculate the 	  exact needed size with the space flag.</p>

<p>Fri Jun 30 19:41:48 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread_win32.c (w32_wait_events): do not acquire GVL, to fix deadlock 	  at read/close race condition. instead, just ignore interrupt_event if 	  it is closed.</p>

<p>	* thread_win32.c (w32_wait_events): fix wait object index in the case of 	  interrupt_event is not usable.</p>

<p>Fri Jun 30 19:37:47 2017  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* io.c (nogvl_wait_for_single_fd): nogvl_wait_for_single_fd must wait 	  as its name. 	  poll(fds, n, 0) mean no timeout and immediately return. If you want to 	  wait something, you need to use -1 instead.</p>

<p>Fri Jun 30 19:35:31 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* class.c (Init_class_hierarchy): prevent rb_cObject which is the class 	  tree root, from GC. [Bug #12492]</p>

<p>Fri Jun 30 19:32:52 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* class.c (Init_class_hierarchy): prevent rb_cObject which is the 	  class tree root, from GC.  [ruby-dev:49666] [Bug #12492]</p>

<p>Fri Jun 30 19:29:45 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/ripper/lib/ripper/lexer.rb (on_heredoc_dedent): fix for nested 	  indedented here documents, where Elems are nested too. [Bug #13536]</p>

<p>	* ext/ripper/lib/ripper/lexer.rb (on_heredoc_dedent): insert stripped 	  leading spaces as on_ignored_sp elements, so that the original source 	  can be reconsructed. [Bug #13536]</p>

<p>Mon May  1 06:36:57 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_parse_string): set the mark of term to <code>nd_func</code> 	  because in this version <code>u2.id</code> is not used for this purpose. 	  fixed failure of ruby/spec introduced at r58518. 	  see also [Backport #13363]</p>

<p>Sun Apr 30 23:01:00 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	class.c: ensure_includable</p>

<p>	* class.c (ensure_includable): extract checks to include and 	  prepend.</p>

<p>	class.c: prohibit refinement module</p>

<p>	* class.c (ensure_includable): cannot include refinement 	  module, or the type and the class do not match. 	  [ruby-core:79632] [Bug #13236]</p>

<p>Sun Apr 30 22:55:41 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	keep line number after unterminated string literal</p>

<p>	* parse.y (parser_parse_string): keep line number even after an 	  unterminated string literal.  it does not matter in the parser, 	  ripper needs this value after this error.</p>

<p>	parse.y: unterminated content token</p>

<p>	* parse.y (parser_parse_string): defer the end token to next 	  reading, to yield tSTRING_CONTENT with the unterminated content. 	  [Bug #13363]</p>

<p>Sun Apr 30 22:52:38 2017  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* io.c: [DOC] expand docs for IO#puts 	  [Bug #13306]</p>

<p>Sun Apr 30 22:38:44 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	sample/pty/shl.rb: update [ci skip]</p>

<p>	* sample/pty/shl.rb: stop writer loop when the child exited. 	  PTY::ChildExited no longer raises asynchronously since r20298. 	  [ruby-dev:49974] [Bug #13191]</p>

<p>	* sample/pty/shl.rb: use io/console instead of stty. 	  [ruby-dev:49974] [Bug #13191]</p>

<p>	* sample/pty/shl.rb: do not manage array length separately. 	  [ruby-dev:49974] [Bug #13191]</p>

<p>	* sample/pty/shl.rb: leap exited child process. 	  [ruby-dev:49974] [Bug #13191]</p>

<p>Sun Apr 30 22:35:10 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	configure.in: use AC_SEARCH_LIBS</p>

<p>	* configure.in (–with-gmp, –with-jemalloc): use AC_SEARCH_LIBS 	  to check if no library is required, instead of AC_CHECK_LIB. 	  [ruby-core:79368] [Bug #13175]</p>

<p>Sun Apr 30 22:24:25 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* numeric.c (flo_round): [EXPERIMENTAL] adjust the case that the 	  receiver is close to the exact but unrepresentable middle value 	  of two values in the given precision. 	  <a href="http://d.hatena.ne.jp/hnw/20160702">d.hatena.ne.jp/hnw/20160702</a></p>

<p>Sun Apr  9 22:21:23 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	thread.c: rb_thread_fd_close [ci skip]</p>

<p>	* thread.c (rb_thread_fd_close): re-define because of a couple of 	  external libraries used it.</p>

<p>Wed Mar 29 23:47:31 2017  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* hash.c (any_hash): fix CI failure on L32LLP64 architecture. 	  The patch was provided by usa. [ruby-core:80484] [Bug #13376]</p>

<p>Wed Mar 29 06:22:27 2017  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* hash.c (any_hash): fix Symbol#hash to be nondeterministic. 	  The patch was provided by Eric Wong. [ruby-core:80433] [Bug #13376]</p>

<p>	* test/ruby/test_symbol.rb: add test for above.</p>

<p>Tue Mar 28 00:38:39 2017  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (poll_child_status): rb_w32_wait_events_blocking() sets 	  errno internally, then should not set it here.</p>

<p>Mon Mar 27 20:15:17 2017  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* eval.c, method.h, proc.c, vm.c, vm_eval.c, vm_insnhelper.c, vm_method.c: 	  TracePoint#method_id should return method_id, not callee_id. 	  [ruby-core:77241] [Feature #12747]</p>

<p>	* test/ruby/test_settracefunc.rb: change accordingly.</p>

<p>Mon Mar 27 20:12:23 2017  Anton Davydov  &lt;mail@davydovanton.com&gt;</p>

<p>	* lib/uri/mailto.rb: Removed needless <code>return</code> and use `.“ instead of <code>root</code> 	  with class method. 	* test/uri/test_mailto.rb: Added tests for coverage.</p>

<p>Mon Mar 20 06:35:08 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby.c (process_options): convert -e script to the encoding 	  given by a command line option on Windows.  assume it is the 	  expected encoding.  [ruby-dev:49461] [Bug #11900]</p>

<p>Mon Mar 20 05:47:49 2017  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/ruby/test_exception.rb: fix thread issues. 	  * use Queue instead of a local variable for synchronization. 	  * join created thread to soleve leaking threads warning.</p>

<p>Mon Mar 20 05:47:49 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_threadptr_raise): set cause from the called thread, 	  but not from the thread to be interrupted. 	  [ruby-core:77222] [Bug #12741]</p>

<p>Wed Feb  8 02:17:02 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/forwardable.rb (Forwardable._delegator_method): extract 	  method generator and deal with non-module objects. 	  [ruby-dev:49656] [Bug #12478]</p>

<p>Wed Feb  8 02:17:02 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/forwardable.rb (def_instance_delegator): adjust backtrace of 	  method body by tail call optimization.  adjusting the delegated 	  target is still done by deleting backtrace.</p>

<p>	* lib/forwardable.rb (def_single_delegator): ditto.</p>

<p>Tue Jan 17 03:51:48 2017  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (setup_args): duplicate splatting array if more 	  arguments present to obey left-to-right execution order. 	  [ruby-core:77701] [Bug# 12860]</p>

<p>Thu Nov 24 05:47:18 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* test/fileutils/test_fileutils.rb (TestFileUtils#setup): Use primary 	  group as well as supplementary groups. 	  based on the patch by Vit Ondruch at [Bug #12910]</p>

<p>Thu Nov 24 05:44:04 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_dir_m17n.rb: Don&#39;t encode to UTF-8 if it&#39;s unnecessary. 	  If the file system encoding is ISO-8851-1 or if the encoding of the 	  target string is invalid, don&#39;t encode to UTF-8. [Bug#12972]</p>

<p>Mon Nov 21 16:55:15 2016  boshan  &lt;boshan@subsplash.com&gt;</p>

<p>	* lib/tempfile.rb (Tempfile#initialize): [DOC] the first parameter 	  <code>basename</code> is optional and defaulted to an empty string since 	  [GH-523].  [Fix GH-1225]</p>

<p>Sat Nov 19 14:06:07 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* iseq.c (proc_dup): don&#39;t duplicate sym_procs.  [Fix GH-1479] 	  [ruby-core:78100] [Bug #12927] 	  Based on the patch provided by Emiliano Ritiro.</p>

<p>Sat Nov 19 11:48:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* iseq.c (iseqw_s_compile_file): deal with syntax error as well as 	  compile, and should not abort when rescued.</p>

<p>Wed Nov 16 23:40:29 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (vm_call0_body): refined module should not be skipped as 	  prepended. [Bug #12920]</p>

<p>Tue Nov 15 03:14:02 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/-test/file/fs.c (get_atime_p): Updating of file access times 	  is enabled or not.</p>

<p>Tue Nov 15 03:14:02 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_file.rb (TestFile#test_stat): fix noatime case. 	  [ruby-core:77943] [Bug #12903]</p>

<p>Tue Nov 15 03:09:39 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* test/rinda/test_rinda.rb (test_make_socket_ipv6_multicast, 	  test_make_socket_ipv6_multicast_hops): skip if IPv6 multicast  	  address is not available.</p>

<p>Tue Nov 15 02:49:30 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (vm_call0_body): follow the original class, not to 	  loop the prepended module.  [ruby-core:77784] [Bug #12876]</p>

<p>Tue Nov 15 02:45:44 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/net/http.rb (transport_request): other than HTTPContinue 	  in 1xx (HTTPInformation) also needs to continue. [Bug #12890]</p>

<p>Sat Nov 12 01:05:45 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* object.c: Improve documentation for Float conversion. 	  [ruby-core:71661][Bug #11736][ci skip]</p>

<p>Sat Nov 12 00:50:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (mnew_internal): follow the original class, not to loop 	  the prepended module.  [ruby-core:77591] [Bug #12832]</p>

<p>Sat Nov 12 00:46:50 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* cont.c (cont_new): disable optimization if clang&#39;s version is 	  3.8.0.  [ruby-core:77894] [Bug #12893]</p>

<p>Sat Nov 12 00:27:24 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): enable tail call 	  optimization inside a conditional block.</p>

<p>Sat Nov  5 11:53:17 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (copy_stream_body): use IO to write to copy to duplex IO. 	  <a href="http://twitter.com/knu/status/786505317974585344">twitter.com/knu/status/786505317974585344</a></p>

<p>Sat Nov  5 11:49:41 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* sprintf.c (rb_str_format): format exact number more exactly.</p>

<p>Sat Nov  5 11:45:32 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl.c (Init_openssl): register an ex_data index for 	  X509_STORE and X509_STORE_CTX respectively. Since they don&#39;t share 	  the ex_data index registry, we can&#39;t use the same index. 	  (ossl_verify_cb): use the the correct index.</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_verify_callback): ditto.</p>

<p>	* ext/openssl/ossl_x509store.c (ossl_x509store_set_vfy_cb): ditto. 	  (ossl_x509stctx_verify): ditto.</p>

<p>	* ext/openssl/ossl.h (void ossl_clear_error): add extern declarations 	  of ossl_store_<code>ctx_,</code>ex_verify_cb_idx.</p>

<p>	* ext/openssl/openssl_missing.c: remove X509_STORE_set_ex_data and 	  X509_STORE_get_ex_data.</p>

<p>	* ext/openssl/openssl_missing.h: implement X509_STORE_get_ex_data, 	  X509_STORE_set_ex_data and X509_STORE_get_ex_new_index as macros.</p>

<p>Sat Nov  5 11:35:58 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_pending_interrupt_p): no pending interrupt 	  before initialization.</p>

<p>	* thread.c (thread_raise_m, rb_thread_kill): uninitialized thread 	  cannot interrupt.  [ruby-core:72732] [Bug #11959]</p>

<p>Sat Nov  5 11:16:58 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c: Import changes from ruby/bigdecimal 	  repository.</p>

<p>Tue Oct 18 02:58:22 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* eval_intern.h (TH_PUSH_TAG): Initialize struct rb_vm_tag::tag with 	  Qundef rather than 0 which is equal to Qfalse. Since Kernel#throw(obj) 	  searches a tag with rb_vm_tag::tag == obj, throw(false) can 	  accidentally find an unrelated tag which is not created by 	  Kernel#catch.  [ruby-core:77229] [Bug #12743]</p>

<p>	* test/ruby/test_exception.rb (test_throw_false): Add a test case for 	  this.</p>

<p>Tue Oct 18 02:24:29 2016  Aurelien Jacobs  &lt;aurel@gnuage.org&gt;</p>

<p>	* lib/logger.rb (Logger::Period#next_rotate_time): fix monthly log 	  rotate when DST is applied during a month of 31 days. 	  [Fix GH-1458]</p>

<p>Wed Oct 12 22:31:09 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* tool/downloader.rb: Removed verification of gem certification. 	  Because signed gem is not working on rubygems ecosystem. 	* tool/gem-unpack.rb: ditto.</p>

<p>Fri Oct  7 02:48:06 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/ssl_certs/GlobalSignRootCA.pem: add for RugyGems.org.</p>

<p>Mon Sep 26 23:51:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* variable.c (rb_const_search): raise with the actual class/module 	  name which defines the private constant.</p>

<p>Mon Sep 26 23:34:09 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl_pkcs12.c (ossl_pkcs12_initialize): pop errors 	  leaked by PKCS12_parse(). This is a bug in OpenSSL, which exists 	  in the versions before the version 1.0.0t, 1.0.1p, 1.0.2d.</p>

<p>Mon Sep 26 23:10:43 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* vm_dump.c (backtrace): use rip in the saved context for the case 	  the SIGSEGV is received when the process is in userland. 	  Note that ip in the stack should be used if the signal is received 	  when it is in kernel (when it is calling syscall) [Bug #12711]</p>

<p>Mon Sep 26 20:23:32 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: update minitest to 5.8.5.</p>

<p>	* tool/downloader.rb: revert workarounds.</p>

<p>	* tool/gem-unpack.rb: ditto.</p>

<p>Mon Sep 26 07:26:44 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* tool/gem-unpack.rb: don&#39;t set security policy. 	  workaround for certificate expiration of minitest-5.8.3.gem.</p>

<p>Mon Sep 26 06:33:16 2016  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* lib/uri/generic.rb (def check_password): don&#39;t include bad password 	  in URI exception output</p>

<p>	* test/uri/test_generic.rb (def test_set_component): test for behavior</p>

<p>Mon Sep 26 06:20:58 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* tool/downloader.rb: comment out gem package verification. 	  workaround for certificate expiration of minitest-5.8.3.gem.</p>

<p>Sun Sep 25 16:37:22 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* io.c (nogvl_fsync, nogvl_fdatasync): on Windows, just ignore if the 	  fd is associated to non-disk device.  if call fsync and/or fdatasync 	  with such fds, it causes Errno::EBADF exception and the behavior is 	  incompatible with ruby 2.1 and earlier unintentionally introduced.</p>

<p>Sun Sep 25 15:09:04 2016  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* array.c (flatten): use rb_obj_class instead of rb_class_of 	  because rb_class_of may return a singleton class. 	  [ruby-dev:49781] [Bug #12738]</p>

<p>Sun Sep 25 15:07:19 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* man/irb.1: remove useless -width option. 	  [ruby-dev:49767] [Bug #12692]</p>

<p>Tue Aug 30 05:24:33 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl_x509ext.c: additional fix memory leak. 	  [ruby-core:76922] [Bug #12680]</p>

<p>	* text/openssl/test_x509ext.rb: test for above.</p>

<p>Sun Aug 28 00:26:58 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* vm_method.c: revert r55869. it breaks Integer#days with 	  ActiveSupport-4.1.x. [ruby-core:76949] [Bug #12353]</p>

<p>	* test/ruby/test_marshal.rb: ditto.</p>

<p>Sat Aug 27 03:51:23 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* id_table.c (hash_table_extend): should not shrink the table than 	  the previous capacity.  [ruby-core:76534] [Bug #12614]</p>

<p>Sat Aug 27 03:37:49 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl_config.c: fix memory leak. 	  [ruby-core:76922] [Bug #12680]</p>

<p>	* ext/openssl/ossl_ocsp.c: ditto.</p>

<p>	* ext/openssl/ossl_pkcs12.c: ditto.</p>

<p>	* ext/openssl/ossl_pkcs7.c: ditto.</p>

<p>	* ext/openssl/ossl_pkey_ec.c: ditto.</p>

<p>	* ext/openssl/ossl_x509.h: ditto.</p>

<p>	* ext/openssl/ossl_x509attr.c: ditto.</p>

<p>	* ext/openssl/ossl_x509crl.c: ditto.</p>

<p>	* ext/openssl/ossl_x509ext.c: ditto.</p>

<p>	* ext/openssl/ossl_x509req.c: ditto.</p>

<p>	* ext/openssl/ossl_x509revoked.c: ditto.</p>

<p>Thu Aug 25 00:19:24 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/specification.rb: <code>coding</code> is affect only first line except 	  shebang. 	* lib/rubygems/package.rb, lib/rubygems/package/*: ditto.</p>

<p>Thu Aug 25 00:19:24 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems.rb, lib/rubygems/*, test/rubygems/*: Update rubygems-2.5.2. 	  It supports to enable frozen string literal and add <code>–norc</code> option for 	  disable to <code>.gemrc</code> configuration. 	  See 2.5.2 release notes for other fixes and enhancements. 	  <a href="https://github.com/rubygems/rubygems/blob/a8aa3bac723f045c52471c7b9328310a048561e0/History.txt#L3">github.com/rubygems/rubygems/blob/a8aa3bac723f045c52471c7b9328310a048561e0/History.txt#L3</a></p>

<p>Wed Aug 24 23:54:40 2016  Charles Oliver Nutter  &lt;headius@headius.com&gt;</p>

<p>	* test/ruby/test_array.rb: split out the test for no stack error 	  on large input for test_permutation, test_repeated_permutation, 	  and test_repeated_combination, and make them all timeout:30.</p>

<p>Tue Aug 23 03:22:34 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/fiddle/test_pointer.rb (test_to_str, test_to_s, test_aref_aset): 	  Attempt to use independent strings for destructive tests that 	  directly modify values on memory by using Fiddle::Pointer. 	  [Bug #12537] [ruby-dev:49700]</p>

<p>Tue Aug 23 03:14:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* string.c (str_buf_cat): Fix capa size for embed string. 	  Fix bug in r55547. [Bug #12536]</p>

<p>Tue Aug 23 03:14:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* string.c (rb_str_change_terminator_length): New function to change 	  termlen and resize heap for the terminator. This is split from 	  rb_str_fill_terminator (str_fill_term) because filling terminator 	  and changing terminator length are different things. [Bug #12536]</p>

<p>	* internal.h: declaration for rb_str_change_terminator_length.</p>

<p>	* string.c (str_fill_term): Simplify only to zero-fill the terminator. 	  For non-shared strings, it assumes that (capa + termlen) bytes of 	  heap is allocated. This partially reverts r55557.</p>

<p>	* encoding.c (rb_enc_associate_index): rb_str_change_terminator_length 	  is used, and it should be called whenever the termlen is changed.</p>

<p>	* string.c (str_capacity): New static function to return capacity 	  of a string with the given termlen, because the termlen may 	  sometimes be different from TERM_LEN(str) especially during 	  changing termlen or filling terminator with specific termlen.</p>

<p>	* string.c (rb_str_capacity): Use str_capacity.</p>

<p>Tue Aug 23 03:14:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* string.c: Partially reverts r55547 and r55555. 	  ChangeLog about the reverted changes are also deleted in this file. 	  [Bug #12536] [ruby-dev:49699] [ruby-dev:49702]</p>

<p>Tue Aug 23 03:14:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* string.c (str_fill_term): When termlen increases, re-allocation 	  of memory for termlen should always be needed. 	  In this fix, if possible, decrease capa instead of realloc. 	  [Bug #12536] [ruby-dev:49699]</p>

<p>Tue Aug 23 03:14:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* string.c: Specify termlen as far as possible. 	  Additional fix for [Bug #12536] [ruby-dev:49699].</p>

<p>	* string.c (str_new_static): Specify termlen from the given encoding 	  when creating a new String object is needed.</p>

<p>	* string.c (rb_tainted_str_new_with_enc): New function to create a 	  tainted String object with the given encoding. This means that 	  the termlen is correctly specified. Currently static function. 	  The function name might be renamed to rb_tainted_enc_str_new 	  or rb_enc_tainted_str_new.</p>

<p>	* string.c (rb_external_str_new_with_enc): Use encoding by using the 	  above rb_tainted_str_new_with_enc().</p>

<p>Tue Aug 23 03:14:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* string.c (rb_str_subseq, str_substr): When RSTRING_EMBED_LEN_MAX 	  is used, TERM_LEN(str) should be considered with it because 	  embedded strings are also processed by TERM_FILL. 	  Additional fix for [Bug #12536] [ruby-dev:49699].</p>

<p>Tue Aug 23 03:14:22 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* string.c: Fix memory corruptions when using UTF-16/32 strings. 	  [Bug #12536] [ruby-dev:49699]</p>

<p>	* string.c (rb_str_new_with_class): Use TERM_LEN of the “obj”.</p>

<p>	* string.c (rb_str_plus, rb_str_justify): Use str_new0 which is aware 	  of termlen.</p>

<p>	* string.c (str_shared_replace): Copy <tt>termlen bytes instead of </tt>1.</p>

<p>	* string.c (rb_str_times): termlen should not be included in capa.</p>

<p>	* string.c (RESIZE_CAPA_TERM): When using RSTRING_EMBED_LEN_MAX, 	  termlen should be counted with it because embedded strings are 	  also processed by TERM_FILL.</p>

<p>	* string.c (rb_str_capacity, str_shared_replace, str_buf_cat): ditto.</p>

<p>	* string.c (rb_str_drop_bytes, rb_str_setbyte, str_byte_substr): ditto.</p>

<p>Thu Aug 18 23:43:33 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_write_internal): 	  avoid undefined behavior 	* test/openssl/test_pair.rb (test_write_zero): new test 	  [ruby-core:76751] [Bug #12660]</p>

<p>Thu Aug 18 23:18:17 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/option.c, ext/socket/rubysocket.h (inet_ntop): share 	  the fallback definition.  [ruby-core:76646] [Bug #12645]</p>

<p>Thu Aug 18 23:07:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm.c (vm_set_main_stack): remove unnecessary check.  toplevel 	  binding must be initialized.  [Bug #12611] (N1)</p>

<p>	* win32/win32.c (w32_symlink): fix return type.  [Bug #12611] (N3)</p>

<p>	* string.c (rb_str_split_m): simplify the condition. 	  [Bug #12611](N4)</p>

<p>Thu Aug 18 23:06:20 2016  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* lib/rexml/attribute.rb (REXML::Attribute#to_string): Fix wrong 	  entry reference name of double quote. 	  [Bug #<a href="ruby-core:76509">12609]</a> 	  Patch by Joseph Marrero. Thanks!!!</p>

<p>Thu Aug 18 23:04:59 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* thread.c (rb_wait_for_single_fd): Clean up fds.revents every time 	  before calling ppoll(2). [Bug #12575] [ruby-dev:49725]</p>

<p>Thu Aug 18 22:52:19 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* vm_args.c (setup_parameters_complex): don&#39;t raise ArgumentError 	  if an array is given for instance_exec with optional argument. 	  [ruby-core:76300] [Bug #12568] 	  <a href="https://github.com/rails/rails/pull/25699">github.com/rails/rails/pull/25699</a></p>

<p>Tue Aug 16 12:27:48 2016  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_roots): should mark the VM object itself to mark 	  singleton class of the VM object. 	  Before this patch, we only set mark bit for the VM object and 	  invoke mark function separately. 	  [Bug #12583]</p>

<p>	* test/ruby/test_gc.rb: add a test.</p>

<p>Tue Aug 16 12:01:35 2016  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* ext/digest/md5/md5ossl.h: Remove excess semicolons. 	  Suppress warning on Solaris with Oracle Solaris Studio 12. 	  [ruby-dev:49692] [Bug #12524]</p>

<p>	* ext/digest/md5/md5cc.h: ditto. 	* ext/digest/sha1/sha1cc.h: ditto. 	* ext/digest/sha1/sha1ossl.h: ditto. 	* ext/digest/sha2/sha2cc.h: ditto. 	* ext/digest/sha2/sha2ossl.h: ditto.</p>

<p>Tue Aug 16 11:51:52 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (ADD_TRACE): ignore trace instruction on non-positive 	  line.</p>

<p>	* parse.y (coverage): get rid of ArgumentError when the starting 	  line number is not positive.  [ruby-core:76141] [Bug #12517]</p>

<p>Tue Aug 16 11:51:52 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/coverage/test_coverage.rb: ignored test when enabled to coverage. 	  It lead to crash with `make test-all`.</p>

<p>Tue Aug 16 11:46:07 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/uri/mailto.rb (initialize): RFC3986_Parser#split sets opaque 	  only if the URI has path-rootless, not path-empty. 	  [ruby-core:76055] [Bug #12498] 	  patched by Chris Heisterkamp &lt;cheister@squareup.com&gt;</p>

<p>Tue Aug 16 04:57:28 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/http/generic_request.rb (write_header): A Request-Line must 	  not contain CR or LF.</p>

<p>Tue Aug 16 04:54:12 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (putline): raise an ArgumentError when 	  CR or LF is included in a line.</p>

<p>Tue Aug 16 04:38:48 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/date/date_strftime.c (date_strftime_with_tmx): reject too 	  large precision to get rid of buffer overflow. 	  reported by Guido Vranken &lt;guido AT guidovranken.nl&gt;.</p>

<p>Tue Aug 16 04:28:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (append_fspath): normalize directory name to be appended 	  on OS X.  [ruby-core:75957] [Ruby trunk Bug#12483] 	  <a href="https://github.com/rails/rails/issues/25303#issuecomment-224834804">github.com/rails/rails/issues/25303#issuecomment-224834804</a></p>

<p>Tue Aug 16 04:16:14 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* regcomp.c (noname_disable_map): don&#39;t optimize out group 0 	  Ruby&#39;s Regexp doesn&#39;t allow normal numbered groups if the regexp 	  has named groups. On such case it optimizes out related NT_ENCLOSE. 	  But even on the case it can use g&lt;0&gt;. 	  This fix not to remove NT_ENCLOSE whose regnum is 0. 	  [ruby-core:75828] [Bug #12454]</p>

<p>Tue Aug 16 04:06:52 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* missing/crypt.c: fix size macros to use configured values 	  for platforms long is larger than 32bit. 	  [ruby-core:75792] [Bug #12446]</p>

<p>Tue Aug 16 04:03:25 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl_bn.c (try_convert_to_bnptr): Extracted from 	  GetBNPtr(). This doesn&#39;t raise exception but returns NULL on error. 	  (GetBNPtr): Raise TypeError if conversion fails. 	  (ossl_bn_eq): Implement BN#==. 	  (ossl_bn_eql): #eql? should not raise TypeError even if the argument 	  is not compatible with BN. 	  (ossl_bn_hash): Implement BN#hash.</p>

<p>	* ext/openssl/ossl_bn.c (Init_ossl_bn): Define #== and #hash.</p>

<p>	* test/openssl/test_bn.rb: Test BN#eql?, #== and #hash</p>

<p>Tue Aug 16 03:51:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* transcode.c (str_transcode0): scrub in the given encoding when 	  the source encoding is given, not in the encoding of the 	  receiver.  [ruby-core:75732] [Bug #12431]</p>

<p>Tue Aug 16 03:41:21 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl_pkey_dh.c (ossl_dh_compute_key): Check that the DH 	  has &#39;p&#39; (the prime) before calling DH_size(). We can create a DH with 	  no parameter but DH_size() does not check and dereferences NULL. 	  [ruby-core:75720] [Bug #12428]</p>

<p>	* ext/openssl/ossl_pkey_dsa.c (ossl_dsa_sign): Ditto. DSA_size() does 	  not check dsa-&gt;q.</p>

<p>	* ext/openssl/ossl_pkey_rsa.c (ossl_rsa_public_encrypt, 	  ossl_rsa_public_decrypt, ossl_rsa_private_encrypt, 	  ossl_rsa_private_decrypt): Ditto. RSA_size() does not check rsa-&gt;n.</p>

<p>Tue Aug 16 03:10:42 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* transcode.c (enc_arg, str_transcode_enc_args, econv_args): 	  remove volatile, and add GC guards in callers. 	  [ruby-core:75664] [Bug #12411]</p>

<p>Tue Aug 16 02:45:52 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/psych/*, test/psych/*: Update psych 2.1.0 	  This version fixed [Bug #<a href="ruby-core:72850">11988]</a></p>

<p>Fri Aug 12 04:15:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* common.mk (build-ext), ext/extmk.rb: use variable EXTENCS 	  different than ENCOBJS, to get rid of circular dependency. 	  build libencs when linking encodings statically. 	  [ruby-core:75618] [Bug #12401]</p>

<p>Fri Aug 12 04:04:23 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (rb_execarg_commandline): build command line string 	  from argument vector in rb_execarg. 	  [ruby-core:75611] [Bug #12398]</p>

<p>Fri Aug 12 03:30:59 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* variable.c (rb_local_constants_i): exclude private constants 	  when excluding inherited constants too.  [Bug #12345]</p>

<p>Fri Aug 12 03:00:05 2016  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>	* lib/drb/timeridconv.rb: don&#39;t use keeper thread. [Bug #12342]</p>

<p>	* test/drb/ut_timerholder.rb: ditto.</p>

<p>Fri Aug 12 02:46:37 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_stop): Don&#39;t free the SSL struct 	  here. Since some methods such as SSLSocket#connect releases GVL, 	  there is a chance of use after free if we free the SSL from another 	  thread. SSLSocket#stop was documented as “prepares it for another 	  connection” so this is a slightly incompatible change. However when 	  this sentence was added (r30090, Add toplevel documentation for 	  OpenSSL, 2010-12-06), it didn&#39;t actually. The current behavior is 	  from r40304 (Correct shutdown behavior w.r.t GC., 2013-04-15). 	  [ruby-core:74978] [Bug #12292]</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (sysclose): Update doc.</p>

<p>	* test/openssl/test_ssl.rb: Test this.</p>

<p>Thu Aug 11 01:30:29 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* ext/json/lib/*.rb: Removed some comments. Because these are unnecessary 	  class description. [ci skip][Bug #<a href="ruby-core:74835">12255]</a></p>

<p>Thu Aug 11 01:09:43 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* pack.c (pack_pack): use union instead of bare variable to ease 	  optimizations and avoid assigning x87 floating point number. 	  [ruby-core:74496] [Bug #12209]</p>

<p>	* pack.c (pack_unpack): ditto.</p>

<p>Tue Aug  2 01:34:12 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/webrick/httpservlet/cgihandler.rb (do_GET): delete HTTP_PROXY 	* test/webrick/test_cgi.rb (test_cgi_env): new test 	* test/webrick/webrick.cgi (do_GET): new endpoint to dump env 	  [ruby-core:76511] [Bug #12610]</p>

<p>Tue Aug  2 01:33:11 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_refinement.rb: skip 	  test_prepend_after_refine_wb_miss on ARM or MIPS. 	  [ruby-core:76031] [Bug #12491]</p>

<p>Sat Jul 30 12:23:29 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_args.c (vm_caller_setup_arg_block): disable symbol block 	  argument optimization when tail call optimization is enabled, 	  in order to avoid SEGV.  [ruby-core:76288] [Bug #12565]</p>

<p>Sat Jul 30 12:10:51 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (passed_block): convert passed block symbol to proc. 	  based on the patch by Daisuke Sato in [ruby-dev:49695]. 	  [Bug #12531]</p>

<p>Sat Jul 30 10:58:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_insnhelper.c (vm_throw_start): check if the iseq is symbol 	  proc, class definition should not be a symbol proc. 	  [ruby-core:75856] [Bug #12462]</p>

<p>Mon Jul 11 22:35:00 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>	* bignum.c (rb_big_hash): make it public function to be available in 	  other source files, and remove documentation comment for Bignum#hash.</p>

<p>	* bignum.c (Bignum#hash): remove its definition because it is unified 	  with Object#hash.</p>

<p>	* include/ruby/intern.h (rb_big_hash): add a prototype declaration.</p>

<p>	* hash.c (any_hash): treat Bignum values directly.</p>

<p>Sat Jul  2 04:00:50 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (tr_trans): consider terminator length and fix heap 	  overflow.  reported by Guido Vranken &lt;guido AT guidovranken.nl&gt;.</p>

<p>Sat Jul  2 03:33:28 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm.c (invoke_bmethod, invoke_block_from_c_0): revert r52104 	  partially to avoid “self has wrong type to call super in this 	  context” errors. 	  [ruby-core:72724] [Bug #11954]</p>

<p>Mon Jun 20 02:38:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/optparse.rb (OptionParser::Completion.candidate): get rid of 	  nil as key names.  [ruby-core:75773] [Bug #12438]</p>

<p>	* lib/optparse.rb (OptionParser#make_switch): char class option 	  cannot be NoArgument, default to RequiredArgument.</p>

<p>Mon Jun 20 02:25:44 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* re.c (unescape_nonascii): scan hex up to only 3 characters. 	  [Bug #12420] [Bug #12423]</p>

<p>Mon Jun 20 02:25:44 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* regparse.c (fetch_token_in_cc): raise error if given octal escaped 	  character is too big. [Bug #12420] [Bug #12423]</p>

<p>Sun Jun 19 04:29:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/missing.h (isfinite): move from numeric.c.</p>

<p>Sun Jun 19 04:29:13 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c (isfinite): get rid of a warning on 	  cygwin. [Bug #<a href="ruby-core:75691">12417]</a></p>

<p>Sun Jun 19 04:29:13 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c (isfinite): isfinite does not always 	  exist.  fixed build error on Windows introduced at r55123.</p>

<p>Sun Jun 19 04:29:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c (GetVpValueWithPrec): consider 	  non-finite float values not to raise FloatDomainError. 	  [ruby-core:75682] [Bug #12414]</p>

<p>Thu Jun 16 00:42:56 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_modify_expand): check integer overflow. 	  [ruby-core:75592] [Bug #12390]</p>

<p>Thu Jun 16 00:29:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_insnhelper.c (vm_get_ev_const): warn deprecated constant even 	  in the class context.  [ruby-core:75505] [Bug #12382]</p>

<p>Tue Jun 14 03:49:28 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* dir.c (dir_close): update RDoc for 2.3 #close change 	  [ruby-core:75679] [Bug #12413]</p>

<p>Tue Jun 14 03:47:29 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* proc.c: fix RDoc of Proc#===/call/yield/[] 	  [Bug #12332]</p>

<p>Tue Jun 14 03:34:27 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* variable.c (rb_local_constants_i): exclude hidden constants. 	  [ruby-core:75575] [Bug #12389]</p>

<p>Tue Jun 14 03:25:14 2016  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* insns.def (defineclass): Also raise an error when redeclaring the 	  superclass of a class as Object and it has another superclass. 	  [Bug #12367] [ruby-core:75446]</p>

<p>	* test/ruby/test_class.rb: test for above.</p>

<p>Tue Jun 14 03:15:54 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (rb_exec_getargs): honor the expected argument types 	  over the conversion method.  the basic language functionality 	  should be robust.  [ruby-core:75388] [Bug #12355]</p>

<p>Tue Jun 14 03:02:38 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c, include/ruby/win32.h (rb_w32_utruncate): implements new 	  truncate alternative which accepts UTF-8 path.</p>

<p>	* file.c (truncate): use above function. 	  [Bug #12340]</p>

<p>Tue Jun 14 02:58:41 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* ext/date/date_core.c (Init_date_core): [DOC] Convert DateTime 	  documentation to RDoc from Markdown. 	  [ruby-core:75136] [Bug #12311]</p>

<p>Sun Jun 12 02:36:52 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* regcomp.c (compile_length_tree): return error code immediately 	  if compile_length_tree raised error [Bug #12418]</p>

<p>Sun Jun 12 02:27:07 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* thread.c (recursive_list_access): a object id may be a Bignum.  so, 	  the list must be a objhash, instead of a identhash. 	  this fixes many test errors on mswin64 CI.</p>

<p>Sun Jun 12 01:59:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (new_if_gen): set newline flag to NODE_IF to trace all 	  if/elsif statements.  [ruby-core:67720] [Bug #10763]</p>

<p>Sun May 15 02:33:52 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/mkmf.rb (pkg_config): use xsystem consistently to set up 	  library path environment variable as well as latter pkg-config 	  calls.  [ruby-dev:49619] [Bug #12379]</p>

<p>Fri May  6 02:30:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/optparse.rb: [DOC] fix example code.  base on the code by 	  Semyon Gaivoronskiy in [ruby-core:75224].  [Bug #12323]</p>

<p>Fri May  6 02:28:31 2016  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* ext/win32ole/win32ole.c (ole_vstr2wc, ole_variant2val): fix blank 	  string conversion. 	  [Bug #11880] 	  Thanks Akio Tajima for the patch!</p>

<p>Fri May  6 02:24:13 2016  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* bignum.c: [DOC] Update result of 123456789 ** -2. 	  [ruby-dev:49606] [Bug #12339]</p>

<p>Wed May  4 02:38:08 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>	* internal.h (RCOMPLEX_SET_IMAG): undef RCOMPLEX_SET_IMAG 	  instead of duplicated undef RCOMPLEX_SET_REAL.</p>

<p>Wed May  4 02:38:08 2016  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>	* complex.c (rb_complex_set_imag): Fix to properly set imag 	  of complex.</p>

<p>Tue Apr 26 23:34:45 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* version.h: Bump versionto 2.3.2.</p>

<p>Tue Apr 26 02:58:51 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* doc/extension.rdoc: Improvements to english grammers. 	  [Bug #<a href="ruby-core:74792">12246]</a>[ci skip]</p>

<p>Tue Apr 26 02:58:51 2016  craft4coder  &lt;yooobuntu@163.com&gt;</p>

<p>	* doc/extension.rdoc: [DOC] <code>nul</code> should be uppercase. 	  change &#39;nul&#39; =&gt; &#39;NUL&#39;.  [Fix GH-1172]</p>

<p>Tue Apr 26 02:54:57 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* encoding.c: Fix return value of <code>Encoding::ISO8859_1.name</code> 	  [Bug #<a href="ruby-core:75147">12313]</a>[ci skip] 	* ext/bigdecimal/bigdecimal.c: Fix code sample of <code>BigDecimal.new</code></p>

<p>Mon Apr 25 02:29:07 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* configure.in: add missing -lm for AIX.</p>

<p>Mon Apr 25 02:29:07 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* configure.in: don&#39;t use the system-provided round(3) on AIX. 	  In AIX, round(0.49999999999999994) returns 1.0. 	  Use round() in numeric.c instead.</p>

<p>Sun Apr 24 03:05:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby.c: cygwin does not use w32_cmdvector, command line can be 	  other than UTF-8.  [ruby-dev:49519] [Bug #12184]</p>

<p>Sat Apr 23 01:01:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* eval_jump.c (exec_end_procs_chain): restore previous error info 	  for each end procs.  [ruby-core:75038] [Bug #12302]</p>

<p>Sat Apr 23 00:51:51 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (new_label_body): initialize bit fields, since 	  compile_data_alloc does not clear the memory.  [Bug #12082]</p>

<p>Sat Apr 23 00:51:51 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_optimize): disable tail call optimization in 	  rescued, rescue, and ensure blocks. 	  [ruby-core:73871] [Bug #12082]</p>

<p>Sat Apr 23 00:33:04 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/nkf/nkf-utf8/nkf.c (mime_putc): fix typo. 	  [Bug #12202] [ruby-core:74802]</p>

<p>Sat Apr 23 00:33:04 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/nkf/nkf-utf8/nkf.c: Merge upstream 4f3edf80a0. 	  patched by Anton Sivakov [Bug #12201] [Bug #12202]</p>

<p>Sat Apr 23 00:29:15 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/securerandom.rb (gen_random): to avoid blocking on Windows. 	  On Windows OpenSSL RAND_bytes (underlying implementation is 	  RAND_poll in crypto/rand/rand_win.c) may be blocked at 	  NetStatisticsGet. 	  <a href="https://wiki.openssl.org/index.php/Random_Numbers#Windows_Issues">wiki.openssl.org/index.php/Random_Numbers#Windows_Issues</a> 	  Instead of this, use Random.raw_seed directly (whose implementation 	  CryptGenRandom is one of the source of 	  entropy of RAND_poll on Windows). 	  <a href="https://wiki.openssl.org/index.php/Random_Numbers">wiki.openssl.org/index.php/Random_Numbers</a> 	  Note: CryptGenRandom function is PRNG and doesn&#39;t check its entropy, 	  so it won&#39;t block. [Bug #12139] 	  <a href="https://msdn.microsoft.com/ja-jp/library/windows/desktop/aa379942.aspx">msdn.microsoft.com/ja-jp/library/windows/desktop/aa379942.aspx</a> 	  <a href="https://tools.ietf.org/html/rfc4086#section-7.1.3">tools.ietf.org/html/rfc4086#section-7.1.3</a> 	  <a href="https://eprint.iacr.org/2007/419.pdf">eprint.iacr.org/2007/419.pdf</a> 	  <a href="http://www.cs.huji.ac.il/~dolev/pubs/thesis/msc-thesis-leo.pdf">www.cs.huji.ac.il/~dolev/pubs/thesis/msc-thesis-leo.pdf</a></p>

<p>Sat Apr 23 00:25:26 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* miniinit.c (Init_enc): add some common aliases of built-in 	  encodings.  [ruby-core:72481] [Bug #11872]</p>

<p>Sat Apr 23 00:13:50 2016  sorah (Shota Fukumori)  &lt;her@sorah.jp&gt;</p>

<p>	* lib/forwardable.rb: Convert given accessors to String.</p>

<p>	  r53381 changed to accept only Symbol or String for accessors, but 	  there are several rubygems that pass classes (e.g. Array, 	  Hash, …) as accessors. Prior r53381, it was accepted because Class#to_s 	  returns its class name. After r53381 given accessors are checked 	  with define_method, but it accepts only Symbol or String, otherwise 	  raises TypeError.</p>

<p>	      def_delegator Foo, <code>:some_method</code></p>

<p>	  This change is to revert unexpected incompatibility. But this behavior 	  may change in the future.</p>

<p>Sat Apr 23 00:02:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in: check if succeeded in creating config.h.</p>

<p>	* tool/ifchange: ignore failures when TEST_COLORS unmatched. just 	  use the default value if expected name is not contained in it. 	  [ruby-core:75046] [Bug #12303]</p>

<p>Fri Apr 22 23:47:05 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* doc/regexp.rdoc (comments): [DOC] terminators cannot appear in 	  comments.  [ruby-core:74838] [Bug #12256]</p>

<p>Fri Apr 22 23:44:07 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* extension.rdoc, extension.ja.rdoc: [DOC] Fix some errors. 	  Renamed files, wrong method names or argument types; the example 	  GetDBM macro is now updated to the current version of the actual 	  code.  patch by Marcus Stollsteimer in [ruby-core:74690]. 	  [Bug #12228]</p>

<p>Fri Apr 22 23:32:19 2016  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_time_tz.rb: Tests depends on Europe/Moscow removed 	  to avoid test failures due to the tzdata change. 	  <a href="https://github.com/eggert/tz/commit/8ee11a301cf173afb0c76e0315b9f9ec8ebb9d95">github.com/eggert/tz/commit/8ee11a301cf173afb0c76e0315b9f9ec8ebb9d95</a> 	  Found by naruse.</p>

<p>Tue Apr 19 02:32:50 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (rb_cv_lgamma_r_m0): fix the condition for 	  lgamma_r(-0.0).  [Bug #12249]</p>

<p>Tue Apr 19 02:32:50 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (rb_cv_lgamma_r_m0): check if lgamma_r(-0.0) 	  returns negative infinity.  [Bug #12249]</p>

<p>	* math.c (ruby_lgamma_r): define by the configured result.</p>

<p>Tue Apr 19 02:32:50 2016  cremno phobia  &lt;cremno@mail.ru&gt;</p>

<p>	* math.c (ruby_lgamma_r): missing/lgamma_r.c is used on Windows, 	  since msvcrt does not provide it.</p>

<p>	* missing/lgamma_r.c (lgamma_r): fix lgamma(-0.0). 	  [ruby-core:74823] [Bug #12249]</p>

<p>Tue Apr 19 02:32:50 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* math.c (ruby_lgamma_r): mswin&#39;s lgamma_r also seems to be wrong. 	  cf. [Bug #12249]</p>

<p>Tue Apr 19 02:32:50 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* math.c (ruby_tgamma): fix tgamma(-0.0) on mingw. 	  [ruby-core:74817] [Bug #12249]</p>

<p>Tue Apr 19 01:53:32 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* defs/keywords (alias, undef): symbol literals are allowed.</p>

<p>	* parse.y (parse_percent): should parse symbol literals for alias 	  and undef.  [ruby-dev:47681] [Bug #8851]</p>

<p>Mon Apr 18 18:05:29 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* struct.c (struct_make_members_list, rb_struct_s_def): member 	  names should be unique. [ruby-core:74971] [Bug #12291]</p>

<p>	* struct.c (struct_make_members_list): extract making member name 	  list from char* va_list, with creating symbols without 	  intermediate IDs.</p>

<p>Mon Apr 18 17:54:40 2016  Joe Swatosh  &lt;joe.swatosh@gmail.com&gt;</p>

<p>	* ext/win32/lib/win32/registry.rb (DeleteValue, DeleteKey): fix 	  API names.  [ruby-core:74863] [Bug #12264]</p>

<p>Mon Apr 18 17:27:30 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): should not replace the 	  current target INSN, not to follow the replaced dangling link in 	  the caller.  [ruby-core:74993] [Bug #11816]</p>

<p>Mon Apr 18 17:18:25 2016  cremno phobia  &lt;cremno@mail.ru&gt;</p>

<p>	* cont.c (fiber_initialize_machine_stack_context): fix wrong 	  _MSC_VER check, should be decimal but not hexadecimal. 	  [ruby-core:74936] [Bug #12279]</p>

<p>Mon Apr 18 17:18:25 2016  cremno phobia  &lt;cremno@mail.ru&gt;</p>

<p>	* cont.c (fiber_initialize_machine_stack_context): fix wrong 	  _MSC_VER check, should be decimal but not hexadecimal. 	  [ruby-core:74936] [Bug #12279]</p>

<p>Mon Apr 18 17:08:10 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_core.h (rb_vm_struct): make at_exit a single linked list but 	  not RArray, not to mark the registered functions by the write 	  barrier.  based on the patches by Evan Phoenix. 	  [ruby-core:73908] [Bug #12095]</p>

<p>Mon Apr 18 16:56:31 2016  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* thread.c (update_coverage): Do not track coverage in loaded files 	  after Coverage.result. Avoids out-of-bounds access. [Bug #12237]</p>

<p>	* ext/coverage/coverage.c (coverage_clear_result_i): document.</p>

<p>Mon Apr 18 16:33:50 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/date/date_core.c (Init_date_core): [DOC] fix misplaced doc 	  of DateTime.  [ruby-core:74729] [Bug #12233]</p>

<p>Mon Apr 18 13:48:05 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* cygwin/GNUmakefile.in (MSYS2_ARG_CONV_EXCL_PARAM): 	  * add missing parentheses and remove double quotes. 	  * rename to get rid of recursive references. 	  * as –excludes-dir option is for a path name, its argument 	    should be converted. 	  [ruby-dev:49526] [Bug #12199]</p>

<p>Mon Apr 18 13:48:05 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* common.mk (TEST_EXCLUDES, EXCLUDE_TESTFRAMEWORK): use full spell 	  long option.</p>

<p>	* cygwin/GNUmakefile.in (MSYS2_ARG_CONV_EXCL): suppress path name 	  conversions by msys2.  [ruby-dev:49525] [Bug #12199]</p>

<p>Mon Apr 18 13:48:05 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/lib/test/unit.rb (Options#non_options): make regexp name 	  options prefixed with “!” negative filters.</p>

<p>	* common.mk (TEST_EXCLUDES): use negative filter to exclude memory 	  leak tests.  -x option excludes test files, not test methods.</p>

<p>Sun Apr 17 04:30:13 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parse_ident): allow keyword arguments just after a 	  method where the same name local variable is defined. 	  [ruby-core:73816] [Bug#12073]</p>

<p>Sun Apr 17 04:20:40 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* eval.c (setup_exception): set the cause only if it is explicitly 	  given or not set yet.  [Bug #12068]</p>

<p>Sat Apr 16 00:56:45 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_setname): defer setting native thread name 	  set in initialize until the native thread is created. 	  [ruby-core:74963] [Bug #12290]</p>

<p>Fri Apr 15 21:10:00 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/irb/ext/save-history.rb: Fix NoMethodError when method is not defined.</p>

<p>Fri Apr 15 14:52:06 2016  Elliot Winkler  &lt;elliot.winkler@gmail.com&gt;</p>

<p>	* lib/forwardable.rb (def_instance_delegator) fix delegating to 	  &#39;args&#39; and &#39;block&#39;, clashing with local variables in generated 	  methods.  [ruby-core:72579] [Bug #11916]</p>

<p>	* lib/forwardable.rb (def_single_delegator): ditto.</p>

<p>Fri Apr 15 14:27:48 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/irb/ext/save-history.rb: suppress warning: method redefined; 	  discarding old save_history=.</p>

<p>Tue Apr 12 16:15:39 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* configure.in: improve ICC (Intel C Compiler) support.</p>

<p>	* configure.in (CXX): The name of icc&#39;s c++ compiler is <code>icpc</code>.</p>

<p>	* configure.in (warnings): Add <code>-diag-disable=2259</code> to suppress 	  noisy warnings: “non-pointer conversion from ”…“ to ”…“ may 	  lose significant bits”.</p>

<p>	* configure.in (optflags): Add `-fp-model precise` like -fno-fast-math.</p>

<p>	* lib/mkmf.rb: icc supports -Werror=division-by-zero 	  and -Werror=deprecated-declarations, but doesn&#39;t support 	  -Wdivision-by-zero and -Wdeprecated-declarations.</p>

<p>Tue Apr 12 14:29:01 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* ext/openssl/extconf.rb: check SSL_CTX_set_next_proto_select_cb 	  function rather than OPENSSL_NPN_NEGOTIATED macro. it exists 	  even if it is disabled by OpenSSL configuration. 	  [ruby-core:74384] [Bug #12182]</p>

<p>	* ext/openssl/ossl_ssl.c: update #ifdef(s) as above.</p>

<p>	* test/openssl/test_ssl.rb: skip NPN tests if NPN is disabled.</p>

<p>Tue Apr 12 14:27:04 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/uri/http.rb (URI::HTTP#initialize): [DOC] fix example, 	  missing mandatory arguments.  [ruby-core:74540] [Bug #12215]</p>

<p>Thu Apr  7 01:07:02 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* sprintf.c (rb_str_format): fix buffer overflow, length must be 	  greater than precision.  reported by William Bowling &lt;will AT 	  wbowling.info&gt;.</p>

<p>Wed Apr  6 00:33:45 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/security.rb (DIGEST_ALGORITHM, KEY_ALGORITHM): 	  should check same name as the used constants. 	  [ruby-core:72674] [Bug #11940]</p>

<p>Mon Apr  4 00:31:51 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (compile_massign_lhs): when index ends with splat, 	  append rhs value to it like POSTARG, since VM_CALL_ARGS_SPLAT 	  splats the last argument only.  [ruby-core:72777] [Bug #11970]</p>

<p>Sat Apr  2 02:07:29 2016  Seiei Miyagi  &lt;hanachin@gmail.com&gt;</p>

<p>	* ext/ripper/lib/ripper/lexer.rb (on_heredoc_dedent): Fix 	  Ripper.lex error in dedenting squiggly heredoc.  heredoc tree is 	  also an array of Elem in the outer tree.  [Fix GH-1234]</p>

<p>Wed Mar 30 02:28:13 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* thread_pthread.c (setup_communication_pipe): delay setting owner 	  (rb_thread_create_timer_thread): until thread creation succeeds 	  [ruby-core:72590] [Bug #11922]</p>

<p>Wed Mar 30 02:20:06 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* localeinit.c (rb_locale_charmap_index): fix prototype. 	  patched by Andreas Schwab [Bug #12218]</p>

<p>Wed Mar 30 02:20:06 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* thread_pthread.c (reserve_stack): fix reserving position where 	  the stack growing bottom to top. [Bug #12118]</p>

<p>Wed Mar 30 02:17:33 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/file.c (rb_readlink): drop garbage after the substitute 	  name, as rb_w32_read_reparse_point returns the expected buffer 	  size but “??&quot; prefix is dropped from the result.</p>

<p>	* win32/win32.c (w32_readlink): ditto, including NUL-terminator.</p>

<p>Wed Mar 30 02:17:33 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (fileattr_to_unixmode, rb_w32_reparse_symlink_p): volume 	  mount point should be treated as directory, not symlink. 	  [ruby-core:72483] [Bug #11874]</p>

<p>	* win32/win32.c (rb_w32_read_reparse_point): check the reparse point is 	  a volume mount point or not.</p>

<p>	* win32/file.c (rb_readlink): follow above change (but this pass won&#39;t 	  be used).</p>

<p>Wed Mar 30 01:32:14 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/-ext-/time/test_new.rb (test_timespec_new): change a gmtoff 	  test to a better one that does not depend on whether the current 	  time is in summer time or not.</p>

<p>Wed Mar 30 01:32:14 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/-ext-/time/test_new.rb (test_timespec_new): Time#gmtoff values 	  are the same only when both or neither of the Time objects are in 	  summer time (daylight-saving time).</p>

<p>Wed Mar 30 01:30:54 2016  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>	* lib/rubygems/test_case.rb: Fix test on Windows for inconsistent temp path. 	  <a href="https://github.com/rubygems/rubygems/pull/1554">github.com/rubygems/rubygems/pull/1554</a> 	  [Bug #<a href="ruby-core:74431">12193]</a></p>

<p>Wed Mar 30 01:25:46 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* string.c (str_new_frozen): if the given string is embeddedable 	  but not embedded, embed a new copied string. [Bug #11946]</p>

<p>Wed Mar 30 01:23:57 2016  Marcus Stollsteimer  &lt;sto.mar@web.de&gt;</p>

<p>	* doc/extension.ja.rdoc: Fix RDoc markup in doc/extension*.rdoc. 	  [ci skip][Bug #<a href="ruby-core:74143">12143]</a> 	* doc/extension.rdoc: ditto.</p>

<p>Wed Mar 30 01:00:30 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (proc_binding): proc from symbol can not make a binding. 	  [ruby-core:74100] [Bug #12137]</p>

<p>Wed Mar 30 00:54:38 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/win32.h (O_SHARE_DELETE): change to fit Fixnum 	  limit.  [ruby-core:74285] [Bug #12171]</p>

<p>Wed Mar 30 00:52:47 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/net/imap/test_imap.rb (test_idle_timeout): Because of the 	  timeout specified in “imap.idle(0.2)”, there is no gurantee that 	  the server thread has done all the work before the client thread 	  performs the assertions. It depends on the thread scheduling. 	  Add checks to avoid false positives (on AIX, particularly).</p>

<p>Wed Mar 30 00:41:42 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/socket/test_socket.rb (test_udp_recvmsg_truncation): 	  AIX does not set the MSG_TRUNC flag for a message partially read 	  by recvmsg(2) with the MSG_PEEK flag set.</p>

<p>Wed Mar 30 00:00:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* doc/extension.rdoc, doc/extension.ja.rdoc: add editor local 	  variables, with commenting out by :enddoc: directives which are 	  just ignored unless code object mode.  [Bug #12111]</p>

<p>Wed Mar 30 00:00:47 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* doc/extension.ja.rdoc: removed rendering error caused by editor specific 	  configuration on <a href="http://docs.ruby-lang.org/en/trunk/extension_rdoc.html">docs.ruby-lang.org/en/trunk/extension_rdoc.html</a> . 	  [Bug #<a href="ruby-core:73990">12111]</a></p>

<p>Tue Mar 29 23:54:31 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* object.c (rb_mod_const_get): make error message at uninterned 	  string consistent with symbols.  [ruby-dev:49498] [Bug #12089]</p>

<p>Tue Mar 29 23:45:24 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (push_pattern, push_glob): deal with read paths as UTF-8 	  to stat later, on Windows as well as OS X. 	  [ruby-core:73868] [Bug #12081]</p>

<p>Tue Mar 29 23:36:49 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/extmk.rb: add cygwin case, nothing excluded. 	  [ruby-core:73806] [Bug#12071]</p>

<p>Tue Mar 29 23:10:47 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* iseq.c (rb_iseq_mark): mark parent iseq to prevent dynamically 	  generated iseq by eval from GC.  [ruby-core:72620] [Bug #11928]</p>

<p>Tue Mar 29 22:56:44 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/resolv.rb (Resolv::IPv6.create): avoid modifying frozen 	* test/resolv/test_dns.rb (test_ipv6_create): test for above 	  [Bug #11910] [ruby-core:72559]</p>

<p>Tue Mar 29 22:31:48 2016  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* range.c (range_eqq): revert r11113 because rb_call_super() is 	  called in range_include() and thus r11113 doesn&#39;t work when the 	  receiver Range object consists of non linear objects such as Date 	  objects. 	  [ruby-core:72908] [Bug #12003]</p>

<p>Tue Mar 29 22:26:55 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (rb_check_funcall_with_hook): also should call the 	  given hook before returning Qundef when overridden respond_to? 	  method returned false.  [ruby-core:73556] [Bug #12030]</p>

<p>Tue Mar 29 22:08:36 2016  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): don&#39;t apply tailcall 	  optimization to send/invokesuper instructions with blockiseq. 	  This is a follow-up to the changes in r51903; blockiseq is now 	  the third operand of send/invokesuper instructions. 	  [ruby-core:73413] [Bug #12018]</p>

<p>Tue Mar 29 21:22:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (xstring): reset heredoc indent after dedenting, 	  so that following string literal would not be dedented. 	  [ruby-core:72857] [Bug #11990]</p>

<p>Tue Mar 29 21:22:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (string1): reset heredoc indent fore each string leteral 	  so that concatenated string would not be dedented. 	  [ruby-core:72857] [Bug #11990]</p>

<p>Tue Mar 29 21:18:09 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_here_document): update indent for each line in 	  indented here document with single-quotes. 	  [ruby-core:72479] [Bug #11871]</p>

<p>Tue Mar 29 21:03:40 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* symbol.h (is_attrset_id): ASET is an attrset ID.  fix 	  unexpected safe call instead of an ordinary ASET.</p>

<p>Tue Mar 29 21:01:07 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* doc/syntax/calling_methods.rdoc: fix old operator for safe navigation 	  operator. [ci skip][fix GH-1182] Patch by @dougo</p>

<p>Tue Mar 29 18:49:54 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/ostruct.rb (freeze): define deferred accessors before 	  freezing to get rid of an error when just reading frozen 	  OpenStruct.</p>

<p>Tue Mar 29 18:49:54 2016  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/ostruct.rb: Fix new_ostruct_member to correctly avoid 	  redefinition [#11901]</p>

<p>Tue Mar 29 17:54:17 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/ostruct.rb (OpenStruct): make respond_to? working on 	  just-allocated objects for workaround of Psych. 	  [ruby-core:72501] [Bug #11884]</p>

<p>Tue Mar 29 17:04:35 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (rb_f_catch): [DOC] fix malformed RDoc syntax, “<code>...</code>” 	  cannot enclose non-identifier characters. 	  a patch by Sebastian S in [ruby-core:74278].  [Bug#12170]</p>

<p>Tue Mar 29 17:03:28 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/-ext-/float/test_nextafter.rb: In AIX, 	  nextafter(+0.0,-0.0)=+0.0, and nextafter(-0.0,+0.0)=-0.0, 	  but they should return -0.0 and +0.0, respectively. This is 	  a known bug in nextafter(3) on AIX, so skip related tests.</p>

<p>Tue Mar 29 16:54:14 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (enc_succ_alnum_char): try to skip an invalid character 	  gap between GREEK CAPITAL RHO and SIGMA. 	  [ruby-core:74478] [Bug #12204]</p>

<p>Tue Mar 29 16:45:58 2016  Victor Nawothnig  &lt;Victor.Nawothnig@gmail.com&gt;</p>

<p>	* parse.y (parse_numvar): NTH_REF must be less than a half of 	  INT_MAX, as it is left-shifted to be ORed with back-ref flag. 	  [ruby-core:74444] [Bug#12192] [Fix GH-1296]</p>

<p>Tue Mar 29 16:44:54 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* enc/trans/JIS: update Unicode&#39;s notice. [Bug #11844]</p>

<p>Tue Mar 29 16:41:27 2016  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>	* marshal.c (r_object0):  raise ArgumentError when linking to undefined 	  object.</p>

<p>Tue Mar 29 16:41:27 2016  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>	* marshal.c (r_object0): Fix Marshal crash for corrupt extended object.</p>

<p>Tue Mar 29 16:40:48 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_sslctx_setup): document as MT-unsafe 	  [ruby-core:73803] [Bug #12069]</p>

<p>Tue Mar 29 16:29:44 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* insns.def (opt_mod): show its method name on ZeroDivisionError. 	  [Bug #12158]</p>

<p>Tue Mar 29 16:25:27 2016  Anthony Dmitriyev  &lt;antstorm@gmail.com&gt;</p>

<p>	* net/ftp.rb: add NullSocket#closed? to fix closing not opened 	  connection.  [Fix GH-1232]</p>

<p>Tue Mar 29 16:12:08 2016  Koichi ITO  &lt;koic.ito@gmail.com&gt;</p>

<p>	* variable.c: Added documentation about order of <code>Module#constants</code> 	  [ci skip][Bug #<a href="ruby-dev:49505">12121]</a>[fix GH-1301]</p>

<p>Tue Mar 29 16:02:26 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/ruby/test_process.rb (test_execopts_gid): Skip a test 	  that is known to fail on AIX. AIX allows setgid to 	  a supplementary group, but Ruby does not allow the “-e” 	  option when setgid&#39;ed, so the test does not work as intended.</p>

<p>Tue Mar 29 15:58:18 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/socket/test_addrinfo.rb (test_ipv6_address_predicates): 	  IN6_IS_ADDR_V4COMPAT and IN6_IS_ADDR_V4MAPPED are broken 	  on AIX, so skip related tests.</p>

<p>Tue Mar 29 15:31:06 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/rinda/test_rinda.rb (test_make_socket_ipv4_multicast): 	  The fifth argument to getsockopt(2) should be modified to 	  indicate the actual size of the value on return, 	  but not in AIX. This is a know bug. Skip related tests. 	* test/rinda/test_rinda.rb (test_ring_server_ipv4_multicast): 	  ditto. 	* test/rinda/test_rinda.rb (test_make_socket_unicast): ditto. 	* test/socket/test_basicsocket.rb (test_getsockopt): ditto. 	* test/socket/test_sockopt.rb (test_bool): ditto.</p>

<p>Tue Mar 29 15:27:14 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/zlib/test_zlib.rb (test_adler32_combine, test_crc32_combine): 	  Skip two tests on AIX because zconf.h in zlib does not correctly 	  recognize _LARGE_FILES in AIX. The problem was already reported 	  to zlib, and skip these tests until it is fixed.</p>

<p>Tue Mar 29 15:10:31 2016  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* thread_pthread.c (getstack): __pi_stacksize returned by 	  pthread_getthrds_np() is wrong on AIX. Use 	  __pi_stackend - __pi_stackaddr instead.</p>

<p>Tue Mar 29 15:10:05 2016  Alex Boyd  &lt;alex@opengroove.org&gt;</p>

<p>	* lib/irb.rb: avoid to needless truncation when using back_trace_limit option. 	  [fix <a href="ruby-core:72773">GH-1205]</a>[Bug #11969]</p>

<p>Tue Mar 29 15:05:16 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb: fix method name typo. 	  [ruby-core:72513] [Bug #11893] The patch provided by Akira Matsuda.</p>

<p>Tue Mar 29 15:05:02 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* ext/tk/lib/tkextlib/tcllib/toolbar.rb: fix method name typo. 	  [ruby-core:72511] [Bug #11891] The patch provided by Akira Matsuda.</p>

<p>Tue Mar 29 15:04:42 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* ext/tk/lib/tkextlib/blt/tree.rb: fix method name typo. 	  [ruby-core:72510] [Bug #11890] The patch provided by Akira Matsuda.</p>

<p>Tue Mar 29 15:04:19 2016  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* ext/tk/lib/tk/menubar.rb: fix a typo in font name. [ruby-core:72505] 	  [Bug #11886] The patch provided by Akira Matsuda.</p>

<p>	* ext/tk/sample/*.rb: ditto.</p>

<p>Tue Mar 29 15:03:03 2016  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>	* ruby.h: undef HAVE_BUILTIN___BUILTIN_CHOOSE_EXPR_CONSTANT_P 	  and HAVE_BUILTIN___BUILTIN_TYPES_COMPATIBLE_P on C++. 	  [ruby-core:72736] [Bug #11962]</p>

<p>Tue Mar 29 14:58:56 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/option.c (inspect_tcpi_msec): more accurate condition 	  for TCPI msec member inspection function. 	  [ruby-core:74388] [Bug #12185]</p>

<p>Tue Mar 29 14:53:58 2016  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>	* lib/logger.rb: Remove block from Logger.add as it&#39;s not needed 	  patch provided by Daniel Lobato Garcia [fix GH-1240] [Bug #12054]</p>

<p>Tue Mar 29 14:52:20 2016  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* re.c: Remove deprecated kcode argument from Regexp.new and compile 	  patch provided by Dylan Pulliam [Bug #11495]</p>

<p>Tue Mar 29 14:44:02 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/socket.c (sock_gethostname): support unlimited size 	  hostname.</p>

<p>Tue Mar 29 14:35:06 2016  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* lib/xmlrpc/client.rb: Support SSL options in async methods of 	  XMLRPC::Client. 	  [Bug #11489] 	  Reported by Aleksandar Kostadinov. Thanks!!!</p>

<p>Tue Mar 29 14:22:57 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* marshal.c (r_object0): honor Marshal.load post proc 	  value for TYPE_LINK.  by Hiroshi Nakamura &lt;nahi@ruby-lang.org&gt; 	  <a href="https://github.com/ruby/ruby/pull/1204">github.com/ruby/ruby/pull/1204</a> fix GH-1204</p>

<p>Tue Mar 29 14:18:26 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* .travis.yml: removed commented-out code.</p>

<p>Tue Mar 29 14:18:26 2016  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* .travis.yml: removed osx code. follow up with r53517</p>

<p>Tue Mar 29 14:12:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/option.c (sockopt_bool): relax boolean size to be one 	  too not only sizeof(int).  Winsock getsockopt() returns a single 	  byte as a boolean socket option.  [ruby-core:72730] [Bug #11958]</p>

<p>Tue Mar 29 14:12:22 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/option.c (check_size): extract a macro to check 	  binary data size, with a consistent message.</p>

<p>	* ext/socket/option.c (sockopt_byte): fix error message, 	  sizeof(int) differs from sizeof(unsigned char) in general.</p>

<p>Tue Mar 29 14:01:14 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* process.c (rb_execarg_parent_start1): need to convert the encoding to 	  ospath&#39;s one.</p>

<p>Tue Mar 29 14:01:14 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* process.c: use rb_w32_uchdir() instead of plain chdir() on Windows. 	  reported by naruse via twitter.</p>

<p>	* process.c (rb_execarg_addopt): need to convert the encoding to 	  ospath&#39;s one.</p>

<p>Tue Mar 29 13:56:36 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/stringio/stringio.c (strio_binmode): implement to set encoding 	* test/stringio/test_stringio.rb (test_binmode): new test 	  [ruby-core:72699] [Bug #11945]</p>

<p>Tue Mar 29 13:50:30 2016  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* io.c (io_getpartial): remove unused kwarg from template 	* test/ruby/test_io.rb (test_readpartial_bad_args): new 	  [Bug #11885]</p>

<p>Tue Mar 29 13:41:03 2016  Tadashi Saito  &lt;tad.a.digger@gmail.com&gt;</p>

<p>	* compile.c, cont.c, doc, man: fix common misspelling. 	  [ruby-core:72466] [Bug #11870]</p>

<p>Tue Mar 29 13:31:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (regexp): set_yylval_num sets u1, should use nd_tag 	  instead of nd_state.  [ruby-core:72638] [Bug #11932]</p>

<p>Tue Mar 29 13:31:34 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (set_yylval_num): should be used as nd_state, set to u3. 	  [ruby-core:72638] [Bug #11932]</p>

<p>Tue Mar 29 13:26:15 2016  Joseph Tibbertsma  &lt;josephtibbertsma@gmail.com&gt;</p>

<p>	* gc.c (RVALUE_PAGE_WB_UNPROTECTED): fix a typo of argument name. 	  [Fix GH-1221]</p>

<p>Thu Jan 21 16:39:55 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* Makefile.in (update-rubyspec): fix r53208 like r53451.</p>

<p>Fri Jan 15 00:05:57 2016  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/uri/generic.rb (URI::Generic#to_s): change encoding to 	  UTF-8 as Ruby 2.2/ by Koichi ITO &lt;koic.ito@gmail.com&gt; 	  <a href="https://github.com/ruby/ruby/pull/1188">github.com/ruby/ruby/pull/1188</a> fix GH-1188</p>

<p>Tue Jan 12 17:23:39 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* process.c (rb_execarg_parent_start1): need to convert the encoding to 	  ospath&#39;s one.</p>

<p>Tue Jan 12 17:23:39 2016  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* process.c: use rb_w32_uchdir() instead of plain chdir() on Windows. 	  reported by naruse via twitter.</p>

<p>	* process.c (rb_execarg_addopt): need to convert the encoding to 	  ospath&#39;s one.</p>

<p>Tue Jan 12 15:21:00 2016  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/missing.h (explicit_bzero_by_memset_s): remove 	  inline implementation by memset_s, which needs a macro before 	  including headers and can cause problems in extension libraries 	  by the order of the macro and headers.</p>

<p>Thu Dec 24 23:01:57 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* NEWS: added entry for CGI.escapeHTML optimization.</p>

<p>Thu Dec 24 18:43:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* error.c (rb_compile_error_with_enc, rb_compile_error), 	  (rb_compile_bug): deprecate internal functions.</p>

<p>	* parse.y (parser_yyerror): construct exception message with 	  source code and caret.</p>

<p>Thu Dec 24 17:25:42 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (append_compile_error), parse.y (compile_error): 	  preserve encoding of source file name in exceptions.</p>

<p>	* error.c (rb_compile_error_str, rb_compile_bug_str): add.</p>

<p>Thu Dec 24 16:17:47 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* common.mk (fake.rb): $(arch)-fake.rb must depend on miniruby because 	  it may depend on miniruby.</p>

<p>Thu Dec 24 16:13:05 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* common.mk (ripper.c): r50045 wrongly replace $(PWD) with ../.. 	  It is the top of build directory, not topsrcdir.</p>

<p>Thu Dec 24 15:02:42 2015  sorah (Shota Fukumori)  &lt;her@sorah.jp&gt;</p>

<p>	* tool/vcs.rb (IO.popen): Refactor. Avoid assigning in condition.</p>

<p>Thu Dec 24 15:01:38 2015  sorah (Shota Fukumori)  &lt;her@sorah.jp&gt;</p>

<p>	* tool/file2lastrev.rb: Fix ArgumentError to work on Ruby 1.8.7.</p>

<p>Thu Dec 24 14:44:08 2015  sorah (Shota Fukumori)  &lt;her@sorah.jp&gt;</p>

<p>	* tool/vcs.rb (IO.popen): Enable on Ruby 1.9 where chdir option is not 	  supported on IO.popen</p>

<p>	* tool/vcs.rb (IO.popen): Fix NoMethodError. I guess r49705 was not 	  tested… :/</p>

<p>Thu Dec 24 14:57:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* NEWS: rename 	  “Implementation changes” section to 	  “Supported platform changes” section.</p>

<p>	* NEWS: add “Implementation improvements” and add several entries.</p>

<p>	* NEWS: add NEWS entries by Eric Wong. [ruby-core:72450]</p>

<p>Thu Dec 24 00:26:05 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/io/console/extconf.rb: fix gem build failure on Windows. 	  only win32_vk.inc is included in the gem and no dependencies for 	  the header, so that gperf will not be mandatory. 	  [ruby-core:72453] [Bug #11866]</p>

<p>	* ext/io/console/io-console.gemspec: include depend file and 	  win32_vk header.</p>

<p>Wed Dec 23 23:58:44 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (rb_readwrite_syserr_fail): works with the given errno than 	  thread local errno.</p>

<p>Wed Dec 23 17:57:45 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c, io.c, util.c: prefer rb_syserr_fail with saved errno 	  over setting errno then call rb_sys_fail, not to be clobbered 	  potentially and to reduce thread local errno accesses.</p>

<p>Wed Dec 23 11:58:52 2015  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>	* string.c: Fix document. Default value of the first 	  argument of <code>String#split</code> is not <code>$;</code> but <code>nil</code>. 	  When <code>nil</code> is passed as first argument, <code>$;</code> is used. 	  [ci skip] [Bug #11729] [ruby-dev:49378]</p>

<p>Wed Dec 23 07:15:17 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (rsock_init_sock): reject reserved FDs 	  [ruby-core:72445] [Bug #11862]</p>

<p>Wed Dec 23 02:59:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (<em>STDC_WANT_LIB_EXT1</em>): necessary to use memset_s 	  in strict C99 mode.</p>

<p>Wed Dec 23 02:34:36 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* regexec.c (match_at): move direct threaded VM code to get rid of 	  mixed declarations and code, and enable it only for gcc since it 	  depends on a gcc extension.</p>

<p>Wed Dec 23 02:23:19 2015  Yuki Nishijima  &lt;mail@yukinishijima.net&gt;</p>

<p>	* gems/bundled_gems: Upgrade the did_you_mean gem to 1.0.0</p>

<p>	* NEWS: Add news about the did_you_mean gem</p>

<p>Wed Dec 23 02:18:57 2015  Jake Worth  &lt;jakeworth82@gmail.com&gt;</p>

<p>	* doc/contributing.rdoc: [DOC] remove an extra word “here”. 	  [Fix GH-1169]</p>

<p>Wed Dec 23 01:58:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* regexec.c (USE_DIRECT_THREADED_VM): enable direct threaded VM by 	  the default.</p>

<p>Tue Dec 22 22:15:53 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.c (internal_object_p): should not expose singleton classes 	  without a metaclass.  based on patches by ko1 and shugo. 	  [Bug #11740]</p>

<p>	* class.c (rb_singleton_class_object_p): added.</p>

<p>Tue Dec 22 22:15:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/io/console/io-console.gemspec: bump up to 0.4.4.</p>

<p>Tue Dec 22 22:11:06 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* NEWS: Added news entry of Psych 2.0.17</p>

<p>Tue Dec 22 22:09:01 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* NEWS: Added news entry of RDoc 4.2.1</p>

<p>Tue Dec 22 21:20:00 2015  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.gemspec: bump version to 1.2.8.</p>

<p>Tue Dec 22 21:08:05 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rdoc.rb: bump version to 4.2.1. It contains following fixes. 	  <a href="https://github.com/rdoc/rdoc/pull/340">github.com/rdoc/rdoc/pull/340</a> 	  <a href="https://github.com/rdoc/rdoc/pull/341">github.com/rdoc/rdoc/pull/341</a> 	  <a href="https://github.com/rdoc/rdoc/pull/367">github.com/rdoc/rdoc/pull/367</a> 	  <a href="https://github.com/rdoc/rdoc/pull/368">github.com/rdoc/rdoc/pull/368</a> 	* lib/rdoc/*: ditto. 	* test/rdoc/*: ditto.</p>

<p>Tue Dec 22 20:25:33 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/psych/lib/psych.rb: bump version to 2.0.17 	* ext/psych/psych.gemspec: ditto.</p>

<p>Tue Dec 22 20:14:47 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c: move vm_callee_setup_block_arg() (and related 	  functions) to the latter location. 	  This moving recovers performance a little. 	  [Bug #11829]</p>

<p>Tue Dec 22 15:21:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (str_compat_and_valid): as scrub does nothing for dummy 	  encoding string now, incompatible encoding is not a matter.</p>

<p>Tue Dec 22 14:31:28 2015  Toru Iwase  &lt;tietew@tietew.net&gt;</p>

<p>	* ext/cgi/escape/escape.c (optimized_escape_html): CGI.escapeHTML 	  should return unfrozen new string. 	  [ruby-core:72426] [Bug #11858]</p>

<p>Tue Dec 22 05:39:58 2015  Takashi Kokubun  &lt;takashikkbn@gmail.com&gt;</p>

<p>	* ext/cgi/escape/escape.c (preserve_original_state): Preserve 	  original state for tainted and frozen.  [Fix GH-1166] 	  [ruby-dev:49451] [Bug #11855]</p>

<p>Tue Dec 22 03:57:20 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (rsock_init_sock): check FD after validating 	* test/socket/test_basicsocket.rb (test_for_fd): new 	  [ruby-core:72418] [Bug #11854]</p>

<p>Mon Dec 21 21:29:45 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* variable.c (struct ivar_update): rename “extended” to “iv_extended” 	  to avoid name conflict with /usr/include/floatingpoint.h on 	  Solaris. [Bug #11853] [ruby-dev:49448]</p>

<p>Mon Dec 21 12:15:32 2015  Kimura Wataru  &lt;kimuraw@i.nifty.jp&gt;</p>

<p>	* test/ruby/test_io.rb: handled rlimit value same as r52277 	  [Bug #<a href="ruby-dev:49446">11852]</a></p>

<p>Mon Dec 21 10:21:22 2015  Ilya Vassilevsky &lt;vassilevsky@gmail.com&gt;</p>

<p>	* lib/net/http.rb (open_timeout): update default value in RDoc 	  [ruby-core:72413]</p>

<p>Mon Dec 21 10:18:46 2015  Kazuki Yamaguchi  &lt;k@rhe.jp&gt;</p>

<p>	* vm_backtrace.c (rb_profile_frames): ignore ifunc frames as it 	  did before.  [ruby-core:72409] [Bug #11851]</p>

<p>Mon Dec 21 09:33:17 2015  Karol Bucek  &lt;kares@users.noreply.github.com&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SSLSocket): fix 	  NotImplementedError typo.  [Fix GH-1165]</p>

<p>Sun Dec 20 20:54:51 2015  Takashi Kokubun  &lt;takashikkbn@gmail.com&gt;</p>

<p>	* cgi/escape/escape.c: Optimize CGI.escapeHTML for 	  ASCII-compatible encodings.  [Fix GH-1164]</p>

<p>Sun Dec 20 15:36:46 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/erb.rb: revert r53123. It breaks compatibility like thor and 	  rspec-rails. 	  We should try with Ruby 2.4 or 3.0. 	  [Bug #<a href="ruby-core:72374">11842]</a> 	* lib/rdoc/erb_partial.rb: ditto. 	* template/verconf.h.tmpl: ditto.</p>

<p>Sun Dec 20 11:43:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_yylex): allow here documents in labeled 	  argument.  [ruby-core:72396] [Bug #11849]</p>

<p>Sun Dec 20 11:14:11 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (rb_mod_define_method): should check Symbol or not. 	  [Bug #11850]</p>

<p>	* test/ruby/test_method.rb: add a test.</p>

<p>Sun Dec 20 11:01:57 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (rb_mod_define_method): fix notation.</p>

<p>Sun Dec 20 10:54:15 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (proc_new): fix notation.</p>

<p>Sun Dec 20 00:29:00 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (rb_proc_get_iseq): proc made from symbol does not have 	  iseq.  fix infinite loop.  [ruby-core:72381] [Bug #11845]</p>

<p>Sat Dec 19 20:06:10 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* enc/windows_1250.c: Should not use C++ style comments (C99 feature). 	  [Bug #11843]</p>

<p>Sat Dec 19 17:17:04 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler#initialize): 	  use WEBrick::Utils::TimeoutHandler::Thread, which is ignored by 	  LeakChecker#find_threads, instead of ::Thread to get rid of 	  thread leak checker.  since this TimeoutHandler is resident 	  during tests because of Singleton, it waits for the next timeout 	  if it has any schedules.  in the case of nested timeouts, inner 	  timeout does not cancel outer timeouts and then those schedules 	  still remain.</p>

<p>Sat Dec 19 14:28:01 2015  Jake Worth  &lt;jakeworth82@gmail.com&gt;</p>

<p>	* ext/zlib/zlib.c (Init_zlib): [DOC] Fix double-word typo and 	  grammatical error.  [Fix GH-1162]</p>

<p>Sat Dec 19 14:23:59 2015  Jake Worth  &lt;jakeworth82@gmail.com&gt;</p>

<p>	* lib/csv.rb (CSV#initialize): [DOC] Fix double-word typo. 	  [Fix GH-1161]</p>

<p>Sat Dec 19 10:33:33 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* enc/iso_8859_2.c, enc/windows_1250.c: separate Windows-1250 	  from ISO-8859-2 to fix 0x80..0x9e range (from Kimihito Matsui)</p>

<p>Fri Dec 18 21:26:54 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler): To prevent 	  potential deadlocks, Queue is used to tell update of @timeout_info 	  instead of sleep and wakeup. [Bug #11742] [ruby-dev:49387]</p>

<p>Fri Dec 18 17:24:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (ibf_load_object_string): use fstring if frozen string.</p>

<p>Fri Dec 18 16:54:38 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/stringio/stringio.c (strio_set_encoding): add StringIO&#39;s own 	  encoding and separate it from the buffer string to override the 	  encoding of string when reading.  [ruby-core:72189] [Bug #11827] 	  note that setting the encoding of its buffer string directly 	  without StringIO#set_encoding may cause unpredictable behavior.</p>

<p>Fri Dec 18 16:50:35 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (ibf_load_setup): check tainted string argument.</p>

<p>Fri Dec 18 16:12:13 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: define USE_LAZY_LOAD if it is not defined.</p>

<p>Fri Dec 18 15:40:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/stringio/stringio.c (strio_unget_bytes): extract from 	  strio_ungetbyte to share with strio_ungetc.</p>

<p>Fri Dec 18 12:39:42 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* doc/syntax/*.rdoc: separated modifier at sentence. 	  [ci skip][fix GH-1121] Patch by @clandry94</p>

<p>Fri Dec 18 12:09:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/stringio/stringio.c (strio_ungetbyte): pad with 000 when 	  the current position is after the end.</p>

<p>Fri Dec 18 11:24:48 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_method.c (rb_method_entry_make, check_override_opt_method): 	  should check whether a newly created method overrides an optimize 	  method in case the method is defined in a prepended module of a 	  built-in class. 	  [ruby-core:72226] [Bug #11836]</p>

<p>Fri Dec 18 11:09:38 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* vm.c (vm_exec): call RUBY_DTRACE_CMETHOD_RETURN_HOOK instead of 	  RUBY_DTRACE_METHOD_RETURN_HOOK.</p>

<p>Fri Dec 18 10:24:44 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/irb/ruby-lex.rb: fixed parse error for striped heredocument syntax. 	  [fix GH-1127] Patch by @koic</p>

<p>Fri Dec 18 09:44:47 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/pty/pty.c: fix double words typo. 	  [ci skip][fix GH-1157] Patch by @jwworth</p>

<p>Fri Dec 18 09:42:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/nkf/nkf-utf8/utf8tbl.c: fix a typo. 	  [ci skip][fix GH-1159] Patch by @akshay-vishnoi 	* ext/nkf/nkf-utf8/utf8tbl.h: ditto.</p>

<p>Fri Dec 18 07:39:01 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm.c (rb_vm_check_redefinition_opt_method): should check the real 	  class instead of the origin iclass. 	  [ruby-core:72188] [Bug #11826]</p>

<p>Thu Dec 17 22:13:10 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_args.c (vm_caller_setup_arg_block): remove code for ifunc 	  because it was made unnecessary by r52138.</p>

<p>Thu Dec 17 16:13:10 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* proc.c (rb_block_arity): should not call GetProcPtr() for symbols. 	  [ruby-core:72205] [Bug #11830]</p>

<p>Thu Dec 17 14:16:29 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_scrub): the result should be infected by the 	  original string.</p>

<p>Thu Dec 17 13:35:27 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* transcode.c (rb_econv_substr_append, econv_primitive_convert): 	  the result should be infected by the original string.</p>

<p>Thu Dec 17 09:46:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* re.c (reg_names_iter): should consider encoding of regexp. 	  [ruby-core:72185] [Bug #11825]</p>

<p>Thu Dec 17 03:52:10 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (vm_make_env_each): should not compare with Qfalse and FALSE. 	  Pointed at <a href="http://d.hatena.ne.jp/nagachika/20151216/ruby_trunk_changes_53128_53163">d.hatena.ne.jp/nagachika/20151216/ruby_trunk_changes_53128_53163</a></p>

<p>Thu Dec 17 03:15:25 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_call_method_each_type): should not set fastpath 	  with keyword arguments for VM_METHOD_TYPE_ATTRSET type methods.</p>

<p>	  Normally, we can not use keyword arguments for this kind of methods, 	  (obj.foo = 1), but we can set alias names for them. 	  [Bug #11657]</p>

<p>	* test/ruby/test_keyword.rb: add a test for this fix.</p>

<p>Wed Dec 16 20:32:43 2015  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* ext/fiddle/handle.c: check tainted string arguments. 	  Patch provided by tenderlove and nobu.</p>

<p>	* test/fiddle/test_handle.rb (class TestHandle): add test for above.</p>

<p>Wed Dec 16 19:30:56 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm.c (vm_make_proc_from_block): should convert a Symbol to a Proc. 	  [ruby-core:72083] [Bug #11811]</p>

<p>Wed Dec 16 16:17:34 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/ruby/test_io.rb: fix spelling errors</p>

<p>Wed Dec 16 16:04:49 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* NEWS: note IO#advise change [ruby-core:72168]</p>

<p>Wed Dec 16 15:35:13 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c: fix mark miss for proc given as passed block. 	  [Bug #11750]</p>

<p>	* vm.c (vm_make_proc_from_block): should return a Proc object 	  if block is given. Previous implementation returns 	  a Proc object only when corresponding Proc object is not 	  available.</p>

<p>	* vm.c (vm_make_env_each): ditto.</p>

<p>	* test/ruby/test_proc.rb: add a test for this bug.</p>

<p>Wed Dec 16 12:24:59 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* test_struct.rb: Test that initialize is overridable [#11708]</p>

<p>Wed Dec 16 10:49:51 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (block_command, block_call): fix <code>&.</code> calls after 	  block_call.  [Feature #11537]</p>

<p>Wed Dec 16 00:53:45 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler): Acquire 	  TimeoutMutex only when accessing @timeout_info for avoiding 	  potential deadlock. [Bug #11742] [ruby-dev:49387]</p>

<p>Wed Dec 16 00:39:27 2015  Jake Worth  &lt;jakeworth82@gmail.com&gt;</p>

<p>	* doc/extension.rdoc: [DOC] fix double-word typo.  [Fix GH-1153]</p>

<p>Wed Dec 16 00:25:41 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler#initialize): 	  TimeoutMutex should be acquired when accessing @timeout_info. 	  To avoid deadlock, interrupt() calls are delayed. 	  Due to the mutex, it is safe to treat ary without ary.dup. 	  [Bug #11742] [ruby-dev:49387]</p>

<p>Tue Dec 15 23:13:10 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* gc.c: Delete excess semicolon after RUBY_ALIAS_FUNCTION(). 	  Suppress “syntax error:  empty declaration” warnings by 	  Oracle Solaris Studio 12.x on Solaris. [Bug #11821]</p>

<p>	* hash.c: ditto, after NOINSERT_UPDATE_CALLBACK().</p>

<p>Tue Dec 15 18:04:04 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* NEWS: added news about EBCDIC encoding</p>

<p>Tue Dec 15 17:57:57 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* enc/ebcdic.h, enc/trans/ebcdic.trans, 	  test/ruby/test_transcode.rb: Fixed encoding name 	  to the correct one in the IANA registry (IBM037) 	  and added an alias (ebcdic-cp-us)</p>

<p>Tue Dec 15 16:19:26 2015  Takashi Kokubun  &lt;takashikkbn@gmail.com&gt;</p>

<p>	* lib/erb.rb: Render erb with array buffer for function call optimization. 	  [fix GH-1143] 	* lib/rdoc/erb_partial.rb: ditto. 	* template/verconf.h.tmpl: ditto.</p>

<p>Tue Dec 15 13:50:05 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_oct): [DOC] mention radix indicators. 	  [ruby-core:71310] [Bug #11648]</p>

<p>Tue Dec 15 12:20:30 2015  Takashi Kokubun  &lt;takashikkbn@gmail.com&gt;</p>

<p>	* lib/erb.rb: Simplify regexp to optimize erb scanner. 	  [fix GH-1144]</p>

<p>Tue Dec 15 11:56:24 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/uri/common.rb: make code block for rdoc. 	  [ci skip][fix GH-1152] Patch by @Tonkpils</p>

<p>Tue Dec 15 11:55:08 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/zlib/zlib.c: fix a typo. 	  [ci skip][fix GH-1149] Patch by @crismali</p>

<p>Tue Dec 15 09:14:14 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* tool/transcode_tablegen.rb: detailed documentation 	  for transcode_tblgen function [ci skip]</p>

<p>Mon Dec 14 22:11:11 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* enc/ebcdic.h: new dummy encoding EBCDIC-US 	* enc/trans/ebcdic.trans: transcodings between EBCDIC-US 	  and iso-8859-1 [with code from Andrea Ribuoli] 	* test/ruby/test_transcode.rb: tests for above 	* tool/transcode_tablegen.rb: additional argument for 	  method transcode_tblgen</p>

<p>Mon Dec 14 17:04:14 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/socket/lib/socket.rb: use safe navigation operator. 	  [fix GH-1142] Patch by @mlarraz 	* lib/drb/extservm.rb: ditto. 	* lib/net/http.rb: ditto. 	* lib/net/http/response.rb: ditto. 	* lib/scanf.rb: ditto. 	* lib/uri/generic.rb: ditto.</p>

<p>Mon Dec 14 17:03:05 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* bootstraptest/runner.rb: use safe navigation operator. 	  [fix GH-1142] Patch by @mlarraz 	* test/openssl/test_pair.rb: ditto. 	* test/ruby/test_econv.rb: ditto. 	* test/ruby/test_settracefunc.rb: ditto. 	* test/thread/test_queue.rb: ditto.</p>

<p>Mon Dec 14 14:33:35 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/xmlrpc.rb: added documentation for parser details. 	  [ci skip][fix GH-1124] Patch by @jrafanie</p>

<p>Mon Dec 14 11:46:52 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* enum.c: fix a typo in documentation. 	  [ci skip][fix GH-1140] Patch by @jutaz 	* io.c: ditto. 	* iseq.c: ditto. 	* numeric.c: ditto. 	* process.c: ditto. 	* string.c: ditto. 	* vm_trace.c: ditto.</p>

<p>Mon Dec 14 11:41:59 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/cgi.rb: fix a typo in documentation. 	  [ci skip][fix GH-1140] Patch by @jutaz</p>

<p>Mon Dec 14 11:31:00 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* compile.c: fix typos. 	  [ci skip][fix GH-1140] Patch by @jutaz 	* dir.c: ditto. 	* gc.c: ditto. 	* io.c: ditto. 	* node.h: ditto. 	* thread_pthread.c: ditto. 	* vm_insnhelper.c: ditto. 	* vsnprintf.c: ditto.</p>

<p>Mon Dec 14 11:27:01 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* enc/iso_2022_jp.h: fix typos. 	  [ci skip][fix GH-1140] Patch by @jutaz 	* enc/utf_16_32.h: ditto. 	* enc/utf_7.h: ditto.</p>

<p>Mon Dec 14 11:25:57 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* benchmark/bm_app_aobench.rb: fix typos. 	  [ci skip][fix GH-1140] Patch by @jutaz 	* benchmark/bm_vm_thread_pipe.rb: ditto.</p>

<p>Sun Dec 13 23:46:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (trace_lex_state): trace lex_state changes if yydebug is 	  set, and send the messages to rb_stdout.</p>

<p>	* parse.y (rb_parser_printf): store YYPRINTF messages per lines 	  so that lex_state traces do not mix.</p>

<p>	* tool/ytab.sed: add parser argument to yy_stack_print too.</p>

<p>Sun Dec 13 20:41:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (build_lex_state_name, trace_lex_state): lex_state is 	  now bit flags and can be set 2 bits or more.</p>

<p>Sun Dec 13 20:26:30 2015  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>	* test/ruby/test_syntax.rb: fix typo in test</p>

<p>Sun Dec 13 20:12:14 2015  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>	* parse.y (parse_percent): Allow %-literals in labeled arg as 	  r51624 did for parentheses. 	  Fixes [ruby-core:72084] [Bug #11812].</p>

<p>Sun Dec 13 20:02:15 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ChangeLog: fix a typo</p>

<p>Sun Dec 13 19:54:26 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/lib/envutil.rb: move envutil&#39;s assertions under Test::Unit::Assertion. 	* test/lib/test/unit/assertions.rb: ditto.</p>

<p>Sun Dec 13 19:24:20 2015  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>	* parse.y (lex_state_name): Make it return the correct names. 	  Add new names to follow r51617; Indices ffs(2) returns are 1-origin.</p>

<p>Sun Dec 13 18:40:45 2015  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>	* parse.y: debug output of lex_state transition if PARSER_DEBUG</p>

<p>Sun Dec 13 18:49:25 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (parse_mode_enc): preserve encoding of mode string in 	  warnings.</p>

<p>	* io.c (io_encname_bom_p): check BOM prefix only, not including 	  UTF prefix.</p>

<p>	* io.c (parse_mode_enc): warn BOM with non-UTF encoding.</p>

<p>	* io.c (parse_mode_enc): fix buffer overflow.</p>

<p>Sun Dec 13 18:35:57 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/fiddle/function.c (initialize): check all arguments first. 	  reported by Marcin &#39;Icewall&#39; Noga of Cisco Talos.</p>

<p>	* ext/fiddle/conversions.h (PTR2NUM): use signed integer to make 	  Fixnum for negative values.</p>

<p>Sun Dec 13 18:33:41 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* pack.c (pack_pack): always check index range against the 	  receiver array length, which can be shortened by elements 	  conversion.  reported by Marcin &#39;Icewall&#39; Noga of Cisco Talos.</p>

<p>Sun Dec 13 18:28:52 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/psych/psych_emitter.c (start_document): should not exceed 	  tags array range.</p>

<p>	* ext/psych/psych_emitter.c (start_document): ensure string before 	  encoding conversion.</p>

<p>Sun Dec 13 18:26:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/tk/tkutil/tkutil.c (tk_hash_kv): check types of array 	  argument.  reported by Marcin &#39;Icewall&#39; Noga of Cisco Talos.</p>

<p>	* ext/tk/tkutil/tkutil.c (cbsubst_table_setup): check length of 	  argument arrays for each access, as callback methods can modify 	  them.  reported by Marcin &#39;Icewall&#39; Noga of Cisco Talos.</p>

<p>	* ext/tk/tkutil/tkutil.c (cbsubst_table_setup): check types of 	  argument elements.  reported by Marcin &#39;Icewall&#39; Noga of Cisco 	  Talos.</p>

<p>Sun Dec 13 18:19:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/win32ole/win32ole.c (ole_vstr2wc): check argument type, vstr 	  must be a String here.  reported by Marcin &#39;Icewall&#39; Noga of 	  Cisco Talos.</p>

<p>Sun Dec 13 16:41:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (BOOTSTRAPRUBY): make BASERUBY full path before 	  building ruby to get rid of unexpectedly invoking built ruby. 	  [ruby-core:72065] [Bug #11807]</p>

<p>	* configure.in (BOOTSTRAPRUBY): use MINIRUBY but not BASERUBY 	  unless cross compiling.  [ruby-core:72065] [Bug #11807]</p>

<p>Sun Dec 13 14:17:19 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* test/test_shellwords.rb (TestShellwords): Add many more tests 	  for handling whitespace characters and frozenness.</p>

<p>Sun Dec 13 14:16:09 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* lib/shellwords.rb (Shellwords#shellsplit): Document that this 	  method does not treat shell metacharacters as such.</p>

<p>Sun Dec 13 12:17:43 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/shellwords.rb (shellescape): duplicate frozen literal 	* test/test_shellwords.rb (test_stringification): new test</p>

<p>Sun Dec 13 11:47:35 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* object.c (rb_inspect): check the default internal encoding as 	  String#inspect do. 	  [ruby-dev:49415] [Bug #11787]</p>

<p>Sun Dec 13 11:38:12 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* lib/shellwords.rb: Turn on frozen-string-literal after fixing 	  shellsplit.</p>

<p>Sun Dec 13 10:44:44 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* KNOWNBUGS.rb: Fixed typo, made more explicit [ci skip]</p>

<p>Sun Dec 13 10:26:47 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ssl_npn_select_cb_common): fix parsing 	  protocol list. 	  The protocol list from OpenSSL is not null-terminated. 	  patched by Kazuki Yamaguchi [Bug #11810] [ruby-core:72082]</p>

<p>Sun Dec 13 06:40:30 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/ostruct.rb: Have OpenStruct#dig raise if argument is not a 	  symbol 	  nor a string. See [#11762]</p>

<p>Sun Dec 13 00:05:42 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_insnhelper.c (vm_call_method_missing): method_missing should 	  not be refined. 	  [ruby-core:72080] [Bug #11809]</p>

<p>Sat Dec 12 23:00:17 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/nkf/nkf-utf8/nkf.c: Merge nkf 2.1.4.</p>

<p>Sat Dec 12 18:52:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* object.c (rb_obj_dig): raise TypeError if an element does not 	  have #dig method.  [ruby-core:71798] [Bug #11762]</p>

<p>Sat Dec 12 17:59:07 2015  Yuichiro Kaneko  &lt;yui-knk@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_regexp.rb: Add test cases for <code>$KCODE</code> and <code>$=</code> warning 	  [Misc #<a href="ruby-dev:49398">11770]</a></p>

<p>Sat Dec 12 17:11:57 2015  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* doc/NEWS-0.2.2: add description about incompatible change in Hash 	  duplicated key overriding policy. [Bug #10315] [Bug #11501]</p>

<p>Sat Dec 12 07:44:38 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* io.c (do_io_advise): do not raise on ENOSYS 	* test/ruby/test_io.rb (test_advise): do not skip on Errno::ENOSYS 	  (test_advise_pipe): ditto 	  [ruby-core:72066] [Feature #11806]</p>

<p>Sat Dec 12 07:05:29 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* enc/windows_1252.c: separate from ISO-8859-1 to fix 0x80..0x9e 	  range.  [ruby-core:64049] [Bug #10097]</p>

<p>Fri Dec 11 23:33:40 2015  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>	* sample/trick2015/: added the award-winning entries of TRICK 2015. 	  See <a href="https://github.com/tric/trick2015">github.com/tric/trick2015</a> for the contest outline.</p>

<p>Fri Dec 11 17:59:05 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* insns.def (opt_case_dispatch): avoid converting Infinity 	* test/ruby/test_optimization.rb (test_opt_case_dispatch_inf): new 	  [ruby-dev:49423] [Bug #11804]&#39;</p>

<p>Fri Dec 11 16:48:57 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* hash.c (rb_num_hash_start): avoid pathological behavior 	  [ruby-core:72028] [Feature #11405]</p>

<p>Fri Dec 11 11:58:46 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* NEWS: Mentioned rubygems-2.5.1</p>

<p>Fri Dec 11 11:52:39 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: Update to RubyGems 2.5.1 	* test/rubygems: ditto.</p>

<p>Fri Dec 11 11:38:14 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each, ibf_load_object_hash): rehash 	  case-dispatch hash to reduce collisions. 	  <a href="http://d.hatena.ne.jp/ku-ma-me/20151210">d.hatena.ne.jp/ku-ma-me/20151210</a></p>

<p>Fri Dec 11 03:44:43 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* object.c (rb_inspect): dump inspected result with rb_str_escape() 	  instead of raising Encoding::CompatibilityError. [Feature #11801]</p>

<p>	* string.c (rb_str_escape): added to dump given string like 	  rb_str_inspect without quotes and always dump in US-ASCII 	  like rb_str_dump.</p>

<p>Thu Dec 10 14:59:59 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/ruby/test_gc.rb (test_expand_heap): relax condition (1-&gt;2).</p>

<p>Thu Dec 10 14:15:59 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* cont.c: fix a double word typo. 	  [Bug #<a href="ruby-core:69749">11313]</a></p>

<p>Thu Dec 10 14:13:34 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/tk/lib/multi-tk.rb: fix typos. 	  [Bug #<a href="ruby-core:71800">11764]</a></p>

<p>Thu Dec 10 11:33:34 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* compile.c (iseq_compile_each): reduce needless rb_str_dup 	  [ruby-core:72018] &lt;5668DB6E.8000101@ruby-lang.org&gt;</p>

<p>Thu Dec 10 09:32:51 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/mkmf.rb, lib/shellwords.rb: disable frozen-string-literal. 	  [ruby-core:72011] [Bug #11800]</p>

<p>Thu Dec 10 06:33:39 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* marshal.c (memsize_dump_arg): remove NULL check 	  (memsize_load_arg): ditto</p>

<p>Thu Dec 10 05:53:18 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/mkconfig.rb: rbconfig must not be frozen-string-literal to 	  expand CONFIG hash.  [ruby-core:72006] [Bug #11798]</p>

<p>Thu Dec 10 05:03:51 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ifaddr.c (ifaddr_mark): remove empty function 	  (ifaddr_type): pass zero to rb_data_type_t.function.dmark</p>

<p>Thu Dec 10 04:49:16 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* proc.c (bm_free): remove, use default free 	  (method_data_type): use RUBY_TYPED_DEFAULT_FREE</p>

<p>Thu Dec 10 02:01:41 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (iseq_compile_each): do not add debug information 	  without –debug or –debug=frozen-string-literal option 	  because String#dup slows down with debug information. 	  [Feature #11725]</p>

<p>	* NEWS: apply about it.</p>

<p>	* test/ruby/test_rubyoptions.rb: catch up this fix with refactoring.</p>

<p>Thu Dec 10 00:06:56 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c: rename methods 	  RubyVM::InstructionSequence#to_binary_format -&gt; #to_binary 	  RubyVM::InstructionSequence.from_binary_format -&gt; .load_from_binary 	  RubyVM::InstructionSequence.from_binary_format_extra_data -&gt; 	                             .load_from_binary_extra_data</p>

<p>	* iseq.c: fix document of iseq.to_binary. 	  [Fix GH-1134]</p>

<p>	* sample/iseq_loader.rb: catch up this change.</p>

<p>	* test/lib/iseq_loader_checker.rb: ditto.</p>

<p>Wed Dec  9 17:02:03 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* regparse.h (SET_NTYPE): get rid of breaking strict aliasing. 	  patch by Zarko Todorovski in [ruby-core:71953].  [Bug #11790]</p>

<p>Wed Dec  9 16:10:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (rb_vm_cref_in_context): Module#define_method in non-class 	  expression should be public. 	  [Bug #11754]</p>

<p>	* test/ruby/test_method.rb: add a test.</p>

<p>Wed Dec  9 14:45:27 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_stacked_objects): fix typo. 	  reported by XIE Zhibang. [Bug #11763]</p>

<p>Wed Dec  9 14:37:51 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* doc/syntax/refinements.rdoc: remove outdated description.</p>

<p>Wed Dec  9 09:58:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/*<strong>/</strong>.c (*_memsize): same as r52986 for extensions.</p>

<p>Wed Dec  9 09:46:19 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* .gitignore: ignored ISeq binary format.</p>

<p>Wed Dec  9 09:34:41 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* *.c (*_memsize): do not check ptr. 	  NULL checking is finished Before call of memsize functions. 	  See r52979.</p>

<p>Wed Dec  9 09:25:29 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/net/smtp/test_response.rb: use Test::Unit. We should use Test::Unit 	  without rubygems and rdoc.</p>

<p>Wed Dec  9 06:26:23 2015  Colin Kelley &lt;colindkelley@gmail.com&gt;</p>

<p>	* lib/uri/generic.rb: enable frozen_string_literal 	  (split_userinfo): remove explicit .freeze for string literals 	  (check_path): ditto 	  (query): ditto 	  (fragment): ditto 	  (to_s): ditto 	  [ruby-core:71910] [Bug #11759]</p>

<p>Wed Dec  9 06:25:47 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/uri/test_generic.rb (to_s): new test 	  [ruby-core:71820]</p>

<p>Wed Dec  9 02:18:52 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (ibf_dump_memsize): should check NULL.</p>

<p>Wed Dec  9 01:46:35 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_init): now accepts new option parameter `encoding&#39;. 	  [Feature #11785]</p>

<p>Wed Dec  9 00:52:37 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_stat_wr, rb_stat_ww): call get_stat only once and 	  reduce checking struct.  patch by Yuki Kurihara in 	  [ruby-core:71949].  [Misc #11789]</p>

<p>Wed Dec  9 00:24:33 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (iseq_ibf_dump): dump extra data just string length.</p>

<p>	* sample/iseq_loader.rb: add using 	  RubyVM::InstructionSequence.from_binary_format_extra_data method 	  (commented out).</p>

<p>Mon Dec  9 00:21:19 2015  Yuki Nishijima  &lt;mail@yukinishijima.net&gt;</p>

<p>	* gems/bundled_gems: Upgrade the did_you_mean gem to 1.0.0.rc1</p>

<p>Wed Dec  9 00:17:49 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (ibf_load_setup): cast to int.</p>

<p>Wed Dec  9 00:13:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (ibf_setup_load): rename to ibf_load_setup().</p>

<p>	* compile.c (iseq_load_setup): check binary format.</p>

<p>Tue Dec  8 23:30:07 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/io/console/test_io_console.rb (run_pty): Avoid waiting twice 	  for a process. Fix Errno::ECHILD in TestIO_Console#test_close and 	  TestIO_Console#test_sync.</p>

<p>Tue Dec  8 23:05:47 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (iseq_ibf_dump): fix for clang type checker.</p>

<p>Tue Dec  8 23:04:02 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (iseq_s_load): fix mysterious bug.</p>

<p>Tue Dec  8 22:31:58 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* introduce new ISeq binary format serializer/de-serializer 	  and a pre-compilation/runtime loader sample. 	  [Feature #11788]</p>

<p>	* iseq.c: add new methods: 	  * RubyVM::InstructionSequence#to_binary_format(extra_data = nil) 	  * RubyVM::InstructionSequence.from_binary_format(binary) 	  * RubyVM::InstructionSequence.from_binary_format_extra_data(binary)</p>

<p>	* compile.c: implement body of this new feature.</p>

<p>	* load.c (rb_load_internal0), iseq.c (rb_iseq_load_iseq): 	  call RubyVM::InstructionSequence.load_iseq(fname) with 	  loading script name if this method is defined.</p>

<p>	  We can return any ISeq object as a result value. 	  Otherwise loading will be continue as usual.</p>

<p>	  This interface is not matured and is not extensible. 	  So that we don&#39;t guarantee the future compatibility of this method. 	  Basically, you shouldn&#39;t use this method.</p>

<p>	* iseq.h: move ISEQ_MAJOR/MINOR_VERSION (and some definitions) 	  from iseq.c.</p>

<p>	* encoding.c (rb_data_is_encoding), internal.h: added.</p>

<p>	* vm_core.h: add several supports for lazy load. 	  * add USE_LAZY_LOAD macro to specify enable or disable of 	    this feature. 	  * add several fields to rb_iseq_t. 	  * introduce new macro rb_iseq_check().</p>

<p>	* insns.def: some check for lazy loading feature.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* proc.c: ditto.</p>

<p>	* vm.c: ditto.</p>

<p>	* test/lib/iseq_loader_checker.rb: enabled iff suitable 	  environment variables are provided.</p>

<p>	* test/runner.rb: enable lib/iseq_loader_checker.rb.</p>

<p>	* sample/iseq_loader.rb: add sample compiler and loader.</p>

<p>	    $ ruby sample/iseq_loader.rb [dir]</p>

<p>	  will compile all ruby scripts in [dir]. 	  With default setting, this compile creates *.rb.yarb files 	  in same directory of target .rb scripts.</p>

<p>	    $ ruby -r sample/iseq_loader.rb [app]</p>

<p>	  will run with enable to load compiled binary data.</p>

<p>Tue Dec  8 21:21:16 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* NEWS: mention about Enumerator::Lazy#grep_v. 	  [ruby-core:71845] [Feature #11773]</p>

<p>Tue Dec  8 17:36:36 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* string.c: removed unused variable</p>

<p>Tue Dec  8 16:23:40 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* enumerator.c (lazy_grep_v): add Enumerator::Lazy#grep_v as well 	  as Enumerable, to enumerate lazily. 	  [ruby-core:71845] [Feature #11773]</p>

<p>Tue Dec  8 14:27:07 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* error.c (name_err_local_variables): new method 	  NameError#local_variables for internal use only. 	  [Feature #11777]</p>

<p>Tue Dec  8 14:20:38 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* marshal.c (w_objivar): skip internal instance variables in 	  T_OBJECT too.</p>

<p>Tue Dec  8 12:58:04 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/io/console/test_io_console.rb (test_getpass): s.getpass 	  should be tested. Narrow ensure block. This reverts r52911. 	  [Bug #11780] [ruby-dev:49412]</p>

<p>Tue Dec  8 10:40:21 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* benchmark/bm_vm2_case_lit.rb: new benchmark 	* compile.c (case_when_optimizable_literal): add nil/true/false 	* insns.def (opt_case_dispatch): ditto 	* vm.c (vm_redefinition_check_flag): ditto 	* vm.c (vm_init_redefined_flag): ditto 	* vm_core.h: ditto 	* object.c (InitVM_Object): define === explicitly for nil/true/false 	* test/ruby/test_case.rb (test_deoptimize_nil): new test 	* test/ruby/test_optimization.rb (test_opt_case_dispatch): update 	  (test_eqq): new test 	  [ruby-core:71923] [Feature #11769] 	  Original patch by Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>Tue Dec  8 10:19:02 2015  Jake Worth  &lt;jakeworth82@gmail.com&gt;</p>

<p>	* lib/optparse.rb: fix double word typo in the document. 	  [Misc #10608] [Fix GH-1126]</p>

<p>Tue Dec  8 09:03:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/date/date_core.c (d_lite_lshift): should check the argument 	  before negation.</p>

<p>Tue Dec  8 08:56:16 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* insns.def (opt_case_dispatch): check Float#=== redefinition 	* test/ruby/test_optimization.rb (test_opt_case_dispatch): new 	  [ruby-core:71920] [Bug #11784]</p>

<p>Tue Dec  8 03:56:05 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/lib/iseq_loader_checker.rb: add iseq dumper/loader checker. 	  If you enable this checker (remove `#&#39; in test/runner.rb), 	  you can see comparison results between an original iseq disassembed 	  result and dumped and loaded iseq disassembed result.</p>

<p>	  There are several bugs around there, because of inexact stack depth 	  calculation. Now, I leave these bugs because they are not critical 	  and difficult to solve completely.</p>

<p>	* test/runner.rb: require test/lib/iseq_loader_checker.rb but 	  disabled at default (commented out).</p>

<p>Tue Dec  8 03:45:47 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* doc/extension.rdoc: warn about kwargs performance in C 	  [Feature #11339] [ci skip]</p>

<p>Tue Dec  8 03:44:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (iseq_load): disable peephole optimization option 	  because apply it multiple times change the sequence. 	  (iseq != peephole_optimize(load(iseq.to_a)))</p>

<p>Tue Dec  8 03:43:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (rb_iseq_build_from_ary): do not allocate table 	  if table_size is 0.</p>

<p>Tue Dec  8 03:30:34 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/unixsocket.c (unix_send_io): document args 	  (unix_recv_io): ditto 	* test/socket/test_unix.rb (test_fd_passing_class_mode): added</p>

<p>Tue Dec 08 02:21:35 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (iseq_translate): at the end of constructing an iseq, 	  call RubyVM::InstructionSequence.translate(iseq) if this method 	  is defined. If the return value is also an object of 	  RubyVM::InstructionSequence, then use it instead of created one.</p>

<p>	  For example, this method is useful to test iseq dumper/loader 	  such as RubyVM::InstructionSequence#to_a and rb_iseq_load().</p>

<p>	  Because this method is for such internal experimental usage, 	  the interface is not matured. For example, this interface has 	  no extensibility. Two or more translators can not run 	  simultaneously.</p>

<p>	  So that we don&#39;t guarantee future compatibility of this method. 	  Basically, do not use this method.</p>

<p>Tue Dec  8 01:57:13 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/psych/*: update psych to 2.0.16 	* test/psych/*: ditto</p>

<p>Mon Dec  7 23:45:20 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* string.c: introduce String#+@ and String#-@ to control 	  String mutability. 	  [Feature #11782]</p>

<p>Mon Dec  7 23:39:49 2015  Ben Miller  &lt;bjmllr@gmail.com&gt;</p>

<p>	* parse.y: add heredoc &lt;&lt;~ syntax.  [Feature #9098]</p>

<p>Mon Dec  7 23:06:16 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* prelude.rb (IO#read_nonblock): [DOC] add missing options to 	  call-seq.  [ruby-core:71627] [Bug #11730]</p>

<p>Mon Dec  7 15:50:50 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* .gitignore: added cygruby*.def for Cygwin</p>

<p>Sun Dec  6 19:52:31 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* include/ruby/intern.h (rb_autoload): deprecate 	* internal.h (rb_autoload_str): declare 	* load.c (rb_mod_autoload): use rb_autoload_str 	* variable.c (rb_autoload): become compatibility wrapper 	  (rb_autoload_str): hoisted out from old rb_autoload 	  [ruby-core:71369] [Feature #11664]</p>

<p>Sun Dec  6 18:25:22 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/webrick/test_cgi.rb (TestWEBrickCGI#test_cgi): gave up the test 	  of binary path info test on Windows because the test had passed 	  occasionally as the comment said.</p>

<p>Sun Dec  6 15:25:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/io/console/console.c (console_getpass): add IO#getpass 	  method.</p>

<p>Sun Dec  6 08:39:05 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/json/json.gemspec: bump version to json 1.8.3. CRuby already contained 	  upstream changes.</p>

<p>	  <a href="https://github.com/ruby/ruby/commit/4d059bf9f5f10f3d3088de49fc87e5555db7770d">github.com/ruby/ruby/commit/4d059bf9f5f10f3d3088de49fc87e5555db7770d</a> 	  <a href="https://github.com/flori/json/commit/d4c99de78905d96c3f301f48b2c789943bb3f098">github.com/flori/json/commit/d4c99de78905d96c3f301f48b2c789943bb3f098</a></p>

<p>	* ext/json/lib/json/version.rb: ditto.</p>

<p>Sat Dec  5 17:48:25 2015  Lars Kanis  &lt;lars@greiz-reinsdorf.de&gt;</p>

<p>	* tool/fake.rb: Fix cross build when srcdir is an absolute path.</p>

<p>	* Makefile.in: PREP dependency is needed when cross build too, not 	  “-r$(arch)-fake” to be  used before created.  [Fix GH-1125]</p>

<p>Sat Dec  5 17:26:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (env_str_new, env_path_str_new): make default string 	  UTF-8 for the case conversion is not possible.  [Bug #8822]</p>

<p>	* hash.c (get_env_cstr): convert non-ASCII string to UTF-8 string.</p>

<p>	* hash.c (ruby_setenv): use wide char version to put environment 	  variable to deal with non-ASCII value.</p>

<p>Sat Dec  5 09:56:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby_atomic.h (ATOMIC_CAS): old value to be swapped should be 	  same as the destination.  immediate value may need type 	  promotion.</p>

<p>	* ruby_atomic.h (ATOMIC_SIZE_CAS): fix the argument order of 	  InterlockedCompareExchange64.  new value and then old value is 	  the last.</p>

<p>Sat Dec  5 09:23:34 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* random.c (fill_random_seed): fix the size to be filled, not the 	  size of element, but the whole size of array.</p>

<p>Sat Dec  5 06:03:54 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* vm.c (ruby_vm_verbose_ptr): make static 	  (ruby_vm_debug_ptr): ditto</p>

<p>Sat Dec  5 00:56:29 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* include/ruby/ruby.h (RB_OBJ_TAINT): follow-up of r52881. 	  Turn into void expression not to use unexpected result. 	  Fix “operands have incompatible types” error with 	  Oracle Solaris Studio 12.x on Solaris.</p>

<p>Fri Dec  4 19:52:52 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* enc/iso_8859_13.c: Added three missing lower/upper-case 	  character pairs (from Kimihito Matsui)</p>

<p>Fri Dec  4 18:57:57 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* enc/iso_8859_4.c: Added missing lower/upper-case character 	  pair (U+014A and U+014B, LATIN CAPITAL/SMALL LETTER ENG) 	  (from Kimihito Matsui)</p>

<p>Fri Dec  4 16:48:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_obj_as_string): fstring should not be infected. 	  re-apply r52872 and fix a typo. 	  TODO: other frozen strings also may not be.</p>

<p>Fri Dec  4 15:21:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: Update to RubyGems 2.5.0+ HEAD(fdab4c4). 	  this version includes #1396, #1397, #1398, #1399 	* test/rubygems: ditto.</p>

<p>Fri Dec  4 11:22:40 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_setname): name must be ascii-compatible, as 	  pthread APIs do not accept legacy wide char strings.</p>

<p>Thu Dec  3 15:39:21 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/scanf.rb: fixed double words typo. 	  [ci skip][fix GH-1123] Patch by @jwworth</p>

<p>Thu Dec  3 15:37:56 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_mixed_unicode_escapes.rb: fixed typo. 	  [fix GH-1122] Patch by @davydovanton 	* test/ruby/test_object.rb: ditto. 	* test/socket/test_tcp.rb: ditto.</p>

<p>Thu Dec  3 15:33:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* sprintf.c (rb_str_format): fix wrong shifting position in 	  Rational conversion when not at the beginning of the result. 	  [ruby-core:71806] [Bug #11766]</p>

<p>Thu Dec  3 14:22:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* range.c (range_to_s): should be infected by the receiver. 	  str2 infects by appending.  [ruby-core:71811] [Bug #11767]</p>

<p>Thu Dec  3 11:57:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in: separate SET_CURRENT_THREAD_NAME, which can set 	  the name of current thread only, and SET_ANOTHER_THREAD_NAME, 	  which can set the name of other threads.</p>

<p>	* thread.c (rb_thread_setname): use SET_ANOTHER_THREAD_NAME.  OS X 	  is not possible to set another thread name.</p>

<p>	* thread_pthread.c (native_set_thread_name, thread_timer): use 	  SET_CURRENT_THREAD_NAME.</p>

<p>Wed Dec 02 22:57:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h, iseq.h: remove rb_iseq_t::variable_body. 	  Fields in rb_iseq_t::variable_body are contained by 	  rb_iseq_t::body::mark_ary (hidden Array object).</p>

<p>	  Index 0 to 2 of mark_ary are reserved by these objects.</p>

<p>	* iseq.c: catch up this fix.</p>

<p>	* compile.c (rb_iseq_original_iseq): trivial rewrite.</p>

<p>Wed Dec  2 17:19:02 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.h: introduce ISEQ_ORIGINAL_ISEQ() and 	  ISEQ_ORIGINAL_ISEQ_ALLOC() macro.</p>

<p>	* compile.c: use them to access original iseq buffer.</p>

<p>	* iseq.c: ditto.</p>

<p>	* vm_core.h: rename iseq field to support this fix.</p>

<p>Wed Dec  2 17:10:32 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.h: introduce ISEQ_FLIP_CNT_INCREMENT() macro.</p>

<p>	* compile.c (iseq_compile_each): use it.</p>

<p>	* vm_core.h: rename flip_cnt field to support this fix.</p>

<p>Wed Dec  2 17:05:15 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.h: introduce ISEQ_COVERAGE() and ISEQ_COVERAGE_SET() macro.</p>

<p>	* compile.c: use them.</p>

<p>	* iseq.c: ditto.</p>

<p>	* iseq.c (rb_iseq_coverage): added.</p>

<p>	* thread.c (update_coverage): use rb_iseq_coverage().</p>

<p>	* vm_core.h: rename coverage field name to support this fix.</p>

<p>Wed Dec  2 17:00:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* encoding.c (enc_name, rb_enc_name_list_i, rb_enc_aliases_enc_i): 	  make fstring instead of making each copies.</p>

<p>Wed Dec  2 16:32:08 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.h: introduce ISEQ_COMPILE_DATA() macro.</p>

<p>	* compile.c, iseq.c: use ISEQ_COMPILE_DATA().</p>

<p>	* vm_core.h: rename compile_data field to support this fix.</p>

<p>Wed Dec  2 16:27:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* encoding.c (enc_m_loader): defer finding encoding object not to 	  be infected by marshal source.  [ruby-core:71793] [Bug #11760]</p>

<p>	* marshal.c (r_object0): enable compatible loader on USERDEF 	  class.  the loader function is called with the class itself, 	  instead of an allocated object, and the loaded data.</p>

<p>	* marshal.c (compat_allocator_table): initialize 	  compat_allocator_tbl on demand.</p>

<p>	* object.c (rb_undefined_alloc): extract from rb_obj_alloc.</p>

<p>Wed Dec  2 15:12:43 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* configure.in: Fixed double negative comments. 	  [Bug #<a href="ruby-core:71506">11698]</a></p>

<p>Wed Dec  2 14:55:01 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test/ruby/test_string.rb: removed non executing tests. 	  [Misc #<a href="ruby-dev:49397">11757]</a></p>

<p>Wed Dec  2 11:23:06 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/csv.rb: enable frozen_string_literal. 	  [fix GH-1116] Patch by @marshall-lee</p>

<p>Wed Dec  2 10:36:25 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c: Fix double word typo. 	  [ci skip][fix GH-1120] Patch by @jwworth</p>

<p>Wed Dec  2 07:43:51 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (mSSLExtConfig): make static 	  (eSSLError): ditto 	  (ID_callback_state): ditto 	  (ossl_ssl_ex_vcb_idx): ditto 	  (ossl_ssl_ex_store_p): ditto 	  (ossl_ssl_ex_ptr_idx): ditto 	* ext/openssl/ossl_ssl.h: remove extern declarations for 	  mSSLExtConfig and eSSLError</p>

<p>Wed Dec  2 07:41:08 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* missing/explicit_bzero.c (explicit_bzero): fixup r52839 	  for compilers with “weak” attribute</p>

<p>Wed Dec  2 06:47:25 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* missing/explicit_bzero.c: add ruby_explicit_bzero_hook_unused 	  for preventing optimization. Inspired from OpenBSD.</p>

<p>Tue Dec  1 23:36:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_setname): allow to reset thread name.</p>

<p>Tue Dec  1 23:14:04 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_setname): check the argument if valid 	  string.  [ruby-core:71774] [Bug #11756]</p>

<p>Tue Dec  1 17:13:41 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_string_value_cstr): should not raise on frozen 	  string.</p>

<p>Tue Dec  1 09:35:29 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* missing/explicit_bzero.c: add a few comment.</p>

<p>Tue Dec  1 09:31:19 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* missing/explicit_bzero.c: add disabling optimization on gcc.</p>

<p>Tue Dec  1 07:50:33 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* missing/explicit_bzero.c: new file. define explicit_bzero. 	  Fixup r52806</p>

<p>Thu Oct 22 12:54:43 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* thread_pthread.c (register_ubf_list): renamed from 	  add_signal_thread_list. 	* thread_pthread.c (unregister_ubf_list): renamed 	  from remove_signal_thread_list. 	* thread_pthread.c (ubf_wakeup_all_threads): renamed from 	  ping_signal_thread_list. 	* thread_pthread.c (ubf_wakeup_thread): renamed from 	  ubf_select_each. 	* thread_pthread.c (ubf_threads_empty): renamed from 	  check_signal_thread_list(). 	* thread_pthread.c (ubf_list_lock): renamed from 	  signal_thread_list_lock.</p>

<p>	* thread_pthread.c (register_ubf_list): large simplification 	  by using ccan/list.h. 	  bonus: removed malloc() and exit(EXIT_FAILURE). 	* thread_pthread.c (unregister_ubf_list): ditto. 	* thread_pthread.c (ubf_threads_empty): ditto. 	* thread_pthread.c (ubf_wakeup_all_threads): ditto.</p>

<p>	* thread_pthread.c (print_signal_list): removed.</p>

<p>Thu Oct 22 08:03:49 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* test/ruby/test_rand.rb (TestRand#test_default_seed): add 	  srand case.</p>

<p>Thu Oct 22 06:33:38 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* random.c (InitVM_Random): move Random::DEFAULT initialization 	  bits to Init_Random_default. 	* random.c (Init_Random_default): renamed from Init_RandomSeed2. 	* random.c (Init_RandomSeedCore): renamed from Init_RandomSeed.</p>

<p>Thu Oct 22 06:20:48 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* random.c (Init_RandomSeed): move all Random::DEFAULT 	  construction bits to Init_RandomSeed2. Random::DEFAULT 	  and Ruby internal hashes are no longer shared their seed. 	* random.c (Init_RandomSeed2): ditto. And, kill evil 	  rb_obj_reveal() stuff.</p>

<p>	* random.c (init_hashseed): add MT argument. 	* random.c: (init_siphash): ditto.</p>

<p>	* test/ruby/test_rand.rb (TestRand#test_default_seed): new 	  test for Random::DEFAULT::seed.</p>

<p>Thu Oct 22 05:23:48 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* random.c (init_hashseed, init_siphash): extract initialize 	  functions.</p>

<p>Thu Oct 22 01:01:34 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* configure.in: sort AC_CHECK_HEADERS() by alphabetical order.</p>

<p>Thu Oct 22 00:19:07 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* random.c (init_randomseed): remove “initial” argument. It never 	  be used from outside of this function.</p>

<p>Thu Oct 22 00:12:33 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* lib/securerandom.rb (SecureRandom::gen_random): use /dev/urandom 	  for initialize OpenSSL&#39;s rand.</p>

<p>Wed Oct 21 12:10:04 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* ext/openssl/ossl_rand.c (ossl_rand_bytes): RAND_bytes could 	  be return -1 as an error. Therefore, added error handling. 	* ext/openssl/ossl_pkey_dsa.c (dsa_generate): ditto.</p>

<p>Wed Oct 21 09:04:09 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* include/ruby/util.h: remove a warning suppression C4723 	  (potential divide by zero) for VisualC++. It&#39;s meaningless. 	  Before r26197, there is ruby_div0() in this place and it 	  actually made divide by zero. But now it&#39;s just garbage.</p>

<p>Wed Oct 21 08:23:36 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* random.c: random_raw_seed don&#39;t use GRND_NONBLOCK. GRND_NONBLOCK 	  mean the result might not have an enough cryptic strength and 	  easy predictable. That&#39;s no good for SecureRandom.</p>

<p>Sun Oct 18 17:26:53 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* common.mk: add a rule for explicit_bzero.o. 	* configure.in: detect explicit_bzero and memset_s. 	* include/ruby/missing.h: add explicit_bzero. 	* random.c (init_randomseed): use explicit_bzero() instead of 	  memset(). memset could be eliminated by compiler optimization.</p>

<p>Mon Nov 30 18:46:44 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/readline/extconf.rb: call dir_config(“libedit”) 	  if –enable-libedit is specified. [Bug #11751] 	  patched by John Hein</p>

<p>Mon Nov 30 08:44:29 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c: remove spurious #define for globals 	  [ruby-core:71735] [Feature #11749]</p>

<p>Sun Nov 29 09:13:03 2015  Conor Landry  &lt;clandry94@gmail.com&gt;</p>

<p>	* NEWS: [DOC] Various grammar corrections and clarifications to 	  increase readability.  [Fix GH-1115]</p>

<p>Sat Nov 28 19:33:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_here_document): store dispatched result of 	  on_tstring_content at the last fragment of a here document.</p>

<p>Fri Nov 27 19:19:44 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/net/http.rb (connect): detect closed connection and reconnect 	  If the server closes a keep-alive http connection, the client socket 	  reaches EOF. To avoid an EOFError, detect the closed connection and 	  reconnect. 	  Added test to ensure HTTP#post succeeds even if the 	  keep-alive-connection has been closed by the server. 	  by Kristian Hanekamp &lt;kris.hanekamp@gmail.com&gt; 	  <a href="https://github.com/ruby/ruby/pull/1089">github.com/ruby/ruby/pull/1089</a> fix GH-1089</p>

<p>Thu Nov 26 21:36:40 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): enable tail call 	  optimization for specialized indexers.</p>

<p>	* compile.c (iseq_compile_each): blockiseq should be NULL, but not 	  Qnil.</p>

<p>Thu Nov 26 17:22:53 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* regcomp.c, regenc.c, regexec.c, regint.h, enc/unicode.c: 	  Merge Onigmo 58fa099ed1a34367de67fb3d06dd48d076839692 	  + <a href="https://github.com/k-takata/Onigmo/pull/52">github.com/k-takata/Onigmo/pull/52</a></p>

<p>Thu Nov 26 09:50:02 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test/coverage/test_coverage.rb: Added test-case for Coverage.restart. 	  [Misc #<a href="ruby-dev:49379">11732]</a></p>

<p>Thu Nov 26 09:46:36 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test/coverage/test_coverage.rb: Added test-case for Coverage.peek_result 	  without Coverage.start. [Misc #<a href="ruby-core:71622">11726]</a></p>

<p>Thu Nov 26 07:22:55 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/openssl/test_ssl.rb (test_copy_stream): new test</p>

<p>Wed Nov 25 21:23:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (copy_stream_body): try to_io conversion before read, 	  readpartial, and write methods.  [ruby-dev:49008] [Bug #11199]</p>

<p>Wed Nov 25 10:55:21 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* io.c (argf_getpartial): should not resize str if the second 	  argument is not given. 	  [ruby-core:71668] [Bug #11738]</p>

<p>Tue Nov 24 23:56:25 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* configure.in: On Solaris, it is safe to define _LARGEFILE_SOURCE 	  when _FILE_OFFSET_BITS=64 is defined (= when 32-bit compile).</p>

<p>Tue Nov 24 10:00:10 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/installer.rb: Fix two double-word typos. 	  [ci skip][fix GH-1108] Patch by @jwworth</p>

<p>Tue Nov 24 09:17:02 2015  Alexander von Gluck IV  &lt;kallisti5@unixzen.com&gt;</p>

<p>	* beos: Drop support for BeOS now that Haiku is stable. 	  [Fix GH-1112]</p>

<p>Tue Nov 24 09:16:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* internal.h (rb_gc_for_fd): move to export, as referred by 	  ext/socket.</p>

<p>Tue Nov 24 09:04:29 2015  David Rodriguez  &lt;deivid.rodriguez@gmail.com&gt;</p>

<p>	* file.c: [DOC] add a missing period to File docs, to terminate 	  the sentence and separate from the next sentence.  [Fix GH-1111]</p>

<p>Tue Nov 24 08:30:06 2015  JuanitoFatas  &lt;katehuang0320@gmail.com&gt;</p>

<p>	* NEWS: Fix the issue number of <code>Struct#dig</code>, which should be 	  [Feature #11688].  [Fix GH-1110]</p>

<p>Tue Nov 24 07:56:54 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (rsock_s_accept): handle ENOMEM</p>

<p>Tue Nov 24 07:50:15 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* dir.c (dir_initialize): use rb_gc_for_fd for ENOMEM 	* ext/socket/init.c (rsock_socket): ditto 	* ext/socket/socket.c (rsock_socketpair): ditto 	* internal.h (rb_gc_for_fd): prototype 	* io.c (rb_gc_for_fd): remove static 	  [ruby-core:71623] [Feature #11727]</p>

<p>Tue Nov 24 06:46:27 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* io.c (rb_gc_for_fd): new helper function 	  (ruby_dup): use rb_gc_for_fd 	  (rb_sysopen): ditto 	  (rb_fdopen): ditto 	  (rb_pipe): ditto 	  [ruby-core:71623] [Feature #11727]</p>

<p>Tue Nov 24 05:13:35 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/fiddle/function.c (struct nogvl_ffi_call_args): 	  new struct for GVL release 	  (nogvl_ffi_call): new function 	  (function_call): adjust for GVL release 	  [ruby-core:71642] [Feature #11607] 	* ext/fiddle/closure.c (struct callback_args): 	  new struct for GVL acquire 	  (with_gvl_callback): adjusted original callback function 	  (callback): wrapper for conditional GVL acquire 	* ext/fiddle/depend: add dependencies 	* ext/fiddle/extconf.rb: include top_srcdir for internal.h 	* internal.h (ruby_thread_has_gvl_p): expose for fiddle 	* vm_core.h (ruby_thread_has_gvl_p): moved to internal.h 	* test/fiddle/test_function.rb (test_nogvl_poll): new test</p>

<p>Mon Nov 23 19:53:12 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* configure.in: On Solaris, with gcc, “-std=iso9899:1999” 	  in $ansi_options is often also needed in CPPFLAGS, 	  because some feature definitions vary depending on such 	  standards options.</p>

<p>Mon Nov 23 12:54:39 2015  Hamish Morrison  &lt;hamishm53@gmail.com&gt;</p>

<p>	* configure.in: remove obsolete workarounds for Haiku.</p>

<p>	* dln.c, file.c, io.c: remove obsolete Haiku workarounds.</p>

<p>	* thread_pthread.c: add stack bounds detection for Haiku.</p>

<p>	* signal.c: get stack pointer from signal context on Haiku. 	  [ruby-core:67923] [Bug #10811] [Fix GH-1109]</p>

<p>Mon Nov 23 11:44:11 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: bump version to minitest-5.8.3</p>

<p>Mon Nov 23 08:55:00 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ChangeLog: fix wrong reference for r52714</p>

<p>Sun Nov 22 22:23:37 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* gc.c (rb_raw_obj_info): fix compile errors when USE_RGENGC 	  is 0.</p>

<p>Sun Nov 22 21:58:09 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* lib/cmath.rb: methods which has suffix &#39;!&#39; are now deprecated. 	  Re-apply r52469 made by Kazuki Tanaka, with fixing bug about 	  mathn.rb compatibility. [ruby-core:68528] [Feature #10974]</p>

<p>Sun Nov 22 19:36:51 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl.c: fix brew command for installation of openssl. 	  [ci skip][fix GH-1107] Patch by @arthurnn</p>

<p>Sun Nov 22 17:59:50 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* configure.in: On Solaris, add -D_XOPEN_SOURCE=n only when both 	  AC_TRY_CPP and AC_TRY_COMPILE pass, because some options 	  (e.g. -std=iso9899:1999) are not set when running C preprocessor 	  or building ext.</p>

<p>Sun Nov 22 16:53:34 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): remove unreachable code 	  chunk after jump/leave.</p>

<p>	* parse.y: move dead code elimination of logical operation to 	  compile.c.  not to warn logical operation of literal constants.</p>

<p>Sun Nov 22 16:37:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): eliminate always/never 	  branches after a literal object and when the value is used after 	  the branch.</p>

<p>Sun Nov 22 01:23:43 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* configure.in: Add -D_XOPEN_SOURCE=500 (or 600 or 700) on Solaris 	  if available, mainly for enabling some features in sockets.</p>

<p>Sun Nov 22 00:17:22 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/socket/test_socket.rb (test/socket/test_socket.rb): skip 	  the test when Socket::SO_TIMESTAMP is not defined. Fix error 	  on Solaris 10. [Bug #11728] [ruby-dev:49377]</p>

<p>Sat Nov 21 18:57:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby.c (need_argument): move frozen-string-literal-debug option 	  from –enable to –debug.  [Feature #11725]</p>

<p>	* ruby.c (proc_options): fix pointer overrun. do not advance argv 	  until it is valid.</p>

<p>Sat Nov 21 13:59:09 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/digest/sha1/extconf.rb: OpenSSL&#39;s struct name for SHA1 is 	  SHA_CTX. <a href="http://openssl.org/docs/man0.9.8/crypto/SHA1.html">openssl.org/docs/man0.9.8/crypto/SHA1.html</a></p>

<p>Sat Nov 21 13:31:52 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* <a href="ch">ext/digest//.</a>: include ruby.h before digest.h to avoid 	  including ext/digest/extconf.h. [Bug #3231] 	  <a href="https://msdn.microsoft.com/library/36k2cdd4.aspx">msdn.microsoft.com/library/36k2cdd4.aspx</a></p>

<p>	* ext/digest/*/extconf.rb: remove ext/digest from include search path 	  to avoid confusion of cl.exe.</p>

<p>	* <a href="ch">ext/digest//.</a>: explicitly specify def.h&#39;s path.</p>

<p>Sat Nov 21 13:05:16 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl.h: LibreSSL doesn&#39;t have and need e_os2.h.</p>

<p>Sat Nov 21 09:18:10 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* thread_sync.c: reduce the specification of Queue#close. 	  * Queue#close accepts no arguments. 	  * deq&#39;ing on closed queue returns nil, always. 	  [Feature #10600]</p>

<p>	* test/thread/test_queue.rb: catch up this fix.</p>

<p>Sat Nov 21 08:44:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (iseq_compile_each): add debug information to NODE_STR 	  strings as default. 	  [Feature #11725]</p>

<p>	* insns.def (freezestring): add new instruction to support adding 	  debug information for dynamically constructed strings.</p>

<p>	* compile.c (iseq_compile_each): support adding debug information 	  for NODE_DSTR with freezestring instruction.</p>

<p>	* error.c (rb_error_frozen): change the debug information ID name 	  id_debug_created_info and this field should have a 2 element array 	  containing path and line information.</p>

<p>	* defs/id.def: ditto.</p>

<p>	* test/ruby/test_rubyoptions.rb: catch up this fix.</p>

<p>	* test/ruby/test_iseq.rb: now frozen strings are not same.</p>

<p>Sat Nov 21 04:34:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* symbol.c (rb_str_intern): should not freeze the receiver itself 	  unexpectedly.  [ruby-core:71611] [Bug #11721]</p>

<p>Fri Nov 20 23:15:18 2015  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>	* lib/logger.rb: expose logger mutex 	  [fix GH-541] Patch by @arthurnn</p>

<p>Fri Nov 20 15:05:28 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* Added missing reference of GitHub</p>

<p>Fri Nov 20 14:57:01 2015  Trevor Rowe  &lt;trevorrowe@gmail.com&gt;</p>

<p>	* lib/net/http.rb: Fixed regression for Net::HTTP::PUT with “Expect-100” 	  header. [fix GH-949] 	* test/net/http/test_http.rb: added test.</p>

<p>Fri Nov 20 14:39:56 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/net/http.rb: set hostname before call ossl_ssl_set_session. 	  [Bug #<a href="ruby-core:70152">11401]</a>[fix GH-964] Patch by @mkarnebeek</p>

<p>Fri Nov 20 12:53:19 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* array.c: clarify docs for take_while/drop_while samples. 	  [ci skip][fix GH-1028] Patch by @leriksen</p>

<p>Fri Nov 20 12:48:04 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/socket/socket.c: remove mention of <code>:UNIX</code> in getaddrinfo(). 	  It&#39;s typically not a support option. 	  [ci skip][fix GH-990] Patch by @eam</p>

<p>Fri Nov 20 12:44:06 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rss/syndication.rb: Add nodoc marker for #validate_sy_updatePeriod. 	  [ci skip][fix GH-1105] Patch by @davydovanton</p>

<p>Fri Nov 20 09:05:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (rb_vm_cref_replace_with_duplicated_cref): added.</p>

<p>	  CREFs should not be shared by methods between `using&#39;. 	  [Bug #11247]</p>

<p>	* vm_insnhelper.c (vm_cref_replace_with_duplicated_cref): ditto.</p>

<p>	* vm.c (vm_cref_dup): should copy refinements correctly.</p>

<p>	* eval.c: use rb_vm_cref_replace_with_duplicated_cref().</p>

<p>	* eval_intern.h: add a decl. of 	  rb_vm_cref_replace_with_duplicated_cref().</p>

<p>	* vm_eval.c (eval_string_with_cref): do not need to pass 	  scope&#39;s CREF because VM can find out CREF from stack frames.</p>

<p>	* test/ruby/test_refinement.rb: add a test.</p>

<p>Fri Nov 20 06:52:53 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* .gitattributes: new file for git users 	  [ruby-core:71578] [Feature #11713]</p>

<p>Thu Nov 19 22:35:31 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/socket/ancdata.c: Check buffer full and ignore MSG_TRUNC flag. 	  buffer fullness is more robust to detect the message is too big for 	  the buffer. 	  AIX 7.1 recvmsg doesn&#39;t set MSG_TRUNC for rflags when MSG_PEEK is 	  given.</p>

<p>Thu Nov 19 21:55:11 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_start): force to invoke GC by GC.start 	  even if it is GC.disable&#39;d.</p>

<p>	* test/ruby/test_gc.rb: add a test.</p>

<p>Thu Nov 19 20:08:59 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: trivial performance improvements.</p>

<p>	    name    modified 	    vm1_gc_short_lived*                1.015 	    vm1_gc_short_with_complex_long*    1.014 	    vm1_gc_short_with_long*            1.000 	    vm1_gc_short_with_symbol*          1.016 	    vm1_gc_wb_ary*                     1.002 	    vm1_gc_wb_ary_promoted*            0.996 	    vm1_gc_wb_obj*                     1.045 	    vm1_gc_wb_obj_promoted*            1.014 	    vm3_gc                             1.021</p>

<p>	* gc.c (gc_writebarrier_generational): reorder parameters to optimize 	  register passing function call.</p>

<p>	* gc.c (gc_writebarrier_incremental): ditto.</p>

<p>	* gc.c (rb_gc_writebarrier): remove LIKELY(). 	  LIKELY() seems to move related functions not better places.</p>

<p>Thu Nov 19 19:45:05 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby.c (ruby_prog_init): [DOC] ARGV does not contain the name of 	  the executable.  [ruby-core:71561] [Bug #11711]</p>

<p>Thu Nov 19 15:53:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* signal.c: should also clear ruby_disable_gc. 	  [Bug #11692]</p>

<p>Thu Nov 19 15:31:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (iseq_compile_each): T_IMEMO/iseq objects should be 	  wrap with ISeq wrappers. [Bug #11676]</p>

<p>Thu Nov 19 15:16:12 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: Update to RubyGems 2.5.0+ HEAD(c6b4946). 	  this version includes #1114, #1314, #1322, #1375, #1383, #1387 	* test/rubygems: ditto.</p>

<p>Thu Nov 19 14:14:37 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (finish_overlapped_socket): return value of this 	  function should be only 0 or SOCKET_ERROR.</p>

<p>Thu Nov 19 14:12:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_tailcall_optimize): apply tail call optimization 	  before conversion to specialized instructions.  when looking 	  back from <code>leave</code> instruction, <code>send</code> instructions have been 	  translated already.</p>

<p>Thu Nov 19 13:57:58 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (finish_overlapped_socket): ignore EMSGSIZE when input, 	  because POSIX platforms just do so.  fixes test errors revealed by 	  r52647.</p>

<p>Thu Nov 19 02:52:30 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_recvmsg_internal): stretch the buffer size 	  only when vmaxdatlen is nil.</p>

<p>Thu Nov 19 02:20:11 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/socket/test_socket.rb (test_udp_recvmsg_truncation): rflags is 	  nil on Solaris 10 which have no HAVE_STRUCT_MSGHDR_MSG_CONTROL. 	  Reported by Naohisa Goto. [ruby-core:71557] [Bug #11709]</p>

<p>Thu Nov 19 01:48:05 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* configure.in: add -static-libgcc for mingw automatically if available.</p>

<p>Thu Nov 19 00:53:26 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/extmk.rb (–extflags): new option to pass EXTLDFLAGS to children, 	  especially exts.mk.</p>

<p>	* common.mk (EXTMK_ARGS): use above option.</p>

<p>Wed Nov 18 22:50:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (rb_class_clear_method_cache): should clear all 	  RCLASS_CALLABLE_M_TBLs of all sub-classes (T_ICLASS).</p>

<p>	  RCLASS_CALLABLE_M_TBL() caches complemented method entries. 	  It should be cleared when the modules are cleared. 	  On previous version clears only for direct children. 	  It is enough for normal modules because corresponding T_ICLASSes 	  are direct children.</p>

<p>	  However, refinements create complex data structure. So that 	  we need to clear all children (and descendants). 	  [ruby-core:71423] [Bug #11672]</p>

<p>	* vm_method.c (rb_clear_method_cache_by_class): rb_mKernel 	  doesn&#39;t call rb_class_clear_method_cache, so that 	  clear child T_ICLASSes.</p>

<p>	* test/ruby/test_refinement.rb: enable disabled test.</p>

<p>Wed Nov 18 21:09:08 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (prepare_callable_method_entry): use 	  RCLASS_CALLABLE_M_TBL() instead of accessing a filed directly.</p>

<p>Wed Nov 18 17:08:18 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: introduce the following field and macros.</p>

<p>	  * rb_method_definition_t::complemented_count to count shared method 	    entries because of complemented method entries and separate from 	    alias_count.</p>

<p>	    Shared `def&#39; only by complemented method entries should not prevent 	    method re-definition warning.</p>

<p>	  * METHOD_ENTRY_COMPLEMENTED(me) to represent complemented method entry. 	  * METHOD_ENTRY_COMPLEMENTED_SET(me) to check it as  complemented me.</p>

<p>	* vm_insnhelper.c (aliased_callable_method_entry): should also 	  check me-&gt;def-&gt;complemented_count.</p>

<p>	* vm_method.c (method_definition_addref_complement): add to count 	  complemented method entries number.</p>

<p>	* vm_method.c (rb_method_definition_release): release `def&#39; iff 	  alias_count == 0 and complemented_count == 0.</p>

<p>	* test/ruby/test_module.rb: add a test.</p>

<p>Wed Nov 18 17:06:19 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_raw_obj_info): fix trivial issues.</p>

<p>	  * support SPECIAL_CONSTs. 	  * fix IMEMO/ment outputs.</p>

<p>Wed Nov 18 11:32:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): eliminate always/never 	  branches after a literal object.  this sequence typically 	  appears by defined? operator for a method call on a local 	  variable.</p>

<p>Wed Nov 18 10:33:06 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_recvmsg_internal): stretch the buffer size 	  when EMSGSIZE occurs on non HAVE_STRUCT_MSGHDR_MSG_CONTROL platforms 	  (such as, Windows).  fixes a test error revealed by r52625.</p>

<p>Wed Nov 18 10:12:36 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_recvmsg_internal): use 4096 as 	  default size to match pre-r52610, which also maps to a common 	  page size.</p>

<p>Wed Nov 18 10:05:25 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* doc/syntax/refinements.rdoc: update documentation to reflect 	  recent changes. 	  [ci skip] [ruby-core:71466] [Misc #11681] Patch by James Adam</p>

<p>Wed Nov 18 09:50:21 2015  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>	* test/logger/test_logdevice.rb: Fix tests of logger to make it work on 	  windows (windows can not remove opened file) [Bug #11702]</p>

<p>Wed Nov 18 06:59:52 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_recvmsg_internal): grow buffer 	  on unspecified maxdatlen 	  [ruby-core:71517] [Bug #11701] 	* ext/socket/lib/socket.rb (Socket#recvmsg): nil default for dlen 	  (Socket#recvmsg_nonblock): ditto 	* test/socket/test_socket.rb (test_recvmsg_udp_no_arg): new test</p>

<p>Tue Nov 17 19:50:06 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (fstat): declare for mingw.</p>

<p>Tue Nov 17 19:02:59 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* configure.in (BASERUBY): use Kernel#print instead of Kernel#p because 	  the baseruby may output CRLF as end of line.</p>

<p>Tue Nov 17 15:34:34 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt; 	* NEWS: Added update from Unicode 7.0.0 to 8.0.0 [ci skip]</p>

<p>Tue Nov 17 15:30:30 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt; 	* enc/unicode/casefold.h, name2ctype.h: Change Unicode 	  Version for regular expressions from 7.0.0 to 	  8.0.0 (with help from Kimihito Matsui) [Feature #11563]</p>

<p>Tue Nov 17 14:36:00 2015  Kenichi Kamiya  &lt;kachick1@gmail.com&gt;</p>

<p>	* lib/ostruct.rb (dig): Implement OpenStruct#dig 	  [Feature #11688]</p>

<p>Tue Nov 17 14:04:14 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/socket/lib/socket.rb (Socket#recvmsg<code>,_nonblock</code>): default values 	  of clen must be nil.</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal): handle nil of clen. 	  fixes test errors introduced at r52602.</p>

<p>Tue Nov 17 13:43:46 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/socket/lib/socket.rb: UNIXSocket is not always exists.  fixes 	  install error on Windows, introduced at r52601.</p>

<p>Tue Nov 17 11:27:23 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/lib/socket.rb (Socket#recvfrom_nonblock): 	  UDPSocket#recvfrom_nonblock): 	  update doc for `exception: false` and destination buffer 	  [ruby-core:69542] [Feature #11229] 	  [ruby-core:69543] [Feature #11242]</p>

<p>Tue Nov 17 11:25:05 2015  Eric Turner  &lt;ericturnerdev@gmail.com&gt;</p>

<p>	* array.c (rb_ary_dig), hash.c (rb_hash_dig): [DOC] Update 	  comments describing dig methods.  [Fix GH-1103]</p>

<p>	* struct.c (rb_struct_dig): [DOC] add rdoc.</p>

<p>Tue Nov 17 11:22:22 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt; 	* NEWS: Small grammatical fix [ci skip]</p>

<p>Tue Nov 17 10:12:30 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/lib/socket.rb (Socket.accept_loop): avoid exceptions 	  (Socket.udp_server_recv): ditto</p>

<p>Tue Nov 17 09:59:00 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal): avoid arg parsing 	  [ruby-core:71439] [Feature #11339] 	  (rsock_bsock_sendmsg): make private, adjust for above 	  (rsock_bsock_sendmsg_nonblock): ditto 	* ext/socket/rubysocket.h: adjust prototypes 	  (rsock_opt_false_p): remove 	* ext/socket/basicsocket.c (rsock_init_basicsocket): 	  define private methods 	* ext/socket/lib/socket.rb (BasicSocket#sendmsg): new wrapper 	  (BasicSocket#sendmsg_nonblock): ditto</p>

<p>Tue Nov 17 09:45:18 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_recvmsg_internal): avoid arg parsing 	  (rsock_bsock_recvmsg): adjust for above change 	  (rsock_bsock_recvmsg_nonblock): ditto 	  [ruby-core:71439] [Feature #11339] 	* ext/socket/rubysocket.h: adjust prototypes for above 	* ext/socket/basicsocket.c (rsock_init_basicsocket): 	  adjust private methods 	* ext/socket/lib/socket.rb (BasicSocket#recvmsg): wrapper method 	  (BasicSocket#recvmsg_nonblock): ditto</p>

<p>Tue Nov 17 08:36:34 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (rsock_s_accept_nonblock): avoid parsing args 	  [ruby-core:71439] [Feature #11339] 	* ext/socket/rubysocket.h: adjust prototype 	* ext/socket/socket.c (sock_accept_nonblock): make private 	* ext/socket/tcpserver.c (tcp_accept_nonblock): ditto 	* ext/socket/unixserver.c (unix_accept_nonblock): ditto 	* ext/socket/lib/socket.rb (Socket#accept_nonblock): 	  implement as wrapper, move RDoc 	  (TCPServer#accept_nonblock): ditto 	  (UNIXServer#accept_nonblock): ditto</p>

<p>Tue Nov 17 08:25:57 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/socket.c (sock_connect_nonblock): 	  avoid argument parsing in C. 	  [ruby-core:71439] [Feature #11339] 	* ext/socket/lib/socket.rb (Socket#connect_nonblock): 	  new wrapper for private method, move RDoc</p>

<p>Tue Nov 17 08:16:09 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (rsock_s_recvfrom_nonblock): 	  avoid arg parsing with C API 	  [ruby-core:71439] [Feature #11339] 	* ext/socket/basicsocket.c (bsock_recv_nonblock): 	  adjust for above change, make private 	* ext/socket/socket.c (sock_recvfrom_nonblock): ditto 	* ext/socket/udpsocket.c (udp_recvfrom_nonblock): ditto 	* ext/socket/lib/socket.rb (BasicSocket#recv_nonblock): 	  new wrapper for private method, move RDoc 	  (Socket#recvfrom_nonblock): ditto 	  (UDPSocket#recvfrom_nonblock): ditto</p>

<p>Mon Nov 16 21:27:54 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/dtrace/helper.rb (Dtrace::TestCase#trap_probe): dtrace buffer 	  size is set as 8m on Solaris (default 4m). [Bug #11697]</p>

<p>Mon Nov 16 20:03:14 2015  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>	* lib/logger.rb: Add Logger#reopen</p>

<p>Mon Nov 16 18:21:52 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* object.c (rb_obj_dig): dig in nested structs too.</p>

<p>	* struct.c (rb_struct_dig): new method Struct#dig. 	  [Feature #11688]</p>

<p>Mon Nov 16 17:41:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): optimize tail calls on aref 	  and aset specialized instructions.</p>

<p>	* compile.c (iseq_peephole_optimize): optimize replaced leave 	  instruction copied to jump instruction too.</p>

<p>Mon Nov 16 16:39:38 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* lib/set.rb: Enable frozen_string_literal.</p>

<p>	* lib/set.rb: Move &lt;&lt; out of the begin block that ensures pop.</p>

<p>Mon Nov 16 16:28:30 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* lib/set.rb (Hash#flatten!, #add?, #delete?, #collect!, #reject!, 	  #select!, #^, #classify): Micro-optimize some methods for 	  performance and readability.</p>

<p>Mon Nov 16 16:17:58 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ChangeLog: fixed accidentally commit.</p>

<p>Mon Nov 16 16:10:51 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* mkconfig.rb: Add some high-level documentation. 	  [ci skip][fix GH-1081] Patch by @ulfalizer</p>

<p>Mon Nov 16 15:59:14 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* proc.c: Add call-seq of <code>Method#super_method</code> 	  [ci skip][fix GH-1094]</p>

<p>Mon Nov 16 15:58:39 2015  Kenichi Kamiya  &lt;kachick1@gmail.com&gt;</p>

<p>	* struct.c: Standardize a method signature of Struct#[]=. 	  [ci skip][fix GH-1095]</p>

<p>Mon Nov 16 15:42:36 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* lib/set.rb (#&gt;=, #&gt;, #&lt;=, #&lt;): Make use of Hash#&gt;=, #&gt;, #&lt;, and 	  #&lt;= when comparing against an instance of the same kind.</p>

<p>Mon Nov 16 15:37:11 2015  Naotoshi Seo  &lt;sonots@gmail.com&gt;</p>

<p>	* lib/logger.rb: Support symbol and string log level setting</p>

<p>Mon Nov 16 15:33:11 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* tool/rbinstall.rb: fix wrong permission for gem specification without 	  zlib runtime. [Bug #<a href="ruby-dev:49343">11685]</a></p>

<p>Mon Nov 16 12:11:11 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/webrick/httpauth/basicauth.rb: fix a typo. 	  [ci skip][fix GH-1099] Patch by @jwworth 	* lib/webrick/httpauth/digestauth.rb: ditto.</p>

<p>Sun Nov 15 18:28:43 2015  Kenichi Kamiya  &lt;kachick1@gmail.com&gt;</p>

<p>	* vm_method.c (set_method_visibility): should fail if the receiver 	  is frozen.  [ruby-core:71489] [Bug #11687]</p>

<p>Sat Nov 14 22:15:07 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/socket/lib/socket.rb: Specify frozen_string_literal: true.</p>

<p>Sat Nov 14 21:44:56 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/time.rb: Use “&lt;&lt;” to reduce string allocation.</p>

<p>Sat Nov 14 17:45:49 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/tsort.rb: Specify frozen_string_literal: true.</p>

<p>Sat Nov 14 17:25:15 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/resolv-replace.rb: Specify frozen_string_literal: true.</p>

<p>Sat Nov 14 17:00:13 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/time.rb: Specify frozen_string_literal: true.</p>

<p>Sat Nov 14 16:43:02 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/open3.rb: Specify frozen_string_literal: true.</p>

<p>Sat Nov 14 05:04:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* node.h: remove old comments.</p>

<p>Sat Nov 14 04:55:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* refactoring CREF related code.</p>

<p>	* eval_intern.h: remove unused setter functions. 	  CREF_CLASS_SET() 	  CREF_NEXT_SET() 	  CREF_SCOPE_VISI_COPY()</p>

<p>	* eval_intern.h: rename flags: 	  * NODE_FL_CREF_PUSHED_BY_EVAL_ -&gt; CREF_FL_PUSHED_BY_EVAL 	  * NODE_FL_CREF_OMOD_SHARED_ -&gt; CREF_FL_OMOD_SHARED 	  and use IMEMO_FL_USER1/2.</p>

<p>	* vm.c (vm_cref_new): accept push_by_eval parameter.</p>

<p>	* vm.c (vm_cref_new_use_prev): added for rb_vm_rewrite_cref().</p>

<p>	* vm_insnhelper.c (vm_cref_push): accept pushed_by_eval parameter.</p>

<p>	* vm_insnhelper.h: remove unused macros: 	  COPY_CREF_OMOD() and COPY_CREF().</p>

<p>	* vm_eval.c, insns.def: catch up this fix.</p>

<p>Sat Nov 14 02:58:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (vm_define_method): refactoring. 	  * get CREF in this function. 	  * cbase is no longer needed (CREF_CLASS(cref) is enough).</p>

<p>	* compile.c: RubyVM::FrozenCore.define_method only accept 2 args.</p>

<p>Sat Nov 14 02:34:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (vm_define_method): do not use current CREF immediately, 	  but check CREF in environment or methods. Methods defined in methods 	  should be public. 	  [Bug #11571]</p>

<p>	* vm_method.c (rb_scope_module_func_check): check CREF in env or me. 	  if CREF is contained by `me&#39;, then return FALSE.</p>

<p>	* test/ruby/test_method.rb: add a test.</p>

<p>Sat Nov 14 02:19:16 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: constify rb_cref_t::scope_visi;</p>

<p>	* eval_intern.h (CREF_SCOPE_VISI_COPY): catch up this fix.</p>

<p>	* vm_method.c: ditto.</p>

<p>Sat Nov 14 01:53:52 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* pack.c (pack_unpack, AVOID_CC_BUG): Very ugly workaround for 	  optimization bug of Oracle Solaris Studio 12.4 on Solaris 	  with -xO4 optimization option. [Bug #11684]</p>

<p>Fri Nov 13 23:00:23 2015  Hiroshi Shirosaki  &lt;h.shirosaki@gmail.com&gt;</p>

<p>	* configure.in: unset LD_PRELOAD on mingw. msys2 child processes 	  crash at make test-all with LD_PRELOAD. 	  [ruby-core:71461] [Bug #11680]</p>

<p>Fri Nov 13 14:00:43 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_pkey.c: Merge ruby/openssl@b9ea8ef [Bug #10735]</p>

<p>Fri Nov 13 13:09:16 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c: Merge ruby/openssl@81e1a30</p>

<p>	* test/openssl/test_ssl.rb: ditto</p>

<p>Fri Nov 13 13:05:37 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* prelude.rb (Thread.exclusive): warn as deprecated.</p>

<p>Fri Nov 13 10:36:39 2015  Victor Nawothnig  &lt;Victor.Nawothnig@gmail.com&gt;</p>

<p>	* parse.y (new_unless): optimize constant condition for <code>unless</code> 	  as well as <code>if</code>.  [Fix GH-1092]</p>

<p>Fri Nov 13 10:08:41 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/psych/psych.gemspec: bump version to 2.0.15</p>

<p>Thu Nov 12 18:44:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_magic_comment): should match exactly. 	  [ruby-core:71460] [Bug #11679]</p>

<p>Thu Nov 12 16:16:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* template/prelude.c.tmpl: enable tail call optimization.</p>

<p>Thu Nov 12 14:17:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_yylex): ANDDOT at the head of the line denote 	  line continuation from previous one to support fluent interface, 	  as well as single dot.</p>

<p>Thu Nov 12 13:49:50 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: Update to RubyGems 2.5.0+ HEAD(db78980). 	  this version includes #1367 , #1373 , #1375 	* test/rubygems: ditto.</p>

<p>Thu Nov 12 10:53:41 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* benchmark/bm_io_nonblock_noex2.rb: new benchmark based 	  on bm_io_nonblock_noex.rb 	* io.c (io_read_nonblock): move documentation to prelude.rb 	  (io_write_nonblock): ditto 	  (Init_io): private, internal methods for prelude.rb use only 	* prelude.rb (IO#read_nonblock): wrapper + documentation 	  (IO#write_nonblock): ditto 	  [ruby-core:71439] [Feature #11339]</p>

<p>Wed Nov 11 18:30:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* sprintf.c (rb_str_format): look up the key, then get default 	  value and raise KeyError if the returned value is nil. 	  [ruby-dev:49338] [Ruby trunk - Bug #11677]</p>

<p>Wed Nov 11 17:38:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (local_var_list_add): skip internal local variable 	  name by its type but not if it has a name.  internal local 	  variable names are just unique per frame, not globally. 	  [ruby-core:71437] [Bug #11674]</p>

<p>Wed Nov 11 14:14:33 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* transcode.c: fix a typo 	[ci skip][fix GH-1091] Patch by @jwworth</p>

<p>Wed Nov 11 11:58:38 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (initialize): Connections are in passive mode per 	  default now.  The default mode can be changed by 	  Net::FTP.default_passive=. 	  [ruby-core:71146] [Feature #11612]</p>

<p>	* lib/net/ftp.rb (default_passive=, default_passive): new methods.</p>

<p>Wed Nov 11 09:03:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* sprintf.c (rb_str_format): respect default value of a hash.  no 	  longer raises KeyError unless the default value of the hash is 	  nil.  [ruby-core:71354] [Bug #11661]</p>

<p>Tue Nov 10 20:35:12 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/open-uri.rb: Remove indicator for “frozen_string_literal: true”.</p>

<p>	* lib/pp.rb: Ditto.</p>

<p>	* lib/prettyprint.rb: Ditto.</p>

<p>	* lib/resolv.rb: Ditto.</p>

<p>	* lib/securerandom.rb: Ditto.</p>

<p>	* lib/tmpdir.rb: Ditto.</p>

<p>	* lib/unicode_normalize/tables.rb: Ditto.</p>

<p>	* test/net/ftp/test_buffered_socket.rb: Ditto.</p>

<p>	* test/net/ftp/test_mlsx_entry.rb: Ditto.</p>

<p>	* test/open-uri/test_open-uri.rb: Ditto.</p>

<p>	* test/open-uri/test_ssl.rb: Ditto.</p>

<p>	* test/pathname/test_pathname.rb: Ditto.</p>

<p>	* test/test_pp.rb: Ditto.</p>

<p>	* test/test_prettyprint.rb: Ditto.</p>

<p>	* tool/transcode-tblgen.rb: Ditto.</p>

<p>	* ext/pathname/lib/pathname.rb: Ditto.</p>

<p>Tue Nov 10 18:42:24 2015  Aleksandrs Ledovskis  &lt;aleksandrs@ledovskis.lv&gt;</p>

<p>	* defs/id.def, parse.y: Switch internal token name to reflect 	  current form of safe-call operator.  [Fix GH-1090]</p>

<p>Tue Nov 10 18:25:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_hash_to_proc): use rb_func_proc_new to make light 	  weight proc.  [Feature #11653]</p>

<p>Tue Nov 10 18:23:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (cfunc_proc_t): add room for me.</p>

<p>	* proc.c (cfunc_proc_new): generalise for cfunc proc without env.</p>

<p>	* proc.c (rb_func_proc_new, rb_func_lambda_new): new functions to 	  make proc/lambda without env from cfunc.</p>

<p>Tue Nov 10 17:32:35 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* bootstraptest/test_fork.rb ([ruby-dev:37934]): <code>:NPROC</code> (RLIMIT_NPROC) 	  is not supported on some platforms (e.g. Solaris 10).</p>

<p>Tue Nov 10 16:57:14 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_hash_to_proc): new method Hash#to_proc. 	  [Feature #11653]</p>

<p>Tue Nov 10 14:34:09 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* time.c (rb_time_timespec_new): swap utc and localtime 	  to generate gmt flag by INT_MAX - gmtoff.</p>

<p>Tue Nov 10 14:01:59 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_hash_<code>le,lt,ge,gt</code>): new methods, Hash#&lt;=, Hash#&lt;, 	  Hash#&gt;=, Hash#&gt;, to test if all elements of a hash are also 	  included in another hash, and vice versa. 	  [ruby-core:68561] [Feature #10984]</p>

<p>Tue Nov 10 11:25:29 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* time.c (rb_timespec_now): added.  [Feature #11558]</p>

<p>	* time.c (rb_time_timespec_new): added.  [Feature #11558]</p>

<p>Tue Nov 10 06:17:17 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (rb_autoload_load): allow recursive calls 	  [ruby-core:71345] [Bug #11658] 	* test/ruby/test_autoload.rb (test_autoload_while_autoloading): 	  new test by: Hiroshi Shirosaki &lt;h.shirosaki@gmail.com&gt; 	  [ruby-core:71390]</p>

<p>Tue Nov 10 00:36:46 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/resolv.rb (Resolv::DNS::Message::MessageEncoder#put_labels): 	  Prevent overflow of pointer to labels. 	  Patch by Hannes Georg.  [ruby-core:71248] [Bug #11632]</p>

<p>Tue Nov 10 00:25:41 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* gems/bundled_gems: update to power_assert 0.2.6.</p>

<p>Mon Nov  9 21:48:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (rb_check_funcall_default): split from 	  rb_check_funcall to return the given fallback value.</p>

<p>	* object.c (rb_obj_dig): use rb_check_funcall_default so that tail 	  call optimization will be possible.  [Feature #11643]</p>

<p>Mon Nov  9 21:27:23 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_dig): new method Array#dig.</p>

<p>	* hash.c (rb_hash_dig): new method Hash#dig.</p>

<p>	* object.c (rb_obj_dig): dig in nested arrays/hashes. 	  [Feature #11643]</p>

<p>Mon Nov  9 18:00:47 2015  Yuki Nishijima  &lt;mail@yukinishijima.net&gt;</p>

<p>	* gems/bundled_gems: Upgrade the did_you_mean gem to 1.0.0.beta3</p>

<p>Mon Nov  9 17:38:14 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/runner.rb: use official repository for coverage tool. 	* Makefile.in: ditto. 	* common.mk: ditto. 	* .gitignore: ignored third party repositories.</p>

<p>Mon Nov  9 17:29:09 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): Dynamic string literals should be 	  frozen. 	  [ruby-core:57574] [Feature #8976]</p>

<p>Mon Nov  9 15:56:07 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* common.mk: Use ruby organization url for simplecov repository.</p>

<p>Sun Nov  8 16:24:09 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* NEWS: describe addition of File::TMPFILE</p>

<p>Sun Nov  8 15:19:17 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* file.c: Add O_TMPFILE.</p>

<p>Sun Nov  8 14:24:43 2015  windwiny  &lt;windwiny.ubt@gmail.com&gt;</p>

<p>	* method.h (METHOD_ENTRY_<code>VISI,BASIC,FLAGS</code>_SET): suppress 	  shift-op-parentheses warnings.  [Fix GH-1082]</p>

<p>Sun Nov  8 14:01:22 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/psych/psych_emitter.c: backport 5bd7744 from tenderlove/psych. 	  support backward compatibility of Ruby 2.0</p>

<p>Sun Nov  8 10:55:10 2015  Anton Davydov  &lt;antondavydov.o@gmail.com&gt;</p>

<p>	* io.c (rb_io_gets_m): Update IO#gets doc for characters more than 	  1 byte.  [Fix GH-1085]</p>

<p>Sun Nov  8 10:37:58 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/uri/ftp.rb: fix a typo. 	  [fix GH-1084][ci skip] Patch by @windwiny</p>

<p>Sun Nov  8 08:10:31 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_trace.c (exec_hooks_precheck): check need_clean everytime 	  to clean-up unused hooks.</p>

<p>	* vm_trace.c (list-&gt;need_clean): use as boolean value.</p>

<p>Sun Nov  8 01:31:27 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/net/http.rb (Net::HTTP#initialize): 	  default value of Net::HTTP#open_timeout is now 60 (was nil).</p>

<p>Sat Nov  7 12:18:05 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* string.c (id_to_s): remove redundant variable 	  (rb_obj_as_string): trade id_to_s for idTo_s 	  (rb_str_equal): replace rb_intern(…) with pre-defined ID 	  (rb_str_cmp_m): ditto 	  (rb_str_match): ditto 	  (str_upto_each): ditto 	  (rb_str_sum): ditto 	  (Init_String): remove id_to_s initialization</p>

<p>Sat Nov  7 11:40:05 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* thread.c (rb_cThreadShield): make static</p>

<p>Sat Nov  7 09:51:38 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_trace.c (rb_threadptr_exec_event_hooks_orig): 	  maintain trace_running counter on internal events.</p>

<p>	  This patch is made by Takashi Kokubun &lt;takashikkbn@gmail.com&gt;. 	  [Bug #11603] <a href="https://github.com/ruby/ruby/pull/1059">github.com/ruby/ruby/pull/1059</a></p>

<p>Sat Nov  7 03:32:27 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* include/ruby/ruby.h (RSTRUCT_PTR): need a close parenthesis.</p>

<p>Sat Nov  7 01:32:06 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* dir.c (dir_fileno, dirfd): support of Dir#fileno on Solaris 10. 	  Solaris 10 does not have dirfd, but the file descriptor of a 	  directory is stored in the d_fd or dd_fd member in the DIR struct. 	  Note that Solaris 11 has dirfd(3C).</p>

<p>	* configure.in: checks for DIR.d_fd and DIR.dd_fd on Solaris 10.</p>

<p>Fri Nov  6 23:13:53 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* array.c: clarifies Array#reject! documentation. 	  [fix GH-894][ci skip] Patch by @GxSplinter</p>

<p>Fri Nov  6 20:18:25 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/runner.rb: extracted test helper. 	* test/lib/zombie_hunter.rb: ditto.</p>

<p>Fri Nov  6 18:07:47 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* include/ruby/ruby.h (rb_array_const_ptr, rb_struct_const_ptr): 	  Suppress pointer type mismatch warnings occurred with old version 	  of Fujitsu C Compiler (fcc) on Solaris 10. The warnings cause 	  failure of TestMkmf::TestConvertible. [Bug #11644] [ruby-dev:49326] 	* include/ruby/ruby.h (FIX_CONST_VALUE_PTR): macro for the above, 	  only effective with fcc.</p>

<p>Fri Nov  6 12:39:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* defs/id.def (token_ops), parse.y (parser_yylex): change DOTQ 	  from “.?” to “&amp;.”.  [ruby-core:71363] [Feature #11537]</p>

<p>Fri Nov  6 09:01:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (kwd_append): fix segv after invalid keyword argument, 	  preceding keyword list is NULL when syntax error is there. 	  [ruby-core:71356] [Bug #11663]</p>

<p>Fri Nov  6 06:59:37 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/ruby/test_autoload: hoist out ruby_impl_require</p>

<p>Thu Nov  5 13:03:58 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* defs/id.def (token_ops): gather associations between IDs, 	  operators, and parser tokens.</p>

<p>Thu Nov  5 10:17:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/socket.c (make_addrinfo): use RARRAY_ASET for 	  write-barrier.</p>

<p>	* ext/tk/tcltklib.c (<code>call,eval,invoke</code>_queue_handler): ditto.</p>

<p>	* ext/tk/tkutil/tkutil.c (ary2list, ary2list2): ditto.</p>

<p>Thu Nov  5 10:09:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/*<strong>/</strong>.c: prefer RARRAY_AREF to indexing RARRAY_CONST_PTR. 	  pointed out by hanmac. 	  <a href="https://github.com/ruby/ruby/commit/3553a86#commitcomment-14187670">github.com/ruby/ruby/commit/3553a86#commitcomment-14187670</a></p>

<p>Wed Nov  4 17:33:24 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/debug.rb: Add documentation for #thread_list_all. 	  [Misc #11580][ci skip]</p>

<p>Wed Nov  4 15:45:59 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* class.c: fix documentation for rb_define_class<code>_id</code>_under. 	  [fix GH-991][ci skip] Patch by @kachick</p>

<p>Wed Nov  4 15:40:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* method.h: fix typo. Patch by @davydovanton 	  [fix GH-1076][ci skip]</p>

<p>Wed Nov  4 15:39:32 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* hash.c: use correct grammar. Patch by @tveastman 	  [fix GH-1079][ci skip]</p>

<p>Wed Nov  4 11:38:23 2015  Jake Worth  &lt;jakeworth82@gmail.com&gt;</p>

<p>	* process.c (proc_getsid): [DOC] Fix double word &#39;for&#39; and typo. 	  [Fix GH-1080]</p>

<p>Wed Nov  4 06:01:52 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* include/ruby/ruby.h (struct RObject): hide iv_index_tbl type 	  [ruby-core:71306] [Feature #11647]</p>

<p>Tue Nov  3 06:48:58 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (find_class_path): remove cast for rb_class_ivar_set 	  (rb_ivar_set): ditto 	  (rb_cvar_set): ditto</p>

<p>Tue Nov  3 06:18:21 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (rb_global_tbl): convert to id_table</p>

<p>Tue Nov  3 01:58:46 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* parse.y (NO_QCALL): fix type mismatch of operands that causes 	  compile error with Oracle Solaris Studio on Solaris. 	  [Bug #11645] [ruby-dev:49327]</p>

<p>Sun Nov  1 17:14:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* id_table.c (mix_id_table_insert): do not touch list during 	  list-&gt;hash transition because GC can run during transition.</p>

<p>Sun Nov  1 11:07:31 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* iseq.c (iseq_memsize): account for rb_call_cache entries</p>

<p>Sun Nov  1 09:12:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_yylex): &#39;:&#39; separated by a comment and a newline 	  is not valid as symbol.</p>

<p>Sat Oct 31 20:15:48 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/openssl/test_pair.rb: skipped tests if openssl doesn&#39;t support 	  ECDH cipher.</p>

<p>Sat Oct 31 14:58:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* man/ruby.1 (SYNOPSIS): remove extraneous space for -F option as 	  it does not allow spaces before its argument. 	  [ruby-core:71283] [Bug #11641]</p>

<p>Sat Oct 31 14:58:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* man/ruby.1 (SYNOPSIS): remove extraneous space for -F option as 	  it does not allow spaces before its argument. 	  [ruby-core:71283] [Bug #11641]</p>

<p>Sat Oct 31 10:22:49 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* eval_error.c (undef_mesg_for): fix typo.  Before this commit 	  `ArgumentError: malformed format string - %$` was raised when 	  <code>NameError#message</code> is called.  [ruby-core:71282] [Bug #11640] 	  [Fix GH-1077]</p>

<p>Fri Oct 30 21:12:45 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* gems/bundled_gems: update to power_assert 0.2.5.</p>

<p>Fri Oct 30 19:29:52 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (newobj_slowpath): do not need to use flags hack (commit miss).</p>

<p>Fri Oct 30 19:08:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (heap_get_freeobj_from_next_freepage): not so UNLIKELY.</p>

<p>Fri Oct 30 18:09:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (newobj_slowpath): reduce 1 parameter to use only registers 	  for performance.</p>

<p>	  On my laptop, &#39;N.times<code>= []</code>&#39; (where N = 29_000_000) is 	  1.86 sec -&gt; 1.74 sec.</p>

<p>Fri Oct 30 12:53:21 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test/ruby/test_call.rb: added test for safe navigation operator. 	  [fix GH-1066]</p>

<p>Fri Oct 30 12:47:34 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ChangeLog: fix wrong commit name.</p>

<p>Fri Oct 30 12:36:16 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* vm_method.c: added documentation of protected/private methods. 	  [fix GH-1072] 	* test/ruby/test_module.rb: added testcase for method_defined? 	  [fix GH-1071]</p>

<p>Fri Oct 30 12:06:59 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* variable.c (rb_class_ivar_set): rename as class specific ivar 	  setter, and st_table is no longer involved.</p>

<p>Fri Oct 30 11:36:33 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (generic_ivar_remove): adjust type, set valp 	  (rb_obj_remove_instance_variable): simplify call 	* test/ruby/test_object.rb (test_remove_instance_variable): 	  expand for implementation details</p>

<p>Fri Oct 30 10:37:56 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* internal.h (rb_st_insert_id_and_value): update prototype 	* variable.c (rb_st_insert_id_and_value): reduce args 	  (find_class_path): adjust call for less args 	  (rb_ivar_set): ditto 	  (rb_cvar_set): ditto 	* class.c (rb_singleton_class_attached): ditto</p>

<p>Fri Oct 30 09:57:22 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: update latest gems. 	  test-unit-3.1.5 and minitest-5.8.2</p>

<p>Fri Oct 30 09:54:05 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: Update to RubyGems HEAD(60d7972). 	  this version contains pull requests number of #1343, #1356, #1357, #1363 	  at <a href="https://github.com/rubygems/rubygems/pulls">github.com/rubygems/rubygems/pulls</a> 	* test/rubygems: ditto.</p>

<p>Fri Oct 30 07:38:29 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* insns.def (getinlinecache/setinlinecache): compare ic-&gt;ic_cref and 	  current cref only when cached CREF list includes singleton class.</p>

<p>	  Singleton classes have own namespaces, so that we need to check 	  cref as a key (#10943).</p>

<p>	  However, if current CREF list does not include singleton class, 	  no need to check CREF because it should be same name space.</p>

<p>	* vm_insnhelper.c (vm_get_const_key_cref): add a function returns 	  CREF only when it includes singleton class.</p>

<p>	* vm_core.h: constify iseq_inline_cache_entry::ic_cref.</p>

<p>Fri Oct 30 06:43:50 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_env_cref): make it inline for performance.</p>

<p>	* vm_insnhelper.c (rb_vm_get_cref): use NULL instead of 0.</p>

<p>Fri Oct 30 06:20:40 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* insns.def: nobody set ic-&gt;ic_value.value to Qundef.</p>

<p>Fri Oct 30 06:15:50 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c: add ifndef guard for VM_CHECK_MODE.</p>

<p>Fri Oct 30 06:13:10 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_check_frame_detail): should require me for 	  VM_FRAME_FLAG_BMETHOD type frame.</p>

<p>Thu Oct 29 18:42:30 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_ptr): specify NOINLINE so that gc_mark() can return 	  immediately when obj is not a markable object.</p>

<p>Thu Oct 29 18:05:22 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* encoding.c (rb_enc_check_str): add for performance. 	  This function only accepts T_STRING (and T_REGEXP).</p>

<p>	  This patch improves performance of a tiny_segmenter benchmark 	  (num=2) 2.54sec -&gt; 2.42sec on my machine. 	  <a href="https://github.com/chezou/TinySegmenter.jl/blob/master/benchmark/benchmark.rb">github.com/chezou/TinySegmenter.jl/blob/master/benchmark/benchmark.rb</a></p>

<p>	* encoding.c: add ENC_DEBUG and ENC_ASSERT() macros.</p>

<p>	* internal.h: add a decl. of rb_enc_check_str().</p>

<p>	* string.c (rb_str_plus): use rb_enc_check_str().</p>

<p>	* string.c (rb_str_subpat_set): ditto.</p>

<p>Thu Oct 29 17:16:40 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: export rb_wb_(un)protected_newobj_of() 	  because some extensions include internal.h.</p>

<p>Thu Oct 29 16:42:19 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_imemo_new): should not pass FL_WB_PROTECTED flag.</p>

<p>	* gc.c (rb_wb_protected_newobj_of): add more assertions.</p>

<p>	* gc.c (rb_wb_unprotected_newobj_of): ditto.</p>

<p>Thu Oct 29 16:20:26 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: introduce rb_wb_unprotected_newobj_of() and 	  rb_wb_protected_newobj_of(), pass the WB_PROTECTED 	  information explicitly.</p>

<p>	* internal.h: use introduced functions by NEWOBJ_OF(). 	  `flag&#39; is immediate value, so that C compilers can 	  solve them at compile time.</p>

<p>	* include/ruby/ruby.h: add a comment about that.</p>

<p>Thu Oct 29 14:52:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: add rb_objspace::flags::has_hook to represent hook availability.</p>

<p>	* gc.c: add gc_event_hook_available_p(objspace) to check that flag.</p>

<p>	* gc.c (newobj_of): use gc_event_hook_available_p() instead of 	  checking gc_event_hook_needed_p(objspace, RUBY_INTERNAL_EVENT_NEWOBJ). 	  for performance.</p>

<p>	* gc.c (newobj_init): add UNLIKELY() for FL_WB_PROTECTED flag.</p>

<p>	* gc.c (newobj_init): change parameters order (trivial change).</p>

<p>Thu Oct 29 14:45:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_core.h (rb_thread_struct): move forward declarations before 	  used.</p>

<p>Thu Oct 29 14:07:54 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_ptr): remove debug code for #11244.</p>

<p>Thu Oct 29 10:08:33 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (struct autoload_state): usable as wait-queue head 	  (struct autoload_data_i): remove 2 words of overhead 	  (autoload_i_mark): remove marking for thread 	  (autoload_reset): adjust for struct changes 	  (rb_autoload): ditto 	  (rb_autoloading_value): ditto 	  (rb_autoload_load): ditto 	  (const_update): ditto</p>

<p>Thu Oct 29 08:48:05 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (struct autoload_data_i): add waitq_head 	  (struct autoload_state): new struct 	  (autoload_require): save result in autoload_state for use 	    in autoload_reset 	  (autoload_reset): wake up other waiters with open-coded 	    wait-queues 	  (rb_autoload_load): add ensure autoload_const_set happens 	    atomically w.r.t. autoload-triggered “require” 	  [ruby-core:70075] [ruby-core:71239] [Bug #11384]</p>

<p>Wed Oct 29 00:39:50 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/rubygems/test_gem_commands_server_command.rb 	  (test_handle_options_port): change port from http to discard. 	  Solaris does not include “http 80/tcp” in its default 	  /etc/inet/services. AFAIK, discard (9/tcp) is older than http 	  and it is expected that all OS can resolve the service name. 	  [Bug #10004] [ruby-core:63518]</p>

<p>Wed Oct 28 23:52:48 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* probes_helper.h (RUBY_DTRACE_HOOK): add RB_GC_GUARD, though paranoic.</p>

<p>Wed Oct 28 15:36:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* error.c (rb_name_err_new): store the receiver directly.</p>

<p>	* error.c (name_err_receiver): return directly stored receiver. 	  [Feature #10881]</p>

<p>	* error.c (name_err_mesg_to_str): quote the name if unprintable.</p>

<p>	* object.c (check_setter_id): use rb_check_id to convert names.</p>

<p>	* variable.c (uninitialized_constant): use NameError::message to 	  keep the receiver of uninitialized constant.  [Feature #10881]</p>

<p>	* error.c (rb_name_err_new): new function to create NameError 	  exception instance.  [Feature #10881]</p>

<p>Wed Oct 28 13:29:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (new_attr_op_assign): fix op_assign type, which is 	  already an ID since r52284.  [Feature #11537]</p>

<p>Tue Oct 27 23:14:14 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* defs/id.def: enable anonymous IDs not to expose internal IDs for 	  frozen-string-literal-debug by Marshal.dump.</p>

<p>Tue Oct 27 17:06:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* defs/id.def: move internal IDs for frozen-string-literal-debug.</p>

<p>Tue Oct 27 16:41:05 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* error.c (rb_error_frozen_object): use rb_attr_get instead of 	  rb_ivar_get to get rid of warnings for string objects created 	  when frozen-string-literal-debug is disabled.</p>

<p>Tue Oct 27 16:18:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/logger.rb (Logger::Period#previous_period_end): as weekly 	  rotation shifts the log file on Sundays, the end date of the 	  previous period should be Saturdays.  fix r45072. 	  [ruby-dev:49314] [Bug #11622]</p>

<p>Tue Oct 27 16:12:37 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* vm_dump.c (rb_print_backtrace): our addr2line doesn&#39;t work on sparc. 	  <a href="http://rubyci.s3.amazonaws.com/unstable11s/ruby-trunk/log/20151027T043311Z.log.html.gz">rubyci.s3.amazonaws.com/unstable11s/ruby-trunk/log/20151027T043311Z.log.html.gz</a></p>

<p>Tue Oct 27 12:00:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/logger.rb (Logger::Period#next_rotate_time): get rid of 	  adding to mday not to exceed the days of the month. 	  [ruby-core:71185] [Bug #11620]</p>

<p>Mon Oct 26 22:43:03 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test/ruby/test_module.rb (test_method_defined): Add test cases 	  for `public/protected/private _method_defined?` 	  These methods accept string as argument, so add string argument 	  cases.  [Fix GH-1067]</p>

<p>Mon Oct 26 22:23:30 2015  SimonDKnight  &lt;simondknight@hotmail.com&gt;</p>

<p>	* lib/racc/rdoc/grammar.en.rdoc: Grammatical errors fixed. 	  [Fix GH-1070]</p>

<p>Mon Oct 26 18:36:43 2015  Shota Fukumori (sora_h) &lt;her@sorah.jp&gt;</p>

<p>	* vm_method.c(rb_method_entry_make): 	  [DOC] [ci skip] Remove a needless space from comment 	  [Fixes GH-1069] Patch by @yui-knk</p>

<p>Mon Oct 26 17:30:13 2015  Ryan Hosford  &lt;tad.hosford@gmail.com&gt;</p>

<p>	* lib/fileutils.rb: rename tailing to trailing. 	  [Misc #11548]</p>

<p>Mon Oct 26 17:11:53 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (call_op, call_op2): fix values on ripper.  [Feature #11537]</p>

<p>Mon Oct 26 12:55:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (call_op2): separate from call_op and also allow “::”, 	  while dot_or_colon should not allow “.?”.  [Feature #11537]</p>

<p>Mon Oct 26 01:03:23 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* thread_pthread.c: fix compile errors when 	  USE_SLEEPY_TIMER_THREAD is disabled.</p>

<p>Sun Oct 25 10:12:05 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* symbol.c (op_tbl): add DOTQ for ripper.  [Feature #11537]</p>

<p>Sat Oct 24 22:51:18 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* configure.in: fixed build failure of Haiku. 	  [fix GH-984] Patch by @kallisti5 	* ext/socket/getaddrinfo.c: ditto. 	* ext/socket/getnameinfo.c: ditto. 	* ext/socket/rubysocket.h: ditto.</p>

<p>Sat Oct 24 21:16:53 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/fileutils/test_fileutils.rb (test_uptodate): relax error 	  message format.  [Feature #9025], [ruby-core:71178] [Bug #11617]</p>

<p>Sat Oct 24 21:06:43 2015  Shota Fukumori (sora_h)  &lt;her@sorah.jp&gt;</p>

<p>	* lib/mkmf.rb: Revert r45640 because it may lead to link 	  with different libruby. [Bug #9760]</p>

<p>Sat Oct 24 15:42:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* bootstraptest/test_method.rb: relax error message format.</p>

<p>	* test/ruby/test_arity.rb (err_mess): ditto. 	  [Feature #9025], [ruby-core:71178] [Bug #11617]</p>

<p>Sat Oct 24 12:47:47 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* vm_insnhelper.c: improved error message for “wrong number 	  of arguments”, distinguishing given and expected argument 	  numbers clearly. [Feature #9025]</p>

<p>Sat Oct 24 11:57:59 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_insnhelper.c: remove the typedef redeclaration of 	  vm_call_handler.</p>

<p>Sat Oct 24 07:29:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/forwardable.rb (def_instance_delegator, def_single_delegator): 	  match backtraces against ::Forwardable in case the target class 	  is a subclass of BasicObject and does not include Kernel. 	  [ruby-core:71176] [Bug #11616]</p>

<p>Sat Oct 24 04:10:13 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (make_compile_option_value): include frozen_string_literal* 	  in a made option value.</p>

<p>	* vm_opts.h: forgot to add OPT_FROZEN_STRING_LITERAL_DEBUG 	  at last commit.</p>

<p>Sat Oct 24 03:58:02 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ruby.c: introduce –enable-frozen-string-literal-debug option. 	  If this option is enabled, the modify error will be: 	    can&#39;t modify frozen String (RuntimeError) =&gt; 	    can&#39;t modify frozen String, created at test.rb:3 (RuntimeError)</p>

<p>	* iseq.h: add compile option frozen_string_literal_debug.</p>

<p>	* compile.c: catch up this fix.</p>

<p>	* error.c (rb_error_frozen): ditto.</p>

<p>	* iseq.c (set_compile_option_from_hash): ditto.</p>

<p>	* test/ruby/test_rubyoptions.rb: add a test for this fix.</p>

<p>Sat Oct 24 02:02:24 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c: introduce new call handler for simple ISeqs.</p>

<p>	  vm_call_iseq_setup_normal_0start() is simple, however it has 	  some loops/conditions depends on ISeq::param.size and 	  ISeq::local_size (in vm_push_frame(), inlined into this function).</p>

<p>	  There are many simple methods which has a few parameters and local 	  variables. So that this patch introduces several special functions 	  generated in vm_call_iseq_optimized.inc by 	  tool/mk_call_iseq_optimized.rb.</p>

<p>	  This script makes 	    vm_call_iseq_setup_normal_0start_Xparams_Ylocals() 	  where X is 0 to 3 and Y is 1 to 6 (as current setting). 	  In this case, X * Y = 24 functions are created.</p>

<p>	  These functions creates fast method dispatch by inlining 	  vm_push_frame() with immediate params/locals sizes.</p>

<p>	  On my laptop, we can have the following results.</p>

<p>	  vm2_method*       1.083 (8.3% faster) 	  vm2_poly_method*  0.961 (3.4% slower)</p>

<p>	  It shows 8.3% faster for inner loop method dispatch (hit inline 	  cache), but 3.4% slower when inline cache miss because we need 	  to find a suitable call handler.</p>

<p>	* common.mk: add a rule for vm_call_iseq_optimized.inc.</p>

<p>	* tool/mk_call_iseq_optimized.rb: added.</p>

<p>	* vm.c: include vm_call_iseq_optimized.inc.</p>

<p>Sat Oct 24 01:58:50 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: define vm_call_handler.</p>

<p>Sat Oct 24 01:56:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h, vm_insnhelper.h: move definition of VMDEBUG 	  from vm_insnhelper.h to vm_core.h.</p>

<p>Sat Oct 24 01:51:01 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* NEWS: [DOC] In the new safe call syntax, arguments are evaluated 	  only if a call is made.</p>

<p>	* doc/syntax/calling_methods.rdoc: Fix a typo.</p>

<p>Sat Oct 24 00:38:34 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/forwardable (def_instance_delegator, def_single_delegator): 	  rescue ::Exception instead of Exception in case Exception is 	  defined under the target class. 	  [ruby-core:71175] [Ruby trunk - Bug #11615]</p>

<p>Fri Oct 23 21:10:37 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* error.c (name_err_mesg_to_str): separate class names from the 	  receiver description.</p>

<p>	* vm_eval.c (make_no_method_exception, raise_method_missing): add 	  format specifiers for class names.</p>

<p>Fri Oct 23 18:10:32 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* .gitignore: ignored environmental wrapper files.</p>

<p>Fri Oct 23 17:55:29 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/irb.rb: Ignored assignment of STDOUT.sync = true 	  when irb.rb loaded. It&#39;s affected to IDE such as Jetbrain. 	  [fix GH-864] Patch by @os97673</p>

<p>Fri Oct 23 16:35:08 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/ipaddr.rb, test/test_ipaddr.rb: Reject invalid address contained 	  EOL string. Patch by @kachick [fix GH-942][Bug #11513]</p>

<p>Fri Oct 23 16:03:26 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* file.c: fix indent style. [fix GH-977] 	* test/ruby/test_string.rb: indent. [fix GH-975] 	  [ci skip] These patches are contributed from @yui-knk</p>

<p>Fri Oct 23 15:46:09 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* string.c: Added method signature to include hash. It&#39;s inconsistency 	  with <code>gsub</code> method signature. 	  [ci skip][fix GH-1023] Patch by @danielevans</p>

<p>Fri Oct 23 15:25:51 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/imap.rb: remove an empty comment line and -*-.</p>

<p>Fri Oct 23 15:20:02 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (gettextfile, getbinaryfile): use the safe 	  navigation operator.</p>

<p>Fri Oct 23 13:51:33 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test_call.rb (test_safe_call): Add test cases for safe 	  navigation operator assignment.  [Fix GH-1064] 	  Validate: 	  * can assign an attribute which is <code>nil</code> 	  * can “or assign” an attribute which is <code>nil</code></p>

<p>Fri Oct 23 11:58:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): optimize lengthy safe 	  navigation method chain.  [Feature #11537]</p>

<p>Fri Oct 23 10:58:41 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/matrix/eigenvalue_decomposition.rb (tridiagonalize): fix 	  indentation to avoid a warning when the command line option -w of 	  ruby is specified.</p>

<p>	* lib/matrix/eigenvalue_decomposition.rb (hessenberg_to_real_schur): 	  change the name of a block parameter to avoid a warning when the 	  command line option -w of ruby is specified.</p>

<p>Fri Oct 23 10:49:36 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): support safe navigation of simple 	  attribute assignment.  [Feature #11537]</p>

<p>	* parse.y (mlhs_node, lhs, attrset_gen): ditto.  keep mid 	  non-attrset as the sign of safe navigation.</p>

<p>Fri Oct 23 07:17:11 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/io/wait/test_io_wait.rb (test_wait_eof): test return value</p>

<p>Fri Oct 23 00:32:02 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ssl_npn_select_cb): explicitly raise error 	  in ext/openssl instead of OpenSSL itself because LibreSSL 	  silently truncate the selected protocol name by casting the length 	  from int to unsigned char. [Bug #11369] 	  Patch by Jeremy Evans &lt;merch-redmine@jeremyevans.net&gt;</p>

<p>Fri Oct 23 00:49:45 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/un.rb (help): change the name of a block parameter to avoid 	  a warning when the command line option -w of ruby is specified.</p>

<p>Fri Oct 23 00:22:20 2015  Josef Simanek  &lt;josef.simanek@gmail.com&gt;</p>

<p>	* string.c (rb_str_tr): [DOC] Escape backslash in String#tr 	  documentation.  [Fix GH-1063]</p>

<p>Fri Oct 23 00:19:04 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* array.c (rb_ary_collect): [DOC] Fix space of code example of 	  Array#map.  [Fix GH-1062]</p>

<p>Thu Oct 22 18:52:53 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* vm_eval.c (rb_f_loop): When a loop is stopped by a StopIteration 	  exception, return what the enumerator has returned instead of 	  nil. [ruby-core:71133] [Feature #11498]</p>

<p>Thu Oct 22 18:25:10 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/imap.rb (idle): add a new argument timeout for keep-alive. 	  [ruby-core:63693] [Bug #10031]</p>

<p>Thu Oct 22 15:30:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_peephole_optimize): peephole optimization for 	  branchnil jumps.</p>

<p>	* compile.c (iseq_compile_each): generate save navigation operator 	  code.</p>

<p>	* insns.def (branchnil): new opcode to pop the tos and branch if 	  it is nil.</p>

<p>	* parse.y (NEW_QCALL, call_op, parser_yylex): parse token &#39;.?&#39;. 	  [Feature #11537]</p>

<p>Thu Oct 22 13:16:19 2015  Guilherme Reis Campos  &lt;guilhermekbsa@gmail.com&gt;</p>

<p>	* dir.c (ruby_brace_expand): glob brace expansion edge case fix. 	  When there are closing braces &#39;}&#39; before a open brace &#39;<code>it 	  must be ignored and considered as literal. 	  [ruby-core:71138] [Bug #11609]</p>

<p>Thu Oct 22 13:13:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (argf_next_argv): check ARGV element type, and try 	  conversion if necessary.  [ruby-core:71140] [Bug #11610]</p>

<p>Thu Oct 22 11:11:16 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* test/net/ftp/test_ftp.rb: add tests for getbinaryfile and 	  gettextfile.</p>

<p>Wed Oct 21 18:34:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_magic_comment): allow a sole magic comment without 	  indicators, neither other non-space comments.  [Feature #8976]</p>

<p>Tue Oct 20 12:17:56 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Add basic argument checking to Prime.prime? 	  [Bug #11606]</p>

<p>Tue Oct 20 12:17:50 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Optimize Integer#prime? 	  Patch by Nick Slocum [Bug #10354]</p>

<p>Tue Oct 20 08:12:47 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* configure.in: pthread_getattr_np is broken on AIX. 	  More specifically, the stack address and size returned are 	  not correct.</p>

<p>Tue Oct 20 05:54:46 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/fiddle/closure.c (callback): static function</p>

<p>Mon Oct 19 10:33:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/init.c (rsock_raise_socket_error): get rid of a glibc 	  bug.  [ruby-core:71100] [Bug #11600]</p>

<p>Mon Oct 19 01:26:26 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* file.c (rb_file_identical_p): not necessary to compare the paths after 	  comparing the file indexes on Windows.  designate by kosaki.</p>

<p>Sun Oct 18 21:17:27 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/open-uri.rb: Specify frozen_string_literal: true.</p>

<p>Sun Oct 18 14:37:56 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* random.c (fill_random_bytes_urandom): add a comment why using 	  O_NONBLOCK and O_NOCTTY.</p>

<p>Sun Oct 18 13:24:17 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* random.c (fill_random_bytes_syscall): use ATOMIC_SET() for 	  updating try_syscall.</p>

<p>Sun Oct 18 13:03:52 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* include/ruby/backward/util.h: Good-by Borland-C.</p>

<p>Sun Oct 18 13:03:09 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* common.mk: add a comment how to use “make test-all”</p>

<p>Sun Oct 18 12:59:22 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* common.mk: add comments how to use “make benchmark”</p>

<p>Sun Oct 18 12:58:15 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/securerandom.rb: Specify frozen_string_literal: true.</p>

<p>Sun Oct 18 11:22:52 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* dln.c: remove defined(__WATCOMC__).</p>

<p>Sun Oct 18 11:16:33 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* lib/mkmf.rb: Good-by Borland-C.</p>

<p>Sun Oct 18 11:04:36 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* numeric.c: Good-by Borland-C. 	* include/ruby/backward/rubyio.h: ditto. 	* include/ruby/backward/st.h: ditto. 	* include/ruby/backward/util.h: ditto. 	* include/ruby/backward/rubysig.h: ditto. 	* include/ruby/backward/classext.h: ditto. 	* dln.c: ditto. 	* gc.c: ditto. 	* win32/resource.rb: ditto. 	* win32/dir.h: ditto. 	* ext/tk/tcltklib.c: ditto. 	* NEWS: announce that Borland-C is no longer supported.</p>

<p>Sun Oct 18 10:54:52 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* dln.c: simplify #ifdef. _WIN32 and __CYGWIN__ are exclusive. 	  see include/ruby/defines.h 	* gc.c: ditto. 	* ext/sdbm/_sdbm.c: ditto.</p>

<p>Sun Oct 18 10:42:19 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* ruby.c (open_load_file): add a comment.</p>

<p>Sun Oct 18 10:12:46 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* file.c (rb_file_identical_p): simplify ifdefs</p>

<p>Sun Oct 18 10:01:40 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* ChangeLog: Good-bye OS/2. 	* common.mk: ditto. 	* configure.in: ditto. 	* dln_find.c: ditto. 	* ext/Setup.emx: ditto. 	* ext/extmk.rb: ditto. 	* ext/socket/extconf.rb: ditto. 	* ext/zlib/extconf.rb: ditto. 	* file.c: ditto. 	* include/ruby/defines.h: ditto. 	* io.c: ditto. 	* lib/mkmf.rb: ditto. 	* missing/os2.c: ditto. 	* process.c: ditto. 	* ruby.c: ditto. 	* NEWS: announce OS/2 is no longer supported.</p>

<p>Sun Oct 18 08:50:15 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* include/ruby/defines.h (DOSISH): add comments.</p>

<p>Sun Oct 18 08:26:51 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* io.c (fptr_finalize): don&#39;t release gvl if fptr is not writable. 	  writable fd may block on close(2) when it&#39;s on NFS. But readonly 	  fd doesn&#39;t. [Bug #11559] 	  result: make benchmark OPTS=“-p bm_require_t -e ruby-trunk -e ruby-2.2.2” 	    build-ruby:             0.171 	    ruby 2.3.0dev(r52151):  0.659 	    ruby 2.2.0p95 (r50295): 0.834</p>

<p>Sun Oct 18 09:32:58 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* file.c (ruby_is_fd_loadable): this should be fail if st_mode is 	  not regular file nor FIFO.</p>

<p>Sun Oct 18 09:20:17 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* ruby.c (open_load_file): use rb_thread_wait_fd() instead of reopen.</p>

<p>Sun Oct 18 05:11:22 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* ruby.c (open_load_file): reset O_NONBLOCK after open. 	  Even if S_ISREG() is true, the file may be file on FUSE filesystem 	  or something. We can&#39;t assume O_NONBLOCK is safe. 	  Moreover, we should wait if the path is point to FIFO. That&#39;s 	  FIFO semantics. GVL should be transparent from ruby script. 	  Thus, just reopen without O_NONBLOCK for filling the requirements. 	  [Bug #11060][Bug #11559]</p>

<p>	* ruby.c (loadopen_func): new for the above.</p>

<p>	* file.c (ruby_is_fd_loadable): new. for checks loadable file type 	  of not. 	* file.c (rb_file_load_ok): use ruby_is_fd_loadble() 	* internal.h: add ruby_is_fd_loadble()</p>

<p>	* common.mk: now, ruby.o depend on thread.h.</p>

<p>	* test/ruby/test_require.rb 	(TestRequire#test_loading_fifo_threading_success): new test. 	  This test successful case that loading from FIFO.</p>

<p>	* test/ruby/test_require.rb 	(TestRequire#test_loading_fifo_threading_raise): rename from 	  test_loading_fifo_threading. You shouldn&#39;t rescue an exception 	  if you test raise or not. 	  Moreover, this case should be caught IOError because load(FIFO) 	  should be blocked until given any input.</p>

<p>Sat Oct 17 13:55:32 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_file_expand_path_internal): concatenate converted 	  string to the result instead of making converted string and 	  append it.</p>

<p>	* string.c (rb_str_cat_conv_enc_opts): from rb_str_conv_enc_opts, 	  separate function to concatenate with transcoding.</p>

<p>Sat Oct 17 13:19:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby.c (load_file): unify each preparations and clean-ups by 	  merging load_file_internal and load_file_internal2, and remove 	  nested rb_protect and rb_ensure.</p>

<p>Sat Oct 17 05:28:32 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/ruby/test_symbol.rb (test_symbol_fstr_leak): add a warm-up 	  code and check RSS to avoid false positive on AIX and false 	  negative on Mac OS X. [Bug #10686]</p>

<p>Fri Oct 16 15:54:37 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_file_load_ok): open in non-blocking mode withoout 	  releasing GVL.  don&#39;t care about others than regular files and 	  directories.  [ruby-dev:49272] [Bug #11559]</p>

<p>	* ruby.c (load_file_internal): ditto.</p>

<p>Thu Oct 15 23:56:03 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (rb_sym_to_proc): make void env.</p>

<p>Thu Oct 15 13:37:23 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (rb_sym_to_proc): move from string.c and create a Proc 	  with no environments.  [ruby-core:71088] [Bug #11594]</p>

<p>Thu Oct 15 01:57:03 2015  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* test/objspace/test_objspace.rb 	  (test_trace_object_allocations_start_stop_clear): clear object 	  allocation table first to get rid of erroneous detection for obj3. 	  [ruby-dev:49095] [Bug #11271]</p>

<p>Thu Oct 15 01:53:38 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* test/ostruct/test_ostruct.rb: Add tests for OpenStruct#respond_to. 	  Patch by @jeremy in [GH-1041]: <a href="https://github.com/ruby/ruby/pull/1041">github.com/ruby/ruby/pull/1041</a></p>

<p>Thu Oct 15 01:49:25 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* lib/ostruct.rb: Finish defining OpenStruct attributes lazily. 	  Patch by @sferik in [GH-1037]: <a href="https://github.com/ruby/ruby/pull/1037">github.com/ruby/ruby/pull/1037</a> 	  This commit is an addendum to <a href="https://github.com/ruby/ruby/pull/1033">github.com/ruby/ruby/pull/1033</a>. 	  It: 	  1. lazily defines attribute accessors for copied and marshaled objects, 	  2. returns nil when an attribute reader is not defined, and 	  3. defines respond_to_missing? to maintain the same respond_to? behavior</p>

<p>Wed Oct 14 16:56:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in: check for libunwind.h, which is not available in 	  very old OS X SDK.  [ruby-core:71080] [Bug #11591]</p>

<p>Wed Oct 14 14:11:42 2015  Brian Black  &lt;bblack@veracode.com&gt;</p>

<p>	* iseq.c (rb_insn_operand_intern): change kw in callinfo disasm from the 	  number of keyword arguments to an ordered list of the keywords used. 	  [Feature #11589]</p>

<p>Wed Oct 14 13:58:44 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_nextc): send a warning to ripper, not to STDERR 	  always.</p>

<p>	* parse.y (rb_warn1, rb_warning1): move argument conversions to 	  callers.  PRIsVALUE is not valid in String#%.</p>

<p>Wed Oct 14 13:37:23 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/racc/rdoc/grammar.en.rdoc: fix spell error. 	  [fix GH-1053][ci skip] Patch by @Matrixbirds</p>

<p>Tue Oct 13 22:06:50 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/socket/raddrinfo.c (rsock_fd_family): Check sa_len.</p>

<p>Tue Oct 13 12:14:10 2015  Craig Davison  &lt;craig65535@gmail.com&gt;</p>

<p>	* ext/socket/rsock_addrinfo (rsock_addrinfo): specify address 	  family.  [Fix GH-1052]</p>

<p>	* ext/socket/udpsocket.c (udp_connect, udp_bind, udp_send): 	  address family by the receiver.</p>

<p>Sun Oct 11 07:09:19 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_push_frame): initialize other than sp (and ep) 	  first for performance.</p>

<p>Sun Oct 11 06:21:50 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_eval.c, internal.h (rb_yield_1): added for performance which 	  doesn&#39;t check Qundef.</p>

<p>	* numeric.c (int_dotimes): use rb_yield_1.</p>

<p>Sun Oct 11 06:19:49 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_call_iseq_setup_normal): setup sp first 	  for performance.</p>

<p>Sun Oct 11 05:29:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (invoke_block_from_c): split this function into several 	  functions.</p>

<p>	* vm_insnhelper.c (vm_yield_callee_setup_arg): remove this function 	  because it is only delegation function.</p>

<p>Sun Oct 11 03:48:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (newobj_of_slowpass): fix typo (pass -&gt; path). 	  Pointed out by Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;.</p>

<p>	* gc.c (newobj_of_…): `of&#39; is unnecessary.</p>

<p>Sat Oct 10 19:04:42 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/udpsocket.c (udp_connect, udp_bind): get open files 	  inside ensure functions.</p>

<p>Sat Oct 10 18:35:12 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_call_method0): do not propagate enable_fastpath, 	  but pass dummy CC to prevent wrong caching.</p>

<p>Sat Oct 10 15:28:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* import a github pull request 	  <a href="https://github.com/ruby/ruby/pull/1050">github.com/ruby/ruby/pull/1050</a> 	  by Kazuho Oku &lt;kazuho@natadeco.co&gt;.</p>

<p>	  This pull request has the following commits.</p>

<p>	* gc.c: reduce # of args to 6 (max. of register args on x86-64) so 	  that the `newobj_of_slowpass` can be called via TCO.</p>

<p>	* gc.c (newobj_of), string.c (str_duplicate): for performance, 	  the hot functions must be inlined.</p>

<p>	* gc.c: for performance, preceding arguments of `.<strong>newobj_of.</strong>` 	  must be same, so that the arg registers can be reused in case of 	  TCO.</p>

<p>Sat Oct 10 08:52:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/udpsocket.c (udp_connect, udp_bind, udp_send): fix 	  memory leaks at closed socket.</p>

<p>Fri Oct  9 17:29:07 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (parse257): refactor.</p>

<p>Fri Oct  9 16:42:26 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/imap.rb: use frozen_string_literal: true.</p>

<p>	* test/net/imap/test_imap.rb: ditto.</p>

<p>	* test/net/imap/test_imap_response_parser.rb: ditto.</p>

<p>Fri Oct  9 15:52:28 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb: use frozen_string_literal: true.</p>

<p>	* test/net/ftp/test_buffered_socket.rb: ditto.</p>

<p>	* test/net/ftp/test_ftp.rb: ditto.</p>

<p>	* test/net/ftp/test_mlsx_entry.rb: ditto.</p>

<p>Fri Oct  9 14:12:35 2015  Shota Fukumori (sora_h)  &lt;her@sorah.jp&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb: Revert r52082 because it was 	  dropping TLS v1.1 support too. Supporting only TLS v1.2 is too 	  early, because many popular websites still don&#39;t support it.</p>

<p>	  For instance, Servers where aws-sdk connects to still don&#39;t support 	  TLS v1.2 and it became broken.</p>

<p>	  We should consider more carefully about this.</p>

<p>	  [Fix GH-873] [Feature #11524]</p>

<p>Fri Oct  9 12:52:08 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): Dynamic string literals (e.g., 	  “#{x</code>”) should not be frozen because they don&#39;t literally 	  represent strings. 	  <a href="https://twitter.com/shugomaeda/status/651937650027401216">twitter.com/shugomaeda/status/651937650027401216</a> 	  <a href="https://twitter.com/yukihiro_matz/status/651942882312482817">twitter.com/yukihiro_matz/status/651942882312482817</a> 	  <a href="https://twitter.com/yukihiro_matz/status/651980835181096960">twitter.com/yukihiro_matz/status/651980835181096960</a></p>

<p>Fri Oct  9 06:52:49 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* benchmark/prepare_require.rb: skip file creation if it already 	  exist. Suggested by ko1.</p>

<p>Fri Oct  9 06:18:04 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt; 	* benchmark/bm_require.rb: new benchmark for require. 	* benchmark/bm_require_thread.rb: new benchmark for conflicting 	  require vs thread. like [Bug #11559] 	* prepare_require.rb: new file for preparing above tests. 	* prepare_require.rb: ditto.</p>

<p>Thu Oct  8 14:10:45 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb: Default to TLSv1.2 and drop TLS v1 	  Patch provided by @claudijd [Fixes GH-873] [Feature #11524]: 	  <a href="https://github.com/ruby/ruby/pull/873">github.com/ruby/ruby/pull/873</a></p>

<p>Wed Oct  7 22:55:02 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/minitest/metametameta.rb (with_output): restore output to 	  fix mixing test result output in worker responses.</p>

<p>Wed Oct  7 21:32:51 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (str_duplicate): move from rb_str_resurrect to short 	  circuit initialization.</p>

<p>Wed Oct  7 20:43:14 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_resurrect): fix resurrection of short enough to 	  be embedded but not embedded string.</p>

<p>Wed Oct  7 20:17:29 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (newobj_of): divide fast path and slow path 	  to avoid register savings for fast path.</p>

<p>	  This idea is given by Kazuho Oku &lt;kazuho@natadeco.co&gt;.</p>

<p>Wed Oct  7 17:30:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_times): optimize for the argument 0 and 1.</p>

<p>Wed Oct  7 01:20:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.h, gc.c: introduce new debug function rb_obj_info_dump(VALUE obj) 	  which prints the result of rb_raw_obj_info(…, obj).</p>

<p>Wed Oct  7 01:16:11 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_args.c: remove an unused field args_info::calling.</p>

<p>Tue Oct  6 23:43:10 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (rb_method_entry_min_max_arity): should support 	  OPTIMIZED_METHOD_TYPE_CALL.</p>

<p>Tue Oct  6 21:29:08 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/tmpdir.rb (Dir.tmpdir): return duplicated string to be 	  modify safely even when $SAFE &gt; 0.</p>

<p>Tue Oct  6 19:24:38 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_call_method0): use switch() for visibilities 	  (for readability).</p>

<p>Tue Oct  6 19:23:58 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (Init_Proc): Proc#call and others should be public.</p>

<p>Tue Oct  6 18:51:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: IMEMO_FL_USER3 and IMEMO_FL_USER4 is not needed any more.</p>

<p>Tue Oct  6 18:47:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: remove METHOD_ENTRY_SAFE(me) and related code 	  because $SAFE = 3 and 4 is not available. 	  Now, $SAFE is not checked on method dispatch at all.</p>

<p>	* vm_eval.c, vm_insnhelper.c, vm_method.c: ditto.</p>

<p>Tue Oct  6 13:56:14 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h: turn function macros into inline functions, 	  for debuggers.</p>

<p>	* include/ruby/ruby.h: turn constant macros into enums, for 	  debuggers.</p>

<p>Tue Oct  6 13:48:05 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* method.h: typo fix. Patch by @davydovanton [fix GH-1032][ci skip]</p>

<p>Tue Oct  6 06:54:34 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (rb_iseq_free): free iseq::variable_body to avoid memory 	  leak.</p>

<p>Tue Oct  6 06:32:52 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c: enable optimization of Proc#call. 	  [Feature #11569]</p>

<p>	* NEWS: write about this optimization and incompatibilities.</p>

<p>	* test/ruby/test_backtrace.rb: catch up this fix.</p>

<p>Tue Oct  6 04:41:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c: solve goto spaghetti.</p>

<p>	  Change all goto statement across blocks to tail call functions.</p>

<p>Tue Oct  6 02:29:38 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_resurrect): optimize by short circuit to copy 	  hidden string without checking length, encoding and so on.</p>

<p>Mon Oct  5 23:08:17 2015  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_thread.rb (test_handle_interrupt_blocking): check if 	  exception handling was postponed until sleep.</p>

<p>Mon Oct  5 22:25:49 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/pp.rb: Use frozen_string_literal: true.</p>

<p>	* lib/prettyprint.rb: Ditto.</p>

<p>	* lib/resolv.rb: Ditto.</p>

<p>	* lib/tmpdir.rb: Ditto.</p>

<p>	* test/test_pp.rb: Ditto.</p>

<p>	* test/test_prettyprint.rb: Ditto.</p>

<p>	* tool/transcode-tblgen.rb: Ditto.</p>

<p>Mon Oct  5 20:39:32 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* test/ruby/test_thread.rb: fix potential race condition. 	  The thread could have a “sleep” status because it tries 	  to acquire the mutex, but does not have it yet.</p>

<p>Mon Oct  5 15:39:30 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* numeric.c: [DOC] Overview for Numeric class by Joe Corcoran 	  This patch was created at ROSSConf Berlin 2015 [Bug #11555]</p>

<p>Mon Oct  5 15:34:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (proc_new): link ep to calling block. 	  [ruby-core:70980] [Bug #11566]</p>

<p>Mon Oct  5 00:53:51 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (rb_dir_getwd): make ASCII-8BIT if filesystem encoding is 	  US-ASCII, like as Dir.glob.</p>

<p>Sun Oct  4 23:39:09 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* enum.c (nmin_filter): Fix limit value. 	  patch by Helder Pereira. 	  [Bug #11471] [ruby-core:70477]</p>

<p>Sun Oct  4 15:11:48 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* enc/euc_jp.c (mbc_case_fold): check given string is valid or not, 	  and if invalid, return 1. [Bug #11486]</p>

<p>Sun Oct  4 10:09:57 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (rb_dir_getwd): normalize OS path to UTF-8 on OS X.</p>

<p>Sun Oct  4 00:09:45 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* template/ruby-runner.c.in: wrapper to set dynamic loading path 	  environment variable.  /bin/sh on Mac OS X 10.11 (El Capitan) 	  clears DYLD_LIBRARY_PATH.</p>

<p>	  it must: 	  - do nothing even if current directory is not present 	  - do not set other environment variables, e.g. PWD, SHLVL, etc 	  - do not open other FDs, e.g. pipes for timer thread</p>

<p>Sun Oct 2 10:59:00 2015  schneems  &lt;richard.schneeman@gmail.com&gt;</p>

<p>	* ext/pathname/lib/pathname.rb: freeze string literals for 	  reduced object allocation. 	  [Feature #11375] [ruby-core:70043]</p>

<p>Fri Oct  2 09:20:20 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* common.mk, lib/unicode_normalize/tables.rb: Change Unicode 	  Version for character normalization data from 7.0.0 to 	  8.0.0.</p>

<p>Fri Oct  2 00:18:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (proc_mark): block.ep of Proc from Symbol is now NULL. 	  [ruby-core:70961] [Bug #11560]</p>

<p>Wed Sep 30 15:47:13 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_args.c (vm_caller_setup_arg_block): bypass Symbol#to_proc 	  call to optimize symbol block passing.</p>

<p>Wed Sep 30 01:34:34 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_free): fix memory leak at syntax error when 	  warn-indent is enabled.</p>

<p>Tue Sep 29 22:27:50 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* parse.y: fix minor typo. [ci skip][fix GH-1038]. 	  Patch by @ltratt.</p>

<p>Tue Sep 29 16:53:53 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* tool/unicode_norm_gen.tmpl, lib/unicode_normalize/tables.rb: 	  get rid of many .freeze commands by using frozen_string_literal 	  pragma.</p>

<p>Tue Sep 29 16:37:29 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (compile_dstr_fragments): fix performance by omitting 	  the first empty string only for keeping literal encoding if 	  other literals are too.  [ruby-core:70930] [Bug #11556]</p>

<p>	* string.c (rb_str_append_literal): append but keep encoding non 	  US-ASCII.</p>

<p>Mon Sep 28 17:40:17 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (mtime): use usec instead of fractions to parse 	  decimal fractions of a second correctly when the number of digits 	  is not 6.</p>

<p>Mon Sep 28 16:07:08 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (mtime): parse decimal fractions of a second as 	  specified in RFC 3659.</p>

<p>Mon Sep 28 10:31:12 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/test_forwardable.rb: Write basic tests for lib/forwardable. 	  [fix GH-1035] Patch by @kachick</p>

<p>Sun Sep 27 23:32:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* class.c (rb_define_class, rb_define_class_id_under): refine 	  error messages.</p>

<p>	* class.c (rb_define_module, rb_define_module_id_under): ditto, 	  and make consistent with class.</p>

<p>Sun Sep 27 18:44:43 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ChangeLog: removed duplicated message.</p>

<p>Sun Sep 27 15:46:58 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby.c (process_options): add an option to enable/disable 	  frozen-string-literal.  [Feature #8976]</p>

<p>	* compile.c (iseq_compile_each): override compile option by option 	  given by pragma.</p>

<p>	* iseq.c (rb_iseq_make_compile_option): extract a function to 	  overwrite rb_compile_option_t.</p>

<p>	* parse.y (parser_set_compile_option_flag): introduce pragma to 	  override compile options.</p>

<p>	* parse.y (magic_comments): new pragma “frozen-string-literal”. 	  [Feature #8976]</p>

<p>Sun Sep 27 08:16:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/ostruct.rb (delete_field): do not raise NameError for 	  existing keys.  [Fix GH-1033]</p>

<p>Sun Sep 27 00:34:31 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* lib/ostruct.rb: Move method definitions for getter/setter to be lazy 	  Patch by @sferik in [GH-1033]: <a href="https://github.com/ruby/ruby/pull/1033">github.com/ruby/ruby/pull/1033</a></p>

<p>Fri Sep 25 10:07:25 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/net/http.rb: removed unused variable. It&#39;s removed at r13648. 	  [fix GH-1022] Patch by @nkondratyev</p>

<p>Fri Sep 25 09:48:27 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: upgrade to minitest-5.8.1</p>

<p>Fri Sep 25 09:47:12 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* id_table.c: fix typo. [ci skip][fix GH-1031] Patch @davydovanton</p>

<p>Fri Sep 25 07:54:05 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/gdbm/test_gdbm.rb (TestGDBM#test_s_open_lock): skip 	  this test on AIX. The issue is the same as on Solaris. 	  [ruby-dev:47631]</p>

<p>Thu Sep 24 17:25:09 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (paren_args): fix separator token at <code>foo::bar()</code> in 	  ripper.</p>

<p>Thu Sep 24 00:00:17 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* complex.c: ruby/config.h must be included before math.h 	  because it defines _LARGE_FILES on AIX and _LARGE_FILES 	  must be defined before sys/types.h is included from math.h. 	  [Bug #11483]</p>

<p>Wed Sep 23 22:22:38 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_pkcs12*: Remove svn commit id macro</p>

<p>Wed Sep 23 01:11:28 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* ext/openssl/*: Remove svn commit id macros to make sync easier</p>

<p>Tue Sep 22 04:20:01 2015  Masatoshi SEKI  &lt;m_seki@mva.biglobe.ne.jp&gt;</p>

<p>	* test/drb/test_drb.rb: Run Rinda/DRb tests on localhost. [Fix GH-1027] 	  patch by voxik.</p>

<p>	* test/rinda/test_rinda.rb: ditto</p>

<p>Mon Sep 21 20:53:39 2015  tbpgr  &lt;tbpgr@tbpgr.jp&gt;</p>

<p>	* test/win32ole/test_win32ole_event.rb: fix typo. 	  swbemsink_avairable? =&gt; swbemsink_available?  [Fix GH-1025]</p>

<p>Sun Sep 20 10:07:35 2015  Anton Davydov  &lt;antondavydov.o@gmail.com&gt;</p>

<p>	* cont.c (rb_callcc): [DOC] append continuations example accros 	  methods.  [Fix GH-1026]</p>

<p>Sun Sep 20 03:20:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (rb_iseq_free): free rb_iseq_t::body::cc_entries.</p>

<p>Sun Sep 20 02:46:34 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: split rb_call_info_t into several structs. 	  * rb_call_info (ci) has compiled fixed information. 	  * if ci-&gt;flag &amp; VM_CALL_KWARG, then rb_call_info is 	    also rb_call_info_with_kwarg. This technique reduce one word 	    for major rb_call_info data. 	  * rb_calling_info has temporary data (argc, blockptr, recv). 	    for each method dispatch. This data is allocated only on 	    machine stack. 	  * rb_call_cache is for inline method cache.</p>

<p>	  Before this patch, only rb_call_info_t data is passed. 	  After this patch, above three structs are passed.</p>

<p>	  This patch improves: 	  * data locality (rb_call_info is now read-only data). 	  * reduce memory consumption (rb_call_info_with_kwarg, 	    rb_calling_info).</p>

<p>	* compile.c: use above data.</p>

<p>	* insns.def: ditto.</p>

<p>	* iseq.c: ditto.</p>

<p>	* vm_args.c: ditto.</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* vm_insnhelper.h: ditto.</p>

<p>	* iseq.h: add iseq_compile_data::ci_index and 	  iseq_compile_data::ci_kw_index.</p>

<p>	* tool/instruction.rb: introduce TS_CALLCACHE operand type.</p>

<p>Sun Sep 20 02:18:10 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/lib/envutil.rb: mkfifo command based File.mkfifo method 	  definition removed.</p>

<p>Fri Sep 18 20:11:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_file_s_mkfifo): implement File.mkfifo. 	  [Feature #11536]</p>

<p>Fri Sep 18 16:56:19 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* NEWS: add Net::FTP#mlst and Net::FTP#mlsd.</p>

<p>Fri Sep 18 07:39:22 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/objspace/objspace_dump.c (obj_type): add IMEMO types to the heap 	  dump information.</p>

<p>Thu Sep 17 22:33:07 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* common.mk: fix command error with outside builddir.</p>

<p>Thu Sep 17 17:42:09 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* common.mk: separated test for test-framework from test-all task. 	  They should be invoke at first before tests of test-all.</p>

<p>Thu Sep 17 12:05:54 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* test/ruby/test_dir.rb (TestDir#test_fileno): s/?x/“x”/. Don&#39;t 	  use tricky code, please.</p>

<p>Wed Sep 16 20:49:56 2015  Masaki Suketa  &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* encindex.h: fix typo of last #endif comment. [ci skip]</p>

<p>Wed Sep 16 20:39:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* variable.c (set_const_visibility): fail if the class/module is 	  frozen.  [ruby-core:70828] [Bug #11532]</p>

<p>Wed Sep 16 17:16:43 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_core.h (ENABLE_VM_OBJSPACE): enable per-VM object space on 	  Windows by default, as rb_w32_sysinit() no longer depends on 	  ruby_xmalloc.</p>

<p>Wed Sep 16 15:08:17 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* doc/syntax/literals.rdoc (Strings): [DOC] Revise the character 	  literal part.</p>

<p>Wed Sep 16 14:55:33 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* doc/syntax/literals.rdoc (Strings): [DOC] Document the full list 	  of supported escape sequences in string literals.</p>

<p>Wed Sep 16 14:49:58 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_setbyte): keep the code range as possible.</p>

<p>Wed Sep 16 13:23:48 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* doc/syntax/literals.rdoc (Strings): mention about ?a literal.</p>

<p>Wed Sep 16 12:06:53 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* dir.c (glob_helper): check pathtype once again by lstat(2) if 	  dp-&gt;d_type is DT_UNKNOWN. XFS may return DT_UNKNOWN.</p>

<p>Wed Sep 16 03:49:19 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* test/ruby/test_thread.rb (TestThread#test_mutex_synchronize): 	  insert waste loop for invoking preemptive thread context switch. 	  [Bug #11496]</p>

<p>Tue Sep 15 19:38:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.c (rb_objspace_alloc, rb_objspace_free): define always 	  regardless ENABLE_VM_OBJSPACE, and free heap pages.</p>

<p>Tue Sep 15 15:15:41 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_sysinit, rb_w32_readdir): compare by 	  encoding index to get rid of encoding initialization before VM 	  object space allocation.</p>

<p>	* dir.c (fundamental_encoding_p, push_glob): compare by encoding 	  index immediately.</p>

<p>	* enc/<code>ascii,us_ascii,utf_8</code>.c: set encoding indexes of 	  fundamental built-in encodings so that usable as well as 	  allocated rb_encoding before rb_enc_init().</p>

<p>	* encindex.h: separate encoding index constants from internal.h.</p>

<p>Tue Sep 15 13:13:13 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_sort_bang, rb_ary_sort): [DOC] correct block 	  return values, which may be a negative or positive integer, not 	  only -1 or +1.</p>

<p>Tue Sep 15 12:49:10 2015  Jason Barnabe  &lt;jason.barnabe@gmail.com&gt;</p>

<p>	* array.c (rb_ary_sort_bang, rb_ary_sort): [DOC] Correct 	  description of array sort block return values.  And also fix up 	  the grammar a bit.  [Fix GH-1020]</p>

<p>Tue Sep 15 12:44:32 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* util.c (ruby_qsort): use BSD-style qsort_r if available.</p>

<p>Mon Sep 14 19:26:34 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (parse_mlsx_entry): parse pathnames including 	  space correctly.</p>

<p>Mon Sep 14 11:12:10 2015  Anton Davydov  &lt;antondavydov.o@gmail.com&gt;</p>

<p>	* lib/racc/rdoc/grammar.en.rdoc: [DOC] fix typo, “convertion” to 	  “conversion”.  [Fix GH-1016]</p>

<p>Sun Sep 13 11:03:13 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h: prefix RUBY or RB to global symbols to get 	  rid of name conflicts with other headers.</p>

<p>	* include/ruby/encoding.h, include/ruby/intern.h: ditto.</p>

<p>Sun Sep 13 09:38:51 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (size, modify, create, type, unique, perm, lang, 	  media_type, charset): new methods to return standard facts.</p>

<p>Sat Sep 12 19:43:49 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_call_iseq_setup_normal): do not clear local 	  variables here. vm_push_frame() clears.</p>

<p>	* vm_insnhelper.c (vm_call_iseq_setup_tailcall): ditto.</p>

<p>	* vm_insnhelper.c (vm_push_frame): move check code to 	  vm_check_frame().</p>

<p>	  Reorder initialization timing to reuse same values (sp).</p>

<p>	* compile.c (rb_iseq_compile_node): use 	  iseq_set_exception_local_table() for ISEQ_TYPE_DEFINED_GUARD.</p>

<p>Sat Sep 12 23:06:51 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (file?, directory?, appendable?, creatable?, 	  deletable?, enterable?, renamable?, listable?, directory_makable?, 	  purgeable?, readable?, writable?): new methods.</p>

<p>Sat Sep 12 21:27:22 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (FACT_PARSERS): support system dependent facts 	  UNIX.mode, UNIX.owner, UNIX.group, UNIX.ctime, and UNIX.atime.</p>

<p>Sat Sep 12 19:08:58 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_dup2): should return the new fd on 	  success, while msvcrt returns 0 wrongly.</p>

<p>Sat Sep 12 18:14:11 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (parse_mlsx_entry, mlst) raise an FTPProtoError 	  when parsing failed.</p>

<p>Sat Sep 12 18:00:35 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (TIME_PARSER): use “Z” instead of “+00:00” to 	  get UTC time.  Thanks, Wilson Bilkovich.</p>

<p>Sat Sep 12 17:55:24 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (mlst, mlsd): support new commands MLST and MLSD 	  specified in RFC 3659.</p>

<p>Sat Sep 12 16:14:31 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* file.c: access()/eaccess() wrapping methods check more than just uid. 	  [fix GH-1007][ci skip] Patch by @eam</p>

<p>Sat Sep 12 16:07:01 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* README.md: improve markdown rendering for readability. 	  [fix GH-1015][ci skip] Patch by @Matrixbirds</p>

<p>Sat Sep 12 14:30:03 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (save_redirect_fd): make saved FDs close-on-exec not 	  to be inherited.</p>

<p>	* process.c (run_exec_dup2): restore close-on-exec flags too.</p>

<p>	* win32/win32.c (fcntl): implement F_GETFD, F_SETFD, and 	  F_DUPFD_CLOEXEC.</p>

<p>Sat Sep 12 05:35:24 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* rational.c (string_to_r_strict): preserve encoding in exception</p>

<p>Fri Sep 11 20:23:35 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove rb_call_info_t::aux.opt_pc.</p>

<p>	* vm_insnhelper.c: introduce shortcut functions for opt_pc == 0 	  because opt_pc is always 0 on shortcut function.</p>

<p>Fri Sep 11 17:49:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c: disable ISeq.load. It enabled accidentally at r51794.</p>

<p>Fri Sep 11 11:15:12 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (size, mdtm, system): parse responses according to 	  RFC 959 and 3659, where reply codes must be followed by SP.</p>

<p>	* lib/net/ftp.rb (system): remove LF from the return value.</p>

<p>Thu Sep 10 22:48:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (literal_concat_gen, evstr2dstr_gen): keep literal 	  encoding beginning with an interpolation same as the source file 	  encoding.  [ruby-core:70703] [Bug #11519]</p>

<p>Thu Sep 10 22:15:51 2015  Joe Rafaniello  &lt;jrafanie@redhat.com&gt;</p>

<p>	* process.c (rb_f_spawn): Be more specific regarding “other 	  values” by having “non-zero positive integers” Add nil, the 	  default value, as a possible value and what it means.</p>

<p>	  Try to use more consistent language. 	  [Fix GH-1008]</p>

<p>Thu Sep 10 15:16:02 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (getmultiline): refactor.</p>

<p>Thu Sep 10 12:17:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_build_from_ary_body): register cdhash to the 	  iseq constant body instead of compile time mark array, not to 	  get GCed.  [ruby-core:70708] [Feature #8543]</p>

<p>Wed Sep  9 18:16:14 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/stub_specification.rb (Gem::StubSpecification#data): 	  should not change the value of $. when `require`ing gems. 	  this fixed test failures introduced by r51813.</p>

<p>Wed Sep  9 16:55:45 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ruby.c (usage, enable_option, disable_option, process_options): new 	  option <code>–disable-did_you_mean</code>.</p>

<p>	* gem_prelude.rb: now requires did_you_mean gem by default if available.</p>

<p>Wed Sep  9 13:38:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/extlibs.rb (do_patch): let “patch” command change the 	  working directory and open the patch file there, instead of 	  spawn options, so that proper error message will be shown by the 	  command not just “chdir” or “open”.</p>

<p>Wed Sep  9 11:33:05 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* common.mk (update-gems): use BASERUBY instead of RUNRUBY.</p>

<p>Wed Sep  9 11:08:59 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* lib/delegate.rb: Remove backtrace cleaning for delegated methods 	  This patch was provided by Rafael Franca and greatly improves 	  performance when an exception is raised. [Bug #11461]</p>

<p>Wed Sep  9 10:05:41 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/rubygems/test_config.rb: fix broken tests for Windows platform.</p>

<p>Wed Sep  9 07:46:32 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: Update to RubyGems HEAD(fe61e4c112). 	  this version contains new feature that warn invalid SPDX license 	  identifiers. <a href="https://github.com/rubygems/rubygems/pull/1249">github.com/rubygems/rubygems/pull/1249</a> 	  and #1032, #1023, #1332, #1328, #1306, #1321, #1324 	* test/rubygems: ditto.</p>

<p>Tue Sep  8 23:17:36 2015  Yuki Nishijima  &lt;mail@yukinishijima.net&gt;</p>

<p>	* gems/bundled_gems: Upgrade the did_you_mean gem to 1.0.0.beta2.</p>

<p>Tue Sep  8 23:09:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (rb_io_s_popen): do not wait the child process during being 	  killed.  [ruby-core:70671] [Bug #11510]</p>

<p>Tue Sep  8 22:18:04 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: revert because ruby trunk never be able to install 	  the did_you_mean gem.  retry after enough test.</p>

<p>Tue Sep  8 21:48:22 2015  Yuki Nishijima  &lt;mail@yukinishijima.net&gt;</p>

<p>	* gems/bundled_gems: Automatically install the did_you_mean gem 	  as a bundled gem.  [Feature #11252]</p>

<p>Tue Sep  8 17:17:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove rb_call_info_t::blockiseq.</p>

<p>	* insns.def (send, invokesuper): pass blockiseq explicitly.</p>

<p>	* compile.c: catch up this fix.</p>

<p>	* iseq.c: ditto.</p>

<p>	* vm_args.c: ditto.</p>

<p>	* iseq.c (ISEQ_MINOR_VERSION): 2-&gt;3 because instruction spec was 	  changed.</p>

<p>Tue Sep  8 15:01:19 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (list): fetch all the lines before yielding a block 	  to allow other commands in the block.  [Feature #11454] 	  Patched by Srikanth Shreenivas.</p>

<p>Tue Sep  8 12:05:00 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_read_reparse_point): return correct required 	  buffer size for IO_REPARSE_TAG_MOUNT_POINT.</p>

<p>Tue Sep  8 00:14:43 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (rb_execarg_parent_start1): raise with the target path 	  name when open() failed.</p>

<p>Mon Sep  7 23:45:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (rb_exec_fail): raise with the target directory name 	  when chdir() failed.  pointed out by sorah.</p>

<p>Mon Sep  7 22:05:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (insert): should use plain strdup() instead of 	  ruby_strdup() at startup time, and plain free()ed in cmdglob().</p>

<p>Mon Sep  7 16:49:30 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_core.h (rb_vm_struct): define objspace always regardless 	  ENABLE_VM_OBJSPACE.</p>

<p>Mon Sep  7 15:54:58 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby_atomic.h (ATOMIC_VALUE_CAS): fix typo. 	  TODO: make arguments of all CAS macros consistent.</p>

<p>Sun Sep  6 16:07:22 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ccan/list/list.h: suppress unused argument warnings 	  [ccan commit 6aaca17e07588997417a73fac19dcf0ff17ed81b]</p>

<p>Sat Sep  5 11:39:52 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/rss/rss.rb (Time#w3cdtf): fix zero-trimmed width of fraction 	  digits.  [ruby-core:70667] [Bug #11509]</p>

<p>Sat Sep  5 08:28:58 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_hash_equal, rb_hash_eql): [DOC] the orders of each 	  hashes are not compared.  [Bug #11508]</p>

<p>Fri Sep  4 23:26:22 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/win32.h: fix macro name for VC runtime version, 	  RT_VER is only in Makefile.</p>

<p>Fri Sep  4 17:46:17 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* doc/contributing.rdoc: fix configuration option. 	  [ci skip] [fix GH-1009]</p>

<p>Fri Sep  4 04:46:54 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (iseq_memsize): functions for wrapper object should have 	  iseqw_ prefix.</p>

<p>Thu Sep  3 21:12:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/cgi/session.rb (create_new_id): use SHA512 instead of MD5. 	  pointed out by SARWAR JAHAN.</p>

<p>Thu Sep  3 20:29:18 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_raw_obj_info): iseq-&gt;body-&gt;location.first_lineno is Fixnum.</p>

<p>Thu Sep  3 17:54:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (raise_method_missing): “names” should be singular. 	  pointed out by Filip Bartuzi.</p>

<p>Thu Sep  3 17:50:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_raw_obj_info): should support IMEMO/iseq.</p>

<p>Thu Sep  3 10:07:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (raise_method_missing): refine error messages when a 	  symbol is not given.  [Fix GH-1013]</p>

<p>Wed Sep  2 18:49:55 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/psych/*: merge psych master(8737e5b). It contains following fixes. 	  <a href="https://github.com/tenderlove/psych/pull/242">github.com/tenderlove/psych/pull/242</a> 	  <a href="https://github.com/tenderlove/psych/pull/246">github.com/tenderlove/psych/pull/246</a> [ruby-list:50219] 	* test/psych/*: ditto.</p>

<p>Wed Sep  2 18:04:13 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.h (GET_PC_COUNT): remove unused macro.</p>

<p>Wed Sep  2 17:18:37 2015  Chris Schneider  &lt;chris@christopher-schneider.com&gt;</p>

<p>	* process.c (proc_detach): [DOC] fix typo “intent” as “intend” in 	  rdoc.  [Fix GH-1011]</p>

<p>Wed Sep  2 16:58:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_realpath_internal): use filesystem encoding if the 	  argument is in ASCII encodings.</p>

<p>	* win32/file.c (rb_readlink): needs the result encoding.</p>

<p>Tue Sep  1 18:37:15 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/thread/test_queue.rb: catch up last commit.</p>

<p>Tue Sep  1 18:16:32 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* thread_sync.c (queue_do_close): ignore multiple close to allow 	  multiple producers. 	  <a href="https://bugs.ruby-lang.org/issues/10600#note-14">bugs.ruby-lang.org/issues/10600#note-14</a></p>

<p>Tue Sep  1 18:06:26 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* thread_tools.c: rename thread_tools.c to thread_sync.c.</p>

<p>Mon Aug 31 17:04:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (move_refined_method): should insert a write barrier 	  from an original class to a created (cloned) method entry.</p>

<p>	* test/ruby/test_refinement.rb: add a test.</p>

<p>Sun Aug 30 02:42:22 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_method_tab): Only add SSLv3 support 	  if the SSL library supports it.  Thanks Kurt Roeckx &lt;kurt@roeckx.be&gt; 	  [Bug #11376]</p>

<p>	* ext/openssl/extconf.rb: check for SSLv3 support in the SSL 	  implementation.</p>

<p>	* test/openssl/test_ssl.rb (class OpenSSL): Skip tests that need SSLv3 	  if there is no support.</p>

<p>Fri Aug 28 16:05:09 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rdoc/*: Update rdoc master(cfffed5) 	  <a href="https://github.com/rdoc/rdoc/pull/337">github.com/rdoc/rdoc/pull/337</a> 	  <a href="https://github.com/rdoc/rdoc/pull/367">github.com/rdoc/rdoc/pull/367</a></p>

<p>Fri Aug 28 10:16:20 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (hook_before_rewind): prevent kicking <code>:return</code> event while 	  finishing vm_exec func because invoke_block_from_c() kick a <code>:return</code> 	  event for bmethods. 	  [Bug #11492]</p>

<p>	* test/ruby/test_settracefunc.rb: add a test.</p>

<p>Thu Aug 27 18:05:42 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/webrick/server.rb: use IO::NULL instead of &#39;/dev/null&#39; 	* test/ruby/test_string.rb: ditto.</p>

<p>Thu Aug 27 15:24:57 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c (iseq_set_sequence): rename variable names 	  to make it readable.</p>

<p>Thu Aug 27 07:45:34 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* thread_tools.c: add Queue#close(exception=false) and 	  SizedQueue#close(exception=false). 	  [Feature #10600]</p>

<p>	  Trying to deq from a closed empty queue return nil 	  if exception parameter equals to false (default).</p>

<p>	  If exception parameter is truthy, it raises 	  ClosedQueueError (&lt; StopIteration). 	  ClosedQueueError inherits StopIteration so that you can write:</p>

<p>	    loop{ e = q.deq; (using e) }</p>

<p>	  Trying to close a closed queue raises ClosedQueueError.</p>

<p>	  Blocking threads to wait deq for Queue and SizedQueue will be 	  restarted immediately by returning nil (exception=false) or 	  raising a ClosedQueueError (exception=true).</p>

<p>	  Blocking threads to wait enq for SizedQueue will be 	  restarted by raising a ClosedQueueError immediately.</p>

<p>	  The above specification is not proposed specification, so that 	  we need to continue discussion to conclude specification this 	  method.</p>

<p>	* test/thread/test_queue.rb: add tests originally written by 	  John Anderson and modify detailed behavior.</p>

<p>Wed Aug 26 10:52:02 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* re.c (rb_memsearch_wchar, rb_memsearch_qchar): test matching 	  till the end of string.  [ruby-core:70592] [Bug #11488]</p>

<p>	* test/ruby/test_m17n.rb (test_include?, test_index): add tests by 	  Tom Stuart.</p>

<p>Wed Aug 26 09:26:00 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* id_table.c (list_table_extend, hash_table_extend): remove C99 	  features.  [ruby-dev:49239] [Bug #11487]</p>

<p>Tue Aug 25 06:34:43 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (w32_symlink): implement symlink().</p>

<p>Mon Aug 24 16:01:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* encoding.c (rb_locale_encindex): find encoding index without 	  making a string object every time.  [ruby-core:58160] [Bug #9080]</p>

<p>Sat Aug 22 15:43:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (check_funcall_failed, check_funcall_missing): cache 	  results of respond_to? and respond_to_missing?, and search a 	  public method only for compatibility with rb_respond_to.</p>

<p>Sat Aug 22 08:23:32 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/thread/thread.c: move definitions of Queue, SizedQueue 	  and ConditionalVariables to thread_tools.c. In other words, 	  such classes are built-in. 	  [Feature #8919]</p>

<p>	  At first, I planned to embed only a Queue class. 	  However, rubygems requires &#39;thread.rb&#39; (rubygems are 	  required at first, when launch MRI without –disable-gems). 	  So most of people require &#39;thread.rb&#39; as an embedded library.</p>

<p>	  Now, ext/thread/thread.c is empty, only for a dummy for 	  compatibility.</p>

<p>	* thread.c: move a definition of Mutex class to thread_tools.c.</p>

<p>	  And define Mutex class under Thread (so now Mutex is Thread::Mutex). 	  Because other thread related classes are also defined under Thread. 	  We remain ::Mutex as Thread::Mutex. Only an inspect result is changed.</p>

<p>	* common.mk: add dependency from thread.o to thread_tools.c.</p>

<p>Sat Aug 22 05:31:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_opts.h, iseq.c, iseq.h: add compile option to force frozen 	  string literals. 	  [Feature #11473]</p>

<p>	  This addition is not specification change, but to try frozen 	  string literal world discussed on [Feature #11473].</p>

<p>	  You can try frozen string literal world using this magical line:</p>

<p>	    RubyVM::InstructionSequence.compile_option = 	      <code>true</code></p>

<p>	  Note that this is a global compilation option, so that you need to 	  compile another script like that:</p>

<p>	    p &#39;foo&#39;.frozen? #=&gt; false 	    RubyVM::InstructionSequence.compile_option = 	      <code>true</code> 	    p &#39;foo&#39;.frozen? #=&gt; false, because this line is already compiled. 	    p eval(“&#39;foo&#39;.frozen?”) #=&gt; true</p>

<p>	  Details: 	    * String literals are deduped by rb_fstring(). 	    * Dynamic string literals (“…#<code>xyz</code>…”) is now only frozen, 	      not deduped. Maybe you have other ideas.</p>

<p>	  Now, please do not use this option on your productions :) 	  Of course, current specification can be changed.</p>

<p>	* compile.c: ditto.</p>

<p>	* test/ruby/test_iseq.rb: add a test.</p>

<p>Sat Aug 22 02:53:12 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/psych/*: update to Psych 2.0.14</p>

<p>	* test/psych/*: ditto</p>

<p>Fri Aug 21 19:58:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/objspace/objspace.c: add a new method ObjectSpace.count_symbols. 	  [Feature #11158]</p>

<p>	* symbol.c (rb_sym_immortal_count): added to count immortal symbols.</p>

<p>	* symbol.h: ditto.</p>

<p>	* test/objspace/test_objspace.rb: add a test for this method.</p>

<p>	* NEWS: describe about this method.</p>

<p>Fri Aug 21 19:48:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/Makefile.sub ($(LIBRUBY_SO)): needs additional libraries 	  for extension libraries to link statically. 	  [ruby-core:70499] [Feature #9018]</p>

<p>Fri Aug 21 18:49:22 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* include/ruby/ruby.h, cont.c, vm_trace.c: add a new event 	  fiber_switch. We need more discussion about this feature 	  so that I don&#39;t write it on NEWS. 	  [Feature #11348]</p>

<p>	* test/ruby/test_settracefunc.rb: add tests.</p>

<p>Fri Aug 21 17:32:42 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_invoke_block): we should not expect ci-&gt;argc is 	  stable after invoking a block. [Bug #11451]</p>

<p>	* test/ruby/test_yield.rb: add a test. This test script is given by 	  Alex Dowad.</p>

<p>Fri Aug 21 06:35:50 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* test/openssl/test_ssl_session.rb: Fix tests so that they take in to 	  account OpenSSL installations that have SSLv3 disabled by default. 	  Thanks Jeremy Evans &lt;code@jeremyevans.net&gt; for the patches. 	  [Bug #11366] [Bug #11367]</p>

<p>Thu Aug 20 22:19:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_method.c (basic_obj_respond_to): call respond_to_missing? 	  only when redefined.  [ruby-core:70460] [Bug #11465]</p>

<p>Thu Aug 20 14:13:27 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (check_funcall_respond_to): share the behavior with 	  rb_obj_respond_to.  [ruby-core:70460] [Bug #11465]</p>

<p>	* vm_method.c (vm_respond_to): extract from rb_obj_respond_to and 	  merge r39881.</p>

<p>Thu Aug 20 08:53:09 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_method.c (rb_obj_respond_to): reuse found method entry 	  instead of searching same entry repeatedly.</p>

<p>Thu Aug 20 08:31:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (replace_real_basename), win32/win32.c (opendir_internal): 	  check reparse point tags and treat supported tags only as 	  symbolic links.  [ruby-core:70454] [Bug #11462]</p>

<p>Wed Aug 19 23:59:28 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): add OP_ALL to 	  existing options rather than just setting it.  Some vendors apply 	  custom patches to their versions of OpenSSL that set default values 	  for options.  This commit respects the custom patches they&#39;ve 	  applied.</p>

<p>	* test/openssl/test_ssl.rb (class OpenSSL): check that OP_ALL has been 	  added to the options.</p>

<p>Wed Aug 19 23:55:29 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (rb_f_spawn): [DOC] elaborate environment variable 	  values.  [ruby-core:70456] [Bug #11463]</p>

<p>Wed Aug 19 23:48:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (winnt_lstat): check reparse point tags and treat 	  supported tags only as symbolic links. 	  [ruby-core:70454] [Bug #11462]</p>

<p>Tue Aug 18 20:05:49 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* thread_pthread.c (reserve_stack): ensure the memory is really 	  allocated. [Bug #11457]</p>

<p>Tue Aug 18 17:19:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (IS_BEG): include labeled argument state, which was 	  EXPR_LABELARG.  [ruby-dev:49221] [Bug #11456]</p>

<p>Tue Aug 18 16:16:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h (RClass): define only in C, <code>__attribute__</code> 	  between <code>struct</code> and the name can&#39;t compile with g++. 	  [ruby-core:70297] [Bug #11426]</p>

<p>Mon Aug 17 20:56:36 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y: fix syntax error at do-block after a conditional 	  operator.  separate label-allowed and after-a-label states from 	  others as bit flags.  [ruby-dev:48790] [Bug #10653]</p>

<p>Mon Aug 17 11:57:36 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (rb_io_each_codepoint): raise an exception at incomplete 	  character before EOF when conversion takes place.  [Bug #11444]</p>

<p>Sun Aug 16 17:33:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: update latest version of bundled gems. 	  It includes minitest-5.8.0 and test-unit 3.1.3.</p>

<p>Sun Aug 16 17:24:10 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* gc.c (gc_mark_children): check if RCLASS_EXT is valid 	  before marking. This fixes the following test failure 	  introduced in r51126:</p>

<p>	    make test-all TESTOPTS=&#39;–gc-stress ruby/test_refinement.rb&#39;</p>

<p>Sat Aug 15 10:51:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/win32/lib/win32/registry.rb (API#SetValue): data size should 	  be in bytes, not in chars.  [ruby-core:70365] [Bug #11439]</p>

<p>Sat Aug 15 10:15:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (rb_io_each_codepoint): read more data when read partially. 	  [ruby-core:70379] [Bug #11444]</p>

<p>Sat Aug 15 04:33:39 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* hash.c (any_hash): skip rb_objid_hash for static syms 	  (rb_num_hash_start): extract from rb_ident_hash 	  (rb_objid_hash): call rb_num_hash_start 	  (rb_ident_hash): ditto 	  [ruby-core:70181] [Feature #11405]</p>

<p>Sat Aug 15 04:16:13 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* iseq.c (rb_iseq_mark): reduce NULL checks</p>

<p>Fri Aug 14 18:50:57 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* method.h (METHOD_ENTRY_VISI_SET): cast visi to int 	  (METHOD_ENTRY_FLAGS_SET): ditto</p>

<p>Fri Aug 14 18:43:11 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* process.c (close_unless_reserved): add extra check 	  (dup2_with_divert): remove 	  (redirect_dup2): use dup2 without divert 	  (before_exec_non_async_signal_safe): adjust call + comment 	  (rb_f_exec): stop timer thread for all OSes 	  (rb_exec_without_timer_thread): remove 	* eval.c (ruby_cleanup): adjust call 	* thread.c (rb_thread_stop_timer_thread): always close pipes 	* thread_pthread.c (struct timer_thread_pipe): add writing field, 	  mark owner_process volatile for signal handlers 	  (rb_thread_wakeup_timer_thread_fd): check valid FD 	  (rb_thread_wakeup_timer_thread): set writing flag to prevent close 	  (rb_thread_wakeup_timer_thread_low): ditto 	  (CLOSE_INVALIDATE): new macro 	  (close_invalidate): new function 	  (close_communication_pipe): removed 	  (setup_communication_pipe_internal): make errors non-fatal 	  (setup_communication_pipe): ditto 	  (thread_timer): close reading ends inside timer thread 	  (rb_thread_create_timer_thread): make errors non-fatal 	  (native_stop_timer_thread): close write ends only, always, 	   wait for signal handlers to finish 	  (rb_divert_reserved_fd): remove 	* thread_win32.c (native_stop_timer_thread): adjust (untested) 	  (rb_divert_reserved_fd): remove 	* vm_core.h: adjust prototype 	  [ruby-core:70386] [Bug #11336]</p>

<p>Fri Aug 14 18:40:43 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/win32/lib/win32/registry.rb (API#SetValue): add terminator 	  size, not 1 byte.  [ruby-core:70365] [Bug #11439]</p>

<p>Thu Aug 13 22:49:42 2015  Juanito Fatas  &lt;katehuang0320@gmail.com&gt;</p>

<p>	* lib/timeout.rb (Timeout#timeout): freeze a string message to 	  reduce string allocations.  [Fix GH-996]</p>

<p>Thu Aug 13 17:42:34 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h (rb_call_info_kw_arg_bytes): move the definition 	  to iseq.h because this function is shared with iseq.c and compile.c.</p>

<p>Thu Aug 13 14:36:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* object.c (rb_num_to_dbl): move from num2dbl_with_to_f in math.c.</p>

<p>Thu Aug 13 09:01:25 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* load.c (features_index_add): avoid repeat calculation</p>

<p>Wed Aug 12 21:57:31 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* id_table.c: IMPL() macro accept op as _opname instead of opname 	  because jemalloc seems to replace the word `free&#39; to `je_free&#39;.</p>

<p>Wed Aug 12 21:51:11 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* id_table.c (mix_id_table_insert): fix memory leak.</p>

<p>Wed Aug 12 21:17:38 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* iseq.c (iseq_memsize): reimplement for wrapper 	  (param_keyword_size): extracted from iseq_memsize 	  (iseqw_mark): new mark function 	  (iseqw_data_type): new data type 	  (iseqw_new): wrap as iseqw_data_type 	  (iseqw_check): adjust for wrapper 	  (Init_ISeq): remove iseqw_iseq_key initialization 	* test/objspace/test_objspace.rb: new test 	  [ruby-core:70344] [Feature #11435]</p>

<p>Wed Aug 12 21:15:27 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* vm_core.h (rb_call_info_kw_arg_bytes): extract from compile.c 	* compile.c (iseq_build_callinfo_from_hash): use above function</p>

<p>Wed Aug 12 18:00:17 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (move_refined_method): same as the last commit.</p>

<p>Wed Aug 12 17:57:53 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c, gc.c vm.c: use ID_TABLE_* instead of ST_* 	  (such as ST_CONTINUE) for enum rb_id_table_iterator_result.</p>

<p>Wed Aug 12 17:05:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* id_table.h: introduce ID key table. 	  [Feature #11420]</p>

<p>	  This table only manage ID-&gt;VALUE table to reduce overhead of st.</p>

<p>	  Some functions prefixed rb_id_table_* are provided.</p>

<p>	* id_table.c: implement rb_id_table_*.</p>

<p>	  There are several algorithms to implement it.</p>

<p>	  Now, there are roughly 4 types:</p>

<p>	    * st 	    * array 	    * hash (implemented by  Yura Sokolov) 	    * mix of array and hash</p>

<p>	  The macro ID_TABLE_IMPL can choose implementation. 	  You can see detailes about them at the head of id_table.c.</p>

<p>	  At the default, I choose 34 (mix of list and hash). 	  This is not final decision. 	  Please report your suitable parameters or 	  your data structure.</p>

<p>	  * symbol.c: introduce rb_id_serial_t and rb_id_to_serial() 	    to represent ID by serial number.</p>

<p>	  * internal.h: use id_table for method tables.</p>

<p>	  * class.c, gc.c, marshal.c, vm.c, vm_method.c: ditto.</p>

<p>Wed Aug 12 05:19:11 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* parse.y (rb_parser_compile_cstr): remove volatile arg 	  (rb_parser_compile_string): ditto 	  (rb_parser_compile_file): ditto 	  (rb_parser_compile_string_path): ditto 	  (rb_parser_compile_file_path): ditto 	  [ruby-core:70323] [Misc #11431]</p>

<p>Tue Aug 11 22:59:57 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* numeric.c (Init_Numeric): Fix document for Float::MIN and 	  Float::EPSILON.</p>

<p>Tue Aug 11 15:22:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h (ALLOCV_N): check integer overflow, as well 	  as ruby_xmalloc2.  pointed out by Paul &lt;pawlkt AT gmail.com&gt;.</p>

<p>Tue Aug 11 14:57:09 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_repeated_permutation): fix buffer size, ALLOCV_N 	  already multiplies element size.</p>

<p>Tue Aug 11 12:13:20 2015  Jeremy Evans  &lt;merch-redmine@jeremyevans.net&gt;</p>

<p>	* test/openssl/test_ssl.rb: Fix LocalJumpErrors being raised 	  in OpenSSL tests. [ruby-core:70020][Bug #11368]</p>

<p>Tue Aug 11 11:54:13 2015  Alexey Lipnyagov  &lt;liptonshmidt@gmail.com&gt;</p>

<p>	* string.c: Fix documentation for String#slice 	  [ruby-core:70298][Bug #11427]</p>

<p>Tue Aug 11 11:53:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (superclass): make superclass rule optional and allow 	  any contents without a terminator.  [EXPERIMENTAL]</p>

<p>Tue Aug 11 10:58:42 2015  Juanito Fatas  &lt;juanitofatas@gmail.com&gt;</p>

<p>	* string.c: [DOC] Make #end_with? example doc symmetry 	  with #start_with? [fix GH-992][ci skip]</p>

<p>Tue Aug 11 10:51:19 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_array.rb: Add test for <code>Array#flatten</code> with level 1 	  [fix GH-986] Patch @yui-knk</p>

<p>Tue Aug 11 10:48:16 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* enum.c: added doc for Enumerable#zip 	  [fix GH-985] Patch by @yui-knk 	* test/ruby/test_enum.rb: added tests for Enumerable#zip 	  [fix GH-985] Patch @yui-knk</p>

<p>Tue Aug 11 10:33:26 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* vm_method.c: typo fix [fix GH-993][ci skip] Patch by @0x0dea 	* test/ruby/test_refinement.rb: ditto.</p>

<p>Sun Aug  9 14:15:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm.c (Init_vm_objects, rb_vm_fstring_table): use frozen_strings 	  table in rb_vm_t.  [ruby-core:70274] [Bug #11423]</p>

<p>Sat Aug  8 03:59:51 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* object.c: [DOC] Improve grammar for Module#=== 	  Patch by @SkyBirdSoar in documenting-ruby/ruby#52: 	  <a href="https://github.com/documenting-ruby/ruby/pull/52">github.com/documenting-ruby/ruby/pull/52</a></p>

<p>Sat Aug  8 03:39:33 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* hash.c: [DOC] Improve description of symbol key syntax 	  Patch by Raphael Das Gupta in documenting-ruby/ruby#51: 	  <a href="https://github.com/documenting-ruby/ruby/pull/51">github.com/documenting-ruby/ruby/pull/51</a></p>

<p>Fri Aug  7 21:04:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parser_params): turn in_def and in_single into bit 	  flags and reduce the size by 2-words.</p>

<p>	* parse.y (parser_params): remove redundant prefixes.</p>

<p>	* parse.y (yylex): non-pure parser has not been supported since 	  merger of ripper.  change argument types from void pointers.</p>

<p>Fri Aug  7 17:07:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (method_super_method): uncallable method entry does not 	  have the defined class, use the owner instead. 	  [ruby-core:70254] [Bug #11419]</p>

<p>	* test/ruby/test_method.rb (test_super_method_unbound): add test 	  by Akira Matsuda.</p>

<p>Thu Aug  6 10:49:57 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* node.c (rb_alloc_tmp_buffer): round up the size and check the 	  range.</p>

<p>	* ruby_atomic.h (ATOMIC_VALUE_EXCHANGE, ATOMIC_VALUE_CAS): add 	  atomic operations for VALUE.</p>

<p>Thu Aug  6 08:15:49 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): move 	  SSLSocket#sysclose to Ruby.</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_close): ditto</p>

<p>Thu Aug  6 07:57:21 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): move nonblock 	  enable to SSLSocket#initialize and remove Nonblock module.</p>

<p>Thu Aug  6 07:53:47 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): move 	  OpenSSL::SSL::SSLSocket#initialize to Ruby.</p>

<p>	* ext/openssl/ossl_ssl.c: ditto</p>

<p>Thu Aug  6 02:25:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* node.c (rb_alloc_tmp_buffer): use NODE_ALLOCA to mark locations 	  like as builtin alloca.  [ruby-core:70251] [Bug #11418]</p>

<p>Wed Aug  5 14:37:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* transcode.c (rb_econv_open0): rb_econv_t::source_encoding_name 	  and rb_econv_t::destination_encoding_name should refer static 	  strings always or NULL.  [ruby-core:70247] [Bug #11416]</p>

<p>Tue Aug  4 16:53:43 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): extract callback 	  lookup to private Ruby methods. This means we can keep the default 	  DH callback logic hidden from consumers.  Also, since the SSLSocket 	  always has a context, we can remove conditionals about that 	  instance.</p>

<p>	* ext/openssl/ossl_ssl.c: move callback lookup methods to private Ruby 	  methods.</p>

<p>Tue Aug  4 16:40:26 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/ruby/test_module.rb: should not expect a method table ordering. 	  [Feature #11414]</p>

<p>Tue Aug 04 15:30:04 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (rb_block_clear_env_self): clear by Qfalse instead of Qnil. 	  [Bug #11409]</p>

<p>	* test/ruby/test_eval.rb: add tests for this issue, 	  written by @0x0dea. 	  <a href="https://github.com/ruby/ruby/pull/988">github.com/ruby/ruby/pull/988</a></p>

<p>Tue Aug  4 12:12:14 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c: wrap long lines</p>

<p>Tue Aug  4 09:32:30 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* proc.c: Removing duplicate doc [fix GH-987][ci skip] 	  Patch by @ronakjangir47</p>

<p>Tue Aug  4 09:21:58 2015  Richard Schneeman  &lt;richard.schneeman+foo@gmail.com&gt;</p>

<p>	* doc/contributing.rdoc: fixed wrong instructions with OS X 	  [fix GH-989][ci skip] Patch by @schneems</p>

<p>Mon Aug  3 10:08:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* re.c (rb_memsearch): should match only char boundaries in wide 	  character encodings.  [ruby-core:70220] [Bug #11413]</p>

<p>Sun Aug  2 07:01:17 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/lib/openssl/buffering.rb (gets): 	  avoid comparing fixnum with nil 	* test/openssl/test_pair.rb: test gets with limit when EOF is hit 	  Thanks to Bar Hofesh &lt;bar.hofesh@safe-t.com&gt; for the bug report 	  and testing. 	  [ruby-core:70149] [Bug #11400]</p>

<p>Sat Aug  1 17:13:15 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* lib/net/http/response.rb (Net::HTTPResponse::Inflater#finish): 	  fix a bug that empty gzipped response body causes Zlib::BufError. 	  [ruby-core:68846] [Bug #11058]</p>

<p>	* test/net/http/test_httpresponse.rb: tests for the above.</p>

<p>Sat Aug  1 17:05:18 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* lib/net/http/response.rb (Net::HTTPResponse#inflater): 	  fix TypeError. An exception object might be nil. 	  [ruby-core:68846] [Bug #11058]</p>

<p>Sat Aug  1 09:09:46 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_sslctx_setup): Implement 	  SSLContext#options and options= using SSL_CTX_set_options and 	  SSL_CTX_get_options. This reduces the number of ivars we need and 	  simplifies <code>ossl_sslctx_setup</code>.</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): Default <code>options</code> 	  to SSL_OP_ALL</p>

<p>Sat Aug  1 06:54:36 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (Init_ossl_ssl): OpenSSL declares these 	  constants as longs, so we should follow that and use LONG2NUM. 	  <a href="http://git.io/vOqxD">git.io/vOqxD</a></p>

<p>Sat Aug  1 04:06:29 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_call_tmp_dh_callback): change callback 	  to return the Ruby dh (or ecdh) object that the caller cares about 	  instead of doing rb_iv_get / set to communicate.  This means we can 	  remove an rb_iv_get call, and only use the set calls for their 	  intended purpose (to prevent the object from being GC&#39;d).</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_tmp_dh_callback): ditto 	* ext/openssl/ossl_ssl.c (ossl_call_tmp_ecdh_callback): ditto 	* ext/openssl/ossl_ssl.c (ossl_tmp_ecdh_callback): ditto</p>

<p>Sat Aug  1 03:49:31 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_call_tmp_dh_callback): Similarly to the 	  tmp_ecdh_callback, the SSLSocket instance always holds a reference 	  to the SSLContext object (it&#39;s always set in <code>initialize</code>).  The 	  SSLContext holds a reference to the tmp_dh_callback.  Ask the 	  context for the callback instead of storing the callback in two 	  places.</p>

<p>Sat Aug  1 03:43:10 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_call_tmp_dh_callback): create an array 	  and use <code>rb_apply</code> to clean up calls to <code>rb_protect</code>.</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_tmp_dh_callback): ditto</p>

<p>Sat Aug  1 03:27:12 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_call_tmp_ecdh_callback): The SSL socket 	  always holds a reference to the SSLContext object, which will have 	  the callback object.  Ask the context for the callback instead of 	  storing the callback in two places.</p>

<p>Sat Aug  1 03:14:07 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): convert 	  <code>tmp_dh_callback</code> to Ruby, and call it when setting up an SSL 	  connection.  This allows us to move the “default” behavior to the 	  reader method.</p>

<p>	* ext/openssl/ossl_ssl.c: call the tmp_dh_callback instead of 	  accessing the SSLContext&#39;s internals.</p>

<p>Fri Jul 31 23:34:27 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* .travis.yml: update libssl before running tests. 	  Thanks to Chris Sinjakli &lt;chris@sinjakli.co.uk&gt; for figuring out the 	  travis settings!</p>

<p>Fri Jul 31 21:34:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* load.c (rb_require_internal): use rb_load_internal0 not to raise 	  a exception to be caught.</p>

<p>Thu Jul 30 13:19:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* variable.c (rb_const_get_0): warn deprecated constant reference.</p>

<p>	* variable.c (rb_mod_deprecate_constant): mark constants to be 	  warned as deprecated.  [Feature #11398]</p>

<p>Thu Jul 30 11:53:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_s_handle_interrupt): make identity hash, to 	  compare masking classes just by their IDs.</p>

<p>Thu Jul 30 11:52:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* load.c (rb_load_internal0): stop separating exits at loading 	  from exits from execution.  TAG_FATAL is the only case that 	  <code>errinfo</code> is a Fixnum, and should continue to exit by JUMP_TAG 	  but not raising as an ordinary exception. 	  [ruby-core:70169] [Bug #11404]</p>

<p>Thu Jul 30 10:42:27 2015  Alex Dowad  &lt;alexinbeijing@gmail.com&gt;</p>

<p>	* load.c (rb_load_internal0): extra check before returning 	  TAG_RAISE when a non-local transfer of control happens while 	  loading and parsing a Ruby source file. 	  [ruby-core:70169] [Bug #11404]</p>

<p>Thu Jul 30 08:48:42 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* st.c (find_entry): constify st_table* 	  (find_packed_index_from): ditto 	  (find_packed_index): ditto 	  (get_keys): ditto 	  (get_values): ditto</p>

<p>Thu Jul 30 04:29:25 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* benchmark/bm_hash_aref_dsym.rb: new benchmark 	* benchmark/bm_hash_aref_dsym_long.rb: ditto 	* benchmark/bm_hash_aref_fix.rb: ditto</p>

<p>Wed Jul 29 21:38:41 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (any_hash), symbol.c (dsymbol_alloc): fix dynamic symbol 	  hash value by restricting in Fixnum range, that is <code>long</code>.</p>

<p>Wed Jul 29 17:25:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_obj_hash): move in order to share with rb_any_hash.</p>

<p>Wed Jul 29 16:00:22 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (str_buf_cat): consider empty non-embed string case, 	  not to loop infinitely.  [ruby-core:70074] [Bug #11383]</p>

<p>Wed Jul 29 15:25:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (send_internal): set method_missing_reason before 	  invoking overriding method_missing method so that the default 	  method_missing can achieve it properly. 	  [ruby-core:68515] [Bug #10969]</p>

<p>Wed Jul 29 14:54:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_sym_hash): return same value as rb_any_hash() of 	  Symbol.  [Bug #9381]</p>

<p>	* hash.c (rb_any_hash): fix Float hash.  rb_dbl_hash() returns a 	  Fixnum, but not a long.  [Bug #9381]</p>

<p>Wed Jul 29 11:07:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* internal.h (LIKELY, UNLIKELY): make a boolean to enforce 1 or 0.</p>

<p>Wed Jul 29 10:44:43 2015  Alex Dowad  &lt;alexinbeijing@gmail.com&gt;</p>

<p>	* gc.c: document argument passed to finalizer proc. 	  [fix GH-976][ci skip] Patch by @alexdowad</p>

<p>Wed Jul 29 10:36:58 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* io.c (rb_io_extract_modeenc): add option parameter `flags&#39; 	  to append extra oflags to normal mode. 	  [Feature #11253] [ruby-core:69539]</p>

<p>Wed Jul 29 04:54:47 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/rubygems/test_gem_remote_fetcher.rb: pre-generate test key 	  [ruby-core:70151] [Bug #11397]</p>

<p>Tue Jul 28 10:32:09 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* internal.h (struct RClass): moved from ruby/ruby.h to hide the 	  internals.</p>

<p>Tue Jul 28 08:48:29 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (RUBY_TYPE_ATTRIBUTE): attribute declaration for 	  types.</p>

<p>Tue Jul 28 07:23:03 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* symbol.h (struct RSymbol): add hashval field 	* symbol.c (dsymbol_alloc): setup hashval field once 	* hash.c (rb_any_hash): return RSymbol-&gt;hashval directly 	* common.mk: hash.o depends on symbol.h 	  Thanks to Bruno Escherl &lt;bruno@escherl.net&gt; for the bug report 	  [ruby-core:70129] [Bug #11396]</p>

<p>Tue Jul 28 03:26:15 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): raise a more 	  helpful exception when verifying the peer connection and an 	  anonymous cipher has been selected. [ruby-core:68330] [Bug #10910] 	  Thanks to Chris Sinjakli &lt;chris@sinjakli.co.uk&gt; for the patch.</p>

<p>	* test/openssl/test_ssl.rb (class OpenSSL): test for change</p>

<p>Mon Jul 27 13:24:11 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* template/id.h.tmpl (ID2ATTRSET): remove an unused macro.</p>

<p>Mon Jul 27 12:21:15 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/openssl/test_ssl.rb: run tests on non-Unix platforms.</p>

<p>Sun Jul 26 19:21:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_alpn_protocol): fix condition 	  to compile, needs ALPN to be available.  [Feature #9390]</p>

<p>Sun Jul 26 11:29:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* signal.c (default_handler, Init_signal): discard SIGSYS, ENOSYS 	  should raise a SystemCallError always instead.</p>

<p>Sun Jul 26 10:26:35 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_call_servername_cb): set the ssl context 	  object returned by the servername callback on to the socket as an 	  instance variable.  If the callback allocated a new context object 	  and didn&#39;t keep a reference to it, it could be GC&#39;d out from under 	  the socket object.</p>

<p>	* test/openssl/test_ssl.rb (class OpenSSL): test for change.</p>

<p>Sun Jul 26 10:07:26 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* test/openssl/test_ssl.rb (class OpenSSL): add test coverage around 	  OpenSSL::SSL::SSLContext#servername_cb</p>

<p>Sun Jul 26 09:10:32 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: update latest version of bundled power_assert.</p>

<p>Sun Jul 26 08:49:28 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/rubygems/test_gem_remote_fetcher.rb: backport rubygems upstream 	  change for OpenSSL key length. see detail to 	  <a href="https://github.com/rubygems/rubygems/pull/1290">github.com/rubygems/rubygems/pull/1290</a></p>

<p>Sun Jul 26 08:33:03 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/pkey.rb: implement DEFAULT_512 and 	  DEFAULT_1024 constants in Ruby.</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): Ask PKey for the 	  default DH callback since it already must check whether openssl has 	  been compiled with DH support.</p>

<p>	* ext/openssl/ossl_pkey_dh.c (OSSL_PKEY_BN): Remove C definitions of 	  DEFAULT_512 and DEFAULT_1024</p>

<p>	* ext/openssl/ossl_pkey_dh.c (Init_ossl_dh): ditto</p>

<p>	* test/openssl/test_pkey_dh.rb (class OpenSSL): add test to ensure the 	  Ruby definitions are the same as the C definitions were.</p>

<p>Sun Jul 26 08:14:59 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): support 	  specifically setting the tmp_dh_callback to nil.</p>

<p>	* ext/openssl/ossl_ssl.c (Init_ossl_ssl): ditto</p>

<p>	* test/openssl/test_pair.rb (module OpenSSL): add a test</p>

<p>Sun Jul 26 07:47:14 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): move the default 	  tmp_dh_callback Ruby code and set it as a default in <code>initialize</code>.</p>

<p>	* ext/openssl/ossl_pkey_dh.c (static unsigned char DEFAULT_DH_512_GEN): 	  move this constant to Ruby.</p>

<p>	* ext/openssl/ossl_pkey_dh.c (static unsigned char DEFAULT_DH_1024_GEN): 	  ditto</p>

<p>	* ext/openssl/ossl_pkey_dh.c (Init_ossl_dh): ditto</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_tmp_dh_callback): ditto</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_sslctx_setup): tmp_dh_callback should 	  always be set, so we can remove this conditional</p>

<p>Sun Jul 26 06:22:24 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* test/openssl/test_pair.rb: add a test ensuring that the default DH 	  callback is used when no DH callback is specified.</p>

<p>Sun Jul 26 04:08:27 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): add missing 	  instance variables to squash warnings with alpn.</p>

<p>Sun Jul 26 03:42:19 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb (module OpenSSL): move 	  OpenSSL::SSL::SSLContext#initialize implementation to pure Ruby.</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_sslctx_initialize): ditto</p>

<p>	* ext/openssl/ossl_ssl.c (Init_ossl_ssl): ditto</p>

<p>Sat Jul 25 21:03:45 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* random.c (fill_random_bytes_syscall): get rid of blocking when 	  no entropy is available.  based on the patch by mame in 	  [ruby-core:70114].  [Bug #11395]</p>

<p>Sat Jul 25 11:05:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (str_replace_shared_without_enc): fill the terminator 	  of embedded strings in wide char encodings.</p>

<p>Sat Jul 25 06:38:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: size should be unsigned. 	  * rb_call_info_t::index 	  * rb_iseq_constant_body::stack_max 	  * rb_iseq_constant_body::local_size 	  * rb_iseq_constant_body::param::size 	  * rb_iseq_constant_body::local_table_size 	  * rb_iseq_constant_body::is_size 	  * rb_iseq_constant_body::callinfo_size</p>

<p>	* iseq.h: same for iseq_catch_table::size.</p>

<p>	* compile.c: catch up these fix.</p>

<p>	* iseq.c: ditto.</p>

<p>	* proc.c: ditto.</p>

<p>	* vm.c: ditto.</p>

<p>	* vm_args.c: ditto.</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>Sat Jul 25 06:00:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_iseq_constant_body::line_info_table.</p>

<p>	* iseq.c: catch up this fix.</p>

<p>Sat Jul 25 05:56:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_iseq_constant_body::param::opt_table and 	  rb_iseq_constant_body::param::keyword.</p>

<p>	* compile.c: catch up this fix.</p>

<p>Sat Jul 25 04:47:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_iseq_constant_body::catch_table.</p>

<p>	* compile.c (iseq_set_exception_table): catch up this fix.</p>

<p>	* iseq.c: ditto.</p>

<p>	* vm.c (vm_exec): ditto.</p>

<p>Fri Jul 24 21:29:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* st.c (EQUAL, st_delete_safe): fix arguments order to compare 	  function, searching key is the first and stored key is the 	  second always.</p>

<p>Fri Jul 24 21:27:29 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (fstr_update_callback): fstring must not be a shared 	  string, or the content without RSTRING_FSTR may be freed. 	  [ruby-dev:49188] [Bug #11386]</p>

<p>Fri Jul 24 20:09:43 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/rinda/test_rinda.rb (RingIPv6#prepare_ipv6): prevent to use 	  IPv6 loopback interface for 	  Rinda::TestRingFinger#test_make_socket_ipv6_multicast and 	  Rinda::TestRingFinger#test_make_socket_ipv6_multicast_hops. 	  The tests are skipped if there are no IPv6 devices other than the 	  loopback device. [Bug #11394] [ruby-dev:49199]</p>

<p>	* test/rinda/test_rinda.rb (test_make_socket_ipv6_multicast): ditto 	  for Rinda::TestRingServer#test_make_socket_ipv6_multicast.</p>

<p>	* test/rinda/test_rinda.rb (test_ring_server_ipv6_multicast): ditto 	  for Rinda::TestRingServer#test_ring_server_ipv6_multicast.</p>

<p>Fri Jul 24 16:35:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (fstr_update_callback): pool bare strings only.</p>

<p>	* string.c (rb_fstring): return the original string with sharing a 	  fstring if it has extra attributes, not the fstring itself. 	  [ruby-dev:49188] [Bug #11386]</p>

<p>Fri Jul 24 16:35:34 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* file.c (rb_file_s_extname): [DOC] add an example.</p>

<p>	* test/ruby/test_path.rb (test_extname): add tests.  [Fix GH-978] 	  * path starts with dot (&#39;.a.rb&#39;) 	  * path includes dir name (&#39;a/b/d/test.rb&#39;) 	  * path includes dir name and dir name starts with dot 	    (&#39;.a/b/d/test.rb&#39;)</p>

<p>Thu Jul 23 18:50:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_iseq_constant_body::local_table and 	  rb_iseq_param_keyword::table and 	  rb_iseq_param_keyword::default_values.</p>

<p>	* compile.c: catch up this fix.</p>

<p>	* iseq.c: ditto.</p>

<p>Thu Jul 23 17:30:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_iseq_constant_body::iseq_encoded and 	  rb_control_frame_t::pc.</p>

<p>	* compile.c (rb_iseq_translate_threaded_code): catch up this fix.</p>

<p>	* iseq.c: ditto.</p>

<p>	* vm_exec.c (vm_exec_core): ditto.</p>

<p>Thu Jul 23 10:25:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h: add raw FL macros, which assume always the 	  argument object is not a special constant.</p>

<p>	* internal.h (STR_EMBED_P, STR_SHARED_P): valid only for T_STRING.</p>

<p>	* string.c: deal with taint flags directly across String instances.</p>

<p>Thu Jul 23 09:05:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (lambda_body): pop cmdarg stack for lookahead 	  token.  [ruby-core:70067] [Bug #11380]</p>

<p>Thu Jul 23 04:03:03 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c: fix tests by not setting the instance 	  variable on the frozen ssl instance.</p>

<p>Thu Jul 23 03:32:26 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c: add ECDH callback support. [Feature #11356]</p>

<p>	* test/openssl/test_pair.rb: test for ECDH callback support</p>

<p>Thu Jul 23 03:29:49 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c: add ALPN support. [Feature #9390]</p>

<p>	* ext/openssl/extconf.rb: detect ALPN support in OpenSSL</p>

<p>	* test/openssl/test_ssl.rb: test for ALPN</p>

<p>Wed Jul 22 23:44:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_reverse): reversed string is not a substring, 	  and should not set coderange of the original string. 	  [ruby-dev:49189] [Bug #11387]</p>

<p>Wed Jul 22 20:17:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: modify layout of rb_iseq_constant_body.</p>

<p>	  Move frequent accessing fields to upper part.</p>

<p>Wed Jul 22 19:57:47 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove unused declaration of 	  iseq_compile_data_ensure_node_stack.</p>

<p>Wed Jul 22 19:52:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: separate rb_iseq_body into rb_iseq_constant_body and 	  rb_iseq_variable_body (rb_iseq_t::variable_body).</p>

<p>	  rb_iseq_variable_body can be modified after compilation.</p>

<p>	* compile.c: use rb_iseq_t::variable_body.</p>

<p>	* iseq.c: ditto.</p>

<p>	* thread.c: ditto.</p>

<p>Wed Jul 22 17:50:35 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/matrix/eigenvalue_decomposition.rb: refine code style. 	  [fix GH-959][ci skip] Patch by @bogdanvlviv</p>

<p>Wed Jul 22 15:48:47 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_range.rb: Add test case for Range#end with 	  exclude_end true case. [fix GH-968] Patch by @yui-knk</p>

<p>Wed Jul 22 09:45:31 2015  Maksim Sitnikov  &lt;sitnikovme@undev.ru&gt;</p>

<p>	* numeric.c (num_coerce): [DOC] fix doc for Numeric#coerce, 	  missing &#39;+&#39;.  [Fix GH-974]</p>

<p>Wed Jul 22 07:24:18 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* make rb_iseq_t T_IMEMO object (type is imemo_iseq).</p>

<p>	  All contents of previous rb_iseq_t is in rb_iseq_t::body. 	  Remove rb_iseq_t::self because rb_iseq_t is an object.</p>

<p>	  RubyVM::InstructionSequence is wrapper object points T_IMEMO/iseq. 	  So RubyVM::ISeq.of(something) method returns different wrapper 	  objects but they point the same T_IMEMO/iseq object.</p>

<p>	  This patch is big, but most of difference is replacement of 	  iseq-&gt;xxx to iseq-&gt;body-&gt;xxx.</p>

<p>	  (previous) rb_iseq_t::compile_data is also located to 	  rb_iseq_t::compile_data. 	  It was moved from rb_iseq_body::compile_data.</p>

<p>	  Now rb_iseq_t has empty two pointers. 	  I will split rb_iseq_body data into static data and dynamic data.</p>

<p>	* compile.c: rename some functions/macros. 	  Now, we don&#39;t need to separate iseq and iseqval (only VALUE).</p>

<p>	* eval.c (ruby_exec_internal): `n&#39; is rb_iseq_t (T_IMEMO/iseq).</p>

<p>	* ext/objspace/objspace.c (count_imemo_objects): count T_IMEMO/iseq.</p>

<p>	* gc.c: check T_IMEMO/iseq.</p>

<p>	* internal.h: add imemo_type::imemo_iseq.</p>

<p>	* iseq.c: define RubyVM::InstructionSequence as T_OBJECT. 	  Methods are implemented by functions named iseqw_.…</p>

<p>	* load.c (rb_load_internal0): rb_iseq_new_top() returns 	  rb_iseq_t (T_IMEMO/iesq).</p>

<p>	* method.h (rb_add_method_iseq): accept rb_iseq_t (T_IMEMO/iseq).</p>

<p>	* vm_core.h (GetISeqPtr): removed because it is not T_DATA now.</p>

<p>	* vm_core.h (struct rb_iseq_body): remove padding for 	  [Bug #<a href="ruby-core:63721">10037]</a>.</p>

<p>Wed Jul 22 07:15:33 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/objspace/objspace.c (total_i): no need to skip singleton classes.</p>

<p>Wed Jul 22 06:37:54 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_call_info_t::kw_arg, 	  rb_control_frame_t::iseq and rb_control_frame_t::block_iseq.</p>

<p>	* iseq.c (iseq_free): catch up this fix.</p>

<p>	* vm.c: ditto.</p>

<p>	* vm_dump.c: ditto.</p>

<p>Wed Jul 22 06:25:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_call_info_t::blockiseq and rb_block_t::iseq.</p>

<p>	* vm.c, vm_insnhelper.c: catch up this fix.</p>

<p>	* iseq.c (iseq_data_to_ary): constify the first iseq parameter.</p>

<p>	* vm_insnhelper.c (vm_make_proc_with_iseq): ditto.</p>

<p>Wed Jul 22 06:17:35 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: constify rb_method_iseq_t::iseqptr.</p>

<p>	* proc.c (rb_method_entry_min_max_arity): catch up this fix.</p>

<p>	* vm_insnhelper.c (def_iseq_ptr): constify.</p>

<p>Wed Jul 22 03:37:39 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (internal_object_p): Now a singleton classes appear by 	  ObjectSpace.each_object. [Bug #11360]</p>

<p>	* test/ruby/test_objectspace.rb: add a test about it.</p>

<p>Tue Jul 21 21:21:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (do_select): replace switch and goto with a loop to 	  suppress maybe-uninitialized warnings by gcc6.</p>

<p>	* thread.c (set_unblock_function, rb_wait_for_single_fd): ditto.</p>

<p>Tue Jul 21 20:32:33 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_range.rb: Add test for Range#hash 	  [fix GH-969] Patch by @yui-knk</p>

<p>Tue Jul 21 19:43:20 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* compile.c: constify the first parameter (iseq). 	  * iseq_add_mark_object() 	  * iseq_add_mark_object_compile_time()</p>

<p>	* iseq.c, iseq.h (rb_iseq_add_mark_object): ditto.</p>

<p>Tue Jul 21 16:18:48 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/socket/test_nonblock.rb: increase buffer sizes 	  to OpenBSD limits. Thanks to Jeremy Evans &lt;code@jeremyevans.net&gt; 	  [ruby-core:70058]</p>

<p>Tue Jul 21 16:08:53 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* load.c (ruby_dln_librefs): make static</p>

<p>Tue Jul 21 13:36:54 2015  yuuji.yaginuma  &lt;yuuji.yaginuma@gmail.com&gt;</p>

<p>	* lib/optparse.rb (complete): [DOC] fix typo.  [Fix GH-973]</p>

<p>Tue Jul 21 05:20:21 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* io.c (nogvl_wait_for_single_fd): new function for Linux 	  (maygvl_copy_stream_wait_read): Linux-specific version 	  (nogvl_copy_stream_wait_write): use nogvl_wait_for_single_fd 	  [ruby-core:70051] [Feature #11377]</p>

<p>Mon Jul 20 15:04:30 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* parse.y (parser_initialize): avoid redundant zero-ing</p>

<p>Mon Jul 20 12:12:05 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* parse.y (struct parser_params): pack: 88 =&gt; 256 bytes on 64-bit 	  [ruby-core:70034] [Feature #11371]</p>

<p>Sun Jul 19 14:29:18 2015  windwiny  &lt;windwiny.ubt@gmail.com&gt;</p>

<p>	* ext/pty/pty.c: [DOC] fix example typo, an old name at move from 	  PTY.open.  [Fix GH-972]</p>

<p>Sat Jul 18 21:29:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (vm_check_ints_blocking): gather common statements at 	  the end, and prefer LIKELY for Visual C optimization.</p>

<p>Sat Jul 18 20:44:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* load.c (rb_load_internal0): do not raise any exceptions but 	  return the result tag state.</p>

<p>	* load.c (rb_load_protect): reduce nested EXEC_TAGs.</p>

<p>Sat Jul 18 19:52:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.c (run_finalizer): set and restore safe level here to reduce 	  nested EXEC_TAGs.</p>

<p>Sat Jul 18 18:45:22 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* eval.c (ruby_cleanup): error_handle() returns exit status to the 	  system, not internal error state, do not convert the exit status 	  again.</p>

<p>Sat Jul 18 10:29:03 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/ruby/test_process.rb: test thread+sigs work after failed exec</p>

<p>Sat Jul 18 07:20:18 2015  Jeremy Evans  &lt;code@jeremyevans.net&gt;</p>

<p>	* test/socket/test_nonblock: use smaller buffer for sendmsg 	  [ruby-core:70016] [Bug #11364]</p>

<p>Sat Jul 18 07:04:24 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* signal.c (trap_handler): cleanup to use RSTRING_GETMEM + memcmp</p>

<p>Sat Jul 18 02:53:06 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* io.c (argf_read_nonblock): support `exception: false&#39; 	  (io_nonblock_eof): new function 	  (io_read_nonblock): use io_nonblock_eof 	  (argf_getpartial): accept kwargs hash for `exception: false&#39; 	* test/ruby/test_argf.rb (test_read_nonblock): new test 	* NEWS: add item for ARGF.read_nonblock 	  [ruby-core:70000] [Feature #11358]</p>

<p>Fri Jul 17 23:51:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (rb_eval_cmd): $SAFE=4 has been deprecated.</p>

<p>Fri Jul 17 22:18:09 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): use enum ruby_tag_type names.</p>

<p>	* vm_core.h (ruby_tag_type): move from eval_intern.h for compiling 	  break/next/redo/return.</p>

<p>Fri Jul 17 15:39:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/encoding.h (ENC_CODERANGE_CLEAN_P): predicate that 	  tells if the coderange is clean, that is 7bit or valid, and no 	  needs to scrub.</p>

<p>	* re.c (rb_reg_expr_str): use ENC_CODERANGE_CLEAN_P.</p>

<p>	* string.c (enc_strlen, rb_enc_cr_str_buf_cat, rb_str_scrub): 	  ditto.</p>

<p>	* string.c (rb_str_enumerate_chars): ditto, and suppress a warning 	  by gcc6.</p>

<p>Fri Jul 17 15:36:52 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test/ruby/test_range.rb (test_first_last): Add test for 	  <code>Range.new</code>.  [Fix GH-971]</p>

<p>Fri Jul 17 15:36:40 2015  yui-knk  &lt;spiketeika@gmail.com&gt;</p>

<p>	* test/ruby/test_range.rb (test_first_last): Add assertions to 	  test of <code>Range#last</code> with exclude_end true case.  [Fix GH-970]</p>

<p>Fri Jul 17 09:59:14 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* thread.c (rb_thread_alone): simplify</p>

<p>Fri Jul 17 09:58:32 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/rinda/tuplespace.rb: remove enumerator require 	* test/pathname/test_pathname.rb: ditto</p>

<p>Fri Jul 17 05:33:58 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* iseq.c (rb_iseq_compile_with_option): reuse result of previous 	  GET_THREAD() call 	* thread.c (thread_create_core): ditto 	  (rb_mutex_trylock): ditto 	  (rb_mutex_lock): ditto 	* process.c (rb_waitpid): avoid multiple eval from RUBY_VM_CHECK_INTS 	* thread.c (rb_thread_check_ints): ditto</p>

<p>Thu Jul 16 19:12:30 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* thread.c (mutex_alloc): remove needless volatile</p>

<p>Thu Jul 16 22:05:29 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: constify rb_iseq_t::parent_iseq.</p>

<p>	  rb_iseq_t::local_iseq is not constant data because 	  local_iseq::flip_cnt can be modified (commented).</p>

<p>	* compile.c: catch up this fix.</p>

<p>	* iseq.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>Thu Jul 16 21:47:47 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* process.c (redirect_dup2): when the new FD of dup2() conflicts 	  with one of the timer thread FDs, the internal FD is diverted. 	  [Bug #11336] [ruby-core:69886] [Bug #11350] [ruby-core:69961]</p>

<p>	* process.c (dup2_with_divert): new function for the above purpose.</p>

<p>	* thread_pthread.c (rb_divert_reserved_fd): new function for 	  diverting reserved FD. If the given FD is the same as one of the 	  reserved FDs, the reserved FD number is internally changed. 	  It returns -1 when error. Otherwise, returns 0. It also returns 	  0 if there is no need to change reserved FD number.</p>

<p>	* thread_win32.c (rb_divert_reserved_fd): always returns 0 because 	  of no reserved FDs.</p>

<p>	* internal.h (rb_divert_reserved_fd): prototype declaration. 	  It is Ruby internal use only.</p>

<p>Thu Jul 16 21:47:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (rb_iseq_disasm): rename rb_iseq_t *iseqdat to iseq 	  and VALUE *iseq to code.</p>

<p>	* iseq.c (rb_iseq_disasm_insn): ditto.</p>

<p>Thu Jul 16 14:34:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm.c (REWIND_CFP): keep the arguments region inside the valid 	  value stack.  [ruby-core:69969] [Bug #11352]</p>

<p>Thu Jul 16 11:38:21 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* process.c (close_unless_reserved): declare type of `fd&#39; arg</p>

<p>Thu Jul 16 08:47:29 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* load.c (rb_construct_expanded_load_path): fstring expanded path 	  (get_loaded_features_index): fstring feature path 	  (rb_provide_feature): ditto 	  [ruby-core:69871] [Feature #11331]</p>

<p>Thu Jul 16 02:56:14 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* thread.c (thread_initialize): avoid RSTRING_PTR and NUMT2INT</p>

<p>Thu Jul 16 01:00:46 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/ruby/test_process.rb (test_exec_close_reserved_fd): test for 	  [Bug #11353]</p>

<p>Thu Jul 16 00:35:42 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* .gitignore: ignore version.i.</p>

<p>Wed Jul 15 23:40:32 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/ruby/test_process.rb (test_deadlock_by_signal_at_forking): 	  use RUBY (= EnvUtil.rubybin)</p>

<p>Wed Jul 15 23:01:22 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* process.c (redirect_close, parent_redirect_close): should not close 	  reserved FD. It should be closed in the exec system call due to the 	  O_CLOEXEC or FD_CLOEXEC flag. [Bug #11353] [ruby-core:69977]</p>

<p>	* process.c (close_unless_reserved): new function to close FD unless 	  it is reserved for internal communication.</p>

<p>	* thread_pthread.c (rb_reserved_fd_p): should check owner_process pid 	  to avoid false positive in forked child process.</p>

<p>Wed Jul 15 18:31:18 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* proc.c (proc_mark): remove redundant check 	* vm.c (env_mark): ditto</p>

<p>Wed Jul 15 17:27:40 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* iseq.c (iseq_mark): remove check for data pointer 	* proc.c (binding_mark): ditto 	* vm.c (rb_thread_mark): ditto 	* vm_trace.c (tp_mark): ditto</p>

<p>Wed Jul 15 16:55:04 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* encoding.c (enc_autoload): drop dummy encoding flag from 	  the loaded encoding index.  this flag is used only in this 	  source.</p>

<p>Wed Jul 15 14:39:29 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (vm_make_env_each): add comments about env layout. 	  Do not use `i&#39; to specify `new_ep&#39;.</p>

<p>	* vm.c (rb_proc_create, rb_vm_make_proc_lambda): envval is not used.</p>

<p>Wed Jul 15 08:59:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.h (RUBY_MARK_UNLESS_NULL): evaluate the argument only once 	  to get rid of inadvertent side effects.</p>

<p>Wed Jul 15 02:53:11 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h, vm.c: remove rb_proc_t::envval because we can know it via 	  rb_proc_t::block::ep.</p>

<p>	  rb_vm_proc_envval(const rb_proc_t *proc) returns an Env object which 	  the Proc object use.</p>

<p>	* proc.c: catch up this fix.</p>

<p>	* vm_dump.c (rb_vmdebug_proc_dump_raw): ditto.</p>

<p>Wed Jul 15 02:27:22 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h, vm.c: remove rb_env_t::prev_envval because we can know it 	  via env-&gt;ep.</p>

<p>	  rb_vm_env_prev_envval(env) returns prev_envval via env-&gt;ep.</p>

<p>	* vm_core.h (rb_vm_env_local_variables): change parameter type 	  from VALUE (T_DATA/env) to `const rb_env_t *&#39; to make same as 	  rb_vm_env_prev_envval().</p>

<p>	* proc.c: catch up these changes.</p>

<p>	* vm_dump.c: ditto.</p>

<p>	* vm.c: rename macros.</p>

<p>	  * ENV_IN_HEAP_P() to VM_EP_IN_HEAP_P() because it uses ep. 	  * ENV_VAL() to VM_ENV_EP_ENVVAL() because it is too short.</p>

<p>Wed Jul 15 01:09:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c: refactoring Proc/Env related code.</p>

<p>	* vm_core.h: remove blockprocval field from rb_proc_t and rb_binding_t. 	  Instead of this field, mark given block in Proc at rb_env_t::env.</p>

<p>	* vm.c (vm_make_env_each): make an Env object with this layout. 	  And also simplify parameters.</p>

<p>	* proc.c: catch up this fix.</p>

<p>	* vm_core.h: remove rb_env_t::local_size because it is not used.</p>

<p>	* vm_dump.c (rb_vmdebug_env_dump_raw): catch up this fix.</p>

<p>	* vm_core.h (rb_vm_make_env_object): remove rb_vm_make_env_object() 	  because it is only referred from vm.c.</p>

<p>	* vm_eval.c (eval_string_with_cref): catch up this fix.</p>

<p>Wed Jul 15 00:03:36 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* gc.c (__has_feature): move into internal.h.</p>

<p>	* internal.h (__has_feature): ditto.</p>

<p>	* internal.h (__has_extension): new macro.</p>

<p>	* internal.h (STATIC_ASSERT): use _Static_assert with 	  clang. [ruby-core:69931] [Bug #11343]</p>

<p>Wed Jul 15 00:00:00 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* random.c (fill_random_bytes_syscall): fix compile error with 	  clang. [ruby-core:69931] [Bug #11343]</p>

<p>Tue Jul 14 11:22:42 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler#register): 	  notify the handler thread of new timeout registration.</p>

<p>	* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler#initialize): 	  make sleep intervals adaptive than fixed period intervals.</p>

<p>	* lib/webrick/server.rb (WEBrick::GenericServer#start): flush 	  shutdown pipe.</p>

<p>	* lib/webrick/server.rb (WEBrick::GenericServer#stop): request the 	  server to stop immediately by sending data via shutdown pipe.</p>

<p>Mon Jul 13 23:58:08 2015  Stefano Tortarolo  &lt;stefano.tortarolo@gmail.com&gt;</p>

<p>	* lib/webrick/httpproxy.rb (WEBrick::HTTPProxyServer#do_CONNECT): 	  fix typos in debugger statements.  [Fix GH-967]</p>

<p>Mon Jul 13 19:11:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/timeout.rb (timeout): warn as deprecated for a long time.</p>

<p>Mon Jul 13 01:37:27 2015  Zachary Scott  &lt;zzak@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl.c: [DOC] Backport ruby/openssl@dbb3fdb [Bug #11345] 	  Thanks to Tomoya Chiba for the report and help with patch.</p>

<p>Sun Jul 12 09:20:02 2015  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>	* ext/socket/basicsocket.c: [DOC] typo (Errno::AGAIN -&gt; Errno::EAGAIN)</p>

<p>	* ext/socket/socket.c: ditto</p>

<p>	* ext/socket/tcpserver.c: ditto</p>

<p>	* ext/socket/udpsocket.c: ditto</p>

<p>	* ext/socket/unixserver.c: ditto</p>

<p>	* io.c: ditto</p>

<p>Sun Jul 12 06:42:23 2015  ksss  &lt;co000ri@gmail.com&gt;</p>

<p>	* test/stringio/test_stringio.rb (test_sysread): add a test for 	  StringIO#sysread.  [Fix GH-966]</p>

<p>Sat Jul 11 21:16:34 2015  ksss  &lt;co000ri@gmail.com&gt;</p>

<p>	* ext/stringio/stringio.c (Init_stringio): [DOC] Fix an example, 	  StringIO#puts should be set “n” at last.  [Fix GH-965]</p>

<p>Sat Jul 11 12:45:51 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/timeout.rb (Timeout#timeout): remove regexp with wrong line 	  number and fix caller depth.</p>

<p>Fri Jul 10 22:05:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/timeout.rb (ExitException): removed internal exception class 	  and use Timeout::Error instead, as using throw/catch to isolate 	  each timeouts now.  [ruby-dev:49179] [Bug #11344]</p>

<p>Fri Jul 10 17:41:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (is_case_sensitive): get attributes by the file descriptor 	  of open directory, instead of using mount point name.</p>

<p>Fri Jul 10 10:46:02 2015  ksss  &lt;co000ri@gmail.com&gt;</p>

<p>	* ext/stringio/stringio.c (writable): remove unnecessary check for 	  deprecated safe level 4.  [Fix GH-963]</p>

<p>Thu Jul  9 15:07:12 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (waitpid): return immediately if interrupted. 	  reported by &lt;takkanm AT gmail.com&gt; [ruby-dev:49176] [Bug #11340]</p>

<p>Thu Jul  9 13:03:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_search_super_method): use CI_SET_FASTPATH().</p>

<p>Thu Jul  9 11:07:06 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove rb_call_info_t::klass because 	  rb_callable_method_entry_t has information about defined class.</p>

<p>	* vm_insnhelper.c (vm_search_method): don&#39;t set ci-&gt;klass because 	  it is removed.</p>

<p>	* vm_insnhelper.c (rb_equal_opt): ditto.</p>

<p>	* vm_insnhelper.c (vm_search_superclass): removed because it is too 	  simple to write code directly.</p>

<p>	* vm_insnhelper.c (vm_defined): don&#39;t use vm_search_superclass(). 	  This fix avoid searching current callable `me&#39; twice.</p>

<p>	* vm_insnhelper.c (vm_search_super_method): ditto.</p>

<p>Thu Jul  9 10:03:10 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/net/http/responses.rb: Added 308 status to CODE_TO_OBJ list. 	  [fix GH-961] Patch by @billinghamj</p>

<p>Thu Jul  9 09:34:14 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h (rb_control_frame_t): fix comments (layout index).</p>

<p>Thu Jul  9 09:25:50 2015  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>	* parse.y: Improve duplicate key warning with patch by @andremedeiros 	  [Fix GH-938] <a href="https://github.com/ruby/ruby/pull/938">github.com/ruby/ruby/pull/938</a> [Bug #11327]</p>

<p>Wed Jul  8 07:43:01 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/csv.rb: typo fix [ci skip][fix GH-958] Patch by @henrik</p>

<p>Wed Jul  8 04:42:27 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* iseq.c (iseq_data_to_ary): dump kw_arg as symbol 	* test/-ext-/iseq_load/test_iseq_load.rb: test kw_arg roundtrip 	  [ruby-core:69891] [Bug #11338]</p>

<p>Tue Jul  7 18:18:41 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* random.c (fill_random_bytes_syscall): fix compile error.</p>

<p>Tue Jul  7 16:47:30 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* compile.c (COMPILE_ERROR): reduce GET_THREAD() calls</p>

<p>Tue Jul  7 16:39:04 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* random.c (fill_random_bytes_syscall): return -1 for error 	* random.c (fill_random_bytes): try urandom on syscall failure</p>

<p>Tue Jul  7 15:02:18 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_str_normalize_ospath): skip invalid byte sequence not 	  to loop infinitely.  this case usually does not happen as the 	  input name should come from real file systems.</p>

<p>Tue Jul  7 14:40:08 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_backtrace.c: remove debug flag introduced accidentally.</p>

<p>Tue Jul  7 12:05:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* cont.c (cont_free): remove mysterious fflush() 	  introduced at r19890, maybe accidentally.</p>

<p>Tue Jul  7 11:45:14 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (rb_method_call): because data-&gt;me should be non-NULL, 	  do not check data-&gt;me</p>

<p>	* proc.c (method_inspect): ditto.</p>

<p>Tue Jul  7 11:37:25 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove rb_iseq_t::orig because rb_iseq_clone() 	  no longer exists.</p>

<p>	* iseq.c: don&#39;t use rb_iseq_t::orig.</p>

<p>Tue Jul 07 11:25:57 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c, internal.h (rb_iseq_clone): removed because we don&#39;t need to 	  clone iseq any more.</p>

<p>	* class.c (clone_method): share iseq between cloned methods. All of 	  method dependent information are able to refer from method entry.</p>

<p>Tue Jul  7 04:42:25 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* string.c (Init_String): use rb_str_freeze for String#freeze 	  to resize internal buffer 	  [ruby-core:69870] [Feature #11330]</p>

<p>Tue Jul  7 04:12:32 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (vm_define_method): remove an unused local variable.</p>

<p>Tue Jul  7 03:57:28 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove rb_iseq_t::defined_method_id because it is not 	  needed.</p>

<p>	* eval.c (frame_func_id): simplify. rb_callable_method_entry_t 	  has enough information.</p>

<p>	* eval.c (frame_called_id): ditto.</p>

<p>	* iseq.c (prepare_iseq_build): catch up this fix.</p>

<p>	* proc.c (rb_mod_define_method): ditto.</p>

<p>	* vm.c (vm_define_method): ditto.</p>

<p>Tue Jul  7 03:47:26 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove a useless declaration.</p>

<p>Tue Jul  7 03:33:20 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: remove rb_iseq_t::klass to reduce dynamic data.</p>

<p>	* internal.h, iseq.c (rb_iseq_klass): remove it because 	  rb_iseq_t::klass is removed.</p>

<p>	* vm_insnhelper.c (vm_super_outside): do not see cfp-&gt;iseq, but 	  check callable method entry on a frame. 	  This fix simplify the logic to search super class.</p>

<p>	* test/ruby/test_method.rb: support super() from Proc. 	  Now, [Bug #4881] and [Bug #3136] was solved.</p>

<p>	* proc.c (rb_mod_define_method): catch up this change.</p>

<p>	* vm.c (vm_define_method): ditto.</p>

<p>	* vm_backtrace.c (rb_profile_frames): now, each `frame&#39; objects 	  are rb_callable_method_entry_t data or iseq VALUEs.</p>

<p>	  This fix introduce minor compatibility issue that 	  rb_profile_frame_label() always returns 	  rb_profile_frame_base_label().</p>

<p>	* test/-ext-/debug/test_profile_frames.rb: catch up this change.</p>

<p>Tue Jul  7 01:52:14 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* cont.c (fiber_init): initialize control frame correctly. 	  This fix does not affect any ordinal execution, but 	  affects debug prints.</p>

<p>Mon Jul  6 17:59:05 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_search_super_method): do not skip calling 	  same methods in super. 	  [Bug #3351]</p>

<p>	* test/ruby/test_super.rb: fix a test.</p>

<p>Mon Jul  6 17:59:11 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/tk/tcltklib.c: removed deprecated safe level.</p>

<p>Mon Jul  6 17:16:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h, proc.c (rb_method_entry_location): make it static 	  and remove prefix `rb_&#39; because it is used only in proc.c.</p>

<p>Mon Jul  6 16:42:10 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/lib/memory_status.rb: removed redundant path.</p>

<p>Mon Jul  6 01:18:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/lib/test/unit/parallel.rb: make @@project_dir one level 	  upper as this file had moved one level deeper.</p>

<p>Sun Jul  5 23:54:10 2015  mizokami  &lt;suzunatsu@yahoo.com&gt;</p>

<p>	* lib/optparse.rb: [DOC] Fix typo.</p>

<p>Sun Jul  5 18:25:37 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* gc.c (gc_profile_record_get): fix spelling error in keys</p>

<p>Sun Jul  5 14:49:01 2015  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* README.md: fix a typo pointed out by raoulvdberge. 	  <a href="https://github.com/ruby/ruby/pull/953#commitcomment-11998186">github.com/ruby/ruby/pull/953#commitcomment-11998186</a></p>

<p>Sun Jul  5 12:56:20 2015  Irvi Firqotul Aini  &lt;viarc7@gmail.com&gt;</p>

<p>	* README.md: Added link HowToReport bugs.</p>

<p>Sun Jul  5 10:51:48 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_sort_bang): the original array may not be 	  embedded even if a substitution array is embedded, as it is 	  embedded when the original array is short enough but not 	  embedded.  [ruby-dev:49166] [Bug #11332]</p>

<p>Sun Jul  5 09:31:40 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/ruby/test_process.rb: test for fd=3 usability in child</p>

<p>Sat Jul  4 19:43:31 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* Add test case for empty array and first method with args. 	  Patch by @yui-knk [fix GH-955]</p>

<p>Sat Jul  4 19:39:08 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* Add test for <code>Enumerable#sort</code> with block. Patch by @yui-knk 	  [fix GH-954]</p>

<p>Sat Jul  4 14:38:43 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* enum.c (zip_ary): remove volatile, use RB_GC_GUARD 	  (zip_i): ditto</p>

<p>Sat Jul  4 10:42:57 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/test_case.rb (teardown): do not delete features 	  loaded from the original load paths, the same libraries should 	  be loaded again when the same features are required. 	  [ruby-dev:49031] [Bug #11222]</p>

<p>Sat Jul  4 09:38:52 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* vm.c (rb_vm_mark): reduce branches for always-set VM fields 	  (rb_vm_add_root_module): ditto</p>

<p>Fri Jul 03 20:05:10 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: introduce rb_callable_method_entry_t to remove 	  rb_control_frame_t::klass. 	  [Bug #11278], [Bug #11279]</p>

<p>	  rb_method_entry_t data belong to modules/classes. 	  rb_method_entry_t::owner points defined module or class.</p>

<p>	    module M 	      def foo; end 	    end</p>

<p>	  In this case, owner is M.</p>

<p>	  rb_callable_method_entry_t data belong to only classes. 	  For modules, MRI creates corresponding T_ICLASS internally. 	  rb_callable_method_entry_t can also belong to T_ICLASS.</p>

<p>	  rb_callable_method_entry_t::defined_class points T_CLASS or 	  T_ICLASS. 	  rb_method_entry_t data for classes (not for modules) are also 	  rb_callable_method_entry_t data because it is completely same data. 	  In this case, rb_method_entry_t::owner == rb_method_entry_t::defined_class.</p>

<p>	  For example, there are classes C and D, and includes M,</p>

<p>	    class C; include M; end 	    class D; include M; end</p>

<p>	  then, two T_ICLASS objects for C&#39;s super class and D&#39;s super class 	  will be created.</p>

<p>	  When C.new.foo is called, then M#foo is searched and 	  rb_callable_method_t data is used by VM to invoke M#foo.</p>

<p>	  rb_method_entry_t data is only one for M#foo. 	  However, rb_callable_method_entry_t data are two (and can be more). 	  It is proportional to the number of including (and prepending) 	  classes (the number of T_ICLASS which point to the module).</p>

<p>	  Now, created rb_callable_method_entry_t are collected when 	  the original module M was modified. We can think it is a cache.</p>

<p>	  We need to select what kind of method entry data is needed. 	  To operate definition, then you need to use rb_method_entry_t.</p>

<p>	  You can access them by the following functions.</p>

<p>	  * rb_method_entry(VALUE klass, ID id); 	  * rb_method_entry_with_refinements(VALUE klass, ID id); 	  * rb_method_entry_without_refinements(VALUE klass, ID id); 	  * rb_resolve_refined_method(VALUE refinements, const rb_method_entry_t *me);</p>

<p>	  To invoke methods, then you need to use rb_callable_method_entry_t 	  which you can get by the following APIs corresponding to the 	  above listed functions.</p>

<p>	  * rb_callable_method_entry(VALUE klass, ID id); 	  * rb_callable_method_entry_with_refinements(VALUE klass, ID id); 	  * rb_callable_method_entry_without_refinements(VALUE klass, ID id); 	  * rb_resolve_refined_method_callable(VALUE refinements, const rb_callable_method_entry_t *me);</p>

<p>	  VM pushes rb_callable_method_entry_t, so that rb_vm_frame_method_entry() 	  returns rb_callable_method_entry_t. 	  You can check a super class of current method by 	  rb_callable_method_entry_t::defined_class.</p>

<p>	* method.h: renamed from rb_method_entry_t::klass to 	  rb_method_entry_t::owner.</p>

<p>	* internal.h: add rb_classext_struct::callable_m_tbl to cache 	  rb_callable_method_entry_t data.</p>

<p>	  We need to consider about this field again because it is only 	  active for T_ICLASS.</p>

<p>	* class.c (method_entry_i): ditto.</p>

<p>	* class.c (rb_define_attr): rb_method_entry() does not takes 	  defined_class_ptr.</p>

<p>	* gc.c (mark_method_entry): mark RCLASS_CALLABLE_M_TBL() for T_ICLASS.</p>

<p>	* cont.c (fiber_init): rb_control_frame_t::klass is removed.</p>

<p>	* proc.c: fix `struct METHOD&#39; data structure because 	  rb_callable_method_t has all information.</p>

<p>	* vm_core.h: remove several fields. 	  * rb_control_frame_t::klass. 	  * rb_block_t::klass.</p>

<p>	  And catch up changes.</p>

<p>	* eval.c: catch up changes.</p>

<p>	* gc.c: ditto.</p>

<p>	* insns.def: ditto.</p>

<p>	* vm.c: ditto.</p>

<p>	* vm_args.c: ditto.</p>

<p>	* vm_backtrace.c: ditto.</p>

<p>	* vm_dump.c: ditto.</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Fri Jul  3 14:30:18 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/file.c: some mingw compilers need a tweek for the 	  declarations of _wfreopen_s.  [Bug #11320]</p>

<p>Fri Jul  3 12:25:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* transcode.c (rb_econv_set_replacement): target encoding name can 	  be empty now.  [ruby-core:69841] [Bug #11324]</p>

<p>Fri Jul  3 07:21:06 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* benchmark/bm_io_nonblock_noex.rb: new benchmark 	* ext/openssl/ossl_ssl.c (no_exception_p): new function 	  (ossl_start_ssl): adjust for no_exception_p 	  (ossl_ssl_connect): adjust ossl_start_ssl call 	  (ossl_ssl_connect_nonblock): ditto 	  (ossl_ssl_accept): ditto 	  (ossl_ssl_accept_nonblock): ditto 	  (ossl_ssl_read_internal): adjust for no_exception_p 	  (ossl_ssl_write_internal): ditto 	  (ossl_ssl_write): adjust ossl_write_internal call 	  (ossl_ssl_write_nonblock): ditto 	* ext/stringio/stringio.c (strio_read_nonblock): 	  delay exception check 	* io.c (no_exception_p): new function 	  (io_getpartial): call no_exception_p 	  (io_readpartial): adjust for io_getpartial 	  (get_kwargs_exception): remove 	  (io_read_nonblock): adjust for io_getpartial, 	  check no_exception_p on EOF 	  (io_write_nonblock): call no_exception_p 	  (rb_io_write_nonblock): do not check `exception: false&#39; 	  (argf_getpartial): adjust for io_getpartial 	  [ruby-core:69778] [Feature #11318]</p>

<p>Fri Jul  3 07:13:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (replace_real_basename): Win32 API does not set errno, get 	  the last error by GetLastError() and map to errno.  [Bug #10015]</p>

<p>Thu Jul  2 21:32:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (replace_real_basename): show warnings at errors. 	  [Bug #10015]</p>

<p>Thu Jul  2 18:39:20 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: remove `#define RGENGC_OBJ_INFO 1&#39; line introduced to 	  debug Bug #11244.</p>

<p>Thu Jul  2 18:34:26 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_raw_obj_info): separated from rb_obj_info(). 	  Fill internal object information into passed buffer.</p>

<p>	* gc.h: declare rb_raw_obj_info().</p>

<p>Thu Jul  2 16:15:04 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (replace_real_basename): update path type by the target 	  attributes if possible, to improve the performance.  [Bug #10015]</p>

<p>Thu Jul  2 14:45:53 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* st.c: get rid of VC++&#39;s warnings of C4700 (uninitialized local 	  variable used).  I think that these are wrong, but should shut them 	  up.</p>

<p>Thu Jul  2 14:15:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/rubygems.rb (Gem.load_path_insert_index): search 	  @gem_prelude_index first.</p>

<p>	* lib/rubygems/test_case.rb (Gem::TestCase#setup): keep already 	  expanded paths to preserve instance variables.</p>

<p>Thu Jul  2 14:12:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby.c (process_options): also copy initial load path marks at 	  setting load paths encoding.</p>

<p>Thu Jul  2 12:26:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/rubygems/test_gem_server.rb (process_based_port): use 	  dynamically chosen port numbers to get rid of conflicts.</p>

<p>Thu Jul  2 11:58:59 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/rubygems/test_gem_specification.rb: skip tests which the 	  platform does not permit the filename of its test file.</p>

<p>Thu Jul  2 11:36:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/rubygems/test_gem_resolver_git_specification.rb: require 	  rubygems/installer.rb before Gem::TestCase#setup runs, otherwise 	  as Gem::TestCase#teardown restores $LOADED_FEATURES to the state 	  at that time, the requiring the file in GitSpecification#install 	  method causes a lot of constant redefinitions.</p>

<p>Thu Jul  2 10:43:36 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/rubysocket.h: flags for common socket families 	  (rsock_getfamily): update signature 	* include/ruby/io.h: comment socket FMODE flags 	* ext/socket/init.c (rsock_getfamily): memoize family 	* ext/socket/basicsocket.c: adjust rsock_getfamily calls 	* ext/socket/ancdata.c: ditto 	  [ruby-core:69713] [Feature #11298]</p>

<p>Thu Jul  2 10:30:01 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/resolver.rb: fixed NameError of Gem::Util::NULL_DEVICE.</p>

<p>Thu Jul  2 09:51:44 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems/resolver.rb: fix error of null device reference with DOSISH 	  platform.</p>

<p>Thu Jul  2 06:49:44 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems: Update to RubyGems HEAD(c202db2). 	  this version contains many enhancements see <a href="http://git.io/vtNwF">git.io/vtNwF</a> 	* test/rubygems: ditto.</p>

<p>Wed Jul  1 23:50:34 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* test/net/http/test_httpresponse.rb 	(HTTPResponseTest#test_read_body_content_encoding_deflate_uppercase): 	fix a failure without zlib.</p>

<p>Wed Jul  1 10:54:56 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* Add test for Enumerable#none? [fix GH-950] Patch by @yui-knk</p>

<p>Wed Jul  1 09:30:36 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* struct.c (struct_set_members): hide internal back_members 	  object, and members object does not need to be duped as it 	  should be frozen and hidden.</p>

<p>Wed Jul  1 09:28:47 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* struct.c (struct_member_pos): revert r51080 to fix other 	  implicit conversions but cast the return value to fix the 	  previous implicit conversion.</p>

<p>Wed Jul  1 08:47:24 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* struct.c (struct_member_pos): avoid implicit conversion loses 	  integer precision: &#39;long&#39; to &#39;int&#39;.</p>

<p>Wed Jul  1 05:57:03 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* vm_method.c (rb_add_method_iseq): add RB_GC_GUARD 	* class.c (clone_method): remove RB_GC_GUARD 	* struct.c (define_aref_method): ditto 	  (define_aset_method): ditto 	* vm.c (vm_define_method): 	* iseq.c (rb_iseq_clone): add RB_GC_GUARD</p>

<p>Wed Jul  1 05:43:58 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* struct.c (AREF_HASH_THRESHOLD): new macro 	  (id_back_members): new ID 	  (struct_member_pos_ideal): new function 	  (struct_member_pos_probe): ditto 	  (struct_set_members): ditto 	  (struct_member_pos): ditto 	  (rb_struct_getmember): use struct_member_pos for O(1) access 	  (rb_struct_aref_sym): ditto 	  (rb_struct_aset_sym): ditto 	  (setup_struct): call struct_set_members 	  (struct_define_without_accessor): ditto 	  (Init_Struct): initialize <em>members_back</em> 	  [ruby-core:66851] [ruby-core:69705] [ruby-core:69821]</p>

<p>Tue Jun 30 23:12:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (rb_io_reopen): FilePathValue() ensures the path 	  NUL-terminated and frozen, so it is unnecessary to make it shared.</p>

<p>Tue Jun 30 23:11:53 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (check_dirname): ensure path name NUL-terminated for 	  SHARABLE_MIDDLE_SUBSTRING.</p>

<p>	* io.c (rb_sysopen): ditto.</p>

<p>Tue Jun 30 18:38:16 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/file.c (rb_freopen): need to terminate by NUL.</p>

<p>Tue Jun 30 17:28:25 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (rb_io_reopen): freopen(3) with OS encoding path. 	  [ruby-core:69780] [Bug #11320]</p>

<p>	* win32/file.c (rb_freopen): wrapper of wchar version freopen(3). 	  use _wfreopen_s() if available.</p>

<p>Tue Jun 30 08:24:08 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* io.c (rb_io_oflags_modestr): handle O_TRUNC correctly 	* test/ruby/test_io.rb (test_reopen_stdio): new test 	  Patch-by: cremno phobia &lt;cremno@mail.ru&gt; 	  [ruby-core:69779] [Bug #11319]</p>

<p>Tue Jun 30 02:47:02 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* include/ruby/st.h (struct st_table): hide struct list_head 	* st.c (struct st_table_entry): adjust struct 	  (head, tail): remove shortcut macros 	  (st_head): new wrapper function 	  (st_init_table_with_size): adjust to new struct and API 	  (st_clear): ditto 	  (add_direct): ditto 	  (unpack_entries): ditto 	  (rehash): ditto 	  (st_copy): ditto 	  (remove_entry): ditto 	  (st_shift): ditto 	  (st_foreach_check): ditto 	  (st_foreach): ditto 	  (get_keys): ditto 	  (get_values): ditto 	  (st_values_check): ditto 	  (st_reverse_foreach_check): ditto (unused) 	  (st_reverse_foreach): ditto (unused) 	  [ruby-core:69726] [Misc #10278]</p>

<p>Mon Jun 29 17:38:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* insns.def (defineclass): do not quote unprintable characters at 	  raising an exception.</p>

<p>Mon Jun 29 16:01:24 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/net/http/response.rb (inflater): CONTENT_ENCODING can be upper 	  case. [ruby-core:69670] [Bug #11285] patched by Andy Chu</p>

<p>Mon Jun 29 14:50:08 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* eval.c (add_activated_refinement): should not include the original 	  class.</p>

<p>Mon Jun 29 12:09:10 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* README.md: tweak styles. [fix GH-945][ci skip] Patch by @bryndyment</p>

<p>Mon Jun 29 07:23:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* template/sizes.c.tmpl: extract RUBY_DEFINT to define sizes of 	  types checked by configure.in, and fix size of intptr_t in 	  universal binary.</p>

<p>Mon Jun 29 02:10:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* insns.def (defineclass): preserve encoding of name in error 	  messages for super class mismatch.</p>

<p>	* insns.def (defineclass): preserve encoding of name in error 	  messages for non-class super.</p>

<p>	* insns.def (defineclass): preserve encoding of name in error 	  messages when already defined but type mismatch.</p>

<p>Sun Jun 28 12:07:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* class.c (rb_define_class_id_under): raise TypeError exception 	  same as ruby level class definition when superclass mismatch.</p>

<p>Sun Jun 14 19:02:03 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* lib/net/ftp.rb (makeport): close the TCPServer 	  when sending the port fails.</p>

<p>	* test/net/ftp/test_ftp.rb: test for above.</p>

<p>Fri Jun 26 12:48:37 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* transcode.c (load_transcoder_entry): fix transcoder loading race 	  condition, by waiting in require.  [ruby-dev:49106] [Bug #11277]</p>

<p>Fri Jun 26 07:53:56 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* enum.c (enum_minmax): simplify return value creation 	* test/ruby/test_enum.rb: test behavior on empty 	* hash.c (rb_hash_fetch_m): remove unnecessary volatile since r41597 	  (env_reject_bang): trade volatile for GC guard 	  (env_select): ditto 	  (env_select_bang): ditto 	  (env_keep_if): ditto 	  (rb_env_clear): ditto</p>

<p>Thu Jun 25 21:24:28 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/-ext-/popen_deadlock/test_popen_deadlock.rb: test [Bug #11265]</p>

<p>	* ext/-test-/popen_deadlock/infinite_loop_dlsym.c: new ext to call 	  dlsym(3) infinitely without GVL, used in the above test.</p>

<p>	* ext/-test-/popen_deadlock/extconf.rb: extconf.rb for the above 	  ext. Currently, only enabled on Solaris (main target) and Linux 	  (as a reference platform and for debugging the ext).</p>

<p>Thu Jun 25 19:24:25 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* configure.in: not to use vfork on Solaris to avoid deadlock 	  occurred in vfork(2) with multi-threading and dynamic linker 	  on Solaris. [Bug #11265] [ruby-dev:49089]</p>

<p>Thu Jun 25 18:25:41 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/lib/envutil.rb (Test::Unit::Assertions#assert_no_memory_leak): 	  NO_MEMORY_LEAK_ENVS is moved to Memory::NO_MEMORY_LEAK_ENVS 	  to reduce child executions during test-all on Solaris.</p>

<p>	* test/lib/memory_status.rb (Memory::NO_MEMORY_LEAK_ENVS): ditto.</p>

<p>Thu Jun 25 17:32:33 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (rb_method_entry_create): need to call 	  method_definition_reset() if def is given.</p>

<p>	  Actually, `me&#39; is a new object, so we don&#39;t need to call it. 	  It is just to make sure.</p>

<p>	* vm_method.c (method_definition_reset): remove duplicated insertion.</p>

<p>	* vm_method.c (rb_method_entry_clone): assign dst-&gt;def here, 	  not in method_definition_reset().</p>

<p>Thu Jun 25 16:44:54 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c: make a rb_method_definition_t data (def) <strong>after</strong> making 	  a rb_method_entry_t data (me).</p>

<p>	  Normally, `me&#39; points `def&#39;. Some Ruby objects pointed from `def&#39; 	  and objects are marked by `me&#39; (mark_method_entry() in gc.c). 	  However, `def&#39; is built before making a `me&#39;, then nobody can mark 	  objects pointed from `def&#39; before making (and pointing from) `me&#39;.</p>

<p>	  I hope this patch solve #11244.</p>

<p>	* vm_method.c: remove `rb_&#39; prefix from some static functions.</p>

<p>	* method.h (rb_method_entry_create): constify</p>

<p>	* gc.c (mark_method_entry): add checking `def&#39; and 	  `def-&gt;body.iseq.iseqptr&#39; availability because they can be NULL.</p>

<p>Thu Jun 25 14:14:16 2015  takiy33  &lt;takiy33@gmail.com&gt;</p>

<p>	* test/test_prime.rb (test_eratosthenes_works_fine_after_timeout): 	  use spaces instead of TABs in ruby codes.  [Fix GH-944]</p>

<p>Thu Jun 25 07:08:35 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (obj_info, method_type_name): show method type name in a string 	  instead of a number.</p>

<p>Thu Jun 25 06:49:25 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (obj_info): show more details for T_IMEMO/imemo_ment.</p>

<p>Thu Jun 25 06:40:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (rb_method_definition_reset): need a WB for 	  VM_METHOD_TYPE_ATTRSET.</p>

<p>Thu Jun 25 03:33:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (RGENGC_OBJ_INFO, obj_info): add a macro to enable/disable 	  rich obj_info() output.</p>

<p>	  At the default, the value of RGENGC_OBJ_INFO is 	  (RGENGC_DEBUG | RGENGC_CHECK_MODE).</p>

<p>	* gc.c (RGENGC_OBJ_INFO): force enable it to debug #11244.</p>

<p>	* gc.c (gc_mark_ptr): print more details with obj_info().</p>

<p>	* gc.c (gc_mark_children): remove useless debug prints.</p>

<p>Thu Jun 25 02:40:33 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_read_internal): 	  do not process kwargs in blocking mode 	* test/openssl/test_ssl.rb: test sysread</p>

<p>Wed Jun 24 16:54:11 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_children): add additional debug code for #11244.</p>

<p>Wed Jun 24 16:05:42 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* string.c (rb_str_justify): use RB_GC_GUARD</p>

<p>Wed Jun 24 14:25:17 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_ptr): add a check code for #11244.</p>

<p>	  It should be removed later. But we can remain this check 	  because it is only a branch.</p>

<p>Wed Jun 24 12:49:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_fstring_cstr): new function to make a fstring from 	  a string literal.</p>

<p>	* internal.h (rb_fstring_lit): new macro to make a fstring from a 	  string literal.</p>

<p>	* include/ruby/intern.h (rb_strlen_lit): new macro to get the 	  length of a string literal, borrowed from mruby/mruby@e4afd53.</p>

<p>Wed Jun 24 12:21:16 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* re.c: Update documentation for Regexp class. 	  [fix GH-937][ci skip] Patch by @davydovanton</p>

<p>Wed Jun 24 09:23:03 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (generic_ivar_set): remove FL_ABLE check 	  (gen_ivar_copy): ditto 	  [ruby-core:69715]</p>

<p>Wed Jun 24 08:28:15 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_recvmsg_internal): reduce stack use 	  [ruby-core:69595] [Feature #11263]</p>

<p>Tue Jun 23 14:32:42 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* error.c (name_err_receiver): raise ArgumentError if no receiver 	  is available on this exception object.  [Feature #10881]</p>

<p>Tue Jun 23 09:48:34 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* dir.c (check_dirname): avoid volatile, use return value 	  (dir_s_chroot, dir_s_mkdir, dir_s_rmdir): adjust callers</p>

<p>Tue Jun 23 06:37:10 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* struct.c (struct_ivar_get): cache member definition in a subclass 	  Thanks to Sokolov Yura aka funny_falcon &lt;funny.falcon@gmail.com&gt; 	  in <a href="https://bugs.ruby-lang.org/issues/10585">bugs.ruby-lang.org/issues/10585</a></p>

<p>Tue Jun 23 04:58:06 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* benchmark/bm_vm2_struct_big_href_hi.rb: new benchmark 	* benchmark/bm_vm2_struct_big_href_lo.rb: ditto 	* benchmark/bm_vm2_struct_big_hset.rb: ditto 	* benchmark/bm_vm2_struct_small_href.rb: ditto 	* benchmark/bm_vm2_struct_small_hset.rb: ditto 	  Thanks to Sokolov Yura aka funny_falcon &lt;funny.falcon@gmail.com&gt; 	  in <a href="https://bugs.ruby-lang.org/issues/10585">bugs.ruby-lang.org/issues/10585</a></p>

<p>Mon Jun 22 18:08:48 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/lib/test/unit.rb (Test::Unit::Parallel#start_watchdog): removed 	  because it has been meaningless since r36385. [Bug #11288]</p>

<p>	* test/lib/test/unit.rb (Test::Unit::Parallel#_run_parallel): delete 	  lines related to the removed start_watchdog method</p>

<p>Sun Jun 21 23:52:46 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* NEWS: mention about Array#bsearch_index and Hash#fetch_values.</p>

<p>Sun Jun 21 23:46:27 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* NEWS: add a reference to a ticket.</p>

<p>Sun Jun 21 20:28:09 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* internal.h (roomof): extract from type_roomof, and move from 	  bignum.c.</p>

<p>Sun Jun 21 18:32:37 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ruby_atomic.h (ATOMIC_PTR_CAS): define by generic CAS macro, not 	  via size_t, to suppress a warning by mingw gcc.</p>

<p>Sun Jun 21 05:31:41 2015  Shota Fukumori  &lt;her@sorah.jp&gt;</p>

<p>	* ext/objspace/objspace_dump.c(dump_object): Return empty JSON object when 	  passed object is a special const, instead of SEGV. 	  Based patch by Kohei Suzuki (eagletmt). [ruby-core:69692] [Bug #11291]</p>

<p>	* test/objspace/test_objspace.rb(test_dump_special_consts): Test for above fix.</p>

<p>Sat Jun 20 03:56:58 2015  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>	* enc/make_encmake.rb: the list of encoding extension libraries must 	  not include encinit.c itself.  It caused “undefined reference to 	  Init_encinit”.</p>

<p>Sat Jun 20 02:03:53 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* process.c (rb_execarg_parent_start1): new macro ALWAYS_NEED_ENVP 	  to generate envp_str anytime on Solaris 10 (or earlier version 	  of Solaris) to avoid calling execv() which is async-signal unsafe 	  on Solaris 10. [Bug #11265] [ruby-dev:49089]</p>

<p>	* process.c (exec_with_sh, proc_exec_cmd): On Solaris 10, 	  because ALWAYS_NEED_ENVP is 1 and envp_str is always generated, 	  execv() in exec_with_sh() and proc_exec_cmd() are never called. 	  To guarantee this, execv() is replaced by a macro to print 	  out error message on Solaris 10.</p>

<p>	* process.c (proc_exec_sh): Because proc_exec_sh() may be called 	  by rb_proc_exec() with envp_str = Qfalse, execl() is replaced 	  by a macro that calls execle() with “extern char **environ” 	  traditional global variable on Solaris 10. 	  TODO: This may be unsafe and should be changed in the future. 	  Although rb_proc_exec() is not used from inside current version 	  of ruby, it may be called by third-party extensions.</p>

<p>Sat Jun 20 01:10:13 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* NEWS: mention about $SAFE.</p>

<p>Fri Jun 19 14:53:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (rb_mod_define_method): now requires a block direct to 	  this method call.  [ruby-core:69655] [Bug #11283]</p>

<p>Fri Jun 19 13:54:43 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (rb_mod_define_method): get rid of inadvertent ID 	  creations at error.</p>

<p>Fri Jun 19 07:58:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/extmk.rb: if no with-ext option is given, default to 	  enable everything.  [ruby-dev:49108] [Bug #11280]</p>

<p>Fri Jun 19 06:30:07 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* bootstraptest/test_method.rb: remove a test because $SAFE=2 was 	  obsolete.</p>

<p>	  Please check btest, too.</p>

<p>Thu Jun 18 23:51:51 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* bin/erb: $SAFE=3 is obsolete.</p>

<p>Thu Jun 18 23:45:11 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* safe.c: removed needless doc related $SAFE=2</p>

<p>Thu Jun 18 23:38:07 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_safe_level): fix document.  $SAFE=3 is obsolete. 	  [ci skip]</p>

<p>Thu Jun 18 23:25:51 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/extmk.rb: configure intersection of with-ext and not 	  without-ext, as withouts is no longer true by default if 	  with-ext option is given.  [ruby-dev:49108] [Bug #11280]</p>

<p>Thu Jun 18 23:20:46 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h: $SAFE=2 is now obsolete.</p>

<p>	* dir.c, ext/fiddle/handle.c, ext/socket/basicsocket.c, file.c 	  gc.c, io.c, process.c, safe.c, signal.c, win32/file.c: 	  removed code for $SAFE=2</p>

<p>	* test/erb/test_erb.rb, test/fiddle/test_handle.rb 	  test/ruby/test_env.rb: removed tests for $SAFE=2.</p>

<p>Thu Jun 18 22:50:07 2015  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>	* enc/make_encmake.rb: added –transes and –no-transes options.</p>

<p>Thu Jun 18 18:24:12 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/socket/test_unix.rb: replace sleep with select</p>

<p>Thu Jun 18 17:59:06 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (rb_vm_control_frame_id_and_class): remove useless codes. 	  `me&#39; knows ID and owner class.</p>

<p>Thu Jun 18 16:58:35 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: constify rb_method_alias_struct::original_me and 	  rb_method_refined_struct::orig_me.</p>

<p>	* class.c (move_refined_method): use RB_OBJ_WRITE() for 	  me-&gt;def-&gt;body.refined.orig_me.</p>

<p>Thu Jun 18 14:35:28 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/objspace/objspace.c (count_imemo_objects): support imemo_ment.</p>

<p>Thu Jun 18 13:32:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* error.c (name_err_receiver): add NameError#receiver method. 	  [Feature #10881]</p>

<p>Thu Jun 18 10:00:06 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* safe.c: removed needless doc related $SAFE=3</p>

<p>Thu Jun 18 09:59:23 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* safe.c: rename old method name for $SAFE=3</p>

<p>Thu Jun 18 06:02:42 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* compile.c (get_exception_sym2type, iseq_build_from_ary_body): 	  rely on %+PRIsVALUE instead of calling rb_inspect directly</p>

<p>Wed Jun 17 20:59:25 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* common.mk (ENC_MK): needs fake.rb if cross compilation. 	  [ruby-dev:49098] [Bug #11272]</p>

<p>Wed Jun 17 20:23:29 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/rbconfig/sizeof/extconf.rb: Check __float80.</p>

<p>Wed Jun 17 15:15:53 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* safe.c (safe_setter): of course, don&#39;t have to warn the limitation of 	  $SAFE=3 after it&#39;s removed.</p>

<p>Wed Jun 17 14:29:43 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h: $SAFE=3 is now obsolete.</p>

<p>	* ext/socket/init.c, ext/socket/socket.c, ext/socket/tcpsocket.c 	  ext/socket/udpsocket.c, gc.c, object.c, re.c, safe.c: removed code 	  for $SAFE=3</p>

<p>	* bootstraptest/test_method.rb, test/erb/test_erb.rb, test/ruby/test_dir.rb 	  test/ruby/test_file.rb, test/ruby/test_method.rb, test/ruby/test_regexp.rb 	  test/ruby/test_thread.rb: remove tests for $SAFE=3</p>

<p>Wed Jun 17 12:13:33 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ChangeLog: added contributor name.</p>

<p>Wed Jun 17 10:57:28 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/csv.rb: accept to use Range object for row selection. 	  contributed by Mitsutaka Mimura. 	  [Feature #<a href="ruby-dev:49091">11267]</a></p>

<p>Wed Jun 17 09:50:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/rdoc/servlet.rb (documentation_search, root_search): 	  requires json for JSON.dump and fix sporadic failures due to 	  the loading order.</p>

<p>Tue Jun 16 19:19:53 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/rbconfig/sizeof/extconf.rb: Check several types defined in C99 	  and x86_64 ABI.</p>

<p>	* template/sizes.c.tmpl: Relax a pattern for types.</p>

<p>Tue Jun 16 17:37:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/objspace/test_objspace.rb: relax pattern because uncollectible 	  flag and marked flag can be false at major GC. 	  [Bug #10852]</p>

<p>Tue Jun 16 04:50:44 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/basicsocket.c (bsock_recv): document outbuf 	* ext/socket/unixsocket.c (unix_recvfrom): ditto 	* ext/socket/init.c (rsock_strbuf, recvfrom_locktmp): new functions 	  (rsock_s_recvfrom): support destination buffer as 3rd arg 	  (rsock_s_recvfrom_nonblock): ditto 	* string.c (rb_str_locktmp_ensure): export for internal ext 	* test/socket/test_nonblock.rb: test recv_nonblock 	* test/socket/test_unix.rb: test recv 	  [ruby-core:69543] [Feature #11242]</p>

<p>Tue Jun 16 04:38:02 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal, 	  bsock_recvmsg_internal): 	  support “exception: false” kwarg 	* ext/socket/init.c (rsock_s_recvfrom_nonblock): 	  ditto 	* ext/socket/init.c (rsock_s_recvfrom_nonblock): use rsock_opt_false_p 	* ext/socket/socket.c (sock_connect_nonblock): ditto 	* ext/socket/rubysocket.h (rsock_opt_false_p): new function 	* ext/socket/basicsocket.c (bsock_recv_nonblock): update rdoc 	* ext/socket/udpsocket.c (udp_recvfrom_nonblock): ditto 	* test/socket/test_nonblock.rb: new tests 	  [ruby-core:69542] [Feature #11229]</p>

<p>Mon Jun 15 14:33:02 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* lib/set.rb: Make Set#each and SortedSet#each generate a sized 	  enumerator. [GH-931] by kachick (Kenichi Kamiya)</p>

<p>	* test/test_set.rb: Import tests from Set into SortedSet. [GH-931] 	  by kachick (Kenichi Kamiya)</p>

<p>Mon Jun 15 02:26:34 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/net/http.rb (Net::HTTP#connect): use connect_nonblock and 	  io/wait to eliminate timeout use. fix GH-899</p>

<p>Sat Jun 13 07:21:18 2015  KOSAKI Motohiro  &lt;kosaki.motohiro@gmail.com&gt;</p>

<p>	* thread.c (thread_start_func_2): don&#39;t interrupt when last thread 	  exit unless main thread is already exited. Otherwise main thread 	  could be wrongly interrupted when it uses rb_thread_call_without_gvl(). 	  Patch by Takehiro Kubo. [Bug #<a href="ruby-dev:49044">11237]</a>[GH-898]</p>

<p>	* test/-ext-/gvl/test_last_thread.rb: new test for the above fix.</p>

<p>	* ext/-test-/gvl/call_without_gvl/call_without_gvl.c: new ext for 	  the above test. 	* ext/-test-/gvl/call_without_gvl/extconf.rb: ditto.</p>

<p>Mon Jun 15 00:14:33 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/pathname/lib/pathname.rb (descend): Blockless form supported. 	  (ascend): Ditto. 	  [ruby-core:68820] [Feature #11052] Patch by Piotr Szotkowski.</p>

<p>Sun Jun 14 20:09:25 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* time.c (time_getlocaltime): [DOC] Add examples of valid utc_offset 	  formats. 	  [ruby-core:68306] [Misc #10905] Patch by Charles Korn.</p>

<p>Sun Jun 14 18:49:56 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/socket/raddrinfo.c (parse_numeric_port): Detect 	  port overflow. 	  (numeric_getaddrinfo): Use parse_numeric_port. 	  numeric_getaddrinfo fails if port is too big now. 	  This makes rb_getaddrinfo invokes the real getaddrinfo() 	  on such condition. 	  This change is related to [ruby-core:69355] [Bug #11179].</p>

<p>Sun Jun 14 17:26:03 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* enum.c (enum_chunk_while): New method Enumerable#chunk_while. 	  [ruby-core:67738] [Feature #10769] proposed by Tsuyoshi Sawada.</p>

<p>Sun Jun 14 17:20:40 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_file_load_ok): try opening file without gvl not to 	  lock entire process.  [Bug #11060]</p>

<p>Sun Jun 14 10:43:50 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/runruby.rb: just remove the lines of RUBY_VERSION check and raise 	  instead of replacing the check to <code>true</code>, for getting rid of a 	  warning `possibly useless use of true in void context`.</p>

<p>Sun Jun 14 10:13:55 2015  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* lib/rexml/source.rb (REXML::IOSource#scan): Fix a typo in 	  document. [fix GH-934] 	  Patch by Anton Davydov. Thanks!!!</p>

<p>Sun Jun 14 10:09:48 2015  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* lib/rexml/attlistdecl.rb (REXML::AttlistDecl): Fix a typo in 	  document. [fix GH-934] 	  Patch by Anton Davydov. Thanks!!!</p>

<p>Sun Jun 14 06:24:57 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* test/ruby/test_io.rb: add test for IO.binread fd leak. 	  See r50881.</p>

<p>Sun Jun 14 05:23:51 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* io.c (rb_io_s_binread): close fd if seek offset is invalid.</p>

<p>Sun Jun 14 04:40:32 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* test/lib/leakchecker.rb (check): refactor.</p>

<p>Sun Jun 14 04:34:14 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* test/lib/leakchecker.rb: Return false for no leaks. 	  Otherwise the GC could run for nothing.</p>

<p>Sun Jun 14 04:15:40 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* lib/delegate.rb: [DOC] Update SimpleDelegator example. [ci skip]</p>

<p>Sat Jun 13 20:28:14 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* file.c (rb_stat_ino): get inode from the interval of struct st.</p>

<p>	* win32/win32.c (stati64_set_inode): get nFileIndexHigh/Low, and set it 	  to the interval of struct st as inode. 	  [Feature #11216]</p>

<p>	* win32/win32.c (stati64_set_inode_handle): call stati64_set_inode.</p>

<p>	* win32/win32.c (rb_w32_fstati64): call stati64_set_inode_handle.</p>

<p>	* win32/win32.c (stati64_handle): call stati64_set_inode.</p>

<p>Sat Jun 13 19:44:53 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/io/console/depend (.list.chksum): revert a part of r50859, because 	  it was not mentioned at its commit log and it caused a build error on 	  Windows ($(MAKE) is already quoted).</p>

<p>Sat Jun 13 17:35:11 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* vm_core.h (rb_thread_t): add th-&gt;name.</p>

<p>	* vm.c (th_init): initialize th-&gt;name.</p>

<p>	* thread.c (Init_Thread): add Thread.name and name=. [Feature #11251]</p>

<p>	* thread.c (rb_thread_inspect): show thread&#39;s name if set.</p>

<p>	* thread.c (rb_thread_getname): defined.</p>

<p>	* thread.c (rb_thread_setname): ditto.</p>

<p>Sat Jun 13 11:39:43 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/tempfile.rb: Fix typo. [fix GH-933] Patch by @Zorbash</p>

<p>Sat Jun 13 11:38:00 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/openssl/ossl_ocsp.c: fix documentation on ocsp response cert status. 	  [fix GH-932] Patch by @chrisholmes</p>

<p>Sat Jun 13 11:35:19 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.gemspec: Fix require paths for released gem. 	  [fix GH-929] Patch by @voxik 	* ext/io/console/io-console.gemspec: ditto.</p>

<p>Sat Jun 13 00:45:08 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Return sized enumerators. 	  Patch by Kenichi Kamiya [GH-931]</p>

<p>Sat Jun 13 00:45:06 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Fix with_object with no block given</p>

<p>Sat Jun 13 00:44:59 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Have with_index accept an offset parameter. 	  Based on patch by T Yamada. [#11007]</p>

<p>Fri Jun 12 22:21:12 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* test/ruby/test_extlibs.rb (TestExtLibs::check_existence): fix 	  error. [Bug #11255] [ruby-dev:49079]</p>

<p>Fri Jun 12 21:17:46 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* pack.c (pack_<code>un,</code>pack): new template character <code>j</code> and <code>J</code>, pointer 	  with signed and unsigned integers.</p>

<p>	* NEWS: mention about this feature. 	  [Feature #11215] [ruby-dev:49015]</p>

<p>Fri Jun 12 21:01:44 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* file.c (File::SHARE_DELETE): new flag to be able to delete opened file 	  on Windows.</p>

<p>	* include/win32/win32.c (O_SHARE_DELETE): new pseudo file mode flag.</p>

<p>	* win32/win32.c (rb_w32_<code>w,</code>open): support above flag.  [EXPERIMENTAL]</p>

<p>	* NEWS: mention about this feature. 	  [Feature #11218] [ruby-dev:49022]</p>

<p>Fri Jun 12 18:21:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ChangeLog: added missing commit message.</p>

<p>Fri Jun 12 18:20:37 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* sample/exyacc.rb: Fix some typos. [fix GH-927] Patch by @davydovanton 	* sample/list.rb: ditto. 	* sample/trick2013/kinaba/remarks.markdown: ditto.</p>

<p>Fri Jun 12 17:34:14 2015  Wojciech Mach  &lt;wojtek@wojtekmach.pl&gt;</p>

<p>	* hash.c (rb_hash_fetch_values): add <code>Hash#fetch_values</code>. 	  [Feature #10017] [Fix GH-776]</p>

<p>Fri Jun 12 16:28:17 2015  Radan Skoric  &lt;radan.skoric@gmail.com&gt;</p>

<p>	* array.c (rb_ary_bsearch_index): Implement Array#bsearch_index 	  method, which is similar to bsearch and returns the index or 	  nil.  [Feature #10730]</p>

<p>Thu Jun 11 19:11:22 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/zlib/zlib.c: Fix indentation for rdoc. 	  [Bug #<a href="ruby-core:69465">11221]</a></p>

<p>Thu Jun 11 16:23:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h (METHOD_ENTRY_BASIC_SET): fix last commit (unbalanced parens).</p>

<p>Thu Jun 11 15:14:16 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* configure.in: define SET_THREAD_NAME if it has pthread_set_name_np 	  for FreeBSD, and don&#39;t define it if both pthread_setname_np 	  and pthread_set_name_np don&#39;t exist.</p>

<p>	* thread_pthread.c (SET_THREAD_NAME): don&#39;t define if they don&#39;t exist.</p>

<p>	* thread_pthread.c (native_set_thread_name): run if SET_THREAD_NAME 	  is defined.</p>

<p>Thu Jun 11 15:53:31 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h (METHOD_ENTRY_BASIC_SET): should clear last bit.</p>

<p>Thu Jun 11 14:34:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems.rb: bump version to 2.4.7 and 2.4.8. these versions fixed 	  CVE-2015-3900. 	* lib/rubygems/remote_fetcher.rb: ditto. 	* test/rubygems/test_gem_remote_fetcher.rb: added testcase for CVE-2015-3900</p>

<p>Thu Jun 11 14:18:51 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/rubygems.rb: bump version to 2.4.6. It&#39;s missing change at r49774.</p>

<p>Thu Jun 11 13:50:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (ary_ensure_room_for_push): check if array size will 	  exceed maximum size to get rid of buffer overflow. 	  [ruby-dev:49043] [Bug #11235]</p>

<p>	* array.c (ary_ensure_room_for_unshift, rb_ary_splice): ditto.</p>

<p>Thu Jun 11 13:17:34 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/test_cmath.rb (TestCMath#test_trigonometric_functions): should 	  not compare float values (in complex values) by <code>==</code>.</p>

<p>Thu Jun 11 08:52:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: embed rb_method_entry_t::attr::flags (5 bits) into 	  rb_method_entry_t::flags to make one word spare space.</p>

<p>	  Add some macros to access these flags.</p>

<p>	* vm_method.c: use these macros.</p>

<p>	* internal.h: define IMEMO_FL_USHIFT and <a href="0-4">IMEMO_FL_USER</a> 	  for T_IMEMO local flags.</p>

<p>Thu Jun 11 08:27:06 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c: use VM_ASSERT instead of assert().</p>

<p>	* vm_args.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Thu Jun 11 08:16:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: define VM_ASSERT() for assertion 	  enabled only when (VM_CHECK_MODE &gt; 0).</p>

<p>	* vm_insnhelper.c: move definition VM_CHECK_MODE 	  from vm_insnhelper.c to vm_core.h.</p>

<p>	* vm.c: remove &lt;assert.h&gt;</p>

<p>Thu Jun 11 06:46:07 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (check_frame): check type of cref_or_me first.</p>

<p>Thu Jun 11 04:34:39 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* test/test_cmath.rb: Add some assertions.</p>

<p>Thu Jun 11 00:34:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* template/fake.rb.in: expanded macro result may have spaces 	  between tokens.  [ruby-dev:49047] [Bug #11243]</p>

<p>Wed Jun 10 22:27:32 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* lib/mkmf.rb: revert r50804 because of build failure when specifying 	  LDFLAGS during configure, observed on Solaris with GCC 4.6. 	  [Bug #11245]</p>

<p>Wed Jun 10 21:59:51 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* README.ja.md: fix markup miss.</p>

<p>Wed Jun 10 11:06:25 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* template/fake.rb.in: turn into erb template from autoconf 	  template to fake more accurately.</p>

<p>	* common.mk (fake.rb): needs preprocessed file now.</p>

<p>	* version.c (Init_version): add dummy expression to 	  RUBY_ENGINE_VERSION.</p>

<p>Tue Jun  9 12:31:25 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Simplify and optimize EratosthenesSieve</p>

<p>Tue Jun  9 11:45:00 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Simplify and optimize EratosthenesSieve 	  based on patch by Ajay Kumar. [Fixes GH-921]</p>

<p>Mon Jun  8 05:09:58 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (obj_info): print method id for T_IMEMO/ment.</p>

<p>Sun Jun  7 07:05:43 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* Move test cases from test/ruby/test_complex.rb to test/test_cmath.rb</p>

<p>Sat Jun  6 18:23:41 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: back to share rb_method_definition_t by 	  rb_method_entry_t.</p>

<p>	  r50728 changed sharing `def&#39;s to isolating `def&#39;s 	  on alias and so on. However, this change conflicts 	  future improvement plan. So I change back to sharing approach.</p>

<p>	* method.h: move rb_method_definition_t::flags to 	  rb_method_entry_t::attr::flags.</p>

<p>	  rb_method_entry_t::attr is union with VALUE because this field 	  should have same size of VALUE. rb_method_entry_t is T_IMEMO).</p>

<p>	  And also add the following access macros to it&#39;s fields.</p>

<p>	  * METHOD_ENTRY_VISI(me) 	  * METHOD_ENTRY_BASIC(me) 	  * METHOD_ENTRY_SAFE(me)</p>

<p>	* vm_method.c (rb_method_definition_addref): added instead of 	  rb_method_definition_clone().</p>

<p>	  Do not create new definition, but increment alias_count.</p>

<p>	* class.c (clone_method): catch up this fix.</p>

<p>	* class.c (method_entry_i): ditto.</p>

<p>	* proc.c (mnew_internal): ditto.</p>

<p>	* proc.c (mnew_missing): ditto.</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Sat Jun  6 15:59:38 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c: ins_methods_push() needs rb_method_visibility_t type on 	  2nd arg.</p>

<p>Sat Jun  6 15:05:47 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (ins_methods_push): Change type and name of parameters 	  to make more clear.</p>

<p>Sat Jun  6 08:52:13 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/socket/test_nonblock.rb: try to avoid EMSGSIZE 	  [ruby-core:69466]</p>

<p>Sat Jun  6 07:58:30 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: remove struct mark_tbl_arg and pass objspace directly 	  to avoid indirect access overhead.</p>

<p>Sat Jun  6 07:08:45 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal): drop redundant assignment</p>

<p>Sat Jun  6 01:00:06 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal): all arguments are 	  parsed even on systems without HAVE_STRUCT_MSGHDR_MSG_CONTROL 	  to prevent SEGV caused by passing Qnil to RARRAY_LENINT and 	  to preserve behavior before r50776. 	  [Bug #11224] [ruby-core:69468] [Bug #11225] [ruby-core:69469]</p>

<p>Fri Jun  5 22:37:42 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (ins_methods_push): change 3rd parameter&#39;s type 	  from long to rb_method_visibility_t.</p>

<p>	* class.c (ins_methods_i): catch up this fix.</p>

<p>	* class.c (method_entry_i): cast to st_data_t instead of `long&#39;.</p>

<p>Fri Jun  5 20:37:10 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: move definition of rb_cref_t to method.h.</p>

<p>	* eval_intern.h: move definition of rb_scope_visibility_t 	  to method.h.</p>

<p>	* method.h: change rb_cref_t::scope_visi from VALUE to 	  rb_scope_visibility_t. 	  [Bug #11219]</p>

<p>	* vm.c (vm_cref_new): accept rb_method_visibility_t directly.</p>

<p>	* vm_insnhelper.c (rb_vm_rewrite_cref): don&#39;t use 0, 	  but METHOD_VISI_UNDEF.</p>

<p>	* vm_method.c (rb_scope_visibility_set): don&#39;t need to use cast.</p>

<p>	* vm_method.c (rb_scope_module_func_set): ditto.</p>

<p>Fri Jun  5 17:27:30 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal): avoid msg_control 	  ptr if msg_controllen is zero to fix portability problems.</p>

<p>Fri Jun  5 09:17:45 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal): fix build error 	  from r50776</p>

<p>Fri Jun  5 07:05:58 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* io.c (sym_wait_readable, sym_wait_writable): declare 	  (io_getpartial): use sym_wait_readable 	  (io_write_nonblock): use sym_wait_writable 	  (Init_IO): initialize sym_wait_*able</p>

<p>Fri Jun  5 06:43:00 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* doc/extension.rdoc: note rb_get_kwargs changes keywords_hash 	  [ruby-core:68507]</p>

<p>Fri Jun  5 05:50:29 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal): use rb_scan_args 	  [ruby-core:69439] [Feature #11207]</p>

<p>Fri Jun  5 02:20:06 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/lib/envutil.rb (assert_no_memory_leak): change default value 	  of limit from 1.5 to 2.0. It is ad-hoc fix to solve test failure 	  in travis-ci.</p>

<p>Fri Jun  5 01:17:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_defined): no need to use cast.</p>

<p>Fri Jun  5 01:14:02 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_defined): show additional messages on rb_bug().</p>

<p>Fri Jun  5 01:06:02 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (rb_add_method_iseq): use intermediate struct to 	  avoid initializing struct with variables. 	  [Bug #11217]</p>

<p>	* method.h: add a comment about it.</p>

<p>Fri Jun  5 00:55:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: constify rb_method_refined_t::orig_me.</p>

<p>	  Also constify the following functions.</p>

<p>	  * rb_resolve_refined_method() 	  * rb_method_entry_with_refinements() 	  * rb_method_entry_without_refinements() 	  * rb_method_entry_copy()&#39;s parameter.</p>

<p>	* class.c: catch up this fix.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Thu Jun  4 12:47:54 SGT 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* array.c: Revert r50763. because “reentered” is not typo.</p>

<p>Thu Jun  4 11:12:29 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/win32ole/win32ole.c: fix a typo. Patch by @davydovanton 	  [fix GH-923] 	* include/ruby/st.h: ditto. 	* include/ruby/util.h: ditto.</p>

<p>Thu Jun  4 10:54:30 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* array.c: fix a typo. Patch by @manish-shrivastava 	  [fix GH-922]</p>

<p>Thu Jun  4 09:52:02 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb: use io/nonblock instead of fcntl 	  [ruby-core:69382] [Feature #11190]</p>

<p>Thu Jun  4 07:22:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: introduce rb_method_refined_t for refined method entry.</p>

<p>	* class.c (move_refined_method): catch up this fix.</p>

<p>	* gc.c (mark_method_entry): ditto.</p>

<p>	* vm_eval.c (vm_call0_body): ditto.</p>

<p>	* vm_insnhelper.c (vm_call_method): ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Thu Jun  4 07:12:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (dirent_match): match short names only when FNM_SHORTNAME 	  flag is given, for the backward compatibility, and the new 	  behavior is often dangerous.  [ruby-core:69435] [Bug #11206]</p>

<p>Thu Jun  4 05:44:01 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (special_generic_ivar): remove flag 	  (givar_i, rb_mark_generic_ivar_tbl): remove functions 	  (rb_free_generic_ivar, rb_ivar_lookup, rb_ivar_delete, 	   generic_ivar_set, rb_ivar_set, rb_ivar_defined, 	   rb_copy_generic_ivar, rb_ivar_foreach, rb_ivar_count, 	   rb_obj_remove_instance_variable): 	   adjust for lack of ivar support in special constants 	* test/ruby/test_variable.rb: test ivars for special consts 	* internal.h: remove rb_mark_generic_ivar_tbl decl 	* gc.c (gc_mark_roots): remove rb_mark_generic_ivar_tbl call 	  [ruby-core:69441] [Feature #11208]</p>

<p>Thu Jun  4 05:13:34 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (def_iseq_ptr): `iseqval&#39; is not available any more.</p>

<p>Thu Jun  4 04:50:12 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (method_entry_i): mtbl should not have `me&#39; as NULL.</p>

<p>Thu Jun  4 04:28:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (clone_method): do not use me-&gt;klass, but use explicitly 	  passed argument.</p>

<p>Thu Jun  4 04:10:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h (rb_vm_rewrite_cref_stack): rename to rb_vm_rewrite_cref().</p>

<p>	* class.c (clone_method): use renamed name.</p>

<p>	* vm_insnhelper.c (rb_vm_rewrite_cref): do not use `node&#39; in variable 	  names.</p>

<p>Wed Jun  3 23:03:50 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c: rename `rb_frame_…&#39; to `rb_scope_…&#39;.</p>

<p>	* eval_intern.h: move decl. of rb_scope_visibility_set() to method.h.</p>

<p>	* load.c: catch up this fix.</p>

<p>Wed Jun  3 21:14:20 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/rbconfig/sizeof/extconf.rb: Check C99 standard integer types.</p>

<p>Wed Jun  3 21:00:47 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* configure.in: Don&#39;t check __int128.</p>

<p>	* ext/rbconfig/sizeof/extconf.rb: Check __int128.</p>

<p>	* ext/rbconfig/sizeof/depend: sizes.c depends on 	  ext/rbconfig/sizeof/extconf.rb.</p>

<p>	* template/sizes.c.tmpl: Detect check_sizeof.</p>

<p>Wed Jun  3 20:07:07 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (clone_method): remove redundant check for me-&gt;def != NULL. 	  Now, all <code>me</code> have <code>me->def</code>.</p>

<p>	* proc.c (rb_method_entry_location): ditto.</p>

<p>	* vm.c (rb_vm_check_redefinition_opt_method): ditto.</p>

<p>	* vm.c (add_opt_method): ditto.</p>

<p>	* vm_eval.c (vm_call0_body): ditto.</p>

<p>Wed Jun  3 19:24:12 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: rename enum missing_reason to enum method_missing_reason.</p>

<p>	* vm_core.h: use enum method_missing_reason for 	  rb_thread_t::method_missing_reason.</p>

<p>	* vm_eval.c: catch up this fix.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>Wed Jun  3 16:17:21 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* vm.c: eagerly allocate <code>loading_table</code>.  This eliminates the need to 	  do NULL checks when looking up the <code>loading_table</code> hash. 	  <a href="https://github.com/ruby/ruby/pull/918">github.com/ruby/ruby/pull/918</a></p>

<p>	* load.c: remove various NULL checks</p>

<p>Wed Jun  3 11:47:15 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: change fields order to gather frequent access fields.</p>

<p>	* vm_insnhelper.c (vm_call_method): add LIKELY().</p>

<p>Wed Jun 03 10:35:45 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: split rb_method_definition_t::flag to several flags.</p>

<p>	  `flag&#39; contains several categories of attributes and it makes us 	  confusion (at least, I had confused).</p>

<p>	  * rb_method_visibility_t (flags::visi) 	    * NOEX_UNDEF     -&gt; METHOD_VISI_UNDEF     = 0 	    * NOEX_PUBLIC    -&gt; METHOD_VISI_PUBLIC    = 1 	    * NOEX_PRIVATE   -&gt; METHOD_VISI_PRIVATE   = 2 	    * NOEX_PROTECTED -&gt; METHOD_VISI_PROTECTED = 3 	  * NOEX_SAFE(flag)  -&gt; safe (flags::safe, 3 bits) 	  * NOEX_BASIC       -&gt; basic (flags::basic, 1 bit) 	  * NOEX_MODFUNC     -&gt; rb_scope_visibility_t in CREF 	  * NOEX_SUPER       -&gt; MISSING_SUPER (enum missing_reason) 	  * NOEX_VCALL       -&gt; MISSING_VCALL (enum missing_reason) 	  * NOEX_RESPONDS    -&gt; BOUND_RESPONDS (macro)</p>

<p>	  Now, NOEX_NOREDEF is not supported (I&#39;m not sure it is needed).</p>

<p>	  Background: 	    I did not know what “NOEX” stands for. 	    I asked Matz (who made this name) and his answer was “Nothing”. 	    “At first, it meant NO EXport (private), but the original 	    meaning was gone.” 	    This is why I remove the mysterious word “NOEX” from MRI.</p>

<p>	* vm_core.h: introduce `enum missing_reason&#39; to represent 	  method_missing (NoMethodError) reason.</p>

<p>	* eval_intern.h: introduce rb_scope_visibility_t to represent 	  scope visibility. 	  It has 3 method visibilities (public/private/protected) 	  and <code>module_function</code>.</p>

<p>Wed Jun  3 08:06:30 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* gem/bundled_gems: updated to test-unit 3.1.1 and minitest 5.7.0.</p>

<p>Wed Jun  3 04:48:05 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_defined): check respond_to_missing? 	  at defined?(func()). 	  [Bug #11212]</p>

<p>	* test/ruby/test_defined.rb: add a test for this fix.</p>

<p>Wed Jun  3 04:34:39 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (vm_defined): skip respond_to_missing? when 	  a method is available. 	  [Bug #11211]</p>

<p>	* test/ruby/test_defined.rb: add a test for this fix.</p>

<p>Wed Jun  3 04:14:13 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* insns.def (defined), vm_insnhelper.c (vm_defined): 	  move instruction body to the vm_defined() function.</p>

<p>Wed Jun  3 02:29:25 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* test/ruby/test_module.rb: Do not assume class variable order. 	  Patch by @enebo.</p>

<p>Wed Jun  3 01:10:38 2015  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>	* vm_method.c (rb_method_definition_set): remove a double assignment. 	  Coverity Scan found this bug.</p>

<p>Wed Jun  3 00:04:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (rb_alias): rename parameter names.</p>

<p>Tue Jun  2 23:27:18 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: remove rb_method_iseq_t::iseqval. 	  While making a r50728, iseqval is needed (to mark correctly), 	  but now just iseqptr is enough.</p>

<p>	* class.c: catch up this fix.</p>

<p>	* gc.c: ditto.</p>

<p>	* proc.c: ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Tue Jun  2 21:29:28 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (proc_curry): remove a debug line.</p>

<p>Tue Jun  2 12:43:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: make rb_method_entry_t a VALUE. 	  Motivation and new data structure are described in [Bug #11203].</p>

<p>	  This patch also solve the following issues.</p>

<p>	  * [Bug #11200] Memory leak of method entries 	  * [Bug #11046] __callee__ returns incorrect method name in orphan 	                 proc</p>

<p>	* test/ruby/test_method.rb: add a test for [Bug #11046].</p>

<p>	* vm_core.h: remove rb_control_frame_t::me. me is located at value 	  stack.</p>

<p>	* vm_core.h, gc.c, vm_method.c: remove unlinked_method… codes 	  because method entries are simple VALUEs.</p>

<p>	* method.h: Now, all method entries has own independent method 	  definitions. Strictly speaking, this change is not essential, 	  but for future changes.</p>

<p>	  * rb_method_entry_t::flag is move to rb_method_definition_t::flag. 	  * rb_method_definition_t::alias_count is now 	    rb_method_definition_t::alias_count_ptr, a pointer to the counter.</p>

<p>	* vm_core.h, vm_insnhelper.c (rb_vm_frame_method_entry) added to 	  search the current method entry from value stack.</p>

<p>	* vm_insnhelper.c (VM_CHECK_MODE): introduced to enable/disable 	  assertions.</p>

<p>Tue Jun  2 10:46:36 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/socket/test_nonblock.rb: new test for sendmsg_nonblock</p>

<p>Tue Jun  2 09:04:14 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/benchmark.rb: just use Process::CLOCK_MONOTONIC 	  [ruby-core:69390]</p>

<p>Mon Jun  1 22:01:27 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/mkmf.rb (pkg_config): split –libs if –libs-only-l option 	  is not available.  patch in [ruby-core:69428] by Hans Mackowiak. 	  [ruby-core:69421] [Bug #11201]</p>

<p>Mon Jun  1 21:18:24 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_children): remove a garbage character 	  introduced at the last commit.</p>

<p>Mon Jun  1 19:24:42 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (rb_method_entry_make): do not show warning message 	  when method_entry is an alias.</p>

<p>Mon Jun  1 15:47:16 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: move class related definitions.</p>

<p>Mon Jun  1 15:43:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c: remove needless include pragma for method.h.</p>

<p>	* struct.c: ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Mon Jun  1 05:42:00 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* eval_intern.h, vm_method.c: move macros to functions. 	  * SCOPE_TEST(f)  -&gt; rb_frame_visibility_test(flag). 	  * SCOPE_CHECK(f) -&gt; rb_frame_visibility_check(flag). 	  * SCOPE_SET(f)   -&gt; rb_frame_visibility_set(flag).</p>

<p>	* load.c (load_ext): use it.</p>

<p>Mon Jun  1 04:47:37 2015  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>	* ext/date/date_core.c: [DOC] Add comparison of Time and DateTime 	  Patch provided by @pixeltrix</p>

<p>Mon Jun  1 04:22:09 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h (VM_FRAME_MAGIC_DUMMY): introduce new frame type to 	  recognize dummy frame.</p>

<p>	* vm.c (th_init): use new frame type.</p>

<p>	* vm_args.c (raise_argument_error): ditto.</p>

<p>Mon Jun  1 04:15:42 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (rb_class_has_methods): added to reduce dependency 	  to internal class data structure.</p>

<p>	* internal.h: ditto.</p>

<p>	* hash.c (has_extra_methods): use added function.</p>

<p>Mon Jun  1 04:11:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c , gc.h (rb_obj_info): export obj_info(VALUE) for debugging.</p>

<p>Mon Jun  1 03:52:55 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/ruby/test_gc.rb: increase timeout seconds for GC stressful 	  debugging.</p>

<p>Sun May 31 04:18:06 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: fix typo of comments.</p>

<p>Sun May 31 03:36:42 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: add VM_METHOD_TYPE_ALIAS rb_method_definition_t::type 	  to fix [Bug #11173].</p>

<p>	  Now, inter class/method alias creates new method entry 	  VM_METHOD_TYPE_ALIAS, which has an original method entry.</p>

<p>	* vm_insnhelper.c (find_defined_class_by_owner): added. 	  Search corresponding defined_class from owner class/module.</p>

<p>	* vm_method.c (rb_method_entry_get_without_cache): return me-&gt;klass 	  directly for defined_class.</p>

<p>	  Now, no need to check me-&gt;klass any more.</p>

<p>	* vm_method.c (method_entry_set0): separated from method_entry_set().</p>

<p>	* vm_method.c (rb_alias): make method entry has VM_METHOD_TYPE_ALIAS.</p>

<p>	* vm_method.c (release_method_definition): support VM_METHOD_TYPE_ALIAS.</p>

<p>	* vm_method.c (rb_hash_method_definition): ditto.</p>

<p>	* vm_method.c (rb_method_definition_eq): ditto.</p>

<p>	* vm_method.c (release_method_definition): ditto.</p>

<p>	* vm_insnhelper.c (vm_call_method): ditto.</p>

<p>	* vm_insnhelper.c (vm_method_cfunc_entry): ditto.</p>

<p>	* vm_eval.c (vm_call0_body): ditto.</p>

<p>	* gc.c (mark_method_entry): ditto.</p>

<p>	* proc.c (method_def_iseq): ditto.</p>

<p>	* proc.c (method_cref): ditto.</p>

<p>	* proc.c (rb_method_entry_min_max_arity): ditto.</p>

<p>	* test/ruby/test_alias.rb: add tests.</p>

<p>	* test/ruby/test_module.rb: fix a test to catch up current behavior.</p>

<p>Sun May 31 03:34:25 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_method.c (rb_unlink_method_entry): make it static.</p>

<p>Sun May 31 03:26:58 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h, vm_method.c (rb_free_method_entry): constify a parameter.</p>

<p>	* vm_core.h: remove useless declaration about rb_unlink_method_entry().</p>

<p>Sat May 30 18:05:02 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* lib/tempfile.rb (Remover#call): fixed wrong condition.  introduced at 	  r50682.</p>

<p>Sat May 30 16:12:35 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c: use RB_GC_GUARD instead of volatile 	  [ruby-core:69419] [Feature #11198]</p>

<p>Sat May 30 15:59:10 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* lib/tempfile.rb (Tempfile#initialize): initialize @unlinked to fix 	  test failures introduced at r50682.  I hope that check the results of 	  tests before committing, at least the tests about the changed feature.</p>

<p>Sat May 30 11:02:55 2015  Martin Englund &lt;martin@englund.nu&gt;</p>

<p>	* doc/dtrace_probes.rdoc: change lingering dtrace probe documentation 	  from function- to method-</p>

<p>Sat May 30 10:26:09 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* lib/tempfile.rb: refactoring. 	  * use warn instead of STDERR.print 	  * remove @tmpname and use @tmpfile.path 	  * introduce @unlinked flag 	  * Remover takes only @tmpfile 	  * mode will be modified just before file reopen</p>

<p>Sat May 30 09:02:51 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* include/ruby/intern.h (rb_generic_ivar_table): deprecate 	* internal.h (rb_attr_delete): declare 	* marshal.c (has_ivars): use rb_ivar_foreach 	  (w_ivar): ditto 	  (w_object): update for new interface 	* time.c (time_mload): use rb_attr_delete 	* variable.c (generic_ivar_delete): implement 	  (rb_ivar_delete): ditto 	  (rb_attr_delete): ditto 	  [ruby-core:69323] [Feature #11170]</p>

<p>Sat May 30 09:14:28 2015  Scott Francis  &lt;scott.francis@shopify.com&gt;</p>

<p>	* cont.c (cont_free): check if ruby_current_thread is still valid. 	  [Fix GH-914]</p>

<p>Sat May 30 08:36:04 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (static int special_generic_ivar): move 	  (rb_generic_ivar_table): rewrite for compatibility 	  (gen_ivtbl_bytes): new function 	  (generic_ivar_get): update to use ivar index 	  (generic_ivar_update): ditto 	  (generic_ivar_set): ditto 	  (generic_ivar_defined): ditto 	  (generic_ivar_remove): ditto 	  (rb_mark_generic_ivar): ditto 	  (givar_i): ditto 	  (rb_free_generic_ivar): ditto 	  (rb_mark_generic_ivar_tbl): ditto 	  (rb_generic_ivar_memsize): ditto 	  (rb_copy_generic_ivar): ditto 	  (rb_ivar_set): ditto 	  (rb_ivar_foreach): ditto 	  (rb_ivar_count): ditto 	  (givar_mark_i): remove 	  (gen_ivtbl_mark): new function 	  (gen_ivar_each): ditto 	  (iv_index_tbl_extend): update for struct ivar_update 	  (iv_index_tbl_newsize): ditto 	  [ruby-core:69323] [Feature #11170]</p>

<p>Sat May 30 08:10:46 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (iv_index_tbl_make): extract from rb_ivar_set 	  (iv_index_tbl_extend): ditto 	  (iv_index_tbl_newsize): ditto 	  (rb_ivar_set): use extracted functions 	  [ruby-core:69323] (Part 1)</p>

<p>Fri May 29 17:39:14 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* tool/make_hgraph.rb: added.</p>

<p>Fri May 29 14:39:00 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): out of range NTH_REF is always 	  nil.</p>

<p>	* parse.y (parse_numvar): check overflow of NTH_REF and range. 	  [ruby-core:69393] [Bug #11192]</p>

<p>	* util.c (ruby_scan_digits): make public and add length parameter.</p>

<p>Fri May 29 11:18:58 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_sendmsg_internal, 	  bsock_recvmsg_internal): 	  avoid redundant fcntl on Linux 	  [ruby-core:69154] [Feature #11145] 	* ext/socket/init.c (rsock_s_recvfrom_nonblock): ditto 	* ext/socket/rubysocket.h (MSG_DONTWAIT_RELIABLE): new macro</p>

<p>Fri May 29 10:30:34 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/net/resolv.rb (request): use monotonic clock 	* lib/net/http.rb (begin_transport, end_transport): ditto 	  [ruby-core:69384] [Feature #11124]</p>

<p>Fri May 29 04:37:38 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/objspace/objspace.c: add two methods to debug internals.</p>

<p>	  * ObjectSpace.internal_class_of: return RBASIC_CLASS(obj). 	  * ObjectSpace.internal_super_of: return RCLASS_SUPER(cls).</p>

<p>	* NEWS: add information about both methods.</p>

<p>	* test/objspace/test_objspace.rb: add tests for both methods.</p>

<p>Thu May 28 06:55:53 2015  Anton Davydov  &lt;antondavydov.o@gmail.com&gt;</p>

<p>	* ext/tk/sample/figmemo_sample.rb (open_file), 	  ext/tk/sample/tktextio.rb (TkTextIO): fix typo in messages. 	  [Fix GH-916]</p>

<p>Wed May 27 09:50:51 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/ossl_asn1.c (ossl_asn1_traverse, ossl_asn1_decode, 	  ossl_asn1_decode_all): use RB_GC_GUARD instead of volatile 	  [ruby-core:69371] [Bug #11185]</p>

<p>Wed May 27 09:27:30 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/drb/drb.rb (set_sockopt): remove redundant fcntl call 	* lib/drb/unix.rb (set_sockopt): ditto 	  [ruby-core:69128] [Feature #11137]</p>

<p>Tue May 26 22:10:43 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_method.c (rb_alias): should resolve refined methods. 	  [ruby-core:69360] [Bug #11182]</p>

<p>Tue May 26 21:35:13 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* include/ruby/defines.h (RUBY_ATTR_ALLOC_SIZE): fix condition.</p>

<p>Mon May 25 22:35:58 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb (rel): after the relations is changed, 	  @changesets is no longer right.</p>

<p>Mon May 25 11:27:14 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (setup_overlapped): seek to the file end only when 	  writing (mode:a), not reading (mode:a+, read).</p>

<p>Mon May 25 00:27:37 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* numeric.c (Numeric#negative?): [DOC] Fix call-seq. 	  Patch by @yui-knk. [Fixes GH-908]</p>

<p>Sun May 24 01:35:22 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* debug.c (ruby_debug_print_id): use rb_id2name() for fprintf().</p>

<p>Sat May 23 18:38:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* man/*.1: updated dates in man pages. 	  [ruby-dev:48988] [Bug #11171]</p>

<p>Sat May 23 03:10:58 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_write_console): should return the count of 	  actually eaten characters, include escape sequences.</p>

<p>Fri May 22 22:36:14 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/prime.rb: Remove obsolete Prime.new 	  patch by Ajay Kumar. [Fixes GH-891]</p>

<p>Fri May 22 21:13:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/intern.h (rb_sym_count): move <code>rb_sym_all_symbols</code> 	  to a symbol.c specific section.  a part of patch by Lourens 	  Naude.</p>

<p>Fri May 22 20:56:33 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* complex.c (f_complex_polar): simple bug reproduced only when y is 	  a float but x is not a float.</p>

<p>Fri May 22 19:42:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* process.c (rb_spawn_process): do not discard global escape 	  status.  [ruby-core:69304] [Bug #11166]</p>

<p>	* process.c (rb_execarg_spawn): extract the start procedure in a 	  parent process with ensuring the end procedure.</p>

<p>Fri May 22 16:48:32 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* NEWS: added news for net-telnet and rake</p>

<p>Thu May 21 20:27:07 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* configure.in (RUBY_DTRACE_POSTPROCESS): cmp -b is GNU extension. 	  darwin uses GNU cmp, and FreeBSD and Solaris are not. 	  Note that accidentally equals to expected result.</p>

<p>Thu May 21 18:00:19 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c: constify.</p>

<p>	* iseq.h: ditto.</p>

<p>	* method.h: ditto.</p>

<p>	* proc.c: ditto.</p>

<p>	* vm_method.c: ditto.</p>

<p>Thu May 21 17:44:53 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c: fix issues caused by binding created from Method#to_proc. 	  [Bug #11163]</p>

<p>	* vm.c (vm_cref_new_toplevel): export as rb_vm_cref_new_toplevel().</p>

<p>	* test/ruby/test_method.rb: add some assertions.</p>

<p>Thu May 21 17:29:26 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/matrix.rb: added documentation for Matrix#empty and Matrix#/ 	  [Feature #<a href="ruby-dev:48433">10070]</a> Patch by @gogotanaka</p>

<p>Thu May 21 17:02:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c: rename functions. 	  * method_get_def() -&gt; method_def() 	  * method_get_iseq() -&gt; method_def_iseq() 	  * method_get_cref() -&gt; method_cref()</p>

<p>Thu May 21 16:52:44 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (rb_method_get_iseq): rename to rb_method_iseq.</p>

<p>	* iseq.c: catch up this fix.</p>

<p>	* iseq.h: commit ditto.</p>

<p>Thu May 21 15:41:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/net/telnet.rb: gemify net-telnet. 	  [Feature #11083] 	* gems/bundled_gems: added net-telnet to bundled gems.</p>

<p>Thu May 21 15:37:32 2015  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>	* vm_method.c: Remove private attribute warning [Bug #10967] 	  Patch by @spastorino [Fixes GH-849] 	  <a href="https://github.com/ruby/ruby/pull/849">github.com/ruby/ruby/pull/849</a></p>

<p>	* test/ruby/test_module.rb: Update test for changes</p>

<p>Thu May 21 10:59:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c (method_proc): rename to method_to_proc.</p>

<p>Thu May 21 10:51:54 2015  Jake Worth  &lt;jakeworth82@gmail.com&gt;</p>

<p>	* io.c (rb_f_select): [DOC] Fixes for grammar and style. 	  [Fix GH-906]</p>

<p>Thu May 21 08:25:19 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* variable.c (Init_var_tables): init generic_iv_tbl 	  (rb_generic_ivar_table, generic_ivar_get, generic_ivar_set, 	   generic_ivar_defined, generic_ivar_remove, 	   rb_mark_generic_ivar, givar_i, rb_mark_generic_ivar_tbl, 	   rb_free_generic_ivar, rb_copy_generic_ivar, rb_ivar_foreach, 	   rb_ivar_count): remove checks for uninitialize generic_iv_tbl 	[ruby-core:69155] [Feature #11146]</p>

<p>Thu May 21 04:11:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (exception_type2symbol): show correct bug message.</p>

<p>Wed May 20 23:19:05 2015  Yusuke Endoh  &lt;mame@ruby-lang.org&gt;</p>

<p>	* lib/base64.rb: Fix rdoc-formatting for padding argument. 	  [fix GH-905][ci skip] Patch by @davydovanton</p>

<p>Wed May 20 13:16:23 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (DEPRECATED_BY): deprecate warning with preferable 	  alternative.</p>

<p>	* configure.in (RUBY_FUNC_ATTRIBUTE): allow attribute arguments in 	  the macro.</p>

<p>Wed May 20 11:23:24 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* vm_dump.c (rb_print_backtrace): return value of libexec&#39;s backtrace 	  is size_t, so simply cast as int.</p>

<p>Tue May 19 18:54:41 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* iseq.c (rb_iseq_compile_with_option): check source type, must be 	  an IO or a String.  [ruby-core:69219] [Bug #11159]</p>

<p>Tue May 19 17:15:03 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/benchmark.rb: Update Benchmark documentation and formatting. 	  [fix GH-903][ci skip] Patch by @davydovanton</p>

<p>Tue May 19 13:10:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* numeric.c (num_positive_p): should false on Bignum 0. 	  <a href="http://twitter.com/rafaelfranca/status/600509783427391488">twitter.com/rafaelfranca/status/600509783427391488</a> 	  [ruby-core:69173] [Feature #11151]</p>

<p>Tue May 19 11:22:28 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/uri/rfc2396_parser.rb (initialize_pattern): 	  URI::Generic.build should accept port as a string. 	  <a href=":PORT">pattern</a> is not defined for long. 	  by Dave Slutzkin &lt;daveslutzkin@fastmail.fm&gt; 	  <a href="https://github.com/ruby/ruby/pull/804">github.com/ruby/ruby/pull/804</a> fix GH-804</p>

<p>Tue May 19 11:18:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h (rb_data_typed_object_alloc), 	  (rb_data_object_alloc): add old names for source level backward 	  compatibilities.</p>

<p>	* gc.c (rb_data_object_alloc, rb_data_typed_object_alloc): add 	  aliases for binary level backward compatibilities.</p>

<p>Tue May 19 09:54:44 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h (Data_Make_Struct0): needs function pointer 	  casts to fix function overloading in C++.</p>

<p>Tue May 19 09:43:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h (Data_Make_Struct0, TypedData_Make_Struct0): 	  explicit cast from void* is necessary as implicit cast is 	  disallowed in C++.</p>

<p>Mon May 18 15:31:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/intern.h (rb_f_notimplement): should not respond to 	  not-implemented methods.  as the address inside a DLL and the 	  imported address are different on Windows, use an exported 	  variable to share the same address.</p>

<p>Mon May 18 13:55:01 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/monitor.rb (mon_try_enter, mon_enter): should reset @mon_count 	  just in case the previous owner thread dies without mon_exit. 	  [fix GH-874] Patch by @chrisberkhout</p>

<p>Sun May 17 17:21:29 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/webrick/utils.rb (set_non_blocking): use IO#nonblock= 	* (set_close_on_exec): use IO#close_on_exec= 	  [Feature #11136]</p>

<p>Sun May 17 15:01:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* numeric.c (num_positive_p, num_negative_p): add methods 	  Numeric#positive? and Numeric#negative?. 	  [ruby-core:69173] [Feature #11151]</p>

<p>	* numeric.c (flo_positive_p, flo_negative_p): specialized 	  functions for Float.</p>

<p>	* complex.c (Init_Complex): Complex do not have positive? and 	  negative? methods</p>

<p>Sun May 17 14:57:42 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/webrick/server.rb (accept_client): avoid redundant fcntl call 	  [Feature #11137]</p>

<p>Sun May 17 12:13:33 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (cloexec_accept): support nonblock flag and 	  use SOCK_NONBLOCK if possible 	* ext/socket/init.c (rsock_s_accept_nonblock): 	  update cloexec_accept call 	* ext/socket/init.c (accept_blocking): ditto for blocking 	* test/socket/test_nonblock.rb: check nonblock? on accepted socket 	  [Feature #11138]</p>

<p>Sun May 17 03:58:59 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* load.c (loaded_feature_path): stop returning false negatives for 	  filenames which are trailing substrings of file extensions.  For 	  example, &#39;b&#39;, which a trailing substring of “.rb” should not return 	  false. [Bug #<a href="ruby-core:69206">11155]</a></p>

<p>	* test/ruby/test_autoload.rb: test for fix</p>

<p>Sat May 16 21:41:24 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* string.c: added documentation for character sequence &#39; with String#sub 	  [Bug #<a href="ruby-core:69121">11132]</a>[fix GH-900][ci skip] Patch by @shishir127</p>

<p>Sat May 16 21:38:05 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* enum.c: fix a sample code. Patch by @eagletmt 	  [fix GH-901][ci skip]</p>

<p>Sat May 16 21:17:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.c (rb_data_object_wrap, rb_data_typed_object_wrap): rename 	  alloc as wrap.  these functions do not allocate data pointers 	  but just wrap the given pointers.</p>

<p>Sat May 16 19:59:24 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_accept): simplified.</p>

<p>Fri May 15 18:28:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_assoc, rb_ary_rassoc): [DOC] the result when key 	  was found is the existing element, not a new array.  reported by 	  Giau Nguyen &lt;giaunv AT nustechnology.com&gt;.</p>

<p>Fri May 15 08:24:28 2015  Takeyuki FUJIOKA  &lt;xibbar@ruby-lang.org&gt;</p>

<p>	* lib/cgi/cookie.rb: Implement HttpOnly flag for cookies. 	  [fix GH-887] Patch by @martinpovolny</p>

<p>Fri May 15 06:54:19 2015  Aaron Patterson &lt;tenderlove@ruby-lang.org&gt;</p>

<p>	* variable.c: Change autoload to call <code>require</code> through Ruby rather 	  than directly calling <code>rb_require_safe</code>.  This allows things like 	  RubyGems to intercept file loading done though <code>autoload</code>. 	  [Feature #11140]</p>

<p>	* test/ruby/test_autoload.rb: Test for change.</p>

<p>Wed Apr  8 19:18:02 2015  Shota Fukumori (sora_h)  &lt;her@sorah.jp&gt;</p>

<p>	* enum.c (enum_grep_v, grep_i, grep_iter_i, Init_enum): 	  Implement Enumerable#grep_v. [Feature #11049]</p>

<p>Thu May 14 15:54:13 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/pathname/lib/pathname.rb: Remove condition of RUBY_VERSION &lt;= 1.9. 	  [Feature #11082]</p>

<p>Wed May 13 17:10:37 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* enum.c (enum_to_a): revert r50457. 	  it requires recursion check. 	  then, it doesn&#39;t make performance improvement. 	  [Bug #11130] [Feature #9118]</p>

<p>Wed May 13 11:13:40 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (parse_gvar): separate message for gvar without 	  non-space characters from message for invalid identifiers.</p>

<p>Tue May 12 22:18:27 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* enum.c (enum_to_a): fix incompatibility introduced in r50457. 	  [Bug #11130]</p>

<p>	* test/ruby/test_enum.rb: test for above.</p>

<p>Tue May 12 17:08:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* method.h: remove unused declaration.</p>

<p>Mon May 11 10:58:45 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: Update minitest-5.6.1 and power_assert-0.2.3.</p>

<p>Mon May 11 00:20:31 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/ruby.h (Data_Make_Struct, TypedData_Make_Struct): 	  allocate wrapper data object before allocating DATA_PTR to get 	  rid of possible memory leak when the former failed.</p>

<p>Sun May 10 21:32:45 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.c (gc_mark_children): call dmark function for non-NULL 	  pointers only, so that DATA_PTR can be NULL safely now.</p>

<p>Sun May 10 16:23:58 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* proc.c (proc_binding): fix segmentation fault on marking phase. 	  envptr of newenvval should not be NULL.</p>

<p>	  You can reproduce by 	   make test-all TESTS=&#39;–gc-stress -n test_to_proc_binding ruby/test_method.rb&#39;</p>

<p>Sun May 10 12:41:18 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* ext/zlib/zlib.c (rb_gzreader_external_encoding): 	  define GzipReader#external_encoding. 	  [Bug #10900]</p>

<p>	* test/zlib/test_zlib.rb: test for above.</p>

<p>Sun May 10 11:57:48 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* ext/win32ole/win32ole_variant.c: fix typo “indicies”. 	  the patch is from davydovanton &lt;antondavydov.o at gmail.com&gt;. 	  [fix GH-892]</p>

<p>	* lib/rubygems/indexer.rb: ditto.</p>

<p>	* test/rubygems/test_gem_indexer.rb: ditto.</p>

<p>Sun May 10 11:44:37 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* string.c (rb_str_crypt): Raise ArgumentError when 	  string passed to String#crypt contains null. 	  the patch is from jrusnack &lt;jrusnack at redhat.com&gt;. 	  [Bug #10988] [fix GH-853]</p>

<p>	* test/ruby/test_string.rb: test for above.</p>

<p>Sun May 10 11:23:03 2015  Masaki Matsushita &lt;glass.saga@gmail.com&gt;</p>

<p>	* enum.c (enum_to_a): Use size to set array capa when possible. 	  the patch is from HonoreDB &lt;aweiner at mdsol.com&gt;. 	  [fix GH-444]</p>

<p>Sat May  9 06:48:36 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/ancdata.c (bsock_recvmsg_internal): GC guard 	  [Bug #11123]</p>

<p>Fri May  8 22:57:24 2015  takiy33  &lt;takiy33@gmail.com&gt;</p>

<p>	* test/matrix/test_matrix.rb (test_determinant): refactor test on 	  Matrix#determinant, by merging with test_det for an alias method 	  det.  [Fix GH-897]</p>

<p>Fri May  8 15:43:11 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/imap.rb (body_ext_mpart): should work even if body-fld-dsp 	  is omitted.  [ruby-core:69093] [Bug #11128]</p>

<p>Fri May  8 15:05:57 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* doc/syntax/control_expressions.rdoc: fix a missing “a” 	  [fix GH-888][ci skip] Patch by @riffraff</p>

<p>Fri May  8 12:11:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (rb_method_call_status): resolve refined method entry 	  to check if undefined.  [ruby-core:69064] [Bug #11117]</p>

<p>Thu May  7 22:22:59 2015  Sho Hashimoto  &lt;sho-h@ruby-lang.org&gt;</p>

<p>	* proc.c: [DOC] fix Binding#local_variable_set example. [ci skip]</p>

<p>Thu May  7 11:32:57 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* Makefile.in (rbconfig.rb): add rule to make.</p>

<p>Thu May  7 05:14:39 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/lib/socket.rb (connect_nonblock): use IO#wait_writable 	* lib/drb/drb.rb (DRB::DRbTCPSocket#alive?): use IO#wait_readable 	* lib/webrick/httpserver.rb (run): ditto 	* lib/resolv.rb (request): ditto for single socket case 	  [ruby-core:68943] [Feature #11081]</p>

<p>Wed May  6 22:49:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (rb_method_call_status): undefined refined method is 	  not callable unless using.  [ruby-core:69064] [Bug #11117]</p>

<p>Sun May  3 22:40:06 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* ext/-test-/file/fs.c: need to include sys/statvfs.h 	  to use statvfs().</p>

<p>	* ext/-test-/file/extconf.rb: check the existence of 	  sys/statvfs.h</p>

<p>Sun May  3 21:59:48 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/yaml.rb: fix typo. [ci skip][fix GH-890] 	  Patch by @miketheman</p>

<p>Sun May  3 10:02:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* range.c (linear_object_p, range_include): test if covered for 	  linear objects.  [ruby-core:69052] [Bug #11113]</p>

<p>Fri May  1 13:30:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dln.c (dln_load): check if a different libruby is loaded by the 	  extension library, and then bail out to get rid of very 	  frequently reported stale bug reports.</p>

<p>Thu Apr 30 19:51:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (iseq_compile_each): revert r46873 and r46875, not to 	  allow to execute private readers by pretending op assign. 	  [ruby-core:68984] [Bug #11096]</p>

<p>Thu Apr 30 17:02:33 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* rational.c: Added documentation for rational literal. 	  [Bug #11075][fix GH-885][ci skip] Patch by @shishir127</p>

<p>Thu Apr 30 16:39:44 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/ipsocket.c (init_inetsock_internal): preserve errno 	  before other library calls and use rb_syserr_fail. 	  [ruby-core:68531] [Bug #10975]</p>

<p>Thu Apr 30 16:22:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (lambda): push and reset cmdarg_stack in lambda body. 	  [ruby-core:69017] [Bug #11107]</p>

<p>Sun Apr 26 07:36:48 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* enc/utf_8.c (code_to_mbclen, code_to_mbc): reject values larger 	  than UTF-8 max codepoints.  [Feature #11094]</p>

<p>Sat Apr 25 14:26:19 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (str_buf_cat): expand later so that the buffer can be 	  larger for further use.  [Bug #11080] [Bug #11095]</p>

<p>Fri Apr 24 23:48:45 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* misc/ruby-electric.el: Import version 2.2.3 from 	  <a href="https://github.com/knu/ruby-electric.el">github.com/knu/ruby-electric.el</a>.</p>

<p>Fri Apr 24 10:40:02 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_<code>getc,putc</code>): removed.  they are needed for old 	  ruby (before 1.8), but not now.</p>

<p>Fri Apr 24 08:40:13 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* win32/win32.c: remove bcc related code.</p>

<p>	* include/ruby/win32.h: ditto.</p>

<p>Fri Apr 24 08:21:07 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_acrt_lowio_lock_fh): wrap _pioinfo(i)-&gt;lock.</p>

<p>	* win32/win32.c (rb_acrt_lowio_unlock_fh): ditto.</p>

<p>Fri Apr 24 06:47:19 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (_filbuf): msvc14 doesn&#39;t have it, use _fgetc_nolock.</p>

<p>	* win32/win32.c (_flsbuf): msvc14 doesn&#39;t have it, use _fputc_nolock.</p>

<p>	* win32/win32.c (vcruntime_file): define vcruntime_file on msvc14 	  because it doesn&#39;t export FILE&#39;s internal structure.</p>

<p>	* win32/win32.c (FILE_COUNT): added to abstract FILE-&gt;_cnt.</p>

<p>	* win32/win32.c (FILE_READPTR): added to abstract FILE-&gt;_ptr.</p>

<p>	* win32/win32.c (FILE_FILENO): added to abstract FILE-&gt;_file.</p>

<p>	* win32/win32.c (init_stdhandle): use FILE_FILENO.</p>

<p>	* win32/win32.c (rb_w32_getc): use FILE_COUNT and FILE_READPTR.</p>

<p>	* win32/win32.c (rb_w32_putc): ditto.</p>

<p>Fri Apr 24 06:37:07 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (dupfd): use _set_osfhnd.</p>

<p>	* win32/win32.c (rb_w32_wopen): use _set_osflags.</p>

<p>Thu Apr 24 05:38:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_mark_roots): fox to work PRINT_ROOT_TICKS.</p>

<p>Fri Apr 24 04:49:05 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* win32/Makefile.sub: MSVC14 have struct timespec.</p>

<p>	* win32/rtname.cmd: support vcruntime140.dll.</p>

<p>	* time.c (localtime_with_gmtoff_zone): MSVC14 doesn&#39;t have tzname and 	  daylight but have _tzname and _daylight.</p>

<p>Thu Apr 23 11:35:55 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (rb_obj_instance_eval, rb_obj_instance_exec): allow 	  symbols to just instance_eval/exec, except for definition of 	  singletons.  [ruby-core:68961] [Bug #11086]</p>

<p>Thu Apr 23 10:01:36 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* lib/delegate.rb: fix a typo. 	  [fix GH-881][ci skip] Patch by @Zorbash</p>

<p>Wed Apr 22 18:36:50 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/imap.rb (move, uid_move): support the MOVE command defined 	  in RFC6851.  Patch by ojab ojab. 	  [ruby-core:68960] [Feature #11077]</p>

<p>Tue Apr 22 12:42:12 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_object.rb: add tests for Kernel#String and Kernel#Array. 	  [fix GH-879][fix GH-880] Patch by @yui-knk</p>

<p>Tue Apr 21 20:46:02 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_object.rb: renamed tests to explicitly class name. 	  [fix GH-877] Patch by @yui-knk</p>

<p>Tue Apr 21 05:31:00 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/lib/socket.rb (connect_internal): avoid common exceptions 	  from connect_nonblock. [ruby-core:68909]</p>

<p>Mon Apr 20 23:46:53 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_wreadlink): follow the official format of 	  REPARSE_DATA_BUFFER structure.</p>

<p>Mon Apr 20 20:23:04 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* common.mk ($(arch)-fake.rb): revert r50354 because bsdmake seems not 	  to handle such substitution.</p>

<p>	* tool/expand-config.rb: convert path separators here.</p>

<p>Mon Apr 20 16:52:20 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/fake.rb: don&#39;t fake libdir.  use libdirname instead.</p>

<p>Mon Apr 20 16:49:52 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* lib/mkmf.rb (MakeMakefile#configuration): DESTDIR should never affect 	  top_srcdir and builddir.</p>

<p>Mon Apr 20 16:18:17 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* common.mk ($(arch)-fake.rb): fix the path separator up for Windows.</p>

<p>Mon Apr 20 15:02:47 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_wreadlink): fixed a bug that a junction misses 	  its drive letter.</p>

<p>Mon Apr 20 12:54:56 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* ext/openssl/*: use license instead of licence. 	  [fix GH-876][ci skip] Patch by @davydovanton 	* lib/net/https.rb: ditto.</p>

<p>Mon Apr 20 12:42:40 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* benchmark/bm_so_meteor_contest.rb: fix a typo. 	  [fix GH-876][ci skip] Patch by @davydovanton 	* tool/bisect.sh: ditto. 	* tool/update-deps: ditto.</p>

<p>Mon Apr 20 11:10:46 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/socket.c (sock_connect_nonblock): do not raise EISCONN 	  [ruby-core:68926] [Feature #11072] 	* test/socket/test_nonblock.rb: check non-EISCONN on 2nd connect</p>

<p>Sun Apr 19 12:19:17 2015  Chad Brewbaker  &lt;crb002@gmail.com&gt;</p>

<p>	* ext/<code>etc,openssl,tk</code>: Adding parens and comparisons around 	  assignments to get rid of Wparentheses warnings.  [Fix GH-875]</p>

<p>Sun Apr 19 10:42:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (get_env_cstr): environment variables must be ASCII 	  compatible, as dummy encodings and wide char encodings are 	  unsupported now.</p>

<p>Sat Apr 18 15:18:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/json/parser/parser.rl: raise with messages in UTF-8 	  encoding.  [ruby-core:67386] [Bug #10705]</p>

<p>Fri Apr 17 11:58:34 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (STR_SET_EMBED): clear NOFREE flag at embedding as 	  embedded strings no longer refer static strings. 	  [ruby-core:68436] [Bug #10942]</p>

<p>Thu Apr 16 05:15:50 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* NEWS: note IO#wait_readable change in r50263</p>

<p>Thu Apr 16 05:09:36 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/net/protocol.rb (rbuf_fill): use IO#wait_*able 	* lib/net/http/generic_request.rb (wait_for_continue): ditto 	  [ruby-core:68891] [Feature #11056]</p>

<p>Wed Apr 15 18:43:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_trace.c (rb_tracepoint_new): fix documentation. 	  Commented by @emilsoman.</p>

<p>Wed Apr 15 17:36:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_trace.c (rb_tracepoint_new): Add documentation for 	  rb_tracepoint_new C level API [ci skip] 	  Provided by @emilsoman. [fix GH-869]</p>

<p>Wed Apr 15 10:37:40 2015  SHIBATA Hiroshi  &lt;hsbt@ruby-lang.org&gt;</p>

<p>	* doc/contributors.rdoc: fix a typo. Patch by @davydovanton 	  [fix GH-872][ci skip] 	* doc/syntax/methods.rdoc: ditto. 	* ext/digest/sha2/sha2.c: ditto. 	* ext/socket/ipsocket.c: ditto. 	* ext/tk/*: ditto.</p>

<p>Wed Apr 15 07:51:23 2015  Yuki Yugui Sonoda  &lt;yugui@yugui.jp&gt;</p>

<p>	* doc/extension.ja.rdoc: Added description of TypedData_XXX. 	  Deprecated the old DATA_XXX. 	  Reviewed by ko1 and nobu. 	  Fixes [ruby-dev:40881] #3064</p>

<p>	* doc/extension.rdoc: ditto.</p>

<p>Wed Apr 15 07:34:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread_pthread.c (reserve_stack): keep sp safe zone to get rid 	  of crash by -fstack-check.  [ruby-core:68740] [Bug #11030]</p>

<p>Tue Apr 14 16:03:49 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/merger.rb (versionup): should also increment revision when 	  changing teeny.</p>

<p>Tue Apr 14 11:24:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/-test-/printf/printf.c (uint_to_str): renamed to get rid of 	  conflict on cygwin.  [ruby-core:68877] [Bug #11065]</p>

<p>Tue Apr 14 08:59:04 2015  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>	* gc.c: [DOC] Improve documentation for ObjectSpace.count_objects 	  with regards to <code>:TOTAL</code> key, with patch by @schneems [Fixes GH-871] 	  <a href="https://github.com/ruby/ruby/pull/871">github.com/ruby/ruby/pull/871</a> [Bug #11067]</p>

<p>Mon Apr 13 22:44:07 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/lib/envutil.rb (File.mkfifo): Defined using mkfifo command.</p>

<p>	* test/ruby/test_io.rb: Use File.mkfifo.</p>

<p>	* test/ruby/test_file_exhaustive.rb: Ditto.</p>

<p>	* test/ruby/test_process.rb: Ditto.</p>

<p>Mon Apr 13 21:20:20 2015  CHIKANAGA Tomoyuki  &lt;nagachika@ruby-lang.org&gt;</p>

<p>	* ext/openssl/lib/openssl/ssl.rb: stricter hostname verification 	  following RFC 6125. with the patch provided by Tony Arcieri and 	  Hiroshi Nakamura [ruby-core:61545] [Bug #9644] 	* test/openssl/test_ssl.rb: add tests for above.</p>

<p>Sun Apr 12 18:40:04 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/json/json.gemspec: bump version to 1.8.2. 	* ext/json/lib/json/version.rb: ditto.</p>

<p>Sun Apr 12 18:12:07 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/json/json.gemspec, lib/rdoc/rdoc.gemspec: added gemspec directly. 	* defs/default_gems, tool/rbinstall.rb: removed default_gems definition. 	  it make simple installation for default gems.</p>

<p>Sun Apr 12 17:35:17 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/json/*, test/json/*: Reverted r50231.  Because it&#39;s not 	  working with cross-compile environment.</p>

<p>Sun Apr 12 15:34:59 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (arg): fix segfault by null caused by syntax error. 	  [ruby-core:68851] [Bug #10957]</p>

<p>Sun Apr 12 15:11:16 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rubygems/test_case.rb: use explicitly exception class and reverted 	  to require JSON library for rubygems tests with Ruby 2.2.0 or earlier.</p>

<p>Sun Apr 12 15:10:18 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/io/wait/wait.c (io_wait_readable): simply returns that IO is 	  readable without blocking, but no longer returns EOF.</p>

<p>	* ext/io/wait/wait.c (io_ready_p, io_wait_readable): try polling 	  first and check FIONREAD optionally to see if EOF. 	  [ruby-core:36805] [Feature #4849]</p>

<p>Sun Apr 12 14:53:23 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rubygems/test_case.rb: fixed json load error for rubygems tests.</p>

<p>Sun Apr 12 14:13:28 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* gc.c: Document require name for ObjectSpace methods. 	  [ci skip][fix GH-860] Patch by @schneems</p>

<p>Sun Apr 12 13:54:05 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_io.rb: New test that open(fifo) doesn&#39;t block other 	  threads.</p>

<p>Sun Apr 12 13:52:18 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/coverage/coverage.c: Remove extension from require argument. 	  [ci skip][fix GH-870] Patch by @yui-knk</p>

<p>Sun Apr 12 10:29:14 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c (ossl_ssl_connect_nonblock): 	  support `exception: false&#39; 	* (get_no_exception): move function location 	* ext/socket/socket.c (sock_connect_nonblock): 	  support `exception: false&#39; 	* test/openssl/test_pair.rb (test_connect_accept_nonblock_no_exception): 	  test `exception: false&#39; on connect, 	  rename from `test_accept_nonblock_no_exception&#39; 	* test/socket/test_nonblock.rb (test_connect_nonblock_no_exception): 	  new test</p>

<p>Sun Apr 12 09:57:16 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Test a block device on GNU/Linux.</p>

<p>Sun Apr 12 09:24:03 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Test a file not owned.</p>

<p>Sun Apr 12 09:05:44 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/fiddle/depend: Fix “Wrong mix of special targets” error with 	  OpenBSD make.</p>

<p>Sun Apr 12 09:04:37 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Windows doesn&#39;t support Unix file 	  modes.</p>

<p>Sun Apr 12 08:56:44 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/-test-/file/fs.c: OpenBSD needs sys/param.h before sys/mount.h.</p>

<p>Sun Apr 12 08:52:01 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Test suid, sgid and sticky file.</p>

<p>Sat Apr 11 23:48:30 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* template/fake.rb.in: Don&#39;t assign baseruby, Because it&#39;s affect to 	  Makefile of native gem like json on bundled gems.</p>

<p>Sat Apr 11 23:33:22 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* file.c (rb_f_test): Consider nsec for “=”, “&lt;” and “&gt;” for “test” 	  method.</p>

<p>Sat Apr 11 23:26:05 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* tool/rbinstall.rb: support destdir for native extension gem.</p>

<p>Sat Apr 11 21:02:06 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb 	  (TestFileExhaustive#test_stat_socket_p): r50226 accidentally missed 	  the guard for non-unix environments.</p>

<p>Sat Apr 11 20:14:21 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/json/*, test/json/*, defs/default_gems: Gemify JSON library. 	  [fix GH-867][Feature #11057] 	* test/ruby/test_extlibs.rb: removed json gem from existence extensions. 	* gems/bundled_gems: added json gem into bundled gem. 	* lib/rdoc/rubygems_hook.rb: ignored no json environment. 	* lib/rubygems/test_case.rb, test/rubygems/*: ditto. 	* lib/rdoc/test_case.rb, test/rdoc/*: ditto.</p>

<p>Sat Apr 11 15:56:58 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Create sample files lazily.</p>

<p>Sat Apr 11 14:03:47 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Test character device using 	  /dev/null.</p>

<p>Sat Apr 11 10:59:58 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/mkmf.rb (append_cppflags, append_cflags, append_ldflags): 	  utility methods to append compiler options.</p>

<p>Sat Apr 11 08:22:24 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rdoc/text.rb: removed duplicated code.</p>

<p>Sat Apr 11 04:46:42 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/net/protocol.rb (rbuf_fill): avoid exception with read_nonblock 	  [ruby-core:68787] [Feature #11044]</p>

<p>Fri Apr 10 23:57:44 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (need_normalization): use getattrlist() if fgetattrlist() 	  is unavailable, on OSX 10.5.  [ruby-core:68829] [Bug #11054]</p>

<p>Fri Apr 10 22:29:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/mkmf.rb (try_compile): pass the given werror flag to try_do 	  to check if stderr is empty.</p>

<p>	* lib/mkmf.rb (try_cflags, try_ldflags): default werror to true.</p>

<p>	* win32/Makefile.sub (WERRORFLAG): remove useless option.  VC does 	  not make warnings of unknown command option an error.</p>

<p>Fri Apr 10 19:34:24 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Test socket.</p>

<p>Fri Apr 10 19:38:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/objspace/test_objspace.rb: remove debug prints.</p>

<p>Fri Apr 10 19:35:51 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/objspace/objspace.c: add ObjectSpace.count_imemo_objects method 	  to count imemo objects for each type.</p>

<p>	* test/objspace/test_objspace.rb: add a test.</p>

<p>	* NEWS: describe about this addition.</p>

<p>Fri Apr 10 19:34:24 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Test anonymous pipe.</p>

<p>Fri Apr 10 19:31:56 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_file_exhaustive.rb: Test named pipe.</p>

<p>Fri Apr 10 19:10:34 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* ext/objspace/objspace.c (setup_hash): unify common routine.</p>

<p>Fri Apr 10 18:29:49 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* process.c (rb_execarg_parent_start1): Handle EINTR.</p>

<p>Fri Apr 10 17:27:58 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm.c (vm_exec): check other events when RETURN is thrown. 	  [Bug #10724]</p>

<p>	* test/ruby/test_settracefunc.rb: add a test.</p>

<p>Fri Apr 10 11:44:09 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/date/extconf.rb: check warnings.</p>

<p>	* lib/mkmf.rb (try_cflags): pass options to try_compile.</p>

<p>	* win32/Makefile.sub (WERRORFLAG): make unknown command line 	  options an error.</p>

<p>Fri Apr 10 08:00:17 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_process.rb: unfortunately, windows is not POSIX… 	  cygwin has mkfifo command, but it does not affect system-wide.</p>

<p>Fri Apr 10 02:18:53 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/ruby/test_process.rb: Use mkfifo command instead of mknod 	  command to create a named pipe.  mkfifo command is defined by POSIX.</p>

<p>Fri Apr 10 01:29:05 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* process.c: Release GVL when opening a file in spawn() to avoid whole 	  process blocking when opening a named pipe. 	  (open_func): New function. 	  (rb_execarg_parent_start1): Extracted from rb_execarg_parent_start and 	  use rb_thread_call_without_gvl2 to release GVL when opening a file. 	  (rb_execarg_parent_start): Invoke rb_execarg_parent_start1 via 	  rb_protect and invoke rb_execarg_parent_end when error.</p>

<p>Thu Apr  9 22:19:19 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* process.c (redirect_open): Removed.</p>

<p>Thu Apr  9 21:38:20 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* internal.h (rb_execarg_parent_end): Declared.</p>

<p>	* process.c: “spawn” opens files in the parent process. 	  (check_exec_redirect): Add an placeholder for fd in parameters 	  for fd_open. 	  (check_exec_fds_1): Delete fd_open condition. 	  (check_exec_fds): Don&#39;t call check_exec_fds_1 with fd_open. 	  (rb_execarg_parent_start): Open files specified as “spawn” options 	  and add “dup2” options. 	  (rb_execarg_parent_end): New function to close opened fds. 	  (run_exec_open): Removed. 	  (rb_execarg_run_options): Don&#39;t call run_exec_open. 	  (rb_spawn_internal): Call rb_execarg_parent_end.</p>

<p>	* io.c (pipe_open): Call rb_execarg_parent_end.</p>

<p>	* ext/pty/pty.c (establishShell): Call rb_execarg_parent_end.</p>

<p>Thu Apr  9 20:52:31 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* internal.h (rb_execarg_parent_start): Renamed from rb_execarg_fixup.</p>

<p>	* process.c: Follows the above change.</p>

<p>	* io.c: Ditto.</p>

<p>	* ext/pty/pty.c: Ditto.</p>

<p>Thu Apr  9 20:35:12 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* process.c (fd_clear_cloexec): Extracted from run_exec_dup2.</p>

<p>Thu Apr  9 09:26:47 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ccan/list/list.h: sync with ccan upstream 	  [ccan commit c2fbfe5282ba264f3485586e7efa8a5967f2d386]</p>

<p>Thu Apr  9 08:24:03 2015  Masahiro Tomita  &lt;tommy@tmtm.org&gt;</p>

<p>	* ext/socket/raddrinfo.c (addrinfo_mload): fix memory leak of 	  addrinfo.  [ruby-dev:48923] [Bug #11051]</p>

<p>Wed Apr  8 17:45:02 2015  Shannon Skipper  &lt;shannonskipper@gmail.com&gt;</p>

<p>	* version.c (Init_version): the version of the engine or 	  interpreter.  [Fix GH-858]</p>

<p>Wed Apr  8 16:15:30 2015  Kenta Murata  &lt;mrkn@cookpad.com&gt;</p>

<p>	* bigdecimal: conform to ruby&#39;s license.  [ruby-core:68466] [Bug #10952]</p>

<p>Wed Apr  8 14:57:06 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (rb_w32_wreadlink): should treat junctions like as 	  symlinks.</p>

<p>Wed Apr  8 14:03:47 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/ruby/test_symbol.rb: fix syntax error.</p>

<p>Wed Apr  8 13:01:06 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_any_hash): Symbols are compared by the identities 	  always.  [ruby-core:68767] [Bug #11035]</p>

<p>Tue Apr  7 10:22:51 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* internal.h: fix typo. Patch by @sferik [fix GH-865]</p>

<p>Mon Apr  6 22:52:35 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* enum.c: Enumerable#chunk and Enumerable#slice_before no longer takes 	  the initial_state argument.  [Feature #10958]</p>

<p>Mon Apr  6 16:09:58 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_args.c: protect value stack from calling other methods 	  during complex parameter setting process (splat, kw, and so on). 	  [Bug #11027]</p>

<p>	* vm_core.h: remove rb_thread_t::mark_stack_len. 	  With this modification, we don&#39;t need to use th-&gt;mark_stack_len.</p>

<p>	* test/ruby/test_keyword.rb: add a test.</p>

<p>	* cont.c (cont_capture): catch up this fix.</p>

<p>	* vm.c (rb_thread_mark): ditto.</p>

<p>Mon Apr  6 11:26:42 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* tool/downloader.rb (http_options): prevent content auto decoding 	  because this is a downloader.</p>

<p>Sun Apr  5 09:55:18 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* doc/contributing.rdoc: update Maintainers list.</p>

<p>Sun Apr  5 09:11:00 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* tool/rbinstall.rb: fix bin script permission of bundled gems.</p>

<p>Sun Apr  5 08:46:08 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* tool/rbinstall.rb: support –program-suffix option.</p>

<p>Sat Apr  4 21:31:18 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rake/*: Gemify rake [fix GH-862][Feature #11025] 	* test/rake/*: ditto. 	* tool/rbinstall.rb: ditto.</p>

<p>Sat Apr  4 11:30:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_setbyte): check the argument first not to 	  discard shared string and code range unnecessarily until 	  actually changing the contents.  pointed out by headius.</p>

<p>Sat Apr  4 08:16:43 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* lib/net/http.rb (edit_path): use path which is absolute ftp url 	  on using ftp_proxy.</p>

<p>Fri Apr  3 11:43:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (vm_call0_cfunc): update invoker arguments.</p>

<p>	* vm_insnhelper.c (vm_call_cfunc_latter): ditto.</p>

<p>	* vm_insnhelper.c (rb_vm_call_cfunc_push_frame): ditto, and prefix 	  with rb_.</p>

<p>Thu Apr  2 16:26:59 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* common.mk, tool/mkconfig.rb: check the running ruby version in 	  rbconfig.rb with the program version, as RUBY_VERSION has never 	  been affected by –with-ruby-version option. 	  [ruby-core:68639] [Bug #11002]</p>

<p>	* configure.in (LIBRUBY_DLDFLAGS): compatibility_version must be 	  valid version numbers, not an arbitrary string.</p>

<p>Wed Apr  1 11:09:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (push_glob): remove indirect links of arguments for 	  trampoline.</p>

<p>Wed Apr  1 09:59:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/fileutils.rb (FileUtils#mv): show the exact target path in 	  the error message instead of the destination parent directory 	  name.  patched by Joao Britto &lt;jabcalves AT gmail.com&gt; at 	  [ruby-core:68706].  [Bug #11021]</p>

<p>Tue Mar 31 15:25:07 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/ChangeLog-0.06_to_0.52: added archived Changelog. 	  [ruby-list:50105] 	* doc/ChangeLog-0.50_to_0.60: ditto. 	* doc/ChangeLog-0.60_to_1.1: ditto.</p>

<p>Mon Mar 30 22:02:55 2015  Kazuhiro NISHIYAMA  &lt;zn@mbf.nifty.com&gt;</p>

<p>	* README.EXT.ja: add redirect [ruby-core:68631]</p>

<p>Mon Mar 30 14:42:41 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (fileattr_to_unixmode, winnt_lstat): deal with 	  symbolic link than directory, and set executable bits.</p>

<p>Mon Mar 30 11:27:54 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (copy_stream_body): use the arguments without conversion if 	  having read, readpartial, and write methods, than conversion by 	  to_path method.  [ruby-core:68676] [Bug #11015]</p>

<p>Sun Mar 29 21:08:37 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* gc.c (objspace_allrefs_destruct_i): fix a typo. 	  [Bug #11013]</p>

<p>Sun Mar 29 11:51:32 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (proc_binding): replicate env from method object, and 	  allocate the local variable area for the iseq local table. 	  [ruby-core:68673] [Bug #11012]</p>

<p>Sat Mar 28 09:19:41 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/date/extconf.rb: try_cflags(“-std=iso9899:1999”) [Bug #10906] 	  ruby itself (including numeric.c) is built with strict compile 	  options including -std=iso9899:1999, but ext/date is not. 	  By the way -std=iso9899:1999 is not only a warning option but also 	  changes behavior like MACRO definitions for example INFINITY. 	  gcc on Solaris affect this.</p>

<p>Fri Mar 27 16:34:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* common.mk: revert using BOOTSTRAPRUBY for enc.mk, as 	  enc/depend uses CONFIG.  [ruby-core:68647] [Bug #11004]</p>

<p>Thu Mar 26 10:05:13 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* test/test_observer.rb: add tests for Observable module. 	  [fix GH-859] Patch by @brightbits</p>

<p>Thu Mar 26 06:35:10 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* README.EXT: add redirect [ruby-core:68631]</p>

<p>Wed Mar 25 16:46:49 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* ext/socket/extconf.rb: Solaris 11 has struct tcp_info.tcpi_ca_state, 	  but it is a dummy.</p>

<p>	* ext/socket/option.c: Solaris 11 doesn&#39;t have u_intN_t.</p>

<p>	* ext/socket/option.c: Solaris 11 needs inspect_tcpi_msec.</p>

<p>	* ext/socket/raddrinfo.c: Solaris 11 has AF_PACKET but doesn&#39;t have 	  related macros.</p>

<p>Wed Mar 25 17:03:08 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/-test-/file/fs.c (get_fsname): try magic number only if 	  f_type is included.  [ruby-dev:48913] [Bug #11000]</p>

<p>Wed Mar 25 11:20:40 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* benchmark/bm_hash_aref_flo.rb: make more realistic data. 	  [ruby-core:68632] [[Bug #10999]</p>

<p>Wed Mar 25 10:39:06 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* .document: removed needless entries.</p>

<p>Wed Mar 25 08:07:28 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* doc/extension.rdoc: fix spelling of filename 	* doc/extension.ja.rdoc: ditto.</p>

<p>Tue Mar 25 06:55:43 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* complex.c (k_inexact_p, k_exact_zero_p): use k_exact_zero_p macro 	  to remove k_inexact_p macro.</p>

<p>	* complex.c (k_exact_one_p): remove unused macro k_exact_one_p.</p>

<p>Tue Mar 24 22:23:33 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/extension.rdoc: move from toplevel document and added extname. 	* doc/extension.ja.rdoc: ditto.</p>

<p>Tue Mar 24 22:06:58 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/standard_library.rdoc: strip.</p>

<p>Tue Mar 24 22:06:27 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/standard_library.rdoc: move Thread to Extensions.</p>

<p>Tue Mar 24 21:59:10 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/contributing.rdoc: update Maintainers list.</p>

<p>Tue Mar 24 19:10:24 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_writebarrier_generational): fix messages for rb_bug(). 	  Remove `rb_&#39; prefix.</p>

<p>	* gc.c (gc_writebarrier_incremental): ditto.</p>

<p>Tue Mar 24 17:34:01 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* README.ja.md: should be chunibyo.</p>

<p>Tue Mar 24 17:30:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/-test-/file/fs.c (get_fsname): return filesystem name by 	  statfs/statvfs.  [ruby-core:68624] [Bug #10998]</p>

<p>Tue Mar 24 16:46:02 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: now doesn&#39;t required spaces just after 	  <code>!</code>.</p>

<p>Mon Mar 23 23:18:27 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (dir_close): don&#39;t raise on double close for consistent to 	  IO#close.  [Feature #10950]</p>

<p>Mon Mar 23 21:22:07 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/file.c (rb_readlink): move from file.c for better buffer 	  allocation and the result encoding.</p>

<p>	* win32/win32.c (wreadlink, rb_w32_ureadlink): implement readlink().</p>

<p>Mon Mar 23 14:40:45 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (winnt_stat): stat with following symbolic links.</p>

<p>	* win32/win32.c (winnt_lstat): rename old winnt_stat, which does 	  not follow symbolic links.</p>

<p>Mon Mar 23 01:44:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* marshal.c (r_symreal): register symbol names as strings first so 	  that r_symlink always returns valid names. 	  [ruby-core:68587] [Bug #10991]</p>

<p>	* marshal.c (r_ivar, r_object0): now need to intern symbol names.</p>

<p>	* marshal.c (r_object0): compare with symbol names.</p>

<p>Sun Mar 22 22:07:40 2015  Kouhei Sutou  &lt;kou@cozmixng.org&gt;</p>

<p>	* doc/etc.rd.ja: Fix wrong coding for Emacs.</p>

<p>Sun Mar 22 09:53:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/make-snapshot (package): add default CONFIGURE name to 	  follow r50039.</p>

<p>	* tool/make-snapshot (package): substitute configuration variables 	  in Makefile.in instead of passing by the command line, and make 	  temporary Makefile instead of a pipe.</p>

<p>Sun Mar 22 08:09:47 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* common.mk (ext/ripper/ripper.c, ext/rbconfig/sizeof/sizes.c): 	  strip autogenerated dependencies which have invalid syntax in 	  other than nmake.</p>

<p>Sat Mar 21 15:01:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/io/console/console.c (console_set_winsize): use handle for 	  writing.  GetConsoleScreenBufferInfo seems failing on a handle 	  for reading.</p>

<p>	* io.c: [DOC] update the example of IO#winsize to use $stdout 	  instead of $stdin, which does not work on Windows.  a patch by 	  Jan Lelis &lt;mail AT janlelis.de&gt; at [ruby-core:68574]. 	  [Bug #10986]</p>

<p>Fri Mar 20 18:41:03 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* proc.c (respond_to_missing_p): check if the receiver responds to 	  the given method by respond_to_missing?.</p>

<p>	* proc.c (mnew_missing): create Method object for method_missing. 	  [ruby-core:68564] [Bug #10985]</p>

<p>Fri Mar 20 17:43:18 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* .travis.yml: enabled email notification.</p>

<p>Fri Mar 20 17:39:52 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* .travis.yml: removed Ruby 1.9.3 build on Travis CI</p>

<p>Fri Mar 20 12:38:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (obj_info): obj_info() can receive internal objects.</p>

<p>	* gc.c (check_rvalue_consistency): obj_info() returns const char *.</p>

<p>Fri Mar 20 12:14:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (obj_info): show class name and T_DATA type_name.</p>

<p>Thu Mar 19 22:12:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_copy_wb_protected_attribute): `dest&#39; can be WB unprotected.</p>

<p>Thu Mar 19 21:25:25 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_copy_wb_protected_attribute): demote `dest&#39; object.</p>

<p>Thu Mar 19 16:18:00 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c, internal.h: export rb_gc_verify_internal_consistency().</p>

<p>Thu Mar 19 16:15:24 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (obj_info): show allocation site if GC_DEBUG is not 0.</p>

<p>Thu Mar 19 16:12:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (newobj_of): fix RGENGC_OLD_NEWOBJ_CHECK logics. 	  * skip on incremental marking because not sure what happen <code>:p</code> 	  * rb_gc_writebarrier_remember() is enough to mark children.</p>

<p>Thu Mar 19 16:08:42 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_copy_wb_protected_attribute): need demote for old objects.</p>

<p>Thu Mar 19 10:31:00 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* random.c (fill_random_bytes): release the handle in the static 	  variable, not a local variable.</p>

<p>Thu Mar 19 06:30:35 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* object.c (rb_obj_clone): do not touch age (<a href="01">FL_PROMOTED</a>) because 	  rb_obj_alloc() can return old object in debug.</p>

<p>Thu Mar 19 06:29:28 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/objspace/test_objspace.rb: flag name was changed 	  (long_lived -&gt; uncollectible).</p>

<p>Thu Mar 19 05:30:13 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* iseq.c (iseq_mark): skip some marking if iseq-&gt;orig is available.</p>

<p>	* iseq.c (rb_iseq_clone): need WB for iseq1-&gt;klass = iseq0-&gt;klass 	  (done in MEMCPY).</p>

<p>Thu Mar 19 04:55:53 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h (IMEMO_DEBUG): added.</p>

<p>	* internal.h: remove unused <a href="0-3">FL_IMEMO_MARK_V</a>.</p>

<p>	* gc.c (rb_imemo_new_debug): added.</p>

<p>	* gc.c (obj_info): show imemo type name.</p>

<p>Thu Mar 19 04:52:26 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (RGENGC_OLD_NEWOBJ_CHECK): add check mechanism.</p>

<p>	  If RGENGC_OLD_NEWOBJ_CHECK &gt; 0, then create old objects 	  (not new objects) periodically.</p>

<p>	  Create one old objects per RGENGC_OLD_NEWOBJ_CHECK objects are 	  created.</p>

<p>Thu Mar 19 04:46:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* enum.c (enum_sort_by): add WBs.</p>

<p>Thu Mar 19 03:37:52 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (check_rvalue_consistency): refactoring. 	  * not inline on RGENGC_CHECK_MODE &gt; 0. 	  * check SPECIAL_CONST_P(obj) first. 	  * add a check that remembered_bit is only TRUE when old (age == 3).</p>

<p>	* gc.c (RVALUE_DEMOTE): should clear RVALUE_REMEMBERED bit.</p>

<p>	  remembered_bit should be TRUE only for old (age == 3) objects.</p>

<p>	  Actually there are no effect because demoted objects will be 	  uncollectible WB unprotected objects (marked at the beginning of 	  every minor GC).</p>

<p>Thu Mar 19 02:52:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: rename terminologies. 	  * long_lived -&gt; uncollectible: 	    because this bitmap does not mean “long lived objects in past”, 	    but means “prohibit collection these objects until next major GC”.</p>

<p>	    Uncollectible objects consist of two types objects, one is old 	    objects (WB protected objects which age == 3) and another is 	    uncollectible WB unprotected objects which are referred from old 	    objects</p>

<p>	  * remembered_wb_unprotected_objects -&gt; 	    uncollectible_wb_unprotected_objects: 	    because uncollectible objects does not mean remembered objects.</p>

<p>Wed Mar 18 17:21:12 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (gc_writebarrier_generational): add an alternative write 	  barrier (WB) implementation. 	  When finding reference from [Old obj] to [New obj] by WB, current 	  implementation marks [Old obj] as remembered old objects and marks 	  children of [Old obj] at the beginning of marking.</p>

<p>	  Added (but disabled) code changes current behaviour. This fix promote 	  [New obj] to old and marks as a remembered old object. We can assume 	  “new objects referred from old objects are maybe long-lived old 	  objects”.</p>

<p>	  Disadvantage of added algorithm is we may promote unwilling 	  short-lived objects. For example, consider many new objects push and 	  pop to an old stack object. All of new objects (short-lived objects) 	  promote to old objects unexpectedly.</p>

<p>	  To compare these behaviour, I add this new code (but disabled it).</p>

<p>Wed Mar 18 17:14:39 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (RVALUE_PROMOTE_RAW): rename to RVALUE_OLD_LONG_LIVED_SET() 	  to make clear.</p>

<p>Wed Mar 18 17:10:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (check_rvalue_consistency): do not need to check is_sweeping().</p>

<p>Wed Mar 18 14:13:22 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* benchmark/bm_vm1_gc_wb_ary.rb: run GC to finish “marking” phase.</p>

<p>	* benchmark/bm_vm1_gc_wb_obj.rb: ditto.</p>

<p>	* benchmark/bm_vm1_gc_wb_ary_promoted.rb: add parameter 	  full_mark: false to invoke only minor GC.</p>

<p>	* benchmark/bm_vm1_gc_wb_obj_promoted.rb: ditto.</p>

<p>Wed Mar 18 12:07:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* string.c: add a comment about RSTRING_FSTR.</p>

<p>Wed Mar 18 12:01:53 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* hash.c (rb_any_hash): use same hash values with Float#hash so 	  that -0.0 and +0.0 will be identical. 	  [ruby-core:68541] [Bug #10979]</p>

<p>Wed Mar 18 05:34:32 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* string.c: introduce STR_FAKESTR to show string is FAKESTR or not.</p>

<p>	* string.c (STR_SET_SHARED): ignore FAKESTR because only Ruby objects 	  can use write barrier.</p>

<p>Tue Mar 17 18:59:16 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* include/ruby/ruby.h: use rb_gc_writebrrier() simply. 	  For incremental GC, we need to get a pointer to the objspace. 	  We can share this pointer for the following WB process. 	  And considering icache hit ratio, process in the GC.</p>

<p>	* gc.c (rb_gc_writebarrier): added.</p>

<p>	* gc.c (gc_writebarrier_generational, gc_writebarrier_incremental): 	  make them NOINLINE because inlining them into rb_gc_writebarrier() 	  makes a prologue code of rb_gc_writebarrier() longer (storing callee 	  save registers).</p>

<p>	  This patch improve the performance of WB on micro-benchmarks.</p>

<p>	  name                   ruby 2.1   trunk   modified 	  vm1_gc_wb_ary*            0.511   0.632      0.532 	  vm1_gc_wb_ary_promoted*   0.578   0.701      0.674 	  vm1_gc_wb_obj*            0.419   0.575      0.492 	  vm1_gc_wb_obj_promoted*   0.537   0.664      0.618 	                                                 (sec)</p>

<p>Tue Mar 17 18:51:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* benchmark/bm_vm1_gc_wb_ary(_promoted).rb: separate fastpath and 	  slowpath for WB.</p>

<p>	  Before this change bm_vm1_gc_wb_ary.rb tried to check the performance 	  for WB slowpath (making a reference from oldobj to newobj). However, 	  from Ruby 2.2, 3 GCs are needed to promote new objects because 	  only 3 age objects are promoted objects.</p>

<p>	  To compare fastpath and slowpath, introduce new “promoted” version 	  benchmark.</p>

<p>	  bm_vm1_gc_wb_ary.rb is for fastpath and 	  bm_vm1_gc_wb_ary_promoted.rb is for slowpath.</p>

<p>	* benchmark/bm_vm1_gc_wb_obj(_promoted).rb: ditto.</p>

<p>Tue Mar 17 17:23:11 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (glob_helper): distinguish not-yet-stated and DT_UNKNOWN 	  by readdir, and traverse recursively for the former.  Linux 	  readdir returns DT_UNKNOWN on some filesystems, e.g., smbfs, 	  iso9660.</p>

<p>Mon Mar 16 17:43:21 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/webrick/server.rb: Fix regression bug in WEBrick&#39;s 	  <code>:DoNotReverseLookup</code> config option implementation. 	  [fix GH-731] Patch by @vais 	* test/webrick/test_do_not_reverse_lookup.rb: ditto.</p>

<p>Sat Mar 14 20:05:23 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* math.c (math_gamma): optimization for passed small integer.</p>

<p>Sat Mar 14 18:07:23 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* enum.c: [DOC] Fixes Enumerable#member? documentation 	  [fix GH-756][ci skip] Patch by @shamanime</p>

<p>Sat Mar 14 12:23:53 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (glob_helper): use d_type to reduce lstat system calls.</p>

<p>	* win32/dir.h (struct direct): add d_type instead of d_isdir and 	  d_isrep.  SYMLINKD is unreliable, since the target can be 	  replaced after a link was created.</p>

<p>	* win32/win32.c (readdir_internal): set d_type.</p>

<p>Sat Mar 14 02:14:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (primary): empty parentheses at cmdarg can be null. 	  [ruby-core:68477] [Bug #10957]</p>

<p>Fri Mar 13 15:04:36 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/stringio/stringio.c (strio_close): don&#39;t raise on double 	  close for consistent to IO#close.</p>

<p>Fri Mar 13 15:03:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (rb_io_close_read, rb_io_close_write): don&#39;t raise after 	  close same as IO#close.</p>

<p>Fri Mar 13 12:29:07 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/readline/test_readline.rb: Restore environment variables: 	  COLUMNS LINES</p>

<p>Fri Mar 13 11:37:46 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/fiddle/extconf.rb: needs –enable-shared when linked to 	  libruby or fiddle.so.  since –with-static-linked-ext does no 	  longer link extensions to ruby program with –enable-shared, the 	  only combination needs –enable-static is –disable-shared and 	  –with-static-linked-ext.  [ruby-dev:48901] [Bug #10960]</p>

<p>Fri Mar 13 07:02:20 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (rsock_s_accept_nonblock): use rb_hash_lookup2 	* ext/openssl/ossl_ssl.c (get_no_exception): new function 	  (ossl_ssl_accept_nonblock): use get_no_exception 	  (ossl_ssl_read_internal): ditto 	  (ossl_ssl_write_nonblock): ditto 	  [ruby-core:68511]</p>

<p>Fri Mar 13 07:01:38 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/openssl/ossl_ssl.c: predefine wait_*able symbols</p>

<p>Thu Mar 12 22:59:53 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* test/lib/leakchecker.rb: Check environment variables.</p>

<p>Thu Mar 12 05:54:27 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/socket/init.c (rsock_s_accept_nonblock): 	  support exception: false 	  [ruby-core:66385] [Feature #10532] 	* ext/socket/init.c (rsock_init_socket_init): define new symbols 	* ext/socket/rubysocket.h: adjust prototype 	* ext/socket/socket.c (sock_accept_nonblock): support exception: false 	* ext/openssl/ossl_ssl.c (ossl_ssl_accept_nonblock): ditto 	* ext/socket/socket.c (Init_socket): adjust accept_nonblock definition 	* ext/openssl/ossl_ssl.c (Init_ossl_ssl): ditto 	* ext/socket/tcpserver.c (rsock_init_tcpserver): ditto 	* ext/socket/unixserver.c (rsock_init_unixserver): ditto 	* ext/socket/tcpserver.c (tcp_accept_nonblock): adjust 	  rsock_s_accept_nonblock call 	* ext/socket/unixserver.c (unix_accept_nonblock): ditto 	* ext/openssl/ossl_ssl.c (ossl_start_ssl): support no_exception 	* ext/openssl/ossl_ssl.c (ossl_ssl_connect): adjust ossl_start_ssl call 	* ext/openssl/ossl_ssl.c (ossl_ssl_connect_nonblock): ditto 	* ext/openssl/ossl_ssl.c (ossl_ssl_accept): ditto 	* test/socket/test_nonblock.rb (test_accept_nonblock): test for 	  “exception :false” 	* test/socket/test_tcp.rb (test_accept_nonblock): new test 	* test/socket/test_unix.rb (test_accept_nonblock): ditto 	* test/openssl/test_pair.rb (test_accept_nonblock_no_exception): ditto</p>

<p>Thu Mar 12 10:53:06 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h, node.h: move a definition of `struct rb_global_entry&#39; 	  and related functions from node.h to internal.h.</p>

<p>	* variable.c: remove unused include pragma.</p>

<p>	* common.mk: remove unused dependency.</p>

<p>Thu Mar 12 10:32:39 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* common.mk: remove unused dependency.</p>

<p>Thu Mar 12 08:20:14 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* load.c: removed unused header file “node.h”.</p>

<p>	* method.h: ditto.</p>

<p>	* symbol.c: ditto.</p>

<p>Thu Mar 12 08:14:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: RGENGC_CHECK_MODE should be 0.</p>

<p>Thu Mar 12 07:44:17 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: use T_IMEMO to represent `struct MEMO&#39; value. 	  memo-&gt;v1 and memo-&gt;v2 is WB protected values. 	  So use MEMO_V1/V2_SET() macros to set these values. 	  memo-&gt;u3 is ambiguous (sometimes a VALUE, sometimes an integer 	  value), so use gc_mark_maybe() in gc.c to mark it.</p>

<p>	  Rename NEW_MEMO() to MEMO_NEW().</p>

<p>	  Move MEMO_FOR and NEW_MEMO_FOR macros from node.h.</p>

<p>	  Export a rb_imemo_new() function for ext/ripper.</p>

<p>	* node.h: remove NODE_MEMO.</p>

<p>	* enum.c: catch up these change.</p>

<p>	* enumerator.c: ditto.</p>

<p>	* load.c: ditto.</p>

<p>	* ext/objspace/objspace.c (count_nodes): ditto.</p>

<p>	* gc.c (gc_mark_children): mark imemo_memo type.</p>

<p>	* parse.y (new_args_gen): use T_IMEMO. 	  (I&#39;m not sure it is working correctly…)</p>

<p>Wed Mar 11 22:36:34 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* eval.c (frame_called_id): it should use vm_ifunc type.</p>

<p>	* eval.c (frame_func_id): ditto.</p>

<p>Wed Mar 11 22:27:05 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* node.h: remove NODE_IFUNC, NEW_IFUNC.</p>

<p>	* internal.h: use T_IMEMO for IFUNC.</p>

<p>	  rename `struct IFUNC&#39; to `struct vm_ifunc&#39; and move the definition 	  from vm_insnhelper.h. Add imemo_ifunc.</p>

<p>	* gc.c (gc_mark_children): mark imemo_ifunc type T_IMEMO object.</p>

<p>	* compile.c: catch up these changes.</p>

<p>	* proc.c: ditto.</p>

<p>	* vm_core.h (RUBY_VM_IFUNC_P): ditto.</p>

<p>	* vm_eval.c (rb_iterate): ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* ext/objspace/objspace.c: ditto.</p>

<p>Wed Mar 11 21:53:43 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h, eval_intern.h: move CREF accessors.</p>

<p>	  List IMEMO supported types in internal.h.</p>

<p>Wed Mar 11 21:45:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.h: use T_IMEMO to create THROW_DATA.</p>

<p>	  Add THROW_DATA_NEW().</p>

<p>	* internal.h: move definition of `struct THROW_DATA&#39; 	  from vm_insnhelper.h to internal.h.</p>

<p>	  Rename `THROW_DATA&#39; to `vm_throw_data&#39;.</p>

<p>	* eval_intern.h (THROW_DATA_P): move to internal.h. 	  THROW_DATA is no longer T_NODE, so check T_IMEMO.</p>

<p>	* gc.c (gc_mark_children): mark THROW_DATA.</p>

<p>	* vm.c: catch up these changes.</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>Wed Mar 11 21:21:56 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c: use T_IMEMO to create SVAR.</p>

<p>	* internal.h, vm_insnhelper.h: move definition `struct SVAR&#39; 	  from vm_insnhelper.h to internal.h. And rename it to struct vm_svar.</p>

<p>	  new imemo_type imemo_svar is added.</p>

<p>	* gc.c (gc_mark_children): mark imemo_svar.</p>

<p>	* node.c (rb_gc_mark_node): remove useless marking.</p>

<p>Wed Mar 11 19:35:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* include/ruby/ruby.h: introduce new type T_IMEMO. 	  T_IMEMO is Internal Memo type, internal use only. 	  T_IMEMO has same purpose of NODE_MEMO.</p>

<p>	  To insert T_IMEMO, type numbers are modified a little.</p>

<p>	* internal.h: define struct RIMemo. Each RIMemo objects 	  has imemo_type. We can observe it by the imemo_type() function.</p>

<p>	* gc.c (rb_imemo_new): added.</p>

<p>	* node.h: remove NODE_CREF and NEW_CREF().</p>

<p>	* node.c (rb_gc_mark_node): ditto.</p>

<p>	* vm.c (vm_cref_new): use rb_imem_new().</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* vm_insnhelper.c: use RIMemo objects for CREF.</p>

<p>	* ext/objspace/objspace.c: support T_IMEMO.</p>

<p>Wed Mar 11 17:03:20 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c: fix memory leak by prepend method.</p>

<p>	  It is easy to reproduce with such script:</p>

<p>	    module M; def bar; end; end 	    loop{ 	      Class.new do 	        def foo; end 	        prepend M 	      end 	    }</p>

<p>	* gc.c (obj_free): free T_ICLASS::m_tbl if it is created by prepend. 	  To recognize it, check RICLASS_IS_ORIGIN flag.</p>

<p>	* gc.c (gc_mark_children): T_ICLASS objects only need to mark 	  T_ICLASS::m_tbl if RICLASS_IS_ORIGIN is set.</p>

<p>	* gc.c (obj_memsize_of): count T_ICLASS if RICLASS_IS_ORIGIN is set.</p>

<p>	* internal.h (RCLASS_SET_ORIGIN): add to set RCLASS_SET_ORIGIN.</p>

<p>	  TODO: The word `origin&#39; seems not good name. We need to invent 	  another good name.</p>

<p>	* class.c: use RCLASS_SET_ORIGIN().</p>

<p>	* class.c (class_alloc): zero clear rb_classext_t.</p>

<p>Wed Mar 11 13:28:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in: check also procstat_getvmmap, which is not 	  available on FreeBSD 9.  [ruby-core:68468] [Bug #10954]</p>

<p>	* vm_dump.c (procstat_vm): use kinfo_getvmmap instead if 	  procstat_getvmmap is not available.</p>

<p>Wed Mar 11 09:15:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: define struct MEMO.</p>

<p>	* enum.c: use MEMO.</p>

<p>	* enumerator.c: ditto.</p>

<p>	* load.c: ditto.</p>

<p>	* node.h: return (struct MEMO *) pointer.</p>

<p>Wed Mar 11 06:26:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.h (THROW_DATA_STATE): return int, not VALUE.</p>

<p>	* vm_insnhelper.h (THROW_DATA_STATE_SET): accept int value.</p>

<p>Wed Mar 11 05:06:46 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_eval.c (rb_catch_protect): use THROW_DATA_VAL().</p>

<p>Wed Mar 11 04:56:04 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.h: define struct IFUNC.</p>

<p>	* vm_eval.c (rb_iterate): use it.</p>

<p>	* vm_insnhelper.c (vm_yield_with_cfunc): ditto.</p>

<p>Wed Mar 11 03:52:12 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* eval_intern.h (THROW_DATA_P): use RB_TYPE_P() instead of 	  BUILTIN_TYPE().</p>

<p>	* thread.c (thread_join): use THROW_DATA_P().</p>

<p>Wed Mar 11 03:48:01 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* proc.c: use RUBY_VM_IFUNC_P() to recognize IFUNC or not.</p>

<p>	* vm.c: ditto.</p>

<p>	* vm_dump.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>	* vm_core.h (RUBY_VM_IFUNC_P): use RB_TYPE_P() instead of 	  BUILTIN_TYPE().</p>

<p>Wed Mar 11 03:21:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.h: define struct THROW_DATA to represent 	  throwing data. Also define accessor functions.</p>

<p>	* eval_intern.h: move related changes into vm_insnhelper.h. 	  Now these MACROs (functions) are only used in vm*.c.</p>

<p>	  There is only THROW_DATA_P(err) to check this data type or not.</p>

<p>	* vm.c: catch up these changes.</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* vm_insnhelper.c: ditto.</p>

<p>Wed Mar 11 00:57:00 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/rubygems/test_gem_security_trust_dir.rb: The return value of 	  File::Stat#mode is OS dependent. In AIX, 0200000 is set.</p>

<p>Tue Mar 10 20:03:41 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/webrick/server.rb: Invoke setup_shutdown_pipe in start method 	  instead of listen method. 	  [ruby-core:68476] [Bug #10956] Reported by Shintaro Kojima.</p>

<p>Tue Mar 10 17:27:27 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* thread.c (thread_join): Fixnum (except TAG_FATAL) and 	  NODE should not be reached here.</p>

<p>Mon Mar  9 21:42:10 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (ep_cref): rename to lep_cref() because it should be 	  local ep.</p>

<p>Mon Mar  9 16:34:36 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/stringio/stringio.c (strio_close): don&#39;t raise on double 	  close for consistent to IO#close.</p>

<p>Mon Mar 09 06:44:48 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.h: define struct SVAR for SVAR. 	  This data type is also same layout of NODE (NODE_IF).</p>

<p>	* vm_insnhelper.c: catch up this change.</p>

<p>Mon Mar  9 06:43:21 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (lep_svar_set): add WBs.</p>

<p>Mon Mar  9 06:19:06 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: define rb_cref_t and change to use it.</p>

<p>	  rb_cref_t is data type of CREF. Now, the body is still NODE. 	  It is easy to understand what is CREF and what is pure NODE.</p>

<p>Mon Mar  9 06:00:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.h (COPY_CREF_OMOD): fix translation miss.</p>

<p>Mon Mar  9 04:47:58 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: define CREF accessor macros. 	  * CREF_CLASS(cref) 	  * CREF_NEXT(cref) 	  * CREF_VISI(cref) 	  * CREF_VISI_SET(cref, v) 	  * CREF_REFINEMENTS(cref) 	  * CREF_PUSHED_BY_EVAL(cref) 	  * CREF_PUSHED_BY_EVAL_SET(cref) 	  * CREF_OMOD_SHARED(cref) 	  * CREF_OMOD_SHARED_SET(cref) 	  * CREF_OMOD_SHARED_UNSET(cref)</p>

<p>	  This is process to change CREF data type from NODE.</p>

<p>Sun Mar  8 22:50:57 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* ext/zlib/zlib.c (rb_gzfile_close): Don&#39;t raise on double 	  close for consistent to IO#close.</p>

<p>Sun Mar  8 16:57:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (glob_helper): match patterns against legacy short names 	  too, not only ordinary names.  [ruby-core:67954] [Bug #10819]</p>

<p>	* win32/dir.h (struct direct): add short name members.</p>

<p>	* win32/win32.c (opendir_internal, readdir_internal): ditto.</p>

<p>Sat Mar  7 09:36:05 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* array.c: document that first element is kept when using 	  Array#uniq and #uniq! [fix GH-845][ci skip] 	  Patch by @riffraff</p>

<p>Sat Mar  7 09:28:02 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* thread.c: Mutex#owned? is no longer experimental since 2.1.0 	  [fix GH-839][ci skip] Patch by @takiy33</p>

<p>Sat Mar  7 09:18:42 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* tool/merger.rb: Added documentation to version method. 	  [fix GH-847][ci skip] Patch by @magikid</p>

<p>Fri Mar  6 22:50:36 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* class.c (rb_prepend_module): need a WB for klass -&gt; origin.</p>

<p>Fri Mar  6 20:18:38 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* fix namespace issue on singleton class expressions. [Bug #10943]</p>

<p>	* vm_core.h, method.h: remove rb_iseq_t::cref_stack. CREF is stored 	  to rb_method_definition_t::body.iseq_body.cref.</p>

<p>	* vm_insnhelper.c: modify SVAR usage. 	  When calling ISEQ type method, push CREF information onto method 	  frame, SVAR located place. Before this fix, SVAR is simply nil. 	  After this patch, CREF (or NULL == Qfalse for not iseq methods) 	  is stored at the method invocation.</p>

<p>	  When SVAR is required, then put NODE_IF onto SVAR location, 	  and NDOE_IF::nd_reserved points CREF itself.</p>

<p>	* vm.c (vm_cref_new, vm_cref_dump, vm_cref_new_toplevel): added.</p>

<p>	* vm_insnhelper.c (vm_push_frame): accept CREF.</p>

<p>	* method.h, vm_method.c (rb_add_method_iseq): added. This function 	  accepts iseq and CREF.</p>

<p>	* class.c (clone_method): use rb_add_method_iseq().</p>

<p>	* gc.c (mark_method_entry): mark method_entry::body.iseq_body.cref.</p>

<p>	* iseq.c: remove CREF related codes.</p>

<p>	* insns.def (getinlinecache/setinlinecache): CREF should be cache key 	  because a different CREF has a different namespace.</p>

<p>	* node.c (rb_gc_mark_node): mark NODE_IF::nd_reserved for SVAR.</p>

<p>	* proc.c: catch up changes.</p>

<p>	* struct.c: ditto.</p>

<p>	* insns.def: ditto.</p>

<p>	* vm_args.c (raise_argument_error): ditto.</p>

<p>	* vm_eval.c: ditto.</p>

<p>	* test/ruby/test_class.rb: add a test.</p>

<p>Fri Mar  6 18:19:13 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/webrick/test_filehandler.rb: on vboxsf (on VirtualBox 	  on Windows 7), file name and permissions are strange (can access 	  by short file name and so on).</p>

<p>	  Simply skip on such tests on such FS. To detect strange FS, this 	  patch use a part of code <code>File.executable?(__FILE__)</code>. 	  Please correct them if there are better ways.</p>

<p>Fri Mar  6 17:31:29 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/ruby/test_beginendblock.rb: do not change directory.</p>

<p>	  Run system command in the directory mounted by vboxsf on Windows 7 	  and get warning like that “warning: Insecure world writable dir…”.</p>

<p>Fri Mar  6 10:31:00 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (vm_call_super): search next super class from the 	  original class, to get rid of infinite recursion with 	  prepending.  a patch by Seiei Higa &lt;hanachin AT gmail.com&gt; at 	  [ruby-core:68434].  [ruby-core:68093] [Bug #10847]</p>

<p>Fri Mar  6 08:45:26 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* lib/matrix.rb: Add Vector#round. Patch by Jordan Stephens. 	  [Fixes GH-802]</p>

<p>Fri Mar  6 07:33:03 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (obj_info): show node name too.</p>

<p>Fri Mar  6 07:00:44 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* internal.h: remove struct method_table_wrapper. 	  struct method_table_wrapper was introduced to avoid duplicate marking 	  for method tables.</p>

<p>	  For example, `module M1; def foo; end; end` make one method table 	  (mtbl) contains a method <code>foo</code>. M1 (T_MODULE) points mtbl. 	  Classes C1 and C2 includes M1, then two T_ICLASS objects are created 	  and they points mtbl too. In this case, three objects (one T_MODULE 	  and two T_ICLASS objects) points same mtbl. On marking phase, these 	  three objects mark same mtbl. To avoid such duplication, struct 	  method_table_wrapper was introduced.</p>

<p>	  However, created two T_ICLASS objects have same or shorter lifetime 	  than M1 (T_MODULE) object. So that we only need to mark mtbl from M1, 	  not from T_ICLASS objects. This patch tries marking only from M1. 	  In other words, original module (M1) has responsibility to mark mtbl. 	  Because of no duplicate marking, we don&#39;t need method_table_wrapper 	  any more.</p>

<p>	  Note that one <code>Module#prepend</code> call creates two T_ICLASS objects. 	  One for referring to a prepending Module object, same as 	  <code>Module#include</code>. We don&#39;t need to care this T_ICLASS. 	  One for moving original mtbl from a prepending class. We need to 	  mark such mtbl from this T_ICLASS object. To mark the mtbl, 	  we need to use <code>RCLASS_ORIGIN(klass)</code> on marking from a prepended 	  class <code>klass</code>.</p>

<p>	* class.c: ditto.</p>

<p>	* eval.c (rb_using_refinement): ditto.</p>

<p>	* gc.c: ditto.</p>

<p>	* include/ruby/ruby.h: define m_tbl directly. The definition of 	  struct RClass should be moved to (srcdir)/internal.h.</p>

<p>	* method.h: remove decl of rb_free_m_tbl_wrapper().</p>

<p>	* object.c: use RCLASS_M_TBL() directly.</p>

<p>Fri Mar  6 02:50:12 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* dir.c (replace_real_basename): need to check the return value of 	  GLOB_REALLOC().</p>

<p>Fri Mar  6 02:26:03 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* dir.c (replace_real_basename): shouldn&#39;t create Ruby object before 	  the object system is loaded. 	  [ruby-core:68430] [Bug #10941]</p>

<p>Wed Mar  5 16:58:43 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* hash.c: [DOC] #delete method actually returns nil, if the key 	  is not found. [fix GH-844][ci skip] Patch by @ivdma</p>

<p>Wed Mar  5 12:22:23 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* math.c: refactoring: remove unnecessary variable d0 to unify code 	  appearance.</p>

<p>Thu Mar  5 11:50:54 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (eval_string_with_cref): A binding should keep 	  refinements activation information and the refinements should be 	  activated in subsequent eval calls with the binding. 	  [ruby-core:67945] [Bug #10818]</p>

<p>Thu Mar  5 11:16:55 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_refinement.rb: There is no need anymore to suppress 	  warnings.</p>

<p>Thu Mar  5 08:31:02 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* random.c (random_raw_seed): Avoid calling fill_random_bytes() 	  if the requested size is 0. AIX returns -1 for 0-byte read from 	  /dev/urandom, while other UNIX returns 0. With this change, 	  Random.raw_seed(0) consistently returns “” in any UNIX.</p>

<p>Wed Mar  4 12:43:32 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_math.rb (assert_float_and_int): Refactor test cases 	  by introducing assert_float_and_int. [misc #10810]</p>

<p>Wed Mar  4 11:52:30 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* symbol.c (Init_sym): make dsym_fstrs a hash compared by identity 	  as the keys are unique fstrings, to get rid of running hash and 	  compare methods and causing new object allocation during garbage 	  collection phase.  [ruby-dev:48891] [Bug #10933]</p>

<p>Wed Mar  4 10:16:57 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* enum.c: Fix typo in slice_after&#39;s exception message. 	  [fix GH-842][ci skip] Patch by @jsyeo</p>

<p>Wed Mar  4 10:15:37 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/syntax/methods.rdoc: add some missing spaces and 	  fix a grammatical error in method docs. 	  [fix GH-843][ci skip] Patch by @nikolas</p>

<p>Wed Mar  4 02:13:06 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb (backport_command_string): pick up only 	  when the revision exists in trunk.</p>

<p>Wed Mar  4 00:44:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_io_blocking_region): assigned variables 	  inside EXEC_TAG() should be volatile.</p>

<p>	* thread.c (rb_thread_s_handle_interrupt): ditto.</p>

<p>	* thread.c (exec_recursive): ditto.</p>

<p>Wed Mar  4 00:29:18 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: now can specify shorten form of commands.</p>

<p>Tue Mar  3 23:41:42 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb (Readline.readline): drop untreated control 	  characters.</p>

<p>Tue Mar  3 22:25:24 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/lib/envutil.rb (EnvUtil.invoke_ruby): need to rescue because 	  Signal.signame may raise exception.</p>

<p>Tue Mar  3 16:57:39 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: use &#39;b&#39; instead of &#39;s&#39; for showing 	  Backport options for merger.rb.</p>

<p>Tue Mar  3 16:55:23 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: show selected ticket number at prompt.</p>

<p>Tue Mar  3 14:47:30 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* math.c (num2dbl_with_to_f): direct casting from Rational to double. 	  [Feature #10909]</p>

<p>	* test/ruby/test_math.rb: add tests for the above change.</p>

<p>Tue Mar  3 07:52:20 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* test/ruby/test_symbol.rb: avoid a false positive in AIX.</p>

<p>Tue Mar  3 00:59:39 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* configure.in: set PRELOADENV in Solaris to avoid “wrong ELF class” 	  error. [Bug #10926] [ruby-dev:48888] 	* configure.in: set LIBPATHENV for 32-bit compile in Solaris 	  in addition to 64-bit.</p>

<p>Mon Mar  2 15:36:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in: do not check _setjmp unless _longjmp is available, 	  so that configure results will not be changed by cache.</p>

<p>Mon Mar  2 14:44:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (RUBY_REPLACE_TYPE): restore unsigned type from 	  cached variable only if the target type is not available.</p>

<p>Mon Mar  2 13:04:27 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* signal.c (sig_signame): return nil if the argument is a valid 	  signal number.</p>

<p>Mon Mar  2 12:05:04 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* test/net/ftp/test_ftp.rb (create_ftp_server): set SO_OOBINLINE 	  for receiving OOB data which is sent with MSG_OOB flag in 	  portable way. [Bug #10915] [ruby-dev:48885] 	* test/net/ftp/test_ftp.rb (test_abort, test_status): use gets 	  for receiving OOB data in portable way.</p>

<p>Mon Mar  2 11:43:07 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (RUBY_REPLACE_TYPE): restore unsigned type from 	  cached variable.</p>

<p>Mon Mar  2 06:01:41 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* ext/io/wait/wait.c (io_nread): wrap return value with INT2FIX 	  Thanks to Yura Sokolov &lt;funny.falcon@gmail.com&gt; 	  [ruby-core:68369] [Bug#10923] 	* test/io/wait/test_io_wait.rb (test_nread_buffered): 	  fix broken test</p>

<p>Sun Mar  1 20:21:16 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (RUBY_REPLACE_TYPE): restore convertible type from 	  cached variable, so that configured results will be stable.</p>

<p>Sun Mar  1 18:10:34 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (rb_cv_broken_memmem): check before adding the 	  result HAVE_MEMMEM macro to confdefs.h, so that configured 	  results will be stable.</p>

<p>Sun Mar  1 11:17:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* gc.c (id2ref): prohibit from accessing internal objects. 	  [ruby-core:68348] [Bug #10918]</p>

<p>Sun Mar  1 09:06:11 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/time.rb (strptime): Support %s.%N. 	  [ruby-core:68301] [Bug #10904] Patch by Sadayuki Furuhashi.</p>

<p>Sat Feb 28 17:18:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* enum.c (enum_each_slice, enum_each_cons): limit elements size by 	  the enumerator size.  suggested by Hans Mackowiak &lt;hanmac AT 	  gmx.de&gt; at [ruby-core:68335]</p>

<p>Sat Feb 28 15:44:20 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_dump.c (rb_vm_bugreport): get rid of making new strings 	  inside signal context.</p>

<p>	* variable.c (rb_tmp_class_path): defer making temporary class 	  path string.</p>

<p>	* variable.c (rb_search_class_path): search class path or return 	  Qnil or Qfalse if unnamed, not creating a temporary path.</p>

<p>Sat Feb 28 15:02:02 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* variable.c (rb_tmp_class_path): preserve name encoding of an 	  anonymous instance of module/class subclass.</p>

<p>Sat Feb 28 08:24:30 2015  Rei Odaira  &lt;Rei.Odaira@gmail.com&gt;</p>

<p>	* ext/pty/pty.c: AIX supports autopush. 	  Patch by Perry Smith [ruby-core:58539] [Bug #9144]</p>

<p>Fri Feb 27 22:00:05 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rubygems: Update to RubyGems 2.4.6 and HEAD(800f2e6). 	  Fixed #1159, #1171, #1173 on rubygems/rubygems 	* test/rubygems: ditto.</p>

<p>Fri Feb 27 20:55:42 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rake: Update to rake (9237e74), typo fix and remove needless 	  private syntax. 	* test/rake: ditto.</p>

<p>Fri Feb 27 17:06:44 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_core.h: define vm_svar_index.</p>

<p>	* vm_insnhelper.c, vm.c, compile.c: use vm_svar_index names.</p>

<p>	* iseq.h: remove DEFAULT_SPECIAL_VAR_COUNT. 	  use VM_SVAR_FLIPFLOP_START instead.</p>

<p>Fri Feb 27 13:57:48 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* io.c (setup_narg): wipe away expanded part of buffer to get rid 	  of revealing uncleaned data.  reported by Dongkwan Kim &lt;dkay AT 	  kaist.ac.kr&gt;.</p>

<p>Wed Feb 25 22:25:07 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* spec/default.mspec: use default configuration file name. 	  <a href="https://github.com/ruby/rubyspec/commit/cc69f337b06362e5607ffa3e3ad40ef7494960cf">github.com/ruby/rubyspec/commit/cc69f337b06362e5607ffa3e3ad40ef7494960cf</a></p>

<p>Wed Feb 25 22:21:56 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* spec/default.mspec: remove specific version number. 	  <a href="https://github.com/ruby/rubyspec/commit/7a909e925c1baa9c700bd44af9241aef6e596714">github.com/ruby/rubyspec/commit/7a909e925c1baa9c700bd44af9241aef6e596714</a></p>

<p>Wed Feb 25 22:04:04 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/win32/Win32API.rb (initialize): accept both a string and an array 	  for the arguments of the imported function. 	  reported by Aaron Stone [ruby-core:68208] [Bug #10876] [Fixes GH-835]</p>

<p>Wed Feb 25 18:12:11 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* signal.c (sighandler): preserve errno 	  Patch by Steven Stewart-Gallus &lt;sstewartgallus00@mylangara.bc.ca&gt; 	  [ruby-core:68172] [Bug #10866]</p>

<p>Wed Feb 25 15:59:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (push_pattern, push_glob): make globbed file names same 	  encoding to the given pattern.</p>

<p>Wed Feb 25 15:27:16 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* tool/merger.rb: support 2.1+ versioning scheme.</p>

<p>Tue Feb 25 08:49:12 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* lib/cmath.rb (log): raise ArgumentError when more than 2 arguments 	  are passed. [ruby-core:66143] [Bug #10487]</p>

<p>Tue Feb 25 02:15:17 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_math.rb: Use assert_infinity instead of assert_equal(1.0/0, …).</p>

<p>	* test/ruby/test_math.rb: Add tests for overriding Integer#to_f. 	  [ruby-core:67919] [Misc #10809]</p>

<p>Tue Feb 24 22:58:48 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* complex.c (nucomp_mul): calculate as rotation in complex plane 	  if matrix calculation resulted in NaN.</p>

<p>Tue Feb 24 21:45:39 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_math.rb(test_cbrt): Add an assertion for Math.cbrt(1.0/0) 	  and move #test_cbrt to more proper place.</p>

<p>Tue Feb 24 19:09:25 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* vm_insnhelper.c (lep_svar_place, lep_svar_get): do not create 	  additional T_NODE object (svars holder) when only getting 	  svars.</p>

<p>Tue Feb 24 11:49:48 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* time.c (time_zone_name): should be US-ASCII only if all 7-bits, 	  otherwise locale encoding.  [ruby-core:68230] [Bug #10887]</p>

<p>Tue Feb 24 09:47:07 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (chompped_length): enable smart chomp for all non-dummy 	  encoding strings, not only default_rs. 	  [ruby-core:68258] [Bug #10893]</p>

<p>Mon Feb 23 23:19:42 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/vcs.rb (IO.popen): support <code>:chdir</code> option.</p>

<p>	* tool/vcs.rb (VCS::GIT.get_revisions): use <code>:chdir</code> option instead 	  of -C option which is not supported by older git. 	  [ruby-dev:48880] [Bug #10890]</p>

<p>Mon Feb 23 15:26:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* string.c (rb_str_split_m): raise ArgumentError at broken string 	  not RegexpError, as Regexp is not involved in. 	  [ruby-core:68229] [Bug #10886]</p>

<p>Mon Feb 23 07:25:29 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* time.c: Zone encoding should be US-ASCII if all 7-bits. Fix r46907.</p>

<p>	* test/ruby/test_time.rb, test/ruby/test_time_tz.rb: Update tests.</p>

<p>Sun Feb 22 18:33:42 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* common.mk: use ruby organization for rubyspec.</p>

<p>Sun Feb 22 15:56:06 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* vm_insnhelper.c (rb_vm_rewrite_cref_stack): copy nd_refinements 	  of original crefs. It fixes segmentation fault when calling 	  refined method in duplicate module. [ruby-dev:48878] [Bug #10885]</p>

<p>	* vm_core.h, class.c: change accordingly.</p>

<p>	* test/ruby/test_refinement.rb: add a test for above.</p>

<p>Sun Feb 22 10:43:37 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* gc.c (rb_objspace_call_finalizer): control GC execution during 	  force firnalizations at the end of interpreter process. 	  [Bug #10768]</p>

<p>	  1) Prohibit incremental GC while running Ruby-level finalizers 	     to avoid any danger. 	  2) Prohibit GC while invoking T_DATA/T_FILE data structure 	     because these operations break object relations consistency.</p>

<p>	  This patch can introduce another memory consuming issue because 	  Ruby-level finalizers can run after (2), GC is disabled. 	  However, basically object consistency was broken at (2) as I 	  described above. So that running Ruby-level finalizers contains 	  danger originally. Because of this point, I need to suggest to 	  remove these 3 lines (invoking remaining finalizers). And add a 	  rule to add that finalizers should not add new finalizers, or 	  say there is no guarantee to invoke finalizers that added by 	  another finalizer.</p>

<p>Sun Feb 22 04:07:05 2015  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>	* ext/openssl/ossl_asn1.c: [DOC] RDoc formatting fixes for 	  ASN1::ObjectId with patch from @vbatts [Fixes GH-834]</p>

<p>	* ext/openssl/ossl_bn.c: ditto.</p>

<p>Sat Feb 21 19:51:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* re.c (match_aref): RMatch::regexp is Qnil after matching by a 	  string since r45451.  [ruby-core:68209] [Bug #10877]</p>

<p>Sat Feb 21 16:18:42 2015  Stefan Schuler  &lt;mail@stefanschuessler.de&gt;</p>

<p>	* compar.c (Init_Comparable): [DOC] Replace camelcase variable name. 	  [Fix GH-833]</p>

<p>Fri Feb 20 17:27:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* file.c (rb_file_identical_p): fix handle leak, ensure to close 	  the handle of the first argument.</p>

<p>Fri Feb 20 17:19:23 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (different_device_p): compare by volume serial 	  numbers, not by path names.  [ruby-core:68162] [Bug #10865]</p>

<p>Thu Feb 19 01:58:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/file.c (rb_file_expand_path_internal): neither the drive 	  of base directory nor the current drive are involved in the 	  result if different than the drive of path. 	  [ruby-core:68130] [Bug #10858]</p>

<p>Wed Feb 18 10:48:56 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/win32.c (wrename): return EXDEV if moving a directory to 	  another drive, since MoveFileExW does not set proper error code. 	  [ruby-core:68162] [Bug #10865]</p>

<p>Wed Feb 18 03:13:52 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych.rb: bump psych version. 	* ext/psych/psych.gemspec: ditto 	* ext/psych/yaml/scanner.c: add latest libyaml change. 	* test/psych/helper.rb: support newer minitest 	* test/psych/test_to_yaml_properties.rb: ditto</p>

<p>Tue Feb 17 11:47:17 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/resolv.rb (Resolv::DNS::Resource#==, #hash): elements 	  returned by Kernel#instance_variables are Symbols now. 	  [ruby-core:68128] [Bug #10857]</p>

<p>Tue Feb 17 10:59:10 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/syntax/calling_methods.rdoc: Fix documentation for “calling_methods” 	  Patch by @sos4nt [fix GH-830][ci skip]</p>

<p>Tue Feb 17 10:53:29 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* win32/file.c (rb_file_expand_path_internal): do not make invalid 	  (or ADS) path if the path has a drive letter, the result also 	  should have be under it.  [ruby-core:68130] [Bug #10858]</p>

<p>Tue Feb 17 10:47:20 2015  Iain Beeston  &lt;iain.beeston@gmail.com&gt;</p>

<p>	* hash.c: Added docs to explain that #include? and #member? do not 	  check member equality 	* lib/set.rb: ditto</p>

<p>Mon Feb 16 20:58:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* compile.c (compile_massign): optimization for special case, 	  assignments by aset or attrset. 	  <a href="http://kokizzu.blogspot.jp/2015/02/c-java-hhvm-ruby-nodejsrhinojscspidermo.html">kokizzu.blogspot.jp/2015/02/c-java-hhvm-ruby-nodejsrhinojscspidermo.html</a> 	  <a href="http://www.atdot.net/~ko1/diary/201502.html#d16">www.atdot.net/~ko1/diary/201502.html#d16</a></p>

<p>Sun Feb 15 10:41:23 2015  Sho Hashimoto  &lt;sho-h@ruby-lang.org&gt;</p>

<p>	* doc/standard_library.rdoc: [DOC] delete removed libraries. 	  [misc #10843] [ci skip]</p>

<p>Sat Feb 14 12:20:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* random.c (rand_random_number): add a method to return a random 	  number like SecureRandom to Random::Formatter.</p>

<p>	* lib/securerandom.rb (random_bytes): move to Random::Formatter, 	  the base method of the module.</p>

<p>Sat Feb 14 12:01:32 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* random.c (random_raw_seed): extract platform dependent random 	  seed initialization function as a new method Random.raw_seed.</p>

<p>	* lib/securerandom.rb (SecureRandom): use Random.raw_seed.</p>

<p>Sat Feb 14 00:49:37 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/coverage/coverage.c: Add Coverage.peek_result.  Allows you to 	  capture coverage information without stopping the coverage tool. 	  [ruby-core:67940] [Feature #10816]</p>

<p>	* test/coverage/test_coverage.rb: test for change.</p>

<p>Fri Feb 13 21:52:05 2015  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>	* string.c (str_discard): does not free for STR_NOFREE string. 	  [Bug #<a href="ruby-core:68110">10853]</a></p>

<p>	* bootstraptest/test_string.rb: test for above.</p>

<p>Fri Feb 13 21:16:00 2015  Yusuke Endoh  &lt;mame@tsg.ne.jp&gt;</p>

<p>	* lib/base64.rb: make urlsafe mode user-friendly.</p>

<p>	* lib/base64.rb (Base64.urlsafe_encode64): a new option “padding” to 	  suppress the padding character (“=”).</p>

<p>	* lib/base64.rb (Base64.urlsafe_decode64): now it accepts not only 	  correctly-padded input but also unpadded input. 	  [Feature #<a href="ruby-core:67570">10740]</a></p>

<p>	* test/base64/test_base64.rb: Test for above</p>

<p>Fri Feb 13 14:19:06 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/json: merge upstream from flori/json 	  change usage of TypedData. [Feature #<a href="ruby-core:67564">10739]</a></p>

<p>Thu Feb 12 18:34:01 2015  multisnow  &lt;infinity.blick.winkel@gmail.com&gt;</p>

<p>	* ext/openssl/extconf.rb: check RAND_edg to support libressl.</p>

<p>	* ext/openssl/ossl_rand.c (ossl_rand_egd): define only if RAND_edg 	  is available.  [Fix GH-829]</p>

<p>Thu Feb 12 10:46:14 2015  Eric Hodel  &lt;drbrain@segment7.net&gt;</p>

<p>	* proc.c (proc_call):  Improve Proc#call documentation.  Patch by 	  Hsing-Hui Hsu.  [fix GH-761]</p>

<p>Thu Feb 12 04:33:02 2015  Benoit Daloze  &lt;eregontp@gmail.com&gt;</p>

<p>	* compar.c (cmp_equal): no more error hiding for Comparable#==. 	  It now behaves as other Comparable methods. See #7688.</p>

<p>	* test/ruby/test_comparable.rb: update related test.</p>

<p>Thu Feb 12 03:28:05 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/set.rb (initialize): internal hash defaults to false</p>

<p>	* lib/set.rb (include?): use Hash#[] for optimized dispatch. 	  Patch by Ismael Abreu &lt;ismaelga@gmail.com&gt; 	  [ruby-core:67664] [Misc #10754]</p>

<p>Wed Feb 11 11:09:52 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/digest/digest_conf.rb (digest_conf): check for CommonDigest.</p>

<p>	* ext/digest/*/*cc.h: for Apple CommonCrypto/CommonDigest.h.</p>

<p>	* ext/digest/digest.h (DEFINE_FINISH_FUNC_FROM_FINAL): macro for 	  finish functions, by inverting arguments order.</p>

<p>	* ext/digest/digest_conf.rb (digest_conf): extract common 	  configurations.</p>

<p>Wed Feb 11 11:01:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/json/generator/generator.c (generate_json): get rid of 	  unnecessary recursive calls which can cause infinite recursion. 	  T_STRING may not have rb_cString.</p>

<p>Wed Feb 11 07:53:35 2015  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* test/win32ole/test_word.rb: use skip method to skip test.</p>

<p>Tue Feb 10 11:38:28 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_insnhelper.c (vm_call_method): stop method search when a method 	  is not found in a refinement, to support undef in refinements. 	  [ruby-core:66741] [Bug #10578]</p>

<p>Tue Feb 10 11:19:11 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* lib/net/ftp.rb (chdir, delete, gettextfile, mdtm, mkdir, nlst, 	  putbinaryfile, puttextfile, rename, rmdir, size): support 	  Pathname. Patch by Joe Rafaniello. [fix GH-828]</p>

<p>Mon Feb  9 16:36:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/make-snapshot (package): get rid of loading unbundled and 	  unexpected libraries.  [ruby-core:67977] [Bug #10822]</p>

<p>Sun Feb  8 20:09:37 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/net/http/header.rb: pass header names as symbols. 	  Patch by @DamirSvrtan [fix GH-805] 	* test/net/http/test_httpheader.rb: added test.</p>

<p>Sun Feb  8 13:04:25 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/socket/getaddrinfo.c (get_addr): reject too long hostname to 	  get rid of GHOST vulnerability on very old platforms.</p>

<p>	* ext/socket/raddrinfo.c (make_hostent_internal): ditto, paranoic 	  check for the canonical name.</p>

<p>Sun Feb  8 12:48:38 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/win32/lib/win32/registry.rb (Win32::Registry::API): use wide 	  versions of RegDeleteValue and RegDeleteKey. 	  [ruby-core:67958] [Bug #10820]</p>

<p>Sat Feb  7 22:13:08 2015  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* test/win32ole/test_win32ole_record.rb: remove test using .NET 	  Framework 3.5 because it is not included in Windows 8/8.1.</p>

<p>Sat Feb  7 19:25:25 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (has_magic): always get long path name on Windows even if 	  no tilde is there.  [ruby-core:68011] [Bug #10819]</p>

<p>	* dir.c (replace_real_basename): FindFirstFile ignore redirection 	  character, check if exists before call it.  cf. [Bug #8597]</p>

<p>Sat Feb  7 13:30:11 2015  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* test/win32ole/test_win32ole_record.rb 	  (test_ole_instance_variable_get): correct VT_RECORD type and 	  instance variables.</p>

<p>Fri Feb  6 17:47:05 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych/visitors/yaml_tree.rb: register nodes when 	  dumping objects with custom coders. [ruby-core:66215] [Bug #10496]</p>

<p>	* test/psych/test_coder.rb: test for fix</p>

<p>Fri Feb  6 16:58:31 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych/visitors/to_ruby.rb: fix support for regular 	  expressions with newlines. tenderlove/psych#222</p>

<p>	* test/psych/test_yaml.rb: test for change.</p>

<p>Fri Feb  6 10:31:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_core.h (rb_call_info_kw_arg_struct): make keywords a symbols 	  list to get rid of inadvertent creation by variable keyword 	  arguments.  [ruby-core:68031] [Bug #10831]</p>

<p>Thu Feb  5 22:42:34 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rubygems:  Update to RubyGems HEAD(5c3b6f3). 	  Fixed #1156, #1142, #1115, #1142, #1139 on rubygems/rubygems 	* test/rubygems:  ditto.</p>

<p>Thu Feb  5 13:41:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_eval.c (send_internal), vm_insnhelper.c (vm_call_opt_send): 	  convert String method name into a Symbol, as method_missing 	  method expects its first argument to be a Symbol.  [Bug #10828]</p>

<p>	* vm_insnhelper.c (ci_missing_reason): return the reason of method 	  missing in call info.</p>

<p>	* vm_insnhelper.c (vm_call_opt_send): re-apply r49500 with the 	  proper missing reason.  [Bug #10828]</p>

<p>Thu Feb  5 10:31:46 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* class.c (rb_obj_singleton_methods): should use RTEST() to convert 	  VALUE to int.</p>

<p>Thu Feb  5 03:59:33 2015  Marc-Andre Lafortune  &lt;ruby-core@marc-andre.ca&gt;</p>

<p>	* vm_insnhelper.c: Fix symbol leak with <code>send</code> [Bug #10828]</p>

<p>Wed Feb  4 20:26:54 2015  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* ext/win32ole/win32ole.c (Init_win32ole): should not use atexit to 	  free allocated hash table to avoid error on Cygwin.</p>

<p>Wed Feb  4 15:34:25 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* class.c (method_entry_i, class_instance_method_list, 	  rb_obj_singleton_methods): should not include methods of 	  superclasses if recur is false. [ruby-dev:48854] [Bug #10826]</p>

<p>Wed Feb  4 16:32:40 2015  Matt Hoyle  &lt;matt@deployable.co&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c (VpSetPTR): fix a typo, &#39;expoennt&#39; 	  to &#39;exponent&#39;.  [ruby-core:67980] [Bug #10823] [Fix GH-825]</p>

<p>Wed Feb  4 15:55:38 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/sdbm/_sdbm.c: include ruby/ruby.h for PRIdPTRDIFF when a 	  macro <code>DEBUG</code> is defined.  based on the patch by Owen Rodley in 	  [ruby-core:67987]. [Bug #10825]</p>

<p>Wed Feb  4 11:12:43 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* Makefile.in (probes.stamp): rebuild dtrace dependent objects 	  only when `dtrace -G` modifies its input files.</p>

<p>Tue Feb  3 19:27:16 2015  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* common.mk (ruby-glommed.o): dependency on $(OBJ) should be written 	  in common.mk (in which OBJ is defined) because of Makefile include 	  and parse order. This partly reverts r49419. 	  [ruby-dev:48849] [Bug #10808]</p>

<p>	* Makefile.in (ruby-glommed.o): ditto.</p>

<p>	* Makefile.in (ruby-glommed.o): remove excess $(DTRACE_OBJ) because 	  it is included in $(OBJS) since r49451.</p>

<p>	* Makefile.in (probes.o): should depend on $(DTRACE_DEPENDENT_OBJS)</p>

<p>Tue Feb  3 17:15:45 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/mkmf.rb (try_cppflags, try_cflags, try_ldflags): get rid of 	  interference by modifying global variables in have_devel? method. 	  [ruby-core:67962] [Bug #10821]</p>

<p>Tue Feb  3 15:23:58 2015  Shugo Maeda  &lt;shugo@ruby-lang.org&gt;</p>

<p>	* vm_method.c (remove_method): When remove refined 	  method, raise a NameError if the method is not 	  defined in refined class.</p>

<p>	  But if the method is defined in refined class, 	  it should keep refined method and remove original 	  method.</p>

<p>	  Patch by Seiei Higa. [ruby-core:67722] [Bug #10765]</p>

<p>Tue Feb  3 14:04:47 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (glob_helper): obtain real name with FindFirstFile API 	  instead of matching all entries, on Windows. 	  [ruby-core:67954] [Bug #10819]</p>

<p>Tue Feb  3 12:26:35 2015  Katsuhiko Nishimra  &lt;ktns.87@gmail.com&gt;</p>

<p>	* lib/mkmf.rb (configuration): set the default cxxflags, which is 	  referred from the default CXXFLAGS, for extension libraries. 	  [Fix GH-823]</p>

<p>Tue Feb  3 05:52:00 2015  Aman Gupta &lt;ruby@tmm1.net&gt;</p>

<p>	* gc.c (rb_objspace_free): cause rb_bug if lazy sweep is in progress 	  during rb_objspace_free. Adds extra protection for r46340. 	  Patch by Vicent Marti. [Bug #10768] [ruby-core:67734] 	* gc.c (rb_objspace_call_finalizer): Ensure GC is completed after 	  finalizers have run. We already call gc_rest() before invoking 	  finalizers, but finalizer can allocate new objects and start new GC 	  cycle, so we call gc_rest() again after finalizers are complete.</p>

<p>Mon Feb  2 10:51:34 2015  Ari Pollak  &lt;ajp@aripollak.com&gt;</p>

<p>	* doc/security.rdoc (Symbols): update about Symbol GC.  Symbols 	  explicitly converted from Strings now can be collected, but 	  reflection/metaprogramming still can cause memory flooding. 	  [Fix GH-725]</p>

<p>Sun Feb  1 13:46:52 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/rbinstall.rb (bin-comm): drop batch file installation. 	  Windows 95 support has not been supported already. 	  [Feature #10806]</p>

<p>Sat Jan 31 12:06:23 2015  Scott Francis  &lt;scott.francis@shopify.com&gt;</p>

<p>	* thread_pthread.c (reserve_stack): fix intermittent SIGBUS on 	  Linux, by reserving the stack virtual address space at process 	  start up so that it will not clash with the heap space. 	  [Fix GH-822]</p>

<p>Fri Jan 30 17:28:29 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* math.c (num2dbl_with_to_f): make faster when Bignum passed by 	  direct conversion using rb_big2dbl().  [Feature #10800]</p>

<p>Thu Jan 29 23:30:00 2015  Kenta Murata  &lt;mrkn@mrkn.jp&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c (rb_rational_num): add fallback function 	  for rubies lower than 2.2.0.</p>

<p>	* ext/bigdecimal/bigdecimal.c (rb_rational_den): ditto.</p>

<p>	* ext/bigdecimal/extconf.rb: check the existences of struct RRational, 	  rb_rational_num, and rb_rational_den.</p>

<p>	* ext/bigdecimal/bigdecimal.bundle: bump version.</p>

<p>Thu Jan 29 20:28:25 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* tool/make-snapshot: removed md5 digest with package information</p>

<p>Thu Jan 29 10:41:52 2015  Kazuki Tanaka  &lt;gogotanaka@ruby-lang.org&gt;</p>

<p>	* math.c (Get_Double): direct casting from Fixnum to double. 	  [Feature #10785]</p>

<p>Thu Jan 29 02:34:27 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych/visitors/to_ruby.rb: fix parsing hashes with 	  instance variables when it is referenced multiple times. 	* ext/psych/lib/psych.rb: bump version 	* ext/psych/psych.gemspec: bump version 	* test/psych/test_hash.rb: test for fix</p>

<p>Thu Jan 29 02:06:09 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* thread.c (struct join_arg): restructure and make smaller 	  (thread_join_sleep): avoid timeofday() call if forever 	  (thread_join): pass join_arg.delay directly 	  (rb_thread_inspect_msg): remove, inline into rb_thread_inspect 	  (rb_thread_inspect): reduce branching and string creation 	* thread_pthread.c (native_set_thread_name): create string directly 	  to avoid reparsing. [Misc #10723]</p>

<p>Wed Jan 28 21:32:24 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* thread.c: Improve documentation for Thread#value 	  [Bug #<a href="ruby-core:67324">10694]</a>[ci skip]</p>

<p>Tue Jan 27 16:04:19 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: added <code>!</code> command.</p>

<p>Tue Jan 27 15:58:23 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: added history feature for platforms which 	  lack readline.</p>

<p>Mon Jan 26 22:09:35 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* .gitignore: ignored temporary file with git.</p>

<p>Mon Jan 26 18:06:03 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* misc/ruby-electric.el: Import version 2.2.2 from 	  <a href="https://github.com/knu/ruby-electric.el">github.com/knu/ruby-electric.el</a>.</p>

<p>Mon Jan 26 11:37:49 2015  Dave Stevens  &lt;dave@crowdlab.com&gt;</p>

<p>	* string.c (str_make_independent_expand): terminate String when 	  moved from heap to embedded.  [Fix GH-821].</p>

<p>Sun Jan 25 12:04:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (flatten): no need to call to_ary method on elements 	  beyond the given level.  [ruby-core:67637] [Bug #10748]</p>

<p>Sun Jan 25 00:42:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/fiddle/win32/libffi.mk.tmpl: assemble without directory prefix. 	  workaround of a bug of VC12 ml, by unak at [ruby-core:67792]. 	  [ruby-core:67789] [Bug #10780]</p>

<p>Sat Jan 24 19:56:25 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dln_find.c (dln_find_1): search regular files only.  based on 	  the patch by Alex Coomans in [ruby-core:67766].  [Bug #10776]</p>

<p>Fri Jan 23 23:57:05 2015  Misumi Rize  &lt;r@ayase-e.li&gt;</p>

<p>	* vm_insnhelper.c (vm_throw_start): search the target to break 	  from a block with nested rescue, from the nested blocks. 	  [ruby-core:67765] [Bug #10775] [Fix GH-820]</p>

<p>Fri Jan 23 20:00:59 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* marshal.c (w_object, marshal_dump): use identity tables for 	  arbitrary VALUE keys, because of performance of FLONUM. 	  [Bug #10761]</p>

<p>	* marshal.c (obj_alloc_by_klass, marshal_load): ditto.</p>

<p>Fri Jan 23 17:12:33 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* benchmark/bm_marshal_dump_flo.rb: new benchmark for [Bug #10761]</p>

<p>Thu Jan 22 18:03:19 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb (find_svn_log): use double quotes instead 	  of single quotes because cmd.exe doesn&#39;t handle them.</p>

<p>	* tool/redmine-backporter.rb (done): the 2nd element of matched data 	  is the offset of the end of matched string, not length.</p>

<p>Thu Jan 22 16:45:24 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* st.c (st_numhash): mix float value for flonum 	* hash.c (rb_any_hash): ditto 	* benchmark/bm_hash_aref_flo.rb: new benchmark 	* benchmark/bm_hash_ident_flo.rb: ditto 	  [Bug #10761]</p>

<p>Wed Jan 21 22:33:51 2015  Akinori MUSHA  &lt;knu@iDaemons.org&gt;</p>

<p>	* misc/ruby-electric.el: Import version 2.2.1 from 	  <a href="https://github.com/knu/ruby-electric.el">github.com/knu/ruby-electric.el</a>.  Improve compatibility 	  with and optimize for Emacs 24.4.</p>

<p>Wed Jan 21 09:40:52 2015  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>	* file.c: Document other cases of missing birthtime on OS with patch 	  provided by @sho-h similar to GH-817. [ci skip] [DOC]</p>

<p>Wed Jan 21 09:09:19 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* NEWS: References to tickets added. 	  [ruby-core:67701] [Bug #10760] Suggested by Zachary Scott.</p>

<p>Tue Jan 20 22:59:54 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* tool/vcs.rb: fix the exception given remote-url of svn.</p>

<p>Tue Jan 20 12:58:33 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: now can change the page of <code>ls</code>.</p>

<p>Tue Jan 20 12:28:37 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb (readline): fallback to normal gets on 	  Windows because IO.console.getch is not always do as expected.</p>

<p>Tue Jan 20 11:31:07 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: update usage.</p>

<p>Tue Jan 20 11:23:47 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb (mygets): to support Backspace 	  implement gets by itself.</p>

<p>Tue Jan 20 02:54:11 2015  Zachary Scott  &lt;e@zzak.io&gt;</p>

<p>	* file.c: NotImplementedError is raised if birthtime is unavailable. 	  Patch by @y-yagi san and [Fixes GH-817] [ci skip] [DOC]</p>

<p>	* ext/pathname/pathname.c: ditto.</p>

<p>Mon Jan 19 22:08:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* class.c (include_modules_at): allow to prepend each module up to 	  once for each classe.  [EXPERIMENTAL]</p>

<p>Sun Jan 18 18:32:20 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* math.c (math_atan2): revive documentation before r49220. 	  <a href="http://d.hatena.ne.jp/nagachika/20150112/ruby_trunk_changes_49213_49226">d.hatena.ne.jp/nagachika/20150112/ruby_trunk_changes_49213_49226</a></p>

<p>Sun Jan 18 15:57:32 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>	* vm_method.c (check_definition): Module#public_method_defined?, 	  Module#private_method_defined?, Module#protected_method_defined? 	  should not use refinements. [ruby-core:67656] [Bug #10753]</p>

<p>Sun Jan 18 15:50:39 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_dump.c (rb_vm_bugreport): check by configured result instead 	  of system name for old FreeBSD.  based on a patch by Steve Wills 	  at [ruby-core:67655].  [Bug #10752]</p>

<p>Sun Jan 18 12:56:49 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* Makefile.in (VPATH, NEWLINE_C), common.mk (common-srcs): make 	  and use newline.c under enc/trans directory, not toplevel.  no 	  longer search enc directory implicitly.</p>

<p>	* configure.in, enc/Makefile.in (BUILTIN_ENCS, BUILTIN_TRANSES): 	  prefix respective directory names to builtin encodings and 	  transcoder source names.</p>

<p>Sun Jan 18 11:49:46 2015  Masaki Suketa &lt;masaki.suketa@nifty.ne.jp&gt;</p>

<p>	* ext/win32ole/win32ole.c (ole_invoke): avoid SEGV when VT_RECORD 	  variable is passed by reference. [ruby-dev:48803] [Bug #10697]</p>

<p>Sat Jan 17 23:59:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/psych/lib/psych/visitors/yaml_tree.rb (visit_String): 	  anchors like <code>Z</code> are not valid inside character class.  use 	  negative-lookahead instead. 	  Fixes: <a href="https://github.com/tenderlove/psych/issues/221">github.com/tenderlove/psych/issues/221</a></p>

<p>Sat Jan 17 23:42:27 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in: get rid of pattern substitution, which is not 	  supported by ash, and ash on NetBSD parses whole source first 	  and fails to start.  [ruby-dev:48823] [Bug #10750]</p>

<p>Fri Jan 16 18:42:58 2015  NARUSE, Yui  &lt;naruse@ruby-lang.org&gt;</p>

<p>	* tool/redmine-backporter.rb: support adding related revisions 	  to issues.</p>

<p>Fri Jan 16 17:20:33 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	vm.c, vm_core.h: constify VM_CF_LEP, VM_CF_PREV_EP, VM_CF_BLOCK_PTR 	and rb_vm_control_frame_block_ptr.</p>

<p>Fri Jan 16 15:41:21 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych.rb: bump version</p>

<p>	* ext/psych/psych.gemspec: ditto</p>

<p>Fri Jan 16 15:37:49 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych/visitors/yaml_tree.rb: only dump hash 	  subclasses. Thanks Joe Eli McIlvain &lt;joe.eli.mac@gmail.com&gt;</p>

<p>	* test/psych/test_hash.rb: test for change</p>

<p>Fri Jan 16 15:35:21 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych.rb: bump version</p>

<p>	* ext/psych/lib/psych/visitors/yaml_tree.rb: fix line width wrapping 	  for long strings.  Thanks Jakub Jirutka &lt;jakub@jirutka.cz&gt;</p>

<p>	* test/psych/test_string.rb: test for change</p>

<p>Fri Jan 16 11:44:44 2015  Kazuki Tsujimoto  &lt;kazuki@callcc.net&gt;</p>

<p>	* eval_intern.h, vm.c, vm_eval.c, vm_insnhelper.c: 	  change throw mechanism (not save target ep, but save target cfp). 	  It fixes `unexpected break&#39; bug that occurs when 	  TracePoint#binding is called. 	  [ruby-dev:48797] [Bug #10689]</p>

<p>	* test/ruby/test_settracefunc.rb: add a test.</p>

<p>Thu Jan 15 23:55:15 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* io.c (rb_io_close_m): Don&#39;t raise when the IO object is closed. 	  [ruby-core:67444] [Feature #10718]</p>

<p>Thu Jan 15 21:34:57 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>	* proc.c (rb_obj_singleton_method): Kernel#singleton_method should 	  not use refinements, as well as Kernel#method. 	  [ruby-core:67603] [Bug #10744]</p>

<p>Thu Jan 15 10:45:04 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_select_bang, ary_reject_bang): linear 	  performance.  [ruby-core:67418] [Feature #10714]</p>

<p>Wed Jan 14 18:06:06 2015  Martin Duerst  &lt;duerst@it.aoyama.ac.jp&gt;</p>

<p>	* lib/uri/mailto.rb: raising URI::InvalidComponentError instead 	  of failing with undefined method `split&#39; for nil:NilClass for 	  mailto: URIs without opaque part. [Bug #10738] 	* test/uri/testuri.rb: Test for above</p>

<p>Wed Jan 14 16:45:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* tool/downloader.rb (RubyGems.download): verify downloaded gem 	  packages.  LowSecurity to allow untrusted certificates now.</p>

<p>Wed Jan 14 15:43:48 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/readline/readline.c (readline_s_refresh_line): initialize 	  before rl_refresh_line(), as some function make the internal 	  state non-clean but rl_refresh_line() does not re-initialize it. 	  [ruby-core:43957] [Bug #6232]</p>

<p>Tue Jan 13 21:59:24 2015  Michal Papis  &lt;mpapis@gmail.com&gt;</p>

<p>	* tool/rbinstall.rb (gem): fix changing permissions of installed 	  bundled gems.  [Fix GH-812]</p>

<p>Tue Jan 13 21:57:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* common.mk (distclean-local): remove autom4te.cache generated by 	  autoconf.</p>

<p>	* common.mk (realclean-local): remove id sources and dummy header 	  for dtrace.  [ruby-core:67562] [Bug #10737]</p>

<p>Tue Jan 13 21:08:22 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/json, test/json: merge JSON HEAD(259dee6) 	  separate implementation of Typed_Data macro. 	  <a href="https://github.com/flori/json/compare/v1.8.1...v1.8.2">github.com/flori/json/compare/v1.8.1…v1.8.2</a></p>

<p>Tue Jan 13 14:16:35 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/net/http/test_http.rb: get rid of accessing DNS actually 	  for some servers returning wrong results. 	  [ruby-core:67454] [Bug #10721]</p>

<p>Mon Jan 12 23:21:57 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* gems/bundled_gems: update test-unit to 3.0.9.</p>

<p>Mon Jan 12 18:35:44 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* numeric.c (bit_coerce): use original value for error message 	  [ruby-core:67405] [Bug #10711] 	* test/ruby/test_numeric.rb (test_coerce): check error message</p>

<p>Mon Jan 12 18:01:24 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/rdoc/text.rb (expand_tabs): get rid of infinite loop with 	  CR.  should check if substitution occurred too. 	  [ruby-dev:48813] [Bug #10732]</p>

<p>Mon Jan 12 16:45:46 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>	* vm_method.c (rb_alias): raise a NameError when creating alias to 	  a refined method if the original method of the refined method is 	  not defined.  [ruby-core:67523] [Bug #10731]</p>

<p>Mon Jan 12 13:53:17 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* math.c (math_atan2): improve documentation. 	  [Feature #<a href="ruby-core:65400">10323]</a>[ci skip]</p>

<p>Mon Jan 12 13:50:49 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/bigdecimal/bigdecimal.c: fixes documentation like labeled lists, 	  code examples etc. [ruby-core:66730][Bug #10576][ci skip]</p>

<p>Mon Jan 12 13:36:44 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/optparse.rb: improvements for OptionParser documentation. 	  [misc #<a href="ruby-core:66901">10608]</a>[ci skip]</p>

<p>Mon Jan 12 13:33:52 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* array.c (rb_ary_each): documented return value. 	  [misc #<a href="ruby-core:66063">10469]</a></p>

<p>Sun Jan 11 15:11:38 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/webrick/test_utils.rb (test_create_listeners): use 	  dynamically chosen port number, not hardcoded port number. 	  [ruby-core:67508]</p>

<p>Sat Jan 10 12:57:12 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/zlib/zlib.c: fix document of method signatures. 	  [Bug #<a href="ruby-core:67186">10668]</a>[ci skip]</p>

<p>Sat Jan 10 12:32:44 2015  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* eval_error.c (error_print): pos and len parameters of rb_str_substr() 	  are counted by characters, not bytes.  use rb_str_subseq() instead. 	  [Bug #10727] [ruby-core:67473]</p>

<p>Sat Jan 10 10:58:55 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* complex.c: removed commented-out code.</p>

<p>Sat Jan 10 10:57:19 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* rational.c: removed commented-out code. 	  [Feature #<a href="ruby-core:65643">10376]</a></p>

<p>Sat Jan 10 10:12:15 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* array.c (rb_ary_select_bang): keep the array consistent by 	  removing unselected values soon.  [ruby-dev:48805] [Bug #10722]</p>

<p>Fri Jan  9 23:20:04 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/rubygems:  Update to RubyGems HEAD(e53c54a). 	* test/rubygems:  ditto.</p>

<p>Fri Jan  9 11:13:01 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (assocs, assoc): eliminate splatting empty literal 	  hashes.  [ruby-core:67446] [Bug #10719]</p>

<p>	* compile.c (compile_array_): support splatted hash in hash type.</p>

<p>Fri Jan  9 10:57:09 2015  Vit Ondruch  &lt;vondruch@redhat.com&gt;</p>

<p>	* configure.in (RUBY_SETJMP_TYPE): Remove superfluous semicolon 	  which causes a syntax error with autoconf 2.63. 	  [ruby-core:67429] [Bug #10716]</p>

<p>Fri Jan  9 07:23:32 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych/visitors/yaml_tree.rb: correctly quote non-ascii 	  letters. Thanks @jirutka for the patch.</p>

<p>	* test/psych/test_string.rb: test for change</p>

<p>Fri Jan  9 07:13:55 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych/visitors/to_ruby.rb: call <code>allocate</code> on hash 	  subclasses.  Fixes github.com/tenderlove/psych/issues/196</p>

<p>	* test/psych/test_hash.rb: test for change</p>

<p>Fri Jan  9 06:58:43 2015  Aaron Patterson &lt;aaron@tenderlovemaking.com&gt;</p>

<p>	* ext/psych/lib/psych/visitors/to_ruby.rb: revive hashes with ivars</p>

<p>	* ext/psych/lib/psych/visitors/yaml_tree.rb: dump hashes with ivars. 	  Fixes github.com/psych/issues/43</p>

<p>	* test/psych/test_hash.rb: test for change</p>

<p>Thu Jan  8 17:05:00 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>	* vm_method.c (rb_method_entry): if no super class, no original 	  method entry.  [ruby-core:67389] [Bug #10707]</p>

<p>Thu Jan  8 16:31:43 2015  Seiei Higa  &lt;hanachin@gmail.com&gt;</p>

<p>	* vm_method.c (rb_export_method): bail out if the original method 	  is undefined when the method is refined. 	  [ruby-core:67387] [Bug #10706]</p>

<p>Thu Jan  8 12:53:44 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (glob_helper): match in case-folding only if the directory 	  resides on a case-insensitive file system, on OSX. 	  [ruby-core:67364] [Bug #10700]</p>

<p>Thu Jan  8 11:39:18 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* .travis.yml: Remove redundant configuration option. 	  [fix GH-809] Patch by @gxworld</p>

<p>Thu Jan  8 07:17:14 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* lib/resolv.rb: consider ENETUNREACH as ResolvTimeout 	  [ruby-core:67411] [Bug #10712]</p>

<p>Thu Jan  8 00:13:52 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/open3.rb: Open3 properly passes non-keyword hash args to spawn. 	  Fixed by Josh Cheek.  [Fix GH-808] 	  Related to [ruby-core:67347] [Bug #10699]</p>

<p>Wed Jan  7 19:19:26 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (dir_initialize): workaround of opendir failure at symlink 	  directories on Windows via CIFS.</p>

<p>Wed Jan  7 18:52:50 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* dir.c (need_normalization): not only HFS+, CIFS (SMB) is also 	  decomposed.  [Bug #10704]</p>

<p>	* dir.c (NORMALIZE_UTF8PATH): Unicode decomposition seems to 	  perform in an upper layer than file systems on OSX, as all path 	  names are always decomposed regardless of file system types.</p>

<p>Tue Jan  6 21:41:04 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* time.c (timelocalw): Set tm_isdst field -1 if vtm-&gt;isdst is 	  VTM_ISDST_INITVAL.  This bug is introduced at packing struct 	  vtm (r45155). 	  [ruby-core:67345] [Bug #10698] Reported by Boris Ruf.</p>

<p>Tue Jan  6 03:10:54 2015  Koichi Sasada  &lt;ko1@atdot.net&gt;</p>

<p>	* test/fiddle/test_handle.rb: fix syntax.</p>

<p>Tue Jan  6 00:16:10 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/fiddle/test_handle.rb (test_NEXT): use -test-/dln/empty 	  which is always a shared object and is not used by others. 	  [ruby-dev:48629] [Bug #10384]</p>

<p>Mon Jan  5 14:58:01 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* test/ruby/test_io.rb: added timeout for AIX environment. 	  [ruby-core:62983][Bug #9917]</p>

<p>Sun Jan  4 22:33:33 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/lib/test/unit.rb (ExcludesOption): add “excludes” support 	  to test suite, for alternative implementations and platforms. 	  [Feature #10682]</p>

<p>Sun Jan  4 22:32:42 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/lib/test/unit.rb (Test::Unit): reorder modules and merge 	  each modules.</p>

<p>	* test/lib/test/unit.rb (Test::Unit): split the large class into 	  each modules.</p>

<p>Sun Jan  4 21:32:52 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (f_label): return tLABEL value as it is. 	  [ruby-core:67315] [Bug #10693]</p>

<p>Sun Jan  4 14:02:37 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/lib/test/unit/parallel.rb (run): expand the file name to be 	  loaded, so that relative paths work in parallel mode.</p>

<p>Sun Jan  4 13:36:56 2015  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>	* test/test_tempfile.rb: use assert_file for more descriptive message. 	  following r49131.</p>

<p>Sun Jan  4 13:05:09 2015  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>	* string.c: improve docs for String#&lt;=&gt;. [ruby-core:65399][Feature #10322] 	  Patch by gogo tanaka.</p>

<p>Sun Jan  4 12:42:24 2015  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>	* array.c: improve docs for Array#reject. [ruby-core:65324][misc #10307] 	  Patched by Nebu Pookins.</p>

<p>Sun Jan  4 12:24:11 2015  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>	* string.c: improve docs for String#strip and variations. 	  [ruby-core:66081][Bug #10476]</p>

<p>Sun Jan  4 09:21:04 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/drb/drb.rb: removed unused argument. Patch by @vipulnsward 	  [fix GH-515]</p>

<p>Sun Jan  4 09:18:31 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/tempfile.rb: provide default basename parameter. 	  [fix GH-523] Patch by @dissolved 	* test/test_tempfile.rb: ditto.</p>

<p>Sun Jan  4 00:43:41 2015  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>	* README.ja.md: add guidance of mailing list and bugs.r-l.o.</p>

<p>Sat Jan  3 23:56:28 2015  Ayumu AIZAWA  &lt;ayumu.aizawa@gmail.com&gt;</p>

<p>	* hash.c: fix docs for Hash#invert. [ruby-core:66917] [Bug #10612]</p>

<p>Sat Jan  3 19:52:12 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* include/ruby/intern.h (rb_str_new_literal): define on all 	  platforms, not only gcc.</p>

<p>Sat Jan  3 18:53:28 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/fiddle/lib/fiddle/cparser.rb (parse_ctype): limit split word 	  number as the rest are not used.</p>

<p>Sat Jan  3 18:19:50 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/fiddle/lib/fiddle/cparser.rb: r49110 broke Fiddle::Import with 	  type_alias. 	* test/fiddle/test_cparser.rb: added type_alias test for parse_ctype 	  and parse_struct_signature.</p>

<p>Sat Jan  3 11:50:16 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/openssl/ossl.h: avoid to build failure of Windows environment. 	* ext/openssl/ossl_ssl_session.c: ditto.</p>

<p>Sat Jan  3 11:27:46 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* array.c: Improve performance of Array#shift. use shared instead of 	  MEMMOVE if with arguments. Patch by @ksss [fix GH-537] 	* test/ruby/test_array.rb: ditto. 	* benchmark/bm_array_shift.rb: Added benchmark of GH-537 issue.</p>

<p>Sat Jan  3 10:38:52 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/net/http.rb: More descriptive error message when net/http fails 	  to connect to a server. Patch by @xaviershay [fix GH-700] 	* test/net/http/test_http.rb: ditto.</p>

<p>Sat Jan  3 10:14:51 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/openssl/ossl.h: Make <code>SSL_SESSION_cmp</code> use <code>CRYPTO_memcmp</code> 	  [fix GH-591] Patch by @PiPeep 	* ext/openssl/ossl_ssl_session.c: ditto.</p>

<p>Sat Jan  3 09:54:32 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/fiddle/lib/fiddle/cparser.rb: Support for Fiddle::CParser 	  to handle rich signatures including parameter names and function 	  pointer types. Patch by @theryan [fix GH-590] 	* test/fiddle/test_cparser.rb: ditto.</p>

<p>Sat Jan  3 09:01:43 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* NEWS: added compatibility entry of r49101.</p>

<p>Fri Jan  2 21:06:59 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/net/http.rb (Net::HTTP#send_request): there is no response body 	  with HEAD request. Patch by @rodrigosaito [fix GH-520]</p>

<p>Fri Jan  2 21:04:36 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* test/net/http/test_http.rb (_test_send_request__HEAD): Added 	  failing test for send_request with HEAD method.</p>

<p>Fri Jan  2 18:41:20 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* eval.c (ruby_init): Print ruby_setup() error only in debug mode. 	  Unsuppressable error message is not a good idea. 	  Note that the message is printed sometimes with following 	  code (highly timing dependent, though): 	  pid = spawn(“ruby -e &#39;&#39;”); Process.kill(:TERM, pid)</p>

<p>Fri Jan  2 16:18:44 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* test/ruby/test_module.rb: Refactor invalid testcase. 	  [fix <a href="ruby-core:59035">GH-472]</a>[Bug #9240]</p>

<p>Fri Jan  2 15:53:00 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/webrick/utils.rb: removed unused argument variable. 	  [fix GH-356] Patch by @vipulnsward 	* lib/webrick/server.rb: ditto. 	* lib/webrick/ssl.rb: ditto. 	* test/webrick/test_utils.rb: added test for WEBrick::Utils#create_listeners.</p>

<p>Fri Jan  2 15:35:53 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/securerandom.rb: improve syntax and grammar of documentation. 	  [fix GH-796][ci skip] Patch by @Erol</p>

<p>Fri Jan  2 15:10:01 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* test/openssl/test_ssl_session.rb (OpenSSL#test_ctx_client_session_cb): 	  fix test failure with OpenSSL disabled SSLv3 protocol. 	  [ruby-core:63772] [Bug #10046]</p>

<p>Fri Jan  2 09:08:31 2015  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/resolv.rb (Resolv::DNS::Label::Str#==): Check class equality. 	  (Resolv::DNS::Name#initialize): Normalize labels as 	  Resolv::DNS::Label::Str objects.</p>

<p>Thu Jan  1 21:41:49 2015  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* doc/regexp.rdoc: fix regexp docs for whitespace character. 	  [ruby-dev:48765] [Bug #10624]</p>

<p>Thu Jan  1 17:50:52 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_rubyoptions.rb: try locale encoding name. 	  [ruby-core:67109] [Bug #10643]</p>

<p>Thu Jan  1 11:07:12 2015  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* symbol.c (rb_gc_free_dsymbol): delete from global fstr hash 	* test/ruby/test_symbol.rb (test_symbol_fstr_leak): test for bug 	  [ruby-core:67268] [Bug #10686]</p>

<p>Thu Jan  1 09:14:21 2015  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* vm_args.c (keyword_hash_p): fix non-symbol keys hash. 	  rb_extract_keywords() returns 0 not Qnil when no symbol keys is 	  included.  [ruby-core:67264] [Bug #10685]</p>

<p>Wed Dec 31 17:48:43 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/resolv.rb (Resolv::DNS::Label::Str#initialize): Set encoding 	  ASCII-8BIT before downcase.  case insensitivity of DNS labels doesn&#39;t 	  apply non-ASCII characters.  [RFC 4343]</p>

<p>Wed Dec 31 16:48:44 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (gettable_gen): disable warnings of possible reference 	  to a local variable defined in a past scope. 	  [ruby-core:67162] [Bug #10661]</p>

<p>Wed Dec 31 13:43:48 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* lib/resolv.rb (Resolv::DNS::Name#==): Compare an array of Label:Str 	  objects.  Label#Str#== is case-insensitive.</p>

<p>Tue Dec 30 16:16:12 2014  Ben Miller  &lt;bmiller@rackspace.com&gt;</p>

<p>	* lib/resolv.rb (Resolv::DNS::Name#==): DNS is case-insensitive, so the 	  comparison should be case-insensitive as well. 	  [ruby-core:66498] [Bug #10550]</p>

<p>Tue Dec 30 16:03:45 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* lib/resolv.rb (Resolv::DNS::Name): names with different dots 	  should be different.</p>

<p>Tue Dec 30 13:16:56 2014  Martin Duerst  &lt;bernhard+git@lsmod.de&gt;</p>

<p>	* lib/uri/common.rb: Initialize HTML5ASCIIINCOMPAT to empty Array 	  to avoid error during bootstrap when encodings are not yet defined. 	  [Bug #10678]</p>

<p>Tue Dec 30 09:29:26 2014  Bernhard M. Wiedemann  &lt;bernhard+git@lsmod.de&gt;</p>

<p>	* ext/dbm/dbm.c (Init_dbm): [DOC] as UNIX permissions are octal 	  numbers, needs to be prefixed by 0.  [Fix GH-800]</p>

<p>Tue Dec 30 08:57:39 2014  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* lib/unicode_normalize.rb: typo fix. [ci skip] 	  [ruby-dev:48794][misc #10675]</p>

<p>Mon Dec 29 19:38:01 2014  Yukihiro Matsumoto  &lt;matz@ruby-lang.org&gt;</p>

<p>	* version.h (RUBY_VERSION): 2.3.0 development has started.</p>

<p>Mon Dec 29 18:58:46 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* re.c (unescape_nonascii): append escape sequence as-is not 	  unescaped character, to get rid of unexpected meta-character. 	  [ruby-core:67193] [Bug #10670]</p>

<p>Mon Dec 29 14:27:33 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* doc/syntax/literals.rdoc (Symbols): now Symbols created by 	  interpolation can be garbage collected.  patch by Yihang Ho in 	  [ruby-core:67194].  [Bug #10671]</p>

<p>Mon Dec 29 11:18:17 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* thread.c (rb_thread_variable_get): fix dynamic symbol keys. 	  rb_check_id() returns non-zero only for static symbols, whereas 	  thread local variable keys can be dynamic symbols. 	  [ruby-core:67185] [Bug #10667]</p>

<p>Mon Dec 29 10:37:27 2014  Thiago Lewin  &lt;thiago_lewin@yahoo.com.br&gt;</p>

<p>	* io.c (rb_f_select): [DOC] workaround for YARD doc.  [Fix GH-799]</p>

<p>	* process.c (proc_detach): [DOC] fix missing closing parenthesis. 	  [Fix GH-799]</p>

<p>Mon Dec 29 07:27:23 2014  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/json, test/json: merge JSON HEAD(17fe8e7) 	  <a href="https://github.com/flori/json/compare/v1.8.1...17fe8e7">github.com/flori/json/compare/v1.8.1…17fe8e7</a></p>

<p>Sun Dec 28 23:49:37 2014  Michal Papis  &lt;mpapis@gmail.com&gt;</p>

<p>	* rbinstall.rb: fix target location for installing bundled gems. 	  install to the prepared directory instead of default Gem.dir, 	  not to be affected GEM_HOME environment variable.  [Fix GH-798]</p>

<p>Sun Dec 28 18:19:28 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* test/-ext-/iseq_load/test_iseq_load.rb 	  (test_next_in_block_in_block): test using ISeq#eval 	  (test_break_ensure): ditto 	  [ruby-core:66988]</p>

<p>Sun Dec 28 16:25:12 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* cygwin/GNUmakefile.in (EXTOBJS): override to add resource files 	  always.  [ruby-core:67153] [Bug #10657]</p>

<p>Sun Dec 28 13:54:26 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* parse.y (f_kwrest, new_args_tail_gen): unnamed rest keyword and 	  keywords bits arguments should be unique.  since internal IDs 	  depend on the local variable index in the current scope, new ID 	  should be made before popping those vtables. 	  [ruby-core:67157] [Bug #10659]</p>

<p>Sat Dec 27 20:12:55 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/json/generator/generator.c (JSON_Generator_State_type): add 	  #ifdef for backward compatibility.</p>

<p>	* ext/json/parser/parser.rl (JSON_Parser_type): ditto.</p>

<p>	* ext/json/generator/generator.h (ZALLOC): add fallback definition.</p>

<p>	* ext/json/parser/parser.h (ZALLOC): ditto.</p>

<p>Sat Dec 27 16:54:05 2014  Tanaka Akira  &lt;akr@fsij.org&gt;</p>

<p>	* process.c: Unused code removed. 	  It seems waitpid() is universally available on POSIX platforms.</p>

<p>Sat Dec 27 15:08:27 2014  Eric Wong  &lt;e@80x24.org&gt;</p>

<p>	* vm_core.h (rb_vm_living_threads_insert): preserve order 	  [Bug #10660] [ruby-core:67154] [ruby-core:67159]</p>

<p>Sat Dec 27 13:08:20 2014  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/socket/socket.c: improved document for YARD doc. 	  [fix GH-795][ci skip] Patch by @tlewin</p>

<p>Sat Dec 27 10:11:21 2014  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* ext/tk/lib/tkextlib/tcllib/plotchart.rb: fix to invoke correct function 	  of tcllib. Patch by @zalt50 [fix GH-787]</p>

<p>Sat Dec 27 10:03:41 2014  SHIBATA Hiroshi  &lt;shibata.hiroshi@gmail.com&gt;</p>

<p>	* tool/make-snapshot: show sha1 digest when making packages. 	  it&#39;s request from <a href="https://github.com/ruby/www.ruby-lang.org/issues/921">github.com/ruby/www.ruby-lang.org/issues/921</a> 	  [fix GH-794]</p>

<p>Fri Dec 26 15:32:16 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/tk/tcltklib.c (ip_invoke_core): remove probably duplicate 	  dead code.</p>

<p>Fri Dec 26 15:28:27 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/tk/tcltklib.c (ip_ruby_cmd_receiver_const_get): simply use 	  rb_path2class() to get a class/module from its name.</p>

<p>Fri Dec 26 15:20:54 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* marshal.c (w_long): append at once by w_nbyte() instead of 	  appending byte by byte.</p>

<p>Fri Dec 26 15:13:13 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/json/parser/parser.rl (unescape_unicode): check if valid 	  before bit-or assignments. 	  reported by Denis Denisov &lt;denji0k AT gmail.com&gt;.</p>

<p>	* ext/nkf/nkf-utf8/nkf.c (nkf_iconv_t): fix a missing semicolon. 	  reported by Denis Denisov &lt;denji0k AT gmail.com&gt;.</p>

<p>	* process.c (rb_spawn_process): get rid of usage of uninitialized 	  variable. 	  reported by Denis Denisov &lt;denji0k AT gmail.com&gt;.</p>

<p>	* regexec.c (match_at): ditto.</p>

<p>	* ext/win32ole/win32ole.c (ole_wc2mb_alloc, ole_vstr2wc, ole_mb2wc): 	  ditto.</p>

<p>	* dir.c (ruby_glob0): no need to check never-NULL pointer. 	  reported by Denis Denisov &lt;denji0k AT gmail.com&gt;.</p>

<p>	* win32/file.c (rb_file_expand_path_internal): ditto.</p>

<p>	* win32/file.c (code_page_i): handle realloc failure. 	  reported by Denis Denisov &lt;denji0k AT gmail.com&gt;.</p>

<p>	* win32/stub.c (stub_sysinit): ditto.</p>

<p>	* fix printf format conversion specifiers. 	  reported by Denis Denisov &lt;denji0k AT gmail.com&gt;.</p>

<p>Fri Dec 26 01:41:40 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/rbinstall.rb: skip installing bundle gems if zlib is unavailable. 	  [Bug #10647] [ruby-dev:48787]</p>

<p>Fri Dec 26 01:24:42 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* tool/downloader.rb: support old versions of ruby.</p>

<p>	* tool/downloader.rb: now can download gems by http if openssl is not 	  available (this may be danger!)</p>

<p>Fri Dec 26 00:13:48 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* test/ruby/test_extlibs.rb: check existence of extension libraries 	  which not depend on outer libraries. (experimental)</p>

<p>Thu Dec 25 21:58:15 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/fiddle/extconf.rb: make PIC objects if it will be linked as 	  a shared object eventually.  [ruby-core:67128]</p>

<p>Thu Dec 25 19:01:13 2014  NAKAMURA Usaku  &lt;usa@ruby-lang.org&gt;</p>

<p>	* ext/fiddle/win32/libffi-3.2.1-mswin.patch: support mswin32.</p>

<p>Thu Dec 25 17:30:40 2014  Naohisa Goto  &lt;ngotogenome@gmail.com&gt;</p>

<p>	* gc.c (wmap_final_func): fix memory size shortage when realloc wmap. 	  Fix SEGV during finalize of WeakRef on Solaris (though the SEGV 	  could occur on all OS/platforms). [ruby-dev:48779] [Bug #10646]</p>

<p>Thu Dec 25 17:27:06 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* configure.in (NET_LUID): include winsock2.h instead of windows.h. 	  patch by Jon Forums in [ruby-core:67125].  [Bug #10640]</p>

<p>Thu Dec 25 16:14:10 2014  Nobuyoshi Nakada  &lt;nobu@ruby-lang.org&gt;</p>

<p>	* ext/io/console/console.c (console_dev): send the given arguments 	  to the opened console.  as a special case, do nothing if <code>:close</code> 	  is given.</p>

<p>	* test/lib/leakchecker.rb (LeakChecker#check_fd_leak): close if 	  console.</p>

<p>For the changes before 2.2.0, see doc/ChangeLog-2.2.0 For the changes before 2.1.0, see doc/ChangeLog-2.1.0 For the changes before 2.0.0, see doc/ChangeLog-2.0.0 For the changes before 1.9.3, see doc/ChangeLog-1.9.3 For the changes before 1.8.0, see doc/ChangeLog-1.8.0</p>

<p>Local variables: coding: us-ascii add-log-time-format: (lambda ()</p>

<pre class="code ruby"><code class="ruby">(let* ((time (current-time))</code></pre>

<p>	 (system-time-locale “C”) 	 (diff (+ (cadr time) 32400)) 	 (lo (% diff 65536)) 	 (hi (+ (car time) (/ diff 65536))))</p>

<pre class="code ruby"><code class="ruby">(format-time-string &quot;%a %b %e %H:%M:%S %Y&quot; (list hi lo) t)))</code></pre>

<p>indent-tabs-mode: t tab-width: 8 change-log-indent-text: 2 end: vim: tabstop=8 shiftwidth=2</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>