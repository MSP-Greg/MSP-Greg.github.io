<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActionDispatch::PermissionsPolicy &mdash; Rails main</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActionDispatch::PermissionsPolicy",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Rails main</a> &raquo; 
      <a href='../_index.html#alpha_P'>Index (P)</a> &raquo; 
        <a href="../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>PermissionsPolicy&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: ActionDispatch::PermissionsPolicy</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="PermissionsPolicy/Request.html" title="ActionDispatch::PermissionsPolicy::Request (module)"><code>Request</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="PermissionsPolicy/Middleware.html" title="ActionDispatch::PermissionsPolicy::Middleware (class)"><code>Middleware</code></a>      </div>
    </td></tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L31'>actionpack/lib/action_dispatch/http/permissions_policy.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Configures the HTTP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Feature-Policy" target="_parent" title="Feature-Policy">Feature-Policy</a> response header to specify which browser features the current document and its iframes can use.</p>

<p>Example global policy:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="../Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="../Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_permissions_policy'>permissions_policy</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_policy'>policy</span><span class='op'>|</span>
  <span class='id identifier rubyid_policy'>policy</span>.<span class='id identifier rubyid_camera'>camera</span>      <span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span>
  <span class='id identifier rubyid_policy'>policy</span>.<span class='id identifier rubyid_gyroscope'>gyroscope</span>   <span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span>
  <span class='id identifier rubyid_policy'>policy</span>.<span class='id identifier rubyid_microphone'>microphone</span>  <span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span>
  <span class='id identifier rubyid_policy'>policy</span>.<span class='id identifier rubyid_usb'>usb</span>         <span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span>
  <span class='id identifier rubyid_policy'>policy</span>.<span class='id identifier rubyid_fullscreen'>fullscreen</span>  <span class='symbeg'>:</span><span class='kw'>self</span>
  <span class='id identifier rubyid_policy'>policy</span>.<span class='id identifier rubyid_payment'>payment</span>     <span class='symbeg'>:</span><span class='kw'>self</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://secure.example.com</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>

<p>The Feature-Policy header has been renamed to Permissions-Policy. The Permissions-Policy requires a different implementation and isn’t yet supported by all browsers. To avoid having to rename this middleware in the future we use the new name for the middleware but keep the old header name and implementation for now.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='DIRECTIVES-constant' class='summary_signature priv'>DIRECTIVES =</span>
    <span class='note title private'>private</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>List of available permissions can be found at <a href="https://github.com/w3c/webappsec-permissions-policy/blob/main/features.md#policy-controlled-features">github.com/w3c/webappsec-permissions-policy/blob/main/features.md#policy-controlled-features</a></p>

  </div>
</div>
    <a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L91-L112'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 91</a>    <pre class='code ruby'>{
  <span class='label'>accelerometer:</span>        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>accelerometer</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>ambient_light_sensor:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ambient-light-sensor</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>autoplay:</span>             <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>autoplay</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>camera:</span>               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>camera</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>encrypted_media:</span>      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>encrypted-media</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>fullscreen:</span>           <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fullscreen</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>geolocation:</span>          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>geolocation</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>gyroscope:</span>            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gyroscope</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>hid:</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hid</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>idle_detection:</span>       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>idle_detection</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>magnetometer:</span>         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>magnetometer</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>microphone:</span>           <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>microphone</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>midi:</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>midi</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>payment:</span>              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>payment</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>picture_in_picture:</span>   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>picture-in-picture</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>screen_wake_lock:</span>     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>screen-wake-lock</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>serial:</span>               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>serial</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>sync_xhr:</span>             <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sync-xhr</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>usb:</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>usb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>web_share:</span>            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>web-share</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
}.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='MAPPINGS-constant' class='summary_signature priv'>MAPPINGS =</span>
    <span class='note title private'>private</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L84-L87'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 84</a>    <pre class='code ruby'>{
  <span class='label'>self:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;self&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>none:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;none&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
}.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong> {|_self| ... } &#x21d2; PermissionsPolicy </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#directives-instance_method" title="#directives (instance method)">#<strong>directives</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#build-instance_method" title="#build (instance method)">#<strong>build</strong>(context = nil)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#initialize_copy-instance_method" title="#initialize_copy (instance method)">#<strong>initialize_copy</strong>(other)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#apply_mapping-instance_method" title="#apply_mapping (instance method)">#<strong>apply_mapping</strong>(source)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#apply_mappings-instance_method" title="#apply_mappings (instance method)">#<strong>apply_mappings</strong>(sources)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_directive-instance_method" title="#build_directive (instance method)">#<strong>build_directive</strong>(sources, context)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_directives-instance_method" title="#build_directives (instance method)">#<strong>build_directives</strong>(context)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#resolve_source-instance_method" title="#resolve_source (instance method)">#<strong>resolve_source</strong>(source, context)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong> {|_self| ... } &#x21d2; <code>PermissionsPolicy</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(<code>_self</code>)</span>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>_self</span>
    <span class='type'>(<code>PermissionsPolicy</code>)</span>
&mdash;    <div class='inline'>
<p>the object that the method was called on</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L118-L121'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='118' data-end='121'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 118</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@directives</span> <span class='op'>=</span> {}
  <span class='kw'>yield</span> <span class='kw'>self</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="directives-instance_method">
  <h3 class='signature ro first'>
    #<strong>directives</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L116-L116'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='116' data-end='116'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 116</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_directives'>directives</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="apply_mapping-instance_method">
  <h3 class='signature priv first'>
    #<strong>apply_mapping</strong>(source)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L155-L159'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='155' data-end='159'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 155</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_mapping'>apply_mapping</span>(<span class='id identifier rubyid_source'>source</span>)
  <span class='const'><a href="#MAPPINGS-constant" title="ActionDispatch::PermissionsPolicy::MAPPINGS (constant)">MAPPINGS</a></span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_source'>source</span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unknown HTTP permissions policy source mapping: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="apply_mappings-instance_method">
  <h3 class='signature priv'>
    #<strong>apply_mappings</strong>(sources)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L142-L153'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='142' data-end='153'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 142</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_mappings'>apply_mappings</span>(<span class='id identifier rubyid_sources'>sources</span>)
  <span class='id identifier rubyid_sources'>sources</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_source'>source</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_source'>source</span>
    <span class='kw'>when</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span>
      <span class='id identifier rubyid_apply_mapping'><a href="#apply_mapping-instance_method" title="ActionDispatch::PermissionsPolicy#apply_mapping (method)">apply_mapping</a></span>(<span class='id identifier rubyid_source'>source</span>)
    <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span><span class='comma'>,</span> <span class='const'>Proc</span>
      <span class='id identifier rubyid_source'>source</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid HTTP permissions policy source: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build-instance_method">
  <h3 class='signature '>
    #<strong>build</strong>(context = nil)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L137-L139'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='137' data-end='139'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 137</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build'>build</span>(<span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_build_directives'><a href="#build_directives-instance_method" title="ActionDispatch::PermissionsPolicy#build_directives (method)">build_directives</a></span>(<span class='id identifier rubyid_context'>context</span>).<span class='id identifier rubyid_compact'>compact</span>.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>; </span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_directive-instance_method">
  <h3 class='signature priv'>
    #<strong>build_directive</strong>(sources, context)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L173-L175'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='173' data-end='175'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 173</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_directive'>build_directive</span>(<span class='id identifier rubyid_sources'>sources</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>)
  <span class='id identifier rubyid_sources'>sources</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_source'>source</span><span class='op'>|</span> <span class='id identifier rubyid_resolve_source'><a href="#resolve_source-instance_method" title="ActionDispatch::PermissionsPolicy#resolve_source (method)">resolve_source</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>) }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_directives-instance_method">
  <h3 class='signature priv'>
    #<strong>build_directives</strong>(context)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L161-L171'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='161' data-end='171'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 161</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_directives'>build_directives</span>(<span class='id identifier rubyid_context'>context</span>)
  <span class='ivar'>@directives</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_directive'>directive</span><span class='comma'>,</span> <span class='id identifier rubyid_sources'>sources</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_sources'>sources</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../Array.html" title="Array (class)">Array</a></span>)
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_directive'>directive</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_build_directive'><a href="#build_directive-instance_method" title="ActionDispatch::PermissionsPolicy#build_directive (method)">build_directive</a></span>(<span class='id identifier rubyid_sources'>sources</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>).<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span>)<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_sources'>sources</span>
      <span class='id identifier rubyid_directive'>directive</span>
    <span class='kw'>else</span>
      <span class='kw'>nil</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initialize_copy-instance_method">
  <h3 class='signature '>
    #<strong>initialize_copy</strong>(other)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L123-L125'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='123' data-end='125'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 123</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_copy'>initialize_copy</span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='ivar'>@directives</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span>.<span class='id identifier rubyid_directives'><a href="#directives-instance_method" title="ActionDispatch::PermissionsPolicy#directives (method)">directives</a></span>.<span class='id identifier rubyid_deep_dup'>deep_dup</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="resolve_source-instance_method">
  <h3 class='signature priv'>
    #<strong>resolve_source</strong>(source, context)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/http/permissions_policy.rb#L177-L192'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='177' data-end='192'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/http/permissions_policy.rb', line 177</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_resolve_source'>resolve_source</span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span>)
  <span class='kw'>case</span> <span class='id identifier rubyid_source'>source</span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
    <span class='id identifier rubyid_source'>source</span>
  <span class='kw'>when</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span>
    <span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>when</span> <span class='const'>Proc</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_context'>context</span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing context for the dynamic permissions policy source: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_context'>context</span>.<span class='id identifier rubyid_instance_exec'>instance_exec</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_source'>source</span>)
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unexpected permissions policy source: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source'>source</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>