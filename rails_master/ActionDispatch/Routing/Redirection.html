<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActionDispatch::Routing::Redirection &mdash; Rails main</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActionDispatch::Routing::Redirection",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Rails main</a> &raquo; 
      <a href='../../_index.html#alpha_R'>Index (R)</a> &raquo; 
        <a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a> &raquo; 
        <a href="../Routing.html" title="ActionDispatch::Routing (module)">Routing</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Redirection&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: ActionDispatch::Routing::Redirection</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="Mapper.html" title="ActionDispatch::Routing::Mapper (class)"><code>Mapper</code></a>
      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/routing/redirection.rb#L150'>actionpack/lib/action_dispatch/routing/redirection.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#redirect-instance_method" title="#redirect (instance method)">#<strong>redirect</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="Redirect.html" title="ActionDispatch::Routing::Redirect (class)"><code>Redirect</code></a> any path to another path:</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="redirect-instance_method">
  <h3 class='signature  first'>
    #<strong>redirect</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="Redirect.html" title="ActionDispatch::Routing::Redirect (class)"><code>Redirect</code></a> any path to another path:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/stories</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/posts</span><span class='tstring_end'>&quot;</span></span>)</code></pre>

<p>This will redirect the user, while ignoring certain parts of the request, including query string, etc. <code>/stories</code>, <code>/stories?foo=bar</code>, etc all redirect to <code>/posts</code>.</p>

<p>The redirect will use a <code>301 Moved Permanently</code> status code by default. This can be overridden with the <code>:status</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/stories</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/posts</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>status:</span> <span class='int'>307</span>)</code></pre>

<p>You can also use interpolation in the supplied redirect argument:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>docs/:article</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/wiki/%{article}</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>Note that if you return a path without a leading slash then the URL is prefixed with the current SCRIPT_NAME environment variable. This is typically ‘/’ but may be different in a mounted engine or where the application is deployed to a subdirectory of a website.</p>

<p>Alternatively you can use one of the other syntaxes:</p>

<p>The block version of redirect allows for the easy encapsulation of any logic associated with the redirect in question. Either the params and request are supplied as arguments, or just params, depending of how many arguments your block accepts. A string is required as a return value.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>jokes/:number</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='id identifier rubyid_redirect'>redirect</span> { <span class='op'>|</span><span class='id identifier rubyid_params'>params</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span><span class='op'>|</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> (<span class='id identifier rubyid_params'>params</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_number'>number</span>].<span class='id identifier rubyid_to_i'>to_i</span>.<span class='id identifier rubyid_even?'>even?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wheres-the-beef</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>i-love-lamp</span><span class='tstring_end'>&quot;</span></span>)
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_host_with_port'>host_with_port</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
}</code></pre>

<p>Note that the <code>do end</code> syntax for the redirect block wouldn’t work, as Ruby would pass the block to <code>get</code> instead of <code>redirect</code>. Use <code>{ ... }</code> instead.</p>

<p>The options version of redirect allows you to supply only the parts of the URL which need to change, it also supports interpolation of the path similar to the first example.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stores/:name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>       <span class='label'>to:</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='label'>subdomain:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stores</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/%{name}</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stores/:name(*all)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='label'>subdomain:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stores</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/%{name}%{all}</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/stories</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='label'>path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/posts</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>This will redirect the user, while changing only the specified parts of the request, for example the <code>path</code> option in the last example. <code>/stories</code>, <code>/stories?foo=bar</code>, redirect to <code>/posts</code> and <code>/posts?foo=bar</code> respectively.</p>

<p>Finally, an object which responds to call can be supplied to redirect, allowing you to reuse common redirect routes. The call method must accept two arguments, params and request, and return a string.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>accounts/:name</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='const'>SubdomainRedirector</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>api</span><span class='tstring_end'>&#39;</span></span>))</code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>ArgumentError</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/routing/redirection.rb#L206-L218'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='206' data-end='218'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/routing/redirection.rb', line 206</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_options'>options</span>         <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_extract_options!'>extract_options!</span>
  <span class='id identifier rubyid_status'>status</span>          <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_status'>status</span>) <span class='op'>||</span> <span class='int'>301</span>
  <span class='id identifier rubyid_path'>path</span>            <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_shift'>shift</span>
  <span class='id identifier rubyid_source_location'>source_location</span> <span class='op'>=</span> <span class='id identifier rubyid_caller'>caller</span>[<span class='int'>0</span>] <span class='kw'>if</span> <span class='const'><a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a></span>.<span class='id identifier rubyid_verbose_redirect_logs'><a href="../../ActionDispatch.html#verbose_redirect_logs-instance_method" title="ActionDispatch#verbose_redirect_logs (method)">verbose_redirect_logs</a></span>

  <span class='kw'>return</span> <span class='const'><a href="OptionRedirect.html" title="ActionDispatch::Routing::OptionRedirect (class)">OptionRedirect</a></span>.<span class='id identifier rubyid_new'><a href="Redirect.html#new-class_method" title="ActionDispatch::Routing::Redirect.new (method)">new</a></span>(<span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_source_location'>source_location</span>) <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_any?'>any?</span>
  <span class='kw'>return</span> <span class='const'><a href="PathRedirect.html" title="ActionDispatch::Routing::PathRedirect (class)">PathRedirect</a></span>.<span class='id identifier rubyid_new'><a href="Redirect.html#new-class_method" title="ActionDispatch::Routing::Redirect.new (method)">new</a></span>(<span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_source_location'>source_location</span>) <span class='kw'>if</span> <span class='const'><a href="../../String.html" title="String (class)">String</a></span> <span class='op'>===</span> <span class='id identifier rubyid_path'>path</span>

  <span class='id identifier rubyid_block'>block</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span> <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_call'>call</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>redirection argument not supported</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_block'>block</span>
  <span class='const'><a href="Redirect.html" title="ActionDispatch::Routing::Redirect (class)">Redirect</a></span>.<span class='id identifier rubyid_new'><a href="Redirect.html#new-class_method" title="ActionDispatch::Routing::Redirect.new (method)">new</a></span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_source_location'>source_location</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>