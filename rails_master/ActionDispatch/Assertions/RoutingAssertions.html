<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActionDispatch::Assertions::RoutingAssertions &mdash; Rails main</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActionDispatch::Assertions::RoutingAssertions",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Rails main</a> &raquo; 
      <a href='../../_index.html#alpha_R'>Index (R)</a> &raquo; 
        <a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a> &raquo; 
        <a href="../Assertions.html" title="ActionDispatch::Assertions (module)">Assertions</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>RoutingAssertions&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: ActionDispatch::Assertions::RoutingAssertions</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="RoutingAssertions/ClassMethods.html" title="ActionDispatch::Assertions::RoutingAssertions::ClassMethods (module)"><code>ClassMethods</code></a>,
        <a class='nodoc' href="RoutingAssertions/WithIntegrationRouting.html" title="ActionDispatch::Assertions::RoutingAssertions::WithIntegrationRouting (module)"><code>WithIntegrationRouting</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="../../ActionController/TestCase.html" title="ActionController::TestCase (class)"><code>::ActionController::TestCase</code></a>,
          <a href="../Assertions.html" title="ActionDispatch::Assertions (module)"><code>::ActionDispatch::Assertions</code></a>,
          <a href="../Integration/Runner.html" title="ActionDispatch::Integration::Runner (module)"><code>::ActionDispatch::Integration::Runner</code></a>,
          <a href="../Integration/Session.html" title="ActionDispatch::Integration::Session (class)"><code>::ActionDispatch::Integration::Session</code></a>,
          <a href="../IntegrationTest.html" title="ActionDispatch::IntegrationTest (class)"><code>::ActionDispatch::IntegrationTest</code></a>,
          <a href="../IntegrationTest/Behavior.html" title="ActionDispatch::IntegrationTest::Behavior (module)"><code>::ActionDispatch::IntegrationTest::Behavior</code></a>,
          <a href="../../ActionView/TestCase.html" title="ActionView::TestCase (class)"><code>::ActionView::TestCase</code></a>,
          <a href="../../ActionView/TestCase/Behavior.html" title="ActionView::TestCase::Behavior (module)"><code>::ActionView::TestCase::Behavior</code></a>
      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="../../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)"><code>::ActiveSupport::Concern</code></a>
        </div>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L14'>actionpack/lib/action_dispatch/testing/assertions/routing.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Suite of assertions to test routes generated by <a href="../../Rails.html" title="Rails (module)"><code>::Rails</code></a> and the handling of requests made to them.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="../../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)"><code>::ActiveSupport::Concern</code></a> - Extended</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">class_methods</a></td>
      <td><div class='inline'><p>Define class methods from given block.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">included</a></td>
      <td><div class='inline'><p>Evaluate given block in context of base class, so that you can write class macros here.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../../ActiveSupport/Concern.html#prepended-instance_method" title="ActiveSupport::Concern#prepended (method)">prepended</a></td>
      <td><div class='inline'><p>Evaluate given block in context of base class, so that you can write class macros here.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="../../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">append_features</a>,
        <a class='i_m nodoc' href="../../ActiveSupport/Concern.html#prepend_features-instance_method" title="ActiveSupport::Concern#prepend_features (method)">prepend_features</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#assert_generates-instance_method" title="#assert_generates (instance method)">#<strong>assert_generates</strong>(expected_path, options, defaults = {}, extras = {}, message = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Asserts that the provided options can be used to generate the provided path.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#assert_recognizes-instance_method" title="#assert_recognizes (instance method)">#<strong>assert_recognizes</strong>(expected_options, path, extras = {}, msg = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Asserts that the routing of the given <code>path</code> was handled correctly and that the parsed options (given in the <code>expected_options</code> hash) match <code>path</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#assert_routing-instance_method" title="#assert_routing (instance method)">#<strong>assert_routing</strong>(path, options, defaults = {}, extras = {}, message = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Asserts that path and options match both ways; in other words, it verifies that <code>path</code> generates <code>options</code> and then that <code>options</code> generates <code>path</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#method_missing-instance_method" title="#method_missing (instance method)">#<strong>method_missing</strong>(selector)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>ROUTES TODO: These assertions should really work in an integration context.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#with_routing-instance_method" title="#with_routing (instance method)">#<strong>with_routing</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A helper to make it easier to test different route configurations.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#create_routes-instance_method" title="#create_routes (instance method)">#<strong>create_routes</strong> {|@routes| ... } </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#fail_on-instance_method" title="#fail_on (instance method)">#<strong>fail_on</strong>(exception_class, message)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#recognized_request_for-instance_method" title="#recognized_request_for (instance method)">#<strong>recognized_request_for</strong>(path, extras = {}, msg)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Recognizes the route for a given path.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#reset_routes-instance_method" title="#reset_routes (instance method)">#<strong>reset_routes</strong>(old_routes, old_controller)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#setup-instance_method" title="#setup (instance method)">#<strong>setup</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='method_missing_details' class='y_details'>Dynamic Method Handling</h2>
  <p class='notice this'>
    This class handles dynamic methods through the <tt>method_missing</tt> method
</p>
<section class='method_details first' id="method_missing-instance_method">
  <h3 class='signature  first'>
    #<strong>method_missing</strong>(selector)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>ROUTES TODO: These assertions should really work in an integration context</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L261-L267'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='261' data-end='267'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 261</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_method_missing'>method_missing</span>(<span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='op'>...</span>)
  <span class='kw'>if</span> <span class='ivar'>@controller</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@routes</span><span class='op'>&amp;.</span><span class='id identifier rubyid_named_routes'>named_routes</span><span class='op'>&amp;.</span><span class='id identifier rubyid_route_defined?'>route_defined?</span>(<span class='id identifier rubyid_selector'>selector</span>)
    <span class='ivar'>@controller</span>.<span class='id identifier rubyid_public_send'>public_send</span>(<span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='op'>...</span>)
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="assert_generates-instance_method">
  <h3 class='signature  first'>
    #<strong>assert_generates</strong>(expected_path, options, defaults = {}, extras = {}, message = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Asserts that the provided options can be used to generate the provided path. This is the inverse of <a href="#assert_recognizes-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#assert_recognizes (method)">#assert_recognizes</a>. The <code>extras</code> parameter is used to tell the request the names and values of additional request parameters that would be in a query string. The <code>message</code> parameter allows you to specify a custom error message for assertion failures.</p>

<p>The <code>defaults</code> parameter is unused.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts that the default action is generated for a route with no action
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>index</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># Tests that the list action is properly routed
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/items/list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>list</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># Tests the generation of a route with a parameter
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/items/list/1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> { <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>items</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span> }

<span class='comment'># Asserts that the generated route gives us our custom route
</span><span class='id identifier rubyid_assert_generates'>assert_generates</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>changesets/12</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> { <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>scm</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>show_diff</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>revision:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>12</span><span class='tstring_end'>&quot;</span></span> }</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L204-L224'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='204' data-end='224'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 204</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_generates'>assert_generates</span>(<span class='id identifier rubyid_expected_path'>expected_path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_expected_path'>expected_path</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>://</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_fail_on'><a href="#fail_on-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#fail_on (method)">fail_on</a></span>(<span class='const'>URI</span><span class='op'>::</span><span class='const'>InvalidURIError</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='id identifier rubyid_expected_path'>expected_path</span>)
      <span class='id identifier rubyid_expected_path'>expected_path</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_path'>path</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_expected_path'>expected_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_expected_path'>expected_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_expected_path'>expected_path</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_clone'>clone</span>
  <span class='id identifier rubyid_generated_path'>generated_path</span><span class='comma'>,</span> <span class='id identifier rubyid_query_string_keys'>query_string_keys</span> <span class='op'>=</span> <span class='ivar'>@routes</span>.<span class='id identifier rubyid_generate_extras'>generate_extras</span>(<span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span>)
  <span class='id identifier rubyid_found_extras'>found_extras</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='op'>!</span> <span class='id identifier rubyid_query_string_keys'>query_string_keys</span>.<span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span> }

  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>||</span> <span class='id identifier rubyid_sprintf'>sprintf</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>found extras &lt;%s&gt;, not &lt;%s&gt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_found_extras'>found_extras</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span>)
  <span class='id identifier rubyid_assert_equal'>assert_equal</span>(<span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_found_extras'>found_extras</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)

  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>||</span> <span class='id identifier rubyid_sprintf'>sprintf</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The generated path &lt;%s&gt; did not match &lt;%s&gt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_generated_path'>generated_path</span><span class='comma'>,</span>
      <span class='id identifier rubyid_expected_path'>expected_path</span>)
  <span class='id identifier rubyid_assert_equal'>assert_equal</span>(<span class='id identifier rubyid_expected_path'>expected_path</span><span class='comma'>,</span> <span class='id identifier rubyid_generated_path'>generated_path</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="assert_recognizes-instance_method">
  <h3 class='signature '>
    #<strong>assert_recognizes</strong>(expected_options, path, extras = {}, msg = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Asserts that the routing of the given <code>path</code> was handled correctly and that the parsed options (given in the <code>expected_options</code> hash) match <code>path</code>. Basically, it asserts that <a href="../../Rails.html" title="Rails (module)"><code>::Rails</code></a> recognizes the route given by <code>expected_options</code>.</p>

<p>Pass a hash in the second argument (<code>path</code>) to specify the request method. This is useful for routes requiring a specific HTTP method. The hash should contain a <code>:path</code> with the incoming request path and a <code>:method</code> containing the required HTTP verb.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts that POSTing to /items will call the create action on ItemsController
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>({<span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>create</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> {<span class='label'>path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>method:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_post'>post</span>})</code></pre>

<p>You can also pass in <code>extras</code> with a hash containing URL parameters that would normally be in the query string. This can be used to assert that values in the query string will end up in the params hash correctly. To test query strings you must use the extras argument because appending the query string on the path directly will not work. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts that a path of &#39;/items/list/1?view=print&#39; returns the correct options
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>({<span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>list</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>view:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>print</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items/list/1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> { <span class='label'>view:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>print</span><span class='tstring_end'>&quot;</span></span> })</code></pre>

<p>The <code>message</code> parameter allows you to pass in an error message that is displayed upon failure.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Check the default route (i.e., the index action)
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>({<span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># Test a specific action
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>({<span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>list</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items/list</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># Test an action with a parameter
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>({<span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>destroy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items/destroy/1</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># Test a custom route
</span><span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>({<span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>show</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span>}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view/item1</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L164-L183'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='164' data-end='183'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 164</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>(<span class='id identifier rubyid_expected_options'>expected_options</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span>].<span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>all</span><span class='tstring_end'>&quot;</span></span>
    [<span class='symbeg'>:</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_post'>post</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_put'>put</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_delete'>delete</span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_method'>method</span><span class='op'>|</span>
      <span class='id identifier rubyid_assert_recognizes'>assert_recognizes</span>(<span class='id identifier rubyid_expected_options'>expected_options</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>method:</span> <span class='id identifier rubyid_method'>method</span>)<span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='id identifier rubyid_recognized_request_for'><a href="#recognized_request_for-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#recognized_request_for (method)">recognized_request_for</a></span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)

    <span class='id identifier rubyid_expected_options'>expected_options</span> <span class='op'>=</span> <span class='id identifier rubyid_expected_options'>expected_options</span>.<span class='id identifier rubyid_clone'>clone</span>

    <span class='id identifier rubyid_expected_options'>expected_options</span>.<span class='id identifier rubyid_stringify_keys!'>stringify_keys!</span>

    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span>(<span class='id identifier rubyid_msg'>msg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>) {
      <span class='id identifier rubyid_sprintf'>sprintf</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The recognized options &lt;%s&gt; did not match &lt;%s&gt;, difference:</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
              <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_path_parameters'>path_parameters</span><span class='comma'>,</span> <span class='id identifier rubyid_expected_options'>expected_options</span>)
    }

    <span class='id identifier rubyid_assert_equal'>assert_equal</span>(<span class='id identifier rubyid_expected_options'>expected_options</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_path_parameters'>path_parameters</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="assert_routing-instance_method">
  <h3 class='signature '>
    #<strong>assert_routing</strong>(path, options, defaults = {}, extras = {}, message = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Asserts that path and options match both ways; in other words, it verifies that <code>path</code> generates <code>options</code> and then that <code>options</code> generates <code>path</code>. This essentially combines <a href="#assert_recognizes-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#assert_recognizes (method)">#assert_recognizes</a> and <a href="#assert_generates-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#assert_generates (method)">#assert_generates</a> into one step.</p>

<p>The <code>extras</code> hash allows you to specify options that would normally be provided as a query string to the action. The <code>message</code> parameter allows you to specify a custom error message to display upon failure.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Asserts a basic route: a controller with the default action (index)
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>home</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Test a route generated with a specific controller, action, and parameter (id)
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/entries/show/23</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>entries</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>show</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='int'>23</span>

<span class='comment'># Asserts a basic route (controller + default action), with an error message if it fails
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/store</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> { <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>store</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> {}<span class='comma'>,</span> {}<span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Route for store index not generated properly</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Tests a route, providing a defaults hash
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>controller/action/9</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>9</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>item:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>square</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span> {<span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>controller</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>action</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span> {}<span class='comma'>,</span> {<span class='label'>item:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>square</span><span class='tstring_end'>&quot;</span></span>}

<span class='comment'># Tests a route with an HTTP method
</span><span class='id identifier rubyid_assert_routing'>assert_routing</span>({ <span class='label'>method:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>put</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/product/321</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> { <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>product</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>update</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>321</span><span class='tstring_end'>&quot;</span></span> })</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L248-L258'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='248' data-end='258'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 248</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_routing'>assert_routing</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_assert_recognizes'><a href="#assert_recognizes-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#assert_recognizes (method)">assert_recognizes</a></span>(<span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>)

  <span class='id identifier rubyid_controller'>controller</span><span class='comma'>,</span> <span class='id identifier rubyid_default_controller'>default_controller</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_controller'>controller</span>]<span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_controller'>controller</span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_controller'>controller</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_controller'>controller</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='CHAR'>?/</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_default_controller'>default_controller</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_default_controller'>default_controller</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='CHAR'>?/</span>)
    <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_controller'>controller</span>] <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_controller'>controller</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_generate_options'>generate_options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_dup'>dup</span>.<span class='id identifier rubyid_delete_if'>delete_if</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='id identifier rubyid_defaults'>defaults</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='id identifier rubyid_k'>k</span>) }
  <span class='id identifier rubyid_assert_generates'><a href="#assert_generates-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#assert_generates (method)">assert_generates</a></span>(<span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>) <span class='op'>?</span> <span class='id identifier rubyid_path'>path</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_path'>path</span>] <span class='op'>:</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_generate_options'>generate_options</span><span class='comma'>,</span> <span class='id identifier rubyid_defaults'>defaults</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_routes-instance_method">
  <h3 class='signature priv'>
    #<strong>create_routes</strong> {|@routes| ... }  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(@<code>routes</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L270-L292'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='270' data-end='292'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 270</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create_routes'>create_routes</span>
  <span class='ivar'>@routes</span> <span class='op'>=</span> <span class='const'><a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a></span><span class='op'>::</span><span class='const'><a href="../Routing.html" title="ActionDispatch::Routing (module)">Routing</a></span><span class='op'>::</span><span class='const'><a href="../Routing/RouteSet.html" title="ActionDispatch::Routing::RouteSet (class)">RouteSet</a></span>.<span class='id identifier rubyid_new'><a href="../Routing/RouteSet.html#new-class_method" title="ActionDispatch::Routing::RouteSet.new (method)">new</a></span>
  <span class='kw'>if</span> <span class='ivar'>@controller</span>
    <span class='ivar'>@controller</span> <span class='op'>=</span> <span class='ivar'>@controller</span>.<span class='id identifier rubyid_clone'>clone</span>
    <span class='id identifier rubyid__routes'>_routes</span> <span class='op'>=</span> <span class='ivar'>@routes</span>

    <span class='ivar'>@controller</span>.<span class='id identifier rubyid_singleton_class'>singleton_class</span>.<span class='id identifier rubyid_include'>include</span>(<span class='id identifier rubyid__routes'>_routes</span>.<span class='id identifier rubyid_url_helpers'>url_helpers</span>)

    <span class='kw'>if</span> <span class='ivar'>@controller</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_view_context_class'>view_context_class</span>
      <span class='id identifier rubyid_view_context_class'>view_context_class</span> <span class='op'>=</span> <span class='const'><a href="../../Class.html" title="Class (class)">Class</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='ivar'>@controller</span>.<span class='id identifier rubyid_view_context_class'>view_context_class</span>) <span class='kw'>do</span>
        <span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid__routes'>_routes</span>.<span class='id identifier rubyid_url_helpers'>url_helpers</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_custom_view_context'>custom_view_context</span> <span class='op'>=</span> <span class='const'><a href="../../Module.html" title="Module (class)">Module</a></span>.<span class='id identifier rubyid_new'>new</span> {
        <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_view_context_class'>view_context_class</span>) <span class='kw'>do</span>
          <span class='id identifier rubyid_view_context_class'>view_context_class</span>
        <span class='kw'>end</span>
      }
      <span class='ivar'>@controller</span>.<span class='id identifier rubyid_extend'>extend</span>(<span class='id identifier rubyid_custom_view_context'>custom_view_context</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>yield</span> <span class='ivar'>@routes</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fail_on-instance_method">
  <h3 class='signature priv'>
    #<strong>fail_on</strong>(exception_class, message)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L336-L340'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='336' data-end='340'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 336</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_fail_on'>fail_on</span>(<span class='id identifier rubyid_exception_class'>exception_class</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>)
  <span class='kw'>yield</span>
<span class='kw'>rescue</span> <span class='id identifier rubyid_exception_class'>exception_class</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../Minitest.html" title="Minitest (module)">Minitest</a></span><span class='op'>::</span><span class='const'>Assertion</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>||</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="recognized_request_for-instance_method">
  <h3 class='signature priv'>
    #<strong>recognized_request_for</strong>(path, extras = {}, msg)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Recognizes the route for a given path.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L302-L334'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='302' data-end='334'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 302</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_recognized_request_for'>recognized_request_for</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_extras'>extras</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>)
    <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span>]
    <span class='id identifier rubyid_path'>path</span>   <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_path'>path</span>]
  <span class='kw'>else</span>
    <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_get'>get</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_controller'>controller</span> <span class='op'>=</span> <span class='ivar'>@controller</span> <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='ivar'>@controller</span>)
  <span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='const'><a href="../../ActionController.html" title="ActionController (module)">ActionController</a></span><span class='op'>::</span><span class='const'><a href="../../ActionController/TestRequest.html" title="ActionController::TestRequest (class)">TestRequest</a></span>.<span class='id identifier rubyid_create'><a href="../../ActionController/TestRequest.html#create-class_method" title="ActionController::TestRequest.create (method)">create</a></span> <span class='id identifier rubyid_controller'>controller</span><span class='op'>&amp;.</span><span class='id identifier rubyid_class'>class</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>://</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_fail_on'><a href="#fail_on-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#fail_on (method)">fail_on</a></span>(<span class='const'>URI</span><span class='op'>::</span><span class='const'>InvalidURIError</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='id identifier rubyid_path'>path</span>)
      <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rack.url_scheme</span><span class='tstring_end'>&quot;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_scheme'>scheme</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_host'>host</span> <span class='kw'>if</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_host'>host</span>
      <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_port'>port</span> <span class='kw'>if</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_port'>port</span>
      <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_uri'>uri</span>.<span class='id identifier rubyid_path'>path</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_request_method'>request_method</span> <span class='op'>=</span> <span class='id identifier rubyid_method'>method</span> <span class='kw'>if</span> <span class='id identifier rubyid_method'>method</span>

  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_fail_on'><a href="#fail_on-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#fail_on (method)">fail_on</a></span>(<span class='const'><a href="../../ActionController.html" title="ActionController (module)">ActionController</a></span><span class='op'>::</span><span class='const'><a href="../../ActionController/RoutingError.html" title="ActionController::RoutingError (class)">RoutingError</a></span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>) <span class='kw'>do</span>
    <span class='ivar'>@routes</span>.<span class='id identifier rubyid_recognize_path'>recognize_path</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>method:</span> <span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='label'>extras:</span> <span class='id identifier rubyid_extras'>extras</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_path_parameters'>path_parameters</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>

  <span class='id identifier rubyid_request'>request</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_routes-instance_method">
  <h3 class='signature priv'>
    #<strong>reset_routes</strong>(old_routes, old_controller)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L294-L299'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='294' data-end='299'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 294</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_routes'>reset_routes</span>(<span class='id identifier rubyid_old_routes'>old_routes</span><span class='comma'>,</span> <span class='id identifier rubyid_old_controller'>old_controller</span>)
  <span class='ivar'>@routes</span> <span class='op'>=</span> <span class='id identifier rubyid_old_routes'>old_routes</span>
  <span class='kw'>if</span> <span class='ivar'>@controller</span>
    <span class='ivar'>@controller</span> <span class='op'>=</span> <span class='id identifier rubyid_old_controller'>old_controller</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="setup-instance_method">
  <h3 class='signature nodoc'>
    #<strong>setup</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L103-L106'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='103' data-end='106'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 103</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_setup'>setup</span> <span class='comment'># :nodoc:
</span>  <span class='ivar'>@routes</span> <span class='op'>||=</span> <span class='kw'>nil</span>
  <span class='kw'>super</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="with_routing-instance_method">
  <h3 class='signature '>
    #<strong>with_routing</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A helper to make it easier to test different route configurations. This method temporarily replaces @routes with a new RouteSet instance.</p>

<p>The new instance is yielded to the passed block. Typically the block will create some routes using ‘set.draw { match … }`:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_with_routing'>with_routing</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_set'>set</span><span class='op'>|</span>
  <span class='id identifier rubyid_set'>set</span>.<span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbeg'>:</span><span class='id identifier rubyid_users'>users</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/users</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_users_path'>users_path</span>
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L121-L126'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='121' data-end='126'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/testing/assertions/routing.rb', line 121</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_with_routing'>with_routing</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_old_routes'>old_routes</span><span class='comma'>,</span> <span class='id identifier rubyid_old_controller'>old_controller</span> <span class='op'>=</span> <span class='ivar'>@routes</span><span class='comma'>,</span> <span class='ivar'>@controller</span>
  <span class='id identifier rubyid_create_routes'><a href="#create_routes-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#create_routes (method)">create_routes</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>ensure</span>
  <span class='id identifier rubyid_reset_routes'><a href="#reset_routes-instance_method" title="ActionDispatch::Assertions::RoutingAssertions#reset_routes (method)">reset_routes</a></span>(<span class='id identifier rubyid_old_routes'>old_routes</span><span class='comma'>,</span> <span class='id identifier rubyid_old_controller'>old_controller</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>