<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Active Support Core Extensions &mdash; Rails main</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "active_support_core_extensions",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Rails main</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Active Support Core Extensions&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1>Active Support Core Extensions</h1>

<p>Active Support is the Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> component responsible for providing Ruby
language extensions and utilities.</p>

<p>It offers a richer bottom-line at the language level, targeted both at the development of <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> applications, and at the development of Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> itself.</p>

<p>After reading this guide, you will know:</p>

<ul>
<li>What Core Extensions are.</li>
<li>How to load all extensions.</li>
<li>How to cherry-pick just the extensions you want.</li>
<li>What extensions Active Support provides.</li>
</ul>

<hr>

<h2>How to Load Core Extensions</h2>

<h3>Stand-Alone Active Support</h3>

<p>In order to have the smallest default footprint possible, Active Support loads the minimum dependencies by default. It is broken in small pieces so that only the desired extensions can be loaded. It also has some convenience entry points to load related extensions in one shot, even everything.</p>

<p>Thus, after a simple require like:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support</span><span class='tstring_end'>&quot;</span></span></code></pre>

<p>only the extensions required by the Active Support framework are loaded.</p>

<h4>Cherry-picking a Definition</h4>

<p>This example shows how to load <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-with_indifferent_access"><a href="Hash.html#with_indifferent_access-instance_method" title="Hash#with_indifferent_access (method)">Hash#with_indifferent_access</a></a>.  This extension enables the conversion of a <a href="Hash.html" title="Hash (class)"><code>Hash</code></a> into an <a href="https://api.rubyonrails.org/classes/ActiveSupport/HashWithIndifferentAccess.html"><a href="ActiveSupport/HashWithIndifferentAccess.html" title="ActiveSupport::HashWithIndifferentAccess (class)"><code>::ActiveSupport::HashWithIndifferentAccess</code></a></a> which permits access to the keys as either strings or symbols.</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>a:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span>] <span class='comment'># =&gt; 1</span></code></pre>

<p>For every single method defined as a core extension this guide has a note that says where such a method is defined. In the case of <code>with_indifferent_access</code> the note reads:</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/indifferent_access.rb</code>.</p>

<p>That means that you can require it like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support/core_ext/hash/indifferent_access</span><span class='tstring_end'>&quot;</span></span></code></pre>

<p>Active Support has been carefully revised so that cherry-picking a file loads only strictly needed dependencies, if any.</p>

<h4>Loading Grouped Core Extensions</h4>

<p>The next level is to simply load all extensions to <a href="Hash.html" title="Hash (class)"><code>Hash</code></a>. As a rule of thumb, extensions to <code>SomeClass</code> are available in one shot by loading <code>active_support/core_ext/some_class</code>.</p>

<p>Thus, to load all extensions to <a href="Hash.html" title="Hash (class)"><code>Hash</code></a> (including <code>with_indifferent_access</code>):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support/core_ext/hash</span><span class='tstring_end'>&quot;</span></span></code></pre>

<h4>Loading All Core Extensions</h4>

<p>You may prefer just to load all core extensions, there is a file for that:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support/core_ext</span><span class='tstring_end'>&quot;</span></span></code></pre>

<h4>Loading All Active Support</h4>

<p>And finally, if you want to have all Active Support available just issue:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_support/all</span><span class='tstring_end'>&quot;</span></span></code></pre>

<p>That does not even put the entire Active Support in memory upfront indeed, some stuff is configured via <code>autoload</code>, so it is only loaded if used.</p>

<h3>Active Support Within a Ruby on Rails Application</h3>

<p>A Ruby on Rails application loads all Active Support unless <a href="configuring.html#config-active-support-bare"><code>config.active_support.bare</code></a> is true. In that case, the application will only load what the framework itself cherry-picks for its own needs, and can still cherry-pick itself at any granularity level, as explained in the previous section.</p>

<h2>Extensions to All Objects</h2>

<h3><code>blank?</code> and <code>present?</code></h3>

<p>The following values are considered to be blank in a Rails application:</p>

<ul>
<li><p><code>nil</code> and <code>false</code>,</p></li>
<li><p>strings composed only of whitespace (see note below),</p></li>
<li><p>empty arrays and hashes, and</p></li>
<li><p>any other object that responds to <code>empty?</code> and is empty.</p></li>
</ul>

<p>INFO: The predicate for strings uses the Unicode-aware character class <code>[:space:]</code>, so for example U+2029 (paragraph separator) is considered to be whitespace.</p>

<p>WARNING: Note that numbers are not mentioned. In particular, 0 and 0.0 are <strong>not</strong> blank.</p>

<p>For example, this method from <a href="ActionController/HttpAuthentication/Token/ControllerMethods.html" title="ActionController::HttpAuthentication::Token::ControllerMethods (module)"><code>::ActionController::HttpAuthentication::Token::ControllerMethods</code></a> uses <a href="https://api.rubyonrails.org/classes/Object.html#method-i-blank-3F"><code>blank?</code></a> for checking whether a token is present:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_authenticate'>authenticate</span>(<span class='id identifier rubyid_controller'>controller</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_login_procedure'>login_procedure</span>)
  <span class='id identifier rubyid_token'>token</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_token_and_options'>token_and_options</span>(<span class='id identifier rubyid_controller'>controller</span>.<span class='id identifier rubyid_request'>request</span>)
  <span class='kw'>unless</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_blank?'>blank?</span>
    <span class='id identifier rubyid_login_procedure'>login_procedure</span>.<span class='id identifier rubyid_call'>call</span>(<span class='id identifier rubyid_token'>token</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/Object.html#method-i-present-3F"><code>present?</code></a> is equivalent to <code>!blank?</code>. This example is taken from <a href="ActionDispatch/Http/Cache/Response.html" title="ActionDispatch::Http::Cache::Response (module)"><code>::ActionDispatch::Http::Cache::Response</code></a>:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_set_conditional_cache_control!'>set_conditional_cache_control!</span>
  <span class='kw'>unless</span> <span class='kw'>self</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cache-Control</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_present?'>present?</span>
    <span class='comment'># ...
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/blank.rb</code>.</p>

<h3><code>presence</code></h3>

<p>The <a href="https://api.rubyonrails.org/classes/Object.html#method-i-presence"><code>presence</code></a> method returns its receiver if <code>present?</code>, and <code>nil</code> otherwise. It is useful for idioms like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_host'>host</span>].<span class='id identifier rubyid_presence'>presence</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/blank.rb</code>.</p>

<h3><code>duplicable?</code></h3>

<p>As of Ruby 2.5, most objects can be duplicated via <code>dup</code> or <code>clone</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_dup'>dup</span>           <span class='comment'># =&gt; &quot;foo&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_dup'>dup</span>              <span class='comment'># =&gt; &quot;&quot;
</span><span class='const'>Rational</span>(<span class='int'>1</span>).<span class='id identifier rubyid_dup'>dup</span>     <span class='comment'># =&gt; (1/1)
</span><span class='const'>Complex</span>(<span class='int'>0</span>).<span class='id identifier rubyid_dup'>dup</span>      <span class='comment'># =&gt; (0+0i)
</span><span class='int'>1</span>.<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='op'>+</span>).<span class='id identifier rubyid_dup'>dup</span>    <span class='comment'># =&gt; TypeError (allocator undefined for Method)</span></code></pre>

<p>Active Support provides <a href="https://api.rubyonrails.org/classes/Object.html#method-i-duplicable-3F"><code>duplicable?</code></a> to query an object about this:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_duplicable?'>duplicable?</span>           <span class='comment'># =&gt; true
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_duplicable?'>duplicable?</span>              <span class='comment'># =&gt; true
</span><span class='const'>Rational</span>(<span class='int'>1</span>).<span class='id identifier rubyid_duplicable?'>duplicable?</span>     <span class='comment'># =&gt; true
</span><span class='const'>Complex</span>(<span class='int'>1</span>).<span class='id identifier rubyid_duplicable?'>duplicable?</span>      <span class='comment'># =&gt; true
</span><span class='int'>1</span>.<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='op'>+</span>).<span class='id identifier rubyid_duplicable?'>duplicable?</span>    <span class='comment'># =&gt; false</span></code></pre>

<p>WARNING: Any class can disallow duplication by removing <code>dup</code> and <code>clone</code> or raising exceptions from them. Thus only <code>rescue</code> can tell whether a given arbitrary object is duplicable. <code>duplicable?</code> depends on the hard-coded list above, but it is much faster than <code>rescue</code>. Use it only if you know the hard-coded list is enough in your use case.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/duplicable.rb</code>.</p>

<h3><code>deep_dup</code></h3>

<p>The <a href="https://api.rubyonrails.org/classes/Object.html#method-i-deep_dup"><code>deep_dup</code></a> method returns a deep copy of a given object. Normally, when you <code>dup</code> an object that contains other objects, Ruby does not <code>dup</code> them, so it creates a shallow copy of the object. If you have an array with a string, for example, it will look like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_array'>array</span>     <span class='op'>=</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string</span><span class='tstring_end'>&quot;</span></span>]
<span class='id identifier rubyid_duplicate'>duplicate</span> <span class='op'>=</span> <span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_dup'>dup</span>

<span class='id identifier rubyid_duplicate'>duplicate</span>.<span class='id identifier rubyid_push'>push</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>another-string</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># the object was duplicated, so the element was added only to the duplicate
</span><span class='id identifier rubyid_array'>array</span>     <span class='comment'># =&gt; [&quot;string&quot;]
</span><span class='id identifier rubyid_duplicate'>duplicate</span> <span class='comment'># =&gt; [&quot;string&quot;, &quot;another-string&quot;]
</span>
<span class='id identifier rubyid_duplicate'>duplicate</span>.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>)

<span class='comment'># first element was not duplicated, it will be changed in both arrays
</span><span class='id identifier rubyid_array'>array</span>     <span class='comment'># =&gt; [&quot;foo&quot;]
</span><span class='id identifier rubyid_duplicate'>duplicate</span> <span class='comment'># =&gt; [&quot;foo, &quot;another-string&quot;]</span></code></pre>

<p>As you can see, after duplicating the <a href="Array.html" title="Array (class)"><code>Array</code></a> instance, we got another object, therefore we can modify it and the original object will stay unchanged. This is not true for array&#39;s elements, however. Since <code>dup</code> does not make a deep copy, the string inside the array is still the same object.</p>

<p>If you need a deep copy of an object, you should use <code>deep_dup</code>. Here is an example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_array'>array</span>     <span class='op'>=</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string</span><span class='tstring_end'>&quot;</span></span>]
<span class='id identifier rubyid_duplicate'>duplicate</span> <span class='op'>=</span> <span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_deep_dup'>deep_dup</span>

<span class='id identifier rubyid_duplicate'>duplicate</span>.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>)

<span class='id identifier rubyid_array'>array</span>     <span class='comment'># =&gt; [&quot;string&quot;]
</span><span class='id identifier rubyid_duplicate'>duplicate</span> <span class='comment'># =&gt; [&quot;foo&quot;]</span></code></pre>

<p>If the object is not duplicable, <code>deep_dup</code> will just return it:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_number'>number</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='id identifier rubyid_duplicate'>duplicate</span> <span class='op'>=</span> <span class='id identifier rubyid_number'>number</span>.<span class='id identifier rubyid_deep_dup'>deep_dup</span>
<span class='id identifier rubyid_number'>number</span>.<span class='id identifier rubyid_object_id'>object_id</span> <span class='op'>==</span> <span class='id identifier rubyid_duplicate'>duplicate</span>.<span class='id identifier rubyid_object_id'>object_id</span>   <span class='comment'># =&gt; true</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p>

<h3><code>try</code></h3>

<p>When you want to call a method on an object only if it is not <code>nil</code>, the simplest way to achieve it is with conditional statements, adding unnecessary clutter. The alternative is to use <a href="https://api.rubyonrails.org/classes/Object.html#method-i-try"><code>try</code></a>. <code>try</code> is like <code>Object#public_send</code> except that it returns <code>nil</code> if sent to <code>nil</code>.</p>

<p>Here is an example:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># without try
</span><span class='kw'>unless</span> <span class='ivar'>@number</span>.<span class='id identifier rubyid_nil?'>nil?</span>
  <span class='ivar'>@number</span>.<span class='id identifier rubyid_next'>next</span>
<span class='kw'>end</span>

<span class='comment'># with try
</span><span class='ivar'>@number</span>.<span class='id identifier rubyid_try'>try</span>(<span class='symbeg'>:</span><span class='kw'>next</span>)</code></pre>

<p>Another example is this code from <a href="ActiveRecord/ConnectionAdapters/AbstractAdapter.html" title="ActiveRecord::ConnectionAdapters::AbstractAdapter (class)"><code>::ActiveRecord::ConnectionAdapters::AbstractAdapter</code></a> where <code>@logger</code> could be <code>nil</code>. You can see that the code uses <code>try</code> and avoids an unnecessary check.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_log_info'>log_info</span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_ms'>ms</span>)
  <span class='kw'>if</span> <span class='ivar'>@logger</span>.<span class='id identifier rubyid_try'>try</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_debug?'>debug?</span>)
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%s (%.1fms)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SQL</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_ms'>ms</span>]
    <span class='ivar'>@logger</span>.<span class='id identifier rubyid_debug'>debug</span>(<span class='id identifier rubyid_format_log_entry'>format_log_entry</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_sql'>sql</span>.<span class='id identifier rubyid_squeeze'>squeeze</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>)))
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p><code>try</code> can also be called without arguments but a block, which will only be executed if the object is not nil:</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@person</span>.<span class='id identifier rubyid_try'>try</span> { <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_first_name'>first_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_last_name'>last_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }</code></pre>

<p>Note that <code>try</code> will swallow no-method errors, returning nil instead. If you want to protect against typos, use <a href="https://api.rubyonrails.org/classes/Object.html#method-i-try-21"><code>try!</code></a> instead:</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@number</span>.<span class='id identifier rubyid_try'>try</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_nest'>nest</span>)  <span class='comment'># =&gt; nil
</span><span class='ivar'>@number</span>.<span class='id identifier rubyid_try!'>try!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_nest'>nest</span>) <span class='comment'># NoMethodError: undefined method `nest&#39; for 1:Integer</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/try.rb</code>.</p>

<h3><code>class_eval(*args, &amp;block)</code></h3>

<p>You can evaluate code in the context of any object&#39;s singleton class using <a href="https://api.rubyonrails.org/classes/Kernel.html#method-i-class_eval"><code>class_eval</code></a>:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Proc</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_bind'>bind</span>(<span class='id identifier rubyid_object'>object</span>)
    <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>=</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_current'><a href="Time.html#current-class_method" title="Time.current (method)">current</a></span>
    <span class='id identifier rubyid_object'>object</span>.<span class='id identifier rubyid_class_eval'>class_eval</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_method_name'>method_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>__bind_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_to_i'>to_i</span><span class='embexpr_end'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_usec'>usec</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_define_method'>define_method</span>(<span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
      <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='id identifier rubyid_instance_method'>instance_method</span>(<span class='id identifier rubyid_method_name'>method_name</span>)
      <span class='id identifier rubyid_remove_method'>remove_method</span>(<span class='id identifier rubyid_method_name'>method_name</span>)
      <span class='id identifier rubyid_method'>method</span>
    <span class='kw'>end</span>.<span class='id identifier rubyid_bind'>bind</span>(<span class='id identifier rubyid_object'>object</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/kernel/singleton_class.rb</code>.</p>

<h3><code>acts_like?(duck)</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Object.html#method-i-acts_like-3F"><code>acts_like?</code></a> provides a way to check whether some class acts like some other class based on a simple convention: a class that provides the same interface as <a href="String.html" title="String (class)"><code>String</code></a> defines</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_acts_like_string?'>acts_like_string?</span>
<span class='kw'>end</span></code></pre>

<p>which is only a marker, its body or return value are irrelevant. Then, client code can query for duck-type-safeness this way:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_some_klass'>some_klass</span>.<span class='id identifier rubyid_acts_like?'>acts_like?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_string'>string</span>)</code></pre>

<p>Rails has classes that act like <a href="Date.html" title="Date (class)"><code>Date</code></a> or <a href="Time.html" title="Time (class)"><code>Time</code></a> and follow this contract.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/acts_like.rb</code>.</p>

<h3><code>to_param</code></h3>

<p>All objects in Rails respond to the method <a href="https://api.rubyonrails.org/classes/Object.html#method-i-to_param"><code>to_param</code></a>, which is meant to return something that represents them as values in a query string, or as URL fragments.</p>

<p>By default <code>to_param</code> just calls <code>to_s</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>7</span>.<span class='id identifier rubyid_to_param'>to_param</span> <span class='comment'># =&gt; &quot;7&quot;</span></code></pre>

<p>The return value of <code>to_param</code> should <strong>not</strong> be escaped:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tom &amp; Jerry</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to_param'>to_param</span> <span class='comment'># =&gt; &quot;Tom &amp; Jerry&quot;</span></code></pre>

<p>Several classes in Rails overwrite this method.</p>

<p>For example <code>nil</code>, <code>true</code>, and <code>false</code> return themselves. <a href="https://api.rubyonrails.org/classes/Array.html#method-i-to_param"><a href="Array.html#to_param-instance_method" title="Array#to_param (method)">Array#to_param</a></a> calls <code>to_param</code> on the elements and joins the result with &quot;/&quot;:</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>0</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='const'><a href="String.html" title="String (class)">String</a></span>].<span class='id identifier rubyid_to_param'>to_param</span> <span class='comment'># =&gt; &quot;0/true/String&quot;</span></code></pre>

<p>Notably, the Rails routing system calls <code>to_param</code> on models to get a value for the <code>:id</code> placeholder. <code>ActiveRecord::Base#to_param</code> returns the <code>id</code> of a model, but you can redefine that method in your models. For example, given</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_to_param'>to_param</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_parameterize'>parameterize</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>we get:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_user_path'>user_path</span>(<span class='ivar'>@user</span>) <span class='comment'># =&gt; &quot;/users/357-john-smith&quot;</span></code></pre>

<p>WARNING. Controllers need to be aware of any redefinition of <code>to_param</code> because when a request like that comes in &quot;357-john-smith&quot; is the value of <code>params[:id]</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/to_param.rb</code>.</p>

<h3><code>to_query</code></h3>

<p>The <a href="https://api.rubyonrails.org/classes/Object.html#method-i-to_query"><code>to_query</code></a> method constructs a query string that associates a given <code>key</code> with the return value of <code>to_param</code>. For example, with the following <code>to_param</code> definition:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_to_param'>to_param</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_parameterize'>parameterize</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>we get:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_current_user'>current_user</span>.<span class='id identifier rubyid_to_query'>to_query</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; &quot;user=357-john-smith&quot;</span></code></pre>

<p>This method escapes whatever is needed, both for the key and the value:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_account'>account</span>.<span class='id identifier rubyid_to_query'>to_query</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>company[name]</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;company%5Bname%5D=Johnson%26Johnson&quot;</span></code></pre>

<p>so its output is ready to be used in a query string.</p>

<p>Arrays return the result of applying <code>to_query</code> to each element with <code>key[]</code> as key, and join the result with &quot;&amp;&quot;:</p>

<pre class="code ruby"><code class="ruby">[<span class='float'>3.4</span><span class='comma'>,</span> <span class='op'>-</span><span class='float'>45.6</span>].<span class='id identifier rubyid_to_query'>to_query</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sample</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;sample%5B%5D=3.4&amp;sample%5B%5D=-45.6&quot;</span></code></pre>

<p>Hashes also respond to <code>to_query</code> but with a different signature. If no argument is passed a call generates a sorted series of key/value assignments calling <code>to_query(key)</code> on its values. Then it joins the result with &quot;&amp;&quot;:</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>c:</span> <span class='int'>3</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>a:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_to_query'>to_query</span> <span class='comment'># =&gt; &quot;a=1&amp;b=2&amp;c=3&quot;</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-to_query"><a href="Hash.html#to_query-instance_method" title="Hash#to_query (method)">Hash#to_query</a></a> accepts an optional namespace for the keys:</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>id:</span> <span class='int'>89</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John Smith</span><span class='tstring_end'>&quot;</span></span> }.<span class='id identifier rubyid_to_query'>to_query</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;user%5Bid%5D=89&amp;user%5Bname%5D=John+Smith&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/to_query.rb</code>.</p>

<h3><code>with_options</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Object.html#method-i-with_options"><code>with_options</code></a> provides a way to factor out common options in a series of method calls.</p>

<p>Given a default options hash, <code>with_options</code> yields a proxy object to a block. Within the block, methods called on the proxy are forwarded to the receiver with their options merged. For example, you get rid of the duplication in:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Account</span> <span class='op'>&lt;</span> <span class='const'>ApplicationRecord</span>
  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_customers'>customers</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_products'>products</span><span class='comma'>,</span>  <span class='label'>dependent:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_invoices'>invoices</span><span class='comma'>,</span>  <span class='label'>dependent:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_expenses'>expenses</span><span class='comma'>,</span>  <span class='label'>dependent:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span>
<span class='kw'>end</span></code></pre>

<p>this way:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Account</span> <span class='op'>&lt;</span> <span class='const'>ApplicationRecord</span>
  <span class='id identifier rubyid_with_options'>with_options</span> <span class='label'>dependent:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_assoc'>assoc</span><span class='op'>|</span>
    <span class='id identifier rubyid_assoc'>assoc</span>.<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_customers'>customers</span>
    <span class='id identifier rubyid_assoc'>assoc</span>.<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_products'>products</span>
    <span class='id identifier rubyid_assoc'>assoc</span>.<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_invoices'>invoices</span>
    <span class='id identifier rubyid_assoc'>assoc</span>.<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_expenses'>expenses</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>That idiom may convey <em>grouping</em> to the reader as well. For example, say you want to send a newsletter whose language depends on the user. Somewhere in the mailer you could group locale-dependent bits like this:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="I18n.html" title="I18n (module)">I18n</a></span>.<span class='id identifier rubyid_with_options'>with_options</span> <span class='label'>locale:</span> <span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_locale'>locale</span><span class='comma'>,</span> <span class='label'>scope:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>newsletter</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i18n'>i18n</span><span class='op'>|</span>
  <span class='id identifier rubyid_subject'>subject</span> <span class='id identifier rubyid_i18n'>i18n</span>.<span class='id identifier rubyid_t'>t</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subject'>subject</span>
  <span class='id identifier rubyid_body'>body</span>    <span class='id identifier rubyid_i18n'>i18n</span>.<span class='id identifier rubyid_t'>t</span> <span class='symbeg'>:</span><span class='id identifier rubyid_body'>body</span><span class='comma'>,</span> <span class='label'>user_name:</span> <span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></code></pre>

<p>TIP: Since <code>with_options</code> forwards calls to its receiver they can be nested. Each nesting level will merge inherited defaults in addition to their own.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/with_options.rb</code>.</p>

<h3>JSON Support</h3>

<p>Active Support provides a better implementation of <code>to_json</code> than the <code>json</code> gem ordinarily provides for Ruby objects. This is because some classes, like <a href="Hash.html" title="Hash (class)"><code>Hash</code></a> and <a href="Process/Status.html" title="Process::Status (class)"><code>::Process::Status</code></a> need special handling in order to provide a proper JSON representation.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/json.rb</code>.</p>

<h3>Instance Variables</h3>

<p>Active Support provides several methods to ease access to instance variables.</p>

<h4><code>instance_values</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Object.html#method-i-instance_values"><code>instance_values</code></a> returns a hash that maps instance variable names without &quot;@&quot; to their
corresponding values. Keys are strings:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span>)
    <span class='ivar'>@x</span><span class='comma'>,</span> <span class='ivar'>@y</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>C</span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span>).<span class='id identifier rubyid_instance_values'>instance_values</span> <span class='comment'># =&gt; {&quot;x&quot; =&gt; 0, &quot;y&quot; =&gt; 1}</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/instance_variables.rb</code>.</p>

<h4><code>instance_variable_names</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Object.html#method-i-instance_variable_names"><code>instance_variable_names</code></a> returns an array. Each name includes the &quot;@&quot; sign.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span>)
    <span class='ivar'>@x</span><span class='comma'>,</span> <span class='ivar'>@y</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>C</span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span>).<span class='id identifier rubyid_instance_variable_names'>instance_variable_names</span> <span class='comment'># =&gt; [&quot;@x&quot;, &quot;@y&quot;]</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/instance_variables.rb</code>.</p>

<h3>Silencing Warnings and Exceptions</h3>

<p>The methods <a href="https://api.rubyonrails.org/classes/Kernel.html#method-i-silence_warnings"><code>silence_warnings</code></a> and <a href="https://api.rubyonrails.org/classes/Kernel.html#method-i-enable_warnings"><code>enable_warnings</code></a> change the value of <code>$VERBOSE</code> accordingly for the duration of their block, and reset it afterwards:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_silence_warnings'>silence_warnings</span> { <span class='const'><a href="Object.html" title="Object (class)">Object</a></span>.<span class='id identifier rubyid_const_set'>const_set</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RAILS_DEFAULT_LOGGER</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span> }</code></pre>

<p>Silencing exceptions is also possible with <a href="https://api.rubyonrails.org/classes/Kernel.html#method-i-suppress"><code>suppress</code></a>. This method receives an arbitrary number of exception classes. If an exception is raised during the execution of the block and is <code>kind_of?</code> any of the arguments, <code>suppress</code> captures it and returns silently. Otherwise the exception is not captured:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># If the user is locked, the increment is lost, no big deal.
</span><span class='id identifier rubyid_suppress'>suppress</span>(<span class='const'><a href="ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="ActiveRecord/StaleObjectError.html" title="ActiveRecord::StaleObjectError (class)">StaleObjectError</a></span>) <span class='kw'>do</span>
  <span class='id identifier rubyid_current_user'>current_user</span>.<span class='id identifier rubyid_increment!'>increment!</span> <span class='symbeg'>:</span><span class='id identifier rubyid_visits'>visits</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/kernel/reporting.rb</code>.</p>

<h3><code>in?</code></h3>

<p>The predicate <a href="https://api.rubyonrails.org/classes/Object.html#method-i-in-3F"><code>in?</code></a> tests if an object is included in another object. An <code>ArgumentError</code> exception will be raised if the argument passed does not respond to <code>include?</code>.</p>

<p>Examples of <code>in?</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>1</span>.<span class='id identifier rubyid_in?'>in?</span>([<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>])        <span class='comment'># =&gt; true
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lo</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_in?'>in?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>)   <span class='comment'># =&gt; true
</span><span class='int'>25</span>.<span class='id identifier rubyid_in?'>in?</span>(<span class='int'>30</span><span class='op'>..</span><span class='int'>50</span>)      <span class='comment'># =&gt; false
</span><span class='int'>1</span>.<span class='id identifier rubyid_in?'>in?</span>(<span class='int'>1</span>)            <span class='comment'># =&gt; ArgumentError</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/inclusion.rb</code>.</p>

<h2>Extensions to <a href="Module.html" title="Module (class)"><code>Module</code></a></h2>

<h3>Attributes</h3>

<h4><code>alias_attribute</code></h4>

<p>Model attributes have a reader, a writer, and a predicate. You can alias a model attribute having the corresponding three methods all defined for you by using <a href="https://api.rubyonrails.org/classes/Module.html#method-i-alias_attribute"><code>alias_attribute</code></a>. As in other aliasing methods, the new name is the first argument, and the old name is the second (one mnemonic is that they go in the same order as if you did an assignment):</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span> <span class='op'>&lt;</span> <span class='const'>ApplicationRecord</span>
  <span class='comment'># You can refer to the email column as &quot;login&quot;.
</span>  <span class='comment'># This can be meaningful for authentication code.
</span>  <span class='id identifier rubyid_alias_attribute'>alias_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_email'>email</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/module/aliasing.rb</code>.</p>

<h4>Internal Attributes</h4>

<p>When you are defining an attribute in a class that is meant to be subclassed, name collisions are a risk. That&#39;s remarkably important for libraries.</p>

<p>Active Support defines the macros <a href="https://api.rubyonrails.org/classes/Module.html#method-i-attr_internal_reader"><code>attr_internal_reader</code></a>, <a href="https://api.rubyonrails.org/classes/Module.html#method-i-attr_internal_writer"><code>attr_internal_writer</code></a>, and <a href="https://api.rubyonrails.org/classes/Module.html#method-i-attr_internal_accessor"><code>attr_internal_accessor</code></a>. They behave like their Ruby built-in <code>attr_*</code> counterparts, except they name the underlying instance variable in a way that makes collisions less likely.</p>

<p>The macro <a href="https://api.rubyonrails.org/classes/Module.html#method-i-attr_internal"><code>attr_internal</code></a> is a synonym for <code>attr_internal_accessor</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># library
</span><span class='kw'>class</span> <span class='const'>ThirdPartyLibrary</span><span class='op'>::</span><span class='const'>Crawler</span>
  <span class='id identifier rubyid_attr_internal'>attr_internal</span> <span class='symbeg'>:</span><span class='id identifier rubyid_log_level'>log_level</span>
<span class='kw'>end</span>

<span class='comment'># client code
</span><span class='kw'>class</span> <span class='const'>MyCrawler</span> <span class='op'>&lt;</span> <span class='const'>ThirdPartyLibrary</span><span class='op'>::</span><span class='const'>Crawler</span>
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_log_level'>log_level</span>
<span class='kw'>end</span></code></pre>

<p>In the previous example it could be the case that <code>:log_level</code> does not belong to the public interface of the library and it is only used for development. The client code, unaware of the potential conflict, subclasses and defines its own <code>:log_level</code>. Thanks to <code>attr_internal</code> there&#39;s no collision.</p>

<p>By default the internal instance variable is named with a leading underscore, <code>@_log_level</code> in the example above. That&#39;s configurable via <a href="Module.html#attr_internal_naming_format-class_method" title="Module.attr_internal_naming_format (method)">Module.attr_internal_naming_format</a> though, you can pass any <code>sprintf</code>-like format string with a leading <code>@</code> and a <code>%s</code> somewhere, which is where the name will be placed. The default is <code>&quot;@_%s&quot;</code>.</p>

<p>Rails uses internal attributes in a few spots, for examples for views:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'><a href="ActionView.html" title="ActionView (module)">ActionView</a></span>
  <span class='kw'>class</span> <span class='const'>Base</span>
    <span class='id identifier rubyid_attr_internal'>attr_internal</span> <span class='symbeg'>:</span><span class='id identifier rubyid_captures'>captures</span>
    <span class='id identifier rubyid_attr_internal'>attr_internal</span> <span class='symbeg'>:</span><span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_layout'>layout</span>
    <span class='id identifier rubyid_attr_internal'>attr_internal</span> <span class='symbeg'>:</span><span class='id identifier rubyid_controller'>controller</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_template'>template</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/module/attr_internal.rb</code>.</p>

<h4>Module Attributes</h4>

<p>The macros <a href="https://api.rubyonrails.org/classes/Module.html#method-i-mattr_reader"><code>mattr_reader</code></a>, <a href="https://api.rubyonrails.org/classes/Module.html#method-i-mattr_writer"><code>mattr_writer</code></a>, and <a href="https://api.rubyonrails.org/classes/Module.html#method-i-mattr_accessor"><code>mattr_accessor</code></a> are the same as the <code>cattr_*</code> macros defined for class. In fact, the <code>cattr_*</code> macros are just aliases for the <code>mattr_*</code> macros. Check <a href="#class-attributes">Class Attributes</a>.</p>

<p>For example, the API for the logger of Active Storage is generated with <code>mattr_accessor</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'><a href="ActiveStorage.html" title="ActiveStorage (module)">ActiveStorage</a></span>
  <span class='id identifier rubyid_mattr_accessor'>mattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/module/attribute_accessors.rb</code>.</p>

<h3>Parents</h3>

<h4><code>module_parent</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/Module.html#method-i-module_parent"><code>module_parent</code></a> method on a nested named module returns the module that contains its corresponding constant:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>X</span>
  <span class='kw'>module</span> <span class='const'>Y</span>
    <span class='kw'>module</span> <span class='const'>Z</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='const'>M</span> <span class='op'>=</span> <span class='const'>X</span><span class='op'>::</span><span class='const'>Y</span><span class='op'>::</span><span class='const'>Z</span>

<span class='const'>X</span><span class='op'>::</span><span class='const'>Y</span><span class='op'>::</span><span class='const'>Z</span>.<span class='id identifier rubyid_module_parent'>module_parent</span> <span class='comment'># =&gt; X::Y
</span><span class='const'>M</span>.<span class='id identifier rubyid_module_parent'>module_parent</span>       <span class='comment'># =&gt; X::Y</span></code></pre>

<p>If the module is anonymous or belongs to the top-level, <code>module_parent</code> returns <a href="Object.html" title="Object (class)"><code>Object</code></a>.</p>

<p>WARNING: Note that in that case <code>module_parent_name</code> returns <code>nil</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/introspection.rb</code>.</p>

<h4><code>module_parent_name</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/Module.html#method-i-module_parent_name"><code>module_parent_name</code></a> method on a nested named module returns the fully qualified name of the module that contains its corresponding constant:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>X</span>
  <span class='kw'>module</span> <span class='const'>Y</span>
    <span class='kw'>module</span> <span class='const'>Z</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='const'>M</span> <span class='op'>=</span> <span class='const'>X</span><span class='op'>::</span><span class='const'>Y</span><span class='op'>::</span><span class='const'>Z</span>

<span class='const'>X</span><span class='op'>::</span><span class='const'>Y</span><span class='op'>::</span><span class='const'>Z</span>.<span class='id identifier rubyid_module_parent_name'>module_parent_name</span> <span class='comment'># =&gt; &quot;X::Y&quot;
</span><span class='const'>M</span>.<span class='id identifier rubyid_module_parent_name'>module_parent_name</span>       <span class='comment'># =&gt; &quot;X::Y&quot;</span></code></pre>

<p>For top-level or anonymous modules <code>module_parent_name</code> returns <code>nil</code>.</p>

<p>WARNING: Note that in that case <code>module_parent</code> returns <a href="Object.html" title="Object (class)"><code>Object</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/introspection.rb</code>.</p>

<h4><code>module_parents</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Module.html#method-i-module_parents"><code>module_parents</code></a> calls <code>module_parent</code> on the receiver and upwards until <a href="Object.html" title="Object (class)"><code>Object</code></a> is reached. The chain is returned in an array, from bottom to top:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>X</span>
  <span class='kw'>module</span> <span class='const'>Y</span>
    <span class='kw'>module</span> <span class='const'>Z</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='const'>M</span> <span class='op'>=</span> <span class='const'>X</span><span class='op'>::</span><span class='const'>Y</span><span class='op'>::</span><span class='const'>Z</span>

<span class='const'>X</span><span class='op'>::</span><span class='const'>Y</span><span class='op'>::</span><span class='const'>Z</span>.<span class='id identifier rubyid_module_parents'>module_parents</span> <span class='comment'># =&gt; [X::Y, X, Object]
</span><span class='const'>M</span>.<span class='id identifier rubyid_module_parents'>module_parents</span>       <span class='comment'># =&gt; [X::Y, X, Object]</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/module/introspection.rb</code>.</p>

<h3>Anonymous</h3>

<p>A module may or may not have a name:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>M</span>
<span class='kw'>end</span>
<span class='const'>M</span>.<span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &quot;M&quot;
</span>
<span class='const'>N</span> <span class='op'>=</span> <span class='const'><a href="Module.html" title="Module (class)">Module</a></span>.<span class='id identifier rubyid_new'>new</span>
<span class='const'>N</span>.<span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &quot;N&quot;
</span>
<span class='const'><a href="Module.html" title="Module (class)">Module</a></span>.<span class='id identifier rubyid_new'>new</span>.<span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; nil</span></code></pre>

<p>You can check whether a module has a name with the predicate <a href="https://api.rubyonrails.org/classes/Module.html#method-i-anonymous-3F"><code>anonymous?</code></a>:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>M</span>
<span class='kw'>end</span>
<span class='const'>M</span>.<span class='id identifier rubyid_anonymous?'>anonymous?</span> <span class='comment'># =&gt; false
</span>
<span class='const'><a href="Module.html" title="Module (class)">Module</a></span>.<span class='id identifier rubyid_new'>new</span>.<span class='id identifier rubyid_anonymous?'><a href="Module.html#anonymous%3F-instance_method" title="Module#anonymous? (method)">anonymous?</a></span> <span class='comment'># =&gt; true</span></code></pre>

<p>Note that being unreachable does not imply being anonymous:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>M</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='const'><a href="Object.html" title="Object (class)">Object</a></span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_remove_const'>remove_const</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>M</span>)

<span class='id identifier rubyid_m'>m</span>.<span class='id identifier rubyid_anonymous?'>anonymous?</span> <span class='comment'># =&gt; false</span></code></pre>

<p>though an anonymous module is unreachable by definition.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/anonymous.rb</code>.</p>

<h3>Method Delegation</h3>

<h4><code>delegate</code></h4>

<p>The macro <a href="https://api.rubyonrails.org/classes/Module.html#method-i-delegate"><code>delegate</code></a> offers an easy way to forward methods.</p>

<p>Let&#39;s imagine that users in some application have login information in the <code>User</code> model but name and other data in a separate <code>Profile</code> model:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span> <span class='op'>&lt;</span> <span class='const'>ApplicationRecord</span>
  <span class='id identifier rubyid_has_one'>has_one</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span>
<span class='kw'>end</span></code></pre>

<p>With that configuration you get a user&#39;s name via their profile, <code>user.profile.name</code>, but it could be handy to still be able to access such attribute directly:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span> <span class='op'>&lt;</span> <span class='const'>ApplicationRecord</span>
  <span class='id identifier rubyid_has_one'>has_one</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_profile'>profile</span>.<span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>That is what <code>delegate</code> does for you:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span> <span class='op'>&lt;</span> <span class='const'>ApplicationRecord</span>
  <span class='id identifier rubyid_has_one'>has_one</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span>

  <span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span>
<span class='kw'>end</span></code></pre>

<p>It is shorter, and the intention more obvious.</p>

<p>The method must be public in the target.</p>

<p>The <code>delegate</code> macro accepts several methods:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_age'>age</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_twitter'>twitter</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span></code></pre>

<p>When interpolated into a string, the <code>:to</code> option should become an expression that evaluates to the object the method is delegated to. Typically a string or symbol. Such an expression is evaluated in the context of the receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># delegates to the Rails constant
</span><span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>

<span class='comment'># delegates to the receiver&#39;s class
</span><span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_table_name'>table_name</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='kw'>class</span></code></pre>

<p>WARNING: If the <code>:prefix</code> option is <code>true</code> this is less generic, see below.</p>

<p>By default, if the delegation raises <code>NoMethodError</code> and the target is <code>nil</code> the exception is propagated. You can ask that <code>nil</code> is returned instead with the <code>:allow_nil</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span><span class='comma'>,</span> <span class='label'>allow_nil:</span> <span class='kw'>true</span></code></pre>

<p>With <code>:allow_nil</code> the call <code>user.name</code> returns <code>nil</code> if the user has no profile.</p>

<p>The option <code>:prefix</code> adds a prefix to the name of the generated method. This may be handy for example to get a better name:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_street'>street</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='kw'>true</span></code></pre>

<p>The previous example generates <code>address_street</code> rather than <code>street</code>.</p>

<p>WARNING: Since in this case the name of the generated method is composed of the target object and target method names, the <code>:to</code> option must be a method name.</p>

<p>A custom prefix may also be configured:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_attachment'>attachment</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_avatar'>avatar</span></code></pre>

<p>In the previous example the macro generates <code>avatar_size</code> rather than <code>size</code>.</p>

<p>The option <code>:private</code> changes methods scope:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_date_of_birth'>date_of_birth</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span><span class='comma'>,</span> <span class='label'>private:</span> <span class='kw'>true</span></code></pre>

<p>The delegated methods are public by default. Pass <code>private: true</code> to change that.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/delegation.rb</code></p>

<h4><code>delegate_missing_to</code></h4>

<p>Imagine you would like to delegate everything missing from the <code>User</code> object,
to the <code>Profile</code> one. The <a href="https://api.rubyonrails.org/classes/Module.html#method-i-delegate_missing_to"><code>delegate_missing_to</code></a> macro lets you implement this
in a breeze:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span> <span class='op'>&lt;</span> <span class='const'>ApplicationRecord</span>
  <span class='id identifier rubyid_has_one'>has_one</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span>

  <span class='id identifier rubyid_delegate_missing_to'>delegate_missing_to</span> <span class='symbeg'>:</span><span class='id identifier rubyid_profile'>profile</span>
<span class='kw'>end</span></code></pre>

<p>The target can be anything callable within the object, e.g. instance variables,
methods, constants, etc. Only the public methods of the target are delegated.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/delegation.rb</code>.</p>

<h3>Redefining Methods</h3>

<p>There are cases where you need to define a method with <code>define_method</code>, but don&#39;t know whether a method with that name already exists. If it does, a warning is issued if they are enabled. No big deal, but not clean either.</p>

<p>The method <a href="https://api.rubyonrails.org/classes/Module.html#method-i-redefine_method"><code>redefine_method</code></a> prevents such a potential warning, removing the existing method before if needed.</p>

<p>You can also use <a href="https://api.rubyonrails.org/classes/Module.html#method-i-silence_redefinition_of_method"><code>silence_redefinition_of_method</code></a> if you need to define
the replacement method yourself (because you&#39;re using <code>delegate</code>, for
example).</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/redefine_method.rb</code>.</p>

<h2>Extensions to <a href="Class.html" title="Class (class)"><code>Class</code></a></h2>

<h3>Class Attributes</h3>

<h4><code>class_attribute</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Class.html#method-i-class_attribute"><code>class_attribute</code></a> declares one or more inheritable class attributes that can be overridden at any level down the hierarchy.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>A</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_x'>x</span>
<span class='kw'>end</span>

<span class='kw'>class</span> <span class='const'>B</span> <span class='op'>&lt;</span> <span class='const'>A</span><span class='semicolon'>;</span> <span class='kw'>end</span>

<span class='kw'>class</span> <span class='const'>C</span> <span class='op'>&lt;</span> <span class='const'>B</span><span class='semicolon'>;</span> <span class='kw'>end</span>

<span class='const'>A</span>.<span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>
<span class='const'>B</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; :a
</span><span class='const'>C</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; :a
</span>
<span class='const'>B</span>.<span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_b'>b</span>
<span class='const'>A</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; :a
</span><span class='const'>C</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; :b
</span>
<span class='const'>C</span>.<span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_c'>c</span>
<span class='const'>A</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; :a
</span><span class='const'>B</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; :b</span></code></pre>

<p>For example <a href="ActionMailer/Base.html" title="ActionMailer::Base (class)"><code>::ActionMailer::Base</code></a> defines:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_default_params'>default_params</span>
<span class='kw'>self</span>.<span class='id identifier rubyid_default_params'>default_params</span> <span class='op'>=</span> {
  <span class='label'>mime_version:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>charset:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UTF-8</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>text/plain</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>parts_order:</span> [ <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>text/plain</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>text/enriched</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>text/html</span><span class='tstring_end'>&quot;</span></span> ]
}.<span class='id identifier rubyid_freeze'>freeze</span></code></pre>

<p>They can also be accessed and overridden at the instance level.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>A</span>.<span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='int'>1</span>

<span class='id identifier rubyid_a1'>a1</span> <span class='op'>=</span> <span class='const'>A</span>.<span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_a2'>a2</span> <span class='op'>=</span> <span class='const'>A</span>.<span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_a2'>a2</span>.<span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='int'>2</span>

<span class='id identifier rubyid_a1'>a1</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; 1, comes from A
</span><span class='id identifier rubyid_a2'>a2</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># =&gt; 2, overridden in a2</span></code></pre>

<p>The generation of the writer instance method can be prevented by setting the option <code>:instance_writer</code> to <code>false</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'><a href="ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span>
  <span class='kw'>class</span> <span class='const'>Base</span>
    <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_table_name_prefix'>table_name_prefix</span><span class='comma'>,</span> <span class='label'>instance_writer:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>A model may find that option useful as a way to prevent mass-assignment from setting the attribute.</p>

<p>The generation of the reader instance method can be prevented by setting the option <code>:instance_reader</code> to <code>false</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>A</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='label'>instance_reader:</span> <span class='kw'>false</span>
<span class='kw'>end</span>

<span class='const'>A</span>.<span class='id identifier rubyid_new'>new</span>.<span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='const'>A</span>.<span class='id identifier rubyid_new'>new</span>.<span class='id identifier rubyid_x'>x</span> <span class='comment'># NoMethodError</span></code></pre>

<p>For convenience <code>class_attribute</code> also defines an instance predicate which is the double negation of what the instance reader returns. In the examples above it would be called <code>x?</code>.</p>

<p>When <code>:instance_reader</code> is <code>false</code>, the instance predicate returns a <code>NoMethodError</code> just like the reader method.</p>

<p>If you do not want the instance predicate, pass <code>instance_predicate: false</code> and it will not be defined.</p>

<p>NOTE: Defined in <code>active_support/core_ext/class/attribute.rb</code>.</p>

<h4><code>cattr_reader</code>, <code>cattr_writer</code>, and <code>cattr_accessor</code></h4>

<p>The macros <a href="https://api.rubyonrails.org/classes/Module.html#method-i-cattr_reader"><code>cattr_reader</code></a>, <a href="https://api.rubyonrails.org/classes/Module.html#method-i-cattr_writer"><code>cattr_writer</code></a>, and <a href="https://api.rubyonrails.org/classes/Module.html#method-i-cattr_accessor"><code>cattr_accessor</code></a> are analogous to their <code>attr_*</code> counterparts but for classes. They initialize a class variable to <code>nil</code> unless it already exists, and generate the corresponding class methods to access it:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>MysqlAdapter</span> <span class='op'>&lt;</span> <span class='const'>AbstractAdapter</span>
  <span class='comment'># Generates class methods to access @@emulate_booleans.
</span>  <span class='id identifier rubyid_cattr_accessor'>cattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_emulate_booleans'>emulate_booleans</span>
<span class='kw'>end</span></code></pre>

<p>Also, you can pass a block to <code>cattr_*</code> to set up the attribute with a default value:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>MysqlAdapter</span> <span class='op'>&lt;</span> <span class='const'>AbstractAdapter</span>
  <span class='comment'># Generates class methods to access @@emulate_booleans with default value of true.
</span>  <span class='id identifier rubyid_cattr_accessor'>cattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_emulate_booleans'>emulate_booleans</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='kw'>true</span>
<span class='kw'>end</span></code></pre>

<p>Instance methods are also created for convenience, but they are simply proxies to the internal value which is shared among the class. As a result, when an instance modifies the value, this affects the entire class hierarchy. This behavior is different than <code>class_attribute</code> (see above).</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Foo</span>
  <span class='id identifier rubyid_cattr_accessor'>cattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_instance'>instance</span> <span class='op'>=</span> <span class='const'>Foo</span>.<span class='id identifier rubyid_new'>new</span>

<span class='const'>Foo</span>.<span class='id identifier rubyid_bar'>bar</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='id identifier rubyid_instance'>instance</span>.<span class='id identifier rubyid_bar'>bar</span> <span class='comment'># =&gt; 1
</span>
<span class='id identifier rubyid_instance'>instance</span>.<span class='id identifier rubyid_bar'>bar</span> <span class='op'>=</span> <span class='int'>2</span>
<span class='const'>Foo</span>.<span class='id identifier rubyid_bar'>bar</span> <span class='comment'># =&gt; 2</span></code></pre>

<p>The generation of the reader instance method can be prevented by setting <code>:instance_reader</code> to <code>false</code> and the generation of the writer instance method can be prevented by setting <code>:instance_writer</code> to <code>false</code>. Generation of both methods can be prevented by setting <code>:instance_accessor</code> to <code>false</code>. In all cases, the value must be exactly <code>false</code> and not any false value.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>A</span>
  <span class='kw'>class</span> <span class='const'>B</span>
    <span class='comment'># No first_name instance reader is generated.
</span>    <span class='id identifier rubyid_cattr_accessor'>cattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_first_name'>first_name</span><span class='comma'>,</span> <span class='label'>instance_reader:</span> <span class='kw'>false</span>
    <span class='comment'># No last_name= instance writer is generated.
</span>    <span class='id identifier rubyid_cattr_accessor'>cattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_last_name'>last_name</span><span class='comma'>,</span> <span class='label'>instance_writer:</span> <span class='kw'>false</span>
    <span class='comment'># No surname instance reader or surname= writer is generated.
</span>    <span class='id identifier rubyid_cattr_accessor'>cattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_surname'>surname</span><span class='comma'>,</span> <span class='label'>instance_accessor:</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>A model may find it useful to set <code>:instance_accessor</code> to <code>false</code> as a way to prevent mass-assignment from setting the attribute.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/attribute_accessors.rb</code>.</p>

<h3>Descendants</h3>

<h4><code>descendants</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/Class.html#method-i-descendants"><code>descendants</code></a> method returns all classes that are <code>&lt;</code> than its receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span><span class='semicolon'>;</span> <span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_descendants'>descendants</span> <span class='comment'># =&gt; []
</span>
<span class='kw'>class</span> <span class='const'>B</span> <span class='op'>&lt;</span> <span class='const'>C</span><span class='semicolon'>;</span> <span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_descendants'>descendants</span> <span class='comment'># =&gt; [B]
</span>
<span class='kw'>class</span> <span class='const'>A</span> <span class='op'>&lt;</span> <span class='const'>B</span><span class='semicolon'>;</span> <span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_descendants'>descendants</span> <span class='comment'># =&gt; [B, A]
</span>
<span class='kw'>class</span> <span class='const'>D</span> <span class='op'>&lt;</span> <span class='const'>C</span><span class='semicolon'>;</span> <span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_descendants'>descendants</span> <span class='comment'># =&gt; [B, A, D]</span></code></pre>

<p>The order in which these classes are returned is unspecified.</p>

<p>NOTE: Defined in <code>active_support/core_ext/class/subclasses.rb</code>.</p>

<h2>Extensions to <a href="String.html" title="String (class)"><code>String</code></a></h2>

<h3>Output Safety</h3>

<h4>Motivation</h4>

<p>Inserting data into HTML templates needs extra care. For example, you can&#39;t just interpolate <code>@review.title</code> verbatim into an HTML page. For one thing, if the review title is &quot;Flanagan &amp; Matz rules!&quot; the output won&#39;t be well-formed because an ampersand has to be escaped as &quot;&amp;amp;&quot;. What&#39;s more, depending on the application, that may be a big security hole because users can inject malicious HTML setting a hand-crafted review title. Check out the section about cross-site scripting in the <a href="security.html#cross-site-scripting-xss">Security guide</a> for further information about the risks.</p>

<h4>Safe Strings</h4>

<p>Active Support has the concept of <em>(html) safe</em> strings. A safe string is one that is marked as being insertable into HTML as is. It is trusted, no matter whether it has been escaped or not.</p>

<p>Strings are considered to be <em>unsafe</em> by default:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_html_safe?'>html_safe?</span> <span class='comment'># =&gt; false</span></code></pre>

<p>You can obtain a safe string from a given one with the <a href="https://api.rubyonrails.org/classes/String.html#method-i-html_safe"><code>html_safe</code></a> method:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_html_safe'>html_safe</span>
<span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_html_safe?'>html_safe?</span> <span class='comment'># =&gt; true</span></code></pre>

<p>It is important to understand that <code>html_safe</code> performs no escaping whatsoever, it is just an assertion:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;script&gt;...&lt;/script&gt;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_html_safe'>html_safe</span>
<span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_html_safe?'>html_safe?</span> <span class='comment'># =&gt; true
</span><span class='id identifier rubyid_s'>s</span>            <span class='comment'># =&gt; &quot;&lt;script&gt;...&lt;/script&gt;&quot;</span></code></pre>

<p>It is your responsibility to ensure calling <code>html_safe</code> on a particular string is fine.</p>

<p>If you append onto a safe string, either in-place with <code>concat</code>/<code>&lt;&lt;</code>, or with <code>+</code>, the result is a safe string. Unsafe arguments are escaped:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_html_safe'>html_safe</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># =&gt; &quot;&amp;lt;&quot;</span></code></pre>

<p>Safe arguments are directly appended:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_html_safe'>html_safe</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_html_safe'>html_safe</span> <span class='comment'># =&gt; &quot;&lt;&quot;</span></code></pre>

<p>These methods should not be used in ordinary views. Unsafe values are automatically escaped:</p>

<pre class="code xml"><code class="xml">&lt;%= @review.title %&gt; &lt;%# fine, escaped if needed %&gt;
</code></pre>

<p>To insert something verbatim use the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/OutputSafetyHelper.html#method-i-raw"><code>raw</code></a> helper rather than calling <code>html_safe</code>:</p>

<pre class="code xml"><code class="xml">&lt;%= raw @cms.current_template %&gt; &lt;%# inserts @cms.current_template as is %&gt;
</code></pre>

<p>or, equivalently, use <code>&lt;%==</code>:</p>

<pre class="code xml"><code class="xml">&lt;%== @cms.current_template %&gt; &lt;%# inserts @cms.current_template as is %&gt;
</code></pre>

<p>The <code>raw</code> helper calls <code>html_safe</code> for you:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_raw'>raw</span>(<span class='id identifier rubyid_stringish'>stringish</span>)
  <span class='id identifier rubyid_stringish'>stringish</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_html_safe'>html_safe</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/output_safety.rb</code>.</p>

<h4>Transformation</h4>

<p>As a rule of thumb, except perhaps for concatenation as explained above, any method that may change a string gives you an unsafe string. These are <code>downcase</code>, <code>gsub</code>, <code>strip</code>, <code>chomp</code>, <code>underscore</code>, etc.</p>

<p>In the case of in-place transformations like <code>gsub!</code> the receiver itself becomes unsafe.</p>

<p>INFO: The safety bit is lost always, no matter whether the transformation actually changed something.</p>

<h4>Conversion and Coercion</h4>

<p>Calling <code>to_s</code> on a safe string returns a safe string, but coercion with <code>to_str</code> returns an unsafe string.</p>

<h4>Copying</h4>

<p>Calling <code>dup</code> or <code>clone</code> on safe strings yields safe strings.</p>

<h3><code>remove</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-remove"><code>remove</code></a> will remove all occurrences of the pattern:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello World</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_remove'>remove</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Hello </span><span class='regexp_end'>/</span></span>) <span class='comment'># =&gt; &quot;World&quot;</span></code></pre>

<p>There&#39;s also the destructive version <a href="String.html#remove!-instance_method" title="String#remove! (method)">String#remove!</a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3><code>squish</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-squish"><code>squish</code></a> strips leading and trailing whitespace, and substitutes runs of whitespace with a single space each:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> \n  foo\n\r \t bar \n</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_squish'>squish</span> <span class='comment'># =&gt; &quot;foo bar&quot;</span></code></pre>

<p>There&#39;s also the destructive version <a href="String.html#squish!-instance_method" title="String#squish! (method)">String#squish!</a>.</p>

<p>Note that it handles both ASCII and Unicode whitespace.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3><code>truncate</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-truncate"><code>truncate</code></a> returns a copy of its receiver truncated after a given <code>length</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate'>truncate</span>(<span class='int'>20</span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh dear!...&quot;</span></code></pre>

<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate'>truncate</span>(<span class='int'>20</span><span class='comma'>,</span> <span class='label'>omission:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;hellip;</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh &amp;hellip;&quot;</span></code></pre>

<p>Note in particular that truncation takes into account the length of the omission string.</p>

<p>Pass a <code>:separator</code> to truncate the string at a natural break:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate'>truncate</span>(<span class='int'>18</span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh dea...&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate'>truncate</span>(<span class='int'>18</span><span class='comma'>,</span> <span class='label'>separator:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh...&quot;</span></code></pre>

<p>The option <code>:separator</code> can be a regexp:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate'>truncate</span>(<span class='int'>18</span><span class='comma'>,</span> <span class='label'>separator:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s</span><span class='regexp_end'>/</span></span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh...&quot;</span></code></pre>

<p>In above examples &quot;dear&quot; gets cut first, but then <code>:separator</code> prevents it.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3><code>truncate_bytes</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-truncate_bytes"><code>truncate_bytes</code></a> returns a copy of its receiver truncated to at most <code>bytesize</code> bytes:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>👍👍👍👍</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate_bytes'>truncate_bytes</span>(<span class='int'>15</span>)
<span class='comment'># =&gt; &quot;👍👍👍…&quot;</span></code></pre>

<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>👍👍👍👍</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate_bytes'>truncate_bytes</span>(<span class='int'>15</span><span class='comma'>,</span> <span class='label'>omission:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>🖖</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;👍👍🖖&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3><code>truncate_words</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-truncate_words"><code>truncate_words</code></a> returns a copy of its receiver truncated after a given number of words:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate_words'>truncate_words</span>(<span class='int'>4</span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh dear!...&quot;</span></code></pre>

<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate_words'>truncate_words</span>(<span class='int'>4</span><span class='comma'>,</span> <span class='label'>omission:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;hellip;</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh dear!&amp;hellip;&quot;</span></code></pre>

<p>Pass a <code>:separator</code> to truncate the string at a natural break:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate_words'>truncate_words</span>(<span class='int'>3</span><span class='comma'>,</span> <span class='label'>separator:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh dear! I shall be late...&quot;</span></code></pre>

<p>The option <code>:separator</code> can be a regexp:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Oh dear! Oh dear! I shall be late!</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_truncate_words'>truncate_words</span>(<span class='int'>4</span><span class='comma'>,</span> <span class='label'>separator:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s</span><span class='regexp_end'>/</span></span>)
<span class='comment'># =&gt; &quot;Oh dear! Oh dear!...&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3><code>inquiry</code></h3>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-inquiry"><code>inquiry</code></a> method converts a string into a <code>StringInquirer</code> object making equality checks prettier.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>production</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_inquiry'>inquiry</span>.<span class='id identifier rubyid_production?'>production?</span> <span class='comment'># =&gt; true
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_inquiry'>inquiry</span>.<span class='id identifier rubyid_inactive?'>inactive?</span>       <span class='comment'># =&gt; false</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inquiry.rb</code>.</p>

<h3><code>starts_with?</code> and <code>ends_with?</code></h3>

<p>Active Support defines 3rd person aliases of <code>String#start_with?</code> and <code>String#end_with?</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>f</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; true
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>o</span><span class='tstring_end'>&quot;</span></span>)   <span class='comment'># =&gt; true</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/starts_ends_with.rb</code>.</p>

<h3><code>strip_heredoc</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-strip_heredoc"><code>strip_heredoc</code></a> strips indentation in heredocs.</p>

<p>For example in</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_usage'>usage</span>]
  <span class='id identifier rubyid_puts'>puts</span> <span class='heredoc_beg'>&lt;&lt;-USAGE</span>.<span class='id identifier rubyid_strip_heredoc'>strip_heredoc</span>
<span class='tstring_content'>    This command does such and such.

    Supported options are:
      -h         This message
      #...
</span><span class='heredoc_end'>  USAGE
</span><span class='kw'>end</span></code></pre>

<p>the user would see the usage message aligned against the left margin.</p>

<p>Technically, it looks for the least indented line in the whole string, and removes
that amount of leading whitespace.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/strip.rb</code>.</p>

<h3><code>indent</code></h3>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-indent"><code>indent</code></a> method indents the lines in the receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='heredoc_beg'>&lt;&lt;EOS</span>.<span class='id identifier rubyid_indent'>indent</span>(<span class='int'>2</span>)
<span class='tstring_content'>def some_method
  some_code
end
</span><span class='heredoc_end'>EOS
</span><span class='comment'># =&gt;
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_some_method'>some_method</span>
    <span class='id identifier rubyid_some_code'>some_code</span>
  <span class='kw'>end</span></code></pre>

<p>The second argument, <code>indent_string</code>, specifies which indent string to use. The default is <code>nil</code>, which tells the method to make an educated guess peeking at the first indented line, and fallback to a space if there is none.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  foo</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_indent'>indent</span>(<span class='int'>2</span>)        <span class='comment'># =&gt; &quot;    foo&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo\n\t\tbar</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_indent'>indent</span>(<span class='int'>2</span>) <span class='comment'># =&gt; &quot;\t\tfoo\n\t\t\t\tbar&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_indent'>indent</span>(<span class='int'>2</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span>)    <span class='comment'># =&gt; &quot;\t\tfoo&quot;</span></code></pre>

<p>While <code>indent_string</code> is typically one space or tab, it may be any string.</p>

<p>The third argument, <code>indent_empty_lines</code>, is a flag that says whether empty lines should be indented. Default is false.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo\n\nbar</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_indent'>indent</span>(<span class='int'>2</span>)            <span class='comment'># =&gt; &quot;  foo\n\n  bar&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo\n\nbar</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_indent'>indent</span>(<span class='int'>2</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span>) <span class='comment'># =&gt; &quot;  foo\n  \n  bar&quot;</span></code></pre>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-indent-21"><code>indent!</code></a> method performs indentation in-place.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/indent.rb</code>.</p>

<h3>Access</h3>

<h4><code>at(position)</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-at"><code>at</code></a> method returns the character of the string at position <code>position</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_at'>at</span>(<span class='int'>0</span>)  <span class='comment'># =&gt; &quot;h&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_at'>at</span>(<span class='int'>4</span>)  <span class='comment'># =&gt; &quot;o&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_at'>at</span>(<span class='op'>-</span><span class='int'>1</span>) <span class='comment'># =&gt; &quot;o&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_at'>at</span>(<span class='int'>10</span>) <span class='comment'># =&gt; nil</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4><code>from(position)</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-from"><code>from</code></a> method returns the substring of the string starting at position <code>position</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_from'>from</span>(<span class='int'>0</span>)  <span class='comment'># =&gt; &quot;hello&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_from'>from</span>(<span class='int'>2</span>)  <span class='comment'># =&gt; &quot;llo&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_from'>from</span>(<span class='op'>-</span><span class='int'>2</span>) <span class='comment'># =&gt; &quot;lo&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_from'>from</span>(<span class='int'>10</span>) <span class='comment'># =&gt; nil</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4><code>to(position)</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-to"><code>to</code></a> method returns the substring of the string up to position <code>position</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to'>to</span>(<span class='int'>0</span>)  <span class='comment'># =&gt; &quot;h&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to'>to</span>(<span class='int'>2</span>)  <span class='comment'># =&gt; &quot;hel&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to'>to</span>(<span class='op'>-</span><span class='int'>2</span>) <span class='comment'># =&gt; &quot;hell&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to'>to</span>(<span class='int'>10</span>) <span class='comment'># =&gt; &quot;hello&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4><code>first(limit = 1)</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-first"><code>first</code></a> method returns a substring containing the first <code>limit</code> characters of the string.</p>

<p>The call <code>str.first(n)</code> is equivalent to <code>str.to(n-1)</code> if <code>n</code> &gt; 0, and returns an empty string for <code>n</code> == 0.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4><code>last(limit = 1)</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-last"><code>last</code></a> method returns a substring containing the last <code>limit</code> characters of the string.</p>

<p>The call <code>str.last(n)</code> is equivalent to <code>str.from(-n)</code> if <code>n</code> &gt; 0, and returns an empty string for <code>n</code> == 0.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h3>Inflections</h3>

<h4><code>pluralize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-pluralize"><code>pluralize</code></a> returns the plural of its receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>table</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_pluralize'>pluralize</span>     <span class='comment'># =&gt; &quot;tables&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_pluralize'>pluralize</span>      <span class='comment'># =&gt; &quot;rubies&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>equipment</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_pluralize'>pluralize</span> <span class='comment'># =&gt; &quot;equipment&quot;</span></code></pre>

<p>As the previous example shows, Active Support knows some irregular plurals and uncountable nouns. Built-in rules can be extended in <code>config/initializers/inflections.rb</code>. This file is generated by default, by the <code>rails new</code> command and has instructions in comments.</p>

<p><code>pluralize</code> can also take an optional <code>count</code> parameter. If <code>count == 1</code> the singular form will be returned. For any other value of <code>count</code> the plural form will be returned:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dude</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_pluralize'>pluralize</span>(<span class='int'>0</span>) <span class='comment'># =&gt; &quot;dudes&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dude</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_pluralize'>pluralize</span>(<span class='int'>1</span>) <span class='comment'># =&gt; &quot;dude&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dude</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_pluralize'>pluralize</span>(<span class='int'>2</span>) <span class='comment'># =&gt; &quot;dudes&quot;</span></code></pre>

<p>Active Record uses this method to compute the default table name that corresponds to a model:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># active_record/model_schema.rb
</span><span class='kw'>def</span> <span class='id identifier rubyid_undecorated_table_name'>undecorated_table_name</span>(<span class='id identifier rubyid_model_name'>model_name</span>)
  <span class='id identifier rubyid_table_name'>table_name</span> <span class='op'>=</span> <span class='id identifier rubyid_model_name'>model_name</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_demodulize'>demodulize</span>.<span class='id identifier rubyid_underscore'>underscore</span>
  <span class='id identifier rubyid_pluralize_table_names'>pluralize_table_names</span> <span class='op'>?</span> <span class='id identifier rubyid_table_name'>table_name</span>.<span class='id identifier rubyid_pluralize'>pluralize</span> <span class='op'>:</span> <span class='id identifier rubyid_table_name'>table_name</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>singularize</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/String.html#method-i-singularize"><code>singularize</code></a> method is the inverse of <code>pluralize</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tables</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_singularize'>singularize</span>    <span class='comment'># =&gt; &quot;table&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rubies</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_singularize'>singularize</span>    <span class='comment'># =&gt; &quot;ruby&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>equipment</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_singularize'>singularize</span> <span class='comment'># =&gt; &quot;equipment&quot;</span></code></pre>

<p>Associations compute the name of the corresponding default associated class using this method:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># active_record/reflection.rb
</span><span class='kw'>def</span> <span class='id identifier rubyid_derive_class_name'>derive_class_name</span>
  <span class='id identifier rubyid_class_name'>class_name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_camelize'>camelize</span>
  <span class='id identifier rubyid_class_name'>class_name</span> <span class='op'>=</span> <span class='id identifier rubyid_class_name'>class_name</span>.<span class='id identifier rubyid_singularize'>singularize</span> <span class='kw'>if</span> <span class='id identifier rubyid_collection?'>collection?</span>
  <span class='id identifier rubyid_class_name'>class_name</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>camelize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-camelize"><code>camelize</code></a> returns its receiver in camel case:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>product</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_camelize'>camelize</span>    <span class='comment'># =&gt; &quot;Product&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>admin_user</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_camelize'>camelize</span> <span class='comment'># =&gt; &quot;AdminUser&quot;</span></code></pre>

<p>As a rule of thumb you can think of this method as the one that transforms paths into Ruby class or module names, where slashes separate namespaces:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>backoffice/session</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_camelize'>camelize</span> <span class='comment'># =&gt; &quot;Backoffice::Session&quot;</span></code></pre>

<p>For example, Action Pack uses this method to load the class that provides a certain session store:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># action_controller/metal/session_management.rb
</span><span class='kw'>def</span> <span class='id identifier rubyid_session_store='>session_store=</span>(<span class='id identifier rubyid_store'>store</span>)
  <span class='cvar'>@@session_store</span> <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Symbol.html" title="Symbol (class)">Symbol</a></span>) <span class='op'>?</span>
    <span class='const'><a href="ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a></span><span class='op'>::</span><span class='const'><a href="ActionDispatch/Session.html" title="ActionDispatch::Session (module)">Session</a></span>.<span class='id identifier rubyid_const_get'>const_get</span>(<span class='id identifier rubyid_store'>store</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_camelize'>camelize</span>) <span class='op'>:</span>
    <span class='id identifier rubyid_store'>store</span>
<span class='kw'>end</span></code></pre>

<p><code>camelize</code> accepts an optional argument, it can be <code>:upper</code> (default), or <code>:lower</code>. With the latter the first letter becomes lowercase:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>visual_effect</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_camelize'>camelize</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_lower'>lower</span>) <span class='comment'># =&gt; &quot;visualEffect&quot;</span></code></pre>

<p>That may be handy to compute method names in a language that follows that convention, for example JavaScript.</p>

<p>INFO: As a rule of thumb you can think of <code>camelize</code> as the inverse of <code>underscore</code>, though there are cases where that does not hold: <code>&quot;SSLError&quot;.underscore.camelize</code> gives back <code>&quot;SslError&quot;</code>. To support cases such as this, Active Support allows you to specify acronyms in <code>config/initializers/inflections.rb</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="ActiveSupport/Inflector.html" title="ActiveSupport::Inflector (module)">Inflector</a></span>.<span class='id identifier rubyid_inflections'><a href="ActiveSupport/Inflector.html#inflections-instance_method" title="ActiveSupport::Inflector#inflections (method)">inflections</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_inflect'>inflect</span><span class='op'>|</span>
  <span class='id identifier rubyid_inflect'>inflect</span>.<span class='id identifier rubyid_acronym'>acronym</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SSL</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>

<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SSLError</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_underscore'>underscore</span>.<span class='id identifier rubyid_camelize'>camelize</span> <span class='comment'># =&gt; &quot;SSLError&quot;</span></code></pre>

<p><code>camelize</code> is aliased to <a href="https://api.rubyonrails.org/classes/String.html#method-i-camelcase"><code>camelcase</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>underscore</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-underscore"><code>underscore</code></a> goes the other way around, from camel case to paths:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Product</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_underscore'>underscore</span>   <span class='comment'># =&gt; &quot;product&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AdminUser</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_underscore'>underscore</span> <span class='comment'># =&gt; &quot;admin_user&quot;</span></code></pre>

<p>Also converts &quot;::&quot; back to &quot;/&quot;:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Backoffice::Session</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_underscore'>underscore</span> <span class='comment'># =&gt; &quot;backoffice/session&quot;</span></code></pre>

<p>and understands strings that start with lowercase:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>visualEffect</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_underscore'>underscore</span> <span class='comment'># =&gt; &quot;visual_effect&quot;</span></code></pre>

<p><code>underscore</code> accepts no argument though.</p>

<p>Rails uses <code>underscore</code> to get a lowercased name for controller classes:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># actionpack/lib/abstract_controller/base.rb
</span><span class='kw'>def</span> <span class='id identifier rubyid_controller_path'>controller_path</span>
  <span class='ivar'>@controller_path</span> <span class='op'>||=</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Controller</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_underscore'>underscore</span>
<span class='kw'>end</span></code></pre>

<p>For example, that value is the one you get in <code>params[:controller]</code>.</p>

<p>INFO: As a rule of thumb you can think of <code>underscore</code> as the inverse of <code>camelize</code>, though there are cases where that does not hold. For example, <code>&quot;SSLError&quot;.underscore.camelize</code> gives back <code>&quot;SslError&quot;</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>titleize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-titleize"><code>titleize</code></a> capitalizes the words in the receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>alice in wonderland</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_titleize'>titleize</span> <span class='comment'># =&gt; &quot;Alice In Wonderland&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fermat&#39;s enigma</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_titleize'>titleize</span>     <span class='comment'># =&gt; &quot;Fermat&#39;s Enigma&quot;</span></code></pre>

<p><code>titleize</code> is aliased to <a href="https://api.rubyonrails.org/classes/String.html#method-i-titlecase"><code>titlecase</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>dasherize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-dasherize"><code>dasherize</code></a> replaces the underscores in the receiver with dashes:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_dasherize'>dasherize</span>         <span class='comment'># =&gt; &quot;name&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>contact_data</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_dasherize'>dasherize</span> <span class='comment'># =&gt; &quot;contact-data&quot;</span></code></pre>

<p>The XML serializer of models uses this method to dasherize node names:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># active_model/serializers/xml.rb
</span><span class='kw'>def</span> <span class='id identifier rubyid_reformat_name'>reformat_name</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_camelize'>camelize</span> <span class='kw'>if</span> <span class='id identifier rubyid_camelize?'>camelize?</span>
  <span class='id identifier rubyid_dasherize?'>dasherize?</span> <span class='op'>?</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_dasherize'>dasherize</span> <span class='op'>:</span> <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>demodulize</code></h4>

<p>Given a string with a qualified constant name, <a href="https://api.rubyonrails.org/classes/String.html#method-i-demodulize"><code>demodulize</code></a> returns the very constant name, that is, the rightmost part of it:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Product</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_demodulize'>demodulize</span>                        <span class='comment'># =&gt; &quot;Product&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Backoffice::UsersController</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_demodulize'>demodulize</span>    <span class='comment'># =&gt; &quot;UsersController&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Admin::Hotel::ReservationUtils</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_demodulize'>demodulize</span> <span class='comment'># =&gt; &quot;ReservationUtils&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::Inflections</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_demodulize'>demodulize</span>                  <span class='comment'># =&gt; &quot;Inflections&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_demodulize'>demodulize</span>                               <span class='comment'># =&gt; &quot;&quot;</span></code></pre>

<p>Active Record for example uses this method to compute the name of a counter cache column:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># active_record/reflection.rb
</span><span class='kw'>def</span> <span class='id identifier rubyid_counter_cache_column'>counter_cache_column</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_counter_cache'>counter_cache</span>] <span class='op'>==</span> <span class='kw'>true</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_active_record'>active_record</span>.<span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_demodulize'>demodulize</span>.<span class='id identifier rubyid_underscore'>underscore</span>.<span class='id identifier rubyid_pluralize'>pluralize</span><span class='embexpr_end'>}</span><span class='tstring_content'>_count</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_counter_cache'>counter_cache</span>]
    <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_counter_cache'>counter_cache</span>]
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>deconstantize</code></h4>

<p>Given a string with a qualified constant reference expression, <a href="https://api.rubyonrails.org/classes/String.html#method-i-deconstantize"><code>deconstantize</code></a> removes the rightmost segment, generally leaving the name of the constant&#39;s container:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Product</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_deconstantize'>deconstantize</span>                        <span class='comment'># =&gt; &quot;&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Backoffice::UsersController</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_deconstantize'>deconstantize</span>    <span class='comment'># =&gt; &quot;Backoffice&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Admin::Hotel::ReservationUtils</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_deconstantize'>deconstantize</span> <span class='comment'># =&gt; &quot;Admin::Hotel&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>parameterize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-parameterize"><code>parameterize</code></a> normalizes its receiver in a way that can be used in pretty URLs.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John Smith</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_parameterize'>parameterize</span> <span class='comment'># =&gt; &quot;john-smith&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Kurt Gödel</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_parameterize'>parameterize</span> <span class='comment'># =&gt; &quot;kurt-godel&quot;</span></code></pre>

<p>To preserve the case of the string, set the <code>preserve_case</code> argument to true. By default, <code>preserve_case</code> is set to false.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John Smith</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_parameterize'>parameterize</span>(<span class='label'>preserve_case:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; &quot;John-Smith&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Kurt Gödel</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_parameterize'>parameterize</span>(<span class='label'>preserve_case:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; &quot;Kurt-Godel&quot;</span></code></pre>

<p>To use a custom separator, override the <code>separator</code> argument.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John Smith</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_parameterize'>parameterize</span>(<span class='label'>separator:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; &quot;john_smith&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Kurt Gödel</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_parameterize'>parameterize</span>(<span class='label'>separator:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; &quot;kurt_godel&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>tableize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-tableize"><code>tableize</code></a> is <code>underscore</code> followed by <code>pluralize</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Person</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_tableize'>tableize</span>      <span class='comment'># =&gt; &quot;people&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invoice</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_tableize'>tableize</span>     <span class='comment'># =&gt; &quot;invoices&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>InvoiceLine</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_tableize'>tableize</span> <span class='comment'># =&gt; &quot;invoice_lines&quot;</span></code></pre>

<p>As a rule of thumb, <code>tableize</code> returns the table name that corresponds to a given model for simple cases. The actual implementation in Active Record is not straight <code>tableize</code> indeed, because it also demodulizes the class name and checks a few options that may affect the returned string.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>classify</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-classify"><code>classify</code></a> is the inverse of <code>tableize</code>. It gives you the class name corresponding to a table name:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>people</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_classify'>classify</span>        <span class='comment'># =&gt; &quot;Person&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invoices</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_classify'>classify</span>      <span class='comment'># =&gt; &quot;Invoice&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invoice_lines</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_classify'>classify</span> <span class='comment'># =&gt; &quot;InvoiceLine&quot;</span></code></pre>

<p>The method understands qualified table names:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>highrise_production.companies</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_classify'>classify</span> <span class='comment'># =&gt; &quot;Company&quot;</span></code></pre>

<p>Note that <code>classify</code> returns a class name as a string. You can get the actual class object by invoking <code>constantize</code> on it, explained next.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>constantize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-constantize"><code>constantize</code></a> resolves the constant reference expression in its receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Integer</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_constantize'>constantize</span> <span class='comment'># =&gt; Integer
</span>
<span class='kw'>module</span> <span class='const'>M</span>
  <span class='const'>X</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='kw'>end</span>
<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>M::X</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_constantize'>constantize</span> <span class='comment'># =&gt; 1</span></code></pre>

<p>If the string evaluates to no known constant, or its content is not even a valid constant name, <code>constantize</code> raises <a href="NameError.html" title="NameError (class)"><code>NameError</code></a>.</p>

<p>Constant name resolution by <code>constantize</code> starts always at the top-level <a href="Object.html" title="Object (class)"><code>Object</code></a> even if there is no leading &quot;::&quot;.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>X</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_in_Object'>in_Object</span>
<span class='kw'>module</span> <span class='const'>M</span>
  <span class='const'>X</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_in_M'>in_M</span>

  <span class='const'>X</span>                 <span class='comment'># =&gt; :in_M
</span>  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::X</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_constantize'>constantize</span> <span class='comment'># =&gt; :in_Object
</span>  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>X</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_constantize'>constantize</span>   <span class='comment'># =&gt; :in_Object (!)
</span><span class='kw'>end</span></code></pre>

<p>So, it is in general not equivalent to what Ruby would do in the same spot, had a real constant be evaluated.</p>

<p>Mailer test cases obtain the mailer being tested from the name of the test class using <code>constantize</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># action_mailer/test_case.rb
</span><span class='kw'>def</span> <span class='id identifier rubyid_determine_default_mailer'>determine_default_mailer</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Test</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_constantize'>constantize</span>
<span class='kw'>rescue</span> <span class='const'><a href="NameError.html" title="NameError (class)">NameError</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NonInferrableMailerError</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_name'>name</span>)
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>humanize</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-humanize"><code>humanize</code></a> tweaks an attribute name for display to end users.</p>

<p>Specifically, it performs these transformations:</p>

<ul>
<li>Applies human inflection rules to the argument.</li>
<li>Deletes leading underscores, if any.</li>
<li>Removes a &quot;_id&quot; suffix if present.</li>
<li>Replaces underscores with spaces, if any.</li>
<li>Downcases all words except acronyms.</li>
<li>Capitalizes the first word.</li>
</ul>

<p>The capitalization of the first word can be turned off by setting the
<code>:capitalize</code> option to false (default is true).</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_humanize'>humanize</span>                         <span class='comment'># =&gt; &quot;Name&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>author_id</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_humanize'>humanize</span>                    <span class='comment'># =&gt; &quot;Author&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>author_id</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_humanize'>humanize</span>(<span class='label'>capitalize:</span> <span class='kw'>false</span>) <span class='comment'># =&gt; &quot;author&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>comments_count</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_humanize'>humanize</span>               <span class='comment'># =&gt; &quot;Comments count&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_humanize'>humanize</span>                          <span class='comment'># =&gt; &quot;Id&quot;</span></code></pre>

<p>If &quot;SSL&quot; was defined to be an acronym:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ssl_error</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_humanize'>humanize</span> <span class='comment'># =&gt; &quot;SSL error&quot;</span></code></pre>

<p>The helper method <code>full_messages</code> uses <code>humanize</code> as a fallback to include
attribute names:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_full_messages'>full_messages</span>
  <span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='op'>|</span> <span class='id identifier rubyid_full_message'>full_message</span>(<span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>) }
<span class='kw'>end</span>

<span class='kw'>def</span> <span class='id identifier rubyid_full_message'>full_message</span>
  <span class='comment'># ...
</span>  <span class='id identifier rubyid_attr_name'>attr_name</span> <span class='op'>=</span> <span class='id identifier rubyid_attribute'>attribute</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_tr'>tr</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_humanize'>humanize</span>
  <span class='id identifier rubyid_attr_name'>attr_name</span> <span class='op'>=</span> <span class='ivar'>@base</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_human_attribute_name'>human_attribute_name</span>(<span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='id identifier rubyid_attr_name'>attr_name</span>)
  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>foreign_key</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-foreign_key"><code>foreign_key</code></a> gives a foreign key column name from a class name. To do so it demodulizes, underscores, and adds &quot;_id&quot;:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>User</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_foreign_key'>foreign_key</span>           <span class='comment'># =&gt; &quot;user_id&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>InvoiceLine</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_foreign_key'>foreign_key</span>    <span class='comment'># =&gt; &quot;invoice_line_id&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Admin::Session</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_foreign_key'>foreign_key</span> <span class='comment'># =&gt; &quot;session_id&quot;</span></code></pre>

<p>Pass a false argument if you do not want the underscore in &quot;_id&quot;:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>User</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_foreign_key'>foreign_key</span>(<span class='kw'>false</span>) <span class='comment'># =&gt; &quot;userid&quot;</span></code></pre>

<p>Associations use this method to infer foreign keys, for example <code>has_one</code> and <code>has_many</code> do this:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># active_record/associations.rb
</span><span class='id identifier rubyid_foreign_key'>foreign_key</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_foreign_key'>foreign_key</span>] <span class='op'>||</span> <span class='id identifier rubyid_reflection'>reflection</span>.<span class='id identifier rubyid_active_record'>active_record</span>.<span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_foreign_key'>foreign_key</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>upcase_first</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-upcase_first"><code>upcase_first</code></a> capitalizes the first letter of the receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employee salary</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_upcase_first'>upcase_first</span> <span class='comment'># =&gt; &quot;Employee salary&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_upcase_first'>upcase_first</span>                <span class='comment'># =&gt; &quot;&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4><code>downcase_first</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/String.html#method-i-downcase_first"><code>downcase_first</code></a> converts the first letter of the receiver to lowercase:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>If I had read Alice in Wonderland</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_downcase_first'>downcase_first</span> <span class='comment'># =&gt; &quot;if I had read Alice in Wonderland&quot;
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_downcase_first'>downcase_first</span>                                  <span class='comment'># =&gt; &quot;&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p>

<h3>Conversions</h3>

<h4><code>to_date</code>, <code>to_time</code>, <code>to_datetime</code></h4>

<p>The methods <a href="https://api.rubyonrails.org/classes/String.html#method-i-to_date"><code>to_date</code></a>, <a href="https://api.rubyonrails.org/classes/String.html#method-i-to_time"><code>to_time</code></a>, and <a href="https://api.rubyonrails.org/classes/String.html#method-i-to_datetime"><code>to_datetime</code></a> are basically convenience wrappers around <code>Date._parse</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2010-07-27</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to_date'>to_date</span>              <span class='comment'># =&gt; Tue, 27 Jul 2010
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2010-07-27 23:37:00</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to_time'>to_time</span>     <span class='comment'># =&gt; 2010-07-27 23:37:00 +0200
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2010-07-27 23:37:00</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to_datetime'>to_datetime</span> <span class='comment'># =&gt; Tue, 27 Jul 2010 23:37:00 +0000</span></code></pre>

<p><code>to_time</code> receives an optional argument <code>:utc</code> or <code>:local</code>, to indicate which time zone you want the time in:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2010-07-27 23:42:00</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to_time'>to_time</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_utc'>utc</span>)   <span class='comment'># =&gt; 2010-07-27 23:42:00 UTC
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2010-07-27 23:42:00</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_to_time'>to_time</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_local'>local</span>) <span class='comment'># =&gt; 2010-07-27 23:42:00 +0200</span></code></pre>

<p>Default is <code>:local</code>.</p>

<p>Please refer to the documentation of <code>Date._parse</code> for further details.</p>

<p>INFO: The three of them return <code>nil</code> for blank receivers.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/conversions.rb</code>.</p>

<h2>Extensions to <a href="Symbol.html" title="Symbol (class)"><code>Symbol</code></a></h2>

<h3><code>starts_with?</code> and <code>ends_with?</code></h3>

<p>Active Support defines 3rd person aliases of <code>Symbol#start_with?</code> and <code>Symbol#end_with?</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>f</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; true
</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>o</span><span class='tstring_end'>&quot;</span></span>)   <span class='comment'># =&gt; true</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/symbol/starts_ends_with.rb</code>.</p>

<h2>Extensions to <a href="Numeric.html" title="Numeric (class)"><code>Numeric</code></a></h2>

<h3>Bytes</h3>

<p>All numbers respond to these methods:</p>

<ul>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-bytes"><code>bytes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-kilobytes"><code>kilobytes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-megabytes"><code>megabytes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-gigabytes"><code>gigabytes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-terabytes"><code>terabytes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-petabytes"><code>petabytes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-exabytes"><code>exabytes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-zettabytes"><code>zettabytes</code></a></li>
</ul>

<p>They return the corresponding amount of bytes, using a conversion factor of 1024:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>2</span>.<span class='id identifier rubyid_kilobytes'>kilobytes</span>   <span class='comment'># =&gt; 2048
</span><span class='int'>3</span>.<span class='id identifier rubyid_megabytes'>megabytes</span>   <span class='comment'># =&gt; 3145728
</span><span class='float'>3.5</span>.<span class='id identifier rubyid_gigabytes'>gigabytes</span> <span class='comment'># =&gt; 3758096384.0
</span><span class='op'>-</span><span class='int'>4</span>.<span class='id identifier rubyid_exabytes'>exabytes</span>   <span class='comment'># =&gt; -4611686018427387904</span></code></pre>

<p>Singular forms are aliased so you are able to say:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>1</span>.<span class='id identifier rubyid_megabyte'>megabyte</span> <span class='comment'># =&gt; 1048576</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/numeric/bytes.rb</code>.</p>

<h3>Time</h3>

<p>The following methods:</p>

<ul>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-seconds"><code>seconds</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-minutes"><code>minutes</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-hours"><code>hours</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-days"><code>days</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-weeks"><code>weeks</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Numeric.html#method-i-fortnights"><code>fortnights</code></a></li>
</ul>

<p>enable time declarations and calculations, like <code>45.minutes + 2.hours + 4.weeks</code>. Their return values can also be added to or subtracted from Time objects.</p>

<p>These methods can be combined with <a href="https://api.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-from_now"><code>from_now</code></a>, <a href="https://api.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-ago"><code>ago</code></a>, etc, for precise date calculations. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># equivalent to Time.current.advance(days: 1)
</span><span class='int'>1</span>.<span class='id identifier rubyid_day'>day</span>.<span class='id identifier rubyid_from_now'>from_now</span>

<span class='comment'># equivalent to Time.current.advance(weeks: 2)
</span><span class='int'>2</span>.<span class='id identifier rubyid_weeks'>weeks</span>.<span class='id identifier rubyid_from_now'>from_now</span>

<span class='comment'># equivalent to Time.current.advance(days: 4, weeks: 5)
</span>(<span class='int'>4</span>.<span class='id identifier rubyid_days'>days</span> <span class='op'>+</span> <span class='int'>5</span>.<span class='id identifier rubyid_weeks'>weeks</span>).<span class='id identifier rubyid_from_now'>from_now</span></code></pre>

<p>WARNING. For other durations please refer to the time extensions to <a href="Integer.html" title="Integer (class)"><code>Integer</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/numeric/time.rb</code>.</p>

<h3>Formatting</h3>

<p>Enables the formatting of numbers in a variety of ways.</p>

<p>Produce a string representation of a number as a telephone number:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>5551234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span>)
<span class='comment'># =&gt; 555-1234
</span><span class='int'>1235551234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span>)
<span class='comment'># =&gt; 123-555-1234
</span><span class='int'>1235551234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span><span class='comma'>,</span> <span class='label'>area_code:</span> <span class='kw'>true</span>)
<span class='comment'># =&gt; (123) 555-1234
</span><span class='int'>1235551234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span><span class='comma'>,</span> <span class='label'>delimiter:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; 123 555 1234
</span><span class='int'>1235551234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span><span class='comma'>,</span> <span class='label'>area_code:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>extension:</span> <span class='int'>555</span>)
<span class='comment'># =&gt; (123) 555-1234 x 555
</span><span class='int'>1235551234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span><span class='comma'>,</span> <span class='label'>country_code:</span> <span class='int'>1</span>)
<span class='comment'># =&gt; +1-123-555-1234</span></code></pre>

<p>Produce a string representation of a number as currency:</p>

<pre class="code ruby"><code class="ruby"><span class='float'>1234567890.50</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_currency'>currency</span>)                 <span class='comment'># =&gt; $1,234,567,890.50
</span><span class='float'>1234567890.506</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_currency'>currency</span>)                <span class='comment'># =&gt; $1,234,567,890.51
</span><span class='float'>1234567890.506</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_currency'>currency</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='int'>3</span>)  <span class='comment'># =&gt; $1,234,567,890.506</span></code></pre>

<p>Produce a string representation of a number as a percentage:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>100</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_percentage'>percentage</span>)
<span class='comment'># =&gt; 100.000%
</span><span class='int'>100</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_percentage'>percentage</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='int'>0</span>)
<span class='comment'># =&gt; 100%
</span><span class='int'>1000</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_percentage'>percentage</span><span class='comma'>,</span> <span class='label'>delimiter:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>separator:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; 1.000,000%
</span><span class='float'>302.24398923423</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_percentage'>percentage</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='int'>5</span>)
<span class='comment'># =&gt; 302.24399%</span></code></pre>

<p>Produce a string representation of a number in delimited form:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>12345678</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_delimited'>delimited</span>)                     <span class='comment'># =&gt; 12,345,678
</span><span class='float'>12345678.05</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_delimited'>delimited</span>)                  <span class='comment'># =&gt; 12,345,678.05
</span><span class='int'>12345678</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_delimited'>delimited</span><span class='comma'>,</span> <span class='label'>delimiter:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>)     <span class='comment'># =&gt; 12.345.678
</span><span class='int'>12345678</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_delimited'>delimited</span><span class='comma'>,</span> <span class='label'>delimiter:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span>)     <span class='comment'># =&gt; 12,345,678
</span><span class='float'>12345678.05</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_delimited'>delimited</span><span class='comma'>,</span> <span class='label'>separator:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>)  <span class='comment'># =&gt; 12,345,678 05</span></code></pre>

<p>Produce a string representation of a number rounded to a precision:</p>

<pre class="code ruby"><code class="ruby"><span class='float'>111.2345</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rounded'>rounded</span>)                     <span class='comment'># =&gt; 111.235
</span><span class='float'>111.2345</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rounded'>rounded</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='int'>2</span>)       <span class='comment'># =&gt; 111.23
</span><span class='int'>13</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rounded'>rounded</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='int'>5</span>)             <span class='comment'># =&gt; 13.00000
</span><span class='float'>389.32314</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rounded'>rounded</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='int'>0</span>)      <span class='comment'># =&gt; 389
</span><span class='float'>111.2345</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rounded'>rounded</span><span class='comma'>,</span> <span class='label'>significant:</span> <span class='kw'>true</span>)  <span class='comment'># =&gt; 111</span></code></pre>

<p>Produce a string representation of a number as a human-readable number of bytes:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>123</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)                  <span class='comment'># =&gt; 123 Bytes
</span><span class='int'>1234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)                 <span class='comment'># =&gt; 1.21 KB
</span><span class='int'>12345</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)                <span class='comment'># =&gt; 12.1 KB
</span><span class='int'>1234567</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)              <span class='comment'># =&gt; 1.18 MB
</span><span class='int'>1234567890</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)           <span class='comment'># =&gt; 1.15 GB
</span><span class='int'>1234567890123</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)        <span class='comment'># =&gt; 1.12 TB
</span><span class='int'>1234567890123456</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)     <span class='comment'># =&gt; 1.1 PB
</span><span class='int'>1234567890123456789</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human_size'>human_size</span>)  <span class='comment'># =&gt; 1.07 EB</span></code></pre>

<p>Produce a string representation of a number in human-readable words:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>123</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human'>human</span>)               <span class='comment'># =&gt; &quot;123&quot;
</span><span class='int'>1234</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human'>human</span>)              <span class='comment'># =&gt; &quot;1.23 Thousand&quot;
</span><span class='int'>12345</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human'>human</span>)             <span class='comment'># =&gt; &quot;12.3 Thousand&quot;
</span><span class='int'>1234567</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human'>human</span>)           <span class='comment'># =&gt; &quot;1.23 Million&quot;
</span><span class='int'>1234567890</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human'>human</span>)        <span class='comment'># =&gt; &quot;1.23 Billion&quot;
</span><span class='int'>1234567890123</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human'>human</span>)     <span class='comment'># =&gt; &quot;1.23 Trillion&quot;
</span><span class='int'>1234567890123456</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_human'>human</span>)  <span class='comment'># =&gt; &quot;1.23 Quadrillion&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/numeric/conversions.rb</code>.</p>

<h2>Extensions to <a href="Integer.html" title="Integer (class)"><code>Integer</code></a></h2>

<h3><code>multiple_of?</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Integer.html#method-i-multiple_of-3F"><code>multiple_of?</code></a> tests whether an integer is multiple of the argument:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>2</span>.<span class='id identifier rubyid_multiple_of?'>multiple_of?</span>(<span class='int'>1</span>) <span class='comment'># =&gt; true
</span><span class='int'>1</span>.<span class='id identifier rubyid_multiple_of?'>multiple_of?</span>(<span class='int'>2</span>) <span class='comment'># =&gt; false</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/integer/multiple.rb</code>.</p>

<h3><code>ordinal</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Integer.html#method-i-ordinal"><code>ordinal</code></a> returns the ordinal suffix string corresponding to the receiver integer:</p>

<pre class="code ruby"><code class="ruby"><span class='int'>1</span>.<span class='id identifier rubyid_ordinal'>ordinal</span>    <span class='comment'># =&gt; &quot;st&quot;
</span><span class='int'>2</span>.<span class='id identifier rubyid_ordinal'>ordinal</span>    <span class='comment'># =&gt; &quot;nd&quot;
</span><span class='int'>53</span>.<span class='id identifier rubyid_ordinal'>ordinal</span>   <span class='comment'># =&gt; &quot;rd&quot;
</span><span class='int'>2009</span>.<span class='id identifier rubyid_ordinal'>ordinal</span> <span class='comment'># =&gt; &quot;th&quot;
</span><span class='op'>-</span><span class='int'>21</span>.<span class='id identifier rubyid_ordinal'>ordinal</span>  <span class='comment'># =&gt; &quot;st&quot;
</span><span class='op'>-</span><span class='int'>134</span>.<span class='id identifier rubyid_ordinal'>ordinal</span> <span class='comment'># =&gt; &quot;th&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/integer/inflections.rb</code>.</p>

<h3><code>ordinalize</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Integer.html#method-i-ordinalize"><code>ordinalize</code></a> returns the ordinal string corresponding to the receiver integer. In comparison, note that the <code>ordinal</code> method returns <strong>only</strong> the suffix string.</p>

<pre class="code ruby"><code class="ruby"><span class='int'>1</span>.<span class='id identifier rubyid_ordinalize'>ordinalize</span>    <span class='comment'># =&gt; &quot;1st&quot;
</span><span class='int'>2</span>.<span class='id identifier rubyid_ordinalize'>ordinalize</span>    <span class='comment'># =&gt; &quot;2nd&quot;
</span><span class='int'>53</span>.<span class='id identifier rubyid_ordinalize'>ordinalize</span>   <span class='comment'># =&gt; &quot;53rd&quot;
</span><span class='int'>2009</span>.<span class='id identifier rubyid_ordinalize'>ordinalize</span> <span class='comment'># =&gt; &quot;2009th&quot;
</span><span class='op'>-</span><span class='int'>21</span>.<span class='id identifier rubyid_ordinalize'>ordinalize</span>  <span class='comment'># =&gt; &quot;-21st&quot;
</span><span class='op'>-</span><span class='int'>134</span>.<span class='id identifier rubyid_ordinalize'>ordinalize</span> <span class='comment'># =&gt; &quot;-134th&quot;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/integer/inflections.rb</code>.</p>

<h3>Time</h3>

<p>The following methods:</p>

<ul>
<li><a href="https://api.rubyonrails.org/classes/Integer.html#method-i-months"><code>months</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/Integer.html#method-i-years"><code>years</code></a></li>
</ul>

<p>enable time declarations and calculations, like <code>4.months + 5.years</code>. Their return values can also be added to or subtracted from Time objects.</p>

<p>These methods can be combined with <a href="https://api.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-from_now"><code>from_now</code></a>, <a href="https://api.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-ago"><code>ago</code></a>, etc, for precise date calculations. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># equivalent to Time.current.advance(months: 1)
</span><span class='int'>1</span>.<span class='id identifier rubyid_month'>month</span>.<span class='id identifier rubyid_from_now'>from_now</span>

<span class='comment'># equivalent to Time.current.advance(years: 2)
</span><span class='int'>2</span>.<span class='id identifier rubyid_years'>years</span>.<span class='id identifier rubyid_from_now'>from_now</span>

<span class='comment'># equivalent to Time.current.advance(months: 4, years: 5)
</span>(<span class='int'>4</span>.<span class='id identifier rubyid_months'>months</span> <span class='op'>+</span> <span class='int'>5</span>.<span class='id identifier rubyid_years'>years</span>).<span class='id identifier rubyid_from_now'>from_now</span></code></pre>

<p>WARNING. For other durations please refer to the time extensions to <a href="Numeric.html" title="Numeric (class)"><code>Numeric</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/integer/time.rb</code>.</p>

<h2>Extensions to <a href="BigDecimal.html" title="BigDecimal (class)"><code>BigDecimal</code></a></h2>

<h3><code>to_s</code></h3>

<p>The method <code>to_s</code> provides a default specifier of &quot;F&quot;. This means that a simple call to <code>to_s</code> will result in floating-point representation instead of scientific notation:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="BigDecimal.html" title="BigDecimal (class)">BigDecimal</a></span>(<span class='float'>5.00</span><span class='comma'>,</span> <span class='int'>6</span>).<span class='id identifier rubyid_to_s'>to_s</span>       <span class='comment'># =&gt; &quot;5.0&quot;</span></code></pre>

<p>Scientific notation is still supported:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="BigDecimal.html" title="BigDecimal (class)">BigDecimal</a></span>(<span class='float'>5.00</span><span class='comma'>,</span> <span class='int'>6</span>).<span class='id identifier rubyid_to_s'>to_s</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>e</span><span class='tstring_end'>&quot;</span></span>)  <span class='comment'># =&gt; &quot;0.5E1&quot;</span></code></pre>

<h2>Extensions to <a href="Enumerable.html" title="Enumerable (module)"><code>Enumerable</code></a></h2>

<h3><code>index_by</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-index_by"><code>index_by</code></a> generates a hash with the elements of an enumerable indexed by some key.</p>

<p>It iterates through the collection and passes each element to a block. The element will be keyed by the value returned by the block:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_invoices'>invoices</span>.<span class='id identifier rubyid_index_by'>index_by</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_number'>number</span>)
<span class='comment'># =&gt; {&quot;2009-032&quot; =&gt; &lt;Invoice ...&gt;, &quot;2009-008&quot; =&gt; &lt;Invoice ...&gt;, ...}</span></code></pre>

<p>WARNING. Keys should normally be unique. If the block returns the same value for different elements no collection is built for that key. The last item will win.</p>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3><code>index_with</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-index_with"><code>index_with</code></a> generates a hash with the elements of an enumerable as keys. The value
is either a passed default or returned in a block.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_post'>post</span> <span class='op'>=</span> <span class='const'>Post</span>.<span class='id identifier rubyid_new'>new</span>(<span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hey there</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>what&#39;s up?</span><span class='tstring_end'>&quot;</span></span>)

<span class='qsymbols'><span class='qsymbols_beg'>%i(</span><span class='words_sep'> </span><span class='tstring_content'>title</span><span class='words_sep'> </span><span class='tstring_content'>body</span><span class='words_sep'> </span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_index_with'>index_with</span> { <span class='op'>|</span><span class='id identifier rubyid_attr_name'>attr_name</span><span class='op'>|</span> <span class='id identifier rubyid_post'>post</span>.<span class='id identifier rubyid_public_send'>public_send</span>(<span class='id identifier rubyid_attr_name'>attr_name</span>) }
<span class='comment'># =&gt; { title: &quot;hey there&quot;, body: &quot;what&#39;s up?&quot; }
</span>
<span class='const'>WEEKDAYS</span>.<span class='id identifier rubyid_index_with'>index_with</span>(<span class='const'>Interval</span>.<span class='id identifier rubyid_all_day'>all_day</span>)
<span class='comment'># =&gt; { monday: [ 0, 1440 ], … }</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3><code>many?</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-many-3F"><code>many?</code></a> is shorthand for <code>collection.size &gt; 1</code>:</p>

<pre class="code xml"><code class="xml">&lt;% if pages.many? %&gt;
  &lt;%= pagination_links %&gt;
&lt;% end %&gt;
</code></pre>

<p>If an optional block is given, <code>many?</code> only takes into account those elements that return true:</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@see_more</span> <span class='op'>=</span> <span class='id identifier rubyid_videos'>videos</span>.<span class='id identifier rubyid_many?'>many?</span> { <span class='op'>|</span><span class='id identifier rubyid_video'>video</span><span class='op'>|</span> <span class='id identifier rubyid_video'>video</span>.<span class='id identifier rubyid_category'>category</span> <span class='op'>==</span> <span class='id identifier rubyid_params'>params</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_category'>category</span>] }</code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3><code>exclude?</code></h3>

<p>The predicate <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-exclude-3F"><code>exclude?</code></a> tests whether a given object does <strong>not</strong> belong to the collection. It is the negation of the built-in <code>include?</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_to_visit'>to_visit</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_node'>node</span> <span class='kw'>if</span> <span class='id identifier rubyid_visited'>visited</span>.<span class='id identifier rubyid_exclude?'>exclude?</span>(<span class='id identifier rubyid_node'>node</span>)</code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3><code>including</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-including"><code>including</code></a> returns a new enumerable that includes the passed elements:</p>

<pre class="code ruby"><code class="ruby">[ <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span> ].<span class='id identifier rubyid_including'>including</span>(<span class='int'>4</span><span class='comma'>,</span> <span class='int'>5</span>)                    <span class='comment'># =&gt; [ 1, 2, 3, 4, 5 ]
</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rafael</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_including'>including</span> <span class='qwords'><span class='qwords_beg'>%w[</span><span class='words_sep'> </span><span class='tstring_content'>Aaron</span><span class='words_sep'> </span><span class='tstring_content'>Todd</span><span class='words_sep'> </span><span class='tstring_end'>]</span></span> <span class='comment'># =&gt; [&quot;David&quot;, &quot;Rafael&quot;, &quot;Aaron&quot;, &quot;Todd&quot;]</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3><code>excluding</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-excluding"><code>excluding</code></a> returns a copy of an enumerable with the specified elements
removed:</p>

<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rafael</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Todd</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_excluding'>excluding</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Todd</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; [&quot;David&quot;, &quot;Rafael&quot;]</span></code></pre>

<p><code>excluding</code> is aliased to <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-without"><code>without</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3><code>pluck</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-pluck"><code>pluck</code></a> extracts the given key from each element:</p>

<pre class="code ruby"><code class="ruby">[{ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span> }<span class='comma'>,</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rafael</span><span class='tstring_end'>&quot;</span></span> }<span class='comma'>,</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron</span><span class='tstring_end'>&quot;</span></span> }].<span class='id identifier rubyid_pluck'>pluck</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span>) <span class='comment'># =&gt; [&quot;David&quot;, &quot;Rafael&quot;, &quot;Aaron&quot;]
</span>[{ <span class='label'>id:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span> }<span class='comma'>,</span> { <span class='label'>id:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rafael</span><span class='tstring_end'>&quot;</span></span> }].<span class='id identifier rubyid_pluck'>pluck</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span>) <span class='comment'># =&gt; [[1, &quot;David&quot;], [2, &quot;Rafael&quot;]]</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3><code>pick</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Enumerable.html#method-i-pick"><code>pick</code></a> extracts the given key from the first element:</p>

<pre class="code ruby"><code class="ruby">[{ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span> }<span class='comma'>,</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rafael</span><span class='tstring_end'>&quot;</span></span> }<span class='comma'>,</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron</span><span class='tstring_end'>&quot;</span></span> }].<span class='id identifier rubyid_pick'>pick</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span>) <span class='comment'># =&gt; &quot;David&quot;
</span>[{ <span class='label'>id:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span> }<span class='comma'>,</span> { <span class='label'>id:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rafael</span><span class='tstring_end'>&quot;</span></span> }].<span class='id identifier rubyid_pick'>pick</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span>) <span class='comment'># =&gt; [1, &quot;David&quot;]</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h2>Extensions to <a href="Array.html" title="Array (class)"><code>Array</code></a></h2>

<h3>Accessing</h3>

<p>Active Support augments the API of arrays to ease certain ways of accessing them. For example, <a href="https://api.rubyonrails.org/classes/Array.html#method-i-to"><code>to</code></a> returns the subarray of elements up to the one at the passed index:</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='words_sep'> </span><span class='tstring_content'>c</span><span class='words_sep'> </span><span class='tstring_content'>d</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_to'>to</span>(<span class='int'>2</span>) <span class='comment'># =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
</span>[].<span class='id identifier rubyid_to'>to</span>(<span class='int'>7</span>)          <span class='comment'># =&gt; []</span></code></pre>

<p>Similarly, <a href="https://api.rubyonrails.org/classes/Array.html#method-i-from"><code>from</code></a> returns the tail from the element at the passed index to the end. If the index is greater than the length of the array, it returns an empty array.</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='words_sep'> </span><span class='tstring_content'>c</span><span class='words_sep'> </span><span class='tstring_content'>d</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_from'>from</span>(<span class='int'>2</span>)  <span class='comment'># =&gt; [&quot;c&quot;, &quot;d&quot;]
</span><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='words_sep'> </span><span class='tstring_content'>c</span><span class='words_sep'> </span><span class='tstring_content'>d</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_from'>from</span>(<span class='int'>10</span>) <span class='comment'># =&gt; []
</span>[].<span class='id identifier rubyid_from'>from</span>(<span class='int'>0</span>)           <span class='comment'># =&gt; []</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-including"><code>including</code></a> returns a new array that includes the passed elements:</p>

<pre class="code ruby"><code class="ruby">[ <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span> ].<span class='id identifier rubyid_including'>including</span>(<span class='int'>4</span><span class='comma'>,</span> <span class='int'>5</span>)          <span class='comment'># =&gt; [ 1, 2, 3, 4, 5 ]
</span>[ [ <span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span> ] ].<span class='id identifier rubyid_including'>including</span>([ [ <span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span> ] ]) <span class='comment'># =&gt; [ [ 0, 1 ], [ 1, 0 ] ]</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-excluding"><code>excluding</code></a> returns a copy of the Array excluding the specified elements.
This is an optimization of <a href="Enumerable.html#excluding-instance_method" title="Enumerable#excluding (method)">Enumerable#excluding</a> that uses <code>Array#-</code>
instead of <code>Array#reject</code> for performance reasons.</p>

<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rafael</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Todd</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_excluding'>excluding</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aaron</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Todd</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; [&quot;David&quot;, &quot;Rafael&quot;]
</span>[ [ <span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span> ]<span class='comma'>,</span> [ <span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span> ] ].<span class='id identifier rubyid_excluding'>excluding</span>([ [ <span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span> ] ])                  <span class='comment'># =&gt; [ [ 0, 1 ] ]</span></code></pre>

<p>The methods <a href="https://api.rubyonrails.org/classes/Array.html#method-i-second"><code>second</code></a>, <a href="https://api.rubyonrails.org/classes/Array.html#method-i-third"><code>third</code></a>, <a href="https://api.rubyonrails.org/classes/Array.html#method-i-fourth"><code>fourth</code></a>, and <a href="https://api.rubyonrails.org/classes/Array.html#method-i-fifth"><code>fifth</code></a> return the corresponding element, as do <a href="https://api.rubyonrails.org/classes/Array.html#method-i-second_to_last"><code>second_to_last</code></a> and <a href="https://api.rubyonrails.org/classes/Array.html#method-i-third_to_last"><code>third_to_last</code></a> (<code>first</code> and <code>last</code> are built-in). Thanks to social wisdom and positive constructiveness all around, <a href="https://api.rubyonrails.org/classes/Array.html#method-i-forty_two"><code>forty_two</code></a> is also available.</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='words_sep'> </span><span class='tstring_content'>c</span><span class='words_sep'> </span><span class='tstring_content'>d</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_third'>third</span> <span class='comment'># =&gt; &quot;c&quot;
</span><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='words_sep'> </span><span class='tstring_content'>c</span><span class='words_sep'> </span><span class='tstring_content'>d</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_fifth'>fifth</span> <span class='comment'># =&gt; nil</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/array/access.rb</code>.</p>

<h3>Extracting</h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-extract-21"><code>extract!</code></a> removes and returns the elements for which the block returns a true value.
If no block is given, an Enumerator is returned instead.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_numbers'>numbers</span> <span class='op'>=</span> [<span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='int'>8</span><span class='comma'>,</span> <span class='int'>9</span>]
<span class='id identifier rubyid_odd_numbers'>odd_numbers</span> <span class='op'>=</span> <span class='id identifier rubyid_numbers'>numbers</span>.<span class='id identifier rubyid_extract!'>extract!</span> { <span class='op'>|</span><span class='id identifier rubyid_number'>number</span><span class='op'>|</span> <span class='id identifier rubyid_number'>number</span>.<span class='id identifier rubyid_odd?'>odd?</span> } <span class='comment'># =&gt; [1, 3, 5, 7, 9]
</span><span class='id identifier rubyid_numbers'>numbers</span> <span class='comment'># =&gt; [0, 2, 4, 6, 8]</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/array/extract.rb</code>.</p>

<h3>Options Extraction</h3>

<p>When the last argument in a method call is a hash, except perhaps for a <code>&amp;block</code> argument, Ruby allows you to omit the brackets:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span>.<span class='id identifier rubyid_exists?'>exists?</span>(<span class='label'>email:</span> <span class='id identifier rubyid_params'>params</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_email'>email</span>])</code></pre>

<p>That syntactic sugar is used a lot in Rails to avoid positional arguments where there would be too many, offering instead interfaces that emulate named parameters. In particular it is very idiomatic to use a trailing hash for options.</p>

<p>If a method expects a variable number of arguments and uses <code>*</code> in its declaration, however, such an options hash ends up being an item of the array of arguments, where it loses its role.</p>

<p>In those cases, you may give an options hash a distinguished treatment with <a href="https://api.rubyonrails.org/classes/Array.html#method-i-extract_options-21"><code>extract_options!</code></a>. This method checks the type of the last item of an array. If it is a hash it pops it and returns it, otherwise it returns an empty hash.</p>

<p>Let&#39;s see for example the definition of the <code>caches_action</code> controller macro:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_caches_action'>caches_action</span>(<span class='op'>*</span><span class='id identifier rubyid_actions'>actions</span>)
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_cache_configured?'>cache_configured?</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_actions'>actions</span>.<span class='id identifier rubyid_extract_options!'>extract_options!</span>
  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>

<p>This method receives an arbitrary number of action names, and an optional hash of options as last argument. With the call to <code>extract_options!</code> you obtain the options hash and remove it from <code>actions</code> in a simple and explicit way.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/extract_options.rb</code>.</p>

<h3>Conversions</h3>

<h4><code>to_sentence</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-to_sentence"><code>to_sentence</code></a> turns an array into a string containing a sentence that enumerates its items:</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_to_sentence'>to_sentence</span>                <span class='comment'># =&gt; &quot;&quot;
</span><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>Earth</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_to_sentence'>to_sentence</span>           <span class='comment'># =&gt; &quot;Earth&quot;
</span><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>Earth</span><span class='words_sep'> </span><span class='tstring_content'>Wind</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_to_sentence'>to_sentence</span>      <span class='comment'># =&gt; &quot;Earth and Wind&quot;
</span><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>Earth</span><span class='words_sep'> </span><span class='tstring_content'>Wind</span><span class='words_sep'> </span><span class='tstring_content'>Fire</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_to_sentence'>to_sentence</span> <span class='comment'># =&gt; &quot;Earth, Wind, and Fire&quot;</span></code></pre>

<p>This method accepts three options:</p>

<ul>
<li><code>:two_words_connector</code>: What is used for arrays of length 2. Default is &quot; and &quot;.</li>
<li><code>:words_connector</code>: What is used to join the elements of arrays with 3 or more elements, except for the last two. Default is &quot;, &quot;.</li>
<li><code>:last_word_connector</code>: What is used to join the last items of an array with 3 or more elements. Default is &quot;, and &quot;.</li>
</ul>

<p>The defaults for these options can be localized, their keys are:</p>

<table><thead>
<tr>
<th>Option</th>
<th>I18n key</th>
</tr>
</thead><tbody>
<tr>
<td><code>:two_words_connector</code></td>
<td><code>support.array.two_words_connector</code></td>
</tr>
<tr>
<td><code>:words_connector</code></td>
<td><code>support.array.words_connector</code></td>
</tr>
<tr>
<td><code>:last_word_connector</code></td>
<td><code>support.array.last_word_connector</code></td>
</tr>
</tbody></table>

<p>NOTE: Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p>

<h4><code>to_fs</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-to_fs"><code>to_fs</code></a> acts like <code>to_s</code> by default.</p>

<p>If the array contains items that respond to <code>id</code>, however, the symbol
<code>:db</code> may be passed as argument. That&#39;s typically used with
collections of Active Record objects. Returned strings are:</p>

<pre class="code ruby"><code class="ruby">[].<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_db'>db</span>)            <span class='comment'># =&gt; &quot;null&quot;
</span>[<span class='id identifier rubyid_user'>user</span>].<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_db'>db</span>)        <span class='comment'># =&gt; &quot;8456&quot;
</span><span class='id identifier rubyid_invoice'>invoice</span>.<span class='id identifier rubyid_lines'>lines</span>.<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_db'>db</span>) <span class='comment'># =&gt; &quot;23,567,556,12&quot;</span></code></pre>

<p>Integers in the example above are supposed to come from the respective calls to <code>id</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p>

<h4><code>to_xml</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-to_xml"><code>to_xml</code></a> returns a string containing an XML representation of its receiver:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Contributor</span>.<span class='id identifier rubyid_limit'>limit</span>(<span class='int'>2</span>).<span class='id identifier rubyid_order'>order</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rank'>rank</span>).<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt;
</span><span class='comment'># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span class='comment'># &lt;contributors type=&quot;array&quot;&gt;
</span><span class='comment'>#   &lt;contributor&gt;
</span><span class='comment'>#     &lt;id type=&quot;integer&quot;&gt;4356&lt;/id&gt;
</span><span class='comment'>#     &lt;name&gt;Jeremy Kemper&lt;/name&gt;
</span><span class='comment'>#     &lt;rank type=&quot;integer&quot;&gt;1&lt;/rank&gt;
</span><span class='comment'>#     &lt;url-id&gt;jeremy-kemper&lt;/url-id&gt;
</span><span class='comment'>#   &lt;/contributor&gt;
</span><span class='comment'>#   &lt;contributor&gt;
</span><span class='comment'>#     &lt;id type=&quot;integer&quot;&gt;4404&lt;/id&gt;
</span><span class='comment'>#     &lt;name&gt;David Heinemeier Hansson&lt;/name&gt;
</span><span class='comment'>#     &lt;rank type=&quot;integer&quot;&gt;2&lt;/rank&gt;
</span><span class='comment'>#     &lt;url-id&gt;david-heinemeier-hansson&lt;/url-id&gt;
</span><span class='comment'>#   &lt;/contributor&gt;
</span><span class='comment'># &lt;/contributors&gt;</span></code></pre>

<p>To do so it sends <code>to_xml</code> to every item in turn, and collects the results under a root node. All items must respond to <code>to_xml</code>, an exception is raised otherwise.</p>

<p>By default, the name of the root element is the underscored and dasherized plural of the name of the class of the first item, provided the rest of elements belong to that type (checked with <code>is_a?</code>) and they are not hashes. In the example above that&#39;s &quot;contributors&quot;.</p>

<p>If there&#39;s any element that does not belong to the type of the first one the root node becomes &quot;objects&quot;:</p>

<pre class="code ruby"><code class="ruby">[<span class='const'>Contributor</span>.<span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='const'>Commit</span>.<span class='id identifier rubyid_first'>first</span>].<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt;
</span><span class='comment'># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span class='comment'># &lt;objects type=&quot;array&quot;&gt;
</span><span class='comment'>#   &lt;object&gt;
</span><span class='comment'>#     &lt;id type=&quot;integer&quot;&gt;4583&lt;/id&gt;
</span><span class='comment'>#     &lt;name&gt;Aaron Batalion&lt;/name&gt;
</span><span class='comment'>#     &lt;rank type=&quot;integer&quot;&gt;53&lt;/rank&gt;
</span><span class='comment'>#     &lt;url-id&gt;aaron-batalion&lt;/url-id&gt;
</span><span class='comment'>#   &lt;/object&gt;
</span><span class='comment'>#   &lt;object&gt;
</span><span class='comment'>#     &lt;author&gt;Joshua Peek&lt;/author&gt;
</span><span class='comment'>#     &lt;authored-timestamp type=&quot;datetime&quot;&gt;2009-09-02T16:44:36Z&lt;/authored-timestamp&gt;
</span><span class='comment'>#     &lt;branch&gt;origin/master&lt;/branch&gt;
</span><span class='comment'>#     &lt;committed-timestamp type=&quot;datetime&quot;&gt;2009-09-02T16:44:36Z&lt;/committed-timestamp&gt;
</span><span class='comment'>#     &lt;committer&gt;Joshua Peek&lt;/committer&gt;
</span><span class='comment'>#     &lt;git-show nil=&quot;true&quot;&gt;&lt;/git-show&gt;
</span><span class='comment'>#     &lt;id type=&quot;integer&quot;&gt;190316&lt;/id&gt;
</span><span class='comment'>#     &lt;imported-from-svn type=&quot;boolean&quot;&gt;false&lt;/imported-from-svn&gt;
</span><span class='comment'>#     &lt;message&gt;Kill AMo observing wrap_with_notifications since ARes was only using it&lt;/message&gt;
</span><span class='comment'>#     &lt;sha1&gt;723a47bfb3708f968821bc969a9a3fc873a3ed58&lt;/sha1&gt;
</span><span class='comment'>#   &lt;/object&gt;
</span><span class='comment'># &lt;/objects&gt;</span></code></pre>

<p>If the receiver is an array of hashes the root element is by default also &quot;objects&quot;:</p>

<pre class="code ruby"><code class="ruby">[{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }<span class='comma'>,</span> { <span class='label'>c:</span> <span class='int'>3</span> }].<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt;
</span><span class='comment'># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span class='comment'># &lt;objects type=&quot;array&quot;&gt;
</span><span class='comment'>#   &lt;object&gt;
</span><span class='comment'>#     &lt;b type=&quot;integer&quot;&gt;2&lt;/b&gt;
</span><span class='comment'>#     &lt;a type=&quot;integer&quot;&gt;1&lt;/a&gt;
</span><span class='comment'>#   &lt;/object&gt;
</span><span class='comment'>#   &lt;object&gt;
</span><span class='comment'>#     &lt;c type=&quot;integer&quot;&gt;3&lt;/c&gt;
</span><span class='comment'>#   &lt;/object&gt;
</span><span class='comment'># &lt;/objects&gt;</span></code></pre>

<p>WARNING. If the collection is empty the root element is by default &quot;nil-classes&quot;. That&#39;s a gotcha, for example the root element of the list of contributors above would not be &quot;contributors&quot; if the collection was empty, but &quot;nil-classes&quot;. You may use the <code>:root</code> option to ensure a consistent root element.</p>

<p>The name of children nodes is by default the name of the root node singularized. In the examples above we&#39;ve seen &quot;contributor&quot; and &quot;object&quot;. The option <code>:children</code> allows you to set these node names.</p>

<p>The default XML builder is a fresh instance of <code>Builder::XmlMarkup</code>. You can configure your own builder via the <code>:builder</code> option. The method also accepts options like <code>:dasherize</code> and friends, they are forwarded to the builder:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Contributor</span>.<span class='id identifier rubyid_limit'>limit</span>(<span class='int'>2</span>).<span class='id identifier rubyid_order'>order</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rank'>rank</span>).<span class='id identifier rubyid_to_xml'>to_xml</span>(<span class='label'>skip_types:</span> <span class='kw'>true</span>)
<span class='comment'># =&gt;
</span><span class='comment'># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span class='comment'># &lt;contributors&gt;
</span><span class='comment'>#   &lt;contributor&gt;
</span><span class='comment'>#     &lt;id&gt;4356&lt;/id&gt;
</span><span class='comment'>#     &lt;name&gt;Jeremy Kemper&lt;/name&gt;
</span><span class='comment'>#     &lt;rank&gt;1&lt;/rank&gt;
</span><span class='comment'>#     &lt;url-id&gt;jeremy-kemper&lt;/url-id&gt;
</span><span class='comment'>#   &lt;/contributor&gt;
</span><span class='comment'>#   &lt;contributor&gt;
</span><span class='comment'>#     &lt;id&gt;4404&lt;/id&gt;
</span><span class='comment'>#     &lt;name&gt;David Heinemeier Hansson&lt;/name&gt;
</span><span class='comment'>#     &lt;rank&gt;2&lt;/rank&gt;
</span><span class='comment'>#     &lt;url-id&gt;david-heinemeier-hansson&lt;/url-id&gt;
</span><span class='comment'>#   &lt;/contributor&gt;
</span><span class='comment'># &lt;/contributors&gt;</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p>

<h3>Wrapping</h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-c-wrap"><a href="Array.html#wrap-class_method" title="Array.wrap (method)">Array.wrap</a></a> wraps its argument in an array unless it is already an array (or array-like).</p>

<p>Specifically:</p>

<ul>
<li>If the argument is <code>nil</code> an empty array is returned.</li>
<li>Otherwise, if the argument responds to <code>to_ary</code> it is invoked, and if the value of <code>to_ary</code> is not <code>nil</code>, it is returned.</li>
<li>Otherwise, an array with the argument as its single element is returned.</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Array.html" title="Array (class)">Array</a></span>.<span class='id identifier rubyid_wrap'><a href="Array.html#wrap-class_method" title="Array.wrap (method)">wrap</a></span>(<span class='kw'>nil</span>)       <span class='comment'># =&gt; []
</span><span class='const'><a href="Array.html" title="Array (class)">Array</a></span>.<span class='id identifier rubyid_wrap'><a href="Array.html#wrap-class_method" title="Array.wrap (method)">wrap</a></span>([<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>]) <span class='comment'># =&gt; [1, 2, 3]
</span><span class='const'><a href="Array.html" title="Array (class)">Array</a></span>.<span class='id identifier rubyid_wrap'><a href="Array.html#wrap-class_method" title="Array.wrap (method)">wrap</a></span>(<span class='int'>0</span>)         <span class='comment'># =&gt; [0]</span></code></pre>

<p>This method is similar in purpose to <code>Kernel#Array</code>, but there are some differences:</p>

<ul>
<li>If the argument responds to <code>to_ary</code> the method is invoked. <code>Kernel#Array</code> moves on to try <code>to_a</code> if the returned value is <code>nil</code>, but <a href="Array.html#wrap-class_method" title="Array.wrap (method)">Array.wrap</a> returns an array with the argument as its single element right away.</li>
<li>If the returned value from <code>to_ary</code> is neither <code>nil</code> nor an <a href="Array.html" title="Array (class)"><code>Array</code></a> object, <code>Kernel#Array</code> raises an exception, while <a href="Array.html#wrap-class_method" title="Array.wrap (method)">Array.wrap</a> does not, it just returns the value.</li>
<li>It does not call <code>to_a</code> on the argument, if the argument does not respond to <code>to_ary</code> it returns an array with the argument as its single element.</li>
</ul>

<p>The last point is particularly worth comparing for some enumerables:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Array.html" title="Array (class)">Array</a></span>.<span class='id identifier rubyid_wrap'><a href="Array.html#wrap-class_method" title="Array.wrap (method)">wrap</a></span>(<span class='label'>foo:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>) <span class='comment'># =&gt; [{:foo=&gt;:bar}]
</span><span class='const'><a href="Array.html" title="Array (class)">Array</a></span>(<span class='label'>foo:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>)      <span class='comment'># =&gt; [[:foo, :bar]]</span></code></pre>

<p>There&#39;s also a related idiom that uses the splat operator:</p>

<pre class="code ruby"><code class="ruby">[<span class='op'>*</span><span class='id identifier rubyid_object'>object</span>]</code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/array/wrap.rb</code>.</p>

<h3>Duplicating</h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-deep_dup"><a href="Array.html#deep_dup-instance_method" title="Array#deep_dup (method)">Array#deep_dup</a></a> duplicates itself and all objects inside
recursively with the Active Support method <a href="Object.html#deep_dup-instance_method" title="Object#deep_dup (method)">Object#deep_dup</a>. It works like <code>Array#map</code>, sending <code>deep_dup</code> method to each object inside.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_array'>array</span> <span class='op'>=</span> [<span class='int'>1</span><span class='comma'>,</span> [<span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>]]
<span class='id identifier rubyid_dup'>dup</span> <span class='op'>=</span> <span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_deep_dup'>deep_dup</span>
<span class='id identifier rubyid_dup'>dup</span>[<span class='int'>1</span>][<span class='int'>2</span>] <span class='op'>=</span> <span class='int'>4</span>
<span class='id identifier rubyid_array'>array</span>[<span class='int'>1</span>][<span class='int'>2</span>] <span class='op'>==</span> <span class='kw'>nil</span>   <span class='comment'># =&gt; true</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p>

<h3>Grouping</h3>

<h4><code>in_groups_of(number, fill_with = nil)</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-in_groups_of"><code>in_groups_of</code></a> splits an array into consecutive groups of a certain size. It returns an array with the groups:</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_in_groups_of'>in_groups_of</span>(<span class='int'>2</span>) <span class='comment'># =&gt; [[1, 2], [3, nil]]</span></code></pre>

<p>or yields them in turn if a block is passed:</p>

<pre class="code xml"><code class="xml">&lt;% sample.in_groups_of(3) do |a, b, c| %&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;%= a %&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%= b %&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%= c %&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;% end %&gt;
</code></pre>

<p>The first example shows how <code>in_groups_of</code> fills the last group with as many <code>nil</code> elements as needed to have the requested size. You can change this padding value using the second optional argument:</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_in_groups_of'>in_groups_of</span>(<span class='int'>2</span><span class='comma'>,</span> <span class='int'>0</span>) <span class='comment'># =&gt; [[1, 2], [3, 0]]</span></code></pre>

<p>And you can tell the method not to fill the last group by passing <code>false</code>:</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_in_groups_of'>in_groups_of</span>(<span class='int'>2</span><span class='comma'>,</span> <span class='kw'>false</span>) <span class='comment'># =&gt; [[1, 2], [3]]</span></code></pre>

<p>As a consequence <code>false</code> can&#39;t be used as a padding value.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p>

<h4><code>in_groups(number, fill_with = nil)</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-in_groups"><code>in_groups</code></a> splits an array into a certain number of groups. The method returns an array with the groups:</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>1</span><span class='words_sep'> </span><span class='tstring_content'>2</span><span class='words_sep'> </span><span class='tstring_content'>3</span><span class='words_sep'> </span><span class='tstring_content'>4</span><span class='words_sep'> </span><span class='tstring_content'>5</span><span class='words_sep'> </span><span class='tstring_content'>6</span><span class='words_sep'> </span><span class='tstring_content'>7</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_in_groups'>in_groups</span>(<span class='int'>3</span>)
<span class='comment'># =&gt; [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], [&quot;4&quot;, &quot;5&quot;, nil], [&quot;6&quot;, &quot;7&quot;, nil]]</span></code></pre>

<p>or yields them in turn if a block is passed:</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>1</span><span class='words_sep'> </span><span class='tstring_content'>2</span><span class='words_sep'> </span><span class='tstring_content'>3</span><span class='words_sep'> </span><span class='tstring_content'>4</span><span class='words_sep'> </span><span class='tstring_content'>5</span><span class='words_sep'> </span><span class='tstring_content'>6</span><span class='words_sep'> </span><span class='tstring_content'>7</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_in_groups'>in_groups</span>(<span class='int'>3</span>) { <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_group'>group</span> }
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>3</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>4</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>nil</span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>6</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>7</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>nil</span>]</code></pre>

<p>The examples above show that <code>in_groups</code> fills some groups with a trailing <code>nil</code> element as needed. A group can get at most one of these extra elements, the rightmost one if any. And the groups that have them are always the last ones.</p>

<p>You can change this padding value using the second optional argument:</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>1</span><span class='words_sep'> </span><span class='tstring_content'>2</span><span class='words_sep'> </span><span class='tstring_content'>3</span><span class='words_sep'> </span><span class='tstring_content'>4</span><span class='words_sep'> </span><span class='tstring_content'>5</span><span class='words_sep'> </span><span class='tstring_content'>6</span><span class='words_sep'> </span><span class='tstring_content'>7</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_in_groups'>in_groups</span>(<span class='int'>3</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>)
<span class='comment'># =&gt; [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], [&quot;4&quot;, &quot;5&quot;, &quot;0&quot;], [&quot;6&quot;, &quot;7&quot;, &quot;0&quot;]]</span></code></pre>

<p>And you can tell the method not to fill the smaller groups by passing <code>false</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>1</span><span class='words_sep'> </span><span class='tstring_content'>2</span><span class='words_sep'> </span><span class='tstring_content'>3</span><span class='words_sep'> </span><span class='tstring_content'>4</span><span class='words_sep'> </span><span class='tstring_content'>5</span><span class='words_sep'> </span><span class='tstring_content'>6</span><span class='words_sep'> </span><span class='tstring_content'>7</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_in_groups'>in_groups</span>(<span class='int'>3</span><span class='comma'>,</span> <span class='kw'>false</span>)
<span class='comment'># =&gt; [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], [&quot;4&quot;, &quot;5&quot;], [&quot;6&quot;, &quot;7&quot;]]</span></code></pre>

<p>As a consequence <code>false</code> can&#39;t be used as a padding value.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p>

<h4><code>split(value = nil)</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Array.html#method-i-split"><code>split</code></a> divides an array by a separator and returns the resulting chunks.</p>

<p>If a block is passed the separators are those elements of the array for which the block returns true:</p>

<pre class="code ruby"><code class="ruby">(<span class='op'>-</span><span class='int'>5</span><span class='op'>..</span><span class='int'>5</span>).<span class='id identifier rubyid_to_a'>to_a</span>.<span class='id identifier rubyid_split'>split</span> { <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_multiple_of?'>multiple_of?</span>(<span class='int'>4</span>) }
<span class='comment'># =&gt; [[-5], [-3, -2, -1], [1, 2, 3], [5]]</span></code></pre>

<p>Otherwise, the value received as argument, which defaults to <code>nil</code>, is the separator:</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>5</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_split'>split</span>(<span class='int'>1</span>)
<span class='comment'># =&gt; [[0], [-5], [], [&quot;foo&quot;, &quot;bar&quot;]]</span></code></pre>

<p>TIP: Observe in the previous example that consecutive separators result in empty arrays.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p>

<h2>Extensions to <a href="Hash.html" title="Hash (class)"><code>Hash</code></a></h2>

<h3>Conversions</h3>

<h4><code>to_xml</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-to_xml"><code>to_xml</code></a> returns a string containing an XML representation of its receiver:</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>foo:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_to_xml'>to_xml</span>
<span class='comment'># =&gt;
</span><span class='comment'># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span class='comment'># &lt;hash&gt;
</span><span class='comment'>#   &lt;foo type=&quot;integer&quot;&gt;1&lt;/foo&gt;
</span><span class='comment'>#   &lt;bar type=&quot;integer&quot;&gt;2&lt;/bar&gt;
</span><span class='comment'># &lt;/hash&gt;</span></code></pre>

<p>To do so, the method loops over the pairs and builds nodes that depend on the <em>values</em>. Given a pair <code>key</code>, <code>value</code>:</p>

<ul>
<li><p>If <code>value</code> is a hash there&#39;s a recursive call with <code>key</code> as <code>:root</code>.</p></li>
<li><p>If <code>value</code> is an array there&#39;s a recursive call with <code>key</code> as <code>:root</code>, and <code>key</code> singularized as <code>:children</code>.</p></li>
<li><p>If <code>value</code> is a callable object it must expect one or two arguments. Depending on the arity, the callable is invoked with the <code>options</code> hash as first argument with <code>key</code> as <code>:root</code>, and <code>key</code> singularized as second argument. Its return value becomes a new node.</p></li>
<li><p>If <code>value</code> responds to <code>to_xml</code> the method is invoked with <code>key</code> as <code>:root</code>.</p></li>
<li><p>Otherwise, a node with <code>key</code> as tag is created with a string representation of <code>value</code> as text node. If <code>value</code> is <code>nil</code> an attribute &quot;nil&quot; set to &quot;true&quot; is added. Unless the option <code>:skip_types</code> exists and is true, an attribute &quot;type&quot; is added as well according to the following mapping:</p></li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='const'>XML_TYPE_NAMES</span> <span class='op'>=</span> {
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Symbol</span><span class='tstring_end'>&quot;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>symbol</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Integer</span><span class='tstring_end'>&quot;</span></span>    <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>integer</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BigDecimal</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>decimal</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Float</span><span class='tstring_end'>&quot;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>float</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TrueClass</span><span class='tstring_end'>&quot;</span></span>  <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>boolean</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FalseClass</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>boolean</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Date</span><span class='tstring_end'>&quot;</span></span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>date</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DateTime</span><span class='tstring_end'>&quot;</span></span>   <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>datetime</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Time</span><span class='tstring_end'>&quot;</span></span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>datetime</span><span class='tstring_end'>&quot;</span></span>
}</code></pre>

<p>By default the root node is &quot;hash&quot;, but that&#39;s configurable via the <code>:root</code> option.</p>

<p>The default XML builder is a fresh instance of <code>Builder::XmlMarkup</code>. You can configure your own builder with the <code>:builder</code> option. The method also accepts options like <code>:dasherize</code> and friends, they are forwarded to the builder.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/conversions.rb</code>.</p>

<h3>Merging</h3>

<p>Ruby has a built-in method <code>Hash#merge</code> that merges two hashes:</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>a:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>c:</span> <span class='int'>2</span>)
<span class='comment'># =&gt; {:a=&gt;0, :b=&gt;1, :c=&gt;2}</span></code></pre>

<p>Active Support defines a few more ways of merging hashes that may be convenient.</p>

<h4><code>reverse_merge</code> and <code>reverse_merge!</code></h4>

<p>In case of collision the key in the hash of the argument wins in <code>merge</code>. You can support option hashes with default values in a compact way with this idiom:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> { <span class='label'>length:</span> <span class='int'>30</span><span class='comma'>,</span> <span class='label'>omission:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span> }.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_options'>options</span>)</code></pre>

<p>Active Support defines <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-reverse_merge"><code>reverse_merge</code></a> in case you prefer this alternative notation:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_reverse_merge'>reverse_merge</span>(<span class='label'>length:</span> <span class='int'>30</span><span class='comma'>,</span> <span class='label'>omission:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span>)</code></pre>

<p>And a bang version <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-reverse_merge-21"><code>reverse_merge!</code></a> that performs the merge in place:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_reverse_merge!'>reverse_merge!</span>(<span class='label'>length:</span> <span class='int'>30</span><span class='comma'>,</span> <span class='label'>omission:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span>)</code></pre>

<p>WARNING. Take into account that <code>reverse_merge!</code> may change the hash in the caller, which may or may not be a good idea.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/reverse_merge.rb</code>.</p>

<h4><code>reverse_update</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-reverse_update"><code>reverse_update</code></a> is an alias for <code>reverse_merge!</code>, explained above.</p>

<p>WARNING. Note that <code>reverse_update</code> has no bang.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/reverse_merge.rb</code>.</p>

<h4><code>deep_merge</code> and <code>deep_merge!</code></h4>

<p>As you can see in the previous example if a key is found in both hashes the value in the one in the argument wins.</p>

<p>Active Support defines <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_merge"><a href="Hash.html#deep_merge-instance_method" title="Hash#deep_merge (method)">Hash#deep_merge</a></a>. In a deep merge, if a key is found in both hashes and their values are hashes in turn, then their <em>merge</em> becomes the value in the resulting hash:</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>a:</span> { <span class='label'>b:</span> <span class='int'>1</span> } }.<span class='id identifier rubyid_deep_merge'>deep_merge</span>(<span class='label'>a:</span> { <span class='label'>c:</span> <span class='int'>2</span> })
<span class='comment'># =&gt; {:a=&gt;{:b=&gt;1, :c=&gt;2}}</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_merge-21"><code>deep_merge!</code></a> performs a deep merge in place.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/deep_merge.rb</code>.</p>

<h3>Deep Duplicating</h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_dup"><a href="Hash.html#deep_dup-instance_method" title="Hash#deep_dup (method)">Hash#deep_dup</a></a> duplicates itself and all keys and values
inside recursively with Active Support method <a href="Object.html#deep_dup-instance_method" title="Object#deep_dup (method)">Object#deep_dup</a>. It works like <code>Enumerator#each_with_object</code> with sending <code>deep_dup</code> method to each pair inside.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> { <span class='label'>c:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>d:</span> [<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>] } }

<span class='id identifier rubyid_dup'>dup</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_deep_dup'>deep_dup</span>
<span class='id identifier rubyid_dup'>dup</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_b'>b</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_e'>e</span>] <span class='op'>=</span> <span class='int'>5</span>
<span class='id identifier rubyid_dup'>dup</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_b'>b</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_d'>d</span>] <span class='op'>&lt;&lt;</span> <span class='int'>5</span>

<span class='id identifier rubyid_hash'>hash</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_b'>b</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_e'>e</span>] <span class='op'>==</span> <span class='kw'>nil</span>      <span class='comment'># =&gt; true
</span><span class='id identifier rubyid_hash'>hash</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_b'>b</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_d'>d</span>] <span class='op'>==</span> [<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]   <span class='comment'># =&gt; true</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p>

<h3>Working with Keys</h3>

<h4><code>except!</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-except-21"><code>except!</code></a> is identical to the built-in <code>except</code> method but removes keys in place, returning <code>self</code>.</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_except!'>except!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>) <span class='comment'># =&gt; {:b=&gt;2}
</span>{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_except!'>except!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_c'>c</span>) <span class='comment'># =&gt; {:a=&gt;1, :b=&gt;2}</span></code></pre>

<p>If the receiver responds to <code>convert_key</code>, the method is called on each of the arguments. This allows <code>except!</code> (and <code>except</code>) to play nice with hashes with indifferent access for instance:</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>a:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>.<span class='id identifier rubyid_except!'>except!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>)  <span class='comment'># =&gt; {}
</span>{ <span class='label'>a:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>.<span class='id identifier rubyid_except!'>except!</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; {}</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/except.rb</code>.</p>

<h4><code>stringify_keys</code> and <code>stringify_keys!</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-stringify_keys"><code>stringify_keys</code></a> returns a hash that has a stringified version of the keys in the receiver. It does so by sending <code>to_s</code> to them:</p>

<pre class="code ruby"><code class="ruby">{ <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>1</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>a:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span> }.<span class='id identifier rubyid_stringify_keys'>stringify_keys</span>
<span class='comment'># =&gt; {&quot;&quot; =&gt; nil, &quot;1&quot; =&gt; 1, &quot;a&quot; =&gt; :a}</span></code></pre>

<p>In case of key collision, the value will be the one most recently inserted into the hash:</p>

<pre class="code ruby"><code class="ruby">{ <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>a:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_stringify_keys'>stringify_keys</span>
<span class='comment'># The result will be
</span><span class='comment'># =&gt; {&quot;a&quot;=&gt;2}</span></code></pre>

<p>This method may be useful for example to easily accept both symbols and strings as options. For instance <a href="ActionView/Helpers/FormHelper.html" title="ActionView::Helpers::FormHelper (module)"><code>::ActionView::Helpers::FormHelper</code></a> defines:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_to_checkbox_tag'>to_checkbox_tag</span>(<span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_checked_value'>checked_value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_unchecked_value'>unchecked_value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>)
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_stringify_keys'>stringify_keys</span>
  <span class='id identifier rubyid_options'>options</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span>] <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>checkbox</span><span class='tstring_end'>&quot;</span></span>
  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>

<p>The second line can safely access the &quot;type&quot; key, and let the user to pass either <code>:type</code> or &quot;type&quot;.</p>

<p>There&#39;s also the bang variant <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-stringify_keys-21"><code>stringify_keys!</code></a> that stringifies keys in place.</p>

<p>Besides that, one can use <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_stringify_keys"><code>deep_stringify_keys</code></a> and <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_stringify_keys-21"><code>deep_stringify_keys!</code></a> to stringify all the keys in the given hash and all the hashes nested in it. An example of the result is:</p>

<pre class="code ruby"><code class="ruby">{ <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>1</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>nested:</span> { <span class='label'>a:</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>5</span> <span class='op'>=&gt;</span> <span class='int'>5</span> } }.<span class='id identifier rubyid_deep_stringify_keys'>deep_stringify_keys</span>
<span class='comment'># =&gt; {&quot;&quot;=&gt;nil, &quot;1&quot;=&gt;1, &quot;nested&quot;=&gt;{&quot;a&quot;=&gt;3, &quot;5&quot;=&gt;5}}</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h4><code>symbolize_keys</code> and <code>symbolize_keys!</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-symbolize_keys"><code>symbolize_keys</code></a> returns a hash that has a symbolized version of the keys in the receiver, where possible. It does so by sending <code>to_sym</code> to them:</p>

<pre class="code ruby"><code class="ruby">{ <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>1</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> }.<span class='id identifier rubyid_symbolize_keys'>symbolize_keys</span>
<span class='comment'># =&gt; {nil=&gt;nil, 1=&gt;1, :a=&gt;&quot;a&quot;}</span></code></pre>

<p>WARNING. Note in the previous example only one key was symbolized.</p>

<p>In case of key collision, the value will be the one most recently inserted into the hash:</p>

<pre class="code ruby"><code class="ruby">{ <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>a:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_symbolize_keys'>symbolize_keys</span>
<span class='comment'># =&gt; {:a=&gt;2}</span></code></pre>

<p>This method may be useful for example to easily accept both symbols and strings as options. For instance <code>ActionText::TagHelper</code> defines</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_rich_textarea_tag'>rich_textarea_tag</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_symbolize_keys'>symbolize_keys</span>

  <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_input'>input</span>] <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trix_input_</span><span class='embexpr_beg'>#{</span><span class='const'><a href="ActionText.html" title="ActionText (module)">ActionText</a></span><span class='op'>::</span><span class='const'>TagHelper</span>.<span class='id identifier rubyid_id'>id</span> <span class='op'>+=</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>

<p>The third line can safely access the <code>:input</code> key, and let the user to pass either <code>:input</code> or &quot;input&quot;.</p>

<p>There&#39;s also the bang variant <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-symbolize_keys-21"><code>symbolize_keys!</code></a> that symbolizes keys in place.</p>

<p>Besides that, one can use <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_symbolize_keys"><code>deep_symbolize_keys</code></a> and <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_symbolize_keys-21"><code>deep_symbolize_keys!</code></a> to symbolize all the keys in the given hash and all the hashes nested in it. An example of the result is:</p>

<pre class="code ruby"><code class="ruby">{ <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>1</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>nested</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>5</span> <span class='op'>=&gt;</span> <span class='int'>5</span> } }.<span class='id identifier rubyid_deep_symbolize_keys'>deep_symbolize_keys</span>
<span class='comment'># =&gt; {nil=&gt;nil, 1=&gt;1, nested:{a:3, 5=&gt;5}}</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h4><code>to_options</code> and <code>to_options!</code></h4>

<p>The methods <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-to_options"><code>to_options</code></a> and <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-to_options-21"><code>to_options!</code></a> are aliases of <code>symbolize_keys</code> and <code>symbolize_keys!</code>, respectively.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h4><code>assert_valid_keys</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-assert_valid_keys"><code>assert_valid_keys</code></a> receives an arbitrary number of arguments, and checks whether the receiver has any key outside that list. If it does <code>ArgumentError</code> is raised.</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>a:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_assert_valid_keys'>assert_valid_keys</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>)  <span class='comment'># passes
</span>{ <span class='label'>a:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_assert_valid_keys'>assert_valid_keys</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># ArgumentError</span></code></pre>

<p>Active Record does not accept unknown options when building associations, for example. It implements that control via <code>assert_valid_keys</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h3>Working with Values</h3>

<h4><code>deep_transform_values</code> and <code>deep_transform_values!</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_transform_values"><code>deep_transform_values</code></a> returns a new hash with all values converted by the block operation. This includes the values from the root hash and from all nested hashes and arrays.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> { <span class='label'>person:</span> { <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rob</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>age:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>28</span><span class='tstring_end'>&quot;</span></span> } }

<span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_deep_transform_values'>deep_transform_values</span> { <span class='op'>|</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_upcase'>upcase</span> }
<span class='comment'># =&gt; {person: {name: &quot;ROB&quot;, age: &quot;28&quot;}}</span></code></pre>

<p>There&#39;s also the bang variant <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-deep_transform_values-21"><code>deep_transform_values!</code></a> that destructively converts all values by using the block operation.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/deep_transform_values.rb</code>.</p>

<h3>Slicing</h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-slice-21"><code>slice!</code></a> replaces the hash with only the given keys and returns a hash containing the removed key/value pairs.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }
<span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_slice!'>slice!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>) <span class='comment'># =&gt; {:b=&gt;2}
</span><span class='id identifier rubyid_hash'>hash</span>                   <span class='comment'># =&gt; {:a=&gt;1}</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/slice.rb</code>.</p>

<h3>Extracting</h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-extract-21"><code>extract!</code></a> removes and returns the key/value pairs matching the given keys.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }
<span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_extract!'>extract!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>) <span class='comment'># =&gt; {:a=&gt;1}
</span><span class='id identifier rubyid_hash'>hash</span>                     <span class='comment'># =&gt; {:b=&gt;2}</span></code></pre>

<p>The method <code>extract!</code> returns the same subclass of Hash that the receiver is.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>
<span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_extract!'>extract!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>).<span class='id identifier rubyid_class'>class</span>
<span class='comment'># =&gt; ActiveSupport::HashWithIndifferentAccess</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/slice.rb</code>.</p>

<h3>Indifferent Access</h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Hash.html#method-i-with_indifferent_access"><code>with_indifferent_access</code></a> returns an <a href="https://api.rubyonrails.org/classes/ActiveSupport/HashWithIndifferentAccess.html"><a href="ActiveSupport/HashWithIndifferentAccess.html" title="ActiveSupport::HashWithIndifferentAccess (class)"><code>::ActiveSupport::HashWithIndifferentAccess</code></a></a> out of its receiver:</p>

<pre class="code ruby"><code class="ruby">{ <span class='label'>a:</span> <span class='int'>1</span> }.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span>] <span class='comment'># =&gt; 1</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/indifferent_access.rb</code>.</p>

<h2>Extensions to <a href="Regexp.html" title="Regexp (class)"><code>Regexp</code></a></h2>

<h3><code>multiline?</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Regexp.html#method-i-multiline-3F"><code>multiline?</code></a> says whether a regexp has the <code>/m</code> flag set, that is, whether the dot matches newlines.</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>.</span><span class='regexp_end'>}</span></span>.<span class='id identifier rubyid_multiline?'>multiline?</span>  <span class='comment'># =&gt; false
</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>.</span><span class='regexp_end'>}m</span></span>.<span class='id identifier rubyid_multiline?'>multiline?</span> <span class='comment'># =&gt; true
</span>
<span class='const'><a href="Regexp.html" title="Regexp (class)">Regexp</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_multiline?'><a href="Regexp.html#multiline%3F-instance_method" title="Regexp#multiline? (method)">multiline?</a></span>                    <span class='comment'># =&gt; false
</span><span class='const'><a href="Regexp.html" title="Regexp (class)">Regexp</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'><a href="Regexp.html" title="Regexp (class)">Regexp</a></span><span class='op'>::</span><span class='const'>MULTILINE</span>).<span class='id identifier rubyid_multiline?'><a href="Regexp.html#multiline%3F-instance_method" title="Regexp#multiline? (method)">multiline?</a></span> <span class='comment'># =&gt; true</span></code></pre>

<p>Rails uses this method in a single place, also in the routing code. Multiline regexps are disallowed for route requirements and this flag eases enforcing that constraint.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_verify_regexp_requirements'>verify_regexp_requirements</span>(<span class='id identifier rubyid_requirements'>requirements</span>)
  <span class='comment'># ...
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_requirement'>requirement</span>.<span class='id identifier rubyid_multiline?'>multiline?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Regexp multiline option is not allowed in routing requirements: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_requirement'>requirement</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/regexp.rb</code>.</p>

<h2>Extensions to <a href="Range.html" title="Range (class)"><code>Range</code></a></h2>

<h3><code>to_fs</code></h3>

<p>Active Support defines <code>Range#to_fs</code> as an alternative to <code>to_s</code> that understands an optional format argument. As of this writing the only supported non-default format is <code>:db</code>:</p>

<pre class="code ruby"><code class="ruby">(<span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_today'>today</span><span class='op'>..</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_tomorrow'>tomorrow</span>).<span class='id identifier rubyid_to_fs'>to_fs</span>
<span class='comment'># =&gt; &quot;2009-10-25..2009-10-26&quot;
</span>
(<span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_today'>today</span><span class='op'>..</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_tomorrow'>tomorrow</span>).<span class='id identifier rubyid_to_fs'>to_fs</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_db'>db</span>)
<span class='comment'># =&gt; &quot;BETWEEN &#39;2009-10-25&#39; AND &#39;2009-10-26&#39;&quot;</span></code></pre>

<p>As the example depicts, the <code>:db</code> format generates a <code>BETWEEN</code> SQL clause. That is used by Active Record in its support for range values in conditions.</p>

<p>NOTE: Defined in <code>active_support/core_ext/range/conversions.rb</code>.</p>

<h3><code>===</code> and <code>include?</code></h3>

<p>The methods <code>Range#===</code> and <code>Range#include?</code> say whether some value falls between the ends of a given instance:</p>

<pre class="code ruby"><code class="ruby">(<span class='int'>2</span><span class='op'>..</span><span class='int'>3</span>).<span class='id identifier rubyid_include?'>include?</span>(<span class='const'>Math</span><span class='op'>::</span><span class='const'>E</span>) <span class='comment'># =&gt; true</span></code></pre>

<p>Active Support extends these methods so that the argument may be another range in turn. In that case we test whether the ends of the argument range belong to the receiver themselves:</p>

<pre class="code ruby"><code class="ruby">(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>) <span class='op'>===</span> (<span class='int'>3</span><span class='op'>..</span><span class='int'>7</span>)  <span class='comment'># =&gt; true
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>) <span class='op'>===</span> (<span class='int'>0</span><span class='op'>..</span><span class='int'>7</span>)  <span class='comment'># =&gt; false
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>) <span class='op'>===</span> (<span class='int'>3</span><span class='op'>..</span><span class='int'>11</span>) <span class='comment'># =&gt; false
</span>(<span class='int'>1</span><span class='op'>...</span><span class='int'>9</span>) <span class='op'>===</span> (<span class='int'>3</span><span class='op'>..</span><span class='int'>9</span>)  <span class='comment'># =&gt; false
</span>
(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>).<span class='id identifier rubyid_include?'>include?</span>(<span class='int'>3</span><span class='op'>..</span><span class='int'>7</span>)  <span class='comment'># =&gt; true
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>).<span class='id identifier rubyid_include?'>include?</span>(<span class='int'>0</span><span class='op'>..</span><span class='int'>7</span>)  <span class='comment'># =&gt; false
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>).<span class='id identifier rubyid_include?'>include?</span>(<span class='int'>3</span><span class='op'>..</span><span class='int'>11</span>) <span class='comment'># =&gt; false
</span>(<span class='int'>1</span><span class='op'>...</span><span class='int'>9</span>).<span class='id identifier rubyid_include?'>include?</span>(<span class='int'>3</span><span class='op'>..</span><span class='int'>9</span>)  <span class='comment'># =&gt; false</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/range/compare_range.rb</code>.</p>

<h3><code>overlap?</code></h3>

<p>The method <a href="https://api.rubyonrails.org/classes/Range.html#method-i-overlaps-3F"><a href="Range.html#overlap%3F-instance_method" title="Range#overlap? (method)">Range#overlap?</a></a> says whether any two given ranges have non-void intersection:</p>

<pre class="code ruby"><code class="ruby">(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>).<span class='id identifier rubyid_overlap?'>overlap?</span>(<span class='int'>7</span><span class='op'>..</span><span class='int'>11</span>)  <span class='comment'># =&gt; true
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>).<span class='id identifier rubyid_overlap?'>overlap?</span>(<span class='int'>0</span><span class='op'>..</span><span class='int'>7</span>)   <span class='comment'># =&gt; true
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>10</span>).<span class='id identifier rubyid_overlap?'>overlap?</span>(<span class='int'>11</span><span class='op'>..</span><span class='int'>27</span>) <span class='comment'># =&gt; false</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/range/overlap.rb</code>.</p>

<h2>Extensions to <a href="Date.html" title="Date (class)"><code>Date</code></a></h2>

<h3>Calculations</h3>

<p>INFO: The following calculation methods have edge cases in October 1582, since days 5..14 just do not exist. This guide does not document their behavior around those days for brevity, but it is enough to say that they do what you would expect. That is, <code>Date.new(1582, 10, 4).tomorrow</code> returns <code>Date.new(1582, 10, 15)</code> and so on. Please check <code>test/core_ext/date_ext_test.rb</code> in the Active Support test suite for expected behavior.</p>

<h4><a href="Date.html#current-class_method" title="Date.current (method)">Date.current</a></h4>

<p>Active Support defines <a href="https://api.rubyonrails.org/classes/Date.html#method-c-current"><a href="Date.html#current-class_method" title="Date.current (method)">Date.current</a></a> to be today in the current time zone. That&#39;s like <code>Date.today</code>, except that it honors the user time zone, if defined. It also defines <a href="https://api.rubyonrails.org/classes/Date.html#method-c-yesterday"><a href="Date.html#yesterday-class_method" title="Date.yesterday (method)">Date.yesterday</a></a> and <a href="https://api.rubyonrails.org/classes/Date.html#method-c-tomorrow"><a href="Date.html#tomorrow-class_method" title="Date.tomorrow (method)">Date.tomorrow</a></a>, and the instance predicates <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-past-3F"><code>past?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-today-3F"><code>today?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-tomorrow-3F"><code>tomorrow?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-next_day-3F"><code>next_day?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-yesterday-3F"><code>yesterday?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-prev_day-3F"><code>prev_day?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-future-3F"><code>future?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-on_weekday-3F"><code>on_weekday?</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-on_weekend-3F"><code>on_weekend?</code></a>, all of them relative to <a href="Date.html#current-class_method" title="Date.current (method)">Date.current</a>.</p>

<p>When making Date comparisons using methods which honor the user time zone, make sure to use <a href="Date.html#current-class_method" title="Date.current (method)">Date.current</a> and not <code>Date.today</code>. There are cases where the user time zone might be in the future compared to the system time zone, which <code>Date.today</code> uses by default. This means <code>Date.today</code> may equal <a href="Date.html#yesterday-class_method" title="Date.yesterday (method)">Date.yesterday</a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date/calculations.rb</code>.</p>

<h4>Named Dates</h4>

<h5><code>beginning_of_week</code>, <code>end_of_week</code></h5>

<p>The methods <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-beginning_of_week"><code>beginning_of_week</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-end_of_week"><code>end_of_week</code></a> return the dates for the
beginning and end of the week, respectively. Weeks are assumed to start on
Monday, but that can be changed passing an argument, setting thread local
<a href="Date.html#beginning_of_week-class_method" title="Date.beginning_of_week (method)">Date.beginning_of_week</a> or <a href="configuring.html#config-beginning-of-week"><code>config.beginning_of_week</code></a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>8</span>)     <span class='comment'># =&gt; Sat, 08 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_beginning_of_week'>beginning_of_week</span>          <span class='comment'># =&gt; Mon, 03 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_beginning_of_week'>beginning_of_week</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_sunday'>sunday</span>) <span class='comment'># =&gt; Sun, 02 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_end_of_week'>end_of_week</span>                <span class='comment'># =&gt; Sun, 09 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_end_of_week'>end_of_week</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_sunday'>sunday</span>)       <span class='comment'># =&gt; Sat, 08 May 2010</span></code></pre>

<p><code>beginning_of_week</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_beginning_of_week"><code>at_beginning_of_week</code></a> and <code>end_of_week</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_end_of_week"><code>at_end_of_week</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>monday</code>, <code>sunday</code></h5>

<p>The methods <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-monday"><code>monday</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-sunday"><code>sunday</code></a> return the dates for the previous Monday and
next Sunday, respectively.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>8</span>)     <span class='comment'># =&gt; Sat, 08 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_monday'>monday</span>                     <span class='comment'># =&gt; Mon, 03 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_sunday'>sunday</span>                     <span class='comment'># =&gt; Sun, 09 May 2010
</span>
<span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2012</span><span class='comma'>,</span> <span class='int'>9</span><span class='comma'>,</span> <span class='int'>10</span>)    <span class='comment'># =&gt; Mon, 10 Sep 2012
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_monday'>monday</span>                     <span class='comment'># =&gt; Mon, 10 Sep 2012
</span>
<span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2012</span><span class='comma'>,</span> <span class='int'>9</span><span class='comma'>,</span> <span class='int'>16</span>)    <span class='comment'># =&gt; Sun, 16 Sep 2012
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_sunday'>sunday</span>                     <span class='comment'># =&gt; Sun, 16 Sep 2012</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>prev_week</code>, <code>next_week</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-next_week"><code>next_week</code></a> receives a symbol with a day name in English (default is the thread local <a href="https://api.rubyonrails.org/classes/Date.html#method-c-beginning_of_week"><a href="Date.html#beginning_of_week-class_method" title="Date.beginning_of_week (method)">Date.beginning_of_week</a></a>, or <a href="configuring.html#config-beginning-of-week"><code>config.beginning_of_week</code></a>, or <code>:monday</code>) and it returns the date corresponding to that day.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>9</span>) <span class='comment'># =&gt; Sun, 09 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_next_week'>next_week</span>              <span class='comment'># =&gt; Mon, 10 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_next_week'>next_week</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_saturday'>saturday</span>)   <span class='comment'># =&gt; Sat, 15 May 2010</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-prev_week"><code>prev_week</code></a> is analogous:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_prev_week'>prev_week</span>              <span class='comment'># =&gt; Mon, 26 Apr 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_prev_week'>prev_week</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_saturday'>saturday</span>)   <span class='comment'># =&gt; Sat, 01 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_prev_week'>prev_week</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_friday'>friday</span>)     <span class='comment'># =&gt; Fri, 30 Apr 2010</span></code></pre>

<p><code>prev_week</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-last_week"><code>last_week</code></a>.</p>

<p>Both <code>next_week</code> and <code>prev_week</code> work as expected when <a href="Date.html#beginning_of_week-class_method" title="Date.beginning_of_week (method)">Date.beginning_of_week</a> or <code>config.beginning_of_week</code> are set.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>beginning_of_month</code>, <code>end_of_month</code></h5>

<p>The methods <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-beginning_of_month"><code>beginning_of_month</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-end_of_month"><code>end_of_month</code></a> return the dates for the beginning and end of the month:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>9</span>) <span class='comment'># =&gt; Sun, 09 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_beginning_of_month'>beginning_of_month</span>     <span class='comment'># =&gt; Sat, 01 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_end_of_month'>end_of_month</span>           <span class='comment'># =&gt; Mon, 31 May 2010</span></code></pre>

<p><code>beginning_of_month</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_beginning_of_month"><code>at_beginning_of_month</code></a>, and <code>end_of_month</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_end_of_month"><code>at_end_of_month</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>quarter</code>, <code>beginning_of_quarter</code>, <code>end_of_quarter</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-quarter"><code>quarter</code></a> returns the quarter of the receiver&#39;s calendar year:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>9</span>) <span class='comment'># =&gt; Sun, 09 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_quarter'>quarter</span>                <span class='comment'># =&gt; 2</span></code></pre>

<p>The methods <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-beginning_of_quarter"><code>beginning_of_quarter</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-end_of_quarter"><code>end_of_quarter</code></a> return the dates for the beginning and end of the quarter of the receiver&#39;s calendar year:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>9</span>) <span class='comment'># =&gt; Sun, 09 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_beginning_of_quarter'>beginning_of_quarter</span>   <span class='comment'># =&gt; Thu, 01 Apr 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_end_of_quarter'>end_of_quarter</span>         <span class='comment'># =&gt; Wed, 30 Jun 2010</span></code></pre>

<p><code>beginning_of_quarter</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_beginning_of_quarter"><code>at_beginning_of_quarter</code></a>, and <code>end_of_quarter</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_end_of_quarter"><code>at_end_of_quarter</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>beginning_of_year</code>, <code>end_of_year</code></h5>

<p>The methods <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-beginning_of_year"><code>beginning_of_year</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-end_of_year"><code>end_of_year</code></a> return the dates for the beginning and end of the year:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>9</span>) <span class='comment'># =&gt; Sun, 09 May 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_beginning_of_year'>beginning_of_year</span>      <span class='comment'># =&gt; Fri, 01 Jan 2010
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_end_of_year'>end_of_year</span>            <span class='comment'># =&gt; Fri, 31 Dec 2010</span></code></pre>

<p><code>beginning_of_year</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_beginning_of_year"><code>at_beginning_of_year</code></a>, and <code>end_of_year</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-at_end_of_year"><code>at_end_of_year</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h4>Other Date Computations</h4>

<h5><code>years_ago</code>, <code>years_since</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-years_ago"><code>years_ago</code></a> receives a number of years and returns the same date those many years ago:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_years_ago'>years_ago</span>(<span class='int'>10</span>) <span class='comment'># =&gt; Wed, 07 Jun 2000</span></code></pre>

<p><a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-years_since"><code>years_since</code></a> moves forward in time:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_years_since'>years_since</span>(<span class='int'>10</span>) <span class='comment'># =&gt; Sun, 07 Jun 2020</span></code></pre>

<p>If such a day does not exist, the last day of the corresponding month is returned:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2012</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>29</span>).<span class='id identifier rubyid_years_ago'><a href="DateAndTime/Calculations.html#years_ago-instance_method" title="DateAndTime::Calculations#years_ago (method)">years_ago</a></span>(<span class='int'>3</span>)     <span class='comment'># =&gt; Sat, 28 Feb 2009
</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2012</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>29</span>).<span class='id identifier rubyid_years_since'><a href="DateAndTime/Calculations.html#years_since-instance_method" title="DateAndTime::Calculations#years_since (method)">years_since</a></span>(<span class='int'>3</span>)   <span class='comment'># =&gt; Sat, 28 Feb 2015</span></code></pre>

<p><a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-last_year"><code>last_year</code></a> is short-hand for <code>#years_ago(1)</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>months_ago</code>, <code>months_since</code></h5>

<p>The methods <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-months_ago"><code>months_ago</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-months_since"><code>months_since</code></a> work analogously for months:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>4</span><span class='comma'>,</span> <span class='int'>30</span>).<span class='id identifier rubyid_months_ago'><a href="DateAndTime/Calculations.html#months_ago-instance_method" title="DateAndTime::Calculations#months_ago (method)">months_ago</a></span>(<span class='int'>2</span>)   <span class='comment'># =&gt; Sun, 28 Feb 2010
</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>4</span><span class='comma'>,</span> <span class='int'>30</span>).<span class='id identifier rubyid_months_since'><a href="DateAndTime/Calculations.html#months_since-instance_method" title="DateAndTime::Calculations#months_since (method)">months_since</a></span>(<span class='int'>2</span>) <span class='comment'># =&gt; Wed, 30 Jun 2010</span></code></pre>

<p>If such a day does not exist, the last day of the corresponding month is returned:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>4</span><span class='comma'>,</span> <span class='int'>30</span>).<span class='id identifier rubyid_months_ago'><a href="DateAndTime/Calculations.html#months_ago-instance_method" title="DateAndTime::Calculations#months_ago (method)">months_ago</a></span>(<span class='int'>2</span>)    <span class='comment'># =&gt; Sun, 28 Feb 2010
</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2009</span><span class='comma'>,</span> <span class='int'>12</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_months_since'><a href="DateAndTime/Calculations.html#months_since-instance_method" title="DateAndTime::Calculations#months_since (method)">months_since</a></span>(<span class='int'>2</span>) <span class='comment'># =&gt; Sun, 28 Feb 2010</span></code></pre>

<p><a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-last_month"><code>last_month</code></a> is short-hand for <code>#months_ago(1)</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>weeks_ago</code>, <code>weeks_since</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-weeks_ago"><code>weeks_ago</code></a> and [<code>weeks_since</code>][DateAndTime::Calculations#week_since] work analogously for weeks:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>24</span>).<span class='id identifier rubyid_weeks_ago'><a href="DateAndTime/Calculations.html#weeks_ago-instance_method" title="DateAndTime::Calculations#weeks_ago (method)">weeks_ago</a></span>(<span class='int'>1</span>)   <span class='comment'># =&gt; Mon, 17 May 2010
</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>24</span>).<span class='id identifier rubyid_weeks_since'><a href="DateAndTime/Calculations.html#weeks_since-instance_method" title="DateAndTime::Calculations#weeks_since (method)">weeks_since</a></span>(<span class='int'>2</span>) <span class='comment'># =&gt; Mon, 07 Jun 2010</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h5><code>advance</code></h5>

<p>The most generic way to jump to other days is <a href="https://api.rubyonrails.org/classes/Date.html#method-i-advance"><code>advance</code></a>. This method receives a hash with keys <code>:years</code>, <code>:months</code>, <code>:weeks</code>, <code>:days</code>, and returns a date advanced as much as the present keys indicate:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>6</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_advance'>advance</span>(<span class='label'>years:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>weeks:</span> <span class='int'>2</span>)  <span class='comment'># =&gt; Mon, 20 Jun 2011
</span><span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_advance'>advance</span>(<span class='label'>months:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>days:</span> <span class='op'>-</span><span class='int'>2</span>) <span class='comment'># =&gt; Wed, 04 Aug 2010</span></code></pre>

<p>Note in the previous example that increments may be negative.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date/calculations.rb</code>.</p>

<h4>Changing Components</h4>

<p>The method <a href="https://api.rubyonrails.org/classes/Date.html#method-i-change"><code>change</code></a> allows you to get a new date which is the same as the receiver except for the given year, month, or day:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>12</span><span class='comma'>,</span> <span class='int'>23</span>).<span class='id identifier rubyid_change'><a href="Date.html#change-instance_method" title="Date#change (method)">change</a></span>(<span class='label'>year:</span> <span class='int'>2011</span><span class='comma'>,</span> <span class='label'>month:</span> <span class='int'>11</span>)
<span class='comment'># =&gt; Wed, 23 Nov 2011</span></code></pre>

<p>This method is not tolerant to non-existing dates, if the change is invalid <code>ArgumentError</code> is raised:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_change'><a href="Date.html#change-instance_method" title="Date#change (method)">change</a></span>(<span class='label'>month:</span> <span class='int'>2</span>)
<span class='comment'># =&gt; ArgumentError: invalid date</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date/calculations.rb</code>.</p>

<h4>Durations</h4>

<p><a href="https://api.rubyonrails.org/classes/ActiveSupport/Duration.html"><code>Duration</code></a> objects can be added to and subtracted from dates:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_current'><a href="Date.html#current-class_method" title="Date.current (method)">current</a></span>
<span class='comment'># =&gt; Mon, 09 Aug 2010
</span><span class='id identifier rubyid_d'>d</span> <span class='op'>+</span> <span class='int'>1</span>.<span class='id identifier rubyid_year'>year</span>
<span class='comment'># =&gt; Tue, 09 Aug 2011
</span><span class='id identifier rubyid_d'>d</span> <span class='op'>-</span> <span class='int'>3</span>.<span class='id identifier rubyid_hours'>hours</span>
<span class='comment'># =&gt; Sun, 08 Aug 2010 21:00:00 UTC +00:00</span></code></pre>

<p>They translate to calls to <code>since</code> or <code>advance</code>. For example here we get the correct jump in the calendar reform:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>1582</span><span class='comma'>,</span> <span class='int'>10</span><span class='comma'>,</span> <span class='int'>4</span>) <span class='op'>+</span> <span class='int'>1</span>.<span class='id identifier rubyid_day'>day</span>
<span class='comment'># =&gt; Fri, 15 Oct 1582</span></code></pre>

<h4>Timestamps</h4>

<p>INFO: The following methods return a <a href="Time.html" title="Time (class)"><code>Time</code></a> object if possible, otherwise a <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a>. If set, they honor the user time zone.</p>

<h5><code>beginning_of_day</code>, <code>end_of_day</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/Date.html#method-i-beginning_of_day"><code>beginning_of_day</code></a> returns a timestamp at the beginning of the day (00:00:00):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_beginning_of_day'>beginning_of_day</span> <span class='comment'># =&gt; Mon Jun 07 00:00:00 +0200 2010</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/Date.html#method-i-end_of_day"><code>end_of_day</code></a> returns a timestamp at the end of the day (23:59:59):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_end_of_day'>end_of_day</span> <span class='comment'># =&gt; Mon Jun 07 23:59:59 +0200 2010</span></code></pre>

<p><code>beginning_of_day</code> is aliased to <a href="https://api.rubyonrails.org/classes/Date.html#method-i-at_beginning_of_day"><code>at_beginning_of_day</code></a>, <a href="https://api.rubyonrails.org/classes/Date.html#method-i-midnight"><code>midnight</code></a>, <a href="https://api.rubyonrails.org/classes/Date.html#method-i-at_midnight"><code>at_midnight</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date/calculations.rb</code>.</p>

<h5><code>beginning_of_hour</code>, <code>end_of_hour</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-beginning_of_hour"><code>beginning_of_hour</code></a> returns a timestamp at the beginning of the hour (hh:00:00):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='int'>19</span><span class='comma'>,</span> <span class='int'>55</span><span class='comma'>,</span> <span class='int'>25</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_beginning_of_hour'>beginning_of_hour</span> <span class='comment'># =&gt; Mon Jun 07 19:00:00 +0200 2010</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-end_of_hour"><code>end_of_hour</code></a> returns a timestamp at the end of the hour (hh:59:59):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='int'>19</span><span class='comma'>,</span> <span class='int'>55</span><span class='comma'>,</span> <span class='int'>25</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_end_of_hour'>end_of_hour</span> <span class='comment'># =&gt; Mon Jun 07 19:59:59 +0200 2010</span></code></pre>

<p><code>beginning_of_hour</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-at_beginning_of_hour"><code>at_beginning_of_hour</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h5><code>beginning_of_minute</code>, <code>end_of_minute</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-beginning_of_minute"><code>beginning_of_minute</code></a> returns a timestamp at the beginning of the minute (hh:mm:00):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='int'>19</span><span class='comma'>,</span> <span class='int'>55</span><span class='comma'>,</span> <span class='int'>25</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_beginning_of_minute'>beginning_of_minute</span> <span class='comment'># =&gt; Mon Jun 07 19:55:00 +0200 2010</span></code></pre>

<p>The method <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-end_of_minute"><code>end_of_minute</code></a> returns a timestamp at the end of the minute (hh:mm:59):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='int'>19</span><span class='comma'>,</span> <span class='int'>55</span><span class='comma'>,</span> <span class='int'>25</span>)
<span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_end_of_minute'>end_of_minute</span> <span class='comment'># =&gt; Mon Jun 07 19:55:59 +0200 2010</span></code></pre>

<p><code>beginning_of_minute</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-at_beginning_of_minute"><code>at_beginning_of_minute</code></a>.</p>

<p>INFO: <code>beginning_of_hour</code>, <code>end_of_hour</code>, <code>beginning_of_minute</code>, and <code>end_of_minute</code> are implemented for <a href="Time.html" title="Time (class)"><code>Time</code></a> and <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a> but <strong>not</strong> <a href="Date.html" title="Date (class)"><code>Date</code></a> as it does not make sense to request the beginning or end of an hour or minute on a <a href="Date.html" title="Date (class)"><code>Date</code></a> instance.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h5><code>ago</code>, <code>since</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/Date.html#method-i-ago"><code>ago</code></a> receives a number of seconds as argument and returns a timestamp those many seconds ago from midnight:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_current'><a href="Date.html#current-class_method" title="Date.current (method)">current</a></span> <span class='comment'># =&gt; Fri, 11 Jun 2010
</span><span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_ago'>ago</span>(<span class='int'>1</span>)         <span class='comment'># =&gt; Thu, 10 Jun 2010 23:59:59 EDT -04:00</span></code></pre>

<p>Similarly, <a href="https://api.rubyonrails.org/classes/Date.html#method-i-since"><code>since</code></a> moves forward:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_current'><a href="Date.html#current-class_method" title="Date.current (method)">current</a></span> <span class='comment'># =&gt; Fri, 11 Jun 2010
</span><span class='id identifier rubyid_date'>date</span>.<span class='id identifier rubyid_since'>since</span>(<span class='int'>1</span>)       <span class='comment'># =&gt; Fri, 11 Jun 2010 00:00:01 EDT -04:00</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date/calculations.rb</code>.</p>

<h2>Extensions to <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a></h2>

<p>WARNING: <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a> is not aware of DST rules and so some of these methods have edge cases when a DST change is going on. For example <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-seconds_since_midnight"><code>seconds_since_midnight</code></a> might not return the real amount in such a day.</p>

<h3>Calculations</h3>

<p>The class <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a> is a subclass of <a href="Date.html" title="Date (class)"><code>Date</code></a> so by loading <code>active_support/core_ext/date/calculations.rb</code> you inherit these methods and their aliases, except that they will always return datetimes.</p>

<p>The following methods are reimplemented so you do <strong>not</strong> need to load <code>active_support/core_ext/date/calculations.rb</code> for these ones:</p>

<ul>
<li><a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-beginning_of_day"><code>beginning_of_day</code></a> / <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-midnight"><code>midnight</code></a> / <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-at_midnight"><code>at_midnight</code></a> / <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-at_beginning_of_day"><code>at_beginning_of_day</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-end_of_day"><code>end_of_day</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-ago"><code>ago</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-since"><code>since</code></a> / <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-in"><code>in</code></a></li>
</ul>

<p>On the other hand, <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-advance"><code>advance</code></a> and <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-change"><code>change</code></a> are also defined and support more options, they are documented below.</p>

<p>The following methods are only implemented in <code>active_support/core_ext/date_time/calculations.rb</code> as they only make sense when used with a <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a> instance:</p>

<ul>
<li><a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-beginning_of_hour"><code>beginning_of_hour</code></a> / <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-at_beginning_of_hour"><code>at_beginning_of_hour</code></a></li>
<li><a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-end_of_hour"><code>end_of_hour</code></a></li>
</ul>

<h4>Named Datetimes</h4>

<h5><a href="DateTime.html#current-class_method" title="DateTime.current (method)">DateTime.current</a></h5>

<p>Active Support defines <a href="https://api.rubyonrails.org/classes/DateTime.html#method-c-current"><a href="DateTime.html#current-class_method" title="DateTime.current (method)">DateTime.current</a></a> to be like <code>Time.now.to_datetime</code>, except that it honors the user time zone, if defined. The instance predicates <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-past-3F"><code>past?</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-future-3F"><code>future?</code></a> are defined relative to <a href="DateTime.html#current-class_method" title="DateTime.current (method)">DateTime.current</a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h4>Other Extensions</h4>

<h5><code>seconds_since_midnight</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-seconds_since_midnight"><code>seconds_since_midnight</code></a> returns the number of seconds since midnight:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_current'><a href="DateTime.html#current-class_method" title="DateTime.current (method)">current</a></span>     <span class='comment'># =&gt; Mon, 07 Jun 2010 20:26:36 +0000
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_seconds_since_midnight'>seconds_since_midnight</span> <span class='comment'># =&gt; 73596</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h5><code>utc</code></h5>

<p>The method <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-utc"><code>utc</code></a> gives you the same datetime in the receiver expressed in UTC.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_current'><a href="DateTime.html#current-class_method" title="DateTime.current (method)">current</a></span> <span class='comment'># =&gt; Mon, 07 Jun 2010 19:27:52 -0400
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_utc'>utc</span>                <span class='comment'># =&gt; Mon, 07 Jun 2010 23:27:52 +0000</span></code></pre>

<p>This method is also aliased as <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-getutc"><code>getutc</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h5><code>utc?</code></h5>

<p>The predicate <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-utc-3F"><code>utc?</code></a> says whether the receiver has UTC as its time zone:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_now'>now</span> <span class='comment'># =&gt; Mon, 07 Jun 2010 19:30:47 -0400
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_utc?'>utc?</span>           <span class='comment'># =&gt; false
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_utc'>utc</span>.<span class='id identifier rubyid_utc?'>utc?</span>       <span class='comment'># =&gt; true</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h5><code>advance</code></h5>

<p>The most generic way to jump to another datetime is <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-advance"><code>advance</code></a>. This method receives a hash with keys <code>:years</code>, <code>:months</code>, <code>:weeks</code>, <code>:days</code>, <code>:hours</code>, <code>:minutes</code>, and <code>:seconds</code>, and returns a datetime advanced as much as the present keys indicate.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_current'><a href="DateTime.html#current-class_method" title="DateTime.current (method)">current</a></span>
<span class='comment'># =&gt; Thu, 05 Aug 2010 11:33:31 +0000
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_advance'>advance</span>(<span class='label'>years:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>months:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>days:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>hours:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>minutes:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>seconds:</span> <span class='int'>1</span>)
<span class='comment'># =&gt; Tue, 06 Sep 2011 12:34:32 +0000</span></code></pre>

<p>This method first computes the destination date passing <code>:years</code>, <code>:months</code>, <code>:weeks</code>, and <code>:days</code> to <a href="Date.html#advance-instance_method" title="Date#advance (method)">Date#advance</a> documented above. After that, it adjusts the time calling <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-since"><code>since</code></a> with the number of seconds to advance. This order is relevant, a different ordering would give different datetimes in some edge-cases. The example in <a href="Date.html#advance-instance_method" title="Date#advance (method)">Date#advance</a> applies, and we can extend it to show order relevance related to the time bits.</p>

<p>If we first move the date bits (that have also a relative order of processing, as documented before), and then the time bits we get for example the following computation:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>28</span><span class='comma'>,</span> <span class='int'>23</span><span class='comma'>,</span> <span class='int'>59</span><span class='comma'>,</span> <span class='int'>59</span>)
<span class='comment'># =&gt; Sun, 28 Feb 2010 23:59:59 +0000
</span><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_advance'>advance</span>(<span class='label'>months:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>seconds:</span> <span class='int'>1</span>)
<span class='comment'># =&gt; Mon, 29 Mar 2010 00:00:00 +0000</span></code></pre>

<p>but if we computed them the other way around, the result would be different:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_advance'>advance</span>(<span class='label'>seconds:</span> <span class='int'>1</span>).<span class='id identifier rubyid_advance'>advance</span>(<span class='label'>months:</span> <span class='int'>1</span>)
<span class='comment'># =&gt; Thu, 01 Apr 2010 00:00:00 +0000</span></code></pre>

<p>WARNING: Since <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a> is not DST-aware you can end up in a non-existing point in time with no warning or error telling you so.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h4>Changing Components</h4>

<p>The method <a href="https://api.rubyonrails.org/classes/DateTime.html#method-i-change"><code>change</code></a> allows you to get a new datetime which is the same as the receiver except for the given options, which may include <code>:year</code>, <code>:month</code>, <code>:day</code>, <code>:hour</code>, <code>:min</code>, <code>:sec</code>, <code>:offset</code>, <code>:start</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_current'><a href="DateTime.html#current-class_method" title="DateTime.current (method)">current</a></span>
<span class='comment'># =&gt; Tue, 08 Jun 2010 01:56:22 +0000
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_change'>change</span>(<span class='label'>year:</span> <span class='int'>2011</span><span class='comma'>,</span> <span class='label'>offset:</span> <span class='const'>Rational</span>(<span class='op'>-</span><span class='int'>6</span><span class='comma'>,</span> <span class='int'>24</span>))
<span class='comment'># =&gt; Wed, 08 Jun 2011 01:56:22 -0600</span></code></pre>

<p>If hours are zeroed, then minutes and seconds are too (unless they have given values):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_change'>change</span>(<span class='label'>hour:</span> <span class='int'>0</span>)
<span class='comment'># =&gt; Tue, 08 Jun 2010 00:00:00 +0000</span></code></pre>

<p>Similarly, if minutes are zeroed, then seconds are too (unless it has given a value):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_change'>change</span>(<span class='label'>min:</span> <span class='int'>0</span>)
<span class='comment'># =&gt; Tue, 08 Jun 2010 01:00:00 +0000</span></code></pre>

<p>This method is not tolerant to non-existing dates, if the change is invalid <code>ArgumentError</code> is raised:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_current'><a href="DateTime.html#current-class_method" title="DateTime.current (method)">current</a></span>.<span class='id identifier rubyid_change'>change</span>(<span class='label'>month:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>day:</span> <span class='int'>30</span>)
<span class='comment'># =&gt; ArgumentError: invalid date</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<h4>Durations</h4>

<p><a href="https://api.rubyonrails.org/classes/ActiveSupport/Duration.html"><code>Duration</code></a> objects can be added to and subtracted from datetimes:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_current'><a href="DateTime.html#current-class_method" title="DateTime.current (method)">current</a></span>
<span class='comment'># =&gt; Mon, 09 Aug 2010 23:15:17 +0000
</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>1</span>.<span class='id identifier rubyid_year'>year</span>
<span class='comment'># =&gt; Tue, 09 Aug 2011 23:15:17 +0000
</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='int'>1</span>.<span class='id identifier rubyid_week'>week</span>
<span class='comment'># =&gt; Mon, 02 Aug 2010 23:15:17 +0000</span></code></pre>

<p>They translate to calls to <code>since</code> or <code>advance</code>. For example here we get the correct jump in the calendar reform:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="DateTime.html" title="DateTime (class)">DateTime</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>1582</span><span class='comma'>,</span> <span class='int'>10</span><span class='comma'>,</span> <span class='int'>4</span><span class='comma'>,</span> <span class='int'>23</span>) <span class='op'>+</span> <span class='int'>1</span>.<span class='id identifier rubyid_hour'>hour</span>
<span class='comment'># =&gt; Fri, 15 Oct 1582 00:00:00 +0000</span></code></pre>

<h2>Extensions to <a href="Time.html" title="Time (class)"><code>Time</code></a></h2>

<h3>Calculations</h3>

<p>They are analogous. Please refer to their documentation above and take into account the following differences:</p>

<ul>
<li><a href="https://api.rubyonrails.org/classes/Time.html#method-i-change"><code>change</code></a> accepts an additional <code>:usec</code> option.</li>
<li><a href="Time.html" title="Time (class)"><code>Time</code></a> understands DST, so you get correct DST calculations as in</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_zone_default'><a href="Time.html#zone_default-class_method" title="Time.zone_default (method)">zone_default</a></span>
<span class='comment'># =&gt; #&lt;ActiveSupport::TimeZone:0x7f73654d4f38 @utc_offset=nil, @name=&quot;Madrid&quot;, ...&gt;
</span>
<span class='comment'># In Barcelona, 2010/03/28 02:00 +0100 becomes 2010/03/28 03:00 +0200 due to DST.
</span><span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_local'>local</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>28</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>59</span><span class='comma'>,</span> <span class='int'>59</span>)
<span class='comment'># =&gt; Sun Mar 28 01:59:59 +0100 2010
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_advance'>advance</span>(<span class='label'>seconds:</span> <span class='int'>1</span>)
<span class='comment'># =&gt; Sun Mar 28 03:00:00 +0200 2010</span></code></pre>

<ul>
<li>If <a href="https://api.rubyonrails.org/classes/Time.html#method-i-since"><code>since</code></a> or <a href="https://api.rubyonrails.org/classes/Time.html#method-i-ago"><code>ago</code></a> jumps to a time that can&#39;t be expressed with <a href="Time.html" title="Time (class)"><code>Time</code></a> a <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a> object is returned instead.</li>
</ul>

<h4><a href="Time.html#current-class_method" title="Time.current (method)">Time.current</a></h4>

<p>Active Support defines <a href="https://api.rubyonrails.org/classes/Time.html#method-c-current"><a href="Time.html#current-class_method" title="Time.current (method)">Time.current</a></a> to be today in the current time zone. That&#39;s like <code>Time.now</code>, except that it honors the user time zone, if defined. It also defines the instance predicates <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-past-3F"><code>past?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-today-3F"><code>today?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-tomorrow-3F"><code>tomorrow?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-next_day-3F"><code>next_day?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-yesterday-3F"><code>yesterday?</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-prev_day-3F"><code>prev_day?</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-future-3F"><code>future?</code></a>, all of them relative to <a href="Time.html#current-class_method" title="Time.current (method)">Time.current</a>.</p>

<p>When making Time comparisons using methods which honor the user time zone, make sure to use <a href="Time.html#current-class_method" title="Time.current (method)">Time.current</a> instead of <code>Time.now</code>. There are cases where the user time zone might be in the future compared to the system time zone, which <code>Time.now</code> uses by default. This means <code>Time.now.to_date</code> may equal <a href="Date.html#yesterday-class_method" title="Date.yesterday (method)">Date.yesterday</a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/time/calculations.rb</code>.</p>

<h4><code>all_day</code>, <code>all_week</code>, <code>all_month</code>, <code>all_quarter</code>, and <code>all_year</code></h4>

<p>The method <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-all_day"><code>all_day</code></a> returns a range representing the whole day of the current time.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_current'><a href="Time.html#current-class_method" title="Time.current (method)">current</a></span>
<span class='comment'># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_all_day'>all_day</span>
<span class='comment'># =&gt; Mon, 09 Aug 2010 00:00:00 UTC +00:00..Mon, 09 Aug 2010 23:59:59 UTC +00:00</span></code></pre>

<p>Analogously, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-all_week"><code>all_week</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-all_month"><code>all_month</code></a>, <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-all_quarter"><code>all_quarter</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-all_year"><code>all_year</code></a> all serve the purpose of generating time ranges.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_current'><a href="Time.html#current-class_method" title="Time.current (method)">current</a></span>
<span class='comment'># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_all_week'>all_week</span>
<span class='comment'># =&gt; Mon, 09 Aug 2010 00:00:00 UTC +00:00..Sun, 15 Aug 2010 23:59:59 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_all_week'>all_week</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_sunday'>sunday</span>)
<span class='comment'># =&gt; Sun, 16 Sep 2012 00:00:00 UTC +00:00..Sat, 22 Sep 2012 23:59:59 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_all_month'>all_month</span>
<span class='comment'># =&gt; Sat, 01 Aug 2010 00:00:00 UTC +00:00..Tue, 31 Aug 2010 23:59:59 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_all_quarter'>all_quarter</span>
<span class='comment'># =&gt; Thu, 01 Jul 2010 00:00:00 UTC +00:00..Thu, 30 Sep 2010 23:59:59 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span>.<span class='id identifier rubyid_all_year'>all_year</span>
<span class='comment'># =&gt; Fri, 01 Jan 2010 00:00:00 UTC +00:00..Fri, 31 Dec 2010 23:59:59 UTC +00:00</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h4><code>prev_day</code>, <code>next_day</code></h4>

<p><a href="https://api.rubyonrails.org/classes/Time.html#method-i-prev_day"><code>prev_day</code></a> and <a href="https://api.rubyonrails.org/classes/Time.html#method-i-next_day"><code>next_day</code></a> return the time in the last or next day:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>8</span>) <span class='comment'># =&gt; 2010-05-08 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_prev_day'>prev_day</span>               <span class='comment'># =&gt; 2010-05-07 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_next_day'>next_day</span>               <span class='comment'># =&gt; 2010-05-09 00:00:00 +0900</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/time/calculations.rb</code>.</p>

<h4><code>prev_month</code>, <code>next_month</code></h4>

<p><a href="https://api.rubyonrails.org/classes/Time.html#method-i-prev_month"><code>prev_month</code></a> and <a href="https://api.rubyonrails.org/classes/Time.html#method-i-next_month"><code>next_month</code></a> return the time with the same day in the last or next month:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>8</span>) <span class='comment'># =&gt; 2010-05-08 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_prev_month'>prev_month</span>             <span class='comment'># =&gt; 2010-04-08 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_next_month'>next_month</span>             <span class='comment'># =&gt; 2010-06-08 00:00:00 +0900</span></code></pre>

<p>If such a day does not exist, the last day of the corresponding month is returned:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_prev_month'><a href="Time.html#prev_month-instance_method" title="Time#prev_month (method)">prev_month</a></span> <span class='comment'># =&gt; 2000-04-30 00:00:00 +0900
</span><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_prev_month'><a href="Time.html#prev_month-instance_method" title="Time#prev_month (method)">prev_month</a></span> <span class='comment'># =&gt; 2000-02-29 00:00:00 +0900
</span><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_next_month'><a href="Time.html#next_month-instance_method" title="Time#next_month (method)">next_month</a></span> <span class='comment'># =&gt; 2000-06-30 00:00:00 +0900
</span><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_next_month'><a href="Time.html#next_month-instance_method" title="Time#next_month (method)">next_month</a></span> <span class='comment'># =&gt; 2000-02-29 00:00:00 +0900</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/time/calculations.rb</code>.</p>

<h4><code>prev_year</code>, <code>next_year</code></h4>

<p><a href="https://api.rubyonrails.org/classes/Time.html#method-i-prev_year"><code>prev_year</code></a> and <a href="https://api.rubyonrails.org/classes/Time.html#method-i-next_year"><code>next_year</code></a> return a time with the same day/month in the last or next year:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>8</span>) <span class='comment'># =&gt; 2010-05-08 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_prev_year'>prev_year</span>              <span class='comment'># =&gt; 2009-05-08 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_next_year'>next_year</span>              <span class='comment'># =&gt; 2011-05-08 00:00:00 +0900</span></code></pre>

<p>If date is the 29th of February of a leap year, you obtain the 28th:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>29</span>) <span class='comment'># =&gt; 2000-02-29 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_prev_year'>prev_year</span>               <span class='comment'># =&gt; 1999-02-28 00:00:00 +0900
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_next_year'>next_year</span>               <span class='comment'># =&gt; 2001-02-28 00:00:00 +0900</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/time/calculations.rb</code>.</p>

<h4><code>prev_quarter</code>, <code>next_quarter</code></h4>

<p><a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-prev_quarter"><code>prev_quarter</code></a> and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-next_quarter"><code>next_quarter</code></a> return the date with the same day in the previous or next quarter:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_local'>local</span>(<span class='int'>2010</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>8</span>) <span class='comment'># =&gt; 2010-05-08 00:00:00 +0300
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_prev_quarter'>prev_quarter</span>             <span class='comment'># =&gt; 2010-02-08 00:00:00 +0200
</span><span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_next_quarter'>next_quarter</span>             <span class='comment'># =&gt; 2010-08-08 00:00:00 +0300</span></code></pre>

<p>If such a day does not exist, the last day of the corresponding month is returned:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_local'>local</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>7</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_prev_quarter'>prev_quarter</span>  <span class='comment'># =&gt; 2000-04-30 00:00:00 +0300
</span><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_local'>local</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_prev_quarter'>prev_quarter</span>  <span class='comment'># =&gt; 2000-02-29 00:00:00 +0200
</span><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_local'>local</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>10</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_prev_quarter'>prev_quarter</span> <span class='comment'># =&gt; 2000-07-31 00:00:00 +0300
</span><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_local'>local</span>(<span class='int'>2000</span><span class='comma'>,</span> <span class='int'>11</span><span class='comma'>,</span> <span class='int'>31</span>).<span class='id identifier rubyid_next_quarter'>next_quarter</span> <span class='comment'># =&gt; 2001-03-01 00:00:00 +0200</span></code></pre>

<p><code>prev_quarter</code> is aliased to <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-last_quarter"><code>last_quarter</code></a>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/date_and_time/calculations.rb</code>.</p>

<h3>Time Constructors</h3>

<p>Active Support defines <a href="https://api.rubyonrails.org/classes/Time.html#method-c-current"><a href="Time.html#current-class_method" title="Time.current (method)">Time.current</a></a> to be <code>Time.zone.now</code> if there&#39;s a user time zone defined, with fallback to <code>Time.now</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_zone_default'><a href="Time.html#zone_default-class_method" title="Time.zone_default (method)">zone_default</a></span>
<span class='comment'># =&gt; #&lt;ActiveSupport::TimeZone:0x7f73654d4f38 @utc_offset=nil, @name=&quot;Madrid&quot;, ...&gt;
</span><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_current'><a href="Time.html#current-class_method" title="Time.current (method)">current</a></span>
<span class='comment'># =&gt; Fri, 06 Aug 2010 17:11:58 CEST +02:00</span></code></pre>

<p>Analogously to <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a>, the predicates <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-past-3F"><code>past?</code></a>, and <a href="https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-future-3F"><code>future?</code></a> are relative to <a href="Time.html#current-class_method" title="Time.current (method)">Time.current</a>.</p>

<p>If the time to be constructed lies beyond the range supported by <a href="Time.html" title="Time (class)"><code>Time</code></a> in the runtime platform, usecs are discarded and a <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a> object is returned instead.</p>

<h4>Durations</h4>

<p><a href="https://api.rubyonrails.org/classes/ActiveSupport/Duration.html"><code>Duration</code></a> objects can be added to and subtracted from time objects:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_current'><a href="Time.html#current-class_method" title="Time.current (method)">current</a></span>
<span class='comment'># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>1</span>.<span class='id identifier rubyid_year'>year</span>
<span class='comment'># =&gt; Tue, 09 Aug 2011 23:21:11 UTC +00:00
</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='int'>1</span>.<span class='id identifier rubyid_week'>week</span>
<span class='comment'># =&gt; Mon, 02 Aug 2010 23:21:11 UTC +00:00</span></code></pre>

<p>They translate to calls to <code>since</code> or <code>advance</code>. For example here we get the correct jump in the calendar reform:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Time.html" title="Time (class)">Time</a></span>.<span class='id identifier rubyid_utc'>utc</span>(<span class='int'>1582</span><span class='comma'>,</span> <span class='int'>10</span><span class='comma'>,</span> <span class='int'>3</span>) <span class='op'>+</span> <span class='int'>5</span>.<span class='id identifier rubyid_days'>days</span>
<span class='comment'># =&gt; Mon Oct 18 00:00:00 UTC 1582</span></code></pre>

<h2>Extensions to <a href="File.html" title="File (class)"><code>File</code></a></h2>

<h3><code>atomic_write</code></h3>

<p>With the class method <a href="https://api.rubyonrails.org/classes/File.html#method-c-atomic_write"><a href="File.html#atomic_write-class_method" title="File.atomic_write (method)">File.atomic_write</a></a> you can write to a file in a way that will prevent any reader from seeing half-written content.</p>

<p>The name of the file is passed as an argument, and the method yields a file handle opened for writing. Once the block is done <code>atomic_write</code> closes the file handle and completes its job.</p>

<p>For example, Action Pack uses this method to write asset cache files like <code>all.css</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="File.html" title="File (class)">File</a></span>.<span class='id identifier rubyid_atomic_write'><a href="File.html#atomic_write-class_method" title="File.atomic_write (method)">atomic_write</a></span>(<span class='id identifier rubyid_joined_asset_path'>joined_asset_path</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cache'>cache</span><span class='op'>|</span>
  <span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_write'>write</span>(<span class='id identifier rubyid_join_asset_file_contents'>join_asset_file_contents</span>(<span class='id identifier rubyid_asset_paths'>asset_paths</span>))
<span class='kw'>end</span></code></pre>

<p>To accomplish this <code>atomic_write</code> creates a temporary file. That&#39;s the file the code in the block actually writes to. On completion, the temporary file is renamed, which is an atomic operation on POSIX systems. If the target file exists <code>atomic_write</code> overwrites it and keeps owners and permissions. However there are a few cases where <code>atomic_write</code> cannot change the file ownership or permissions, this error is caught and skipped over trusting in the user/filesystem to ensure the file is accessible to the processes that need it.</p>

<p>NOTE. Due to the chmod operation <code>atomic_write</code> performs, if the target file has an ACL set on it this ACL will be recalculated/modified.</p>

<p>WARNING. Note you can&#39;t append with <code>atomic_write</code>.</p>

<p>The auxiliary file is written in a standard directory for temporary files, but you can pass a directory of your choice as second argument.</p>

<p>NOTE: Defined in <code>active_support/core_ext/file/atomic.rb</code>.</p>

<h2>Extensions to <a href="NameError.html" title="NameError (class)"><code>NameError</code></a></h2>

<p>Active Support adds <a href="https://api.rubyonrails.org/classes/NameError.html#method-i-missing_name-3F"><code>missing_name?</code></a> to <a href="NameError.html" title="NameError (class)"><code>NameError</code></a>, which tests whether the exception was raised because of the name passed as argument.</p>

<p>The name may be given as a symbol or string. A symbol is tested against the bare constant name, a string is against the fully qualified constant name.</p>

<p>TIP: A symbol can represent a fully qualified constant name as in <code>:&quot;ActiveRecord::Base&quot;</code>, so the behavior for symbols is defined for convenience, not because it has to be that way technically.</p>

<p>For example, when an action of <code>ArticlesController</code> is called Rails tries optimistically to use <code>ArticlesHelper</code>. It is OK that the helper module does not exist, so if an exception for that constant name is raised it should be silenced. But it could be the case that <code>articles_helper.rb</code> raises a <a href="NameError.html" title="NameError (class)"><code>NameError</code></a> due to an actual unknown constant. That should be reraised. The method <code>missing_name?</code> provides a way to distinguish both cases:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_default_helper_module!'>default_helper_module!</span>
  <span class='id identifier rubyid_module_name'>module_name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Controller</span><span class='tstring_end'>&quot;</span></span>)
  <span class='id identifier rubyid_module_path'>module_path</span> <span class='op'>=</span> <span class='id identifier rubyid_module_name'>module_name</span>.<span class='id identifier rubyid_underscore'>underscore</span>
  <span class='id identifier rubyid_helper'>helper</span> <span class='id identifier rubyid_module_path'>module_path</span>
<span class='kw'>rescue</span> <span class='const'><a href="LoadError.html" title="LoadError (class)">LoadError</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span> <span class='kw'>unless</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_is_missing?'>is_missing?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>helpers/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>_helper</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>rescue</span> <span class='const'><a href="NameError.html" title="NameError (class)">NameError</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span> <span class='kw'>unless</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_missing_name?'>missing_name?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_name'>module_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>Helper</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/name_error.rb</code>.</p>

<h2>Extensions to <a href="LoadError.html" title="LoadError (class)"><code>LoadError</code></a></h2>

<p>Active Support adds <a href="https://api.rubyonrails.org/classes/LoadError.html#method-i-is_missing-3F"><code>is_missing?</code></a> to <a href="LoadError.html" title="LoadError (class)"><code>LoadError</code></a>.</p>

<p>Given a path name <code>is_missing?</code> tests whether the exception was raised due to that particular file (except perhaps for the &quot;.rb&quot; extension).</p>

<p>For example, when an action of <code>ArticlesController</code> is called Rails tries to load <code>articles_helper.rb</code>, but that file may not exist. That&#39;s fine, the helper module is not mandatory so Rails silences a load error. But it could be the case that the helper module does exist and in turn requires another library that is missing. In that case Rails must reraise the exception. The method <code>is_missing?</code> provides a way to distinguish both cases:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_default_helper_module!'>default_helper_module!</span>
  <span class='id identifier rubyid_module_name'>module_name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Controller</span><span class='tstring_end'>&quot;</span></span>)
  <span class='id identifier rubyid_module_path'>module_path</span> <span class='op'>=</span> <span class='id identifier rubyid_module_name'>module_name</span>.<span class='id identifier rubyid_underscore'>underscore</span>
  <span class='id identifier rubyid_helper'>helper</span> <span class='id identifier rubyid_module_path'>module_path</span>
<span class='kw'>rescue</span> <span class='const'><a href="LoadError.html" title="LoadError (class)">LoadError</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span> <span class='kw'>unless</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_is_missing?'>is_missing?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>helpers/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>_helper</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>rescue</span> <span class='const'><a href="NameError.html" title="NameError (class)">NameError</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span> <span class='kw'>unless</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_missing_name?'>missing_name?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_name'>module_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>Helper</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/load_error.rb</code>.</p>

<h2>Extensions to Pathname</h2>

<h3><code>existence</code></h3>

<p>The <a href="https://api.rubyonrails.org/classes/Pathname.html#method-i-existence"><code>existence</code></a> method returns the receiver if the named file exists otherwise returns <code>nil</code>. It is useful for idioms like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_content'>content</span> <span class='op'>=</span> <span class='const'><a href="Pathname.html" title="Pathname (class)">Pathname</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>file</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_existence'><a href="Pathname.html#existence-instance_method" title="Pathname#existence (method)">existence</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_read'>read</span></code></pre>

<p>NOTE: Defined in <code>active_support/core_ext/pathname/existence.rb</code>.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>