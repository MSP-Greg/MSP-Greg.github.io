<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActiveRecord::Transaction &mdash; Rails main</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::Transaction",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Rails main</a> &raquo; 
      <a href='../_index.html#alpha_T'>Index (T)</a> &raquo; 
        <a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Transaction&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: ActiveRecord::Transaction</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a class='nodoc' href="Transaction/Callback.html" title="ActiveRecord::Transaction::Callback (class)"><code>Callback</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Subclasses:</div>
        <div class='box_22'>
          <a href="ConnectionAdapters/RealTransaction.html" title="ActiveRecord::ConnectionAdapters::RealTransaction (class)">ConnectionAdapters::RealTransaction</a>, <a href="ConnectionAdapters/RestartParentTransaction.html" title="ActiveRecord::ConnectionAdapters::RestartParentTransaction (class)">ConnectionAdapters::RestartParentTransaction</a>, <a href="ConnectionAdapters/SavepointTransaction.html" title="ActiveRecord::ConnectionAdapters::SavepointTransaction (class)">ConnectionAdapters::SavepointTransaction</a>, <a class='nodoc' href="ConnectionAdapters/Transaction.html" title="ActiveRecord::ConnectionAdapters::Transaction (class)">ConnectionAdapters::Transaction</a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/main/activerecord/lib/active_record/transaction.rb#L4'>activerecord/lib/active_record/transaction.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>  &#x21d2; Transaction </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#after_commit-instance_method" title="#after_commit (instance method)">#<strong>after_commit</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Registers a block to be called after the current transaction is fully committed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#after_rollback-instance_method" title="#after_rollback (instance method)">#<strong>after_rollback</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Registers a block to be called after the current transaction is rolled back.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#before_commit-instance_method" title="#before_commit (instance method)">#<strong>before_commit</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Registers a block to be called before the current transaction is fully committed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature prot'>
      <a href="#append_callbacks-instance_method" title="#append_callbacks (instance method)">#<strong>append_callbacks</strong>(callbacks)  </a>
    </span>
    <span class='note title protected'>protected</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature nodoc first'>
    .<strong>new</strong>  &#x21d2; <code>Transaction</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/activerecord/lib/active_record/transaction.rb#L24-L26'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='24' data-end='26'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transaction.rb', line 24</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='comment'># :nodoc:
</span>  <span class='ivar'>@callbacks</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="after_commit-instance_method">
  <h3 class='signature  first'>
    #<strong>after_commit</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Registers a block to be called after the current transaction is fully committed.</p>

<p>If there is no currently open transactions, the block is called immediately.</p>

<p>If the current transaction has a parent transaction, the callback is transferred to the parent when the current transaction commits, or dropped when the current transaction is rolled back. This operation is repeated until the outermost transaction is reached.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/activerecord/lib/active_record/transaction.rb#L46-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='46' data-end='48'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transaction.rb', line 46</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_commit'>after_commit</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  (<span class='ivar'>@callbacks</span> <span class='op'>||=</span> []) <span class='op'>&lt;&lt;</span> <span class='const'><a href="Transaction/Callback.html" title="ActiveRecord::Transaction::Callback (class)">Callback</a></span>.<span class='id identifier rubyid_new'><a href="Transaction/Callback.html#new-class_method" title="ActiveRecord::Transaction::Callback.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_after_commit'>after_commit</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="after_rollback-instance_method">
  <h3 class='signature '>
    #<strong>after_rollback</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Registers a block to be called after the current transaction is rolled back.</p>

<p>If there is no currently open transactions, the block is never called.</p>

<p>If the current transaction is successfully committed but has a parent transaction, the callback is automatically added to the parent transaction.</p>

<p>If the entire chain of nested transactions are all successfully committed, the block is never called.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/activerecord/lib/active_record/transaction.rb#L59-L61'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='59' data-end='61'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transaction.rb', line 59</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_rollback'>after_rollback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  (<span class='ivar'>@callbacks</span> <span class='op'>||=</span> []) <span class='op'>&lt;&lt;</span> <span class='const'><a href="Transaction/Callback.html" title="ActiveRecord::Transaction::Callback (class)">Callback</a></span>.<span class='id identifier rubyid_new'><a href="Transaction/Callback.html#new-class_method" title="ActiveRecord::Transaction::Callback.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_after_rollback'>after_rollback</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="append_callbacks-instance_method">
  <h3 class='signature prot'>
    #<strong>append_callbacks</strong>(callbacks)   <span class="extras">(<span class='prot'>protected</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/activerecord/lib/active_record/transaction.rb#L64-L66'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='64' data-end='66'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transaction.rb', line 64</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_append_callbacks'>append_callbacks</span>(<span class='id identifier rubyid_callbacks'>callbacks</span>)
  (<span class='ivar'>@callbacks</span> <span class='op'>||=</span> []).<span class='id identifier rubyid_concat'>concat</span>(<span class='id identifier rubyid_callbacks'>callbacks</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="before_commit-instance_method">
  <h3 class='signature '>
    #<strong>before_commit</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Registers a block to be called before the current transaction is fully committed.</p>

<p>If there is no currently open transactions, the block is called immediately.</p>

<p>If the current transaction has a parent transaction, the callback is transferred to the parent when the current transaction commits, or dropped when the current transaction is rolled back. This operation is repeated until the outermost transaction is reached.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/activerecord/lib/active_record/transaction.rb#L35-L37'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='35' data-end='37'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transaction.rb', line 35</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_before_commit'>before_commit</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  (<span class='ivar'>@callbacks</span> <span class='op'>||=</span> []) <span class='op'>&lt;&lt;</span> <span class='const'><a href="Transaction/Callback.html" title="ActiveRecord::Transaction::Callback (class)">Callback</a></span>.<span class='id identifier rubyid_new'><a href="Transaction/Callback.html#new-class_method" title="ActiveRecord::Transaction::Callback.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_before_commit'>before_commit</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>