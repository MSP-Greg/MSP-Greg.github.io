<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActionController::Redirecting &mdash; Rails main</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActionController::Redirecting",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Rails main</a> &raquo; 
      <a href='../_index.html#alpha_R'>Index (R)</a> &raquo; 
        <a href="../ActionController.html" title="ActionController (module)">ActionController</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Redirecting&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: ActionController::Redirecting</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a class='nodoc' href="Redirecting/ClassMethods.html" title="ActionController::Redirecting::ClassMethods (module)"><code>ClassMethods</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Exceptions:</div>
      <div class='box_11'>
          <a href="Redirecting/OpenRedirectError.html" title="ActionController::Redirecting::OpenRedirectError (class)"><code>OpenRedirectError</code></a>,
        <a href="Redirecting/PathRelativeRedirectError.html" title="ActionController::Redirecting::PathRelativeRedirectError (class)"><code>PathRelativeRedirectError</code></a>,
        <a href="Redirecting/UnsafeRedirectError.html" title="ActionController::Redirecting::UnsafeRedirectError (class)"><code>UnsafeRedirectError</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="API.html" title="ActionController::API (class)"><code>API</code></a>,
          <a href="Base.html" title="ActionController::Base (class)"><code>Base</code></a>,
          <a href="../ActionView/TestCase/TestController.html" title="ActionView::TestCase::TestController (class)"><code>::ActionView::TestCase::TestController</code></a>,
          <a class='nodoc' href="../Rails/ApplicationController.html" title="Rails::ApplicationController (class)"><code>::Rails::ApplicationController</code></a>,
          <a href="../Rails/HealthController.html" title="Rails::HealthController (class)"><code>::Rails::HealthController</code></a>,
          <a class='nodoc' href="../Rails/InfoController.html" title="Rails::InfoController (class)"><code>::Rails::InfoController</code></a>,
          <a class='nodoc' href="../Rails/MailersController.html" title="Rails::MailersController (class)"><code>::Rails::MailersController</code></a>,
          <a class='nodoc' href="../Rails/PwaController.html" title="Rails::PwaController (class)"><code>::Rails::PwaController</code></a>,
          <a class='nodoc' href="../Rails/WelcomeController.html" title="Rails::WelcomeController (class)"><code>::Rails::WelcomeController</code></a>
      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)"><code>::ActiveSupport::Concern</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="UrlFor.html" title="ActionController::UrlFor (module)"><code>UrlFor</code></a>,
          <a href="../AbstractController/UrlFor.html" title="AbstractController::UrlFor (module)"><code>::AbstractController::UrlFor</code></a>,
          <a href="../ActionDispatch/Routing/UrlFor.html" title="ActionDispatch::Routing::UrlFor (module)"><code>::ActionDispatch::Routing::UrlFor</code></a>,
          <a href="../ActionDispatch/Routing/PolymorphicRoutes.html" title="ActionDispatch::Routing::PolymorphicRoutes (module)"><code>::ActionDispatch::Routing::PolymorphicRoutes</code></a>,
          <a href="../ActiveSupport/Benchmarkable.html" title="ActiveSupport::Benchmarkable (module)"><code>::ActiveSupport::Benchmarkable</code></a>,
          <a class='nodoc' href="../AbstractController/Logger.html" title="AbstractController::Logger (module)"><code>::AbstractController::Logger</code></a>
        </div>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L6'>actionpack/lib/action_controller/metal/redirecting.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ILLEGAL_HEADER_VALUE_REGEX-constant' class='summary_signature'>ILLEGAL_HEADER_VALUE_REGEX =</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L26-L26'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 26</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\x00-\x08\x0A-\x1F]</span><span class='regexp_end'>/</span></span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum nodoc'><a href="../AbstractController/Logger.html" title="AbstractController::Logger (module)"><code>::AbstractController::Logger</code></a> - Attributes &amp; Methods</h2>
<div>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature mf nodoc'>
      <a href="#_compute_redirect_to_location-class_method" title="._compute_redirect_to_location (class method)">.<strong>_compute_redirect_to_location</strong>(request, options)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited'><a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)"><code>::ActiveSupport::Concern</code></a> - Extended</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">class_methods</a></td>
      <td><div class='inline'><p>Define class methods from given block.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">included</a></td>
      <td><div class='inline'><p>Evaluate given block in context of base class, so that you can write class macros here.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActiveSupport/Concern.html#prepended-instance_method" title="ActiveSupport::Concern#prepended (method)">prepended</a></td>
      <td><div class='inline'><p>Evaluate given block in context of base class, so that you can write class macros here.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">append_features</a>,
        <a class='i_m nodoc' href="../ActiveSupport/Concern.html#prepend_features-instance_method" title="ActiveSupport::Concern#prepend_features (method)">prepend_features</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="../AbstractController/UrlFor.html" title="AbstractController::UrlFor (module)"><code>::AbstractController::UrlFor</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m rw' href="../AbstractController/UrlFor.html#default_url_options-instance_method" title="AbstractController::UrlFor#default_url_options (method)">#default_url_options</a>,
        <a class='i_m rw' href="../AbstractController/UrlFor.html#default_url_options%3F-instance_method" title="AbstractController::UrlFor#default_url_options? (method)">#default_url_options?</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../ActionDispatch/Routing/UrlFor.html" title="ActionDispatch::Routing::UrlFor (module)"><code>::ActionDispatch::Routing::UrlFor</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro prot' href="../ActionDispatch/Routing/UrlFor.html#optimize_routes_generation%3F-instance_method" title="ActionDispatch::Routing::UrlFor#optimize_routes_generation? (method)">#optimize_routes_generation?</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#redirect_back-instance_method" title="#redirect_back (instance method)">#<strong>redirect_back</strong>(fallback_location:, allow_other_host: _allow_other_host, **args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Soft deprecated alias for <a href="#redirect_back_or_to-instance_method" title="ActionController::Redirecting#redirect_back_or_to (method)">#redirect_back_or_to</a> where the <code>fallback_location</code> location is supplied as a keyword argument instead of the first positional argument.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#redirect_back_or_to-instance_method" title="#redirect_back_or_to (instance method)">#<strong>redirect_back_or_to</strong>(fallback_location, allow_other_host: _allow_other_host, **options)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Redirects the browser to the page that issued the request (the referrer) if possible, otherwise redirects to the provided default fallback location.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#redirect_to-instance_method" title="#redirect_to (instance method)">#<strong>redirect_to</strong>(options = {}, response_options = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Redirects the browser to the target specified in <code>options</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#url_from-instance_method" title="#url_from (instance method)">#<strong>url_from</strong>(location)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Verifies the passed <code>location</code> is an internal URL that’s safe to redirect to and returns it, or nil if not.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#_allow_other_host-instance_method" title="#_allow_other_host (instance method)">#<strong>_allow_other_host</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#_enforce_open_redirect_protection-instance_method" title="#_enforce_open_redirect_protection (instance method)">#<strong>_enforce_open_redirect_protection</strong>(location, allow_other_host:)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#_ensure_url_is_http_header_safe-instance_method" title="#_ensure_url_is_http_header_safe (instance method)">#<strong>_ensure_url_is_http_header_safe</strong>(url)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#_extract_redirect_to_status-instance_method" title="#_extract_redirect_to_status (instance method)">#<strong>_extract_redirect_to_status</strong>(options, response_options)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#_handle_path_relative_redirect-instance_method" title="#_handle_path_relative_redirect (instance method)">#<strong>_handle_path_relative_redirect</strong>(url)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#_url_host_allowed%3F-instance_method" title="#_url_host_allowed? (instance method)">#<strong>_url_host_allowed?</strong>(url)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>

<h3 class='inherited'><a href="UrlFor.html" title="ActionController::UrlFor (module)"><code>UrlFor</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="UrlFor.html#initialize-instance_method" title="ActionController::UrlFor#initialize (method)">#initialize</a>,
        <a class='i_m ' href="UrlFor.html#url_options-instance_method" title="ActionController::UrlFor#url_options (method)">#url_options</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../AbstractController/UrlFor.html" title="AbstractController::UrlFor (module)"><code>::AbstractController::UrlFor</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../AbstractController/UrlFor.html#_routes-instance_method" title="AbstractController::UrlFor#_routes (method)">#_routes</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../ActionDispatch/Routing/UrlFor.html" title="ActionDispatch::Routing::UrlFor (module)"><code>::ActionDispatch::Routing::UrlFor</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../ActionDispatch/Routing/UrlFor.html#initialize-instance_method" title="ActionDispatch::Routing::UrlFor#initialize (method)">#initialize</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActionDispatch/Routing/UrlFor.html#route_for-instance_method" title="ActionDispatch::Routing::UrlFor#route_for (method)">#route_for</a></td>
      <td><div class='inline'><p>Allows calling direct or regular named route.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActionDispatch/Routing/UrlFor.html#url_for-instance_method" title="ActionDispatch::Routing::UrlFor#url_for (method)">#url_for</a></td>
      <td><div class='inline'><p>Generate a URL based on the options provided, <code>default_url_options</code>, and the routes defined in <code>config/routes.rb</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActionDispatch/Routing/UrlFor.html#url_options-instance_method" title="ActionDispatch::Routing::UrlFor#url_options (method)">#url_options</a></td>
      <td><div class='inline'><p>Hook overridden in controller to add request information with <code>default_url_options</code>.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="../ActionDispatch/Routing/UrlFor.html#_routes_context-instance_method" title="ActionDispatch::Routing::UrlFor#_routes_context (method)">#_routes_context</a>,
        <a class='i_m priv' href="../ActionDispatch/Routing/UrlFor.html#_with_routes-instance_method" title="ActionDispatch::Routing::UrlFor#_with_routes (method)">#_with_routes</a>,
        <a class='i_m nodoc' href="../ActionDispatch/Routing/UrlFor.html#full_url_for-instance_method" title="ActionDispatch::Routing::UrlFor#full_url_for (method)">#full_url_for</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../ActionDispatch/Routing/PolymorphicRoutes.html" title="ActionDispatch::Routing::PolymorphicRoutes (module)"><code>::ActionDispatch::Routing::PolymorphicRoutes</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActionDispatch/Routing/PolymorphicRoutes.html#polymorphic_path-instance_method" title="ActionDispatch::Routing::PolymorphicRoutes#polymorphic_path (method)">#polymorphic_path</a></td>
      <td><div class='inline'><p>Returns the path component of a URL for the given record.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActionDispatch/Routing/PolymorphicRoutes.html#polymorphic_url-instance_method" title="ActionDispatch::Routing::PolymorphicRoutes#polymorphic_url (method)">#polymorphic_url</a></td>
      <td><div class='inline'><p>Constructs a call to a named RESTful route for the given record and returns the resulting URL string.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="../ActionDispatch/Routing/PolymorphicRoutes.html#polymorphic_mapping-instance_method" title="ActionDispatch::Routing::PolymorphicRoutes#polymorphic_mapping (method)">#polymorphic_mapping</a>,
        <a class='i_m priv' href="../ActionDispatch/Routing/PolymorphicRoutes.html#polymorphic_path_for_action-instance_method" title="ActionDispatch::Routing::PolymorphicRoutes#polymorphic_path_for_action (method)">#polymorphic_path_for_action</a>,
        <a class='i_m priv' href="../ActionDispatch/Routing/PolymorphicRoutes.html#polymorphic_url_for_action-instance_method" title="ActionDispatch::Routing::PolymorphicRoutes#polymorphic_url_for_action (method)">#polymorphic_url_for_action</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../ActiveSupport/Benchmarkable.html" title="ActiveSupport::Benchmarkable (module)"><code>::ActiveSupport::Benchmarkable</code></a> - self</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../ActiveSupport/Benchmarkable.html#benchmark-instance_method" title="ActiveSupport::Benchmarkable#benchmark (method)">#benchmark</a></td>
      <td><div class='inline'><p>Allows you to measure the execution time of a block in a template and records the result to the log.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>DSL Calls</h2>
<section class='method_details first' id="included-dslcall">
<h3 class='signature'><strong>included</strong></h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L28-L34'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


28
29
30
31
32
33
34</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 28</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_included'>included</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_mattr_accessor'>mattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_raise_on_open_redirects'>raise_on_open_redirects</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_mattr_accessor'>mattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_action_on_open_redirect'>action_on_open_redirect</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_log'>log</span>
  <span class='id identifier rubyid_mattr_accessor'>mattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_action_on_path_relative_redirect'>action_on_path_relative_redirect</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_log'>log</span>
  <span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid__allowed_redirect_hosts'>_allowed_redirect_hosts</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_allowed_redirect_hosts_permissions'>allowed_redirect_hosts_permissions</span><span class='comma'>,</span> <span class='label'>instance_accessor:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>instance_predicate:</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_singleton_class'>singleton_class</span>.<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_allowed_redirect_hosts'>allowed_redirect_hosts</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid__allowed_redirect_hosts'>_allowed_redirect_hosts</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="_compute_redirect_to_location-class_method">
  <h3 class='signature private nodoc first'>
    .<strong>_compute_redirect_to_location</strong>(request, options)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L209-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='209' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 209</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__compute_redirect_to_location'>_compute_redirect_to_location</span>(<span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>) <span class='comment'># :nodoc:
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_options'>options</span>
  <span class='comment'># The scheme name consist of a letter followed by any combination of letters,
</span>  <span class='comment'># digits, and the plus (&quot;+&quot;), period (&quot;.&quot;), or hyphen (&quot;-&quot;) characters; and is
</span>  <span class='comment'># terminated by a colon (&quot;:&quot;). See
</span>  <span class='comment'># https://tools.ietf.org/html/rfc3986#section-3.1 The protocol relative scheme
</span>  <span class='comment'># starts with a double slash &quot;//&quot;.
</span>  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A([a-z][a-z\d\-+.]*:|\/\/).*</span><span class='regexp_end'>/i</span></span>
    <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_to_str'>to_str</span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid__handle_path_relative_redirect'><a href="#_handle_path_relative_redirect-instance_method" title="ActionController::Redirecting#_handle_path_relative_redirect (method)">_handle_path_relative_redirect</a></span>(<span class='id identifier rubyid_options'>options</span>)
    <span class='kw'>end</span>

    <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_protocol'>protocol</span> <span class='op'>+</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_host_with_port'>host_with_port</span> <span class='op'>+</span> <span class='id identifier rubyid_options'>options</span>
  <span class='kw'>when</span> <span class='const'>Proc</span>
    <span class='id identifier rubyid__compute_redirect_to_location'>_compute_redirect_to_location</span> <span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_instance_eval'>instance_eval</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_options'>options</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_url_for'>url_for</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='kw'>end</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\0\r\n</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="logger-instance_method">
  <h3 class='signature rw first'>
    #<strong>logger</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/abstract_controller/logger.rb#L13-L13'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='13' data-end='13'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/abstract_controller/logger.rb', line 13</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger='><a href="#logger=-instance_method" title="ActionController::Redirecting#logger= (method)">logger=</a></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config'>config</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="_allow_other_host-instance_method">
  <h3 class='signature priv first'>
    #<strong>_allow_other_host</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L263-L267'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='263' data-end='267'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 263</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__allow_other_host'>_allow_other_host</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_raise_on_open_redirects'>raise_on_open_redirects</span>

  <span class='id identifier rubyid_action_on_open_redirect'>action_on_open_redirect</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_enforce_open_redirect_protection-instance_method">
  <h3 class='signature priv'>
    #<strong>_enforce_open_redirect_protection</strong>(location, allow_other_host:)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L279-L305'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='279' data-end='305'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 279</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__enforce_open_redirect_protection'>_enforce_open_redirect_protection</span>(<span class='id identifier rubyid_location'>location</span><span class='comma'>,</span> <span class='label'>allow_other_host:</span>)
  <span class='comment'># Explictly allowed other host or host is in allow list allow redirect
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_allow_other_host'>allow_other_host</span> <span class='op'>||</span> <span class='id identifier rubyid__url_host_allowed?'><a href="#_url_host_allowed%3F-instance_method" title="ActionController::Redirecting#_url_host_allowed? (method)">_url_host_allowed?</a></span>(<span class='id identifier rubyid_location'>location</span>)
    <span class='id identifier rubyid_location'>location</span>
  <span class='comment'># Explicitly disallowed other host
</span>  <span class='kw'>elsif</span> <span class='id identifier rubyid_allow_other_host'>allow_other_host</span> <span class='op'>==</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Redirecting/OpenRedirectError.html" title="ActionController::Redirecting::OpenRedirectError (class)">OpenRedirectError</a></span>.<span class='id identifier rubyid_new'><a href="Redirecting/OpenRedirectError.html#new-class_method" title="ActionController::Redirecting::OpenRedirectError.new (method)">new</a></span>(<span class='id identifier rubyid_location'>location</span>)
  <span class='comment'># Configuration disallows other hosts
</span>  <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid__allow_other_host'><a href="#_allow_other_host-instance_method" title="ActionController::Redirecting#_allow_other_host (method)">_allow_other_host</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Redirecting/OpenRedirectError.html" title="ActionController::Redirecting::OpenRedirectError (class)">OpenRedirectError</a></span>.<span class='id identifier rubyid_new'><a href="Redirecting/OpenRedirectError.html#new-class_method" title="ActionController::Redirecting::OpenRedirectError.new (method)">new</a></span>(<span class='id identifier rubyid_location'>location</span>)
  <span class='comment'># Log but allow redirect
</span>  <span class='kw'>elsif</span> <span class='id identifier rubyid_action_on_open_redirect'>action_on_open_redirect</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_log'>log</span>
    <span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="ActionController::Redirecting#logger (method)">logger</a></span>.<span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Open redirect to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> detected</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="ActionController::Redirecting#logger (method)">logger</a></span>
    <span class='id identifier rubyid_location'>location</span>
  <span class='comment'># Notify but allow redirect
</span>  <span class='kw'>elsif</span> <span class='id identifier rubyid_action_on_open_redirect'>action_on_open_redirect</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_notify'>notify</span>
    <span class='const'><a href="../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../ActiveSupport/Notifications.html" title="ActiveSupport::Notifications (module)">Notifications</a></span>.<span class='id identifier rubyid_instrument'><a href="../ActiveSupport/Notifications.html#instrument-class_method" title="ActiveSupport::Notifications.instrument (method)">instrument</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>open_redirect.action_controller</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='label'>location:</span> <span class='id identifier rubyid_location'>location</span><span class='comma'>,</span>
      <span class='label'>request:</span> <span class='id identifier rubyid_request'>request</span><span class='comma'>,</span>
      <span class='label'>stack_trace:</span> <span class='id identifier rubyid_caller'>caller</span><span class='comma'>,</span>
    )
    <span class='id identifier rubyid_location'>location</span>
  <span class='comment'># Fall through, should not happen but raise for safety
</span>  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Redirecting/OpenRedirectError.html" title="ActionController::Redirecting::OpenRedirectError (class)">OpenRedirectError</a></span>.<span class='id identifier rubyid_new'><a href="Redirecting/OpenRedirectError.html#new-class_method" title="ActionController::Redirecting::OpenRedirectError.new (method)">new</a></span>(<span class='id identifier rubyid_location'>location</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_ensure_url_is_http_header_safe-instance_method">
  <h3 class='signature priv'>
    #<strong>_ensure_url_is_http_header_safe</strong>(url)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L320-L328'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='320' data-end='328'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 320</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__ensure_url_is_http_header_safe'>_ensure_url_is_http_header_safe</span>(<span class='id identifier rubyid_url'>url</span>)
  <span class='comment'># Attempt to comply with the set of valid token characters defined for an HTTP
</span>  <span class='comment'># header value in https://datatracker.ietf.org/doc/html/rfc7230#section-3.2.6
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='const'><a href="#ILLEGAL_HEADER_VALUE_REGEX-constant" title="ActionController::Redirecting::ILLEGAL_HEADER_VALUE_REGEX (constant)">ILLEGAL_HEADER_VALUE_REGEX</a></span>)
    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The redirect URL </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'> contains one or more illegal HTTP header field character. </span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Set of legal characters defined in https://datatracker.ietf.org/doc/html/rfc7230#section-3.2.6</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Redirecting/UnsafeRedirectError.html" title="ActionController::Redirecting::UnsafeRedirectError (class)">UnsafeRedirectError</a></span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_extract_redirect_to_status-instance_method">
  <h3 class='signature priv'>
    #<strong>_extract_redirect_to_status</strong>(options, response_options)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L269-L277'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='269' data-end='277'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 269</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__extract_redirect_to_status'>_extract_redirect_to_status</span>(<span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_response_options'>response_options</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_status'>status</span>)
    <span class='const'><a href="../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a></span><span class='op'>::</span><span class='const'><a href="../ActionDispatch/Response.html" title="ActionDispatch::Response (class)">Response</a></span>.<span class='id identifier rubyid_rack_status_code'><a href="../ActionDispatch/Response.html#rack_status_code-class_method" title="ActionDispatch::Response.rack_status_code (method)">rack_status_code</a></span>(<span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_status'>status</span>))
  <span class='kw'>elsif</span> <span class='id identifier rubyid_response_options'>response_options</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_status'>status</span>)
    <span class='const'><a href="../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a></span><span class='op'>::</span><span class='const'><a href="../ActionDispatch/Response.html" title="ActionDispatch::Response (class)">Response</a></span>.<span class='id identifier rubyid_rack_status_code'><a href="../ActionDispatch/Response.html#rack_status_code-class_method" title="ActionDispatch::Response.rack_status_code (method)">rack_status_code</a></span>(<span class='id identifier rubyid_response_options'>response_options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_status'>status</span>])
  <span class='kw'>else</span>
    <span class='int'>302</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_handle_path_relative_redirect-instance_method">
  <h3 class='signature priv'>
    #<strong>_handle_path_relative_redirect</strong>(url)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L330-L345'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='330' data-end='345'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 330</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__handle_path_relative_redirect'>_handle_path_relative_redirect</span>(<span class='id identifier rubyid_url'>url</span>)
  <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Path relative URL redirect detected: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>case</span> <span class='id identifier rubyid_action_on_path_relative_redirect'>action_on_path_relative_redirect</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_log'>log</span>
    <span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="ActionController::Redirecting#logger (method)">logger</a></span><span class='op'>&amp;.</span><span class='id identifier rubyid_warn'>warn</span> <span class='id identifier rubyid_message'>message</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_notify'>notify</span>
    <span class='const'><a href="../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../ActiveSupport/Notifications.html" title="ActiveSupport::Notifications (module)">Notifications</a></span>.<span class='id identifier rubyid_instrument'><a href="../ActiveSupport/Notifications.html#instrument-class_method" title="ActiveSupport::Notifications.instrument (method)">instrument</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unsafe_redirect.action_controller</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='label'>url:</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span>
      <span class='label'>message:</span> <span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
      <span class='label'>stack_trace:</span> <span class='id identifier rubyid_caller'>caller</span>
    )
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_raise'>raise</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="Redirecting/PathRelativeRedirectError.html" title="ActionController::Redirecting::PathRelativeRedirectError (class)">PathRelativeRedirectError</a></span>.<span class='id identifier rubyid_new'><a href="Redirecting/PathRelativeRedirectError.html#new-class_method" title="ActionController::Redirecting::PathRelativeRedirectError.new (method)">new</a></span>(<span class='id identifier rubyid_url'>url</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_url_host_allowed?-instance_method">
  <h3 class='signature priv'>
    #<strong>_url_host_allowed?</strong>(url)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L307-L318'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='307' data-end='318'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 307</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__url_host_allowed?'>_url_host_allowed?</span>(<span class='id identifier rubyid_url'>url</span>)
  <span class='id identifier rubyid_url_to_s'>url_to_s</span> <span class='op'>=</span> <span class='id identifier rubyid_url'>url</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='const'>URI</span>(<span class='id identifier rubyid_url_to_s'>url_to_s</span>).<span class='id identifier rubyid_host'>host</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_host'>host</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_url_to_s'>url_to_s</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_url_to_s'>url_to_s</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_host'>host</span> <span class='op'>==</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_host'>host</span> <span class='op'>||</span> <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_allowed_redirect_hosts_permissions'>allowed_redirect_hosts_permissions</span><span class='op'>&amp;.</span><span class='id identifier rubyid_allows?'>allows?</span>(<span class='id identifier rubyid_host'>host</span>)
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='const'>URI</span><span class='op'>::</span><span class='const'>Error</span>
  <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="redirect_back-instance_method">
  <h3 class='signature '>
    #<strong>redirect_back</strong>(fallback_location:, allow_other_host: _allow_other_host, **args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Soft deprecated alias for <a href="#redirect_back_or_to-instance_method" title="ActionController::Redirecting#redirect_back_or_to (method)">#redirect_back_or_to</a> where the <code>fallback_location</code> location is supplied as a keyword argument instead of the first positional argument.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L172-L174'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='172' data-end='174'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 172</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_redirect_back'>redirect_back</span>(<span class='label'>fallback_location:</span><span class='comma'>,</span> <span class='label'>allow_other_host:</span> <span class='id identifier rubyid__allow_other_host'><a href="#_allow_other_host-instance_method" title="ActionController::Redirecting#_allow_other_host (method)">_allow_other_host</a></span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_redirect_back_or_to'><a href="#redirect_back_or_to-instance_method" title="ActionController::Redirecting#redirect_back_or_to (method)">redirect_back_or_to</a></span> <span class='id identifier rubyid_fallback_location'>fallback_location</span><span class='comma'>,</span> <span class='label'>allow_other_host:</span> <span class='id identifier rubyid_allow_other_host'>allow_other_host</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_args'>args</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="redirect_back_or_to-instance_method">
  <h3 class='signature '>
    #<strong>redirect_back_or_to</strong>(fallback_location, allow_other_host: _allow_other_host, **options)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Redirects the browser to the page that issued the request (the referrer) if possible, otherwise redirects to the provided default fallback location.</p>

<p>The referrer information is pulled from the HTTP <code>Referer</code> (sic) header on the request. This is an optional header and its presence on the request is subject to browser security settings and user preferences. If the request is missing this header, the <code>fallback_location</code> will be used.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span>({ <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>show</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='int'>5</span> })
<span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span> <span class='ivar'>@post</span>
<span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.rubyonrails.org</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/images/screenshot.jpg</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span> <span class='id identifier rubyid_posts_url'>posts_url</span>
<span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span> <span class='id identifier rubyid_proc'>proc</span> { <span class='id identifier rubyid_edit_post_url'>edit_post_url</span>(<span class='ivar'>@post</span>) }
<span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>allow_other_host:</span> <span class='kw'>false</span></code></pre>

<p>#### Options</p>
<ul><li>
<p><code>:allow_other_host</code> - Allow or disallow redirection to the host that is different to the current host, defaults to true.</p>
</li></ul>

<p>All other options that can be passed to <a href="#redirect_to-instance_method" title="ActionController::Redirecting#redirect_to (method)">#redirect_to</a> are accepted as options, and the behavior is identical.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L199-L207'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='199' data-end='207'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 199</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_redirect_back_or_to'>redirect_back_or_to</span>(<span class='id identifier rubyid_fallback_location'>fallback_location</span><span class='comma'>,</span> <span class='label'>allow_other_host:</span> <span class='id identifier rubyid__allow_other_host'><a href="#_allow_other_host-instance_method" title="ActionController::Redirecting#_allow_other_host (method)">_allow_other_host</a></span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_referer'>referer</span> <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_allow_other_host'>allow_other_host</span> <span class='op'>||</span> <span class='id identifier rubyid__url_host_allowed?'><a href="#_url_host_allowed%3F-instance_method" title="ActionController::Redirecting#_url_host_allowed? (method)">_url_host_allowed?</a></span>(<span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_referer'>referer</span>))
    <span class='id identifier rubyid_redirect_to'><a href="#redirect_to-instance_method" title="ActionController::Redirecting#redirect_to (method)">redirect_to</a></span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_referer'>referer</span><span class='comma'>,</span> <span class='label'>allow_other_host:</span> <span class='id identifier rubyid_allow_other_host'>allow_other_host</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>
  <span class='kw'>else</span>
    <span class='comment'># The method level `allow_other_host` doesn&#39;t apply in the fallback case, omit
</span>    <span class='comment'># and let the `redirect_to` handling take over.
</span>    <span class='id identifier rubyid_redirect_to'><a href="#redirect_to-instance_method" title="ActionController::Redirecting#redirect_to (method)">redirect_to</a></span> <span class='id identifier rubyid_fallback_location'>fallback_location</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="redirect_to-instance_method">
  <h3 class='signature '>
    #<strong>redirect_to</strong>(options = {}, response_options = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Redirects the browser to the target specified in <code>options</code>. This parameter can be any one of:</p>
<ul><li>
<p><a href="../Hash.html" title="Hash (class)"><code>::Hash</code></a> - The URL will be generated by calling url_for with the <code>options</code>.</p>
</li><li>
<p><code>Record</code> - The URL will be generated by calling url_for with the <code>options</code>, which will reference a named URL for that record.</p>
</li><li>
<p><a href="../String.html" title="String (class)"><code>::String</code></a> starting with <a href="protocol://" target="_parent" title="protocol://">protocol://</a> (like <a href="http://" target="_parent" title="http://">http://</a>) or a protocol relative reference (like <code>//</code>) - Is passed straight through as the target for redirection.</p>
</li><li>
<p><a href="../String.html" title="String (class)"><code>::String</code></a> not containing a protocol - The current protocol and host is prepended to the string.</p>
</li><li>
<p><code>Proc</code> - A block that will be executed in the controller’s context. Should return any option accepted by <code>redirect_to</code>.</p>
</li></ul>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>show</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='int'>5</span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='ivar'>@post</span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.rubyonrails.org</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/images/screenshot.jpg</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_posts_url'>posts_url</span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_proc'>proc</span> { <span class='id identifier rubyid_edit_post_url'>edit_post_url</span>(<span class='ivar'>@post</span>) }</code></pre>

<p>The redirection happens as a <code>302 Found</code> header unless otherwise specified using the <code>:status</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_post_url'>post_url</span>(<span class='ivar'>@post</span>)<span class='comma'>,</span> <span class='label'>status:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_found'>found</span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>atom</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>status:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_moved_permanently'>moved_permanently</span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_post_url'>post_url</span>(<span class='ivar'>@post</span>)<span class='comma'>,</span> <span class='label'>status:</span> <span class='int'>301</span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>atom</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>status:</span> <span class='int'>302</span></code></pre>

<p>The status code can either be a standard [HTTP Status code](<a href="https://www.iana.org/assignments/http-status-codes">www.iana.org/assignments/http-status-codes</a>) as an integer, or a symbol representing the downcased, underscored and symbolized description. Note that the status code must be a 3xx HTTP code, or redirection will not occur.</p>

<p>If you are using XHR requests other than GET or POST and redirecting after the request then some browsers will follow the redirect using the original request method. This may lead to undesirable behavior such as a double DELETE. To work around this you can return a <code>303 See Other</code> status code which will be followed using a GET request.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_posts_url'>posts_url</span><span class='comma'>,</span> <span class='label'>status:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_see_other'>see_other</span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>status:</span> <span class='int'>303</span></code></pre>

<p>It is also possible to assign a flash message as part of the redirection. There are two special accessors for the commonly used flash names <code>alert</code> and <code>notice</code> as well as a general purpose <code>flash</code> bucket.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_post_url'>post_url</span>(<span class='ivar'>@post</span>)<span class='comma'>,</span> <span class='label'>alert:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Watch it, mister!</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_post_url'>post_url</span>(<span class='ivar'>@post</span>)<span class='comma'>,</span> <span class='label'>status:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_found'>found</span><span class='comma'>,</span> <span class='label'>notice:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pay attention to the road</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_post_url'>post_url</span>(<span class='ivar'>@post</span>)<span class='comma'>,</span> <span class='label'>status:</span> <span class='int'>301</span><span class='comma'>,</span> <span class='label'>flash:</span> { <span class='label'>updated_post_id:</span> <span class='ivar'>@post</span>.<span class='id identifier rubyid_id'>id</span> }
<span class='id identifier rubyid_redirect_to'>redirect_to</span>({ <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>atom</span><span class='tstring_end'>&#39;</span></span> }<span class='comma'>,</span> <span class='label'>alert:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Something serious happened</span><span class='tstring_end'>&quot;</span></span>)</code></pre>

<p>Statements after <code>redirect_to</code> in our controller get executed, so <code>redirect_to</code> doesn’t stop the execution of the function. To terminate the execution of the function immediately after the <code>redirect_to</code>, use return.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_post_url'>post_url</span>(<span class='ivar'>@post</span>) <span class='kw'>and</span> <span class='kw'>return</span></code></pre>

<h4 id="label-Open+Redirect+protection">Open Redirect protection</h4>

<p>By default, <a href="../Rails.html" title="Rails (module)"><code>::Rails</code></a> protects against redirecting to external hosts for your app’s safety, so called open redirects. Note: this was a new default in <a href="../Rails.html" title="Rails (module)"><code>::Rails</code></a> 7.0, after upgrading opt-in by uncommenting the line with <code>raise_on_open_redirects</code> in <code>config/initializers/new_framework_defaults_7_0.rb</code></p>

<p>Here <code>#redirect_to</code> automatically validates the potentially-unsafe URL:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_params'>params</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_redirect_url'>redirect_url</span>]</code></pre>

<p>The <code>action_on_open_redirect</code> configuration option controls the behavior when an unsafe redirect is detected:</p>
<ul><li>
<p><code>:log</code> - Logs a warning but allows the redirect</p>
</li><li>
<p><code>:notify</code> - Sends an <a href="../ActiveSupport.html" title="ActiveSupport (module)"><code>::ActiveSupport</code></a> notification for monitoring</p>
</li><li>
<p><code>:raise</code> - Raises an <a href="Redirecting/UnsafeRedirectError.html" title="ActionController::Redirecting::UnsafeRedirectError (class)"><code>Redirecting::UnsafeRedirectError</code></a></p>
</li></ul>

<p>To allow any external redirects pass <code>allow_other_host: true</code>, though using a user-provided param in that case is unsafe.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://rubyonrails.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>allow_other_host:</span> <span class='kw'>true</span></code></pre>

<p>See <a href="#url_from-instance_method" title="ActionController::Redirecting#url_from (method)">#url_from</a> for more information on what an internal and safe URL is, or how to fall back to an alternate redirect URL in the unsafe case.</p>

<h4 id="label-Path+Relative+URL+Redirect+Protection">Path Relative URL Redirect Protection</h4>

<p><a href="../Rails.html" title="Rails (module)"><code>::Rails</code></a> also protects against potentially unsafe path relative URL redirects that don’t start with a leading slash. These can create security vulnerabilities:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>example.com</span><span class='tstring_end'>&quot;</span></span>     <span class='comment'># Creates http://yourdomain.comexample.com
</span><span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@attacker.com</span><span class='tstring_end'>&quot;</span></span>   <span class='comment'># Creates http://yourdomain.com@attacker.com
</span>                              <span class='comment'># which browsers interpret as user@host</span></code></pre>

<p>You can configure how <a href="../Rails.html" title="Rails (module)"><code>::Rails</code></a> handles these cases using:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_action_controller'>action_controller</span>.<span class='id identifier rubyid_action_on_path_relative_redirect'>action_on_path_relative_redirect</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_log'>log</span>    <span class='comment'># default
</span><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_action_controller'>action_controller</span>.<span class='id identifier rubyid_action_on_path_relative_redirect'>action_on_path_relative_redirect</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_notify'>notify</span>
<span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_action_controller'>action_controller</span>.<span class='id identifier rubyid_action_on_path_relative_redirect'>action_on_path_relative_redirect</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_raise'>raise</span></code></pre>
<ul><li>
<p><code>:log</code> - Logs a warning but allows the redirect</p>
</li><li>
<p><code>:notify</code> - Sends an <a href="../ActiveSupport.html" title="ActiveSupport (module)"><code>::ActiveSupport</code></a> notification but allows the redirect (includes stack trace to help identify the source)</p>
</li><li>
<p><code>:raise</code> - Raises an <a href="Redirecting/UnsafeRedirectError.html" title="ActionController::Redirecting::UnsafeRedirectError (class)"><code>Redirecting::UnsafeRedirectError</code></a></p>
</li></ul>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="ActionControllerError.html" title="ActionController::ActionControllerError (class)">ActionControllerError</a>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L153-L167'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='153' data-end='167'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 153</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_redirect_to'>redirect_to</span>(<span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_response_options'>response_options</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="ActionControllerError.html" title="ActionController::ActionControllerError (class)">ActionControllerError</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot redirect to nil!</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../AbstractController.html" title="AbstractController (module)">AbstractController</a></span><span class='op'>::</span><span class='const'><a href="../AbstractController/DoubleRenderError.html" title="AbstractController::DoubleRenderError (class)">DoubleRenderError</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_response_body'>response_body</span>

  <span class='id identifier rubyid_allow_other_host'>allow_other_host</span> <span class='op'>=</span> <span class='id identifier rubyid_response_options'>response_options</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_allow_other_host'>allow_other_host</span>)

  <span class='id identifier rubyid_proposed_status'>proposed_status</span> <span class='op'>=</span> <span class='id identifier rubyid__extract_redirect_to_status'><a href="#_extract_redirect_to_status-instance_method" title="ActionController::Redirecting#_extract_redirect_to_status (method)">_extract_redirect_to_status</a></span>(<span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_response_options'>response_options</span>)

  <span class='id identifier rubyid_redirect_to_location'>redirect_to_location</span> <span class='op'>=</span> <span class='id identifier rubyid__compute_redirect_to_location'><a href="#_compute_redirect_to_location-class_method" title="ActionController::Redirecting._compute_redirect_to_location (method)">_compute_redirect_to_location</a></span>(<span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid__ensure_url_is_http_header_safe'><a href="#_ensure_url_is_http_header_safe-instance_method" title="ActionController::Redirecting#_ensure_url_is_http_header_safe (method)">_ensure_url_is_http_header_safe</a></span>(<span class='id identifier rubyid_redirect_to_location'>redirect_to_location</span>)

  <span class='kw'>self</span>.<span class='id identifier rubyid_location'>location</span>      <span class='op'>=</span> <span class='id identifier rubyid__enforce_open_redirect_protection'><a href="#_enforce_open_redirect_protection-instance_method" title="ActionController::Redirecting#_enforce_open_redirect_protection (method)">_enforce_open_redirect_protection</a></span>(<span class='id identifier rubyid_redirect_to_location'>redirect_to_location</span><span class='comma'>,</span> <span class='label'>allow_other_host:</span> <span class='id identifier rubyid_allow_other_host'>allow_other_host</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid_response_body'>response_body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_status'>status</span>        <span class='op'>=</span> <span class='id identifier rubyid_proposed_status'>proposed_status</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="url_from-instance_method">
  <h3 class='signature '>
    #<strong>url_from</strong>(location)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Verifies the passed <code>location</code> is an internal URL that’s safe to redirect to and returns it, or nil if not. Useful to wrap a params provided redirect URL and fall back to an alternate URL to redirect to:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redirect_to'><a href="#redirect_to-instance_method" title="ActionController::Redirecting#redirect_to (method)">redirect_to</a></span> <span class='id identifier rubyid_url_from'>url_from</span>(<span class='id identifier rubyid_params'>params</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_redirect_url'>redirect_url</span>]) <span class='op'>||</span> <span class='id identifier rubyid_root_url'>root_url</span></code></pre>

<p>The <code>location</code> is considered internal, and safe, if it’s on the same host as <code>request.host</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># If request.host is example.com:
</span><span class='id identifier rubyid_url_from'>url_from</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://example.com/profile</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; &quot;https://example.com/profile&quot;
</span><span class='id identifier rubyid_url_from'>url_from</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://example.com/profile</span><span class='tstring_end'>&quot;</span></span>)  <span class='comment'># =&gt; &quot;http://example.com/profile&quot;
</span><span class='id identifier rubyid_url_from'>url_from</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://evil.com/profile</span><span class='tstring_end'>&quot;</span></span>)     <span class='comment'># =&gt; nil</span></code></pre>

<p>Subdomains are considered part of the host:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># If request.host is on https://example.com or https://app.example.com, you&#39;d get:
</span><span class='id identifier rubyid_url_from'>url_from</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://dev.example.com/profile</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; nil</span></code></pre>

<p>NOTE: there’s a similarity with [url_for](ActionDispatch::Routing::UrlFor#url_for), which generates an internal URL from various options from within the app, e.g. <code>url_for(@post)</code>. However, <code>#url_from</code> is meant to take an external parameter to verify as in <code>url_from(params[:redirect_url])</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/redirecting.rb#L257-L260'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='257' data-end='260'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_controller/metal/redirecting.rb', line 257</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_url_from'>url_from</span>(<span class='id identifier rubyid_location'>location</span>)
  <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_location'>location</span>.<span class='id identifier rubyid_presence'>presence</span>
  <span class='id identifier rubyid_location'>location</span> <span class='kw'>if</span> <span class='id identifier rubyid_location'>location</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid__url_host_allowed?'><a href="#_url_host_allowed%3F-instance_method" title="ActionController::Redirecting#_url_host_allowed? (method)">_url_host_allowed?</a></span>(<span class='id identifier rubyid_location'>location</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>