<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActionCable::Server::Base &mdash; Rails 6.1.7.10</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActionCable::Server::Base",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Rails 6.1.7.10</a> &raquo; 
      <a href='../../_index.html#alpha_B'>Index (B)</a> &raquo; 
        <a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a> &raquo; 
        <a href="../Server.html" title="ActionCable::Server (module)">Server</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Base&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: ActionCable::Server::Base</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Broadcasting.html" title="ActionCable::Server::Broadcasting (module)"><code>Broadcasting</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L11'>actioncable/lib/action_cable/server/base.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>A singleton <a href="../Server.html" title="ActionCable::Server (module)"><code>::ActionCable::Server</code></a> instance is available via <code>ActionCable.server</code>. It’s used by the <a href="../../Rack.html" title="Rack (module)"><code>::Rack</code></a> process that starts the Action Cable server, but is also used by the user to reach the <a href="../RemoteConnections.html" title="ActionCable::RemoteConnections (class)"><code>::ActionCable::RemoteConnections</code></a> object, which is used for finding and disconnecting connections across all servers.</p>

<p>Also, this is the server instance used for broadcasting. See Broadcasting for more information.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#config-class_method" title=".config (class method)">.<strong>config</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
</ul>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#logger-class_method" title=".logger (class method)">.<strong>logger</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(config: self.class.config)  &#x21d2; Base </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#config-instance_method" title="#config (instance method)">#<strong>config</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#mutex-instance_method" title="#mutex (instance method)">#<strong>mutex</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#call-instance_method" title="#call (instance method)">#<strong>call</strong>(env)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by <a href="../../Rack.html" title="Rack (module)"><code>::Rack</code></a> to set up the server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connection_identifiers-instance_method" title="#connection_identifiers (instance method)">#<strong>connection_identifiers</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>All of the identifiers applied to the connection class associated with this server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#disconnect-instance_method" title="#disconnect (instance method)">#<strong>disconnect</strong>(identifiers)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Disconnect all the connections identified by <code>identifiers</code> on this server or any others via <a href="../RemoteConnections.html" title="ActionCable::RemoteConnections (class)"><code>::ActionCable::RemoteConnections</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#event_loop-instance_method" title="#event_loop (instance method)">#<strong>event_loop</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pubsub-instance_method" title="#pubsub (instance method)">#<strong>pubsub</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Adapter used for all streams/broadcasting.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#remote_connections-instance_method" title="#remote_connections (instance method)">#<strong>remote_connections</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Gateway to <a href="../RemoteConnections.html" title="ActionCable::RemoteConnections (class)"><code>::ActionCable::RemoteConnections</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#restart-instance_method" title="#restart (instance method)">#<strong>restart</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_pool-instance_method" title="#worker_pool (instance method)">#<strong>worker_pool</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The worker pool is where we run connection callbacks and channel actions.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Broadcasting.html" title="ActionCable::Server::Broadcasting (module)"><code>Broadcasting</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Broadcasting.html#broadcast-instance_method" title="ActionCable::Server::Broadcasting#broadcast (method)">#broadcast</a></td>
      <td><div class='inline'><p>Broadcast a hash directly to a named <code>broadcasting</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Broadcasting.html#broadcaster_for-instance_method" title="ActionCable::Server::Broadcasting#broadcaster_for (method)">#broadcaster_for</a></td>
      <td><div class='inline'><p>Returns a broadcaster for a named <code>broadcasting</code> that can be reused.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(config: self.class.config)  &#x21d2; <code>Base</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L24-L28'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='24' data-end='28'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 24</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='label'>config:</span> <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>)
  <span class='ivar'>@config</span> <span class='op'>=</span> <span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>
  <span class='ivar'>@mutex</span> <span class='op'>=</span> <span class='const'>Monitor</span>.<span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@remote_connections</span> <span class='op'>=</span> <span class='ivar'>@event_loop</span> <span class='op'>=</span> <span class='ivar'>@worker_pool</span> <span class='op'>=</span> <span class='ivar'>@pubsub</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="config-class_method">
  <h3 class='signature rw first'>
    .<strong>config</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L15-L15'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='15' data-end='15'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 15</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_cattr_accessor'>cattr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config'>config</span><span class='comma'>,</span> <span class='label'>instance_accessor:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Server.html" title="ActionCable::Server (module)">Server</a></span><span class='op'>::</span><span class='const'><a href="Configuration.html" title="ActionCable::Server::Configuration (class)">Configuration</a></span>.<span class='id identifier rubyid_new'><a href="Configuration.html#new-class_method" title="ActionCable::Server::Configuration.new (method)">new</a></span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="logger-class_method">
  <h3 class='signature  first'>
    .<strong>logger</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L19-L19'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='19' data-end='19'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 19</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_logger'>logger</span><span class='semicolon'>;</span> <span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>.<span class='id identifier rubyid_logger'>logger</span><span class='semicolon'>;</span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="config-instance_method">
  <h3 class='signature ro first'>
    #<strong>config</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L17-L17'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='17' data-end='17'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 17</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config'>config</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="logger-instance_method">
  <h3 class='signature ro'>
    #<strong>logger</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L20-L20'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='20' data-end='20'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 20</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="mutex-instance_method">
  <h3 class='signature ro'>
    #<strong>mutex</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L22-L22'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='22' data-end='22'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 22</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_mutex'>mutex</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="call-instance_method">
  <h3 class='signature  first'>
    #<strong>call</strong>(env)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Called by <a href="../../Rack.html" title="Rack (module)"><code>::Rack</code></a> to set up the server.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L31-L34'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='31' data-end='34'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 31</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_call'>call</span>(<span class='id identifier rubyid_env'>env</span>)
  <span class='id identifier rubyid_setup_heartbeat_timer'>setup_heartbeat_timer</span>
  <span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>.<span class='id identifier rubyid_connection_class'>connection_class</span>.<span class='id identifier rubyid_call'>call</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="ActionCable::Server::Base.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>).<span class='id identifier rubyid_process'>process</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connection_identifiers-instance_method">
  <h3 class='signature '>
    #<strong>connection_identifiers</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>All of the identifiers applied to the connection class associated with this server.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L87-L89'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='87' data-end='89'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 87</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_identifiers'>connection_identifiers</span>
  <span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>.<span class='id identifier rubyid_connection_class'>connection_class</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="ActionCable::Server::Base#call (method)">call</a></span>.<span class='id identifier rubyid_identifiers'>identifiers</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disconnect-instance_method">
  <h3 class='signature '>
    #<strong>disconnect</strong>(identifiers)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Disconnect all the connections identified by <code>identifiers</code> on this server or any others via <a href="../RemoteConnections.html" title="ActionCable::RemoteConnections (class)"><code>::ActionCable::RemoteConnections</code></a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L37-L39'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='37' data-end='39'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 37</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_disconnect'>disconnect</span>(<span class='id identifier rubyid_identifiers'>identifiers</span>)
  <span class='id identifier rubyid_remote_connections'><a href="#remote_connections-instance_method" title="ActionCable::Server::Base#remote_connections (method)">remote_connections</a></span>.<span class='id identifier rubyid_where'>where</span>(<span class='id identifier rubyid_identifiers'>identifiers</span>).<span class='id identifier rubyid_disconnect'>disconnect</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="event_loop-instance_method">
  <h3 class='signature '>
    #<strong>event_loop</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L62-L64'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='62' data-end='64'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 62</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_event_loop'>event_loop</span>
  <span class='ivar'>@event_loop</span> <span class='op'>||</span> <span class='ivar'>@mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> { <span class='ivar'>@event_loop</span> <span class='op'>||=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="../Connection/StreamEventLoop.html" title="ActionCable::Connection::StreamEventLoop (class)">StreamEventLoop</a></span>.<span class='id identifier rubyid_new'><a href="../Connection/StreamEventLoop.html#new-class_method" title="ActionCable::Connection::StreamEventLoop.new (method)">new</a></span> }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pubsub-instance_method">
  <h3 class='signature '>
    #<strong>pubsub</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Adapter used for all streams/broadcasting.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L82-L84'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='82' data-end='84'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 82</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pubsub'>pubsub</span>
  <span class='ivar'>@pubsub</span> <span class='op'>||</span> <span class='ivar'>@mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> { <span class='ivar'>@pubsub</span> <span class='op'>||=</span> <span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>.<span class='id identifier rubyid_pubsub_adapter'>pubsub_adapter</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="ActionCable::Server::Base.new (method)">new</a></span>(<span class='kw'>self</span>) }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="remote_connections-instance_method">
  <h3 class='signature '>
    #<strong>remote_connections</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Gateway to <a href="../RemoteConnections.html" title="ActionCable::RemoteConnections (class)"><code>::ActionCable::RemoteConnections</code></a>. See that class for details.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L58-L60'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='58' data-end='60'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 58</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_remote_connections'>remote_connections</span>
  <span class='ivar'>@remote_connections</span> <span class='op'>||</span> <span class='ivar'>@mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> { <span class='ivar'>@remote_connections</span> <span class='op'>||=</span> <span class='const'><a href="../RemoteConnections.html" title="ActionCable::RemoteConnections (class)">RemoteConnections</a></span>.<span class='id identifier rubyid_new'><a href="../RemoteConnections.html#new-class_method" title="ActionCable::RemoteConnections.new (method)">new</a></span>(<span class='kw'>self</span>) }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="restart-instance_method">
  <h3 class='signature '>
    #<strong>restart</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L41-L55'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='41' data-end='55'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 41</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_restart'>restart</span>
  <span class='id identifier rubyid_connections'>connections</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_connection'>connection</span><span class='op'>|</span>
    <span class='id identifier rubyid_connection'>connection</span>.<span class='id identifier rubyid_close'>close</span>(<span class='label'>reason:</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../../ActionCable.html#INTERNAL-constant" title="ActionCable::INTERNAL (constant)">INTERNAL</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_disconnect_reasons'>disconnect_reasons</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_server_restart'>server_restart</span>])
  <span class='kw'>end</span>

  <span class='ivar'>@mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='comment'># Shutdown the worker pool
</span>    <span class='ivar'>@worker_pool</span>.<span class='id identifier rubyid_halt'>halt</span> <span class='kw'>if</span> <span class='ivar'>@worker_pool</span>
    <span class='ivar'>@worker_pool</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='comment'># Shutdown the pub/sub adapter
</span>    <span class='ivar'>@pubsub</span>.<span class='id identifier rubyid_shutdown'>shutdown</span> <span class='kw'>if</span> <span class='ivar'>@pubsub</span>
    <span class='ivar'>@pubsub</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_pool-instance_method">
  <h3 class='signature '>
    #<strong>worker_pool</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The worker pool is where we run connection callbacks and channel actions. We do as little as possible on the server’s main thread. The worker pool is an executor service that’s backed by a pool of threads working from a task queue. The thread pool size maxes out at 4 worker threads by default. Tune the size yourself with <code>config.action_cable.worker_pool_size</code>.</p>

<p>Using Active Record, Redis, etc within your channel actions means you’ll get a separate connection from each thread in the worker pool. Plan your deployment accordingly: 5 servers each running 5 Puma workers each running an 8-thread worker pool means at least 200 database connections.</p>

<p>Also, ensure that your database connection pool size is as least as large as your worker pool size. Otherwise, workers may oversubscribe the database connection pool and block while they wait for other workers to release their connections. Use a smaller worker pool or a larger database connection pool instead.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v6.1.7.10/actioncable/lib/action_cable/server/base.rb#L77-L79'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='77' data-end='79'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/server/base.rb', line 77</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_pool'>worker_pool</span>
  <span class='ivar'>@worker_pool</span> <span class='op'>||</span> <span class='ivar'>@mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> { <span class='ivar'>@worker_pool</span> <span class='op'>||=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Server.html" title="ActionCable::Server (module)">Server</a></span><span class='op'>::</span><span class='const'><a href="Worker.html" title="ActionCable::Server::Worker (class)">Worker</a></span>.<span class='id identifier rubyid_new'><a href="Worker.html#new-class_method" title="ActionCable::Server::Worker.new (method)">new</a></span>(<span class='label'>max_size:</span> <span class='id identifier rubyid_config'><a href="#config-class_method" title="ActionCable::Server::Base.config (method)">config</a></span>.<span class='id identifier rubyid_worker_pool_size'>worker_pool_size</span>) }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>