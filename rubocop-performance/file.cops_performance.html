<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Cops Performance &mdash; RuboCop::Performance master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "cops_performance",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>RuboCop::Performance master</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Cops Performance&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<div class="sect1">
<h2 id="performanceancestorsinclude">Performance/AncestorsInclude</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>ancestors.include?</code> and change them to use <code>&#8656;</code> instead.</p>
</div>
<div class="sect2">
<h3 id="safety-performanceancestorsinclude">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it can&#8217;t tell whether the receiver is a class or an object.
e.g. the false positive was for <code>Nokogiri::XML::Node#ancestors</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performanceancestorsinclude">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>A</span>.<span class='id identifier rubyid_ancestors'>ancestors</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='const'>B</span>)

<span class='comment'># good
</span><span class='const'>A</span> <span class='op'>&lt;=</span> <span class='const'>B</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performanceancestorsinclude">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#ancestorsinclude-vs&#8212;&#8203;code" class="bare">https://github.com/fastruby/fast-ruby#ancestorsinclude-vs&#8212;&#8203;code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancearraysemiinfiniterangeslice">Performance/ArraySemiInfiniteRangeSlice</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where slicing arrays with semi-infinite ranges
can be replaced by <code>Array#take</code> and <code>Array#drop</code>.
This cop was created due to a mistake in microbenchmark and hence is disabled by default.
Refer <a href="https://github.com/rubocop/rubocop-performance/pull/175#issuecomment-731892717" class="bare">https://github.com/rubocop/rubocop-performance/pull/175#issuecomment-731892717</a></p>
</div>
<div class="sect2">
<h3 id="safety-performancearraysemiinfiniterangeslice">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe for string slices because strings do not have <code>#take</code> and <code>#drop</code> methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancearraysemiinfiniterangeslice">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span>[<span class='op'>..</span><span class='int'>2</span>]
<span class='id identifier rubyid_array'>array</span>[<span class='op'>...</span><span class='int'>2</span>]
<span class='id identifier rubyid_array'>array</span>[<span class='int'>2</span><span class='op'>..</span>]
<span class='id identifier rubyid_array'>array</span>[<span class='int'>2</span><span class='op'>...</span>]
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_slice'>slice</span>(<span class='op'>..</span><span class='int'>2</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_take'>take</span>(<span class='int'>3</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_take'>take</span>(<span class='int'>2</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_drop'>drop</span>(<span class='int'>2</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_drop'>drop</span>(<span class='int'>2</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_take'>take</span>(<span class='int'>3</span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancebigdecimalwithnumericargument">Performance/BigDecimalWithNumericArgument</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 3.1
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.26</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where a float argument to BigDecimal should be converted to a string.
Initializing from String is faster than from Float for BigDecimal.</p>
</div>
<div class="paragraph">
<p>Also identifies places where an integer string argument to BigDecimal should be converted to
an integer. Initializing from Integer is faster than from String for BigDecimal.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This cop is disabled by default because the performance of initializing with a String
and Number differ between versions. Additionally, performance depends on the size of the Number,
and if it is an Integer or a Float. Since this is very specific to <code>bigdecimal</code> internals,
suggestions from this cop are not unlikely to result in code that performs worse than before.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-performancebigdecimalwithnumericargument">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>BigDecimal</span>(<span class='float'>1.2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>true</span>)
<span class='float'>4.5</span>.<span class='id identifier rubyid_to_d'>to_d</span>(<span class='int'>6</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>true</span>)

<span class='comment'># good
</span><span class='const'>BigDecimal</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1.2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>true</span>)
<span class='const'>BigDecimal</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>4.5</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>true</span>)

<span class='comment'># bad
</span><span class='const'>BigDecimal</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span>)
<span class='const'>BigDecimal</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>4</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>6</span>)

<span class='comment'># good
</span><span class='const'>BigDecimal</span>(<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>)
<span class='int'>4</span>.<span class='id identifier rubyid_to_d'>to_d</span>(<span class='int'>6</span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancebindcall">Performance/BindCall</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.7, <code>UnboundMethod#bind_call</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>bind(obj).call(args, &#8230;&#8203;)</code>
can be replaced by <code>bind_call(obj, args, &#8230;&#8203;)</code>.</p>
</div>
<div class="paragraph">
<p>The <code>bind_call(obj, args, &#8230;&#8203;)</code> method is faster than
<code>bind(obj).call(args, &#8230;&#8203;)</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performancebindcall">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_umethod'>umethod</span>.<span class='id identifier rubyid_bind'>bind</span>(<span class='id identifier rubyid_obj'>obj</span>).<span class='id identifier rubyid_call'>call</span>(<span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='id identifier rubyid_bar'>bar</span>)
<span class='id identifier rubyid_umethod'>umethod</span>.<span class='id identifier rubyid_bind'>bind</span>(<span class='id identifier rubyid_obj'>obj</span>).(<span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='id identifier rubyid_bar'>bar</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_umethod'>umethod</span>.<span class='id identifier rubyid_bind_call'>bind_call</span>(<span class='id identifier rubyid_obj'>obj</span><span class='comma'>,</span> <span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='id identifier rubyid_bar'>bar</span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceblockgivenwithexplicitblock">Performance/BlockGivenWithExplicitBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.22</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a <code>block_given?</code> where explicit check
of block argument would suffice.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This cop produces code with significantly worse performance when a
block is being passed to the method and as such should not be enabled.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-performanceblockgivenwithexplicitblock">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_method'>method</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_do_something'>do_something</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_method'>method</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_do_something'>do_something</span> <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>

<span class='comment'># good - block is reassigned
</span><span class='kw'>def</span> <span class='id identifier rubyid_method'>method</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_block'>block</span> <span class='op'>||=</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_do_something'>do_something</span> }
  <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Using default ...</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecaller">Performance/Caller</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.49</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>caller[n]</code> can be replaced by <code>caller(n..n).first</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performancecaller">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_caller'>caller</span>[<span class='int'>1</span>]
<span class='id identifier rubyid_caller'>caller</span>.<span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_caller_locations'>caller_locations</span>[<span class='int'>1</span>]
<span class='id identifier rubyid_caller_locations'>caller_locations</span>.<span class='id identifier rubyid_first'>first</span>

<span class='comment'># good
</span><span class='id identifier rubyid_caller'>caller</span>(<span class='int'>2</span><span class='op'>..</span><span class='int'>2</span>).<span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_caller'>caller</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>1</span>).<span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_caller_locations'>caller_locations</span>(<span class='int'>2</span><span class='op'>..</span><span class='int'>2</span>).<span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_caller_locations'>caller_locations</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>1</span>).<span class='id identifier rubyid_first'>first</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecasewhensplat">Performance/CaseWhenSplat</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.34</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Reordering <code>when</code> conditions with a splat to the end
of the <code>when</code> branches can improve performance.</p>
</div>
<div class="paragraph">
<p>Ruby has to allocate memory for the splat expansion every time
that the <code>case</code> <code>when</code> statement is run. Since Ruby does not support
fall through inside of <code>case</code> <code>when</code>, like some other languages do,
the order of the <code>when</code> branches should not matter. By placing any
splat expansions at the end of the list of <code>when</code> branches we will
reduce the number of times that memory has to be allocated for
the expansion. The exception to this is if multiple of your <code>when</code>
conditions can be true for any given condition. A likely scenario for
this defining a higher level when condition to override a condition
that is inside of the splat expansion.</p>
</div>
<div class="sect2">
<h3 id="safety-performancecasewhensplat">Safety</h3>
<div class="paragraph">
<p>This cop is not unsafe autocorrection because it is not a guaranteed
performance improvement. If the data being processed by the <code>case</code> condition is
normalized in a manner that favors hitting a condition in the splat expansion,
it is possible that moving the splat condition to the end will use more memory,
and run slightly slower.
See for more details: <a href="https://github.com/rubocop/rubocop/pull/6163" class="bare">https://github.com/rubocop/rubocop/pull/6163</a></p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancecasewhensplat">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='kw'>case</span> <span class='id identifier rubyid_foo'>foo</span>
<span class='kw'>when</span> <span class='op'>*</span><span class='id identifier rubyid_condition'>condition</span>
  <span class='id identifier rubyid_bar'>bar</span>
<span class='kw'>when</span> <span class='id identifier rubyid_baz'>baz</span>
  <span class='id identifier rubyid_foobar'>foobar</span>
<span class='kw'>end</span>

<span class='kw'>case</span> <span class='id identifier rubyid_foo'>foo</span>
<span class='kw'>when</span> <span class='op'>*</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]
  <span class='id identifier rubyid_bar'>bar</span>
<span class='kw'>when</span> <span class='int'>5</span>
  <span class='id identifier rubyid_baz'>baz</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>case</span> <span class='id identifier rubyid_foo'>foo</span>
<span class='kw'>when</span> <span class='id identifier rubyid_baz'>baz</span>
  <span class='id identifier rubyid_foobar'>foobar</span>
<span class='kw'>when</span> <span class='op'>*</span><span class='id identifier rubyid_condition'>condition</span>
  <span class='id identifier rubyid_bar'>bar</span>
<span class='kw'>end</span>

<span class='kw'>case</span> <span class='id identifier rubyid_foo'>foo</span>
<span class='kw'>when</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>
  <span class='id identifier rubyid_bar'>bar</span>
<span class='kw'>when</span> <span class='int'>5</span>
  <span class='id identifier rubyid_baz'>baz</span>
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecasecmp">Performance/Casecmp</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.21</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where a case-insensitive string comparison
can better be implemented using <code>casecmp</code>.</p>
</div>
<div class="paragraph">
<p>This cop is disabled by default because <code>String#casecmp</code> only works with
ASCII characters. See <a href="https://github.com/rubocop/rubocop/issues/9753" class="bare">https://github.com/rubocop/rubocop/issues/9753</a>.</p>
</div>
<div class="paragraph">
<p>If you are working only with ASCII characters, then this cop can be
safely enabled.</p>
</div>
<div class="sect2">
<h3 id="safety-performancecasecmp">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>String#casecmp</code> and <code>String#casecmp?</code> behave
differently when using Non-ASCII characters.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancecasecmp">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_downcase'>downcase</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_upcase'>upcase</span>.<span class='id identifier rubyid_eql?'>eql?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ABC</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>==</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_downcase'>downcase</span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ABC</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_eql?'>eql?</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_upcase'>upcase</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_downcase'>downcase</span> <span class='op'>==</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_downcase'>downcase</span>

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_casecmp'>casecmp</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ABC</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_zero?'>zero?</span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_casecmp'>casecmp</span>(<span class='id identifier rubyid_str'>str</span>).<span class='id identifier rubyid_zero?'>zero?</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancecasecmp">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringcasecmp-vs&#8212;&#8203;stringcasecmp-vs-stringdowncase---code" class="bare">https://github.com/fastruby/fast-ruby#stringcasecmp-vs&#8212;&#8203;stringcasecmp-vs-stringdowncase---code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancechainarrayallocation">Performance/ChainArrayAllocation</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.59</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>array.compact.flatten.map { |x| x.downcase }</code>.
Each of these methods (<code>compact</code>, <code>flatten</code>, <code>map</code>) will generate a new intermediate array
that is promptly thrown away. Instead it is faster to mutate when we know it&#8217;s safe.</p>
</div>
<div class="sect2">
<h3 id="examples-performancechainarrayallocation">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span> <span class='op'>=</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>]
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_compact'>compact</span>.<span class='id identifier rubyid_flatten'>flatten</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_downcase'>downcase</span> }

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span> <span class='op'>=</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>]
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_compact!'>compact!</span>
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_flatten!'>flatten!</span>
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_map!'>map!</span> { <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_downcase'>downcase</span> }
<span class='id identifier rubyid_array'>array</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecollectionliteralinloop">Performance/CollectionLiteralInLoop</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where Array and Hash literals are used within loops.
It is better to extract them into a local variable or constant
to avoid unnecessary allocations on each iteration.</p>
</div>
<div class="paragraph">
<p>You can set the minimum number of elements to consider
an offense with <code>MinSize</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since Ruby 3.4, certain simple arguments to <code>Array#include?</code> are
optimized directly in Ruby. This avoids allocations without changing the
code, as such no offense will be registered in those cases. Currently that
includes: strings, <code>self</code>, local variables, instance variables, and method
calls without arguments. Additionally, any number of methods can be chained:
<code>[1, 2, 3].include?(@foo)</code> and <code>[1, 2, 3].include?(@foo.bar.baz)</code> both avoid
the array allocation.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-performancecollectionliteralinloop">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_users'>users</span>.<span class='id identifier rubyid_select'>select</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span>
  <span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>superadmin</span><span class='words_sep'> </span><span class='tstring_content'>admin</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_role'>role</span>)
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='id identifier rubyid_admin_roles'>admin_roles</span> <span class='op'>=</span> <span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>superadmin</span><span class='words_sep'> </span><span class='tstring_content'>admin</span><span class='tstring_end'>]</span></span>
<span class='id identifier rubyid_users'>users</span>.<span class='id identifier rubyid_select'>select</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span>
  <span class='id identifier rubyid_admin_roles'>admin_roles</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_role'>role</span>)
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='const'>ADMIN_ROLES</span> <span class='op'>=</span> <span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>superadmin</span><span class='words_sep'> </span><span class='tstring_content'>admin</span><span class='tstring_end'>]</span></span>
<span class='op'>...</span>
<span class='id identifier rubyid_users'>users</span>.<span class='id identifier rubyid_select'>select</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span>
  <span class='const'>ADMIN_ROLES</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_role'>role</span>)
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performancecollectionliteralinloop">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MinSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecomparewithblock">Performance/CompareWithBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.46</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>sort { |a, b| a.foo &lt;&#8658; b.foo }</code>
can be replaced by <code>sort_by(&amp;:foo)</code>.
This cop also checks <code>sort!</code>, <code>min</code>, <code>max</code> and <code>minmax</code> methods.</p>
</div>
<div class="sect2">
<h3 id="examples-performancecomparewithblock">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort'>sort</span>   { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_foo'>foo</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_foo'>foo</span> }
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort!'>sort!</span>  { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_foo'>foo</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_foo'>foo</span> }
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_max'>max</span>    { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_foo'>foo</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_foo'>foo</span> }
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_min'>min</span>    { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_foo'>foo</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_foo'>foo</span> }
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_minmax'>minmax</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>.<span class='id identifier rubyid_foo'>foo</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_foo'>foo</span> }
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort'>sort</span>   { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>] <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>] }

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort_by'>sort_by</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort_by!'>sort_by!</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort_by'>sort_by</span> { <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span>.<span class='id identifier rubyid_foo'>foo</span> }
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort_by'>sort_by</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_var'>var</span><span class='op'>|</span>
  <span class='id identifier rubyid_var'>var</span>.<span class='id identifier rubyid_foo'>foo</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_max_by'>max_by</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_min_by'>min_by</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_minmax_by'>minmax_by</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort_by'>sort_by</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>] }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceconcurrentmonotonictime">Performance/ConcurrentMonotonicTime</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>Concurrent.monotonic_time</code>
can be replaced by <code>Process.clock_gettime(Process::CLOCK_MONOTONIC)</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceconcurrentmonotonictime">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>Concurrent</span>.<span class='id identifier rubyid_monotonic_time'>monotonic_time</span>

<span class='comment'># good
</span><span class='const'>Process</span>.<span class='id identifier rubyid_clock_gettime'>clock_gettime</span>(<span class='const'>Process</span><span class='op'>::</span><span class='const'>CLOCK_MONOTONIC</span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performanceconcurrentmonotonictime">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rails/rails/pull/43502" class="bare">https://github.com/rails/rails/pull/43502</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceconstantregexp">Performance/ConstantRegexp</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Finds regular expressions with dynamic components that are all constants.</p>
</div>
<div class="paragraph">
<p>Ruby allocates a new Regexp object every time it executes a code containing such
a regular expression. It is more efficient to extract it into a constant,
memoize it, or add an <code>/o</code> option to perform <code>#{}</code> interpolation only once and
reuse that Regexp object.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceconstantregexp">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_tokens'>tokens</span>(<span class='id identifier rubyid_pattern'>pattern</span>)
  <span class='id identifier rubyid_pattern'>pattern</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='const'>TOKEN</span>).<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_token'>token</span><span class='op'>|</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A</span><span class='embexpr_beg'>#{</span><span class='const'>SEPARATORS</span><span class='embexpr_end'>}</span><span class='tstring_content'>\Z</span><span class='regexp_end'>/</span></span>) }
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='const'>ALL_SEPARATORS</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A</span><span class='embexpr_beg'>#{</span><span class='const'>SEPARATORS</span><span class='embexpr_end'>}</span><span class='tstring_content'>\Z</span><span class='regexp_end'>/</span></span>
<span class='kw'>def</span> <span class='id identifier rubyid_tokens'>tokens</span>(<span class='id identifier rubyid_pattern'>pattern</span>)
  <span class='id identifier rubyid_pattern'>pattern</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='const'>TOKEN</span>).<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_token'>token</span><span class='op'>|</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='const'>ALL_SEPARATORS</span>) }
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_tokens'>tokens</span>(<span class='id identifier rubyid_pattern'>pattern</span>)
  <span class='id identifier rubyid_pattern'>pattern</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='const'>TOKEN</span>).<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_token'>token</span><span class='op'>|</span> <span class='id identifier rubyid_token'>token</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A</span><span class='embexpr_beg'>#{</span><span class='const'>SEPARATORS</span><span class='embexpr_end'>}</span><span class='tstring_content'>\Z</span><span class='regexp_end'>/o</span></span>) }
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_separators'>separators</span>
  <span class='ivar'>@separators</span> <span class='op'>||=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A</span><span class='embexpr_beg'>#{</span><span class='const'>SEPARATORS</span><span class='embexpr_end'>}</span><span class='tstring_content'>\Z</span><span class='regexp_end'>/</span></span>
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecount">Performance/Count</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>count</code> on an <code>Enumerable</code> that
follow calls to <code>select</code>, <code>find_all</code>, <code>filter</code> or <code>reject</code>. Querying logic can instead be
passed to the <code>count</code> call.</p>
</div>
<div class="sect2">
<h3 id="safety-performancecount">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it has known compatibility issues with <code>ActiveRecord</code> and other
frameworks. Before Rails 5.1, <code>ActiveRecord</code> will ignore the block that is passed to <code>count</code>.
Other methods, such as <code>select</code>, will convert the association to an
array and then run the block on the array. A simple work around to
make <code>count</code> work with a block is to call <code>to_a.count {&#8230;&#8203;}</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='const'>Model</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> [<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>]).<span class='id identifier rubyid_select'>select</span> { <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span>.<span class='id identifier rubyid_method'>method</span> <span class='op'>==</span> <span class='kw'>true</span> }.<span class='id identifier rubyid_size'>size</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>becomes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='const'>Model</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> [<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>]).<span class='id identifier rubyid_to_a'>to_a</span>.<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span>.<span class='id identifier rubyid_method'>method</span> <span class='op'>==</span> <span class='kw'>true</span> }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancecount">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_select'>select</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_size'>size</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_size'>size</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_select'>select</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_length'>length</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_length'>length</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_select'>select</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_odd?'>odd?</span> }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reject'>reject</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_even?'>even?</span> }
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_select'>select</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>).<span class='id identifier rubyid_count'>count</span>

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&lt;</span> <span class='int'>2</span> }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_odd?'>odd?</span> }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&lt;</span> <span class='int'>2</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_even?'>even?</span> }
<span class='const'>Model</span>.<span class='id identifier rubyid_select'>select</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>field AS field_one</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_count'>count</span>
<span class='const'>Model</span>.<span class='id identifier rubyid_select'>select</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>).<span class='id identifier rubyid_count'>count</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedeleteprefix">Performance/DeletePrefix</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.5
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.5, <code>String#delete_prefix</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>gsub(/\Aprefix/, '')</code> and <code>sub(/\Aprefix/, '')</code>
can be replaced by <code>delete_prefix('prefix')</code>.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>^prefix</code> is unsafe as it will behave incompatible with <code>delete_prefix</code>
for receiver is multiline string.</p>
</div>
<div class="paragraph">
<p>The <code>delete_prefix('prefix')</code> method is faster than <code>gsub(/\Aprefix/, '')</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-performancedeleteprefix">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>Pathname</code> has <code>sub</code> but not <code>delete_prefix</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancedeleteprefix">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aprefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aprefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub'>sub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aprefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub!'>sub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aprefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_delete_prefix'>delete_prefix</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefix</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_delete_prefix!'>delete_prefix!</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefix</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-true-_default_-performancedeleteprefix">SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub'>sub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub!'>sub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-false-performancedeleteprefix">SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub'>sub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub!'>sub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^prefix</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performancedeleteprefix">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedeletesuffix">Performance/DeleteSuffix</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.5
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.5, <code>String#delete_suffix</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>gsub(/suffix\z/, '')</code> and <code>sub(/suffix\z/, '')</code>
can be replaced by <code>delete_suffix('suffix')</code>.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>suffix$</code> is unsafe as it will behave incompatible with <code>delete_suffix?</code>
for receiver is multiline string.</p>
</div>
<div class="paragraph">
<p>The <code>delete_suffix('suffix')</code> method is faster than <code>gsub(/suffix\z/, '')</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-performancedeletesuffix">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>Pathname</code> has <code>sub</code> but not <code>delete_suffix</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancedeletesuffix">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix\z</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix\z</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)

<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub'>sub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix\z</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub!'>sub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix\z</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>suffix</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_delete_suffix!'>delete_suffix!</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>suffix</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-true-_default_-performancedeletesuffix">SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub'>sub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub!'>sub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-false-performancedeletesuffix">SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub'>sub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_sub!'>sub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>suffix$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performancedeletesuffix">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedetect">Performance/Detect</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>first</code>, <code>last</code>, <code>[0]</code> or <code>[-1]</code>
chained to <code>select</code>, <code>find_all</code> or <code>filter</code> and change them to use
<code>detect</code> instead.</p>
</div>
<div class="sect2">
<h3 id="safety-performancedetect">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it assumes that the receiver is an
<code>Array</code> or equivalent, but can&#8217;t reliably detect it. For example,
if the receiver is a <code>Hash</code>, it may report a false positive.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancedetect">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>[].<span class='id identifier rubyid_select'>select</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }.<span class='id identifier rubyid_first'>first</span>
[].<span class='id identifier rubyid_select'>select</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }.<span class='id identifier rubyid_last'>last</span>
[].<span class='id identifier rubyid_find_all'>find_all</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }.<span class='id identifier rubyid_first'>first</span>
[].<span class='id identifier rubyid_find_all'>find_all</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }.<span class='id identifier rubyid_last'>last</span>
[].<span class='id identifier rubyid_filter'>filter</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }.<span class='id identifier rubyid_first'>first</span>
[].<span class='id identifier rubyid_filter'>filter</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }.<span class='id identifier rubyid_last'>last</span>
[].<span class='id identifier rubyid_filter'>filter</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }[<span class='int'>0</span>]
[].<span class='id identifier rubyid_filter'>filter</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }[<span class='op'>-</span><span class='int'>1</span>]

<span class='comment'># good
</span>[].<span class='id identifier rubyid_detect'>detect</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }
[].<span class='id identifier rubyid_reverse'>reverse</span>.<span class='id identifier rubyid_detect'>detect</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='kw'>true</span> }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancedetect">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#enumerabledetect-vs-enumerableselectfirst-code" class="bare">https://github.com/fastruby/fast-ruby#enumerabledetect-vs-enumerableselectfirst-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedoublestartendwith">Performance/DoubleStartEndWith</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.48</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for consecutive <code>#start_with?</code> or <code>#end_with?</code> calls.
These methods accept multiple arguments, so in some cases like when
they are separated by <code>||</code>, they can be combined into a single method call.</p>
</div>
<div class="paragraph">
<p><code>IncludeActiveSupportAliases</code> configuration option is used to check for
<code>starts_with?</code> and <code>ends_with?</code>. These methods are defined by Active Support.</p>
</div>
<div class="sect2">
<h3 id="examples-performancedoublestartendwith">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='const'>Some</span><span class='op'>::</span><span class='const'>CONST</span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>)
<span class='op'>!</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='id identifier rubyid_foo'>foo</span>) <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='id identifier rubyid_bar'>bar</span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='id identifier rubyid_var1'>var1</span>) <span class='op'>||</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='id identifier rubyid_var2'>var2</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>Some</span><span class='op'>::</span><span class='const'>CONST</span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>)
<span class='op'>!</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='id identifier rubyid_bar'>bar</span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='id identifier rubyid_var1'>var1</span><span class='comma'>,</span> <span class='id identifier rubyid_var2'>var2</span>)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="includeactivesupportaliases_-false-_default_-performancedoublestartendwith">IncludeActiveSupportAliases: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='id identifier rubyid_var1'>var1</span>) <span class='op'>||</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='id identifier rubyid_var2'>var2</span>)

<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='id identifier rubyid_var1'>var1</span><span class='comma'>,</span> <span class='id identifier rubyid_var2'>var2</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="includeactivesupportaliases_-true-performancedoublestartendwith">IncludeActiveSupportAliases: true</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='id identifier rubyid_var1'>var1</span>) <span class='op'>||</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='id identifier rubyid_var2'>var2</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_starts_with?'>starts_with?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_ends_with?'>ends_with?</span>(<span class='id identifier rubyid_var1'>var1</span><span class='comma'>,</span> <span class='id identifier rubyid_var2'>var2</span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performancedoublestartendwith">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludeActiveSupportAliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceendwith">Performance/EndWith</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a regex where <code>String#end_with?</code> would suffice.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>end$</code> is unsafe as it will behave incompatible with <code>end_with?</code>
for receiver is multiline string.</p>
</div>
<div class="sect2">
<h3 id="safety-performanceendwith">Safety</h3>
<div class="paragraph">
<p>This will change to a new method call which isn&#8217;t guaranteed to be on the
object. Switching these methods has to be done with knowledge of the types
of the variables which rubocop doesn&#8217;t have.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performanceendwith">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc\Z</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc\Z</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc\Z</span><span class='regexp_end'>/</span></span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc\Z</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc\Z</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc\Z</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bc</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-true-_default_-performanceendwith">SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># good
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-false-performanceendwith">SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>bc$</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performanceendwith">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-performanceendwith">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end" class="bare">https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancefixedsize">Performance/FixedSize</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.35</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Do not compute the size of statically sized objects.</p>
</div>
<div class="sect2">
<h3 id="examples-performancefixedsize">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># String methods
</span><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_size'>size</span>
<span class='tstring'><span class='tstring_beg'>%q[</span><span class='tstring_content'>bar</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_count'>count</span>
<span class='tstring'><span class='tstring_beg'>%(</span><span class='tstring_content'>qux</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_length'>length</span>

<span class='comment'># Symbol methods
</span><span class='comment'># bad
</span><span class='symbeg'>:</span><span class='id identifier rubyid_fred'>fred</span>.<span class='id identifier rubyid_size'>size</span>
<span class='symbeg'>:&#39;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_length'>length</span>

<span class='comment'># Array methods
</span><span class='comment'># bad
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_thud'>thud</span>].<span class='id identifier rubyid_count'>count</span>
<span class='words'><span class='words_beg'>%W(</span><span class='tstring_content'>1,</span><span class='words_sep'> </span><span class='tstring_content'>2,</span><span class='words_sep'> </span><span class='tstring_content'>bar</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_size'>size</span>

<span class='comment'># Hash methods
</span><span class='comment'># bad
</span>{ <span class='label'>a:</span> <span class='id identifier rubyid_corge'>corge</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='id identifier rubyid_grault'>grault</span> }.<span class='id identifier rubyid_length'>length</span>

<span class='comment'># good
</span><span class='id identifier rubyid_foo'>foo</span>.<span class='id identifier rubyid_size'>size</span>
<span class='id identifier rubyid_bar'>bar</span>.<span class='id identifier rubyid_count'>count</span>
<span class='id identifier rubyid_qux'>qux</span>.<span class='id identifier rubyid_length'>length</span>

<span class='comment'># good
</span><span class='symbeg'>:&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_fred'>fred</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_size'>size</span>
<span class='const'>CONST</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_baz'>baz</span>.<span class='id identifier rubyid_length'>length</span>

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_thud'>thud</span>].<span class='id identifier rubyid_count'>count</span>
<span class='id identifier rubyid_garply'>garply</span> <span class='op'>=</span> [<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>]
<span class='id identifier rubyid_garply'>garply</span>.<span class='id identifier rubyid_size'>size</span>

<span class='comment'># good
</span>{ <span class='label'>a:</span> <span class='id identifier rubyid_corge'>corge</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_grault'>grault</span> }.<span class='id identifier rubyid_length'>length</span>
<span class='id identifier rubyid_waldo'>waldo</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='id identifier rubyid_corge'>corge</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='id identifier rubyid_grault'>grault</span> }
<span class='id identifier rubyid_waldo'>waldo</span>.<span class='id identifier rubyid_size'>size</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceflatmap">Performance/FlatMap</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>map { &#8230;&#8203; }.flatten</code> and
change them to use <code>flat_map { &#8230;&#8203; }</code> instead.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceflatmap">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>].<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> [<span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span>] }.<span class='id identifier rubyid_flatten'>flatten</span>(<span class='int'>1</span>)
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>].<span class='id identifier rubyid_collect'>collect</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> [<span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span>] }.<span class='id identifier rubyid_flatten'>flatten</span>(<span class='int'>1</span>)

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>].<span class='id identifier rubyid_flat_map'>flat_map</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> [<span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span>] }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>].<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> [<span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span>] }.<span class='id identifier rubyid_flatten'>flatten</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>].<span class='id identifier rubyid_collect'>collect</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> [<span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span>] }.<span class='id identifier rubyid_flatten'>flatten</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performanceflatmap">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnabledForFlattenWithoutParams</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-performanceflatmap">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#enumerablemaparrayflatten-vs-enumerableflat_map-code" class="bare">https://github.com/fastruby/fast-ruby#enumerablemaparrayflatten-vs-enumerableflat_map-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceinefficienthashsearch">Performance/InefficientHashSearch</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for inefficient searching of keys and values within
hashes.</p>
</div>
<div class="paragraph">
<p><code>Hash#keys.include?</code> is less efficient than <code>Hash#key?</code> because
the former allocates a new array and then performs an O(n) search
through that array, while <code>Hash#key?</code> does not allocate any array and
performs a faster O(1) search for the key.</p>
</div>
<div class="paragraph">
<p><code>Hash#values.include?</code> is less efficient than <code>Hash#value?</code>. While they
both perform an O(n) search through all of the values, calling <code>values</code>
allocates a new array while using <code>value?</code> does not.</p>
</div>
<div class="sect2">
<h3 id="safety-performanceinefficienthashsearch">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it can&#8217;t tell whether the receiver is a hash object.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performanceinefficienthashsearch">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>)
{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_z'>z</span>)
<span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }<span class='semicolon'>;</span> <span class='id identifier rubyid_h'>h</span>.<span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='int'>100</span>)

<span class='comment'># good
</span>{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>)
{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_has_key?'>has_key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_z'>z</span>)
<span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }<span class='semicolon'>;</span> <span class='id identifier rubyid_h'>h</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='int'>100</span>)

<span class='comment'># bad
</span>{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='int'>2</span>)
{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>garbage</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }<span class='semicolon'>;</span> <span class='id identifier rubyid_h'>h</span>.<span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='kw'>nil</span>)

<span class='comment'># good
</span>{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_value?'>value?</span>(<span class='int'>2</span>)
{ <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }.<span class='id identifier rubyid_has_value?'>has_value?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>garbage</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> { <span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span> }<span class='semicolon'>;</span> <span class='id identifier rubyid_h'>h</span>.<span class='id identifier rubyid_value?'>value?</span>(<span class='kw'>nil</span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performanceinefficienthashsearch">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#hashkey-instead-of-hashkeysinclude-code" class="bare">https://github.com/fastruby/fast-ruby#hashkey-instead-of-hashkeysinclude-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceioreadlines">Performance/IoReadlines</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where inefficient <code>readlines</code> method
can be replaced by <code>each_line</code> to avoid fully loading file content into memory.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceioreadlines">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>File</span>.<span class='id identifier rubyid_readlines'>readlines</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_l'>l</span> }
<span class='const'>IO</span>.<span class='id identifier rubyid_readlines'>readlines</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>chomp:</span> <span class='kw'>true</span>).<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_l'>l</span> }

<span class='id identifier rubyid_conn'>conn</span>.<span class='id identifier rubyid_readlines'>readlines</span>(<span class='int'>10</span>).<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_size'>size</span> }
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_readlines'>readlines</span>.<span class='id identifier rubyid_find'>find</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span>) }
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_readlines'>readlines</span>.<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_l'>l</span> }

<span class='comment'># good
</span><span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_each_line'>each_line</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_l'>l</span> }
<span class='const'>IO</span>.<span class='id identifier rubyid_open'>open</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>testfile</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_each_line'>each_line</span>(<span class='label'>chomp:</span> <span class='kw'>true</span>) { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_l'>l</span> }

<span class='id identifier rubyid_conn'>conn</span>.<span class='id identifier rubyid_each_line'>each_line</span>(<span class='int'>10</span>).<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_size'>size</span> }
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_each_line'>each_line</span>.<span class='id identifier rubyid_find'>find</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span>) }
<span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_each_line'>each_line</span> { <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_l'>l</span> }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performanceioreadlines">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gitlab.com/development/performance/#reading-from-files-and-other-data-sources" class="bare">https://docs.gitlab.com/development/performance/#reading-from-files-and-other-data-sources</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancemapcompact">Performance/MapCompact</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.7, <code>Enumerable#filter_map</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>map { &#8230;&#8203; }.compact</code> can be replaced by <code>filter_map</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby">[<span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>nil</span>].<span class='id identifier rubyid_compact'>compact</span>              <span class='comment'>#=&gt; [true, false]
</span>[<span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>nil</span>].<span class='id identifier rubyid_filter_map'>filter_map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_itself'>itself</span>) <span class='comment'>#=&gt; [true]</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="safety-performancemapcompact">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>map { &#8230;&#8203; }.compact</code> might yield
different results than <code>filter_map</code>. As illustrated in the example, <code>filter_map</code>
also filters out falsey values, while <code>compact</code> only gets rid of <code>nil</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancemapcompact">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>).<span class='id identifier rubyid_compact'>compact</span>
<span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_collect'>collect</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>).<span class='id identifier rubyid_compact'>compact</span>

<span class='comment'># good
</span><span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_filter_map'>filter_map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>)
<span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>).<span class='id identifier rubyid_compact!'>compact!</span>
<span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_compact'>compact</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancemapmethodchain">Performance/MapMethodChain</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks if the map method is used in a chain.</p>
</div>
<div class="paragraph">
<p>Autocorrection is not supported because an appropriate block variable name cannot be determined automatically.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>X</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
    <span class='cvar'>@@num</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
    <span class='cvar'>@@num</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_bar'>bar</span>
    <span class='cvar'>@@num</span> <span class='op'>*</span> <span class='int'>2</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

[<span class='const'>X</span>.<span class='id identifier rubyid_new'>new</span><span class='comma'>,</span> <span class='const'>X</span>.<span class='id identifier rubyid_new'>new</span>].<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>).<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>) <span class='comment'># =&gt; [4, 4]
</span>[<span class='const'>X</span>.<span class='id identifier rubyid_new'>new</span><span class='comma'>,</span> <span class='const'>X</span>.<span class='id identifier rubyid_new'>new</span>].<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_foo'>foo</span>.<span class='id identifier rubyid_bar'>bar</span> } <span class='comment'># =&gt; [2, 4]</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="safety-performancemapmethodchain">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because false positives occur if the number of times the first method is executed
affects the return value of subsequent methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancemapmethodchain">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>).<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_foo'>foo</span>.<span class='id identifier rubyid_bar'>bar</span> }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancemethodobjectasblock">Performance/MethodObjectAsBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where methods are converted to blocks, with the
use of <code>&amp;method</code>, and passed as arguments to method calls.
It is faster to replace those with explicit blocks, calling those methods inside.</p>
</div>
<div class="sect2">
<h3 id="examples-performancemethodobjectasblock">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_do_something'>do_something</span>))
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_each'>each</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_out'>out</span>.<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_puts'>puts</span>))

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_do_something'>do_something</span>(<span class='id identifier rubyid_x'>x</span>) }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_out'>out</span>.<span class='id identifier rubyid_puts'>puts</span>(<span class='id identifier rubyid_x'>x</span>) }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancemethodobjectasblock">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#normal-way-to-apply-method-vs-method-code" class="bare">https://github.com/fastruby/fast-ruby#normal-way-to-apply-method-vs-method-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceopenstruct">Performance/OpenStruct</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for <code>OpenStruct.new</code> calls.
Instantiation of an <code>OpenStruct</code> invalidates
Ruby global method cache as it causes dynamic method
definition during program runtime.
This could have an effect on performance,
especially in case of single-threaded
applications with multiple <code>OpenStruct</code> instantiations.</p>
</div>
<div class="sect2">
<h3 id="safety-performanceopenstruct">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>OpenStruct.new</code> and <code>Struct.new</code>
are not equivalent.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performanceopenstruct">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='kw'>class</span> <span class='const'>MyClass</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_my_method'>my_method</span>
    <span class='const'>OpenStruct</span>.<span class='id identifier rubyid_new'>new</span>(<span class='label'>my_key1:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_value1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>my_key2:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_value2</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>class</span> <span class='const'>MyClass</span>
  <span class='const'>MyStruct</span> <span class='op'>=</span> <span class='const'>Struct</span>.<span class='id identifier rubyid_new'>new</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_my_key1'>my_key1</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_my_key2'>my_key2</span>)
  <span class='kw'>def</span> <span class='id identifier rubyid_my_method'>my_method</span>
    <span class='const'>MyStruct</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_value1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_value2</span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancerangeinclude">Performance/RangeInclude</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies uses of <code>Range#include?</code> and <code>Range#member?</code>, which iterates over each
item in a <code>Range</code> to see if a specified item is there. In contrast,
<code>Range#cover?</code> simply compares the target item with the beginning and
end points of the <code>Range</code>. In a great majority of cases, this is what
is wanted.</p>
</div>
<div class="sect2">
<h3 id="safety-performancerangeinclude">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>Range#include?</code> (or <code>Range#member?</code>) and <code>Range#cover?</code>
are not equivalent behavior.
Example of a case where <code>Range#cover?</code> may not provide the desired result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby">(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>z</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_cover?'>cover?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>yellow</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancerangeinclude">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>z</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; true
</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>z</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_member?'>member?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span>)  <span class='comment'># =&gt; true
</span>
<span class='comment'># good
</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>z</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_cover?'>cover?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancerangeinclude">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#cover-vs-include-code" class="bare">https://github.com/fastruby/fast-ruby#cover-vs-include-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantblockcall">Performance/RedundantBlockCall</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies the use of a <code>&amp;block</code> parameter and <code>block.call</code>
where <code>yield</code> would do just as well.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceredundantblockcall">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_method'>method</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_call'>call</span>
<span class='kw'>end</span>
<span class='kw'>def</span> <span class='id identifier rubyid_another'>another</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_func'>func</span>)
  <span class='id identifier rubyid_func'>func</span>.<span class='id identifier rubyid_call'>call</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_method'>method</span>
  <span class='kw'>yield</span>
<span class='kw'>end</span>
<span class='kw'>def</span> <span class='id identifier rubyid_another'>another</span>
  <span class='kw'>yield</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performanceredundantblockcall">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#proccall-and-block-arguments-vs-yieldcode" class="bare">https://github.com/fastruby/fast-ruby#proccall-and-block-arguments-vs-yieldcode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantequalitycomparisonblock">Performance/RedundantEqualityComparisonBlock</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.5
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for uses <code>Enumerable#all?</code>, <code>Enumerable#any?</code>, <code>Enumerable#one?</code>,
and <code>Enumerable#none?</code> are compared with <code>===</code> or similar methods in block.</p>
</div>
<div class="paragraph">
<p>By default, <code>Object#===</code> behaves the same as <code>Object#==</code>, but this
behavior is appropriately overridden in subclass. For example,
<code>Range#===</code> returns <code>true</code> when argument is within the range.</p>
</div>
<div class="paragraph">
<p>This cop has <code>AllowRegexpMatch</code> option and it is true by default because
<code>regexp.match?('string')</code> often used in block changes to the opposite result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>pattern</span><span class='regexp_end'>/</span></span>].<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_regexp'>regexp</span><span class='op'>|</span> <span class='id identifier rubyid_regexp'>regexp</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pattern</span><span class='tstring_end'>&#39;</span></span>) } <span class='comment'># =&gt; true
</span>[<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>pattern</span><span class='regexp_end'>/</span></span>].<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_regexp'>regexp</span><span class='op'>|</span> <span class='id identifier rubyid_regexp'>regexp</span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pattern</span><span class='tstring_end'>&#39;</span></span> }      <span class='comment'># =&gt; true
</span>[<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>pattern</span><span class='regexp_end'>/</span></span>].<span class='id identifier rubyid_all?'>all?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pattern</span><span class='tstring_end'>&#39;</span></span>)                            <span class='comment'># =&gt; false</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="safety-performanceredundantequalitycomparisonblock">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>===</code> and <code>==</code> do not always behave the same.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performanceredundantequalitycomparisonblock">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_pattern'>pattern</span> <span class='op'>===</span> <span class='id identifier rubyid_item'>item</span> }
<span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span> }
<span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Klass</span>) }
<span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'>Klass</span>) }

<span class='comment'># good
</span><span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span>(<span class='id identifier rubyid_pattern'>pattern</span>)
<span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span>(<span class='const'>Klass</span>)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowregexpmatch_-true-_default_-performanceredundantequalitycomparisonblock">AllowRegexpMatch: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># good
</span><span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span> <span class='op'>=~</span> <span class='id identifier rubyid_pattern'>pattern</span> }
<span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='id identifier rubyid_pattern'>pattern</span>) }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowregexpmatch_-false-performanceredundantequalitycomparisonblock">AllowRegexpMatch: false</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span> <span class='op'>=~</span> <span class='id identifier rubyid_pattern'>pattern</span> }
<span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='id identifier rubyid_pattern'>pattern</span>) }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performanceredundantequalitycomparisonblock">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowRegexpMatch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-performanceredundantequalitycomparisonblock">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rails/rails/pull/41363" class="bare">https://github.com/rails/rails/pull/41363</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantmatch">Performance/RedundantMatch</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies the use of <code>Regexp#match</code> or <code>String#match</code>, which
returns <code>#&lt;MatchData&gt;</code>/<code>nil</code>. The return value of <code>=~</code> is an integral
index/<code>nil</code> and is more performant.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceredundantmatch">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_do_something'>do_something</span> <span class='kw'>if</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>regex</span><span class='regexp_end'>/</span></span>)
<span class='kw'>while</span> <span class='id identifier rubyid_regex'>regex</span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>str</span><span class='tstring_end'>&#39;</span></span>)
  <span class='id identifier rubyid_do_something'>do_something</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='id identifier rubyid_method'>method</span>(<span class='id identifier rubyid_str'>str</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>regex</span><span class='regexp_end'>/</span></span>)
<span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>unless</span> <span class='id identifier rubyid_regex'>regex</span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>str</span><span class='tstring_end'>&#39;</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantmerge">Performance/RedundantMerge</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>Hash#merge!</code> can be replaced by <code>Hash#[]=</code>.
You can set the maximum number of key-value pairs to consider
an offense with <code>MaxKeyValuePairs</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-performanceredundantmerge">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because RuboCop cannot determine if the
receiver of <code>merge!</code> is actually a hash or not.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performanceredundantmerge">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='label'>a:</span> <span class='int'>1</span>)
<span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_merge!'>merge!</span>({<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>key</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span>})

<span class='comment'># good
</span><span class='id identifier rubyid_hash'>hash</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>] <span class='op'>=</span> <span class='int'>1</span>
<span class='id identifier rubyid_hash'>hash</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>key</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="maxkeyvaluepairs_-2-_default_-performanceredundantmerge">MaxKeyValuePairs: 2 (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_hash'>hash</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span>] <span class='op'>=</span> <span class='int'>1</span>
<span class='id identifier rubyid_hash'>hash</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_b'>b</span>] <span class='op'>=</span> <span class='int'>2</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performanceredundantmerge">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MaxKeyValuePairs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-performanceredundantmerge">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#hashmerge-vs-hash-code" class="bare">https://github.com/fastruby/fast-ruby#hashmerge-vs-hash-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantsortblock">Performance/RedundantSortBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>sort { |a, b| a &lt;&#8658; b }</code> can be replaced with <code>sort</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceredundantsortblock">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort'>sort</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span> }

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort'>sort</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantsplitregexpargument">Performance/RedundantSplitRegexpArgument</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>split</code> argument can be replaced from
a deterministic regexp to a string.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceredundantsplitregexpargument">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a,b,c</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span>)

<span class='comment'># good
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a,b,c</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantstringchars">Performance/RedundantStringChars</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for redundant <code>String#chars</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceredundantstringchars">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>[<span class='int'>0</span><span class='op'>..</span><span class='int'>2</span>]
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_slice'>slice</span>(<span class='int'>0</span><span class='op'>..</span><span class='int'>2</span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_last'>last</span>

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>[<span class='int'>0</span><span class='op'>..</span><span class='int'>2</span>].<span class='id identifier rubyid_chars'>chars</span>

<span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_first'>first</span>(<span class='int'>2</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>[<span class='int'>0</span>]
<span class='id identifier rubyid_str'>str</span>[<span class='int'>0</span><span class='op'>...</span><span class='int'>2</span>].<span class='id identifier rubyid_chars'>chars</span>
<span class='id identifier rubyid_str'>str</span>[<span class='op'>-</span><span class='int'>1</span>]

<span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_take'>take</span>(<span class='int'>2</span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_length'>length</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_size'>size</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_empty?'>empty?</span>

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>[<span class='int'>0</span><span class='op'>...</span><span class='int'>2</span>].<span class='id identifier rubyid_chars'>chars</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_length'>length</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_size'>size</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_empty?'>empty?</span>

<span class='comment'># For example, if the receiver is an empty string, it will be incompatible.
</span><span class='comment'># If a negative value is specified for the receiver, `nil` is returned.
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_last'>last</span>(<span class='int'>2</span>) <span class='comment'># Incompatible with `str[-2..-1].chars`.
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_chars'>chars</span>.<span class='id identifier rubyid_drop'>drop</span>(<span class='int'>2</span>) <span class='comment'># Incompatible with `str[2..-1].chars`.</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceregexpmatch">Performance/RegexpMatch</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.4
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.4, <code>String#match?</code>, <code>Regexp#match?</code>, and <code>Symbol#match?</code>
have been added. The methods are faster than <code>match</code>.
Because the methods avoid creating a <code>MatchData</code> object or saving
backref.
So, when <code>MatchData</code> is not used, use <code>match?</code> instead of <code>match</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceregexpmatch">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_do_something'>do_something</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>!~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_do_something'>do_something</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span>)
    <span class='id identifier rubyid_do_something'>do_something</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># bad
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span> <span class='op'>===</span> <span class='id identifier rubyid_x'>x</span>
    <span class='id identifier rubyid_do_something'>do_something</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span>)
    <span class='id identifier rubyid_do_something'>do_something</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span>)
    <span class='id identifier rubyid_do_something'>do_something</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_do_something'>do_something</span>(<span class='const'>Regexp</span>.<span class='id identifier rubyid_last_match'>last_match</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span>)
    <span class='id identifier rubyid_do_something'>do_something</span>(<span class='gvar'>$~</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='kw'>if</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>re</span><span class='regexp_end'>/</span></span> <span class='op'>===</span> <span class='id identifier rubyid_x'>x</span>
    <span class='id identifier rubyid_do_something'>do_something</span>(<span class='gvar'>$~</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performanceregexpmatch">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#regexp-vs-regexpmatch-vs-regexpmatch-vs-stringmatch-vs-string-vs-stringmatch-code-" class="bare">https://github.com/fastruby/fast-ruby#regexp-vs-regexpmatch-vs-regexpmatch-vs-stringmatch-vs-string-vs-stringmatch-code-</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancereverseeach">Performance/ReverseEach</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>reverse.each</code> and change them to use <code>reverse_each</code> instead.</p>
</div>
<div class="paragraph">
<p>If the return value is used, it will not be detected because the result will be different.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby">[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reverse'>reverse</span>.<span class='id identifier rubyid_each'>each</span> {} <span class='comment'>#=&gt; [3, 2, 1]
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reverse_each'>reverse_each</span> {} <span class='comment'>#=&gt; [1, 2, 3]</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancereverseeach">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_reverse'>reverse</span>.<span class='id identifier rubyid_each'>each</span>

<span class='comment'># good
</span><span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_reverse_each'>reverse_each</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancereverseeach">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#enumerablereverseeach-vs-enumerablereverse_each-code" class="bare">https://github.com/fastruby/fast-ruby#enumerablereverseeach-vs-enumerablereverse_each-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancereversefirst">Performance/ReverseFirst</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>reverse.first(n)</code> and <code>reverse.first</code>
can be replaced by <code>last(n).reverse</code> and <code>last</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performancereversefirst">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_reverse'>reverse</span>.<span class='id identifier rubyid_first'>first</span>(<span class='int'>5</span>)
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_reverse'>reverse</span>.<span class='id identifier rubyid_first'>first</span>

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_last'>last</span>(<span class='int'>5</span>).<span class='id identifier rubyid_reverse'>reverse</span>
<span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_last'>last</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceselectmap">Performance/SelectMap</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.7, <code>Enumerable#filter_map</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>select.map</code> can be replaced by <code>filter_map</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceselectmap">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_select'>select</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>).<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>)
<span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_filter'>filter</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span>).<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>)

<span class='comment'># good
</span><span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_filter_map'>filter_map</span> { <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_o'>o</span>.<span class='id identifier rubyid_bar'>bar</span> <span class='kw'>if</span> <span class='id identifier rubyid_o'>o</span>.<span class='id identifier rubyid_foo'>foo</span> }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesize">Performance/Size</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>count</code> on an <code>Array</code> and <code>Hash</code> and change them to <code>size</code>.</p>
</div>
<div class="paragraph">
<p>TODO: Add advanced detection of variables that could
have been assigned to an array or a hash.</p>
</div>
<div class="sect2">
<h3 id="examples-performancesize">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_count'>count</span>
(<span class='int'>1</span><span class='op'>..</span><span class='int'>3</span>).<span class='id identifier rubyid_to_a'>to_a</span>.<span class='id identifier rubyid_count'>count</span>
<span class='const'>Array</span>[<span class='op'>*</span><span class='int'>1</span><span class='op'>..</span><span class='int'>3</span>].<span class='id identifier rubyid_count'>count</span>
<span class='const'>Array</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>3</span>).<span class='id identifier rubyid_count'>count</span>

<span class='comment'># bad
</span>{<span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>c:</span> <span class='int'>3</span>}.<span class='id identifier rubyid_count'>count</span>
[[<span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>]<span class='comma'>,</span> [<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>]].<span class='id identifier rubyid_to_h'>to_h</span>.<span class='id identifier rubyid_count'>count</span>
<span class='const'>Hash</span>[<span class='op'>*</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>z</span><span class='tstring_end'>&#39;</span></span>)].<span class='id identifier rubyid_count'>count</span>
<span class='const'>Hash</span>(<span class='label'>key:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>).<span class='id identifier rubyid_count'>count</span>

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_size'>size</span>
(<span class='int'>1</span><span class='op'>..</span><span class='int'>3</span>).<span class='id identifier rubyid_to_a'>to_a</span>.<span class='id identifier rubyid_size'>size</span>
<span class='const'>Array</span>[<span class='op'>*</span><span class='int'>1</span><span class='op'>..</span><span class='int'>3</span>].<span class='id identifier rubyid_size'>size</span>
<span class='const'>Array</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>3</span>).<span class='id identifier rubyid_size'>size</span>

<span class='comment'># good
</span>{<span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>c:</span> <span class='int'>3</span>}.<span class='id identifier rubyid_size'>size</span>
[[<span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>]<span class='comma'>,</span> [<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>]].<span class='id identifier rubyid_to_h'>to_h</span>.<span class='id identifier rubyid_size'>size</span>
<span class='const'>Hash</span>[<span class='op'>*</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>z</span><span class='tstring_end'>&#39;</span></span>)].<span class='id identifier rubyid_size'>size</span>
<span class='const'>Hash</span>(<span class='label'>key:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>).<span class='id identifier rubyid_size'>size</span>

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_count'>count</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>&gt;</span> <span class='int'>2</span> }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancesize">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#arraylength-vs-arraysize-vs-arraycount-code" class="bare">https://github.com/fastruby/fast-ruby#arraylength-vs-arraysize-vs-arraycount-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesortreverse">Performance/SortReverse</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>sort { |a, b| b &lt;&#8658; a }</code>
can be replaced by a faster <code>sort.reverse</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performancesortreverse">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort'>sort</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_b'>b</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_a'>a</span> }

<span class='comment'># good
</span><span class='id identifier rubyid_array'>array</span>.<span class='id identifier rubyid_sort'>sort</span>.<span class='id identifier rubyid_reverse'>reverse</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesqueeze">Performance/Squeeze</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>gsub(/a+/, 'a')</code> and <code>gsub!(/a+/, 'a')</code>
can be replaced by <code>squeeze('a')</code> and <code>squeeze!('a')</code>.</p>
</div>
<div class="paragraph">
<p>The <code>squeeze('a')</code> method is faster than <code>gsub(/a+/, 'a')</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performancesqueeze">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>a+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>a+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_squeeze'>squeeze</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_squeeze!'>squeeze!</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancesqueeze">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#remove-extra-spaces-or-other-contiguous-characters-code" class="bare">https://github.com/fastruby/fast-ruby#remove-extra-spaces-or-other-contiguous-characters-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestartwith">Performance/StartWith</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a regex where <code>String#start_with?</code> would suffice.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>^start</code> is unsafe as it will behave incompatible with <code>start_with?</code>
for receiver is multiline string.</p>
</div>
<div class="sect2">
<h3 id="safety-performancestartwith">Safety</h3>
<div class="paragraph">
<p>This will change to a new method call which isn&#8217;t guaranteed to be on the
object. Switching these methods has to be done with knowledge of the types
of the variables which rubocop doesn&#8217;t have.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancestartwith">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aab</span><span class='regexp_end'>/</span></span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aab</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ab</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-true-_default_-performancestartwith">SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># good
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline_-false-performancestartwith">SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performancestartwith">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-performancestartwith">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end" class="bare">https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestringbytesize">Performance/StringBytesize</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for calls to <code>#bytes</code> counting method and suggests using <code>bytesize</code> instead.
The <code>bytesize</code> method is more efficient and directly returns the size in bytes,
avoiding the intermediate array allocation that <code>bytes.size</code> incurs.</p>
</div>
<div class="sect2">
<h3 id="safety-performancestringbytesize">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it assumes that the receiver
responds to <code>#bytesize</code> method.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancestringbytesize">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_string_var'>string_var</span>.<span class='id identifier rubyid_bytes'>bytes</span>.<span class='id identifier rubyid_count'>count</span>
<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foobar</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_bytes'>bytes</span>.<span class='id identifier rubyid_size'>size</span>

<span class='comment'># good
</span><span class='id identifier rubyid_string_var'>string_var</span>.<span class='id identifier rubyid_bytesize'>bytesize</span>
<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foobar</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_bytesize'>bytesize</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestringidentifierargument">Performance/StringIdentifierArgument</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where string identifier argument can be replaced
by symbol identifier argument.
It prevents the redundancy of the internal string-to-symbol conversion.</p>
</div>
<div class="paragraph">
<p>This cop targets methods that take identifier (e.g. method name) argument
and the following examples are parts of it.</p>
</div>
<div class="sect2">
<h3 id="examples-performancestringidentifierargument">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_send'>send</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>do_something</span><span class='tstring_end'>&#39;</span></span>)
<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>do_something</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@ivar</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_do_something'>do_something</span>)
<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_do_something'>do_something</span>
<span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span>(<span class='symbeg'>:</span><span class='ivar'>@ivar</span>)

<span class='comment'># good - these methods don&#39;t support namespaced symbols
</span><span class='id identifier rubyid_const_get'>const_get</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>::Base</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_const_source_location'>const_source_location</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>::Base</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_const_defined?'>const_defined?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>::Base</span><span class='tstring_end'>&quot;</span></span>)

<span class='comment'># good - using a symbol when string interpolation is involved causes a performance regression.
</span><span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_interpolation'>interpolation</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestringinclude">Performance/StringInclude</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.12</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a regex where <code>String#include?</code> would suffice.</p>
</div>
<div class="sect2">
<h3 id="safety-performancestringinclude">Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s offenses are not safe to autocorrect if a receiver is nil or a Symbol.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancestringinclude">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='id identifier rubyid_str'>str</span>)
<span class='id identifier rubyid_str'>str</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ab</span><span class='regexp_end'>/</span></span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ab</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='id identifier rubyid_str'>str</span>
<span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_match'>match</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ab</span><span class='regexp_end'>/</span></span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ab</span><span class='regexp_end'>/</span></span>.<span class='id identifier rubyid_match'>match</span>(<span class='id identifier rubyid_str'>str</span>)
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ab</span><span class='regexp_end'>/</span></span> <span class='op'>===</span> <span class='id identifier rubyid_str'>str</span>

<span class='comment'># good
</span><span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ab</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestringreplacement">Performance/StringReplacement</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.33</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>gsub</code> can be replaced by <code>tr</code> or <code>delete</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performancestringreplacement">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>a</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.*</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>a+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_tr'>tr</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d</span><span class='tstring_end'>&#39;</span></span>)
<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a b c</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-performancestringreplacement">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringgsub-vs-stringtr-code" class="bare">https://github.com/fastruby/fast-ruby#stringgsub-vs-stringtr-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesum">Performance/Sum</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.4
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where custom code finding the sum of elements
in some Enumerable object can be replaced by <code>Enumerable#sum</code> method.</p>
</div>
<div class="sect2">
<h3 id="safety-performancesum">Safety</h3>
<div class="paragraph">
<p>Autocorrections are unproblematic wherever an initial value is provided explicitly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby">[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='int'>4</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>+</span>) <span class='comment'># =&gt; 10
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>4</span>) <span class='comment'># =&gt; 10
</span>
[].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='int'>4</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>+</span>) <span class='comment'># =&gt; 4
</span>[].<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>4</span>) <span class='comment'># =&gt; 4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This also holds true for non-numeric types which implement a <code>:+</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>l</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>o</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Hel</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>+</span>) <span class='comment'># =&gt; &quot;Hello&quot;
</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>l</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>o</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_sum'>sum</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Hel</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; &quot;Hello&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When no initial value is provided though, <code>Enumerable#reduce</code> will pick the first enumerated value
as initial value and successively add all following values to it, whereas
<code>Enumerable#sum</code> will set an initial value of <code>0</code> (<code>Integer</code>) which can lead to a <code>TypeError</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby">[].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='symbeg'>:</span><span class='op'>+</span>) <span class='comment'># =&gt; nil
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='symbeg'>:</span><span class='op'>+</span>) <span class='comment'># =&gt; 6
</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>H</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>l</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>l</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>o</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='symbeg'>:</span><span class='op'>+</span>) <span class='comment'># =&gt; &quot;Hello&quot;
</span>
[].<span class='id identifier rubyid_sum'>sum</span> <span class='comment'># =&gt; 0
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span> <span class='comment'># =&gt; 6
</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>H</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>l</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>l</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>o</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_sum'>sum</span> <span class='comment'># =&gt; in `+&#39;: String can&#39;t be coerced into Integer (TypeError)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancesum">Examples</h3>
<div class="sect3">
<h4 id="onlysumorwithinitialvalue_-false-_default_-performancesum">OnlySumOrWithInitialValue: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_inject'>inject</span>(<span class='symbeg'>:</span><span class='op'>+</span>)                        <span class='comment'># Autocorrections for cases without initial value are unsafe
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_inject'>inject</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='op'>+</span>)                       <span class='comment'># and will only be performed when using the `-A` option.
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reduce'>reduce</span> { <span class='op'>|</span><span class='id identifier rubyid_acc'>acc</span><span class='comma'>,</span> <span class='id identifier rubyid_elem'>elem</span><span class='op'>|</span> <span class='id identifier rubyid_acc'>acc</span> <span class='op'>+</span> <span class='id identifier rubyid_elem'>elem</span> } <span class='comment'># They can be prohibited completely using `SafeAutoCorrect: true`.
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='int'>10</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>+</span>)
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_elem'>elem</span><span class='op'>|</span> <span class='id identifier rubyid_elem'>elem</span> <span class='op'>**</span> <span class='int'>2</span> }.<span class='id identifier rubyid_sum'>sum</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_collect'>collect</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_count'>count</span>).<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>10</span>)

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>10</span>)
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span> { <span class='op'>|</span><span class='id identifier rubyid_elem'>elem</span><span class='op'>|</span> <span class='id identifier rubyid_elem'>elem</span> <span class='op'>**</span> <span class='int'>2</span> }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>10</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_count'>count</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="onlysumorwithinitialvalue_-true-performancesum">OnlySumOrWithInitialValue: true</h4>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_reduce'>reduce</span>(<span class='int'>10</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>+</span>)
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_elem'>elem</span><span class='op'>|</span> <span class='id identifier rubyid_elem'>elem</span> <span class='op'>**</span> <span class='int'>2</span> }.<span class='id identifier rubyid_sum'>sum</span>
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_collect'>collect</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_count'>count</span>).<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>10</span>)

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>10</span>)
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span> { <span class='op'>|</span><span class='id identifier rubyid_elem'>elem</span><span class='op'>|</span> <span class='id identifier rubyid_elem'>elem</span> <span class='op'>**</span> <span class='int'>2</span> }
[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_sum'>sum</span>(<span class='int'>10</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_count'>count</span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-performancesum">Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OnlySumOrWithInitialValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-performancesum">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.bigbinary.com/blog/ruby-2-4-introduces-enumerable-sum" class="bare">https://www.bigbinary.com/blog/ruby-2-4-introduces-enumerable-sum</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancetimesmap">Performance/TimesMap</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for .times.map calls.
In most cases such calls can be replaced
with an explicit array creation.</p>
</div>
<div class="sect2">
<h3 id="safety-performancetimesmap">Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because <code>Integer#times</code> does nothing if receiver is 0
or less. However, <code>Array.new</code> raises an error if argument is less than 0.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='op'>-</span><span class='int'>1</span>.<span class='id identifier rubyid_times'>times</span>{}    <span class='comment'># does nothing
</span><span class='const'>Array</span>.<span class='id identifier rubyid_new'>new</span>(<span class='op'>-</span><span class='int'>1</span>) <span class='comment'># ArgumentError: negative array size</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancetimesmap">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='int'>9</span>.<span class='id identifier rubyid_times'>times</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
  <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>

<span class='comment'># good
</span><span class='const'>Array</span>.<span class='id identifier rubyid_new'>new</span>(<span class='int'>9</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
  <span class='id identifier rubyid_i'>i</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceunfreezestring">Performance/UnfreezeString</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Requires Ruby version 2.3
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.3 or later, use unary plus operator to unfreeze a string
literal instead of <code>String#dup</code> and <code>String.new</code>.
Unary plus operator is faster than <code>String#dup</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-performanceunfreezestring">Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because <code>String.new</code> (without operator) is not
exactly the same as <code>''`. These differ in encoding. {String.new.encoding} is always
{ASCII-8BIT}. However, `('').encoding</code> is the same as script encoding(e.g. <code>UTF-8</code>).
if you expect <code>ASCII-8BIT</code> encoding, disable this cop.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performanceunfreezestring">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>.<span class='id identifier rubyid_dup'>dup</span>          <span class='comment'># when Ruby 3.2 or lower
</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>something</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_dup'>dup</span> <span class='comment'># when Ruby 3.2 or lower
</span><span class='const'>String</span>.<span class='id identifier rubyid_new'>new</span>
<span class='const'>String</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>)
<span class='const'>String</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>something</span><span class='tstring_end'>&#39;</span></span>)

<span class='comment'># good
</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>something</span><span class='tstring_end'>&#39;</span></span>
<span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceuridefaultparser">Performance/UriDefaultParser</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>URI::Parser.new</code> can be replaced by <code>URI::DEFAULT_PARSER</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-performanceuridefaultparser">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span><span class='const'>URI</span><span class='op'>::</span><span class='const'>Parser</span>.<span class='id identifier rubyid_new'>new</span>

<span class='comment'># good
</span><span class='const'>URI</span><span class='op'>::</span><span class='const'>DEFAULT_PARSER</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancezipwithoutblock">Performance/ZipWithoutBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for <code>map { |id| [id] }</code> and suggests replacing it with <code>zip</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-performancezipwithoutblock">Safety</h3>
<div class="paragraph">
<p>This cop is unsafe for novel definitions of <code>map</code> and <code>collect</code>
on non-Enumerable objects that do not respond to <code>zip</code>.
To make your object enumerable, define an <code>each</code> method
as described in <a href="https://ruby-doc.org/core/Enumerable.html" class="bare">https://ruby-doc.org/core/Enumerable.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="examples-performancezipwithoutblock">Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="code ruby"><code class="ruby"><span class='comment'># bad
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span> [<span class='id identifier rubyid_id'>id</span>] }

<span class='comment'># good
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>].<span class='id identifier rubyid_zip'>zip</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>