<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Active Support Changelog &mdash; Rails-5.1.0</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../css/common.css' />

<script type='text/javascript'>
  var pathId = "active_support_changelog",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../index.html'>Home</a> &raquo; 
          <a href='index.html'>Rails-5.1.0</a> &raquo; 
          <a href='_index.html'>Index</a> &raquo; 
          <span class='title'>File: Active Support Changelog</span>
                </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="file_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='file'>
<ul>
<li><p>Since weeks are no longer converted to days, add <code>:weeks</code> to the list of
parts that <code>ActiveSupport::TimeWithZone</code> will recognize as possibly being
of variable duration to take account of DST transitions.</p>

<p>Fixes #26039.</p>

<p><em>Andrew White</em></p></li>
<li><p>Defines <code>Regexp.match?</code> for Ruby versions prior to 2.4. The predicate
has the same interface, but it does not have the performance boost. Its
purpose is to be able to write 2.4 compatible code.</p>

<p><em>Xavier Noria</em></p></li>
<li><p>Allow MessageEncryptor to take advantage of authenticated encryption modes.</p>

<p>AEAD modes like <code>aes-256-gcm</code> provide both confidentiality and data
authenticity, eliminating the need to use MessageVerifier to check if the
encrypted data has been tampered with. This speeds up encryption/decryption
and results in shorter cipher text.</p>

<p><em>Bart de Water</em></p></li>
<li><p>Introduce <code>assert_changes</code> and <code>assert_no_changes</code>.</p>

<p><code>assert_changes</code> is a more general <code>assert_difference</code> that works with any
value.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_assert_changes'>assert_changes</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Error.current</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>from:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ERR</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_expected_bad_operation'>expected_bad_operation</span>
<span class='kw'>end</span>
</code></pre>

<p>Can be called with strings, to be evaluated in the binding (context) of
the block given to the assertion, or a lambda.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_assert_changes'>assert_changes</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='const'>Error</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ERR</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_expected_bad_operation'>expected_bad_operation</span>
<span class='kw'>end</span>
</code></pre>

<p>The <code>from</code> and <code>to</code> arguments are compared with the case operator (<code>===</code>).</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_assert_changes'>assert_changes</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Error.current</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>from:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='const'>Error</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_expected_bad_operation'>expected_bad_operation</span>
<span class='kw'>end</span>
</code></pre>

<p>This is pretty useful, if you need to loosely compare a value. For example,
you need to test a token has been generated and it has that many random
characters.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_start_registration'>start_registration</span>
<span class='id identifier rubyid_assert_changes'>assert_changes</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user.token</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>to:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\w{32}</span><span class='regexp_end'>/</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_finish_registration'>finish_registration</span>
<span class='kw'>end</span>
</code></pre>

<p><em>Genadi Samokovarov</em></p></li>
<li><p>Add <code>:fallback_string</code> option to <code>Array#to_sentence</code>. If an empty array
calls the function and a fallback string option is set then it returns the
fallback string other than an empty string.</p>

<p><em>Mohamed Osama</em></p></li>
<li><p>Fix <code>ActiveSupport::TimeZone#strptime</code>. Now raises <code>ArgumentError</code> when the
given time doesn&#39;t match the format. The error is the same as the one given
by Ruby&#39;s <code>Date.strptime</code>. Previously it raised
<code>NoMethodError: undefined method empty? for nil:NilClass.</code> due to a bug.</p>

<p>Fixes #25701.</p>

<p><em>John Gesimondo</em></p></li>
<li><p><code>travel/travel_to</code> travel time helpers, now raise on nested calls,
 as this can lead to confusing time stubbing.</p>

<p>Instead of:</p>

<pre class="code ruby"><code class="ruby"> <span class='id identifier rubyid_travel_to'>travel_to</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='period'>.</span><span class='id identifier rubyid_from_now'>from_now</span> <span class='kw'>do</span>
   <span class='comment'># 2 days from today
</span>   <span class='id identifier rubyid_travel_to'>travel_to</span> <span class='int'>3</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='period'>.</span><span class='id identifier rubyid_from_now'>from_now</span> <span class='kw'>do</span>
     <span class='comment'># 5 days from today
</span>   <span class='kw'>end</span>
 <span class='kw'>end</span>
</code></pre>

<p>preferred way to achieve above is:</p>

<pre class="code ruby"><code class="ruby"> <span class='id identifier rubyid_travel'>travel</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span> <span class='kw'>do</span>
   <span class='comment'># 2 days from today
</span> <span class='kw'>end</span>

 <span class='id identifier rubyid_travel'>travel</span> <span class='int'>5</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span> <span class='kw'>do</span>
   <span class='comment'># 5 days from today
</span> <span class='kw'>end</span>
</code></pre>

<p><em>Vipul A M</em></p></li>
<li><p>Support parsing JSON time in ISO8601 local time strings in
<code>ActiveSupport::JSON.decode</code> when <code>parse_json_times</code> is enabled.
Strings in the format of <code>YYYY-MM-DD hh:mm:ss</code> (without a <code>Z</code> at
the end) will be parsed in the local timezone (<code>Time.zone</code>). In
addition, date strings (<code>YYYY-MM-DD</code>) are now parsed into <code>Date</code>
objects.</p>

<p><em>Grzegorz Witek</em></p></li>
<li><p>Fixed <code>ActiveSupport::Logger.broadcast</code> so that calls to <code>#silence</code> now
properly delegate to all loggers. Silencing now properly suppresses logging
to both the log and the console.</p>

<p><em>Kevin McPhillips</em></p></li>
<li><p>Remove deprecated arguments in <code>assert_nothing_raised</code>.</p>

<p><em>Rafel Mendonça França</em></p></li>
<li><p><code>Date.to_s</code> doesn&#39;t produce too many spaces. For example, <code>to_s(:short)</code>
will now produce <code>01 Feb</code> instead of <code>1 Feb</code>.</p>

<p>Fixes #25251.</p>

<p><em>Sean Griffin</em></p></li>
<li><p>Introduce Module#delegate_missing_to.</p>

<p>When building a decorator, a common pattern emerges:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Partition</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_first_event'>first_event</span><span class='rparen'>)</span>
    <span class='ivar'>@events</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_first_event'>first_event</span> <span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_people'>people</span>
    <span class='kw'>if</span> <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_people'>people</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
      <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='const'><a href="Array.html" title="Array (class)">Array</a></span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_people'>people</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    <span class='kw'>else</span>
      <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_creator'>creator</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_respond_to_missing?'>respond_to_missing?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_include_private'>include_private</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
      <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_include_private'>include_private</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_method_missing'>method_missing</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
      <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>With <code>Module#delegate_missing_to</code>, the above is condensed to:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Partition</span>
  <span class='id identifier rubyid_delegate_missing_to'>delegate_missing_to</span> <span class='symbeg'>:</span><span class='ivar'>@events</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_first_event'>first_event</span><span class='rparen'>)</span>
    <span class='ivar'>@events</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_first_event'>first_event</span> <span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_people'>people</span>
    <span class='kw'>if</span> <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_people'>people</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
      <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='const'><a href="Array.html" title="Array (class)">Array</a></span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_people'>people</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    <span class='kw'>else</span>
      <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_creator'>creator</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p><em>Genadi Samokovarov</em>, <em>DHH</em></p></li>
<li><p>Rescuable: If a handler doesn&#39;t match the exception, check for handlers
matching the exception&#39;s cause.</p>

<p><em>Jeremy Daer</em></p></li>
</ul>

<p>Please check <a href="https://github.com/rails/rails/blob/5-0-stable/activesupport/CHANGELOG.md">5-0-stable</a> for previous changes.</p>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>