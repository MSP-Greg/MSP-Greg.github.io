<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::TestFixtures &mdash; Rails-5.1.0</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::TestFixtures",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../index.html'>Home</a> &raquo; 
          <a href='../index.html'>Rails-5.1.0</a> &raquo; 
          <a href='../_index.html'>Index (T)</a> &raquo; 
          <a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <span class='title'>TestFixtures</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActiveRecord::TestFixtures</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Child Modules:</td>
    <td>
      <div class='box_max'>
        <a href="TestFixtures/ClassMethods.html" title="ActiveRecord::TestFixtures::ClassMethods (module)">ClassMethods</a>
      </div>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Extended by:</td>
    <td>
      <div class='box_max'>
        <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a>
      </div>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Included in:</td>
    <td>
      <div class='box_max'>
        <a href="../ActiveSupport/TestCase.html" title="ActiveSupport::TestCase (class)">ActiveSupport::TestCase</a>
      </div>
    </td>
  </tr>
  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L847'>activerecord/lib/active_record/fixtures.rb</a></div>  </td>
  </tr>
</table>





<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#after_teardown-instance_method" title="#after_teardown (instance method)">#<strong>after_teardown</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#before_setup-instance_method" title="#before_setup (instance method)">#<strong>before_setup</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#enlist_fixture_connections-instance_method" title="#enlist_fixture_connections (instance method)">#<strong>enlist_fixture_connections</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#instantiate_fixtures-instance_method" title="#instantiate_fixtures (instance method)">#<strong>instantiate_fixtures</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#load_fixtures-instance_method" title="#load_fixtures (instance method)">#<strong>load_fixtures</strong>(config)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#load_instances%3F-instance_method" title="#load_instances? (instance method)">#<strong>load_instances?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#run_in_transaction%3F-instance_method" title="#run_in_transaction? (instance method)">#<strong>run_in_transaction?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#setup_fixtures-instance_method" title="#setup_fixtures (instance method)">#<strong>setup_fixtures</strong>(config = ActiveRecord::Base)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#teardown_fixtures-instance_method" title="#teardown_fixtures (instance method)">#<strong>teardown_fixtures</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a></h3>
  <p class="inherited"><a href="../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">append_features</a>, <a href="../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">class_methods</a>, <a href="../ActiveSupport/Concern.html#extended-class_method" title="ActiveSupport::Concern.extended (method)">.extended</a>, <a href="../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">included</a></p>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="after_teardown-instance_method">
  <h3 class='signature first'>
  #<strong>after_teardown</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L855'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


855
856
857
858</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 855</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_teardown'>after_teardown</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>super</span>
  <span class='id identifier rubyid_teardown_fixtures'>teardown_fixtures</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="before_setup-instance_method">
  <h3 class='signature'>
  #<strong>before_setup</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L850'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


850
851
852
853</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 850</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_before_setup'>before_setup</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_setup_fixtures'>setup_fixtures</span>
  <span class='kw'>super</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="enlist_fixture_connections-instance_method">
  <h3 class='signature'>
  #<strong>enlist_fixture_connections</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L1031'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1031
1032
1033</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 1031</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_enlist_fixture_connections'>enlist_fixture_connections</span>
  <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="Base.html" title="ActiveRecord::Base (class)">Base</a></span><span class='period'>.</span><span class='id identifier rubyid_connection_handler'><a href="Core.html#connection_handler-instance_method" title="ActiveRecord::Core#connection_handler (method)">connection_handler</a></span><span class='period'>.</span><span class='id identifier rubyid_connection_pool_list'>connection_pool_list</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_connection'>connection</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="instantiate_fixtures-instance_method">
  <h3 class='signature'>
  #<strong>instantiate_fixtures</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L1041'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 1041</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_instantiate_fixtures'>instantiate_fixtures</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_pre_loaded_fixtures'>pre_loaded_fixtures</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Load fixtures before instantiating them.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="FixtureSet.html" title="ActiveRecord::FixtureSet (class)">FixtureSet</a></span><span class='period'>.</span><span class='id identifier rubyid_all_loaded_fixtures'>all_loaded_fixtures</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="FixtureSet.html" title="ActiveRecord::FixtureSet (class)">FixtureSet</a></span><span class='period'>.</span><span class='id identifier rubyid_instantiate_all_loaded_fixtures'><a href="FixtureSet.html#instantiate_all_loaded_fixtures-class_method" title="ActiveRecord::FixtureSet.instantiate_all_loaded_fixtures (method)">instantiate_all_loaded_fixtures</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_load_instances?'>load_instances?</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Load fixtures before instantiating them.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@loaded_fixtures</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='ivar'>@loaded_fixtures</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_fixture_set'>fixture_set</span><span class='op'>|</span>
      <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="FixtureSet.html" title="ActiveRecord::FixtureSet (class)">FixtureSet</a></span><span class='period'>.</span><span class='id identifier rubyid_instantiate_fixtures'><a href="FixtureSet.html#instantiate_fixtures-class_method" title="ActiveRecord::FixtureSet.instantiate_fixtures (method)">instantiate_fixtures</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_fixture_set'>fixture_set</span><span class='comma'>,</span> <span class='id identifier rubyid_load_instances?'>load_instances?</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="load_fixtures-instance_method">
  <h3 class='signature'>
  #<strong>load_fixtures</strong>(config)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L1036'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1036
1037
1038
1039</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 1036</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_load_fixtures'>load_fixtures</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fixtures'>fixtures</span> <span class='op'>=</span> <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="FixtureSet.html" title="ActiveRecord::FixtureSet (class)">FixtureSet</a></span><span class='period'>.</span><span class='id identifier rubyid_create_fixtures'><a href="FixtureSet.html#create_fixtures-class_method" title="ActiveRecord::FixtureSet.create_fixtures (method)">create_fixtures</a></span><span class='lparen'>(</span><span class='id identifier rubyid_fixture_path'>fixture_path</span><span class='comma'>,</span> <span class='id identifier rubyid_fixture_table_names'>fixture_table_names</span><span class='comma'>,</span> <span class='id identifier rubyid_fixture_class_names'>fixture_class_names</span><span class='comma'>,</span> <span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span><span class='lbracket'>[</span><span class='id identifier rubyid_fixtures'>fixtures</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="load_instances?-instance_method">
  <h3 class='signature'>
  #<strong>load_instances?</strong>  &#x21d2; <tt>Boolean</tt>  <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L1053'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1053
1054
1055</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 1053</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_load_instances?'>load_instances?</span>
  <span class='id identifier rubyid_use_instantiated_fixtures'>use_instantiated_fixtures</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_no_instances'>no_instances</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="run_in_transaction?-instance_method">
  <h3 class='signature'>
  #<strong>run_in_transaction?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L957'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


957
958
959
960</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 957</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_run_in_transaction?'>run_in_transaction?</span>
  <span class='id identifier rubyid_use_transactional_tests'>use_transactional_tests</span> <span class='op'>&amp;&amp;</span>
    <span class='op'>!</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_uses_transaction?'>uses_transaction?</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="setup_fixtures-instance_method">
  <h3 class='signature'>
  #<strong>setup_fixtures</strong>(config = ActiveRecord::Base)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L962'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 962</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_setup_fixtures'>setup_fixtures</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="Base.html" title="ActiveRecord::Base (class)">Base</a></span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_pre_loaded_fixtures'>pre_loaded_fixtures</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_use_transactional_tests'>use_transactional_tests</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pre_loaded_fixtures requires use_transactional_tests</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@fixture_cache</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@fixture_connections</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='cvar'>@@already_loaded_fixtures</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@connection_subscriber</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='comment'># Load fixtures once and begin transaction.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_run_in_transaction?'>run_in_transaction?</span>
    <span class='kw'>if</span> <span class='cvar'>@@already_loaded_fixtures</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rbracket'>]</span>
      <span class='ivar'>@loaded_fixtures</span> <span class='op'>=</span> <span class='cvar'>@@already_loaded_fixtures</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='ivar'>@loaded_fixtures</span> <span class='op'>=</span> <span class='id identifier rubyid_load_fixtures'>load_fixtures</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
      <span class='cvar'>@@already_loaded_fixtures</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@loaded_fixtures</span>
    <span class='kw'>end</span>

    <span class='comment'># Begin transactions for connections already established
</span>    <span class='ivar'>@fixture_connections</span> <span class='op'>=</span> <span class='id identifier rubyid_enlist_fixture_connections'>enlist_fixture_connections</span>
    <span class='ivar'>@fixture_connections</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_connection'>connection</span><span class='op'>|</span>
      <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_begin_transaction'>begin_transaction</span> <span class='label'>joinable:</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='comment'># When connections are established in the future, begin a transaction too
</span>    <span class='ivar'>@connection_subscriber</span> <span class='op'>=</span> <span class='const'><a href="../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../ActiveSupport/Notifications.html" title="ActiveSupport::Notifications (module)">Notifications</a></span><span class='period'>.</span><span class='id identifier rubyid_subscribe'><a href="../ActiveSupport/Notifications.html#subscribe-class_method" title="ActiveSupport::Notifications.subscribe (method)">subscribe</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>!connection.active_record</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_payload'>payload</span><span class='op'>|</span>
      <span class='id identifier rubyid_spec_name'>spec_name</span> <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_spec_name'>spec_name</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_spec_name'>spec_name</span><span class='rparen'>)</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_spec_name'>spec_name</span>
        <span class='kw'>begin</span>
          <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="Base.html" title="ActiveRecord::Base (class)">Base</a></span><span class='period'>.</span><span class='id identifier rubyid_connection_handler'><a href="Core.html#connection_handler-instance_method" title="ActiveRecord::Core#connection_handler (method)">connection_handler</a></span><span class='period'>.</span><span class='id identifier rubyid_retrieve_connection'>retrieve_connection</span><span class='lparen'>(</span><span class='id identifier rubyid_spec_name'>spec_name</span><span class='rparen'>)</span>
        <span class='kw'>rescue</span> <span class='const'><a href="ConnectionNotEstablished.html" title="ActiveRecord::ConnectionNotEstablished (class)">ConnectionNotEstablished</a></span>
          <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='kw'>nil</span>
        <span class='kw'>end</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_connection'>connection</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@fixture_connections</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_connection'>connection</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_begin_transaction'>begin_transaction</span> <span class='label'>joinable:</span> <span class='kw'>false</span>
          <span class='ivar'>@fixture_connections</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_connection'>connection</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='comment'># Load fixtures for every test.
</span>  <span class='kw'>else</span>
    <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="FixtureSet.html" title="ActiveRecord::FixtureSet (class)">FixtureSet</a></span><span class='period'>.</span><span class='id identifier rubyid_reset_cache'><a href="FixtureSet.html#reset_cache-class_method" title="ActiveRecord::FixtureSet.reset_cache (method)">reset_cache</a></span>
    <span class='cvar'>@@already_loaded_fixtures</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@loaded_fixtures</span> <span class='op'>=</span> <span class='id identifier rubyid_load_fixtures'>load_fixtures</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Instantiate fixtures for every test if requested.
</span>  <span class='id identifier rubyid_instantiate_fixtures'>instantiate_fixtures</span> <span class='kw'>if</span> <span class='id identifier rubyid_use_instantiated_fixtures'>use_instantiated_fixtures</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="teardown_fixtures-instance_method">
  <h3 class='signature'>
  #<strong>teardown_fixtures</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L1016'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/fixtures.rb', line 1016</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_teardown_fixtures'>teardown_fixtures</span>
  <span class='comment'># Rollback changes if a transaction is active.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_run_in_transaction?'>run_in_transaction?</span>
    <span class='const'><a href="../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../ActiveSupport/Notifications.html" title="ActiveSupport::Notifications (module)">Notifications</a></span><span class='period'>.</span><span class='id identifier rubyid_unsubscribe'><a href="../ActiveSupport/Notifications.html#unsubscribe-class_method" title="ActiveSupport::Notifications.unsubscribe (method)">unsubscribe</a></span><span class='lparen'>(</span><span class='ivar'>@connection_subscriber</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@connection_subscriber</span>
    <span class='ivar'>@fixture_connections</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_connection'>connection</span><span class='op'>|</span>
      <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_rollback_transaction'>rollback_transaction</span> <span class='kw'>if</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_transaction_open?'>transaction_open?</span>
    <span class='kw'>end</span>
    <span class='ivar'>@fixture_connections</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='kw'>else</span>
    <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="FixtureSet.html" title="ActiveRecord::FixtureSet (class)">FixtureSet</a></span><span class='period'>.</span><span class='id identifier rubyid_reset_cache'><a href="FixtureSet.html#reset_cache-class_method" title="ActiveRecord::FixtureSet.reset_cache (method)">reset_cache</a></span>
  <span class='kw'>end</span>

  <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="Base.html" title="ActiveRecord::Base (class)">Base</a></span><span class='period'>.</span><span class='id identifier rubyid_clear_active_connections!'>clear_active_connections!</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>