<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::Transactions::ClassMethods &mdash; Rails-5.1.0</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::Transactions::ClassMethods",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Rails-5.1.0</a> &raquo; 
          <a href='../../_index.html'>Index (C)</a> &raquo; 
          <a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <a href="../Transactions.html" title="ActiveRecord::Transactions (module)">Transactions</a> &raquo; 
          <span class='title'>ClassMethods</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActiveRecord::Transactions::ClassMethods</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L208'>activerecord/lib/active_record/transactions.rb</a></div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<h2 id="label-Active+Record+Transactions">Active Record Transactions</h2>

<p>Transactions are protective blocks where SQL statements are only permanent
if they can all succeed as one atomic action. The classic example is a
transfer between two accounts where you can only have a deposit if the
withdrawal succeeded and vice versa. Transactions enforce the integrity of
the database and guard the data against program errors or database
break-downs. So basically you should use transaction blocks whenever you
have a number of statements that must be executed together or not at all.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="../Base.html" title="ActiveRecord::Base (class)">Base</a></span><span class='period'>.</span><span class='id identifier rubyid_transaction'><a href="../Transactions.html#transaction-instance_method" title="ActiveRecord::Transactions#transaction (method)">transaction</a></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_david'>david</span><span class='period'>.</span><span class='id identifier rubyid_withdrawal'>withdrawal</span><span class='lparen'>(</span><span class='int'>100</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mary'>mary</span><span class='period'>.</span><span class='id identifier rubyid_deposit'>deposit</span><span class='lparen'>(</span><span class='int'>100</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</code></pre>

<p>This example will only take money from David and give it to Mary if neither
<code>withdrawal</code> nor <code>deposit</code> raise an exception.
Exceptions will force a ROLLBACK that returns the database to the state
before the transaction began. Be aware, though, that the objects will
<em>not</em> have their instance data returned to their pre-transactional
state.</p>

<h3 id="label-Different+Active+Record+classes+in+a+single+transaction">Different Active Record classes in a single transaction</h3>

<p>Though the <a href="#transaction-instance_method" title="ActiveRecord::Transactions::ClassMethods#transaction (method)">#transaction</a> class method is called on some Active Record
class, the objects within the transaction block need not all be instances
of that class. This is because transactions are per-database connection,
not per-model.</p>

<p>In this example a <code>balance</code> record is transactionally saved even
though <a href="#transaction-instance_method" title="ActiveRecord::Transactions::ClassMethods#transaction (method)">#transaction</a> is called on the <code>Account</code> class:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Account</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_balance'>balance</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
  <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
<span class='kw'>end</span>
</code></pre>

<p>The <a href="#transaction-instance_method" title="ActiveRecord::Transactions::ClassMethods#transaction (method)">#transaction</a> method is also available as a model instance method. For
example, you can also do this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_balance'>balance</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_balance'>balance</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
  <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
<span class='kw'>end</span>
</code></pre>

<h3 id="label-Transactions+are+not+distributed+across+database+connections">Transactions are not distributed across database connections</h3>

<p>A transaction acts on a single database connection. If you have multiple
class-specific databases, the transaction will not protect interaction
among them. One workaround is to begin a transaction on each class whose
models you alter:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Student</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
  <span class='const'>Course</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_course'>course</span><span class='period'>.</span><span class='id identifier rubyid_enroll'>enroll</span><span class='lparen'>(</span><span class='id identifier rubyid_student'>student</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_student'>student</span><span class='period'>.</span><span class='id identifier rubyid_units'>units</span> <span class='op'>+=</span> <span class='id identifier rubyid_course'>course</span><span class='period'>.</span><span class='id identifier rubyid_units'>units</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>This is a poor solution, but fully distributed transactions are beyond the
scope of Active Record.</p>

<h3 id="label-save+and+destroy+are+automatically+wrapped+in+a+transaction"><code>save</code> and <code>destroy</code> are automatically wrapped in a transaction</h3>

<p>Both <a href="../Transactions.html#save-instance_method" title="ActiveRecord::Transactions#save (method)">#save</a>[Persistence#save] and <a href="../Transactions.html#destroy-instance_method" title="ActiveRecord::Transactions#destroy (method)">#destroy</a>[Persistence#destroy] come
wrapped in a transaction that ensures that whatever you do in validations
or callbacks will happen under its protected cover. So you can use
validations to check for values that the transaction depends on or you can
raise exceptions in the callbacks to rollback, including
<code>after_*</code> callbacks.</p>

<p>As a consequence changes to the database are not seen outside your
connection until the operation is complete. For example, if you try to
update the index of a search engine in <code>after_save</code> the indexer
won&#39;t see the updated record. The <a href="#after_commit-instance_method" title="ActiveRecord::Transactions::ClassMethods#after_commit (method)">#after_commit</a> callback is the only
one that is triggered once the update is committed. See below.</p>

<h3 id="label-Exception+handling+and+rolling+back">Exception handling and rolling back</h3>

<p>Also have in mind that exceptions thrown within a transaction block will be
propagated (after triggering the ROLLBACK), so you should be ready to catch
those in your application code.</p>

<p>One exception is the <a href="../Rollback.html" title="ActiveRecord::Rollback (class)">Rollback</a> exception, which will trigger
a ROLLBACK when raised, but not be re-raised by the transaction block.</p>

<p><strong>Warning</strong>: one should not catch
<a href="../StatementInvalid.html" title="ActiveRecord::StatementInvalid (class)">StatementInvalid</a> exceptions inside a transaction block.
<a href="../StatementInvalid.html" title="ActiveRecord::StatementInvalid (class)">StatementInvalid</a> exceptions indicate that an error occurred
at the database level, for example when a unique constraint is violated. On
some database systems, such as PostgreSQL, database errors inside a
transaction cause the entire transaction to become unusable until it&#39;s
restarted from the beginning. Here is an example which demonstrates the
problem:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Suppose that we have a Number model with a unique column called &#39;i&#39;.
</span><span class='const'>Number</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
  <span class='const'>Number</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>i:</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='comment'># This will raise a unique constraint error...
</span>    <span class='const'>Number</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>i:</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="../StatementInvalid.html" title="ActiveRecord::StatementInvalid (class)">StatementInvalid</a></span>
    <span class='comment'># ...which we ignore.
</span>  <span class='kw'>end</span>

  <span class='comment'># On PostgreSQL, the transaction is now unusable. The following
</span>  <span class='comment'># statement will cause a PostgreSQL error, even though the unique
</span>  <span class='comment'># constraint is no longer violated:
</span>  <span class='const'>Number</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>i:</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='comment'># =&gt; &quot;PGError: ERROR:  current transaction is aborted, commands
</span>  <span class='comment'>#     ignored until end of transaction block&quot;
</span><span class='kw'>end</span>
</code></pre>

<p>One should restart the entire transaction if an
<a href="../StatementInvalid.html" title="ActiveRecord::StatementInvalid (class)">StatementInvalid</a> occurred.</p>

<h3 id="label-Nested+transactions">Nested transactions</h3>

<p><a href="#transaction-instance_method" title="ActiveRecord::Transactions::ClassMethods#transaction (method)">#transaction</a> calls can be nested. By default, this makes all database
statements in the nested transaction block become part of the parent
transaction. For example, the following behavior may be surprising:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
  <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>username:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Kotori</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
    <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>username:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nemu</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="../Rollback.html" title="ActiveRecord::Rollback (class)">Rollback</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>creates both “Kotori” and “Nemu”. Reason is the <a href="../Rollback.html" title="ActiveRecord::Rollback (class)">Rollback</a>
exception in the nested block does not issue a ROLLBACK. Since these
exceptions are captured in transaction blocks, the parent block does not
see it and the real transaction is committed.</p>

<p>In order to get a ROLLBACK for the nested transaction you may ask for a
real sub-transaction by passing <code>requires_new: true</code>. If
anything goes wrong, the database rolls back to the beginning of the
sub-transaction without rolling back the parent transaction. If we add it
to the previous example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
  <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>username:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Kotori</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span><span class='lparen'>(</span><span class='label'>requires_new:</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>username:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nemu</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="../Rollback.html" title="ActiveRecord::Rollback (class)">Rollback</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>only “Kotori” is created. This works on MySQL and PostgreSQL. SQLite3
version &gt;= &#39;3.6.8&#39; also supports it.</p>

<p>Most databases don&#39;t support true nested transactions. At the time of
writing, the only database that we&#39;re aware of that supports true
nested transactions, is MS-SQL. Because of this, Active Record emulates
nested transactions by using savepoints on MySQL and PostgreSQL. See <a
href="http://dev.mysql.com/doc/refman/5.7/en/savepoint.html">dev.mysql.com/doc/refman/5.7/en/savepoint.html</a>
for more information about savepoints.</p>

<h4 id="label-Callbacks">Callbacks</h4>

<p>There are two types of callbacks associated with committing and rolling
back transactions: <a href="#after_commit-instance_method" title="ActiveRecord::Transactions::ClassMethods#after_commit (method)">#after_commit</a> and <a href="#after_rollback-instance_method" title="ActiveRecord::Transactions::ClassMethods#after_rollback (method)">#after_rollback</a>.</p>

<p><a href="#after_commit-instance_method" title="ActiveRecord::Transactions::ClassMethods#after_commit (method)">#after_commit</a> callbacks are called on every record saved or destroyed
within a transaction immediately after the transaction is committed.
<a href="#after_rollback-instance_method" title="ActiveRecord::Transactions::ClassMethods#after_rollback (method)">#after_rollback</a> callbacks are called on every record saved or destroyed
within a transaction immediately after the transaction or savepoint is
rolled back.</p>

<p>These callbacks are useful for interacting with other systems since you
will be guaranteed that the callback is only executed when the database is
in a permanent state. For example, <a href="#after_commit-instance_method" title="ActiveRecord::Transactions::ClassMethods#after_commit (method)">#after_commit</a> is a good spot to put in
a hook to clearing a cache since clearing it from within a transaction
could trigger the cache to be regenerated before the database is updated.</p>

<h4 id="label-Caveats">Caveats</h4>

<p>If you&#39;re on MySQL, then do not use Data Definition Language(DDL)
operations in nested transactions blocks that are emulated with savepoints.
That is, do not execute statements like &#39;CREATE TABLE&#39; inside such
blocks. This is because MySQL automatically releases all savepoints upon
executing a DDL operation. When <code>transaction</code> is finished and
tries to release the savepoint it created earlier, a database error will
occur because the savepoint has already been automatically released. The
following example demonstrates the problem:</p>

<pre class="code ruby"><code class="ruby">Model.connection.transaction do                           # BEGIN
  Model.connection.transaction(requires_new: true) do     # CREATE SAVEPOINT active_record_1
    Model.connection.create_table(...)                    # active_record_1 now automatically released
  end                                                     # RELEASE SAVEPOINT active_record_1
                                                          # ^^^^ BOOM! database error!
end</code></pre>

<p>Note that “TRUNCATE” is also a MySQL DDL statement!</p>


  </div>
</div>
<div class="tags">
  
</div>




<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#after_commit-instance_method" title="#after_commit (instance method)">#<strong>after_commit</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>This callback is called after a record has been created, updated, or
destroyed.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#after_commit_without_transaction_enrollment-instance_method" title="#after_commit_without_transaction_enrollment (instance method)">#<strong>after_commit_without_transaction_enrollment</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#after_create_commit-instance_method" title="#after_create_commit (instance method)">#<strong>after_create_commit</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Shortcut for <code>after_commit :hook, on: :create</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#after_destroy_commit-instance_method" title="#after_destroy_commit (instance method)">#<strong>after_destroy_commit</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Shortcut for <code>after_commit :hook, on: :destroy</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#after_rollback-instance_method" title="#after_rollback (instance method)">#<strong>after_rollback</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>This callback is called after a create, update, or destroy are rolled back.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#after_rollback_without_transaction_enrollment-instance_method" title="#after_rollback_without_transaction_enrollment (instance method)">#<strong>after_rollback_without_transaction_enrollment</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#after_update_commit-instance_method" title="#after_update_commit (instance method)">#<strong>after_update_commit</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Shortcut for <code>after_commit :hook, on: :update</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#assert_valid_transaction_action-instance_method" title="#assert_valid_transaction_action (instance method)">#<strong>assert_valid_transaction_action</strong>(actions)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#before_commit-instance_method" title="#before_commit (instance method)">#<strong>before_commit</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#before_commit_without_transaction_enrollment-instance_method" title="#before_commit_without_transaction_enrollment (instance method)">#<strong>before_commit_without_transaction_enrollment</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#raise_in_transactional_callbacks-instance_method" title="#raise_in_transactional_callbacks (instance method)">#<strong>raise_in_transactional_callbacks</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#raise_in_transactional_callbacks%3D-instance_method" title="#raise_in_transactional_callbacks= (instance method)">#<strong>raise_in_transactional_callbacks=</strong>(value)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#set_options_for_callbacks%21-instance_method" title="#set_options_for_callbacks! (instance method)">#<strong>set_options_for_callbacks!</strong>(args, enforced_options = {})  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#transaction-instance_method" title="#transaction (instance method)">#<strong>transaction</strong>(options = {}, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>See the <a href="../ConnectionAdapters/DatabaseStatements.html#transaction-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#transaction (method)">ConnectionAdapters::DatabaseStatements#transaction</a> API docs.</p>
</div>
      </span>
    </li>
  </ul>


<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="after_commit-instance_method">
  <h3 class='signature first'>
  #<strong>after_commit</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>This callback is called after a record has been created, updated, or
destroyed.</p>

<p>You can specify that the callback should only be fired by a certain action
with the <code>:on</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_after_commit'>after_commit</span> <span class='symbeg'>:</span><span class='id identifier rubyid_do_foo'>do_foo</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_create'>create</span>
<span class='id identifier rubyid_after_commit'>after_commit</span> <span class='symbeg'>:</span><span class='id identifier rubyid_do_bar'>do_bar</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_update'>update</span>
<span class='id identifier rubyid_after_commit'>after_commit</span> <span class='symbeg'>:</span><span class='id identifier rubyid_do_baz'>do_baz</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span>

<span class='id identifier rubyid_after_commit'>after_commit</span> <span class='symbeg'>:</span><span class='id identifier rubyid_do_foo_bar'>do_foo_bar</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_create'>create</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_update'>update</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_after_commit'>after_commit</span> <span class='symbeg'>:</span><span class='id identifier rubyid_do_bar_baz'>do_bar_baz</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span><span class='rbracket'>]</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L231'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


231
232
233
234</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 231</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_commit'>after_commit</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_commit'>commit</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="after_commit_without_transaction_enrollment-instance_method">
  <h3 class='signature'>
  #<strong>after_commit_without_transaction_enrollment</strong>(*args, &amp;block)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L267'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


267
268
269
270</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 267</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_commit_without_transaction_enrollment'>after_commit_without_transaction_enrollment</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_commit_without_transaction_enrollment'>commit_without_transaction_enrollment</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="after_create_commit-instance_method">
  <h3 class='signature'>
  #<strong>after_create_commit</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Shortcut for <code>after_commit :hook, on: :create</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L237'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


237
238
239
240</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 237</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_create_commit'>after_create_commit</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_create'>create</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_commit'>commit</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="after_destroy_commit-instance_method">
  <h3 class='signature'>
  #<strong>after_destroy_commit</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Shortcut for <code>after_commit :hook, on: :destroy</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L249'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


249
250
251
252</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 249</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_destroy_commit'>after_destroy_commit</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destroy'>destroy</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_commit'>commit</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="after_rollback-instance_method">
  <h3 class='signature'>
  #<strong>after_rollback</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>This callback is called after a create, update, or destroy are rolled back.</p>

<p>Please check the documentation of <a href="#after_commit-instance_method" title="ActiveRecord::Transactions::ClassMethods#after_commit (method)">#after_commit</a> for options.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L257'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


257
258
259
260</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 257</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_rollback'>after_rollback</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_rollback'>rollback</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="after_rollback_without_transaction_enrollment-instance_method">
  <h3 class='signature'>
  #<strong>after_rollback_without_transaction_enrollment</strong>(*args, &amp;block)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L272'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


272
273
274
275</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 272</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_rollback_without_transaction_enrollment'>after_rollback_without_transaction_enrollment</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_rollback_without_transaction_enrollment'>rollback_without_transaction_enrollment</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="after_update_commit-instance_method">
  <h3 class='signature'>
  #<strong>after_update_commit</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Shortcut for <code>after_commit :hook, on: :update</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L243'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


243
244
245
246</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 243</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_update_commit'>after_update_commit</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_update'>update</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_commit'>commit</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="assert_valid_transaction_action-instance_method">
  <h3 class='signature'>
  #<strong>assert_valid_transaction_action</strong>(actions)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L301'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


301
302
303
304
305</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 301</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_valid_transaction_action'>assert_valid_transaction_action</span><span class='lparen'>(</span><span class='id identifier rubyid_actions'>actions</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_actions'>actions</span> <span class='op'>-</span> <span class='const'><a href="../Transactions.html#ACTIONS-constant" title="ActiveRecord::Transactions::ACTIONS (constant)">ACTIONS</a></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:on conditions for after_commit and after_rollback callbacks have to be one of </span><span class='embexpr_beg'>#{</span><span class='const'><a href="../Transactions.html#ACTIONS-constant" title="ActiveRecord::Transactions::ACTIONS (constant)">ACTIONS</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="before_commit-instance_method">
  <h3 class='signature'>
  #<strong>before_commit</strong>(*args, &amp;block)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L214'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


214
215
216
217</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 214</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_before_commit'>before_commit</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_before_commit'>before_commit</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_before'>before</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="before_commit_without_transaction_enrollment-instance_method">
  <h3 class='signature'>
  #<strong>before_commit_without_transaction_enrollment</strong>(*args, &amp;block)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L262'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


262
263
264
265</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 262</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_before_commit_without_transaction_enrollment'>before_commit_without_transaction_enrollment</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_callback'>set_callback</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_before_commit_without_transaction_enrollment'>before_commit_without_transaction_enrollment</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_before'>before</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="raise_in_transactional_callbacks-instance_method">
  <h3 class='signature'>
  #<strong>raise_in_transactional_callbacks</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L277'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


277
278
279
280</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 277</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_raise_in_transactional_callbacks'>raise_in_transactional_callbacks</span>
  <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)">Deprecation</a></span><span class='period'>.</span><span class='id identifier rubyid_warn'><a href="../../ActiveSupport/Deprecation/Reporting.html#warn-instance_method" title="ActiveSupport::Deprecation::Reporting#warn (method)">warn</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ActiveRecord::Base.raise_in_transactional_callbacks is deprecated and will be removed without replacement.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="raise_in_transactional_callbacks=-instance_method">
  <h3 class='signature'>
  #<strong>raise_in_transactional_callbacks=</strong>(value)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L282'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


282
283
284
285</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 282</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_raise_in_transactional_callbacks='>raise_in_transactional_callbacks=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)">Deprecation</a></span><span class='period'>.</span><span class='id identifier rubyid_warn'><a href="../../ActiveSupport/Deprecation/Reporting.html#warn-instance_method" title="ActiveSupport::Deprecation::Reporting#warn (method)">warn</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ActiveRecord::Base.raise_in_transactional_callbacks= is deprecated, has no effect and will be removed without replacement.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="set_options_for_callbacks!-instance_method">
  <h3 class='signature'>
  #<strong>set_options_for_callbacks!</strong>(args, enforced_options = {})   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L289'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


289
290
291
292
293
294
295
296
297
298
299</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 289</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_options_for_callbacks!'>set_options_for_callbacks!</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_enforced_options'>enforced_options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_extract_options!'>extract_options!</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_enforced_options'>enforced_options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_options'>options</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_on'>on</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_fire_on'>fire_on</span> <span class='op'>=</span> <span class='const'><a href="../../Array.html" title="Array (class)">Array</a></span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_on'>on</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_valid_transaction_action'>assert_valid_transaction_action</span><span class='lparen'>(</span><span class='id identifier rubyid_fire_on'>fire_on</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='kw'>if</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><a href="../../Array.html" title="Array (class)">Array</a></span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='kw'>if</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='kw'>if</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>transaction_include_any_action?(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_fire_on'>fire_on</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="transaction-instance_method">
  <h3 class='signature'>
  #<strong>transaction</strong>(options = {}, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>See the <a href="../ConnectionAdapters/DatabaseStatements.html#transaction-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#transaction (method)">ConnectionAdapters::DatabaseStatements#transaction</a> API docs.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/transactions.rb#L210'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


210
211
212</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/transactions.rb', line 210</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_transaction'>transaction</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>