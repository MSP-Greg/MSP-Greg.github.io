<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::Inheritance::ClassMethods &mdash; Rails-5.1.0</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::Inheritance::ClassMethods",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Rails-5.1.0</a> &raquo; 
          <a href='../../_index.html'>Index (C)</a> &raquo; 
          <a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
          <a href="../Inheritance.html" title="ActiveRecord::Inheritance (module)">Inheritance</a> &raquo; 
          <span class='title'>ClassMethods</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='module'>

<h1>Module: ActiveRecord::Inheritance::ClassMethods</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L45'>activerecord/lib/active_record/inheritance.rb</a></div>  </td>
  </tr>
</table>



<h2>Instance Attribute Summary <small><a href='#' class='summary_toggle'>collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#abstract_class-instance_method" title="#abstract_class (instance method)">#<strong>abstract_class</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Set this to true if this is an abstract class (see
<code>abstract_class?</code>).</p>
</div>
      </span>
    </li>
  </ul>


<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#abstract_class%3F-instance_method" title="#abstract_class? (instance method)">#<strong>abstract_class?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns whether this class is an abstract class or not.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#base_class-instance_method" title="#base_class (instance method)">#<strong>base_class</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the class descending directly from <a href="../Base.html" title="ActiveRecord::Base (class)">Base</a>, or an
abstract class, if any, in the inheritance hierarchy.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#compute_type-instance_method" title="#compute_type (instance method)">#<strong>compute_type</strong>(type_name)  </a>
      </span>
      <span class='note title protected'>protected</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns the class type of the record using the current module as a prefix.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#descends_from_active_record%3F-instance_method" title="#descends_from_active_record? (instance method)">#<strong>descends_from_active_record?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Returns <code>true</code> if this does not need STI type condition.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#discriminate_class_for_record-instance_method" title="#discriminate_class_for_record (instance method)">#<strong>discriminate_class_for_record</strong>(record)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Called by <code>instantiate</code> to decide which class to use for a new
record instance.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#find_sti_class-instance_method" title="#find_sti_class (instance method)">#<strong>find_sti_class</strong>(type_name)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#finder_needs_type_condition%3F-instance_method" title="#finder_needs_type_condition? (instance method)">#<strong>finder_needs_type_condition?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new-instance_method" title="#new (instance method)">#<strong>new</strong>(*args, &amp;block)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Determines if one of the attributes passed in is the inheritance column,
and if the inheritance column is attr accessible, it initializes an
instance of the given subclass instead of the base class.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#sti_name-instance_method" title="#sti_name (instance method)">#<strong>sti_name</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#subclass_from_attributes-instance_method" title="#subclass_from_attributes (instance method)">#<strong>subclass_from_attributes</strong>(attrs)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Detect the subclass from the inheritance column of attrs.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#type_condition-instance_method" title="#type_condition (instance method)">#<strong>type_condition</strong>(table = arel_table)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#using_single_table_inheritance%3F-instance_method" title="#using_single_table_inheritance? (instance method)">#<strong>using_single_table_inheritance?</strong>(record)  &#x21d2; Boolean </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
  </ul>


<h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="abstract_class-instance_method">
  <h3 class='signature first'>
  #<strong>abstract_class</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Set this to true if this is an abstract class (see
<code>abstract_class?</code>). If you are using inheritance with
ActiveRecord and don&#39;t want child classes to utilize the implied STI
table name of the parent class, this will need to be true. For example,
given the following:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>SuperClass</span> <span class='op'>&lt;</span> <span class='const'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="../Base.html" title="ActiveRecord::Base (class)">Base</a></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_abstract_class'>abstract_class</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
<span class='kw'>class</span> <span class='const'>Child</span> <span class='op'>&lt;</span> <span class='const'>SuperClass</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_table_name'>table_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>the_table_i_really_want</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</code></pre>

<p><code>self.abstract_class = true</code> is required to make
<code>Child&lt;.find,.create, or any Arel method&gt;</code> use
<code>the_table_i_really_want</code> instead of a table called
<code>super_classes</code></p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L122'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


122</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 122</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_abstract_class'>abstract_class</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="abstract_class?-instance_method">
  <h3 class='signature first'>
  #<strong>abstract_class?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns whether this class is an abstract class or not.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L125'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


125
126
127</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 125</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_abstract_class?'>abstract_class?</span>
  <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@abstract_class</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@abstract_class</span> <span class='op'>==</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="base_class-instance_method">
  <h3 class='signature'>
  #<strong>base_class</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the class descending directly from <a href="../Base.html" title="ActiveRecord::Base (class)">Base</a>, or an
abstract class, if any, in the inheritance hierarchy.</p>

<p>If A extends <a href="../Base.html" title="ActiveRecord::Base (class)">Base</a>, A.base_class will return A. If B
descends from A through some arbitrarily deep hierarchy, B.base_class will
return A.</p>

<p>If B &lt; A and C &lt; B and if A is an abstract_class then both
B.base_class and C.base_class would return B as the answer since A is an
abstract_class.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L95'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


95
96
97
98
99
100
101
102
103
104
105</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 95</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_base_class'>base_class</span>
  <span class='kw'>unless</span> <span class='kw'>self</span> <span class='op'>&lt;</span> <span class='const'><a href="../Base.html" title="ActiveRecord::Base (class)">Base</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> doesn&#39;t belong in a hierarchy descending from ActiveRecord</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>==</span> <span class='const'><a href="../Base.html" title="ActiveRecord::Base (class)">Base</a></span> <span class='op'>||</span> <span class='id identifier rubyid_superclass'>superclass</span><span class='period'>.</span><span class='id identifier rubyid_abstract_class?'>abstract_class?</span>
    <span class='kw'>self</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_superclass'>superclass</span><span class='period'>.</span><span class='id identifier rubyid_base_class'>base_class</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="compute_type-instance_method">
  <h3 class='signature'>
  #<strong>compute_type</strong>(type_name)   <span class="extras">(<span class='prot'>protected</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns the class type of the record using the current module as a prefix.
So descendants of <code>MyApp::Business::Account</code> would appear as
<code>MyApp::Business::AccountSubclass</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L137'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 137</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_compute_type'>compute_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type_name'>type_name</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_type_name'>type_name</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^::</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
    <span class='comment'># If the type is prefixed with a scope operator then we assume that
</span>    <span class='comment'># the type_name is an absolute reference.
</span>    <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/Dependencies.html" title="ActiveSupport::Dependencies (module)">Dependencies</a></span><span class='period'>.</span><span class='id identifier rubyid_constantize'><a href="../../ActiveSupport/Dependencies.html#constantize-instance_method" title="ActiveSupport::Dependencies#constantize (method)">constantize</a></span><span class='lparen'>(</span><span class='id identifier rubyid_type_name'>type_name</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='comment'># Build a list of candidates to search for
</span>    <span class='id identifier rubyid_candidates'>candidates</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>::|$</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_candidates'>candidates</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='backref'>$`</span><span class='embexpr_end'>}</span><span class='tstring_content'>::</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type_name'>type_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_candidates'>candidates</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_type_name'>type_name</span>

    <span class='id identifier rubyid_candidates'>candidates</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_candidate'>candidate</span><span class='op'>|</span>
      <span class='id identifier rubyid_constant'>constant</span> <span class='op'>=</span> <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/Dependencies.html" title="ActiveSupport::Dependencies (module)">Dependencies</a></span><span class='period'>.</span><span class='id identifier rubyid_safe_constantize'><a href="../../ActiveSupport/Dependencies.html#safe_constantize-instance_method" title="ActiveSupport::Dependencies#safe_constantize (method)">safe_constantize</a></span><span class='lparen'>(</span><span class='id identifier rubyid_candidate'>candidate</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_constant'>constant</span> <span class='kw'>if</span> <span class='id identifier rubyid_candidate'>candidate</span> <span class='op'>==</span> <span class='id identifier rubyid_constant'>constant</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../../NameError.html" title="NameError (class)">NameError</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uninitialized constant </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_candidates'>candidates</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_candidates'>candidates</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="descends_from_active_record?-instance_method">
  <h3 class='signature'>
  #<strong>descends_from_active_record?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Returns <code>true</code> if this does not need STI type condition. Returns
<code>false</code> if STI type condition needs to be applied.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L72'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


72
73
74
75
76
77
78
79
80</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 72</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_descends_from_active_record?'>descends_from_active_record?</span>
  <span class='kw'>if</span> <span class='kw'>self</span> <span class='op'>==</span> <span class='const'><a href="../Base.html" title="ActiveRecord::Base (class)">Base</a></span>
    <span class='kw'>false</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_superclass'>superclass</span><span class='period'>.</span><span class='id identifier rubyid_abstract_class?'>abstract_class?</span>
    <span class='id identifier rubyid_superclass'>superclass</span><span class='period'>.</span><span class='id identifier rubyid_descends_from_active_record?'>descends_from_active_record?</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>==</span> <span class='const'><a href="../Base.html" title="ActiveRecord::Base (class)">Base</a></span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_columns_hash'>columns_hash</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="discriminate_class_for_record-instance_method">
  <h3 class='signature'>
  #<strong>discriminate_class_for_record</strong>(record)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Called by <code>instantiate</code> to decide which class to use for a new
record instance. For single-table inheritance, we check the record for a
<code>type</code> column and return the corresponding class.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L162'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


162
163
164
165
166
167
168</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 162</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_discriminate_class_for_record'>discriminate_class_for_record</span><span class='lparen'>(</span><span class='id identifier rubyid_record'>record</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_using_single_table_inheritance?'>using_single_table_inheritance?</span><span class='lparen'>(</span><span class='id identifier rubyid_record'>record</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_find_sti_class'>find_sti_class</span><span class='lparen'>(</span><span class='id identifier rubyid_record'>record</span><span class='lbracket'>[</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="find_sti_class-instance_method">
  <h3 class='signature'>
  #<strong>find_sti_class</strong>(type_name)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L174'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 174</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_find_sti_class'>find_sti_class</span><span class='lparen'>(</span><span class='id identifier rubyid_type_name'>type_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_type_name'>type_name</span> <span class='op'>=</span> <span class='id identifier rubyid_base_class'>base_class</span><span class='period'>.</span><span class='id identifier rubyid_type_for_attribute'>type_for_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cast'>cast</span><span class='lparen'>(</span><span class='id identifier rubyid_type_name'>type_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_subclass'>subclass</span> <span class='op'>=</span> <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_store_full_sti_class'>store_full_sti_class</span>
      <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/Dependencies.html" title="ActiveSupport::Dependencies (module)">Dependencies</a></span><span class='period'>.</span><span class='id identifier rubyid_constantize'><a href="../../ActiveSupport/Dependencies.html#constantize-instance_method" title="ActiveSupport::Dependencies#constantize (method)">constantize</a></span><span class='lparen'>(</span><span class='id identifier rubyid_type_name'>type_name</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_compute_type'>compute_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type_name'>type_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'><a href="../../NameError.html" title="NameError (class)">NameError</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SubclassNotFound.html" title="ActiveRecord::SubclassNotFound (class)">SubclassNotFound</a></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The single-table inheritance mechanism failed to locate the subclass: &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type_name'>type_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;. </span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This error is raised because the column &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; is reserved for storing the class in case of inheritance. </span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Please rename this column if you didn&#39;t intend it to be used for storing the inheritance class </span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>or overwrite </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.inheritance_column to use another column for that information.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_subclass'>subclass</span> <span class='op'>==</span> <span class='kw'>self</span> <span class='op'>||</span> <span class='id identifier rubyid_descendants'>descendants</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_subclass'>subclass</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../SubclassNotFound.html" title="ActiveRecord::SubclassNotFound (class)">SubclassNotFound</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid single-table inheritance type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subclass'>subclass</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a subclass of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_subclass'>subclass</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="finder_needs_type_condition?-instance_method">
  <h3 class='signature'>
  #<strong>finder_needs_type_condition?</strong>  &#x21d2; <tt>Boolean</tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L82'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


82
83
84
85</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 82</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_finder_needs_type_condition?'>finder_needs_type_condition?</span> <span class='comment'>#:nodoc:
</span>  <span class='comment'># This is like this because benchmarking justifies the strange :false stuff
</span>  <span class='symbeg'>:</span><span class='kw'>true</span> <span class='op'>==</span> <span class='lparen'>(</span><span class='ivar'>@finder_needs_type_condition</span> <span class='op'>||=</span> <span class='id identifier rubyid_descends_from_active_record?'>descends_from_active_record?</span> <span class='op'>?</span> <span class='symbeg'>:</span><span class='kw'>false</span> <span class='op'>:</span> <span class='symbeg'>:</span><span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="new-instance_method">
  <h3 class='signature'>
  #<strong>new</strong>(*args, &amp;block)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Determines if one of the attributes passed in is the inheritance column,
and if the inheritance column is attr accessible, it initializes an
instance of the given subclass instead of the base class.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L49'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 49</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_abstract_class?'>abstract_class?</span> <span class='op'>||</span> <span class='kw'>self</span> <span class='op'>==</span> <span class='const'><a href="../Base.html" title="ActiveRecord::Base (class)">Base</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='embexpr_end'>}</span><span class='tstring_content'> is an abstract class and cannot be instantiated.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_has_attribute?'>has_attribute?</span><span class='lparen'>(</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_subclass'>subclass</span> <span class='op'>=</span> <span class='id identifier rubyid_subclass_from_attributes'>subclass_from_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_subclass'>subclass</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_base_class'>base_class</span> <span class='op'>==</span> <span class='kw'>self</span>
      <span class='id identifier rubyid_subclass'>subclass</span> <span class='op'>=</span> <span class='id identifier rubyid_subclass_from_attributes'>subclass_from_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_column_defaults'>column_defaults</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_subclass'>subclass</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_subclass'>subclass</span> <span class='op'>!=</span> <span class='kw'>self</span>
    <span class='id identifier rubyid_subclass'>subclass</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="sti_name-instance_method">
  <h3 class='signature'>
  #<strong>sti_name</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L129'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


129
130
131</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 129</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_sti_name'>sti_name</span>
  <span class='id identifier rubyid_store_full_sti_class'>store_full_sti_class</span> <span class='op'>?</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>:</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_demodulize'>demodulize</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="subclass_from_attributes-instance_method">
  <h3 class='signature'>
  #<strong>subclass_from_attributes</strong>(attrs)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Detect the subclass from the inheritance column of attrs. If the
inheritance column value is not self or a valid subclass, raises
<a href="../SubclassNotFound.html" title="ActiveRecord::SubclassNotFound (class)">SubclassNotFound</a></p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L204'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


204
205
206
207
208
209
210
211
212
213</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 204</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_subclass_from_attributes'>subclass_from_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span> <span class='kw'>if</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_permitted?'>permitted?</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><a href="../../Hash.html" title="Hash (class)">Hash</a></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_subclass_name'>subclass_name</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span><span class='lbracket'>[</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_subclass_name'>subclass_name</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
      <span class='id identifier rubyid_find_sti_class'>find_sti_class</span><span class='lparen'>(</span><span class='id identifier rubyid_subclass_name'>subclass_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="type_condition-instance_method">
  <h3 class='signature'>
  #<strong>type_condition</strong>(table = arel_table)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L195'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


195
196
197
198
199
200</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 195</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_type_condition'>type_condition</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span> <span class='op'>=</span> <span class='id identifier rubyid_arel_table'>arel_table</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sti_column'>sti_column</span> <span class='op'>=</span> <span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='comma'>,</span> <span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sti_names'>sti_names</span>  <span class='op'>=</span> <span class='lparen'>(</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_descendants'>descendants</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_sti_name'>sti_name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_sti_column'>sti_column</span><span class='period'>.</span><span class='id identifier rubyid_in'>in</span><span class='lparen'>(</span><span class='id identifier rubyid_sti_names'>sti_names</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="using_single_table_inheritance?-instance_method">
  <h3 class='signature'>
  #<strong>using_single_table_inheritance?</strong>(record)  &#x21d2; <tt>Boolean</tt>  <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/inheritance.rb#L170'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


170
171
172</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/inheritance.rb', line 170</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_using_single_table_inheritance?'>using_single_table_inheritance?</span><span class='lparen'>(</span><span class='id identifier rubyid_record'>record</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_record'>record</span><span class='lbracket'>[</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_has_attribute?'>has_attribute?</span><span class='lparen'>(</span><span class='id identifier rubyid_inheritance_column'>inheritance_column</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>