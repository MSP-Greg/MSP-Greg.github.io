<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActionCable::Connection::Base &mdash; Rails-5.1.0</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActionCable::Connection::Base",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Rails-5.1.0</a> &raquo; 
          <a href='../../_index.html'>Index (B)</a> &raquo; 
          <a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a> &raquo; 
          <a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a> &raquo; 
          <span class='title'>Base</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: ActionCable::Connection::Base</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'><a href="../../Object.html" title="Object (class)">Object</a></span>
      <ul class='fullTree'>
        <li><a href="../../Object.html" title="Object (class)">Object</a></li>
        <li class='next'>ActionCable::Connection::Base</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Includes:</td>
    <td>
      <div class='box_max'>
        <a href="Authorization.html" title="ActionCable::Connection::Authorization (module)">Authorization</a>, <a href="Identification.html" title="ActionCable::Connection::Identification (module)">Identification</a>, <a href="InternalChannel.html" title="ActionCable::Connection::InternalChannel (module)">InternalChannel</a>
      </div>
    </td>
  </tr>
  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_max'>
<a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L46'>actioncable/lib/action_cable/connection/base.rb</a></div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>For every WebSocket connection the Action Cable server accepts, a
Connection object will be instantiated. This instance becomes the parent of
all of the channel subscriptions that are created from there on. Incoming
messages are then routed to these channel subscriptions based on an
identifier sent by the Action Cable consumer. The Connection itself does
not deal with any specific application logic beyond authentication and
authorization.</p>

<p>Here&#39;s a basic example:</p>

<pre class="code ruby"><code class="ruby">module ApplicationCable
  class Connection &lt; ActionCable::Connection::Base
    identified_by :current_user

    def connect
      self.current_user = find_verified_user
      logger.add_tags current_user.name
    end

    def disconnect
      # Any cleanup work needed when the cable connection is cut.
    end

    protected
      def find_verified_user
        if current_user = User.find_by_identity cookies.signed[:identity_id]
          current_user
        else
          reject_unauthorized_connection
        end
      end
  end
end</code></pre>

<p>First, we declare that this connection can be identified by its
current_user. This allows us to later be able to find all connections
established for that current_user (and potentially disconnect them). You
can declare as many identification indexes as you like. Declaring an
identification means that an attr_accessor is automatically set for that
key.</p>

<p>Second, we rely on the fact that the WebSocket connection is established
with the cookies from the domain being sent along. This makes it easy to
use signed cookies that were set when logging in via a web interface to
authorize the WebSocket connection.</p>

<p>Finally, we add a tag to the connection-specific logger with the name of
the current user to easily distinguish their messages in the log.</p>

<p>Pretty simple, eh?</p>


  </div>
</div>
<div class="tags">
  
</div>


<h2>Instance Attribute Summary <small><a href='#' class='summary_toggle'>collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#env-instance_method" title="#env (instance method)">#<strong>env</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#message_buffer-instance_method" title="#message_buffer (instance method)">#<strong>message_buffer</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='note title protected'>protected</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#protocol-instance_method" title="#protocol (instance method)">#<strong>protocol</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#server-instance_method" title="#server (instance method)">#<strong>server</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#subscriptions-instance_method" title="#subscriptions (instance method)">#<strong>subscriptions</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#websocket-instance_method" title="#websocket (instance method)">#<strong>websocket</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='note title protected'>protected</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#worker_pool-instance_method" title="#worker_pool (instance method)">#<strong>worker_pool</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
  </ul>


<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(server, env, coder: ActiveSupport::JSON)  &#x21d2; Base </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>a new instance of Base</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#allow_request_origin%3F-instance_method" title="#allow_request_origin? (instance method)">#<strong>allow_request_origin?</strong>  &#x21d2; Boolean </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#beat-instance_method" title="#beat (instance method)">#<strong>beat</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Close the WebSocket connection.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#cookies-instance_method" title="#cookies (instance method)">#<strong>cookies</strong>  </a>
      </span>
      <span class='note title protected'>protected</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The cookies of the request that initiated the WebSocket connection.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#decode-instance_method" title="#decode (instance method)">#<strong>decode</strong>(websocket_message)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#dispatch_websocket_message-instance_method" title="#dispatch_websocket_message (instance method)">#<strong>dispatch_websocket_message</strong>(websocket_message)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#encode-instance_method" title="#encode (instance method)">#<strong>encode</strong>(cable_message)  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#finished_request_message-instance_method" title="#finished_request_message (instance method)">#<strong>finished_request_message</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#handle_close-instance_method" title="#handle_close (instance method)">#<strong>handle_close</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#handle_open-instance_method" title="#handle_open (instance method)">#<strong>handle_open</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#invalid_request_message-instance_method" title="#invalid_request_message (instance method)">#<strong>invalid_request_message</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#new_tagged_logger-instance_method" title="#new_tagged_logger (instance method)">#<strong>new_tagged_logger</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Tags are declared in the server but computed in the connection.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#on_close-instance_method" title="#on_close (instance method)">#<strong>on_close</strong>(reason, code)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#on_error-instance_method" title="#on_error (instance method)">#<strong>on_error</strong>(message)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#on_message-instance_method" title="#on_message (instance method)">#<strong>on_message</strong>(message)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#on_open-instance_method" title="#on_open (instance method)">#<strong>on_open</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#process-instance_method" title="#process (instance method)">#<strong>process</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Called by the server when a new WebSocket connection is established.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#receive-instance_method" title="#receive (instance method)">#<strong>receive</strong>(websocket_message)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Decodes WebSocket messages and dispatches them to subscribed channels.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#request-instance_method" title="#request (instance method)">#<strong>request</strong>  </a>
      </span>
      <span class='note title protected'>protected</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The request that initiated the WebSocket connection is available here.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#respond_to_invalid_request-instance_method" title="#respond_to_invalid_request (instance method)">#<strong>respond_to_invalid_request</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#respond_to_successful_request-instance_method" title="#respond_to_successful_request (instance method)">#<strong>respond_to_successful_request</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#send_async-instance_method" title="#send_async (instance method)">#<strong>send_async</strong>(method, *arguments)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Invoke a method on the connection asynchronously through the pool of thread
workers.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#send_welcome_message-instance_method" title="#send_welcome_message (instance method)">#<strong>send_welcome_message</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#started_request_message-instance_method" title="#started_request_message (instance method)">#<strong>started_request_message</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#statistics-instance_method" title="#statistics (instance method)">#<strong>statistics</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Return a basic hash of statistics for the connection keyed with
<code>identifier</code>, <code>started_at</code>, and
<code>subscriptions</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#successful_request_message-instance_method" title="#successful_request_message (instance method)">#<strong>successful_request_message</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#transmit-instance_method" title="#transmit (instance method)">#<strong>transmit</strong>(cable_message)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'></div>
      </span>
    </li>
  </ul>



  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Authorization.html" title="ActionCable::Connection::Authorization (module)">Authorization</a></h3>
  <p class="inherited"><a href="Authorization.html#reject_unauthorized_connection-instance_method" title="ActionCable::Connection::Authorization#reject_unauthorized_connection (method)">#reject_unauthorized_connection</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="InternalChannel.html" title="ActionCable::Connection::InternalChannel (module)">InternalChannel</a></h3>
  <p class="inherited"><a href="InternalChannel.html#internal_channel-instance_method" title="ActionCable::Connection::InternalChannel#internal_channel (method)">#internal_channel</a>, <a href="InternalChannel.html#process_internal_message-instance_method" title="ActionCable::Connection::InternalChannel#process_internal_message (method)">#process_internal_message</a>, <a href="InternalChannel.html#subscribe_to_internal_channel-instance_method" title="ActionCable::Connection::InternalChannel#subscribe_to_internal_channel (method)">#subscribe_to_internal_channel</a>, <a href="InternalChannel.html#unsubscribe_from_internal_channel-instance_method" title="ActionCable::Connection::InternalChannel#unsubscribe_from_internal_channel (method)">#unsubscribe_from_internal_channel</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="../../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a></h3>
  <p class="inherited"><a href="../../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">#append_features</a>, <a href="../../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">#class_methods</a>, <a href="../../ActiveSupport/Concern.html#extended-class_method" title="ActiveSupport::Concern.extended (method)">.extended</a>, <a href="../../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">#included</a></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <a href="Identification.html" title="ActionCable::Connection::Identification (module)">Identification</a></h3>
  <p class="inherited"><a href="Identification.html#connection_gid-instance_method" title="ActionCable::Connection::Identification#connection_gid (method)">#connection_gid</a>, <a href="Identification.html#connection_identifier-instance_method" title="ActionCable::Connection::Identification#connection_identifier (method)">#connection_identifier</a></p>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(server, env, coder: ActiveSupport::JSON)  &#x21d2; <tt><a href="" title="ActionCable::Connection::Base (class)">Base</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>a new instance of Base</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L54'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


54
55
56
57
58
59
60
61
62
63
64
65
66</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 54</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='label'>coder:</span> <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/JSON.html" title="ActiveSupport::JSON (module)">JSON</a></span><span class='rparen'>)</span>
  <span class='ivar'>@server</span><span class='comma'>,</span> <span class='ivar'>@env</span><span class='comma'>,</span> <span class='ivar'>@coder</span> <span class='op'>=</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_coder'>coder</span>

  <span class='ivar'>@worker_pool</span> <span class='op'>=</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_worker_pool'>worker_pool</span>
  <span class='ivar'>@logger</span> <span class='op'>=</span> <span class='id identifier rubyid_new_tagged_logger'>new_tagged_logger</span>

  <span class='ivar'>@websocket</span>      <span class='op'>=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="WebSocket.html#new-class_method" title="ActionCable::Connection::WebSocket.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_event_loop'>event_loop</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_client_socket_class'>client_socket_class</span><span class='rparen'>)</span>
  <span class='ivar'>@subscriptions</span>  <span class='op'>=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="Subscriptions.html" title="ActionCable::Connection::Subscriptions (class)">Subscriptions</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Subscriptions.html#new-class_method" title="ActionCable::Connection::Subscriptions.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@message_buffer</span> <span class='op'>=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="MessageBuffer.html" title="ActionCable::Connection::MessageBuffer (class)">MessageBuffer</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="MessageBuffer.html#new-class_method" title="ActionCable::Connection::MessageBuffer.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>

  <span class='ivar'>@_internal_subscriptions</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@started_at</span> <span class='op'>=</span> <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="env-instance_method">
  <h3 class='signature first'>
  #<strong>env</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L51'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="logger-instance_method">
  <h3 class='signature'>
  #<strong>logger</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L51'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="message_buffer-instance_method">
  <h3 class='signature'>
  #<strong>message_buffer</strong>   <span class="extras">(<span class='only'>readonly</span>, <span class='prot'>protected</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L154'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


154</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 154</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_buffer'>message_buffer</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="protocol-instance_method">
  <h3 class='signature'>
  #<strong>protocol</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L51'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="server-instance_method">
  <h3 class='signature'>
  #<strong>server</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L51'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="subscriptions-instance_method">
  <h3 class='signature'>
  #<strong>subscriptions</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L51'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="websocket-instance_method">
  <h3 class='signature'>
  #<strong>websocket</strong>   <span class="extras">(<span class='only'>readonly</span>, <span class='prot'>protected</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L153'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


153</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 153</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_websocket'>websocket</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="worker_pool-instance_method">
  <h3 class='signature'>
  #<strong>worker_pool</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L51'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="allow_request_origin?-instance_method">
  <h3 class='signature first'>
  #<strong>allow_request_origin?</strong>  &#x21d2; <tt>Boolean</tt>  <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L195'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


195
196
197
198
199
200
201
202
203
204</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 195</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_request_origin?'>allow_request_origin?</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_disable_request_forgery_protection'>disable_request_forgery_protection</span>

  <span class='kw'>if</span> <span class='const'><a href="../../Array.html" title="Array (class)">Array</a></span><span class='lparen'>(</span><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_allowed_request_origins'>allowed_request_origins</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_allowed_origin'>allowed_origin</span><span class='op'>|</span>  <span class='id identifier rubyid_allowed_origin'>allowed_origin</span> <span class='op'>===</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_ORIGIN</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
    <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Request origin not allowed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_ORIGIN</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="beat-instance_method">
  <h3 class='signature'>
  #<strong>beat</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L119'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


119
120
121</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 119</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_beat'>beat</span>
  <span class='id identifier rubyid_transmit'>transmit</span> <span class='label'>type:</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../../ActionCable.html#INTERNAL-constant" title="ActionCable::INTERNAL (constant)">INTERNAL</a></span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_message_types'>message_types</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_ping'>ping</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close-instance_method">
  <h3 class='signature'>
  #<strong>close</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Close the WebSocket connection.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L99'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


99
100
101</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 99</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
  <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="cookies-instance_method">
  <h3 class='signature'>
  #<strong>cookies</strong>   <span class="extras">(<span class='prot'>protected</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The cookies of the request that initiated the WebSocket connection. Useful
for performing authorization checks.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L149'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


149
150
151</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 149</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cookies'>cookies</span>
  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_cookie_jar'>cookie_jar</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="decode-instance_method">
  <h3 class='signature'>
  #<strong>decode</strong>(websocket_message)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L161'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


161
162
163</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 161</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span>
  <span class='ivar'>@coder</span><span class='period'>.</span><span class='id identifier rubyid_decode'>decode</span> <span class='id identifier rubyid_websocket_message'>websocket_message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="dispatch_websocket_message-instance_method">
  <h3 class='signature'>
  #<strong>dispatch_websocket_message</strong>(websocket_message)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L86'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


86
87
88
89
90
91
92</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 86</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_dispatch_websocket_message'>dispatch_websocket_message</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_alive?'>alive?</span>
    <span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='period'>.</span><span class='id identifier rubyid_execute_command'>execute_command</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ignoring message processed after the WebSocket was closed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="encode-instance_method">
  <h3 class='signature'>
  #<strong>encode</strong>(cable_message)   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L157'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


157
158
159</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 157</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='id identifier rubyid_cable_message'>cable_message</span><span class='rparen'>)</span>
  <span class='ivar'>@coder</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span> <span class='id identifier rubyid_cable_message'>cable_message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="finished_request_message-instance_method">
  <h3 class='signature'>
  #<strong>finished_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L234'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


234
235
236
237
238
239
240</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 234</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_finished_request_message'>finished_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Finished &quot;%s&quot;%s for %s at %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_filtered_path'>filtered_path</span><span class='comma'>,</span>
    <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_possible?'>possible?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> [WebSocket]</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[non-WebSocket]</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span>
    <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="handle_close-instance_method">
  <h3 class='signature'>
  #<strong>handle_close</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L177'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


177
178
179
180
181
182
183
184
185
186</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 177</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_close'>handle_close</span>
  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_finished_request_message'>finished_request_message</span>

  <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_remove_connection'>remove_connection</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='period'>.</span><span class='id identifier rubyid_unsubscribe_from_all'>unsubscribe_from_all</span>
  <span class='id identifier rubyid_unsubscribe_from_internal_channel'>unsubscribe_from_internal_channel</span>

  <span class='id identifier rubyid_disconnect'>disconnect</span> <span class='kw'>if</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_disconnect'>disconnect</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="handle_open-instance_method">
  <h3 class='signature'>
  #<strong>handle_open</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L165'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


165
166
167
168
169
170
171
172
173
174
175</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 165</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_open'>handle_open</span>
  <span class='ivar'>@protocol</span> <span class='op'>=</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span>
  <span class='id identifier rubyid_connect'>connect</span> <span class='kw'>if</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_connect'>connect</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_subscribe_to_internal_channel'>subscribe_to_internal_channel</span>
  <span class='id identifier rubyid_send_welcome_message'>send_welcome_message</span>

  <span class='id identifier rubyid_message_buffer'>message_buffer</span><span class='period'>.</span><span class='id identifier rubyid_process!'>process!</span>
  <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_add_connection'>add_connection</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="Authorization.html" title="ActionCable::Connection::Authorization (module)">Authorization</a></span><span class='op'>::</span><span class='const'><a href="Authorization/UnauthorizedError.html" title="ActionCable::Connection::Authorization::UnauthorizedError (class)">UnauthorizedError</a></span>
  <span class='id identifier rubyid_respond_to_invalid_request'>respond_to_invalid_request</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="invalid_request_message-instance_method">
  <h3 class='signature'>
  #<strong>invalid_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L242'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


242
243
244
245
246</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 242</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_invalid_request_message'>invalid_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to upgrade to WebSocket (REQUEST_METHOD: %s, HTTP_CONNECTION: %s, HTTP_UPGRADE: %s)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>REQUEST_METHOD</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_CONNECTION</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_UPGRADE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="new_tagged_logger-instance_method">
  <h3 class='signature'>
  #<strong>new_tagged_logger</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Tags are declared in the server but computed in the connection. This allows
us per-connection tailored tags.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L220'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


220
221
222
223</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 220</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_new_tagged_logger'>new_tagged_logger</span>
  <span class='const'><a href="TaggedLoggerProxy.html" title="ActionCable::Connection::TaggedLoggerProxy (class)">TaggedLoggerProxy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="TaggedLoggerProxy.html#new-class_method" title="ActionCable::Connection::TaggedLoggerProxy.new (method)">new</a></span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span>
    <span class='label'>tags:</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_log_tags'>log_tags</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='op'>|</span> <span class='id identifier rubyid_tag'>tag</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_call'>call</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_tag'>tag</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_tag'>tag</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_camelize'>camelize</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="on_close-instance_method">
  <h3 class='signature'>
  #<strong>on_close</strong>(reason, code)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L135'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


135
136
137</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 135</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_close'>on_close</span><span class='lparen'>(</span><span class='id identifier rubyid_reason'>reason</span><span class='comma'>,</span> <span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_send_async'>send_async</span> <span class='symbeg'>:</span><span class='id identifier rubyid_handle_close'>handle_close</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="on_error-instance_method">
  <h3 class='signature'>
  #<strong>on_error</strong>(message)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L131'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


131
132
133</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 131</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_error'>on_error</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='comment'># ignore
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="on_message-instance_method">
  <h3 class='signature'>
  #<strong>on_message</strong>(message)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L127'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


127
128
129</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 127</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_message'>on_message</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_message_buffer'>message_buffer</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="on_open-instance_method">
  <h3 class='signature'>
  #<strong>on_open</strong>  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L123'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


123
124
125</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 123</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_open'>on_open</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_send_async'>send_async</span> <span class='symbeg'>:</span><span class='id identifier rubyid_handle_open'>handle_open</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="process-instance_method">
  <h3 class='signature'>
  #<strong>process</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Called by the server when a new WebSocket connection is established. This
configures the callbacks intended for overwriting by the user. This method
should not be called directly – instead rely upon on the <code>#connect</code> (and
<code>#disconnect</code>) callbacks.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L70'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


70
71
72
73
74
75
76
77
78</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 70</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process'>process</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_started_request_message'>started_request_message</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_possible?'>possible?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_allow_request_origin?'>allow_request_origin?</span>
    <span class='id identifier rubyid_respond_to_successful_request'>respond_to_successful_request</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_respond_to_invalid_request'>respond_to_invalid_request</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="receive-instance_method">
  <h3 class='signature'>
  #<strong>receive</strong>(websocket_message)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Decodes WebSocket messages and dispatches them to subscribed channels.
WebSocket message transfer encoding is always JSON.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L82'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


82
83
84</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 82</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_send_async'>send_async</span> <span class='symbeg'>:</span><span class='id identifier rubyid_dispatch_websocket_message'>dispatch_websocket_message</span><span class='comma'>,</span> <span class='id identifier rubyid_websocket_message'>websocket_message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="request-instance_method">
  <h3 class='signature'>
  #<strong>request</strong>   <span class="extras">(<span class='prot'>protected</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The request that initiated the WebSocket connection is available here. This
gives access to the environment, cookies, etc.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L141'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


141
142
143
144
145
146</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 141</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_request'>request</span>
  <span class='ivar'>@request</span> <span class='op'>||=</span> <span class='kw'>begin</span>
    <span class='id identifier rubyid_environment'>environment</span> <span class='op'>=</span> <span class='const'><a href="../../Rails.html" title="Rails (module)">Rails</a></span><span class='period'>.</span><span class='id identifier rubyid_application'><a href="../../Rails.html#application-class_method" title="Rails.application (method)">application</a></span><span class='period'>.</span><span class='id identifier rubyid_env_config'>env_config</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'><a href="../../Rails.html" title="Rails (module)">Rails</a></span><span class='period'>.</span><span class='id identifier rubyid_application'><a href="../../Rails.html#application-class_method" title="Rails.application (method)">application</a></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='const'><a href="../../Rails.html" title="Rails (module)">Rails</a></span><span class='period'>.</span><span class='id identifier rubyid_application'><a href="../../Rails.html#application-class_method" title="Rails.application (method)">application</a></span>
    <span class='const'><a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a></span><span class='op'>::</span><span class='const'><a href="../../ActionDispatch/Request.html" title="ActionDispatch::Request (class)">Request</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="../../ActionDispatch/Request.html#new-class_method" title="ActionDispatch::Request.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_environment'>environment</span> <span class='op'>||</span> <span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="respond_to_invalid_request-instance_method">
  <h3 class='signature'>
  #<strong>respond_to_invalid_request</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L211'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


211
212
213
214
215
216
217</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 211</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_respond_to_invalid_request'>respond_to_invalid_request</span>
  <span class='id identifier rubyid_close'>close</span> <span class='kw'>if</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_alive?'>alive?</span>

  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_invalid_request_message'>invalid_request_message</span>
  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_finished_request_message'>finished_request_message</span>
  <span class='lbracket'>[</span> <span class='int'>404</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Content-Type</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>text/plain</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Page not found</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span> <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="respond_to_successful_request-instance_method">
  <h3 class='signature'>
  #<strong>respond_to_successful_request</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L206'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


206
207
208
209</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 206</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_respond_to_successful_request'>respond_to_successful_request</span>
  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_successful_request_message'>successful_request_message</span>
  <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_rack_response'>rack_response</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="send_async-instance_method">
  <h3 class='signature'>
  #<strong>send_async</strong>(method, *arguments)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Invoke a method on the connection asynchronously through the pool of thread
workers.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L104'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


104
105
106</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 104</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_async'>send_async</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_arguments'>arguments</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='period'>.</span><span class='id identifier rubyid_async_invoke'>async_invoke</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_arguments'>arguments</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="send_welcome_message-instance_method">
  <h3 class='signature'>
  #<strong>send_welcome_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L188'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


188
189
190
191
192
193</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 188</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_welcome_message'>send_welcome_message</span>
  <span class='comment'># Send welcome message to the internal connection monitor channel.
</span>  <span class='comment'># This ensures the connection monitor state is reset after a successful
</span>  <span class='comment'># websocket connection.
</span>  <span class='id identifier rubyid_transmit'>transmit</span> <span class='label'>type:</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../../ActionCable.html#INTERNAL-constant" title="ActionCable::INTERNAL (constant)">INTERNAL</a></span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_message_types'>message_types</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_welcome'>welcome</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="started_request_message-instance_method">
  <h3 class='signature'>
  #<strong>started_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L225'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


225
226
227
228
229
230
231
232</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 225</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_started_request_message'>started_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Started %s &quot;%s&quot;%s for %s at %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span><span class='comma'>,</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_filtered_path'>filtered_path</span><span class='comma'>,</span>
    <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_possible?'>possible?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> [WebSocket]</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[non-WebSocket]</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span>
    <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="statistics-instance_method">
  <h3 class='signature'>
  #<strong>statistics</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Return a basic hash of statistics for the connection keyed with
<code>identifier</code>, <code>started_at</code>, and
<code>subscriptions</code>. This can be returned by a health check against
the connection.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L110'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


110
111
112
113
114
115
116
117</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 110</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_statistics'>statistics</span>
  <span class='lbrace'>{</span>
    <span class='label'>identifier:</span> <span class='id identifier rubyid_connection_identifier'>connection_identifier</span><span class='comma'>,</span>
    <span class='label'>started_at:</span> <span class='ivar'>@started_at</span><span class='comma'>,</span>
    <span class='label'>subscriptions:</span> <span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='period'>.</span><span class='id identifier rubyid_identifiers'>identifiers</span><span class='comma'>,</span>
    <span class='label'>request_id:</span> <span class='ivar'>@env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>action_dispatch.request_id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="successful_request_message-instance_method">
  <h3 class='signature'>
  #<strong>successful_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L248'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


248
249
250
251
252</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 248</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_successful_request_message'>successful_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successfully upgraded to WebSocket (REQUEST_METHOD: %s, HTTP_CONNECTION: %s, HTTP_UPGRADE: %s)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>REQUEST_METHOD</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_CONNECTION</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_UPGRADE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="transmit-instance_method">
  <h3 class='signature'>
  #<strong>transmit</strong>(cable_message)  
</h3>
  <span class='link_repo'>[ <a href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L94'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


94
95
96</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 94</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_transmit'>transmit</span><span class='lparen'>(</span><span class='id identifier rubyid_cable_message'>cable_message</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_transmit'>transmit</span> <span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='id identifier rubyid_cable_message'>cable_message</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>