<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Action Pack CHANGELOG &mdash; Rails 4.2.11.3</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "action_pack_CHANGELOG",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Rails 4.2.11.3</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Action Pack CHANGELOG&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<h2>Rails 4.2.11.3 (May 15, 2020)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.11.2 (May 15, 2020)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.11.1 (March 11, 2019)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.11 (November 27, 2018)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.10 (September 27, 2017)</h2>
<ul>
<li>
<p>Fix regression in behavior of <code>normalize_path</code>.</p>
<p>In Rails 5 there was a change to ensure the encoding of the original string
in a path was maintained. This was incorrectly backported to Rails 4.2 which
caused a regression.</p>
<p><em>Eileen M. Uchitelle</em></p>
</li>
</ul>
<h2>Rails 4.2.9 (June 26, 2017)</h2>
<ul>
<li>
<p>Use more specific check for <code>:format</code> in route path</p>
<p>The current check for whether to add an optional format to the path is very lax
and will match things like <code>:format_id</code> where there are nested resources, e.g:</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_resources'>resources</span> <span class='symbeg'>:</span><span class='id identifier rubyid_formats'>formats</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_resources'>resources</span> <span class='symbeg'>:</span><span class='id identifier rubyid_items'>items</span>
<span class='kw'>end</span></code></pre>
<p>Fix this by using a more restrictive regex pattern that looks for the patterns
<code>(.:format)</code>, <code>.:format</code> or <code>/</code> at the end of the path. Note that we need to
allow for multiple closing parenthesis since the route may be of this form:</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/books(/:action(.:format))</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>books</span><span class='tstring_end'>&quot;</span></span></code></pre>
<p>This probably isn't what's intended since it means that the default index action
route doesn't support a format but we have a test for it so we need to allow it.</p>
<p>Fixes #28517.</p>
<p><em>Andrew White</em></p>
</li>
</ul>
<h2>Rails 4.2.8 (February 21, 2017)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.7 (July 12, 2016)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.6 (March 07, 2016)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.5.2 (February 26, 2016)</h2>
<ul>
<li>
<p>Do not allow render with unpermitted parameter.</p>
<p>Fixes CVE-2016-2098.</p>
<p><em>Arthur Neves</em></p>
</li>
</ul>
<h2>Rails 4.2.5.1 (January 25, 2015)</h2>
<ul>
<li>No changes.</li>
</ul>
<h2>Rails 4.2.5 (November 12, 2015)</h2>
<ul>
<li>
<p><a href="ActionController/TestCase.html" title="ActionController::TestCase (class)">::ActionController::TestCase</a> can teardown gracefully if an error is raised
early in the <code>setup</code> chain.</p>
<p><em>Yves Senn</em></p>
</li>
<li>
<p>Parse RSS/ATOM responses as XML, not HTML.</p>
<p><em>Alexander Kaupanin</em></p>
</li>
<li>
<p>Fix regression in mounted engine named routes generation for app deployed to
a subdirectory. <code>relative_url_root</code> was prepended to the path twice (e.g.
&quot;/subdir/subdir/engine_path&quot; instead of &quot;/subdir/engine_path&quot;)</p>
<p>Fixes #20920. Fixes #21459.</p>
<p><em>Matthew Erhard</em></p>
</li>
<li>
<p><code>url_for</code> does not modify its arguments when generating polymorphic URLs.</p>
<p><em>Bernerd Schaefer</em></p>
</li>
<li>
<p>Update <a href="ActionController/TestSession.html#fetch-instance_method" title="ActionController::TestSession#fetch (method)">ActionController::TestSession#fetch</a> to behave more like
<a href="ActionDispatch/Request/Session.html#fetch-instance_method" title="ActionDispatch::Request::Session#fetch (method)">ActionDispatch::Request::Session#fetch</a> when using non-string keys.</p>
<p><em>Jeremy Friesen</em></p>
</li>
</ul>
<h2>Rails 4.2.4 (August 24, 2015)</h2>
<ul>
<li>
<p><a href="ActionController/TestSession.html" title="ActionController::TestSession (class)">::ActionController::TestSession</a> now accepts a default value as well as
a block for generating a default value based off the key provided.</p>
<p>This fixes calls to session#fetch in ApplicationController instances that
take more two arguments or a block from raising <code>ArgumentError: wrong number of arguments (2 for 1)</code> when performing controller tests.</p>
<p><em>Matthew Gerrior</em></p>
</li>
<li>
<p>Fix to keep original header instance in <a href="ActionDispatch/SSL.html" title="ActionDispatch::SSL (class)">::ActionDispatch::SSL</a></p>
<p><a href="ActionDispatch/SSL.html" title="ActionDispatch::SSL (class)">::ActionDispatch::SSL</a> changes headers to <a href="Hash.html" title="Hash (class)">Hash</a>.
So some headers will be broken if there are some middlewares
on <a href="ActionDispatch/SSL.html" title="ActionDispatch::SSL (class)">::ActionDispatch::SSL</a> and if it uses <code>Rack::Utils::HeaderHash</code>.</p>
<p><em>Fumiaki Matsushima</em></p>
</li>
</ul>
<h2>Rails 4.2.3 (June 25, 2015)</h2>
<ul>
<li>
<p>Fix rake routes not showing the right format when
nesting multiple routes.</p>
<p>See #18373.</p>
<p><em>Ravil Bayramgalin</em></p>
</li>
<li>
<p>Fix regression where a gzip file response would have a Content-type,
even when it was a 304 status code.</p>
<p>See #19271.</p>
<p><em>Kohei Suzuki</em></p>
</li>
<li>
<p>Fix handling of empty X_FORWARDED_HOST header in raw_host_with_port</p>
<p>Previously, an empty X_FORWARDED_HOST header would cause
Actiondispatch::Http:URL.raw_host_with_port to return nil, causing
Actiondispatch::Http:URL.host to raise a NoMethodError.</p>
<p><em>Adam Forsyth</em></p>
</li>
<li>
<p>Fallback to <code>ENV['RAILS_RELATIVE_URL_ROOT']</code> in <code>url_for</code>.</p>
<p>Fixed an issue where the <code>RAILS_RELATIVE_URL_ROOT</code> environment variable is not
prepended to the path when <code>url_for</code> is called. If <code>SCRIPT_NAME</code> (used by Rack)
is set, it takes precedence.</p>
<p>Fixes #5122.</p>
<p><em>Yasyf Mohamedali</em></p>
</li>
<li>
<p>Fix regression in functional tests. Responses should have default headers
assigned.</p>
<p>See #18423.</p>
<p><em>Jeremy Kemper</em>, <em>Yves Senn</em></p>
</li>
</ul>
<h2>Rails 4.2.2 (June 16, 2015)</h2>
<ul>
<li>No Changes *</li>
</ul>
<h2>Rails 4.2.1 (March 19, 2015)</h2>
<ul>
<li>
<p>Non-string authenticity tokens do not raise NoMethodError when decoding
the masked token.</p>
<p><em>Ville Lautanala</em></p>
</li>
<li>
<p>Explicitly ignored wildcard verbs when searching for HEAD routes before fallback</p>
<p>Fixes an issue where a mounted rack app at root would intercept the HEAD
request causing an incorrect behavior during the fall back to GET requests.</p>
<p>Example:</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test#index</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_mount'>mount</span> <span class='id identifier rubyid_rack_app'>rack_app</span><span class='comma'>,</span> <span class='label'>at:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
<span class='id identifier rubyid_head'>head</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/home</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_assert_response'>assert_response</span> <span class='symbeg'>:</span><span class='id identifier rubyid_success'>success</span></code></pre>
<p>In this case, a HEAD request runs through the routes the first time and fails
to match anything. Then, it runs through the list with the fallback and matches
<code>get '/home'</code>. The original behavior would match the rack app in the first pass.</p>
<p><em>Terence Sun</em></p>
</li>
<li>
<p>Preserve default format when generating URLs</p>
<p>Fixes an issue that would cause the format set in default_url_options to be
lost when generating URLs with fewer positional arguments than parameters in
the route definition.</p>
<p>Backport of #18627</p>
<p><em>Tekin Suleyman</em>, <em>Dominic Baggott</em></p>
</li>
<li>
<p>Default headers, removed in controller actions, are no longer reapplied on
the test response.</p>
<p><em>Jonas Baumann</em></p>
</li>
<li>
<p>Ensure <code>append_info_to_payload</code> is called even if an exception is raised.</p>
<p>Fixes an issue where when an exception is raised in the request the additonal
payload data is not available.</p>
<p>See:</p>
<ul>
<li>#14903</li>
<li><a href="https://github.com/roidrage/lograge/issues/37">https://github.com/roidrage/lograge/issues/37</a></li>
</ul>
<p><em>Dieter Komendera</em>, <em>Margus Pärt</em></p>
</li>
<li>
<p>Correctly rely on the response's status code to handle calls to <code>head</code>.</p>
<p><em>Robin Dupret</em></p>
</li>
<li>
<p>Using <code>head</code> method returns empty response_body instead
of returning a single space &quot; &quot;.</p>
<p>The old behavior was added as a workaround for a bug in an early
version of Safari, where the HTTP headers are not returned correctly
if the response body has a 0-length. This is been fixed since and
the workaround is no longer necessary.</p>
<p>Fixes #18253.</p>
<p><em>Prathamesh Sonpatki</em></p>
</li>
<li>
<p>Fix how polymorphic routes works with objects that implement <code>to_model</code>.</p>
<p><em>Travis Grathwell</em></p>
</li>
<li>
<p>Fixed handling of positional url helper arguments when <code>format: false</code>.</p>
<p>Fixes #17819.</p>
<p><em>Andrew White</em>, <em>Tatiana Soukiassian</em></p>
</li>
<li>
<p>Fixed usage of optional scopes in URL helpers.</p>
<p><em>Alex Robbin</em></p>
</li>
</ul>
<h2>Rails 4.2.0 (December 20, 2014)</h2>
<ul>
<li>
<p>Add <a href="ActionController/Parameters.html#to_unsafe_h-instance_method" title="ActionController::Parameters#to_unsafe_h (method)">ActionController::Parameters#to_unsafe_h</a> to return an unfiltered
<a href="Hash.html" title="Hash (class)">Hash</a> representation of Parameters object. This is now a preferred way to
retrieve unfiltered parameters as we will stop inheriting <code>AC::Parameters</code>
object in Rails 5.0.</p>
<p><em>Prem Sichanugrist</em></p>
</li>
<li>
<p>Restore handling of a bare <code>Authorization</code> header, without <code>token=</code>
prefix.</p>
<p>Fixes #17108.</p>
<p><em>Guo Xiang Tan</em></p>
</li>
<li>
<p>Deprecate use of string keys in URL helpers.</p>
<p>Use symbols instead.
Fixes #16958.</p>
<p><em>Byron Bischoff</em>, <em>Melanie Gilman</em></p>
</li>
<li>
<p>Deprecate the <code>only_path</code> option on <code>*_path</code> helpers.</p>
<p>In cases where this option is set to <code>true</code>, the option is redundant and can
be safely removed; otherwise, the corresponding <code>*_url</code> helper should be
used instead.</p>
<p>Fixes #17294.</p>
<p><em>Dan Olson</em>, <em>Godfrey Chan</em></p>
</li>
<li>
<p>Improve Journey compliance to RFC 3986.</p>
<p>The scanner in Journey failed to recognize routes that use literals
from the sub-delims section of RFC 3986. It's now able to parse those
authorized delimiters and route as expected.</p>
<p>Fixes #17212.</p>
<p><em>Nicolas Cavigneaux</em></p>
</li>
<li>
<p>Deprecate implicit <a href="Array.html" title="Array (class)">Array</a> conversion for Response objects. It was added
(using <code>#to_ary</code>) so we could conveniently use implicit splatting:</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span></code></pre>
<p>But it also means <code>response + response</code> works and <code>[response].flatten</code>
cascades down to the Rack body. Nonsense behavior. Instead, rely on
explicit conversion and splatting with <code>#to_a</code>:</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_header'>header</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='op'>*</span><span class='id identifier rubyid_response'>response</span></code></pre>
<p><em>Jeremy Kemper</em></p>
</li>
<li>
<p>Don't rescue <code>IPAddr::InvalidAddressError</code>.</p>
<p><code>IPAddr::InvalidAddressError</code> does not exist in Ruby 1.9.3
and fails for JRuby in 1.9 mode.</p>
<p><em>Peter Suschlik</em></p>
</li>
<li>
<p>Fix bug where the router would ignore any constraints added to redirect
routes.</p>
<p>Fixes #16605.</p>
<p><em>Agis Anastasopoulos</em></p>
</li>
<li>
<p>Allow <code>config.action_dispatch.trusted_proxies</code> to accept an IPAddr object.</p>
<p>Example:</p>
<pre class="code ruby"><code class="ruby"><span class='comment'># config/environments/production.rb
</span><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_action_dispatch'>action_dispatch</span>.<span class='id identifier rubyid_trusted_proxies'>trusted_proxies</span> <span class='op'>=</span> <span class='const'>IPAddr</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>4.8.15.0/16</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
<p><em>Sam Aarons</em></p>
</li>
<li>
<p>Avoid duplicating routes for HEAD requests.</p>
<p>Instead of duplicating the routes, we will first match the HEAD request to
HEAD routes. If no match is found, we will then map the HEAD request to
GET routes.</p>
<p><em>Guo Xiang Tan</em>, <em>Andrew White</em></p>
</li>
<li>
<p>Requests that hit <a href="ActionDispatch/Static.html" title="ActionDispatch::Static (class)">::ActionDispatch::Static</a> can now take advantage
of gzipped assets on disk. By default a gzip asset will be served if
the client supports gzip and a compressed file is on disk.</p>
<p><em>Richard Schneeman</em></p>
</li>
<li>
<p><a href="ActionController/Parameters.html" title="ActionController::Parameters (class)">::ActionController::Parameters</a> will stop inheriting from <a href="Hash.html" title="Hash (class)">Hash</a> and
<a href="#HashWithIndifferentAccess-constant" title="HashWithIndifferentAccess (constant)">HashWithIndifferentAccess</a> in the next major release. If you use any method
that is not available on <a href="ActionController/Parameters.html" title="ActionController::Parameters (class)">::ActionController::Parameters</a> you should consider
calling <code>#to_h</code> to convert it to a <a href="Hash.html" title="Hash (class)">Hash</a> first before calling that method.</p>
<p><em>Prem Sichanugrist</em></p>
</li>
<li>
<p><a href="ActionController/Parameters.html#to_h-instance_method" title="ActionController::Parameters#to_h (method)">ActionController::Parameters#to_h</a> now returns a <a href="Hash.html" title="Hash (class)">Hash</a> with unpermitted
keys removed. This change is to reflect on a security concern where some
method performed on an <a href="ActionController/Parameters.html" title="ActionController::Parameters (class)">::ActionController::Parameters</a> may yield a <a href="Hash.html" title="Hash (class)">Hash</a>
object which does not maintain <code>permitted?</code> status. If you would like to
get a <a href="Hash.html" title="Hash (class)">Hash</a> with all the keys intact, duplicate and mark it as permitted
before calling <code>#to_h</code>.</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='const'><a href="ActionController.html" title="ActionController (module)">ActionController</a></span><span class='op'>::</span><span class='const'><a href="ActionController/Parameters.html" title="ActionController::Parameters (class)">Parameters</a></span>.<span class='id identifier rubyid_new'><a href="ActionController/Parameters.html#new-class_method" title="ActionController::Parameters.new (method)">new</a></span>({
  <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Senjougahara Hitagi</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>oddity:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Heavy stone crab</span><span class='tstring_end'>&#39;</span></span>
})
<span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_to_h'>to_h</span>
<span class='comment'># =&gt; {}
</span>
<span class='id identifier rubyid_unsafe_params'>unsafe_params</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_dup'>dup</span>.<span class='id identifier rubyid_permit!'>permit!</span>
<span class='id identifier rubyid_unsafe_params'>unsafe_params</span>.<span class='id identifier rubyid_to_h'>to_h</span>
<span class='comment'># =&gt; {&quot;name&quot;=&gt;&quot;Senjougahara Hitagi&quot;, &quot;oddity&quot;=&gt;&quot;Heavy stone crab&quot;}
</span>
<span class='id identifier rubyid_safe_params'>safe_params</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_permit'>permit</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span>)
<span class='id identifier rubyid_safe_params'>safe_params</span>.<span class='id identifier rubyid_to_h'>to_h</span>
<span class='comment'># =&gt; {&quot;name&quot;=&gt;&quot;Senjougahara Hitagi&quot;}</span></code></pre>
<p>This change is consider a stopgap as we cannot change the code to stop
<a href="ActionController/Parameters.html" title="ActionController::Parameters (class)">::ActionController::Parameters</a> to inherit from <a href="#HashWithIndifferentAccess-constant" title="HashWithIndifferentAccess (constant)">HashWithIndifferentAccess</a>
in the next minor release.</p>
<p><em>Prem Sichanugrist</em></p>
</li>
<li>
<p>Deprecated <code>TagAssertions</code>.</p>
<p><em>Kasper Timm Hansen</em></p>
</li>
<li>
<p>Use the Active Support JSON encoder for cookie jars using the <code>:json</code> or
<code>:hybrid</code> serializer. This allows you to serialize custom Ruby objects into
cookies by defining the <code>#as_json</code> hook on such objects.</p>
<p>Fixes #16520.</p>
<p><em>Godfrey Chan</em></p>
</li>
<li>
<p>Add <code>config.action_dispatch.cookies_digest</code> option for setting custom
digest. The default remains the same - 'SHA1'.</p>
<p><em>Łukasz Strzałkowski</em></p>
</li>
<li>
<p>Move <code>respond_with</code> (and the class-level <code>respond_to</code>) to
the <code>responders</code> gem.</p>
<p><em>José Valim</em></p>
</li>
<li>
<p>When your templates change, browser caches bust automatically.</p>
<p>New default: the template digest is automatically included in your ETags.
When you call <code>fresh_when @post</code>, the digest for <code>posts/show.html.erb</code>
is mixed in so future changes to the HTML will blow HTTP caches for you.
This makes it easy to HTTP-cache many more of your actions.</p>
<p>If you render a different template, you can now pass the <code>:template</code>
option to include its digest instead:</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_fresh_when'>fresh_when</span> <span class='ivar'>@post</span><span class='comma'>,</span> <span class='label'>template:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>widgets/show</span><span class='tstring_end'>&#39;</span></span></code></pre>
<p>Pass <code>template: false</code> to skip the lookup. To turn this off entirely, set:</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_action_controller'>action_controller</span>.<span class='id identifier rubyid_etag_with_template_digest'>etag_with_template_digest</span> <span class='op'>=</span> <span class='kw'>false</span></code></pre>
<p><em>Jeremy Kemper</em></p>
</li>
<li>
<p>Remove deprecated <code>AbstractController::Helpers::ClassMethods::MissingHelperError</code>
in favor of <a href="AbstractController/Helpers/MissingHelperError.html" title="AbstractController::Helpers::MissingHelperError (class)">::AbstractController::Helpers::MissingHelperError</a>.</p>
<p><em>Yves Senn</em></p>
</li>
<li>
<p>Fix <code>assert_template</code> not being able to assert that no files were rendered.</p>
<p><em>Guo Xiang Tan</em></p>
</li>
<li>
<p>Extract source code for the entire exception stack trace for
better debugging and diagnosis.</p>
<p><em>Ryan Dao</em></p>
</li>
<li>
<p>Allows ActionDispatch::Request::LOCALHOST to match any IPv4 127.0.0.0/8
loopback address.</p>
<p><em>Earl St Sauver</em>, <em>Sven Riedel</em></p>
</li>
<li>
<p>Preserve original path in <code>ShowExceptions</code> middleware by stashing it as
<code>env[&quot;action_dispatch.original_path&quot;]</code></p>
<p><a href="ActionDispatch/ShowExceptions.html" title="ActionDispatch::ShowExceptions (class)">::ActionDispatch::ShowExceptions</a> overwrites <code>PATH_INFO</code> with the status code
for the exception defined in <code>ExceptionWrapper</code>, so the path
the user was visiting when an exception occurred was not previously
available to any custom exceptions_app. The original <code>PATH_INFO</code> is now
stashed in <code>env[&quot;action_dispatch.original_path&quot;]</code>.</p>
<p><em>Grey Baker</em></p>
</li>
<li>
<p>Use <code>String#bytesize</code> instead of <code>String#size</code> when checking for cookie
overflow.</p>
<p><em>Agis Anastasopoulos</em></p>
</li>
<li>
<p><code>render nothing: true</code> or rendering a <code>nil</code> body no longer add a single
space to the response body.</p>
<p>The old behavior was added as a workaround for a bug in an early version of
Safari, where the HTTP headers are not returned correctly if the response
body has a 0-length. This is been fixed since and the workaround is no
longer necessary.</p>
<p>Use <code>render body: ' '</code> if the old behavior is desired.</p>
<p>See #14883 for details.</p>
<p><em>Godfrey Chan</em></p>
</li>
<li>
<p>Prepend a JS comment to JSONP callbacks. Addresses CVE-2014-4671
(&quot;Rosetta Flash&quot;).</p>
<p><em>Greg Campbell</em></p>
</li>
<li>
<p>Because URI paths may contain non US-ASCII characters we need to force
the encoding of any unescaped URIs to UTF-8 if they are US-ASCII.
This essentially replicates the functionality of the monkey patch to
URI.parser.unescape in active_support/core_ext/uri.rb.</p>
<p>Fixes #16104.</p>
<p><em>Karl Entwistle</em></p>
</li>
<li>
<p>Generate shallow paths for all children of shallow resources.</p>
<p>Fixes #15783.</p>
<p><em>Seb Jacobs</em></p>
</li>
<li>
<p>JSONP responses are now rendered with the <code>text/javascript</code> content type
when rendering through a <code>respond_to</code> block.</p>
<p>Fixes #15081.</p>
<p><em>Lucas Mazza</em></p>
</li>
<li>
<p>Add <code>config.action_controller.always_permitted_parameters</code> to configure which
parameters are permitted globally. The default value of this configuration is
<code>['controller', 'action']</code>.</p>
<p><em>Gary S. Weaver</em>, <em>Rafael Chacon</em></p>
</li>
<li>
<p>Fix env['PATH_INFO'] missing leading slash when a rack app mounted at '/'.</p>
<p>Fixes #15511.</p>
<p><em>Larry Lv</em></p>
</li>
<li>
<p>ActionController::Parameters#require now accepts <code>false</code> values.</p>
<p>Fixes #15685.</p>
<p><em>Sergio Romano</em></p>
</li>
<li>
<p>With authorization header <code>Authorization: Token token=</code>, <code>authenticate</code> now
recognize token as nil, instead of &quot;token&quot;.</p>
<p>Fixes #14846.</p>
<p><em>Larry Lv</em></p>
</li>
<li>
<p>Ensure the controller is always notified as soon as the client disconnects
during live streaming, even when the controller is blocked on a write.</p>
<p><em>Nicholas Jakobsen</em>, <em>Matthew Draper</em></p>
</li>
<li>
<p>Routes specifying 'to:' must be a string that contains a &quot;#&quot; or a rack
application.  Use of a symbol should be replaced with <code>action: symbol</code>.
Use of a string without a &quot;#&quot; should be replaced with <code>controller: string</code>.</p>
<p><em>Aaron Patterson</em></p>
</li>
<li>
<p>Fix URL generation with <code>:trailing_slash</code> such that it does not add
a trailing slash after <code>.:format</code></p>
<p><em>Dan Langevin</em></p>
</li>
<li>
<p>Build full <a href="URI.html" title="URI (module)">URI</a> as string when processing path in integration tests for
performance reasons. One consequence of this is that the leading slash
is now required in integration test <code>process</code> helpers, whereas previously
it could be omitted. The fact that this worked was a unintended consequence
of the implementation and was never an intentional feature.</p>
<p><em>Guo Xiang Tan</em></p>
</li>
<li>
<p>Fix <code>'Stack level too deep'</code> when rendering <code>head :ok</code> in an action method
called 'status' in a controller.</p>
<p>Fixes #13905.</p>
<p><em>Christiaan Van den Poel</em></p>
</li>
<li>
<p>Add MKCALENDAR HTTP method (RFC 4791).</p>
<p><em>Sergey Karpesh</em></p>
</li>
<li>
<p>Instrument fragment cache metrics.</p>
<p>Adds <code>:controller</code>: and <code>:action</code> keys to the instrumentation payload
for the <code>*_fragment.action_controller</code> notifications. This allows tracking
e.g. the fragment cache hit rates for each controller action.</p>
<p><em>Daniel Schierbeck</em></p>
</li>
<li>
<p>Always use the provided port if the protocol is relative.</p>
<p>Fixes #15043.</p>
<p><em>Guilherme Cavalcanti</em>, <em>Andrew White</em></p>
</li>
<li>
<p>Moved <code>params[request_forgery_protection_token]</code> into its own method
and improved tests.</p>
<p>Fixes #11316.</p>
<p><em>Tom Kadwill</em></p>
</li>
<li>
<p>Added verification of route constraints given as a Proc or an object responding
to <code>:matches?</code>. Previously, when given an non-complying object, it would just
silently fail to enforce the constraint. It will now raise an <code>ArgumentError</code>
when setting up the routes.</p>
<p><em>Xavier Defrang</em></p>
</li>
<li>
<p>Properly treat the entire IPv6 User Local Address space as private for
purposes of remote IP detection. Also handle uppercase private IPv6
addresses.</p>
<p>Fixes #12638.</p>
<p><em>Caleb Spare</em></p>
</li>
<li>
<p>Fixed an issue with migrating legacy json cookies.</p>
<p>Previously, the <code>VerifyAndUpgradeLegacySignedMessage</code> assumes all incoming
cookies are marshal-encoded. This is not the case when <code>secret_token</code> is
used in conjunction with the <code>:json</code> or <code>:hybrid</code> serializer.</p>
<p>In those case, when upgrading to use <code>secret_key_base</code>, this would cause a
<code>TypeError: incompatible marshal file format</code> and a 500 error for the user.</p>
<p>Fixes #14774.</p>
<p><em>Godfrey Chan</em></p>
</li>
<li>
<p>Make URL escaping more consistent:</p>
<ol>
<li>Escape '%' characters in URLs - only unescaped data should be passed to URL helpers</li>
<li>Add an <code>escape_segment</code> helper to <code>Router::Utils</code> that escapes '/' characters</li>
<li>Use <code>escape_segment</code> rather than <code>escape_fragment</code> in optimized URL generation</li>
<li>Use <code>escape_segment</code> rather than <code>escape_path</code> in URL generation</li>
</ol>
<p>For point 4 there are two exceptions. Firstly, when a route uses wildcard segments
(e.g. <code>*foo</code>) then we use <code>escape_path</code> as the value may contain '/' characters. This
means that wildcard routes can't be optimized. Secondly, if a <code>:controller</code> segment
is used in the path then this uses <code>escape_path</code> as the controller may be namespaced.</p>
<p>Fixes #14629, #14636 and #14070.</p>
<p><em>Andrew White</em>, <em>Edho Arief</em></p>
</li>
<li>
<p>Add alias <a href="ActionDispatch/Http/UploadedFile.html#to_io-instance_method" title="ActionDispatch::Http::UploadedFile#to_io (method)">ActionDispatch::Http::UploadedFile#to_io</a> to
<a href="ActionDispatch/Http/UploadedFile.html#tempfile-instance_method" title="ActionDispatch::Http::UploadedFile#tempfile (method)">ActionDispatch::Http::UploadedFile#tempfile</a>.</p>
<p><em>Tim Linquist</em></p>
</li>
<li>
<p>Returns null type format when format is not know and controller is using <code>any</code>
format block.</p>
<p>Fixes #14462.</p>
<p><em>Rafael Mendonça França</em></p>
</li>
<li>
<p>Improve routing error page with fuzzy matching search.</p>
<p><em>Winston</em></p>
</li>
<li>
<p>Only make deeply nested routes shallow when parent is shallow.</p>
<p>Fixes #14684.</p>
<p><em>Andrew White</em>, <em>James Coglan</em></p>
</li>
<li>
<p>Append link to bad code to backtrace when exception is <code>SyntaxError</code>.</p>
<p><em>Boris Kuznetsov</em></p>
</li>
<li>
<p>Swapped the parameters of assert_equal in <code>assert_select</code> so that the
proper values were printed correctly.</p>
<p>Fixes #14422.</p>
<p><em>Vishal Lal</em></p>
</li>
<li>
<p>The method <code>shallow?</code> returns false if the parent resource is a singleton so
we need to check if we're not inside a nested scope before copying the :path
and :as options to their shallow equivalents.</p>
<p>Fixes #14388.</p>
<p><em>Andrew White</em></p>
</li>
<li>
<p>Make logging of CSRF failures optional (but on by default) with the
<code>log_warning_on_csrf_failure</code> configuration setting in
<a href="ActionController/RequestForgeryProtection.html" title="ActionController::RequestForgeryProtection (module)">::ActionController::RequestForgeryProtection</a>.</p>
<p><em>John Barton</em></p>
</li>
<li>
<p>Fix URL generation in controller tests with request-dependent
<code>default_url_options</code> methods.</p>
<p><em>Tony Wooster</em></p>
</li>
</ul>
<p>Please check <a href="https://github.com/rails/rails/blob/4-1-stable/actionpack/CHANGELOG.md" target="_parent" title="4-1-stable">4-1-stable</a> for previous changes.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>