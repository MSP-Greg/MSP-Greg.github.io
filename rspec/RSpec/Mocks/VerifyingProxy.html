<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: RSpec::Mocks::VerifyingProxy &mdash; RSpec main</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "RSpec::Mocks::VerifyingProxy",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>RSpec main</a> &raquo; 
      <a href='../../_index.html#alpha_V'>Index (V)</a> &raquo; 
        <a href="../../RSpec.html" title="RSpec (module)">RSpec</a> &raquo; 
        <a href="../Mocks.html" title="RSpec::Mocks (module)">Mocks</a> &raquo; 
      <span class='title'><a class='nodoc' id='t2_doc_top' href='#'>VerifyingProxy&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: RSpec::Mocks::VerifyingProxy  <span class='private note title'>Private</span>
</h1>
  <div class='note nodoc inline-block'>
    <strong>Do not use.  This class is for internal use only.</strong>
  </div>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="TestDoubleProxy.html" title="RSpec::Mocks::TestDoubleProxy (class)"><code>TestDoubleProxy</code></a>,
          <a href="Proxy.html" title="RSpec::Mocks::Proxy (class)"><code>Proxy</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="VerifyingProxyMethods.html" title="RSpec::Mocks::VerifyingProxyMethods (module)"><code>VerifyingProxyMethods</code></a>,
          <a href="TestDoubleProxy.html" title="RSpec::Mocks::TestDoubleProxy (class)"><code>TestDoubleProxy</code></a>,
          <a href="Proxy.html" title="RSpec::Mocks::Proxy (class)"><code>Proxy</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="TestDoubleProxy.html" title="RSpec::Mocks::TestDoubleProxy (class)">RSpec::Mocks::TestDoubleProxy</a></span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'><a href="Proxy.html" title="RSpec::Mocks::Proxy (class)">RSpec::Mocks::Proxy</a></li>
          <li class='next'><a href="TestDoubleProxy.html" title="RSpec::Mocks::TestDoubleProxy (class)">RSpec::Mocks::TestDoubleProxy</a></li>
          <li class='next'>RSpec::Mocks::VerifyingProxy</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rspec/rspec-mocks/blob/main/lib/rspec/mocks/verifying_proxy.rb#L71'>rspec-mocks/lib/rspec/mocks/verifying_proxy.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>A verifying proxy mostly acts like a normal proxy, except that it contains extra logic to try and determine the validity of any expectation set on it. This includes whether or not methods have been defined and the validity of arguments on method calls.</p>

<p>In all other ways this behaves like a normal proxy. It only adds the verification behaviour to specific methods then delegates to the parent implementation.</p>

<p>These checks are only activated if the doubled class has already been loaded, otherwise they are disabled. This allows for testing in isolation.</p>

  </div>
</div>
<div class='tags'>
  
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
  <h3 class='inherited'><a href="Proxy.html" title="RSpec::Mocks::Proxy (class)"><code>Proxy</code></a> - Inherited</h3>
  <p  class='inherited'>
    <a class='nodoc' href="Proxy.html#DEFAULT_MESSAGE_EXPECTATION_OPTS-constant" title="RSpec::Mocks::Proxy::DEFAULT_MESSAGE_EXPECTATION_OPTS (constant)">DEFAULT_MESSAGE_EXPECTATION_OPTS</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(object, order_group, doubled_module, method_reference_class)  &#x21d2; VerifyingProxy </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="Proxy.html" title="RSpec::Mocks::Proxy (class)"><code>Proxy</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="Proxy.html#new-class_method" title="RSpec::Mocks::Proxy.new (method)">.new</a>,
        <a class='i_m nodoc' href="Proxy.html#prepended_modules_of-class_method" title="RSpec::Mocks::Proxy.prepended_modules_of (method)">.prepended_modules_of</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>

<h3 class='inherited nodoc'><a href="Proxy.html" title="RSpec::Mocks::Proxy (class)"><code>Proxy</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro nodoc' href="Proxy.html#null_object%3F-instance_method" title="RSpec::Mocks::Proxy#null_object? (method)">#null_object?</a>,
        <a class='i_m ro nodoc' href="Proxy.html#object-instance_method" title="RSpec::Mocks::Proxy#object (method)">#object</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#method_reference-instance_method" title="#method_reference (instance method)">#<strong>method_reference</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#validate_arguments!-instance_method" title="#validate_arguments! (instance method)">#<strong>validate_arguments!</strong>(method_name, args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#visibility_for-instance_method" title="#visibility_for (instance method)">#<strong>visibility_for</strong>(method_name)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="VerifyingProxyMethods.html" title="RSpec::Mocks::VerifyingProxyMethods (module)"><code>VerifyingProxyMethods</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="VerifyingProxyMethods.html#add_message_expectation-instance_method" title="RSpec::Mocks::VerifyingProxyMethods#add_message_expectation (method)">#add_message_expectation</a>,
        <a class='i_m nodoc' href="VerifyingProxyMethods.html#add_simple_stub-instance_method" title="RSpec::Mocks::VerifyingProxyMethods#add_simple_stub (method)">#add_simple_stub</a>,
        <a class='i_m nodoc' href="VerifyingProxyMethods.html#add_stub-instance_method" title="RSpec::Mocks::VerifyingProxyMethods#add_stub (method)">#add_stub</a>,
        <a class='i_m nodoc' href="VerifyingProxyMethods.html#ensure_implemented-instance_method" title="RSpec::Mocks::VerifyingProxyMethods#ensure_implemented (method)">#ensure_implemented</a>,
        <a class='i_m nodoc' href="VerifyingProxyMethods.html#ensure_publicly_implemented-instance_method" title="RSpec::Mocks::VerifyingProxyMethods#ensure_publicly_implemented (method)">#ensure_publicly_implemented</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited nodoc'><a href="TestDoubleProxy.html" title="RSpec::Mocks::TestDoubleProxy (class)"><code>TestDoubleProxy</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="TestDoubleProxy.html#reset-instance_method" title="RSpec::Mocks::TestDoubleProxy#reset (method)">#reset</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited nodoc'><a href="Proxy.html" title="RSpec::Mocks::Proxy (class)"><code>Proxy</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="Proxy.html#add_message_expectation-instance_method" title="RSpec::Mocks::Proxy#add_message_expectation (method)">#add_message_expectation</a>,
        <a class='i_m nodoc' href="Proxy.html#add_simple_expectation-instance_method" title="RSpec::Mocks::Proxy#add_simple_expectation (method)">#add_simple_expectation</a>,
        <a class='i_m nodoc' href="Proxy.html#add_simple_stub-instance_method" title="RSpec::Mocks::Proxy#add_simple_stub (method)">#add_simple_stub</a>,
        <a class='i_m nodoc' href="Proxy.html#add_stub-instance_method" title="RSpec::Mocks::Proxy#add_stub (method)">#add_stub</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="Proxy.html#as_null_object-instance_method" title="RSpec::Mocks::Proxy#as_null_object (method)">#as_null_object</a></td>
      <td><div class='inline'><p>Tells the object to ignore any messages that aren’t explicitly set as stubs or message expectations.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="Proxy.html#build_expectation-instance_method" title="RSpec::Mocks::Proxy#build_expectation (method)">#build_expectation</a>,
        <a class='i_m nodoc' href="Proxy.html#check_for_unexpected_arguments-instance_method" title="RSpec::Mocks::Proxy#check_for_unexpected_arguments (method)">#check_for_unexpected_arguments</a>,
        <a class='i_m nodoc' href="Proxy.html#ensure_can_be_proxied!-instance_method" title="RSpec::Mocks::Proxy#ensure_can_be_proxied! (method)">#ensure_can_be_proxied!</a>,
        <a class='i_m nodoc' href="Proxy.html#ensure_implemented-instance_method" title="RSpec::Mocks::Proxy#ensure_implemented (method)">#ensure_implemented</a>,
        <a class='i_m nodoc' href="Proxy.html#has_negative_expectation%3F-instance_method" title="RSpec::Mocks::Proxy#has_negative_expectation? (method)">#has_negative_expectation?</a>,
        <a class='i_m nodoc' href="Proxy.html#message_received-instance_method" title="RSpec::Mocks::Proxy#message_received (method)">#message_received</a>,
        <a class='i_m nodoc' href="Proxy.html#messages_arg_list-instance_method" title="RSpec::Mocks::Proxy#messages_arg_list (method)">#messages_arg_list</a>,
        <a class='i_m nodoc' href="Proxy.html#method_double_if_exists_for_message-instance_method" title="RSpec::Mocks::Proxy#method_double_if_exists_for_message (method)">#method_double_if_exists_for_message</a>,
        <a class='i_m nodoc' href="Proxy.html#original_method_handle_for-instance_method" title="RSpec::Mocks::Proxy#original_method_handle_for (method)">#original_method_handle_for</a>,
        <a class='i_m nodoc' href="Proxy.html#prepended_modules_of_singleton_class-instance_method" title="RSpec::Mocks::Proxy#prepended_modules_of_singleton_class (method)">#prepended_modules_of_singleton_class</a>,
        <a class='i_m nodoc' href="Proxy.html#raise_missing_default_stub_error-instance_method" title="RSpec::Mocks::Proxy#raise_missing_default_stub_error (method)">#raise_missing_default_stub_error</a>,
        <a class='i_m nodoc' href="Proxy.html#raise_unexpected_message_error-instance_method" title="RSpec::Mocks::Proxy#raise_unexpected_message_error (method)">#raise_unexpected_message_error</a>,
        <a class='i_m nodoc' href="Proxy.html#received_message%3F-instance_method" title="RSpec::Mocks::Proxy#received_message? (method)">#received_message?</a>,
        <a class='i_m nodoc' href="Proxy.html#record_message_received-instance_method" title="RSpec::Mocks::Proxy#record_message_received (method)">#record_message_received</a>,
        <a class='i_m nodoc' href="Proxy.html#remove_stub-instance_method" title="RSpec::Mocks::Proxy#remove_stub (method)">#remove_stub</a>,
        <a class='i_m nodoc' href="Proxy.html#remove_stub_if_present-instance_method" title="RSpec::Mocks::Proxy#remove_stub_if_present (method)">#remove_stub_if_present</a>,
        <a class='i_m nodoc' href="Proxy.html#replay_received_message_on-instance_method" title="RSpec::Mocks::Proxy#replay_received_message_on (method)">#replay_received_message_on</a>,
        <a class='i_m nodoc' href="Proxy.html#reset-instance_method" title="RSpec::Mocks::Proxy#reset (method)">#reset</a>,
        <a class='i_m nodoc' href="Proxy.html#verify-instance_method" title="RSpec::Mocks::Proxy#verify (method)">#verify</a>,
        <a class='i_m nodoc' href="Proxy.html#visibility_for-instance_method" title="RSpec::Mocks::Proxy#visibility_for (method)">#visibility_for</a>,
        <a class='i_m priv nodoc' href="Proxy.html#find_almost_matching_expectation-instance_method" title="RSpec::Mocks::Proxy#find_almost_matching_expectation (method)">#find_almost_matching_expectation</a>,
        <a class='i_m priv nodoc' href="Proxy.html#find_almost_matching_stub-instance_method" title="RSpec::Mocks::Proxy#find_almost_matching_stub (method)">#find_almost_matching_stub</a>,
        <a class='i_m priv nodoc' href="Proxy.html#find_best_matching_expectation_for-instance_method" title="RSpec::Mocks::Proxy#find_best_matching_expectation_for (method)">#find_best_matching_expectation_for</a>,
        <a class='i_m priv nodoc' href="Proxy.html#find_matching_expectation-instance_method" title="RSpec::Mocks::Proxy#find_matching_expectation (method)">#find_matching_expectation</a>,
        <a class='i_m priv nodoc' href="Proxy.html#find_matching_method_stub-instance_method" title="RSpec::Mocks::Proxy#find_matching_method_stub (method)">#find_matching_method_stub</a>,
        <a class='i_m priv nodoc' href="Proxy.html#method_double_for-instance_method" title="RSpec::Mocks::Proxy#method_double_for (method)">#method_double_for</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="method_reference-instance_method">
  <h3 class='signature nodoc first'>
    #<strong>method_reference</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rspec/rspec-mocks/blob/main/lib/rspec/mocks/verifying_proxy.rb#L88-L92'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='88' data-end='92'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'rspec-mocks/lib/rspec/mocks/verifying_proxy.rb', line 88</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_method_reference'>method_reference</span>
  <span class='ivar'>@method_reference</span> <span class='op'>||=</span> <span class='const'>Hash</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="RSpec::Mocks::VerifyingProxy.new (method)">new</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='id identifier rubyid_h'>h</span>[<span class='id identifier rubyid_k'>k</span>] <span class='op'>=</span> <span class='ivar'>@method_reference_class</span>.<span class='id identifier rubyid_for'>for</span>(<span class='ivar'>@doubled_module</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validate_arguments!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>validate_arguments!</strong>(method_name, args)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rspec/rspec-mocks/blob/main/lib/rspec/mocks/verifying_proxy.rb#L98-L100'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='98' data-end='100'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'rspec-mocks/lib/rspec/mocks/verifying_proxy.rb', line 98</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_arguments!'>validate_arguments!</span>(<span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span>)
  <span class='ivar'>@method_doubles</span>[<span class='id identifier rubyid_method_name'>method_name</span>].<span class='id identifier rubyid_validate_arguments!'>validate_arguments!</span>(<span class='id identifier rubyid_args'>args</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="visibility_for-instance_method">
  <h3 class='signature nodoc'>
    #<strong>visibility_for</strong>(method_name)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rspec/rspec-mocks/blob/main/lib/rspec/mocks/verifying_proxy.rb#L94-L96'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='94' data-end='96'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'rspec-mocks/lib/rspec/mocks/verifying_proxy.rb', line 94</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_visibility_for'>visibility_for</span>(<span class='id identifier rubyid_method_name'>method_name</span>)
  <span class='id identifier rubyid_method_reference'><a href="#method_reference-instance_method" title="RSpec::Mocks::VerifyingProxy#method_reference (method)">method_reference</a></span>[<span class='id identifier rubyid_method_name'>method_name</span>].<span class='id identifier rubyid_visibility'>visibility</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>