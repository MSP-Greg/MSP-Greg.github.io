<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActiveSupport::Cache::MemoryStore &mdash; Rails 7-1-stable</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActiveSupport::Cache::MemoryStore",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Rails 7-1-stable</a> &raquo; 
      <a href='../../_index.html#alpha_M'>Index (M)</a> &raquo; 
        <a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a> &raquo; 
        <a href="../Cache.html" title="ActiveSupport::Cache (module)">Cache</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>MemoryStore&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: ActiveSupport::Cache::MemoryStore</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a class='nodoc' href="MemoryStore/DupCoder.html" title="ActiveSupport::Cache::MemoryStore::DupCoder (module)"><code>DupCoder</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Store.html" title="ActiveSupport::Cache::Store (class)">ActiveSupport::Cache::Store</a></span>
        <ul class='fullTree'>
          <li><a href="../../Object.html" title="Object (class)"><code>::Object</code></a></li>
          <li class='next'><a href="Store.html" title="ActiveSupport::Cache::Store (class)">ActiveSupport::Cache::Store</a></li>
          <li class='next'>ActiveSupport::Cache::MemoryStore</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L28'>activesupport/lib/active_support/cache/memory_store.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<h3 id="label-Memory+Cache+Store">Memory Cache Store</h3>

<p>A cache store implementation which stores everything into memory in the same process. If you’re running multiple Ruby on Rails server processes (which is the case if you’re using Phusion Passenger or puma clustered mode), then this means that Rails server process instances won’t be able to share cache data with each other and this may not be the most appropriate cache in that scenario.</p>

<p>This cache has a bounded size specified by the <code>:size</code> options to the initializer (default is 32Mb). When the cache exceeds the allotted size, a cleanup will occur which tries to prune the cache down to three quarters of the maximum size by removing the least recently used entries.</p>

<p>Unlike other <a href="../Cache.html" title="ActiveSupport::Cache (module)"><code>::ActiveSupport::Cache</code></a> store implementations, <code>MemoryStore</code> does not compress values by default. <code>MemoryStore</code> does not benefit from compression as much as other <a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a> implementations, as it does not send data over a network. However, when compression is enabled, it still pays the full cost of compression in terms of cpu use.</p>

<p><code>MemoryStore</code> is thread-safe.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='PER_ENTRY_OVERHEAD-constant' class='summary_signature'>PER_ENTRY_OVERHEAD =</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L191-L191'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 191</a>    <pre class='code ruby'><span class='int'>240</span></pre>
  </li>
</ul>
  <h3 class='inherited'><a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a> - Inherited</h3>
  <p  class='inherited'>
    <a class='priv ' href="Store.html#DEFAULT_POOL_OPTIONS-constant" title="ActiveSupport::Cache::Store::DEFAULT_POOL_OPTIONS (constant)">DEFAULT_POOL_OPTIONS</a>
  </p>
</div>

<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#supports_cache_versioning%3F-class_method" title=".supports_cache_versioning? (class method)">.<strong>supports_cache_versioning?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Advertise cache versioning support.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m rw' href="Store.html#logger-class_method" title="ActiveSupport::Cache::Store.logger (method)">.logger</a>,
        <a class='i_m rw' href="Store.html#raise_on_invalid_cache_expiration_time-class_method" title="ActiveSupport::Cache::Store.raise_on_invalid_cache_expiration_time (method)">.raise_on_invalid_cache_expiration_time</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(options = nil)  &#x21d2; MemoryStore </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>

<h3 class='inherited'><a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#new-class_method" title="ActiveSupport::Cache::Store.new (method)">.new</a></td>
      <td><div class='inline'><p>Creates a new cache.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Store.html#retrieve_pool_options-class_method" title="ActiveSupport::Cache::Store.retrieve_pool_options (method)">.retrieve_pool_options</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#pruning%3F-instance_method" title="#pruning? (instance method)">#<strong>pruning?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true if the cache is currently being pruned.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m rw' href="Store.html#logger-instance_method" title="ActiveSupport::Cache::Store#logger (method)">#logger</a>,
        <a class='i_m ro' href="Store.html#options-instance_method" title="ActiveSupport::Cache::Store#options (method)">#options</a>,
        <a class='i_m rw' href="Store.html#raise_on_invalid_cache_expiration_time-instance_method" title="ActiveSupport::Cache::Store#raise_on_invalid_cache_expiration_time (method)">#raise_on_invalid_cache_expiration_time</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro' href="Store.html#silence%3F-instance_method" title="ActiveSupport::Cache::Store#silence? (method)">#silence?</a></td>
      <td><div class='inline'><p>Alias for <a href="Store.html#silence-instance_method" title="ActiveSupport::Cache::Store#silence (method)">Store#silence</a>.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#cleanup-instance_method" title="#cleanup (instance method)">#<strong>cleanup</strong>(options = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Preemptively iterates through all stored keys and removes the ones which have expired.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#clear-instance_method" title="#clear (instance method)">#<strong>clear</strong>(options = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Delete all data stored in a given cache store.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#decrement-instance_method" title="#decrement (instance method)">#<strong>decrement</strong>(name, amount = 1, options = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Decrement a cached integer value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete_matched-instance_method" title="#delete_matched (instance method)">#<strong>delete_matched</strong>(matcher, options = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Deletes cache entries if the cache key matches a given pattern.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#increment-instance_method" title="#increment (instance method)">#<strong>increment</strong>(name, amount = 1, options = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Increment a cached integer value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#prune-instance_method" title="#prune (instance method)">#<strong>prune</strong>(target_size, max_time = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>To ensure entries fit within the specified memory prune the cache by removing the least recently accessed entries.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#cached_size-instance_method" title="#cached_size (instance method)">#<strong>cached_size</strong>(key, payload)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#delete_entry-instance_method" title="#delete_entry (instance method)">#<strong>delete_entry</strong>(key, **options)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#modify_value-instance_method" title="#modify_value (instance method)">#<strong>modify_value</strong>(name, amount, options)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Modifies the amount of an integer value that is stored in the cache.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#read_entry-instance_method" title="#read_entry (instance method)">#<strong>read_entry</strong>(key, **options)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#write_entry-instance_method" title="#write_entry (instance method)">#<strong>write_entry</strong>(key, entry, **options)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#synchronize-instance_method" title="#synchronize (instance method)">#<strong>synchronize</strong>(&amp;block)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Synchronize calls to the cache.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Store.html" title="ActiveSupport::Cache::Store (class)"><code>Store</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#cleanup-instance_method" title="ActiveSupport::Cache::Store#cleanup (method)">#cleanup</a></td>
      <td><div class='inline'><p>Cleans up the cache by removing expired entries.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#clear-instance_method" title="ActiveSupport::Cache::Store#clear (method)">#clear</a></td>
      <td><div class='inline'><p>Clears the entire cache.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#decrement-instance_method" title="ActiveSupport::Cache::Store#decrement (method)">#decrement</a></td>
      <td><div class='inline'><p>Decrements an integer value in the cache.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#delete-instance_method" title="ActiveSupport::Cache::Store#delete (method)">#delete</a></td>
      <td><div class='inline'><p>Deletes an entry in the cache.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#delete_matched-instance_method" title="ActiveSupport::Cache::Store#delete_matched (method)">#delete_matched</a></td>
      <td><div class='inline'><p>Deletes all entries with keys matching the pattern.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#delete_multi-instance_method" title="ActiveSupport::Cache::Store#delete_multi (method)">#delete_multi</a></td>
      <td><div class='inline'><p>Deletes multiple entries in the cache.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#exist%3F-instance_method" title="ActiveSupport::Cache::Store#exist? (method)">#exist?</a></td>
      <td><div class='inline'><p>Returns <code>true</code> if the cache contains an entry for the given key.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#fetch-instance_method" title="ActiveSupport::Cache::Store#fetch (method)">#fetch</a></td>
      <td><div class='inline'><p>Fetches data from the cache, using the given key.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#fetch_multi-instance_method" title="ActiveSupport::Cache::Store#fetch_multi (method)">#fetch_multi</a></td>
      <td><div class='inline'><p>Fetches data from the cache, using the given keys.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#increment-instance_method" title="ActiveSupport::Cache::Store#increment (method)">#increment</a></td>
      <td><div class='inline'><p>Increments an integer value in the cache.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#mute-instance_method" title="ActiveSupport::Cache::Store#mute (method)">#mute</a></td>
      <td><div class='inline'><p>Silences the logger within a block.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#read-instance_method" title="ActiveSupport::Cache::Store#read (method)">#read</a></td>
      <td><div class='inline'><p>Reads data from the cache, using the given key.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#read_multi-instance_method" title="ActiveSupport::Cache::Store#read_multi (method)">#read_multi</a></td>
      <td><div class='inline'><p>Reads multiple values at once from the cache.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ro' href="Store.html#silence-instance_method" title="ActiveSupport::Cache::Store#silence (method)">#silence</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#silence!-instance_method" title="ActiveSupport::Cache::Store#silence! (method)">#silence!</a></td>
      <td><div class='inline'><p>Silences the logger.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#write-instance_method" title="ActiveSupport::Cache::Store#write (method)">#write</a></td>
      <td><div class='inline'><p>Writes the value to the cache with the key.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Store.html#write_multi-instance_method" title="ActiveSupport::Cache::Store#write_multi (method)">#write_multi</a></td>
      <td><div class='inline'><p><a href="../Cache.html" title="ActiveSupport::Cache (module)"><code>::ActiveSupport::Cache</code></a> Storage API to write multiple values at once.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Store.html#_instrument-instance_method" title="ActiveSupport::Cache::Store#_instrument (method)">#_instrument</a>,
        <a class='i_m priv' href="Store.html#default_serializer-instance_method" title="ActiveSupport::Cache::Store#default_serializer (method)">#default_serializer</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#delete_entry-instance_method" title="ActiveSupport::Cache::Store#delete_entry (method)">#delete_entry</a></td>
      <td><div class='inline'><p>Deletes an entry from the cache implementation.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#delete_multi_entries-instance_method" title="ActiveSupport::Cache::Store#delete_multi_entries (method)">#delete_multi_entries</a></td>
      <td><div class='inline'><p>Deletes multiples entries in the cache implementation.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Store.html#deserialize_entry-instance_method" title="ActiveSupport::Cache::Store#deserialize_entry (method)">#deserialize_entry</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#expanded_key-instance_method" title="ActiveSupport::Cache::Store#expanded_key (method)">#expanded_key</a></td>
      <td><div class='inline'><p>Expands key to be a consistent string value.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Store.html#expanded_version-instance_method" title="ActiveSupport::Cache::Store#expanded_version (method)">#expanded_version</a>,
        <a class='i_m priv' href="Store.html#get_entry_value-instance_method" title="ActiveSupport::Cache::Store#get_entry_value (method)">#get_entry_value</a>,
        <a class='i_m priv' href="Store.html#handle_expired_entry-instance_method" title="ActiveSupport::Cache::Store#handle_expired_entry (method)">#handle_expired_entry</a>,
        <a class='i_m priv' href="Store.html#handle_invalid_expires_in-instance_method" title="ActiveSupport::Cache::Store#handle_invalid_expires_in (method)">#handle_invalid_expires_in</a>,
        <a class='i_m priv' href="Store.html#instrument-instance_method" title="ActiveSupport::Cache::Store#instrument (method)">#instrument</a>,
        <a class='i_m priv' href="Store.html#instrument_multi-instance_method" title="ActiveSupport::Cache::Store#instrument_multi (method)">#instrument_multi</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#key_matcher-instance_method" title="ActiveSupport::Cache::Store#key_matcher (method)">#key_matcher</a></td>
      <td><div class='inline'><p>Adds the namespace defined in the options to a pattern designed to match keys.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#merged_options-instance_method" title="ActiveSupport::Cache::Store#merged_options (method)">#merged_options</a></td>
      <td><div class='inline'><p>Merges the default options with ones specific to a method call.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#namespace_key-instance_method" title="ActiveSupport::Cache::Store#namespace_key (method)">#namespace_key</a></td>
      <td><div class='inline'><p>Prefix the key with a namespace string:</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#normalize_key-instance_method" title="ActiveSupport::Cache::Store#normalize_key (method)">#normalize_key</a></td>
      <td><div class='inline'><p>Expands and namespaces the cache key.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#normalize_options-instance_method" title="ActiveSupport::Cache::Store#normalize_options (method)">#normalize_options</a></td>
      <td><div class='inline'><p>Normalize aliased options to their canonical form.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Store.html#normalize_version-instance_method" title="ActiveSupport::Cache::Store#normalize_version (method)">#normalize_version</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#read_entry-instance_method" title="ActiveSupport::Cache::Store#read_entry (method)">#read_entry</a></td>
      <td><div class='inline'><p>Reads an entry from the cache implementation.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#read_multi_entries-instance_method" title="ActiveSupport::Cache::Store#read_multi_entries (method)">#read_multi_entries</a></td>
      <td><div class='inline'><p>Reads multiple entries from the cache implementation.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Store.html#save_block_result_to_cache-instance_method" title="ActiveSupport::Cache::Store#save_block_result_to_cache (method)">#save_block_result_to_cache</a>,
        <a class='i_m priv' href="Store.html#serialize_entry-instance_method" title="ActiveSupport::Cache::Store#serialize_entry (method)">#serialize_entry</a>,
        <a class='i_m priv' href="Store.html#validate_options-instance_method" title="ActiveSupport::Cache::Store#validate_options (method)">#validate_options</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#write_entry-instance_method" title="ActiveSupport::Cache::Store#write_entry (method)">#write_entry</a></td>
      <td><div class='inline'><p>Writes an entry to the cache implementation.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Store.html#write_multi_entries-instance_method" title="ActiveSupport::Cache::Store#write_multi_entries (method)">#write_multi_entries</a></td>
      <td><div class='inline'><p>Writes multiple entries to the cache implementation.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="Store.html#new_entry-instance_method" title="ActiveSupport::Cache::Store#new_entry (method)">#new_entry</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(options = nil)  &#x21d2; <code>MemoryStore</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L73-L85'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='73' data-end='85'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 73</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_options'>options</span> <span class='op'>||=</span> {}
  <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_coder'>coder</span>] <span class='op'>=</span> <span class='const'><a href="MemoryStore/DupCoder.html" title="ActiveSupport::Cache::MemoryStore::DupCoder (module)">DupCoder</a></span> <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_coder'>coder</span>) <span class='op'>||</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_serializer'>serializer</span>)
  <span class='comment'># Disable compression by default.
</span>  <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_compress'>compress</span>] <span class='op'>||=</span> <span class='kw'>false</span>
  <span class='kw'>super</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='ivar'>@data</span> <span class='op'>=</span> {}
  <span class='ivar'>@max_size</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_size'>size</span>] <span class='op'>||</span> <span class='int'>32</span>.<span class='id identifier rubyid_megabytes'>megabytes</span>
  <span class='ivar'>@max_prune_time</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_max_prune_time'>max_prune_time</span>] <span class='op'>||</span> <span class='int'>2</span>
  <span class='ivar'>@cache_size</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@monitor</span> <span class='op'>=</span> <span class='const'>Monitor</span>.<span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@pruning</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="supports_cache_versioning?-class_method">
  <h3 class='signature ro first'>
    .<strong>supports_cache_versioning?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Advertise cache versioning support.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L88-L90'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='88' data-end='90'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 88</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_supports_cache_versioning?'>supports_cache_versioning?</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="pruning?-instance_method">
  <h3 class='signature ro first'>
    #<strong>pruning?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true if the cache is currently being pruned.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L133-L135'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='133' data-end='135'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 133</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pruning?'>pruning?</span>
  <span class='ivar'>@pruning</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="cached_size-instance_method">
  <h3 class='signature priv first'>
    #<strong>cached_size</strong>(key, payload)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L193-L195'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='193' data-end='195'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 193</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cached_size'>cached_size</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_payload'>payload</span>)
  <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='op'>+</span> <span class='id identifier rubyid_payload'>payload</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='op'>+</span> <span class='const'><a href="#PER_ENTRY_OVERHEAD-constant" title="ActiveSupport::Cache::MemoryStore::PER_ENTRY_OVERHEAD (constant)">PER_ENTRY_OVERHEAD</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cleanup-instance_method">
  <h3 class='signature '>
    #<strong>cleanup</strong>(options = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Preemptively iterates through all stored keys and removes the ones which have expired.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L101-L110'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='101' data-end='110'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 101</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup'>cleanup</span>(<span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_merged_options'>merged_options</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid__instrument'>_instrument</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_cleanup'>cleanup</span><span class='comma'>,</span> <span class='label'>size:</span> <span class='ivar'>@data</span>.<span class='id identifier rubyid_size'>size</span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_keys'>keys</span> <span class='op'>=</span> <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> { <span class='ivar'>@data</span>.<span class='id identifier rubyid_keys'>keys</span> }
    <span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
      <span class='id identifier rubyid_entry'>entry</span> <span class='op'>=</span> <span class='ivar'>@data</span>[<span class='id identifier rubyid_key'>key</span>]
      <span class='id identifier rubyid_delete_entry'><a href="#delete_entry-instance_method" title="ActiveSupport::Cache::MemoryStore#delete_entry (method)">delete_entry</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>) <span class='kw'>if</span> <span class='id identifier rubyid_entry'>entry</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_entry'>entry</span>.<span class='id identifier rubyid_expired?'>expired?</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clear-instance_method">
  <h3 class='signature '>
    #<strong>clear</strong>(options = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Delete all data stored in a given cache store.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L93-L98'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='93' data-end='98'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 93</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clear'>clear</span>(<span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> <span class='kw'>do</span>
    <span class='ivar'>@data</span>.<span class='id identifier rubyid_clear'>clear</span>
    <span class='ivar'>@cache_size</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="decrement-instance_method">
  <h3 class='signature '>
    #<strong>decrement</strong>(name, amount = 1, options = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Decrement a cached integer value. Returns the updated value.</p>

<p>If the key is unset or has expired, it will be set to <code>-amount</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_decrement'>decrement</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; -1</span></code></pre>

<p>To set a specific value, call <code>#write</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_write'>write</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>5</span>)
<span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_decrement'>decrement</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; 4</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L164-L166'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='164' data-end='166'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 164</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_decrement'>decrement</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_amount'>amount</span> <span class='op'>=</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_modify_value'><a href="#modify_value-instance_method" title="ActiveSupport::Cache::MemoryStore#modify_value (method)">modify_value</a></span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>-</span><span class='id identifier rubyid_amount'>amount</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_entry-instance_method">
  <h3 class='signature priv'>
    #<strong>delete_entry</strong>(key, **options)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L226-L232'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='226' data-end='232'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 226</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_entry'>delete_entry</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='ivar'>@data</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_key'>key</span>)
    <span class='ivar'>@cache_size</span> <span class='op'>-=</span> <span class='id identifier rubyid_cached_size'><a href="#cached_size-instance_method" title="ActiveSupport::Cache::MemoryStore#cached_size (method)">cached_size</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_payload'>payload</span>) <span class='kw'>if</span> <span class='id identifier rubyid_payload'>payload</span>
    <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_payload'>payload</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="delete_matched-instance_method">
  <h3 class='signature '>
    #<strong>delete_matched</strong>(matcher, options = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Deletes cache entries if the cache key matches a given pattern.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L169-L178'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='169' data-end='178'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 169</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_matched'>delete_matched</span>(<span class='id identifier rubyid_matcher'>matcher</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_merged_options'>merged_options</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_instrument'>instrument</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_delete_matched'>delete_matched</span><span class='comma'>,</span> <span class='id identifier rubyid_matcher'>matcher</span>.<span class='id identifier rubyid_inspect'><a href="#inspect-instance_method" title="ActiveSupport::Cache::MemoryStore#inspect (method)">inspect</a></span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_matcher'>matcher</span> <span class='op'>=</span> <span class='id identifier rubyid_key_matcher'>key_matcher</span>(<span class='id identifier rubyid_matcher'>matcher</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
    <span class='id identifier rubyid_keys'>keys</span> <span class='op'>=</span> <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> { <span class='ivar'>@data</span>.<span class='id identifier rubyid_keys'>keys</span> }
    <span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
      <span class='id identifier rubyid_delete_entry'><a href="#delete_entry-instance_method" title="ActiveSupport::Cache::MemoryStore#delete_entry (method)">delete_entry</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>) <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_match'>match</span>(<span class='id identifier rubyid_matcher'>matcher</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="increment-instance_method">
  <h3 class='signature '>
    #<strong>increment</strong>(name, amount = 1, options = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Increment a cached integer value. Returns the updated value.</p>

<p>If the key is unset, it will be set to <code>amount</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_increment'>increment</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; 1
</span><span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_increment'>increment</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>100</span>) <span class='comment'># =&gt; 100</span></code></pre>

<p>To set a specific value, call <code>#write</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_write'>write</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>5</span>)
<span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_increment'>increment</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; 6</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L149-L151'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='149' data-end='151'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 149</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_increment'>increment</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_amount'>amount</span> <span class='op'>=</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_modify_value'><a href="#modify_value-instance_method" title="ActiveSupport::Cache::MemoryStore#modify_value (method)">modify_value</a></span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_amount'>amount</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature nodoc'>
    #<strong>inspect</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L180-L182'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='180' data-end='182'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 180</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span> <span class='comment'># :nodoc:
</span>  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> entries=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@data</span>.<span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'>, size=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@cache_size</span><span class='embexpr_end'>}</span><span class='tstring_content'>, options=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@options</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="modify_value-instance_method">
  <h3 class='signature priv'>
    #<strong>modify_value</strong>(name, amount, options)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Modifies the amount of an integer value that is stored in the cache. If the key is not found it is created and set to <code>amount</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L236-L254'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='236' data-end='254'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 236</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_modify_value'>modify_value</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_amount'>amount</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_merged_options'>merged_options</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_key'>key</span>     <span class='op'>=</span> <span class='id identifier rubyid_normalize_key'>normalize_key</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_version'><a href="../../ActiveSupport.html#version-class_method" title="ActiveSupport.version (method)">version</a></span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_version'>normalize_version</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)

  <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_entry'>entry</span> <span class='op'>=</span> <span class='id identifier rubyid_read_entry'><a href="#read_entry-instance_method" title="ActiveSupport::Cache::MemoryStore#read_entry (method)">read_entry</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)

    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_entry'>entry</span> <span class='op'>||</span> <span class='id identifier rubyid_entry'>entry</span>.<span class='id identifier rubyid_expired?'>expired?</span> <span class='op'>||</span> <span class='id identifier rubyid_entry'>entry</span>.<span class='id identifier rubyid_mismatched?'>mismatched?</span>(<span class='id identifier rubyid_version'><a href="../../ActiveSupport.html#version-class_method" title="ActiveSupport.version (method)">version</a></span>)
      <span class='id identifier rubyid_write'>write</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='const'><a href="../../Integer.html" title="Integer (class)">Integer</a></span>(<span class='id identifier rubyid_amount'>amount</span>)<span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
      <span class='id identifier rubyid_amount'>amount</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_num'>num</span> <span class='op'>=</span> <span class='id identifier rubyid_entry'>entry</span>.<span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>+</span> <span class='id identifier rubyid_amount'>amount</span>
      <span class='id identifier rubyid_entry'>entry</span> <span class='op'>=</span> <span class='const'><a href="Entry.html" title="ActiveSupport::Cache::Entry (class)">Entry</a></span>.<span class='id identifier rubyid_new'><a href="Entry.html#new-class_method" title="ActiveSupport::Cache::Entry.new (method)">new</a></span>(<span class='id identifier rubyid_num'>num</span><span class='comma'>,</span> <span class='label'>expires_at:</span> <span class='id identifier rubyid_entry'>entry</span>.<span class='id identifier rubyid_expires_at'>expires_at</span><span class='comma'>,</span> <span class='label'>version:</span> <span class='id identifier rubyid_entry'>entry</span>.<span class='id identifier rubyid_version'><a href="../../ActiveSupport.html#version-class_method" title="ActiveSupport.version (method)">version</a></span>)
      <span class='id identifier rubyid_write_entry'><a href="#write_entry-instance_method" title="ActiveSupport::Cache::MemoryStore#write_entry (method)">write_entry</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_entry'>entry</span>)
      <span class='id identifier rubyid_num'>num</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prune-instance_method">
  <h3 class='signature '>
    #<strong>prune</strong>(target_size, max_time = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>To ensure entries fit within the specified memory prune the cache by removing the least recently accessed entries.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L114-L130'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='114' data-end='130'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 114</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prune'>prune</span>(<span class='id identifier rubyid_target_size'>target_size</span><span class='comma'>,</span> <span class='id identifier rubyid_max_time'>max_time</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_pruning?'><a href="#pruning%3F-instance_method" title="ActiveSupport::Cache::MemoryStore#pruning? (method)">pruning?</a></span>
  <span class='ivar'>@pruning</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_start_time'>start_time</span> <span class='op'>=</span> <span class='const'>Process</span>.<span class='id identifier rubyid_clock_gettime'>clock_gettime</span>(<span class='const'>Process</span><span class='op'>::</span><span class='const'>CLOCK_MONOTONIC</span>)
    <span class='id identifier rubyid_cleanup'><a href="#cleanup-instance_method" title="ActiveSupport::Cache::MemoryStore#cleanup (method)">cleanup</a></span>
    <span class='id identifier rubyid_instrument'>instrument</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_prune'>prune</span><span class='comma'>,</span> <span class='id identifier rubyid_target_size'>target_size</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='ivar'>@cache_size</span>) <span class='kw'>do</span>
      <span class='id identifier rubyid_keys'>keys</span> <span class='op'>=</span> <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> { <span class='ivar'>@data</span>.<span class='id identifier rubyid_keys'>keys</span> }
      <span class='id identifier rubyid_keys'>keys</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
        <span class='id identifier rubyid_delete_entry'><a href="#delete_entry-instance_method" title="ActiveSupport::Cache::MemoryStore#delete_entry (method)">delete_entry</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
        <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@cache_size</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_target_size'>target_size</span> <span class='op'>||</span> (<span class='id identifier rubyid_max_time'>max_time</span> <span class='op'>&amp;&amp;</span> <span class='const'>Process</span>.<span class='id identifier rubyid_clock_gettime'>clock_gettime</span>(<span class='const'>Process</span><span class='op'>::</span><span class='const'>CLOCK_MONOTONIC</span>) <span class='op'>-</span> <span class='id identifier rubyid_start_time'>start_time</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_max_time'>max_time</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>ensure</span>
    <span class='ivar'>@pruning</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="read_entry-instance_method">
  <h3 class='signature priv'>
    #<strong>read_entry</strong>(key, **options)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L197-L207'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='197' data-end='207'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 197</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_read_entry'>read_entry</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_entry'>entry</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='ivar'>@data</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_key'>key</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_payload'>payload</span>
      <span class='ivar'>@data</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span>
      <span class='id identifier rubyid_entry'>entry</span> <span class='op'>=</span> <span class='id identifier rubyid_deserialize_entry'>deserialize_entry</span>(<span class='id identifier rubyid_payload'>payload</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_entry'>entry</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="synchronize-instance_method">
  <h3 class='signature nodoc'>
    #<strong>synchronize</strong>(&amp;block)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Synchronize calls to the cache. This should be called wherever the underlying cache implementation is not thread safe.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L186-L188'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='186' data-end='188'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 186</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_synchronize'>synchronize</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>) <span class='comment'># :nodoc:
</span>  <span class='ivar'>@monitor</span>.<span class='id identifier rubyid_synchronize'>synchronize</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="write_entry-instance_method">
  <h3 class='signature priv'>
    #<strong>write_entry</strong>(key, entry, **options)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/7-1-stable/activesupport/lib/active_support/cache/memory_store.rb#L209-L224'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='209' data-end='224'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/cache/memory_store.rb', line 209</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_write_entry'>write_entry</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_entry'>entry</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='id identifier rubyid_serialize_entry'>serialize_entry</span>(<span class='id identifier rubyid_entry'>entry</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span>)
  <span class='id identifier rubyid_synchronize'><a href="#synchronize-instance_method" title="ActiveSupport::Cache::MemoryStore#synchronize (method)">synchronize</a></span> <span class='kw'>do</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_unless_exist'>unless_exist</span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_exist?'>exist?</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='label'>namespace:</span> <span class='kw'>nil</span>)

    <span class='id identifier rubyid_old_payload'>old_payload</span> <span class='op'>=</span> <span class='ivar'>@data</span>[<span class='id identifier rubyid_key'>key</span>]
    <span class='kw'>if</span> <span class='id identifier rubyid_old_payload'>old_payload</span>
      <span class='ivar'>@cache_size</span> <span class='op'>-=</span> (<span class='id identifier rubyid_old_payload'>old_payload</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='op'>-</span> <span class='id identifier rubyid_payload'>payload</span>.<span class='id identifier rubyid_bytesize'>bytesize</span>)
    <span class='kw'>else</span>
      <span class='ivar'>@cache_size</span> <span class='op'>+=</span> <span class='id identifier rubyid_cached_size'><a href="#cached_size-instance_method" title="ActiveSupport::Cache::MemoryStore#cached_size (method)">cached_size</a></span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_payload'>payload</span>)
    <span class='kw'>end</span>
    <span class='ivar'>@data</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span>
    <span class='id identifier rubyid_prune'><a href="#prune-instance_method" title="ActiveSupport::Cache::MemoryStore#prune (method)">prune</a></span>(<span class='ivar'>@max_size</span> <span class='op'>*</span> <span class='float'>0.75</span><span class='comma'>,</span> <span class='ivar'>@max_prune_time</span>) <span class='kw'>if</span> <span class='ivar'>@cache_size</span> <span class='op'>&gt;</span> <span class='ivar'>@max_size</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>