<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Active Support CHANGELOG &mdash; Rails 8-0-stable</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "active_support_CHANGELOG",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Rails 8-0-stable</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Active Support CHANGELOG&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<ul>
<li><p>Fix <a href="Enumerable.html#sole-instance_method" title="Enumerable#sole (method)">Enumerable#sole</a> to return the full tuple instead of just the first element of the tuple.</p>

<p><em>Olivier Bellone</em></p></li>
<li><p>Fix parallel tests hanging when worker processes die abruptly.</p>

<p>Previously, if a worker process was killed (e.g., OOM killed, <code>kill -9</code>) during parallel
test execution, the test suite would hang forever waiting for the dead worker.</p>

<p><em>Joshua Young</em></p></li>
<li><p>Fix <a href="NameError.html" title="NameError (class)"><code>NameError</code></a> when <code>class_attribute</code> is defined on instance singleton classes.</p>

<p>Previously, calling <code>class_attribute</code> on an instance&#39;s singleton class would raise
a <a href="NameError.html" title="NameError (class)"><code>NameError</code></a> when accessing the attribute through the instance.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_object'>object</span> <span class='op'>=</span> <span class='const'>MyClass</span>.<span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_object'>object</span>.<span class='id identifier rubyid_singleton_class'>singleton_class</span>.<span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_object'>object</span>.<span class='id identifier rubyid_foo'>foo</span> <span class='comment'># previously raised NameError, now returns &quot;bar&quot;</span></code></pre>

<p><em>Joshua Young</em></p></li>
</ul>

<h2>Rails 8.0.3 (September 22, 2025)</h2>

<ul>
<li><p><a href="ActiveSupport/FileUpdateChecker.html" title="ActiveSupport::FileUpdateChecker (class)"><code>::ActiveSupport::FileUpdateChecker</code></a> does not depend on <code>Time.now</code> to prevent unnecessary reloads with time travel test helpers</p>

<p><em>Jan Grodowski</em></p></li>
<li><p>Fix <a href="ActiveSupport/BroadcastLogger.html" title="ActiveSupport::BroadcastLogger (class)"><code>::ActiveSupport::BroadcastLogger</code></a> from executing a block argument for each logger (tagged, info, etc.).</p>

<p><em>Jared Armstrong</em></p></li>
<li><p>Make <a href="ActiveSupport/Logger.html" title="ActiveSupport::Logger (class)"><code>::ActiveSupport::Logger</code></a> <code>#freeze</code>-friendly.</p>

<p><em>Joshua Young</em></p></li>
<li><p>Fix <a href="ActiveSupport/HashWithIndifferentAccess.html#transform_keys!-instance_method" title="ActiveSupport::HashWithIndifferentAccess#transform_keys! (method)">ActiveSupport::HashWithIndifferentAccess#transform_keys!</a> removing defaults.</p>

<p><em>Hartley McGuire</em></p></li>
<li><p>Fix <code>ActiveSupport::HashWithIndifferentAccess#tranform_keys!</code> to handle collisions.</p>

<p>If the transformation would result in a key equal to another not yet transformed one,
it would result in keys being lost.</p>

<p>Before:</p>

<pre class="code ruby"><code class="ruby"><span class='op'>&gt;&gt;</span> {<span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span>}.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>.<span class='id identifier rubyid_transform_keys!'>transform_keys!</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_succ'>succ</span>)
<span class='comment'>#=&gt; {&quot;c&quot; =&gt; 1}</span></code></pre>

<p>After:</p>

<pre class="code ruby"><code class="ruby"><span class='op'>&gt;&gt;</span> {<span class='label'>a:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>b:</span> <span class='int'>2</span>}.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>.<span class='id identifier rubyid_transform_keys!'>transform_keys!</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_succ'>succ</span>)
<span class='comment'>#=&gt; {&quot;b&quot; =&gt; 1, &quot;c&quot; =&gt; 2}</span></code></pre>

<p><em>Jason T Johnson</em>, <em>Jean Boussier</em></p></li>
<li><p>Fix <code>ActiveSupport::Cache::MemCacheStore#read_multi</code> to handle network errors.</p>

<p>This method specifically wasn&#39;t handling network errors like other codepaths.</p>

<p><em>Alessandro Dal Grande</em></p></li>
<li><p>Fix configuring <code>RedisCacheStore</code> with <code>raw: true</code>.</p>

<p><em>fatkodima</em></p></li>
<li><p>Fix <a href="Enumerable.html#sole-instance_method" title="Enumerable#sole (method)">Enumerable#sole</a> for infinite collections.</p>

<p><em>fatkodima</em></p></li>
</ul>

<h2>Rails 8.0.2.1 (August 13, 2025)</h2>

<ul>
<li>  No changes.</li>
</ul>

<h2>Rails 8.0.2 (March 12, 2025)</h2>

<ul>
<li><p>Fix setting <code>to_time_preserves_timezone</code> from <code>new_framework_defaults_8_0.rb</code>.</p>

<p><em>fatkodima</em></p></li>
<li><p>Fix Active Support Cache <code>fetch_multi</code> when local store is active.</p>

<p><code>fetch_multi</code> now properly yield to the provided block for missing entries
that have been recorded as such in the local store.</p>

<p><em>Jean Boussier</em></p></li>
<li><p>Fix execution wrapping to report all exceptions, including <a href="Exception.html" title="Exception (class)"><code>Exception</code></a>.</p>

<p>If a more serious error like <code>SystemStackError</code> or <code>NoMemoryError</code> happens,
the error reporter should be able to report these kinds of exceptions.</p>

<p><em>Gannon McGibbon</em></p></li>
<li><p>Fix <code>RedisCacheStore</code> and <code>MemCacheStore</code> to also handle connection pool related errors.</p>

<p>These errors are rescued and reported to <a href="Rails.html#error-class_method" title="Rails.error (method)">Rails.error</a>.</p>

<p><em>Jean Boussier</em></p></li>
<li><p>Fix <code>ActiveSupport::Cache#read_multi</code> to respect version expiry when using local cache.</p>

<p><em>zzak</em></p></li>
<li><p>Fix <a href="ActiveSupport/MessageVerifier.html" title="ActiveSupport::MessageVerifier (class)"><code>::ActiveSupport::MessageVerifier</code></a> and <a href="ActiveSupport/MessageEncryptor.html" title="ActiveSupport::MessageEncryptor (class)"><code>::ActiveSupport::MessageEncryptor</code></a> configuration of <code>on_rotation</code> callback.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_verifier'>verifier</span>.<span class='id identifier rubyid_rotate'>rotate</span>(<span class='id identifier rubyid_old_secret'>old_secret</span>).<span class='id identifier rubyid_on_rotation'>on_rotation</span> { <span class='op'>...</span> }</code></pre>

<p>Now both work as documented.</p>

<p><em>Jean Boussier</em></p></li>
<li><p>Fix <a href="ActiveSupport/MessageVerifier.html" title="ActiveSupport::MessageVerifier (class)"><code>::ActiveSupport::MessageVerifier</code></a> to always be able to verify both URL-safe and URL-unsafe payloads.</p>

<p>This is to allow transitioning seemlessly from either configuration without immediately invalidating
all previously generated signed messages.</p>

<p><em>Jean Boussier</em>, <em>Florent Beaurain</em>, <em>Ali Sepehri</em></p></li>
<li><p>Fix <code>cache.fetch</code> to honor the provided expiry when <code>:race_condition_ttl</code> is used.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cache'>cache</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>expires_in:</span> <span class='int'>1</span>.<span class='id identifier rubyid_hour'>hour</span><span class='comma'>,</span> <span class='label'>race_condition_ttl:</span> <span class='int'>5</span>.<span class='id identifier rubyid_second'>second</span>) <span class='kw'>do</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>something</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>

<p>In the above example, the final cache entry would have a 10 seconds TTL instead
of the requested 1 hour.</p>

<p><em>Dhia</em></p></li>
<li><p>Better handle procs with splat arguments in <code>set_callback</code>.</p>

<p><em>Radamés Roriz</em></p></li>
<li><p>Fix <a href="String.html#mb_chars-instance_method" title="String#mb_chars (method)">String#mb_chars</a> to not mutate the receiver.</p>

<p>Previously it would call <code>force_encoding</code> on the receiver,
now it dups the receiver first.</p>

<p><em>Jean Boussier</em></p></li>
<li><p>Improve <code>ErrorSubscriber</code> to also mark error causes as reported.</p>

<p>This avoid some cases of errors being reported twice, notably in views because of how
errors are wrapped in <a href="ActionView/Template/Error.html" title="ActionView::Template::Error (class)"><code>::ActionView::Template::Error</code></a>.</p>

<p><em>Jean Boussier</em></p></li>
<li><p>Fix <a href="Module.html#module_parent_name-instance_method" title="Module#module_parent_name (method)">Module#module_parent_name</a> to return the correct name after the module has been named.</p>

<p>When called on an anonymous module, the return value wouldn&#39;t change after the module was given a name
later by being assigned to a constant.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mod'>mod</span> <span class='op'>=</span> <span class='const'><a href="Module.html" title="Module (class)">Module</a></span>.<span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_mod'>mod</span>.<span class='id identifier rubyid_module_parent_name'>module_parent_name</span> <span class='comment'># =&gt; &quot;Object&quot;
</span><span class='const'>MyModule</span><span class='op'>::</span><span class='const'>Something</span> <span class='op'>=</span> <span class='id identifier rubyid_mod'>mod</span>
<span class='id identifier rubyid_mod'>mod</span>.<span class='id identifier rubyid_module_parent_name'>module_parent_name</span> <span class='comment'># =&gt; &quot;MyModule&quot;</span></code></pre>

<p><em>Jean Boussier</em></p></li>
</ul>

<h2>Rails 8.0.1 (December 13, 2024)</h2>

<ul>
<li><p>Fix a bug in <a href="ERB/Util.html#tokenize-class_method" title="ERB::Util.tokenize (method)">ERB::Util.tokenize</a> that causes incorrect tokenization when <a href="ERB.html" title="ERB (class)"><code>ERB</code></a> tags are preceeded by multibyte characters.</p>

<p><em>Martin Emde</em></p></li>
<li><p>Restore the ability to decorate methods generated by <code>class_attribute</code>.</p>

<p>It always has been complicated to use Module#prepend or an alias method chain
to decorate methods defined by <code>class_attribute</code>, but became even harder in 8.0.</p>

<p>This capability is now supported for both reader and writer methods.</p>

<p><em>Jean Boussier</em></p></li>
</ul>

<h2>Rails 8.0.0.1 (December 10, 2024)</h2>

<ul>
<li>  No changes.</li>
</ul>

<h2>Rails 8.0.0 (November 07, 2024)</h2>

<ul>
<li>  No changes.</li>
</ul>

<h2>Rails 8.0.0.rc2 (October 30, 2024)</h2>

<ul>
<li>  No changes.</li>
</ul>

<h2>Rails 8.0.0.rc1 (October 19, 2024)</h2>

<ul>
<li><p>Remove deprecated support to passing an array of strings to <code>ActiveSupport::Deprecation#warn</code>.</p>

<p><em>Rafael Mendonça França</em></p></li>
<li><p>Remove deprecated support to setting <code>attr_internal_naming_format</code> with a <code>@</code> prefix.</p>

<p><em>Rafael Mendonça França</em></p></li>
<li><p>Remove deprecated <code>ActiveSupport::ProxyObject</code>.</p>

<p><em>Rafael Mendonça França</em></p></li>
<li><p>Don&#39;t execute i18n watcher on boot. It shouldn&#39;t catch any file changes initially,
and unnecessarily slows down boot of applications with lots of translations.</p>

<p><em>Gannon McGibbon</em>, <em>David Stosik</em></p></li>
<li><p>Fix <code>ActiveSupport::HashWithIndifferentAccess#stringify_keys</code> to stringify all keys not just symbols.</p>

<p>Previously:</p>

<pre class="code ruby"><code class="ruby">{ <span class='int'>1</span> <span class='op'>=&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>.<span class='id identifier rubyid_stringify_keys'>stringify_keys</span>[<span class='int'>1</span>] <span class='comment'># =&gt; 2</span></code></pre>

<p>After this change:</p>

<pre class="code ruby"><code class="ruby">{ <span class='int'>1</span> <span class='op'>=&gt;</span> <span class='int'>2</span> }.<span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>.<span class='id identifier rubyid_stringify_keys'>stringify_keys</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>] <span class='comment'># =&gt; 2</span></code></pre>

<p>This change can be seen as a bug fix, but since it behaved like this for a very long time, we&#39;re deciding
to not backport the fix and to make the change in a major release.</p>

<p><em>Jean Boussier</em></p></li>
</ul>

<h2>Rails 8.0.0.beta1 (September 26, 2024)</h2>

<ul>
<li><p>Include options when instrumenting <a href="ActiveSupport/Cache/Store.html#delete-instance_method" title="ActiveSupport::Cache::Store#delete (method)">ActiveSupport::Cache::Store#delete</a> and <a href="ActiveSupport/Cache/Store.html#delete_multi-instance_method" title="ActiveSupport::Cache::Store#delete_multi (method)">ActiveSupport::Cache::Store#delete_multi</a>.</p>

<p><em>Adam Renberg Tamm</em></p></li>
<li><p>Print test names when running <code>rails test -v</code> for parallel tests.</p>

<p><em>John Hawthorn</em>, <em>Abeid Ahmed</em></p></li>
<li><p>Deprecate <a href="Benchmark.html#ms-class_method" title="Benchmark.ms (method)">Benchmark.ms</a> core extension.</p>

<p>The <code>benchmark</code> gem will become bundled in Ruby 3.5</p>

<p><em>Earlopain</em></p></li>
<li><p><a href="ActiveSupport/TimeWithZone.html#inspect-instance_method" title="ActiveSupport::TimeWithZone#inspect (method)">ActiveSupport::TimeWithZone#inspect</a> now uses ISO 8601 style time like <code>Time#inspect</code></p>

<p><em>John Hawthorn</em></p></li>
<li><p><a href="ActiveSupport/ErrorReporter.html#report-instance_method" title="ActiveSupport::ErrorReporter#report (method)">ActiveSupport::ErrorReporter#report</a> now assigns a backtrace to unraised exceptions.</p>

<p>Previously reporting an un-raised exception would result in an error report without
a backtrace. Now it automatically generates one.</p>

<p><em>Jean Boussier</em></p></li>
<li><p>Add <code>escape_html_entities</code> option to <a href="ActiveSupport/JSON.html#encode-class_method" title="ActiveSupport::JSON.encode (method)">ActiveSupport::JSON.encode</a>.</p>

<p>This allows for overriding the global configuration found at
<a href="ActiveSupport.html#escape_html_entities_in_json-instance_method" title="ActiveSupport#escape_html_entities_in_json (method)">ActiveSupport#escape_html_entities_in_json</a> for specific calls to <code>to_json</code>.</p>

<p>This should be usable from controllers in the following manner:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>MyController</span> <span class='op'>&lt;</span> <span class='const'>ApplicationController</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_index'>index</span>
    <span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> { <span class='label'>hello:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>world</span><span class='tstring_end'>&quot;</span></span> }<span class='comma'>,</span> <span class='label'>escape_html_entities:</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p><em>Nigel Baillie</em></p></li>
<li><p>Raise when using key which can&#39;t respond to <code>#to_sym</code> in <code>EncryptedConfiguration</code>.</p>

<p>As is the case when trying to use an Integer or Float as a key, which is unsupported.</p>

<p><em>zzak</em></p></li>
<li><p>Deprecate addition and since between two <a href="Time.html" title="Time (class)"><code>Time</code></a> and <a href="ActiveSupport/TimeWithZone.html" title="ActiveSupport::TimeWithZone (class)"><code>::ActiveSupport::TimeWithZone</code></a>.</p>

<p>Previously adding time instances together such as <code>10.days.ago + 10.days.ago</code> or <code>10.days.ago.since(10.days.ago)</code> produced a nonsensical future date. This behavior is deprecated and will be removed in Rails 8.1.</p>

<p><em>Nick Schwaderer</em></p></li>
<li><p>Support rfc2822 format for Time#to_fs &amp; Date#to_fs.</p>

<p><em>Akshay Birajdar</em></p></li>
<li><p>Optimize load time for <code>Railtie#initialize_i18n</code>. Filter <code>I18n.load_path</code>s passed to the file watcher to only those
under <a href="Rails.html#root-class_method" title="Rails.root (method)">Rails.root</a>. Previously the watcher would grab all available locales, including those in gems
which do not require a watcher because they won&#39;t change.</p>

<p><em>Nick Schwaderer</em></p></li>
<li><p>Add a <code>filter</code> option to <code>in_order_of</code> to prioritize certain values in the sorting without filtering the results
by these values.</p>

<p><em>Igor Depolli</em></p></li>
<li><p>Improve error message when using <code>assert_difference</code> or <code>assert_changes</code> with a
proc by printing the proc&#39;s source code (MRI only).</p>

<p><em>Richard Böhme</em>, <em>Jean Boussier</em></p></li>
<li><p>Add a new configuration value <code>:zone</code> for <a href="ActiveSupport.html#to_time_preserves_timezone-class_method" title="ActiveSupport.to_time_preserves_timezone (method)">ActiveSupport.to_time_preserves_timezone</a> and rename the previous <code>true</code> value to <code>:offset</code>. The new default value is <code>:zone</code>.</p>

<p><em>Jason Kim</em>, <em>John Hawthorn</em></p></li>
<li><p>Align instrumentation <code>payload[:key]</code> in <a href="ActiveSupport/Cache.html" title="ActiveSupport::Cache (module)"><code>::ActiveSupport::Cache</code></a> to follow the same pattern, with namespaced and normalized keys.</p>

<p><em>Frederik Erbs Spang Thomsen</em></p></li>
<li><p>Fix <code>travel_to</code> to set usec 0 when <code>with_usec</code> is <code>false</code> and the given argument <a href="String.html" title="String (class)"><code>String</code></a> or <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a>.</p>

<p><em>mopp</em></p></li>
</ul>

<p>Please check [7-2-stable]) for previous changes.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>