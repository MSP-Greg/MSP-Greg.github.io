<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: 7.0 Release Notes &mdash; Rails 8-1-stable</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "7_0_release_notes",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Rails 8-1-stable</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: 7.0 Release Notes&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1>Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.0 Release Notes</h1>

<p>Highlights in <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.0:</p>

<ul>
<li>Ruby 2.7.0+ required, Ruby 3.0+ preferred</li>
</ul>

<hr>

<h2>Upgrading to <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.0</h2>

<p>If you&#39;re upgrading an existing application, it&#39;s a great idea to have good test
coverage before going in. You should also first upgrade to <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 6.1 in case you
haven&#39;t and make sure your application still runs as expected before attempting
an update to <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.0. A list of things to watch out for when upgrading is
available in the
<a href="upgrading_ruby_on_rails.html#upgrading-from-rails-6-1-to-rails-7-0">Upgrading Ruby on Rails</a>
guide.</p>

<h2>Major Features</h2>

<h2>Railties</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/railties/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li>  Remove deprecated <code>config</code> in <code>dbconsole</code>.</li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p>Sprockets is now an optional dependency</p>

<p>The gem <code>rails</code> doesn&#39;t depend on <code>sprockets-rails</code> anymore. If your application still needs to use Sprockets,
make sure to add <code>sprockets-rails</code> to your Gemfile.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sprockets-rails</span><span class='tstring_end'>&quot;</span></span></code></pre></li>
</ul>

<h2>Action Cable</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/actioncable/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Action Pack</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/actionpack/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated <code>ActionDispatch::Response.return_only_media_type_on_content_type</code>.</p></li>
<li><p>Remove deprecated <code>Rails.config.action_dispatch.hosts_response_app</code>.</p></li>
<li><p>Remove deprecated <code>ActionDispatch::SystemTestCase#host!</code>.</p></li>
<li><p>Remove deprecated support to passing a path to <code>fixture_file_upload</code> relative to <code>fixture_path</code>.</p></li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Action View</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/actionview/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li>  Remove deprecated <code>Rails.config.action_view.raise_on_missing_translations</code>.</li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p><code>button_to</code> infers HTTP verb [method] from an Active Record object if object is used to build URL</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_button_to'>button_to</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Do a POST</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_do_post_action'>do_post_action</span><span class='comma'>,</span> <span class='const'>Workshop</span>.<span class='id identifier rubyid_find'>find</span>(<span class='int'>1</span>)])
<span class='comment'># Before
</span><span class='comment'>#=&gt;   &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;post&quot; autocomplete=&quot;off&quot; /&gt;
</span><span class='comment'># After
</span><span class='comment'>#=&gt;   &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;patch&quot; autocomplete=&quot;off&quot; /&gt;</span></code></pre></li>
</ul>

<h2>Action Mailer</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/actionmailer/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li>  Remove deprecated <code>ActionMailer::DeliveryJob</code> and <code>ActionMailer::Parameterized::DeliveryJob</code>
in favor of <a href="ActionMailer/MailDeliveryJob.html" title="ActionMailer::MailDeliveryJob (class)"><code>::ActionMailer::MailDeliveryJob</code></a>.</li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Active Record</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/activerecord/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated <code>database</code> kwarg from <code>connected_to</code>.</p></li>
<li><p>Remove deprecated  <code>ActiveRecord::Base.allow_unsafe_raw_sql</code>.</p></li>
<li><p>Remove deprecated option <code>:spec_name</code> in the <code>configs_for</code> method.</p></li>
<li><p>Remove deprecated support to YAML load <a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)"><code>::ActiveRecord::Base</code></a> instance in the <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 4.2 and 4.1 formats.</p></li>
<li><p>Remove deprecation warning when <code>:interval</code> column is used in PostgreSQL database.</p>

<p>Now, interval columns will return <a href="ActiveSupport/Duration.html" title="ActiveSupport::Duration (class)"><code>::ActiveSupport::Duration</code></a> objects instead of strings.</p>

<p>To keep the old behavior, you can add this line to your model:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_attribute'>attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_column'>column</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_string'>string</span></code></pre></li>
<li><p>Remove deprecated support to resolve connection using <code>&quot;primary&quot;</code> as connection specification name.</p></li>
<li><p>Remove deprecated support to quote <a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)"><code>::ActiveRecord::Base</code></a> objects.</p></li>
<li><p>Remove deprecated support to type cast to database values <a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)"><code>::ActiveRecord::Base</code></a> objects.</p></li>
<li><p>Remove deprecated support to pass a column to <code>type_cast</code>.</p></li>
<li><p>Remove deprecated <code>DatabaseConfig#config</code> method.</p></li>
<li><p>Remove deprecated rake tasks:</p>

<ul>
<li><code>db:schema:load_if_ruby</code></li>
<li><code>db:structure:dump</code></li>
<li><code>db:structure:load</code></li>
<li><code>db:structure:load_if_sql</code></li>
<li><code>db:structure:dump:#{name}</code></li>
<li><code>db:structure:load:#{name}</code></li>
<li><code>db:test:load_structure</code></li>
<li><code>db:test:load_structure:#{name}</code></li>
</ul></li>
<li><p>Remove deprecated support to <code>Model.reorder(nil).first</code> to search using non-deterministic order.</p></li>
<li><p>Remove deprecated <code>environment</code> and <code>name</code> arguments from <code>Tasks::DatabaseTasks.schema_up_to_date?</code>.</p></li>
<li><p>Remove deprecated <code>Tasks::DatabaseTasks.dump_filename</code>.</p></li>
<li><p>Remove deprecated <code>Tasks::DatabaseTasks.schema_file</code>.</p></li>
<li><p>Remove deprecated <code>Tasks::DatabaseTasks.spec</code>.</p></li>
<li><p>Remove deprecated <code>Tasks::DatabaseTasks.current_config</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Connection#allowed_index_name_length</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Connection#in_clause_length</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::DatabaseConfigurations::DatabaseConfig#spec_name</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Base.connection_config</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Base.arel_attribute</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Base.configurations.default_hash</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Base.configurations.to_h</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Result#map!</code> and <code>ActiveRecord::Result#collect!</code>.</p></li>
<li><p>Remove deprecated <code>ActiveRecord::Base#remove_connection</code>.</p></li>
</ul>

<h3>Deprecations</h3>

<ul>
<li>  Deprecated <code>Tasks::DatabaseTasks.schema_file_type</code>.</li>
</ul>

<h3>Notable changes</h3>

<ul>
<li><p>Rollback transactions when the block returns earlier than expected.</p>

<p>Before this change, when a transaction block returned early, the transaction would be committed.</p>

<p>The problem is that timeouts triggered inside the transaction block was also making the incomplete transaction
to be committed, so in order to avoid this mistake, the transaction block is rolled back.</p></li>
<li><p>Merging conditions on the same column no longer maintain both conditions,
and will be consistently replaced by the latter condition.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Rails 6.1 (IN clause is replaced by merger side equality condition)
</span><span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> [<span class='id identifier rubyid_david'>david</span>.<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_mary'>mary</span>.<span class='id identifier rubyid_id'>id</span>]).<span class='id identifier rubyid_merge'>merge</span>(<span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_bob'>bob</span>)) <span class='comment'># =&gt; [bob]
</span><span class='comment'># Rails 6.1 (both conflict conditions exists, deprecated)
</span><span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_david'>david</span>.<span class='id identifier rubyid_id'>id</span><span class='op'>..</span><span class='id identifier rubyid_mary'>mary</span>.<span class='id identifier rubyid_id'>id</span>).<span class='id identifier rubyid_merge'>merge</span>(<span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_bob'>bob</span>)) <span class='comment'># =&gt; []
</span><span class='comment'># Rails 6.1 with rewhere to migrate to Rails 7.0&#39;s behavior
</span><span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_david'>david</span>.<span class='id identifier rubyid_id'>id</span><span class='op'>..</span><span class='id identifier rubyid_mary'>mary</span>.<span class='id identifier rubyid_id'>id</span>).<span class='id identifier rubyid_merge'>merge</span>(<span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_bob'>bob</span>)<span class='comma'>,</span> <span class='label'>rewhere:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; [bob]
</span><span class='comment'># Rails 7.0 (same behavior with IN clause, mergee side condition is consistently replaced)
</span><span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> [<span class='id identifier rubyid_david'>david</span>.<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_mary'>mary</span>.<span class='id identifier rubyid_id'>id</span>]).<span class='id identifier rubyid_merge'>merge</span>(<span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_bob'>bob</span>)) <span class='comment'># =&gt; [bob]
</span><span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_david'>david</span>.<span class='id identifier rubyid_id'>id</span><span class='op'>..</span><span class='id identifier rubyid_mary'>mary</span>.<span class='id identifier rubyid_id'>id</span>).<span class='id identifier rubyid_merge'>merge</span>(<span class='const'>Author</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>id:</span> <span class='id identifier rubyid_bob'>bob</span>)) <span class='comment'># =&gt; [bob]</span></code></pre></li>
</ul>

<h2>Active Storage</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/activestorage/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Active Model</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/activemodel/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated enumeration of <a href="ActiveModel/Errors.html" title="ActiveModel::Errors (class)"><code>::ActiveModel::Errors</code></a> instances as a <a href="Hash.html" title="Hash (class)"><code>Hash</code></a>.</p></li>
<li><p>Remove deprecated <code>ActiveModel::Errors#to_h</code>.</p></li>
<li><p>Remove deprecated <code>ActiveModel::Errors#slice!</code>.</p></li>
<li><p>Remove deprecated <code>ActiveModel::Errors#values</code>.</p></li>
<li><p>Remove deprecated <code>ActiveModel::Errors#keys</code>.</p></li>
<li><p>Remove deprecated <code>ActiveModel::Errors#to_xml</code>.</p></li>
<li><p>Remove deprecated support concat errors to <a href="ActiveModel/Errors.html#messages-instance_method" title="ActiveModel::Errors#messages (method)">ActiveModel::Errors#messages</a>.</p></li>
<li><p>Remove deprecated support to <code>clear</code> errors from <a href="ActiveModel/Errors.html#messages-instance_method" title="ActiveModel::Errors#messages (method)">ActiveModel::Errors#messages</a>.</p></li>
<li><p>Remove deprecated support to <code>delete</code> errors from <a href="ActiveModel/Errors.html#messages-instance_method" title="ActiveModel::Errors#messages (method)">ActiveModel::Errors#messages</a>.</p></li>
<li><p>Remove deprecated support to use <code>[]=</code> in <a href="ActiveModel/Errors.html#messages-instance_method" title="ActiveModel::Errors#messages (method)">ActiveModel::Errors#messages</a>.</p></li>
<li><p>Remove support to Marshal and YAML load <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 5.x error format.</p></li>
<li><p>Remove support to Marshal load <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 5.x <a href="ActiveModel/AttributeSet.html" title="ActiveModel::AttributeSet (class)"><code>::ActiveModel::AttributeSet</code></a> format.</p></li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Active Support</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/activesupport/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated <code>config.active_support.use_sha1_digests</code>.</p></li>
<li><p>Remove deprecated <code>URI.parser</code>.</p></li>
<li><p>Remove deprecated support to use <code>Range#include?</code> to check the inclusion of a value in
a date time range is deprecated.</p></li>
<li><p>Remove deprecated <code>ActiveSupport::Multibyte::Unicode.default_normalization_form</code>.</p></li>
</ul>

<h3>Deprecations</h3>

<ul>
<li><p>Deprecate passing a format to <code>#to_s</code> in favor of <code>#to_fs</code> in <a href="Array.html" title="Array (class)"><code>Array</code></a>, <a href="Range.html" title="Range (class)"><code>Range</code></a>, <a href="Date.html" title="Date (class)"><code>Date</code></a>, <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a>, <a href="Time.html" title="Time (class)"><code>Time</code></a>,
<a href="BigDecimal.html" title="BigDecimal (class)"><code>BigDecimal</code></a>, <a href="Float.html" title="Float (class)"><code>Float</code></a> and, <a href="Integer.html" title="Integer (class)"><code>Integer</code></a>.</p>

<p>This deprecation is to allow Rails application to take advantage of a Ruby 3.1
<a href="https://github.com/ruby/ruby/commit/b08dacfea39ad8da3f1fd7fdd0e4538cc892ec44">optimization</a> that makes
interpolation of some types of objects faster.</p>

<p>New applications will not have the <code>#to_s</code> method overridden on those classes, existing applications can use
<code>config.active_support.disable_to_s_conversion</code>.</p></li>
</ul>

<h3>Notable changes</h3>

<h2>Active Job</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/activejob/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Removed deprecated behavior that was not halting <code>after_enqueue</code>/<code>after_perform</code> callbacks when a
previous callback was halted with <code>throw :abort</code>.</p></li>
<li><p>Remove deprecated <code>:return_false_on_aborted_enqueue</code> option.</p></li>
</ul>

<h3>Deprecations</h3>

<ul>
<li>  Deprecated <code>Rails.config.active_job.skip_after_callbacks_if_terminated</code>.</li>
</ul>

<h3>Notable changes</h3>

<h2>Action Text</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/actiontext/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Action Mailbox</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/actionmailbox/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Removed deprecated <code>Rails.application.credentials.action_mailbox.mailgun_api_key</code>.</p></li>
<li><p>Removed deprecated environment variable <code>MAILGUN_INGRESS_API_KEY</code>.</p></li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> Guides</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-0-stable/guides/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Notable changes</h3>

<h2>Credits</h2>

<p>See the
<a href="https://contributors.rubyonrails.org/">full list of contributors to Rails</a>
for the many people who spent many hours making <a href="Rails.html" title="Rails (module)"><code>Rails</code></a>, the stable and robust
framework it is. Kudos to all of them.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>