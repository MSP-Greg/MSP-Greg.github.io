<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Sinatra::Helpers &mdash; Sinatra main</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Sinatra::Helpers",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Sinatra main</a> &raquo; 
      <a href='../_index.html#alpha_H'>Index (H)</a> &raquo; 
        <a href="../Sinatra.html" title="Sinatra (module)">Sinatra</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Helpers&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Sinatra::Helpers</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Helpers/Stream.html" title="Sinatra::Helpers::Stream (class)"><code>Stream</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="Application.html" title="Sinatra::Application (class)"><code>Application</code></a>,
          <a href="Base.html" title="Sinatra::Base (class)"><code>Base</code></a>
      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L283'>lib/sinatra/base.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    <p>Methods available to routes, before/after filters, and views.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ETAG_KINDS-constant' class='summary_signature'>ETAG_KINDS =</span>
    <br/>
    <a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L610-L610'># File 'lib/sinatra/base.rb', line 610</a>    <pre class='code ruby'><span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>strong</span><span class='words_sep'> </span><span class='tstring_content'>weak</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='MULTIPART_FORM_DATA_REPLACEMENT_TABLE-constant' class='summary_signature'>MULTIPART_FORM_DATA_REPLACEMENT_TABLE =</span>
    <div class='docstring'>
  <div class='discussion'>
    <p><a href="https://html.spec.whatwg.org/#multipart-form-data">https://html.spec.whatwg.org/#multipart-form-data</a></p>

  </div>
</div>
    <a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L406-L410'># File 'lib/sinatra/base.rb', line 406</a>    <pre class='code ruby'>{
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%22</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%0D</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%0A</span><span class='tstring_end'>&#39;</span></span>
}.<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#bad_request%3F-instance_method" title="#bad_request? (instance method)">#<strong>bad_request?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>whether or not the status is set to 400.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#client_error%3F-instance_method" title="#client_error? (instance method)">#<strong>client_error?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>whether or not the status is set to 4xx.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#informational%3F-instance_method" title="#informational? (instance method)">#<strong>informational?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>whether or not the status is set to 1xx.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#not_found%3F-instance_method" title="#not_found? (instance method)">#<strong>not_found?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>whether or not the status is set to 404.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#redirect%3F-instance_method" title="#redirect? (instance method)">#<strong>redirect?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>whether or not the status is set to 3xx.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#server_error%3F-instance_method" title="#server_error? (instance method)">#<strong>server_error?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>whether or not the status is set to 5xx.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#success%3F-instance_method" title="#success? (instance method)">#<strong>success?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>whether or not the status is set to 2xx.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#attachment-instance_method" title="#attachment (instance method)">#<strong>attachment</strong>(filename = nil, disposition = :attachment)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the Content-Disposition to &quot;attachment&quot; with the specified filename, instructing the user agents to prompt to save.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#back-instance_method" title="#back (instance method)">#<strong>back</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sugar for redirect (example:  redirect back).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#body-instance_method" title="#body (instance method)">#<strong>body</strong>(value = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set or retrieve the response body.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#cache_control-instance_method" title="#cache_control (instance method)">#<strong>cache_control</strong>(*values)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specify response freshness policy for HTTP caches (Cache-Control header).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#content_type-instance_method" title="#content_type (instance method)">#<strong>content_type</strong>(type = nil, params = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the content-type of the response body given a media type or file extension.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#error-instance_method" title="#error (instance method)">#<strong>error</strong>(code, body = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Halt processing and return the error status provided.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#etag-instance_method" title="#etag (instance method)">#<strong>etag</strong>(value, options = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the response entity tag (HTTP &#39;ETag&#39; header) and halt if conditional GET matches.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#expires-instance_method" title="#expires (instance method)">#<strong>expires</strong>(amount, *values)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the Expires header and Cache-Control/max-age directive.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#headers-instance_method" title="#headers (instance method)">#<strong>headers</strong>(hash = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set multiple response headers with Hash.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#last_modified-instance_method" title="#last_modified (instance method)">#<strong>last_modified</strong>(time)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the last modified time of the resource (HTTP &#39;Last-Modified&#39; header) and halt if conditional GET matches.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Access shared logger object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#mime_type-instance_method" title="#mime_type (instance method)">#<strong>mime_type</strong>(type)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Look up a media type by file extension in Rack&#39;s mime registry.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#not_found-instance_method" title="#not_found (instance method)">#<strong>not_found</strong>(body = nil)  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Halt processing and return a 404 Not Found.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#redirect-instance_method" title="#redirect (instance method)">#<strong>redirect</strong>(uri, *args)  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Halt processing and redirect to the URI provided.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#send_file-instance_method" title="#send_file (instance method)">#<strong>send_file</strong>(path, opts = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Use the contents of the file at <code>path</code> as the response body.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#session-instance_method" title="#session (instance method)">#<strong>session</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Access the underlying <a href="../Rack.html" title="Rack (module)"><code>::Rack</code></a> session.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#status-instance_method" title="#status (instance method)">#<strong>status</strong>(value = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set or retrieve the response status code.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stream-instance_method" title="#stream (instance method)">#<strong>stream</strong>(keep_open = false)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows to start sending data to the client even though later parts of the response body have not yet been generated.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#time_for-instance_method" title="#time_for (instance method)">#<strong>time_for</strong>(value)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Generates a Time object from the given value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to-instance_method" title="#to (instance method)">#<strong>to</strong>(addr = nil, absolute = true, add_script_name = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">#uri</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#uri-instance_method" title="#uri (instance method)">#<strong>uri</strong>(addr = nil, absolute = true, add_script_name = true)  </a>
      (also: #url, #to)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Generates the absolute URI for a given path in the app.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#url-instance_method" title="#url (instance method)">#<strong>url</strong>(addr = nil, absolute = true, add_script_name = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">#uri</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#etag_matches%3F-instance_method" title="#etag_matches? (instance method)">#<strong>etag_matches?</strong>(list, new_resource = request.post?)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Helper method checking if a ETag value list includes the current ETag.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#with_params-instance_method" title="#with_params (instance method)">#<strong>with_params</strong>(temp_params)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="bad_request?-instance_method">
  <h3 class='signature ro first'>
    #<strong>bad_request?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>whether or not the status is set to 400</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L685-L687'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='685' data-end='687'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 685</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bad_request?'>bad_request?</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span> <span class='op'>==</span> <span class='int'>400</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_error?-instance_method">
  <h3 class='signature ro'>
    #<strong>client_error?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>whether or not the status is set to 4xx</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L670-L672'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='670' data-end='672'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 670</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_error?'>client_error?</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>.<span class='id identifier rubyid_between?'>between?</span> <span class='int'>400</span><span class='comma'>,</span> <span class='int'>499</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="informational?-instance_method">
  <h3 class='signature ro'>
    #<strong>informational?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>whether or not the status is set to 1xx</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L655-L657'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='655' data-end='657'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 655</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_informational?'>informational?</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>.<span class='id identifier rubyid_between?'>between?</span> <span class='int'>100</span><span class='comma'>,</span> <span class='int'>199</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="not_found?-instance_method">
  <h3 class='signature ro'>
    #<strong>not_found?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>whether or not the status is set to 404</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L680-L682'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='680' data-end='682'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 680</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_not_found?'>not_found?</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span> <span class='op'>==</span> <span class='int'>404</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="redirect?-instance_method">
  <h3 class='signature ro'>
    #<strong>redirect?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>whether or not the status is set to 3xx</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L665-L667'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='665' data-end='667'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 665</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_redirect?'>redirect?</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>.<span class='id identifier rubyid_between?'>between?</span> <span class='int'>300</span><span class='comma'>,</span> <span class='int'>399</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server_error?-instance_method">
  <h3 class='signature ro'>
    #<strong>server_error?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>whether or not the status is set to 5xx</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L675-L677'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='675' data-end='677'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 675</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_server_error?'>server_error?</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>.<span class='id identifier rubyid_between?'>between?</span> <span class='int'>500</span><span class='comma'>,</span> <span class='int'>599</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="success?-instance_method">
  <h3 class='signature ro'>
    #<strong>success?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>whether or not the status is set to 2xx</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L660-L662'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='660' data-end='662'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 660</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_success?'>success?</span>
  <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>.<span class='id identifier rubyid_between?'>between?</span> <span class='int'>200</span><span class='comma'>,</span> <span class='int'>299</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="attachment-instance_method">
  <h3 class='signature  first'>
    #<strong>attachment</strong>(filename = nil, disposition = :attachment)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set the Content-Disposition to &quot;attachment&quot; with the specified filename,
instructing the user agents to prompt to save.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L414-L422'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='414' data-end='422'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 414</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attachment'>attachment</span>(<span class='id identifier rubyid_filename'>filename</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_disposition'>disposition</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_attachment'>attachment</span>)
  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content-Disposition</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_disposition'>disposition</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_filename'>filename</span>

  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_format'>format</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>; filename=&quot;%s&quot;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>File</span>.<span class='id identifier rubyid_basename'>basename</span>(<span class='id identifier rubyid_filename'>filename</span>).<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[&quot;\r\n]</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='const'><a href="#MULTIPART_FORM_DATA_REPLACEMENT_TABLE-constant" title="Sinatra::Helpers::MULTIPART_FORM_DATA_REPLACEMENT_TABLE (constant)">MULTIPART_FORM_DATA_REPLACEMENT_TABLE</a></span>))
  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content-Disposition</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_params'>params</span>
  <span class='id identifier rubyid_ext'>ext</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_extname'>extname</span>(<span class='id identifier rubyid_filename'>filename</span>)
  <span class='id identifier rubyid_content_type'><a href="#content_type-instance_method" title="Sinatra::Helpers#content_type (method)">content_type</a></span>(<span class='id identifier rubyid_ext'>ext</span>) <span class='kw'>unless</span> <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-type</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>||</span> <span class='id identifier rubyid_ext'>ext</span>.<span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="back-instance_method">
  <h3 class='signature '>
    #<strong>back</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sugar for redirect (example:  redirect back)</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L650-L652'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='650' data-end='652'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 650</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_back'>back</span>
  <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_referer'>referer</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="body-instance_method">
  <h3 class='signature '>
    #<strong>body</strong>(value = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set or retrieve the response body. When a block is given,
evaluation is deferred until the body is read with #each.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L292-L304'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='292' data-end='304'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 292</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_body'>body</span>(<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_each'>each</span><span class='semicolon'>;</span> <span class='kw'>yield</span>(<span class='id identifier rubyid_call'>call</span>) <span class='kw'>end</span>
    <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_head?'>head?</span> <span class='op'>||</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../Rack.html" title="Rack (module)">Rack</a></span><span class='op'>::</span><span class='const'>Files</span><span class='op'>::</span><span class='const'>Iterator</span>) <span class='op'>||</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Helpers/Stream.html" title="Sinatra::Helpers::Stream (class)">Stream</a></span>)
      <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="Sinatra::Helpers#headers (method)">headers</a></span>.<span class='id identifier rubyid_delete'>delete</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-length</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_body'>body</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cache_control-instance_method">
  <h3 class='signature '>
    #<strong>cache_control</strong>(*values)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Specify response freshness policy for HTTP caches (Cache-Control header).
Any number of non-value directives (:public, <code>:private</code>, <code>:no_cache</code>,
<code>:no_store</code>, <code>:must_revalidate</code>, <code>:proxy_revalidate</code>) may be passed along with
a Hash of value directives (:max_age, <code>:s_maxage</code>).</p>

<p>cache_control :public, :must_revalidate, :max_age =&gt; 60
  =&gt; Cache-Control: public, must-revalidate, max-age=60</p>

<p>See RFC 2616 / 14.9 for more on standard cache control directives:
<a href="http://tools.ietf.org/html/rfc2616#section-14.9.1">http://tools.ietf.org/html/rfc2616#section-14.9.1</a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L537-L554'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='537' data-end='554'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 537</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cache_control'>cache_control</span>(<span class='op'>*</span><span class='id identifier rubyid_values'>values</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Hash</span>)
    <span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_pop'>pop</span>
    <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_reject!'>reject!</span> { <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>==</span> <span class='kw'>false</span> }
    <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_reject!'>reject!</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_values'>values</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_k'>k</span> <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>==</span> <span class='kw'>true</span> }
  <span class='kw'>else</span>
    <span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> {}
  <span class='kw'>end</span>

  <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_map!'>map!</span> { <span class='op'>|</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_tr'>tr</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span>) }
  <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_tr'>tr</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span>)
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_i'>to_i</span> <span class='kw'>if</span> <span class='qwords'><span class='qwords_beg'>%w[</span><span class='tstring_content'>max-age</span><span class='words_sep'> </span><span class='tstring_content'>s-maxage</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_values'>values</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cache-Control</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>if</span> <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_any?'>any?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="content_type-instance_method">
  <h3 class='signature '>
    #<strong>content_type</strong>(type = nil, params = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set the content-type of the response body given a media type or file
extension.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L383-L403'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='383' data-end='403'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 383</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_content_type'>content_type</span>(<span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> {})
  <span class='kw'>return</span> <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-type</span><span class='tstring_end'>&#39;</span></span>] <span class='kw'>unless</span> <span class='id identifier rubyid_type'>type</span>

  <span class='id identifier rubyid_default'>default</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_delete'>delete</span> <span class='symbeg'>:</span><span class='id identifier rubyid_default'>default</span>
  <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span> <span class='op'>=</span> <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span>(<span class='id identifier rubyid_type'>type</span>) <span class='op'>||</span> <span class='id identifier rubyid_default'>default</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_format'>format</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unknown media type: %p</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span>) <span class='kw'>if</span> <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span>.<span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span> <span class='op'>=</span> <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_charset'>charset</span>) <span class='op'>||</span> <span class='id identifier rubyid_settings'>settings</span>.<span class='id identifier rubyid_add_charset'>add_charset</span>.<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='op'>!</span>(<span class='id identifier rubyid_p'>p</span> <span class='op'>===</span> <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span>) }
    <span class='id identifier rubyid_params'>params</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_charset'>charset</span>] <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>charset</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>||</span> <span class='id identifier rubyid_settings'>settings</span>.<span class='id identifier rubyid_default_encoding'>default_encoding</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_delete'>delete</span> <span class='symbeg'>:</span><span class='id identifier rubyid_charset'>charset</span> <span class='kw'>if</span> <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span>.<span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>charset</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span> <span class='op'>&lt;&lt;</span> (<span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span>)
    <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='op'>|</span>
      <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>.<span class='id identifier rubyid_inspect'>inspect</span> <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[&quot;;,]</span><span class='regexp_end'>/</span></span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val'>val</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-type</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_mime_type'><a href="#mime_type-instance_method" title="Sinatra::Helpers#mime_type (method)">mime_type</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="error-instance_method">
  <h3 class='signature '>
    #<strong>error</strong>(code, body = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Halt processing and return the error status provided.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L346-L353'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='346' data-end='353'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 346</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_error'>error</span>(<span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_code'>code</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_to_str'>to_str</span>
    <span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span> <span class='op'>=</span> <span class='id identifier rubyid_code'>code</span>.<span class='id identifier rubyid_to_str'>to_str</span>
    <span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='int'>500</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span> <span class='op'>=</span> <span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span> <span class='kw'>unless</span> <span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span>.<span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_halt'>halt</span> <span class='id identifier rubyid_code'>code</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="etag-instance_method">
  <h3 class='signature '>
    #<strong>etag</strong>(value, options = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set the response entity tag (HTTP &#39;ETag&#39; header) and halt if conditional
GET matches. The <code>value</code> argument is an identifier that uniquely
identifies the current version of the resource. The <code>kind</code> argument
indicates whether the etag should be used as a <code>:strong</code> (default) or <code>:weak</code>
cache validator.</p>

<p>When the current request includes an &#39;If-None-Match&#39; header with a
matching etag, execution is immediately halted. If the request method is
GET or HEAD, a &#39;304 Not Modified&#39; response is sent.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L620-L647'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='620' data-end='647'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 620</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_etag'>etag</span>(<span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {})
  <span class='comment'># Before touching this code, please double check RFC 2616 14.24 and 14.26.
</span>  <span class='id identifier rubyid_options'>options</span>      <span class='op'>=</span> { <span class='label'>kind:</span> <span class='id identifier rubyid_options'>options</span> } <span class='kw'>unless</span> <span class='const'>Hash</span> <span class='op'>===</span> <span class='id identifier rubyid_options'>options</span>
  <span class='id identifier rubyid_kind'>kind</span>         <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_kind'>kind</span>] <span class='op'>||</span> <span class='symbeg'>:</span><span class='id identifier rubyid_strong'>strong</span>
  <span class='id identifier rubyid_new_resource'>new_resource</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_new_resource'>new_resource</span>) { <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_post?'>post?</span> }

  <span class='kw'>unless</span> <span class='const'><a href="#ETAG_KINDS-constant" title="Sinatra::Helpers::ETAG_KINDS (constant)">ETAG_KINDS</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_kind'>kind</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:strong or :weak expected</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_format'>format</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&quot;%s&quot;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>W/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_weak'>weak</span>
  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ETag</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>

  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_success?'><a href="#success%3F-instance_method" title="Sinatra::Helpers#success? (method)">success?</a></span> <span class='op'>||</span> <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span> <span class='op'>==</span> <span class='int'>304</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_etag_matches?'><a href="#etag_matches%3F-instance_method" title="Sinatra::Helpers#etag_matches? (method)">etag_matches?</a></span>(<span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_NONE_MATCH</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span> <span class='id identifier rubyid_new_resource'>new_resource</span>)
    <span class='id identifier rubyid_halt'>halt</span>(<span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_safe?'>safe?</span> <span class='op'>?</span> <span class='int'>304</span> <span class='op'>:</span> <span class='int'>412</span>)
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_MATCH</span><span class='tstring_end'>&#39;</span></span>]
    <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_etag_matches?'><a href="#etag_matches%3F-instance_method" title="Sinatra::Helpers#etag_matches? (method)">etag_matches?</a></span>(<span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_MATCH</span><span class='tstring_end'>&#39;</span></span>]<span class='comma'>,</span> <span class='id identifier rubyid_new_resource'>new_resource</span>)

    <span class='id identifier rubyid_halt'>halt</span> <span class='int'>412</span>
  <span class='kw'>end</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="etag_matches?-instance_method">
  <h3 class='signature priv'>
    #<strong>etag_matches?</strong>(list, new_resource = request.post?)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Helper method checking if a ETag value list includes the current ETag.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L708-L712'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='708' data-end='712'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 708</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_etag_matches?'>etag_matches?</span>(<span class='id identifier rubyid_list'>list</span><span class='comma'>,</span> <span class='id identifier rubyid_new_resource'>new_resource</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_post?'>post?</span>)
  <span class='kw'>return</span> <span class='op'>!</span><span class='id identifier rubyid_new_resource'>new_resource</span> <span class='kw'>if</span> <span class='id identifier rubyid_list'>list</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_list'>list</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s*,\s*</span><span class='regexp_end'>/</span></span>).<span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ETag</span><span class='tstring_end'>&#39;</span></span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="expires-instance_method">
  <h3 class='signature '>
    #<strong>expires</strong>(amount, *values)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set the Expires header and Cache-Control/max-age directive. Amount
can be an integer number of seconds in the future or a Time object
indicating when the response should be considered &quot;stale&quot;. The remaining
&quot;values&quot; arguments are passed to the #cache_control helper:</p>

<p>expires 500, :public, :must_revalidate
  =&gt; Cache-Control: public, must-revalidate, max-age=500
  =&gt; Expires: Mon, 08 Jun 2009 08:50:17 GMT</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L565-L580'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='565' data-end='580'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 565</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_expires'>expires</span>(<span class='id identifier rubyid_amount'>amount</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_values'>values</span>)
  <span class='id identifier rubyid_values'>values</span> <span class='op'>&lt;&lt;</span> {} <span class='kw'>unless</span> <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Hash</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_amount'>amount</span>.<span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Integer</span>
    <span class='id identifier rubyid_time'>time</span>    <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='id identifier rubyid_amount'>amount</span>.<span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_max_age'>max_age</span> <span class='op'>=</span> <span class='id identifier rubyid_amount'>amount</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_time'>time</span>    <span class='op'>=</span> <span class='id identifier rubyid_time_for'><a href="#time_for-instance_method" title="Sinatra::Helpers#time_for (method)">time_for</a></span> <span class='id identifier rubyid_amount'>amount</span>
    <span class='id identifier rubyid_max_age'>max_age</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>-</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='label'>max_age:</span> <span class='id identifier rubyid_max_age'>max_age</span>) { <span class='op'>|</span><span class='id identifier rubyid__key'>_key</span><span class='comma'>,</span> <span class='id identifier rubyid_v1'>v1</span><span class='comma'>,</span> <span class='id identifier rubyid_v2'>v2</span><span class='op'>|</span> <span class='id identifier rubyid_v1'>v1</span> <span class='op'>||</span> <span class='id identifier rubyid_v2'>v2</span> }
  <span class='id identifier rubyid_cache_control'><a href="#cache_control-instance_method" title="Sinatra::Helpers#cache_control (method)">cache_control</a></span>(<span class='op'>*</span><span class='id identifier rubyid_values'>values</span>)

  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Expires</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_httpdate'>httpdate</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="headers-instance_method">
  <h3 class='signature '>
    #<strong>headers</strong>(hash = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set multiple response headers with Hash.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L361-L364'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='361' data-end='364'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 361</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_headers'>headers</span>(<span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_headers'>headers</span>.<span class='id identifier rubyid_merge!'>merge!</span> <span class='id identifier rubyid_hash'>hash</span> <span class='kw'>if</span> <span class='id identifier rubyid_hash'>hash</span>
  <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_headers'>headers</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="last_modified-instance_method">
  <h3 class='signature '>
    #<strong>last_modified</strong>(time)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set the last modified time of the resource (HTTP &#39;Last-Modified&#39; header)
and halt if conditional GET matches. The <code>time</code> argument is a Time,
DateTime, or other object that responds to <code>to_time</code>.</p>

<p>When the current request includes an &#39;If-Modified-Since&#39; header that is
equal or later than the time specified, execution is immediately halted
with a &#39;304 Not Modified&#39; response.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L589-L608'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='589' data-end='608'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 589</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_last_modified'>last_modified</span>(<span class='id identifier rubyid_time'>time</span>)
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_time'>time</span>

  <span class='id identifier rubyid_time'>time</span> <span class='op'>=</span> <span class='id identifier rubyid_time_for'><a href="#time_for-instance_method" title="Sinatra::Helpers#time_for (method)">time_for</a></span> <span class='id identifier rubyid_time'>time</span>
  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Last-Modified</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_httpdate'>httpdate</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_NONE_MATCH</span><span class='tstring_end'>&#39;</span></span>]

  <span class='kw'>if</span> (<span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span> <span class='op'>==</span> <span class='int'>200</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_MODIFIED_SINCE</span><span class='tstring_end'>&#39;</span></span>]
    <span class='comment'># compare based on seconds since epoch
</span>    <span class='id identifier rubyid_since'>since</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_httpdate'>httpdate</span>(<span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_MODIFIED_SINCE</span><span class='tstring_end'>&#39;</span></span>]).<span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_halt'>halt</span> <span class='int'>304</span> <span class='kw'>if</span> <span class='id identifier rubyid_since'>since</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> (<span class='id identifier rubyid_success?'><a href="#success%3F-instance_method" title="Sinatra::Helpers#success? (method)">success?</a></span> <span class='op'>||</span> (<span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span> <span class='op'>==</span> <span class='int'>412</span>)) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_UNMODIFIED_SINCE</span><span class='tstring_end'>&#39;</span></span>]
    <span class='comment'># compare based on seconds since epoch
</span>    <span class='id identifier rubyid_since'>since</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_httpdate'>httpdate</span>(<span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_IF_UNMODIFIED_SINCE</span><span class='tstring_end'>&#39;</span></span>]).<span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_halt'>halt</span> <span class='int'>412</span> <span class='kw'>if</span> <span class='id identifier rubyid_since'>since</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="logger-instance_method">
  <h3 class='signature '>
    #<strong>logger</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Access shared logger object.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L372-L374'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='372' data-end='374'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 372</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_logger'>logger</span>
  <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_logger'>logger</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="mime_type-instance_method">
  <h3 class='signature '>
    #<strong>mime_type</strong>(type)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Look up a media type by file extension in Rack&#39;s mime registry.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L377-L379'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='377' data-end='379'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 377</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_mime_type'>mime_type</span>(<span class='id identifier rubyid_type'>type</span>)
  <span class='const'><a href="Base.html" title="Sinatra::Base (class)">Base</a></span>.<span class='id identifier rubyid_mime_type'><a href="Base.html#mime_type-class_method" title="Sinatra::Base.mime_type (method)">mime_type</a></span>(<span class='id identifier rubyid_type'>type</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="not_found-instance_method">
  <h3 class='signature ro'>
    #<strong>not_found</strong>(body = nil)   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Halt processing and return a 404 Not Found.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L356-L358'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='356' data-end='358'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 356</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_not_found'>not_found</span>(<span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_error'><a href="#error-instance_method" title="Sinatra::Helpers#error (method)">error</a></span> <span class='int'>404</span><span class='comma'>,</span> <span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="redirect-instance_method">
  <h3 class='signature ro'>
    #<strong>redirect</strong>(uri, *args)   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Halt processing and redirect to the URI provided.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L307-L321'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='307' data-end='321'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 307</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_redirect'>redirect</span>(<span class='id identifier rubyid_uri'><a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">uri</a></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='comment'># SERVER_PROTOCOL is required in Rack 3, fall back to HTTP_VERSION
</span>  <span class='comment'># for servers not updated for Rack 3 (like Puma 5)
</span>  <span class='id identifier rubyid_http_version'>http_version</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SERVER_PROTOCOL</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>||</span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_VERSION</span><span class='tstring_end'>&#39;</span></span>]
  <span class='kw'>if</span> (<span class='id identifier rubyid_http_version'>http_version</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP/1.1</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>REQUEST_METHOD</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GET</span><span class='tstring_end'>&#39;</span></span>)
    <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span> <span class='int'>303</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span> <span class='int'>302</span>
  <span class='kw'>end</span>

  <span class='comment'># According to RFC 2616 section 14.30, &quot;the field value consists of a
</span>  <span class='comment'># single absolute URI&quot;
</span>  <span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Location</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_uri'><a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">uri</a></span>(<span class='id identifier rubyid_uri'><a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">uri</a></span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_settings'>settings</span>.<span class='id identifier rubyid_absolute_redirects?'>absolute_redirects?</span><span class='comma'>,</span> <span class='id identifier rubyid_settings'>settings</span>.<span class='id identifier rubyid_prefixed_redirects?'>prefixed_redirects?</span>)
  <span class='id identifier rubyid_halt'>halt</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_file-instance_method">
  <h3 class='signature '>
    #<strong>send_file</strong>(path, opts = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Use the contents of the file at <code>path</code> as the response body.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L425-L447'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='425' data-end='447'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 425</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_file'>send_file</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> {})
  <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_type'>type</span>] <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_response'>response</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-type</span><span class='tstring_end'>&#39;</span></span>]
    <span class='id identifier rubyid_content_type'><a href="#content_type-instance_method" title="Sinatra::Helpers#content_type (method)">content_type</a></span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_type'>type</span>] <span class='op'>||</span> <span class='const'>File</span>.<span class='id identifier rubyid_extname'>extname</span>(<span class='id identifier rubyid_path'>path</span>)<span class='comma'>,</span> <span class='label'>default:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/octet-stream</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_disposition'>disposition</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_disposition'>disposition</span>]
  <span class='id identifier rubyid_filename'>filename</span>    <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_filename'>filename</span>]
  <span class='id identifier rubyid_disposition'>disposition</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_attachment'><a href="#attachment-instance_method" title="Sinatra::Helpers#attachment (method)">attachment</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_disposition'>disposition</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_filename'>filename</span>
  <span class='id identifier rubyid_filename'>filename</span>    <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>        <span class='kw'>if</span> <span class='id identifier rubyid_filename'>filename</span>.<span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_attachment'><a href="#attachment-instance_method" title="Sinatra::Helpers#attachment (method)">attachment</a></span>(<span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_disposition'>disposition</span>) <span class='kw'>if</span> <span class='id identifier rubyid_disposition'>disposition</span>

  <span class='id identifier rubyid_last_modified'><a href="#last_modified-instance_method" title="Sinatra::Helpers#last_modified (method)">last_modified</a></span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_last_modified'><a href="#last_modified-instance_method" title="Sinatra::Helpers#last_modified (method)">last_modified</a></span>] <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_last_modified'><a href="#last_modified-instance_method" title="Sinatra::Helpers#last_modified (method)">last_modified</a></span>]

  <span class='id identifier rubyid_file'>file</span>   <span class='op'>=</span> <span class='const'><a href="../Rack.html" title="Rack (module)">Rack</a></span><span class='op'>::</span><span class='const'>Files</span>.<span class='id identifier rubyid_new'><a href="../Sinatra.html#new-class_method" title="Sinatra.new (method)">new</a></span>(<span class='const'>File</span>.<span class='id identifier rubyid_dirname'>dirname</span>(<span class='id identifier rubyid_settings'>settings</span>.<span class='id identifier rubyid_app_file'>app_file</span>))
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_serving'>serving</span>(<span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span>)

  <span class='id identifier rubyid_result'>result</span>[<span class='int'>1</span>].<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="Sinatra::Helpers#headers (method)">headers</a></span>[<span class='id identifier rubyid_k'>k</span>] <span class='op'>||=</span> <span class='id identifier rubyid_v'>v</span> }
  <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="Sinatra::Helpers#headers (method)">headers</a></span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-length</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span>[<span class='int'>1</span>][<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content-length</span><span class='tstring_end'>&#39;</span></span>]
  <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>] <span class='op'>&amp;&amp;=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>])
  <span class='id identifier rubyid_halt'>halt</span> (<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_status'><a href="#status-instance_method" title="Sinatra::Helpers#status (method)">status</a></span>] <span class='op'>||</span> <span class='id identifier rubyid_result'>result</span>[<span class='int'>0</span>])<span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span>[<span class='int'>2</span>]
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span>
  <span class='id identifier rubyid_not_found'><a href="#not_found-instance_method" title="Sinatra::Helpers#not_found (method)">not_found</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="session-instance_method">
  <h3 class='signature '>
    #<strong>session</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Access the underlying <a href="../Rack.html" title="Rack (module)"><code>::Rack</code></a> session.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L367-L369'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='367' data-end='369'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 367</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_session'>session</span>
  <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_session'>session</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="status-instance_method">
  <h3 class='signature '>
    #<strong>status</strong>(value = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set or retrieve the response status code.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L285-L288'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='285' data-end='288'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 285</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_status'>status</span>(<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'><a href="../Rack.html" title="Rack (module)">Rack</a></span><span class='op'>::</span><span class='const'>Utils</span>.<span class='id identifier rubyid_status_code'>status_code</span>(<span class='id identifier rubyid_value'>value</span>) <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
  <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_status'>status</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stream-instance_method">
  <h3 class='signature '>
    #<strong>stream</strong>(keep_open = false)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Allows to start sending data to the client even though later parts of
the response body have not yet been generated.</p>

<p>The close parameter specifies whether Stream#close should be called
after the block has been executed.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L512-L525'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='512' data-end='525'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 512</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_stream'>stream</span>(<span class='id identifier rubyid_keep_open'>keep_open</span> <span class='op'>=</span> <span class='kw'>false</span>)
  <span class='id identifier rubyid_scheduler'>scheduler</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>async.callback</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>?</span> <span class='const'>EventMachine</span> <span class='op'>:</span> <span class='const'><a href="Helpers/Stream.html" title="Sinatra::Helpers::Stream (class)">Stream</a></span>
  <span class='id identifier rubyid_current'>current</span>   <span class='op'>=</span> <span class='ivar'>@params</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_stream'>stream</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_scheduler'>scheduler</span> <span class='op'>==</span> <span class='const'><a href="Helpers/Stream.html" title="Sinatra::Helpers::Stream (class)">Stream</a></span>  <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_keep_open'>keep_open</span>
    <span class='const'><a href="Helpers/Stream.html" title="Sinatra::Helpers::Stream (class)">Stream</a></span>.<span class='id identifier rubyid_new'><a href="Helpers/Stream.html#new-class_method" title="Sinatra::Helpers::Stream.new (method)">new</a></span>(<span class='id identifier rubyid_scheduler'>scheduler</span><span class='comma'>,</span> <span class='kw'>false</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_out'>out</span><span class='op'>|</span>
      <span class='kw'>until</span> <span class='id identifier rubyid_out'>out</span>.<span class='id identifier rubyid_closed?'>closed?</span>
        <span class='id identifier rubyid_with_params'><a href="#with_params-instance_method" title="Sinatra::Helpers#with_params (method)">with_params</a></span>(<span class='id identifier rubyid_current'>current</span>) { <span class='kw'>yield</span>(<span class='id identifier rubyid_out'>out</span>) }
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='const'><a href="Helpers/Stream.html" title="Sinatra::Helpers::Stream (class)">Stream</a></span>.<span class='id identifier rubyid_new'><a href="Helpers/Stream.html#new-class_method" title="Sinatra::Helpers::Stream.new (method)">new</a></span>(<span class='id identifier rubyid_scheduler'>scheduler</span><span class='comma'>,</span> <span class='id identifier rubyid_keep_open'>keep_open</span>) { <span class='op'>|</span><span class='id identifier rubyid_out'>out</span><span class='op'>|</span> <span class='id identifier rubyid_with_params'><a href="#with_params-instance_method" title="Sinatra::Helpers#with_params (method)">with_params</a></span>(<span class='id identifier rubyid_current'>current</span>) { <span class='kw'>yield</span>(<span class='id identifier rubyid_out'>out</span>) } }
  <span class='kw'>end</span>
  <span class='id identifier rubyid_body'><a href="#body-instance_method" title="Sinatra::Helpers#body (method)">body</a></span> <span class='id identifier rubyid_stream'>stream</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="time_for-instance_method">
  <h3 class='signature '>
    #<strong>time_for</strong>(value)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Generates a Time object from the given value.
Used by #expires and #last_modified.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L691-L703'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='691' data-end='703'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 691</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_time_for'>time_for</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Numeric</span>
    <span class='const'>Time</span>.<span class='id identifier rubyid_at'>at</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='const'>Time</span>.<span class='id identifier rubyid_parse'>parse</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_time'>to_time</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span>
<span class='kw'>rescue</span> <span class='const'>Exception</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unable to convert </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> to a Time object</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to-instance_method">
  <h3 class='signature '>
    #<strong>to</strong>(addr = nil, absolute = true, add_script_name = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Alias for <a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">#uri</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L343-L343'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='343' data-end='343'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 343</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_uri'><a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">uri</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="uri-instance_method">
  <h3 class='signature '>
    #<strong>uri</strong>(addr = nil, absolute = true, add_script_name = true)  
    <span class='aliases'>Also known as: <span class='names'>#url, #to</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Generates the absolute URI for a given path in the app.
Takes Rack routers and reverse proxies into account.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L325-L340'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='325' data-end='340'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 325</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_uri'>uri</span>(<span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_absolute'>absolute</span> <span class='op'>=</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='id identifier rubyid_add_script_name'>add_script_name</span> <span class='op'>=</span> <span class='kw'>true</span>)
  <span class='kw'>return</span> <span class='id identifier rubyid_addr'>addr</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span>.<span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[a-z][a-z0-9+.\-]*:</span><span class='regexp_end'>/i</span></span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> [<span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='const'>String</span>.<span class='id identifier rubyid_new'><a href="../Sinatra.html#new-class_method" title="Sinatra.new (method)">new</a></span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_absolute'>absolute</span>
    <span class='id identifier rubyid_host'>host</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_secure?'>secure?</span><span class='embexpr_end'>}</span><span class='tstring_content'>://</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_host'>host</span> <span class='op'>&lt;&lt;</span> <span class='kw'>if</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_forwarded?'>forwarded?</span> <span class='op'>||</span> (<span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_port'>port</span> <span class='op'>!=</span> (<span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_secure?'>secure?</span> <span class='op'>?</span> <span class='int'>443</span> <span class='op'>:</span> <span class='int'>80</span>))
              <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_host_with_port'>host_with_port</span>
            <span class='kw'>else</span>
              <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_host'>host</span>
            <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_script_name'>script_name</span>.<span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_add_script_name'>add_script_name</span>
  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>&lt;&lt;</span> (<span class='id identifier rubyid_addr'>addr</span> <span class='op'>||</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_path_info'>path_info</span>).<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='const'>File</span>.<span class='id identifier rubyid_join'>join</span> <span class='id identifier rubyid_uri'>uri</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="url-instance_method">
  <h3 class='signature '>
    #<strong>url</strong>(addr = nil, absolute = true, add_script_name = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Alias for <a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">#uri</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L342-L342'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='342' data-end='342'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 342</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_url'>url</span> <span class='id identifier rubyid_uri'><a href="#uri-instance_method" title="Sinatra::Helpers#uri (method)">uri</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="with_params-instance_method">
  <h3 class='signature priv'>
    #<strong>with_params</strong>(temp_params)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/lib/sinatra/base.rb#L714-L720'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='714' data-end='720'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sinatra/base.rb', line 714</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_with_params'>with_params</span>(<span class='id identifier rubyid_temp_params'>temp_params</span>)
  <span class='id identifier rubyid_original'>original</span> <span class='op'>=</span> <span class='ivar'>@params</span>
  <span class='ivar'>@params</span> <span class='op'>=</span> <span class='id identifier rubyid_temp_params'>temp_params</span>
  <span class='kw'>yield</span>
<span class='kw'>ensure</span>
  <span class='ivar'>@params</span> <span class='op'>=</span> <span class='id identifier rubyid_original'>original</span> <span class='kw'>if</span> <span class='id identifier rubyid_original'>original</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>