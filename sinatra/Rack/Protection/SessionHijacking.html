<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Rack::Protection::SessionHijacking &mdash; Sinatra main</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Rack::Protection::SessionHijacking",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Sinatra main</a> &raquo; 
      <a href='../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../Rack.html" title="Rack (module)">Rack</a> &raquo; 
        <a href="../Protection.html" title="Rack::Protection (module)">Protection</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>SessionHijacking&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Rack::Protection::SessionHijacking</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="Base.html" title="Rack::Protection::Base (class)"><code>Base</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Base.html" title="Rack::Protection::Base (class)"><code>Base</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Base.html" title="Rack::Protection::Base (class)">Rack::Protection::Base</a></span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'><a href="Base.html" title="Rack::Protection::Base (class)">Rack::Protection::Base</a></li>
          <li class='next'>Rack::Protection::SessionHijacking</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/sinatra/sinatra/blob/main/rack-protection/lib/rack/protection/session_hijacking.rb#L16'>rack-protection/lib/rack/protection/session_hijacking.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    <p>Prevented attack::   Session Hijacking
Supported browsers:: all
More infos::         <a href="http://en.wikipedia.org/wiki/Session_hijacking">http://en.wikipedia.org/wiki/Session_hijacking</a></p>

<p>Tracks request properties like the user agent in the session and empties
the session if those properties change. This essentially prevents attacks
from Firesheep. Since all headers taken into consideration can be
spoofed, too, this will not prevent determined hijacking attempts.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
  <h3 class='inherited'><a href="Base.html" title="Rack::Protection::Base (class)"><code>Base</code></a> - Inherited</h3>
  <p  class='inherited'>
    <a href="Base.html#DEFAULT_OPTIONS-constant" title="Rack::Protection::Base::DEFAULT_OPTIONS (constant)">DEFAULT_OPTIONS</a>
  </p>
</div>

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="Base.html" title="Rack::Protection::Base (class)"><code>Base</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Base.html#default_options-class_method" title="Rack::Protection::Base.default_options (method)">.default_options</a>,
        <a class='i_m ' href="Base.html#default_reaction-class_method" title="Rack::Protection::Base.default_reaction (method)">.default_reaction</a>,
        <a class='i_m ' href="Base.html#new-class_method" title="Rack::Protection::Base.new (method)">.new</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="Base.html" title="Rack::Protection::Base (class)"><code>Base</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro' href="Base.html#app-instance_method" title="Rack::Protection::Base#app (method)">#app</a>,
        <a class='i_m ro' href="Base.html#options-instance_method" title="Rack::Protection::Base#options (method)">#options</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#accepts%3F-instance_method" title="#accepts? (instance method)">#<strong>accepts?</strong>(env)  &#x21d2; Boolean </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#encode-instance_method" title="#encode (instance method)">#<strong>encode</strong>(value)  </a>
    </span>
  </li>
</ul>

<h3 class='inherited'><a href="Base.html" title="Rack::Protection::Base (class)"><code>Base</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Base.html#accepts%3F-instance_method" title="Rack::Protection::Base#accepts? (method)">#accepts?</a>,
        <a class='i_m ' href="Base.html#call-instance_method" title="Rack::Protection::Base#call (method)">#call</a>,
        <a class='i_m ' href="Base.html#debug-instance_method" title="Rack::Protection::Base#debug (method)">#debug</a>,
        <a class='i_m ' href="Base.html#default_options-instance_method" title="Rack::Protection::Base#default_options (method)">#default_options</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Base.html#default_reaction-instance_method" title="Rack::Protection::Base#default_reaction (method)">#default_reaction</a></td>
      <td><div class='inline'><p>Alias for <a href="Base.html#deny-instance_method" title="Rack::Protection::Base#deny (method)">Base#deny</a>.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Base.html#deny-instance_method" title="Rack::Protection::Base#deny (method)">#deny</a>,
        <a class='i_m ' href="Base.html#drop_session-instance_method" title="Rack::Protection::Base#drop_session (method)">#drop_session</a>,
        <a class='i_m ' href="Base.html#encrypt-instance_method" title="Rack::Protection::Base#encrypt (method)">#encrypt</a>,
        <a class='i_m ' href="Base.html#html%3F-instance_method" title="Rack::Protection::Base#html? (method)">#html?</a>,
        <a class='i_m ' href="Base.html#instrument-instance_method" title="Rack::Protection::Base#instrument (method)">#instrument</a>,
        <a class='i_m ' href="Base.html#origin-instance_method" title="Rack::Protection::Base#origin (method)">#origin</a>,
        <a class='i_m ' href="Base.html#random_string-instance_method" title="Rack::Protection::Base#random_string (method)">#random_string</a>,
        <a class='i_m ' href="Base.html#react-instance_method" title="Rack::Protection::Base#react (method)">#react</a>,
        <a class='i_m ' href="Base.html#referrer-instance_method" title="Rack::Protection::Base#referrer (method)">#referrer</a>,
        <a class='i_m ' href="Base.html#report-instance_method" title="Rack::Protection::Base#report (method)">#report</a>,
        <a class='i_m ' href="Base.html#safe%3F-instance_method" title="Rack::Protection::Base#safe? (method)">#safe?</a>,
        <a class='i_m ' href="Base.html#secure_compare-instance_method" title="Rack::Protection::Base#secure_compare (method)">#secure_compare</a>,
        <a class='i_m ' href="Base.html#session-instance_method" title="Rack::Protection::Base#session (method)">#session</a>,
        <a class='i_m ' href="Base.html#session%3F-instance_method" title="Rack::Protection::Base#session? (method)">#session?</a>,
        <a class='i_m ' href="Base.html#warn-instance_method" title="Rack::Protection::Base#warn (method)">#warn</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <p class='notice'>This class inherits a constructor from <a href="Base.html#new-class_method" title="Rack::Protection::Base.new (method)">Rack::Protection::Base</a></p>
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="accepts?-instance_method">
  <h3 class='signature  first'>
    #<strong>accepts?</strong>(env)  &#x21d2; <code>Boolean</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/rack-protection/lib/rack/protection/session_hijacking.rb#L21-L30'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='21' data-end='30'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'rack-protection/lib/rack/protection/session_hijacking.rb', line 21</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_accepts?'>accepts?</span>(<span class='id identifier rubyid_env'>env</span>)
  <span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='id identifier rubyid_session'>session</span> <span class='id identifier rubyid_env'>env</span>
  <span class='id identifier rubyid_key'>key</span>     <span class='op'>=</span> <span class='id identifier rubyid_options'><a href="../../Sinatra/Delegator.html#options-instance_method" title="Sinatra::Delegator#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_tracking_key'>tracking_key</span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span>.<span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_session'>session</span>[<span class='id identifier rubyid_key'>key</span>].<span class='id identifier rubyid_all?'>all?</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>==</span> <span class='id identifier rubyid_encode'><a href="#encode-instance_method" title="Rack::Protection::SessionHijacking#encode (method)">encode</a></span>(<span class='id identifier rubyid_env'>env</span>[<span class='id identifier rubyid_k'>k</span>]) }
  <span class='kw'>else</span>
    <span class='id identifier rubyid_session'>session</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> {}
    <span class='id identifier rubyid_options'><a href="../../Sinatra/Delegator.html#options-instance_method" title="Sinatra::Delegator#options (method)">options</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_track'>track</span>].<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_session'>session</span>[<span class='id identifier rubyid_key'>key</span>][<span class='id identifier rubyid_k'>k</span>] <span class='op'>=</span> <span class='id identifier rubyid_encode'><a href="#encode-instance_method" title="Rack::Protection::SessionHijacking#encode (method)">encode</a></span>(<span class='id identifier rubyid_env'>env</span>[<span class='id identifier rubyid_k'>k</span>]) }
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="encode-instance_method">
  <h3 class='signature '>
    #<strong>encode</strong>(value)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sinatra/sinatra/blob/main/rack-protection/lib/rack/protection/session_hijacking.rb#L32-L34'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='32' data-end='34'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'rack-protection/lib/rack/protection/session_hijacking.rb', line 32</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_encode'>encode</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_downcase'>downcase</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>