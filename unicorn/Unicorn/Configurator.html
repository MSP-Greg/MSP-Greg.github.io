<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Unicorn::Configurator &mdash; Unicorn master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Unicorn::Configurator",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Unicorn master</a> &raquo; 
      <a href='../_index.html#alpha_C'>Index (C)</a> &raquo; 
        <a class='nodoc' href="../Unicorn.html" title="Unicorn (module)">Unicorn</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Configurator&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Unicorn::Configurator</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a class='nodoc' href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L14'>lib/unicorn/configurator.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Implements a simple DSL for configuring a unicorn server.</p>

<p>See <a href="https://yhbt.net/unicorn/examples/unicorn.conf.rb">yhbt.net/unicorn/examples/unicorn.conf.rb</a> and <a href="https://yhbt.net/unicorn/examples/unicorn.conf.minimal.rb">yhbt.net/unicorn/examples/unicorn.conf.minimal.rb</a> example configuration files.  An example config file for use with nginx is also available at <a href="https://yhbt.net/unicorn/examples/nginx.conf">yhbt.net/unicorn/examples/nginx.conf</a></p>

<p>See the <a href="TUNING.html">TUNING.html</a> document for more information on tuning unicorn.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='DEFAULTS-constant' class='summary_signature nodoc'>DEFAULTS =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Default settings for <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a></p>

  </div>
</div>
    <a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L32-L63'># File 'lib/unicorn/configurator.rb', line 32</a>    <pre class='code ruby'>{
  <span class='symbeg'>:</span><span class='id identifier rubyid_timeout'><a href="#timeout-instance_method" title="Unicorn::Configurator#timeout (method)">timeout</a></span> <span class='op'>=&gt;</span> <span class='int'>60</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span> <span class='op'>=&gt;</span> <span class='const'>Logger</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Unicorn::Configurator.new (method)">new</a></span>(<span class='gvar'>$stderr</span>)<span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_worker_processes'><a href="#worker_processes-instance_method" title="Unicorn::Configurator#worker_processes (method)">worker_processes</a></span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_after_fork'><a href="#after_fork-instance_method" title="Unicorn::Configurator#after_fork (method)">after_fork</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_worker'>worker</span><span class='op'>|</span>
      <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_info'>info</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>worker=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_worker'>worker</span>.<span class='id identifier rubyid_nr'>nr</span><span class='embexpr_end'>}</span><span class='tstring_content'> spawned pid=</span><span class='embexpr_beg'>#{</span><span class='gvar'>$$</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
    }<span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_before_fork'><a href="#before_fork-instance_method" title="Unicorn::Configurator#before_fork (method)">before_fork</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_worker'>worker</span><span class='op'>|</span>
      <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_info'>info</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>worker=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_worker'>worker</span>.<span class='id identifier rubyid_nr'>nr</span><span class='embexpr_end'>}</span><span class='tstring_content'> spawning...</span><span class='tstring_end'>&quot;</span></span>)
    }<span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_before_exec'><a href="#before_exec-instance_method" title="Unicorn::Configurator#before_exec (method)">before_exec</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='op'>|</span>
      <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_info'>info</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>forked child re-executing...</span><span class='tstring_end'>&quot;</span></span>)
    }<span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_after_worker_exit'><a href="#after_worker_exit-instance_method" title="Unicorn::Configurator#after_worker_exit (method)">after_worker_exit</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_worker'>worker</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reaped </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> worker=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_worker'>worker</span>.<span class='id identifier rubyid_nr'>nr</span> <span class='kw'>rescue</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unknown</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_success?'>success?</span>
        <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_info'>info</span>(<span class='id identifier rubyid_m'>m</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_error'>error</span>(<span class='id identifier rubyid_m'>m</span>)
      <span class='kw'>end</span>
    }<span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_after_worker_ready'><a href="#after_worker_ready-instance_method" title="Unicorn::Configurator#after_worker_ready (method)">after_worker_ready</a></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_worker'>worker</span><span class='op'>|</span>
      <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_info'>info</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>worker=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_worker'>worker</span>.<span class='id identifier rubyid_nr'>nr</span><span class='embexpr_end'>}</span><span class='tstring_content'> ready</span><span class='tstring_end'>&quot;</span></span>)
    }<span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_pid'><a href="#pid-instance_method" title="Unicorn::Configurator#pid (method)">pid</a></span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_early_hints'><a href="#early_hints-instance_method" title="Unicorn::Configurator#early_hints (method)">early_hints</a></span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_worker_exec'><a href="#worker_exec-instance_method" title="Unicorn::Configurator#worker_exec (method)">worker_exec</a></span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_preload_app'><a href="#preload_app-instance_method" title="Unicorn::Configurator#preload_app (method)">preload_app</a></span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_check_client_connection'><a href="#check_client_connection-instance_method" title="Unicorn::Configurator#check_client_connection (method)">check_client_connection</a></span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_rewindable_input'><a href="#rewindable_input-instance_method" title="Unicorn::Configurator#rewindable_input (method)">rewindable_input</a></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_client_body_buffer_size'><a href="#client_body_buffer_size-instance_method" title="Unicorn::Configurator#client_body_buffer_size (method)">client_body_buffer_size</a></span> <span class='op'>=&gt;</span> <span class='const'><a href="../Unicorn.html" title="Unicorn (module)">Unicorn</a></span><span class='op'>::</span><span class='const'><a href="Const.html" title="Unicorn::Const (module)">Const</a></span><span class='op'>::</span><span class='const'><a href="Const.html#MAX_BODY-constant" title="Unicorn::Const::MAX_BODY (constant)">MAX_BODY</a></span><span class='comma'>,</span>
}</pre>
  </li>
  <li>
    <span id='RACKUP-constant' class='summary_signature nodoc'>RACKUP =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>used to stash stuff for deferred processing of cli options in config.ru after “working_directory” is bound.  Do not rely on this being around later on…</p>

  </div>
</div>
    <a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L23-L29'># File 'lib/unicorn/configurator.rb', line 23</a>    <pre class='code ruby'>{
  <span class='symbeg'>:</span><span class='id identifier rubyid_daemonize'>daemonize</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_host'>host</span> <span class='op'>=&gt;</span> <span class='const'><a href="../Unicorn.html" title="Unicorn (module)">Unicorn</a></span><span class='op'>::</span><span class='const'><a href="Const.html" title="Unicorn::Const (module)">Const</a></span><span class='op'>::</span><span class='const'><a href="Const.html#DEFAULT_HOST-constant" title="Unicorn::Const::DEFAULT_HOST (constant)">DEFAULT_HOST</a></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_port'>port</span> <span class='op'>=&gt;</span> <span class='const'><a href="../Unicorn.html" title="Unicorn (module)">Unicorn</a></span><span class='op'>::</span><span class='const'><a href="Const.html" title="Unicorn::Const (module)">Const</a></span><span class='op'>::</span><span class='const'><a href="Const.html#DEFAULT_PORT-constant" title="Unicorn::Const::DEFAULT_PORT (constant)">DEFAULT_PORT</a></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_set_listener'>set_listener</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=&gt;</span> { <span class='symbeg'>:</span><span class='id identifier rubyid_listeners'><a href="#listeners-instance_method" title="Unicorn::Configurator#listeners (method)">listeners</a></span> <span class='op'>=&gt;</span> [] }
}</pre>
  </li>
</ul>
  <h3 class='inherited'><a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a> - Included</h3>
  <p  class='inherited'>
    <a class='nodoc' href="../Unicorn.html#ClientShutdown-constant" title="Unicorn::ClientShutdown (constant)">ClientShutdown</a>, 
    <a class='nodoc' href="../Unicorn.html#F_SETPIPE_SZ-constant" title="Unicorn::F_SETPIPE_SZ (constant)">F_SETPIPE_SZ</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(defaults = {})  &#x21d2; Configurator </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#after_reload-instance_method" title="#after_reload (instance method)">#<strong>after_reload</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#config_file-instance_method" title="#config_file (instance method)">#<strong>config_file</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#set-instance_method" title="#set (instance method)">#<strong>set</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#after_fork-instance_method" title="#after_fork (instance method)">#<strong>after_fork</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets after_fork hook to a given block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#after_worker_exit-instance_method" title="#after_worker_exit (instance method)">#<strong>after_worker_exit</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets after_worker_exit hook to a given block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#after_worker_ready-instance_method" title="#after_worker_ready (instance method)">#<strong>after_worker_ready</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets after_worker_ready hook to a given block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#before_exec-instance_method" title="#before_exec (instance method)">#<strong>before_exec</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets the before_exec hook to a given Proc object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#before_fork-instance_method" title="#before_fork (instance method)">#<strong>before_fork</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets before_fork got be a given Proc object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#check_client_connection-instance_method" title="#check_client_connection (instance method)">#<strong>check_client_connection</strong>(bool)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>When enabled, unicorn will check the client connection by writing the beginning of the HTTP headers before calling the application.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#client_body_buffer_size-instance_method" title="#client_body_buffer_size (instance method)">#<strong>client_body_buffer_size</strong>(bytes)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The maximum size (in <code>bytes</code>) to buffer in memory before resorting to a temporary file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#default_middleware-instance_method" title="#default_middleware (instance method)">#<strong>default_middleware</strong>(bool)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets whether to add default middleware in the development and deployment RACK_ENVs.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#early_hints-instance_method" title="#early_hints (instance method)">#<strong>early_hints</strong>(bool)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets whether to enable the proposed early hints Rack API.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#listen-instance_method" title="#listen (instance method)">#<strong>listen</strong>(address, options = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Adds an <code>address</code> to the existing listener set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>(obj)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets object to the <code>obj</code> Logger-like object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pid-instance_method" title="#pid (instance method)">#<strong>pid</strong>(path)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets the <code>path</code> for the PID file of the unicorn master process.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#preload_app-instance_method" title="#preload_app (instance method)">#<strong>preload_app</strong>(bool)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Enabling this preloads an application before forking worker processes.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#rewindable_input-instance_method" title="#rewindable_input (instance method)">#<strong>rewindable_input</strong>(bool)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Toggles making <a href=“&quot;rack.input&quot;”>env</a> rewindable.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stderr_path-instance_method" title="#stderr_path (instance method)">#<strong>stderr_path</strong>(path)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allow redirecting $stderr to a given path.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stdout_path-instance_method" title="#stdout_path (instance method)">#<strong>stdout_path</strong>(path)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Same as stderr_path, except for $stdout.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#timeout-instance_method" title="#timeout (instance method)">#<strong>timeout</strong>(seconds)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Strongly consider using <a href="Application_Timeouts.html">Application_Timeouts.html</a> instead of this misfeature.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#user-instance_method" title="#user (instance method)">#<strong>user</strong>(user, group = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Runs worker processes as the specified <code>user</code> and <code>group</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_exec-instance_method" title="#worker_exec (instance method)">#<strong>worker_exec</strong>(bool)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Whether to exec in each worker process after forking.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_processes-instance_method" title="#worker_processes (instance method)">#<strong>worker_processes</strong>(nr)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets the current number of worker_processes to <code>nr</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#working_directory-instance_method" title="#working_directory (instance method)">#<strong>working_directory</strong>(path)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>sets the working directory for <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#canonicalize_tcp-instance_method" title="#canonicalize_tcp (instance method)">#<strong>canonicalize_tcp</strong>(addr, port)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(key)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#commit!-instance_method" title="#commit! (instance method)">#<strong>commit!</strong>(server, options = {})  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#expand_addr-instance_method" title="#expand_addr (instance method)">#<strong>expand_addr</strong>(address)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>expands “unix:path/to/foo” to a socket relative to the current path expands pathnames of sockets if relative to “~” or “~username” expands “*:port and ”:port“ to ”0.0.0.0:port“.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#listeners-instance_method" title="#listeners (instance method)">#<strong>listeners</strong>(addresses)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>sets listeners to the given <code>addresses</code>, replacing or augmenting the current set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#reload-instance_method" title="#reload (instance method)">#<strong>reload</strong>(merge_defaults = true)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#check_bool-instance_method" title="#check_bool (instance method)">#<strong>check_bool</strong>(var, bool)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#parse_rackup_file-instance_method" title="#parse_rackup_file (instance method)">#<strong>parse_rackup_file</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>this is called <em>after</em> working_directory is bound.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#set_bool-instance_method" title="#set_bool (instance method)">#<strong>set_bool</strong>(var, bool)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#set_hook-instance_method" title="#set_hook (instance method)">#<strong>set_hook</strong>(var, my_proc, req_arity = 2)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#set_int-instance_method" title="#set_int (instance method)">#<strong>set_int</strong>(var, n, min)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#set_path-instance_method" title="#set_path (instance method)">#<strong>set_path</strong>(var, path)  </a>
    </span>
    <span class='note title private'>private</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature nodoc first'>
    .<strong>new</strong>(defaults = {})  &#x21d2; <code>Configurator</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L66-L80'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='66' data-end='80'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 66</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_defaults'>defaults</span> <span class='op'>=</span> {}) <span class='comment'>#:nodoc:
</span>  <span class='kw'>self</span>.<span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span> <span class='op'>=</span> <span class='const'>Hash</span>.<span class='id identifier rubyid_new'>new</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_unset'>unset</span>)
  <span class='ivar'>@use_defaults</span> <span class='op'>=</span> <span class='id identifier rubyid_defaults'>defaults</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_use_defaults'>use_defaults</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span> <span class='op'>=</span> <span class='id identifier rubyid_defaults'>defaults</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span>)

  <span class='comment'># after_reload is only used by unicorn_rails, unsupported otherwise
</span>  <span class='kw'>self</span>.<span class='id identifier rubyid_after_reload'><a href="#after_reload-instance_method" title="Unicorn::Configurator#after_reload (method)">after_reload</a></span> <span class='op'>=</span> <span class='id identifier rubyid_defaults'>defaults</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_after_reload'><a href="#after_reload-instance_method" title="Unicorn::Configurator#after_reload (method)">after_reload</a></span>)

  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='const'><a href="#DEFAULTS-constant" title="Unicorn::Configurator::DEFAULTS (constant)">DEFAULTS</a></span>) <span class='kw'>if</span> <span class='ivar'>@use_defaults</span>
  <span class='id identifier rubyid_defaults'>defaults</span>.<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span> <span class='kw'>self</span>.<span class='id identifier rubyid___send__'>__send__</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>) }
  <span class='const'>Hash</span> <span class='op'>===</span> <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listener_opts'>listener_opts</span>] <span class='kw'>or</span>
      <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listener_opts'>listener_opts</span>] <span class='op'>=</span> <span class='const'>Hash</span>.<span class='id identifier rubyid_new'>new</span> { <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='comma'>,</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span> <span class='id identifier rubyid_hash'>hash</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> {} }
  <span class='const'>Array</span> <span class='op'>===</span> <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listeners'><a href="#listeners-instance_method" title="Unicorn::Configurator#listeners (method)">listeners</a></span>] <span class='kw'>or</span> <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listeners'><a href="#listeners-instance_method" title="Unicorn::Configurator#listeners (method)">listeners</a></span>] <span class='op'>=</span> []
  <span class='id identifier rubyid_reload'><a href="#reload-instance_method" title="Unicorn::Configurator#reload (method)">reload</a></span>(<span class='kw'>false</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="after_reload-instance_method">
  <h3 class='signature rw  nodoc first'>
    #<strong>after_reload</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L18-L18'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='18' data-end='18'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 18</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_reload'>after_reload</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="config_file-instance_method">
  <h3 class='signature rw  nodoc'>
    #<strong>config_file</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L18-L18'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='18' data-end='18'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 18</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config_file'>config_file</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_reload'><a href="#after_reload-instance_method" title="Unicorn::Configurator#after_reload (method)">after_reload</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set-instance_method">
  <h3 class='signature rw  nodoc'>
    #<strong>set</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L18-L18'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='18' data-end='18'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 18</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_set'>set</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_reload'><a href="#after_reload-instance_method" title="Unicorn::Configurator#after_reload (method)">after_reload</a></span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="[]-instance_method">
  <h3 class='signature nodoc first'>
    #<strong>[]</strong>(key)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L129-L131'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='129' data-end='131'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 129</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>[]</span>(<span class='id identifier rubyid_key'>key</span>) <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='id identifier rubyid_key'>key</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="after_fork-instance_method">
  <h3 class='signature '>
    #<strong>after_fork</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets after_fork hook to a given block.  This block will be called by the worker after forking.  The following is an example hook which adds a per-process listener to every worker:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_after_fork'>after_fork</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span><span class='id identifier rubyid_worker'>worker</span><span class='op'>|</span>
  <span class='comment'># per-process listener ports for debugging/admin:
</span>  <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1:</span><span class='embexpr_beg'>#{</span><span class='int'>9293</span> <span class='op'>+</span> <span class='id identifier rubyid_worker'>worker</span>.<span class='id identifier rubyid_nr'>nr</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># the negative :tries parameter indicates we will retry forever
</span>  <span class='comment'># waiting on the existing process to exit with a 5 second :delay
</span>  <span class='comment'># Existing options for Unicorn::Configurator#listen such as
</span>  <span class='comment'># :backlog, :rcvbuf, :sndbuf are available here as well.
</span>  <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_listen'><a href="#listen-instance_method" title="Unicorn::Configurator#listen (method)">listen</a></span>(<span class='id identifier rubyid_addr'>addr</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tries'>tries</span> <span class='op'>=&gt;</span> <span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_delay'>delay</span> <span class='op'>=&gt;</span> <span class='int'>5</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_backlog'>backlog</span> <span class='op'>=&gt;</span> <span class='int'>128</span>)
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L167-L169'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='167' data-end='169'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 167</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_fork'>after_fork</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_set_hook'><a href="#set_hook-instance_method" title="Unicorn::Configurator#set_hook (method)">set_hook</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_after_fork'>after_fork</span><span class='comma'>,</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='id identifier rubyid_block'>block</span> <span class='op'>:</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>])
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="after_worker_exit-instance_method">
  <h3 class='signature '>
    #<strong>after_worker_exit</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets after_worker_exit hook to a given block.  This block will be called by the master process after a worker exits:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_after_worker_exit'>after_worker_exit</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span><span class='id identifier rubyid_worker'>worker</span><span class='comma'>,</span><span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
  <span class='comment'># status is a Process::Status instance for the exited worker process
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_success?'>success?</span>
    <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_error'>error</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>worker process failure: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>after_worker_exit is only available in unicorn 5.3.0+</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L182-L184'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='182' data-end='184'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 182</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_worker_exit'>after_worker_exit</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_set_hook'><a href="#set_hook-instance_method" title="Unicorn::Configurator#set_hook (method)">set_hook</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_after_worker_exit'>after_worker_exit</span><span class='comma'>,</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='id identifier rubyid_block'>block</span> <span class='op'>:</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>]<span class='comma'>,</span> <span class='int'>3</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="after_worker_ready-instance_method">
  <h3 class='signature '>
    #<strong>after_worker_ready</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets after_worker_ready hook to a given block.  This block will be called by a worker process after it has been fully loaded, directly before it starts responding to requests:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_after_worker_ready'>after_worker_ready</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span><span class='id identifier rubyid_worker'>worker</span><span class='op'>|</span>
  <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_logger'><a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">logger</a></span>.<span class='id identifier rubyid_info'>info</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>worker </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_worker'>worker</span>.<span class='id identifier rubyid_nr'>nr</span><span class='embexpr_end'>}</span><span class='tstring_content'> ready, dropping privileges</span><span class='tstring_end'>&quot;</span></span>)
  <span class='id identifier rubyid_worker'>worker</span>.<span class='id identifier rubyid_user'><a href="#user-instance_method" title="Unicorn::Configurator#user (method)">user</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>username</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>groupname</span><span class='tstring_end'>&#39;</span></span>)
<span class='kw'>end</span></code></pre>

<p>Do not use <a href="#user-instance_method" title="Unicorn::Configurator#user (method)">#user</a> if you rely on changing users in the after_worker_ready hook.</p>

<p>after_worker_ready is only available in unicorn 5.3.0+</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L199-L201'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='199' data-end='201'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 199</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_worker_ready'>after_worker_ready</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_set_hook'><a href="#set_hook-instance_method" title="Unicorn::Configurator#set_hook (method)">set_hook</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_after_worker_ready'>after_worker_ready</span><span class='comma'>,</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='id identifier rubyid_block'>block</span> <span class='op'>:</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>])
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="before_exec-instance_method">
  <h3 class='signature '>
    #<strong>before_exec</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets the before_exec hook to a given Proc object.  This Proc object will be called by the master process right before exec()-ing the new unicorn binary.  This is useful for freeing certain OS resources that you do NOT wish to share with the reexeced child process. There is no corresponding after_exec hook (for obvious reasons).</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L216-L218'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='216' data-end='218'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 216</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_before_exec'>before_exec</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_set_hook'><a href="#set_hook-instance_method" title="Unicorn::Configurator#set_hook (method)">set_hook</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_before_exec'>before_exec</span><span class='comma'>,</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='id identifier rubyid_block'>block</span> <span class='op'>:</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>]<span class='comma'>,</span> <span class='int'>1</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="before_fork-instance_method">
  <h3 class='signature '>
    #<strong>before_fork</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets before_fork got be a given Proc object.  This Proc object will be called by the master process before forking each worker.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L206-L208'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='206' data-end='208'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 206</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_before_fork'>before_fork</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_set_hook'><a href="#set_hook-instance_method" title="Unicorn::Configurator#set_hook (method)">set_hook</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_before_fork'>before_fork</span><span class='comma'>,</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='id identifier rubyid_block'>block</span> <span class='op'>:</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>])
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="canonicalize_tcp-instance_method">
  <h3 class='signature priv'>
    #<strong>canonicalize_tcp</strong>(addr, port)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L673-L677'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='673' data-end='677'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 673</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_canonicalize_tcp'>canonicalize_tcp</span>(<span class='id identifier rubyid_addr'>addr</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>)
  <span class='id identifier rubyid_packed'>packed</span> <span class='op'>=</span> <span class='const'>Socket</span>.<span class='id identifier rubyid_pack_sockaddr_in'>pack_sockaddr_in</span>(<span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_addr'>addr</span>)
  <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='const'>Socket</span>.<span class='id identifier rubyid_unpack_sockaddr_in'>unpack_sockaddr_in</span>(<span class='id identifier rubyid_packed'>packed</span>)
  <span class='id identifier rubyid_addr'>addr</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_addr'>addr</span><span class='embexpr_end'>}</span><span class='tstring_content'>]:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_addr'>addr</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="check_bool-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>check_bool</strong>(var, bool)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>ArgumentError</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L688-L694'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='688' data-end='694'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 688</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_check_bool'>check_bool</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>) <span class='comment'># :nodoc:
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_bool'>bool</span>
  <span class='kw'>when</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>false</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_bool'>bool</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_var'>var</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_bool'>bool</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> not a boolean</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="check_client_connection-instance_method">
  <h3 class='signature '>
    #<strong>check_client_connection</strong>(bool)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>When enabled, unicorn will check the client connection by writing the beginning of the HTTP headers before calling the application.</p>

<p>This will prevent calling the application for clients who have disconnected while their connection was queued.</p>

<p>This only affects clients connecting over Unix domain sockets and TCP via loopback (127.<strong>.</strong>.*).  It is unlikely to detect disconnects if the client is on a remote host (even on a fast LAN).</p>

<p>This option cannot be used in conjunction with <code>:tcp_nopush</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L580-L582'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='580' data-end='582'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 580</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_check_client_connection'>check_client_connection</span>(<span class='id identifier rubyid_bool'>bool</span>)
  <span class='id identifier rubyid_set_bool'><a href="#set_bool-instance_method" title="Unicorn::Configurator#set_bool (method)">set_bool</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_check_client_connection'>check_client_connection</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_body_buffer_size-instance_method">
  <h3 class='signature '>
    #<strong>client_body_buffer_size</strong>(bytes)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The maximum size (in <code>bytes</code>) to buffer in memory before resorting to a temporary file.  Default is 112 kilobytes. This option has no effect if “rewindable_input” is set to <code>false</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L565-L567'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='565' data-end='567'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 565</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_client_body_buffer_size'>client_body_buffer_size</span>(<span class='id identifier rubyid_bytes'>bytes</span>)
  <span class='id identifier rubyid_set_int'><a href="#set_int-instance_method" title="Unicorn::Configurator#set_int (method)">set_int</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_client_body_buffer_size'>client_body_buffer_size</span><span class='comma'>,</span> <span class='id identifier rubyid_bytes'>bytes</span><span class='comma'>,</span> <span class='int'>0</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="commit!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>commit!</strong>(server, options = {})  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L109-L127'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='109' data-end='127'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 109</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_commit!'>commit!</span>(<span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {}) <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_skip'>skip</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_skip'>skip</span>] <span class='op'>||</span> []
  <span class='kw'>if</span> <span class='id identifier rubyid_ready_pipe'>ready_pipe</span> <span class='op'>=</span> <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_ready_pipe'>ready_pipe</span>)
    <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid_ready_pipe'>ready_pipe</span> <span class='op'>=</span> <span class='id identifier rubyid_ready_pipe'>ready_pipe</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_check_client_connection'><a href="#check_client_connection-instance_method" title="Unicorn::Configurator#check_client_connection (method)">check_client_connection</a></span>]
    <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listeners'><a href="#listeners-instance_method" title="Unicorn::Configurator#listeners (method)">listeners</a></span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_address'>address</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listener_opts'>listener_opts</span>][<span class='id identifier rubyid_address'>address</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_tcp_nopush'>tcp_nopush</span>] <span class='op'>==</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>check_client_connection is incompatible with tcp_nopush:true</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unset'>unset</span> <span class='kw'>and</span> <span class='kw'>next</span>
    <span class='id identifier rubyid_skip'>skip</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_key'>key</span>) <span class='kw'>and</span> <span class='kw'>next</span>
    <span class='id identifier rubyid_server'>server</span>.<span class='id identifier rubyid___send__'>__send__</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="default_middleware-instance_method">
  <h3 class='signature '>
    #<strong>default_middleware</strong>(bool)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets whether to add default middleware in the development and deployment RACK_ENVs.</p>

<p>default_middleware is only available in unicorn 5.5.0+</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L282-L284'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='282' data-end='284'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 282</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_default_middleware'>default_middleware</span>(<span class='id identifier rubyid_bool'>bool</span>)
  <span class='id identifier rubyid_set_bool'><a href="#set_bool-instance_method" title="Unicorn::Configurator#set_bool (method)">set_bool</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_default_middleware'>default_middleware</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="early_hints-instance_method">
  <h3 class='signature '>
    #<strong>early_hints</strong>(bool)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets whether to enable the proposed early hints Rack API. If enabled, Rails 5.2+ will automatically send a 103 Early Hint for all the <code>javascript_include_tag</code> and <code>stylesheet_link_tag</code> in your response. See: <a href="https://api.rubyonrails.org/v5.2/classes/ActionDispatch/Request.html#method-i-send_early_hints">api.rubyonrails.org/v5.2/classes/ActionDispatch/Request.html#method-i-send_early_hints</a> See also <a href="https://tools.ietf.org/html/rfc8297">tools.ietf.org/html/rfc8297</a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L291-L293'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='291' data-end='293'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 291</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_early_hints'>early_hints</span>(<span class='id identifier rubyid_bool'>bool</span>)
  <span class='id identifier rubyid_set_bool'><a href="#set_bool-instance_method" title="Unicorn::Configurator#set_bool (method)">set_bool</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_early_hints'>early_hints</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="expand_addr-instance_method">
  <h3 class='signature nodoc'>
    #<strong>expand_addr</strong>(address)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>expands “unix:path/to/foo” to a socket relative to the current path expands pathnames of sockets if relative to “~” or “~username” expands “*:port and ”:port“ to ”0.0.0.0:port“</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L646-L664'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='646' data-end='664'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 646</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_expand_addr'>expand_addr</span>(<span class='id identifier rubyid_address'>address</span>) <span class='comment'>#:nodoc:
</span>  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>Integer</span> <span class='op'>===</span> <span class='id identifier rubyid_address'>address</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_address'>address</span> <span class='kw'>unless</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id identifier rubyid_address'>address</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_address'>address</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>\Aunix:(.*)\z</span><span class='regexp_end'>}</span></span>
    <span class='const'>File</span>.<span class='id identifier rubyid_expand_path'>expand_path</span>(<span class='backref'>$1</span>)
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>\A~</span><span class='regexp_end'>}</span></span>
    <span class='const'>File</span>.<span class='id identifier rubyid_expand_path'>expand_path</span>(<span class='id identifier rubyid_address'>address</span>)
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>\A(?:\*:)?(\d+)\z</span><span class='regexp_end'>}</span></span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0:</span><span class='embvar'>#</span><span class='backref'>$1</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>\A\[([a-fA-F0-9:]+)\]\z</span><span class='regexp_end'>}</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>%r/</span><span class='tstring_content'>\A((?:\d\.){3}\d)\z</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_canonicalize_tcp'><a href="#canonicalize_tcp-instance_method" title="Unicorn::Configurator#canonicalize_tcp (method)">canonicalize_tcp</a></span>(<span class='backref'>$1</span><span class='comma'>,</span> <span class='int'>80</span>)
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>\A\[([a-fA-F0-9:])\]:(\d)\z</span><span class='regexp_end'>}</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>\A(.*):(\d+)\z</span><span class='regexp_end'>}</span></span>
    <span class='id identifier rubyid_canonicalize_tcp'><a href="#canonicalize_tcp-instance_method" title="Unicorn::Configurator#canonicalize_tcp (method)">canonicalize_tcp</a></span>(<span class='backref'>$1</span><span class='comma'>,</span> <span class='backref'>$2</span>.<span class='id identifier rubyid_to_i'>to_i</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_address'>address</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="listen-instance_method">
  <h3 class='signature '>
    #<strong>listen</strong>(address, options = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Adds an <code>address</code> to the existing listener set.  May be specified more than once.  <code>address</code> may be an Integer port number for a TCP port, an “IP_ADDRESS:PORT” for TCP listeners or a pathname for UNIX domain sockets.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_listen'>listen</span> <span class='int'>3000</span> <span class='comment'># listen to port 3000 on all TCP interfaces
</span><span class='id identifier rubyid_listen'>listen</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1:3000</span><span class='tstring_end'>&quot;</span></span>  <span class='comment'># listen to port 3000 on the loopback interface
</span><span class='id identifier rubyid_listen'>listen</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/path/to/.unicorn.sock</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># listen on the given Unix domain socket
</span><span class='id identifier rubyid_listen'>listen</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[::1]:3000</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># listen to port 3000 on the IPv6 loopback interface</span></code></pre>

<p>When using Unix domain sockets, be sure: 1) the path matches the one used by nginx 2) uses the same filesystem namespace as the nginx process For systemd users using PrivateTmp=true (for either nginx or unicorn), this means Unix domain sockets must not be placed in /tmp</p>

<p>The following options may be specified (but are generally not needed):</p>
<dl class="rdoc-list label-list"><dt>:backlog =&gt; number of clients
<dd>
<p>This is the backlog of the listen() syscall.</p>

<p>Some operating systems allow negative values here to specify the maximum allowable value.  In most cases, this number is only recommendation and there are other OS-specific tunables and variables that can affect this number.  See the listen(2) syscall documentation of your OS for the exact semantics of this.</p>

<p>If you are running unicorn on multiple machines, lowering this number can help your load balancer detect when a machine is overloaded and give requests to a different machine.</p>

<p>Default: 1024</p>

<p>Note: with the Linux kernel, the net.core.somaxconn sysctl defaults to 128, capping this value to 128.  Raising the sysctl allows a larger backlog (which may not be desirable with multiple, load-balanced machines).</p>
</dd><dt>:rcvbuf =&gt; bytes, <code>:sndbuf</code> =&gt; bytes
<dd>
<p>Maximum receive and send buffer sizes (in bytes) of sockets.</p>

<p>These correspond to the SO_RCVBUF and SO_SNDBUF settings which can be set via the setsockopt(2) syscall.  Some kernels (e.g. Linux 2.4+) have intelligent auto-tuning mechanisms and there is no need (and it is sometimes detrimental) to specify them.</p>

<p>See the socket API documentation of your operating system to determine the exact semantics of these settings and other operating system-specific knobs where they can be specified.</p>

<p>Defaults: operating system defaults</p>
</dd><dt>:tcp_nodelay =&gt; true or false
<dd>
<p>Disables Nagle’s algorithm on TCP sockets if <code>true</code>.</p>

<p>Setting this to <code>true</code> can make streaming responses in Rails 3.1 appear more quickly at the cost of slightly higher bandwidth usage. The effect of this option is most visible if nginx is not used, but nginx remains highly recommended with unicorn.</p>

<p>This has no effect on UNIX sockets.</p>

<p>Default: <code>true</code> (Nagle’s algorithm disabled) in unicorn This defaulted to <code>false</code> in unicorn 3.x</p>
</dd><dt>:tcp_nopush =&gt; true or false
<dd>
<p>Enables/disables TCP_CORK in Linux or TCP_NOPUSH in FreeBSD</p>

<p>This prevents partial TCP frames from being sent out and reduces wakeups in nginx if it is on a different machine.  Since unicorn is only designed for applications that send the response body quickly without keepalive, sockets will always be flushed on close to prevent delays.</p>

<p>This has no effect on UNIX sockets.</p>

<p>Default: <code>false</code> This defaulted to <code>true</code> in unicorn 3.4 - 3.7</p>
</dd><dt>:ipv6only =&gt; true or false
<dd>
<p>This option makes IPv6-capable TCP listeners IPv6-only and unable to receive IPv4 queries on dual-stack systems.  A separate IPv4-only listener is required if this is true.</p>

<p>Enabling this option for the IPv6-only listener and having a separate IPv4 listener is recommended if you wish to support IPv6 on the same TCP port.  Otherwise, the value of <a href=“&quot;REMOTE_ADDR&quot;”>env</a> will appear as an ugly IPv4-mapped-IPv6 address for IPv4 clients (e.g “:ffff:10.0.0.1” instead of just “10.0.0.1”).</p>

<p>Default: Operating-system dependent</p>
</dd><dt>:reuseport =&gt; true or false
<dd>
<p>This enables multiple, independently-started unicorn instances to bind to the same port (as long as all the processes enable this).</p>

<p>This option must be used when unicorn first binds the listen socket. It cannot be enabled when a socket is inherited via SIGUSR2 (but it will remain on if inherited), and it cannot be enabled directly via SIGHUP.</p>

<p>Note: there is a chance of connections being dropped if one of the unicorn instances is stopped while using this.</p>

<p>This is supported on *BSD systems and Linux 3.9 or later.</p>

<p>ref: <a href="https://lwn.net/Articles/542629">lwn.net/Articles/542629</a>/</p>

<p>Default: false (unset)</p>
</dd><dt>:tries =&gt; Integer
<dd>
<p>Times to retry binding a socket if it is already in use</p>

<p>A negative number indicates we will retry indefinitely, this is useful for migrations and upgrades when individual workers are binding to different ports.</p>

<p>Default: 5</p>
</dd><dt>:delay =&gt; seconds
<dd>
<p>Seconds to wait between successive <code>tries</code></p>

<p>Default: 0.5 seconds</p>
</dd><dt>:umask =&gt; mode
<dd>
<p>Sets the file mode creation mask for UNIX sockets.  If specified, this is usually in octal notation.</p>

<p>Typically UNIX domain sockets are created with more liberal file permissions than the rest of the application.  By default, we create UNIX domain sockets to be readable and writable by all local users to give them the same accessibility as locally-bound TCP listeners.</p>

<p>This has no effect on TCP listeners.</p>

<p>Default: 0000 (world-read/writable)</p>
</dd><dt>:tcp_defer_accept =&gt; Integer
<dd>
<p>Defer accept() until data is ready (Linux-only)</p>

<p>For Linux 2.6.32 and later, this is the number of retransmits to defer an accept() for if no data arrives, but the client will eventually be accepted after the specified number of retransmits regardless of whether data is ready.</p>

<p>For Linux before 2.6.32, this is a boolean option, and accepts are <em>always</em> deferred indefinitely if no data arrives. This is similar to <code>:accept_filter =&gt; &quot;dataready&quot;</code> under FreeBSD.</p>

<p>Specifying <code>true</code> is synonymous for the default value(s) below, and <code>false</code> or <code>nil</code> is synonymous for a value of zero.</p>

<p>A value of <code>1</code> is a good optimization for local networks and trusted clients.  There is no good reason to ever disable this with a <code>zero</code> value with unicorn.</p>

<p>Default: 1</p>
</dd><dt>:accept_filter =&gt; String
<dd>
<p>defer accept() until data is ready (FreeBSD-only)</p>

<p>This enables either the “dataready” or (default) “httpready” accept() filter under FreeBSD.  This is intended as an optimization to reduce context switches with common GET/HEAD requests.</p>

<p>There is no good reason to change from the default.</p>

<p>Default: “httpready”</p>
</dd></dl>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L489-L510'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='489' data-end='510'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 489</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_listen'>listen</span>(<span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='id identifier rubyid_expand_addr'><a href="#expand_addr-instance_method" title="Unicorn::Configurator#expand_addr (method)">expand_addr</a></span>(<span class='id identifier rubyid_address'>address</span>)
  <span class='kw'>if</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id identifier rubyid_address'>address</span>
    [ <span class='symbeg'>:</span><span class='id identifier rubyid_umask'>umask</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_backlog'>backlog</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_sndbuf'>sndbuf</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rcvbuf'>rcvbuf</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tries'>tries</span> ].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='id identifier rubyid_key'>key</span>] <span class='kw'>or</span> <span class='kw'>next</span>
      <span class='const'>Integer</span> <span class='op'>===</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>or</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>not an integer: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    [ <span class='symbeg'>:</span><span class='id identifier rubyid_tcp_nodelay'>tcp_nodelay</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tcp_nopush'>tcp_nopush</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_ipv6only'>ipv6only</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reuseport'>reuseport</span> ].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
      (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='id identifier rubyid_key'>key</span>]).<span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>and</span> <span class='kw'>next</span>
      <span class='const'>TrueClass</span> <span class='op'>===</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>||</span> <span class='const'>FalseClass</span> <span class='op'>===</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>or</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>not boolean: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='kw'>unless</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_delay'>delay</span>]).<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='const'>Numeric</span> <span class='op'>===</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>or</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>not numeric: delay=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listener_opts'>listener_opts</span>][<span class='id identifier rubyid_address'>address</span>].<span class='id identifier rubyid_merge!'>merge!</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listeners'><a href="#listeners-instance_method" title="Unicorn::Configurator#listeners (method)">listeners</a></span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_address'>address</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="listeners-instance_method">
  <h3 class='signature nodoc'>
    #<strong>listeners</strong>(addresses)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets listeners to the given <code>addresses</code>, replacing or augmenting the current set.  This is for the global listener pool shared by all worker processes.  For per-worker listeners, see the after_fork example This is for internal API use only, do not use it in your <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a> config file.  Use listen instead.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L300-L304'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='300' data-end='304'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 300</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_listeners'>listeners</span>(<span class='id identifier rubyid_addresses'>addresses</span>) <span class='comment'># :nodoc:
</span>  <span class='const'>Array</span> <span class='op'>===</span> <span class='id identifier rubyid_addresses'>addresses</span> <span class='kw'>or</span> <span class='id identifier rubyid_addresses'>addresses</span> <span class='op'>=</span> <span class='const'>Array</span>(<span class='id identifier rubyid_addresses'>addresses</span>)
  <span class='id identifier rubyid_addresses'>addresses</span>.<span class='id identifier rubyid_map!'>map!</span> { <span class='op'>|</span><span class='id identifier rubyid_addr'>addr</span><span class='op'>|</span> <span class='id identifier rubyid_expand_addr'><a href="#expand_addr-instance_method" title="Unicorn::Configurator#expand_addr (method)">expand_addr</a></span>(<span class='id identifier rubyid_addr'>addr</span>) }
  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listeners'>listeners</span>] <span class='op'>=</span> <span class='id identifier rubyid_addresses'>addresses</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="logger-instance_method">
  <h3 class='signature '>
    #<strong>logger</strong>(obj)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets object to the <code>obj</code> Logger-like object.  The new Logger-like object must respond to the following methods:</p>
<ul><li>
<p>debug</p>
</li><li>
<p>info</p>
</li><li>
<p>warn</p>
</li><li>
<p>error</p>
</li><li>
<p>fatal</p>
</li></ul>

<p>The default Logger will log its output to the path specified by <a href="#stderr_path-instance_method" title="Unicorn::Configurator#stderr_path (method)">#stderr_path</a>.  If you’re running <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a> daemonized, then you must specify a path to prevent error messages from going to /dev/null.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L144-L151'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='144' data-end='151'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 144</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_logger'>logger</span>(<span class='id identifier rubyid_obj'>obj</span>)
  <span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>debug</span><span class='words_sep'> </span><span class='tstring_content'>info</span><span class='words_sep'> </span><span class='tstring_content'>warn</span><span class='words_sep'> </span><span class='tstring_content'>error</span><span class='words_sep'> </span><span class='tstring_content'>fatal</span><span class='tstring_end'>)</span></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span>
    <span class='id identifier rubyid_obj'>obj</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='id identifier rubyid_m'>m</span>) <span class='kw'>and</span> <span class='kw'>next</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logger=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_obj'>obj</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not respond to method=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_m'>m</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span>] <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_rackup_file-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>parse_rackup_file</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>this is called <em>after</em> working_directory is bound.  This only parses the embedded switches in <code>.ru</code> files (for “rackup” compatibility)</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L719-L748'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='719' data-end='748'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 719</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_rackup_file'>parse_rackup_file</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_ru'>ru</span> <span class='op'>=</span> <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_file'>file</span>] <span class='kw'>or</span> <span class='kw'>return</span> <span class='comment'># we only return here in unit tests
</span>
  <span class='comment'># :rails means use (old) Rails autodetect
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_ru'>ru</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rails'>rails</span>
    <span class='const'>File</span>.<span class='id identifier rubyid_readable?'>readable?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>config.ru</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>or</span> <span class='kw'>return</span>
    <span class='id identifier rubyid_ru'>ru</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>config.ru</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='const'>File</span>.<span class='id identifier rubyid_readable?'>readable?</span>(<span class='id identifier rubyid_ru'>ru</span>) <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rackup file (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ru'>ru</span><span class='embexpr_end'>}</span><span class='tstring_content'>) not readable</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># it could be a .rb file, too, we don&#39;t parse those manually
</span>  <span class='id identifier rubyid_ru'>ru</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.ru</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>or</span> <span class='kw'>return</span>

  <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^#\\(.*)</span><span class='regexp_end'>/</span></span> <span class='op'>=~</span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='id identifier rubyid_ru'>ru</span>) <span class='kw'>or</span> <span class='kw'>return</span>
  <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_optparse'>optparse</span>].<span class='id identifier rubyid_parse!'>parse!</span>(<span class='backref'>$1</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span>))

  <span class='kw'>if</span> <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_daemonize'>daemonize</span>]
    <span class='comment'># unicorn_rails wants a default pid path, (not plain &#39;unicorn&#39;)
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_after_reload'><a href="#after_reload-instance_method" title="Unicorn::Configurator#after_reload (method)">after_reload</a></span>
      <span class='id identifier rubyid_spid'>spid</span> <span class='op'>=</span> <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_pid'><a href="#pid-instance_method" title="Unicorn::Configurator#pid (method)">pid</a></span>]
      <span class='id identifier rubyid_pid'><a href="#pid-instance_method" title="Unicorn::Configurator#pid (method)">pid</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tmp/pids/unicorn.pid</span><span class='tstring_end'>&#39;</span></span>) <span class='kw'>if</span> <span class='id identifier rubyid_spid'>spid</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_spid'>spid</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unset'>unset</span>
    <span class='kw'>end</span>
    <span class='kw'>unless</span> <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_daemonized'>daemonized</span>]
      <span class='const'><a href="../Unicorn.html" title="Unicorn (module)">Unicorn</a></span><span class='op'>::</span><span class='const'><a href="Launcher.html" title="Unicorn::Launcher (module)">Launcher</a></span>.<span class='id identifier rubyid_daemonize!'><a href="Launcher.html#daemonize!-class_method" title="Unicorn::Launcher.daemonize! (method)">daemonize!</a></span>(<span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_options'>options</span>])
      <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ready_pipe'>ready_pipe</span>] <span class='op'>=</span> <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_options'>options</span>].<span class='id identifier rubyid_delete'>delete</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_ready_pipe'>ready_pipe</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pid-instance_method">
  <h3 class='signature '>
    #<strong>pid</strong>(path)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets the <code>path</code> for the PID file of the unicorn master process</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L513-L513'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='513' data-end='513'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 513</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pid'>pid</span>(<span class='id identifier rubyid_path'>path</span>)<span class='semicolon'>;</span> <span class='id identifier rubyid_set_path'><a href="#set_path-instance_method" title="Unicorn::Configurator#set_path (method)">set_path</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_pid'>pid</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span>)<span class='semicolon'>;</span> <span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="preload_app-instance_method">
  <h3 class='signature '>
    #<strong>preload_app</strong>(bool)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Enabling this preloads an application before forking worker processes.  This allows memory savings when using a copy-on-write-friendly GC but can cause bad things to happen when resources like sockets are opened at load time by the master process and shared by multiple children.  People enabling this are highly encouraged to look at the before_fork/after_fork hooks to properly close/reopen sockets.  Files opened for logging do not have to be reopened as (unbuffered-in-userspace) files opened with the <code>File::APPEND</code> flag are written to atomically on UNIX.</p>

<p>In addition to reloading the unicorn-specific config settings, SIGHUP will reload application code in the working directory/symlink when workers are gracefully restarted when preload_app=false (the default).  As reloading the application sometimes requires RubyGems updates, <code>Gem.refresh</code> is always called before the application is loaded (for RubyGems users).</p>

<p>During deployments, care should <em>always</em> be taken to ensure your applications are properly deployed and running.  Using preload_app=false (the default) means you <em>must</em> check if your application is responding properly after a deployment. Improperly deployed applications can go into a spawn loop if the application fails to load.  While your children are in a spawn loop, it is is possible to fix an application by properly deploying all required code and dependencies. Using preload_app=true means any application load error will cause the master process to exit with an error.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L543-L545'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='543' data-end='545'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 543</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_preload_app'>preload_app</span>(<span class='id identifier rubyid_bool'>bool</span>)
  <span class='id identifier rubyid_set_bool'><a href="#set_bool-instance_method" title="Unicorn::Configurator#set_bool (method)">set_bool</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_preload_app'>preload_app</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reload-instance_method">
  <h3 class='signature nodoc'>
    #<strong>reload</strong>(merge_defaults = true)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L82-L107'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='82' data-end='107'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 82</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reload'>reload</span>(<span class='id identifier rubyid_merge_defaults'>merge_defaults</span> <span class='op'>=</span> <span class='kw'>true</span>) <span class='comment'>#:nodoc:
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_merge_defaults'>merge_defaults</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@use_defaults</span>
    <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='const'><a href="#DEFAULTS-constant" title="Unicorn::Configurator::DEFAULTS (constant)">DEFAULTS</a></span>) <span class='kw'>if</span> <span class='ivar'>@use_defaults</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_instance_eval'>instance_eval</span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span>)<span class='comma'>,</span> <span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span>) <span class='kw'>if</span> <span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span>

  <span class='id identifier rubyid_parse_rackup_file'><a href="#parse_rackup_file-instance_method" title="Unicorn::Configurator#parse_rackup_file (method)">parse_rackup_file</a></span>

  <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_set_listener'>set_listener</span>] <span class='kw'>and</span>
    <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_listeners'><a href="#listeners-instance_method" title="Unicorn::Configurator#listeners (method)">listeners</a></span>] <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_host'>host</span>]<span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_port'>port</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='const'><a href="#RACKUP-constant" title="Unicorn::Configurator::RACKUP (constant)">RACKUP</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_no_default_middleware'>no_default_middleware</span>] <span class='kw'>and</span>
    <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_default_middleware'><a href="#default_middleware-instance_method" title="Unicorn::Configurator#default_middleware (method)">default_middleware</a></span>] <span class='op'>=</span> <span class='kw'>false</span>

  <span class='comment'># unicorn_rails creates dirs here after working_directory is bound
</span>  <span class='id identifier rubyid_after_reload'><a href="#after_reload-instance_method" title="Unicorn::Configurator#after_reload (method)">after_reload</a></span>.<span class='id identifier rubyid_call'>call</span> <span class='kw'>if</span> <span class='id identifier rubyid_after_reload'><a href="#after_reload-instance_method" title="Unicorn::Configurator#after_reload (method)">after_reload</a></span>

  <span class='comment'># working_directory binds immediately (easier error checking that way),
</span>  <span class='comment'># now ensure any paths we changed are correctly set.
</span>  [ <span class='symbeg'>:</span><span class='id identifier rubyid_pid'><a href="#pid-instance_method" title="Unicorn::Configurator#pid (method)">pid</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_stderr_path'><a href="#stderr_path-instance_method" title="Unicorn::Configurator#stderr_path (method)">stderr_path</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_stdout_path'><a href="#stdout_path-instance_method" title="Unicorn::Configurator#stdout_path (method)">stdout_path</a></span> ].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_var'>var</span><span class='op'>|</span>
    <span class='const'>String</span> <span class='op'>===</span> (<span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='id identifier rubyid_var'>var</span>]) <span class='kw'>or</span> <span class='kw'>next</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_expand_path'>expand_path</span>(<span class='id identifier rubyid_path'>path</span>)
    <span class='const'>File</span>.<span class='id identifier rubyid_writable?'>writable?</span>(<span class='id identifier rubyid_path'>path</span>) <span class='op'>||</span> <span class='const'>File</span>.<span class='id identifier rubyid_writable?'>writable?</span>(<span class='const'>File</span>.<span class='id identifier rubyid_dirname'>dirname</span>(<span class='id identifier rubyid_path'>path</span>)) <span class='kw'>or</span> \
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>directory for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_var'>var</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> not writable</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rewindable_input-instance_method">
  <h3 class='signature '>
    #<strong>rewindable_input</strong>(bool)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Toggles making <a href=“&quot;rack.input&quot;”>env</a> rewindable. Disabling rewindability can improve performance by lowering I/O and memory usage for applications that accept uploads. Keep in mind that the Rack 1.x spec requires <a href=“&quot;rack.input&quot;”>env</a> to be rewindable, but the Rack 2.x spec does not.</p>

<p><code>rewindable_input</code> defaults to <code>true</code> for compatibility. Setting it to <code>false</code> may be safe for applications and frameworks developed for Rack 2.x and later.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L557-L559'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='557' data-end='559'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 557</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_rewindable_input'>rewindable_input</span>(<span class='id identifier rubyid_bool'>bool</span>)
  <span class='id identifier rubyid_set_bool'><a href="#set_bool-instance_method" title="Unicorn::Configurator#set_bool (method)">set_bool</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rewindable_input'>rewindable_input</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_bool-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>set_bool</strong>(var, bool)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L696-L698'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='696' data-end='698'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 696</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_bool'>set_bool</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>) <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='id identifier rubyid_var'>var</span>] <span class='op'>=</span> <span class='id identifier rubyid_check_bool'><a href="#check_bool-instance_method" title="Unicorn::Configurator#check_bool (method)">check_bool</a></span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_hook-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>set_hook</strong>(var, my_proc, req_arity = 2)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L700-L714'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='700' data-end='714'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 700</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_hook'>set_hook</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_my_proc'>my_proc</span><span class='comma'>,</span> <span class='id identifier rubyid_req_arity'>req_arity</span> <span class='op'>=</span> <span class='int'>2</span>) <span class='comment'>#:nodoc:
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_my_proc'>my_proc</span>
  <span class='kw'>when</span> <span class='const'>Proc</span>
    <span class='id identifier rubyid_arity'>arity</span> <span class='op'>=</span> <span class='id identifier rubyid_my_proc'>my_proc</span>.<span class='id identifier rubyid_arity'>arity</span>
    (<span class='id identifier rubyid_arity'>arity</span> <span class='op'>==</span> <span class='id identifier rubyid_req_arity'>req_arity</span>) <span class='kw'>or</span> \
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_var'>var</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_my_proc'>my_proc</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> has invalid arity: </span><span class='tstring_end'>&quot;</span></span> \
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arity'>arity</span><span class='embexpr_end'>}</span><span class='tstring_content'> (need </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_req_arity'>req_arity</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>when</span> <span class='const'>NilClass</span>
    <span class='id identifier rubyid_my_proc'>my_proc</span> <span class='op'>=</span> <span class='const'><a href="#DEFAULTS-constant" title="Unicorn::Configurator::DEFAULTS (constant)">DEFAULTS</a></span>[<span class='id identifier rubyid_var'>var</span>]
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_var'>var</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_my_proc'>my_proc</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='id identifier rubyid_var'>var</span>] <span class='op'>=</span> <span class='id identifier rubyid_my_proc'>my_proc</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_int-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>set_int</strong>(var, n, min)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L667-L671'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='667' data-end='671'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 667</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_int'>set_int</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='id identifier rubyid_min'>min</span>) <span class='comment'>#:nodoc:
</span>  <span class='const'>Integer</span> <span class='op'>===</span> <span class='id identifier rubyid_n'>n</span> <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>not an integer: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_var'>var</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_n'>n</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_n'>n</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_min'>min</span> <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>too low (&lt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_min'>min</span><span class='embexpr_end'>}</span><span class='tstring_content'>): </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_var'>var</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_n'>n</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='id identifier rubyid_var'>var</span>] <span class='op'>=</span> <span class='id identifier rubyid_n'>n</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_path-instance_method">
  <h3 class='signature priv  nodoc'>
    #<strong>set_path</strong>(var, path)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L679-L686'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='679' data-end='686'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 679</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_path'>set_path</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span>) <span class='comment'>#:nodoc:
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_path'>path</span>
  <span class='kw'>when</span> <span class='const'>NilClass</span><span class='comma'>,</span> <span class='const'>String</span>
    <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='id identifier rubyid_var'>var</span>] <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stderr_path-instance_method">
  <h3 class='signature '>
    #<strong>stderr_path</strong>(path)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Allow redirecting $stderr to a given path.  Unlike doing this from the shell, this allows the unicorn process to know the path its writing to and rotate the file if it is used for logging.  The file will be opened with the <code>File::APPEND</code> flag and writes synchronized to the kernel (but not necessarily to <em>disk</em>) so multiple processes can safely append to it.</p>

<p>If you are daemonizing and using the default <a href="#logger-instance_method" title="Unicorn::Configurator#logger (method)">#logger</a>, it is important to specify this as errors will otherwise be lost to /dev/null. Some applications/libraries may also triggering warnings that go to stderr, and they will end up here.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L595-L597'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='595' data-end='597'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 595</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_stderr_path'>stderr_path</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='id identifier rubyid_set_path'><a href="#set_path-instance_method" title="Unicorn::Configurator#set_path (method)">set_path</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_stderr_path'>stderr_path</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stdout_path-instance_method">
  <h3 class='signature '>
    #<strong>stdout_path</strong>(path)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Same as stderr_path, except for $stdout.  Not many Rack applications write to $stdout, but any that do will have their output written here. It is safe to point this to the same location a stderr_path. Like stderr_path, this defaults to /dev/null when daemonized.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L603-L605'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='603' data-end='605'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 603</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_stdout_path'>stdout_path</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='id identifier rubyid_set_path'><a href="#set_path-instance_method" title="Unicorn::Configurator#set_path (method)">set_path</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_stdout_path'>stdout_path</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="timeout-instance_method">
  <h3 class='signature '>
    #<strong>timeout</strong>(seconds)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Strongly consider using <a href="Application_Timeouts.html">Application_Timeouts.html</a> instead of this misfeature.  This misfeature has done decades of damage to Ruby since it demotivates the use of fine-grained timeout mechanisms.</p>

<p>Sets the timeout of worker processes to <code>seconds</code>.  Workers handling the request/app.call/response cycle taking longer than this time period will be forcibly killed (via SIGKILL).  This timeout is enforced by the master process itself and not subject to the scheduling limitations by the worker process.  Due the low-complexity, low-overhead implementation, timeouts of less than 3.0 seconds can be considered inaccurate and unsafe.</p>

<p>For running <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a> behind nginx, it is recommended to set “fail_timeout=0” for in your nginx configuration like this to have nginx always retry backends that may have had workers SIGKILL-ed due to timeouts.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_upstream'>upstream</span> <span class='id identifier rubyid_unicorn_backend'>unicorn_backend</span> {
  <span class='comment'># for UNIX domain socket setups:
</span>  <span class='id identifier rubyid_server'>server</span> <span class='label'>unix:</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>path</span><span class='regexp_end'>/to</span></span><span class='op'>/</span>.<span class='id identifier rubyid_unicorn'>unicorn</span>.<span class='id identifier rubyid_sock'>sock</span> <span class='id identifier rubyid_fail_timeout'>fail_timeout</span><span class='op'>=</span><span class='int'>0</span><span class='semicolon'>;</span>

  <span class='comment'># for TCP setups
</span>  <span class='id identifier rubyid_server'>server</span> <span class='float'>192.168</span><span class='op'>:</span><span class='int'>8080</span> <span class='id identifier rubyid_fail_timeout'>fail_timeout</span><span class='op'>=</span><span class='int'>0</span><span class='semicolon'>;</span>
  <span class='id identifier rubyid_server'>server</span> <span class='float'>192.168</span><span class='op'>:</span><span class='int'>8080</span> <span class='id identifier rubyid_fail_timeout'>fail_timeout</span><span class='op'>=</span><span class='int'>0</span><span class='semicolon'>;</span>
  <span class='id identifier rubyid_server'>server</span> <span class='float'>192.168</span><span class='op'>:</span><span class='int'>8080</span> <span class='id identifier rubyid_fail_timeout'>fail_timeout</span><span class='op'>=</span><span class='int'>0</span><span class='semicolon'>;</span>
}</code></pre>

<p>See <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html">nginx.org/en/docs/http/ngx_http_upstream_module.html</a> for more details on nginx upstream configuration.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L250-L255'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='250' data-end='255'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 250</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_timeout'>timeout</span>(<span class='id identifier rubyid_seconds'>seconds</span>)
  <span class='id identifier rubyid_set_int'><a href="#set_int-instance_method" title="Unicorn::Configurator#set_int (method)">set_int</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='id identifier rubyid_seconds'>seconds</span><span class='comma'>,</span> <span class='int'>3</span>)
  <span class='comment'># POSIX says 31 days is the smallest allowed maximum timeout for select()
</span>  <span class='id identifier rubyid_max'>max</span> <span class='op'>=</span> <span class='int'>30</span> <span class='op'>*</span> <span class='int'>60</span> <span class='op'>*</span> <span class='int'>60</span> <span class='op'>*</span> <span class='int'>24</span>
  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_timeout'>timeout</span>] <span class='op'>=</span> <span class='id identifier rubyid_seconds'>seconds</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_max'>max</span> <span class='op'>?</span> <span class='id identifier rubyid_max'>max</span> <span class='op'>:</span> <span class='id identifier rubyid_seconds'>seconds</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="user-instance_method">
  <h3 class='signature '>
    #<strong>user</strong>(user, group = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Runs worker processes as the specified <code>user</code> and <code>group</code>. The master process always stays running as the user who started it. This switch will occur after calling the after_fork hook, and only if the <a href="Worker.html#user-instance_method" title="Unicorn::Worker#user (method)">Worker#user</a> method is not called in the after_fork hook <code>group</code> is optional and will not change if unspecified.</p>

<p>Do not use <code>#user</code> if you rely on changing users in the after_worker_ready hook.  Instead, you need to call <a href="Worker.html#user-instance_method" title="Unicorn::Worker#user (method)">Worker#user</a> directly in after_worker_ready.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L636-L641'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='636' data-end='641'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 636</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_user'>user</span>(<span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='comment'># raises ArgumentError on invalid user/group
</span>  <span class='const'>Etc</span>.<span class='id identifier rubyid_getpwnam'>getpwnam</span>(<span class='id identifier rubyid_user'>user</span>)
  <span class='const'>Etc</span>.<span class='id identifier rubyid_getgrnam'>getgrnam</span>(<span class='id identifier rubyid_group'>group</span>) <span class='kw'>if</span> <span class='id identifier rubyid_group'>group</span>
  <span class='id identifier rubyid_set'><a href="#set-instance_method" title="Unicorn::Configurator#set (method)">set</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_user'>user</span>] <span class='op'>=</span> [ <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span> ]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_exec-instance_method">
  <h3 class='signature '>
    #<strong>worker_exec</strong>(bool)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Whether to exec in each worker process after forking.  This changes the memory layout of each worker process, which is a security feature designed to defeat possible address space discovery attacks.  Note that using worker_exec only makes sense if you are not preloading the application, and will result in higher memory usage.</p>

<p>worker_exec is only available in unicorn 5.3.0+</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L264-L266'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='264' data-end='266'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 264</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_exec'>worker_exec</span>(<span class='id identifier rubyid_bool'>bool</span>)
  <span class='id identifier rubyid_set_bool'><a href="#set_bool-instance_method" title="Unicorn::Configurator#set_bool (method)">set_bool</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_worker_exec'>worker_exec</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_processes-instance_method">
  <h3 class='signature '>
    #<strong>worker_processes</strong>(nr)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets the current number of worker_processes to <code>nr</code>.  Each worker process will serve exactly one client at a time.  You can increment or decrement this value at runtime by sending SIGTTIN or SIGTTOU respectively to the master process without reloading the rest of your <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a> configuration.  See the SIGNALS document for more information.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L274-L276'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='274' data-end='276'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 274</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_processes'>worker_processes</span>(<span class='id identifier rubyid_nr'>nr</span>)
  <span class='id identifier rubyid_set_int'><a href="#set_int-instance_method" title="Unicorn::Configurator#set_int (method)">set_int</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_worker_processes'>worker_processes</span><span class='comma'>,</span> <span class='id identifier rubyid_nr'>nr</span><span class='comma'>,</span> <span class='int'>1</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="working_directory-instance_method">
  <h3 class='signature '>
    #<strong>working_directory</strong>(path)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets the working directory for <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a>.  This ensures SIGUSR2 will start a new instance of <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a> in this directory.  This may be a symlink, a common scenario for Capistrano users.  Unlike all other <a href="../Unicorn.html" title="Unicorn (module)"><code>::Unicorn</code></a> configuration directives, this binds immediately for error checking and cannot be undone by unsetting it in the configuration file and reloading.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/configurator.rb#L613-L625'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='613' data-end='625'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/configurator.rb', line 613</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_working_directory'>working_directory</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='comment'># just let chdir raise errors
</span>  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span>.<span class='id identifier rubyid_expand_path'>expand_path</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span> <span class='op'>&amp;&amp;</span>
     <span class='op'>!</span> <span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>) <span class='op'>&amp;&amp;</span>
     <span class='op'>!</span> <span class='const'>File</span>.<span class='id identifier rubyid_readable?'>readable?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>config_file=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_config_file'><a href="#config_file-instance_method" title="Unicorn::Configurator#config_file (method)">config_file</a></span><span class='embexpr_end'>}</span><span class='tstring_content'> would not be accessible in</span><span class='tstring_end'>&quot;</span></span> \
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> working_directory=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='const'>Dir</span>.<span class='id identifier rubyid_chdir'>chdir</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='const'><a href="../Unicorn.html" title="Unicorn (module)">Unicorn</a></span><span class='op'>::</span><span class='const'><a href="HttpServer.html" title="Unicorn::HttpServer (class)">HttpServer</a></span><span class='op'>::</span><span class='const'><a href="HttpServer.html#START_CTX-constant" title="Unicorn::HttpServer::START_CTX (constant)">START_CTX</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cwd'>cwd</span>] <span class='op'>=</span> <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PWD</span><span class='tstring_end'>&quot;</span></span>] <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>