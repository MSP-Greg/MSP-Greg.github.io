<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Unicorn::TeeInput &mdash; Unicorn master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Unicorn::TeeInput",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Unicorn master</a> &raquo; 
      <a href='../_index.html#alpha_T'>Index (T)</a> &raquo; 
        <a class='nodoc' href="../Unicorn.html" title="Unicorn (module)">Unicorn</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>TeeInput&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Unicorn::TeeInput</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="StreamInput.html" title="Unicorn::StreamInput (class)"><code>StreamInput</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="StreamInput.html" title="Unicorn::StreamInput (class)"><code>StreamInput</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="StreamInput.html" title="Unicorn::StreamInput (class)">Unicorn::StreamInput</a></span>
        <ul class='fullTree'>
          <li><a href="../Object.html" title="Object (class)"><code>::Object</code></a></li>
          <li class='next'><a href="StreamInput.html" title="Unicorn::StreamInput (class)">Unicorn::StreamInput</a></li>
          <li class='next'>Unicorn::TeeInput</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L14'>lib/unicorn/tee_input.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Acts like tee(1) on an input input to provide a input-like stream while providing rewindable semantics through a File/StringIO backing store.  On the first pass, the input is only read on demand so your Rack application can use input notification (upload progress and like).  This should fully conform to the <code>Rack::Lint::InputWrapper</code> specification on the public API.  This class is intended to be a strict interpretation of <code>Rack::Lint::InputWrapper</code> functionality and will not support any deviations from it.</p>

<p>When processing uploads, unicorn exposes a <code>TeeInput</code> object under “rack.input” of the Rack environment by default.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#client_body_buffer_size-class_method" title=".client_body_buffer_size (class method)">.<strong>client_body_buffer_size</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the maximum size of request bodies to buffer in memory, amounts larger than this are buffered to the filesystem.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#client_body_buffer_size=-class_method" title=".client_body_buffer_size= (class method)">.<strong>client_body_buffer_size=</strong>(bytes)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>sets the maximum size of request bodies to buffer in memory, amounts larger than this are buffered to the filesystem.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(socket, request)  &#x21d2; TeeInput </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Initializes a new <code>TeeInput</code> object.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="StreamInput.html" title="Unicorn::StreamInput (class)"><code>StreamInput</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="StreamInput.html#new-class_method" title="Unicorn::StreamInput.new (method)">.new</a></td>
      <td><div class='inline'><p>Initializes a new <a href="StreamInput.html" title="Unicorn::StreamInput (class)"><code>StreamInput</code></a> object.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="StreamInput.html" title="Unicorn::StreamInput (class)"><code>StreamInput</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ro priv' href="StreamInput.html#eof%3F-instance_method" title="Unicorn::StreamInput#eof? (method)">#eof?</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#gets-instance_method" title="#gets (instance method)">#<strong>gets</strong>  &#x21d2; String<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Reads the next “line” from the I/O stream; lines are separated by the global record separator ($/, typically “n”).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#read-instance_method" title="#read (instance method)">#<strong>read</strong>([length [, buffer ]])  &#x21d2; String, ... </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Reads at most length bytes from the I/O stream, or to the end of file if length is omitted or is nil.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#rewind-instance_method" title="#rewind (instance method)">#<strong>rewind</strong>  &#x21d2; 0 </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Positions the <strong>ios</strong> pointer to the beginning of input, returns the offset (zero) of the <code>ios</code> pointer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#size-instance_method" title="#size (instance method)">#<strong>size</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the size of the input.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#consume!-instance_method" title="#consume! (instance method)">#<strong>consume!</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>consumes the stream of the socket.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#tee-instance_method" title="#tee (instance method)">#<strong>tee</strong>(buffer)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new_tmpio-instance_method" title="#new_tmpio (instance method)">#<strong>new_tmpio</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>for <code>Rack::TempfileReaper</code> in rack 1.6+.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="StreamInput.html" title="Unicorn::StreamInput (class)"><code>StreamInput</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="StreamInput.html#each-instance_method" title="Unicorn::StreamInput#each (method)">#each</a></td>
      <td><div class='inline'><p>Executes the block for every “line” in <strong>ios</strong>, where lines are separated by the global record separator ($/, typically “n”).</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="StreamInput.html#gets-instance_method" title="Unicorn::StreamInput#gets (method)">#gets</a></td>
      <td><div class='inline'><p>Reads the next “line” from the I/O stream; lines are separated by the global record separator ($/, typically “n”).</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="StreamInput.html#read-instance_method" title="Unicorn::StreamInput#read (method)">#read</a></td>
      <td><div class='inline'><p>Reads at most length bytes from the I/O stream, or to the end of file if length is omitted or is nil.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="StreamInput.html#eof!-instance_method" title="Unicorn::StreamInput#eof! (method)">#eof!</a>,
        <a class='i_m priv' href="StreamInput.html#filter_body-instance_method" title="Unicorn::StreamInput#filter_body (method)">#filter_body</a>,
        <a class='i_m priv' href="StreamInput.html#read_all-instance_method" title="Unicorn::StreamInput#read_all (method)">#read_all</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature nodoc first'>
    .<strong>new</strong>(socket, request)  &#x21d2; <code>TeeInput</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Initializes a new <code>TeeInput</code> object.  You normally do not have to call this unless you are writing an HTTP server.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L40-L45'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='40' data-end='45'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 40</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_socket'>socket</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span>) <span class='comment'># :nodoc:
</span>  <span class='ivar'>@len</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span>.<span class='id identifier rubyid_content_length'>content_length</span>
  <span class='kw'>super</span>
  <span class='ivar'>@tmp</span> <span class='op'>=</span> <span class='ivar'>@len</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@len</span> <span class='op'>&lt;=</span> <span class='cvar'>@@client_body_buffer_size</span> <span class='op'>?</span>
         <span class='const'>StringIO</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>:</span> <span class='id identifier rubyid_new_tmpio'><a href="#new_tmpio-instance_method" title="Unicorn::TeeInput#new_tmpio (method)">new_tmpio</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="client_body_buffer_size-class_method">
  <h3 class='signature rw  nodoc first'>
    .<strong>client_body_buffer_size</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the maximum size of request bodies to buffer in memory, amounts larger than this are buffered to the filesystem</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L27-L29'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='27' data-end='29'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 27</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_client_body_buffer_size'>client_body_buffer_size</span> <span class='comment'># :nodoc:
</span>  <span class='cvar'>@@client_body_buffer_size</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="client_body_buffer_size=-class_method">
  <h3 class='signature rw  nodoc'>
    .<strong>client_body_buffer_size=</strong>(bytes)   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>sets the maximum size of request bodies to buffer in memory, amounts larger than this are buffered to the filesystem</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L21-L23'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='21' data-end='23'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 21</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_client_body_buffer_size='>client_body_buffer_size=</span>(<span class='id identifier rubyid_bytes'>bytes</span>) <span class='comment'># :nodoc:
</span>  <span class='cvar'>@@client_body_buffer_size</span> <span class='op'>=</span> <span class='id identifier rubyid_bytes'>bytes</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="consume!-instance_method">
  <h3 class='signature priv first'>
    #<strong>consume!</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>consumes the stream of the socket</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L122-L125'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='122' data-end='125'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 122</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_consume!'>consume!</span>
  <span class='id identifier rubyid_junk'>junk</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>nil</span> <span class='kw'>while</span> <span class='id identifier rubyid_read'><a href="#read-instance_method" title="Unicorn::TeeInput#read (method)">read</a></span>(<span class='cvar'>@@io_chunk_size</span><span class='comma'>,</span> <span class='id identifier rubyid_junk'>junk</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="gets-instance_method">
  <h3 class='signature '>
    #<strong>gets</strong>  &#x21d2; <code>String</code><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Reads the next “line” from the I/O stream; lines are separated by the global record separator ($/, typically “n”). A global record separator of nil reads the entire unread contents of ios. Returns nil if called at the end of file. This takes zero arguments for strict <code>Rack::Lint</code> compatibility, unlike <code>IO#gets</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L103-L105'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='103' data-end='105'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 103</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_gets'>gets</span>
  <span class='ivar'>@socket</span> <span class='op'>?</span> <span class='id identifier rubyid_tee'><a href="#tee-instance_method" title="Unicorn::TeeInput#tee (method)">tee</a></span>(<span class='kw'>super</span>) <span class='op'>:</span> <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_gets'>gets</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="new_tmpio-instance_method">
  <h3 class='signature nodoc'>
    #<strong>new_tmpio</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>for <code>Rack::TempfileReaper</code> in rack 1.6+</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L32-L36'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='32' data-end='36'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 32</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_new_tmpio'>new_tmpio</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_tmpio'>tmpio</span> <span class='op'>=</span> <span class='const'><a href="../Unicorn.html" title="Unicorn (module)">Unicorn</a></span><span class='op'>::</span><span class='const'><a href="TmpIO.html" title="Unicorn::TmpIO (class)">TmpIO</a></span>.<span class='id identifier rubyid_new'><a href="TmpIO.html#new-class_method" title="Unicorn::TmpIO.new (method)">new</a></span>
  (<span class='ivar'>@parser</span>.<span class='id identifier rubyid_env'>env</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rack.tempfiles</span><span class='tstring_end'>&#39;</span></span>] <span class='op'>||=</span> []) <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_tmpio'>tmpio</span>
  <span class='id identifier rubyid_tmpio'>tmpio</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="read-instance_method">
  <h3 class='signature '>
    #<strong>read</strong>([length [, buffer ]])  &#x21d2; <code>String</code>, ...   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Reads at most length bytes from the I/O stream, or to the end of file if length is omitted or is nil. length must be a non-negative integer or nil. If the optional buffer argument is present, it must reference a String, which will receive the data.</p>

<p>At end of file, it returns nil or “” depend on length. ios.read() and ios.read(nil) returns “”. ios.read(length [, buffer]) returns nil.</p>

<p>If the Content-Length of the HTTP request is known (as is the common case for POST requests), then ios.read(length [, buffer]) will block until the specified length is read (or it is the last chunk). Otherwise, for uncommon “Transfer-Encoding: chunked” requests, ios.read(length [, buffer]) will return immediately if there is any data and only block when nothing is available (providing <code>IO#readpartial</code> semantics).</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L90-L92'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='90' data-end='92'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 90</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_read'>read</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='ivar'>@socket</span> <span class='op'>?</span> <span class='id identifier rubyid_tee'><a href="#tee-instance_method" title="Unicorn::TeeInput#tee (method)">tee</a></span>(<span class='kw'>super</span>) <span class='op'>:</span> <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_read'>read</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rewind-instance_method">
  <h3 class='signature '>
    #<strong>rewind</strong>  &#x21d2; <code>0</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Positions the <strong>ios</strong> pointer to the beginning of input, returns the offset (zero) of the <code>ios</code> pointer.  Subsequent reads will start from the beginning of the previously-buffered input.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L113-L117'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='113' data-end='117'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 113</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_rewind'>rewind</span>
  <span class='kw'>return</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='int'>0</span> <span class='op'>==</span> <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_size'><a href="#size-instance_method" title="Unicorn::TeeInput#size (method)">size</a></span>
  <span class='id identifier rubyid_consume!'><a href="#consume!-instance_method" title="Unicorn::TeeInput#consume! (method)">consume!</a></span> <span class='kw'>if</span> <span class='ivar'>@socket</span>
  <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_rewind'>rewind</span> <span class='comment'># Rack does not specify what the return value is here
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="size-instance_method">
  <h3 class='signature '>
    #<strong>size</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the size of the input.  For requests with a Content-Length header value, this will not read data off the socket and just return the value of the Content-Length header as an Integer.</p>

<p>For Transfer-Encoding:chunked requests, this requires consuming all of the input stream before returning since there’s no other way to determine the size of the request body beforehand.</p>

<p>This method is no longer part of the Rack specification as of Rack 1.2, so its use is not recommended.  This method only exists for compatibility with Rack applications designed for Rack 1.1 and earlier.  Most applications should only need to call <a href="#read-instance_method" title="Unicorn::TeeInput#read (method)">#read</a> with a specified <code>length</code> in a loop until it returns <code>nil</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L63-L69'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='63' data-end='69'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 63</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='ivar'>@len</span> <span class='kw'>and</span> <span class='kw'>return</span> <span class='ivar'>@len</span>
  <span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_pos'>pos</span>
  <span class='id identifier rubyid_consume!'><a href="#consume!-instance_method" title="Unicorn::TeeInput#consume! (method)">consume!</a></span>
  <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='id identifier rubyid_pos'>pos</span>
  <span class='ivar'>@len</span> <span class='op'>=</span> <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_size'>size</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="tee-instance_method">
  <h3 class='signature priv'>
    #<strong>tee</strong>(buffer)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/defunkt/unicorn/blob/master/lib/unicorn/tee_input.rb#L127-L130'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='127' data-end='130'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/unicorn/tee_input.rb', line 127</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_tee'>tee</span>(<span class='id identifier rubyid_buffer'>buffer</span>)
  <span class='ivar'>@tmp</span>.<span class='id identifier rubyid_write'>write</span>(<span class='id identifier rubyid_buffer'>buffer</span>) <span class='kw'>if</span> <span class='id identifier rubyid_buffer'>buffer</span>
  <span class='id identifier rubyid_buffer'>buffer</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>