<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: CSV::Parser &mdash; csv  Ruby-3.0.6 pp216</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "CSV::Parser",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Ruby-3.0.6</a> &raquo; 
      <a href='../'>csv</a> &raquo; 
      <a href='../_index.html#alpha_P'>Index (P)</a> &raquo; 
        <a href="../CSV.html" title="CSV (class)">CSV</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Parser&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: CSV::Parser</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Parser/InputsScanner.html" title="CSV::Parser::InputsScanner (class)"><code>InputsScanner</code></a>,
        <a href="Parser/Scanner.html" title="CSV::Parser::Scanner (class)"><code>Scanner</code></a>,
        <a href="Parser/UnoptimizedStringIO.html" title="CSV::Parser::UnoptimizedStringIO (class)"><code>UnoptimizedStringIO</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Exceptions:</div>
      <div class='box_11'>
          <a href="Parser/InvalidEncoding.html" title="CSV::Parser::InvalidEncoding (class)"><code>InvalidEncoding</code></a>      </div>
    </td></tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L15'>lib/csv/parser.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Note: Donâ€™t use this class directly. This is an internal class.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='SCANNER_TEST-constant' class='summary_signature'>SCANNER_TEST =</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L707-L707'># File 'lib/csv/parser.rb', line 707</a>    <pre class='code ruby'>(<span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CSV_PARSER_SCANNER_TEST</span><span class='tstring_end'>&quot;</span></span>] <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>yes</span><span class='tstring_end'>&quot;</span></span>)</pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(input, options)  &#x21d2; Parser </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#header_row%3F-instance_method" title="#header_row? (instance method)">#<strong>header_row?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#liberal_parsing%3F-instance_method" title="#liberal_parsing? (instance method)">#<strong>liberal_parsing?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#return_headers%3F-instance_method" title="#return_headers? (instance method)">#<strong>return_headers?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#skip_blanks%3F-instance_method" title="#skip_blanks? (instance method)">#<strong>skip_blanks?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#unconverted_fields%3F-instance_method" title="#unconverted_fields? (instance method)">#<strong>unconverted_fields?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#use_headers%3F-instance_method" title="#use_headers? (instance method)">#<strong>use_headers?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro priv'>
      <a href="#may_quoted%3F-instance_method" title="#may_quoted? (instance method)">#<strong>may_quoted?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#column_separator-instance_method" title="#column_separator (instance method)">#<strong>column_separator</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#field_size_limit-instance_method" title="#field_size_limit (instance method)">#<strong>field_size_limit</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#headers-instance_method" title="#headers (instance method)">#<strong>headers</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#line-instance_method" title="#line (instance method)">#<strong>line</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#lineno-instance_method" title="#lineno (instance method)">#<strong>lineno</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#parse-instance_method" title="#parse (instance method)">#<strong>parse</strong>(&amp;block)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#quote_character-instance_method" title="#quote_character (instance method)">#<strong>quote_character</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#row_separator-instance_method" title="#row_separator (instance method)">#<strong>row_separator</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#skip_lines-instance_method" title="#skip_lines (instance method)">#<strong>skip_lines</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#add_unconverted_fields-instance_method" title="#add_unconverted_fields (instance method)">#<strong>add_unconverted_fields</strong>(row, fields)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>This method injects an instance variable <code>unconverted_fields</code> into <code>row</code> and an accessor method for <code>row</code> called unconverted_fields().</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#adjust_headers-instance_method" title="#adjust_headers (instance method)">#<strong>adjust_headers</strong>(headers)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_scanner-instance_method" title="#build_scanner (instance method)">#<strong>build_scanner</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>See additional method definition at line 727.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#detect_row_separator-instance_method" title="#detect_row_separator (instance method)">#<strong>detect_row_separator</strong>(sample, cr, lf)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#emit_row-instance_method" title="#emit_row (instance method)">#<strong>emit_row</strong>(row) {|row| ... } </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#ignore_broken_line-instance_method" title="#ignore_broken_line (instance method)">#<strong>ignore_broken_line</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#last_line-instance_method" title="#last_line (instance method)">#<strong>last_line</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_column_end-instance_method" title="#parse_column_end (instance method)">#<strong>parse_column_end</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_column_value-instance_method" title="#parse_column_value (instance method)">#<strong>parse_column_value</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_headers-instance_method" title="#parse_headers (instance method)">#<strong>parse_headers</strong>(row)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_no_quote-instance_method" title="#parse_no_quote (instance method)">#<strong>parse_no_quote</strong>(&amp;block)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_quotable_loose-instance_method" title="#parse_quotable_loose (instance method)">#<strong>parse_quotable_loose</strong>(&amp;block)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_quotable_robust-instance_method" title="#parse_quotable_robust (instance method)">#<strong>parse_quotable_robust</strong>(&amp;block)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_quoted_column_value-instance_method" title="#parse_quoted_column_value (instance method)">#<strong>parse_quoted_column_value</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_row_end-instance_method" title="#parse_row_end (instance method)">#<strong>parse_row_end</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#parse_unquoted_column_value-instance_method" title="#parse_unquoted_column_value (instance method)">#<strong>parse_unquoted_column_value</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare-instance_method" title="#prepare (instance method)">#<strong>prepare</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>A set of tasks to prepare the file in order to parse it.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_backslash-instance_method" title="#prepare_backslash (instance method)">#<strong>prepare_backslash</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_header-instance_method" title="#prepare_header (instance method)">#<strong>prepare_header</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_line-instance_method" title="#prepare_line (instance method)">#<strong>prepare_line</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_parser-instance_method" title="#prepare_parser (instance method)">#<strong>prepare_parser</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_quote_character-instance_method" title="#prepare_quote_character (instance method)">#<strong>prepare_quote_character</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_quoted-instance_method" title="#prepare_quoted (instance method)">#<strong>prepare_quoted</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_separators-instance_method" title="#prepare_separators (instance method)">#<strong>prepare_separators</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_skip_lines-instance_method" title="#prepare_skip_lines (instance method)">#<strong>prepare_skip_lines</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_strip-instance_method" title="#prepare_strip (instance method)">#<strong>prepare_strip</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_unquoted-instance_method" title="#prepare_unquoted (instance method)">#<strong>prepare_unquoted</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#prepare_variable-instance_method" title="#prepare_variable (instance method)">#<strong>prepare_variable</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#resolve_row_separator-instance_method" title="#resolve_row_separator (instance method)">#<strong>resolve_row_separator</strong>(separator)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#skip_line%3F-instance_method" title="#skip_line? (instance method)">#<strong>skip_line?</strong>(line)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#skip_needless_lines-instance_method" title="#skip_needless_lines (instance method)">#<strong>skip_needless_lines</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#start_row-instance_method" title="#start_row (instance method)">#<strong>start_row</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#strip_value-instance_method" title="#strip_value (instance method)">#<strong>strip_value</strong>(value)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(input, options)  &#x21d2; <code>Parser</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L258-L264'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='258' data-end='264'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 258</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
  <span class='ivar'>@input</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>
  <span class='ivar'>@samples</span> <span class='op'>=</span> []

  <span class='id identifier rubyid_prepare'><a href="#prepare-instance_method" title="CSV::Parser#prepare (method)">prepare</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="header_row?-instance_method">
  <h3 class='signature ro first'>
    #<strong>header_row?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L294-L296'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='294' data-end='296'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 294</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_header_row?'>header_row?</span>
  <span class='ivar'>@use_headers</span> <span class='kw'>and</span> <span class='ivar'>@headers</span>.<span class='id identifier rubyid_nil?'>nil?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="liberal_parsing?-instance_method">
  <h3 class='signature ro'>
    #<strong>liberal_parsing?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L306-L308'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='306' data-end='308'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 306</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_liberal_parsing?'>liberal_parsing?</span>
  <span class='ivar'>@liberal_parsing</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="may_quoted?-instance_method">
  <h3 class='signature ro priv'>
    #<strong>may_quoted?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L693-L705'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='693' data-end='705'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 693</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_may_quoted?'>may_quoted?</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='ivar'>@quote_character</span>.<span class='id identifier rubyid_nil?'>nil?</span>

  <span class='kw'>if</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>StringIO</span>)
    <span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_pos'>pos</span>
    <span class='id identifier rubyid_sample'>sample</span> <span class='op'>=</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_read'><a href="../CSV.html#read-class_method" title="CSV.read (method)">read</a></span>
    <span class='ivar'>@input</span>.<span class='id identifier rubyid_seek'>seek</span>(<span class='id identifier rubyid_pos'>pos</span>)
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='ivar'>@samples</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_sample'>sample</span> <span class='op'>=</span> <span class='ivar'>@samples</span>.<span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_sample'>sample</span>[<span class='int'>0</span><span class='comma'>,</span> <span class='int'>128</span>].<span class='id identifier rubyid_index'>index</span>(<span class='ivar'>@quote_character</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="return_headers?-instance_method">
  <h3 class='signature ro'>
    #<strong>return_headers?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L298-L300'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='298' data-end='300'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 298</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_return_headers?'>return_headers?</span>
  <span class='ivar'>@return_headers</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="skip_blanks?-instance_method">
  <h3 class='signature ro'>
    #<strong>skip_blanks?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L302-L304'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='302' data-end='304'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 302</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_skip_blanks?'>skip_blanks?</span>
  <span class='ivar'>@skip_blanks</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unconverted_fields?-instance_method">
  <h3 class='signature ro'>
    #<strong>unconverted_fields?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L286-L288'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='286' data-end='288'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 286</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unconverted_fields?'>unconverted_fields?</span>
  <span class='ivar'>@unconverted_fields</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="use_headers?-instance_method">
  <h3 class='signature ro'>
    #<strong>use_headers?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L350-L352'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='350' data-end='352'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 350</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_use_headers?'>use_headers?</span>
  <span class='ivar'>@use_headers</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="add_unconverted_fields-instance_method">
  <h3 class='signature priv first'>
    #<strong>add_unconverted_fields</strong>(row, fields)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>This method injects an instance variable <code>unconverted_fields</code> into <code>row</code> and an accessor method for <code>row</code> called unconverted_fields().  The variable is set to the contents of <code>fields</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L1134-L1140'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1134' data-end='1140'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 1134</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_unconverted_fields'>add_unconverted_fields</span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='id identifier rubyid_fields'>fields</span>)
  <span class='kw'>class</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_row'>row</span>
    <span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unconverted_fields'>unconverted_fields</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_row'>row</span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='symbeg'>:</span><span class='ivar'>@unconverted_fields</span><span class='comma'>,</span> <span class='id identifier rubyid_fields'>fields</span>)
  <span class='id identifier rubyid_row'>row</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="adjust_headers-instance_method">
  <h3 class='signature priv'>
    #<strong>adjust_headers</strong>(headers)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L683-L687'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='683' data-end='687'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 683</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_adjust_headers'>adjust_headers</span>(<span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span>)
  <span class='id identifier rubyid_adjusted_headers'>adjusted_headers</span> <span class='op'>=</span> <span class='ivar'>@header_fields_converter</span>.<span class='id identifier rubyid_convert'><a href="../CSV.html#convert-instance_method" title="CSV#convert (method)">convert</a></span>(<span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
  <span class='id identifier rubyid_adjusted_headers'>adjusted_headers</span>.<span class='id identifier rubyid_each'><a href="../CSV.html#each-instance_method" title="CSV#each (method)">each</a></span> {<span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span>.<span class='id identifier rubyid_freeze'>freeze</span> <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span>.<span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>}
  <span class='id identifier rubyid_adjusted_headers'>adjusted_headers</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_scanner-instance_method">
  <h3 class='signature priv'>
    #<strong>build_scanner</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>See additional method definition at line 727.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L742-L755'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='742' data-end='755'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 742</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_scanner'>build_scanner</span>
  <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='ivar'>@samples</span>.<span class='id identifier rubyid_collect'>collect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sample'>sample</span><span class='op'>|</span>
    <span class='const'><a href="Parser/UnoptimizedStringIO.html" title="CSV::Parser::UnoptimizedStringIO (class)">UnoptimizedStringIO</a></span>.<span class='id identifier rubyid_new'><a href="Parser/UnoptimizedStringIO.html#new-class_method" title="CSV::Parser::UnoptimizedStringIO.new (method)">new</a></span>(<span class='id identifier rubyid_sample'>sample</span>)
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>StringIO</span>)
    <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>&lt;&lt;</span> <span class='const'><a href="Parser/UnoptimizedStringIO.html" title="CSV::Parser::UnoptimizedStringIO (class)">UnoptimizedStringIO</a></span>.<span class='id identifier rubyid_new'><a href="Parser/UnoptimizedStringIO.html#new-class_method" title="CSV::Parser::UnoptimizedStringIO.new (method)">new</a></span>(<span class='ivar'>@input</span>.<span class='id identifier rubyid_read'><a href="../CSV.html#read-class_method" title="CSV.read (method)">read</a></span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@input</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_chunk_size'>chunk_size</span> <span class='op'>=</span> <span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CSV_PARSER_SCANNER_TEST_CHUNK_SIZE</span><span class='tstring_end'>&quot;</span></span>] <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><a href="Parser/InputsScanner.html" title="CSV::Parser::InputsScanner (class)">InputsScanner</a></span>.<span class='id identifier rubyid_new'><a href="Parser/InputsScanner.html#new-class_method" title="CSV::Parser::InputsScanner.new (method)">new</a></span>(<span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span>
                    <span class='ivar'>@encoding</span><span class='comma'>,</span>
                    <span class='label'>chunk_size:</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_chunk_size'>chunk_size</span><span class='comma'>,</span> <span class='int'>10</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="column_separator-instance_method">
  <h3 class='signature '>
    #<strong>column_separator</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L266-L268'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='266' data-end='268'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 266</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_column_separator'>column_separator</span>
  <span class='ivar'>@column_separator</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="detect_row_separator-instance_method">
  <h3 class='signature priv'>
    #<strong>detect_row_separator</strong>(sample, cr, lf)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L613-L635'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='613' data-end='635'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 613</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_detect_row_separator'>detect_row_separator</span>(<span class='id identifier rubyid_sample'>sample</span><span class='comma'>,</span> <span class='id identifier rubyid_cr'>cr</span><span class='comma'>,</span> <span class='id identifier rubyid_lf'>lf</span>)
  <span class='id identifier rubyid_lf_index'>lf_index</span> <span class='op'>=</span> <span class='id identifier rubyid_sample'>sample</span>.<span class='id identifier rubyid_index'>index</span>(<span class='id identifier rubyid_lf'>lf</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_lf_index'>lf_index</span>
    <span class='id identifier rubyid_cr_index'>cr_index</span> <span class='op'>=</span> <span class='id identifier rubyid_sample'>sample</span>[<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_lf_index'>lf_index</span>].<span class='id identifier rubyid_index'>index</span>(<span class='id identifier rubyid_cr'>cr</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_cr_index'>cr_index</span> <span class='op'>=</span> <span class='id identifier rubyid_sample'>sample</span>.<span class='id identifier rubyid_index'>index</span>(<span class='id identifier rubyid_cr'>cr</span>)
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_cr_index'>cr_index</span> <span class='kw'>and</span> <span class='id identifier rubyid_lf_index'>lf_index</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cr_index'>cr_index</span> <span class='op'>+</span> <span class='int'>1</span> <span class='op'>==</span> <span class='id identifier rubyid_lf_index'>lf_index</span>
      <span class='id identifier rubyid_cr'>cr</span> <span class='op'>+</span> <span class='id identifier rubyid_lf'>lf</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_cr_index'>cr_index</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_lf_index'>lf_index</span>
      <span class='id identifier rubyid_cr'>cr</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_lf'>lf</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_cr_index'>cr_index</span>
    <span class='id identifier rubyid_cr'>cr</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_lf_index'>lf_index</span>
    <span class='id identifier rubyid_lf'>lf</span>
  <span class='kw'>else</span>
    <span class='symbeg'>:</span><span class='id identifier rubyid_auto'>auto</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="emit_row-instance_method">
  <h3 class='signature priv'>
    #<strong>emit_row</strong>(row) {|row| ... }  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(<code>row</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L1105-L1129'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1105' data-end='1129'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 1105</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_emit_row'>emit_row</span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='ivar'>@lineno</span> <span class='op'>+=</span> <span class='int'>1</span>

  <span class='id identifier rubyid_raw_row'>raw_row</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span>
  <span class='kw'>if</span> <span class='ivar'>@use_headers</span>
    <span class='kw'>if</span> <span class='ivar'>@headers</span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='ivar'>@headers</span> <span class='op'>=</span> <span class='id identifier rubyid_adjust_headers'><a href="#adjust_headers-instance_method" title="CSV::Parser#adjust_headers (method)">adjust_headers</a></span>(<span class='id identifier rubyid_row'>row</span>)
      <span class='kw'>return</span> <span class='kw'>unless</span> <span class='ivar'>@return_headers</span>
      <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> <span class='const'><a href="Row.html" title="CSV::Row (class)">Row</a></span>.<span class='id identifier rubyid_new'><a href="Row.html#new-class_method" title="CSV::Row.new (method)">new</a></span>(<span class='ivar'>@headers</span><span class='comma'>,</span> <span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='kw'>true</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> <span class='const'><a href="Row.html" title="CSV::Row (class)">Row</a></span>.<span class='id identifier rubyid_new'><a href="Row.html#new-class_method" title="CSV::Row.new (method)">new</a></span>(<span class='ivar'>@headers</span><span class='comma'>,</span>
                    <span class='ivar'>@fields_converter</span>.<span class='id identifier rubyid_convert'><a href="../CSV.html#convert-instance_method" title="CSV#convert (method)">convert</a></span>(<span class='id identifier rubyid_raw_row'>raw_row</span><span class='comma'>,</span> <span class='ivar'>@headers</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>))
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># convert fields, if needed...
</span>    <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> <span class='ivar'>@fields_converter</span>.<span class='id identifier rubyid_convert'><a href="../CSV.html#convert-instance_method" title="CSV#convert (method)">convert</a></span>(<span class='id identifier rubyid_raw_row'>raw_row</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
  <span class='kw'>end</span>

  <span class='comment'># inject unconverted fields and accessor, if requested...
</span>  <span class='kw'>if</span> <span class='ivar'>@unconverted_fields</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='id identifier rubyid_row'>row</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_unconverted_fields'>unconverted_fields</span>)
    <span class='id identifier rubyid_add_unconverted_fields'><a href="#add_unconverted_fields-instance_method" title="CSV::Parser#add_unconverted_fields (method)">add_unconverted_fields</a></span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='id identifier rubyid_raw_row'>raw_row</span>)
  <span class='kw'>end</span>

  <span class='kw'>yield</span>(<span class='id identifier rubyid_row'>row</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="field_size_limit-instance_method">
  <h3 class='signature '>
    #<strong>field_size_limit</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L278-L280'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='278' data-end='280'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 278</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_field_size_limit'>field_size_limit</span>
  <span class='ivar'>@field_size_limit</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="headers-instance_method">
  <h3 class='signature '>
    #<strong>headers</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L290-L292'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='290' data-end='292'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 290</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_headers'>headers</span>
  <span class='ivar'>@headers</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ignore_broken_line-instance_method">
  <h3 class='signature priv'>
    #<strong>ignore_broken_line</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L1090-L1094'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1090' data-end='1094'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 1090</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ignore_broken_line'>ignore_broken_line</span>
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@not_line_end</span>)
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@cr_or_lf</span>)
  <span class='ivar'>@lineno</span> <span class='op'>+=</span> <span class='int'>1</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="last_line-instance_method">
  <h3 class='signature priv'>
    #<strong>last_line</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L643-L649'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='643' data-end='649'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 643</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_last_line'>last_line</span>
  <span class='kw'>if</span> <span class='ivar'>@scanner</span>
    <span class='ivar'>@last_line</span> <span class='op'>||=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_end'>keep_end</span>
  <span class='kw'>else</span>
    <span class='ivar'>@last_line</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="line-instance_method">
  <h3 class='signature '>
    #<strong>line</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L314-L316'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='314' data-end='316'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 314</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_line'>line</span>
  <span class='id identifier rubyid_last_line'><a href="#last_line-instance_method" title="CSV::Parser#last_line (method)">last_line</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="lineno-instance_method">
  <h3 class='signature '>
    #<strong>lineno</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L310-L312'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='310' data-end='312'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 310</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_lineno'>lineno</span>
  <span class='ivar'>@lineno</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse-instance_method">
  <h3 class='signature '>
    #<strong>parse</strong>(&amp;block)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L318-L348'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='318' data-end='348'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 318</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse'>parse</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>return</span> <span class='id identifier rubyid_to_enum'>to_enum</span>(<span class='id identifier rubyid___method__'>__method__</span>) <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='kw'>if</span> <span class='ivar'>@return_headers</span> <span class='kw'>and</span> <span class='ivar'>@headers</span> <span class='kw'>and</span> <span class='ivar'>@raw_headers</span>
    <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span> <span class='op'>=</span> <span class='const'><a href="Row.html" title="CSV::Row (class)">Row</a></span>.<span class='id identifier rubyid_new'><a href="Row.html#new-class_method" title="CSV::Row.new (method)">new</a></span>(<span class='ivar'>@headers</span><span class='comma'>,</span> <span class='ivar'>@raw_headers</span><span class='comma'>,</span> <span class='kw'>true</span>)
    <span class='kw'>if</span> <span class='ivar'>@unconverted_fields</span>
      <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span> <span class='op'>=</span> <span class='id identifier rubyid_add_unconverted_fields'><a href="#add_unconverted_fields-instance_method" title="CSV::Parser#add_unconverted_fields (method)">add_unconverted_fields</a></span>(<span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span><span class='comma'>,</span> [])
    <span class='kw'>end</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='ivar'>@scanner</span> <span class='op'>||=</span> <span class='id identifier rubyid_build_scanner'><a href="#build_scanner-instance_method" title="CSV::Parser#build_scanner (method)">build_scanner</a></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_quote_character'><a href="#quote_character-instance_method" title="CSV::Parser#quote_character (method)">quote_character</a></span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_parse_no_quote'><a href="#parse_no_quote-instance_method" title="CSV::Parser#parse_no_quote (method)">parse_no_quote</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>elsif</span> <span class='ivar'>@need_robust_parsing</span>
      <span class='id identifier rubyid_parse_quotable_robust'><a href="#parse_quotable_robust-instance_method" title="CSV::Parser#parse_quotable_robust (method)">parse_quotable_robust</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_parse_quotable_loose'><a href="#parse_quotable_loose-instance_method" title="CSV::Parser#parse_quotable_loose (method)">parse_quotable_loose</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'><a href="Parser/InvalidEncoding.html" title="CSV::Parser::InvalidEncoding (class)">InvalidEncoding</a></span>
    <span class='kw'>if</span> <span class='ivar'>@scanner</span>
      <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
      <span class='id identifier rubyid_lineno'><a href="#lineno-instance_method" title="CSV::Parser#lineno (method)">lineno</a></span> <span class='op'>=</span> <span class='ivar'>@lineno</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_lineno'><a href="#lineno-instance_method" title="CSV::Parser#lineno (method)">lineno</a></span> <span class='op'>=</span> <span class='ivar'>@lineno</span> <span class='op'>+</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid byte sequence in </span><span class='embexpr_beg'>#{</span><span class='ivar'>@encoding</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_lineno'><a href="#lineno-instance_method" title="CSV::Parser#lineno (method)">lineno</a></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_column_end-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_column_end</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L1042-L1054'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1042' data-end='1054'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 1042</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_column_end'>parse_column_end</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='ivar'>@column_end</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@column_ends</span>

  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
  <span class='kw'>if</span> <span class='ivar'>@column_ends</span>.<span class='id identifier rubyid_all?'>all?</span> {<span class='op'>|</span><span class='id identifier rubyid_column_end'>column_end</span><span class='op'>|</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='id identifier rubyid_column_end'>column_end</span>)}
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
    <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_back'>keep_back</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_column_value-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_column_value</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L940-L968'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='940' data-end='968'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 940</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_column_value'>parse_column_value</span>
  <span class='kw'>if</span> <span class='ivar'>@liberal_parsing</span>
    <span class='id identifier rubyid_quoted_value'>quoted_value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_quoted_column_value'><a href="#parse_quoted_column_value-instance_method" title="CSV::Parser#parse_quoted_column_value (method)">parse_quoted_column_value</a></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_quoted_value'>quoted_value</span>
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@strip_value</span>) <span class='kw'>if</span> <span class='ivar'>@strip_value</span>
      <span class='id identifier rubyid_unquoted_value'>unquoted_value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_unquoted_column_value'><a href="#parse_unquoted_column_value-instance_method" title="CSV::Parser#parse_unquoted_column_value (method)">parse_unquoted_column_value</a></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_unquoted_value'>unquoted_value</span>
        <span class='kw'>if</span> <span class='ivar'>@double_quote_outside_quote</span>
          <span class='id identifier rubyid_unquoted_value'>unquoted_value</span> <span class='op'>=</span> <span class='id identifier rubyid_unquoted_value'>unquoted_value</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='ivar'>@quote_character</span> <span class='op'>*</span> <span class='int'>2</span><span class='comma'>,</span>
                                               <span class='ivar'>@quote_character</span>)
          <span class='kw'>if</span> <span class='id identifier rubyid_quoted_value'>quoted_value</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'># %Q{&quot;&quot;...} case
</span>            <span class='kw'>return</span> <span class='ivar'>@quote_character</span> <span class='op'>+</span> <span class='id identifier rubyid_unquoted_value'>unquoted_value</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        <span class='ivar'>@quote_character</span> <span class='op'>+</span> <span class='id identifier rubyid_quoted_value'>quoted_value</span> <span class='op'>+</span> <span class='ivar'>@quote_character</span> <span class='op'>+</span> <span class='id identifier rubyid_unquoted_value'>unquoted_value</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_quoted_value'>quoted_value</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_parse_unquoted_column_value'><a href="#parse_unquoted_column_value-instance_method" title="CSV::Parser#parse_unquoted_column_value (method)">parse_unquoted_column_value</a></span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='ivar'>@may_quoted</span>
    <span class='id identifier rubyid_parse_quoted_column_value'><a href="#parse_quoted_column_value-instance_method" title="CSV::Parser#parse_quoted_column_value (method)">parse_quoted_column_value</a></span> <span class='op'>||</span>
      <span class='id identifier rubyid_parse_unquoted_column_value'><a href="#parse_unquoted_column_value-instance_method" title="CSV::Parser#parse_unquoted_column_value (method)">parse_unquoted_column_value</a></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_parse_unquoted_column_value'><a href="#parse_unquoted_column_value-instance_method" title="CSV::Parser#parse_unquoted_column_value (method)">parse_unquoted_column_value</a></span> <span class='op'>||</span>
      <span class='id identifier rubyid_parse_quoted_column_value'><a href="#parse_quoted_column_value-instance_method" title="CSV::Parser#parse_quoted_column_value (method)">parse_quoted_column_value</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_headers-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_headers</strong>(row)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L676-L681'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='676' data-end='681'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 676</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_headers'>parse_headers</span>(<span class='id identifier rubyid_row'>row</span>)
  <span class='const'><a href="../CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse_line'><a href="../CSV.html#parse_line-class_method" title="CSV.parse_line (method)">parse_line</a></span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span>
                 <span class='label'>col_sep:</span>    <span class='ivar'>@column_separator</span><span class='comma'>,</span>
                 <span class='label'>row_sep:</span>    <span class='ivar'>@row_separator</span><span class='comma'>,</span>
                 <span class='label'>quote_char:</span> <span class='ivar'>@quote_character</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_no_quote-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_no_quote</strong>(&amp;block)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L799-L821'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='799' data-end='821'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 799</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_no_quote'>parse_no_quote</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_each_line'>each_line</span>(<span class='ivar'>@row_separator</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='ivar'>@skip_lines</span> <span class='kw'>and</span> <span class='id identifier rubyid_skip_line?'><a href="#skip_line%3F-instance_method" title="CSV::Parser#skip_line? (method)">skip_line?</a></span>(<span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>)
    <span class='id identifier rubyid_original_line'>original_line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>
    <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span> <span class='op'>=</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='ivar'>@row_separator</span>)

    <span class='kw'>if</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_empty?'>empty?</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='ivar'>@skip_blanks</span>
      <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> []
    <span class='kw'>else</span>
      <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span> <span class='op'>=</span> <span class='id identifier rubyid_strip_value'><a href="#strip_value-instance_method" title="CSV::Parser#strip_value (method)">strip_value</a></span>(<span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>)
      <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_split'>split</span>(<span class='ivar'>@split_column_separator</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>1</span>)
      <span class='id identifier rubyid_n_columns'>n_columns</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span>.<span class='id identifier rubyid_size'>size</span>
      <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='kw'>while</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_n_columns'>n_columns</span>
        <span class='id identifier rubyid_row'>row</span>[<span class='id identifier rubyid_i'>i</span>] <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span>[<span class='id identifier rubyid_i'>i</span>].<span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_i'>i</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='ivar'>@last_line</span> <span class='op'>=</span> <span class='id identifier rubyid_original_line'>original_line</span>
    <span class='id identifier rubyid_emit_row'><a href="#emit_row-instance_method" title="CSV::Parser#emit_row (method)">emit_row</a></span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_quotable_loose-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_quotable_loose</strong>(&amp;block)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L823-L876'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='823' data-end='876'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 823</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_quotable_loose'>parse_quotable_loose</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_each_line'>each_line</span>(<span class='ivar'>@row_separator</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='ivar'>@skip_lines</span> <span class='kw'>and</span> <span class='id identifier rubyid_skip_line?'><a href="#skip_line%3F-instance_method" title="CSV::Parser#skip_line? (method)">skip_line?</a></span>(<span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>)
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_original_line'>original_line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>
    <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span> <span class='op'>=</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='ivar'>@row_separator</span>)

    <span class='kw'>if</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_empty?'>empty?</span>
      <span class='kw'>if</span> <span class='ivar'>@skip_blanks</span>
        <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
        <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
        <span class='kw'>next</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> []
    <span class='kw'>elsif</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='ivar'>@cr</span>) <span class='kw'>or</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='ivar'>@lf</span>)
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_back'>keep_back</span>
      <span class='ivar'>@need_robust_parsing</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_parse_quotable_robust'><a href="#parse_quotable_robust-instance_method" title="CSV::Parser#parse_quotable_robust (method)">parse_quotable_robust</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_split'>split</span>(<span class='ivar'>@split_column_separator</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>1</span>)
      <span class='id identifier rubyid_n_columns'>n_columns</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span>.<span class='id identifier rubyid_size'>size</span>
      <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='kw'>while</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_n_columns'>n_columns</span>
        <span class='id identifier rubyid_column'>column</span> <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span>[<span class='id identifier rubyid_i'>i</span>]
        <span class='kw'>if</span> <span class='id identifier rubyid_column'>column</span>.<span class='id identifier rubyid_empty?'>empty?</span>
          <span class='id identifier rubyid_row'>row</span>[<span class='id identifier rubyid_i'>i</span>] <span class='op'>=</span> <span class='kw'>nil</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>=</span> <span class='id identifier rubyid_column'>column</span>.<span class='id identifier rubyid_count'>count</span>(<span class='ivar'>@quote_character</span>)
          <span class='kw'>if</span> <span class='id identifier rubyid_n_quotes'>n_quotes</span>.<span class='id identifier rubyid_zero?'>zero?</span>
            <span class='comment'># no quote
</span>          <span class='kw'>elsif</span> <span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>==</span> <span class='int'>2</span> <span class='kw'>and</span>
               <span class='id identifier rubyid_column'>column</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='ivar'>@quote_character</span>) <span class='kw'>and</span>
               <span class='id identifier rubyid_column'>column</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='ivar'>@quote_character</span>)
            <span class='id identifier rubyid_row'>row</span>[<span class='id identifier rubyid_i'>i</span>] <span class='op'>=</span> <span class='id identifier rubyid_column'>column</span>[<span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span>]
          <span class='kw'>else</span>
            <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_back'>keep_back</span>
            <span class='ivar'>@need_robust_parsing</span> <span class='op'>=</span> <span class='kw'>true</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_parse_quotable_robust'><a href="#parse_quotable_robust-instance_method" title="CSV::Parser#parse_quotable_robust (method)">parse_quotable_robust</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_i'>i</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
    <span class='ivar'>@last_line</span> <span class='op'>=</span> <span class='id identifier rubyid_original_line'>original_line</span>
    <span class='id identifier rubyid_emit_row'><a href="#emit_row-instance_method" title="CSV::Parser#emit_row (method)">emit_row</a></span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>end</span>
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_quotable_robust-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_quotable_robust</strong>(&amp;block)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L878-L938'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='878' data-end='938'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 878</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_quotable_robust'>parse_quotable_robust</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_skip_needless_lines'><a href="#skip_needless_lines-instance_method" title="CSV::Parser#skip_needless_lines (method)">skip_needless_lines</a></span>
  <span class='id identifier rubyid_start_row'><a href="#start_row-instance_method" title="CSV::Parser#start_row (method)">start_row</a></span>
  <span class='kw'>while</span> <span class='kw'>true</span>
    <span class='ivar'>@quoted_column_value</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@unquoted_column_value</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@strip_value</span>) <span class='kw'>if</span> <span class='ivar'>@strip_value</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_column_value'><a href="#parse_column_value-instance_method" title="CSV::Parser#parse_column_value (method)">parse_column_value</a></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@strip_value</span>) <span class='kw'>if</span> <span class='ivar'>@strip_value</span>
      <span class='kw'>if</span> <span class='ivar'>@field_size_limit</span> <span class='kw'>and</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='ivar'>@field_size_limit</span>
        <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Field size exceeded</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_parse_column_end'><a href="#parse_column_end-instance_method" title="CSV::Parser#parse_column_end (method)">parse_column_end</a></span>
      <span class='id identifier rubyid_row'>row</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_parse_row_end'><a href="#parse_row_end-instance_method" title="CSV::Parser#parse_row_end (method)">parse_row_end</a></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>and</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_emit_row'><a href="#emit_row-instance_method" title="CSV::Parser#emit_row (method)">emit_row</a></span>([]<span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>) <span class='kw'>unless</span> <span class='ivar'>@skip_blanks</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_row'>row</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_value'>value</span>
        <span class='id identifier rubyid_emit_row'><a href="#emit_row-instance_method" title="CSV::Parser#emit_row (method)">emit_row</a></span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
        <span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> []
      <span class='kw'>end</span>
      <span class='id identifier rubyid_skip_needless_lines'><a href="#skip_needless_lines-instance_method" title="CSV::Parser#skip_needless_lines (method)">skip_needless_lines</a></span>
      <span class='id identifier rubyid_start_row'><a href="#start_row-instance_method" title="CSV::Parser#start_row (method)">start_row</a></span>
    <span class='kw'>elsif</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_eos?'>eos?</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>and</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_row'>row</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_emit_row'><a href="#emit_row-instance_method" title="CSV::Parser#emit_row (method)">emit_row</a></span>(<span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
      <span class='kw'>break</span>
    <span class='kw'>else</span>
      <span class='kw'>if</span> <span class='ivar'>@quoted_column_value</span>
        <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Any value after quoted field isn&#39;t allowed</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
      <span class='kw'>elsif</span> <span class='ivar'>@unquoted_column_value</span> <span class='kw'>and</span>
            (<span class='id identifier rubyid_new_line'>new_line</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='ivar'>@cr_or_lf</span>))
        <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unquoted fields do not allow new line </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_line'>new_line</span>.<span class='id identifier rubyid_inspect'><a href="../CSV.html#inspect-instance_method" title="CSV#inspect (method)">inspect</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
      <span class='kw'>elsif</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_rest'>rest</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='ivar'>@quote_character</span>)
        <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Illegal quoting</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
      <span class='kw'>elsif</span> (<span class='id identifier rubyid_new_line'>new_line</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='ivar'>@cr_or_lf</span>))
        <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>New line must be &lt;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@row_separator</span>.<span class='id identifier rubyid_inspect'><a href="../CSV.html#inspect-instance_method" title="CSV#inspect (method)">inspect</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt; </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>not &lt;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_line'>new_line</span>.<span class='id identifier rubyid_inspect'><a href="../CSV.html#inspect-instance_method" title="CSV#inspect (method)">inspect</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TODO: Meaningful message</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                                    <span class='ivar'>@lineno</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_quoted_column_value-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_quoted_column_value</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L998-L1040'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='998' data-end='1040'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 998</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_quoted_column_value'>parse_quoted_column_value</span>
  <span class='id identifier rubyid_quotes'>quotes</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@quotes</span>)
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_quotes'>quotes</span>

  <span class='ivar'>@quoted_column_value</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>=</span> <span class='id identifier rubyid_quotes'>quotes</span>.<span class='id identifier rubyid_size'>size</span>
  <span class='kw'>if</span> (<span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>%</span> <span class='int'>2</span>).<span class='id identifier rubyid_zero?'>zero?</span>
    <span class='id identifier rubyid_quotes'>quotes</span>[<span class='int'>0</span><span class='comma'>,</span> (<span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>-</span> <span class='int'>2</span>) <span class='op'>/</span> <span class='int'>2</span>]
  <span class='kw'>else</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_quotes'>quotes</span>[<span class='int'>0</span><span class='comma'>,</span> (<span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>-</span> <span class='int'>1</span>) <span class='op'>/</span> <span class='int'>2</span>]
    <span class='kw'>while</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_quoted_value'>quoted_value</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@quoted_value</span>)
      <span class='id identifier rubyid_value'>value</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_quoted_value'>quoted_value</span> <span class='kw'>if</span> <span class='id identifier rubyid_quoted_value'>quoted_value</span>
      <span class='kw'>if</span> <span class='ivar'>@backslash_quote</span>
        <span class='kw'>if</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='ivar'>@escaped_backslash</span>)
          <span class='kw'>if</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='ivar'>@escaped_quote</span>)
            <span class='id identifier rubyid_value'>value</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@quote_character</span>
          <span class='kw'>else</span>
            <span class='id identifier rubyid_value'>value</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@backslash_character</span>
          <span class='kw'>end</span>
          <span class='kw'>next</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_quotes'>quotes</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@quotes</span>)
      <span class='kw'>unless</span> <span class='id identifier rubyid_quotes'>quotes</span>
        <span class='id identifier rubyid_ignore_broken_line'><a href="#ignore_broken_line-instance_method" title="CSV::Parser#ignore_broken_line (method)">ignore_broken_line</a></span>
        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unclosed quoted field</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="MalformedCSVError.html" title="CSV::MalformedCSVError (class)">MalformedCSVError</a></span>.<span class='id identifier rubyid_new'><a href="MalformedCSVError.html#new-class_method" title="CSV::MalformedCSVError.new (method)">new</a></span>(<span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='ivar'>@lineno</span>)
      <span class='kw'>end</span>
      <span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>=</span> <span class='id identifier rubyid_quotes'>quotes</span>.<span class='id identifier rubyid_size'>size</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='kw'>break</span>
      <span class='kw'>elsif</span> (<span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>%</span> <span class='int'>2</span>) <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_quotes'>quotes</span>[<span class='int'>0</span><span class='comma'>,</span> (<span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>-</span> <span class='int'>1</span>) <span class='op'>/</span> <span class='int'>2</span>]
        <span class='kw'>break</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_quotes'>quotes</span>[<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_n_quotes'>n_quotes</span> <span class='op'>/</span> <span class='int'>2</span>]
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_row_end-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_row_end</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L1056-L1067'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1056' data-end='1067'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 1056</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_row_end'>parse_row_end</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='ivar'>@row_end</span>)
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@row_ends</span>
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
  <span class='kw'>if</span> <span class='ivar'>@row_ends</span>.<span class='id identifier rubyid_all?'>all?</span> {<span class='op'>|</span><span class='id identifier rubyid_row_end'>row_end</span><span class='op'>|</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='id identifier rubyid_row_end'>row_end</span>)}
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
    <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_back'>keep_back</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parse_unquoted_column_value-instance_method">
  <h3 class='signature priv'>
    #<strong>parse_unquoted_column_value</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L970-L996'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='970' data-end='996'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 970</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_unquoted_column_value'>parse_unquoted_column_value</span>
  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@unquoted_value</span>)
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_value'>value</span>

  <span class='ivar'>@unquoted_column_value</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>if</span> <span class='ivar'>@first_column_separators</span>
    <span class='kw'>while</span> <span class='kw'>true</span>
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
      <span class='id identifier rubyid_is_column_end'>is_column_end</span> <span class='op'>=</span> <span class='ivar'>@column_ends</span>.<span class='id identifier rubyid_all?'>all?</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_column_end'>column_end</span><span class='op'>|</span>
        <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan'>scan</span>(<span class='id identifier rubyid_column_end'>column_end</span>)
      <span class='kw'>end</span>
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_back'>keep_back</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_is_column_end'>is_column_end</span>
      <span class='id identifier rubyid_sub_separator'>sub_separator</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@first_column_separators</span>)
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_sub_separator'>sub_separator</span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_sub_separator'>sub_separator</span>
      <span class='id identifier rubyid_sub_value'>sub_value</span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@unquoted_value</span>)
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_sub_value'>sub_value</span>.<span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_sub_value'>sub_value</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='ivar'>@backslash_quote_character</span><span class='comma'>,</span> <span class='ivar'>@quote_character</span>) <span class='kw'>if</span> <span class='ivar'>@backslash_quote</span>
  <span class='kw'>if</span> <span class='ivar'>@rstrip_value</span>
    <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_gsub!'>gsub!</span>(<span class='ivar'>@rstrip_value</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A set of tasks to prepare the file in order to parse it</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L356-L368'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='356' data-end='368'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 356</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare'>prepare</span>
  <span class='id identifier rubyid_prepare_variable'><a href="#prepare_variable-instance_method" title="CSV::Parser#prepare_variable (method)">prepare_variable</a></span>
  <span class='id identifier rubyid_prepare_quote_character'><a href="#prepare_quote_character-instance_method" title="CSV::Parser#prepare_quote_character (method)">prepare_quote_character</a></span>
  <span class='id identifier rubyid_prepare_backslash'><a href="#prepare_backslash-instance_method" title="CSV::Parser#prepare_backslash (method)">prepare_backslash</a></span>
  <span class='id identifier rubyid_prepare_skip_lines'><a href="#prepare_skip_lines-instance_method" title="CSV::Parser#prepare_skip_lines (method)">prepare_skip_lines</a></span>
  <span class='id identifier rubyid_prepare_strip'><a href="#prepare_strip-instance_method" title="CSV::Parser#prepare_strip (method)">prepare_strip</a></span>
  <span class='id identifier rubyid_prepare_separators'><a href="#prepare_separators-instance_method" title="CSV::Parser#prepare_separators (method)">prepare_separators</a></span>
  <span class='id identifier rubyid_prepare_quoted'><a href="#prepare_quoted-instance_method" title="CSV::Parser#prepare_quoted (method)">prepare_quoted</a></span>
  <span class='id identifier rubyid_prepare_unquoted'><a href="#prepare_unquoted-instance_method" title="CSV::Parser#prepare_unquoted (method)">prepare_unquoted</a></span>
  <span class='id identifier rubyid_prepare_line'><a href="#prepare_line-instance_method" title="CSV::Parser#prepare_line (method)">prepare_line</a></span>
  <span class='id identifier rubyid_prepare_header'><a href="#prepare_header-instance_method" title="CSV::Parser#prepare_header (method)">prepare_header</a></span>
  <span class='id identifier rubyid_prepare_parser'><a href="#prepare_parser-instance_method" title="CSV::Parser#prepare_parser (method)">prepare_parser</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_backslash-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_backslash</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L413-L426'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='413' data-end='426'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 413</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_backslash'>prepare_backslash</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='ivar'>@backslash_quote</span>

  <span class='ivar'>@backslash_character</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)

  <span class='ivar'>@escaped_backslash_character</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='ivar'>@backslash_character</span>)
  <span class='ivar'>@escaped_backslash</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_backslash_character</span>)
  <span class='kw'>if</span> <span class='ivar'>@quote_character</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='ivar'>@backslash_quote_character</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='ivar'>@backslash_quote_character</span> <span class='op'>=</span>
      <span class='ivar'>@backslash_character</span> <span class='op'>+</span> <span class='ivar'>@escaped_quote_character</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_header-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_header</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L651-L674'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='651' data-end='674'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 651</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_header'>prepare_header</span>
  <span class='ivar'>@return_headers</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_return_headers'>return_headers</span>]

  <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span>]
  <span class='kw'>case</span> <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span>
  <span class='kw'>when</span> <span class='const'><a href="../Array.html" title="Array (class)">Array</a></span>
    <span class='ivar'>@raw_headers</span> <span class='op'>=</span> <span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span>
    <span class='ivar'>@use_headers</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
    <span class='ivar'>@raw_headers</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_headers'><a href="#parse_headers-instance_method" title="CSV::Parser#parse_headers (method)">parse_headers</a></span>(<span class='id identifier rubyid_headers'><a href="#headers-instance_method" title="CSV::Parser#headers (method)">headers</a></span>)
    <span class='ivar'>@use_headers</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>when</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>false</span>
    <span class='ivar'>@raw_headers</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@use_headers</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>else</span>
    <span class='ivar'>@raw_headers</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@use_headers</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='ivar'>@raw_headers</span>
    <span class='ivar'>@headers</span> <span class='op'>=</span> <span class='id identifier rubyid_adjust_headers'><a href="#adjust_headers-instance_method" title="CSV::Parser#adjust_headers (method)">adjust_headers</a></span>(<span class='ivar'>@raw_headers</span>)
  <span class='kw'>else</span>
    <span class='ivar'>@headers</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_line-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_line</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L637-L641'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='637' data-end='641'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 637</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_line'>prepare_line</span>
  <span class='ivar'>@lineno</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@last_line</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@scanner</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_parser-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_parser</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L689-L691'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='689' data-end='691'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 689</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_parser'>prepare_parser</span>
  <span class='ivar'>@may_quoted</span> <span class='op'>=</span> <span class='id identifier rubyid_may_quoted?'><a href="#may_quoted%3F-instance_method" title="CSV::Parser#may_quoted? (method)">may_quoted?</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_quote_character-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_quote_character</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L396-L411'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='396' data-end='411'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 396</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_quote_character'>prepare_quote_character</span>
  <span class='ivar'>@quote_character</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_quote_character'><a href="#quote_character-instance_method" title="CSV::Parser#quote_character (method)">quote_character</a></span>]
  <span class='kw'>if</span> <span class='ivar'>@quote_character</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='ivar'>@escaped_quote_character</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@escaped_quote</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='ivar'>@quote_character</span> <span class='op'>=</span> <span class='ivar'>@quote_character</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
    <span class='kw'>if</span> <span class='ivar'>@quote_character</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:quote_char has to be nil or a single character String</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>
    <span class='kw'>end</span>
    <span class='ivar'>@double_quote_character</span> <span class='op'>=</span> <span class='ivar'>@quote_character</span> <span class='op'>*</span> <span class='int'>2</span>
    <span class='ivar'>@escaped_quote_character</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='ivar'>@quote_character</span>)
    <span class='ivar'>@escaped_quote</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_quote_character</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_quoted-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_quoted</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L533-L558'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='533' data-end='558'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 533</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_quoted'>prepare_quoted</span>
  <span class='kw'>if</span> <span class='ivar'>@quote_character</span>
    <span class='ivar'>@quotes</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_quote_character</span> <span class='op'>+</span>
                         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
    <span class='id identifier rubyid_no_quoted_values'>no_quoted_values</span> <span class='op'>=</span> <span class='ivar'>@escaped_quote_character</span>.<span class='id identifier rubyid_dup'>dup</span>
    <span class='kw'>if</span> <span class='ivar'>@backslash_quote</span>
      <span class='id identifier rubyid_no_quoted_values'>no_quoted_values</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@escaped_backslash_character</span>
    <span class='kw'>end</span>
    <span class='ivar'>@quoted_value</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[^</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>) <span class='op'>+</span>
                               <span class='id identifier rubyid_no_quoted_values'>no_quoted_values</span> <span class='op'>+</span>
                               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>]+</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='ivar'>@escaped_strip</span>
    <span class='ivar'>@split_column_separator</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_strip</span> <span class='op'>+</span>
                                         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>) <span class='op'>+</span>
                                         <span class='ivar'>@escaped_column_separator</span> <span class='op'>+</span>
                                         <span class='ivar'>@escaped_strip</span> <span class='op'>+</span>
                                         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='ivar'>@column_separator</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
      <span class='ivar'>@split_column_separator</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_column_separator</span>)
    <span class='kw'>else</span>
      <span class='ivar'>@split_column_separator</span> <span class='op'>=</span> <span class='ivar'>@column_separator</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_separators-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_separators</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L487-L531'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='487' data-end='531'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 487</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_separators'>prepare_separators</span>
  <span class='id identifier rubyid_column_separator'><a href="#column_separator-instance_method" title="CSV::Parser#column_separator (method)">column_separator</a></span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_column_separator'><a href="#column_separator-instance_method" title="CSV::Parser#column_separator (method)">column_separator</a></span>]
  <span class='ivar'>@column_separator</span> <span class='op'>=</span> <span class='id identifier rubyid_column_separator'><a href="#column_separator-instance_method" title="CSV::Parser#column_separator (method)">column_separator</a></span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
  <span class='kw'>if</span> <span class='ivar'>@column_separator</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='int'>1</span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:col_sep must be 1 or more characters: </span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>+=</span> <span class='id identifier rubyid_column_separator'><a href="#column_separator-instance_method" title="CSV::Parser#column_separator (method)">column_separator</a></span>.<span class='id identifier rubyid_inspect'><a href="../CSV.html#inspect-instance_method" title="CSV#inspect (method)">inspect</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>
  <span class='kw'>end</span>
  <span class='ivar'>@row_separator</span> <span class='op'>=</span>
    <span class='id identifier rubyid_resolve_row_separator'><a href="#resolve_row_separator-instance_method" title="CSV::Parser#resolve_row_separator (method)">resolve_row_separator</a></span>(<span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_row_separator'><a href="#row_separator-instance_method" title="CSV::Parser#row_separator (method)">row_separator</a></span>]).<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)

  <span class='ivar'>@escaped_column_separator</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='ivar'>@column_separator</span>)
  <span class='ivar'>@escaped_first_column_separator</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='ivar'>@column_separator</span>[<span class='int'>0</span>])
  <span class='kw'>if</span> <span class='ivar'>@column_separator</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='ivar'>@column_end</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_column_separator</span>)
    <span class='ivar'>@column_ends</span> <span class='op'>=</span> <span class='ivar'>@column_separator</span>.<span class='id identifier rubyid_each_char'>each_char</span>.<span class='id identifier rubyid_collect'>collect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_char'>char</span><span class='op'>|</span>
      <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='id identifier rubyid_char'>char</span>))
    <span class='kw'>end</span>
    <span class='ivar'>@first_column_separators</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_first_column_separator</span> <span class='op'>+</span>
                                          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='cvar'>@@string_scanner_scan_accept_string</span>
      <span class='ivar'>@column_end</span> <span class='op'>=</span> <span class='ivar'>@column_separator</span>
    <span class='kw'>else</span>
      <span class='ivar'>@column_end</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_column_separator</span>)
    <span class='kw'>end</span>
    <span class='ivar'>@column_ends</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@first_column_separators</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_escaped_row_separator'>escaped_row_separator</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='ivar'>@row_separator</span>)
  <span class='ivar'>@row_end</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='id identifier rubyid_escaped_row_separator'>escaped_row_separator</span>)
  <span class='kw'>if</span> <span class='ivar'>@row_separator</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='ivar'>@row_ends</span> <span class='op'>=</span> <span class='ivar'>@row_separator</span>.<span class='id identifier rubyid_each_char'>each_char</span>.<span class='id identifier rubyid_collect'>collect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_char'>char</span><span class='op'>|</span>
      <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='id identifier rubyid_char'>char</span>))
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='ivar'>@row_ends</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='ivar'>@cr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
  <span class='ivar'>@lf</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
  <span class='ivar'>@cr_or_lf</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[\r\n]</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
  <span class='ivar'>@not_line_end</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[^\r\n]+</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_skip_lines-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_skip_lines</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L428-L443'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='428' data-end='443'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 428</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_skip_lines'>prepare_skip_lines</span>
  <span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span>]
  <span class='kw'>case</span> <span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
    <span class='ivar'>@skip_lines</span> <span class='op'>=</span> <span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
  <span class='kw'>when</span> <span class='const'>Regexp</span><span class='comma'>,</span> <span class='kw'>nil</span>
    <span class='ivar'>@skip_lines</span> <span class='op'>=</span> <span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span>
  <span class='kw'>else</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_match'>match</span>)
      <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:skip_lines has to respond to \#match: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span>.<span class='id identifier rubyid_inspect'><a href="../CSV.html#inspect-instance_method" title="CSV#inspect (method)">inspect</a></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>
    <span class='kw'>end</span>
    <span class='ivar'>@skip_lines</span> <span class='op'>=</span> <span class='id identifier rubyid_skip_lines'><a href="#skip_lines-instance_method" title="CSV::Parser#skip_lines (method)">skip_lines</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_strip-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_strip</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L445-L477'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='445' data-end='477'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 445</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_strip'>prepare_strip</span>
  <span class='ivar'>@strip</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_strip'>strip</span>]
  <span class='ivar'>@escaped_strip</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@strip_value</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@rstrip_value</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='ivar'>@strip</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="../String.html" title="String (class)">String</a></span>)
    <span class='kw'>case</span> <span class='ivar'>@strip</span>.<span class='id identifier rubyid_length'>length</span>
    <span class='kw'>when</span> <span class='int'>0</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:strip must not be an empty String</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='int'>1</span>
      <span class='comment'># ok
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:strip doesn&#39;t support 2 or more characters yet</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='ivar'>@strip</span> <span class='op'>=</span> <span class='ivar'>@strip</span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
    <span class='ivar'>@escaped_strip</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_escape'>escape</span>(<span class='ivar'>@strip</span>)
    <span class='kw'>if</span> <span class='ivar'>@quote_character</span>
      <span class='ivar'>@strip_value</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_strip</span> <span class='op'>+</span>
                                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
      <span class='ivar'>@rstrip_value</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='ivar'>@escaped_strip</span> <span class='op'>+</span>
                                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+\\z</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
    <span class='kw'>end</span>
    <span class='ivar'>@need_robust_parsing</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>elsif</span> <span class='ivar'>@strip</span>
    <span class='id identifier rubyid_strip_values'>strip_values</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> \t\f\v</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@escaped_strip</span> <span class='op'>=</span> <span class='id identifier rubyid_strip_values'>strip_values</span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
    <span class='kw'>if</span> <span class='ivar'>@quote_character</span>
      <span class='ivar'>@strip_value</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strip_values'>strip_values</span><span class='embexpr_end'>}</span><span class='tstring_content'>]+</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
      <span class='ivar'>@rstrip_value</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strip_values'>strip_values</span><span class='embexpr_end'>}</span><span class='tstring_content'>]+\\z</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
    <span class='kw'>end</span>
    <span class='ivar'>@need_robust_parsing</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_unquoted-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_unquoted</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L560-L571'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='560' data-end='571'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 560</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_unquoted'>prepare_unquoted</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@quote_character</span>.<span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_no_unquoted_values'>no_unquoted_values</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
  <span class='id identifier rubyid_no_unquoted_values'>no_unquoted_values</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@escaped_first_column_separator</span>
  <span class='kw'>unless</span> <span class='ivar'>@liberal_parsing</span>
    <span class='id identifier rubyid_no_unquoted_values'>no_unquoted_values</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@escaped_quote_character</span>
  <span class='kw'>end</span>
  <span class='ivar'>@unquoted_value</span> <span class='op'>=</span> <span class='const'>Regexp</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="CSV::Parser.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[^</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>) <span class='op'>+</span>
                               <span class='id identifier rubyid_no_unquoted_values'>no_unquoted_values</span> <span class='op'>+</span>
                               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>]+</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare_variable-instance_method">
  <h3 class='signature priv'>
    #<strong>prepare_variable</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L370-L394'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='370' data-end='394'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 370</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_variable'>prepare_variable</span>
  <span class='ivar'>@need_robust_parsing</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@encoding</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_encoding'><a href="../CSV.html#encoding-instance_method" title="CSV#encoding (method)">encoding</a></span>]
  <span class='id identifier rubyid_liberal_parsing'>liberal_parsing</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_liberal_parsing'>liberal_parsing</span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_liberal_parsing'>liberal_parsing</span>
    <span class='ivar'>@liberal_parsing</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_liberal_parsing'>liberal_parsing</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Hash</span>)
      <span class='ivar'>@double_quote_outside_quote</span> <span class='op'>=</span>
        <span class='id identifier rubyid_liberal_parsing'>liberal_parsing</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_double_quote_outside_quote'>double_quote_outside_quote</span>]
      <span class='ivar'>@backslash_quote</span> <span class='op'>=</span> <span class='id identifier rubyid_liberal_parsing'>liberal_parsing</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_backslash_quote'>backslash_quote</span>]
    <span class='kw'>else</span>
      <span class='ivar'>@double_quote_outside_quote</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='ivar'>@backslash_quote</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
    <span class='ivar'>@need_robust_parsing</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='ivar'>@liberal_parsing</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@backslash_quote</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
  <span class='ivar'>@unconverted_fields</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_unconverted_fields'>unconverted_fields</span>]
  <span class='ivar'>@field_size_limit</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_field_size_limit'><a href="#field_size_limit-instance_method" title="CSV::Parser#field_size_limit (method)">field_size_limit</a></span>]
  <span class='ivar'>@skip_blanks</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_skip_blanks'>skip_blanks</span>]
  <span class='ivar'>@fields_converter</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_fields_converter'>fields_converter</span>]
  <span class='ivar'>@header_fields_converter</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_header_fields_converter'><a href="../CSV.html#header_fields_converter-instance_method" title="CSV#header_fields_converter (method)">header_fields_converter</a></span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="quote_character-instance_method">
  <h3 class='signature '>
    #<strong>quote_character</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L274-L276'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='274' data-end='276'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 274</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_quote_character'>quote_character</span>
  <span class='ivar'>@quote_character</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="resolve_row_separator-instance_method">
  <h3 class='signature priv'>
    #<strong>resolve_row_separator</strong>(separator)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L573-L611'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='573' data-end='611'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 573</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_resolve_row_separator'>resolve_row_separator</span>(<span class='id identifier rubyid_separator'>separator</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_separator'>separator</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_auto'>auto</span>
    <span class='id identifier rubyid_cr'>cr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
    <span class='id identifier rubyid_lf'>lf</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
    <span class='kw'>if</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>StringIO</span>)
      <span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_pos'>pos</span>
      <span class='id identifier rubyid_separator'>separator</span> <span class='op'>=</span> <span class='id identifier rubyid_detect_row_separator'><a href="#detect_row_separator-instance_method" title="CSV::Parser#detect_row_separator (method)">detect_row_separator</a></span>(<span class='ivar'>@input</span>.<span class='id identifier rubyid_read'><a href="../CSV.html#read-class_method" title="CSV.read (method)">read</a></span><span class='comma'>,</span> <span class='id identifier rubyid_cr'>cr</span><span class='comma'>,</span> <span class='id identifier rubyid_lf'>lf</span>)
      <span class='ivar'>@input</span>.<span class='id identifier rubyid_seek'>seek</span>(<span class='id identifier rubyid_pos'>pos</span>)
    <span class='kw'>elsif</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_gets'><a href="../CSV.html#gets-instance_method" title="CSV#gets (method)">gets</a></span>)
      <span class='kw'>if</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>File</span>)
        <span class='id identifier rubyid_chunk_size'>chunk_size</span> <span class='op'>=</span> <span class='int'>32</span> <span class='op'>*</span> <span class='int'>1024</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_chunk_size'>chunk_size</span> <span class='op'>=</span> <span class='int'>1024</span>
      <span class='kw'>end</span>
      <span class='kw'>begin</span>
        <span class='kw'>while</span> <span class='id identifier rubyid_separator'>separator</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_auto'>auto</span>
          <span class='comment'>#
</span>          <span class='comment'># if we run out of data, it&#39;s probably a single line
</span>          <span class='comment'># (ensure will set default value)
</span>          <span class='comment'>#
</span>          <span class='kw'>break</span> <span class='kw'>unless</span> <span class='id identifier rubyid_sample'>sample</span> <span class='op'>=</span> <span class='ivar'>@input</span>.<span class='id identifier rubyid_gets'><a href="../CSV.html#gets-instance_method" title="CSV#gets (method)">gets</a></span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_chunk_size'>chunk_size</span>)

          <span class='comment'># extend sample if we&#39;re unsure of the line ending
</span>          <span class='kw'>if</span> <span class='id identifier rubyid_sample'>sample</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='id identifier rubyid_cr'>cr</span>)
            <span class='id identifier rubyid_sample'>sample</span> <span class='op'>&lt;&lt;</span> (<span class='ivar'>@input</span>.<span class='id identifier rubyid_gets'><a href="../CSV.html#gets-instance_method" title="CSV#gets (method)">gets</a></span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>1</span>) <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>)
          <span class='kw'>end</span>

          <span class='ivar'>@samples</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_sample'>sample</span>

          <span class='id identifier rubyid_separator'>separator</span> <span class='op'>=</span> <span class='id identifier rubyid_detect_row_separator'><a href="#detect_row_separator-instance_method" title="CSV::Parser#detect_row_separator (method)">detect_row_separator</a></span>(<span class='id identifier rubyid_sample'>sample</span><span class='comma'>,</span> <span class='id identifier rubyid_cr'>cr</span><span class='comma'>,</span> <span class='id identifier rubyid_lf'>lf</span>)
        <span class='kw'>end</span>
      <span class='kw'>rescue</span> <span class='const'>IOError</span>
        <span class='comment'># do nothing:  ensure will set default
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_separator'>separator</span> <span class='op'>=</span> <span class='gvar'>$INPUT_RECORD_SEPARATOR</span> <span class='kw'>if</span> <span class='id identifier rubyid_separator'>separator</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_auto'>auto</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_separator'>separator</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="row_separator-instance_method">
  <h3 class='signature '>
    #<strong>row_separator</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L270-L272'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='270' data-end='272'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 270</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_row_separator'>row_separator</span>
  <span class='ivar'>@row_separator</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="skip_line?-instance_method">
  <h3 class='signature priv'>
    #<strong>skip_line?</strong>(line)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L787-L797'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='787' data-end='797'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 787</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_skip_line?'>skip_line?</span>(<span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>)
  <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span> <span class='op'>=</span> <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_delete_suffix'>delete_suffix</span>(<span class='ivar'>@row_separator</span>)
  <span class='kw'>case</span> <span class='ivar'>@skip_lines</span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
    <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='ivar'>@skip_lines</span>)
  <span class='kw'>when</span> <span class='const'>Regexp</span>
    <span class='ivar'>@skip_lines</span>.<span class='id identifier rubyid_match?'>match?</span>(<span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>)
  <span class='kw'>else</span>
    <span class='ivar'>@skip_lines</span>.<span class='id identifier rubyid_match'>match</span>(<span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="skip_lines-instance_method">
  <h3 class='signature '>
    #<strong>skip_lines</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L282-L284'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='282' data-end='284'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 282</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_skip_lines'>skip_lines</span>
  <span class='ivar'>@skip_lines</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="skip_needless_lines-instance_method">
  <h3 class='signature priv'>
    #<strong>skip_needless_lines</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L770-L785'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='770' data-end='785'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 770</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_skip_needless_lines'>skip_needless_lines</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='ivar'>@skip_lines</span>

  <span class='kw'>until</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_eos?'>eos?</span>
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
    <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span> <span class='op'>=</span> <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_scan_all'>scan_all</span>(<span class='ivar'>@not_line_end</span>) <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='ivar'>@encoding</span>)
    <span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@row_separator</span> <span class='kw'>if</span> <span class='id identifier rubyid_parse_row_end'><a href="#parse_row_end-instance_method" title="CSV::Parser#parse_row_end (method)">parse_row_end</a></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_skip_line?'><a href="#skip_line%3F-instance_method" title="CSV::Parser#skip_line? (method)">skip_line?</a></span>(<span class='id identifier rubyid_line'><a href="#line-instance_method" title="CSV::Parser#line (method)">line</a></span>)
      <span class='ivar'>@lineno</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
    <span class='kw'>else</span>
      <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_back'>keep_back</span>
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_row-instance_method">
  <h3 class='signature priv'>
    #<strong>start_row</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L1096-L1103'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1096' data-end='1103'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 1096</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_start_row'>start_row</span>
  <span class='kw'>if</span> <span class='ivar'>@last_line</span>
    <span class='ivar'>@last_line</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_drop'>keep_drop</span>
  <span class='kw'>end</span>
  <span class='ivar'>@scanner</span>.<span class='id identifier rubyid_keep_start'>keep_start</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="strip_value-instance_method">
  <h3 class='signature priv'>
    #<strong>strip_value</strong>(value)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/lib/csv/parser.rb#L1069-L1088'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1069' data-end='1088'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/csv/parser.rb', line 1069</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_strip_value'>strip_value</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>unless</span> <span class='ivar'>@strip</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_nil?'>nil?</span>

  <span class='kw'>case</span> <span class='ivar'>@strip</span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
    <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_size'>size</span>
    <span class='kw'>while</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_start_with?'>start_with?</span>(<span class='ivar'>@strip</span>)
      <span class='id identifier rubyid_size'>size</span> <span class='op'>-=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span>]
    <span class='kw'>end</span>
    <span class='kw'>while</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_end_with?'>end_with?</span>(<span class='ivar'>@strip</span>)
      <span class='id identifier rubyid_size'>size</span> <span class='op'>-=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>[<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span>]
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_strip!'>strip!</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>