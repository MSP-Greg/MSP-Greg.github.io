<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Parsing &mdash; csv  Ruby-3.0.6 pp216</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "parsing",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-3.0.6</a> &raquo; 
      <a href='.'>csv</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Parsing&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>

<h2 id="label-Recipes+for+Parsing+CSV">Recipes for Parsing CSV</h2>

<p>For other recipes, see <a href="file.recipes_rdoc.html" title="Recipes for CSV">Recipes for CSV</a>.</p>

<p>All code snippets on this page assume that the following has been executed:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csv</span><span class='tstring_end'>&#39;</span></span></code></pre>

<h3 id="label-Contents">Contents</h3>
<ul><li>
<p><a href="#label-Source+Formats">Source Formats</a></p>
<ul><li>
<p><a href="#label-Parsing+from+a+String">Parsing from a String</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Parse+from+String+with+Headers">Recipe: Parse from String with Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Parse+from+String+Without+Headers">Recipe: Parse from String Without Headers</a></p>
</li></ul>
</li><li>
<p><a href="#label-Parsing+from+a+File">Parsing from a File</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Parse+from+File+with+Headers">Recipe: Parse from File with Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Parse+from+File+Without+Headers">Recipe: Parse from File Without Headers</a></p>
</li></ul>
</li><li>
<p><a href="#label-Parsing+from+an+IO+Stream">Parsing from an IO Stream</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Parse+from+IO+Stream+with+Headers">Recipe: Parse from IO Stream with Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Parse+from+IO+Stream+Without+Headers">Recipe: Parse from IO Stream Without Headers</a></p>
</li></ul>
</li></ul>
</li><li>
<p><a href="#label-RFC+4180+Compliance">RFC 4180 Compliance</a></p>
<ul><li>
<p><a href="#label-Row+Separator">Row Separator</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Handle+Compliant+Row+Separator">Recipe: Handle Compliant Row Separator</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Handle+Non-Compliant+Row+Separator">Recipe: Handle Non-Compliant Row Separator</a></p>
</li></ul>
</li><li>
<p><a href="#label-Column+Separator">Column Separator</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Handle+Compliant+Column+Separator">Recipe: Handle Compliant Column Separator</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Handle+Non-Compliant+Column+Separator">Recipe: Handle Non-Compliant Column Separator</a></p>
</li></ul>
</li><li>
<p><a href="#label-Quote+Character">Quote Character</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Handle+Compliant+Quote+Character">Recipe: Handle Compliant Quote Character</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Handle+Non-Compliant+Quote+Character">Recipe: Handle Non-Compliant Quote Character</a></p>
</li></ul>
</li><li>
<p><a href="#label-Recipe-3A+Allow+Liberal+Parsing">Recipe: Allow Liberal Parsing</a></p>
</li></ul>
</li><li>
<p><a href="#label-Special+Handling">Special Handling</a></p>
<ul><li>
<p><a href="#label-Special+Line+Handling">Special Line Handling</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Ignore+Blank+Lines">Recipe: Ignore Blank Lines</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Ignore+Selected+Lines">Recipe: Ignore Selected Lines</a></p>
</li></ul>
</li><li>
<p><a href="#label-Special+Field+Handling">Special Field Handling</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Strip+Fields">Recipe: Strip Fields</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Handle+Null+Fields">Recipe: Handle Null Fields</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Handle+Empty+Fields">Recipe: Handle Empty Fields</a></p>
</li></ul>
</li></ul>
</li><li>
<p><a href="#label-Converting+Fields">Converting Fields</a></p>
<ul><li>
<p><a href="#label-Converting+Fields+to+Objects">Converting Fields to Objects</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Convert+Fields+to+Integers">Recipe: Convert Fields to Integers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Convert+Fields+to+Floats">Recipe: Convert Fields to Floats</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Convert+Fields+to+Numerics">Recipe: Convert Fields to Numerics</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Convert+Fields+to+Dates">Recipe: Convert Fields to Dates</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Convert+Fields+to+DateTimes">Recipe: Convert Fields to DateTimes</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Convert+Assorted+Fields+to+Objects">Recipe: Convert Assorted Fields to Objects</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Convert+Fields+to+Other+Objects">Recipe: Convert Fields to Other Objects</a></p>
</li></ul>
</li><li>
<p><a href="#label-Recipe-3A+Filter+Field+Strings">Recipe: Filter Field Strings</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Register+Field+Converters">Recipe: Register Field Converters</a></p>
</li><li>
<p><a href="#label-Using+Multiple+Field+Converters">Using Multiple Field Converters</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Specify+Multiple+Field+Converters+in+Option+-3Aconverters">Recipe: Specify Multiple Field Converters in Option :converters</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Specify+Multiple+Field+Converters+in+a+Custom+Converter+List">Recipe: Specify Multiple Field Converters in a Custom Converter List</a></p>
</li></ul>
</li></ul>
</li><li>
<p><a href="#label-Converting+Headers">Converting Headers</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Convert+Headers+to+Lowercase">Recipe: Convert Headers to Lowercase</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Convert+Headers+to+Symbols">Recipe: Convert Headers to Symbols</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+Header+Strings">Recipe: Filter Header Strings</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Register+Header+Converters">Recipe: Register Header Converters</a></p>
</li><li>
<p><a href="#label-Using+Multiple+Header+Converters">Using Multiple Header Converters</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Specify+Multiple+Header+Converters+in+Option+-3Aheader_converters">Recipe: Specify Multiple Header Converters in Option :header_converters</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Specify+Multiple+Header+Converters+in+a+Custom+Header+Converter+List">Recipe: Specify Multiple Header Converters in a Custom Header Converter List</a></p>
</li></ul>
</li></ul>
</li><li>
<p><a href="#label-Diagnostics">Diagnostics</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Capture+Unconverted+Fields">Recipe: Capture Unconverted Fields</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Capture+Field+Info">Recipe: Capture Field Info</a></p>
</li></ul>
</li></ul>

<h3 id="label-Source+Formats">Source Formats</h3>

<p>You can parse CSV data from a String, from a File (via its path), or from an IO stream.</p>

<h4 id="label-Parsing+from+a+String">Parsing from a String</h4>

<p>You can parse CSV data from a String, with or without headers.</p>

<h5 id="label-Recipe-3A+Parse+from+String+with+Headers">Recipe: Parse from String with Headers</h5>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.parse with option <code>headers</code> to read a source String all at once (may have memory resource implications):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; #&lt;CSV::Table mode:col_or_row row_count:4&gt;</span></code></pre>

<p>Use instance method CSV#each with option <code>headers</code> to read a source String one row at a time:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_new'><a href="CSV.html#new-class_method" title="CSV.new (method)">new</a></span>(<span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span>).<span class='id identifier rubyid_each'><a href="CSV.html#each-instance_method" title="CSV#each (method)">each</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>
<span class='kw'>end</span></code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;foo&quot; &quot;Value&quot;:&quot;0&quot;&gt;
</span><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;bar&quot; &quot;Value&quot;:&quot;1&quot;&gt;
</span><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;baz&quot; &quot;Value&quot;:&quot;2&quot;&gt;</span></code></pre>

<h5 id="label-Recipe-3A+Parse+from+String+Without+Headers">Recipe: Parse from String Without Headers</h5>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.parse without option <code>headers</code> to read a source String all at once (may have memory resource implications):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_string'>string</span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;0&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<p>Use instance method CSV#each without option <code>headers</code> to read a source String one row at a time:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_new'><a href="CSV.html#new-class_method" title="CSV.new (method)">new</a></span>(<span class='id identifier rubyid_string'>string</span>).<span class='id identifier rubyid_each'><a href="CSV.html#each-instance_method" title="CSV#each (method)">each</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>
<span class='kw'>end</span></code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span>]</code></pre>

<h4 id="label-Parsing+from+a+File">Parsing from a File</h4>

<p>You can parse CSV data from a File, with or without headers.</p>

<h5 id="label-Recipe-3A+Parse+from+File+with+Headers">Recipe: Parse from File with Headers</h5>

<p>Use instance method CSV#read with option <code>headers</code> to read a file all at once:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t.csv</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>File</span>.<span class='id identifier rubyid_write'>write</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span>)
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_read'><a href="CSV.html#read-class_method" title="CSV.read (method)">read</a></span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; #&lt;CSV::Table mode:col_or_row row_count:4&gt;</span></code></pre>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.foreach with option <code>headers</code> to read one row at a time:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_foreach'><a href="CSV.html#foreach-class_method" title="CSV.foreach (method)">foreach</a></span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>
<span class='kw'>end</span></code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;foo&quot; &quot;Value&quot;:&quot;0&quot;&gt;
</span><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;bar&quot; &quot;Value&quot;:&quot;1&quot;&gt;
</span><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;baz&quot; &quot;Value&quot;:&quot;2&quot;&gt;</span></code></pre>

<h5 id="label-Recipe-3A+Parse+from+File+Without+Headers">Recipe: Parse from File Without Headers</h5>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.read without option <code>headers</code> to read a file all at once:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t.csv</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>File</span>.<span class='id identifier rubyid_write'>write</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span>)
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_read'><a href="CSV.html#read-class_method" title="CSV.read (method)">read</a></span>(<span class='id identifier rubyid_path'>path</span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;0&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.foreach without option <code>headers</code> to read one row at a time:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_foreach'><a href="CSV.html#foreach-class_method" title="CSV.foreach (method)">foreach</a></span>(<span class='id identifier rubyid_path'>path</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>
<span class='kw'>end</span></code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span>]</code></pre>

<h4 id="label-Parsing+from+an+IO+Stream">Parsing from an IO Stream</h4>

<p>You can parse CSV data from an IO stream, with or without headers.</p>

<h5 id="label-Recipe-3A+Parse+from+IO+Stream+with+Headers">Recipe: Parse from IO Stream with Headers</h5>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.parse with option <code>headers</code> to read an IO stream all at once:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t.csv</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>File</span>.<span class='id identifier rubyid_write'>write</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span>)
<span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid_path'>path</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
  <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span>)
<span class='kw'>end</span> <span class='comment'># =&gt; #&lt;CSV::Table mode:col_or_row row_count:4&gt;</span></code></pre>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.foreach with option <code>headers</code> to read one row at a time:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid_path'>path</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
  <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_foreach'><a href="CSV.html#foreach-class_method" title="CSV.foreach (method)">foreach</a></span>(<span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;foo&quot; &quot;Value&quot;:&quot;0&quot;&gt;
</span><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;bar&quot; &quot;Value&quot;:&quot;1&quot;&gt;
</span><span class='comment'>#&lt;CSV::Row &quot;Name&quot;:&quot;baz&quot; &quot;Value&quot;:&quot;2&quot;&gt;</span></code></pre>

<h5 id="label-Recipe-3A+Parse+from+IO+Stream+Without+Headers">Recipe: Parse from IO Stream Without Headers</h5>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.parse without option <code>headers</code> to read an IO stream all at once:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t.csv</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>File</span>.<span class='id identifier rubyid_write'>write</span>(<span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span>)
<span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid_path'>path</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
  <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_file'>file</span>)
<span class='kw'>end</span> <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;0&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<p>Use class method <a href="CSV.html" title="CSV (class)"><code>CSV</code></a>.foreach without option <code>headers</code> to read one row at a time:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>File</span>.<span class='id identifier rubyid_open'>open</span>(<span class='id identifier rubyid_path'>path</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
  <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_foreach'><a href="CSV.html#foreach-class_method" title="CSV.foreach (method)">foreach</a></span>(<span class='id identifier rubyid_file'>file</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span>]</code></pre>

<h3 id="label-RFC+4180+Compliance">RFC 4180 Compliance</h3>

<p>By default, CSV parses data that is compliant with <a href="https://tools.ietf.org/html/rfc4180" target="_parent" title="RFC 4180">RFC 4180</a> with respect to:</p>
<ul><li>
<p>Row separator.</p>
</li><li>
<p>Column separator.</p>
</li><li>
<p>Quote character.</p>
</li></ul>

<h4 id="label-Row+Separator">Row Separator</h4>

<p>RFC 4180 specifies the row separator CRLF (Ruby <code>&quot;\r\n&quot;</code>).</p>

<p>Although the CSV default row separator is <code>&quot;\n&quot;</code>, the parser also by default handles row separator <code>&quot;\r&quot;</code> and the RFC-compliant <code>&quot;\r\n&quot;</code>.</p>

<h5 id="label-Recipe-3A+Handle+Compliant+Row+Separator">Recipe: Handle Compliant Row Separator</h5>

<p>For strict compliance, use option <code>:row_sep</code> to specify row separator <code>&quot;\r\n&quot;</code>, which allows the compliant row separator:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,1\r\nbar,1\r\nbaz,2\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>row_sep:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;1&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<p>But rejects other row separators:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,1\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>row_sep:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># Raised MalformedCSVError
</span><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,1\rbar,1\rbaz,2\r</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>row_sep:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># Raised MalformedCSVError
</span><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,1\n\rbar,1\n\rbaz,2\n\r</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>row_sep:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># Raised MalformedCSVError</span></code></pre>

<h5 id="label-Recipe-3A+Handle+Non-Compliant+Row+Separator">Recipe: Handle Non-Compliant Row Separator</h5>

<p>For data with non-compliant row separators, use option <code>:row_sep</code>. This example source uses semicolon (<code>&quot;;&quot;</code>) as its row separator:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,1;bar,1;baz,2;</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>row_sep:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;1&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<h4 id="label-Column+Separator">Column Separator</h4>

<p>RFC 4180 specifies column separator COMMA (Ruby <code>&quot;,&quot;</code>).</p>

<h5 id="label-Recipe-3A+Handle+Compliant+Column+Separator">Recipe: Handle Compliant Column Separator</h5>

<p>Because the CSV default comma separator is ‘,’, you need not specify option <code>:col_sep</code> for compliant data:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,1\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;1&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<h5 id="label-Recipe-3A+Handle+Non-Compliant+Column+Separator">Recipe: Handle Non-Compliant Column Separator</h5>

<p>For data with non-compliant column separators, use option <code>:col_sep</code>. This example source uses TAB (<code>&quot;\t&quot;</code>) as its column separator:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo,1\tbar,1\tbaz,2</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>col_sep:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;1&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<h4 id="label-Quote+Character">Quote Character</h4>

<p>RFC 4180 specifies quote character DQUOTE (Ruby <code>&quot;\&quot;&quot;</code>).</p>

<h5 id="label-Recipe-3A+Handle+Compliant+Quote+Character">Recipe: Handle Compliant Quote Character</h5>

<p>Because the CSV default quote character is <code>&quot;\&quot;&quot;</code>, you need not specify option <code>:quote_char</code> for compliant data:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\&quot;foo\&quot;,\&quot;1\&quot;\n\&quot;bar\&quot;,\&quot;1\&quot;\n\&quot;baz\&quot;,\&quot;2\&quot;\n</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;1&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<h5 id="label-Recipe-3A+Handle+Non-Compliant+Quote+Character">Recipe: Handle Non-Compliant Quote Character</h5>

<p>For data with non-compliant quote characters, use option <code>:quote_char</code>. This example source uses SQUOTE (<code>&quot;&#39;&quot;</code>) as its quote character:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;foo&#39;,&#39;1&#39;\n&#39;bar&#39;,&#39;1&#39;\n&#39;baz&#39;,&#39;2&#39;\n</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>quote_char:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;1&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<h4 id="label-Recipe-3A+Allow+Liberal+Parsing">Recipe: Allow Liberal Parsing</h4>

<p>Use option <code>:liberal_parsing</code> to specify that CSV should attempt to parse input not conformant with RFC 4180, such as double quotes in unquoted fields:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>is,this &quot;three, or four&quot;,fields</span><span class='tstring_end'>&#39;</span></span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span>) <span class='comment'># Raises MalformedCSVError
</span><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>liberal_parsing:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; [[&quot;is&quot;, &quot;this \&quot;three&quot;, &quot; or four\&quot;&quot;, &quot;fields&quot;]]</span></code></pre>

<h3 id="label-Special+Handling">Special Handling</h3>

<p>You can use parsing options to specify special handling for certain lines and fields.</p>

<h4 id="label-Special+Line+Handling">Special Line Handling</h4>

<p>Use parsing options to specify special handling for blank lines, or for other selected lines.</p>

<h5 id="label-Recipe-3A+Ignore+Blank+Lines">Recipe: Ignore Blank Lines</h5>

<p>Use option <code>:skip_blanks</code> to ignore blank lines:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;-EOT</span>
<span class='tstring_content'>foo,0

bar,1
baz,2

,
</span><span class='heredoc_end'>EOT
</span><span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>skip_blanks:</span> <span class='kw'>true</span>)
<span class='id identifier rubyid_parsed'>parsed</span> <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;0&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;], [nil, nil]]</span></code></pre>

<h5 id="label-Recipe-3A+Ignore+Selected+Lines">Recipe: Ignore Selected Lines</h5>

<p>Use option <code>:skip_lines</code> to ignore selected lines.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;-EOT</span>
<span class='tstring_content'># Comment
foo,0
bar,1
baz,2
# Another comment
</span><span class='heredoc_end'>EOT
</span><span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>skip_lines:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^#</span><span class='regexp_end'>/</span></span>)
<span class='id identifier rubyid_parsed'>parsed</span> <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;0&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<h4 id="label-Special+Field+Handling">Special Field Handling</h4>

<p>Use parsing options to specify special handling for certain field values.</p>

<h5 id="label-Recipe-3A+Strip+Fields">Recipe: Strip Fields</h5>

<p>Use option <code>:strip</code> to strip parsed field values:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse_line'><a href="CSV.html#parse_line-class_method" title="CSV.parse_line (method)">parse_line</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> a , b </span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>strip:</span> <span class='kw'>true</span>) <span class='comment'># =&gt; [&quot;a&quot;, &quot;b&quot;]</span></code></pre>

<h5 id="label-Recipe-3A+Handle+Null+Fields">Recipe: Handle Null Fields</h5>

<p>Use option <code>:nil_value</code> to specify a value that will replace each field that is null (no text):</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse_line'><a href="CSV.html#parse_line-class_method" title="CSV.parse_line (method)">parse_line</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a,,b,,c</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>nil_value:</span> <span class='int'>0</span>) <span class='comment'># =&gt; [&quot;a&quot;, 0, &quot;b&quot;, 0, &quot;c&quot;]</span></code></pre>

<h5 id="label-Recipe-3A+Handle+Empty+Fields">Recipe: Handle Empty Fields</h5>

<p>Use option <code>:empty_value</code> to specify a value that will replace each field that is empty (String of length 0);</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse_line'><a href="CSV.html#parse_line-class_method" title="CSV.parse_line (method)">parse_line</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a,&quot;&quot;,b,&quot;&quot;,c</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>empty_value:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>x</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># =&gt; [&quot;a&quot;, &quot;x&quot;, &quot;b&quot;, &quot;x&quot;, &quot;c&quot;]</span></code></pre>

<h3 id="label-Converting+Fields">Converting Fields</h3>

<p>You can use field converters to change parsed String fields into other objects, or to otherwise modify the String fields.</p>

<h4 id="label-Converting+Fields+to+Objects">Converting Fields to Objects</h4>

<p>Use field converters to change parsed String objects into other, more specific, objects.</p>

<p>There are built-in field converters for converting to objects of certain classes:</p>
<ul><li>
<p>Float</p>
</li><li>
<p>Integer</p>
</li><li>
<p>Date</p>
</li><li>
<p>DateTime</p>
</li></ul>

<p>Other built-in field converters include:</p>
<ul><li>
<p><code>:numeric</code>: converts to Integer and Float.</p>
</li><li>
<p><code>:all</code>: converts to DateTime, Integer, Float.</p>
</li></ul>

<p>You can also define field converters to convert to objects of other classes.</p>

<h5 id="label-Recipe-3A+Convert+Fields+to+Integers">Recipe: Convert Fields to Integers</h5>

<p>Convert fields to Integer objects using built-in converter <code>:integer</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_integer'>integer</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [Integer, Integer, Integer]</span></code></pre>

<h5 id="label-Recipe-3A+Convert+Fields+to+Floats">Recipe: Convert Fields to Floats</h5>

<p>Convert fields to Float objects using built-in converter <code>:float</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_float'>float</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [Float, Float, Float]</span></code></pre>

<h5 id="label-Recipe-3A+Convert+Fields+to+Numerics">Recipe: Convert Fields to Numerics</h5>

<p>Convert fields to Integer and Float objects using built-in converter <code>:numeric</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1.1\nbaz,2.2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_numeric'>numeric</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [Integer, Float, Float]</span></code></pre>

<h5 id="label-Recipe-3A+Convert+Fields+to+Dates">Recipe: Convert Fields to Dates</h5>

<p>Convert fields to Date objects using built-in converter <code>:date</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Date\nfoo,2001-02-03\nbar,2001-02-04\nbaz,2001-02-03\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_date'>date</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Date</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [Date, Date, Date]</span></code></pre>

<h5 id="label-Recipe-3A+Convert+Fields+to+DateTimes">Recipe: Convert Fields to DateTimes</h5>

<p>Convert fields to DateTime objects using built-in converter <code>:date_time</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,DateTime\nfoo,2001-02-03\nbar,2001-02-04\nbaz,2020-05-07T14:59:00-05:00\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_date_time'>date_time</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DateTime</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [DateTime, DateTime, DateTime]</span></code></pre>

<h5 id="label-Recipe-3A+Convert+Assorted+Fields+to+Objects">Recipe: Convert Assorted Fields to Objects</h5>

<p>Convert assorted fields to objects using built-in converter <code>:all</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Type,Value\nInteger,0\nFloat,1.0\nDateTime,2001-02-04\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_all'>all</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [Integer, Float, DateTime]</span></code></pre>

<h5 id="label-Recipe-3A+Convert+Fields+to+Other+Objects">Recipe: Convert Fields to Other Objects</h5>

<p>Define a custom field converter to convert String fields into other objects. This example defines and uses a custom field converter that converts each column-1 value to a Rational object:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rational_converter'>rational_converter</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_field_context'>field_context</span><span class='op'>|</span>
  <span class='id identifier rubyid_field_context'>field_context</span>.<span class='id identifier rubyid_index'>index</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_to_r'>to_r</span> <span class='op'>:</span> <span class='id identifier rubyid_field'>field</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='id identifier rubyid_rational_converter'>rational_converter</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_row'>row</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [Rational, Rational, Rational]</span></code></pre>

<h4 id="label-Recipe-3A+Filter+Field+Strings">Recipe: Filter Field Strings</h4>

<p>Define a custom field converter to modify String fields. This example defines and uses a custom field converter that strips whitespace from each field value:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_strip_converter'>strip_converter</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='op'>|</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_strip'>strip</span> }
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\n foo , 0 \n bar , 1 \n baz , 2 \n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='id identifier rubyid_strip_converter'>strip_converter</span>)
<span class='id identifier rubyid_parsed'>parsed</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span>] <span class='comment'># =&gt; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]
</span><span class='id identifier rubyid_parsed'>parsed</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>] <span class='comment'># =&gt; [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;]</span></code></pre>

<h4 id="label-Recipe-3A+Register+Field+Converters">Recipe: Register Field Converters</h4>

<p>Register a custom field converter, assigning it a name; then refer to the converter by its name:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rational_converter'>rational_converter</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_field_context'>field_context</span><span class='op'>|</span>
  <span class='id identifier rubyid_field_context'>field_context</span>.<span class='id identifier rubyid_index'>index</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_to_r'>to_r</span> <span class='op'>:</span> <span class='id identifier rubyid_field'>field</span>
<span class='kw'>end</span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span><span class='op'>::</span><span class='const'><a href="CSV.html#Converters-constant" title="CSV::Converters (constant)">Converters</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_rational'>rational</span>] <span class='op'>=</span> <span class='id identifier rubyid_rational_converter'>rational_converter</span>
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rational'>rational</span>)
<span class='id identifier rubyid_parsed'>parsed</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>] <span class='comment'># =&gt; [(0/1), (1/1), (2/1)]</span></code></pre>

<h4 id="label-Using+Multiple+Field+Converters">Using Multiple Field Converters</h4>

<p>You can use multiple field converters in either of these ways:</p>
<ul><li>
<p>Specify converters in option <code>:converters</code>.</p>
</li><li>
<p>Specify converters in a custom converter list.</p>
</li></ul>

<h5 id="label-Recipe-3A+Specify+Multiple+Field+Converters+in+Option+-3Aconverters">Recipe: Specify Multiple Field Converters in Option <code>:converters</code></h5>

<p>Apply multiple field converters by specifying them in option <code>:conveters</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1.0\nbaz,2.0\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_integer'>integer</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_float'>float</span>])
<span class='id identifier rubyid_parsed'>parsed</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>] <span class='comment'># =&gt; [0, 1.0, 2.0]</span></code></pre>

<h5 id="label-Recipe-3A+Specify+Multiple+Field+Converters+in+a+Custom+Converter+List">Recipe: Specify Multiple Field Converters in a Custom Converter List</h5>

<p>Apply multiple field converters by defining and registering a custom converter list:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_strip_converter'>strip_converter</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='op'>|</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_strip'>strip</span> }
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span><span class='op'>::</span><span class='const'><a href="CSV.html#Converters-constant" title="CSV::Converters (constant)">Converters</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_strip'>strip</span>] <span class='op'>=</span> <span class='id identifier rubyid_strip_converter'>strip_converter</span>
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span><span class='op'>::</span><span class='const'><a href="CSV.html#Converters-constant" title="CSV::Converters (constant)">Converters</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_my_converters'>my_converters</span>] <span class='op'>=</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_integer'>integer</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_float'>float</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_strip'>strip</span>]
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\n foo , 0 \n bar , 1.0 \n baz , 2.0 \n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_my_converters'>my_converters</span>)
<span class='id identifier rubyid_parsed'>parsed</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span>] <span class='comment'># =&gt; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]
</span><span class='id identifier rubyid_parsed'>parsed</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&#39;</span></span>] <span class='comment'># =&gt; [0, 1.0, 2.0]</span></code></pre>

<h3 id="label-Converting+Headers">Converting Headers</h3>

<p>You can use header converters to modify parsed String headers.</p>

<p>Built-in header converters include:</p>
<ul><li>
<p><code>:symbol</code>: converts String header to Symbol.</p>
</li><li>
<p><code>:downcase</code>: converts String header to lowercase.</p>
</li></ul>

<p>You can also define header converters to otherwise modify header Strings.</p>

<h4 id="label-Recipe-3A+Convert+Headers+to+Lowercase">Recipe: Convert Headers to Lowercase</h4>

<p>Convert headers to lowercase using built-in converter <code>:downcase</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>header_converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_downcase'>downcase</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_headers'>headers</span> <span class='comment'># =&gt; [&quot;name&quot;, &quot;value&quot;]</span></code></pre>

<h4 id="label-Recipe-3A+Convert+Headers+to+Symbols">Recipe: Convert Headers to Symbols</h4>

<p>Convert headers to downcased Symbols using built-in converter <code>:symbol</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>header_converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_symbol'>symbol</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_headers'>headers</span> <span class='comment'># =&gt; [:name, :value]
</span><span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_headers'>headers</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_header'>header</span><span class='op'>|</span> <span class='id identifier rubyid_header'>header</span>.<span class='id identifier rubyid_class'>class</span>} <span class='comment'># =&gt; [Symbol, Symbol]</span></code></pre>

<h4 id="label-Recipe-3A+Filter+Header+Strings">Recipe: Filter Header Strings</h4>

<p>Define a custom header converter to modify String fields. This example defines and uses a custom header converter that capitalizes each header String:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_capitalize_converter'>capitalize_converter</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_header'>header</span><span class='op'>|</span> <span class='id identifier rubyid_header'>header</span>.<span class='id identifier rubyid_capitalize'>capitalize</span> }
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NAME,VALUE\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>header_converters:</span> <span class='id identifier rubyid_capitalize_converter'>capitalize_converter</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_headers'>headers</span> <span class='comment'># =&gt; [&quot;Name&quot;, &quot;Value&quot;]</span></code></pre>

<h4 id="label-Recipe-3A+Register+Header+Converters">Recipe: Register Header Converters</h4>

<p>Register a custom header converter, assigning it a name; then refer to the converter by its name:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_capitalize_converter'>capitalize_converter</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_header'>header</span><span class='op'>|</span> <span class='id identifier rubyid_header'>header</span>.<span class='id identifier rubyid_capitalize'>capitalize</span> }
<span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span><span class='op'>::</span><span class='const'><a href="CSV.html#HeaderConverters-constant" title="CSV::HeaderConverters (constant)">HeaderConverters</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_capitalize'>capitalize</span>] <span class='op'>=</span> <span class='id identifier rubyid_capitalize_converter'>capitalize_converter</span>
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NAME,VALUE\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>header_converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_capitalize'>capitalize</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_headers'>headers</span> <span class='comment'># =&gt; [&quot;Name&quot;, &quot;Value&quot;]</span></code></pre>

<h4 id="label-Using+Multiple+Header+Converters">Using Multiple Header Converters</h4>

<p>You can use multiple header converters in either of these ways:</p>
<ul><li>
<p>Specify header converters in option <code>:header_converters</code>.</p>
</li><li>
<p>Specify header converters in a custom header converter list.</p>
</li></ul>

<h5 id="label-Recipe-3A+Specify+Multiple+Header+Converters+in+Option+-3Aheader_converters">Recipe: Specify Multiple Header Converters in Option :header_converters</h5>

<p>Apply multiple header converters by specifying them in option <code>:header_conveters</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1.0\nbaz,2.0\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>header_converters:</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_downcase'>downcase</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_symbol'>symbol</span>])
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_headers'>headers</span> <span class='comment'># =&gt; [:name, :value]</span></code></pre>

<h5 id="label-Recipe-3A+Specify+Multiple+Header+Converters+in+a+Custom+Header+Converter+List">Recipe: Specify Multiple Header Converters in a Custom Header Converter List</h5>

<p>Apply multiple header converters by defining and registering a custom header converter list:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span><span class='op'>::</span><span class='const'><a href="CSV.html#HeaderConverters-constant" title="CSV::HeaderConverters (constant)">HeaderConverters</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_my_header_converters'>my_header_converters</span>] <span class='op'>=</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_symbol'>symbol</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_downcase'>downcase</span>]
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NAME,VALUE\nfoo,0\nbar,1.0\nbaz,2.0\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>header_converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_my_header_converters'>my_header_converters</span>)
<span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_headers'>headers</span> <span class='comment'># =&gt; [:name, :value]</span></code></pre>

<h3 id="label-Diagnostics">Diagnostics</h3>

<h4 id="label-Recipe-3A+Capture+Unconverted+Fields">Recipe: Capture Unconverted Fields</h4>

<p>To capture unconverted field values, use option <code>:unconverted_fields</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name,Value\nfoo,0\nbar,1\nbaz,2\n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_integer'>integer</span><span class='comma'>,</span> <span class='label'>unconverted_fields:</span> <span class='kw'>true</span>)
<span class='id identifier rubyid_parsed'>parsed</span> <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;0&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]
</span><span class='id identifier rubyid_parsed'>parsed</span>.<span class='id identifier rubyid_each'>each</span> {<span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>.<span class='id identifier rubyid_unconverted_fields'>unconverted_fields</span> }</code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby">[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Value</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>]
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>baz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span>]</code></pre>

<h4 id="label-Recipe-3A+Capture+Field+Info">Recipe: Capture Field Info</h4>

<p>To capture field info in a custom converter, accept two block arguments. The first is the field value; the second is a <code>CSV::FieldInfo</code> object:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_strip_converter'>strip_converter</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_field_info'>field_info</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_field_info'>field_info</span><span class='semicolon'>;</span> <span class='id identifier rubyid_field'>field</span>.<span class='id identifier rubyid_strip'>strip</span> }
<span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> foo , 0 \n bar , 1 \n baz , 2 \n</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'><a href="CSV.html" title="CSV (class)">CSV</a></span>.<span class='id identifier rubyid_parse'><a href="CSV.html#parse-class_method" title="CSV.parse (method)">parse</a></span>(<span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='label'>converters:</span> <span class='id identifier rubyid_strip_converter'>strip_converter</span>)
<span class='id identifier rubyid_parsed'>parsed</span> <span class='comment'># =&gt; [[&quot;foo&quot;, &quot;0&quot;], [&quot;bar&quot;, &quot;1&quot;], [&quot;baz&quot;, &quot;2&quot;]]</span></code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'>#&lt;struct CSV::FieldInfo index=0, line=1, header=nil&gt;
</span><span class='comment'>#&lt;struct CSV::FieldInfo index=1, line=1, header=nil&gt;
</span><span class='comment'>#&lt;struct CSV::FieldInfo index=0, line=2, header=nil&gt;
</span><span class='comment'>#&lt;struct CSV::FieldInfo index=1, line=2, header=nil&gt;
</span><span class='comment'>#&lt;struct CSV::FieldInfo index=0, line=3, header=nil&gt;
</span><span class='comment'>#&lt;struct CSV::FieldInfo index=1, line=3, header=nil&gt;</span></code></pre>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>