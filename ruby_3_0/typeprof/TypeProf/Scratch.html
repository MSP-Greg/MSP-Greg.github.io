<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: TypeProf::Scratch &mdash; typeprof  Ruby-3.0.6 pp216</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "TypeProf::Scratch",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Ruby-3.0.6</a> &raquo; 
      <a href='../'>typeprof</a> &raquo; 
      <a href='../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../TypeProf.html" title="TypeProf (module)">TypeProf</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Scratch&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: TypeProf::Scratch</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Scratch/ClassDef.html" title="TypeProf::Scratch::ClassDef (class)"><code>ClassDef</code></a>,
        <a href="Scratch/VarTable.html" title="TypeProf::Scratch::VarTable (class)"><code>VarTable</code></a>      </div>
    </td></tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L247'>lib/typeprof/analyzer.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>  &#x21d2; Scratch </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#class_defs-instance_method" title="#class_defs (instance method)">#<strong>class_defs</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#loaded_files-instance_method" title="#loaded_files (instance method)">#<strong>loaded_files</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#namespace-instance_method" title="#namespace (instance method)">#<strong>namespace</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#rbs_reader-instance_method" title="#rbs_reader (instance method)">#<strong>rbs_reader</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#return_envs-instance_method" title="#return_envs (instance method)">#<strong>return_envs</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#add_attr_method-instance_method" title="#add_attr_method (instance method)">#<strong>add_attr_method</strong>(klass, mid, ivar, kind, pub_meth, ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_block_signature!-instance_method" title="#add_block_signature! (instance method)">#<strong>add_block_signature!</strong>(block_body, bsig)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_block_to_ctx!-instance_method" title="#add_block_to_ctx! (instance method)">#<strong>add_block_to_ctx!</strong>(block_body, ctx)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_callsite!-instance_method" title="#add_callsite! (instance method)">#<strong>add_callsite!</strong>(callee_ctx, caller_ep, caller_env, &amp;ctn)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_constant-instance_method" title="#add_constant (instance method)">#<strong>add_constant</strong>(klass, name, value, user_defined)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_cvar_read!-instance_method" title="#add_cvar_read! (instance method)">#<strong>add_cvar_read!</strong>(klass, var, ep, &amp;ctn)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_cvar_write!-instance_method" title="#add_cvar_write! (instance method)">#<strong>add_cvar_write!</strong>(klass, var, ty, ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_edge-instance_method" title="#add_edge (instance method)">#<strong>add_edge</strong>(ep, next_ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_entrypoint-instance_method" title="#add_entrypoint (instance method)">#<strong>add_entrypoint</strong>(iseq)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_executed_iseq-instance_method" title="#add_executed_iseq (instance method)">#<strong>add_executed_iseq</strong>(iseq)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_gvar_read!-instance_method" title="#add_gvar_read! (instance method)">#<strong>add_gvar_read!</strong>(var, ep, &amp;ctn)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_gvar_write!-instance_method" title="#add_gvar_write! (instance method)">#<strong>add_gvar_write!</strong>(var, ty, ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_iseq_method-instance_method" title="#add_iseq_method (instance method)">#<strong>add_iseq_method</strong>(klass, mid, iseq, cref, outer_ep, pub_meth)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_iseq_method_call!-instance_method" title="#add_iseq_method_call! (instance method)">#<strong>add_iseq_method_call!</strong>(iseq_mdef, ctx)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_ivar_read!-instance_method" title="#add_ivar_read! (instance method)">#<strong>add_ivar_read!</strong>(recv, var, ep, &amp;ctn)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_ivar_write!-instance_method" title="#add_ivar_write! (instance method)">#<strong>add_ivar_write!</strong>(recv, var, ty, ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_method-instance_method" title="#add_method (instance method)">#<strong>add_method</strong>(klass, mid, singleton, mdef)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_method_signature!-instance_method" title="#add_method_signature! (instance method)">#<strong>add_method_signature!</strong>(callee_ctx, msig)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_return_value!-instance_method" title="#add_return_value! (instance method)">#<strong>add_return_value!</strong>(callee_ctx, ret_ty)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_singleton_iseq_method-instance_method" title="#add_singleton_iseq_method (instance method)">#<strong>add_singleton_iseq_method</strong>(klass, mid, iseq, cref, outer_ep, pub_meth)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_superclass_type_args!-instance_method" title="#add_superclass_type_args! (instance method)">#<strong>add_superclass_type_args!</strong>(klass, tyargs)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#adjust_substitution-instance_method" title="#adjust_substitution (instance method)">#<strong>adjust_substitution</strong>(klass, singleton, mid, mthd, subst, &amp;blk)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#alias_method-instance_method" title="#alias_method (instance method)">#<strong>alias_method</strong>(klass, singleton, alias_mid, orig_mid, ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#cbase_path-instance_method" title="#cbase_path (instance method)">#<strong>cbase_path</strong>(cbase)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#check_typed_method-instance_method" title="#check_typed_method (instance method)">#<strong>check_typed_method</strong>(klass, mid, singleton)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#do_define_iseq_method-instance_method" title="#do_define_iseq_method (instance method)">#<strong>do_define_iseq_method</strong>(ep, env, mid, iseq, outer_ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#do_invoke_block-instance_method" title="#do_invoke_block (instance method)">#<strong>do_invoke_block</strong>(blk, aargs, ep, env, replace_recv_ty: nil, replace_cref: nil, &amp;ctn)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#do_send-instance_method" title="#do_send (instance method)">#<strong>do_send</strong>(recvs, mid, aargs, ep, env, &amp;ctn)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#error-instance_method" title="#error (instance method)">#<strong>error</strong>(ep, msg)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_all_super_methods-instance_method" title="#get_all_super_methods (instance method)">#<strong>get_all_super_methods</strong>(klass, singleton, current_klass, mid)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_array_elem_type-instance_method" title="#get_array_elem_type (instance method)">#<strong>get_array_elem_type</strong>(env, ep, id, idx = nil)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_class_name-instance_method" title="#get_class_name (instance method)">#<strong>get_class_name</strong>(klass)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_constant-instance_method" title="#get_constant (instance method)">#<strong>get_constant</strong>(klass, name)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_container_elem_types-instance_method" title="#get_container_elem_types (instance method)">#<strong>get_container_elem_types</strong>(env, ep, id)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_env-instance_method" title="#get_env (instance method)">#<strong>get_env</strong>(ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_hash_elem_type-instance_method" title="#get_hash_elem_type (instance method)">#<strong>get_hash_elem_type</strong>(env, ep, id, key_ty = nil)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_instance_variable-instance_method" title="#get_instance_variable (instance method)">#<strong>get_instance_variable</strong>(recv, var, ep, env)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_ivar-instance_method" title="#get_ivar (instance method)">#<strong>get_ivar</strong>(recv, var)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_method-instance_method" title="#get_method (instance method)">#<strong>get_method</strong>(klass, singleton, include_subclasses, mid)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_super_method-instance_method" title="#get_super_method (instance method)">#<strong>get_super_method</strong>(ctx, singleton)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#globalize_type-instance_method" title="#globalize_type (instance method)">#<strong>globalize_type</strong>(ty, env, ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#identify_class_for_ivar-instance_method" title="#identify_class_for_ivar (instance method)">#<strong>identify_class_for_ivar</strong>(recv, var)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#localize_type-instance_method" title="#localize_type (instance method)">#<strong>localize_type</strong>(ty, env, ep, alloc_site = AllocationSite.new(ep))  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#merge_env-instance_method" title="#merge_env (instance method)">#<strong>merge_env</strong>(ep, env)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#merge_return_env-instance_method" title="#merge_return_env (instance method)">#<strong>merge_return_env</strong>(caller_ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#mix_module-instance_method" title="#mix_module (instance method)">#<strong>mix_module</strong>(kind, mixing_mod, mixed_mod, type_args, singleton, caller_ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new_class-instance_method" title="#new_class (instance method)">#<strong>new_class</strong>(cbase, name, type_params, superclass, absolute_path)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new_struct-instance_method" title="#new_struct (instance method)">#<strong>new_struct</strong>(ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pend_block_dummy_execution-instance_method" title="#pend_block_dummy_execution (instance method)">#<strong>pend_block_dummy_execution</strong>(blk, iseq, nep, nenv)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pend_method_execution-instance_method" title="#pend_method_execution (instance method)">#<strong>pend_method_execution</strong>(iseq, meth, recv, mid, cref, ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#report-instance_method" title="#report (instance method)">#<strong>report</strong>(stat_eps, output)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reveal_type-instance_method" title="#reveal_type (instance method)">#<strong>reveal_type</strong>(ep, ty)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#search_constant-instance_method" title="#search_constant (instance method)">#<strong>search_constant</strong>(cref, name)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#search_method-instance_method" title="#search_method (instance method)">#<strong>search_method</strong>(klass, singleton, mid, &amp;blk)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_custom_method-instance_method" title="#set_custom_method (instance method)">#<strong>set_custom_method</strong>(klass, mid, impl, pub_meth = true)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_instance_variable-instance_method" title="#set_instance_variable (instance method)">#<strong>set_instance_variable</strong>(recv, var, ty, ep, env)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_method-instance_method" title="#set_method (instance method)">#<strong>set_method</strong>(klass, mid, singleton, mdef)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_singleton_custom_method-instance_method" title="#set_singleton_custom_method (instance method)">#<strong>set_singleton_custom_method</strong>(klass, mid, impl, pub_meth = true)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#show_block_signature-instance_method" title="#show_block_signature (instance method)">#<strong>show_block_signature</strong>(blks)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#show_method_signature-instance_method" title="#show_method_signature (instance method)">#<strong>show_method_signature</strong>(ctx)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#show_proc_signature-instance_method" title="#show_proc_signature (instance method)">#<strong>show_proc_signature</strong>(blks)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#step-instance_method" title="#step (instance method)">#<strong>step</strong>(ep)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#traverse_subclasses-instance_method" title="#traverse_subclasses (instance method)">#<strong>traverse_subclasses</strong>(klass, &amp;blk)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#type_profile-instance_method" title="#type_profile (instance method)">#<strong>type_profile</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#update_container_elem_types-instance_method" title="#update_container_elem_types (instance method)">#<strong>update_container_elem_types</strong>(env, ep, id, base_type)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#warn-instance_method" title="#warn (instance method)">#<strong>warn</strong>(ep, msg)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#do_expand_array-instance_method" title="#do_expand_array (instance method)">#<strong>do_expand_array</strong>(ep, env, elems, num, splat, from_head)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#setup_actual_arguments-instance_method" title="#setup_actual_arguments (instance method)">#<strong>setup_actual_arguments</strong>(kind, operands, ep, env)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>  &#x21d2; <code>Scratch</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L252-L290'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='252' data-end='290'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 252</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@entrypoints</span> <span class='op'>=</span> []

  <span class='ivar'>@worklist</span> <span class='op'>=</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/WorkList.html" title="TypeProf::Utils::WorkList (class)">WorkList</a></span>.<span class='id identifier rubyid_new'><a href="Utils/WorkList.html#new-class_method" title="TypeProf::Utils::WorkList.new (method)">new</a></span>

  <span class='ivar'>@ep2env</span> <span class='op'>=</span> {}

  <span class='ivar'>@class_defs</span> <span class='op'>=</span> {}
  <span class='ivar'>@struct_defs</span> <span class='op'>=</span> {}

  <span class='ivar'>@iseq_method_to_ctxs</span> <span class='op'>=</span> {}

  <span class='ivar'>@alloc_site_to_global_id</span> <span class='op'>=</span> {}

  <span class='ivar'>@callsites</span><span class='comma'>,</span> <span class='ivar'>@return_envs</span> <span class='op'>=</span> {}<span class='comma'>,</span> {}
  <span class='ivar'>@block_to_ctx</span> <span class='op'>=</span> {}
  <span class='ivar'>@method_signatures</span> <span class='op'>=</span> {}
  <span class='ivar'>@block_signatures</span> <span class='op'>=</span> {}
  <span class='ivar'>@return_values</span> <span class='op'>=</span> {}
  <span class='ivar'>@gvar_table</span> <span class='op'>=</span> <span class='const'><a href="Scratch/VarTable.html" title="TypeProf::Scratch::VarTable (class)">VarTable</a></span>.<span class='id identifier rubyid_new'><a href="Scratch/VarTable.html#new-class_method" title="TypeProf::Scratch::VarTable.new (method)">new</a></span>

  <span class='ivar'>@errors</span> <span class='op'>=</span> []
  <span class='ivar'>@reveal_types</span> <span class='op'>=</span> {}
  <span class='ivar'>@backward_edges</span> <span class='op'>=</span> {}

  <span class='ivar'>@pending_execution</span> <span class='op'>=</span> {}
  <span class='ivar'>@executed_iseqs</span> <span class='op'>=</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/MutableSet.html" title="TypeProf::Utils::MutableSet (class)">MutableSet</a></span>.<span class='id identifier rubyid_new'><a href="Utils/MutableSet.html#new-class_method" title="TypeProf::Utils::MutableSet.new (method)">new</a></span>

  <span class='ivar'>@loaded_files</span> <span class='op'>=</span> {}

  <span class='ivar'>@rbs_reader</span> <span class='op'>=</span> <span class='const'><a href="RBSReader.html" title="TypeProf::RBSReader (class)">RBSReader</a></span>.<span class='id identifier rubyid_new'><a href="RBSReader.html#new-class_method" title="TypeProf::RBSReader.new (method)">new</a></span>

  <span class='ivar'>@terminated</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='ivar'>@anonymous_struct_gen_id</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='ivar'>@types_being_shown</span> <span class='op'>=</span> []
  <span class='ivar'>@namespace</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="class_defs-instance_method">
  <h3 class='signature ro first'>
    #<strong>class_defs</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L318-L318'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='318' data-end='318'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 318</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_class_defs'>class_defs</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="loaded_files-instance_method">
  <h3 class='signature ro'>
    #<strong>loaded_files</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L296-L296'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='296' data-end='296'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 296</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_return_envs'><a href="#return_envs-instance_method" title="TypeProf::Scratch#return_envs (method)">return_envs</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_loaded_files'>loaded_files</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rbs_reader'><a href="#rbs_reader-instance_method" title="TypeProf::Scratch#rbs_reader (method)">rbs_reader</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="namespace-instance_method">
  <h3 class='signature rw'>
    #<strong>namespace</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L489-L489'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='489' data-end='489'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 489</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_namespace'>namespace</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rbs_reader-instance_method">
  <h3 class='signature ro'>
    #<strong>rbs_reader</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L296-L296'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='296' data-end='296'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 296</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_return_envs'><a href="#return_envs-instance_method" title="TypeProf::Scratch#return_envs (method)">return_envs</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_loaded_files'><a href="#loaded_files-instance_method" title="TypeProf::Scratch#loaded_files (method)">loaded_files</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rbs_reader'>rbs_reader</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="return_envs-instance_method">
  <h3 class='signature ro'>
    #<strong>return_envs</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L296-L296'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='296' data-end='296'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 296</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_return_envs'>return_envs</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_loaded_files'><a href="#loaded_files-instance_method" title="TypeProf::Scratch#loaded_files (method)">loaded_files</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rbs_reader'><a href="#rbs_reader-instance_method" title="TypeProf::Scratch#rbs_reader (method)">rbs_reader</a></span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="add_attr_method-instance_method">
  <h3 class='signature  first'>
    #<strong>add_attr_method</strong>(klass, mid, ivar, kind, pub_meth, ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L644-L651'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='644' data-end='651'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 644</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_attr_method'>add_attr_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_ivar'>ivar</span><span class='comma'>,</span> <span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reader'>reader</span> <span class='op'>||</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_accessor'>accessor</span>
    <span class='id identifier rubyid_add_method'><a href="#add_method-instance_method" title="TypeProf::Scratch#add_method (method)">add_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='const'><a href="AttrMethodDef.html" title="TypeProf::AttrMethodDef (class)">AttrMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="AttrMethodDef.html#new-class_method" title="TypeProf::AttrMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_ivar'>ivar</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reader'>reader</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>))
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_writer'>writer</span> <span class='op'>||</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_accessor'>accessor</span>
    <span class='id identifier rubyid_add_method'><a href="#add_method-instance_method" title="TypeProf::Scratch#add_method (method)">add_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='symbeg'>:&quot;</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_mid'>mid</span> <span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='const'><a href="AttrMethodDef.html" title="TypeProf::AttrMethodDef (class)">AttrMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="AttrMethodDef.html#new-class_method" title="TypeProf::AttrMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_ivar'>ivar</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_writer'>writer</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>))
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_block_signature!-instance_method">
  <h3 class='signature '>
    #<strong>add_block_signature!</strong>(block_body, bsig)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L737-L743'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='737' data-end='743'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 737</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_block_signature!'>add_block_signature!</span>(<span class='id identifier rubyid_block_body'>block_body</span><span class='comma'>,</span> <span class='id identifier rubyid_bsig'>bsig</span>)
  <span class='kw'>if</span> <span class='ivar'>@block_signatures</span>[<span class='id identifier rubyid_block_body'>block_body</span>]
    <span class='ivar'>@block_signatures</span>[<span class='id identifier rubyid_block_body'>block_body</span>] <span class='op'>=</span> <span class='ivar'>@block_signatures</span>[<span class='id identifier rubyid_block_body'>block_body</span>].<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_bsig'>bsig</span>)
  <span class='kw'>else</span>
    <span class='ivar'>@block_signatures</span>[<span class='id identifier rubyid_block_body'>block_body</span>] <span class='op'>=</span> <span class='id identifier rubyid_bsig'>bsig</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_block_to_ctx!-instance_method">
  <h3 class='signature '>
    #<strong>add_block_to_ctx!</strong>(block_body, ctx)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L731-L735'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='731' data-end='735'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 731</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_block_to_ctx!'>add_block_to_ctx!</span>(<span class='id identifier rubyid_block_body'>block_body</span><span class='comma'>,</span> <span class='id identifier rubyid_ctx'>ctx</span>)
  <span class='id identifier rubyid_raise'>raise</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_block_body'>block_body</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Block.html" title="TypeProf::Block (class)">Block</a></span>)
  <span class='ivar'>@block_to_ctx</span>[<span class='id identifier rubyid_block_body'>block_body</span>] <span class='op'>||=</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/MutableSet.html" title="TypeProf::Utils::MutableSet (class)">MutableSet</a></span>.<span class='id identifier rubyid_new'><a href="Utils/MutableSet.html#new-class_method" title="TypeProf::Utils::MutableSet.new (method)">new</a></span>
  <span class='ivar'>@block_to_ctx</span>[<span class='id identifier rubyid_block_body'>block_body</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ctx'>ctx</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_callsite!-instance_method">
  <h3 class='signature '>
    #<strong>add_callsite!</strong>(callee_ctx, caller_ep, caller_env, &amp;ctn)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L696-L707'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='696' data-end='707'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 696</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_callsite!'>add_callsite!</span>(<span class='id identifier rubyid_callee_ctx'>callee_ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_caller_ep'>caller_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_caller_env'>caller_env</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='ivar'>@executed_iseqs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_callee_ctx'>callee_ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span> <span class='kw'>if</span> <span class='id identifier rubyid_callee_ctx'>callee_ctx</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Context.html" title="TypeProf::Context (class)">Context</a></span>)

  <span class='ivar'>@callsites</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>] <span class='op'>||=</span> {}
  <span class='ivar'>@callsites</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>][<span class='id identifier rubyid_caller_ep'>caller_ep</span>] <span class='op'>=</span> <span class='id identifier rubyid_ctn'>ctn</span>
  <span class='id identifier rubyid_merge_return_env'><a href="#merge_return_env-instance_method" title="TypeProf::Scratch#merge_return_env (method)">merge_return_env</a></span>(<span class='id identifier rubyid_caller_ep'>caller_ep</span>) {<span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span> <span class='id identifier rubyid_env'>env</span> <span class='op'>?</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_caller_env'>caller_env</span>) <span class='op'>:</span> <span class='id identifier rubyid_caller_env'>caller_env</span> }

  <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='ivar'>@return_values</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>] <span class='op'>||=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>!=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
    <span class='id identifier rubyid_ctn'>ctn</span>[<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_caller_ep'>caller_ep</span><span class='comma'>,</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_caller_ep'>caller_ep</span>]]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_constant-instance_method">
  <h3 class='signature '>
    #<strong>add_constant</strong>(klass, name, value, user_defined)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L624-L628'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='624' data-end='628'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 624</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_constant'>add_constant</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_user_defined'>user_defined</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
    <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_add_constant'>add_constant</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_user_defined'>user_defined</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_cvar_read!-instance_method">
  <h3 class='signature '>
    #<strong>add_cvar_read!</strong>(klass, var, ep, &amp;ctn)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L822-L829'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='822' data-end='829'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 822</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_cvar_read!'>add_cvar_read!</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_klass'>klass</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
    <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_class_def'>class_def</span>
    <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_cvars'>cvars</span>.<span class='id identifier rubyid_add_read!'>add_read!</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_cvar_write!-instance_method">
  <h3 class='signature '>
    #<strong>add_cvar_write!</strong>(klass, var, ty, ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L831-L838'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='831' data-end='838'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 831</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_cvar_write!'>add_cvar_write!</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_klass'>klass</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
    <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_class_def'>class_def</span>
    <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_cvars'>cvars</span>.<span class='id identifier rubyid_add_write!'>add_write!</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='kw'>self</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_edge-instance_method">
  <h3 class='signature '>
    #<strong>add_edge</strong>(ep, next_ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L683-L685'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='683' data-end='685'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 683</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_edge'>add_edge</span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_next_ep'>next_ep</span>)
  (<span class='ivar'>@backward_edges</span>[<span class='id identifier rubyid_next_ep'>next_ep</span>] <span class='op'>||=</span> {})[<span class='id identifier rubyid_ep'>ep</span>] <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_entrypoint-instance_method">
  <h3 class='signature '>
    #<strong>add_entrypoint</strong>(iseq)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L292-L294'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='292' data-end='294'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 292</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_entrypoint'>add_entrypoint</span>(<span class='id identifier rubyid_iseq'>iseq</span>)
  <span class='ivar'>@entrypoints</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_iseq'>iseq</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_executed_iseq-instance_method">
  <h3 class='signature '>
    #<strong>add_executed_iseq</strong>(iseq)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L692-L694'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='692' data-end='694'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 692</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_executed_iseq'>add_executed_iseq</span>(<span class='id identifier rubyid_iseq'>iseq</span>)
  <span class='ivar'>@executed_iseqs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_iseq'>iseq</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_gvar_read!-instance_method">
  <h3 class='signature '>
    #<strong>add_gvar_read!</strong>(var, ep, &amp;ctn)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L840-L842'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='840' data-end='842'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 840</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_gvar_read!'>add_gvar_read!</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='ivar'>@gvar_table</span>.<span class='id identifier rubyid_add_read!'>add_read!</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_gvar_write!-instance_method">
  <h3 class='signature '>
    #<strong>add_gvar_write!</strong>(var, ty, ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L844-L846'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='844' data-end='846'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 844</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_gvar_write!'>add_gvar_write!</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='ivar'>@gvar_table</span>.<span class='id identifier rubyid_add_write!'>add_write!</span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='kw'>self</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_iseq_method-instance_method">
  <h3 class='signature '>
    #<strong>add_iseq_method</strong>(klass, mid, iseq, cref, outer_ep, pub_meth)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L653-L655'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='653' data-end='655'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 653</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_iseq_method'>add_iseq_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span>)
  <span class='id identifier rubyid_add_method'><a href="#add_method-instance_method" title="TypeProf::Scratch#add_method (method)">add_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='const'><a href="ISeqMethodDef.html" title="TypeProf::ISeqMethodDef (class)">ISeqMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="ISeqMethodDef.html#new-class_method" title="TypeProf::ISeqMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_iseq_method_call!-instance_method">
  <h3 class='signature '>
    #<strong>add_iseq_method_call!</strong>(iseq_mdef, ctx)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L687-L690'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='687' data-end='690'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 687</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_iseq_method_call!'>add_iseq_method_call!</span>(<span class='id identifier rubyid_iseq_mdef'>iseq_mdef</span><span class='comma'>,</span> <span class='id identifier rubyid_ctx'>ctx</span>)
  <span class='ivar'>@iseq_method_to_ctxs</span>[<span class='id identifier rubyid_iseq_mdef'>iseq_mdef</span>] <span class='op'>||=</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/MutableSet.html" title="TypeProf::Utils::MutableSet (class)">MutableSet</a></span>.<span class='id identifier rubyid_new'><a href="Utils/MutableSet.html#new-class_method" title="TypeProf::Utils::MutableSet.new (method)">new</a></span>
  <span class='ivar'>@iseq_method_to_ctxs</span>[<span class='id identifier rubyid_iseq_mdef'>iseq_mdef</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ctx'>ctx</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_ivar_read!-instance_method">
  <h3 class='signature '>
    #<strong>add_ivar_read!</strong>(recv, var, ep, &amp;ctn)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L806-L812'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='806' data-end='812'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 806</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_ivar_read!'>add_ivar_read!</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_recv'>recv</span><span class='op'>|</span>
    <span class='id identifier rubyid_class_def'>class_def</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>=</span> <span class='id identifier rubyid_get_ivar'><a href="#get_ivar-instance_method" title="TypeProf::Scratch#get_ivar (method)">get_ivar</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>)
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_class_def'>class_def</span>
    <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_ivars'>ivars</span>.<span class='id identifier rubyid_add_read!'>add_read!</span>([<span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>]<span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_ivar_write!-instance_method">
  <h3 class='signature '>
    #<strong>add_ivar_write!</strong>(recv, var, ty, ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L814-L820'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='814' data-end='820'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 814</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_ivar_write!'>add_ivar_write!</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_recv'>recv</span><span class='op'>|</span>
    <span class='id identifier rubyid_class_def'>class_def</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>=</span> <span class='id identifier rubyid_get_ivar'><a href="#get_ivar-instance_method" title="TypeProf::Scratch#get_ivar (method)">get_ivar</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>)
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_class_def'>class_def</span>
    <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_ivars'>ivars</span>.<span class='id identifier rubyid_add_write!'>add_write!</span>([<span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>]<span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='kw'>self</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_method-instance_method">
  <h3 class='signature '>
    #<strong>add_method</strong>(klass, mid, singleton, mdef)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L634-L637'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='634' data-end='637'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 634</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_method'>add_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mdef'>mdef</span>)
  <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_add_method'>add_method</span>(<span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mdef'>mdef</span>)
  <span class='id identifier rubyid_mdef'>mdef</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_method_signature!-instance_method">
  <h3 class='signature '>
    #<strong>add_method_signature!</strong>(callee_ctx, msig)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L709-L715'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='709' data-end='715'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 709</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_method_signature!'>add_method_signature!</span>(<span class='id identifier rubyid_callee_ctx'>callee_ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_msig'>msig</span>)
  <span class='kw'>if</span> <span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>]
    <span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>] <span class='op'>=</span> <span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>].<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_msig'>msig</span>)
  <span class='kw'>else</span>
    <span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>] <span class='op'>=</span> <span class='id identifier rubyid_msig'>msig</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_return_value!-instance_method">
  <h3 class='signature '>
    #<strong>add_return_value!</strong>(callee_ctx, ret_ty)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L721-L729'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='721' data-end='729'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 721</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_return_value!'>add_return_value!</span>(<span class='id identifier rubyid_callee_ctx'>callee_ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>)
  <span class='ivar'>@return_values</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>] <span class='op'>||=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
  <span class='ivar'>@return_values</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>] <span class='op'>=</span> <span class='ivar'>@return_values</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>].<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)

  <span class='ivar'>@callsites</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>] <span class='op'>||=</span> {}
  <span class='ivar'>@callsites</span>[<span class='id identifier rubyid_callee_ctx'>callee_ctx</span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_caller_ep'>caller_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ctn'>ctn</span><span class='op'>|</span>
    <span class='id identifier rubyid_ctn'>ctn</span>[<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_caller_ep'>caller_ep</span><span class='comma'>,</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_caller_ep'>caller_ep</span>]]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_singleton_iseq_method-instance_method">
  <h3 class='signature '>
    #<strong>add_singleton_iseq_method</strong>(klass, mid, iseq, cref, outer_ep, pub_meth)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L657-L659'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='657' data-end='659'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 657</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_singleton_iseq_method'>add_singleton_iseq_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span>)
  <span class='id identifier rubyid_add_method'><a href="#add_method-instance_method" title="TypeProf::Scratch#add_method (method)">add_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='const'><a href="ISeqMethodDef.html" title="TypeProf::ISeqMethodDef (class)">ISeqMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="ISeqMethodDef.html#new-class_method" title="TypeProf::ISeqMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_superclass_type_args!-instance_method">
  <h3 class='signature '>
    #<strong>add_superclass_type_args!</strong>(klass, tyargs)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L468-L470'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='468' data-end='470'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 468</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_superclass_type_args!'>add_superclass_type_args!</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_tyargs'>tyargs</span>)
  <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass_type_args'>superclass_type_args</span> <span class='op'>=</span> <span class='id identifier rubyid_tyargs'>tyargs</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="adjust_substitution-instance_method">
  <h3 class='signature '>
    #<strong>adjust_substitution</strong>(klass, singleton, mid, mthd, subst, &amp;blk)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L511-L533'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='511' data-end='533'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 511</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_adjust_substitution'>adjust_substitution</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_mthd'>mthd</span><span class='comma'>,</span> <span class='id identifier rubyid_subst'>subst</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='id identifier rubyid_direct'>direct</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>class</span>
    <span class='kw'>while</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='id identifier rubyid___root__'>__root__</span>
      <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
      <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_adjust_substitution'>adjust_substitution</span>(<span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_mthd'>mthd</span><span class='comma'>,</span> <span class='id identifier rubyid_subst'>subst</span><span class='comma'>,</span> <span class='id identifier rubyid_direct'>direct</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
      <span class='id identifier rubyid_direct'>direct</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass_type_args'>superclass_type_args</span>
        <span class='id identifier rubyid_subst2'>subst2</span> <span class='op'>=</span> {}
        <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_type_params'>type_params</span>.<span class='id identifier rubyid_zip'>zip</span>(<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass_type_args'>superclass_type_args</span>) <span class='kw'>do</span> <span class='op'>|</span>(<span class='id identifier rubyid_tyvar'>tyvar</span><span class='comma'>,</span> <span class='op'>*</span>)<span class='comma'>,</span> <span class='id identifier rubyid_tyarg'>tyarg</span><span class='op'>|</span>
          <span class='id identifier rubyid_tyvar'>tyvar</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Var.html" title="TypeProf::Type::Var (class)">Var</a></span>.<span class='id identifier rubyid_new'><a href="Type/Var.html#new-class_method" title="TypeProf::Type::Var.new (method)">new</a></span>(<span class='id identifier rubyid_tyvar'>tyvar</span>)
          <span class='id identifier rubyid_subst2'>subst2</span>[<span class='id identifier rubyid_tyvar'>tyvar</span>] <span class='op'>=</span> <span class='id identifier rubyid_tyarg'>tyarg</span>.<span class='id identifier rubyid_substitute'>substitute</span>(<span class='id identifier rubyid_subst'>subst</span><span class='comma'>,</span> <span class='const'>Config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_type_depth_limit'>type_depth_limit</span>])
        <span class='kw'>end</span>
        <span class='id identifier rubyid_subst'>subst</span> <span class='op'>=</span> <span class='id identifier rubyid_subst2'>subst2</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># module
</span>    <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
    <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_adjust_substitution'>adjust_substitution</span>(<span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_mthd'>mthd</span><span class='comma'>,</span> <span class='id identifier rubyid_subst'>subst</span><span class='comma'>,</span> <span class='id identifier rubyid_direct'>direct</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="alias_method-instance_method">
  <h3 class='signature '>
    #<strong>alias_method</strong>(klass, singleton, alias_mid, orig_mid, ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L669-L681'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='669' data-end='681'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 669</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_alias_method'>alias_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_alias_mid'>alias_mid</span><span class='comma'>,</span> <span class='id identifier rubyid_orig_mid'>orig_mid</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
    <span class='kw'>self</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_mdefs'>mdefs</span> <span class='op'>=</span> <span class='id identifier rubyid_get_method'><a href="#get_method-instance_method" title="TypeProf::Scratch#get_method (method)">get_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_orig_mid'>orig_mid</span>) <span class='comment'># XXX: include_subclass == false??
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_mdefs'>mdefs</span>
      <span class='comment'># dup is needed for `alias foo foo` (otherwise, &quot;can&#39;t add a new key into hash during iteration&quot; error occurs)
</span>      <span class='id identifier rubyid_mdefs'>mdefs</span>.<span class='id identifier rubyid_dup'>dup</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mdef'>mdef</span><span class='op'>|</span>
        <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_add_method'><a href="#add_method-instance_method" title="TypeProf::Scratch#add_method (method)">add_method</a></span>(<span class='id identifier rubyid_alias_mid'>alias_mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='const'><a href="AliasMethodDef.html" title="TypeProf::AliasMethodDef (class)">AliasMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="AliasMethodDef.html#new-class_method" title="TypeProf::AliasMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_orig_mid'>orig_mid</span><span class='comma'>,</span> <span class='id identifier rubyid_mdef'>mdef</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>))
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cbase_path-instance_method">
  <h3 class='signature '>
    #<strong>cbase_path</strong>(cbase)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L443-L445'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='443' data-end='445'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 443</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cbase_path'>cbase_path</span>(<span class='id identifier rubyid_cbase'>cbase</span>)
  <span class='id identifier rubyid_cbase'>cbase</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_cbase'>cbase</span>.<span class='id identifier rubyid_idx'>idx</span> <span class='op'>!=</span> <span class='int'>1</span> <span class='op'>?</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_cbase'>cbase</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_name'>name</span> <span class='op'>:</span> []
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="check_typed_method-instance_method">
  <h3 class='signature '>
    #<strong>check_typed_method</strong>(klass, mid, singleton)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L630-L632'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='630' data-end='632'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 630</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_check_typed_method'>check_typed_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>)
  <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_check_typed_method'>check_typed_method</span>(<span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="do_define_iseq_method-instance_method">
  <h3 class='signature '>
    #<strong>do_define_iseq_method</strong>(ep, env, mid, iseq, outer_ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2234-L2260'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2234' data-end='2260'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2234</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_do_define_iseq_method'>do_define_iseq_method</span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span>)
  <span class='id identifier rubyid_cref'>cref</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
    <span class='id identifier rubyid_typed_mdef'>typed_mdef</span> <span class='op'>=</span> <span class='id identifier rubyid_check_typed_method'><a href="#check_typed_method-instance_method" title="TypeProf::Scratch#check_typed_method (method)">check_typed_method</a></span>(<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_singleton'>singleton</span>)
    <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span>
    <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='id identifier rubyid_recv'>recv</span>) <span class='kw'>unless</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_singleton'>singleton</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_typed_mdef'>typed_mdef</span>
      <span class='id identifier rubyid_mdef'>mdef</span> <span class='op'>=</span> <span class='const'><a href="ISeqMethodDef.html" title="TypeProf::ISeqMethodDef (class)">ISeqMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="ISeqMethodDef.html#new-class_method" title="TypeProf::ISeqMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_pub_meth'>pub_meth</span>)
      <span class='id identifier rubyid_typed_mdef'>typed_mdef</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_typed_mdef'>typed_mdef</span><span class='op'>|</span>
        <span class='id identifier rubyid_typed_mdef'>typed_mdef</span>.<span class='id identifier rubyid_do_match_iseq_mdef'>do_match_iseq_mdef</span>(<span class='id identifier rubyid_mdef'>mdef</span><span class='comma'>,</span> <span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='kw'>self</span>)
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_singleton'>singleton</span>
        <span class='id identifier rubyid_meth'>meth</span> <span class='op'>=</span> <span class='id identifier rubyid_add_singleton_iseq_method'><a href="#add_singleton_iseq_method-instance_method" title="TypeProf::Scratch#add_singleton_iseq_method (method)">add_singleton_iseq_method</a></span>(<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='kw'>true</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_meth'>meth</span> <span class='op'>=</span> <span class='id identifier rubyid_add_iseq_method'><a href="#add_iseq_method-instance_method" title="TypeProf::Scratch#add_iseq_method (method)">add_iseq_method</a></span>(<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_pub_meth'>pub_meth</span>)
        <span class='kw'>if</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_mod_func'>mod_func</span>
          <span class='id identifier rubyid_add_singleton_iseq_method'><a href="#add_singleton_iseq_method-instance_method" title="TypeProf::Scratch#add_singleton_iseq_method (method)">add_singleton_iseq_method</a></span>(<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span><span class='comma'>,</span> <span class='kw'>true</span>)
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_pend_method_execution'><a href="#pend_method_execution-instance_method" title="TypeProf::Scratch#pend_method_execution (method)">pend_method_execution</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_ep'>outer_ep</span>)
  <span class='kw'>else</span>
    <span class='comment'># XXX: what to do?
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="do_expand_array-instance_method">
  <h3 class='signature priv'>
    #<strong>do_expand_array</strong>(ep, env, elems, num, splat, from_head)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2020-L2041'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2020' data-end='2041'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2020</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_private'>private</span> <span class='kw'>def</span> <span class='id identifier rubyid_do_expand_array'>do_expand_array</span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span><span class='comma'>,</span> <span class='id identifier rubyid_num'>num</span><span class='comma'>,</span> <span class='id identifier rubyid_splat'>splat</span><span class='comma'>,</span> <span class='id identifier rubyid_from_head'>from_head</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_from_head'>from_head</span>
    <span class='id identifier rubyid_lead_tys'>lead_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_rest_ary_ty'>rest_ary_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_take_first'>take_first</span>(<span class='id identifier rubyid_num'>num</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_splat'>splat</span>
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_local_ary_ty'>local_ary_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_rest_ary_ty'>rest_ary_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_local_ary_ty'>local_ary_ty</span>)
    <span class='kw'>end</span>
    <span class='id identifier rubyid_lead_tys'>lead_tys</span>.<span class='id identifier rubyid_reverse_each'>reverse_each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_rest_ary_ty'>rest_ary_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_following_tys'>following_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_take_last'>take_last</span>(<span class='id identifier rubyid_num'>num</span>)
    <span class='id identifier rubyid_following_tys'>following_tys</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_splat'>splat</span>
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_local_ary_ty'>local_ary_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_rest_ary_ty'>rest_ary_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_local_ary_ty'>local_ary_ty</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="do_invoke_block-instance_method">
  <h3 class='signature '>
    #<strong>do_invoke_block</strong>(blk, aargs, ep, env, replace_recv_ty: nil, replace_cref: nil, &amp;ctn)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2223-L2232'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2223' data-end='2232'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2223</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_do_invoke_block'>do_invoke_block</span>(<span class='id identifier rubyid_blk'>blk</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='label'>replace_recv_ty:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>replace_cref:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk'>blk</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Proc.html" title="TypeProf::Type::Proc (class)">Proc</a></span>)
      <span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_block_body'>block_body</span>.<span class='id identifier rubyid_do_call'>do_call</span>(<span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>replace_recv_ty:</span> <span class='id identifier rubyid_replace_recv_ty'>replace_recv_ty</span><span class='comma'>,</span> <span class='label'>replace_cref:</span> <span class='id identifier rubyid_replace_cref'>replace_cref</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>non-proc is passed as a block</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>if</span> <span class='id identifier rubyid_blk'>blk</span> <span class='op'>!=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
      <span class='id identifier rubyid_ctn'>ctn</span>[<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>]
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="do_send-instance_method">
  <h3 class='signature '>
    #<strong>do_send</strong>(recvs, mid, aargs, ep, env, &amp;ctn)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2192-L2221'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2192' data-end='2221'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2192</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_do_send'>do_send</span>(<span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
  <span class='id identifier rubyid_recvs'>recvs</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_recv'>recv</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_recv'>recv</span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Void.html" title="TypeProf::Type::Void (class)">Void</a></span>
      <span class='id identifier rubyid_error'><a href="#error-instance_method" title="TypeProf::Scratch#error (method)">error</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>void&#39;s method is called: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>).<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_content'>#</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_mid'>mid</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
      <span class='id identifier rubyid_ctn'>ctn</span>[<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>]
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Any.html" title="TypeProf::Type::Any (class)">Any</a></span>
      <span class='id identifier rubyid_ctn'>ctn</span>[<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>]
    <span class='kw'>else</span>
      <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_include_subclasses'>include_subclasses</span> <span class='op'>=</span> <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_method_dispatch_info'>method_dispatch_info</span>
      <span class='id identifier rubyid_meths'>meths</span> <span class='op'>=</span> <span class='id identifier rubyid_get_method'><a href="#get_method-instance_method" title="TypeProf::Scratch#get_method (method)">get_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_include_subclasses'>include_subclasses</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span>) <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_meths'>meths</span>
        <span class='id identifier rubyid_meths'>meths</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_meth'>meth</span><span class='op'>|</span>
          <span class='id identifier rubyid_meth'>meth</span>.<span class='id identifier rubyid_do_send'>do_send</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_meths'>meths</span> <span class='op'>=</span> <span class='id identifier rubyid_get_method'><a href="#get_method-instance_method" title="TypeProf::Scratch#get_method (method)">get_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_include_subclasses'>include_subclasses</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_method_missing'>method_missing</span>) <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_meths'>meths</span>
          <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_for_method_missing'>for_method_missing</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Symbol.html" title="TypeProf::Type::Symbol (class)">Symbol</a></span>.<span class='id identifier rubyid_new'><a href="Type/Symbol.html#new-class_method" title="TypeProf::Type::Symbol.new (method)">new</a></span>(<span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_sym'>sym</span>])))
          <span class='id identifier rubyid_meths'>meths</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_meth'>meth</span><span class='op'>|</span>
            <span class='id identifier rubyid_meth'>meth</span>.<span class='id identifier rubyid_do_send'>do_send</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_method_missing'>method_missing</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_ctn'>ctn</span>)
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_error'><a href="#error-instance_method" title="TypeProf::Scratch#error (method)">error</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>undefined method: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>).<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_content'>#</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_mid'>mid</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
          <span class='id identifier rubyid_ctn'>ctn</span>[<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>]
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="error-instance_method">
  <h3 class='signature '>
    #<strong>error</strong>(ep, msg)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L848-L851'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='848' data-end='851'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 848</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_error'>error</span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)
  <span class='id identifier rubyid_p'>p</span> [<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_source_location'>source_location</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[error] </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_msg'>msg</span>] <span class='kw'>if</span> <span class='const'>Config</span>.<span class='id identifier rubyid_verbose'>verbose</span> <span class='op'>&gt;=</span> <span class='int'>2</span>
  <span class='ivar'>@errors</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[error] </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_msg'>msg</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_all_super_methods-instance_method">
  <h3 class='signature '>
    #<strong>get_all_super_methods</strong>(klass, singleton, current_klass, mid)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L576-L582'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='576' data-end='582'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 576</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_all_super_methods'>get_all_super_methods</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_current_klass'>current_klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span>)
  <span class='id identifier rubyid_hit'>hit</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_search_method'><a href="#search_method-instance_method" title="TypeProf::Scratch#search_method (method)">search_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mthds'>mthds</span><span class='comma'>,</span> <span class='id identifier rubyid_klass0'>klass0</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton0'>singleton0</span><span class='op'>|</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_mthds'>mthds</span><span class='comma'>,</span> <span class='id identifier rubyid_klass0'>klass0</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton0'>singleton0</span> <span class='kw'>if</span> <span class='id identifier rubyid_hit'>hit</span>
    <span class='id identifier rubyid_hit'>hit</span> <span class='op'>=</span> <span class='id identifier rubyid_klass0'>klass0</span> <span class='op'>==</span> <span class='id identifier rubyid_current_klass'>current_klass</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_array_elem_type-instance_method">
  <h3 class='signature '>
    #<strong>get_array_elem_type</strong>(env, ep, id, idx = nil)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L906-L915'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='906' data-end='915'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 906</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_array_elem_type'>get_array_elem_type</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='id identifier rubyid_get_container_elem_types'><a href="#get_container_elem_types-instance_method" title="TypeProf::Scratch#get_container_elem_types (method)">get_container_elem_types</a></span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_elems'>elems</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_elems'>elems</span>[<span class='id identifier rubyid_idx'>idx</span>] <span class='op'>||</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_idx'>idx</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_squash_or_any'>squash_or_any</span>
  <span class='kw'>else</span>
    <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_class_name-instance_method">
  <h3 class='signature '>
    #<strong>get_class_name</strong>(klass)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L491-L509'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='491' data-end='509'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 491</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_class_name'>get_class_name</span>(<span class='id identifier rubyid_klass'>klass</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>???</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_name'>name</span>
    <span class='kw'>if</span> <span class='ivar'>@namespace</span>
      <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_i'>i</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='kw'>while</span> <span class='ivar'>@namespace</span>[<span class='id identifier rubyid_i'>i</span>] <span class='op'>&amp;&amp;</span> <span class='ivar'>@namespace</span>[<span class='id identifier rubyid_i'>i</span>] <span class='op'>==</span> <span class='id identifier rubyid_path'>path</span>[<span class='id identifier rubyid_i'>i</span>]
      <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span>[<span class='id identifier rubyid_i'>i</span>]
        <span class='id identifier rubyid_path'>path</span>[<span class='id identifier rubyid_i'>i</span><span class='op'>..</span>].<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::</span><span class='tstring_end'>&quot;</span></span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_to_s'>to_s</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='comment'>#&quot;::&quot; + path.join(&quot;::&quot;)
</span>      <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_join'>join</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_constant-instance_method">
  <h3 class='signature '>
    #<strong>get_constant</strong>(klass, name)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L604-L612'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='604' data-end='612'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 604</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_constant'>get_constant</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
    <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
    <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_get_constant'>get_constant</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>else</span>
    <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_container_elem_types-instance_method">
  <h3 class='signature '>
    #<strong>get_container_elem_types</strong>(env, ep, id)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L868-L875'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='868' data-end='875'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 868</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_container_elem_types'>get_container_elem_types</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span> <span class='kw'>while</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>]
  <span class='kw'>end</span>
  <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_get_container_elem_types'>get_container_elem_types</span>(<span class='id identifier rubyid_id'>id</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_env-instance_method">
  <h3 class='signature '>
    #<strong>get_env</strong>(ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L298-L300'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='298' data-end='300'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 298</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_env'>get_env</span>(<span class='id identifier rubyid_ep'>ep</span>)
  <span class='ivar'>@ep2env</span>[<span class='id identifier rubyid_ep'>ep</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_hash_elem_type-instance_method">
  <h3 class='signature '>
    #<strong>get_hash_elem_type</strong>(env, ep, id, key_ty = nil)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L917-L925'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='917' data-end='925'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 917</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_hash_elem_type'>get_hash_elem_type</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_key_ty'>key_ty</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='id identifier rubyid_get_container_elem_types'><a href="#get_container_elem_types-instance_method" title="TypeProf::Scratch#get_container_elem_types (method)">get_container_elem_types</a></span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_elems'>elems</span>
    <span class='id identifier rubyid_elems'>elems</span>[<span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_key_ty'>key_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) <span class='op'>||</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>]
  <span class='kw'>else</span>
    <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_instance_variable-instance_method">
  <h3 class='signature '>
    #<strong>get_instance_variable</strong>(recv, var, ep, env)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1101-L1111'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1101' data-end='1111'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1101</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_instance_variable'>get_instance_variable</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
  <span class='id identifier rubyid_add_ivar_read!'><a href="#add_ivar_read!-instance_method" title="TypeProf::Scratch#add_ivar_read! (method)">add_ivar_read!</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='op'>|</span>
    <span class='id identifier rubyid_alloc_site'>alloc_site</span> <span class='op'>=</span> <span class='const'><a href="AllocationSite.html" title="TypeProf::AllocationSite (class)">AllocationSite</a></span>.<span class='id identifier rubyid_new'><a href="AllocationSite.html#new-class_method" title="TypeProf::AllocationSite.new (method)">new</a></span>(<span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_alloc_site'>alloc_site</span>)
    <span class='kw'>case</span> <span class='id identifier rubyid_ty'>ty</span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Local.html" title="TypeProf::Type::Local (class)">Local</a></span>
      <span class='ivar'>@alloc_site_to_global_id</span>[<span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_id'>id</span>] <span class='op'>=</span> [<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>] <span class='comment'># need overwrite check??
</span>    <span class='kw'>end</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_ivar-instance_method">
  <h3 class='signature '>
    #<strong>get_ivar</strong>(recv, var)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L794-L804'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='794' data-end='804'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 794</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_ivar'>get_ivar</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>)
  <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_base_type'>base_type</span> <span class='kw'>while</span> <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_base_type'>base_type</span>)

  <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>=</span> <span class='id identifier rubyid_identify_class_for_ivar'><a href="#identify_class_for_ivar-instance_method" title="TypeProf::Scratch#identify_class_for_ivar (method)">identify_class_for_ivar</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>.<span class='id identifier rubyid_to_s'>to_s</span>[<span class='int'>1</span><span class='op'>..</span>].<span class='id identifier rubyid_to_sym'>to_sym</span>) <span class='comment'># search attr_reader
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>
    <span class='kw'>return</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]<span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_method-instance_method">
  <h3 class='signature '>
    #<strong>get_method</strong>(klass, singleton, include_subclasses, mid)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L561-L574'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='561' data-end='574'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 561</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_method'>get_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_include_subclasses'>include_subclasses</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_include_subclasses'>include_subclasses</span>
    <span class='id identifier rubyid_subclasses_mthds'>subclasses_mthds</span> <span class='op'>=</span> []
    <span class='id identifier rubyid_traverse_subclasses'><a href="#traverse_subclasses-instance_method" title="TypeProf::Scratch#traverse_subclasses (method)">traverse_subclasses</a></span>(<span class='id identifier rubyid_klass'>klass</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subclass'>subclass</span><span class='op'>|</span>
      <span class='id identifier rubyid_subclass'>subclass</span>.<span class='id identifier rubyid_search_method'><a href="#search_method-instance_method" title="TypeProf::Scratch#search_method (method)">search_method</a></span>(<span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> {}) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mthds'>mthds</span><span class='comma'>,</span><span class='op'>|</span>
        <span class='id identifier rubyid_subclasses_mthds'>subclasses_mthds</span>.<span class='id identifier rubyid_concat'>concat</span>(<span class='id identifier rubyid_mthds'>mthds</span>.<span class='id identifier rubyid_to_a'>to_a</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_search_method'><a href="#search_method-instance_method" title="TypeProf::Scratch#search_method (method)">search_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span>) {<span class='op'>|</span><span class='id identifier rubyid_mthds'>mthds</span><span class='comma'>,</span><span class='op'>|</span> <span class='kw'>return</span> <span class='id identifier rubyid_subclasses_mthds'>subclasses_mthds</span> <span class='op'>+</span> <span class='id identifier rubyid_mthds'>mthds</span>.<span class='id identifier rubyid_to_a'>to_a</span> }
    <span class='kw'>return</span> <span class='id identifier rubyid_subclasses_mthds'>subclasses_mthds</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_search_method'><a href="#search_method-instance_method" title="TypeProf::Scratch#search_method (method)">search_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span>) {<span class='op'>|</span><span class='id identifier rubyid_mthds'>mthds</span><span class='comma'>,</span><span class='op'>|</span> <span class='kw'>return</span> <span class='id identifier rubyid_mthds'>mthds</span> }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_super_method-instance_method">
  <h3 class='signature '>
    #<strong>get_super_method</strong>(ctx, singleton)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L584-L602'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='584' data-end='602'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 584</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_super_method'>get_super_method</span>(<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>)
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span>
  <span class='id identifier rubyid_mid'>mid</span> <span class='op'>=</span> <span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_mid'>mid</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>class</span>
    <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>
    <span class='kw'>while</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='id identifier rubyid___root__'>__root__</span>
      <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
      <span class='id identifier rubyid_mthd'>mthd</span> <span class='op'>=</span> <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_get_method'><a href="#get_method-instance_method" title="TypeProf::Scratch#get_method (method)">get_method</a></span>(<span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>)
      <span class='kw'>return</span> <span class='id identifier rubyid_mthd'>mthd</span> <span class='kw'>if</span> <span class='id identifier rubyid_mthd'>mthd</span>
      <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># module
</span>    <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
    <span class='id identifier rubyid_mthd'>mthd</span> <span class='op'>=</span> <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_get_method'><a href="#get_method-instance_method" title="TypeProf::Scratch#get_method (method)">get_method</a></span>(<span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>)
    <span class='kw'>return</span> <span class='id identifier rubyid_mthd'>mthd</span> <span class='kw'>if</span> <span class='id identifier rubyid_mthd'>mthd</span>
  <span class='kw'>end</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="globalize_type-instance_method">
  <h3 class='signature '>
    #<strong>globalize_type</strong>(ty, env, ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1020-L1027'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1020' data-end='1027'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1020</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_globalize_type'>globalize_type</span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span> <span class='kw'>while</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>]
  <span class='kw'>end</span>
  <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_globalize'>globalize</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='const'>Config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_type_depth_limit'>type_depth_limit</span>])
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="identify_class_for_ivar-instance_method">
  <h3 class='signature '>
    #<strong>identify_class_for_ivar</strong>(recv, var)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L783-L792'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='783' data-end='792'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 783</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_identify_class_for_ivar'>identify_class_for_ivar</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>)
  <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>=</span> <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_method_dispatch_info'>method_dispatch_info</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_klass'>klass</span>
  <span class='id identifier rubyid_search_method'><a href="#search_method-instance_method" title="TypeProf::Scratch#search_method (method)">search_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mthds'>mthds</span><span class='comma'>,</span> <span class='id identifier rubyid_klass0'>klass0</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton0'>singleton0</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_mthds'>mthds</span>.<span class='id identifier rubyid_any?'>any?</span> {<span class='op'>|</span><span class='id identifier rubyid_mthd'>mthd</span><span class='op'>|</span> <span class='id identifier rubyid_mthd'>mthd</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="AttrMethodDef.html" title="TypeProf::AttrMethodDef (class)">AttrMethodDef</a></span>) }
      <span class='kw'>return</span> <span class='id identifier rubyid_klass0'>klass0</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature '>
    #<strong>inspect</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L248-L250'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='248' data-end='250'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 248</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Scratch&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="localize_type-instance_method">
  <h3 class='signature '>
    #<strong>localize_type</strong>(ty, env, ep, alloc_site = AllocationSite.new(ep))  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1029-L1042'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1029' data-end='1042'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1029</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_localize_type'>localize_type</span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_alloc_site'>alloc_site</span> <span class='op'>=</span> <span class='const'><a href="AllocationSite.html" title="TypeProf::AllocationSite (class)">AllocationSite</a></span>.<span class='id identifier rubyid_new'><a href="AllocationSite.html#new-class_method" title="TypeProf::AllocationSite.new (method)">new</a></span>(<span class='id identifier rubyid_ep'>ep</span>))
  <span class='kw'>if</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span> <span class='kw'>while</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_target_env'>target_env</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>]
    <span class='id identifier rubyid_target_env'>target_env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_localize'>localize</span>(<span class='id identifier rubyid_target_env'>target_env</span><span class='comma'>,</span> <span class='id identifier rubyid_alloc_site'>alloc_site</span><span class='comma'>,</span> <span class='const'>Config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_type_depth_limit'>type_depth_limit</span>])
    <span class='id identifier rubyid_merge_return_env'><a href="#merge_return_env-instance_method" title="TypeProf::Scratch#merge_return_env (method)">merge_return_env</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
      <span class='id identifier rubyid_env'>env</span> <span class='op'>?</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_target_env'>target_env</span>) <span class='op'>:</span> <span class='id identifier rubyid_target_env'>target_env</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_localize'>localize</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_alloc_site'>alloc_site</span><span class='comma'>,</span> <span class='const'>Config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_type_depth_limit'>type_depth_limit</span>])
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="merge_env-instance_method">
  <h3 class='signature '>
    #<strong>merge_env</strong>(ep, env)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L302-L316'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='302' data-end='316'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 302</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_merge_env'>merge_env</span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
  <span class='comment'># TODO: this is wrong; it include not only proceeds but also indirect propagation like out-of-block variable modification
</span>  <span class='comment'>#add_edge(ep, @ep)
</span>  <span class='id identifier rubyid_env2'>env2</span> <span class='op'>=</span> <span class='ivar'>@ep2env</span>[<span class='id identifier rubyid_ep'>ep</span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_env2'>env2</span>
    <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_env2'>env2</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_env'>env</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>!=</span> <span class='id identifier rubyid_env2'>env2</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@worklist</span>.<span class='id identifier rubyid_member?'>member?</span>(<span class='id identifier rubyid_ep'>ep</span>)
      <span class='ivar'>@worklist</span>.<span class='id identifier rubyid_insert'>insert</span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='kw'>end</span>
    <span class='ivar'>@ep2env</span>[<span class='id identifier rubyid_ep'>ep</span>] <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>
  <span class='kw'>else</span>
    <span class='ivar'>@worklist</span>.<span class='id identifier rubyid_insert'>insert</span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='ivar'>@ep2env</span>[<span class='id identifier rubyid_ep'>ep</span>] <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="merge_return_env-instance_method">
  <h3 class='signature '>
    #<strong>merge_return_env</strong>(caller_ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L717-L719'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='717' data-end='719'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 717</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_merge_return_env'>merge_return_env</span>(<span class='id identifier rubyid_caller_ep'>caller_ep</span>)
  <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_caller_ep'>caller_ep</span>] <span class='op'>=</span> <span class='kw'>yield</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_caller_ep'>caller_ep</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="mix_module-instance_method">
  <h3 class='signature '>
    #<strong>mix_module</strong>(kind, mixing_mod, mixed_mod, type_args, singleton, caller_ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L427-L441'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='427' data-end='441'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 427</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_mix_module'>mix_module</span>(<span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_mixing_mod'>mixing_mod</span><span class='comma'>,</span> <span class='id identifier rubyid_mixed_mod'>mixed_mod</span><span class='comma'>,</span> <span class='id identifier rubyid_type_args'>type_args</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_caller_ep'>caller_ep</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_mixed_mod'>mixed_mod</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>

  <span class='id identifier rubyid_mixing_mod'>mixing_mod</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_mixing_mod'>mixing_mod</span>.<span class='id identifier rubyid_idx'>idx</span>]
  <span class='id identifier rubyid_mixed_mod'>mixed_mod</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mixed_mod'>mixed_mod</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_mixed_mod'>mixed_mod</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
      <span class='id identifier rubyid_mixed_mod'>mixed_mod</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_mixed_mod'>mixed_mod</span>.<span class='id identifier rubyid_idx'>idx</span>]
      <span class='kw'>if</span> <span class='id identifier rubyid_mixed_mod'>mixed_mod</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_mixed_mod'>mixed_mod</span>.<span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>module</span>
        <span class='id identifier rubyid_mixing_mod'>mixing_mod</span>.<span class='id identifier rubyid_mix_module'>mix_module</span>(<span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_mixed_mod'>mixed_mod</span><span class='comma'>,</span> <span class='id identifier rubyid_type_args'>type_args</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_caller_ep'>caller_ep</span> <span class='op'>?</span> <span class='id identifier rubyid_caller_ep'>caller_ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_absolute_path'>absolute_path</span> <span class='op'>:</span> <span class='kw'>nil</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_caller_ep'>caller_ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attempted to </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>include/extend</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>prepend</span><span class='tstring_end'>&quot;</span></span> <span class='embexpr_end'>}</span><span class='tstring_content'> non-module; ignored</span><span class='tstring_end'>&quot;</span></span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="new_class-instance_method">
  <h3 class='signature '>
    #<strong>new_class</strong>(cbase, name, type_params, superclass, absolute_path)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L447-L466'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='447' data-end='466'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 447</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_new_class'>new_class</span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_type_params'>type_params</span><span class='comma'>,</span> <span class='id identifier rubyid_superclass'>superclass</span><span class='comma'>,</span> <span class='id identifier rubyid_absolute_path'>absolute_path</span>)
  <span class='id identifier rubyid_show_name'>show_name</span> <span class='op'>=</span> <span class='id identifier rubyid_cbase_path'><a href="#cbase_path-instance_method" title="TypeProf::Scratch#cbase_path (method)">cbase_path</a></span>(<span class='id identifier rubyid_cbase'>cbase</span>) <span class='op'>+</span> [<span class='id identifier rubyid_name'>name</span>]
  <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>.<span class='id identifier rubyid_size'>size</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_superclass'>superclass</span>
    <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_idx'>idx</span>] <span class='op'>=</span> <span class='const'><a href="Scratch/ClassDef.html" title="TypeProf::Scratch::ClassDef (class)">ClassDef</a></span>.<span class='id identifier rubyid_new'><a href="Scratch/ClassDef.html#new-class_method" title="TypeProf::Scratch::ClassDef.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='kw'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_show_name'>show_name</span><span class='comma'>,</span> <span class='id identifier rubyid_absolute_path'>absolute_path</span>)
    <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_subclasses'>subclasses</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_idx'>idx</span> <span class='kw'>unless</span> <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid___root__'>__root__</span>
    <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>.<span class='id identifier rubyid_new'><a href="Type/Class.html#new-class_method" title="TypeProf::Type::Class.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='kw'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> <span class='id identifier rubyid_type_params'>type_params</span><span class='comma'>,</span> <span class='id identifier rubyid_superclass'>superclass</span><span class='comma'>,</span> <span class='id identifier rubyid_show_name'>show_name</span>)
    <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_klass_obj'>klass_obj</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>
    <span class='id identifier rubyid_cbase'>cbase</span> <span class='op'>||=</span> <span class='id identifier rubyid_klass'>klass</span> <span class='comment'># for bootstrap
</span>    <span class='id identifier rubyid_add_constant'><a href="#add_constant-instance_method" title="TypeProf::Scratch#add_constant (method)">add_constant</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_absolute_path'>absolute_path</span>)
    <span class='kw'>return</span> <span class='id identifier rubyid_klass'>klass</span>
  <span class='kw'>else</span>
    <span class='comment'># module
</span>    <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_idx'>idx</span>] <span class='op'>=</span> <span class='const'><a href="Scratch/ClassDef.html" title="TypeProf::Scratch::ClassDef (class)">ClassDef</a></span>.<span class='id identifier rubyid_new'><a href="Scratch/ClassDef.html#new-class_method" title="TypeProf::Scratch::ClassDef.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='kw'>module</span><span class='comma'>,</span> <span class='id identifier rubyid_show_name'>show_name</span><span class='comma'>,</span> <span class='id identifier rubyid_absolute_path'>absolute_path</span>)
    <span class='id identifier rubyid_mod'>mod</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>.<span class='id identifier rubyid_new'><a href="Type/Class.html#new-class_method" title="TypeProf::Type::Class.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='kw'>module</span><span class='comma'>,</span> <span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> <span class='id identifier rubyid_type_params'>type_params</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_show_name'>show_name</span>)
    <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_klass_obj'>klass_obj</span> <span class='op'>=</span> <span class='id identifier rubyid_mod'>mod</span>
    <span class='id identifier rubyid_add_constant'><a href="#add_constant-instance_method" title="TypeProf::Scratch#add_constant (method)">add_constant</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span><span class='comma'>,</span> <span class='id identifier rubyid_absolute_path'>absolute_path</span>)
    <span class='kw'>return</span> <span class='id identifier rubyid_mod'>mod</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="new_struct-instance_method">
  <h3 class='signature '>
    #<strong>new_struct</strong>(ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L472-L487'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='472' data-end='487'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 472</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_new_struct'>new_struct</span>(<span class='id identifier rubyid_ep'>ep</span>)
  <span class='kw'>return</span> <span class='ivar'>@struct_defs</span>[<span class='id identifier rubyid_ep'>ep</span>] <span class='kw'>if</span> <span class='ivar'>@struct_defs</span>[<span class='id identifier rubyid_ep'>ep</span>]

  <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>.<span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_struct'>struct</span>]
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AnonymousStruct_generated_</span><span class='embexpr_beg'>#{</span> <span class='ivar'>@anonymous_struct_gen_id</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_idx'>idx</span>] <span class='op'>=</span> <span class='const'><a href="Scratch/ClassDef.html" title="TypeProf::Scratch::ClassDef (class)">ClassDef</a></span>.<span class='id identifier rubyid_new'><a href="Scratch/ClassDef.html#new-class_method" title="TypeProf::Scratch::ClassDef.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='kw'>class</span><span class='comma'>,</span> [<span class='id identifier rubyid_name'>name</span>]<span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_absolute_path'>absolute_path</span>)
  <span class='comment'>#@class_defs[superclass.idx].subclasses &lt;&lt; idx # needed?
</span>  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>.<span class='id identifier rubyid_new'><a href="Type/Class.html#new-class_method" title="TypeProf::Type::Class.new (method)">new</a></span>(<span class='symbeg'>:</span><span class='kw'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> []<span class='comma'>,</span> <span class='id identifier rubyid_superclass'>superclass</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_add_superclass_type_args!'><a href="#add_superclass_type_args!-instance_method" title="TypeProf::Scratch#add_superclass_type_args! (method)">add_superclass_type_args!</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> [<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>])
  <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_klass_obj'>klass_obj</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>

  <span class='ivar'>@struct_defs</span>[<span class='id identifier rubyid_ep'>ep</span>] <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>

  <span class='id identifier rubyid_klass'>klass</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pend_block_dummy_execution-instance_method">
  <h3 class='signature '>
    #<strong>pend_block_dummy_execution</strong>(blk, iseq, nep, nenv)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1088-L1099'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1088' data-end='1099'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1088</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pend_block_dummy_execution'>pend_block_dummy_execution</span>(<span class='id identifier rubyid_blk'>blk</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_nep'>nep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
  <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>] <span class='op'>||=</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> [<span class='id identifier rubyid_blk'>blk</span><span class='comma'>,</span> {}]]
  <span class='kw'>if</span> <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>][<span class='int'>0</span>] <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_block'>block</span>
    <span class='kw'>if</span> <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>][<span class='int'>1</span>][<span class='int'>1</span>][<span class='id identifier rubyid_nep'>nep</span>]
      <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>][<span class='int'>1</span>][<span class='int'>1</span>][<span class='id identifier rubyid_nep'>nep</span>] <span class='op'>=</span> <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>][<span class='int'>1</span>][<span class='int'>1</span>][<span class='id identifier rubyid_nep'>nep</span>].<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='kw'>else</span>
      <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>][<span class='int'>1</span>][<span class='int'>1</span>][<span class='id identifier rubyid_nep'>nep</span>] <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># XXX: what to do?
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pend_method_execution-instance_method">
  <h3 class='signature '>
    #<strong>pend_method_execution</strong>(iseq, meth, recv, mid, cref, ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1044-L1086'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1044' data-end='1086'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1044</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pend_method_execution'>pend_method_execution</span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='id identifier rubyid_ctx'>ctx</span> <span class='op'>=</span> <span class='const'><a href="Context.html" title="TypeProf::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Context.html#new-class_method" title="TypeProf::Context.new (method)">new</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span>)
  <span class='id identifier rubyid_ep'>ep</span> <span class='op'>=</span> <span class='const'><a href="ExecutionPoint.html" title="TypeProf::ExecutionPoint (class)">ExecutionPoint</a></span>.<span class='id identifier rubyid_new'><a href="ExecutionPoint.html#new-class_method" title="TypeProf::ExecutionPoint.new (method)">new</a></span>(<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='id identifier rubyid_locals'>locals</span> <span class='op'>=</span> [<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>] <span class='op'>*</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_locals'>locals</span>.<span class='id identifier rubyid_size'>size</span>

  <span class='id identifier rubyid_fargs_format'>fargs_format</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>
  <span class='id identifier rubyid_lead_num'>lead_num</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_lead_num'>lead_num</span>] <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_post_num'>post_num</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_post_num'>post_num</span>] <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_post_index'>post_index</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_post_start'>post_start</span>]
  <span class='id identifier rubyid_rest_index'>rest_index</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_rest_start'>rest_start</span>]
  <span class='id identifier rubyid_keyword'>keyword</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_keyword'>keyword</span>]
  <span class='id identifier rubyid_kw_index'>kw_index</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_kwbits'>kwbits</span>] <span class='op'>-</span> <span class='id identifier rubyid_keyword'>keyword</span>.<span class='id identifier rubyid_size'>size</span> <span class='kw'>if</span> <span class='id identifier rubyid_keyword'>keyword</span>
  <span class='id identifier rubyid_kwrest_index'>kwrest_index</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_kwrest'>kwrest</span>]
  <span class='id identifier rubyid_block_index'>block_index</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_block_start'>block_start</span>]
  <span class='id identifier rubyid_opt'>opt</span> <span class='op'>=</span> <span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_opt'>opt</span>] <span class='op'>||</span> [<span class='int'>0</span>]

  (<span class='id identifier rubyid_lead_num'>lead_num</span> <span class='op'>+</span> <span class='id identifier rubyid_opt'>opt</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span>).<span class='id identifier rubyid_times'>times</span> {<span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_i'>i</span>] <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> }
  <span class='id identifier rubyid_post_num'>post_num</span>.<span class='id identifier rubyid_times'>times</span> {<span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_i'>i</span> <span class='op'>+</span> <span class='id identifier rubyid_post_index'>post_index</span>] <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> } <span class='kw'>if</span> <span class='id identifier rubyid_post_index'>post_index</span>
  <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_rest_index'>rest_index</span>] <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_rest_index'>rest_index</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_keyword'>keyword</span>
    <span class='id identifier rubyid_keyword'>keyword</span>.<span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_kw'>kw</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
      <span class='kw'>case</span>
      <span class='kw'>when</span> <span class='id identifier rubyid_kw'>kw</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Symbol</span>) <span class='comment'># required keyword
</span>        <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_kw_index'>kw_index</span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span>] <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
      <span class='kw'>when</span> <span class='id identifier rubyid_kw'>kw</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>2</span> <span class='comment'># optional keyword (default value is a literal)
</span>        <span class='id identifier rubyid__key'>_key</span><span class='comma'>,</span> <span class='id identifier rubyid_default_ty'>default_ty</span> <span class='op'>=</span> <span class='op'>*</span><span class='id identifier rubyid_kw'>kw</span>
        <span class='id identifier rubyid_default_ty'>default_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_guess_literal_type'><a href="Type.html#guess_literal_type-class_method" title="TypeProf::Type.guess_literal_type (method)">guess_literal_type</a></span>(<span class='id identifier rubyid_default_ty'>default_ty</span>)
        <span class='id identifier rubyid_default_ty'>default_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_default_ty'>default_ty</span>.<span class='id identifier rubyid_base_type'>base_type</span> <span class='kw'>if</span> <span class='id identifier rubyid_default_ty'>default_ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Literal.html" title="TypeProf::Type::Literal (class)">Literal</a></span>)
        <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_kw_index'>kw_index</span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span>] <span class='op'>=</span> <span class='id identifier rubyid_default_ty'>default_ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>)
      <span class='kw'>else</span> <span class='comment'># optional keyword (default value is an expression)
</span>        <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_kw_index'>kw_index</span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span>] <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_kwrest_index'>kwrest_index</span>] <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_kwrest_index'>kwrest_index</span>
  <span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_block_index'>block_index</span>] <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_block_index'>block_index</span>

  <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='const'><a href="Env.html" title="TypeProf::Env (class)">Env</a></span>.<span class='id identifier rubyid_new'><a href="Env.html#new-class_method" title="TypeProf::Env.new (method)">new</a></span>(<span class='const'><a href="StaticEnv.html" title="TypeProf::StaticEnv (class)">StaticEnv</a></span>.<span class='id identifier rubyid_new'><a href="StaticEnv.html#new-class_method" title="TypeProf::StaticEnv.new (method)">new</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>true</span>)<span class='comma'>,</span> <span class='id identifier rubyid_locals'>locals</span><span class='comma'>,</span> []<span class='comma'>,</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/HashWrapper.html" title="TypeProf::Utils::HashWrapper (class)">HashWrapper</a></span>.<span class='id identifier rubyid_new'><a href="Utils/HashWrapper.html#new-class_method" title="TypeProf::Utils::HashWrapper.new (method)">new</a></span>({}))

  <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>] <span class='op'>||</span> <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>][<span class='int'>0</span>] <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_block'>block</span>
    <span class='ivar'>@pending_execution</span>[<span class='id identifier rubyid_iseq'>iseq</span>] <span class='op'>=</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> [<span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>]]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="report-instance_method">
  <h3 class='signature '>
    #<strong>report</strong>(stat_eps, output)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1008-L1018'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1008' data-end='1018'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1008</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_report'>report</span>(<span class='id identifier rubyid_stat_eps'>stat_eps</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span>)
  <span class='const'><a href="Reporters.html" title="TypeProf::Reporters (module)">Reporters</a></span>.<span class='id identifier rubyid_show_message'><a href="Reporters.html#show_message-class_method" title="TypeProf::Reporters.show_message (method)">show_message</a></span>(<span class='ivar'>@terminated</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span>)

  <span class='const'><a href="Reporters.html" title="TypeProf::Reporters (module)">Reporters</a></span>.<span class='id identifier rubyid_show_error'><a href="Reporters.html#show_error-class_method" title="TypeProf::Reporters.show_error (method)">show_error</a></span>(<span class='ivar'>@errors</span><span class='comma'>,</span> <span class='ivar'>@backward_edges</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span>)

  <span class='const'><a href="Reporters.html" title="TypeProf::Reporters (module)">Reporters</a></span>.<span class='id identifier rubyid_show_reveal_types'><a href="Reporters.html#show_reveal_types-class_method" title="TypeProf::Reporters.show_reveal_types (method)">show_reveal_types</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@reveal_types</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span>)

  <span class='const'><a href="Reporters.html" title="TypeProf::Reporters (module)">Reporters</a></span>.<span class='id identifier rubyid_show_gvars'><a href="Reporters.html#show_gvars-class_method" title="TypeProf::Reporters.show_gvars (method)">show_gvars</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@gvar_table</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span>)

  <span class='const'><a href="RubySignatureExporter.html" title="TypeProf::RubySignatureExporter (class)">RubySignatureExporter</a></span>.<span class='id identifier rubyid_new'><a href="RubySignatureExporter.html#new-class_method" title="TypeProf::RubySignatureExporter.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@class_defs</span><span class='comma'>,</span> <span class='ivar'>@iseq_method_to_ctxs</span>).<span class='id identifier rubyid_show'><a href="RubySignatureExporter.html#show-instance_method" title="TypeProf::RubySignatureExporter#show (method)">show</a></span>(<span class='id identifier rubyid_stat_eps'>stat_eps</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reveal_type-instance_method">
  <h3 class='signature '>
    #<strong>reveal_type</strong>(ep, ty)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L858-L866'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='858' data-end='866'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 858</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reveal_type'>reveal_type</span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>)
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_source_location'>source_location</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reveal:</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_source_location'>source_location</span> <span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>Config</span>.<span class='id identifier rubyid_verbose'>verbose</span> <span class='op'>&gt;=</span> <span class='int'>2</span>
  <span class='kw'>if</span> <span class='ivar'>@reveal_types</span>[<span class='id identifier rubyid_key'>key</span>]
    <span class='ivar'>@reveal_types</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> <span class='ivar'>@reveal_types</span>[<span class='id identifier rubyid_key'>key</span>].<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>else</span>
    <span class='ivar'>@reveal_types</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="search_constant-instance_method">
  <h3 class='signature '>
    #<strong>search_constant</strong>(cref, name)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L614-L622'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='614' data-end='622'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 614</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_search_constant'>search_constant</span>(<span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>while</span> <span class='id identifier rubyid_cref'>cref</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_bottom'>bottom</span>
    <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_get_constant'><a href="#get_constant-instance_method" title="TypeProf::Scratch#get_constant (method)">get_constant</a></span>(<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
    <span class='kw'>return</span> <span class='id identifier rubyid_val'>val</span> <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>!=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
    <span class='id identifier rubyid_cref'>cref</span> <span class='op'>=</span> <span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_outer'>outer</span>
  <span class='kw'>end</span>

  <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="search_method-instance_method">
  <h3 class='signature '>
    #<strong>search_method</strong>(klass, singleton, mid, &amp;blk)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L542-L559'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='542' data-end='559'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 542</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_search_method'>search_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='comment'># XXX: support method alias correctly
</span>  <span class='id identifier rubyid_klass_orig'>klass_orig</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>class</span>
    <span class='kw'>while</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='id identifier rubyid___root__'>__root__</span>
      <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
      <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_search_method'>search_method</span>(<span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
      <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_superclass'>superclass</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># module
</span>    <span class='id identifier rubyid_class_def'>class_def</span> <span class='op'>=</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>]
    <span class='id identifier rubyid_class_def'>class_def</span>.<span class='id identifier rubyid_search_method'>search_method</span>(<span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_singleton'>singleton</span>
    <span class='id identifier rubyid_search_method'>search_method</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='id identifier rubyid_klass_orig'>klass_orig</span>.<span class='id identifier rubyid_kind'>kind</span>]<span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_custom_method-instance_method">
  <h3 class='signature '>
    #<strong>set_custom_method</strong>(klass, mid, impl, pub_meth = true)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L661-L663'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='661' data-end='663'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 661</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_custom_method'>set_custom_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_impl'>impl</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span> <span class='op'>=</span> <span class='kw'>true</span>)
  <span class='id identifier rubyid_set_method'><a href="#set_method-instance_method" title="TypeProf::Scratch#set_method (method)">set_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='const'><a href="CustomMethodDef.html" title="TypeProf::CustomMethodDef (class)">CustomMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="CustomMethodDef.html#new-class_method" title="TypeProf::CustomMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_impl'>impl</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_instance_variable-instance_method">
  <h3 class='signature '>
    #<strong>set_instance_variable</strong>(recv, var, ty, ep, env)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1113-L1116'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1113' data-end='1116'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1113</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_instance_variable'>set_instance_variable</span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
  <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='id identifier rubyid_add_ivar_write!'><a href="#add_ivar_write!-instance_method" title="TypeProf::Scratch#add_ivar_write! (method)">add_ivar_write!</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_method-instance_method">
  <h3 class='signature '>
    #<strong>set_method</strong>(klass, mid, singleton, mdef)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L639-L642'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='639' data-end='642'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 639</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_method'>set_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mdef'>mdef</span>)
  <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_set_method'>set_method</span>(<span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_mdef'>mdef</span>)
  <span class='id identifier rubyid_mdef'>mdef</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_singleton_custom_method-instance_method">
  <h3 class='signature '>
    #<strong>set_singleton_custom_method</strong>(klass, mid, impl, pub_meth = true)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L665-L667'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='665' data-end='667'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 665</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_singleton_custom_method'>set_singleton_custom_method</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_impl'>impl</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span> <span class='op'>=</span> <span class='kw'>true</span>)
  <span class='id identifier rubyid_set_method'><a href="#set_method-instance_method" title="TypeProf::Scratch#set_method (method)">set_method</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='const'><a href="CustomMethodDef.html" title="TypeProf::CustomMethodDef (class)">CustomMethodDef</a></span>.<span class='id identifier rubyid_new'><a href="CustomMethodDef.html#new-class_method" title="TypeProf::CustomMethodDef.new (method)">new</a></span>(<span class='id identifier rubyid_impl'>impl</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_meth'>pub_meth</span>))
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="setup_actual_arguments-instance_method">
  <h3 class='signature priv'>
    #<strong>setup_actual_arguments</strong>(kind, operands, ep, env)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2043-L2190'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2043' data-end='2190'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2043</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_private'>private</span> <span class='kw'>def</span> <span class='id identifier rubyid_setup_actual_arguments'>setup_actual_arguments</span>(<span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_operands'>operands</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
  <span class='id identifier rubyid_opt'>opt</span><span class='comma'>,</span> <span class='id identifier rubyid_blk_iseq'>blk_iseq</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
  <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='id identifier rubyid_opt'>opt</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_flag'>flag</span>]
  <span class='id identifier rubyid_mid'>mid</span> <span class='op'>=</span> <span class='id identifier rubyid_opt'>opt</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_mid'>mid</span>]
  <span class='id identifier rubyid_kw_arg'>kw_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_opt'>opt</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_kw_arg'>kw_arg</span>]
  <span class='id identifier rubyid_argc'>argc</span> <span class='op'>=</span> <span class='id identifier rubyid_opt'>opt</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_orig_argc'>orig_argc</span>]
  <span class='id identifier rubyid_argc'>argc</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='kw'>if</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span> <span class='comment'># for the receiver
</span>  <span class='id identifier rubyid_argc'>argc</span> <span class='op'>+=</span> <span class='id identifier rubyid_kw_arg'>kw_arg</span>.<span class='id identifier rubyid_size'>size</span> <span class='kw'>if</span> <span class='id identifier rubyid_kw_arg'>kw_arg</span>

  <span class='id identifier rubyid_flag_args_splat'>flag_args_splat</span>    <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>0</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_flag_args_blockarg'>flag_args_blockarg</span> <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>1</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid__flag_args_fcall'>_flag_args_fcall</span>   <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>2</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid__flag_args_vcall'>_flag_args_vcall</span>   <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>3</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid__flag_args_simple'>_flag_args_simple</span>  <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>4</span>] <span class='op'>!=</span> <span class='int'>0</span> <span class='comment'># unused in TP
</span>  <span class='id identifier rubyid__flag_blockiseq'>_flag_blockiseq</span>    <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>5</span>] <span class='op'>!=</span> <span class='int'>0</span> <span class='comment'># unused in VM :-)
</span>  <span class='id identifier rubyid_flag_args_kwarg'>flag_args_kwarg</span>    <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>6</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_flag_args_kw_splat'>flag_args_kw_splat</span> <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>7</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid__flag_tailcall'>_flag_tailcall</span>     <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>8</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid__flag_super'>_flag_super</span>        <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[ <span class='int'>9</span>] <span class='op'>!=</span> <span class='int'>0</span>
  <span class='id identifier rubyid__flag_zsuper'>_flag_zsuper</span>       <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>[<span class='int'>10</span>] <span class='op'>!=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_argc'>argc</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='kw'>if</span> <span class='id identifier rubyid_flag_args_blockarg'>flag_args_blockarg</span>

  <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_argc'>argc</span>)

  <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_shift'>shift</span> <span class='kw'>if</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_flag_args_blockarg'>flag_args_blockarg</span>
    <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_pop'>pop</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_blk_iseq'>blk_iseq</span>
    <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Proc.html" title="TypeProf::Type::Proc (class)">Proc</a></span>.<span class='id identifier rubyid_new'><a href="Type/Proc.html#new-class_method" title="TypeProf::Type::Proc.new (method)">new</a></span>(<span class='const'><a href="ISeqBlock.html" title="TypeProf::ISeqBlock (class)">ISeqBlock</a></span>.<span class='id identifier rubyid_new'><a href="ISeqBlock.html#new-class_method" title="TypeProf::ISeqBlock.new (method)">new</a></span>(<span class='id identifier rubyid_blk_iseq'>blk_iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_proc'>proc</span>]))
  <span class='kw'>else</span>
    <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_new_blk_ty'>new_blk_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
  <span class='id identifier rubyid_blk_ty'>blk_ty</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk_ty'>blk_ty</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_blk_ty'>blk_ty</span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Proc.html" title="TypeProf::Type::Proc (class)">Proc</a></span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Symbol.html" title="TypeProf::Type::Symbol (class)">Symbol</a></span>
      <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Proc.html" title="TypeProf::Type::Proc (class)">Proc</a></span>.<span class='id identifier rubyid_new'><a href="Type/Proc.html#new-class_method" title="TypeProf::Type::Proc.new (method)">new</a></span>(<span class='const'><a href="SymbolBlock.html" title="TypeProf::SymbolBlock (class)">SymbolBlock</a></span>.<span class='id identifier rubyid_new'><a href="SymbolBlock.html#new-class_method" title="TypeProf::SymbolBlock.new (method)">new</a></span>(<span class='id identifier rubyid_blk_ty'>blk_ty</span>.<span class='id identifier rubyid_sym'>sym</span>)<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_proc'>proc</span>]))
    <span class='kw'>else</span>
      <span class='comment'># XXX: attempt to call to_proc
</span>      <span class='id identifier rubyid_error'><a href="#error-instance_method" title="TypeProf::Scratch#error (method)">error</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wrong argument type </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_blk_ty'>blk_ty</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_content'> (expected Proc)</span><span class='tstring_end'>&quot;</span></span>)
      <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_new_blk_ty'>new_blk_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_new_blk_ty'>new_blk_ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_blk_ty'>blk_ty</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_new_blk_ty'>new_blk_ty</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_flag_args_splat'>flag_args_splat</span>
    <span class='comment'># assert !flag_args_kwarg
</span>    <span class='id identifier rubyid_rest_ty'>rest_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_last'>last</span>
    <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>[<span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span>]
    <span class='kw'>if</span> <span class='id identifier rubyid_flag_args_kw_splat'>flag_args_kw_splat</span>
      <span class='comment'># XXX: The types contained in ActualArguments are expected to be all local types.
</span>      <span class='comment'># This &quot;globalize_type&quot; breaks the invariant, and violates the assertion of Union#globalize that asserts @elems be nil.
</span>      <span class='comment'># To fix this issue fundamentally, ActualArguments should keep all arguments as-is (as like the VM does),
</span>      <span class='comment'># and globalize some types on the on-demand bases.
</span>      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_rest_ty'>rest_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='kw'>if</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span>)
        <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_take_last'>take_last</span>(<span class='int'>1</span>)
        <span class='kw'>case</span> <span class='id identifier rubyid_ty'>ty</span>
        <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Hash.html" title="TypeProf::Type::Hash (class)">Hash</a></span>
          <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_to_keywords'>to_keywords</span>
        <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Union.html" title="TypeProf::Type::Union (class)">Union</a></span>
          <span class='id identifier rubyid_hash_elems'>hash_elems</span> <span class='op'>=</span> <span class='kw'>nil</span>
          <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_elems'>elems</span><span class='op'>&amp;.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span>(<span class='id identifier rubyid_container_kind'>container_kind</span><span class='comma'>,</span> <span class='id identifier rubyid_base_type'>base_type</span>)<span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span><span class='op'>|</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_container_kind'>container_kind</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Hash.html" title="TypeProf::Type::Hash (class)">Hash</a></span>
              <span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_to_keywords'>to_keywords</span>
              <span class='id identifier rubyid_hash_elems'>hash_elems</span> <span class='op'>=</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span> <span class='op'>?</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span>.<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_elems'>elems</span>) <span class='op'>:</span> <span class='id identifier rubyid_elems'>elems</span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span>
            <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span>.<span class='id identifier rubyid_to_keywords'>to_keywords</span>
          <span class='kw'>else</span>
            <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> { <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> }
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>non hash is passed to **kwarg?</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>unless</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
          <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> { <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> }
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> {}
    <span class='kw'>end</span>
    <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='const'><a href="ActualArguments.html" title="TypeProf::ActualArguments (class)">ActualArguments</a></span>.<span class='id identifier rubyid_new'><a href="ActualArguments.html#new-class_method" title="TypeProf::ActualArguments.new (method)">new</a></span>(<span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_rest_ty'>rest_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_kw_tys'>kw_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_blk_ty'>blk_ty</span>)
  <span class='kw'>elsif</span> <span class='id identifier rubyid_flag_args_kw_splat'>flag_args_kw_splat</span>
    <span class='id identifier rubyid_last'>last</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_last'>last</span>
    <span class='comment'># XXX: The types contained in ActualArguments are expected to be all local types.
</span>    <span class='comment'># This &quot;globalize_type&quot; breaks the invariant, and violates the assertion of Union#globalize that asserts @elems be nil.
</span>    <span class='comment'># To fix this issue fundamentally, ActualArguments should keep all arguments as-is (as like the VM does),
</span>    <span class='comment'># and globalize some types on the on-demand bases.
</span>    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_last'>last</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='kw'>case</span> <span class='id identifier rubyid_ty'>ty</span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Hash.html" title="TypeProf::Type::Hash (class)">Hash</a></span>
      <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>[<span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span>]
      <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_to_keywords'>to_keywords</span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Union.html" title="TypeProf::Type::Union (class)">Union</a></span>
      <span class='id identifier rubyid_hash_elems'>hash_elems</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_elems'>elems</span><span class='op'>&amp;.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span>(<span class='id identifier rubyid_container_kind'>container_kind</span><span class='comma'>,</span> <span class='id identifier rubyid_base_type'>base_type</span>)<span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_container_kind'>container_kind</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Hash.html" title="TypeProf::Type::Hash (class)">Hash</a></span>
          <span class='id identifier rubyid_hash_elems'>hash_elems</span> <span class='op'>=</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span> <span class='op'>?</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span>.<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_elems'>elems</span>) <span class='op'>:</span> <span class='id identifier rubyid_elems'>elems</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span>
        <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_hash_elems'>hash_elems</span>.<span class='id identifier rubyid_to_keywords'>to_keywords</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> { <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> }
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Any.html" title="TypeProf::Type::Any (class)">Any</a></span>
      <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>[<span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span>]
      <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> { <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> }
    <span class='kw'>else</span>
      <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>non hash is passed to **kwarg?</span><span class='tstring_end'>&quot;</span></span>)
      <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> { <span class='kw'>nil</span> <span class='op'>=&gt;</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> }
    <span class='kw'>end</span>
    <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='const'><a href="ActualArguments.html" title="TypeProf::ActualArguments (class)">ActualArguments</a></span>.<span class='id identifier rubyid_new'><a href="ActualArguments.html#new-class_method" title="TypeProf::ActualArguments.new (method)">new</a></span>(<span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_kw_tys'>kw_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_blk_ty'>blk_ty</span>)
  <span class='kw'>elsif</span> <span class='id identifier rubyid_flag_args_kwarg'>flag_args_kwarg</span>
    <span class='id identifier rubyid_kw_vals'>kw_vals</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_kw_arg'>kw_arg</span>.<span class='id identifier rubyid_size'>size</span>)

    <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> {}
    <span class='id identifier rubyid_kw_arg'>kw_arg</span>.<span class='id identifier rubyid_zip'>zip</span>(<span class='id identifier rubyid_kw_vals'>kw_vals</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_v_ty'>v_ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_kw_tys'>kw_tys</span>[<span class='id identifier rubyid_key'>key</span>] <span class='op'>=</span> <span class='id identifier rubyid_v_ty'>v_ty</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='const'><a href="ActualArguments.html" title="TypeProf::ActualArguments (class)">ActualArguments</a></span>.<span class='id identifier rubyid_new'><a href="ActualArguments.html#new-class_method" title="TypeProf::ActualArguments.new (method)">new</a></span>(<span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_kw_tys'>kw_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_blk_ty'>blk_ty</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='const'><a href="ActualArguments.html" title="TypeProf::ActualArguments (class)">ActualArguments</a></span>.<span class='id identifier rubyid_new'><a href="ActualArguments.html#new-class_method" title="TypeProf::ActualArguments.new (method)">new</a></span>(<span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_blk_ty'>blk_ty</span>)
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_blk_iseq'>blk_iseq</span>
    <span class='comment'># pending dummy execution
</span>    <span class='id identifier rubyid_nctx'>nctx</span> <span class='op'>=</span> <span class='const'><a href="Context.html" title="TypeProf::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Context.html#new-class_method" title="TypeProf::Context.new (method)">new</a></span>(<span class='id identifier rubyid_blk_iseq'>blk_iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_mid'>mid</span>)
    <span class='id identifier rubyid_nep'>nep</span> <span class='op'>=</span> <span class='const'><a href="ExecutionPoint.html" title="TypeProf::ExecutionPoint (class)">ExecutionPoint</a></span>.<span class='id identifier rubyid_new'><a href="ExecutionPoint.html#new-class_method" title="TypeProf::ExecutionPoint.new (method)">new</a></span>(<span class='id identifier rubyid_nctx'>nctx</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_nlocals'>nlocals</span> <span class='op'>=</span> [<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>] <span class='op'>*</span> <span class='id identifier rubyid_blk_iseq'>blk_iseq</span>.<span class='id identifier rubyid_locals'>locals</span>.<span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_nsenv'>nsenv</span> <span class='op'>=</span> <span class='const'><a href="StaticEnv.html" title="TypeProf::StaticEnv (class)">StaticEnv</a></span>.<span class='id identifier rubyid_new'><a href="StaticEnv.html#new-class_method" title="TypeProf::StaticEnv.new (method)">new</a></span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_recv_ty'>recv_ty</span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_mod_func'>mod_func</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_pub_meth'>pub_meth</span>)
    <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='const'><a href="Env.html" title="TypeProf::Env (class)">Env</a></span>.<span class='id identifier rubyid_new'><a href="Env.html#new-class_method" title="TypeProf::Env.new (method)">new</a></span>(<span class='id identifier rubyid_nsenv'>nsenv</span><span class='comma'>,</span> <span class='id identifier rubyid_nlocals'>nlocals</span><span class='comma'>,</span> []<span class='comma'>,</span> <span class='kw'>nil</span>)
    <span class='id identifier rubyid_pend_block_dummy_execution'><a href="#pend_block_dummy_execution-instance_method" title="TypeProf::Scratch#pend_block_dummy_execution (method)">pend_block_dummy_execution</a></span>(<span class='id identifier rubyid_blk_ty'>blk_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_blk_iseq'>blk_iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_nep'>nep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='id identifier rubyid_merge_return_env'><a href="#merge_return_env-instance_method" title="TypeProf::Scratch#merge_return_env (method)">merge_return_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>) {<span class='op'>|</span><span class='id identifier rubyid_tenv'>tenv</span><span class='op'>|</span> <span class='id identifier rubyid_tenv'>tenv</span> <span class='op'>?</span> <span class='id identifier rubyid_tenv'>tenv</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_env'>env</span>) <span class='op'>:</span> <span class='id identifier rubyid_env'>env</span> }
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="show_block_signature-instance_method">
  <h3 class='signature '>
    #<strong>show_block_signature</strong>(blks)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2262-L2291'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2262' data-end='2291'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2262</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_show_block_signature'>show_block_signature</span>(<span class='id identifier rubyid_blks'>blks</span>)
  <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>

  <span class='id identifier rubyid_blks'>blks</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk'>blk</span><span class='op'>|</span>
    <span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_each_child_global'>each_child_global</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk'>blk</span><span class='op'>|</span>
      <span class='id identifier rubyid_bsig0'>bsig0</span> <span class='op'>=</span> <span class='ivar'>@block_signatures</span>[<span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_block_body'>block_body</span>]
      <span class='kw'>if</span> <span class='id identifier rubyid_bsig0'>bsig0</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_bsig'>bsig</span>
          <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>=</span> <span class='id identifier rubyid_bsig'>bsig</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_bsig0'>bsig0</span>)
        <span class='kw'>else</span>
          <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>=</span> <span class='id identifier rubyid_bsig0'>bsig0</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='ivar'>@block_to_ctx</span>[<span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_block_body'>block_body</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk_ctx'>blk_ctx</span><span class='op'>|</span>
        <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='ivar'>@return_values</span>[<span class='id identifier rubyid_blk_ctx'>blk_ctx</span>]) <span class='kw'>if</span> <span class='ivar'>@return_values</span>[<span class='id identifier rubyid_blk_ctx'>blk_ctx</span>]
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>||=</span> <span class='const'><a href="BlockSignature.html" title="TypeProf::BlockSignature (class)">BlockSignature</a></span>.<span class='id identifier rubyid_new'><a href="BlockSignature.html#new-class_method" title="TypeProf::BlockSignature.new (method)">new</a></span>([]<span class='comma'>,</span> []<span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>)

  <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>=</span> <span class='id identifier rubyid_bsig'>bsig</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>self</span>)
  <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>)
  <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> (<span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>) <span class='comment'># XXX?
</span>
  <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>=</span> <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_bsig'>bsig</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{ </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_bsig'>bsig</span> <span class='embexpr_end'>}</span><span class='tstring_content'>-&gt; </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='embexpr_end'>}</span><span class='tstring_content'> }</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="show_method_signature-instance_method">
  <h3 class='signature '>
    #<strong>show_method_signature</strong>(ctx)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2331-L2342'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2331' data-end='2342'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2331</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_show_method_signature'>show_method_signature</span>(<span class='id identifier rubyid_ctx'>ctx</span>)
  <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>=</span> <span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_ctx'>ctx</span>]
  <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_mid'>mid</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_initialize'>initialize</span> <span class='op'>?</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Void.html" title="TypeProf::Type::Void (class)">Void</a></span>.<span class='id identifier rubyid_new'><a href="Type/Any.html#new-class_method" title="TypeProf::Type::Any.new (method)">new</a></span> <span class='op'>:</span> <span class='ivar'>@return_values</span>[<span class='id identifier rubyid_ctx'>ctx</span>] <span class='op'>||</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>

  <span class='id identifier rubyid_untyped'>untyped</span> <span class='op'>=</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span>.<span class='id identifier rubyid_include_untyped?'>include_untyped?</span>(<span class='kw'>self</span>) <span class='op'>||</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_include_untyped?'>include_untyped?</span>(<span class='kw'>self</span>)

  <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='kw'>self</span>)
  <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>)
  <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> (<span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>) <span class='comment'># XXX?
</span>
  [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span> (<span class='id identifier rubyid_farg_tys'>farg_tys</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>) <span class='embexpr_end'>}</span><span class='tstring_content'>-&gt; </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_untyped'>untyped</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="show_proc_signature-instance_method">
  <h3 class='signature '>
    #<strong>show_proc_signature</strong>(blks)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L2293-L2329'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='2293' data-end='2329'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 2293</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_show_proc_signature'>show_proc_signature</span>(<span class='id identifier rubyid_blks'>blks</span>)
  <span class='id identifier rubyid_farg_tys'>farg_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>

  <span class='id identifier rubyid_blks'>blks</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk'>blk</span><span class='op'>|</span>
    <span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_each_child_global'>each_child_global</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk'>blk</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_block_body'>block_body</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="TypedBlock.html" title="TypeProf::TypedBlock (class)">TypedBlock</a></span>) <span class='comment'># XXX: Support TypedBlock
</span>      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='ivar'>@block_to_ctx</span>[<span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_block_body'>block_body</span>] <span class='comment'># this occurs when screen_name is called before type-profiling finished (e.g., error message)
</span>      <span class='ivar'>@block_to_ctx</span>[<span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_block_body'>block_body</span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_blk_ctx'>blk_ctx</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span>
          <span class='kw'>if</span> <span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_blk_ctx'>blk_ctx</span>]
            <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span>.<span class='id identifier rubyid_merge_as_block_arguments'>merge_as_block_arguments</span>(<span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_blk_ctx'>blk_ctx</span>])
          <span class='kw'>else</span>
            <span class='comment'># this occurs when screen_name is called before type-profiling finished (e.g., error message)
</span>          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>=</span> <span class='ivar'>@method_signatures</span>[<span class='id identifier rubyid_blk_ctx'>blk_ctx</span>]
        <span class='kw'>end</span>

        <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='ivar'>@return_values</span>[<span class='id identifier rubyid_blk_ctx'>blk_ctx</span>]) <span class='kw'>if</span> <span class='ivar'>@return_values</span>[<span class='id identifier rubyid_blk_ctx'>blk_ctx</span>]
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='kw'>if</span> <span class='ivar'>@types_being_shown</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_farg_tys'>farg_tys</span>) <span class='op'>||</span> <span class='ivar'>@types_being_shown</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)

  <span class='kw'>begin</span>
    <span class='ivar'>@types_being_shown</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>
    <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>?</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>self</span>) <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(unknown)</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>)
    <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> (<span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>) <span class='comment'># XXX?
</span>
    <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>^</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_farg_tys'>farg_tys</span> <span class='embexpr_end'>}</span><span class='tstring_content'>-&gt; </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>ensure</span>
    <span class='ivar'>@types_being_shown</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="step-instance_method">
  <h3 class='signature '>
    #<strong>step</strong>(ep)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L1118-L2018'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1118' data-end='2018'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 1118</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_step'>step</span>(<span class='id identifier rubyid_ep'>ep</span>)
  <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='ivar'>@ep2env</span>[<span class='id identifier rubyid_ep'>ep</span>]
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>nil env</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_env'>env</span>

  <span class='id identifier rubyid_insn'>insn</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_insns'>insns</span>[<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_pc'>pc</span>]
  <span class='id identifier rubyid_operands'>operands</span> <span class='op'>=</span> <span class='id identifier rubyid_insn'>insn</span>.<span class='id identifier rubyid_operands'>operands</span>

  <span class='kw'>if</span> <span class='const'>Config</span>.<span class='id identifier rubyid_verbose'>verbose</span> <span class='op'>&gt;=</span> <span class='int'>2</span>
    <span class='comment'># XXX: more dedicated output
</span>    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: stack=%p</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_stack'>stack</span>]
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: %s (%s) PC=%d insn=%s sp=%d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_source_location'>source_location</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_pc'>pc</span><span class='comma'>,</span> <span class='id identifier rubyid_insn'>insn</span>.<span class='id identifier rubyid_insn'>insn</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_size'>size</span>]
  <span class='kw'>end</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_insn'>insn</span>.<span class='id identifier rubyid_insn'>insn</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid__iseq_body_start'>_iseq_body_start</span>
    <span class='comment'># XXX: reconstruct and record the method signature
</span>    <span class='id identifier rubyid_iseq'>iseq</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>
    <span class='id identifier rubyid_lead_num'>lead_num</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_lead_num'>lead_num</span>] <span class='op'>||</span> <span class='int'>0</span>
    <span class='id identifier rubyid_opt'>opt</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_opt'>opt</span>] <span class='op'>||</span> [<span class='int'>0</span>]
    <span class='id identifier rubyid_rest_start'>rest_start</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_rest_start'>rest_start</span>]
    <span class='id identifier rubyid_post_start'>post_start</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_post_start'>post_start</span>]
    <span class='id identifier rubyid_post_num'>post_num</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_post_num'>post_num</span>] <span class='op'>||</span> <span class='int'>0</span>
    <span class='id identifier rubyid_kw_start'>kw_start</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_kwbits'>kwbits</span>]
    <span class='id identifier rubyid_keyword'>keyword</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_keyword'>keyword</span>]
    <span class='id identifier rubyid_kw_start'>kw_start</span> <span class='op'>-=</span> <span class='id identifier rubyid_keyword'>keyword</span>.<span class='id identifier rubyid_size'>size</span> <span class='kw'>if</span> <span class='id identifier rubyid_kw_start'>kw_start</span>
    <span class='id identifier rubyid_kw_rest'>kw_rest</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_kwrest'>kwrest</span>]
    <span class='id identifier rubyid_block_start'>block_start</span> <span class='op'>=</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_fargs_format'>fargs_format</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_block_start'>block_start</span>]

    <span class='id identifier rubyid_lead_tys'>lead_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_locals'>locals</span>[<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_lead_num'>lead_num</span>].<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) }
    <span class='id identifier rubyid_opt_tys'>opt_tys</span> <span class='op'>=</span> <span class='id identifier rubyid_opt'>opt</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='op'>?</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_lead_num'>lead_num</span><span class='comma'>,</span> <span class='id identifier rubyid_opt'>opt</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span>].<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) } <span class='op'>:</span> []
    <span class='kw'>if</span> <span class='id identifier rubyid_rest_start'>rest_start</span> <span class='comment'># XXX:squash
</span>      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_rest_start'>rest_start</span>]<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_rest_ty'>rest_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
      <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_each_child_global'>each_child_global</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span>)
          <span class='id identifier rubyid_rest_ty'>rest_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_rest_ty'>rest_ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_squash'>squash</span>)
        <span class='kw'>else</span>
          <span class='comment'># XXX: to_ary?
</span>          <span class='id identifier rubyid_rest_ty'>rest_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_rest_ty'>rest_ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_ty'>ty</span>)
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_post_tys'>post_tys</span> <span class='op'>=</span> (<span class='id identifier rubyid_post_start'>post_start</span> <span class='op'>?</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_post_start'>post_start</span><span class='comma'>,</span> <span class='id identifier rubyid_post_num'>post_num</span>] <span class='op'>:</span> []).<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) }
    <span class='kw'>if</span> <span class='id identifier rubyid_keyword'>keyword</span>
      <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>=</span> []
      <span class='id identifier rubyid_keyword'>keyword</span>.<span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_kw'>kw</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='kw'>case</span>
        <span class='kw'>when</span> <span class='id identifier rubyid_kw'>kw</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Symbol</span>) <span class='comment'># required keyword
</span>          <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_kw'>kw</span>
          <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='id identifier rubyid_kw'>kw</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>2</span> <span class='comment'># optional keyword (default value is a literal)
</span>          <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_default_ty'>default_ty</span> <span class='op'>=</span> <span class='op'>*</span><span class='id identifier rubyid_kw'>kw</span>
          <span class='id identifier rubyid_default_ty'>default_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_guess_literal_type'><a href="Type.html#guess_literal_type-class_method" title="TypeProf::Type.guess_literal_type (method)">guess_literal_type</a></span>(<span class='id identifier rubyid_default_ty'>default_ty</span>)
          <span class='id identifier rubyid_default_ty'>default_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_default_ty'>default_ty</span>.<span class='id identifier rubyid_base_type'>base_type</span> <span class='kw'>if</span> <span class='id identifier rubyid_default_ty'>default_ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Literal.html" title="TypeProf::Type::Literal (class)">Literal</a></span>)
          <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='kw'>else</span> <span class='comment'># optional keyword (default value is an expression)
</span>          <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_kw'>kw</span>
          <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_kw_start'>kw_start</span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span>]
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_default_ty'>default_ty</span>) <span class='kw'>if</span> <span class='id identifier rubyid_default_ty'>default_ty</span>
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
        <span class='id identifier rubyid_kw_tys'>kw_tys</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>]
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_kw_rest_ty'>kw_rest_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_kw_rest'>kw_rest</span>]<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) <span class='kw'>if</span> <span class='id identifier rubyid_kw_rest'>kw_rest</span>
    <span class='id identifier rubyid_kw_rest_ty'>kw_rest_ty</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_kw_rest_ty'>kw_rest_ty</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_block_start'>block_start</span>
      <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_locals'>locals</span>[<span class='id identifier rubyid_block_start'>block_start</span>]<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='kw'>elsif</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span>
      <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_blk_ty'>blk_ty</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_blk_ty'>blk_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_msig'>msig</span> <span class='op'>=</span> <span class='const'><a href="MethodSignature.html" title="TypeProf::MethodSignature (class)">MethodSignature</a></span>.<span class='id identifier rubyid_new'><a href="MethodSignature.html#new-class_method" title="TypeProf::MethodSignature.new (method)">new</a></span>(<span class='id identifier rubyid_lead_tys'>lead_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_opt_tys'>opt_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_rest_ty'>rest_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_post_tys'>post_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_kw_tys'>kw_tys</span><span class='comma'>,</span> <span class='id identifier rubyid_kw_rest_ty'>kw_rest_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_blk_ty'>blk_ty</span>)
    <span class='id identifier rubyid_add_method_signature!'><a href="#add_method_signature!-instance_method" title="TypeProf::Scratch#add_method_signature! (method)">add_method_signature!</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_msig'>msig</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_putspecialobject'>putspecialobject</span>
    <span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_kind'>kind</span>
    <span class='kw'>when</span> <span class='int'>1</span> <span class='kw'>then</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_vmcore'>vmcore</span>])
    <span class='kw'>when</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span> <span class='comment'># CBASE / CONSTBASE
</span>      <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown special object: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_type'>type</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_putnil'>putnil</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_putobject'>putobject</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_duparray'>duparray</span>
    <span class='id identifier rubyid_obj'>obj</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_guess_literal_type'><a href="Type.html#guess_literal_type-class_method" title="TypeProf::Type.guess_literal_type (method)">guess_literal_type</a></span>(<span class='id identifier rubyid_obj'>obj</span>)<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_putstring'>putstring</span>
    <span class='id identifier rubyid_str'>str</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Literal.html" title="TypeProf::Type::Literal (class)">Literal</a></span>.<span class='id identifier rubyid_new'><a href="Type/Literal.html#new-class_method" title="TypeProf::Type::Literal.new (method)">new</a></span>(<span class='id identifier rubyid_str'>str</span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_str'>str</span>]))
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_putself'>putself</span>
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_recv_ty'>recv_ty</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>)
      <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_klass'>klass</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_type_params'>type_params</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/ContainerType.html" title="TypeProf::Type::ContainerType (class)">ContainerType</a></span>.<span class='id identifier rubyid_create_empty_instance'><a href="Type/ContainerType.html#create_empty_instance-class_method" title="TypeProf::Type::ContainerType.create_empty_instance (method)">create_empty_instance</a></span>(<span class='id identifier rubyid_klass'>klass</span>)
        <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='const'><a href="AllocationSite.html" title="TypeProf::AllocationSite (class)">AllocationSite</a></span>.<span class='id identifier rubyid_new'><a href="AllocationSite.html#new-class_method" title="TypeProf::AllocationSite.new (method)">new</a></span>(<span class='id identifier rubyid_ep'>ep</span>))
      <span class='kw'>else</span>
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='id identifier rubyid_klass'>klass</span>)
      <span class='kw'>end</span>
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_newarray'>newarray</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_newarraykwsplat'>newarraykwsplat</span>
    <span class='id identifier rubyid_len'>len</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_len'>len</span>)
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array.html#new-class_method" title="TypeProf::Type::Array.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span><span class='op'>::</span><span class='const'><a href="Type/Array/Elements.html" title="TypeProf::Type::Array::Elements (class)">Elements</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array/Elements.html#new-class_method" title="TypeProf::Type::Array::Elements.new (method)">new</a></span>(<span class='id identifier rubyid_elems'>elems</span>)<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ary'>ary</span>]))
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_newhash'>newhash</span>
    <span class='id identifier rubyid_num'>num</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_tys'>tys</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_num'>num</span>)

    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_gen_hash'><a href="Type.html#gen_hash-class_method" title="TypeProf::Type.gen_hash (method)">gen_hash</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='op'>|</span>
      <span class='id identifier rubyid_tys'>tys</span>.<span class='id identifier rubyid_each_slice'>each_slice</span>(<span class='int'>2</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k_ty'>k_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_v_ty'>v_ty</span><span class='op'>|</span>
        <span class='id identifier rubyid_k_ty'>k_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_k_ty'>k_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
        <span class='id identifier rubyid_h'>h</span>[<span class='id identifier rubyid_k_ty'>k_ty</span>] <span class='op'>=</span> <span class='id identifier rubyid_v_ty'>v_ty</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_newhashfromarray'>newhashfromarray</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>newhashfromarray</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_newrange'>newrange</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_tys'>tys</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
    <span class='comment'># XXX: need generics
</span>    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_range'>range</span>]))

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_concatstrings'>concatstrings</span>
    <span class='id identifier rubyid_num'>num</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_num'>num</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_str'>str</span>]))
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_tostring'>tostring</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid__ty1'>_ty1</span><span class='comma'>,</span> <span class='id identifier rubyid__ty2'>_ty2</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_str'>str</span>]))
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_freezestring'>freezestring</span>
    <span class='comment'># do nothing
</span>  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_toregexp'>toregexp</span>
    <span class='id identifier rubyid__regexp_opt'>_regexp_opt</span><span class='comma'>,</span> <span class='id identifier rubyid_str_count'>str_count</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_tys'>tys</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_str_count'>str_count</span>)
    <span class='comment'># TODO: check if tys are all strings?
</span>    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_regexp'>regexp</span>]))
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_intern'>intern</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='comment'># XXX check if ty is String
</span>    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_sym'>sym</span>]))

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_definemethod'>definemethod</span>
    <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_do_define_iseq_method'><a href="#do_define_iseq_method-instance_method" title="TypeProf::Scratch#do_define_iseq_method (method)">do_define_iseq_method</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='kw'>nil</span>)

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_definesmethod'>definesmethod</span>
    <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_cref'>cref</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>
    <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_recv'>recv</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
        <span class='id identifier rubyid_meth'>meth</span> <span class='op'>=</span> <span class='id identifier rubyid_add_singleton_iseq_method'><a href="#add_singleton_iseq_method-instance_method" title="TypeProf::Scratch#add_singleton_iseq_method (method)">add_singleton_iseq_method</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_pub_meth'>pub_meth</span>)
        <span class='id identifier rubyid_pend_method_execution'><a href="#pend_method_execution-instance_method" title="TypeProf::Scratch#pend_method_execution (method)">pend_method_execution</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='kw'>nil</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='comment'># XXX: what to do?
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_defineclass'>defineclass</span>
    <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_superclass'>superclass</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
    <span class='kw'>case</span> <span class='id identifier rubyid_flags'>flags</span> <span class='op'>&amp;</span> <span class='int'>7</span>
    <span class='kw'>when</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>2</span> <span class='comment'># CLASS / MODULE
</span>      <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> (<span class='id identifier rubyid_flags'>flags</span> <span class='op'>&amp;</span> <span class='int'>7</span>) <span class='op'>==</span> <span class='int'>2</span> <span class='op'>?</span> <span class='symbeg'>:</span><span class='kw'>module</span> <span class='op'>:</span> <span class='symbeg'>:</span><span class='kw'>class</span>
      <span class='id identifier rubyid_existing_klass'>existing_klass</span> <span class='op'>=</span> <span class='id identifier rubyid_get_constant'><a href="#get_constant-instance_method" title="TypeProf::Scratch#get_constant (method)">get_constant</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>) <span class='comment'># TODO: multiple return values
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_existing_klass'>existing_klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
        <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_existing_klass'>existing_klass</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_existing_klass'>existing_klass</span> <span class='op'>!=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
          <span class='id identifier rubyid_error'><a href="#error-instance_method" title="TypeProf::Scratch#error (method)">error</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>the class \&quot;</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_id'>id</span> <span class='embexpr_end'>}</span><span class='tstring_content'>\&quot; is </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_existing_klass'>existing_klass</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>class</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
            <span class='comment'># okay
</span>          <span class='kw'>elsif</span> <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
            <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>superclass is any; Object is used instead</span><span class='tstring_end'>&quot;</span></span>)
            <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_obj'>obj</span>]
          <span class='kw'>elsif</span> <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
            <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_obj'>obj</span>]
          <span class='kw'>elsif</span> <span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>)
            <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>superclass is an instance; Object is used instead</span><span class='tstring_end'>&quot;</span></span>)
            <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_obj'>obj</span>]
          <span class='kw'>else</span>
            <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>superclass is not a class; Object is used instead</span><span class='tstring_end'>&quot;</span></span>)
            <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_obj'>obj</span>]
          <span class='kw'>end</span>
        <span class='kw'>else</span> <span class='comment'># module
</span>          <span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>=</span> <span class='kw'>nil</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_cbase'>cbase</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
          <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_new_class'><a href="#new_class-instance_method" title="TypeProf::Scratch#new_class (method)">new_class</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> []<span class='comma'>,</span> <span class='id identifier rubyid_superclass'>superclass</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_absolute_path'>absolute_path</span>)
          <span class='kw'>if</span> <span class='id identifier rubyid_superclass'>superclass</span>
            <span class='id identifier rubyid_add_superclass_type_args!'><a href="#add_superclass_type_args!-instance_method" title="TypeProf::Scratch#add_superclass_type_args! (method)">add_superclass_type_args!</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_superclass'>superclass</span>.<span class='id identifier rubyid_type_params'>type_params</span>.<span class='id identifier rubyid_map'>map</span> { <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> })

            <span class='comment'># inherited hook
</span>            <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='const'><a href="ActualArguments.html" title="TypeProf::ActualArguments (class)">ActualArguments</a></span>.<span class='id identifier rubyid_new'><a href="ActualArguments.html#new-class_method" title="TypeProf::ActualArguments.new (method)">new</a></span>([<span class='id identifier rubyid_klass'>klass</span>]<span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>)
            <span class='id identifier rubyid_do_send'><a href="#do_send-instance_method" title="TypeProf::Scratch#do_send (method)">do_send</a></span>(<span class='id identifier rubyid_superclass'>superclass</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_inherited'>inherited</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) {<span class='op'>|</span><span class='id identifier rubyid__ret_ty'>_ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid__ep'>_ep</span><span class='op'>|</span> }
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>when</span> <span class='int'>1</span> <span class='comment'># SINGLETON_CLASS
</span>      <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_cbase'>cbase</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>)
      <span class='kw'>elsif</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Any.html" title="TypeProf::Type::Any (class)">Any</a></span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A singleton class is open for </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_content'>; handled as any</span><span class='tstring_end'>&quot;</span></span>)
        <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown defineclass flag: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_flags'>flags</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_ncref'>ncref</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_extend'>extend</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span>)
    <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>?</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='op'>:</span> <span class='id identifier rubyid_klass'>klass</span>
    <span class='id identifier rubyid_blk'>blk</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_blk_ty'>blk_ty</span>
    <span class='id identifier rubyid_nctx'>nctx</span> <span class='op'>=</span> <span class='const'><a href="Context.html" title="TypeProf::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Context.html#new-class_method" title="TypeProf::Context.new (method)">new</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_ncref'>ncref</span><span class='comma'>,</span> <span class='kw'>nil</span>)
    <span class='id identifier rubyid_nep'>nep</span> <span class='op'>=</span> <span class='const'><a href="ExecutionPoint.html" title="TypeProf::ExecutionPoint (class)">ExecutionPoint</a></span>.<span class='id identifier rubyid_new'><a href="ExecutionPoint.html#new-class_method" title="TypeProf::ExecutionPoint.new (method)">new</a></span>(<span class='id identifier rubyid_nctx'>nctx</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='kw'>nil</span>)
    <span class='id identifier rubyid_locals'>locals</span> <span class='op'>=</span> [<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>] <span class='op'>*</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_locals'>locals</span>.<span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='const'><a href="Env.html" title="TypeProf::Env (class)">Env</a></span>.<span class='id identifier rubyid_new'><a href="Env.html#new-class_method" title="TypeProf::Env.new (method)">new</a></span>(<span class='const'><a href="StaticEnv.html" title="TypeProf::StaticEnv (class)">StaticEnv</a></span>.<span class='id identifier rubyid_new'><a href="StaticEnv.html#new-class_method" title="TypeProf::StaticEnv.new (method)">new</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_blk'>blk</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>true</span>)<span class='comma'>,</span> <span class='id identifier rubyid_locals'>locals</span><span class='comma'>,</span> []<span class='comma'>,</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/HashWrapper.html" title="TypeProf::Utils::HashWrapper (class)">HashWrapper</a></span>.<span class='id identifier rubyid_new'><a href="Utils/HashWrapper.html#new-class_method" title="TypeProf::Utils::HashWrapper.new (method)">new</a></span>({}))
    <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_nep'>nep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='id identifier rubyid_add_callsite!'><a href="#add_callsite!-instance_method" title="TypeProf::Scratch#add_callsite! (method)">add_callsite!</a></span>(<span class='id identifier rubyid_nep'>nep</span>.<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
      <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_send'>send</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_setup_actual_arguments'><a href="#setup_actual_arguments-instance_method" title="TypeProf::Scratch#setup_actual_arguments (method)">setup_actual_arguments</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='id identifier rubyid_operands'>operands</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_recvs'>recvs</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_recvs'>recvs</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
    <span class='id identifier rubyid_do_send'><a href="#do_send-instance_method" title="TypeProf::Scratch#do_send (method)">do_send</a></span>(<span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
      <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_recv_getlocal_send_branch'>recv_getlocal_send_branch</span>
    <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_send_operands'>send_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_setup_actual_arguments'><a href="#setup_actual_arguments-instance_method" title="TypeProf::Scratch#setup_actual_arguments (method)">setup_actual_arguments</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='id identifier rubyid_send_operands'>send_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_recvs'>recvs</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_recvs'>recvs</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
    <span class='id identifier rubyid_recvs'>recvs</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_recv'>recv</span><span class='op'>|</span>
      <span class='id identifier rubyid_do_send'><a href="#do_send-instance_method" title="TypeProf::Scratch#do_send (method)">do_send</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
        <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)

        <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
        <span class='comment'># branchtype: :if or :unless or :nil
</span>        <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
        <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

        <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span>
        <span class='id identifier rubyid_flow_env'>flow_env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_recv'>recv</span>)

        <span class='kw'>case</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>
        <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>true</span>])
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>])
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='kw'>else</span>
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_arg_getlocal_send_branch'>arg_getlocal_send_branch</span>
    <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_send_operands'>send_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_setup_actual_arguments'><a href="#setup_actual_arguments-instance_method" title="TypeProf::Scratch#setup_actual_arguments (method)">setup_actual_arguments</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='id identifier rubyid_send_operands'>send_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='kw'>if</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_lead_tys'>lead_tys</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_aarg'>aarg</span> <span class='op'>=</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_lead_tys'>lead_tys</span>[<span class='int'>0</span>]
    <span class='id identifier rubyid_aarg'>aarg</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_aarg'>aarg</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
    <span class='id identifier rubyid_recvs'>recvs</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_recv'>recv</span><span class='op'>|</span>
      <span class='id identifier rubyid_aarg'>aarg</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_aarg'>aarg</span><span class='op'>|</span>
        <span class='id identifier rubyid_aargs_tmp'>aargs_tmp</span> <span class='op'>=</span> <span class='const'><a href="ActualArguments.html" title="TypeProf::ActualArguments (class)">ActualArguments</a></span>.<span class='id identifier rubyid_new'><a href="ActualArguments.html#new-class_method" title="TypeProf::ActualArguments.new (method)">new</a></span>([<span class='id identifier rubyid_aarg'>aarg</span>]<span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span>.<span class='id identifier rubyid_blk_ty'>blk_ty</span>)
        <span class='id identifier rubyid_do_send'><a href="#do_send-instance_method" title="TypeProf::Scratch#do_send (method)">do_send</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs_tmp'>aargs_tmp</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
          <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)

          <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
          <span class='comment'># branchtype: :if or :unless or :nil
</span>          <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
          <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

          <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span>
          <span class='id identifier rubyid_flow_env'>flow_env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_aarg'>aarg</span>)

          <span class='kw'>case</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>
          <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>true</span>])
            <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
          <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>])
            <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
          <span class='kw'>else</span>
            <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
            <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_send_branch'>send_branch</span>
    <span class='id identifier rubyid_send_operands'>send_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_setup_actual_arguments'><a href="#setup_actual_arguments-instance_method" title="TypeProf::Scratch#setup_actual_arguments (method)">setup_actual_arguments</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='id identifier rubyid_send_operands'>send_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_recvs'>recvs</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_recvs'>recvs</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
    <span class='id identifier rubyid_do_send'><a href="#do_send-instance_method" title="TypeProf::Scratch#do_send (method)">do_send</a></span>(<span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)

      <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
      <span class='comment'># branchtype: :if or :unless or :nil
</span>      <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
      <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

      <span class='kw'>case</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>true</span>])
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>])
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_invokeblock'>invokeblock</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_recvs'>recvs</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_setup_actual_arguments'><a href="#setup_actual_arguments-instance_method" title="TypeProf::Scratch#setup_actual_arguments (method)">setup_actual_arguments</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_operands'>operands</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_blk'>blk</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_blk_ty'>blk_ty</span>
    <span class='kw'>case</span>
    <span class='kw'>when</span> <span class='id identifier rubyid_blk'>blk</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>)
    <span class='kw'>when</span> <span class='id identifier rubyid_blk'>blk</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
      <span class='comment'>#warn(ep, &quot;block is any&quot;)
</span>      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>)
    <span class='kw'>else</span> <span class='comment'># Proc
</span>      <span class='id identifier rubyid_do_invoke_block'><a href="#do_invoke_block-instance_method" title="TypeProf::Scratch#do_invoke_block (method)">do_invoke_block</a></span>(<span class='id identifier rubyid_blk'>blk</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
        <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
        <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
      <span class='kw'>end</span>
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_invokesuper'>invokesuper</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span> <span class='op'>=</span> <span class='id identifier rubyid_setup_actual_arguments'><a href="#setup_actual_arguments-instance_method" title="TypeProf::Scratch#setup_actual_arguments (method)">setup_actual_arguments</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='id identifier rubyid_operands'>operands</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_mid'>mid</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_mid'>mid</span>
    <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_each_child_global'>each_child_global</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_recv'>recv</span><span class='op'>|</span>
      <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span> <span class='op'>=</span> <span class='id identifier rubyid_recv'>recv</span>.<span class='id identifier rubyid_method_dispatch_info'>method_dispatch_info</span>
      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_klass'>klass</span>
      <span class='id identifier rubyid_get_all_super_methods'><a href="#get_all_super_methods-instance_method" title="TypeProf::Scratch#get_all_super_methods (method)">get_all_super_methods</a></span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_singleton'>singleton</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_mid'>mid</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_meths'>meths</span><span class='comma'>,</span> <span class='id identifier rubyid_klass'>klass</span><span class='op'>|</span>
        <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_meths'>meths</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_meth'>meth</span><span class='op'>|</span>
          <span class='comment'># XXX: this decomposition is really needed??
</span>          <span class='comment'># It calls `Object.new` with union receiver which causes an error, but
</span>          <span class='comment'># it may be a fault of builtin Object.new implementation.
</span>          <span class='id identifier rubyid_meth'>meth</span>.<span class='id identifier rubyid_do_send'><a href="#do_send-instance_method" title="TypeProf::Scratch#do_send (method)">do_send</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_mid'>mid</span><span class='comma'>,</span> <span class='id identifier rubyid_aargs'>aargs</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='kw'>self</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
            <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
            <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)
            <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_found'>found</span>
    <span class='id identifier rubyid_error'><a href="#error-instance_method" title="TypeProf::Scratch#error (method)">error</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no superclass method: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_recv_ty'>recv_ty</span>.<span class='id identifier rubyid_screen_name'>screen_name</span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_content'>#</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_mid'>mid</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_invokebuiltin'>invokebuiltin</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_leave'>leave</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>stack inconsistency error: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_inspect'><a href="#inspect-instance_method" title="TypeProf::Scratch#inspect (method)">inspect</a></span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_add_return_value!'><a href="#add_return_value!-instance_method" title="TypeProf::Scratch#add_return_value! (method)">add_return_value!</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_throw'>throw</span>
    <span class='id identifier rubyid_throwtype'>throwtype</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid__no_escape'>_no_escape</span> <span class='op'>=</span> <span class='op'>!</span><span class='op'>!</span>(<span class='id identifier rubyid_throwtype'>throwtype</span> <span class='op'>&amp;</span> <span class='int'>0x8000</span>)
    <span class='id identifier rubyid_throwtype'>throwtype</span> <span class='op'>=</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='kw'>return</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='kw'>break</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='kw'>next</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='kw'>retry</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='kw'>redo</span>][<span class='id identifier rubyid_throwtype'>throwtype</span> <span class='op'>&amp;</span> <span class='int'>0xff</span>]
    <span class='kw'>case</span> <span class='id identifier rubyid_throwtype'>throwtype</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_none'>none</span>

    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='kw'>return</span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span> <span class='kw'>while</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
      <span class='id identifier rubyid_add_return_value!'><a href="#add_return_value!-instance_method" title="TypeProf::Scratch#add_return_value! (method)">add_return_value!</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>)
      <span class='kw'>return</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='kw'>break</span>
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
      <span class='kw'>while</span> <span class='kw'>true</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_block'>block</span>
          <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
          <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>].<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
          <span class='kw'>break</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid__type'>_type</span><span class='comma'>,</span> <span class='id identifier rubyid__iseq'>_iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cont'>cont</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_catch_table'>catch_table</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_pc'>pc</span>]<span class='op'>&amp;.</span><span class='id identifier rubyid_find'>find</span> {<span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span><span class='op'>|</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>break</span> }
        <span class='kw'>if</span> <span class='id identifier rubyid_cont'>cont</span>
          <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>] <span class='op'>||</span> <span class='id identifier rubyid_env'>env</span>
          <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span>)
          <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
          <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_cont'>cont</span>)
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
          <span class='kw'>break</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='kw'>next</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='kw'>redo</span>
      <span class='comment'># begin; rescue; next; end
</span>      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_outer'>outer</span>
      <span class='id identifier rubyid__type'>_type</span><span class='comma'>,</span> <span class='id identifier rubyid__iseq'>_iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cont'>cont</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_catch_table'>catch_table</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_pc'>pc</span>].<span class='id identifier rubyid_find'>find</span> {<span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span><span class='op'>|</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='id identifier rubyid_throwtype'>throwtype</span> }
      <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>]
      <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span>)
      <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>) <span class='kw'>if</span> <span class='id identifier rubyid_throwtype'>throwtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>next</span>
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_cont'>cont</span>)
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='kw'>retry</span>
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_outer'>outer</span>
      <span class='id identifier rubyid__type'>_type</span><span class='comma'>,</span> <span class='id identifier rubyid__iseq'>_iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cont'>cont</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_catch_table'>catch_table</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_pc'>pc</span>].<span class='id identifier rubyid_find'>find</span> {<span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span><span class='op'>|</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>retry</span> }
      <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>]
      <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span>)
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_cont'>cont</span>)
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_throwtype'>throwtype</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_once'>once</span>
    <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>

    <span class='id identifier rubyid_nctx'>nctx</span> <span class='op'>=</span> <span class='const'><a href="Context.html" title="TypeProf::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Context.html#new-class_method" title="TypeProf::Context.new (method)">new</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_mid'>mid</span>)
    <span class='id identifier rubyid_nep'>nep</span> <span class='op'>=</span> <span class='const'><a href="ExecutionPoint.html" title="TypeProf::ExecutionPoint (class)">ExecutionPoint</a></span>.<span class='id identifier rubyid_new'><a href="ExecutionPoint.html#new-class_method" title="TypeProf::ExecutionPoint.new (method)">new</a></span>(<span class='id identifier rubyid_nctx'>nctx</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='kw'>if</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_locals'>locals</span> <span class='op'>!=</span> []
    <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='const'><a href="Env.html" title="TypeProf::Env (class)">Env</a></span>.<span class='id identifier rubyid_new'><a href="Env.html#new-class_method" title="TypeProf::Env.new (method)">new</a></span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span><span class='comma'>,</span> []<span class='comma'>,</span> []<span class='comma'>,</span> <span class='kw'>nil</span>)
    <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_nep'>nep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='id identifier rubyid_add_callsite!'><a href="#add_callsite!-instance_method" title="TypeProf::Scratch#add_callsite! (method)">add_callsite!</a></span>(<span class='id identifier rubyid_nep'>nep</span>.<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
      <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
    <span class='kw'>end</span>
    <span class='kw'>return</span>

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_branch'>branch</span> <span class='comment'># TODO: check how branchnil is used
</span>    <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='comment'># branchtype: :if or :unless or :nil
</span>    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
    <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

    <span class='comment'># TODO: it works for only simple cases: `x = nil; x || 1`
</span>    <span class='comment'># It would be good to merge &quot;dup; branchif&quot; to make it context-sensitive-like
</span>    <span class='id identifier rubyid_falsy'>falsy</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>

    <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>unless</span> <span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_falsy'>falsy</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_jump'>jump</span>
    <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='kw'>return</span>

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setinstancevariable'>setinstancevariable</span>
    <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_recv_ty'>recv_ty</span>
    <span class='id identifier rubyid_set_instance_variable'><a href="#set_instance_variable-instance_method" title="TypeProf::Scratch#set_instance_variable (method)">set_instance_variable</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getinstancevariable'>getinstancevariable</span>
    <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_recv'>recv</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span>.<span class='id identifier rubyid_recv_ty'>recv_ty</span>
    <span class='id identifier rubyid_get_instance_variable'><a href="#get_instance_variable-instance_method" title="TypeProf::Scratch#get_instance_variable (method)">get_instance_variable</a></span>(<span class='id identifier rubyid_recv'>recv</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span><span class='op'>|</span>
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>))
    <span class='kw'>end</span>
    <span class='kw'>return</span>

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setclassvariable'>setclassvariable</span>
    <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_cbase'>cbase</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span>
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='comment'># TODO: if superclass has the variable, it should be updated
</span>    <span class='id identifier rubyid_add_cvar_write!'><a href="#add_cvar_write!-instance_method" title="TypeProf::Scratch#add_cvar_write! (method)">add_cvar_write!</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getclassvariable'>getclassvariable</span>
    <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_cbase'>cbase</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span>.<span class='id identifier rubyid_klass'>klass</span>
    <span class='comment'># TODO: if superclass has the variable, it should be read
</span>    <span class='id identifier rubyid_add_cvar_read!'><a href="#add_cvar_read!-instance_method" title="TypeProf::Scratch#add_cvar_read! (method)">add_cvar_read!</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='op'>|</span>
      <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>))
    <span class='kw'>end</span>
    <span class='kw'>return</span>

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setglobal'>setglobal</span>
    <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_add_gvar_write!'><a href="#add_gvar_write!-instance_method" title="TypeProf::Scratch#add_gvar_write! (method)">add_gvar_write!</a></span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getglobal'>getglobal</span>
    <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_builtin_global_variable_type'><a href="Type.html#builtin_global_variable_type-class_method" title="TypeProf::Type.builtin_global_variable_type (method)">builtin_global_variable_type</a></span>(<span class='id identifier rubyid_var'>var</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_ty'>ty</span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_get_constant'><a href="#get_constant-instance_method" title="TypeProf::Scratch#get_constant (method)">get_constant</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_obj'>obj</span>]<span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>) <span class='kw'>if</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Symbol</span>)
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_add_gvar_read!'><a href="#add_gvar_read!-instance_method" title="TypeProf::Scratch#add_gvar_read! (method)">add_gvar_read!</a></span>(<span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='op'>|</span>
        <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>))
      <span class='kw'>end</span>
      <span class='comment'># need to return default nil of global variables
</span>      <span class='kw'>return</span>
    <span class='kw'>end</span>

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getlocal'>getlocal</span>
    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid_scope_idx'>scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_scope_idx'>scope_idx</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_get_local'>get_local</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
      <span class='id identifier rubyid_scope_idx'>scope_idx</span>.<span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='ivar'>@return_envs</span>[<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>].<span class='id identifier rubyid_get_local'>get_local</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span>)
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getlocal_branch'>getlocal_branch</span>
    <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span>
    <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_get_local'>get_local</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span>)

    <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
    <span class='comment'># branchtype: :if or :unless or :nil
</span>    <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
    <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span>

    <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_flow_env'>flow_env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>)
      <span class='kw'>case</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>])<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getlocal_dup_branch'>getlocal_dup_branch</span>
    <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span><span class='comma'>,</span> <span class='id identifier rubyid__dup_operands'>_dup_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span>
    <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_get_local'>get_local</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span>)

    <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
    <span class='comment'># branchtype: :if or :unless or :nil
</span>    <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
    <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

    <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_flow_env'>flow_env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>).<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)
      <span class='kw'>case</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>])<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_dup_setlocal_branch'>dup_setlocal_branch</span>
    <span class='id identifier rubyid__dup_operands'>_dup_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_setlocal_operands'>setlocal_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>

    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)

    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_setlocal_operands'>setlocal_operands</span>

    <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
    <span class='comment'># branchtype: :if or :unless or :nil
</span>    <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
    <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

    <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_flow_env'>flow_env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>)
      <span class='kw'>case</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>])<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getlocal_checkmatch_branch'>getlocal_checkmatch_branch</span>
    <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span>
    <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_get_local'>get_local</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span>)

    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_pattern_ty'>pattern_ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)

    <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
    <span class='comment'># branchtype: :if or :unless or :nil
</span>    <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
    <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__scope_idx'>_scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_getlocal_operands'>getlocal_operands</span>

    <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_flow_env'>flow_env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>)
      <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_base_type'>base_type</span> <span class='kw'>if</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Symbol.html" title="TypeProf::Type::Symbol (class)">Symbol</a></span>)
      <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_base_type'>base_type</span> <span class='kw'>if</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Local.html" title="TypeProf::Type::Local (class)">Local</a></span>)
      <span class='kw'>if</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>)
        <span class='kw'>if</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span>.<span class='id identifier rubyid_klass'>klass</span> <span class='op'>==</span> <span class='id identifier rubyid_pattern_ty'>pattern_ty</span> <span class='comment'># XXX: inheritance
</span>          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='kw'>else</span>
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setlocal'>setlocal</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setblockparam'>setblockparam</span>
    <span class='id identifier rubyid_var_idx'>var_idx</span><span class='comma'>,</span> <span class='id identifier rubyid_scope_idx'>scope_idx</span><span class='comma'>,</span> <span class='id identifier rubyid__escaped'>_escaped</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_scope_idx'>scope_idx</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
      <span class='id identifier rubyid_scope_idx'>scope_idx</span>.<span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_merge_return_env'><a href="#merge_return_env-instance_method" title="TypeProf::Scratch#merge_return_env (method)">merge_return_env</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
        <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_local_update'>local_update</span>(<span class='op'>-</span><span class='id identifier rubyid_var_idx'>var_idx</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>))
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getconstant'>getconstant</span>
    <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid__allow_nil'>_allow_nil</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_cbase'>cbase</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_search_constant'><a href="#search_constant-instance_method" title="TypeProf::Scratch#search_constant (method)">search_constant</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>elsif</span> <span class='id identifier rubyid_cbase'>cbase</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>) <span class='comment'># XXX: warning needed?
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_get_constant'><a href="#get_constant-instance_method" title="TypeProf::Scratch#get_constant (method)">get_constant</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setconstant'>setconstant</span>
    <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_cbase'>cbase</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
    <span class='id identifier rubyid_old_ty'>old_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_get_constant'><a href="#get_constant-instance_method" title="TypeProf::Scratch#get_constant (method)">get_constant</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_old_ty'>old_ty</span> <span class='op'>!=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span> <span class='comment'># XXX???
</span>      <span class='id identifier rubyid_warn'><a href="#warn-instance_method" title="TypeProf::Scratch#warn (method)">warn</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>already initialized constant </span><span class='embexpr_beg'>#{</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='id identifier rubyid_cbase'>cbase</span>).<span class='id identifier rubyid_screen_name'><a href="Type/Instance.html#screen_name-instance_method" title="TypeProf::Type::Instance#screen_name (method)">screen_name</a></span>(<span class='kw'>self</span>) <span class='embexpr_end'>}</span><span class='tstring_content'>::</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_name'>name</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>end</span>
    <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_cbase'>cbase</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Class.html" title="TypeProf::Type::Class (class)">Class</a></span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_superclass'>superclass</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_struct'>struct</span>]
        <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_cbase_path'><a href="#cbase_path-instance_method" title="TypeProf::Scratch#cbase_path (method)">cbase_path</a></span>(<span class='id identifier rubyid_cbase'>cbase</span>) <span class='op'>+</span> [<span class='id identifier rubyid_name'>name</span>]
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_add_constant'><a href="#add_constant-instance_method" title="TypeProf::Scratch#add_constant (method)">add_constant</a></span>(<span class='id identifier rubyid_cbase'>cbase</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)<span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_absolute_path'>absolute_path</span>)

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_getspecial'>getspecial</span>
    <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_key'>key</span>
      <span class='kw'>when</span> <span class='int'>0</span> <span class='comment'># VM_SVAR_LASTLINE
</span>        <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>) <span class='comment'># or String | NilClass only?
</span>      <span class='kw'>when</span> <span class='int'>1</span> <span class='comment'># VM_SVAR_BACKREF ($~)
</span>        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_matchdata'>matchdata</span>])))
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>))
        <span class='kw'>return</span>
      <span class='kw'>else</span> <span class='comment'># flip-flop
</span>        <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bool'><a href="Type.html#bool-class_method" title="TypeProf::Type.bool (method)">bool</a></span>)
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='comment'># NTH_REF ($1, $2, ...) / BACK_REF ($&amp;, $+, ...)
</span>      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_str'>str</span>])))
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>))
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setspecial'>setspecial</span>
    <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>&gt;=</span> <span class='int'>2</span> <span class='comment'># flip-flop
</span>      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown setspecial key: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_key'>key</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>).<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_dup_branch'>dup_branch</span>
    <span class='id identifier rubyid__dup_operands'>_dup_operands</span><span class='comma'>,</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)

    <span class='id identifier rubyid_branchtype'>branchtype</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_branch_operands'>branch_operands</span>
    <span class='comment'># branchtype: :if or :unless or :nil
</span>    <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span>
    <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_target'>target</span>)

    <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span>
      <span class='id identifier rubyid_flow_env'>flow_env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
      <span class='kw'>case</span> <span class='id identifier rubyid_ty'>ty</span>
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>])<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_then'>ep_then</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_else'>ep_else</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_branchtype'>branchtype</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='kw'>if</span> <span class='op'>?</span> <span class='id identifier rubyid_ep_else'>ep_else</span> <span class='op'>:</span> <span class='id identifier rubyid_ep_then'>ep_then</span><span class='comma'>,</span> <span class='id identifier rubyid_flow_env'>flow_env</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_duphash'>duphash</span>
    <span class='id identifier rubyid_raw_hash'>raw_hash</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_guess_literal_type'><a href="Type.html#guess_literal_type-class_method" title="TypeProf::Type.guess_literal_type (method)">guess_literal_type</a></span>(<span class='id identifier rubyid_raw_hash'>raw_hash</span>)
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_dupn'>dupn</span>
    <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_tys'>tys</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_n'>n</span>)
    <span class='id identifier rubyid_tys'>tys</span>.<span class='id identifier rubyid_each'>each</span> {<span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span> <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>) }
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_pop'>pop</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_swap'>swap</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_a'>a</span>).<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_b'>b</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reverse'>reverse</span>
    <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_tys'>tys</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_n'>n</span>)
    <span class='id identifier rubyid_tys'>tys</span>.<span class='id identifier rubyid_reverse_each'>reverse_each</span> {<span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='op'>|</span> <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>) }
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_defined'>defined</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_sym_ty'>sym_ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Symbol.html" title="TypeProf::Type::Symbol (class)">Symbol</a></span>.<span class='id identifier rubyid_new'><a href="Type/Symbol.html#new-class_method" title="TypeProf::Type::Symbol.new (method)">new</a></span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_sym'>sym</span>]))
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_optional'><a href="Type.html#optional-class_method" title="TypeProf::Type.optional (method)">optional</a></span>(<span class='id identifier rubyid_sym_ty'>sym_ty</span>))
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_checkmatch'>checkmatch</span>
    <span class='id identifier rubyid_flag'>flag</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>

    <span class='comment'># This flag means that the stack top is an array, and the check needs to be applied to find all elements
</span>    <span class='comment'># However, currently TypeProf uses very conservative interpretation (all check returns both true and false),
</span>    <span class='comment'># so we just ignore the flag now
</span>    <span class='id identifier rubyid__array'>_array</span> <span class='op'>=</span> <span class='id identifier rubyid_flag'>flag</span> <span class='op'>&amp;</span> <span class='int'>4</span> <span class='op'>!=</span> <span class='int'>0</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_flag'>flag</span> <span class='op'>&amp;</span> <span class='int'>3</span>
    <span class='kw'>when</span> <span class='int'>1</span> <span class='comment'># VM_CHECKMATCH_TYPE_WHEN
</span>      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bool'><a href="Type.html#bool-class_method" title="TypeProf::Type.bool (method)">bool</a></span>)
    <span class='kw'>when</span> <span class='int'>2</span> <span class='comment'># VM_CHECKMATCH_TYPE_CASE
</span>      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bool'><a href="Type.html#bool-class_method" title="TypeProf::Type.bool (method)">bool</a></span>)
    <span class='kw'>when</span> <span class='int'>3</span> <span class='comment'># VM_CHECKMATCH_TYPE_RESCUE
</span>      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bool'><a href="Type.html#bool-class_method" title="TypeProf::Type.bool (method)">bool</a></span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown checkmatch flag</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_checkkeyword'>checkkeyword</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bool'><a href="Type.html#bool-class_method" title="TypeProf::Type.bool (method)">bool</a></span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_adjuststack'>adjuststack</span>
    <span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_n'>n</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_nop'>nop</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_setn'>setn</span>
    <span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_idx'>idx</span> <span class='op'>&gt;=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_setn'>setn</span>(<span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span>).<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_topn'>topn</span>
    <span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_topn'>topn</span>(<span class='id identifier rubyid_idx'>idx</span>)

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_splatarray'>splatarray</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='comment'># XXX: vm_splat_array
</span>    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_expandarray'>expandarray</span>
    <span class='id identifier rubyid_num'>num</span><span class='comma'>,</span> <span class='id identifier rubyid_flag'>flag</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ary'>ary</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_splat'>splat</span> <span class='op'>=</span> <span class='id identifier rubyid_flag'>flag</span> <span class='op'>&amp;</span> <span class='int'>1</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_from_head'>from_head</span> <span class='op'>=</span> <span class='id identifier rubyid_flag'>flag</span> <span class='op'>&amp;</span> <span class='int'>2</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ary'>ary</span><span class='op'>|</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_ary'>ary</span>
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Local.html" title="TypeProf::Type::Local (class)">Local</a></span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span>
          <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='id identifier rubyid_get_container_elem_types'><a href="#get_container_elem_types-instance_method" title="TypeProf::Scratch#get_container_elem_types (method)">get_container_elem_types</a></span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ary'>ary</span>.<span class='id identifier rubyid_id'>id</span>)
          <span class='id identifier rubyid_elems'>elems</span> <span class='op'>||=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span><span class='op'>::</span><span class='const'><a href="Type/Array/Elements.html" title="TypeProf::Type::Array::Elements (class)">Elements</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array/Elements.html#new-class_method" title="TypeProf::Type::Array::Elements.new (method)">new</a></span>([]<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>) <span class='comment'># XXX
</span>        <span class='kw'>else</span>
          <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span><span class='op'>::</span><span class='const'><a href="Type/Array/Elements.html" title="TypeProf::Type::Array::Elements (class)">Elements</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array/Elements.html#new-class_method" title="TypeProf::Type::Array::Elements.new (method)">new</a></span>([]<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>) <span class='comment'># XXX
</span>        <span class='kw'>end</span>
        <span class='id identifier rubyid_do_expand_array'><a href="#do_expand_array-instance_method" title="TypeProf::Scratch#do_expand_array (method)">do_expand_array</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span><span class='comma'>,</span> <span class='id identifier rubyid_num'>num</span><span class='comma'>,</span> <span class='id identifier rubyid_splat'>splat</span><span class='comma'>,</span> <span class='id identifier rubyid_from_head'>from_head</span>)
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Any.html" title="TypeProf::Type::Any (class)">Any</a></span>
        <span class='id identifier rubyid_nnum'>nnum</span> <span class='op'>=</span> <span class='id identifier rubyid_num'>num</span>
        <span class='id identifier rubyid_nnum'>nnum</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='kw'>if</span> <span class='id identifier rubyid_splat'>splat</span>
        <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>
        <span class='id identifier rubyid_nnum'>nnum</span>.<span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>)
        <span class='kw'>end</span>
        <span class='id identifier rubyid_add_edge'><a href="#add_edge-instance_method" title="TypeProf::Scratch#add_edge (method)">add_edge</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
      <span class='kw'>else</span>
        <span class='comment'># TODO: call to_ary (or to_a?)
</span>        <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span><span class='op'>::</span><span class='const'><a href="Type/Array/Elements.html" title="TypeProf::Type::Array::Elements (class)">Elements</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array/Elements.html#new-class_method" title="TypeProf::Type::Array::Elements.new (method)">new</a></span>([<span class='id identifier rubyid_ary'>ary</span>]<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>)
        <span class='id identifier rubyid_do_expand_array'><a href="#do_expand_array-instance_method" title="TypeProf::Scratch#do_expand_array (method)">do_expand_array</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span><span class='comma'>,</span> <span class='id identifier rubyid_num'>num</span><span class='comma'>,</span> <span class='id identifier rubyid_splat'>splat</span><span class='comma'>,</span> <span class='id identifier rubyid_from_head'>from_head</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_concatarray'>concatarray</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_ary1'>ary1</span><span class='comma'>,</span> <span class='id identifier rubyid_ary2'>ary2</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>2</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_ary1'>ary1</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Local.html" title="TypeProf::Type::Local (class)">Local</a></span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_ary1'>ary1</span>.<span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span>
      <span class='id identifier rubyid_elems1'>elems1</span> <span class='op'>=</span> <span class='id identifier rubyid_get_container_elem_types'><a href="#get_container_elem_types-instance_method" title="TypeProf::Scratch#get_container_elem_types (method)">get_container_elem_types</a></span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ary1'>ary1</span>.<span class='id identifier rubyid_id'>id</span>)
      <span class='kw'>if</span> <span class='id identifier rubyid_ary2'>ary2</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Local.html" title="TypeProf::Type::Local (class)">Local</a></span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_ary2'>ary2</span>.<span class='id identifier rubyid_kind'>kind</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span>
        <span class='id identifier rubyid_elems2'>elems2</span> <span class='op'>=</span> <span class='id identifier rubyid_get_container_elem_types'><a href="#get_container_elem_types-instance_method" title="TypeProf::Scratch#get_container_elem_types (method)">get_container_elem_types</a></span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ary2'>ary2</span>.<span class='id identifier rubyid_id'>id</span>)
        <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span><span class='op'>::</span><span class='const'><a href="Type/Array/Elements.html" title="TypeProf::Type::Array::Elements (class)">Elements</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array/Elements.html#new-class_method" title="TypeProf::Type::Array::Elements.new (method)">new</a></span>([]<span class='comma'>,</span> <span class='id identifier rubyid_elems1'>elems1</span>.<span class='id identifier rubyid_squash'>squash</span>.<span class='id identifier rubyid_union'>union</span>(<span class='id identifier rubyid_elems2'>elems2</span>.<span class='id identifier rubyid_squash'>squash</span>))
        <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_update_container_elem_types'><a href="#update_container_elem_types-instance_method" title="TypeProf::Scratch#update_container_elem_types (method)">update_container_elem_types</a></span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ary1'>ary1</span>.<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_ary1'>ary1</span>.<span class='id identifier rubyid_base_type'>base_type</span>) { <span class='id identifier rubyid_elems'>elems</span> }
        <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ary1'>ary1</span>)
      <span class='kw'>else</span>
        <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span><span class='op'>::</span><span class='const'><a href="Type/Array/Elements.html" title="TypeProf::Type::Array::Elements (class)">Elements</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array/Elements.html#new-class_method" title="TypeProf::Type::Array::Elements.new (method)">new</a></span>([]<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>)
        <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_update_container_elem_types'><a href="#update_container_elem_types-instance_method" title="TypeProf::Scratch#update_container_elem_types (method)">update_container_elem_types</a></span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ary1'>ary1</span>.<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_ary1'>ary1</span>.<span class='id identifier rubyid_base_type'>base_type</span>) { <span class='id identifier rubyid_elems'>elems</span> }
        <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ary1'>ary1</span>)
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array.html#new-class_method" title="TypeProf::Type::Array.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Array.html" title="TypeProf::Type::Array (class)">Array</a></span><span class='op'>::</span><span class='const'><a href="Type/Array/Elements.html" title="TypeProf::Type::Array::Elements (class)">Elements</a></span>.<span class='id identifier rubyid_new'><a href="Type/Array/Elements.html#new-class_method" title="TypeProf::Type::Array::Elements.new (method)">new</a></span>([]<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>)<span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ary'>ary</span>]))
      <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
    <span class='kw'>end</span>

  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_checktype'>checktype</span>
    <span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_operands'>operands</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_kind'>kind</span>
    <span class='kw'>when</span> <span class='int'>5</span> <span class='kw'>then</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_str'>str</span>  <span class='comment'># T_STRING
</span>    <span class='kw'>when</span> <span class='int'>7</span> <span class='kw'>then</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_ary'>ary</span>  <span class='comment'># T_ARRAY
</span>    <span class='kw'>when</span> <span class='int'>8</span> <span class='kw'>then</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_hash'>hash</span> <span class='comment'># T_HASH
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> (<span class='id identifier rubyid_val'>val</span><span class='comma'>,</span>) <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='int'>1</span>)
    <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span>
    <span class='id identifier rubyid_val'>val</span>.<span class='id identifier rubyid_each_child'>each_child</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_val'>val</span><span class='op'>|</span>
    <span class='comment'>#globalize_type(val, env, ep).each_child_global do |val|
</span>      <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>.<span class='id identifier rubyid_base_type'>base_type</span> <span class='kw'>while</span> <span class='id identifier rubyid_val'>val</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_base_type'>base_type</span>)
      <span class='kw'>case</span> <span class='id identifier rubyid_val'>val</span>
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='id identifier rubyid_klass'>klass</span>])
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>true</span>]))
      <span class='kw'>when</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_any'><a href="Type.html#any-class_method" title="TypeProf::Type.any (method)">any</a></span>
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bool'><a href="Type.html#bool-class_method" title="TypeProf::Type.bool (method)">bool</a></span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_ty'>ty</span>.<span class='id identifier rubyid_union'>union</span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Instance.html" title="TypeProf::Type::Instance (class)">Instance</a></span>.<span class='id identifier rubyid_new'><a href="Type/Instance.html#new-class_method" title="TypeProf::Type::Instance.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type.html#Builtin-constant" title="TypeProf::Type::Builtin (constant)">Builtin</a></span>[<span class='symbeg'>:</span><span class='kw'>false</span>]))
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ty'>ty</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unknown insn: </span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_insn'>insn</span>.<span class='id identifier rubyid_insn'>insn</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_add_edge'><a href="#add_edge-instance_method" title="TypeProf::Scratch#add_edge (method)">add_edge</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
  <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_next'>next</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_catch_table'>catch_table</span>[<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_pc'>pc</span>]
    <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_catch_table'>catch_table</span>[<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_pc'>pc</span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_cont'>cont</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='kw'>rescue</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='kw'>ensure</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span>
      <span class='id identifier rubyid_cont_ep'>cont_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_cont'>cont</span>)
      <span class='id identifier rubyid_cont_env'>cont_env</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_pop'>pop</span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_stack'>stack</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_stack_depth'>stack_depth</span>)
      <span class='id identifier rubyid_nctx'>nctx</span> <span class='op'>=</span> <span class='const'><a href="Context.html" title="TypeProf::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Context.html#new-class_method" title="TypeProf::Context.new (method)">new</a></span>(<span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_cref'>cref</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_mid'>mid</span>)
      <span class='id identifier rubyid_nep'>nep</span> <span class='op'>=</span> <span class='const'><a href="ExecutionPoint.html" title="TypeProf::ExecutionPoint (class)">ExecutionPoint</a></span>.<span class='id identifier rubyid_new'><a href="ExecutionPoint.html#new-class_method" title="TypeProf::ExecutionPoint.new (method)">new</a></span>(<span class='id identifier rubyid_nctx'>nctx</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_cont_ep'>cont_ep</span>)
      <span class='id identifier rubyid_locals'>locals</span> <span class='op'>=</span> [<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span>] <span class='op'>*</span> <span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_locals'>locals</span>.<span class='id identifier rubyid_size'>size</span>
      <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='const'><a href="Env.html" title="TypeProf::Env (class)">Env</a></span>.<span class='id identifier rubyid_new'><a href="Env.html#new-class_method" title="TypeProf::Env.new (method)">new</a></span>(<span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_static_env'>static_env</span><span class='comma'>,</span> <span class='id identifier rubyid_locals'>locals</span><span class='comma'>,</span> []<span class='comma'>,</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/HashWrapper.html" title="TypeProf::Utils::HashWrapper (class)">HashWrapper</a></span>.<span class='id identifier rubyid_new'><a href="Utils/HashWrapper.html#new-class_method" title="TypeProf::Utils::HashWrapper.new (method)">new</a></span>({}))
      <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_nep'>nep</span><span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
      <span class='id identifier rubyid_add_callsite!'><a href="#add_callsite!-instance_method" title="TypeProf::Scratch#add_callsite! (method)">add_callsite!</a></span>(<span class='id identifier rubyid_nep'>nep</span>.<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_cont_ep'>cont_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_cont_env'>cont_env</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
        <span class='id identifier rubyid_nenv'>nenv</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_ty'>ret_ty</span> <span class='op'>=</span> <span class='id identifier rubyid_localize_type'><a href="#localize_type-instance_method" title="TypeProf::Scratch#localize_type (method)">localize_type</a></span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
        <span class='id identifier rubyid_nenv'>nenv</span> <span class='op'>=</span> <span class='id identifier rubyid_nenv'>nenv</span>.<span class='id identifier rubyid_push'>push</span>(<span class='id identifier rubyid_ret_ty'>ret_ty</span>)
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_jump'>jump</span>(<span class='id identifier rubyid_cont'>cont</span>)<span class='comma'>,</span> <span class='id identifier rubyid_nenv'>nenv</span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="traverse_subclasses-instance_method">
  <h3 class='signature '>
    #<strong>traverse_subclasses</strong>(klass, &amp;blk)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L535-L540'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='535' data-end='540'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 535</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_traverse_subclasses'>traverse_subclasses</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_idx'>idx</span>].<span class='id identifier rubyid_subclasses'>subclasses</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subclass'>subclass</span><span class='op'>|</span>
    <span class='kw'>yield</span> <span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_subclass'>subclass</span>]
    <span class='id identifier rubyid_traverse_subclasses'>traverse_subclasses</span>(<span class='ivar'>@class_defs</span>[<span class='id identifier rubyid_subclass'>subclass</span>].<span class='id identifier rubyid_klass_obj'>klass_obj</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="type_profile-instance_method">
  <h3 class='signature '>
    #<strong>type_profile</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L927-L1006'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='927' data-end='1006'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 927</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_type_profile'>type_profile</span>
  <span class='id identifier rubyid_start_time'>start_time</span> <span class='op'>=</span> <span class='id identifier rubyid_tick'>tick</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>
  <span class='id identifier rubyid_iter_counter'>iter_counter</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_stat_eps'>stat_eps</span> <span class='op'>=</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/MutableSet.html" title="TypeProf::Utils::MutableSet (class)">MutableSet</a></span>.<span class='id identifier rubyid_new'><a href="Utils/MutableSet.html#new-class_method" title="TypeProf::Utils::MutableSet.new (method)">new</a></span>

  <span class='id identifier rubyid_prologue_ctx'>prologue_ctx</span> <span class='op'>=</span> <span class='const'><a href="Context.html" title="TypeProf::Context (class)">Context</a></span>.<span class='id identifier rubyid_new'><a href="Context.html#new-class_method" title="TypeProf::Context.new (method)">new</a></span>(<span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_prologue_ep'>prologue_ep</span> <span class='op'>=</span> <span class='const'><a href="ExecutionPoint.html" title="TypeProf::ExecutionPoint (class)">ExecutionPoint</a></span>.<span class='id identifier rubyid_new'><a href="ExecutionPoint.html#new-class_method" title="TypeProf::ExecutionPoint.new (method)">new</a></span>(<span class='id identifier rubyid_prologue_ctx'>prologue_ctx</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_prologue_env'>prologue_env</span> <span class='op'>=</span> <span class='const'><a href="Env.html" title="TypeProf::Env (class)">Env</a></span>.<span class='id identifier rubyid_new'><a href="Env.html#new-class_method" title="TypeProf::Env.new (method)">new</a></span>(<span class='const'><a href="StaticEnv.html" title="TypeProf::StaticEnv (class)">StaticEnv</a></span>.<span class='id identifier rubyid_new'><a href="StaticEnv.html#new-class_method" title="TypeProf::StaticEnv.new (method)">new</a></span>(<span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_bot'><a href="Type.html#bot-class_method" title="TypeProf::Type.bot (method)">bot</a></span><span class='comma'>,</span> <span class='const'><a href="Type.html" title="TypeProf::Type (class)">Type</a></span>.<span class='id identifier rubyid_nil'><a href="Type.html#nil-class_method" title="TypeProf::Type.nil (method)">nil</a></span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>true</span>)<span class='comma'>,</span> []<span class='comma'>,</span> []<span class='comma'>,</span> <span class='const'><a href="Utils.html" title="TypeProf::Utils (module)">Utils</a></span><span class='op'>::</span><span class='const'><a href="Utils/HashWrapper.html" title="TypeProf::Utils::HashWrapper (class)">HashWrapper</a></span>.<span class='id identifier rubyid_new'><a href="Utils/HashWrapper.html#new-class_method" title="TypeProf::Utils::HashWrapper.new (method)">new</a></span>({}))

  <span class='kw'>until</span> <span class='ivar'>@entrypoints</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_entrypoint'>entrypoint</span> <span class='op'>=</span> <span class='ivar'>@entrypoints</span>.<span class='id identifier rubyid_shift'>shift</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_entrypoint'>entrypoint</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>String</span>)
      <span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='id identifier rubyid_entrypoint'>entrypoint</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='ivar'>@loaded_files</span>[<span class='const'>File</span>.<span class='id identifier rubyid_expand_path'>expand_path</span>(<span class='id identifier rubyid_file'>file</span>)]
      <span class='id identifier rubyid_iseq'>iseq</span> <span class='op'>=</span> <span class='const'><a href="ISeq.html" title="TypeProf::ISeq (class)">ISeq</a></span>.<span class='id identifier rubyid_compile'><a href="ISeq.html#compile-class_method" title="TypeProf::ISeq.compile (method)">compile</a></span>(<span class='id identifier rubyid_file'>file</span>)
    <span class='kw'>else</span>
      <span class='id identifier rubyid_iseq'>iseq</span> <span class='op'>=</span> <span class='id identifier rubyid_entrypoint'>entrypoint</span>
    <span class='kw'>end</span>

    <span class='ivar'>@loaded_files</span>[<span class='id identifier rubyid_iseq'>iseq</span>.<span class='id identifier rubyid_absolute_path'>absolute_path</span>] <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='const'><a href="../TypeProf.html" title="TypeProf (module)">TypeProf</a></span>.<span class='id identifier rubyid_starting_state'><a href="../TypeProf.html#starting_state-class_method" title="TypeProf.starting_state (method)">starting_state</a></span>(<span class='id identifier rubyid_iseq'>iseq</span>)
    <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
    <span class='id identifier rubyid_add_callsite!'><a href="#add_callsite!-instance_method" title="TypeProf::Scratch#add_callsite! (method)">add_callsite!</a></span>(<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_prologue_ep'>prologue_ep</span><span class='comma'>,</span> <span class='id identifier rubyid_prologue_env'>prologue_env</span>) {<span class='op'>|</span><span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='op'>|</span> }

    <span class='kw'>while</span> <span class='kw'>true</span>
      <span class='kw'>until</span> <span class='ivar'>@worklist</span>.<span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_ep'>ep</span> <span class='op'>=</span> <span class='ivar'>@worklist</span>.<span class='id identifier rubyid_deletemin'>deletemin</span>

        <span class='id identifier rubyid_iter_counter'>iter_counter</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='kw'>if</span> <span class='const'>Config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_show_indicator'>show_indicator</span>]
          <span class='id identifier rubyid_tick2'>tick2</span> <span class='op'>=</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_tick2'>tick2</span> <span class='op'>-</span> <span class='id identifier rubyid_tick'>tick</span> <span class='op'>&gt;=</span> <span class='int'>1</span>
            <span class='id identifier rubyid_tick'>tick</span> <span class='op'>=</span> <span class='id identifier rubyid_tick2'>tick2</span>
            <span class='gvar'>$stderr</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\rType Profiling... (%d instructions @ %s)\e[K</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> [<span class='id identifier rubyid_iter_counter'>iter_counter</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_source_location'>source_location</span>]
            <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_flush'>flush</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='kw'>if</span> (<span class='const'>Config</span>.<span class='id identifier rubyid_max_sec'>max_sec</span> <span class='op'>&amp;&amp;</span> <span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_start_time'>start_time</span> <span class='op'>&gt;=</span> <span class='const'>Config</span>.<span class='id identifier rubyid_max_sec'>max_sec</span>) <span class='op'>||</span> (<span class='const'>Config</span>.<span class='id identifier rubyid_max_iter'>max_iter</span> <span class='op'>&amp;&amp;</span> <span class='const'>Config</span>.<span class='id identifier rubyid_max_iter'>max_iter</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_iter_counter'>iter_counter</span>)
          <span class='ivar'>@terminated</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='kw'>break</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_stat_eps'>stat_eps</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ep'>ep</span>
        <span class='id identifier rubyid_step'><a href="#step-instance_method" title="TypeProf::Scratch#step (method)">step</a></span>(<span class='id identifier rubyid_ep'>ep</span>)
      <span class='kw'>end</span>

      <span class='kw'>break</span> <span class='kw'>if</span> <span class='ivar'>@terminated</span>

      <span class='kw'>break</span> <span class='kw'>unless</span> <span class='const'>Config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_stub_execution'>stub_execution</span>]

      <span class='kw'>begin</span>
        <span class='id identifier rubyid_iseq'>iseq</span><span class='comma'>,</span> (<span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_dummy_continuation'>dummy_continuation</span>) <span class='op'>=</span> <span class='ivar'>@pending_execution</span>.<span class='id identifier rubyid_first'>first</span>
        <span class='kw'>break</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_iseq'>iseq</span>
        <span class='ivar'>@pending_execution</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='id identifier rubyid_iseq'>iseq</span>)
      <span class='kw'>end</span> <span class='kw'>while</span> <span class='ivar'>@executed_iseqs</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_iseq'>iseq</span>)

      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: trigger stub execution (</span><span class='embexpr_beg'>#{</span> <span class='id identifier rubyid_iseq'>iseq</span><span class='op'>&amp;.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(nil)</span><span class='tstring_end'>&quot;</span></span> <span class='embexpr_end'>}</span><span class='tstring_content'>): rest </span><span class='embexpr_beg'>#{</span> <span class='ivar'>@pending_execution</span>.<span class='id identifier rubyid_size'>size</span> <span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>Config</span>.<span class='id identifier rubyid_verbose'>verbose</span> <span class='op'>&gt;=</span> <span class='int'>2</span>

      <span class='kw'>break</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_iseq'>iseq</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_kind'>kind</span>
      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_method'>method</span>
        <span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_dummy_continuation'>dummy_continuation</span>
        <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
        <span class='id identifier rubyid_add_iseq_method_call!'><a href="#add_iseq_method_call!-instance_method" title="TypeProf::Scratch#add_iseq_method_call! (method)">add_iseq_method_call!</a></span>(<span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>)

      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_block'>block</span>
        <span class='id identifier rubyid_blk'>blk</span><span class='comma'>,</span> <span class='id identifier rubyid_epenvs'>epenvs</span> <span class='op'>=</span> <span class='id identifier rubyid_dummy_continuation'>dummy_continuation</span>
        <span class='id identifier rubyid_epenvs'>epenvs</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
          <span class='id identifier rubyid_merge_env'><a href="#merge_env-instance_method" title="TypeProf::Scratch#merge_env (method)">merge_env</a></span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span>)
          <span class='id identifier rubyid_add_block_to_ctx!'><a href="#add_block_to_ctx!-instance_method" title="TypeProf::Scratch#add_block_to_ctx! (method)">add_block_to_ctx!</a></span>(<span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_block_body'>block_body</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_ctx'>ctx</span>)
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\e[K</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>Config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_show_indicator'>show_indicator</span>]

  <span class='id identifier rubyid_stat_eps'>stat_eps</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="update_container_elem_types-instance_method">
  <h3 class='signature '>
    #<strong>update_container_elem_types</strong>(env, ep, id, base_type)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L877-L904'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='877' data-end='904'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 877</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_update_container_elem_types'>update_container_elem_types</span>(<span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_base_type'>base_type</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_ep'>ep</span>
    <span class='id identifier rubyid_tmp_ep'>tmp_ep</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span> <span class='kw'>while</span> <span class='id identifier rubyid_tmp_ep'>tmp_ep</span>.<span class='id identifier rubyid_outer'>outer</span>
    <span class='id identifier rubyid_merge_return_env'><a href="#merge_return_env-instance_method" title="TypeProf::Scratch#merge_return_env (method)">merge_return_env</a></span>(<span class='id identifier rubyid_tmp_ep'>tmp_ep</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_menv'>menv</span><span class='op'>|</span>
      <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='id identifier rubyid_menv'>menv</span>.<span class='id identifier rubyid_get_container_elem_types'><a href="#get_container_elem_types-instance_method" title="TypeProf::Scratch#get_container_elem_types (method)">get_container_elem_types</a></span>(<span class='id identifier rubyid_id'>id</span>)
      <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='kw'>yield</span> <span class='id identifier rubyid_elems'>elems</span>
      <span class='id identifier rubyid_menv'>menv</span> <span class='op'>=</span> <span class='id identifier rubyid_menv'>menv</span>.<span class='id identifier rubyid_deploy_type'>deploy_type</span>(<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span>)
      <span class='id identifier rubyid_gid'>gid</span> <span class='op'>=</span> <span class='ivar'>@alloc_site_to_global_id</span>[<span class='id identifier rubyid_id'>id</span>]
      <span class='kw'>if</span> <span class='id identifier rubyid_gid'>gid</span>
        <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_to_local_type'>to_local_type</span>(<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_base_type'>base_type</span>)<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
        <span class='id identifier rubyid_add_ivar_write!'><a href="#add_ivar_write!-instance_method" title="TypeProf::Scratch#add_ivar_write! (method)">add_ivar_write!</a></span>(<span class='op'>*</span><span class='id identifier rubyid_gid'>gid</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='kw'>end</span>
      <span class='id identifier rubyid_menv'>menv</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_get_container_elem_types'><a href="#get_container_elem_types-instance_method" title="TypeProf::Scratch#get_container_elem_types (method)">get_container_elem_types</a></span>(<span class='id identifier rubyid_id'>id</span>)
    <span class='id identifier rubyid_elems'>elems</span> <span class='op'>=</span> <span class='kw'>yield</span> <span class='id identifier rubyid_elems'>elems</span>
    <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span>.<span class='id identifier rubyid_deploy_type'>deploy_type</span>(<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_elems'>elems</span>)
    <span class='id identifier rubyid_gid'>gid</span> <span class='op'>=</span> <span class='ivar'>@alloc_site_to_global_id</span>[<span class='id identifier rubyid_id'>id</span>]
    <span class='kw'>if</span> <span class='id identifier rubyid_gid'>gid</span>
      <span class='id identifier rubyid_ty'>ty</span> <span class='op'>=</span> <span class='id identifier rubyid_globalize_type'><a href="#globalize_type-instance_method" title="TypeProf::Scratch#globalize_type (method)">globalize_type</a></span>(<span class='id identifier rubyid_elems'>elems</span>.<span class='id identifier rubyid_to_local_type'>to_local_type</span>(<span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_base_type'>base_type</span>)<span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
      <span class='id identifier rubyid_add_ivar_write!'><a href="#add_ivar_write!-instance_method" title="TypeProf::Scratch#add_ivar_write! (method)">add_ivar_write!</a></span>(<span class='op'>*</span><span class='id identifier rubyid_gid'>gid</span><span class='comma'>,</span> <span class='id identifier rubyid_ty'>ty</span><span class='comma'>,</span> <span class='id identifier rubyid_ep'>ep</span>)
    <span class='kw'>end</span>
    <span class='id identifier rubyid_env'>env</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="warn-instance_method">
  <h3 class='signature '>
    #<strong>warn</strong>(ep, msg)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/typeprof/blob/v0.15.2/lib/typeprof/analyzer.rb#L853-L856'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='853' data-end='856'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/typeprof/analyzer.rb', line 853</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_warn'>warn</span>(<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span>)
  <span class='id identifier rubyid_p'>p</span> [<span class='id identifier rubyid_ep'>ep</span>.<span class='id identifier rubyid_source_location'>source_location</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[warning] </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_msg'>msg</span>] <span class='kw'>if</span> <span class='const'>Config</span>.<span class='id identifier rubyid_verbose'>verbose</span> <span class='op'>&gt;=</span> <span class='int'>2</span>
  <span class='ivar'>@errors</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_ep'>ep</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[warning] </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_msg'>msg</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>