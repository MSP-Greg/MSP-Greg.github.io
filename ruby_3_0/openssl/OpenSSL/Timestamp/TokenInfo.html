<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: OpenSSL::Timestamp::TokenInfo &mdash; openssl</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL::Timestamp::TokenInfo",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../'>Ruby-3.0.6</a> &raquo; 
      <a href='../../'>openssl</a> &raquo; 
      <a href='../../_index.html#alpha_T'>Index (T)</a> &raquo; 
        <a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a> &raquo; 
        <a href="../Timestamp.html" title="OpenSSL::Timestamp (module)">Timestamp</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>TokenInfo&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: OpenSSL::Timestamp::TokenInfo</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L1350'>ext/openssl/ossl_ts.c</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Immutable and read-only representation of a timestamp token info from a <a href="Response.html" title="OpenSSL::Timestamp::Response (class)"><code>Response</code></a>.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(file)  &#x21d2; token-info </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a <code>TokenInfo</code> from a <code>File</code> or <code>string</code> parameter, the corresponding <code>File</code> or <code>string</code> must be DER-encoded.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#algorithm-instance_method" title="#algorithm (instance method)">#<strong>algorithm</strong>  &#x21d2; String<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the ‘short name’ of the object identifier representing the algorithm that was used to derive the message imprint digest.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#gen_time-instance_method" title="#gen_time (instance method)">#<strong>gen_time</strong>  &#x21d2; Time </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns time when this timestamp token was created.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#message_imprint-instance_method" title="#msg_imprint (instance method)">#<strong>msg_imprint</strong>  &#x21d2; string. </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the message imprint digest.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#nonce-instance_method" title="#nonce (instance method)">#<strong>nonce</strong>  &#x21d2; BN<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>If the timestamp token is valid then this field contains the same nonce that was passed to the timestamp server in the initial <a href="Request.html" title="OpenSSL::Timestamp::Request (class)"><code>Request</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ordering-instance_method" title="#ordering (instance method)">#<strong>ordering</strong>  &#x21d2; true, ... </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>If the ordering field is missing, or if the ordering field is present and set to false, then the genTime field only indicates the time at which the time-stamp token has been created by the TSA.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#policy_id-instance_method" title="#policy_id (instance method)">#<strong>policy_id</strong>  &#x21d2; String<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the timestamp policy object identifier of the policy this timestamp was created under.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#serial_number-instance_method" title="#serial_number (instance method)">#<strong>serial_number</strong>  &#x21d2; BN<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns serial number of the timestamp token.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_der-instance_method" title="#to_der (instance method)">#<strong>to_der</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the <code>TokenInfo</code> in DER-encoded form.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#version-instance_method" title="#version (instance method)">#<strong>version</strong>  &#x21d2; Integer<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the version number of the token info.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    <div class='inline-block'>
      <span class='overload'>.<strong>new</strong>(file)  &#x21d2; <code>token</code>-<code>info</code> </span>
      <span class='overload'>.<strong>new</strong>(string)  &#x21d2; <code>token</code>-<code>info</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a <code>TokenInfo</code> from a <code>File</code> or <code>string</code> parameter, the corresponding <code>File</code> or <code>string</code> must be DER-encoded. Please note that <code>TokenInfo</code> is an immutable read-only class. If you’d like to create timestamps please refer to <a href="Factory.html" title="OpenSSL::Timestamp::Factory (class)"><code>Factory</code></a> instead.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L868-L885'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='868' data-end='885'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 868</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_initialize(VALUE self, VALUE der)
{
    TS_TST_INFO *info = DATA_PTR(self);
    BIO *in;

    der = ossl_to_der_if_possible(der);
    in  = ossl_obj2bio(&amp;der);
    info = d2i_TS_TST_INFO_bio(in, &amp;info);
    BIO_free(in);
    if (!info) {
        DATA_PTR(self) = NULL;
        ossl_raise(eTimestampError, &quot;Error when decoding the timestamp token info&quot;);
    }
    DATA_PTR(self) = info;

    return self;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="algorithm-instance_method">
  <h3 class='signature  first'>
    #<strong>algorithm</strong>  &#x21d2; <code>String</code><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the ‘short name’ of the object identifier representing the algorithm that was used to derive the message imprint digest. For valid timestamps, this is the same value that was already given in the <a href="Request.html" title="OpenSSL::Timestamp::Request (class)"><code>Request</code></a>. If status is GRANTED or GRANTED_WITH_MODS, this is never <code>nil</code>.</p>

<h3 id="label-Example-3A">Example:</h3>

<pre class="code ruby"><code class="ruby">algo = token_info.algorithm
puts algo                -&gt; &quot;SHA1&quot;</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L938-L949'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='938' data-end='949'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 938</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_algorithm(VALUE self)
{
    TS_TST_INFO *info;
    TS_MSG_IMPRINT *mi;
    X509_ALGOR *algo;

    GetTSTokenInfo(self, info);
    mi = TS_TST_INFO_get_msg_imprint(info);
    algo = TS_MSG_IMPRINT_get_algo(mi);
    return get_asn1obj(algo-&gt;algorithm);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="gen_time-instance_method">
  <h3 class='signature '>
    #<strong>gen_time</strong>  &#x21d2; <code>Time</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns time when this timestamp token was created. If status is GRANTED or GRANTED_WITH_MODS, this is never <code>nil</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L1003-L1010'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1003' data-end='1010'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 1003</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_gen_time(VALUE self)
{
    TS_TST_INFO *info;

    GetTSTokenInfo(self, info);
    return asn1time_to_time(TS_TST_INFO_get_time(info));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="message_imprint-instance_method">
  <h3 class='signature '>
    #<strong>msg_imprint</strong>  &#x21d2; <code>string</code>.   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the message imprint digest. For valid timestamps, this is the same value that was already given in the <a href="Request.html" title="OpenSSL::Timestamp::Request (class)"><code>Request</code></a>. If status is GRANTED or GRANTED_WITH_MODS, this is never <code>nil</code>.</p>

<h3 id="label-Example-3A">Example:</h3>

<pre class="code ruby"><code class="ruby">mi = token_info.msg_imprint
puts mi                -&gt; &quot;DEADBEEF&quot;</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L963-L977'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='963' data-end='977'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 963</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_msg_imprint(VALUE self)
{
    TS_TST_INFO *info;
    TS_MSG_IMPRINT *mi;
    ASN1_OCTET_STRING *hashed_msg;
    VALUE ret;

    GetTSTokenInfo(self, info);
    mi = TS_TST_INFO_get_msg_imprint(info);
    hashed_msg = TS_MSG_IMPRINT_get_msg(mi);
    ret = rb_str_new((const char *)hashed_msg-&gt;data, hashed_msg-&gt;length);

    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="nonce-instance_method">
  <h3 class='signature '>
    #<strong>nonce</strong>  &#x21d2; <a href="../BN.html" title="OpenSSL::BN (class)">BN</a><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>If the timestamp token is valid then this field contains the same nonce that was passed to the timestamp server in the initial <a href="Request.html" title="OpenSSL::Timestamp::Request (class)"><code>Request</code></a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L1045-L1056'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1045' data-end='1056'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 1045</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_nonce(VALUE self)
{
    TS_TST_INFO *info;
    const ASN1_INTEGER *nonce;

    GetTSTokenInfo(self, info);
    if (!(nonce = TS_TST_INFO_get_nonce(info)))
        return Qnil;

    return asn1integer_to_num(nonce);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ordering-instance_method">
  <h3 class='signature '>
    #<strong>ordering</strong>  &#x21d2; <code>true</code>, ...   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>If the ordering field is missing, or if the ordering field is present and set to false, then the genTime field only indicates the time at which the time-stamp token has been created by the TSA.  In such a case, the ordering of time-stamp tokens issued by the same TSA or different TSAs is only possible when the difference between the genTime of the first time-stamp token and the genTime of the second time-stamp token is greater than the sum of the accuracies of the genTime for each time-stamp token.</p>

<p>If the ordering field is present and set to true, every time-stamp token from the same TSA can always be ordered based on the genTime field, regardless of the genTime accuracy.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L1029-L1036'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1029' data-end='1036'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 1029</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_ordering(VALUE self)
{
    TS_TST_INFO *info;

    GetTSTokenInfo(self, info);
    return TS_TST_INFO_get_ordering(info) ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="policy_id-instance_method">
  <h3 class='signature '>
    #<strong>policy_id</strong>  &#x21d2; <code>String</code><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the timestamp policy object identifier of the policy this timestamp was created under. If status is GRANTED or GRANTED_WITH_MODS, this is never <code>nil</code>.</p>

<h3 id="label-Example-3A">Example:</h3>

<pre class="code ruby"><code class="ruby">id = token_info.policy_id
puts id                 -&gt; &quot;1.2.3.4.5&quot;</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L916-L923'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='916' data-end='923'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 916</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_policy_id(VALUE self)
{
    TS_TST_INFO *info;

    GetTSTokenInfo(self, info);
    return get_asn1obj(TS_TST_INFO_get_policy_id(info));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="serial_number-instance_method">
  <h3 class='signature '>
    #<strong>serial_number</strong>  &#x21d2; <a href="../BN.html" title="OpenSSL::BN (class)">BN</a><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns serial number of the timestamp token. This value shall never be the same for two timestamp tokens issued by a dedicated timestamp authority. If status is GRANTED or GRANTED_WITH_MODS, this is never <code>nil</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L987-L994'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='987' data-end='994'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 987</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_serial_number(VALUE self)
{
    TS_TST_INFO *info;

    GetTSTokenInfo(self, info);
    return asn1integer_to_num(TS_TST_INFO_get_serial(info));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_der-instance_method">
  <h3 class='signature '>
    #<strong>to_der</strong>  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the <code>TokenInfo</code> in DER-encoded form.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L1064-L1071'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1064' data-end='1071'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 1064</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_to_der(VALUE self)
{
    TS_TST_INFO *info;

    GetTSTokenInfo(self, info);
    return asn1_to_der((void *)info, (int (*)(void *, unsigned char **))i2d_TS_TST_INFO);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="version-instance_method">
  <h3 class='signature '>
    #<strong>version</strong>  &#x21d2; <a href="../../Integer.html" title="Integer (class)">Integer</a><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the version number of the token info. With compliant servers, this value should be <code>1</code> if present. If status is GRANTED or GRANTED_WITH_MODS.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_0_6/ext/openssl/ossl_ts.c#L895-L902'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='895' data-end='902'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_ts.c', line 895</span></pre>
<pre class='code cpp'>

static VALUE
ossl_ts_token_info_get_version(VALUE self)
{
    TS_TST_INFO *info;

    GetTSTokenInfo(self, info);
    return LONG2NUM(TS_TST_INFO_get_version(info));
}
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>