<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: FFI::Library &mdash; FFI master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "FFI::Library",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>FFI master</a> &raquo; 
      <a href='../_index.html#alpha_L'>Index (L)</a> &raquo; 
        <a href="../FFI.html" title="FFI (module)">FFI</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Library&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: FFI::Library</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L72'>lib/ffi/library.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>This module is the base to use native functions.</p>

<p>A basic usage may be:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ffi</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>module</span> <span class='const'>Hello</span>
  <span class='id identifier rubyid_extend'>extend</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'>Library</span>
  <span class='id identifier rubyid_ffi_lib'><a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">ffi_lib</a></span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'>Library</span><span class='op'>::</span><span class='const'><a href="#LIBC-constant" title="FFI::Library::LIBC (constant)">LIBC</a></span>
  <span class='id identifier rubyid_attach_function'><a href="#attach_function-instance_method" title="FFI::Library#attach_function (method)">attach_function</a></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>puts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> [ <span class='symbeg'>:</span><span class='id identifier rubyid_string'>string</span> ]<span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_int'>int</span>
<span class='kw'>end</span>

<span class='const'>Hello</span>.<span class='id identifier rubyid_puts'>puts</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, World</span><span class='tstring_end'>&quot;</span></span>)</code></pre>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='CURRENT_PROCESS-constant' class='summary_signature'>CURRENT_PROCESS =</span>
    <br/>
    <a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L73-L73'># File 'lib/ffi/library.rb', line 73</a>    <pre class='code ruby'><span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="../FFI.html#CURRENT_PROCESS-constant" title="FFI::CURRENT_PROCESS (constant)">CURRENT_PROCESS</a></span></pre>
  </li>
  <li>
    <span id='FlagsMap-constant' class='summary_signature'>FlagsMap =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Flags used in <a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a>.</p>

<p>This map allows you to supply symbols to <a href="#ffi_lib_flags-instance_method" title="FFI::Library#ffi_lib_flags (method)">#ffi_lib_flags</a> instead of the actual constants.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L125-L130'># File 'lib/ffi/library.rb', line 125</a>    <pre class='code ruby'>{
  <span class='symbeg'>:</span><span class='id identifier rubyid_global'>global</span> <span class='op'>=&gt;</span> <span class='const'><a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">DynamicLibrary</a></span><span class='op'>::</span><span class='const'>RTLD_GLOBAL</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_local'>local</span> <span class='op'>=&gt;</span> <span class='const'><a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">DynamicLibrary</a></span><span class='op'>::</span><span class='const'>RTLD_LOCAL</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_lazy'>lazy</span> <span class='op'>=&gt;</span> <span class='const'><a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">DynamicLibrary</a></span><span class='op'>::</span><span class='const'>RTLD_LAZY</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_now'>now</span> <span class='op'>=&gt;</span> <span class='const'><a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">DynamicLibrary</a></span><span class='op'>::</span><span class='const'>RTLD_NOW</span>
}</pre>
  </li>
  <li>
    <span id='LIBC-constant' class='summary_signature'>LIBC =</span>
    <br/>
    <a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L74-L74'># File 'lib/ffi/library.rb', line 74</a>    <pre class='code ruby'><span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Platform.html" title="FFI::Platform (module)">Platform</a></span><span class='op'>::</span><span class='const'><a href="Platform.html#LIBC-constant" title="FFI::Platform::LIBC (constant)">LIBC</a></span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#extended-class_method" title=".extended (class method)">.<strong>extended</strong>(mod)  &#x21d2; nil </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Test if extended object is a Module.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#attach_function-instance_method" title="#attach_function (instance method)">#<strong>attach_function</strong>(func, args, returns, options = {})  &#x21d2; FFI::VariadicInvoker </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Attach C function <code>func</code> to this module.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attach_variable-instance_method" title="#attach_variable (instance method)">#<strong>attach_variable</strong>(mname, cname, type)  &#x21d2; DynamicLibrary::Symbol </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Attach C variable <code>cname</code> to this module.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attached_functions-instance_method" title="#attached_functions (instance method)">#<strong>attached_functions</strong>  &#x21d2; Hash&lt; Symbol =&gt; [FFI::Function, FFI::VariadicInvoker] &gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Retrieve all attached functions and their function signature.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attached_variables-instance_method" title="#attached_variables (instance method)">#<strong>attached_variables</strong>  &#x21d2; Hash&lt; Symbol =&gt; ffi_type &gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Retrieve all attached variables and their type.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#bitmask-instance_method" title="#bitmask (instance method)">#<strong>bitmask</strong>(name, values)  &#x21d2; FFI::Bitmask </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Create a new <a href="Bitmask.html" title="FFI::Bitmask (class)"><code>Bitmask</code></a></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#callback-instance_method" title="#callback (instance method)">#<strong>callback</strong>(name, params, ret)  &#x21d2; FFI::CallbackInfo </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enum-instance_method" title="#enum (instance method)">#<strong>enum</strong>(name, values)  &#x21d2; FFI::Enum </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Create a new <a href="Enum.html" title="FFI::Enum (class)"><code>Enum</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enum_type-instance_method" title="#enum_type (instance method)">#<strong>enum_type</strong>(name)  &#x21d2; FFI::Enum </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Find an enum by name.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enum_value-instance_method" title="#enum_value (instance method)">#<strong>enum_value</strong>(symbol)  &#x21d2; FFI::Enum </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Find an enum by a symbol it contains.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ffi_convention-instance_method" title="#ffi_convention (instance method)">#<strong>ffi_convention</strong>(convention = nil)  &#x21d2; Symbol </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the calling convention for <a href="#attach_function-instance_method" title="FFI::Library#attach_function (method)">#attach_function</a> and <a href="#callback-instance_method" title="FFI::Library#callback (method)">#callback</a></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ffi_lib-instance_method" title="#ffi_lib (instance method)">#<strong>ffi_lib</strong>(*names)  &#x21d2; Array&lt;DynamicLibrary&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Load native libraries.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ffi_lib_flags-instance_method" title="#ffi_lib_flags (instance method)">#<strong>ffi_lib_flags</strong>(*flags)  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets library flags for <a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ffi_libraries-instance_method" title="#ffi_libraries (instance method)">#<strong>ffi_libraries</strong>  &#x21d2; Array&lt;FFI::DynamicLibrary&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get FFI libraries loaded using <a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#find_type-instance_method" title="#find_type (instance method)">#<strong>find_type</strong>(t)  &#x21d2; Type </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Find a type definition.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#freeze-instance_method" title="#freeze (instance method)">#<strong>freeze</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Freeze all definitions of the module.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#function_names-instance_method" title="#function_names (instance method)">#<strong>function_names</strong>(name, arg_types)  &#x21d2; Array&lt;String&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This function returns a list of possible names to lookup.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#typedef-instance_method" title="#typedef (instance method)">#<strong>typedef</strong>(old, add, info = nil)  &#x21d2; FFI::Enum, FFI::Type </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Register or get an already registered type definition.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#generic_enum-instance_method" title="#generic_enum (instance method)">#<strong>generic_enum</strong>(klass, *args)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Generic enum builder  @param [Class] klass can be one of <a href="Enum.html" title="FFI::Enum (class)"><code>Enum</code></a> or <a href="Bitmask.html" title="FFI::Bitmask (class)"><code>Bitmask</code></a>  @param args (see #enum or #bitmask).</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="extended-class_method">
  <h3 class='signature  first'>
    .<strong>extended</strong>(mod)  &#x21d2; <code>nil</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Test if extended object is a Module. If not, raise <a href="../RuntimeError.html" title="RuntimeError (class)"><code>::RuntimeError</code></a>.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>mod</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>extended object</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="../RuntimeError.html" title="RuntimeError (class)">RuntimeError</a>)</span>
&mdash;    <div class='inline'>
<p>if <code>mod</code> is not a Module</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L80-L82'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='80' data-end='82'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 80</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_extended'>extended</span>(<span class='id identifier rubyid_mod'>mod</span>)
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../RuntimeError.html" title="RuntimeError (class)">RuntimeError</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>must only be extended by module</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>unless</span> <span class='id identifier rubyid_mod'>mod</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='op'>::</span><span class='const'>Module</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="attach_function-instance_method">
  <h3 class='signature  first'>
    <div class='inline-block'>
      <span class='overload'>#<strong>attach_function</strong>(func, args, returns, options = {})  &#x21d2; <a href="VariadicInvoker.html" title="FFI::VariadicInvoker (class)">FFI::VariadicInvoker</a> </span>
      <span class='overload'>#<strong>attach_function</strong>(name, func, args, returns, options = {})  &#x21d2; <a href="VariadicInvoker.html" title="FFI::VariadicInvoker (class)">FFI::VariadicInvoker</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Attach C function <code>func</code> to this module.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(#<code>to_s</code>)</span>
&mdash;    <div class='inline'>
<p>name of ruby method to attach as</p>
</div>
  </li>
  <li>
    <span class='name'>func</span>
    <span class='type'>(#<code>to_s</code>)</span>
&mdash;    <div class='inline'>
<p>name of C function to attach</p>
</div>
  </li>
  <li>
    <span class='name'>args</span>
    <span class='type'>(<code>Array</code>&lt;<code>Symbol</code>&gt;)</span>
&mdash;    <div class='inline'>
<p>an array of types</p>
</div>
  </li>
  <li>
    <span class='name'>returns</span>
    <span class='type'>(<code>Symbol</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>type of return value</p>
</div>
  </li>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>a customizable set of options</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>options</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:blocking</span>
          <span class='type'>(<code>Boolean</code>)</span>
          <span class='default'> &mdash; default:
              <tt>@blocking</tt>          </span>
            &mdash; <div class='inline'>
<p>set to true if the C function is a blocking call</p>
</div>        </li>
        <li>
          <span class='name'>:convention</span>
          <span class='type'>(<code>Symbol</code>)</span>
          <span class='default'> &mdash; default:
              <tt>:default</tt>          </span>
            &mdash; <div class='inline'>
<p>calling convention (see <a href="#ffi_convention-instance_method" title="FFI::Library#ffi_convention (method)">#ffi_convention</a>)</p>
</div>        </li>
        <li>
          <span class='name'>:enums</span>
          <span class='type'>(<a href="Enums.html" title="FFI::Enums (class)">FFI::Enums</a>)</span>
        </li>
        <li>
          <span class='name'>:type_map</span>
          <span class='type'>(<code>Hash</code>)</span>
        </li>
    </ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="NotFoundError.html" title="FFI::NotFoundError (class)">FFI::NotFoundError</a>)</span>
&mdash;    <div class='inline'>
<p>if <code>func</code> cannot be found in the attached libraries (see <a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a>)</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L177-L220'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='177' data-end='220'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 177</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attach_function'>attach_function</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_returns'>returns</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_mname'>mname</span><span class='comma'>,</span> <span class='id identifier rubyid_a2'>a2</span><span class='comma'>,</span> <span class='id identifier rubyid_a3'>a3</span><span class='comma'>,</span> <span class='id identifier rubyid_a4'>a4</span><span class='comma'>,</span> <span class='id identifier rubyid_a5'>a5</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_returns'>returns</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>
  <span class='id identifier rubyid_cname'>cname</span><span class='comma'>,</span> <span class='id identifier rubyid_arg_types'>arg_types</span><span class='comma'>,</span> <span class='id identifier rubyid_ret_type'>ret_type</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> (<span class='id identifier rubyid_a4'>a4</span> <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_a2'>a2</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>String</span>) <span class='op'>||</span> <span class='id identifier rubyid_a2'>a2</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Symbol</span>))) <span class='op'>?</span> [ <span class='id identifier rubyid_a2'>a2</span><span class='comma'>,</span> <span class='id identifier rubyid_a3'>a3</span><span class='comma'>,</span> <span class='id identifier rubyid_a4'>a4</span><span class='comma'>,</span> <span class='id identifier rubyid_a5'>a5</span> ] <span class='op'>:</span> [ <span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_a2'>a2</span><span class='comma'>,</span> <span class='id identifier rubyid_a3'>a3</span><span class='comma'>,</span> <span class='id identifier rubyid_a4'>a4</span> ]

  <span class='comment'># Convert :foo to the native type
</span>  <span class='id identifier rubyid_arg_types'>arg_types</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_types'>arg_types</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_find_type'><a href="#find_type-instance_method" title="FFI::Library#find_type (method)">find_type</a></span>(<span class='id identifier rubyid_e'>e</span>) }
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {
    <span class='symbeg'>:</span><span class='id identifier rubyid_convention'>convention</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ffi_convention'><a href="#ffi_convention-instance_method" title="FFI::Library#ffi_convention (method)">ffi_convention</a></span><span class='comma'>,</span>
    <span class='symbeg'>:</span><span class='id identifier rubyid_type_map'>type_map</span> <span class='op'>=&gt;</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_typedefs</span>) <span class='op'>?</span> <span class='ivar'>@ffi_typedefs</span> <span class='op'>:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='symbeg'>:</span><span class='id identifier rubyid_blocking'>blocking</span> <span class='op'>=&gt;</span> <span class='kw'>defined?</span>(<span class='ivar'>@blocking</span>) <span class='op'>&amp;&amp;</span> <span class='ivar'>@blocking</span><span class='comma'>,</span>
    <span class='symbeg'>:</span><span class='id identifier rubyid_enums'>enums</span> <span class='op'>=&gt;</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_enums</span>) <span class='op'>?</span> <span class='ivar'>@ffi_enums</span> <span class='op'>:</span> <span class='kw'>nil</span><span class='comma'>,</span>
  }

  <span class='ivar'>@blocking</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='id identifier rubyid_opts'>opts</span>) <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Hash</span>)

  <span class='comment'># Try to locate the function in any of the libraries
</span>  <span class='id identifier rubyid_invokers'>invokers</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_ffi_libraries'><a href="#ffi_libraries-instance_method" title="FFI::Library#ffi_libraries (method)">ffi_libraries</a></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_lib'>lib</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_invokers'>invokers</span>.<span class='id identifier rubyid_empty?'>empty?</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_function'>function</span> <span class='op'>=</span> <span class='kw'>nil</span>
        <span class='id identifier rubyid_function_names'><a href="#function_names-instance_method" title="FFI::Library#function_names (method)">function_names</a></span>(<span class='id identifier rubyid_cname'>cname</span><span class='comma'>,</span> <span class='id identifier rubyid_arg_types'>arg_types</span>).<span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_fname'>fname</span><span class='op'>|</span>
          <span class='id identifier rubyid_function'>function</span> <span class='op'>=</span> <span class='id identifier rubyid_lib'>lib</span>.<span class='id identifier rubyid_find_function'>find_function</span>(<span class='id identifier rubyid_fname'>fname</span>)
        <span class='kw'>end</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>LoadError</span> <span class='kw'>unless</span> <span class='id identifier rubyid_function'>function</span>

        <span class='id identifier rubyid_invokers'>invokers</span> <span class='op'>&lt;&lt;</span> <span class='kw'>if</span> <span class='id identifier rubyid_arg_types'>arg_types</span>[<span class='op'>-</span><span class='int'>1</span>] <span class='op'>==</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="NativeType.html" title="FFI::NativeType (module)">NativeType</a></span><span class='op'>::</span><span class='const'>VARARGS</span>
          <span class='const'><a href="VariadicInvoker.html" title="FFI::VariadicInvoker (class)">VariadicInvoker</a></span>.<span class='id identifier rubyid_new'><a href="VariadicInvoker.html#new-class_method" title="FFI::VariadicInvoker.new (method)">new</a></span>(<span class='id identifier rubyid_function'>function</span><span class='comma'>,</span> <span class='id identifier rubyid_arg_types'>arg_types</span><span class='comma'>,</span> <span class='id identifier rubyid_find_type'><a href="#find_type-instance_method" title="FFI::Library#find_type (method)">find_type</a></span>(<span class='id identifier rubyid_ret_type'>ret_type</span>)<span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)

        <span class='kw'>else</span>
          <span class='const'><a href="Function.html" title="FFI::Function (class)">Function</a></span>.<span class='id identifier rubyid_new'><a href="Function.html#new-class_method" title="FFI::Function.new (method)">new</a></span>(<span class='id identifier rubyid_find_type'><a href="#find_type-instance_method" title="FFI::Library#find_type (method)">find_type</a></span>(<span class='id identifier rubyid_ret_type'>ret_type</span>)<span class='comma'>,</span> <span class='id identifier rubyid_arg_types'>arg_types</span><span class='comma'>,</span> <span class='id identifier rubyid_function'>function</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)
        <span class='kw'>end</span>

      <span class='kw'>rescue</span> <span class='const'>LoadError</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_invoker'>invoker</span> <span class='op'>=</span> <span class='id identifier rubyid_invokers'>invokers</span>.<span class='id identifier rubyid_compact'>compact</span>.<span class='id identifier rubyid_shift'>shift</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="NotFoundError.html" title="FFI::NotFoundError (class)">NotFoundError</a></span>.<span class='id identifier rubyid_new'><a href="NotFoundError.html#new-class_method" title="FFI::NotFoundError.new (method)">new</a></span>(<span class='id identifier rubyid_cname'>cname</span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_ffi_libraries'><a href="#ffi_libraries-instance_method" title="FFI::Library#ffi_libraries (method)">ffi_libraries</a></span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_lib'>lib</span><span class='op'>|</span> <span class='id identifier rubyid_lib'>lib</span>.<span class='id identifier rubyid_name'>name</span> }) <span class='kw'>unless</span> <span class='id identifier rubyid_invoker'>invoker</span>

  <span class='id identifier rubyid_invoker'>invoker</span>.<span class='id identifier rubyid_attach'>attach</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_to_s'>to_s</span>)
  <span class='id identifier rubyid_invoker'>invoker</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attach_variable-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>attach_variable</strong>(mname, cname, type)  &#x21d2; <a href="DynamicLibrary/Symbol.html" title="FFI::DynamicLibrary::Symbol (class)">DynamicLibrary::Symbol</a> </span>
      <span class='overload'>#<strong>attach_variable</strong>(cname, type)  &#x21d2; <a href="DynamicLibrary/Symbol.html" title="FFI::DynamicLibrary::Symbol (class)">DynamicLibrary::Symbol</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Attach C variable <code>cname</code> to this module.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="NotFoundError.html" title="FFI::NotFoundError (class)">FFI::NotFoundError</a>)</span>
&mdash;    <div class='inline'>
<p>if <code>cname</code> cannot be found in libraries</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L274-L319'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='274' data-end='319'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 274</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attach_variable'>attach_variable</span>(<span class='id identifier rubyid_mname'>mname</span><span class='comma'>,</span> <span class='id identifier rubyid_a1'>a1</span><span class='comma'>,</span> <span class='id identifier rubyid_a2'>a2</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_cname'>cname</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_a2'>a2</span> <span class='op'>?</span> [ <span class='id identifier rubyid_a1'>a1</span><span class='comma'>,</span> <span class='id identifier rubyid_a2'>a2</span> ] <span class='op'>:</span> [ <span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_a1'>a1</span> ]
  <span class='id identifier rubyid_mname'>mname</span> <span class='op'>=</span> <span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>
  <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_ffi_libraries'><a href="#ffi_libraries-instance_method" title="FFI::Library#ffi_libraries (method)">ffi_libraries</a></span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_lib'>lib</span><span class='op'>|</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='id identifier rubyid_lib'>lib</span>.<span class='id identifier rubyid_find_variable'>find_variable</span>(<span class='id identifier rubyid_cname'>cname</span>.<span class='id identifier rubyid_to_s'>to_s</span>)
      <span class='kw'>break</span> <span class='kw'>unless</span> <span class='id identifier rubyid_address'>address</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>rescue</span> <span class='const'>LoadError</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="NotFoundError.html" title="FFI::NotFoundError (class)">NotFoundError</a></span>.<span class='id identifier rubyid_new'><a href="NotFoundError.html#new-class_method" title="FFI::NotFoundError.new (method)">new</a></span>(<span class='id identifier rubyid_cname'>cname</span><span class='comma'>,</span> <span class='id identifier rubyid_ffi_libraries'><a href="#ffi_libraries-instance_method" title="FFI::Library#ffi_libraries (method)">ffi_libraries</a></span>) <span class='kw'>if</span> <span class='id identifier rubyid_address'>address</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_address'>address</span>.<span class='id identifier rubyid_null?'>null?</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Class</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&lt;</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Struct.html" title="FFI::Struct (class)">Struct</a></span>
    <span class='comment'># If it is a global struct, just attach directly to the pointer
</span>    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_type'>type</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_address'>address</span>) <span class='comment'># Assigning twice to suppress unused variable warning
</span>    <span class='kw'>self</span>.<span class='id identifier rubyid_module_eval'>module_eval</span> <span class='heredoc_beg'>&lt;&lt;-code</span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='comma'>,</span> <span class='kw'>__LINE__</span>
<span class='tstring_content'>      @ffi_gsvars = {} unless defined?(@ffi_gsvars)
      @ffi_gsvars[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>] = s
      def self.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span><span class='embexpr_end'>}</span><span class='tstring_content'>
        @ffi_gsvars[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>]
      end
</span><span class='heredoc_end'>    code
</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sc'>sc</span> <span class='op'>=</span> <span class='const'>Class</span>.<span class='id identifier rubyid_new'>new</span>(<span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Struct.html" title="FFI::Struct (class)">Struct</a></span>)
    <span class='id identifier rubyid_sc'>sc</span>.<span class='id identifier rubyid_layout'>layout</span> <span class='symbeg'>:</span><span class='id identifier rubyid_gvar'>gvar</span><span class='comma'>,</span> <span class='id identifier rubyid_find_type'><a href="#find_type-instance_method" title="FFI::Library#find_type (method)">find_type</a></span>(<span class='id identifier rubyid_type'>type</span>)
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_sc'>sc</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_address'>address</span>)
    <span class='comment'>#
</span>    <span class='comment'># Attach to this module as mname/mname=
</span>    <span class='comment'>#
</span>    <span class='kw'>self</span>.<span class='id identifier rubyid_module_eval'>module_eval</span> <span class='heredoc_beg'>&lt;&lt;-code</span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='comma'>,</span> <span class='kw'>__LINE__</span>
<span class='tstring_content'>      @ffi_gvars = {} unless defined?(@ffi_gvars)
      @ffi_gvars[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>] = s
      def self.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span><span class='embexpr_end'>}</span><span class='tstring_content'>
        @ffi_gvars[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>][:gvar]
      end
      def self.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span><span class='embexpr_end'>}</span><span class='tstring_content'>=(value)
        @ffi_gvars[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mname'>mname</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>][:gvar] = value
      end
</span><span class='heredoc_end'>    code
</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_address'>address</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attached_functions-instance_method">
  <h3 class='signature '>
    #<strong>attached_functions</strong>  &#x21d2; <code>Hash</code>&lt; <code>Symbol</code> =&gt; [<a href="Function.html" title="FFI::Function (class)">FFI::Function</a>, <a href="VariadicInvoker.html" title="FFI::VariadicInvoker (class)">FFI::VariadicInvoker</a>] &gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Retrieve all attached functions and their function signature</p>

<p>This method returns a Hash of method names of attached functions connected by <a href="#attach_function-instance_method" title="FFI::Library#attach_function (method)">#attach_function</a> and the corresponding function type. The function type responds to <code>#return_type</code> and <code>#param_types</code> which return the <a href="../FFI.html" title="FFI (module)"><code>::FFI</code></a> types of the function signature.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L544-L546'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='544' data-end='546'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 544</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attached_functions'>attached_functions</span>
  <span class='ivar'>@ffi_functions</span> <span class='op'>||</span> {}
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attached_variables-instance_method">
  <h3 class='signature '>
    #<strong>attached_variables</strong>  &#x21d2; <code>Hash</code>&lt; <code>Symbol</code> =&gt; <code>ffi_type</code> &gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Retrieve all attached variables and their type</p>

<p>This method returns a Hash of variable names and the corresponding type or variables connected by <a href="#attach_variable-instance_method" title="FFI::Library#attach_variable (method)">#attach_variable</a> .</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L553-L562'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='553' data-end='562'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 553</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_attached_variables'>attached_variables</span>
  (
    (<span class='kw'>defined?</span>(<span class='ivar'>@ffi_gsvars</span>) <span class='op'>?</span> <span class='ivar'>@ffi_gsvars</span> <span class='op'>:</span> {}).<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_gvar'>gvar</span><span class='op'>|</span>
      [<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_gvar'>gvar</span>.<span class='id identifier rubyid_class'>class</span>]
    <span class='kw'>end</span> <span class='op'>+</span>
    (<span class='kw'>defined?</span>(<span class='ivar'>@ffi_gvars</span>) <span class='op'>?</span> <span class='ivar'>@ffi_gvars</span> <span class='op'>:</span> {}).<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_gvar'>gvar</span><span class='op'>|</span>
      [<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_gvar'>gvar</span>.<span class='id identifier rubyid_layout'>layout</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_gvar'>gvar</span>].<span class='id identifier rubyid_type'>type</span>]
    <span class='kw'>end</span>
  ).<span class='id identifier rubyid_to_h'>to_h</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bitmask-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>bitmask</strong>(name, values)  &#x21d2; <a href="Bitmask.html" title="FFI::Bitmask (class)">FFI::Bitmask</a> </span>
      <span class='overload'>#<strong>bitmask</strong>(*args)  &#x21d2; <a href="Bitmask.html" title="FFI::Bitmask (class)">FFI::Bitmask</a> </span>
      <span class='overload'>#<strong>bitmask</strong>(values)  &#x21d2; <a href="Bitmask.html" title="FFI::Bitmask (class)">FFI::Bitmask</a> </span>
      <span class='overload'>#<strong>bitmask</strong>(native_type, name, values)  &#x21d2; <a href="Bitmask.html" title="FFI::Bitmask (class)">FFI::Bitmask</a> </span>
      <span class='overload'>#<strong>bitmask</strong>(native_type, *args)  &#x21d2; <a href="Bitmask.html" title="FFI::Bitmask (class)">FFI::Bitmask</a> </span>
      <span class='overload'>#<strong>bitmask</strong>(native_type, values)  &#x21d2; <a href="Bitmask.html" title="FFI::Bitmask (class)">FFI::Bitmask</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Create a new <a href="Bitmask.html" title="FFI::Bitmask (class)"><code>Bitmask</code></a></p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L520-L522'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='520' data-end='522'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 520</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bitmask'>bitmask</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_generic_enum'><a href="#generic_enum-instance_method" title="FFI::Library#generic_enum (method)">generic_enum</a></span>(<span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Bitmask.html" title="FFI::Bitmask (class)">Bitmask</a></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="callback-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>callback</strong>(name, params, ret)  &#x21d2; <a href="../FFI.html#CallbackInfo-constant" title="FFI::CallbackInfo (constant)">FFI::CallbackInfo</a> </span>
      <span class='overload'>#<strong>callback</strong>(params, ret)  &#x21d2; <a href="../FFI.html#CallbackInfo-constant" title="FFI::CallbackInfo (constant)">FFI::CallbackInfo</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>ArgumentError</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L330-L355'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='330' data-end='355'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 330</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_callback'>callback</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wrong number of arguments</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='int'>2</span> <span class='op'>||</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>3</span>
  <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='comma'>,</span> <span class='id identifier rubyid_ret'>ret</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>3</span>
    <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>else</span>
    [ <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>]<span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>1</span>] ]
  <span class='kw'>end</span>

  <span class='id identifier rubyid_native_params'>native_params</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>.<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_find_type'><a href="#find_type-instance_method" title="FFI::Library#find_type (method)">find_type</a></span>(<span class='id identifier rubyid_e'>e</span>) }
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>callbacks cannot have variadic parameters</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_native_params'>native_params</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span><span class='op'>::</span><span class='const'>VARARGS</span>)
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'>Hash</span>.<span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_convention'>convention</span>] <span class='op'>=</span> <span class='id identifier rubyid_ffi_convention'><a href="#ffi_convention-instance_method" title="FFI::Library#ffi_convention (method)">ffi_convention</a></span>
  <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_enums'>enums</span>] <span class='op'>=</span> <span class='ivar'>@ffi_enums</span> <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_enums</span>)
  <span class='id identifier rubyid_ret_type'>ret_type</span> <span class='op'>=</span> <span class='id identifier rubyid_find_type'><a href="#find_type-instance_method" title="FFI::Library#find_type (method)">find_type</a></span>(<span class='id identifier rubyid_ret'>ret</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_ret_type'>ret_type</span> <span class='op'>==</span> <span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span><span class='op'>::</span><span class='const'>STRING</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>TypeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:string is not allowed as return type of callbacks</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="../FFI.html#CallbackInfo-constant" title="FFI::CallbackInfo (constant)">CallbackInfo</a></span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_ret_type'>ret_type</span><span class='comma'>,</span> <span class='id identifier rubyid_native_params'>native_params</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>)

  <span class='comment'># Add to the symbol -&gt; type map (unless there was no name)
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_typedef'><a href="#typedef-instance_method" title="FFI::Library#typedef (method)">typedef</a></span> <span class='id identifier rubyid_cb'>cb</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_cb'>cb</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enum-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>enum</strong>(name, values)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> </span>
      <span class='overload'>#<strong>enum</strong>(*args)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> </span>
      <span class='overload'>#<strong>enum</strong>(values)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> </span>
      <span class='overload'>#<strong>enum</strong>(native_type, name, values)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> </span>
      <span class='overload'>#<strong>enum</strong>(native_type, *args)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> </span>
      <span class='overload'>#<strong>enum</strong>(native_type, values)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Create a new <a href="Enum.html" title="FFI::Enum (class)"><code>Enum</code></a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L477-L479'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='477' data-end='479'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 477</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_enum'>enum</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_generic_enum'><a href="#generic_enum-instance_method" title="FFI::Library#generic_enum (method)">generic_enum</a></span>(<span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Enum.html" title="FFI::Enum (class)">Enum</a></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enum_type-instance_method">
  <h3 class='signature '>
    #<strong>enum_type</strong>(name)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Find an enum by name.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'></span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L527-L529'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='527' data-end='529'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 527</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_enum_type'>enum_type</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='ivar'>@ffi_enums</span>.<span class='id identifier rubyid_find'>find</span>(<span class='id identifier rubyid_name'>name</span>) <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_enums</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enum_value-instance_method">
  <h3 class='signature '>
    #<strong>enum_value</strong>(symbol)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Find an enum by a symbol it contains.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>symbol</span>
    <span class='type'></span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L534-L536'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='534' data-end='536'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 534</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_enum_value'>enum_value</span>(<span class='id identifier rubyid_symbol'>symbol</span>)
  <span class='ivar'>@ffi_enums</span>.<span class='id identifier rubyid___map_symbol'>__map_symbol</span>(<span class='id identifier rubyid_symbol'>symbol</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ffi_convention-instance_method">
  <h3 class='signature '>
    #<strong>ffi_convention</strong>(convention = nil)  &#x21d2; <code>Symbol</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><code>:stdcall</code> is typically used for attaching Windows API functions</p>
</div>
  </div>


<p>Set the calling convention for <a href="#attach_function-instance_method" title="FFI::Library#attach_function (method)">#attach_function</a> and <a href="#callback-instance_method" title="FFI::Library#callback (method)">#callback</a></p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>convention</span>
    <span class='type'>(<code>Symbol</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>one of <code>:default</code>, <code>:stdcall</code></p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Symbol</code>)</span>
&mdash;    <div class='inline'>
<p>the new calling convention</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="http://en.wikipedia.org/wiki/Stdcall#stdcall" target="_parent" title="http://en.wikipedia.org/wiki/Stdcall#stdcall">http://en.wikipedia.org/wiki/Stdcall#stdcall</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L106-L110'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='106' data-end='110'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 106</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ffi_convention'>ffi_convention</span>(<span class='id identifier rubyid_convention'>convention</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='ivar'>@ffi_convention</span> <span class='op'>||=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_default'>default</span>
  <span class='ivar'>@ffi_convention</span> <span class='op'>=</span> <span class='id identifier rubyid_convention'>convention</span> <span class='kw'>if</span> <span class='id identifier rubyid_convention'>convention</span>
  <span class='ivar'>@ffi_convention</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ffi_lib-instance_method">
  <h3 class='signature '>
    #<strong>ffi_lib</strong>(*names)  &#x21d2; <code>Array</code>&lt;<a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">DynamicLibrary</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Load native libraries.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>names</span>
    <span class='type'>(<code>Array</code>)</span>
&mdash;    <div class='inline'>
<p>names of libraries to load</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>LoadError</code>)</span>
&mdash;    <div class='inline'>
<p>if a library cannot be opened</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L89-L97'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='89' data-end='97'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 89</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ffi_lib'>ffi_lib</span>(<span class='op'>*</span><span class='id identifier rubyid_names'>names</span>)
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>LoadError</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>library names list must not be empty</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>if</span> <span class='id identifier rubyid_names'>names</span>.<span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_lib_flags'>lib_flags</span> <span class='op'>=</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_lib_flags</span>) <span class='op'>&amp;&amp;</span> <span class='ivar'>@ffi_lib_flags</span>

  <span class='ivar'>@ffi_libs</span> <span class='op'>=</span> <span class='id identifier rubyid_names'>names</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">DynamicLibrary</a></span>.<span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_load_library'>load_library</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_lib_flags'>lib_flags</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ffi_lib_flags-instance_method">
  <h3 class='signature '>
    #<strong>ffi_lib_flags</strong>(*flags)  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets library flags for <a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a>.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_ffi_lib_flags'>ffi_lib_flags</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_lazy'>lazy</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_local'>local</span>) <span class='comment'># =&gt; 5</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>flags</span>
    <span class='type'>(<code>Symbol</code>, …)</span>
&mdash;    <div class='inline'>
<p>(see <a href="#FlagsMap-constant" title="FFI::Library::FlagsMap (constant)">FlagsMap</a>)</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'>
<p>the new value</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L139-L141'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='139' data-end='141'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 139</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ffi_lib_flags'>ffi_lib_flags</span>(<span class='op'>*</span><span class='id identifier rubyid_flags'>flags</span>)
  <span class='ivar'>@ffi_lib_flags</span> <span class='op'>=</span> <span class='id identifier rubyid_flags'>flags</span>.<span class='id identifier rubyid_inject'>inject</span>(<span class='int'>0</span>) { <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_result'>result</span> <span class='op'>|</span> <span class='const'><a href="#FlagsMap-constant" title="FFI::Library::FlagsMap (constant)">FlagsMap</a></span>[<span class='id identifier rubyid_f'>f</span>] }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ffi_libraries-instance_method">
  <h3 class='signature '>
    #<strong>ffi_libraries</strong>  &#x21d2; <code>Array</code>&lt;<a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">FFI::DynamicLibrary</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get FFI libraries loaded using <a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a>.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Array</code>&lt;<a href="DynamicLibrary.html" title="FFI::DynamicLibrary (class)">FFI::DynamicLibrary</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>array of currently loaded <a href="../FFI.html" title="FFI (module)"><code>::FFI</code></a> libraries</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>LoadError</code>)</span>
&mdash;    <div class='inline'>
<p>if no libraries have been loaded (using <a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a>)</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#ffi_lib-instance_method" title="FFI::Library#ffi_lib (method)">#ffi_lib</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L116-L119'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='116' data-end='119'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 116</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ffi_libraries'>ffi_libraries</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>LoadError</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no library specified</span><span class='tstring_end'>&quot;</span></span>) <span class='kw'>if</span> <span class='op'>!</span><span class='kw'>defined?</span>(<span class='ivar'>@ffi_libs</span>) <span class='op'>||</span> <span class='ivar'>@ffi_libs</span>.<span class='id identifier rubyid_empty?'>empty?</span>
  <span class='ivar'>@ffi_libs</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="find_type-instance_method">
  <h3 class='signature '>
    #<strong>find_type</strong>(t)  &#x21d2; <a href="Type.html" title="FFI::Type (class)">Type</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Find a type definition.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>t</span>
    <span class='type'>(<a href="DataConverter.html" title="FFI::DataConverter (module)">DataConverter</a>, <a href="Type.html" title="FFI::Type (class)">Type</a>, <a href="Struct.html" title="FFI::Struct (class)">Struct</a>, <code>Symbol</code>)</span>
&mdash;    <div class='inline'>
<p>type to find</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L401-L416'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='401' data-end='416'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 401</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_find_type'>find_type</span>(<span class='id identifier rubyid_t'>t</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span>)
    <span class='id identifier rubyid_t'>t</span>

  <span class='kw'>elsif</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_typedefs</span>) <span class='op'>&amp;&amp;</span> <span class='ivar'>@ffi_typedefs</span>.<span class='id identifier rubyid_has_key?'>has_key?</span>(<span class='id identifier rubyid_t'>t</span>)
    <span class='ivar'>@ffi_typedefs</span>[<span class='id identifier rubyid_t'>t</span>]

  <span class='kw'>elsif</span> <span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Class</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_t'>t</span> <span class='op'>&lt;</span> <span class='const'><a href="Struct.html" title="FFI::Struct (class)">Struct</a></span>
    <span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span><span class='op'>::</span><span class='const'>POINTER</span>

  <span class='kw'>elsif</span> <span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="DataConverter.html" title="FFI::DataConverter (module)">DataConverter</a></span>)
    <span class='comment'># Add a typedef so next time the converter is used, it hits the cache
</span>    <span class='id identifier rubyid_typedef'><a href="#typedef-instance_method" title="FFI::Library#typedef (method)">typedef</a></span> <span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Mapped.html" title="FFI::Type::Mapped (class)">Mapped</a></span>.<span class='id identifier rubyid_new'><a href="Type/Mapped.html#new-class_method" title="FFI::Type::Mapped.new (method)">new</a></span>(<span class='id identifier rubyid_t'>t</span>)<span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span>

  <span class='kw'>end</span> <span class='op'>||</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span>.<span class='id identifier rubyid_find_type'><a href="../FFI.html#find_type-class_method" title="FFI.find_type (method)">find_type</a></span>(<span class='id identifier rubyid_t'>t</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="freeze-instance_method">
  <h3 class='signature '>
    #<strong>freeze</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Freeze all definitions of the module</p>

<p>This freezes the module’s definitions, so that it can be used in a Ractor. No further methods or variables can be attached and no further enums or typedefs can be created in this module afterwards.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L568-L574'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='568' data-end='574'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 568</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_freeze'>freeze</span>
  <span class='id identifier rubyid_instance_variables'>instance_variables</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span>(<span class='id identifier rubyid_name'>name</span>)
    <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span>.<span class='id identifier rubyid_make_shareable'><a href="../FFI.html#make_shareable-class_method" title="FFI.make_shareable (method)">make_shareable</a></span>(<span class='id identifier rubyid_var'>var</span>)
  <span class='kw'>end</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="function_names-instance_method">
  <h3 class='signature '>
    #<strong>function_names</strong>(name, arg_types)  &#x21d2; <code>Array</code>&lt;<code>String</code>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Function.html" title="FFI::Function (class)"><code>Function</code></a> names on windows may be decorated if they are using stdcall. See</p>
<ul><li>
<p><a href="http://en.wikipedia.org/wiki/Name_mangling#C_name_decoration_in_Microsoft_Windows">en.wikipedia.org/wiki/Name_mangling#C_name_decoration_in_Microsoft_Windows</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/en-us/library/zxk0tw93%28v=VS.100%29.aspx">msdn.microsoft.com/en-us/library/zxk0tw93%28v=VS.100%29.aspx</a></p>
</li><li>
<p><a href="http://en.wikibooks.org/wiki/X86_Disassembly/Calling_Conventions#STDCALL">en.wikibooks.org/wiki/X86_Disassembly/Calling_Conventions#STDCALL</a></p>
</li></ul>

<p>Note that decorated names can be overridden via def files.  Also note that the windows api, although using, doesn’t have decorated names.</p>
</div>
  </div>


<p>This function returns a list of possible names to lookup.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>name</span>
    <span class='type'>(#<code>to_s</code>)</span>
&mdash;    <div class='inline'>
<p>function name</p>
</div>
  </li>
  <li>
    <span class='name'>arg_types</span>
    <span class='type'>(<code>Array</code>)</span>
&mdash;    <div class='inline'>
<p>function’s argument types</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L232-L247'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='232' data-end='247'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 232</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_function_names'>function_names</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_arg_types'>arg_types</span>)
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> [<span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_to_s'>to_s</span>]
  <span class='kw'>if</span> <span class='id identifier rubyid_ffi_convention'><a href="#ffi_convention-instance_method" title="FFI::Library#ffi_convention (method)">ffi_convention</a></span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_stdcall'>stdcall</span>
    <span class='comment'># Get the size of each parameter
</span>    <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_types'>arg_types</span>.<span class='id identifier rubyid_inject'>inject</span>(<span class='int'>0</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mem'>mem</span><span class='comma'>,</span> <span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span>.<span class='id identifier rubyid_size'>size</span>
      <span class='comment'># The size must be a multiple of 4
</span>      <span class='id identifier rubyid_size'>size</span> <span class='op'>+=</span> (<span class='int'>4</span> <span class='op'>-</span> <span class='id identifier rubyid_size'>size</span>) <span class='op'>%</span> <span class='int'>4</span>
      <span class='id identifier rubyid_mem'>mem</span> <span class='op'>+</span> <span class='id identifier rubyid_size'>size</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># win32
</span>    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># win64
</span>  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="generic_enum-instance_method">
  <h3 class='signature priv'>
    #<strong>generic_enum</strong>(klass, *args)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Generic enum builder</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@param</span> [<span class='const'>Class</span>] <span class='id identifier rubyid_klass'>klass</span> <span class='id identifier rubyid_can'>can</span> <span class='id identifier rubyid_be'>be</span> <span class='id identifier rubyid_one'>one</span> <span class='id identifier rubyid_of'>of</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Enum.html" title="FFI::Enum (class)">Enum</a></span> <span class='kw'>or</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Bitmask.html" title="FFI::Bitmask (class)">Bitmask</a></span>
<span class='ivar'>@param</span> <span class='id identifier rubyid_args'>args</span> (<span class='id identifier rubyid_see'>see</span> <span class='comment'>#enum or #bitmask)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L422-L437'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='422' data-end='437'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 422</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_generic_enum'>generic_enum</span>(<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_native_type'>native_type</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span>) <span class='op'>?</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_shift'>shift</span> <span class='op'>:</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>].<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'>Symbol</span>) <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>1</span>].<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'>Array</span>)
    [ <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>]<span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>1</span>] ]
  <span class='kw'>elsif</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>].<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'>Array</span>)
    [ <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>] ]
  <span class='kw'>else</span>
    [ <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span> ]
  <span class='kw'>end</span>
  <span class='ivar'>@ffi_enums</span> <span class='op'>=</span> <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Enums.html" title="FFI::Enums (class)">Enums</a></span>.<span class='id identifier rubyid_new'><a href="Enums.html#new-class_method" title="FFI::Enums.new (method)">new</a></span> <span class='kw'>unless</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_enums</span>)
  <span class='ivar'>@ffi_enums</span> <span class='op'>&lt;&lt;</span> (<span class='id identifier rubyid_e'>e</span> <span class='op'>=</span> <span class='id identifier rubyid_native_type'>native_type</span> <span class='op'>?</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_native_type'>native_type</span><span class='comma'>,</span> <span class='id identifier rubyid_values'>values</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>) <span class='op'>:</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_values'>values</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>))

  <span class='comment'># If called with a name, add a typedef alias
</span>  <span class='id identifier rubyid_typedef'><a href="#typedef-instance_method" title="FFI::Library#typedef (method)">typedef</a></span>(<span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>) <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_e'>e</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="typedef-instance_method">
  <h3 class='signature '>
    #<strong>typedef</strong>(old, add, info = nil)  &#x21d2; <a href="Enum.html" title="FFI::Enum (class)">FFI::Enum</a>, <a href="Type.html" title="FFI::Type (class)">FFI::Type</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Register or get an already registered type definition.</p>

<p>To register a new type definition, <code>old</code> should be a <a href="Type.html" title="FFI::Type (class)"><code>Type</code></a>. <code>add</code> is in this case the type definition.</p>

<p>If <code>old</code> is a <a href="DataConverter.html" title="FFI::DataConverter (module)"><code>DataConverter</code></a>, a <a href="Type/Mapped.html" title="FFI::Type::Mapped (class)"><code>Type::Mapped</code></a> is returned.</p>

<p>If <code>old</code> is <code>:enum</code></p>
<ul><li>
<p>and <code>add</code> is an <code>Array</code>, a call to <a href="#enum-instance_method" title="FFI::Library#enum (method)">#enum</a> is made with <code>add</code> as single parameter;</p>
</li><li>
<p>in others cases, <code>info</code> is used to create a named enum.</p>
</li></ul>

<p>If <code>old</code> is a key for type map, <code>#typedef</code> get <code>old</code> type definition.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>old</span>
    <span class='type'>(<a href="DataConverter.html" title="FFI::DataConverter (module)">DataConverter</a>, <code>Symbol</code>, <a href="Type.html" title="FFI::Type (class)">Type</a>)</span>
  </li>
  <li>
    <span class='name'>add</span>
    <span class='type'>(<code>Symbol</code>)</span>
  </li>
  <li>
    <span class='name'>info</span>
    <span class='type'>(<code>Symbol</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ffi/ffi/blob/master/lib/ffi/library.rb#L374-L396'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='374' data-end='396'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/ffi/library.rb', line 374</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_typedef'>typedef</span>(<span class='id identifier rubyid_old'>old</span><span class='comma'>,</span> <span class='id identifier rubyid_add'>add</span><span class='comma'>,</span> <span class='id identifier rubyid_info'>info</span><span class='op'>=</span><span class='kw'>nil</span>)
  <span class='ivar'>@ffi_typedefs</span> <span class='op'>=</span> <span class='const'>Hash</span>.<span class='id identifier rubyid_new'>new</span> <span class='kw'>unless</span> <span class='kw'>defined?</span>(<span class='ivar'>@ffi_typedefs</span>)

  <span class='ivar'>@ffi_typedefs</span>[<span class='id identifier rubyid_add'>add</span>] <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_old'>old</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span>)
    <span class='id identifier rubyid_old'>old</span>

  <span class='kw'>elsif</span> <span class='ivar'>@ffi_typedefs</span>.<span class='id identifier rubyid_has_key?'>has_key?</span>(<span class='id identifier rubyid_old'>old</span>)
    <span class='ivar'>@ffi_typedefs</span>[<span class='id identifier rubyid_old'>old</span>]

  <span class='kw'>elsif</span> <span class='id identifier rubyid_old'>old</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="DataConverter.html" title="FFI::DataConverter (module)">DataConverter</a></span>)
    <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="Type.html" title="FFI::Type (class)">Type</a></span><span class='op'>::</span><span class='const'><a href="Type/Mapped.html" title="FFI::Type::Mapped (class)">Mapped</a></span>.<span class='id identifier rubyid_new'><a href="Type/Mapped.html#new-class_method" title="FFI::Type::Mapped.new (method)">new</a></span>(<span class='id identifier rubyid_old'>old</span>)

  <span class='kw'>elsif</span> <span class='id identifier rubyid_old'>old</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_enum'><a href="#enum-instance_method" title="FFI::Library#enum (method)">enum</a></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_add'>add</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'>Array</span>)
      <span class='kw'>self</span>.<span class='id identifier rubyid_enum'><a href="#enum-instance_method" title="FFI::Library#enum (method)">enum</a></span>(<span class='id identifier rubyid_add'>add</span>)
    <span class='kw'>else</span>
      <span class='kw'>self</span>.<span class='id identifier rubyid_enum'><a href="#enum-instance_method" title="FFI::Library#enum (method)">enum</a></span>(<span class='id identifier rubyid_info'>info</span><span class='comma'>,</span> <span class='id identifier rubyid_add'>add</span>)
    <span class='kw'>end</span>

  <span class='kw'>else</span>
    <span class='const'><a href="../FFI.html" title="FFI (module)">FFI</a></span>.<span class='id identifier rubyid_find_type'><a href="../FFI.html#find_type-class_method" title="FFI.find_type (method)">find_type</a></span>(<span class='id identifier rubyid_old'>old</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>