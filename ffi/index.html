<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: README &mdash; FFI master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "README",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>FFI master</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: README&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<h1>Ruby-FFI <a href="https://github.com/ffi/ffi/wiki">https://github.com/ffi/ffi/wiki</a></h1>

<h2>Description</h2>

<p>Ruby-FFI is a gem for programmatically loading dynamically-linked native
libraries, binding functions within them, and calling those functions
from Ruby code. Moreover, a Ruby-FFI extension works without changes
on CRuby (MRI), JRuby, Rubinius and TruffleRuby. <a href="https://github.com/ffi/ffi/wiki/why-use-ffi">Discover why you should write your next extension
using Ruby-FFI</a>.</p>

<h2>Features</h2>

<ul>
<li>Intuitive DSL</li>
<li>Supports all C native types</li>
<li>C structs (also nested), enums and global variables</li>
<li>Callbacks from C to Ruby</li>
<li>Automatic garbage collection of native memory</li>
<li>Usable in Ractor: <a href="https://github.com/ffi/ffi/wiki/Ractors">How-to-use-FFI-in-Ruby-Ractors</a></li>
</ul>

<h2>Synopsis</h2>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ffi</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>module</span> <span class='const'>MyLib</span>
  <span class='id identifier rubyid_extend'>extend</span> <span class='const'><a href="FFI.html" title="FFI (module)">FFI</a></span><span class='op'>::</span><span class='const'><a href="FFI/Library.html" title="FFI::Library (module)">Library</a></span>
  <span class='id identifier rubyid_ffi_lib'>ffi_lib</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>c</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_attach_function'>attach_function</span> <span class='symbeg'>:</span><span class='id identifier rubyid_puts'>puts</span><span class='comma'>,</span> [ <span class='symbeg'>:</span><span class='id identifier rubyid_string'>string</span> ]<span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_int'>int</span>
<span class='kw'>end</span>

<span class='const'>MyLib</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Hello, World using libc!</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>For less minimalistic and more examples you may look at:</p>

<ul>
<li>The <a href="https://www.rubydoc.info/gems/ffi">documentation</a></li>
<li>the <code>samples/</code> folder</li>
<li>the examples on the <a href="https://github.com/ffi/ffi/wiki">wiki</a></li>
<li>the projects using FFI listed on the wiki: <a href="https://github.com/ffi/ffi/wiki/projects-using-ffi">https://github.com/ffi/ffi/wiki/projects-using-ffi</a></li>
</ul>

<h2>Requirements</h2>

<p>When installing the gem on CRuby (MRI), you will need:</p>

<ul>
<li>A C compiler (e.g., Xcode on macOS, <code>gcc</code> or <code>clang</code> on everything else)
Optionally (speeds up installation):</li>
<li>The <code>libffi</code> library and development headers - this is commonly in the <code>libffi-dev</code> or <code>libffi-devel</code> packages</li>
</ul>

<p>The ffi gem comes with a builtin libffi version, which is used, when the system libffi library is not available or too old.
Use of the system libffi can be enforced by:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_ffi'>ffi</span> <span class='op'>-</span><span class='op'>-</span> <span class='op'>-</span><span class='op'>-</span><span class='id identifier rubyid_enable'>enable</span><span class='op'>-</span><span class='id identifier rubyid_system'>system</span><span class='op'>-</span><span class='id identifier rubyid_libffi'>libffi</span>        <span class='comment'># to install the gem manually
</span><span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_config'>config</span> <span class='id identifier rubyid_build'>build</span>.<span class='id identifier rubyid_ffi'>ffi</span> <span class='op'>-</span><span class='op'>-</span><span class='id identifier rubyid_enable'>enable</span><span class='op'>-</span><span class='id identifier rubyid_system'>system</span><span class='op'>-</span><span class='id identifier rubyid_libffi'>libffi</span>   <span class='comment'># for bundle install</span></code></pre>

<p>or prevented by <code>--disable-system-libffi</code>.</p>

<p>On Linux systems running with <a href="https://en.wikipedia.org/wiki/PaX">PaX</a> (Gentoo, Alpine, etc.), FFI may trigger <code>mprotect</code> errors. You may need to disable <a href="https://en.wikibooks.org/wiki/Grsecurity/Appendix/Grsecurity_and_PaX_Configuration_Options#Restrict_mprotect.28.29">mprotect</a> for ruby (<code>paxctl -m [/path/to/ruby]</code>) for the time being until a solution is found.</p>

<p>On FreeBSD systems pkgconf must be installed for the gem to be able to compile using clang. Install either via packages <code>pkg install pkgconf</code> or from ports via <code>devel/pkgconf</code>.</p>

<p>On JRuby and TruffleRuby, there are no requirements to install the FFI gem, and <code>require &#39;ffi&#39;</code> works even without installing the gem (i.e., the gem is preinstalled on these implementations).</p>

<h2>Installation</h2>

<p>From rubygems:</p>

<pre class="code ruby"><code class="ruby">[<span class='id identifier rubyid_sudo'>sudo</span>] <span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_ffi'>ffi</span></code></pre>

<p>From a Gemfile using git or GitHub</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ffi</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>github:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ffi/ffi</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>submodules:</span> <span class='kw'>true</span></code></pre>

<p>or from the git repository on github:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_git'>git</span> <span class='id identifier rubyid_clone'>clone</span> <span class='label'>git:</span><span class='tstring'><span class='regexp_beg'>/</span><span class='regexp_end'>/github</span></span>.<span class='id identifier rubyid_com'>com</span><span class='op'>/</span><span class='id identifier rubyid_ffi'>ffi</span><span class='op'>/</span><span class='id identifier rubyid_ffi'>ffi</span>.<span class='id identifier rubyid_git'>git</span>
<span class='id identifier rubyid_cd'>cd</span> <span class='id identifier rubyid_ffi'>ffi</span>
<span class='id identifier rubyid_git'>git</span> <span class='id identifier rubyid_submodule'>submodule</span> <span class='id identifier rubyid_update'>update</span> <span class='op'>-</span><span class='op'>-</span><span class='id identifier rubyid_init'>init</span> <span class='op'>-</span><span class='op'>-</span><span class='id identifier rubyid_recursive'>recursive</span>
<span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_install'>install</span>
<span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_install'>install</span></code></pre>

<h3>Install options:</h3>

<ul>
<li><code>--enable-system-libffi</code> : Force usage of system libffi</li>
<li><code>--disable-system-libffi</code> : Force usage of builtin libffi</li>
<li><code>--enable-libffi-alloc</code> : Force closure allocation by libffi</li>
<li><code>--disable-libffi-alloc</code> : Force closure allocation by builtin method</li>
</ul>

<h2>License</h2>

<p>The ffi library is covered by the BSD license, also see the LICENSE file.
The specs are covered by the same license as <a href="https://github.com/ruby/spec">ruby/spec</a>, the MIT license.</p>

<h2>Credits</h2>

<p>The following people have submitted code, bug reports, or otherwise contributed to the success of this project:</p>

<ul>
<li>Alban Peignier <a href="mailto:alban.peignier@free.fr">alban.peignier@free.fr</a></li>
<li>Aman Gupta <a href="mailto:aman@tmm1.net">aman@tmm1.net</a></li>
<li>Andrea Fazzi <a href="mailto:andrea.fazzi@alcacoop.it">andrea.fazzi@alcacoop.it</a></li>
<li>Andreas Niederl <a href="mailto:rico32@gmx.net">rico32@gmx.net</a></li>
<li>Andrew Cholakian <a href="mailto:andrew@andrewvc.com">andrew@andrewvc.com</a></li>
<li>Antonio Terceiro <a href="mailto:terceiro@softwarelivre.org">terceiro@softwarelivre.org</a></li>
<li>Benoit Daloze <a href="mailto:eregontp@gmail.com">eregontp@gmail.com</a></li>
<li>Brian Candler <a href="mailto:B.Candler@pobox.com">B.Candler@pobox.com</a></li>
<li>Brian D. Burns <a href="mailto:burns180@gmail.com">burns180@gmail.com</a></li>
<li>Bryan Kearney <a href="mailto:bkearney@redhat.com">bkearney@redhat.com</a></li>
<li>Charlie Savage <a href="mailto:cfis@zerista.com">cfis@zerista.com</a></li>
<li>Chikanaga Tomoyuki <a href="mailto:nagachika00@gmail.com">nagachika00@gmail.com</a></li>
<li>Hongli Lai <a href="mailto:hongli@phusion.nl">hongli@phusion.nl</a></li>
<li>Ian MacLeod <a href="mailto:ian@nevir.net">ian@nevir.net</a></li>
<li>Jake Douglas <a href="mailto:jake@shiftedlabs.com">jake@shiftedlabs.com</a></li>
<li>Jean-Dominique Morani <a href="mailto:jdmorani@mac.com">jdmorani@mac.com</a></li>
<li>Jeremy Hinegardner <a href="mailto:jeremy@hinegardner.org">jeremy@hinegardner.org</a></li>
<li>Jesús García Sáez <a href="mailto:blaxter@gmail.com">blaxter@gmail.com</a></li>
<li>Joe Khoobyar <a href="mailto:joe@ankhcraft.com">joe@ankhcraft.com</a></li>
<li>Jurij Smakov <a href="mailto:jurij@wooyd.org">jurij@wooyd.org</a></li>
<li>KISHIMOTO, Makoto <a href="mailto:ksmakoto@dd.iij4u.or.jp">ksmakoto@dd.iij4u.or.jp</a></li>
<li>Kim Burgestrand <a href="mailto:kim@burgestrand.se">kim@burgestrand.se</a></li>
<li>Lars Kanis <a href="mailto:lars@greiz-reinsdorf.de">lars@greiz-reinsdorf.de</a></li>
<li>Luc Heinrich <a href="mailto:luc@honk-honk.com">luc@honk-honk.com</a></li>
<li>Luis Lavena <a href="mailto:luislavena@gmail.com">luislavena@gmail.com</a></li>
<li>Matijs van Zuijlen <a href="mailto:matijs@matijs.net">matijs@matijs.net</a></li>
<li>Matthew King <a href="mailto:automatthew@gmail.com">automatthew@gmail.com</a></li>
<li>Mike Dalessio <a href="mailto:mike.dalessio@gmail.com">mike.dalessio@gmail.com</a></li>
<li>NARUSE, Yui <a href="mailto:naruse@airemix.jp">naruse@airemix.jp</a></li>
<li>Park Heesob <a href="mailto:phasis@gmail.com">phasis@gmail.com</a></li>
<li>Shin Yee <a href="mailto:shinyee@speedgocomputing.com">shinyee@speedgocomputing.com</a></li>
<li>Stephen Bannasch <a href="mailto:stephen.bannasch@gmail.com">stephen.bannasch@gmail.com</a></li>
<li>Suraj N. Kurapati <a href="mailto:sunaku@gmail.com">sunaku@gmail.com</a></li>
<li>Sylvain Daubert <a href="mailto:sylvain.daubert@laposte.net">sylvain.daubert@laposte.net</a></li>
<li>Victor Costan</li>
<li><a href="mailto:beoran@gmail.com">beoran@gmail.com</a></li>
<li>ctide <a href="mailto:christide@christide.com">christide@christide.com</a></li>
<li>emboss <a href="mailto:Martin.Bosslet@googlemail.com">Martin.Bosslet@googlemail.com</a></li>
<li>hobophobe <a href="mailto:unusualtears@gmail.com">unusualtears@gmail.com</a></li>
<li>meh <a href="mailto:meh@paranoici.org">meh@paranoici.org</a></li>
<li>postmodern <a href="mailto:postmodern.mod3@gmail.com">postmodern.mod3@gmail.com</a></li>
<li><a href="mailto:wycats@gmail.com">wycats@gmail.com</a> <a href="mailto:wycats@gmail.com">wycats@gmail.com</a></li>
<li>Wayne Meissner <a href="mailto:wmeissner@gmail.com">wmeissner@gmail.com</a></li>
</ul>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>