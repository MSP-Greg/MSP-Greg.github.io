<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: EventMachine &mdash; EventMachine master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "EventMachine",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>EventMachine master</a> &raquo; 
      <a href='_index.html#alpha_E'>Index (E)</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>EventMachine&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: EventMachine</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="EventMachine/DNS.html" title="EventMachine::DNS (module)"><code>DNS</code></a>,
        <a href="EventMachine/Deferrable.html" title="EventMachine::Deferrable (module)"><code>Deferrable</code></a>,
        <a href="EventMachine/Protocols.html" title="EventMachine::Protocols (module)"><code>Protocols</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="EventMachine/Channel.html" title="EventMachine::Channel (class)"><code>Channel</code></a>,
        <a href="EventMachine/Completion.html" title="EventMachine::Completion (class)"><code>Completion</code></a>,
        <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>,
        <a href="EventMachine/DefaultDeferrable.html" title="EventMachine::DefaultDeferrable (class)"><code>DefaultDeferrable</code></a>,
        <a href="EventMachine/DeferrableChildProcess.html" title="EventMachine::DeferrableChildProcess (class)"><code>DeferrableChildProcess</code></a>,
        <a href="EventMachine/FastFileReader.html" title="EventMachine::FastFileReader (class)"><code>FastFileReader</code></a>,
        <a href="EventMachine/FileStreamer.html" title="EventMachine::FileStreamer (class)"><code>FileStreamer</code></a>,
        <a href="EventMachine/FileWatch.html" title="EventMachine::FileWatch (class)"><code>FileWatch</code></a>,
        <a href="EventMachine/IOStreamer.html" title="EventMachine::IOStreamer (class)"><code>IOStreamer</code></a>,
        <a href="EventMachine/Iterator.html" title="EventMachine::Iterator (class)"><code>Iterator</code></a>,
        <a href="EventMachine/PeriodicTimer.html" title="EventMachine::PeriodicTimer (class)"><code>PeriodicTimer</code></a>,
        <a href="EventMachine/Pool.html" title="EventMachine::Pool (class)"><code>Pool</code></a>,
        <a href="EventMachine/ProcessWatch.html" title="EventMachine::ProcessWatch (class)"><code>ProcessWatch</code></a>,
        <a href="EventMachine/Queue.html" title="EventMachine::Queue (class)"><code>Queue</code></a>,
        <a href="EventMachine/SpawnedProcess.html" title="EventMachine::SpawnedProcess (class)"><code>SpawnedProcess</code></a>,
        <a href="EventMachine/SystemCmd.html" title="EventMachine::SystemCmd (class)"><code>SystemCmd</code></a>,
        <a href="EventMachine/ThreadedResource.html" title="EventMachine::ThreadedResource (class)"><code>ThreadedResource</code></a>,
        <a href="EventMachine/TickLoop.html" title="EventMachine::TickLoop (class)"><code>TickLoop</code></a>,
        <a href="EventMachine/Timer.html" title="EventMachine::Timer (class)"><code>Timer</code></a>,
        <a href="EventMachine/YieldBlockFromSpawnedProcess.html" title="EventMachine::YieldBlockFromSpawnedProcess (class)"><code>YieldBlockFromSpawnedProcess</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Exceptions:</div>
      <div class='box_11'>
          <a href="EventMachine/BadCertParams.html" title="EventMachine::BadCertParams (class)"><code>BadCertParams</code></a>,
        <a href="EventMachine/BadParams.html" title="EventMachine::BadParams (class)"><code>BadParams</code></a>,
        <a href="EventMachine/BadPrivateKeyParams.html" title="EventMachine::BadPrivateKeyParams (class)"><code>BadPrivateKeyParams</code></a>,
        <a href="EventMachine/ConnectionError.html" title="EventMachine::ConnectionError (class)"><code>ConnectionError</code></a>,
        <a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)"><code>ConnectionNotBound</code></a>,
        <a href="EventMachine/FileNotFoundException.html" title="EventMachine::FileNotFoundException (class)"><code>FileNotFoundException</code></a>,
        <a href="EventMachine/InvalidPrivateKey.html" title="EventMachine::InvalidPrivateKey (class)"><code>InvalidPrivateKey</code></a>,
        <a href="EventMachine/InvalidSignature.html" title="EventMachine::InvalidSignature (class)"><code>InvalidSignature</code></a>,
        <a href="EventMachine/UnknownTimerFired.html" title="EventMachine::UnknownTimerFired (class)"><code>UnknownTimerFired</code></a>,
        <a href="EventMachine/Unsupported.html" title="EventMachine::Unsupported (class)"><code>Unsupported</code></a>      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/future.rb#L31'>lib/em/future.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1492'>ext/rubymain.cpp</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/fastfilereader/rubymain.cpp#L115'>ext/fastfilereader/rubymain.cpp</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L73'>lib/eventmachine.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/callback.rb#L1'>lib/em/callback.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/channel.rb#L1'>lib/em/channel.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/completion.rb#L1'>lib/em/completion.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L1'>lib/em/connection.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/deferrable.rb#L26'>lib/em/deferrable.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/file_watch.rb#L1'>lib/em/file_watch.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/io_streamer.rb#L24'>lib/em/io_streamer.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/iterator.rb#L1'>lib/em/iterator.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/pool.rb#L1'>lib/em/pool.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/process_watch.rb#L1'>lib/em/process_watch.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/processes.rb#L27'>lib/em/processes.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols.rb#L1'>lib/em/protocols.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/queue.rb#L1'>lib/em/queue.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/resolver.rb#L1'>lib/em/resolver.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/spawnable.rb#L26'>lib/em/spawnable.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/streamer.rb#L1'>lib/em/streamer.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/threaded_resource.rb#L1'>lib/em/threaded_resource.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/tick_loop.rb#L1'>lib/em/tick_loop.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/timers.rb#L1'>lib/em/timers.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/version.rb#L1'>lib/em/version.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/header_and_content.rb#L26'>lib/em/protocols/header_and_content.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/httpclient.rb#L29'>lib/em/protocols/httpclient.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/httpclient2.rb#L26'>lib/em/protocols/httpclient2.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/line_and_text.rb#L27'>lib/em/protocols/line_and_text.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/line_protocol.rb#L3'>lib/em/protocols/line_protocol.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/linetext2.rb#L26'>lib/em/protocols/linetext2.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/memcache.rb#L1'>lib/em/protocols/memcache.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/object_protocol.rb#L3'>lib/em/protocols/object_protocol.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/postgres3.rb#L52'>lib/em/protocols/postgres3.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/saslauth.rb#L29'>lib/em/protocols/saslauth.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpclient.rb#L28'>lib/em/protocols/smtpclient.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L26'>lib/em/protocols/smtpserver.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/socks4.rb#L1'>lib/em/protocols/socks4.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/stomp.rb#L27'>lib/em/protocols/stomp.rb</a>,<br/> <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/tcptest.rb#L27'>lib/em/protocols/tcptest.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    <p>Top-level <code>EventMachine</code> namespace. If you are looking for <code>EventMachine</code> examples, see <a href="file.GettingStarted.html" title="&lt;code&gt;EventMachine&lt;/code&gt; tutorial"><code>EventMachine</code> tutorial</a>.</p>

<h3>Key methods</h3>

<h4>Starting and stopping the event loop</h4>

<ul>
<li><a href="#run-class_method" title="EventMachine.run (method)">.run</a></li>
<li><a href="#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">.stop_event_loop</a></li>
</ul>

<h4>Implementing clients</h4>

<ul>
<li><a href="#connect-class_method" title="EventMachine.connect (method)">.connect</a></li>
</ul>

<h4>Implementing servers</h4>

<ul>
<li><a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a></li>
</ul>

<h4>Working with timers</h4>

<ul>
<li><a href="#add_timer-class_method" title="EventMachine.add_timer (method)">.add_timer</a></li>
<li><a href="#add_periodic_timer-class_method" title="EventMachine.add_periodic_timer (method)">.add_periodic_timer</a></li>
<li><a href="#cancel_timer-class_method" title="EventMachine.cancel_timer (method)">.cancel_timer</a></li>
</ul>

<h4>Working with blocking tasks</h4>

<ul>
<li><a href="#defer-class_method" title="EventMachine.defer (method)">.defer</a></li>
<li><a href="#next_tick-class_method" title="EventMachine.next_tick (method)">.next_tick</a></li>
</ul>

<h4>Efficient proxying</h4>

<ul>
<li><a href="#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">.enable_proxy</a></li>
<li><a href="#disable_proxy-class_method" title="EventMachine.disable_proxy (method)">.disable_proxy</a></li>
</ul>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ConnectionAccepted-constant' class='summary_signature'>ConnectionAccepted =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1605'># File 'ext/rubymain.cpp', line 1605</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_CONNECTION_ACCEPTED</span>       )</pre>
  </li>
  <li>
    <span id='ConnectionCompleted-constant' class='summary_signature'>ConnectionCompleted =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1606'># File 'ext/rubymain.cpp', line 1606</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_CONNECTION_COMPLETED</span>      )</pre>
  </li>
  <li>
    <span id='ConnectionData-constant' class='summary_signature'>ConnectionData =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1603'># File 'ext/rubymain.cpp', line 1603</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_CONNECTION_READ</span>           )</pre>
  </li>
  <li>
    <span id='ConnectionNotifyReadable-constant' class='summary_signature'>ConnectionNotifyReadable =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1608'># File 'ext/rubymain.cpp', line 1608</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_CONNECTION_NOTIFY_READABLE</span>)</pre>
  </li>
  <li>
    <span id='ConnectionNotifyWritable-constant' class='summary_signature'>ConnectionNotifyWritable =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1609'># File 'ext/rubymain.cpp', line 1609</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_CONNECTION_NOTIFY_WRITABLE</span>)</pre>
  </li>
  <li>
    <span id='ConnectionUnbound-constant' class='summary_signature'>ConnectionUnbound =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1604'># File 'ext/rubymain.cpp', line 1604</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_CONNECTION_UNBOUND</span>        )</pre>
  </li>
  <li>
    <span id='EM_PROTO_SSLv2-constant' class='summary_signature'>EM_PROTO_SSLv2 =</span>
    <div class='docstring'>
  <div class='discussion'>
    <p>SSL Protocols</p>

  </div>
</div>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1616'># File 'ext/rubymain.cpp', line 1616</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'><a href="#EM_PROTO_SSLv2-constant" title="EventMachine::EM_PROTO_SSLv2 (constant)">EM_PROTO_SSLv2</a></span>  )</pre>
  </li>
  <li>
    <span id='EM_PROTO_SSLv3-constant' class='summary_signature'>EM_PROTO_SSLv3 =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1617'># File 'ext/rubymain.cpp', line 1617</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'><a href="#EM_PROTO_SSLv3-constant" title="EventMachine::EM_PROTO_SSLv3 (constant)">EM_PROTO_SSLv3</a></span>  )</pre>
  </li>
  <li>
    <span id='EM_PROTO_TLSv1-constant' class='summary_signature'>EM_PROTO_TLSv1 =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1618'># File 'ext/rubymain.cpp', line 1618</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'><a href="#EM_PROTO_TLSv1-constant" title="EventMachine::EM_PROTO_TLSv1 (constant)">EM_PROTO_TLSv1</a></span>  )</pre>
  </li>
  <li>
    <span id='EM_PROTO_TLSv1_1-constant' class='summary_signature'>EM_PROTO_TLSv1_1 =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1619'># File 'ext/rubymain.cpp', line 1619</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'><a href="#EM_PROTO_TLSv1_1-constant" title="EventMachine::EM_PROTO_TLSv1_1 (constant)">EM_PROTO_TLSv1_1</a></span>)</pre>
  </li>
  <li>
    <span id='EM_PROTO_TLSv1_2-constant' class='summary_signature'>EM_PROTO_TLSv1_2 =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1620'># File 'ext/rubymain.cpp', line 1620</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'><a href="#EM_PROTO_TLSv1_2-constant" title="EventMachine::EM_PROTO_TLSv1_2 (constant)">EM_PROTO_TLSv1_2</a></span>)</pre>
  </li>
  <li>
    <span id='EM_PROTO_TLSv1_3-constant' class='summary_signature'>EM_PROTO_TLSv1_3 =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1622'># File 'ext/rubymain.cpp', line 1622</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'><a href="#EM_PROTO_TLSv1_3-constant" title="EventMachine::EM_PROTO_TLSv1_3 (constant)">EM_PROTO_TLSv1_3</a></span>)</pre>
  </li>
  <li>
    <span id='ERRNOS-constant' class='summary_signature nodoc'>ERRNOS =</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='docstring'>
  <div class='discussion'>
    <p>System errnos</p>

  </div>
</div>
<div class='tags'>
  
</div>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L91-L95'># File 'lib/eventmachine.rb', line 91</a>    <pre class='code ruby'><span class='const'>Errno</span><span class='op'>::</span><span class='id identifier rubyid_constants'>constants</span>.<span class='id identifier rubyid_grep'>grep</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^E</span><span class='regexp_end'>/</span></span>).<span class='id identifier rubyid_inject'>inject</span>(<span class='const'>Hash</span>.<span class='id identifier rubyid_new'>new</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_unknown'>unknown</span>)) { <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
  <span class='id identifier rubyid_errno'>errno</span> <span class='op'>=</span> <span class='const'>Errno</span>.<span class='id identifier rubyid___send__'>__send__</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_const_get'>const_get</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='id identifier rubyid_hash'>hash</span>[<span class='id identifier rubyid_errno'>errno</span><span class='op'>::</span><span class='const'>Errno</span>] <span class='op'>=</span> <span class='id identifier rubyid_errno'>errno</span>
  <span class='id identifier rubyid_hash'>hash</span>
}</pre>
  </li>
  <li>
    <span id='LoopbreakSignalled-constant' class='summary_signature'>LoopbreakSignalled =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1607'># File 'ext/rubymain.cpp', line 1607</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_LOOPBREAK_SIGNAL</span>          )</pre>
  </li>
  <li>
    <span id='OPENSSL_LIBRARY_VERSION-constant' class='summary_signature'>OPENSSL_LIBRARY_VERSION =</span>
    <div class='docstring'>
  <div class='discussion'>
    <p>Version of OpenSSL that <code>EventMachine</code> loaded with</p>

  </div>
</div>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1645'># File 'ext/rubymain.cpp', line 1645</a>    <pre class='code c'><span class='id identifier rubyid_rb_str_new2'>rb_str_new2</span>(<span class='const'>OpenSSL_version</span>(<span class='const'><a href="#OPENSSL_VERSION-constant" title="EventMachine::OPENSSL_VERSION (constant)">OPENSSL_VERSION</a></span>))</pre>
  </li>
  <li>
    <span id='OPENSSL_NO_SSL2-constant' class='summary_signature'>OPENSSL_NO_SSL2 =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1628'># File 'ext/rubymain.cpp', line 1628</a>    <pre class='code c'><span class='const'>Qtrue</span></pre>
  </li>
  <li>
    <span id='OPENSSL_NO_SSL3-constant' class='summary_signature'>OPENSSL_NO_SSL3 =</span>
    <div class='docstring'>
  <div class='discussion'>
    <p>True if SSL3 is not available</p>

  </div>
</div>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1627'># File 'ext/rubymain.cpp', line 1627</a>    <pre class='code c'><span class='const'>Qtrue</span></pre>
  </li>
  <li>
    <span id='OPENSSL_VERSION-constant' class='summary_signature'>OPENSSL_VERSION =</span>
    <div class='docstring'>
  <div class='discussion'>
    <p>Version of OpenSSL that <code>EventMachine</code> was compiled with</p>

  </div>
</div>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1641'># File 'ext/rubymain.cpp', line 1641</a>    <pre class='code c'><span class='id identifier rubyid_rb_str_new2'>rb_str_new2</span>(<span class='const'>OPENSSL_VERSION_TEXT</span>)</pre>
  </li>
  <li>
    <span id='P-constant' class='summary_signature'>P =</span>
    <div class='docstring'>
  <div class='discussion'>
    <p>Alias for <a href="EventMachine/Protocols.html" title="EventMachine::Protocols (module)"><code>Protocols</code></a></p>

  </div>
</div>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1603-L1603'># File 'lib/eventmachine.rb', line 1603</a>    <pre class='code ruby'><span class='const'>EventMachine</span><span class='op'>::</span><span class='const'><a href="EventMachine/Protocols.html" title="EventMachine::Protocols (module)">Protocols</a></span></pre>
  </li>
  <li>
    <span id='SslHandshakeCompleted-constant' class='summary_signature'>SslHandshakeCompleted =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1610'># File 'ext/rubymain.cpp', line 1610</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_SSL_HANDSHAKE_COMPLETED</span>   )</pre>
  </li>
  <li>
    <span id='SslVerify-constant' class='summary_signature'>SslVerify =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1611'># File 'ext/rubymain.cpp', line 1611</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_SSL_VERIFY</span>                )</pre>
  </li>
  <li>
    <span id='TimerFired-constant' class='summary_signature'>TimerFired =</span>
    <div class='docstring'>
  <div class='discussion'>
    <p><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> states</p>

  </div>
</div>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1602'># File 'ext/rubymain.cpp', line 1602</a>    <pre class='code c'><span class='const'>INT2NUM</span>(<span class='const'>EM_TIMER_FIRED</span>               )</pre>
  </li>
  <li>
    <span id='VERSION-constant' class='summary_signature'>VERSION =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/version.rb#L2-L2'># File 'lib/em/version.rb', line 2</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.3.0.dev.1</span><span class='tstring_end'>&quot;</span></span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#defers_finished%3F-class_method" title=".defers_finished? (class method)">.<strong>defers_finished?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns <code>true</code> if all deferred actions are done executing and their callbacks have been fired.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#heartbeat_interval-class_method" title=".heartbeat_interval (class method)">.<strong>heartbeat_interval</strong>  &#x21d2; Integer </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Retrieve the heartbeat interval.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#heartbeat_interval=-class_method" title=".heartbeat_interval= (class method)">.<strong>heartbeat_interval=</strong>(time)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the heartbeat interval.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#reactor_running%3F-class_method" title=".reactor_running? (class method)">.<strong>reactor_running?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Tells you whether the <code>EventMachine</code> reactor loop is currently running.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#reactor_thread-class_method" title=".reactor_thread (class method)">.<strong>reactor_thread</strong>  &#x21d2; Thread </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Exposed to allow joining on the thread, when run in a multithreaded environment.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#reactor_thread%3F-class_method" title=".reactor_thread? (class method)">.<strong>reactor_thread?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro nodoc'>
      <a href="#threadpool-class_method" title=".threadpool (class method)">.<strong>threadpool</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#threadpool_size-class_method" title=".threadpool_size (class method)">.<strong>threadpool_size</strong>  &#x21d2; Number </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Size of the <code>EventMachine</code>.defer threadpool (defaults to 20).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#epoll-class_method" title=".epoll (class method)">.<strong>epoll</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t__epoll.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#epoll%3F-class_method" title=".epoll? (class method)">.<strong>epoll?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t__epoll_p.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#kqueue-class_method" title=".kqueue (class method)">.<strong>kqueue</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t__kqueue.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#kqueue%3F-class_method" title=".kqueue? (class method)">.<strong>kqueue?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t__kqueue_p.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ssl%3F-class_method" title=".ssl? (class method)">.<strong>ssl?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t__ssl_p.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#stopping%3F-class_method" title=".stopping? (class method)">.<strong>stopping?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_stopping.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_attribute_summary -->

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#_open_file_for_writing-class_method" title="._open_file_for_writing (class method)">.<strong>_open_file_for_writing</strong>(filename, handler = nil)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_periodic_timer-class_method" title=".add_periodic_timer (class method)">.<strong>add_periodic_timer</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Adds a periodic timer to the event loop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_shutdown_hook-class_method" title=".add_shutdown_hook (class method)">.<strong>add_shutdown_hook</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Adds a block to call as the reactor is shutting down.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#add_timer-class_method" title=".add_timer (class method)">.<strong>add_timer</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Adds a one-shot timer to the event loop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attach-class_method" title=".attach (class method)">.<strong>attach</strong>(io, handler = nil, *args, &amp;blk)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Attaches an IO object or file descriptor to the eventloop as a regular connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#attach_io-class_method" title=".attach_io (class method)">.<strong>attach_io</strong>(io, watch_mode, handler = nil, *args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#attach_server-class_method" title=".attach_server (class method)">.<strong>attach_server</strong>(sock, handler = nil, *args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Attach to an existing socket&#39;s file descriptor.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#bind_connect-class_method" title=".bind_connect (class method)">.<strong>bind_connect</strong>(bind_addr, bind_port, server, port = nil, handler = nil, *args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This method is like <a href="#connect-class_method" title="EventMachine.connect (method)">.connect</a>, but allows for a local address/port to bind the connection to.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#Callback-class_method" title="Callback (class method)"><strong>Callback</strong>(object, method)  &#x21d2; &lt;#call&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Utility method for coercing arguments to an object that responds to <code>:call</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#cancel_timer-class_method" title=".cancel_timer (class method)">.<strong>cancel_timer</strong>(timer_or_sig)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Cancel a timer (can be a callback or an <a href="EventMachine/Timer.html" title="EventMachine::Timer (class)"><code>Timer</code></a> instance).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#cleanup_machine-class_method" title=".cleanup_machine (class method)">.<strong>cleanup_machine</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Clean up Ruby space following a release_machine.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect-class_method" title=".connect (class method)">.<strong>connect</strong>(server, port = nil, handler = nil, *args, &amp;blk)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Initiates a TCP connection to a remote server and sets up event handling for the connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect_unix_domain-class_method" title=".connect_unix_domain (class method)">.<strong>connect_unix_domain</strong>(socketname, *args, &amp;blk)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Make a connection to a Unix-domain socket.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connection_count-class_method" title=".connection_count (class method)">.<strong>connection_count</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the total number of connections (file descriptors) currently held by the reactor.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#defer-class_method" title=".defer (class method)">.<strong>defer</strong>(op = nil, callback = nil, errback = nil, &amp;blk)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p><code>EventMachine</code>.defer is used for integrating blocking operations into EventMachine&#39;s control flow.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#disable_proxy-class_method" title=".disable_proxy (class method)">.<strong>disable_proxy</strong>(from)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Takes just one argument, a <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> that has proxying enabled via <a href="#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">.enable_proxy</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enable_proxy-class_method" title=".enable_proxy (class method)">.<strong>enable_proxy</strong>(from, to, bufsize = 0, length = 0)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This method allows for direct writing of incoming data back out to another descriptor, at the C++ level in the reactor.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#error_handler-class_method" title=".error_handler (class method)">.<strong>error_handler</strong>(cb = nil, &amp;blk)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Catch-all for errors raised during event loop callbacks.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#event_callback-class_method" title=".event_callback (class method)">.<strong>event_callback</strong>(conn_binding, opcode, data)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#fork_reactor-class_method" title=".fork_reactor (class method)">.<strong>fork_reactor</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Forks a new process, properly stops the reactor and then calls <a href="#run-class_method" title="EventMachine.run (method)">.run</a> inside of it again, passing your block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_max_timers-class_method" title=".get_max_timers (class method)">.<strong>get_max_timers</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Gets the current maximum number of allowed timers.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#klass_from_handler-class_method" title=".klass_from_handler (class method)">.<strong>klass_from_handler</strong>(klass = Connection, handler = nil, *args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#next_tick-class_method" title=".next_tick (class method)">.<strong>next_tick</strong>(pr = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Schedules a proc for execution immediately after the next &quot;turn&quot; through the reactor core.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#open_datagram_socket-class_method" title=".open_datagram_socket (class method)">.<strong>open_datagram_socket</strong>(address, port, handler = nil, *args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Used for UDP-based protocols.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#open_keyboard-class_method" title=".open_keyboard (class method)">.<strong>open_keyboard</strong>(handler = nil, *args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>(Experimental).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#popen-class_method" title=".popen (class method)">.<strong>popen</strong>(cmd, handler = nil, *args) {|c| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Runs an external process.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reconnect-class_method" title=".reconnect (class method)">.<strong>reconnect</strong>(server, port, handler)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Connect to a given host/port and re-use the provided <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> instance.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#run-class_method" title=".run (class method)">.<strong>run</strong>(blk = nil, tail = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Initializes and runs an event loop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#run_block-class_method" title=".run_block (class method)">.<strong>run_block</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sugars a common use case.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#run_deferred_callbacks-class_method" title=".run_deferred_callbacks (class method)">.<strong>run_deferred_callbacks</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>The is the responder for the loopback-signalled event.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#schedule-class_method" title=".schedule (class method)">.<strong>schedule</strong>(*a, &amp;b)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Runs the given callback on the reactor thread, or immediately if called from the reactor thread.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_descriptor_table_size-class_method" title=".set_descriptor_table_size (class method)">.<strong>set_descriptor_table_size</strong>(n_descriptors = nil)  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the maximum number of file or socket descriptors that your process may open.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_effective_user-class_method" title=".set_effective_user (class method)">.<strong>set_effective_user</strong>(username)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A wrapper over the setuid system call.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_max_timers-class_method" title=".set_max_timers (class method)">.<strong>set_max_timers</strong>(ct)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the maximum number of timers and periodic timers that may be outstanding at any given time.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_quantum-class_method" title=".set_quantum (class method)">.<strong>set_quantum</strong>(mills)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>For advanced users.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#spawn-class_method" title=".spawn (class method)">.<strong>spawn</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Spawn an erlang-style process.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#spawn_threadpool-class_method" title=".spawn_threadpool (class method)">.<strong>spawn_threadpool</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#start_server-class_method" title=".start_server (class method)">.<strong>start_server</strong>(server, port = nil, handler = nil, *args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Initiates a TCP server (socket acceptor) on the specified IP address and port.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#start_unix_domain_server-class_method" title=".start_unix_domain_server (class method)">.<strong>start_unix_domain_server</strong>(filename, *args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Start a Unix-domain server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stop_event_loop-class_method" title=".stop_event_loop (class method)">.<strong>stop_event_loop</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Causes the processing loop to stop executing, which will cause all open connections and accepting servers to be run down and closed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stop_server-class_method" title=".stop_server (class method)">.<strong>stop_server</strong>(signature)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Stop a TCP server socket that was started with <a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#system-class_method" title=".system (class method)">.<strong>system</strong>(cmd, *args, &amp;cb)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>EM::system is a simple wrapper for EM::popen.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#tick_loop-class_method" title=".tick_loop (class method)">.<strong>tick_loop</strong>(*a, &amp;b)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates and immediately starts an <a href="EventMachine/TickLoop.html" title="EventMachine::TickLoop (class)"><code>TickLoop</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#watch-class_method" title=".watch (class method)">.<strong>watch</strong>(io, handler = nil, *args, &amp;blk)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="#watch-class_method" title="EventMachine.watch (method)">.watch</a> registers a given file descriptor or IO object with the eventloop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#watch_file-class_method" title=".watch_file (class method)">.<strong>watch_file</strong>(filename, handler = nil, *args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>EventMachine&#39;s file monitoring API.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#watch_process-class_method" title=".watch_process (class method)">.<strong>watch_process</strong>(pid, handler = nil, *args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>EventMachine&#39;s process monitoring API.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#yield-class_method" title=".yield (class method)">.<strong>yield</strong>(&amp;block)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#yield_and_notify-class_method" title=".yield_and_notify (class method)">.<strong>yield_and_notify</strong>(&amp;block)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#add_oneshot_timer-class_method" title=".add_oneshot_timer (class method)">.<strong>add_oneshot_timer</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_add_oneshot_timer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#attach_sd-class_method" title=".attach_sd (class method)">.<strong>attach_sd</strong>(sd)  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_attach_sd.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#bind_connect_server-class_method" title=".bind_connect_server (class method)">.<strong>bind_connect_server</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_bind_connect_server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#close_connection-class_method" title=".close_connection (class method)">.<strong>close_connection</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_close_connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#connect_server-class_method" title=".connect_server (class method)">.<strong>connect_server</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_connect_server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#connect_unix_server-class_method" title=".connect_unix_server (class method)">.<strong>connect_unix_server</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_connect_unix_server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#current_time-class_method" title=".current_time (class method)">.<strong>current_time</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_loop_time.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#epoll=-class_method" title=".epoll= (class method)">.<strong>epoll=</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t__epoll_set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_cipher_bits-class_method" title=".get_cipher_bits (class method)">.<strong>get_cipher_bits</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_cipher_name-class_method" title=".get_cipher_name (class method)">.<strong>get_cipher_name</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_cipher_protocol-class_method" title=".get_cipher_protocol (class method)">.<strong>get_cipher_protocol</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_comm_inactivity_timeout-class_method" title=".get_comm_inactivity_timeout (class method)">.<strong>get_comm_inactivity_timeout</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_comm_inactivity_timeout.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_connection_count-class_method" title=".get_connection_count (class method)">.<strong>get_connection_count</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_connection_count.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_heartbeat_interval-class_method" title=".get_heartbeat_interval (class method)">.<strong>get_heartbeat_interval</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_heartbeat_interval.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_idle_time-class_method" title=".get_idle_time (class method)">.<strong>get_idle_time</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_idle_time.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_max_timer_count-class_method" title=".get_max_timer_count (class method)">.<strong>get_max_timer_count</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_max_timer_count.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_peer_cert-class_method" title=".get_peer_cert (class method)">.<strong>get_peer_cert</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_peername-class_method" title=".get_peername (class method)">.<strong>get_peername</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_peername.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_pending_connect_timeout-class_method" title=".get_pending_connect_timeout (class method)">.<strong>get_pending_connect_timeout</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_pending_connect_timeout.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_simultaneous_accept_count-class_method" title=".get_simultaneous_accept_count (class method)">.<strong>get_simultaneous_accept_count</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get/set_simultaneous_accept_count.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_sni_hostname-class_method" title=".get_sni_hostname (class method)">.<strong>get_sni_hostname</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_sockname-class_method" title=".get_sockname (class method)">.<strong>get_sockname</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_sockname.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_subprocess_pid-class_method" title=".get_subprocess_pid (class method)">.<strong>get_subprocess_pid</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_subprocess_pid.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_subprocess_status-class_method" title=".get_subprocess_status (class method)">.<strong>get_subprocess_status</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_subprocess_status.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#get_timer_count-class_method" title=".get_timer_count (class method)">.<strong>get_timer_count</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_get_timer_count.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#initialize_event_machine-class_method" title=".initialize_event_machine (class method)">.<strong>initialize_event_machine</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_initialize_event_machine.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#invoke_popen-class_method" title=".invoke_popen (class method)">.<strong>invoke_popen</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_invoke_popen.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#kqueue=-class_method" title=".kqueue= (class method)">.<strong>kqueue=</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t__kqueue_set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#library_type-class_method" title=".library_type (class method)">.<strong>library_type</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_library_type.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#open_udp_socket-class_method" title=".open_udp_socket (class method)">.<strong>open_udp_socket</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_open_udp_socket.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#read_keyboard-class_method" title=".read_keyboard (class method)">.<strong>read_keyboard</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_read_keyboard.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#release_machine-class_method" title=".release_machine (class method)">.<strong>release_machine</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_release_machine.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#report_connection_error_status-class_method" title=".report_connection_error_status (class method)">.<strong>report_connection_error_status</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_report_connection_error_status.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#run_machine-class_method" title=".run_machine (class method)">.<strong>run_machine</strong>  </a>
      (also: .run_machine_without_threads)
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_run_machine.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#run_machine_once-class_method" title=".run_machine_once (class method)">.<strong>run_machine_once</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_run_machine_once.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#run_machine_without_threads-class_method" title=".run_machine_without_threads (class method)">.<strong>run_machine_without_threads</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#run_machine-class_method" title="EventMachine.run_machine (method)">.run_machine</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#send_data-class_method" title=".send_data (class method)">.<strong>send_data</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_send_data.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#send_datagram-class_method" title=".send_datagram (class method)">.<strong>send_datagram</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_send_datagram.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#send_file_data-class_method" title=".send_file_data (class method)">.<strong>send_file_data</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_send_file_data.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_comm_inactivity_timeout-class_method" title=".set_comm_inactivity_timeout (class method)">.<strong>set_comm_inactivity_timeout</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_set_comm_inactivity_timeout.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_heartbeat_interval-class_method" title=".set_heartbeat_interval (class method)">.<strong>set_heartbeat_interval</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_set_heartbeat_interval.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_max_timer_count-class_method" title=".set_max_timer_count (class method)">.<strong>set_max_timer_count</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_set_max_timer_count.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_pending_connect_timeout-class_method" title=".set_pending_connect_timeout (class method)">.<strong>set_pending_connect_timeout</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_set_pending_connect_timeout.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_rlimit_nofile-class_method" title=".set_rlimit_nofile (class method)">.<strong>set_rlimit_nofile</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_set_rlimit_nofile.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_simultaneous_accept_count-class_method" title=".set_simultaneous_accept_count (class method)">.<strong>set_simultaneous_accept_count</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_timer_quantum-class_method" title=".set_timer_quantum (class method)">.<strong>set_timer_quantum</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_set_timer_quantum.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#set_tls_parms-class_method" title=".set_tls_parms (class method)">.<strong>set_tls_parms</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_set_tls_parms.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#setuid_string-class_method" title=".setuid_string (class method)">.<strong>setuid_string</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_setuid_string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#signal_loopbreak-class_method" title=".signal_loopbreak (class method)">.<strong>signal_loopbreak</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_signal_loopbreak.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#start_tcp_server-class_method" title=".start_tcp_server (class method)">.<strong>start_tcp_server</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_start_server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#start_tls-class_method" title=".start_tls (class method)">.<strong>start_tls</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_start_tls.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#start_unix_server-class_method" title=".start_unix_server (class method)">.<strong>start_unix_server</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_start_unix_server.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#stop-class_method" title=".stop (class method)">.<strong>stop</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_stop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature mf'>
      <a href="#stop_tcp_server-class_method" title=".stop_tcp_server (class method)">.<strong>stop_tcp_server</strong>  </a>
    </span>
    <span class='mod_func note title'>mod_func</span>
    <div class='summary_desc'>
      <div class='inline'><p>t_stop_server.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->
<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="defers_finished?-class_method">
  <h3 class='signature ro first'>
    .<strong>defers_finished?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Returns <code>true</code> if all deferred actions are done executing and their
callbacks have been fired.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1096-L1102'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1096' data-end='1102'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1096</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_defers_finished?'>defers_finished?</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='ivar'>@threadpool</span> <span class='kw'>and</span> <span class='op'>!</span><span class='ivar'>@all_threads_spawned</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='ivar'>@threadqueue</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='ivar'>@threadqueue</span>.<span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='ivar'>@resultqueue</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='ivar'>@resultqueue</span>.<span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='ivar'>@threadpool</span> <span class='kw'>and</span> <span class='ivar'>@threadqueue</span>.<span class='id identifier rubyid_num_waiting'>num_waiting</span> <span class='op'>!=</span> <span class='ivar'>@threadpool</span>.<span class='id identifier rubyid_size'>size</span>
  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="epoll-class_method">
  <h3 class='signature ro  private'>
    .<strong>epoll</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t__epoll</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1159-L1166'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1159' data-end='1166'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1159</span></pre>
<pre class='code cpp'>

static VALUE t__epoll (VALUE self UNUSED)
{
	if (t__epoll_p(self) == Qfalse)
		return Qfalse;

	evma_set_epoll (1);
	return Qtrue;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="epoll?-class_method">
  <h3 class='signature ro  private'>
    .<strong>epoll?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t__epoll_p</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1146-L1153'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1146' data-end='1153'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1146</span></pre>
<pre class='code cpp'>

static VALUE t__epoll_p (VALUE self UNUSED)
{
	#ifdef HAVE_EPOLL
	return Qtrue;
	#else
	return Qfalse;
	#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="heartbeat_interval-class_method">
  <h3 class='signature rw'>
    .<strong>heartbeat_interval</strong>  &#x21d2; <code>Integer</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Retrieve the heartbeat interval. This is how often <code>EventMachine</code> will check for dead connections
that have had an inactivity timeout set via <a href="EventMachine/Connection.html#set_comm_inactivity_timeout-instance_method" title="EventMachine::Connection#set_comm_inactivity_timeout (method)">Connection#set_comm_inactivity_timeout</a>.
Default is 2 seconds.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Heartbeat interval, in seconds</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1450-L1452'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1450' data-end='1452'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1450</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_heartbeat_interval'>heartbeat_interval</span>
  <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='id identifier rubyid_get_heartbeat_interval'><a href="#get_heartbeat_interval-class_method" title="EventMachine.get_heartbeat_interval (method)">get_heartbeat_interval</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="heartbeat_interval=-class_method">
  <h3 class='signature rw'>
    .<strong>heartbeat_interval=</strong>(time)   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Set the heartbeat interval. This is how often <code>EventMachine</code> will check for dead connections
that have had an inactivity timeout set via <a href="EventMachine/Connection.html#set_comm_inactivity_timeout-instance_method" title="EventMachine::Connection#set_comm_inactivity_timeout (method)">Connection#set_comm_inactivity_timeout</a>.
Takes a Numeric number of seconds. Default is 2.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>time</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Heartbeat interval, in seconds</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1459-L1461'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1459' data-end='1461'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1459</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_heartbeat_interval='>heartbeat_interval=</span>(<span class='id identifier rubyid_time'>time</span>)
  <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='id identifier rubyid_set_heartbeat_interval'><a href="#set_heartbeat_interval-class_method" title="EventMachine.set_heartbeat_interval (method)">set_heartbeat_interval</a></span> <span class='id identifier rubyid_time'>time</span>.<span class='id identifier rubyid_to_f'>to_f</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="kqueue-class_method">
  <h3 class='signature ro  private'>
    .<strong>kqueue</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t__kqueue</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1199-L1206'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1199' data-end='1206'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1199</span></pre>
<pre class='code cpp'>

static VALUE t__kqueue (VALUE self UNUSED)
{
	if (t__kqueue_p(self) == Qfalse)
		return Qfalse;

	evma_set_kqueue (1);
	return Qtrue;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="kqueue?-class_method">
  <h3 class='signature ro  private'>
    .<strong>kqueue?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t__kqueue_p</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1186-L1193'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1186' data-end='1193'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1186</span></pre>
<pre class='code cpp'>

static VALUE t__kqueue_p (VALUE self UNUSED)
{
	#ifdef HAVE_KQUEUE
	return Qtrue;
	#else
	return Qfalse;
	#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reactor_running?-class_method">
  <h3 class='signature ro'>
    .<strong>reactor_running?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Tells you whether the <code>EventMachine</code> reactor loop is currently running.</p>

<p>Useful when writing libraries that want to run event-driven code, but may
be running in programs that are already event-driven. In such cases, if <code>reactor_running?</code>
returns false, your code can invoke <a href="#run-class_method" title="EventMachine.run (method)">.run</a> and run your application code inside
the block passed to that method. If this method returns true, just
execute your event-aware code.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Boolean</code>)</span>
&mdash;    <div class='inline'><p>true if the <code>EventMachine</code> reactor loop is currently running</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1228-L1230'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1228' data-end='1230'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1228</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_reactor_running?'>reactor_running?</span>
  <span class='ivar'>@reactor_running</span> <span class='op'>&amp;&amp;</span> <span class='const'>Process</span>.<span class='id identifier rubyid_pid'>pid</span> <span class='op'>==</span> <span class='ivar'>@reactor_pid</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reactor_thread-class_method">
  <h3 class='signature ro'>
    .<strong>reactor_thread</strong>  &#x21d2; <code>Thread</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Exposed to allow joining on the thread, when run in a multithreaded
environment. Performing other actions on the thread has undefined
semantics (read: a dangerous endevor).</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L80-L80'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='80' data-end='80'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 80</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reactor_thread'>reactor_thread</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reactor_thread?-class_method">
  <h3 class='signature ro'>
    .<strong>reactor_thread?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Boolean</code>)</span>
&mdash;    <div class='inline'><p>true if the calling thread is the same thread as the reactor.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L228-L230'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='228' data-end='230'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 228</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_reactor_thread?'>reactor_thread?</span>
  <span class='const'>Thread</span>.<span class='id identifier rubyid_current'>current</span> <span class='op'>==</span> <span class='ivar'>@reactor_thread</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ssl?-class_method">
  <h3 class='signature ro  private'>
    .<strong>ssl?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t__ssl_p</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1226-L1233'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1226' data-end='1233'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1226</span></pre>
<pre class='code cpp'>

static VALUE t__ssl_p (VALUE self UNUSED)
{
	#ifdef WITH_SSL
	return Qtrue;
	#else
	return Qfalse;
	#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stopping?-class_method">
  <h3 class='signature ro  private'>
    .<strong>stopping?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_stopping</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1239-L1246'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1239' data-end='1246'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1239</span></pre>
<pre class='code cpp'>

static VALUE t_stopping ()
{
	if (evma_stopping()) {
		return Qtrue;
	} else {
		return Qfalse;
	}
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="threadpool-class_method">
  <h3 class='signature ro  nodoc'>
    .<strong>threadpool</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1106-L1106'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1106' data-end='1106'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1106</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_threadpool'>threadpool</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="threadpool_size-class_method">
  <h3 class='signature rw'>
    .<strong>threadpool_size</strong>  &#x21d2; <code>Number</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Size of the <code>EventMachine</code>.defer threadpool (defaults to 20)</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1110-L1110'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1110' data-end='1110'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1110</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_threadpool_size'>threadpool_size</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="_open_file_for_writing-class_method">
  <h3 class='signature nodoc first'>
    .<strong>_open_file_for_writing</strong>(filename, handler = nil)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1565-L1573'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1565' data-end='1573'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1565</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid__open_file_for_writing'>_open_file_for_writing</span> <span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span>
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span>)

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid__write_file'>_write_file</span> <span class='id identifier rubyid_filename'>filename</span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span>
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_oneshot_timer-class_method">
  <h3 class='signature private'>
    .<strong>add_oneshot_timer</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_add_oneshot_timer</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L291-L297'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='291' data-end='297'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 291</span></pre>
<pre class='code cpp'>

static VALUE t_add_oneshot_timer (VALUE self UNUSED, VALUE interval)
{
	const uintptr_t f = evma_install_oneshot_timer (FIX2LONG (interval));
	if (!f)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;ran out of timers; use #set_max_timers to increase limit&quot;);
	return BSIG2NUM (f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_periodic_timer-class_method">
  <h3 class='signature '>
    .<strong>add_periodic_timer</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Adds a periodic timer to the event loop.
It takes the same parameters as the one-shot timer method, <a href="#add_timer-class_method" title="EventMachine.add_timer (method)">.add_timer</a>.
This method schedules execution of the given block repeatedly, at intervals
of time <em>at least</em> as great as the number of seconds given in the first
parameter to the call.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Write a dollar-sign to stderr every five seconds, without blocking</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_add_periodic_timer'>add_periodic_timer</span>(<span class='int'>5</span>) { <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$</span><span class='tstring_end'>&quot;</span></span> }
}</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>delay</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Delay in seconds</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="EventMachine/PeriodicTimer.html" title="EventMachine::PeriodicTimer (class)"><code>PeriodicTimer</code></a></li>
          <li><a href="#add_timer-class_method" title="EventMachine.add_timer (method)">.add_timer</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L352-L357'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='352' data-end='357'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 352</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_add_periodic_timer'>add_periodic_timer</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_interval'>interval</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_shift'>shift</span>
  <span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_shift'>shift</span> <span class='op'>||</span> <span class='id identifier rubyid_block'>block</span>

  <span class='const'>EventMachine</span><span class='op'>::</span><span class='const'><a href="EventMachine/PeriodicTimer.html" title="EventMachine::PeriodicTimer (class)">PeriodicTimer</a></span>.<span class='id identifier rubyid_new'><a href="EventMachine/PeriodicTimer.html#new-class_method" title="EventMachine::PeriodicTimer.new (method)">new</a></span>(<span class='id identifier rubyid_interval'>interval</span><span class='comma'>,</span> <span class='id identifier rubyid_code'>code</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_shutdown_hook-class_method">
  <h3 class='signature '>
    .<strong>add_shutdown_hook</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Adds a block to call as the reactor is shutting down.</p>

<p>These callbacks are called in the <em>reverse</em> order to which they are added.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Scheduling operations to be run when <code>EventMachine</code> event loop is stopped</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> <span class='kw'>do</span>
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_add_shutdown_hook'>add_shutdown_hook</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span> }
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_add_shutdown_hook'>add_shutdown_hook</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> }
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_stop'><a href="#stop-class_method" title="EventMachine.stop (method)">stop</a></span>
<span class='kw'>end</span>

<span class='comment'># Outputs:
</span><span class='comment'>#   a
</span><span class='comment'>#   b</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L292-L294'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='292' data-end='294'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 292</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_add_shutdown_hook'>add_shutdown_hook</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@tails</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_timer-class_method">
  <h3 class='signature '>
    .<strong>add_timer</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Adds a one-shot timer to the event loop.
Call it with one or two parameters. The first parameters is a delay-time
expressed in <em>seconds</em> (not milliseconds). The second parameter, if
present, must be an object that responds to <code>:call</code>. If 2nd parameter is not given, then you
can also simply pass a block to the method call.</p>

<p>This method may be called from the block passed to <a href="#run-class_method" title="EventMachine.run (method)">.run</a>
or from any callback method. It schedules execution of the proc or block
passed to it, after the passage of an interval of time equal to
<em>at least</em> the number of seconds specified in the first parameter to
the call.</p>

<p><code>add_timer</code> is a non-blocking method. Callbacks can and will
be called during the interval of time that the timer is in effect.
There is no built-in limit to the number of timers that can be outstanding at
any given time.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Setting a one-shot timer with <code>EventMachine</code></p>
</div></p>
      <pre class='example code ruby'><code><span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Starting the run now: </span><span class='embexpr_beg'>#{</span><span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_add_timer'>add_timer</span> <span class='int'>5</span><span class='comma'>,</span> <span class='id identifier rubyid_proc'>proc</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Executing timer event: </span><span class='embexpr_beg'>#{</span><span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_add_timer'>add_timer</span>(<span class='int'>10</span>) { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Executing timer event: </span><span class='embexpr_beg'>#{</span><span class='const'>Time</span>.<span class='id identifier rubyid_now'>now</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }
}</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>delay</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Delay in seconds</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="EventMachine/Timer.html" title="EventMachine::Timer (class)"><code>Timer</code></a></li>
          <li><a href="#add_periodic_timer-class_method" title="EventMachine.add_periodic_timer (method)">.add_periodic_timer</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L324-L333'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='324' data-end='333'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 324</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_add_timer'>add_timer</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_interval'>interval</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_shift'>shift</span>
  <span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_shift'>shift</span> <span class='op'>||</span> <span class='id identifier rubyid_block'>block</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_code'>code</span>
    <span class='comment'># check too many timers!
</span>    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_add_oneshot_timer'><a href="#add_oneshot_timer-class_method" title="EventMachine.add_oneshot_timer (method)">add_oneshot_timer</a></span>((<span class='id identifier rubyid_interval'>interval</span>.<span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>*</span> <span class='int'>1000</span>).<span class='id identifier rubyid_to_i'>to_i</span>)
    <span class='ivar'>@timers</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_code'>code</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attach-class_method">
  <h3 class='signature '>
    .<strong>attach</strong>(io, handler = nil, *args, &amp;blk)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Attaches an IO object or file descriptor to the eventloop as a regular connection.
The file descriptor will be set as non-blocking, and <code>EventMachine</code> will process
receive_data and send_data events on it as it would for any other connection.</p>

<p>To watch a fd instead, use <a href="#watch-class_method" title="EventMachine.watch (method)">.watch</a>, which will not alter the state of the socket
and fire notify_readable and notify_writable events instead.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L742-L744'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='742' data-end='744'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 742</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_attach'>attach</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
  <span class='id identifier rubyid_attach_io'><a href="#attach_io-class_method" title="EventMachine.attach_io (method)">attach_io</a></span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attach_io-class_method">
  <h3 class='signature nodoc'>
    .<strong>attach_io</strong>(io, watch_mode, handler = nil, *args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L747-L775'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='747' data-end='775'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 747</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_attach_io'>attach_io</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_watch_mode'>watch_mode</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_watch_mode'>watch_mode</span> <span class='kw'>and</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_public_instance_methods'>public_instance_methods</span>.<span class='id identifier rubyid_any?'>any?</span>{<span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_notify_readable'>notify_readable</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_notify_writable'>notify_writable</span>].<span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_m'>m</span>.<span class='id identifier rubyid_to_sym'>to_sym</span> }
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>notify_readable/writable with EM.attach is not supported. Use EM.watch(io){ |c| c.notify_readable = true }</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_fileno'>fileno</span>)
    <span class='comment'># getDescriptorByFileno deprecated in JRuby 1.7.x, removed in JRuby 9000
</span>    <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='const'>JRuby</span>) <span class='op'>&amp;&amp;</span> <span class='const'>JRuby</span>.<span class='id identifier rubyid_runtime'>runtime</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_getDescriptorByFileno'>getDescriptorByFileno</span>)
      <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='const'>JRuby</span>.<span class='id identifier rubyid_runtime'>runtime</span>.<span class='id identifier rubyid_getDescriptorByFileno'>getDescriptorByFileno</span>(<span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_fileno'>fileno</span>).<span class='id identifier rubyid_getChannel'>getChannel</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_fileno'>fileno</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='id identifier rubyid_io'>io</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_attach_fd'>attach_fd</span> <span class='id identifier rubyid_fd'>fd</span><span class='comma'>,</span> <span class='id identifier rubyid_watch_mode'>watch_mode</span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>

  <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='symbeg'>:</span><span class='ivar'>@io</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span>)
  <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='symbeg'>:</span><span class='ivar'>@watch_mode</span><span class='comma'>,</span> <span class='id identifier rubyid_watch_mode'>watch_mode</span>)
  <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='symbeg'>:</span><span class='ivar'>@fd</span><span class='comma'>,</span> <span class='id identifier rubyid_fd'>fd</span>)

  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attach_sd-class_method">
  <h3 class='signature private'>
    .<strong>attach_sd</strong>(sd)   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_attach_sd</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L339-L345'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='339' data-end='345'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 339</span></pre>
<pre class='code cpp'>

static VALUE t_attach_sd(VALUE self UNUSED, VALUE sd)
{
	const uintptr_t f = evma_attach_sd(FIX2INT(sd));
	if (!f)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;no socket descriptor acceptor&quot;);
	return BSIG2NUM (f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="attach_server-class_method">
  <h3 class='signature '>
    .<strong>attach_server</strong>(sock, handler = nil, *args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Attach to an existing socket&#39;s file descriptor. The socket may have been
started with <a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L542-L548'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='542' data-end='548'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 542</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_attach_server'>attach_server</span> <span class='id identifier rubyid_sock'>sock</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_sd'>sd</span> <span class='op'>=</span> <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_fileno'>fileno</span>) <span class='op'>?</span> <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_fileno'>fileno</span> <span class='op'>:</span> <span class='id identifier rubyid_sock'>sock</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_attach_sd'><a href="#attach_sd-class_method" title="EventMachine.attach_sd (method)">attach_sd</a></span>(<span class='id identifier rubyid_sd'>sd</span>)
  <span class='ivar'>@acceptors</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> [<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span><span class='id identifier rubyid_block'>block</span><span class='comma'>,</span><span class='id identifier rubyid_sock'>sock</span>]
  <span class='id identifier rubyid_s'>s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bind_connect-class_method">
  <h3 class='signature '>
    .<strong>bind_connect</strong>(bind_addr, bind_port, server, port = nil, handler = nil, *args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>This method is like <a href="#connect-class_method" title="EventMachine.connect (method)">.connect</a>, but allows for a local address/port
to bind the connection to.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#connect-class_method" title="EventMachine.connect (method)">.connect</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L662-L689'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='662' data-end='689'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 662</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_bind_connect'>bind_connect</span> <span class='id identifier rubyid_bind_addr'>bind_addr</span><span class='comma'>,</span> <span class='id identifier rubyid_bind_port'>bind_port</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_port'>port</span>)
  <span class='kw'>rescue</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='const'>TypeError</span>
    <span class='comment'># there was no port, so server must be a unix domain socket
</span>    <span class='comment'># the port argument is actually the handler, and the handler is one of the args
</span>    <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_unshift'>unshift</span> <span class='id identifier rubyid_handler'>handler</span> <span class='kw'>if</span> <span class='id identifier rubyid_handler'>handler</span>
    <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='id identifier rubyid_port'>port</span>
    <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span>

  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_bind_addr'>bind_addr</span>
          <span class='id identifier rubyid_bind_connect_server'><a href="#bind_connect_server-class_method" title="EventMachine.bind_connect_server (method)">bind_connect_server</a></span> <span class='id identifier rubyid_bind_addr'>bind_addr</span><span class='comma'>,</span> <span class='id identifier rubyid_bind_port'>bind_port</span>.<span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_connect_server'><a href="#connect_server-class_method" title="EventMachine.connect_server (method)">connect_server</a></span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_connect_unix_server'><a href="#connect_unix_server-class_method" title="EventMachine.connect_unix_server (method)">connect_unix_server</a></span> <span class='id identifier rubyid_server'>server</span>
      <span class='kw'>end</span>

  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bind_connect_server-class_method">
  <h3 class='signature private'>
    .<strong>bind_connect_server</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_bind_connect_server</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L725-L740'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='725' data-end='740'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 725</span></pre>
<pre class='code cpp'>

static VALUE t_bind_connect_server (VALUE self UNUSED, VALUE bind_addr, VALUE bind_port, VALUE server, VALUE port)
{
	// Avoid FIX2INT in this case, because it doesn&#39;t deal with type errors properly.
	// Specifically, if the value of port comes in as a string rather than an integer,
	// NUM2INT will throw a type error, but FIX2INT will generate garbage.

	try {
		const uintptr_t f = evma_connect_to_server (StringValueCStr(bind_addr), NUM2INT(bind_port), StringValueCStr(server), NUM2INT(port));
		if (!f)
			rb_raise (EM_eConnectionError, &quot;%s&quot;, &quot;no connection&quot;);
		return BSIG2NUM (f);
	} catch (std::runtime_error e) {
		rb_raise (EM_eConnectionError, &quot;%s&quot;, e.what());
	}
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="Callback-class_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'><strong>Callback</strong>(object, method)  &#x21d2; &lt;#<code>call</code>&gt; </span>
      <span class='overload'><strong>Callback</strong>(object)  &#x21d2; &lt;#<code>call</code>&gt; </span>
      <span class='overload'><strong>Callback</strong>(&amp;block)  &#x21d2; &lt;#<code>call</code>&gt; </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Utility method for coercing arguments to an object that responds to <code>:call</code>.
Accepts an object and a method name to send to, or a block, or an object
that responds to <code>:call</code>.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p><code>EventMachine</code>.Callback used with a block. Returns that block.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='const'>EventMachine</span>.<span class='const'>Callback</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span>(<span class='id identifier rubyid_msg'>msg</span>)
<span class='kw'>end</span>
<span class='comment'># returned object is a callable
</span><span class='id identifier rubyid_cb'>cb</span>.<span class='id identifier rubyid_call'>call</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello world</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
        <p class='example_title'><div class='inline'><p><code>EventMachine</code>.Callback used with an object (to be more specific, class object) and a method name, returns an object that responds to #call</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='const'>EventMachine</span>.<span class='const'>Callback</span>(<span class='const'><a href="Object.html" title="Object (class)">Object</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_puts'>puts</span>)
<span class='comment'># returned object is a callable that delegates to Kernel#puts (in this case Object.puts)
</span><span class='id identifier rubyid_cb'>cb</span>.<span class='id identifier rubyid_call'>call</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello world</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
        <p class='example_title'><div class='inline'><p><code>EventMachine</code>.Callback used with an object that responds to #call. Returns the argument.</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='const'>EventMachine</span>.<span class='const'>Callback</span>(<span class='id identifier rubyid_proc'>proc</span>{ <span class='op'>|</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span>(<span class='id identifier rubyid_msg'>msg</span>) })
<span class='comment'># returned object is a callable
</span><span class='id identifier rubyid_cb'>cb</span>.<span class='id identifier rubyid_call'>call</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hello world</span><span class='tstring_end'>&#39;</span></span>)</code></pre>
  </div>
  <p class='tag_title'>Overloads:</p>
  <ul class='overload'>

      <li class='overload_item'>
        <span class='signature'><strong>Callback</strong>(object, method)  &#x21d2; &lt;#<code>call</code>&gt; </span>
        <div class='docstring'>
  <div class='discussion'>
    <p>Wraps <code>method</code> invocation on <code>object</code> into an object that responds to #call that proxies all the arguments to that method</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>Object</span>
    <span class='type'>(<a href="Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'><p>to invoke method on</p>
</div>
  </li>
  <li>
    <span class='name'>Method</span>
    <span class='type'>(<code>Symbol</code>)</span>
&mdash;    <div class='inline'><p>name</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(&lt;#<code>call</code>&gt;)</span>
&mdash;    <div class='inline'><p>An object that responds to #call that takes any number of arguments and invokes method on object with those arguments</p>
</div>
  </li>
</ul>

</div>

      </li>

      <li class='overload_item'>
        <span class='signature'><strong>Callback</strong>(object)  &#x21d2; &lt;#<code>call</code>&gt; </span>
        <div class='docstring'>
  <div class='discussion'>
    <p>Returns callable object as is, without any coercion</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>An</span>
    <span class='type'>(&lt;#<code>call</code>&gt;)</span>
&mdash;    <div class='inline'><p>object that responds to #call</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(&lt;#<code>call</code>&gt;)</span>
&mdash;    <div class='inline'><p>Its argument</p>
</div>
  </li>
</ul>

</div>

      </li>

      <li class='overload_item'>
        <span class='signature'><strong>Callback</strong>(&amp;block)  &#x21d2; &lt;#<code>call</code>&gt; </span>
        <div class='docstring'>
  <div class='discussion'>
    <p>Returns block passed to it without any coercion</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(&lt;#<code>call</code>&gt;)</span>
&mdash;    <div class='inline'><p>Block passed to this method</p>
</div>
  </li>
</ul>

</div>

      </li>
  </ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>ArgumentError</code>)</span>
&mdash;    <div class='inline'><p>When argument doesn&#39;t respond to #call, method name is missing or when invoked without arguments and block isn&#39;t given</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/callback.rb#L47-L57'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='47' data-end='57'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/callback.rb', line 47</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='const'>Callback</span>(<span class='id identifier rubyid_object'>object</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_object'>object</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_method'>method</span>
    <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span> <span class='id identifier rubyid_object'>object</span>.<span class='id identifier rubyid___send__'>__send__</span> <span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span> }
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_object'>object</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_call'>call</span>
      <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_blk'>blk</span> <span class='op'>||</span> <span class='id identifier rubyid_raise'>raise</span>(<span class='const'>ArgumentError</span>)
    <span class='kw'>end</span> <span class='comment'># if
</span>  <span class='kw'>end</span> <span class='comment'># if
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cancel_timer-class_method">
  <h3 class='signature '>
    .<strong>cancel_timer</strong>(timer_or_sig)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Cancel a timer (can be a callback or an <a href="EventMachine/Timer.html" title="EventMachine::Timer (class)"><code>Timer</code></a> instance).</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>timer_or_sig</span>
    <span class='type'>(#<code>cancel</code>, #<code>call</code>)</span>
&mdash;    <div class='inline'><p>A timer to cancel</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="EventMachine/Timer.html#cancel-instance_method" title="EventMachine::Timer#cancel (method)">Timer#cancel</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L364-L370'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='364' data-end='370'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 364</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_cancel_timer'>cancel_timer</span> <span class='id identifier rubyid_timer_or_sig'>timer_or_sig</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_timer_or_sig'>timer_or_sig</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_cancel'>cancel</span>
    <span class='id identifier rubyid_timer_or_sig'>timer_or_sig</span>.<span class='id identifier rubyid_cancel'>cancel</span>
  <span class='kw'>else</span>
    <span class='ivar'>@timers</span>[<span class='id identifier rubyid_timer_or_sig'>timer_or_sig</span>] <span class='op'>=</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='ivar'>@timers</span>.<span class='id identifier rubyid_has_key?'>has_key?</span>(<span class='id identifier rubyid_timer_or_sig'>timer_or_sig</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cleanup_machine-class_method">
  <h3 class='signature '>
    .<strong>cleanup_machine</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Clean up Ruby space following a release_machine</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L262-L274'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='262' data-end='274'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 262</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_cleanup_machine'>cleanup_machine</span>
  <span class='kw'>if</span> <span class='ivar'>@threadpool</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@threadpool</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'># Tell the threads to stop
</span>    <span class='ivar'>@threadpool</span>.<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_exit'>exit</span> }
    <span class='comment'># Join the threads or bump the stragglers one more time
</span>    <span class='ivar'>@threadpool</span>.<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_join'>join</span> <span class='float'>0.01</span> <span class='op'>||</span> <span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_exit'>exit</span> }
  <span class='kw'>end</span>
  <span class='ivar'>@threadpool</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@threadqueue</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@resultqueue</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@all_threads_spawned</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@next_tick_queue</span> <span class='op'>=</span> []
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close_connection-class_method">
  <h3 class='signature private'>
    .<strong>close_connection</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_close_connection</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L682-L686'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='682' data-end='686'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 682</span></pre>
<pre class='code cpp'>

static VALUE t_close_connection (VALUE self UNUSED, VALUE signature, VALUE after_writing)
{
	evma_close_connection (NUM2BSIG (signature), ((after_writing == Qtrue) ? 1 : 0));
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect-class_method">
  <h3 class='signature '>
    .<strong>connect</strong>(server, port = nil, handler = nil, *args, &amp;blk)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Initiates a TCP connection to a remote server and sets up event handling for the connection.
<code>connect</code> requires event loop to be running (see <a href="#run-class_method" title="EventMachine.run (method)">.run</a>).</p>

<p><code>connect</code> takes the IP address (or hostname) and
port of the remote server you want to connect to.
It also takes an optional handler (a module or a subclass of <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>) which you must define, that
contains the callbacks that will be invoked by the event loop on behalf of the connection.</p>

<p>Learn more about connection lifecycle callbacks in the <a href="file.GettingStarted.html" title="&lt;code&gt;EventMachine&lt;/code&gt; tutorial"><code>EventMachine</code> tutorial</a> and
<a href="file.ConnectionLifecycleCallbacks.html" title="{EventMachine::Connection">{EventMachine::Connection</a> lifecycle guide}.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='comment'># Here&#39;s a program which connects to a web server, sends a naive
</span><span class='comment'># request, parses the HTTP header of the response, and then
</span><span class='comment'># (antisocially) ends the event loop, which automatically drops the connection
</span><span class='comment'># (and incidentally calls the connection&#39;s unbind method).
</span><span class='kw'>module</span> <span class='const'>DumbHttpClient</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'>post_init</span>
    <span class='id identifier rubyid_send_data'><a href="#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.1\r\nHost: _\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@data</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@parsed</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'>receive_data</span> <span class='id identifier rubyid_data'>data</span>
    <span class='ivar'>@data</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_data'>data</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@parsed</span> <span class='kw'>and</span> <span class='ivar'>@data</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\n][\r]*[\n]</span><span class='regexp_end'>/m</span></span>
      <span class='ivar'>@parsed</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RECEIVED HTTP HEADER:</span><span class='tstring_end'>&quot;</span></span>
      <span class='backref'>$`</span>.<span class='id identifier rubyid_each'>each</span> {<span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;&gt;&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line'>line</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }

      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Now we&#39;ll terminate the loop, which will also close the connection</span><span class='tstring_end'>&quot;</span></span>
      <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_stop_event_loop'><a href="#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">stop_event_loop</a></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A connection has terminated</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_connect'>connect</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.bayshorenetworks.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='const'>DumbHttpClient</span>
}
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The event loop has ended</span><span class='tstring_end'>&quot;</span></span></code></pre>
        <p class='example_title'><div class='inline'><p>Defining protocol handler as a class</p>
</div></p>
      <pre class='example code ruby'><code><span class='kw'>class</span> <span class='const'>MyProtocolHandler</span> <span class='op'>&lt;</span> <span class='const'>EventMachine</span><span class='op'>::</span><span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
    <span class='kw'>super</span>
    <span class='comment'># whatever else you want to do here
</span>  <span class='kw'>end</span>

  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>server</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Host to connect to</p>
</div>
  </li>
  <li>
    <span class='name'>port</span>
    <span class='type'>(<code>Integer</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>Port to connect to</p>
</div>
  </li>
  <li>
    <span class='name'>handler</span>
    <span class='type'>(<code>Module</code>, <code>Class</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>A module or class that implements connection lifecycle callbacks</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a></li>
          <li><a href="file.GettingStarted.html" title="EventMachine tutorial">EventMachine tutorial</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L632-L656'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='632' data-end='656'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 632</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_connect'>connect</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
  <span class='comment'># EventMachine::connect initiates a TCP connection to a remote
</span>  <span class='comment'># server and sets up event-handling for the connection.
</span>  <span class='comment'># It internally creates an object that should not be handled
</span>  <span class='comment'># by the caller. HOWEVER, it&#39;s often convenient to get the
</span>  <span class='comment'># object to set up interfacing to other objects in the system.
</span>  <span class='comment'># We return the newly-created anonymous-class object to the caller.
</span>  <span class='comment'># It&#39;s expected that a considerable amount of code will depend
</span>  <span class='comment'># on this behavior, so don&#39;t change it.
</span>  <span class='comment'>#
</span>  <span class='comment'># Ok, added support for a user-defined block, 13Apr06.
</span>  <span class='comment'># This leads us to an interesting choice because of the
</span>  <span class='comment'># presence of the post_init call, which happens in the
</span>  <span class='comment'># initialize method of the new object. We call the user&#39;s
</span>  <span class='comment'># block and pass the new object to it. This is a great
</span>  <span class='comment'># way to do protocol-specific initiation. It happens
</span>  <span class='comment'># AFTER post_init has been called on the object, which I
</span>  <span class='comment'># certainly hope is the right choice.
</span>  <span class='comment'># Don&#39;t change this lightly, because accepted connections
</span>  <span class='comment'># are different from connected ones and we don&#39;t want
</span>  <span class='comment'># to have them behave differently with respect to post_init
</span>  <span class='comment'># if at all possible.
</span>
  <span class='id identifier rubyid_bind_connect'><a href="#bind_connect-class_method" title="EventMachine.bind_connect (method)">bind_connect</a></span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_server-class_method">
  <h3 class='signature private'>
    .<strong>connect_server</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_connect_server</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L704-L719'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='704' data-end='719'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 704</span></pre>
<pre class='code cpp'>

static VALUE t_connect_server (VALUE self UNUSED, VALUE server, VALUE port)
{
	// Avoid FIX2INT in this case, because it doesn&#39;t deal with type errors properly.
	// Specifically, if the value of port comes in as a string rather than an integer,
	// NUM2INT will throw a type error, but FIX2INT will generate garbage.

	try {
		const uintptr_t f = evma_connect_to_server (NULL, 0, StringValueCStr(server), NUM2INT(port));
		if (!f)
			rb_raise (EM_eConnectionError, &quot;%s&quot;, &quot;no connection&quot;);
		return BSIG2NUM (f);
	} catch (std::runtime_error e) {
		rb_raise (EM_eConnectionError, &quot;%s&quot;, e.what());
	}
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_unix_domain-class_method">
  <h3 class='signature '>
    .<strong>connect_unix_domain</strong>(socketname, *args, &amp;blk)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>UNIX sockets, as the name suggests, are not available on Microsoft Windows.</p>
</div>
  </div>

<p>Make a connection to a Unix-domain socket. This method is simply an alias for <a href="#connect-class_method" title="EventMachine.connect (method)">.connect</a>,
which can connect to both TCP and Unix-domain sockets. Make sure that your process has sufficient
permissions to open the socket it is given.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>socketname</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Unix domain socket (local fully-qualified path) you want to connect to.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L814-L816'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='814' data-end='816'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 814</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_connect_unix_domain'>connect_unix_domain</span> <span class='id identifier rubyid_socketname'>socketname</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
  <span class='id identifier rubyid_connect'><a href="#connect-class_method" title="EventMachine.connect (method)">connect</a></span> <span class='id identifier rubyid_socketname'>socketname</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_unix_server-class_method">
  <h3 class='signature private'>
    .<strong>connect_unix_server</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_connect_unix_server</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L746-L752'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='746' data-end='752'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 746</span></pre>
<pre class='code cpp'>

static VALUE t_connect_unix_server (VALUE self UNUSED, VALUE serversocket)
{
	const uintptr_t f = evma_connect_to_unix_server (StringValueCStr(serversocket));
	if (!f)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;no connection&quot;);
	return BSIG2NUM (f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connection_count-class_method">
  <h3 class='signature '>
    .<strong>connection_count</strong>  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Returns the total number of connections (file descriptors) currently held by the reactor.
Note that a tick must pass after the &#39;initiation&#39; of a connection for this number to increment.
It&#39;s usually accurate, but don&#39;t rely on the exact precision of this number unless you really know <a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a> internals.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_connect'><a href="#connect-class_method" title="EventMachine.connect (method)">connect</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rubyeventmachine.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>)
  <span class='comment'># count will be 0 in this case, because connection is not
</span>  <span class='comment'># established yet
</span>  <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='const'>EventMachine</span>.<span class='id identifier rubyid_connection_count'>connection_count</span>
}</code></pre>
      <pre class='example code ruby'><code><span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_connect'><a href="#connect-class_method" title="EventMachine.connect (method)">connect</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rubyeventmachine.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span>)

  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_next_tick'><a href="#next_tick-class_method" title="EventMachine.next_tick (method)">next_tick</a></span> {
    <span class='comment'># In this example, count will be 1 since the connection has been established in
</span>    <span class='comment'># the next loop of the reactor.
</span>    <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='const'>EventMachine</span>.<span class='id identifier rubyid_connection_count'>connection_count</span>
  }
}</code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Number of connections currently held by the reactor.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L956-L958'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='956' data-end='958'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 956</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_connection_count'>connection_count</span>
  <span class='kw'>self</span>.<span class='id identifier rubyid_get_connection_count'><a href="#get_connection_count-class_method" title="EventMachine.get_connection_count (method)">get_connection_count</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="current_time-class_method">
  <h3 class='signature private'>
    .<strong>current_time</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_loop_time</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1352-L1365'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1352' data-end='1365'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1352</span></pre>
<pre class='code cpp'>

static VALUE t_get_loop_time (VALUE self UNUSED)
{
	uint64_t current_time = evma_get_current_loop_time();
	if (current_time == 0) {
		return Qnil;
	}

	// Generally the industry has moved to 64-bit time_t, this is just in case we&#39;re 32-bit time_t.
	if (sizeof(time_t) &lt; 8 &amp;&amp; current_time &gt; INT_MAX) {
		return rb_funcall(rb_cTime, Intern_at, 2, INT2NUM(current_time / 1000000), INT2NUM(current_time % 1000000));
	} else {
		return rb_time_new(current_time / 1000000, current_time % 1000000);
	}
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="defer-class_method">
  <h3 class='signature '>
    .<strong>defer</strong>(op = nil, callback = nil, errback = nil, &amp;blk)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p><code>EventMachine</code>.defer is used for integrating blocking operations into EventMachine&#39;s control flow.
The action of <code>.defer</code> is to take the block specified in the first parameter (the &quot;operation&quot;)
and schedule it for asynchronous execution on an internal thread pool maintained by <code>EventMachine</code>.
When the operation completes, it will pass the result computed by the block (if any) back to the
<code>EventMachine</code> reactor. Then, <code>EventMachine</code> calls the block specified in the second parameter to
<code>.defer</code> (the &quot;callback&quot;), as part of its normal event handling loop. The result computed by the
operation block is passed as a parameter to the callback. You may omit the callback parameter if
you don&#39;t need to execute any code after the operation completes. If the operation raises an
unhandled exception, the exception will be passed to the third parameter to <code>.defer</code> (the
&quot;errback&quot;), as part of its normal event handling loop. If no errback is provided, the exception
will be allowed to blow through to the main thread immediately.</p>

<h4>Caveats</h4>

<p>Note carefully that the code in your deferred operation will be executed on a separate
thread from the main <code>EventMachine</code> processing and all other Ruby threads that may exist in
your program. Also, multiple deferred operations may be running at once! Therefore, you
are responsible for ensuring that your operation code is threadsafe.</p>

<p>Don&#39;t write a deferred operation that will block forever. If so, the current implementation will
not detect the problem, and the thread will never be returned to the pool. <code>EventMachine</code> limits
the number of threads in its pool, so if you do this enough times, your subsequent deferred
operations won&#39;t get a chance to run.</p>

<p>The threads within the EventMachine&#39;s thread pool have abort_on_exception set to true. As a result,
if an unhandled exception is raised by the deferred operation and an errback is not provided, it
will blow through to the main thread immediately. If the main thread is within an indiscriminate
rescue block at that time, the exception could be handled improperly by the main thread.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_operation'>operation</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
  <span class='comment'># perform a long-running operation here, such as a database query.
</span>  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>result</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># as usual, the last expression evaluated in the block will be the return value.
</span>}
<span class='id identifier rubyid_callback'>callback</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='op'>|</span>
  <span class='comment'># do something with result here, such as send it back to a network client.
</span>}
<span class='id identifier rubyid_errback'>errback</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_error'>error</span><span class='op'>|</span>
  <span class='comment'># do something with error here, such as re-raising or logging.
</span>}

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_defer'>defer</span>(<span class='id identifier rubyid_operation'>operation</span><span class='comma'>,</span> <span class='id identifier rubyid_callback'>callback</span><span class='comma'>,</span> <span class='id identifier rubyid_errback'>errback</span>)</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>op</span>
    <span class='type'>(#<code>call</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>An operation you want to offload to <code>EventMachine</code> thread pool</p>
</div>
  </li>
  <li>
    <span class='name'>callback</span>
    <span class='type'>(#<code>call</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>A callback that will be run on the event loop thread after <code>operation</code> finishes.</p>
</div>
  </li>
  <li>
    <span class='name'>errback</span>
    <span class='type'>(#<code>call</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>An errback that will be run on the event loop thread after <code>operation</code> raises an exception.</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#threadpool_size-class_method" title="EventMachine.threadpool_size (method)">.threadpool_size</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1044-L1062'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1044' data-end='1062'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1044</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_defer'>defer</span> <span class='id identifier rubyid_op'>op</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_callback'>callback</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_errback'>errback</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
  <span class='comment'># OBSERVE that #next_tick hacks into this mechanism, so don&#39;t make any changes here
</span>  <span class='comment'># without syncing there.
</span>  <span class='comment'>#
</span>  <span class='comment'># Running with $VERBOSE set to true gives a warning unless all ivars are defined when
</span>  <span class='comment'># they appear in rvalues. But we DON&#39;T ever want to initialize @threadqueue unless we
</span>  <span class='comment'># need it, because the Ruby threads are so heavyweight. We end up with this bizarre
</span>  <span class='comment'># way of initializing @threadqueue because EventMachine is a Module, not a Class, and
</span>  <span class='comment'># has no constructor.
</span>
  <span class='kw'>unless</span> <span class='ivar'>@threadpool</span>
    <span class='ivar'>@threadpool</span> <span class='op'>=</span> []
    <span class='ivar'>@threadqueue</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'><a href="EventMachine/Queue.html" title="EventMachine::Queue (class)">Queue</a></span>.<span class='id identifier rubyid_new'>new</span>
    <span class='ivar'>@resultqueue</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'><a href="EventMachine/Queue.html" title="EventMachine::Queue (class)">Queue</a></span>.<span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_spawn_threadpool'><a href="#spawn_threadpool-class_method" title="EventMachine.spawn_threadpool (method)">spawn_threadpool</a></span>
  <span class='kw'>end</span>

  <span class='ivar'>@threadqueue</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_op'>op</span><span class='op'>||</span><span class='id identifier rubyid_blk'>blk</span><span class='comma'>,</span><span class='id identifier rubyid_callback'>callback</span><span class='comma'>,</span><span class='id identifier rubyid_errback'>errback</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disable_proxy-class_method">
  <h3 class='signature '>
    .<strong>disable_proxy</strong>(from)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Takes just one argument, a <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> that has proxying enabled via <a href="#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">.enable_proxy</a>.
Calling this method will remove that functionality and your connection will begin receiving
data via <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a> again.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>from</span>
    <span class='type'>(<a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">EventMachine::Connection</a>)</span>
&mdash;    <div class='inline'><p>Source of data that is being proxied</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">.enable_proxy</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1441-L1443'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1441' data-end='1443'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1441</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_disable_proxy'>disable_proxy</span>(<span class='id identifier rubyid_from'>from</span>)
  <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='id identifier rubyid_stop_proxy'>stop_proxy</span>(<span class='id identifier rubyid_from'>from</span>.<span class='id identifier rubyid_signature'>signature</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enable_proxy-class_method">
  <h3 class='signature '>
    .<strong>enable_proxy</strong>(from, to, bufsize = 0, length = 0)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>This method allows for direct writing of incoming data back out to another descriptor, at the C++ level in the reactor.
This is very efficient and especially useful for proxies where high performance is required. Propogating data from a server response
all the way up to Ruby, and then back down to the reactor to be sent back to the client, is often unnecessary and
incurs a significant performance decrease.</p>

<p>The two arguments are instance of <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> subclasses, &#39;from&#39; and &#39;to&#39;. &#39;from&#39; is the connection whose inbound data you want
relayed back out. &#39;to&#39; is the connection to write it to.</p>

<p>Once you call this method, the &#39;from&#39; connection will no longer get receive_data callbacks from the reactor,
except in the case that &#39;to&#39; connection has already closed when attempting to write to it. You can see
in the example, that proxy_target_unbound will be called when this occurs. After that, further incoming
data will be passed into receive_data as normal.</p>

<p>Note also that this feature supports different types of descriptors: TCP, UDP, and pipes. You can relay
data from one kind to another, for example, feed a pipe from a UDP stream.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='kw'>module</span> <span class='const'>ProxyConnection</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span>)
    <span class='ivar'>@client</span><span class='comma'>,</span> <span class='ivar'>@request</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'>post_init</span>
    <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='id identifier rubyid_enable_proxy'>enable_proxy</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@client</span>)
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_connection_completed'>connection_completed</span>
    <span class='id identifier rubyid_send_data'><a href="#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='ivar'>@request</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_proxy_target_unbound'>proxy_target_unbound</span>
    <span class='id identifier rubyid_close_connection'><a href="#close_connection-class_method" title="EventMachine.close_connection (method)">close_connection</a></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
    <span class='ivar'>@client</span>.<span class='id identifier rubyid_close_connection_after_writing'>close_connection_after_writing</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='kw'>module</span> <span class='const'>ProxyServer</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'>receive_data</span>(<span class='id identifier rubyid_data'>data</span>)
    (<span class='ivar'>@buf</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_data'>data</span>
    <span class='kw'>if</span> <span class='ivar'>@buf</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\r\n\r\n</span><span class='regexp_end'>/</span></span> <span class='comment'># all http headers received
</span>      <span class='const'>EventMachine</span>.<span class='id identifier rubyid_connect'><a href="#connect-class_method" title="EventMachine.connect (method)">connect</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>10.0.0.15</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='const'>ProxyConnection</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_start_server'><a href="#start_server-class_method" title="EventMachine.start_server (method)">start_server</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>8080</span><span class='comma'>,</span> <span class='const'>ProxyServer</span>)
}</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>from</span>
    <span class='type'>(<a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">EventMachine::Connection</a>)</span>
&mdash;    <div class='inline'><p>Source of data to be proxies/streamed.</p>
</div>
  </li>
  <li>
    <span class='name'>to</span>
    <span class='type'>(<a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">EventMachine::Connection</a>)</span>
&mdash;    <div class='inline'><p>Destination of data to be proxies/streamed.</p>
</div>
  </li>
  <li>
    <span class='name'>bufsize</span>
    <span class='type'>(<code>Integer</code>)</span>
    <em class='default'>(defaults to: <tt>0</tt>)</em>
&mdash;    <div class='inline'><p>Buffer size to use</p>
</div>
  </li>
  <li>
    <span class='name'>length</span>
    <span class='type'>(<code>Integer</code>)</span>
    <em class='default'>(defaults to: <tt>0</tt>)</em>
&mdash;    <div class='inline'><p>Maximum number of bytes to proxy.</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#disable_proxy-class_method" title="EventMachine.disable_proxy (method)">.disable_proxy</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1431-L1433'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1431' data-end='1433'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1431</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_enable_proxy'>enable_proxy</span>(<span class='id identifier rubyid_from'>from</span><span class='comma'>,</span> <span class='id identifier rubyid_to'>to</span><span class='comma'>,</span> <span class='id identifier rubyid_bufsize'>bufsize</span><span class='op'>=</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='op'>=</span><span class='int'>0</span>)
  <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='id identifier rubyid_start_proxy'>start_proxy</span>(<span class='id identifier rubyid_from'>from</span>.<span class='id identifier rubyid_signature'>signature</span><span class='comma'>,</span> <span class='id identifier rubyid_to'>to</span>.<span class='id identifier rubyid_signature'>signature</span><span class='comma'>,</span> <span class='id identifier rubyid_bufsize'>bufsize</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="epoll=-class_method">
  <h3 class='signature ro  private'>
    .<strong>epoll=</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t__epoll_set</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1172-L1179'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1172' data-end='1179'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1172</span></pre>
<pre class='code cpp'>

static VALUE t__epoll_set (VALUE self, VALUE val)
{
	if (t__epoll_p(self) == Qfalse &amp;&amp; val == Qtrue)
		rb_raise (EM_eUnsupported, &quot;%s&quot;, &quot;epoll is not supported on this platform&quot;);

	evma_set_epoll (val == Qtrue ? 1 : 0);
	return val;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="error_handler-class_method">
  <h3 class='signature '>
    .<strong>error_handler</strong>(cb = nil, &amp;blk)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Catch-all for errors raised during event loop callbacks.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='const'>EventMachine</span>.<span class='id identifier rubyid_error_handler'>error_handler</span>{ <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error raised during event loop: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span>.<span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
}</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>cb</span>
    <span class='type'>(#<code>call</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>Global catch-all errback</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1364-L1370'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1364' data-end='1370'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1364</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_error_handler'>error_handler</span> <span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_cb'>cb</span> <span class='kw'>or</span> <span class='id identifier rubyid_blk'>blk</span>
    <span class='ivar'>@error_handler</span> <span class='op'>=</span> <span class='id identifier rubyid_cb'>cb</span> <span class='op'>||</span> <span class='id identifier rubyid_blk'>blk</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span> <span class='symbeg'>:</span><span class='ivar'>@error_handler</span>
    <span class='id identifier rubyid_remove_instance_variable'>remove_instance_variable</span> <span class='symbeg'>:</span><span class='ivar'>@error_handler</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="event_callback-class_method">
  <h3 class='signature nodoc'>
    .<strong>event_callback</strong>(conn_binding, opcode, data)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1464-L1560'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1464' data-end='1560'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1464</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_event_callback'>event_callback</span> <span class='id identifier rubyid_conn_binding'>conn_binding</span><span class='comma'>,</span> <span class='id identifier rubyid_opcode'>opcode</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span>
  <span class='comment'>#
</span>  <span class='comment'># Changed 27Dec07: Eliminated the hookable error handling.
</span>  <span class='comment'># No one was using it, and it degraded performance significantly.
</span>  <span class='comment'># It&#39;s in original_event_callback, which is dead code.
</span>  <span class='comment'>#
</span>  <span class='comment'># Changed 25Jul08: Added a partial solution to the problem of exceptions
</span>  <span class='comment'># raised in user-written event-handlers. If such exceptions are not caught,
</span>  <span class='comment'># we must cause the reactor to stop, and then re-raise the exception.
</span>  <span class='comment'># Otherwise, the reactor doesn&#39;t stop and it&#39;s left on the call stack.
</span>  <span class='comment'># This is partial because we only added it to #unbind, where it&#39;s critical
</span>  <span class='comment'># (to keep unbind handlers from being re-entered when a stopping reactor
</span>  <span class='comment'># runs down open connections). It should go on the other calls to user
</span>  <span class='comment'># code, but the performance impact may be too large.
</span>  <span class='comment'>#
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#ConnectionUnbound-constant" title="EventMachine::ConnectionUnbound (constant)">ConnectionUnbound</a></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@conns</span>.<span class='id identifier rubyid_delete'>delete</span>( <span class='id identifier rubyid_conn_binding'>conn_binding</span> )
      <span class='kw'>begin</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_original_method'>original_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_unbind'>unbind</span>).<span class='id identifier rubyid_arity'>arity</span> <span class='op'>!=</span> <span class='int'>0</span>
          <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_unbind'>unbind</span>(<span class='id identifier rubyid_data'>data</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='const'>EventMachine</span><span class='op'>::</span><span class='const'><a href="#ERRNOS-constant" title="EventMachine::ERRNOS (constant)">ERRNOS</a></span>[<span class='id identifier rubyid_data'>data</span>])
        <span class='kw'>else</span>
          <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_unbind'>unbind</span>
        <span class='kw'>end</span>
        <span class='comment'># If this is an attached (but not watched) connection, close the underlying io object.
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span>(<span class='symbeg'>:</span><span class='ivar'>@io</span>) <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span>(<span class='symbeg'>:</span><span class='ivar'>@watch_mode</span>)
          <span class='id identifier rubyid_io'>io</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span>(<span class='symbeg'>:</span><span class='ivar'>@io</span>)
          <span class='kw'>begin</span>
            <span class='id identifier rubyid_io'>io</span>.<span class='id identifier rubyid_close'>close</span>
          <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EBADF</span><span class='comma'>,</span> <span class='const'>IOError</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='comment'># As noted above, unbind absolutely must not raise an exception or the reactor will crash.
</span>      <span class='comment'># If there is no EM.error_handler, or if the error_handler retrows, then stop the reactor,
</span>      <span class='comment'># stash the exception in $wrapped_exception, and the exception will be raised after the
</span>      <span class='comment'># reactor is cleaned up (see the last line of self.run).
</span>      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span> <span class='symbeg'>:</span><span class='ivar'>@error_handler</span>
          <span class='kw'>begin</span>
            <span class='ivar'>@error_handler</span>.<span class='id identifier rubyid_call'>call</span> <span class='id identifier rubyid_error'>error</span>
            <span class='comment'># No need to stop unless error_handler rethrows
</span>          <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
            <span class='ivar'>@wrapped_exception</span> <span class='op'>=</span> <span class='id identifier rubyid_error'>error</span>
            <span class='id identifier rubyid_stop'><a href="#stop-class_method" title="EventMachine.stop (method)">stop</a></span>
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='ivar'>@wrapped_exception</span> <span class='op'>=</span> <span class='id identifier rubyid_error'>error</span>
          <span class='id identifier rubyid_stop'><a href="#stop-class_method" title="EventMachine.stop (method)">stop</a></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@acceptors</span>.<span class='id identifier rubyid_delete'>delete</span>( <span class='id identifier rubyid_conn_binding'>conn_binding</span> )
      <span class='comment'># no-op
</span>    <span class='kw'>else</span>
      <span class='kw'>if</span> <span class='gvar'>$!</span> <span class='comment'># Bubble user generated errors.
</span>        <span class='ivar'>@wrapped_exception</span> <span class='op'>=</span> <span class='gvar'>$!</span>
        <span class='id identifier rubyid_stop'><a href="#stop-class_method" title="EventMachine.stop (method)">stop</a></span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)">ConnectionNotBound</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>received ConnectionUnbound for an unknown signature: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_conn_binding'>conn_binding</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#ConnectionAccepted-constant" title="EventMachine::ConnectionAccepted (constant)">ConnectionAccepted</a></span>
    <span class='id identifier rubyid_accep'>accep</span><span class='comma'>,</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span><span class='id identifier rubyid_blk'>blk</span> <span class='op'>=</span> <span class='ivar'>@acceptors</span>[<span class='id identifier rubyid_conn_binding'>conn_binding</span>]
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NoHandlerForAcceptedConnection</span> <span class='kw'>unless</span> <span class='id identifier rubyid_accep'>accep</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_accep'>accep</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
    <span class='ivar'>@conns</span>[<span class='id identifier rubyid_data'>data</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
    <span class='id identifier rubyid_blk'>blk</span> <span class='kw'>and</span> <span class='id identifier rubyid_blk'>blk</span>.<span class='id identifier rubyid_call'>call</span>(<span class='id identifier rubyid_c'>c</span>)
    <span class='id identifier rubyid_c'>c</span> <span class='comment'># (needed?)
</span>    <span class='comment'>##
</span>    <span class='comment'># The remaining code is a fallback for the pure ruby and java reactors.
</span>    <span class='comment'># In the C++ reactor, these events are handled in the C event_callback() in rubymain.cpp
</span>  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#ConnectionCompleted-constant" title="EventMachine::ConnectionCompleted (constant)">ConnectionCompleted</a></span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@conns</span>[<span class='id identifier rubyid_conn_binding'>conn_binding</span>] <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)">ConnectionNotBound</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>received ConnectionCompleted for unknown signature: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_conn_binding'>conn_binding</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_connection_completed'>connection_completed</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#SslHandshakeCompleted-constant" title="EventMachine::SslHandshakeCompleted (constant)">SslHandshakeCompleted</a></span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@conns</span>[<span class='id identifier rubyid_conn_binding'>conn_binding</span>] <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)">ConnectionNotBound</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>received SslHandshakeCompleted for unknown signature: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_conn_binding'>conn_binding</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_ssl_handshake_completed'>ssl_handshake_completed</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#SslVerify-constant" title="EventMachine::SslVerify (constant)">SslVerify</a></span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@conns</span>[<span class='id identifier rubyid_conn_binding'>conn_binding</span>] <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)">ConnectionNotBound</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>received SslVerify for unknown signature: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_conn_binding'>conn_binding</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_ssl_verify_peer'>ssl_verify_peer</span>(<span class='id identifier rubyid_data'>data</span>) <span class='kw'>or</span> <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_close_connection'><a href="#close_connection-class_method" title="EventMachine.close_connection (method)">close_connection</a></span>
    <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#TimerFired-constant" title="EventMachine::TimerFired (constant)">TimerFired</a></span>
    <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='ivar'>@timers</span>.<span class='id identifier rubyid_delete'>delete</span>( <span class='id identifier rubyid_data'>data</span> )
    <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_t'>t</span> <span class='op'>==</span> <span class='kw'>false</span> <span class='comment'># timer cancelled
</span>    <span class='id identifier rubyid_t'>t</span> <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/UnknownTimerFired.html" title="EventMachine::UnknownTimerFired (class)">UnknownTimerFired</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timer data: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_t'>t</span>.<span class='id identifier rubyid_call'>call</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#ConnectionData-constant" title="EventMachine::ConnectionData (constant)">ConnectionData</a></span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@conns</span>[<span class='id identifier rubyid_conn_binding'>conn_binding</span>] <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)">ConnectionNotBound</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>received data </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='embexpr_end'>}</span><span class='tstring_content'> for unknown signature: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_conn_binding'>conn_binding</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_receive_data'>receive_data</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#LoopbreakSignalled-constant" title="EventMachine::LoopbreakSignalled (constant)">LoopbreakSignalled</a></span>
    <span class='id identifier rubyid_run_deferred_callbacks'><a href="#run_deferred_callbacks-class_method" title="EventMachine.run_deferred_callbacks (method)">run_deferred_callbacks</a></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#ConnectionNotifyReadable-constant" title="EventMachine::ConnectionNotifyReadable (constant)">ConnectionNotifyReadable</a></span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@conns</span>[<span class='id identifier rubyid_conn_binding'>conn_binding</span>] <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)">ConnectionNotBound</a></span>
    <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_notify_readable'>notify_readable</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opcode'>opcode</span> <span class='op'>==</span> <span class='const'><a href="#ConnectionNotifyWritable-constant" title="EventMachine::ConnectionNotifyWritable (constant)">ConnectionNotifyWritable</a></span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='ivar'>@conns</span>[<span class='id identifier rubyid_conn_binding'>conn_binding</span>] <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="EventMachine/ConnectionNotBound.html" title="EventMachine::ConnectionNotBound (class)">ConnectionNotBound</a></span>
    <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_notify_writable'>notify_writable</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fork_reactor-class_method">
  <h3 class='signature '>
    .<strong>fork_reactor</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Forks a new process, properly stops the reactor and then calls <a href="#run-class_method" title="EventMachine.run (method)">.run</a> inside of it again, passing your block.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L244-L259'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='244' data-end='259'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 244</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_fork_reactor'>fork_reactor</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='comment'># This implementation is subject to change, especially if we clean up the relationship
</span>  <span class='comment'># of EM#run to @reactor_running.
</span>  <span class='comment'># Original patch by Aman Gupta.
</span>  <span class='comment'>#
</span>  <span class='const'>Kernel</span>.<span class='id identifier rubyid_fork'>fork</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_reactor_running?'><a href="#reactor_running%3F-class_method" title="EventMachine.reactor_running? (method)">reactor_running?</a></span>
      <span class='id identifier rubyid_stop_event_loop'><a href="#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">stop_event_loop</a></span>
      <span class='id identifier rubyid_release_machine'><a href="#release_machine-class_method" title="EventMachine.release_machine (method)">release_machine</a></span>
      <span class='id identifier rubyid_cleanup_machine'><a href="#cleanup_machine-class_method" title="EventMachine.cleanup_machine (method)">cleanup_machine</a></span>
      <span class='ivar'>@reactor_running</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='ivar'>@reactor_thread</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> <span class='id identifier rubyid_block'>block</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_cipher_bits-class_method">
  <h3 class='signature private'>
    .<strong>get_cipher_bits</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L434-L437'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='434' data-end='437'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 434</span></pre>
<pre class='code cpp'>

static VALUE t_get_cipher_bits (VALUE self UNUSED, VALUE signature UNUSED)
{
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_cipher_name-class_method">
  <h3 class='signature private'>
    .<strong>get_cipher_name</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L454-L457'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='454' data-end='457'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 454</span></pre>
<pre class='code cpp'>

static VALUE t_get_cipher_name (VALUE self UNUSED, VALUE signature UNUSED)
{
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_cipher_protocol-class_method">
  <h3 class='signature private'>
    .<strong>get_cipher_protocol</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L474-L477'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='474' data-end='477'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 474</span></pre>
<pre class='code cpp'>

static VALUE t_get_cipher_protocol (VALUE self UNUSED, VALUE signature UNUSED)
{
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_comm_inactivity_timeout-class_method">
  <h3 class='signature private'>
    .<strong>get_comm_inactivity_timeout</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_comm_inactivity_timeout</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L625-L628'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='625' data-end='628'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 625</span></pre>
<pre class='code cpp'>

static VALUE t_get_comm_inactivity_timeout (VALUE self UNUSED, VALUE signature)
{
	return rb_float_new(evma_get_comm_inactivity_timeout(NUM2BSIG (signature)));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_connection_count-class_method">
  <h3 class='signature private'>
    .<strong>get_connection_count</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_connection_count</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L616-L619'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='616' data-end='619'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 616</span></pre>
<pre class='code cpp'>

static VALUE t_get_connection_count (VALUE self UNUSED)
{
	return INT2NUM(evma_get_connection_count());
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_heartbeat_interval-class_method">
  <h3 class='signature private'>
    .<strong>get_heartbeat_interval</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_heartbeat_interval</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1440-L1443'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1440' data-end='1443'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1440</span></pre>
<pre class='code cpp'>

static VALUE t_get_heartbeat_interval (VALUE self UNUSED)
{
	return rb_float_new(evma_get_heartbeat_interval());
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_idle_time-class_method">
  <h3 class='signature private'>
    .<strong>get_idle_time</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_idle_time</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1415-L1434'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1415' data-end='1434'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1415</span></pre>
<pre class='code cpp'>

static VALUE t_get_idle_time (VALUE self UNUSED, VALUE from)
{
	try{
		uint64_t current_time = evma_get_current_loop_time();
		uint64_t time = evma_get_last_activity_time(NUM2BSIG (from));
		if (current_time != 0 &amp;&amp; time != 0) {
			if (time &gt;= current_time)
				return BSIG2NUM(0);
			else {
				uint64_t diff = current_time - time;
				float seconds = diff / (1000.0*1000.0);
				return rb_float_new(seconds);
			}
			return Qnil;
		}
	} catch (std::runtime_error e) {
		rb_raise (EM_eConnectionError, &quot;%s&quot;, e.what());
	}
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_max_timer_count-class_method">
  <h3 class='signature private'>
    .<strong>get_max_timer_count</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_max_timer_count</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L982-L985'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='982' data-end='985'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 982</span></pre>
<pre class='code cpp'>

static VALUE t_get_max_timer_count (VALUE self UNUSED)
{
	return INT2FIX (evma_get_max_timer_count());
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_max_timers-class_method">
  <h3 class='signature '>
    .<strong>get_max_timers</strong>  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Gets the current maximum number of allowed timers</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Maximum number of timers that may be outstanding at any given time</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L925-L927'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='925' data-end='927'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 925</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_get_max_timers'>get_max_timers</span>
  <span class='id identifier rubyid_get_max_timer_count'><a href="#get_max_timer_count-class_method" title="EventMachine.get_max_timer_count (method)">get_max_timer_count</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_peer_cert-class_method">
  <h3 class='signature private'>
    .<strong>get_peer_cert</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L415-L418'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='415' data-end='418'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 415</span></pre>
<pre class='code cpp'>

static VALUE t_get_peer_cert (VALUE self UNUSED, VALUE signature UNUSED)
{
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_peername-class_method">
  <h3 class='signature private'>
    .<strong>get_peername</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_peername</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L504-L517'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='504' data-end='517'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 504</span></pre>
<pre class='code cpp'>

static VALUE t_get_peername (VALUE self UNUSED, VALUE signature)
{
	char buf[1024];
	socklen_t len = sizeof buf;
	try {
		if (evma_get_peername (NUM2BSIG (signature), (struct sockaddr*)buf, &amp;len)) {
			return rb_str_new (buf, len);
		}
	} catch (std::runtime_error e) {
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, e.what());
	}

	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_pending_connect_timeout-class_method">
  <h3 class='signature private'>
    .<strong>get_pending_connect_timeout</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_pending_connect_timeout</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L647-L650'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='647' data-end='650'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 647</span></pre>
<pre class='code cpp'>

static VALUE t_get_pending_connect_timeout (VALUE self UNUSED, VALUE signature)
{
	return rb_float_new(evma_get_pending_connect_timeout(NUM2BSIG (signature)));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_simultaneous_accept_count-class_method">
  <h3 class='signature private'>
    .<strong>get_simultaneous_accept_count</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get/set_simultaneous_accept_count</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1001-L1004'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1001' data-end='1004'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1001</span></pre>
<pre class='code cpp'>

static VALUE t_get_simultaneous_accept_count (VALUE self UNUSED)
{
	return INT2FIX (evma_get_simultaneous_accept_count());
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_sni_hostname-class_method">
  <h3 class='signature private'>
    .<strong>get_sni_hostname</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L494-L497'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='494' data-end='497'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 494</span></pre>
<pre class='code cpp'>

static VALUE t_get_sni_hostname (VALUE self UNUSED, VALUE signature UNUSED)
{
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_sockname-class_method">
  <h3 class='signature private'>
    .<strong>get_sockname</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_sockname</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L523-L536'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='523' data-end='536'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 523</span></pre>
<pre class='code cpp'>

static VALUE t_get_sockname (VALUE self UNUSED, VALUE signature)
{
	char buf[1024];
	socklen_t len = sizeof buf;
	try {
		if (evma_get_sockname (NUM2BSIG (signature), (struct sockaddr*)buf, &amp;len)) {
			return rb_str_new (buf, len);
		}
	} catch (std::runtime_error e) {
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, e.what());
	}

	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_subprocess_pid-class_method">
  <h3 class='signature private'>
    .<strong>get_subprocess_pid</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_subprocess_pid</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L542-L550'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='542' data-end='550'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 542</span></pre>
<pre class='code cpp'>

static VALUE t_get_subprocess_pid (VALUE self UNUSED, VALUE signature)
{
	pid_t pid;
	if (evma_get_subprocess_pid (NUM2BSIG (signature), &amp;pid)) {
		return INT2NUM (pid);
	}

	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_subprocess_status-class_method">
  <h3 class='signature private'>
    .<strong>get_subprocess_status</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_subprocess_status</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L556-L610'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='556' data-end='610'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 556</span></pre>
<pre class='code cpp'>

static VALUE t_get_subprocess_status (VALUE self UNUSED, VALUE signature)
{
	VALUE proc_status = Qnil;

	int status;
	pid_t pid;

	if (evma_get_subprocess_status (NUM2BSIG (signature), &amp;status)) {
		if (evma_get_subprocess_pid (NUM2BSIG (signature), &amp;pid)) {

#if defined(IS_RUBY_3_3_OR_LATER)
			proc_status = rb_obj_alloc(rb_cProcessStatus);
			struct rb_process_status *data = NULL;
			data = (rb_process_status*)RTYPEDDATA_GET_DATA(proc_status);
			data-&gt;pid = pid;
			data-&gt;status = status;
#elif defined(IS_RUBY_3_OR_LATER)
			struct rb_process_status *data = NULL;

			/* Defined to match static definition from MRI Ruby 3.0 process.c
			 *
			 * Older C++ compilers before GCC 8 don&#39;t allow static initialization of a
			 * struct without every field specified, so the definition here is at runtime
			 */
			static rb_data_type_t rb_process_status_type;
			rb_process_status_type.wrap_struct_name = &quot;Process::Status&quot;;
			rb_process_status_type.function.dfree = RUBY_DEFAULT_FREE;
			rb_process_status_type.flags = RUBY_TYPED_FREE_IMMEDIATELY;

			proc_status = TypedData_Make_Struct(rb_cProcessStatus, struct rb_process_status, &amp;rb_process_status_type, data);
			data-&gt;pid = pid;
			data-&gt;status = status;
#else
			proc_status = rb_obj_alloc(rb_cProcessStatus);
			/* MRI Ruby uses hidden instance vars */
			rb_ivar_set(proc_status, rb_intern_const(&quot;status&quot;), INT2FIX(status));
			rb_ivar_set(proc_status, rb_intern_const(&quot;pid&quot;), INT2FIX(pid));
#endif

#ifdef RUBINIUS
			/* Rubinius uses standard instance vars */
			rb_iv_set(proc_status, &quot;@pid&quot;, INT2FIX(pid));
			if (WIFEXITED(status)) {
				rb_iv_set(proc_status, &quot;@status&quot;, INT2FIX(WEXITSTATUS(status)));
			} else if (WIFSIGNALED(status)) {
				rb_iv_set(proc_status, &quot;@termsig&quot;, INT2FIX(WTERMSIG(status)));
			} else if (WIFSTOPPED(status)) {
				rb_iv_set(proc_status, &quot;@stopsig&quot;, INT2FIX(WSTOPSIG(status)));
			}
#endif
		}
	}
	rb_obj_freeze(proc_status);
	return proc_status;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_timer_count-class_method">
  <h3 class='signature private'>
    .<strong>get_timer_count</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_get_timer_count</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L282-L285'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='282' data-end='285'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 282</span></pre>
<pre class='code cpp'>

static VALUE t_get_timer_count ()
{
	return SIZET2NUM (evma_get_timer_count ());
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initialize_event_machine-class_method">
  <h3 class='signature private'>
    .<strong>initialize_event_machine</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_initialize_event_machine</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L247-L255'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='247' data-end='255'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 247</span></pre>
<pre class='code cpp'>

static VALUE t_initialize_event_machine (VALUE self UNUSED)
{
	EmConnsHash = rb_ivar_get (EmModule, Intern_at_conns);
	EmTimersHash = rb_ivar_get (EmModule, Intern_at_timers);
	assert(EmConnsHash != Qnil);
	assert(EmTimersHash != Qnil);
	evma_initialize_library ((EMCallback)event_callback_wrapper);
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="invoke_popen-class_method">
  <h3 class='signature private'>
    .<strong>invoke_popen</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_invoke_popen</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1028-L1059'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1028' data-end='1059'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1028</span></pre>
<pre class='code cpp'>

static VALUE t_invoke_popen (VALUE self UNUSED, VALUE cmd)
{
	#ifdef OS_WIN32
	rb_raise (EM_eUnsupported, &quot;popen is not available on this platform&quot;);
	#endif

	int len = RARRAY_LEN(cmd);
	if (len &gt;= 2048)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;too many arguments to popen&quot;);
	char *strings [2048];
	for (int i=0; i &lt; len; i++) {
		VALUE ix = INT2FIX (i);
		VALUE s = rb_ary_aref (1, &amp;ix, cmd);
		strings[i] = StringValueCStr (s);
	}
	strings[len] = NULL;

	uintptr_t f = 0;
	try {
		f = evma_popen (strings);
	} catch (std::runtime_error e) {
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, e.what());
	}
	if (!f) {
		char *err = strerror (errno);
		char buf[100];
		memset (buf, 0, sizeof(buf));
		snprintf (buf, sizeof(buf)-1, &quot;no popen: %s&quot;, (err?err:&quot;???&quot;));
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, buf);
	}
	return BSIG2NUM (f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="klass_from_handler-class_method">
  <h3 class='signature nodoc'>
    .<strong>klass_from_handler</strong>(klass = Connection, handler = nil, *args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1576-L1597'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1576' data-end='1597'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1576</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_klass_from_handler'>klass_from_handler</span>(<span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_handler'>handler</span> <span class='kw'>and</span> <span class='id identifier rubyid_handler'>handler</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Class</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>must provide module or subclass of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_klass'>klass</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_handler'>handler</span>
    <span class='id identifier rubyid_handler'>handler</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_handler'>handler</span>
    <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='id identifier rubyid_handler'>handler</span><span class='op'>::</span><span class='const'>EM_CONNECTION_CLASS</span>)
      <span class='id identifier rubyid_handler'>handler</span><span class='op'>::</span><span class='const'>EM_CONNECTION_CLASS</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_handler'>handler</span><span class='op'>::</span><span class='id identifier rubyid_const_set'>const_set</span>(<span class='symbeg'>:</span><span class='const'>EM_CONNECTION_CLASS</span><span class='comma'>,</span> <span class='const'>Class</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_klass'>klass</span>) {<span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid_handler'>handler</span>})
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_klass'>klass</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_arity'>arity</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_instance_method'>instance_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_initialize'>initialize</span>).<span class='id identifier rubyid_arity'>arity</span>
  <span class='id identifier rubyid_expected'>expected</span> <span class='op'>=</span> <span class='id identifier rubyid_arity'>arity</span> <span class='op'>&gt;=</span> <span class='int'>0</span> <span class='op'>?</span> <span class='id identifier rubyid_arity'>arity</span> <span class='op'>:</span> <span class='op'>-</span>(<span class='id identifier rubyid_arity'>arity</span> <span class='op'>+</span> <span class='int'>1</span>)
  <span class='kw'>if</span> (<span class='id identifier rubyid_arity'>arity</span> <span class='op'>&gt;=</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='id identifier rubyid_expected'>expected</span>) <span class='kw'>or</span> (<span class='id identifier rubyid_arity'>arity</span> <span class='op'>&lt;</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_expected'>expected</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wrong number of arguments for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_klass'>klass</span><span class='embexpr_end'>}</span><span class='tstring_content'>#initialize (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_expected'>expected</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_klass'>klass</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="kqueue=-class_method">
  <h3 class='signature ro  private'>
    .<strong>kqueue=</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t__kqueue_set</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1212-L1219'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1212' data-end='1219'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1212</span></pre>
<pre class='code cpp'>

static VALUE t__kqueue_set (VALUE self, VALUE val)
{
	if (t__kqueue_p(self) == Qfalse &amp;&amp; val == Qtrue)
		rb_raise (EM_eUnsupported, &quot;%s&quot;, &quot;kqueue is not supported on this platform&quot;);

	evma_set_kqueue (val == Qtrue ? 1 : 0);
	return val;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="library_type-class_method">
  <h3 class='signature private'>
    .<strong>library_type</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_library_type</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L961-L964'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='961' data-end='964'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 961</span></pre>
<pre class='code cpp'>

static VALUE t_library_type (VALUE self UNUSED)
{
	return rb_eval_string (&quot;:extension&quot;);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="next_tick-class_method">
  <h3 class='signature '>
    .<strong>next_tick</strong>(pr = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Schedules a proc for execution immediately after the next &quot;turn&quot; through the reactor
core. An advanced technique, this can be useful for improving memory management and/or
application responsiveness, especially when scheduling large amounts of data for
writing to a network connection.</p>

<p>This method takes either a single argument (which must be a callable object) or a block.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>pr</span>
    <span class='type'>(#<code>call</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>A callable object to run</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>ArgumentError</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1122-L1136'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1122' data-end='1136'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1122</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_next_tick'>next_tick</span> <span class='id identifier rubyid_pr'>pr</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='comment'># This works by adding to the @resultqueue that&#39;s used for #defer.
</span>  <span class='comment'># The general idea is that next_tick is used when we want to give the reactor a chance
</span>  <span class='comment'># to let other operations run, either to balance the load out more evenly, or to let
</span>  <span class='comment'># outbound network buffers drain, or both. So we probably do NOT want to block, and
</span>  <span class='comment'># we probably do NOT want to be spinning any threads. A program that uses next_tick
</span>  <span class='comment'># but not #defer shouldn&#39;t suffer the penalty of having Ruby threads running. They&#39;re
</span>  <span class='comment'># extremely expensive even if they&#39;re just sleeping.
</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no proc or block given</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> ((<span class='id identifier rubyid_pr'>pr</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_pr'>pr</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_call'>call</span>)) <span class='kw'>or</span> <span class='id identifier rubyid_block'>block</span>)
  <span class='ivar'>@next_tick_mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='ivar'>@next_tick_queue</span> <span class='op'>&lt;&lt;</span> ( <span class='id identifier rubyid_pr'>pr</span> <span class='op'>||</span> <span class='id identifier rubyid_block'>block</span> )
  <span class='kw'>end</span>
  <span class='id identifier rubyid_signal_loopbreak'><a href="#signal_loopbreak-class_method" title="EventMachine.signal_loopbreak (method)">signal_loopbreak</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_reactor_running?'><a href="#reactor_running%3F-class_method" title="EventMachine.reactor_running? (method)">reactor_running?</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="open_datagram_socket-class_method">
  <h3 class='signature '>
    .<strong>open_datagram_socket</strong>(address, port, handler = nil, *args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Used for UDP-based protocols. Its usage is similar to that of <a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a>.</p>

<p>This method will create a new UDP (datagram) socket and
bind it to the address and port that you specify.
The normal callbacks (see <a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a>) will
be called as events of interest occur on the newly-created
socket, but there are some differences in how they behave.</p>

<p><a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a> will be called when a datagram packet
is received on the socket, but unlike TCP sockets, the message
boundaries of the received data will be respected. In other words,
if the remote peer sent you a datagram of a particular size,
you may rely on <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a> to give you the
exact data in the packet, with the original data length.
Also observe that Connection#receive_data may be called with a
<em>zero-length</em> data payload, since empty datagrams are permitted in UDP.</p>

<p><a href="EventMachine/Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">Connection#send_data</a> is available with UDP packets as with TCP,
but there is an important difference. Because UDP communications
are <em>connectionless</em>, there is no implicit recipient for the packets you
send. Ordinarily you must specify the recipient for each packet you send.
However, <code>EventMachine</code> provides for the typical pattern of receiving a UDP datagram
from a remote peer, performing some operation, and then sending
one or more packets in response to the same remote peer.
To support this model easily, just use <a href="EventMachine/Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">Connection#send_data</a>
in the code that you supply for <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a>.</p>

<p><code>EventMachine</code> will provide an implicit return address for any messages sent to
<a href="EventMachine/Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">Connection#send_data</a> within the context of a <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a> callback,
and your response will automatically go to the correct remote peer.</p>

<p>Observe that the port number that you supply to <code>open_datagram_socket</code>
may be zero. In this case, <code>EventMachine</code> will create a UDP socket
that is bound to an <a href="http://en.wikipedia.org/wiki/Ephemeral_port">ephemeral port</a>.
This is not appropriate for servers that must publish a well-known
port to which remote peers may send datagrams. But it can be useful
for clients that send datagrams to other servers.
If you do this, you will receive any responses from the remote
servers through the normal <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a> callback.
Observe that you will probably have issues with firewalls blocking
the ephemeral port numbers, so this technique is most appropriate for LANs.</p>

<p>If you wish to send datagrams to arbitrary remote peers (not
necessarily ones that have sent data to which you are responding),
then see <a href="EventMachine/Connection.html#send_datagram-instance_method" title="EventMachine::Connection#send_datagram (method)">Connection#send_datagram</a>.</p>

<p>DO NOT call send_data from a datagram socket outside of a <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a> method. Use <a href="EventMachine/Connection.html#send_datagram-instance_method" title="EventMachine::Connection#send_datagram (method)">Connection#send_datagram</a>.
If you do use <a href="EventMachine/Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">Connection#send_data</a> outside of a <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a> method, you&#39;ll get a confusing error
because there is no &quot;peer,&quot; as #send_data requires (inside of <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a>,
<a href="EventMachine/Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">Connection#send_data</a> &quot;fakes&quot; the peer as described above).</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>address</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>IP address</p>
</div>
  </li>
  <li>
    <span class='name'>port</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Port</p>
</div>
  </li>
  <li>
    <span class='name'>handler</span>
    <span class='type'>(<code>Class</code>, <code>Module</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>A class or a module that implements connection lifecycle callbacks.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L873-L884'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='873' data-end='884'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 873</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_open_datagram_socket'>open_datagram_socket</span> <span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='comment'># Replaced the implementation on 01Oct06. Thanks to Tobias Gustafsson for pointing
</span>  <span class='comment'># out that this originally did not take a class but only a module.
</span>

  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_open_udp_socket'><a href="#open_udp_socket-class_method" title="EventMachine.open_udp_socket (method)">open_udp_socket</a></span> <span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>.<span class='id identifier rubyid_to_i'>to_i</span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="open_keyboard-class_method">
  <h3 class='signature nodoc'>
    .<strong>open_keyboard</strong>(handler = nil, *args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    <p>(Experimental)</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1236-L1244'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1236' data-end='1244'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1236</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_open_keyboard'>open_keyboard</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_read_keyboard'><a href="#read_keyboard-class_method" title="EventMachine.read_keyboard (method)">read_keyboard</a></span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="open_udp_socket-class_method">
  <h3 class='signature private'>
    .<strong>open_udp_socket</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_open_udp_socket</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L916-L922'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='916' data-end='922'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 916</span></pre>
<pre class='code cpp'>

static VALUE t_open_udp_socket (VALUE self UNUSED, VALUE server, VALUE port)
{
	const uintptr_t f = evma_open_datagram_socket (StringValueCStr(server), FIX2INT(port));
	if (!f)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;no datagram socket&quot;);
	return BSIG2NUM(f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="popen-class_method">
  <h3 class='signature '>
    .<strong>popen</strong>(cmd, handler = nil, *args) {|c| ... } 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>This method is not supported on Microsoft Windows</p>
</div>
  </div>

<p>Runs an external process.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='kw'>module</span> <span class='const'>RubyCounter</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'>post_init</span>
    <span class='comment'># count up to 5
</span>    <span class='id identifier rubyid_send_data'><a href="#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'>receive_data</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby sent me: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby died with exit status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_status'>get_status</span>.<span class='id identifier rubyid_exitstatus'>exitstatus</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_popen'>popen</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby -e&#39; $stdout.sync = true; gets.to_i.times{ |i| puts i+1; sleep 1 } &#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>RubyCounter</span>)
}</code></pre>
  </div>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'>(<code>c</code>)</span>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="EventMachine/DeferrableChildProcess.html" title="EventMachine::DeferrableChildProcess (class)"><code>DeferrableChildProcess</code></a></li>
          <li><a href="#system-class_method" title="EventMachine.system (method)">.system</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1199-L1216'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1199' data-end='1216'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1199</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_popen'>popen</span> <span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='comment'># At this moment, it&#39;s only available on Unix.
</span>  <span class='comment'># Perhaps misnamed since the underlying function uses socketpair and is full-duplex.
</span>
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_cmd'>cmd</span>
      <span class='kw'>when</span> <span class='const'>Array</span>
        <span class='id identifier rubyid_cmd'>cmd</span>
      <span class='kw'>when</span> <span class='const'>String</span>
        <span class='const'>Shellwords</span><span class='op'>::</span><span class='id identifier rubyid_shellwords'>shellwords</span>( <span class='id identifier rubyid_cmd'>cmd</span> )
      <span class='kw'>end</span>
  <span class='id identifier rubyid_w'>w</span>.<span class='id identifier rubyid_unshift'>unshift</span>( <span class='id identifier rubyid_w'>w</span>.<span class='id identifier rubyid_first'>first</span> ) <span class='kw'>if</span> <span class='id identifier rubyid_w'>w</span>.<span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_invoke_popen'><a href="#invoke_popen-class_method" title="EventMachine.invoke_popen (method)">invoke_popen</a></span>( <span class='id identifier rubyid_w'>w</span> )
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='kw'>yield</span>(<span class='id identifier rubyid_c'>c</span>) <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="read_keyboard-class_method">
  <h3 class='signature private'>
    .<strong>read_keyboard</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_read_keyboard</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1066-L1072'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1066' data-end='1072'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1066</span></pre>
<pre class='code cpp'>

static VALUE t_read_keyboard (VALUE self UNUSED)
{
	const uintptr_t f = evma_open_keyboard();
	if (!f)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;no keyboard reader&quot;);
	return BSIG2NUM (f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reconnect-class_method">
  <h3 class='signature '>
    .<strong>reconnect</strong>(server, port, handler)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Connect to a given host/port and re-use the provided <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> instance.
Consider also <a href="EventMachine/Connection.html#reconnect-instance_method" title="EventMachine::Connection#reconnect (method)">Connection#reconnect</a>.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="EventMachine/Connection.html#reconnect-instance_method" title="EventMachine::Connection#reconnect (method)">Connection#reconnect</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L782-L804'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='782' data-end='804'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 782</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_reconnect'>reconnect</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span>
  <span class='comment'># Observe, the test for already-connected FAILS if we call a reconnect inside post_init,
</span>  <span class='comment'># because we haven&#39;t set up the connection in @conns by that point.
</span>  <span class='comment'># RESIST THE TEMPTATION to &quot;fix&quot; this problem by redefining the behavior of post_init.
</span>  <span class='comment'>#
</span>  <span class='comment'># Changed 22Nov06: if called on an already-connected handler, just return the
</span>  <span class='comment'># handler and do nothing more. Originally this condition raised an exception.
</span>  <span class='comment'># We may want to change it yet again and call the block, if any.
</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid handler</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_handler'>handler</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_connection_completed'>connection_completed</span>)
  <span class='comment'>#raise &quot;still connected&quot; if @conns.has_key?(handler.signature)
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_handler'>handler</span> <span class='kw'>if</span> <span class='ivar'>@conns</span>.<span class='id identifier rubyid_has_key?'>has_key?</span>(<span class='id identifier rubyid_handler'>handler</span>.<span class='id identifier rubyid_signature'>signature</span>)

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span>
        <span class='id identifier rubyid_connect_server'><a href="#connect_server-class_method" title="EventMachine.connect_server (method)">connect_server</a></span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_connect_unix_server'><a href="#connect_unix_server-class_method" title="EventMachine.connect_unix_server (method)">connect_unix_server</a></span> <span class='id identifier rubyid_server'>server</span>
      <span class='kw'>end</span>
  <span class='id identifier rubyid_handler'>handler</span>.<span class='id identifier rubyid_signature'>signature</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span>
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_handler'>handler</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_handler'>handler</span>
  <span class='id identifier rubyid_handler'>handler</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="release_machine-class_method">
  <h3 class='signature private'>
    .<strong>release_machine</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_release_machine</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L930-L934'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='930' data-end='934'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 930</span></pre>
<pre class='code cpp'>

static VALUE t_release_machine (VALUE self UNUSED)
{
	evma_release_library();
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="report_connection_error_status-class_method">
  <h3 class='signature private'>
    .<strong>report_connection_error_status</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_report_connection_error_status</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L692-L696'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='692' data-end='696'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 692</span></pre>
<pre class='code cpp'>

static VALUE t_report_connection_error_status (VALUE self UNUSED, VALUE signature)
{
	int b = evma_report_connection_error_status (NUM2BSIG (signature));
	return INT2NUM (b);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="run-class_method">
  <h3 class='signature '>
    .<strong>run</strong>(blk = nil, tail = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>This method blocks calling thread. If you need to start <code>EventMachine</code> event loop from a Web app
running on a non event-driven server (Unicorn, Apache Passenger, Mongrel), do it in a separate thread like demonstrated
in one of the examples.</p>
</div>
  </div>

<p>Initializes and runs an event loop. This method only returns if code inside the block passed to this method
calls <a href="#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">.stop_event_loop</a>. The block is executed after initializing its internal event loop but <em>before</em> running the loop,
therefore this block is the right place to call any code that needs event loop to run, for example, <a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a>,
<a href="#connect-class_method" title="EventMachine.connect (method)">.connect</a> or similar methods of libraries that use <code>EventMachine</code> under the hood
(like <code>EventMachine::HttpRequest.new</code> or <code>AMQP.start</code>).</p>

<p>Programs that are run for long periods of time (e.g. servers) usually start event loop by calling <code>run</code>, and let it
run &quot;forever&quot;. It&#39;s also possible to use <code>run</code> to make a single client-connection to a remote server,
process the data flow from that single connection, and then call <a href="#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">.stop_event_loop</a> to stop, in other words,
to run event loop for a short period of time (necessary to complete some operation) and then shut it down.</p>

<p>Once event loop is running, it is perfectly possible to start multiple servers and clients simultaneously: content-aware
proxies like <a href="https://github.com/mojombo/proxymachine">Proxymachine</a> do just that.</p>

<h4>Using EventMachine with Ruby on Rails and other Web application frameworks</h4>

<p>Standalone applications often run event loop on the main thread, thus blocking for their entire lifespan. In case of Web applications,
if you are running an EventMachine-based app server such as <a href="http://code.macournoyer.com/thin/">Thin</a> or <a href="https://github.com/postrank-labs/goliath/">Goliath</a>,
they start event loop for you. Servers like Unicorn, Apache Passenger or Mongrel occupy main Ruby thread to serve HTTP(S) requests. This means
that calling <code>run</code> on the same thread is not an option (it will result in Web server never binding to the socket).
In that case, start event loop in a separate thread as demonstrated below.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Starting EventMachine event loop in the current thread to run the &quot;Hello, world&quot;-like Echo server example</p>
</div></p>
      <pre class='example code ruby'><code><span class='comment'>#!/usr/bin/env ruby
</span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># or use Bundler.setup
</span><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>eventmachine</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>class</span> <span class='const'>EchoServer</span> <span class='op'>&lt;</span> <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span>
  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'>receive_data</span>(<span class='id identifier rubyid_data'>data</span>)
    <span class='id identifier rubyid_send_data'><a href="#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span>(<span class='id identifier rubyid_data'>data</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'>run</span> <span class='kw'>do</span>
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_start_server'><a href="#start_server-class_method" title="EventMachine.start_server (method)">start_server</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>10000</span><span class='comma'>,</span> <span class='const'>EchoServer</span>)
<span class='kw'>end</span></code></pre>
        <p class='example_title'><div class='inline'><p>Starting EventMachine event loop in a separate thread</p>
</div></p>
      <pre class='example code ruby'><code><span class='comment'># doesn&#39;t block current thread, can be used with Ruby on Rails, Sinatra, Merb, Rack
</span><span class='comment'># and any other application server that occupies main Ruby thread.
</span><span class='const'>Thread</span>.<span class='id identifier rubyid_new'>new</span> { <span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'>run</span> }</code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="file.GettingStarted.html" title="Getting started with EventMachine">Getting started with EventMachine</a></li>
          <li><a href="#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">.stop_event_loop</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L150-L212'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='150' data-end='212'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 150</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_run'>run</span> <span class='id identifier rubyid_blk'>blk</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_tail'>tail</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='comment'># Obsoleted the use_threads mechanism.
</span>  <span class='comment'># 25Nov06: Added the begin/ensure block. We need to be sure that release_machine
</span>  <span class='comment'># gets called even if an exception gets thrown within any of the user code
</span>  <span class='comment'># that the event loop runs. The best way to see this is to run a unit
</span>  <span class='comment'># test with two functions, each of which calls {EventMachine.run} and each of
</span>  <span class='comment'># which throws something inside of #run. Without the ensure, the second test
</span>  <span class='comment'># will start without release_machine being called and will immediately throw
</span>
  <span class='comment'>#
</span>  <span class='kw'>if</span> <span class='ivar'>@reactor_running</span> <span class='kw'>and</span> <span class='ivar'>@reactor_pid</span> <span class='op'>!=</span> <span class='const'>Process</span>.<span class='id identifier rubyid_pid'>pid</span>
    <span class='comment'># Reactor was started in a different parent, meaning we have forked.
</span>    <span class='comment'># Clean up reactor state so a new reactor boots up in this child.
</span>    <span class='id identifier rubyid_stop_event_loop'><a href="#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">stop_event_loop</a></span>
    <span class='id identifier rubyid_release_machine'><a href="#release_machine-class_method" title="EventMachine.release_machine (method)">release_machine</a></span>
    <span class='id identifier rubyid_cleanup_machine'><a href="#cleanup_machine-class_method" title="EventMachine.cleanup_machine (method)">cleanup_machine</a></span>
    <span class='ivar'>@reactor_running</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_tail'>tail</span> <span class='kw'>and</span> <span class='ivar'>@tails</span>.<span class='id identifier rubyid_unshift'>unshift</span>(<span class='id identifier rubyid_tail'>tail</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_reactor_running?'><a href="#reactor_running%3F-class_method" title="EventMachine.reactor_running? (method)">reactor_running?</a></span>
    (<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_blk'>blk</span> <span class='op'>||</span> <span class='id identifier rubyid_block'>block</span>) <span class='kw'>and</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'>call</span> <span class='comment'># next_tick(b)
</span>  <span class='kw'>else</span>
    <span class='ivar'>@conns</span> <span class='op'>=</span> {}
    <span class='ivar'>@acceptors</span> <span class='op'>=</span> {}
    <span class='ivar'>@timers</span> <span class='op'>=</span> {}
    <span class='ivar'>@wrapped_exception</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@next_tick_queue</span> <span class='op'>||=</span> []
    <span class='ivar'>@tails</span> <span class='op'>||=</span> []
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_initialize_event_machine'><a href="#initialize_event_machine-class_method" title="EventMachine.initialize_event_machine (method)">initialize_event_machine</a></span>
      <span class='ivar'>@reactor_pid</span> <span class='op'>=</span> <span class='const'>Process</span>.<span class='id identifier rubyid_pid'>pid</span>
      <span class='ivar'>@reactor_thread</span> <span class='op'>=</span> <span class='const'>Thread</span>.<span class='id identifier rubyid_current'>current</span>
      <span class='ivar'>@reactor_running</span> <span class='op'>=</span> <span class='kw'>true</span>

      (<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_blk'>blk</span> <span class='op'>||</span> <span class='id identifier rubyid_block'>block</span>) <span class='kw'>and</span> <span class='id identifier rubyid_add_timer'><a href="#add_timer-class_method" title="EventMachine.add_timer (method)">add_timer</a></span>(<span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)
      <span class='kw'>if</span> <span class='ivar'>@next_tick_queue</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@next_tick_queue</span>.<span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_add_timer'><a href="#add_timer-class_method" title="EventMachine.add_timer (method)">add_timer</a></span>(<span class='int'>0</span>) { <span class='id identifier rubyid_signal_loopbreak'><a href="#signal_loopbreak-class_method" title="EventMachine.signal_loopbreak (method)">signal_loopbreak</a></span> }
      <span class='kw'>end</span>

      <span class='comment'># Rubinius needs to come back into &quot;Ruby space&quot; for GC to work,
</span>      <span class='comment'># so we&#39;ll crank the machine here.
</span>      <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='const'>RUBY_ENGINE</span>) <span class='op'>&amp;&amp;</span> <span class='const'>RUBY_ENGINE</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rbx</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>while</span> <span class='id identifier rubyid_run_machine_once'><a href="#run_machine_once-class_method" title="EventMachine.run_machine_once (method)">run_machine_once</a></span><span class='semicolon'>;</span> <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_run_machine'><a href="#run_machine-class_method" title="EventMachine.run_machine (method)">run_machine</a></span>
      <span class='kw'>end</span>

    <span class='kw'>ensure</span>
      <span class='kw'>until</span> <span class='ivar'>@tails</span>.<span class='id identifier rubyid_empty?'>empty?</span>
        <span class='ivar'>@tails</span>.<span class='id identifier rubyid_pop'>pop</span>.<span class='id identifier rubyid_call'>call</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_release_machine'><a href="#release_machine-class_method" title="EventMachine.release_machine (method)">release_machine</a></span>
      <span class='id identifier rubyid_cleanup_machine'><a href="#cleanup_machine-class_method" title="EventMachine.cleanup_machine (method)">cleanup_machine</a></span>
      <span class='ivar'>@reactor_running</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='ivar'>@reactor_thread</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='ivar'>@wrapped_exception</span> <span class='kw'>if</span> <span class='ivar'>@wrapped_exception</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="run_block-class_method">
  <h3 class='signature '>
    .<strong>run_block</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sugars a common use case. Will pass the given block to #run, but will terminate
the reactor loop and exit the function as soon as the code in the block completes.
(Normally, <a href="#run-class_method" title="EventMachine.run (method)">.run</a> keeps running indefinitely, even after the block supplied to it
finishes running, until user code calls <a href="#stop-class_method" title="EventMachine.stop (method)">.stop</a>)</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L219-L225'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='219' data-end='225'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 219</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_run_block'>run_block</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_pr'>pr</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
    <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_call'>call</span>
    <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_stop'><a href="#stop-class_method" title="EventMachine.stop (method)">stop</a></span>
  }
  <span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_pr'>pr</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="run_deferred_callbacks-class_method">
  <h3 class='signature nodoc'>
    .<strong>run_deferred_callbacks</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    <p>The is the responder for the loopback-signalled event.
It can be fired either by code running on a separate thread (<a href="#defer-class_method" title="EventMachine.defer (method)">.defer</a>) or on
the main thread (<a href="#next_tick-class_method" title="EventMachine.next_tick (method)">.next_tick</a>).
It will often happen that a next_tick handler will reschedule itself. We
consume a copy of the tick queue so that tick events scheduled by tick events
have to wait for the next pass through the reactor core.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L968-L992'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='968' data-end='992'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 968</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_run_deferred_callbacks'>run_deferred_callbacks</span>
  <span class='kw'>until</span> (<span class='ivar'>@resultqueue</span> <span class='op'>||=</span> []).<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_result'>result</span><span class='comma'>,</span><span class='id identifier rubyid_cback'>cback</span> <span class='op'>=</span> <span class='ivar'>@resultqueue</span>.<span class='id identifier rubyid_pop'>pop</span>
    <span class='id identifier rubyid_cback'>cback</span>.<span class='id identifier rubyid_call'>call</span> <span class='id identifier rubyid_result'>result</span> <span class='kw'>if</span> <span class='id identifier rubyid_cback'>cback</span>
  <span class='kw'>end</span>

  <span class='comment'># Capture the size at the start of this tick...
</span>  <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='ivar'>@next_tick_mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> { <span class='ivar'>@next_tick_queue</span>.<span class='id identifier rubyid_size'>size</span> }
  <span class='id identifier rubyid_size'>size</span>.<span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_callback'>callback</span> <span class='op'>=</span> <span class='ivar'>@next_tick_mutex</span>.<span class='id identifier rubyid_synchronize'>synchronize</span> { <span class='ivar'>@next_tick_queue</span>.<span class='id identifier rubyid_shift'>shift</span> }
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_callback'>callback</span>.<span class='id identifier rubyid_call'>call</span>
    <span class='kw'>rescue</span>
      <span class='id identifier rubyid_exception_raised'>exception_raised</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>ensure</span>
      <span class='comment'># This is a little nasty. The problem is, if an exception occurs during
</span>      <span class='comment'># the callback, then we need to send a signal to the reactor to actually
</span>      <span class='comment'># do some work during the next_tick. The only mechanism we have from the
</span>      <span class='comment'># ruby side is next_tick itself, although ideally, we&#39;d just drop a byte
</span>      <span class='comment'># on the loopback descriptor.
</span>      <span class='id identifier rubyid_next_tick'><a href="#next_tick-class_method" title="EventMachine.next_tick (method)">next_tick</a></span> {} <span class='kw'>if</span> <span class='id identifier rubyid_exception_raised'>exception_raised</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="run_machine-class_method">
  <h3 class='signature private'>
    .<strong>run_machine</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>.run_machine_without_threads</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_run_machine</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L272-L276'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='272' data-end='276'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 272</span></pre>
<pre class='code cpp'>

static VALUE t_run_machine (VALUE self UNUSED)
{
	evma_run_machine();
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="run_machine_once-class_method">
  <h3 class='signature private'>
    .<strong>run_machine_once</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_run_machine_once</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L262-L265'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='262' data-end='265'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 262</span></pre>
<pre class='code cpp'>

static VALUE t_run_machine_once (VALUE self UNUSED)
{
	return evma_run_machine_once () ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="run_machine_without_threads-class_method">
  <h3 class='signature private'>
    .<strong>run_machine_without_threads</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Alias for <a href="#run_machine-class_method" title="EventMachine.run_machine (method)">.run_machine</a>.</p>

  </div>
</div>

</section>

<section class='method_details' id="schedule-class_method">
  <h3 class='signature '>
    .<strong>schedule</strong>(*a, &amp;b)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Runs the given callback on the reactor thread, or immediately if called
from the reactor thread. Accepts the same arguments as <code>EventMachine::Callback</code></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L234-L241'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='234' data-end='241'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 234</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_schedule'>schedule</span>(<span class='op'>*</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>)
  <span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='const'><a href="#Callback-class_method" title="EventMachine.Callback (method)">Callback</a></span>(<span class='op'>*</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_reactor_running?'><a href="#reactor_running%3F-class_method" title="EventMachine.reactor_running? (method)">reactor_running?</a></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_reactor_thread?'><a href="#reactor_thread%3F-class_method" title="EventMachine.reactor_thread? (method)">reactor_thread?</a></span>
    <span class='id identifier rubyid_cb'>cb</span>.<span class='id identifier rubyid_call'>call</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_next_tick'><a href="#next_tick-class_method" title="EventMachine.next_tick (method)">next_tick</a></span> { <span class='id identifier rubyid_cb'>cb</span>.<span class='id identifier rubyid_call'>call</span> }
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_data-class_method">
  <h3 class='signature private'>
    .<strong>send_data</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_send_data</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L352-L356'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='352' data-end='356'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 352</span></pre>
<pre class='code cpp'>

static VALUE t_send_data (VALUE self UNUSED, VALUE signature, VALUE data, VALUE data_length)
{
	int b = evma_send_data_to_connection (NUM2BSIG (signature), StringValuePtr (data), FIX2INT (data_length));
	return INT2NUM (b);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_datagram-class_method">
  <h3 class='signature private'>
    .<strong>send_datagram</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_send_datagram</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L669-L675'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='669' data-end='675'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 669</span></pre>
<pre class='code cpp'>

static VALUE t_send_datagram (VALUE self UNUSED, VALUE signature, VALUE data, VALUE data_length, VALUE address, VALUE port)
{
	int b = evma_send_datagram (NUM2BSIG (signature), StringValuePtr (data), FIX2INT (data_length), StringValueCStr(address), FIX2INT(port));
	if (b &lt; 0)
		rb_raise (EM_eConnectionError, &quot;%s&quot;, &quot;error in sending datagram&quot;); // FIXME: this could be more specific.
	return INT2NUM (b);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_file_data-class_method">
  <h3 class='signature private'>
    .<strong>send_file_data</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_send_file_data</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1253-L1277'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1253' data-end='1277'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1253</span></pre>
<pre class='code cpp'>

static VALUE t_send_file_data (VALUE self UNUSED, VALUE signature, VALUE filename)
{

	/* The current implementation of evma_send_file_data_to_connection enforces a strict
	 * upper limit on the file size it will transmit (currently 32K). The function returns
	 * zero on success, -1 if the requested file exceeds its size limit, and a positive
	 * number for other errors.
	 * TODO: Positive return values are actually errno&#39;s, which is probably the wrong way to
	 * do this. For one thing it&#39;s ugly. For another, we can&#39;t be sure zero is never a real errno.
	 */

	int b = evma_send_file_data_to_connection (NUM2BSIG (signature), StringValueCStr(filename));
	if (b == -1)
		rb_raise(rb_eRuntimeError, &quot;%s&quot;, &quot;File too large.  send_file_data() supports files under 32k.&quot;);
	if (b &gt; 0) {
		char *err = strerror (b);
		char buf[1024];
		memset (buf, 0, sizeof(buf));
		snprintf (buf, sizeof(buf)-1, &quot;: %s %s&quot;, StringValueCStr(filename),(err?err:&quot;???&quot;));

		rb_raise (rb_eIOError, &quot;%s&quot;, buf);
	}

	return INT2NUM (0);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_comm_inactivity_timeout-class_method">
  <h3 class='signature private'>
    .<strong>set_comm_inactivity_timeout</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_set_comm_inactivity_timeout</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L634-L641'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='634' data-end='641'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 634</span></pre>
<pre class='code cpp'>

static VALUE t_set_comm_inactivity_timeout (VALUE self UNUSED, VALUE signature, VALUE timeout)
{
	float ti = RFLOAT_VALUE(timeout);
	if (evma_set_comm_inactivity_timeout(NUM2BSIG(signature), ti)) {
		return Qtrue;
	}
	return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_descriptor_table_size-class_method">
  <h3 class='signature '>
    .<strong>set_descriptor_table_size</strong>(n_descriptors = nil)  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sets the maximum number of file or socket descriptors that your process may open.
If you call this method with no arguments, it will simply return
the current size of the descriptor table without attempting to change it.</p>

<p>The new limit on open descriptors <strong>only</strong> applies to sockets and other descriptors
that belong to <code>EventMachine</code>. It has <strong>no effect</strong> on the number of descriptors
you can create in ordinary Ruby code.</p>

<p>Not available on all platforms. Increasing the number of descriptors beyond its
default limit usually requires superuser privileges. (See <a href="#set_effective_user-class_method" title="EventMachine.set_effective_user (method)">.set_effective_user</a>
for a way to drop superuser privileges while your program is running.)</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>n_descriptors</span>
    <span class='type'>(<code>Integer</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>The maximum number of file or socket descriptors that your process may open</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>The new descriptor table size.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1169-L1171'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1169' data-end='1171'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1169</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_set_descriptor_table_size'>set_descriptor_table_size</span> <span class='id identifier rubyid_n_descriptors'>n_descriptors</span><span class='op'>=</span><span class='kw'>nil</span>
  <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_set_rlimit_nofile'><a href="#set_rlimit_nofile-class_method" title="EventMachine.set_rlimit_nofile (method)">set_rlimit_nofile</a></span> <span class='id identifier rubyid_n_descriptors'>n_descriptors</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_effective_user-class_method">
  <h3 class='signature '>
    .<strong>set_effective_user</strong>(username)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>This method has no effective implementation on Windows or in the pure-Ruby
implementation of <code>EventMachine</code></p>
</div>
  </div>

<p>A wrapper over the setuid system call. Particularly useful when opening a network
server on a privileged port because you can use this call to drop privileges
after opening the port. Also very useful after a call to <a href="#set_descriptor_table_size-class_method" title="EventMachine.set_descriptor_table_size (method)">.set_descriptor_table_size</a>,
which generally requires that you start your process with root privileges.</p>

<p>This method is intended for use in enforcing security requirements, consequently
it will throw a fatal error and end your program if it fails.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>username</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>The effective name of the user whose privilege-level your process should attain.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1150-L1152'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1150' data-end='1152'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1150</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_set_effective_user'>set_effective_user</span> <span class='id identifier rubyid_username'>username</span>
  <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_setuid_string'><a href="#setuid_string-class_method" title="EventMachine.setuid_string (method)">setuid_string</a></span> <span class='id identifier rubyid_username'>username</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_heartbeat_interval-class_method">
  <h3 class='signature private'>
    .<strong>set_heartbeat_interval</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_set_heartbeat_interval</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1450-L1456'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1450' data-end='1456'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1450</span></pre>
<pre class='code cpp'>

static VALUE t_set_heartbeat_interval (VALUE self UNUSED, VALUE interval)
{
	float iv = RFLOAT_VALUE(interval);
	if (evma_set_heartbeat_interval(iv))
		return Qtrue;
	return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_max_timer_count-class_method">
  <h3 class='signature private'>
    .<strong>set_max_timer_count</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_set_max_timer_count</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L991-L995'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='991' data-end='995'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 991</span></pre>
<pre class='code cpp'>

static VALUE t_set_max_timer_count (VALUE self UNUSED, VALUE ct)
{
	evma_set_max_timer_count (FIX2INT (ct));
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_max_timers-class_method">
  <h3 class='signature '>
    .<strong>set_max_timers</strong>(ct)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>This method has to be used <em>before</em> event loop is started.</p>
</div>
  </div>

<p>Sets the maximum number of timers and periodic timers that may be outstanding at any
given time. You only need to call <code>.set_max_timers</code> if you need more than the default
number of timers, which on most platforms is 1000.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>ct</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Maximum number of timers that may be outstanding at any given time</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#add_timer-class_method" title="EventMachine.add_timer (method)">.add_timer</a></li>
          <li><a href="#add_periodic_timer-class_method" title="EventMachine.add_periodic_timer (method)">.add_periodic_timer</a></li>
          <li><a href="EventMachine/Timer.html" title="EventMachine::Timer (class)"><code>Timer</code></a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L918-L920'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='918' data-end='920'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 918</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_set_max_timers'>set_max_timers</span> <span class='id identifier rubyid_ct'>ct</span>
  <span class='id identifier rubyid_set_max_timer_count'><a href="#set_max_timer_count-class_method" title="EventMachine.set_max_timer_count (method)">set_max_timer_count</a></span> <span class='id identifier rubyid_ct'>ct</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_pending_connect_timeout-class_method">
  <h3 class='signature private'>
    .<strong>set_pending_connect_timeout</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_set_pending_connect_timeout</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L656-L663'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='656' data-end='663'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 656</span></pre>
<pre class='code cpp'>

static VALUE t_set_pending_connect_timeout (VALUE self UNUSED, VALUE signature, VALUE timeout)
{
	float ti = RFLOAT_VALUE(timeout);
	if (evma_set_pending_connect_timeout(NUM2BSIG(signature), ti)) {
		return Qtrue;
	}
	return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_quantum-class_method">
  <h3 class='signature '>
    .<strong>set_quantum</strong>(mills)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>For advanced users. This function sets the default timer granularity, which by default is
slightly smaller than 100 milliseconds. Call this function to set a higher or lower granularity.
The function affects the behavior of <a href="#add_timer-class_method" title="EventMachine.add_timer (method)">.add_timer</a> and <a href="#add_periodic_timer-class_method" title="EventMachine.add_periodic_timer (method)">.add_periodic_timer</a>.
Most applications will not need to call this function.</p>

<p>Avoid setting the quantum to very low values because that may reduce performance under some extreme conditions.
We recommend that you not use values lower than 10.</p>

<p>This method only can be used if event loop is running.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>mills</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>New timer granularity, in milliseconds</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#add_timer-class_method" title="EventMachine.add_timer (method)">.add_timer</a></li>
          <li><a href="#add_periodic_timer-class_method" title="EventMachine.add_periodic_timer (method)">.add_periodic_timer</a></li>
          <li><a href="EventMachine/Timer.html" title="EventMachine::Timer (class)"><code>Timer</code></a></li>
          <li><a href="#run-class_method" title="EventMachine.run (method)">.run</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L903-L905'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='903' data-end='905'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 903</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_set_quantum'>set_quantum</span> <span class='id identifier rubyid_mills'>mills</span>
  <span class='id identifier rubyid_set_timer_quantum'><a href="#set_timer_quantum-class_method" title="EventMachine.set_timer_quantum (method)">set_timer_quantum</a></span> <span class='id identifier rubyid_mills'>mills</span>.<span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_rlimit_nofile-class_method">
  <h3 class='signature private'>
    .<strong>set_rlimit_nofile</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_set_rlimit_nofile</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1284-L1288'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1284' data-end='1288'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1284</span></pre>
<pre class='code cpp'>

static VALUE t_set_rlimit_nofile (VALUE self UNUSED, VALUE arg)
{
	int arg_int = (NIL_P(arg)) ? -1 : NUM2INT (arg);
	return INT2NUM (evma_set_rlimit_nofile (arg_int));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_simultaneous_accept_count-class_method">
  <h3 class='signature private'>
    .<strong>set_simultaneous_accept_count</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1006-L1010'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1006' data-end='1010'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1006</span></pre>
<pre class='code cpp'>

static VALUE t_set_simultaneous_accept_count (VALUE self UNUSED, VALUE ct)
{
	evma_set_simultaneous_accept_count (FIX2INT (ct));
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_timer_quantum-class_method">
  <h3 class='signature private'>
    .<strong>set_timer_quantum</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_set_timer_quantum</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L972-L976'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='972' data-end='976'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 972</span></pre>
<pre class='code cpp'>

static VALUE t_set_timer_quantum (VALUE self UNUSED, VALUE interval)
{
	evma_set_timer_quantum (FIX2INT (interval));
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_tls_parms-class_method">
  <h3 class='signature private'>
    .<strong>set_tls_parms</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_set_tls_parms</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L377-L386'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='377' data-end='386'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 377</span></pre>
<pre class='code cpp'>

static VALUE t_set_tls_parms (VALUE self UNUSED, VALUE signature, VALUE privkeyfile, VALUE privkey, VALUE privkeypass, VALUE certchainfile, VALUE cert, VALUE verify_peer, VALUE fail_if_no_peer_cert, VALUE snihostname, VALUE cipherlist, VALUE ecdh_curve, VALUE dhparam, VALUE ssl_version)
{
	/* set_tls_parms takes a series of positional arguments for specifying such things
	 * as private keys and certificate chains.
	 * It&#39;s expected that the parameter list will grow as we add more supported features.
	 * ALL of these parameters are optional, and can be specified as empty or NULL strings.
	 */
	evma_set_tls_parms (NUM2BSIG (signature), StringValueCStr (privkeyfile), StringValueCStr (privkey), StringValueCStr (privkeypass), StringValueCStr (certchainfile), StringValueCStr (cert), (verify_peer == Qtrue ? 1 : 0), (fail_if_no_peer_cert == Qtrue ? 1 : 0), StringValueCStr (snihostname), StringValueCStr (cipherlist), StringValueCStr (ecdh_curve), StringValueCStr (dhparam), NUM2INT (ssl_version));
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="setuid_string-class_method">
  <h3 class='signature private'>
    .<strong>setuid_string</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_setuid_string</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1016-L1020'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1016' data-end='1020'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1016</span></pre>
<pre class='code cpp'>

static VALUE t_setuid_string (VALUE self UNUSED, VALUE username)
{
	evma_setuid_string (StringValueCStr (username));
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="signal_loopbreak-class_method">
  <h3 class='signature private'>
    .<strong>signal_loopbreak</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_signal_loopbreak</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L951-L955'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='951' data-end='955'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 951</span></pre>
<pre class='code cpp'>

static VALUE t_signal_loopbreak (VALUE self UNUSED)
{
	evma_signal_loopbreak();
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="spawn-class_method">
  <h3 class='signature '>
    .<strong>spawn</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Spawn an erlang-style process</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/spawnable.rb#L69-L73'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='69' data-end='73'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/spawnable.rb', line 69</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_spawn'>spawn</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'><a href="EventMachine/SpawnedProcess.html" title="EventMachine::SpawnedProcess (class)">SpawnedProcess</a></span>.<span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_set_receiver'>set_receiver</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_s'>s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="spawn_threadpool-class_method">
  <h3 class='signature nodoc'>
    .<strong>spawn_threadpool</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1066-L1090'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1066' data-end='1090'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1066</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_spawn_threadpool'>spawn_threadpool</span>
  <span class='kw'>until</span> <span class='ivar'>@threadpool</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='ivar'>@threadpool_size</span>.<span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_thread'>thread</span> <span class='op'>=</span> <span class='const'>Thread</span>.<span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span>
      <span class='const'>Thread</span>.<span class='id identifier rubyid_current'>current</span>.<span class='id identifier rubyid_abort_on_exception'>abort_on_exception</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>while</span> <span class='kw'>true</span>
        <span class='kw'>begin</span>
          <span class='id identifier rubyid_op'>op</span><span class='comma'>,</span> <span class='id identifier rubyid_cback'>cback</span><span class='comma'>,</span> <span class='id identifier rubyid_eback'>eback</span> <span class='op'>=</span> <span class='op'>*</span><span class='ivar'>@threadqueue</span>.<span class='id identifier rubyid_pop'>pop</span>
        <span class='kw'>rescue</span> <span class='const'>ThreadError</span>
          <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='gvar'>$!</span>.<span class='id identifier rubyid_message'>message</span>
          <span class='kw'>break</span> <span class='comment'># Ruby 2.0 may fail at Queue.pop
</span>        <span class='kw'>end</span>
        <span class='kw'>begin</span>
          <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_op'>op</span>.<span class='id identifier rubyid_call'>call</span>
          <span class='ivar'>@resultqueue</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_cback'>cback</span>]
        <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_error'>error</span> <span class='kw'>unless</span> <span class='id identifier rubyid_eback'>eback</span>
          <span class='ivar'>@resultqueue</span> <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_error'>error</span><span class='comma'>,</span> <span class='id identifier rubyid_eback'>eback</span>]
        <span class='kw'>end</span>
        <span class='id identifier rubyid_signal_loopbreak'><a href="#signal_loopbreak-class_method" title="EventMachine.signal_loopbreak (method)">signal_loopbreak</a></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='ivar'>@threadpool</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_thread'>thread</span>
  <span class='kw'>end</span>
  <span class='ivar'>@all_threads_spawned</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_server-class_method">
  <h3 class='signature '>
    .<strong>start_server</strong>(server, port = nil, handler = nil, *args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Don&#39;t forget that in order to bind to ports &lt; 1024 on Linux, *BSD and Mac OS X your process must have superuser privileges.</p>
</div>
  </div>

<p>Initiates a TCP server (socket acceptor) on the specified IP address and port.</p>

<p>The IP address must be valid on the machine where the program
runs, and the process must be privileged enough to listen
on the specified port (on Unix-like systems, superuser privileges
are usually required to listen on any port lower than 1024).
Only one listener may be running on any given address/port
combination. start_server will fail if the given address and port
are already listening on the machine, either because of a prior call
to <code>.start_server</code> or some unrelated process running on the machine.
If <code>.start_server</code> succeeds, the new network listener becomes active
immediately and starts accepting connections from remote peers,
and these connections generate callback events that are processed
by the code specified in the handler parameter to <code>.start_server</code>.</p>

<p>The optional handler which is passed to this method is the key
to EventMachine&#39;s ability to handle particular network protocols.
The handler parameter passed to start_server must be a Ruby Module
that you must define. When the network server that is started by
start_server accepts a new connection, it instantiates a new
object of an anonymous class that is inherited from <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>,
<em>into which your handler module have been included</em>. Arguments passed into start_server
after the class name are passed into the constructor during the instantiation.</p>

<p>Your handler module may override any of the methods in <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>,
such as <a href="EventMachine/Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">Connection#receive_data</a>, in order to implement the specific behavior
of the network protocol.</p>

<p>Callbacks invoked in response to network events <em>always</em> take place
within the execution context of the object derived from <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>
extended by your handler module. There is one object per connection, and
all of the callbacks invoked for a particular connection take the form
of instance methods called against the corresponding <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>
object. Therefore, you are free to define whatever instance variables you
wish, in order to contain the per-connection state required by the network protocol you are
implementing.</p>

<p><code>start_server</code> is usually called inside the block passed to <a href="#run-class_method" title="EventMachine.run (method)">.run</a>,
but it can be called from any <code>EventMachine</code> callback. <code>start_server</code> will fail
unless the <code>EventMachine</code> event loop is currently running (which is why
it&#39;s often called in the block suppled to <a href="#run-class_method" title="EventMachine.run (method)">.run</a>).</p>

<p>You may call start_server any number of times to start up network
listeners on different address/port combinations. The servers will
all run simultaneously. More interestingly, each individual call to start_server
can specify a different handler module and thus implement a different
network protocol from all the others.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>eventmachine</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Here is an example of a server that counts lines of input from the remote
</span><span class='comment'># peer and sends back the total number of lines received, after each line.
</span><span class='comment'># Try the example with more than one client connection opened via telnet,
</span><span class='comment'># and you will see that the line count increments independently on each
</span><span class='comment'># of the client connections. Also very important to note, is that the
</span><span class='comment'># handler for the receive_data function, which our handler redefines, may
</span><span class='comment'># not assume that the data it receives observes any kind of message boundaries.
</span><span class='comment'># Also, to use this example, be sure to change the server and port parameters
</span><span class='comment'># to the start_server call to values appropriate for your environment.
</span><span class='kw'>module</span> <span class='const'>LineCounter</span>
  <span class='const'>MaxLinesPerConnection</span> <span class='op'>=</span> <span class='int'>10</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'>post_init</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Received a new connection</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@data_received</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@line_count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'>receive_data</span> <span class='id identifier rubyid_data'>data</span>
    <span class='ivar'>@data_received</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_data'>data</span>
    <span class='kw'>while</span> <span class='ivar'>@data_received</span>.<span class='id identifier rubyid_slice!'>slice!</span>( <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[^\n]*[\n]</span><span class='regexp_end'>/m</span></span> )
      <span class='ivar'>@line_count</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_send_data'><a href="#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>received </span><span class='embexpr_beg'>#{</span><span class='ivar'>@line_count</span><span class='embexpr_end'>}</span><span class='tstring_content'> lines so far\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@line_count</span> <span class='op'>==</span> <span class='const'>MaxLinesPerConnection</span> <span class='kw'>and</span> <span class='id identifier rubyid_close_connection_after_writing'>close_connection_after_writing</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>192.168.0.100</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>8090</span>
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_start_server'>start_server</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='const'>LineCounter</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Now accepting connections on address </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>, port </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_add_periodic_timer'><a href="#add_periodic_timer-class_method" title="EventMachine.add_periodic_timer (method)">add_periodic_timer</a></span>(<span class='int'>10</span>) { <span class='gvar'>$stderr</span>.<span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span> }
}</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>server</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Host to bind to.</p>
</div>
  </li>
  <li>
    <span class='name'>port</span>
    <span class='type'>(<code>Integer</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>Port to bind to.</p>
</div>
  </li>
  <li>
    <span class='name'>handler</span>
    <span class='type'>(<code>Module</code>, <code>Class</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>A module or class that implements connection callbacks</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="file.GettingStarted.html" title="EventMachine tutorial">EventMachine tutorial</a></li>
          <li><a href="#stop_server-class_method" title="EventMachine.stop_server (method)">.stop_server</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L518-L538'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='518' data-end='538'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 518</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_start_server'>start_server</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_port'>port</span>)
  <span class='kw'>rescue</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='const'>TypeError</span>
    <span class='comment'># there was no port, so server must be a unix domain socket
</span>    <span class='comment'># the port argument is actually the handler, and the handler is one of the args
</span>    <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_unshift'>unshift</span> <span class='id identifier rubyid_handler'>handler</span> <span class='kw'>if</span> <span class='id identifier rubyid_handler'>handler</span>
    <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='id identifier rubyid_port'>port</span>
    <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span>

  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/Connection.html" title="EventMachine::Connection (class)">Connection</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span>
        <span class='id identifier rubyid_start_tcp_server'><a href="#start_tcp_server-class_method" title="EventMachine.start_tcp_server (method)">start_tcp_server</a></span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_start_unix_server'><a href="#start_unix_server-class_method" title="EventMachine.start_unix_server (method)">start_unix_server</a></span> <span class='id identifier rubyid_server'>server</span>
      <span class='kw'>end</span>
  <span class='ivar'>@acceptors</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> [<span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span><span class='id identifier rubyid_block'>block</span>]
  <span class='id identifier rubyid_s'>s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_tcp_server-class_method">
  <h3 class='signature private'>
    .<strong>start_tcp_server</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_start_server</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L304-L310'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='304' data-end='310'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 304</span></pre>
<pre class='code cpp'>

static VALUE t_start_server (VALUE self UNUSED, VALUE server, VALUE port)
{
	const uintptr_t f = evma_create_tcp_server (StringValueCStr(server), FIX2INT(port));
	if (!f)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;no acceptor (port is in use or requires root privileges)&quot;);
	return BSIG2NUM (f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_tls-class_method">
  <h3 class='signature private'>
    .<strong>start_tls</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_start_tls</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L363-L371'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='363' data-end='371'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 363</span></pre>
<pre class='code cpp'>

static VALUE t_start_tls (VALUE self UNUSED, VALUE signature)
{
	try {
		evma_start_tls (NUM2BSIG (signature));
	} catch (const std::runtime_error&amp; e) {
		rb_raise (EM_eInvalidPrivateKey, e.what(), signature);
	}
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_unix_domain_server-class_method">
  <h3 class='signature '>
    .<strong>start_unix_domain_server</strong>(filename, *args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Start a Unix-domain server.</p>

<p>Note that this is an alias for <a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a>, which can be used to start both
TCP and Unix-domain servers.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L562-L564'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='562' data-end='564'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 562</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_start_unix_domain_server'>start_unix_domain_server</span> <span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_start_server'><a href="#start_server-class_method" title="EventMachine.start_server (method)">start_server</a></span> <span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_unix_server-class_method">
  <h3 class='signature private'>
    .<strong>start_unix_server</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_start_unix_server</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L327-L333'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='327' data-end='333'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 327</span></pre>
<pre class='code cpp'>

static VALUE t_start_unix_server (VALUE self UNUSED, VALUE filename)
{
	const uintptr_t f = evma_create_unix_domain_server (StringValueCStr(filename));
	if (!f)
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, &quot;no unix-domain acceptor&quot;);
	return BSIG2NUM (f);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stop-class_method">
  <h3 class='signature private'>
    .<strong>stop</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_stop</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L941-L945'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='941' data-end='945'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 941</span></pre>
<pre class='code cpp'>

static VALUE t_stop (VALUE self UNUSED)
{
	evma_stop_machine();
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stop_event_loop-class_method">
  <h3 class='signature '>
    .<strong>stop_event_loop</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Causes the processing loop to stop executing, which will cause all open connections and accepting servers
to be run down and closed. <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> termination callbacks added using <a href="#add_shutdown_hook-class_method" title="EventMachine.add_shutdown_hook (method)">.add_shutdown_hook</a>
will be called as part of running this method.</p>

<p>When all of this processing is complete, the call to <a href="#run-class_method" title="EventMachine.run (method)">.run</a> which started the processing loop
will return and program flow will resume from the statement following <a href="#run-class_method" title="EventMachine.run (method)">.run</a> call.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Stopping a running <code>EventMachine</code> event loop</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>eventmachine</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>module</span> <span class='const'>Redmond</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'>post_init</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>We&#39;re sending a dumb HTTP request to the remote peer.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_send_data'><a href="#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.1\r\nHost: www.microsoft.com\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'>receive_data</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>We received </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes from the remote peer.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>We&#39;re going to stop the event loop now.</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_stop_event_loop'>stop_event_loop</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A connection has terminated.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>We&#39;re starting the event loop now.</span><span class='tstring_end'>&quot;</span></span>
<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_connect'><a href="#connect-class_method" title="EventMachine.connect (method)">connect</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.microsoft.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='const'>Redmond</span>
}
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The event loop has stopped.</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># This program will produce approximately the following output:
</span><span class='comment'>#
</span><span class='comment'># We&#39;re starting the event loop now.
</span><span class='comment'># We&#39;re sending a dumb HTTP request to the remote peer.
</span><span class='comment'># We received 1440 bytes from the remote peer.
</span><span class='comment'># We&#39;re going to stop the event loop now.
</span><span class='comment'># A connection has terminated.
</span><span class='comment'># The event loop has stopped.</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L418-L420'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='418' data-end='420'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 418</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_stop_event_loop'>stop_event_loop</span>
  <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_stop'><a href="#stop-class_method" title="EventMachine.stop (method)">stop</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stop_server-class_method">
  <h3 class='signature '>
    .<strong>stop_server</strong>(signature)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Stop a TCP server socket that was started with <a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a>.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#start_server-class_method" title="EventMachine.start_server (method)">.start_server</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L552-L554'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='552' data-end='554'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 552</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_stop_server'>stop_server</span> <span class='id identifier rubyid_signature'>signature</span>
  <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_stop_tcp_server'><a href="#stop_tcp_server-class_method" title="EventMachine.stop_tcp_server (method)">stop_tcp_server</a></span> <span class='id identifier rubyid_signature'>signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stop_tcp_server-class_method">
  <h3 class='signature private'>
    .<strong>stop_tcp_server</strong>   <span class="extras">(<span class='mod_func'>mod_func</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_stop_server</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L316-L320'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='316' data-end='320'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 316</span></pre>
<pre class='code cpp'>

static VALUE t_stop_server (VALUE self UNUSED, VALUE signature)
{
	evma_stop_tcp_server (NUM2BSIG (signature));
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="system-class_method">
  <h3 class='signature '>
    .<strong>system</strong>(cmd, *args, &amp;cb)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>EM::system is a simple wrapper for EM::popen. It is similar to Kernel::system, but requires a
single string argument for the command and performs no shell expansion.</p>

<p>The block or proc passed to EM::system is called with two arguments: the output generated by the command,
and a Process::Status that contains information about the command&#39;s execution.</p>

<p>EM.run{
   EM.system(&#39;ls&#39;){ |output,status| puts output if status.exitstatus == 0 }
 }</p>

<p>You can also supply an additional proc to send some data to the process:</p>

<p>EM.run{
   EM.system(&#39;sh&#39;, proc{ |process|
     process.send_data(&quot;echo hello\n&quot;)
     process.send_data(&quot;exit\n&quot;)
   }, proc{ |out,status|
     puts(out)
   })
 }</p>

<p>Like EventMachine.popen, <code>EventMachine</code>.system currently does not work on windows.
It returns the pid of the spawned process.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/processes.rb#L112-L122'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='112' data-end='122'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/processes.rb', line 112</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_system'>system</span> <span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_cb'>cb</span>
  <span class='id identifier rubyid_cb'>cb</span> <span class='op'>||=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_pop'>pop</span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Proc</span>
  <span class='id identifier rubyid_init'>init</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_pop'>pop</span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Proc</span>

  <span class='comment'># merge remaining arguments into the command
</span>  <span class='id identifier rubyid_cmd'>cmd</span> <span class='op'>=</span> [<span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>] <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_any?'>any?</span>

  <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span>.<span class='id identifier rubyid_get_subprocess_pid'><a href="#get_subprocess_pid-class_method" title="EventMachine.get_subprocess_pid (method)">get_subprocess_pid</a></span>(<span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span>.<span class='id identifier rubyid_popen'><a href="#popen-class_method" title="EventMachine.popen (method)">popen</a></span>(<span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='const'><a href="EventMachine/SystemCmd.html" title="EventMachine::SystemCmd (class)">SystemCmd</a></span><span class='comma'>,</span> <span class='id identifier rubyid_cb'>cb</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
    <span class='id identifier rubyid_init'>init</span>[<span class='id identifier rubyid_c'>c</span>] <span class='kw'>if</span> <span class='id identifier rubyid_init'>init</span>
  <span class='kw'>end</span>.<span class='id identifier rubyid_signature'>signature</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="tick_loop-class_method">
  <h3 class='signature '>
    .<strong>tick_loop</strong>(*a, &amp;b)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Creates and immediately starts an <a href="EventMachine/TickLoop.html" title="EventMachine::TickLoop (class)"><code>TickLoop</code></a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/tick_loop.rb#L3-L5'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='3' data-end='5'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/tick_loop.rb', line 3</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_tick_loop'>tick_loop</span>(<span class='op'>*</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>)
  <span class='const'><a href="EventMachine/TickLoop.html" title="EventMachine::TickLoop (class)">TickLoop</a></span>.<span class='id identifier rubyid_new'><a href="EventMachine/TickLoop.html#new-class_method" title="EventMachine::TickLoop.new (method)">new</a></span>(<span class='op'>*</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>).<span class='id identifier rubyid_start'><a href="EventMachine/TickLoop.html#start-instance_method" title="EventMachine::TickLoop#start (method)">start</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="watch-class_method">
  <h3 class='signature '>
    .<strong>watch</strong>(io, handler = nil, *args, &amp;blk)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p><code>watch</code> registers a given file descriptor or IO object with the eventloop. The
file descriptor will not be modified (it will remain blocking or non-blocking).</p>

<p>The eventloop can be used to process readable and writable events on the file descriptor, using
<a href="EventMachine/Connection.html#notify_readable=-instance_method" title="EventMachine::Connection#notify_readable= (method)">Connection#notify_readable=</a> and <a href="EventMachine/Connection.html#notify_writable=-instance_method" title="EventMachine::Connection#notify_writable= (method)">Connection#notify_writable=</a></p>

<p><a href="EventMachine/Connection.html#notify_readable%3F-instance_method" title="EventMachine::Connection#notify_readable? (method)">Connection#notify_readable?</a> and <a href="EventMachine/Connection.html#notify_writable%3F-instance_method" title="EventMachine::Connection#notify_writable? (method)">Connection#notify_writable?</a> can be used
to check what events are enabled on the connection.</p>

<p>To detach the file descriptor, use <a href="EventMachine/Connection.html#detach-instance_method" title="EventMachine::Connection#detach (method)">Connection#detach</a></p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='kw'>module</span> <span class='const'>SimpleHttpClient</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_notify_readable'>notify_readable</span>
    <span class='id identifier rubyid_header'>header</span> <span class='op'>=</span> <span class='ivar'>@io</span>.<span class='id identifier rubyid_readline'>readline</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_header'>header</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='comment'># detach returns the file descriptor number (fd == @io.fileno)
</span>      <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='id identifier rubyid_detach'>detach</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>EOFError</span>
    <span class='id identifier rubyid_detach'>detach</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
    <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span>.<span class='id identifier rubyid_next_tick'><a href="#next_tick-class_method" title="EventMachine.next_tick (method)">next_tick</a></span> <span class='kw'>do</span>
      <span class='comment'># socket is detached from the eventloop, but still open
</span>      <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='ivar'>@io</span>.<span class='id identifier rubyid_read'>read</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'>TCPSocket</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>site.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>80</span>)
  <span class='id identifier rubyid_sock'>sock</span>.<span class='id identifier rubyid_write'>write</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>)
  <span class='id identifier rubyid_conn'>conn</span> <span class='op'>=</span> <span class='const'>EventMachine</span>.<span class='id identifier rubyid_watch'>watch</span>(<span class='id identifier rubyid_sock'>sock</span><span class='comma'>,</span> <span class='const'>SimpleHttpClient</span>)
  <span class='id identifier rubyid_conn'>conn</span>.<span class='id identifier rubyid_notify_readable'>notify_readable</span> <span class='op'>=</span> <span class='kw'>true</span>
}</code></pre>
  </div>
<p class='tag_title'>Author:</p>
<ul class='author'>
  <li>
    <div class='inline'><p>Riham Aldakkak (eSpace Technologies)</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L732-L734'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='732' data-end='734'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 732</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='const'>EventMachine</span><span class='op'>::</span><span class='id identifier rubyid_watch'>watch</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
  <span class='id identifier rubyid_attach_io'><a href="#attach_io-class_method" title="EventMachine.attach_io (method)">attach_io</a></span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="watch_file-class_method">
  <h3 class='signature '>
    .<strong>watch_file</strong>(filename, handler = nil, *args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>The ability to pick up on the new filename after a rename is not yet supported.
Calling #path will always return the filename you originally used.</p>
</div>
  </div>

<p>EventMachine&#39;s file monitoring API. Currently supported are the following events
on individual files, using inotify on Linux systems, and kqueue for *BSD and Mac OS X:</p>

<ul>
<li>File modified (written to)</li>
<li>File moved/renamed</li>
<li>File deleted</li>
</ul>

<p>EventMachine::watch_file takes a filename and a handler Module containing your custom callback methods.
This will setup the low level monitoring on the specified file, and create a new <a href="EventMachine/FileWatch.html" title="EventMachine::FileWatch (class)"><code>FileWatch</code></a>
object with your Module mixed in. <a href="EventMachine/FileWatch.html" title="EventMachine::FileWatch (class)"><code>FileWatch</code></a> is a subclass of <a href="EventMachine/Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>, so callbacks on this object
work in the familiar way. The callbacks that will be fired by <code>EventMachine</code> are:</p>

<ul>
<li>file_modified</li>
<li>file_moved</li>
<li>file_deleted</li>
</ul>

<p>You can access the filename being monitored from within this object using <a href="EventMachine/FileWatch.html#path-instance_method" title="EventMachine::FileWatch#path (method)">FileWatch#path</a>.</p>

<p>When a file is deleted, <a href="EventMachine/FileWatch.html#stop_watching-instance_method" title="EventMachine::FileWatch#stop_watching (method)">FileWatch#stop_watching</a> will be called after your file_deleted callback,
to clean up the underlying monitoring and remove EventMachine&#39;s reference to the now-useless <a href="EventMachine/FileWatch.html" title="EventMachine::FileWatch (class)"><code>FileWatch</code></a> instance.
This will in turn call unbind, if you wish to use it.</p>

<p>The corresponding system-level Errno will be raised when attempting to monitor non-existent files,
files with wrong permissions, or if an error occurs dealing with inotify/kqueue.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='comment'># Before running this example, make sure we have a file to monitor:
</span><span class='comment'># $ echo &quot;bar&quot; &gt; /tmp/foo
</span>
<span class='kw'>module</span> <span class='const'>Handler</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_file_modified'>file_modified</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> modified</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_file_moved'>file_moved</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> moved</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_file_deleted'>file_deleted</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> deleted</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> monitoring ceased</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># for efficient file watching, use kqueue on Mac OS X
</span><span class='const'>EventMachine</span>.<span class='id identifier rubyid_kqueue'><a href="#kqueue-class_method" title="EventMachine.kqueue (method)">kqueue</a></span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='const'>EventMachine</span>.<span class='id identifier rubyid_kqueue?'><a href="#kqueue%3F-class_method" title="EventMachine.kqueue? (method)">kqueue?</a></span>

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_watch_file'>watch_file</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>Handler</span>)
}

<span class='comment'># $ echo &quot;baz&quot; &gt;&gt; /tmp/foo    =&gt;    &quot;/tmp/foo modified&quot;
</span><span class='comment'># $ mv /tmp/foo /tmp/oof      =&gt;    &quot;/tmp/foo moved&quot;
</span><span class='comment'># $ rm /tmp/oof               =&gt;    &quot;/tmp/foo deleted&quot;</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filename</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Local path to the file to watch.</p>
</div>
  </li>
  <li>
    <span class='name'>handler</span>
    <span class='type'>(<code>Class</code>, <code>Module</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>A class or module that implements event handlers associated with the file.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1310-L1320'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1310' data-end='1320'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1310</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_watch_file'>watch_file</span>(<span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/FileWatch.html" title="EventMachine::FileWatch (class)">FileWatch</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='id identifier rubyid_watch_filename'>watch_filename</span>(<span class='id identifier rubyid_filename'>filename</span>)
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='comment'># we have to set the path like this because of how Connection.new works
</span>  <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@path</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_filename'>filename</span>)
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="watch_process-class_method">
  <h3 class='signature '>
    .<strong>watch_process</strong>(pid, handler = nil, *args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>EventMachine&#39;s process monitoring API. On Mac OS X and *BSD this method is implemented using kqueue.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='kw'>module</span> <span class='const'>ProcessWatcher</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_process_exited'>process_exited</span>
    <span class='id identifier rubyid_put'>put</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>the forked child died!</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='id identifier rubyid_fork'>fork</span>{ <span class='id identifier rubyid_sleep'>sleep</span> }

<span class='const'>EventMachine</span>.<span class='id identifier rubyid_run'><a href="#run-class_method" title="EventMachine.run (method)">run</a></span> {
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_watch_process'>watch_process</span>(<span class='id identifier rubyid_pid'>pid</span><span class='comma'>,</span> <span class='const'>ProcessWatcher</span>)
  <span class='const'>EventMachine</span>.<span class='id identifier rubyid_add_timer'><a href="#add_timer-class_method" title="EventMachine.add_timer (method)">add_timer</a></span>(<span class='int'>1</span>){ <span class='const'>Process</span>.<span class='id identifier rubyid_kill'>kill</span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TERM</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pid'>pid</span>) }
}</code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>pid</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>PID of the process to watch.</p>
</div>
  </li>
  <li>
    <span class='name'>handler</span>
    <span class='type'>(<code>Class</code>, <code>Module</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'><p>A class or module that implements event handlers associated with the file.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/eventmachine.rb#L1341-L1353'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1341' data-end='1353'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/eventmachine.rb', line 1341</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_watch_process'>watch_process</span>(<span class='id identifier rubyid_pid'>pid</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='id identifier rubyid_pid'>pid</span>.<span class='id identifier rubyid_to_i'>to_i</span>

  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_klass_from_handler'><a href="#klass_from_handler-class_method" title="EventMachine.klass_from_handler (method)">klass_from_handler</a></span>(<span class='const'><a href="EventMachine/ProcessWatch.html" title="EventMachine::ProcessWatch (class)">ProcessWatch</a></span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'><a href="top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span><span class='op'>::</span><span class='id identifier rubyid_watch_pid'>watch_pid</span>(<span class='id identifier rubyid_pid'>pid</span>)
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span>.<span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='comment'># we have to set the path like this because of how Connection.new works
</span>  <span class='id identifier rubyid_c'>c</span>.<span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@pid</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pid'>pid</span>)
  <span class='ivar'>@conns</span>[<span class='id identifier rubyid_s'>s</span>] <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>and</span> <span class='kw'>yield</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="yield-class_method">
  <h3 class='signature nodoc'>
    .<strong>yield</strong>(&amp;block)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/spawnable.rb#L76-L78'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='76' data-end='78'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/spawnable.rb', line 76</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='kw'>yield</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>return</span> <span class='const'><a href="EventMachine/YieldBlockFromSpawnedProcess.html" title="EventMachine::YieldBlockFromSpawnedProcess (class)">YieldBlockFromSpawnedProcess</a></span>.<span class='id identifier rubyid_new'><a href="EventMachine/YieldBlockFromSpawnedProcess.html#new-class_method" title="EventMachine::YieldBlockFromSpawnedProcess.new (method)">new</a></span>( <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='kw'>false</span> )
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="yield_and_notify-class_method">
  <h3 class='signature nodoc'>
    .<strong>yield_and_notify</strong>(&amp;block)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/spawnable.rb#L81-L83'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='81' data-end='83'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/spawnable.rb', line 81</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_yield_and_notify'>yield_and_notify</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>return</span> <span class='const'><a href="EventMachine/YieldBlockFromSpawnedProcess.html" title="EventMachine::YieldBlockFromSpawnedProcess (class)">YieldBlockFromSpawnedProcess</a></span>.<span class='id identifier rubyid_new'><a href="EventMachine/YieldBlockFromSpawnedProcess.html#new-class_method" title="EventMachine::YieldBlockFromSpawnedProcess.new (method)">new</a></span>( <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='kw'>true</span> )
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>