<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: EventMachine::Connection &mdash; EventMachine master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "EventMachine::Connection",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>EventMachine master</a> &raquo; 
      <a href='../_index.html#alpha_C'>Index (C)</a> &raquo; 
        <a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Connection&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: EventMachine::Connection</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Subclasses:</div>
        <div class='box_22'>
          <a href="DeferrableChildProcess.html" title="EventMachine::DeferrableChildProcess (class)">DeferrableChildProcess</a>, <a href="FileWatch.html" title="EventMachine::FileWatch (class)">FileWatch</a>, <a href="ProcessWatch.html" title="EventMachine::ProcessWatch (class)">ProcessWatch</a>, <a class='nodoc' href="SystemCmd.html" title="EventMachine::SystemCmd (class)">SystemCmd</a>, <a href="DNS/Socket.html" title="EventMachine::DNS::Socket (class)">DNS::Socket</a>, <a href="Protocols/HeaderAndContentProtocol.html" title="EventMachine::Protocols::HeaderAndContentProtocol (class)">Protocols::HeaderAndContentProtocol</a>, <a href="Protocols/HttpClient.html" title="EventMachine::Protocols::HttpClient (class)">Protocols::HttpClient</a>, <a href="Protocols/HttpClient2.html" title="EventMachine::Protocols::HttpClient2 (class)">Protocols::HttpClient2</a>, <a href="Protocols/LineAndTextProtocol.html" title="EventMachine::Protocols::LineAndTextProtocol (class)">Protocols::LineAndTextProtocol</a>, <a href="Protocols/Postgres3.html" title="EventMachine::Protocols::Postgres3 (class)">Protocols::Postgres3</a>, <a href="Protocols/SmtpClient.html" title="EventMachine::Protocols::SmtpClient (class)">Protocols::SmtpClient</a>, <a href="Protocols/SmtpServer.html" title="EventMachine::Protocols::SmtpServer (class)">Protocols::SmtpServer</a>, <a href="Protocols/Socks4.html" title="EventMachine::Protocols::Socks4 (class)">Protocols::Socks4</a>, <a class='nodoc' href="Protocols/TcpConnectTester.html" title="EventMachine::Protocols::TcpConnectTester (class)">Protocols::TcpConnectTester</a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L39'>lib/em/connection.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1493'>ext/rubymain.cpp</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    <p><code>Connection</code> is a class that is instantiated
by EventMachine&#39;s processing loop whenever a new connection
is created. (New connections can be either initiated locally
to a remote server or accepted locally from a remote client.)
When a <code>Connection</code> object is instantiated, it <i>mixes in</i>
the functionality contained in the user-defined module
specified in calls to <a href="../EventMachine.html#connect-class_method" title="EventMachine.connect (method)">connect</a> or <a href="../EventMachine.html#start_server-class_method" title="EventMachine.start_server (method)">start_server</a>.
User-defined handler modules may redefine any or all of the standard
methods defined here, as well as add arbitrary additional code
that will also be mixed in.</p>

<p><a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> manages one object inherited from <code>Connection</code>
(and containing the mixed-in user code) for every network connection
that is active at any given time.
The event loop will automatically call methods on <code>Connection</code>
objects whenever specific events occur on the corresponding connections,
as described below.</p>

<p>This class is never instantiated by user code, and does not publish an
initialize method. The instance methods of <code>Connection</code>
which may be called by the event loop are:</p>

<ul>
<li><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a></li>
<li><a href="#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a></li>
<li><a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a></li>
<li><a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a></li>
<li><a href="#ssl_verify_peer-instance_method" title="EventMachine::Connection#ssl_verify_peer (method)">#ssl_verify_peer</a> (if TLS is used)</li>
<li><a href="#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">#ssl_handshake_completed</a></li>
</ul>

<p>All of the other instance methods defined here are called  only by user code.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="../file.GettingStarted.html" title="EventMachine tutorial">EventMachine tutorial</a></li>
      </ul>

</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(sig, *args)  &#x21d2; Connection </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Override .new so subclasses don&#39;t have to call super and can ignore connection-specific arguments.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#comm_inactivity_timeout-instance_method" title="#comm_inactivity_timeout (instance method)">#<strong>comm_inactivity_timeout</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>comm_inactivity_timeout returns the current value (float in seconds) of the inactivity-timeout property of network-connection and datagram-socket objects.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#comm_inactivity_timeout=-instance_method" title="#comm_inactivity_timeout= (instance method)">#<strong>comm_inactivity_timeout=</strong>(value)  </a>
      (also: #set_comm_inactivity_timeout)
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows you to set the inactivity-timeout property for a network connection or datagram socket.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#error%3F-instance_method" title="#error? (instance method)">#<strong>error?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true if the connection is in an error state, false otherwise.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#notify_readable=-instance_method" title="#notify_readable= (instance method)">#<strong>notify_readable=</strong>(mode)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Watches connection for readability.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#notify_readable%3F-instance_method" title="#notify_readable? (instance method)">#<strong>notify_readable?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#notify_writable=-instance_method" title="#notify_writable= (instance method)">#<strong>notify_writable=</strong>(mode)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Watches connection for writeability.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#notify_writable%3F-instance_method" title="#notify_writable? (instance method)">#<strong>notify_writable?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true if the connection is being watched for writability.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#paused%3F-instance_method" title="#paused? (instance method)">#<strong>paused?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#pending_connect_timeout-instance_method" title="#pending_connect_timeout (instance method)">#<strong>pending_connect_timeout</strong>  &#x21d2; Float </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>The duration after which a TCP connection in the connecting state will fail.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#pending_connect_timeout=-instance_method" title="#pending_connect_timeout= (instance method)">#<strong>pending_connect_timeout=</strong>(value)  </a>
      (also: #set_pending_connect_timeout)
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the duration after which a TCP connection in a connecting state will fail.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw nodoc'>
      <a href="#signature-instance_method" title="#signature (instance method)">#<strong>signature</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#watch_only%3F-instance_method" title="#watch_only? (instance method)">#<strong>watch_only?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#associate_callback_target-instance_method" title="#associate_callback_target (instance method)">#<strong>associate_callback_target</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>conn_associate_callback_target.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#close_connection-instance_method" title="#close_connection (instance method)">#<strong>close_connection</strong>(after_writing = false)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>EventMachine::Connection#close_connection is called only by user code, and never by the event loop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#close_connection_after_writing-instance_method" title="#close_connection_after_writing (instance method)">#<strong>close_connection_after_writing</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A variant of <a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connection_completed-instance_method" title="#connection_completed (instance method)">#<strong>connection_completed</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by the event loop when a remote TCP connection attempt completes successfully.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#detach-instance_method" title="#detach (instance method)">#<strong>detach</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Removes given connection from the event loop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#disable_keepalive-instance_method" title="#disable_keepalive (instance method)">#<strong>disable_keepalive</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>t_disable_keepalive.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enable_keepalive-instance_method" title="#enable_keepalive (instance method)">#<strong>enable_keepalive</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>t_enable_keepalive.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_cipher_bits-instance_method" title="#get_cipher_bits (instance method)">#<strong>get_cipher_bits</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_cipher_name-instance_method" title="#get_cipher_name (instance method)">#<strong>get_cipher_name</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_cipher_protocol-instance_method" title="#get_cipher_protocol (instance method)">#<strong>get_cipher_protocol</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_idle_time-instance_method" title="#get_idle_time (instance method)">#<strong>get_idle_time</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The number of seconds since the last send/receive activity on this connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_outbound_data_size-instance_method" title="#get_outbound_data_size (instance method)">#<strong>get_outbound_data_size</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>conn_get_outbound_data_size.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_peer_cert-instance_method" title="#get_peer_cert (instance method)">#<strong>get_peer_cert</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>If <a href="http://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> is active on the connection, returns the remote <a href="http://en.wikipedia.org/wiki/X.509">X509 certificate</a> as a string, in the popular <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_peername-instance_method" title="#get_peername (instance method)">#<strong>get_peername</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This method is used with stream-connections to obtain the identity of the remotely-connected peer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_pid-instance_method" title="#get_pid (instance method)">#<strong>get_pid</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the PID (kernel process identifier) of a subprocess associated with this <code>Connection</code> object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_proxied_bytes-instance_method" title="#get_proxied_bytes (instance method)">#<strong>get_proxied_bytes</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The number of bytes proxied to another connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_sni_hostname-instance_method" title="#get_sni_hostname (instance method)">#<strong>get_sni_hostname</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_sock_opt-instance_method" title="#get_sock_opt (instance method)">#<strong>get_sock_opt</strong>(level, option)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_sockname-instance_method" title="#get_sockname (instance method)">#<strong>get_sockname</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Used with stream-connections to obtain the identity of the local side of the connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_status-instance_method" title="#get_status (instance method)">#<strong>get_status</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a subprocess exit status.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(*args)  &#x21d2; Connection </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Stubbed initialize so legacy superclasses can safely call super.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#original_method-instance_method" title="#original_method (instance method)">#<strong>original_method</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pause-instance_method" title="#pause (instance method)">#<strong>pause</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Pause a connection so that <a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a> and <a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a> events are not fired until <a href="#resume-instance_method" title="EventMachine::Connection#resume (method)">#resume</a> is called.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#post_init-instance_method" title="#post_init (instance method)">#<strong>post_init</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by the event loop immediately after the network connection has been established, and before resumption of the network loop.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#proxy_completed-instance_method" title="#proxy_completed (instance method)">#<strong>proxy_completed</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>called when the reactor finished proxying all of the requested bytes.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#proxy_incoming_to-instance_method" title="#proxy_incoming_to (instance method)">#<strong>proxy_incoming_to</strong>(conn, bufsize = 0)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>EventMachine::Connection#proxy_incoming_to is called only by user code.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#proxy_target_unbound-instance_method" title="#proxy_target_unbound (instance method)">#<strong>proxy_target_unbound</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by the reactor after attempting to relay incoming data to a descriptor (set as a proxy target descriptor with <a href="../EventMachine.html#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">enable_proxy</a>) that has already been closed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_data-instance_method" title="#receive_data (instance method)">#<strong>receive_data</strong>(data)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by the event loop whenever data has been received by the network connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reconnect-instance_method" title="#reconnect (instance method)">#<strong>reconnect</strong>(server, port)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Reconnect to a given host/port with the current instance.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#resume-instance_method" title="#resume (instance method)">#<strong>resume</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Resume a connection&#39;s <a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a> and <a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a> events.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#send_data-instance_method" title="#send_data (instance method)">#<strong>send_data</strong>(data)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Call this method to send data to the remote end of the network connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#send_datagram-instance_method" title="#send_datagram (instance method)">#<strong>send_datagram</strong>(data, recipient_address, recipient_port)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sends UDP messages.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#send_file_data-instance_method" title="#send_file_data (instance method)">#<strong>send_file_data</strong>(filename)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Like <a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a>, this sends data to the remote end of the network connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_sock_opt-instance_method" title="#set_sock_opt (instance method)">#<strong>set_sock_opt</strong>(level, optname, optval)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ssl_handshake_completed-instance_method" title="#ssl_handshake_completed (instance method)">#<strong>ssl_handshake_completed</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> when the SSL/TLS handshake has been completed, as a result of calling #start_tls to initiate SSL/TLS on the connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ssl_verify_peer-instance_method" title="#ssl_verify_peer (instance method)">#<strong>ssl_verify_peer</strong>(cert)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> when <code>:verify_peer</code> =&gt; true has been passed to <a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">#start_tls</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#start_tls-instance_method" title="#start_tls (instance method)">#<strong>start_tls</strong>(args = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Call <a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">#start_tls</a> at any point to initiate TLS encryption on connected streams.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stop_proxying-instance_method" title="#stop_proxying (instance method)">#<strong>stop_proxying</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A helper method for <a href="../EventMachine.html#disable_proxy-class_method" title="EventMachine.disable_proxy (method)">disable_proxy</a></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stream_file_data-instance_method" title="#stream_file_data (instance method)">#<strong>stream_file_data</strong>(filename, args = {})  &#x21d2; EventMachine::Deferrable </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Open a file on the filesystem and send it to the remote peer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unbind-instance_method" title="#unbind (instance method)">#<strong>unbind</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>called by the framework whenever a connection (either a server or client connection) is closed.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature nodoc first'>
    .<strong>new</strong>(sig, *args)  &#x21d2; <code>Connection</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    <p>Override .new so subclasses don&#39;t have to call super and can ignore
connection-specific arguments</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L50-L64'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='50' data-end='64'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 50</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_new'>new</span>(<span class='id identifier rubyid_sig'>sig</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_allocate'>allocate</span>.<span class='id identifier rubyid_instance_eval'>instance_eval</span> <span class='kw'>do</span>
    <span class='comment'># Store signature
</span>    <span class='ivar'>@signature</span> <span class='op'>=</span> <span class='id identifier rubyid_sig'>sig</span>
    <span class='comment'># associate_callback_target sig
</span>
    <span class='comment'># Call a superclass&#39;s #initialize if it has one
</span>    <span class='id identifier rubyid_initialize'><a href="#initialize-instance_method" title="EventMachine::Connection#initialize (method)">initialize</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

    <span class='comment'># post initialize callback
</span>    <span class='id identifier rubyid_post_init'><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">post_init</a></span>

    <span class='kw'>self</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

  <section class='method_details' id="initialize-instance_method">
  <h3 class='signature nodoc'>
    #<strong>initialize</strong>(*args)  &#x21d2; <code>Connection</code> 
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    <p>Stubbed initialize so legacy superclasses can safely call super</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L69-L70'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='69' data-end='70'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 69</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="comm_inactivity_timeout-instance_method">
  <h3 class='signature rw first'>
    #<strong>comm_inactivity_timeout</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>comm_inactivity_timeout returns the current value (float in seconds) of the inactivity-timeout
property of network-connection and datagram-socket objects. A nonzero value
indicates that the connection or socket will automatically be closed if no read or write
activity takes place for at least that number of seconds.
A zero value (the default) specifies that no automatic timeout will take place.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L674-L676'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='674' data-end='676'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 674</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_comm_inactivity_timeout'>comm_inactivity_timeout</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_comm_inactivity_timeout'><a href="../EventMachine.html#get_comm_inactivity_timeout-class_method" title="EventMachine.get_comm_inactivity_timeout (method)">get_comm_inactivity_timeout</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="comm_inactivity_timeout=-instance_method">
  <h3 class='signature rw'>
    #<strong>comm_inactivity_timeout=</strong>(value)   <span class="extras">(<span class='rw'>rw</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>#set_comm_inactivity_timeout</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Allows you to set the inactivity-timeout property for
a network connection or datagram socket. Specify a non-negative float value in seconds.
If the value is greater than zero, the connection or socket will automatically be closed
if no read or write activity takes place for at least that number of seconds.
Specify a value of zero to indicate that no automatic timeout should take place.
Zero is the default value.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L684-L686'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='684' data-end='686'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 684</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_comm_inactivity_timeout='>comm_inactivity_timeout=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_set_comm_inactivity_timeout'><a href="../EventMachine.html#set_comm_inactivity_timeout-class_method" title="EventMachine.set_comm_inactivity_timeout (method)">set_comm_inactivity_timeout</a></span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_f'>to_f</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="error?-instance_method">
  <h3 class='signature ro'>
    #<strong>error?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Returns true if the connection is in an error state, false otherwise.</p>

<p>In general, you can detect the occurrence of communication errors or unexpected
disconnection by the remote peer by handing the <a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a> method. In some cases, however,
it&#39;s useful to check the status of the connection using <code>#error?</code> before attempting to send data.
This function is synchronous but it will return immediately without blocking.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Boolean</code>)</span>
&mdash;    <div class='inline'><p>true if the connection is in an error state, false otherwise</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L337-L347'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='337' data-end='347'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 337</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_error?'>error?</span>
  <span class='id identifier rubyid_errno'>errno</span> <span class='op'>=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_report_connection_error_status'><a href="../EventMachine.html#report_connection_error_status-class_method" title="EventMachine.report_connection_error_status (method)">report_connection_error_status</a></span>(<span class='ivar'>@signature</span>)
  <span class='kw'>case</span> <span class='id identifier rubyid_errno'>errno</span>
  <span class='kw'>when</span> <span class='int'>0</span>
    <span class='kw'>false</span>
  <span class='kw'>when</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#ERRNOS-constant" title="EventMachine::ERRNOS (constant)">ERRNOS</a></span>[<span class='id identifier rubyid_errno'>errno</span>]
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="notify_readable=-instance_method">
  <h3 class='signature rw'>
    #<strong>notify_readable=</strong>(mode)   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Watches connection for readability. Only possible if the connection was created
using <a href="../EventMachine.html#attach-class_method" title="EventMachine.attach (method)">EventMachine.attach</a> and had <code>EventMachine.notify_readable</code>/<code>EventMachine.notify_writable</code> defined on the handler.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#notify_readable%3F-instance_method" title="EventMachine::Connection#notify_readable? (method)">#notify_readable?</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L756-L758'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='756' data-end='758'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 756</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_notify_readable='>notify_readable=</span> <span class='id identifier rubyid_mode'>mode</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_set_notify_readable'>set_notify_readable</span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_mode'>mode</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="notify_readable?-instance_method">
  <h3 class='signature rw'>
    #<strong>notify_readable?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Boolean</code>)</span>
&mdash;    <div class='inline'><p>true if the connection is being watched for readability.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L761-L763'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='761' data-end='763'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 761</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_notify_readable?'>notify_readable?</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_is_notify_readable'>is_notify_readable</span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="notify_writable=-instance_method">
  <h3 class='signature rw'>
    #<strong>notify_writable=</strong>(mode)   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Watches connection for writeability. Only possible if the connection was created
using <a href="../EventMachine.html#attach-class_method" title="EventMachine.attach (method)">EventMachine.attach</a> and had <code>EventMachine.notify_readable</code>/<code>EventMachine.notify_writable</code> defined on the handler.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#notify_writable%3F-instance_method" title="EventMachine::Connection#notify_writable? (method)">#notify_writable?</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L769-L771'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='769' data-end='771'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 769</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_notify_writable='>notify_writable=</span> <span class='id identifier rubyid_mode'>mode</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_set_notify_writable'>set_notify_writable</span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_mode'>mode</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="notify_writable?-instance_method">
  <h3 class='signature rw'>
    #<strong>notify_writable?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Returns true if the connection is being watched for writability.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L774-L776'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='774' data-end='776'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 774</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_notify_writable?'>notify_writable?</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_is_notify_writable'>is_notify_writable</span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="paused?-instance_method">
  <h3 class='signature ro'>
    #<strong>paused?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Boolean</code>)</span>
&mdash;    <div class='inline'><p>true if the connect was paused using <a href="#pause-instance_method" title="EventMachine::Connection#pause (method)">#pause</a>.</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#pause-instance_method" title="EventMachine::Connection#pause (method)">#pause</a></li>
          <li><a href="#resume-instance_method" title="EventMachine::Connection#resume (method)">#resume</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L793-L795'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='793' data-end='795'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 793</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_paused?'>paused?</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_connection_paused?'>connection_paused?</span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pending_connect_timeout-instance_method">
  <h3 class='signature rw'>
    #<strong>pending_connect_timeout</strong>  &#x21d2; <code>Float</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>The duration after which a TCP connection in the connecting state will fail.
It is important to distinguish this value from <a href="#comm_inactivity_timeout-instance_method" title="EventMachine::Connection#comm_inactivity_timeout (method)">#comm_inactivity_timeout</a>,
which looks at how long since data was passed on an already established connection.
The value is a float in seconds.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Float</code>)</span>
&mdash;    <div class='inline'><p>The duration after which a TCP connection in the connecting state will fail, in seconds.</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L695-L697'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='695' data-end='697'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 695</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pending_connect_timeout'>pending_connect_timeout</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_pending_connect_timeout'><a href="../EventMachine.html#get_pending_connect_timeout-class_method" title="EventMachine.get_pending_connect_timeout (method)">get_pending_connect_timeout</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pending_connect_timeout=-instance_method">
  <h3 class='signature rw'>
    #<strong>pending_connect_timeout=</strong>(value)   <span class="extras">(<span class='rw'>rw</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>#set_pending_connect_timeout</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sets the duration after which a TCP connection in a
connecting state will fail.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<code>Float</code>, #<code>to_f</code>)</span>
&mdash;    <div class='inline'><p><code>Connection</code> timeout in seconds</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L703-L705'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='703' data-end='705'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 703</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pending_connect_timeout='>pending_connect_timeout=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_set_pending_connect_timeout'><a href="../EventMachine.html#set_pending_connect_timeout-class_method" title="EventMachine.set_pending_connect_timeout (method)">set_pending_connect_timeout</a></span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_to_f'>to_f</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="signature-instance_method">
  <h3 class='signature rw  nodoc'>
    #<strong>signature</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L41-L41'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='41' data-end='41'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 41</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_signature'>signature</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="watch_only?-instance_method">
  <h3 class='signature ro'>
    #<strong>watch_only?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Boolean</code>)</span>
&mdash;    <div class='inline'><p>true if the connect was watch only</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L798-L800'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='798' data-end='800'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 798</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_watch_only?'>watch_only?</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_watch_only?'>watch_only?</span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="associate_callback_target-instance_method">
  <h3 class='signature  first'>
    #<strong>associate_callback_target</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>conn_associate_callback_target</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1305-L1309'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1305' data-end='1309'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1305</span></pre>
<pre class='code cpp'>

static VALUE conn_associate_callback_target (VALUE self UNUSED, VALUE sig UNUSED)
{
	// No-op for the time being.
	return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close_connection-instance_method">
  <h3 class='signature '>
    #<strong>close_connection</strong>(after_writing = false)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>EventMachine::Connection#close_connection is called only by user code, and never
by the event loop. You may call this method against a connection object in any
callback handler, whether or not the callback was made against the connection
you want to close. close_connection <i>schedules</i> the connection to be closed
at the next available opportunity within the event loop. You may not assume that
the connection is closed when close_connection returns. In particular, the framework
will callback the unbind method for the particular connection at a point shortly
after you call close_connection. You may assume that the unbind callback will
take place sometime after your call to close_connection completes. In other words,
the unbind callback will not re-enter your code &quot;inside&quot; of your call to close_connection.
However, it&#39;s not guaranteed that a future version of <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> will not change
this behavior.</p>

<p><code>#close_connection</code> will <em>silently discard</em> any outbound data which you have
sent to the connection using <a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a> but which has not
yet been sent across the network. If you want to avoid this behavior, use
<a href="#close_connection_after_writing-instance_method" title="EventMachine::Connection#close_connection_after_writing (method)">#close_connection_after_writing</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L263-L265'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='263' data-end='265'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 263</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_close_connection'>close_connection</span> <span class='id identifier rubyid_after_writing'>after_writing</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_close_connection'><a href="../EventMachine.html#close_connection-class_method" title="EventMachine.close_connection (method)">close_connection</a></span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_after_writing'>after_writing</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close_connection_after_writing-instance_method">
  <h3 class='signature '>
    #<strong>close_connection_after_writing</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>A variant of <a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a>.
All of the descriptive comments given for close_connection also apply to
close_connection_after_writing, <em>with one exception</em>: if the connection has
outbound data sent using send_dat but which has not yet been sent across the network,
close_connection_after_writing will schedule the connection to be closed <em>after</em>
all of the outbound data has been safely written to the remote peer.</p>

<p>Depending on the amount of outgoing data and the speed of the network,
considerable time may elapse between your call to close_connection_after_writing
and the actual closing of the socket (at which time the unbind callback will be called
by the event loop). During this time, you <em>may not</em> call send_data to transmit
additional data (that is, the connection is closed for further writes). In very
rare cases, you may experience a receive_data callback after your call to <code>#close_connection_after_writing</code>,
depending on whether incoming data was in the process of being received on the connection
at the moment when you called <code>#close_connection_after_writing</code>. Your protocol handler must
be prepared to properly deal with such data (probably by ignoring it).</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a></li>
          <li><a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L300-L302'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='300' data-end='302'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 300</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_close_connection_after_writing'>close_connection_after_writing</span>
  <span class='id identifier rubyid_close_connection'><a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">close_connection</a></span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connection_completed-instance_method">
  <h3 class='signature '>
    #<strong>connection_completed</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Called by the event loop when a remote TCP connection attempt completes successfully.
You can expect to get this notification after calls to <a href="../EventMachine.html#connect-class_method" title="EventMachine.connect (method)">EventMachine.connect</a>. Remember that <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> makes remote connections
asynchronously, just as with any other kind of network event. This method
is intended primarily to assist with network diagnostics. For normal protocol
handling, use #post_init to perform initial work on a new connection (such as sending initial set of data).
<a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a> will always be called. This method will only be called in case of a successful completion.
A connection attempt which fails will result a call to <a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a> after the failure.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a></li>
          <li><a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a></li>
          <li><a href="../file.GettingStarted.html" title="EventMachine tutorial">EventMachine tutorial</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L360-L361'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='360' data-end='361'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 360</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_completed'>connection_completed</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="detach-instance_method">
  <h3 class='signature '>
    #<strong>detach</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Removes given connection from the event loop.
The connection&#39;s socket remains open and its file descriptor number is returned.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L269-L271'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='269' data-end='271'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 269</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_detach'>detach</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_detach_fd'>detach_fd</span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disable_keepalive-instance_method">
  <h3 class='signature '>
    #<strong>disable_keepalive</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_disable_keepalive</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1338-L1346'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1338' data-end='1346'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1338</span></pre>
<pre class='code cpp'>

static VALUE t_disable_keepalive (VALUE self)
{
	VALUE sig = rb_ivar_get (self, Intern_at_signature);
	try {
		return INT2NUM (evma_disable_keepalive(NUM2ULONG(sig)));
	} catch (std::runtime_error e) {
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, e.what());
	}
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enable_keepalive-instance_method">
  <h3 class='signature '>
    #<strong>enable_keepalive</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>t_enable_keepalive</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1316-L1332'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1316' data-end='1332'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1316</span></pre>
<pre class='code cpp'>

static VALUE t_enable_keepalive (int argc, VALUE *argv, VALUE self)
{
	VALUE idle, intvl, cnt;
	rb_scan_args(argc, argv, &quot;03&quot;, &amp;idle, &amp;intvl, &amp;cnt);

	// In ed.cpp, skip 0 values before calling setsockopt
	int i_idle  = NIL_P(idle)  ? 0 : NUM2INT(idle);
	int i_intvl = NIL_P(intvl) ? 0 : NUM2INT(intvl);
	int i_cnt   = NIL_P(cnt)   ? 0 : NUM2INT(cnt);

	VALUE sig = rb_ivar_get (self, Intern_at_signature);
	try {
		return INT2NUM (evma_enable_keepalive(NUM2ULONG(sig), i_idle, i_intvl, i_cnt));
	} catch (std::runtime_error e) {
		rb_raise (rb_eRuntimeError, &quot;%s&quot;, e.what());
	}
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_cipher_bits-instance_method">
  <h3 class='signature '>
    #<strong>get_cipher_bits</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L561-L563'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='561' data-end='563'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 561</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_cipher_bits'>get_cipher_bits</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_cipher_bits'><a href="../EventMachine.html#get_cipher_bits-class_method" title="EventMachine.get_cipher_bits (method)">get_cipher_bits</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_cipher_name-instance_method">
  <h3 class='signature '>
    #<strong>get_cipher_name</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L565-L567'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='565' data-end='567'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 565</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_cipher_name'>get_cipher_name</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_cipher_name'><a href="../EventMachine.html#get_cipher_name-class_method" title="EventMachine.get_cipher_name (method)">get_cipher_name</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_cipher_protocol-instance_method">
  <h3 class='signature '>
    #<strong>get_cipher_protocol</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L569-L571'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='569' data-end='571'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 569</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_cipher_protocol'>get_cipher_protocol</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_cipher_protocol'><a href="../EventMachine.html#get_cipher_protocol-class_method" title="EventMachine.get_cipher_protocol (method)">get_cipher_protocol</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_idle_time-instance_method">
  <h3 class='signature '>
    #<strong>get_idle_time</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>The number of seconds since the last send/receive activity on this connection.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L665-L667'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='665' data-end='667'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 665</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_idle_time'>get_idle_time</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_idle_time'><a href="../EventMachine.html#get_idle_time-class_method" title="EventMachine.get_idle_time (method)">get_idle_time</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_outbound_data_size-instance_method">
  <h3 class='signature '>
    #<strong>get_outbound_data_size</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>conn_get_outbound_data_size</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/ext/rubymain.cpp#L1294-L1298'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1294' data-end='1298'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/rubymain.cpp', line 1294</span></pre>
<pre class='code cpp'>

static VALUE conn_get_outbound_data_size (VALUE self)
{
	VALUE sig = rb_ivar_get (self, Intern_at_signature);
	return INT2NUM (evma_get_outbound_data_size (NUM2BSIG (sig)));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_peer_cert-instance_method">
  <h3 class='signature '>
    #<strong>get_peer_cert</strong>  &#x21d2; <code>String</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>If <a href="http://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> is active on the connection, returns the remote <a href="http://en.wikipedia.org/wiki/X.509">X509 certificate</a>
as a string, in the popular <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a>. This can then be used for arbitrary validation
of a peer&#39;s certificate in your code.</p>

<p>This should be called in/after the <a href="#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">#ssl_handshake_completed</a> callback, which indicates
that SSL/TLS is active. Using this callback is important, because the certificate may not
be available until the time it is executed. Using #post_init or #connection_completed is
not adequate, because the SSL handshake may still be taking place.</p>

<p>This method will return <code>nil</code> if:</p>

<ul>
<li><a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> is not built with <a href="http://www.openssl.org">OpenSSL</a> support</li>
<li><a href="http://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> is not active on the connection</li>
<li>TLS handshake is not yet complete</li>
<li>Remote peer for any other reason has not presented a certificate</li>
</ul>

<p>You can do whatever you want with the certificate String, such as load it
as a certificate object using the OpenSSL library, and check its fields.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Getting peer TLS certificate information in <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a></p>
</div></p>
      <pre class='example code ruby'><code><span class='kw'>module</span> <span class='const'>Handler</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">post_init</a></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Starting TLS</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_start_tls'><a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">start_tls</a></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_ssl_handshake_completed'><a href="#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">ssl_handshake_completed</a></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_get_peer_cert'>get_peer_cert</span>
    <span class='id identifier rubyid_close_connection'><a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">close_connection</a></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'><a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">unbind</a></span>
    <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_stop_event_loop'><a href="../EventMachine.html#stop_event_loop-class_method" title="EventMachine.stop_event_loop (method)">stop_event_loop</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

 <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span>.<span class='id identifier rubyid_run'><a href="../EventMachine.html#run-class_method" title="EventMachine.run (method)">run</a></span> <span class='kw'>do</span>
   <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span>.<span class='id identifier rubyid_connect'><a href="../EventMachine.html#connect-class_method" title="EventMachine.connect (method)">connect</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mail.google.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>443</span><span class='comma'>,</span> <span class='const'>Handler</span>
<span class='kw'>end</span>

<span class='comment'># Will output:
</span><span class='comment'># -----BEGIN CERTIFICATE-----
</span><span class='comment'># MIIDIjCCAougAwIBAgIQbldpChBPqv+BdPg4iwgN8TANBgkqhkiG9w0BAQUFADBM
</span><span class='comment'># MQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkg
</span><span class='comment'># THRkLjEWMBQGA1UEAxMNVGhhd3RlIFNHQyBDQTAeFw0wODA1MDIxNjMyNTRaFw0w
</span><span class='comment'># OTA1MDIxNjMyNTRaMGkxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlh
</span><span class='comment'># MRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRMwEQYDVQQKEwpHb29nbGUgSW5jMRgw
</span><span class='comment'># FgYDVQQDEw9tYWlsLmdvb2dsZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJ
</span><span class='comment'># AoGBALlkxdh2QXegdElukCSOV2+8PKiONIS+8Tu9K7MQsYpqtLNC860zwOPQ2NLI
</span><span class='comment'># 3Zp4jwuXVTrtzGuiqf5Jioh35Ig3CqDXtLyZoypjZUQcq4mlLzHlhIQ4EhSjDmA7
</span><span class='comment'># Ffw9y3ckSOQgdBQWNLbquHh9AbEUjmhkrYxIqKXeCnRKhv6nAgMBAAGjgecwgeQw
</span><span class='comment'># KAYDVR0lBCEwHwYIKwYBBQUHAwEGCCsGAQUFBwMCBglghkgBhvhCBAEwNgYDVR0f
</span><span class='comment'># BC8wLTAroCmgJ4YlaHR0cDovL2NybC50aGF3dGUuY29tL1RoYXd0ZVNHQ0NBLmNy
</span><span class='comment'># bDByBggrBgEFBQcBAQRmMGQwIgYIKwYBBQUHMAGGFmh0dHA6Ly9vY3NwLnRoYXd0
</span><span class='comment'># ZS5jb20wPgYIKwYBBQUHMAKGMmh0dHA6Ly93d3cudGhhd3RlLmNvbS9yZXBvc2l0
</span><span class='comment'># b3J5L1RoYXd0ZV9TR0NfQ0EuY3J0MAwGA1UdEwEB/wQCMAAwDQYJKoZIhvcNAQEF
</span><span class='comment'># BQADgYEAsRwpLg1dgCR1gYDK185MFGukXMeQFUvhGqF8eT/CjpdvezyKVuz84gSu
</span><span class='comment'># 6ccMXgcPQZGQN/F4Xug+Q01eccJjRSVfdvR5qwpqCj+6BFl5oiKDBsveSkrmL5dz
</span><span class='comment'># s2bn7TdTSYKcLeBkjXxDLHGBqLJ6TNCJ3c4/cbbG5JhGvoema94=
</span><span class='comment'># -----END CERTIFICATE-----</span></code></pre>
  </div>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>the remote <a href="http://en.wikipedia.org/wiki/X.509">X509 certificate</a>, in the popular <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a>,
if TLS is active on the connection</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">#start_tls</a></li>
          <li><a href="#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">#ssl_handshake_completed</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L557-L559'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='557' data-end='559'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 557</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_peer_cert'>get_peer_cert</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_peer_cert'><a href="../EventMachine.html#get_peer_cert-class_method" title="EventMachine.get_peer_cert (method)">get_peer_cert</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_peername-instance_method">
  <h3 class='signature '>
    #<strong>get_peername</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>This method is used with stream-connections to obtain the identity
of the remotely-connected peer. If a peername is available, this method
returns a sockaddr structure. The method returns nil if no peername is available.
You can use Socket.unpack_sockaddr_in and its variants to obtain the
values contained in the peername structure returned from #get_peername.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>How to get peer IP address and port with <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a></p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>module</span> <span class='const'>Handler</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'><a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">receive_data</a></span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='const'>Socket</span>.<span class='id identifier rubyid_unpack_sockaddr_in'>unpack_sockaddr_in</span>(<span class='id identifier rubyid_get_peername'>get_peername</span>)
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L623-L625'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='623' data-end='625'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 623</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_peername'>get_peername</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_peername'><a href="../EventMachine.html#get_peername-class_method" title="EventMachine.get_peername (method)">get_peername</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_pid-instance_method">
  <h3 class='signature '>
    #<strong>get_pid</strong>  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Returns the PID (kernel process identifier) of a subprocess
associated with this <code>Connection</code> object. For use with <a href="../EventMachine.html#popen-class_method" title="EventMachine.popen (method)">EventMachine.popen</a>
and similar methods. Returns nil when there is no meaningful subprocess.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L652-L654'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='652' data-end='654'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 652</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_pid'>get_pid</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_subprocess_pid'><a href="../EventMachine.html#get_subprocess_pid-class_method" title="EventMachine.get_subprocess_pid (method)">get_subprocess_pid</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_proxied_bytes-instance_method">
  <h3 class='signature '>
    #<strong>get_proxied_bytes</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>The number of bytes proxied to another connection. Reset to zero when
EventMachine::Connection#proxy_incoming_to is called, and incremented whenever data is proxied.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L241-L243'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='241' data-end='243'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 241</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_proxied_bytes'>get_proxied_bytes</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_proxied_bytes'>get_proxied_bytes</span>(<span class='ivar'>@signature</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_sni_hostname-instance_method">
  <h3 class='signature '>
    #<strong>get_sni_hostname</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L573-L575'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='573' data-end='575'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 573</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_sni_hostname'>get_sni_hostname</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_sni_hostname'><a href="../EventMachine.html#get_sni_hostname-class_method" title="EventMachine.get_sni_hostname (method)">get_sni_hostname</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_sock_opt-instance_method">
  <h3 class='signature '>
    #<strong>get_sock_opt</strong>(level, option)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L273-L275'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='273' data-end='275'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 273</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_sock_opt'>get_sock_opt</span> <span class='id identifier rubyid_level'>level</span><span class='comma'>,</span> <span class='id identifier rubyid_option'>option</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_sock_opt'>get_sock_opt</span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_level'>level</span><span class='comma'>,</span> <span class='id identifier rubyid_option'>option</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_sockname-instance_method">
  <h3 class='signature '>
    #<strong>get_sockname</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Used with stream-connections to obtain the identity
of the local side of the connection. If a local name is available, this method
returns a sockaddr structure. The method returns nil if no local name is available.
You can use <code>Socket.unpack_sockaddr_in</code> and its variants to obtain the
values contained in the local-name structure returned from this method.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>socket</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>module</span> <span class='const'>Handler</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_receive_data'><a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">receive_data</a></span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='const'>Socket</span>.<span class='id identifier rubyid_unpack_sockaddr_in'>unpack_sockaddr_in</span>(<span class='id identifier rubyid_get_sockname'>get_sockname</span>)
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L643-L645'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='643' data-end='645'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 643</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_sockname'>get_sockname</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_sockname'><a href="../EventMachine.html#get_sockname-class_method" title="EventMachine.get_sockname (method)">get_sockname</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_status-instance_method">
  <h3 class='signature '>
    #<strong>get_status</strong>  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Returns a subprocess exit status. Only useful for <a href="../EventMachine.html#popen-class_method" title="EventMachine.popen (method)">EventMachine.popen</a>. Call it in your
<a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a> handler.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L660-L662'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='660' data-end='662'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 660</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_status'>get_status</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_get_subprocess_status'><a href="../EventMachine.html#get_subprocess_status-class_method" title="EventMachine.get_subprocess_status (method)">get_subprocess_status</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="original_method-instance_method">
  <h3 class='signature nodoc'>
    #<strong>original_method</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L44-L44'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='44' data-end='44'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 44</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_original_method'>original_method</span> <span class='id identifier rubyid_method'>method</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pause-instance_method">
  <h3 class='signature '>
    #<strong>pause</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Pause a connection so that <a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a> and <a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a> events are not fired until <a href="#resume-instance_method" title="EventMachine::Connection#resume (method)">#resume</a> is called.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#resume-instance_method" title="EventMachine::Connection#resume (method)">#resume</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L780-L782'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='780' data-end='782'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 780</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pause'>pause</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_pause_connection'>pause_connection</span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="post_init-instance_method">
  <h3 class='signature '>
    #<strong>post_init</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Called by the event loop immediately after the network connection has been established,
and before resumption of the network loop.
This method is generally not called by user code, but is called automatically
by the event loop. The base-class implementation is a no-op.
This is a very good place to initialize instance variables that will
be used throughout the lifetime of the network connection.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a></li>
          <li><a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a></li>
          <li><a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a></li>
          <li><a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L83-L84'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='83' data-end='84'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 83</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_post_init'>post_init</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="proxy_completed-instance_method">
  <h3 class='signature '>
    #<strong>proxy_completed</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>called when the reactor finished proxying all
of the requested bytes.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L222-L223'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='222' data-end='223'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 222</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy_completed'>proxy_completed</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="proxy_incoming_to-instance_method">
  <h3 class='signature '>
    #<strong>proxy_incoming_to</strong>(conn, bufsize = 0)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>EventMachine::Connection#proxy_incoming_to is called only by user code. It sets up
a low-level proxy relay for all data inbound for this connection, to the connection given
as the argument. This is essentially just a helper method for enable_proxy.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="../EventMachine.html#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">EventMachine.enable_proxy</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L230-L232'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='230' data-end='232'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 230</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy_incoming_to'>proxy_incoming_to</span>(<span class='id identifier rubyid_conn'>conn</span><span class='comma'>,</span><span class='id identifier rubyid_bufsize'>bufsize</span><span class='op'>=</span><span class='int'>0</span>)
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_enable_proxy'><a href="../EventMachine.html#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">enable_proxy</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_conn'>conn</span><span class='comma'>,</span> <span class='id identifier rubyid_bufsize'>bufsize</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="proxy_target_unbound-instance_method">
  <h3 class='signature '>
    #<strong>proxy_target_unbound</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Called by the reactor after attempting to relay incoming data to a descriptor (set as a proxy target descriptor with
<a href="../EventMachine.html#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">EventMachine.enable_proxy</a>) that has already been closed.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="../EventMachine.html#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">EventMachine.enable_proxy</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L217-L218'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='217' data-end='218'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 217</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy_target_unbound'>proxy_target_unbound</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_data-instance_method">
  <h3 class='signature '>
    #<strong>receive_data</strong>(data)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Depending on the protocol, buffer sizes and OS networking stack configuration, incoming data may or may not be &quot;a complete message&quot;.
It is up to this handler to detect content boundaries to determine whether all the content (for example, full HTTP request)
has been received and can be processed.</p>
</div>
  </div>

<p>Called by the event loop whenever data has been received by the network connection.
It is never called by user code. <code>#receive_data</code> is called with a single parameter, a String containing
the network protocol data, which may of course be binary. You will
generally redefine this method to perform your own processing of the incoming data.</p>

<p>Here&#39;s a key point which is essential to understanding the event-driven
programming model: <i>EventMachine knows absolutely nothing about the protocol
which your code implements.</i> You must not make any assumptions about
the size of the incoming data packets, or about their alignment on any
particular intra-message or PDU boundaries (such as line breaks).
receive_data can and will send you arbitrary chunks of data, with the
only guarantee being that the data is presented to your code in the order
it was collected from the network. Don&#39;t even assume that the chunks of
data will correspond to network packets, as <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> can and will coalesce
several incoming packets into one, to improve performance. The implication for your
code is that you generally will need to implement some kind of a state machine
in your redefined implementation of receive_data. For a better understanding
of this, read through the examples of specific protocol handlers in <a href="Protocols.html" title="EventMachine::Protocols (module)"><code>Protocols</code></a></p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>data</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Opaque incoming data.</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a></li>
          <li><a href="#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a></li>
          <li><a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a></li>
          <li><a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a></li>
          <li><a href="../file.GettingStarted.html" title="EventMachine tutorial">EventMachine tutorial</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L115-L116'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='115' data-end='116'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 115</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_data'>receive_data</span> <span class='id identifier rubyid_data'>data</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reconnect-instance_method">
  <h3 class='signature '>
    #<strong>reconnect</strong>(server, port)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Reconnect to a given host/port with the current instance</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>server</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Hostname or IP address</p>
</div>
  </li>
  <li>
    <span class='name'>port</span>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'><p>Port to reconnect to</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L712-L714'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='712' data-end='714'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 712</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reconnect'>reconnect</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_reconnect'><a href="../EventMachine.html#reconnect-class_method" title="EventMachine.reconnect (method)">reconnect</a></span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="resume-instance_method">
  <h3 class='signature '>
    #<strong>resume</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Resume a connection&#39;s <a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a> and <a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a> events.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#pause-instance_method" title="EventMachine::Connection#pause (method)">#pause</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L786-L788'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='786' data-end='788'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 786</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_resume'>resume</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_resume_connection'>resume_connection</span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_data-instance_method">
  <h3 class='signature '>
    #<strong>send_data</strong>(data)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Call this method to send data to the remote end of the network connection. It takes a single String argument,
which may contain binary data. Data is buffered to be sent at the end of this event loop tick (cycle).</p>

<p>When used in a method that is event handler (for example, <a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a> or <a href="#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a>, it will send
data to the other end of the connection that generated the event.
You can also call <code>#send_data</code> to write to other connections. For more information see The Chat Server Example in the
<a href="../file.GettingStarted.html" title="{EventMachine">{EventMachine</a> tutorial}.</p>

<p>If you want to send some data and then immediately close the connection, make sure to use <a href="#close_connection_after_writing-instance_method" title="EventMachine::Connection#close_connection_after_writing (method)">#close_connection_after_writing</a>
instead of <a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a>.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>data</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Data to send asynchronously</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="../file.GettingStarted.html" title="EventMachine tutorial">EventMachine tutorial</a></li>
          <li><a href="#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a></li>
          <li><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a></li>
          <li><a href="#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L322-L327'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='322' data-end='327'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 322</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_data'>send_data</span> <span class='id identifier rubyid_data'>data</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_bytesize'>bytesize</span>)
  <span class='id identifier rubyid_size'>size</span> <span class='op'>||=</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_size'>size</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_send_data'><a href="../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_datagram-instance_method">
  <h3 class='signature '>
    #<strong>send_datagram</strong>(data, recipient_address, recipient_port)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sends UDP messages.</p>

<p>This method may be called from any <code>Connection</code> object that refers
to an open datagram socket (see EventMachine#open_datagram_socket).
The method sends a UDP (datagram) packet containing the data you specify,
to a remote peer specified by the IP address and port that you give
as parameters to the method.
Observe that you may send a zero-length packet (empty string).
However, you may not send an arbitrarily-large data packet because
your operating system will enforce a platform-specific limit on
the size of the outbound packet. (Your kernel
will respond in a platform-specific way if you send an overlarge
packet: some will send a truncated packet, some will complain, and
some will silently drop your request).
On LANs, it&#39;s usually OK to send datagrams up to about 4000 bytes in length,
but to be really safe, send messages smaller than the Ethernet-packet
size (typically about 1400 bytes). Some very restrictive WANs
will either drop or truncate packets larger than about 500 bytes.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>data</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Data to send asynchronously</p>
</div>
  </li>
  <li>
    <span class='name'>recipient_address</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>IP address of the recipient</p>
</div>
  </li>
  <li>
    <span class='name'>recipient_port</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Port of the recipient</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L599-L604'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='599' data-end='604'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 599</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_datagram'>send_datagram</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_recipient_address'>recipient_address</span><span class='comma'>,</span> <span class='id identifier rubyid_recipient_port'>recipient_port</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_bytesize'>bytesize</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_bytesize'>bytesize</span>)
  <span class='id identifier rubyid_size'>size</span> <span class='op'>||=</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_size'>size</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_send_datagram'><a href="../EventMachine.html#send_datagram-class_method" title="EventMachine.send_datagram (method)">send_datagram</a></span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_recipient_address'>recipient_address</span><span class='comma'>,</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_recipient_port'>recipient_port</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_file_data-instance_method">
  <h3 class='signature '>
    #<strong>send_file_data</strong>(filename)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Like <a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a>, this sends data to the remote end of
the network connection. <code>send_file_data</code> takes a
filename as an argument, though, and sends the contents of the file, in one
chunk.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filename</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Local path of the file to send</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a></li>
      </ul>
<p class='tag_title'>Author:</p>
<ul class='author'>
  <li>
    <div class='inline'><p>Kirk Haines</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L726-L728'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='726' data-end='728'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 726</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_file_data'>send_file_data</span> <span class='id identifier rubyid_filename'>filename</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_send_file_data'><a href="../EventMachine.html#send_file_data-class_method" title="EventMachine.send_file_data (method)">send_file_data</a></span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_filename'>filename</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_sock_opt-instance_method">
  <h3 class='signature '>
    #<strong>set_sock_opt</strong>(level, optname, optval)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L277-L279'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='277' data-end='279'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 277</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_sock_opt'>set_sock_opt</span> <span class='id identifier rubyid_level'>level</span><span class='comma'>,</span> <span class='id identifier rubyid_optname'>optname</span><span class='comma'>,</span> <span class='id identifier rubyid_optval'>optval</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_set_sock_opt'>set_sock_opt</span> <span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_level'>level</span><span class='comma'>,</span> <span class='id identifier rubyid_optname'>optname</span><span class='comma'>,</span> <span class='id identifier rubyid_optval'>optval</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ssl_handshake_completed-instance_method">
  <h3 class='signature '>
    #<strong>ssl_handshake_completed</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Called by <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> when the SSL/TLS handshake has
been completed, as a result of calling #start_tls to initiate SSL/TLS on the connection.</p>

<p>This callback exists because <a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a> and <a href="#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a> are <strong>not</strong> reliable
for indicating when an SSL/TLS connection is ready to have its certificate queried for.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#get_peer_cert-instance_method" title="EventMachine::Connection#get_peer_cert (method)">#get_peer_cert</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L125-L126'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='125' data-end='126'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 125</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_handshake_completed'>ssl_handshake_completed</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ssl_verify_peer-instance_method">
  <h3 class='signature '>
    #<strong>ssl_verify_peer</strong>(cert)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Called by <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> when <code>:verify_peer</code> =&gt; true has been passed to <a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">#start_tls</a>.
It will be called with each certificate in the certificate chain provided by the remote peer.</p>

<p>The cert will be passed as a String in PEM format, the same as in <a href="#get_peer_cert-instance_method" title="EventMachine::Connection#get_peer_cert (method)">#get_peer_cert</a>. It is up to user defined
code to perform a check on the certificates. The return value from this callback is used to accept or deny the peer.
A return value that is not nil or false triggers acceptance. If the peer is not accepted, the connection
will be subsequently closed.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>This server always accepts all peers</p>
</div></p>
      <pre class='example code ruby'><code><span class='kw'>module</span> <span class='const'>AcceptServer</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">post_init</a></span>
    <span class='id identifier rubyid_start_tls'><a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">start_tls</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_verify_peer'>verify_peer</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>)
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_ssl_verify_peer'>ssl_verify_peer</span>(<span class='id identifier rubyid_cert'>cert</span>)
    <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_ssl_handshake_completed'><a href="#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">ssl_handshake_completed</a></span>
    <span class='gvar'>$server_handshake_completed</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
        <p class='example_title'><div class='inline'><p>This server never accepts any peers</p>
</div></p>
      <pre class='example code ruby'><code><span class='kw'>module</span> <span class='const'>DenyServer</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">post_init</a></span>
    <span class='id identifier rubyid_start_tls'><a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">start_tls</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_verify_peer'>verify_peer</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>)
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_ssl_verify_peer'>ssl_verify_peer</span>(<span class='id identifier rubyid_cert'>cert</span>)
    <span class='comment'># Do not accept the peer. This should now cause the connection to shut down
</span>    <span class='comment'># without the SSL handshake being completed.
</span>    <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_ssl_handshake_completed'><a href="#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">ssl_handshake_completed</a></span>
    <span class='gvar'>$server_handshake_completed</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">#start_tls</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L172-L173'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='172' data-end='173'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 172</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_verify_peer'>ssl_verify_peer</span>(<span class='id identifier rubyid_cert'>cert</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="start_tls-instance_method">
  <h3 class='signature '>
    #<strong>start_tls</strong>(args = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'><p>support passing an encryption parameter, which can be string or Proc, to get a passphrase</p>
</div>
  </div>

  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'><p>support passing key material via raw strings or Procs that return strings instead of</p>
</div>
  </div>

<p>Call <code>#start_tls</code> at any point to initiate TLS encryption on connected streams.
The method is smart enough to know whether it should perform a server-side
or a client-side handshake. An appropriate place to call <code>#start_tls</code> is in
your redefined <a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a> method, or in the <a href="#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a> handler for
an outbound connection.</p>

<p>for encrypted private keys.
just filenames.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Using TLS with <a href="../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a></p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rubygems</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>eventmachine</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>module</span> <span class='const'>Handler</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_post_init'><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">post_init</a></span>
    <span class='id identifier rubyid_start_tls'>start_tls</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_private_key_file'>private_key_file</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/tmp/server.key</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_cert_chain_file'>cert_chain_file</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/tmp/server.crt</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_verify_peer'>verify_peer</span> <span class='op'>=&gt;</span> <span class='kw'>false</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>

 <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span>.<span class='id identifier rubyid_run'><a href="../EventMachine.html#run-class_method" title="EventMachine.run (method)">run</a></span> <span class='kw'>do</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span>.<span class='id identifier rubyid_start_server'><a href="../EventMachine.html#start_server-class_method" title="EventMachine.start_server (method)">start_server</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>9999</span><span class='comma'>,</span> <span class='const'>Handler</span>)
<span class='kw'>end</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>args</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>args</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:cert_chain_file</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>nil</tt>          </span>
            &mdash; <div class='inline'><p>local path of a readable file that contants  a chain of X509 certificates in
the <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a>,
with the most-resolved certificate at the top of the file, successive intermediate
certs in the middle, and the root (or CA) cert at the bottom. If both
<code>:cert_chain_file</code> and <code>:cert</code> are used, <a href="BadCertParams.html" title="EventMachine::BadCertParams (class)"><code>BadCertParams</code></a> will be raised.</p>
</div>        </li>
        <li>
          <span class='name'>:cert</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>nil</tt>          </span>
            &mdash; <div class='inline'><p>a string with the client certificate to use, complete with header and footer. If a cert chain is required, you will have to use the <code>:cert_chain_file</code> option. If both <code>:cert_chain_file</code> and <code>:cert</code> are used, <a href="BadCertParams.html" title="EventMachine::BadCertParams (class)"><code>BadCertParams</code></a> will be raised.</p>
</div>        </li>
        <li>
          <span class='name'>:private_key_file</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>nil</tt>          </span>
            &mdash; <div class='inline'><p>local path of a readable file that must contain a private key in the <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a>. If both <code>:private_key_file</code> and <code>:private_key</code> are used, <a href="BadPrivateKeyParams.html" title="EventMachine::BadPrivateKeyParams (class)"><code>BadPrivateKeyParams</code></a> will be raised. If the Private Key does not match the certificate, <a href="InvalidPrivateKey.html" title="EventMachine::InvalidPrivateKey (class)"><code>InvalidPrivateKey</code></a> will be raised.</p>
</div>        </li>
        <li>
          <span class='name'>:private_key</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>nil</tt>          </span>
            &mdash; <div class='inline'><p>a string, complete with header and footer, that must contain a private key in the <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a>. If both <code>:private_key_file</code> and <code>:private_key</code> are used, <a href="BadPrivateKeyParams.html" title="EventMachine::BadPrivateKeyParams (class)"><code>BadPrivateKeyParams</code></a> will be raised. If the Private Key does not match the certificate, <a href="InvalidPrivateKey.html" title="EventMachine::InvalidPrivateKey (class)"><code>InvalidPrivateKey</code></a> will be raised.</p>
</div>        </li>
        <li>
          <span class='name'>:private_key_pass</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>nil</tt>          </span>
            &mdash; <div class='inline'><p>a string to use as password to decode <code>:private_key</code> or <code>:private_key_file</code></p>
</div>        </li>
        <li>
          <span class='name'>:verify_peer</span>
          <span class='type'>(<code>Boolean</code>)</span>
          <span class='default'> &mdash; default:
              <tt>false</tt>          </span>
            &mdash; <div class='inline'><p>indicates whether a server should request a certificate from a peer, to be verified by user code.
If true, the <a href="#ssl_verify_peer-instance_method" title="EventMachine::Connection#ssl_verify_peer (method)">#ssl_verify_peer</a> callback on the <code>Connection</code> object is called with each certificate
in the certificate chain provided by the peer. See documentation on <a href="#ssl_verify_peer-instance_method" title="EventMachine::Connection#ssl_verify_peer (method)">#ssl_verify_peer</a> for how to use this.</p>
</div>        </li>
        <li>
          <span class='name'>:fail_if_no_peer_cert</span>
          <span class='type'>(<code>Boolean</code>)</span>
          <span class='default'> &mdash; default:
              <tt>false</tt>          </span>
            &mdash; <div class='inline'><p>Used in conjunction with verify_peer. If set the SSL handshake will be terminated if the peer does not provide a certificate.</p>
</div>        </li>
        <li>
          <span class='name'>:cipher_list</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>&quot;ALL:!ADH:!LOW:!EXP:!DES-CBC3-SHA:@STRENGTH&quot;</tt>          </span>
            &mdash; <div class='inline'><p>indicates the available SSL cipher values. Default value is &quot;ALL:!ADH:!LOW:!EXP:!DES-CBC3-SHA:@STRENGTH&quot;. Check the format of the OpenSSL cipher string at <a href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT">http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT</a>.</p>
</div>        </li>
        <li>
          <span class='name'>:ecdh_curve</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>nil</tt>          </span>
            &mdash; <div class='inline'><p>The curve for ECDHE ciphers. See available ciphers with &#39;openssl ecparam -list_curves&#39;</p>
</div>        </li>
        <li>
          <span class='name'>:dhparam</span>
          <span class='type'>(<code>String</code>)</span>
          <span class='default'> &mdash; default:
              <tt>nil</tt>          </span>
            &mdash; <div class='inline'><p>The local path of a file containing DH parameters for EDH ciphers in <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a> See: &#39;openssl dhparam&#39;</p>
</div>        </li>
        <li>
          <span class='name'>:ssl_version</span>
          <span class='type'>(<code>Array</code>)</span>
          <span class='default'> &mdash; default:
              <tt>TLSv1 TLSv1_1 TLSv1_2</tt>          </span>
            &mdash; <div class='inline'><p>indicates the allowed SSL/TLS versions. Possible values are: <code>SSLv2</code>, <code>SSLv3</code>, <code>TLSv1</code>, <code>TLSv1_1</code>, <code>TLSv1_2</code>.</p>
</div>        </li>
    </ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#ssl_verify_peer-instance_method" title="EventMachine::Connection#ssl_verify_peer (method)">#ssl_verify_peer</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L422-L487'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='422' data-end='487'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 422</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_start_tls'>start_tls</span> <span class='id identifier rubyid_args'>args</span><span class='op'>=</span>{}
  <span class='id identifier rubyid_priv_key_path'>priv_key_path</span>   <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_private_key_file'>private_key_file</span>]
  <span class='id identifier rubyid_priv_key'>priv_key</span>        <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_private_key'>private_key</span>]
  <span class='id identifier rubyid_priv_key_pass'>priv_key_pass</span>   <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_private_key_pass'>private_key_pass</span>]
  <span class='id identifier rubyid_cert_chain_path'>cert_chain_path</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cert_chain_file'>cert_chain_file</span>]
  <span class='id identifier rubyid_cert'>cert</span>            <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cert'>cert</span>]
  <span class='id identifier rubyid_verify_peer'>verify_peer</span>     <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_verify_peer'>verify_peer</span>]
  <span class='id identifier rubyid_sni_hostname'>sni_hostname</span>    <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_sni_hostname'>sni_hostname</span>]
  <span class='id identifier rubyid_cipher_list'>cipher_list</span>     <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cipher_list'>cipher_list</span>]
  <span class='id identifier rubyid_ssl_version'>ssl_version</span>     <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ssl_version'>ssl_version</span>]
  <span class='id identifier rubyid_ecdh_curve'>ecdh_curve</span>      <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ecdh_curve'>ecdh_curve</span>]
  <span class='id identifier rubyid_dhparam'>dhparam</span>         <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_dhparam'>dhparam</span>]
  <span class='id identifier rubyid_fail_if_no_peer_cert'>fail_if_no_peer_cert</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_fail_if_no_peer_cert'>fail_if_no_peer_cert</span>]

  [<span class='id identifier rubyid_priv_key_path'>priv_key_path</span><span class='comma'>,</span> <span class='id identifier rubyid_cert_chain_path'>cert_chain_path</span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="FileNotFoundException.html" title="EventMachine::FileNotFoundException (class)">FileNotFoundException</a></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_content'> for start_tls</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'>File</span>.<span class='id identifier rubyid_exist?'>exist?</span> <span class='id identifier rubyid_file'>file</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_priv_key_path'>priv_key_path</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_priv_key_path'>priv_key_path</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_priv_key'>priv_key</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_priv_key'>priv_key</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="BadPrivateKeyParams.html" title="EventMachine::BadPrivateKeyParams (class)">BadPrivateKeyParams</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Specifying both private_key and private_key_file not allowed</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_cert_chain_path'>cert_chain_path</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_cert_chain_path'>cert_chain_path</span>.<span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="BadCertParams.html" title="EventMachine::BadCertParams (class)">BadCertParams</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Specifying both cert and cert_chain_file not allowed</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> (<span class='op'>!</span><span class='id identifier rubyid_priv_key_path'>priv_key_path</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_priv_key_path'>priv_key_path</span>.<span class='id identifier rubyid_empty?'>empty?</span>) <span class='op'>||</span> (<span class='op'>!</span><span class='id identifier rubyid_priv_key'>priv_key</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_priv_key'>priv_key</span>.<span class='id identifier rubyid_empty?'>empty?</span>)
    <span class='kw'>if</span> (<span class='id identifier rubyid_cert_chain_path'>cert_chain_path</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_cert_chain_path'>cert_chain_path</span>.<span class='id identifier rubyid_empty?'>empty?</span>) <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_cert'>cert</span>.<span class='id identifier rubyid_empty?'>empty?</span>)
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="BadParams.html" title="EventMachine::BadParams (class)">BadParams</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You have specified a private key to use, but not the related cert</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ssl_version'>ssl_version</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1-constant" title="EventMachine::EM_PROTO_TLSv1 (constant)">EM_PROTO_TLSv1</a></span>
    <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1_1-constant" title="EventMachine::EM_PROTO_TLSv1_1 (constant)">EM_PROTO_TLSv1_1</a></span>
    <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1_2-constant" title="EventMachine::EM_PROTO_TLSv1_2 (constant)">EM_PROTO_TLSv1_2</a></span>
    <span class='kw'>if</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span>.<span class='id identifier rubyid_const_defined?'>const_defined?</span> <span class='symbeg'>:</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1_3-constant" title="EventMachine::EM_PROTO_TLSv1_3 (constant)">EM_PROTO_TLSv1_3</a></span>
      <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1_3-constant" title="EventMachine::EM_PROTO_TLSv1_3 (constant)">EM_PROTO_TLSv1_3</a></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    [<span class='id identifier rubyid_ssl_version'>ssl_version</span>].<span class='id identifier rubyid_flatten'>flatten</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_to_s'>to_s</span>.<span class='id identifier rubyid_downcase'>downcase</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sslv2</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_SSLv2-constant" title="EventMachine::EM_PROTO_SSLv2 (constant)">EM_PROTO_SSLv2</a></span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sslv3</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_SSLv3-constant" title="EventMachine::EM_PROTO_SSLv3 (constant)">EM_PROTO_SSLv3</a></span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tlsv1</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1-constant" title="EventMachine::EM_PROTO_TLSv1 (constant)">EM_PROTO_TLSv1</a></span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tlsv1_1</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1_1-constant" title="EventMachine::EM_PROTO_TLSv1_1 (constant)">EM_PROTO_TLSv1_1</a></span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tlsv1_2</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1_2-constant" title="EventMachine::EM_PROTO_TLSv1_2 (constant)">EM_PROTO_TLSv1_2</a></span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tlsv1_3</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span> <span class='op'>|=</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="../EventMachine.html#EM_PROTO_TLSv1_3-constant" title="EventMachine::EM_PROTO_TLSv1_3 (constant)">EM_PROTO_TLSv1_3</a></span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unrecognized SSL/TLS Protocol: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_p'>p</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>)
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_set_tls_parms'><a href="../EventMachine.html#set_tls_parms-class_method" title="EventMachine.set_tls_parms (method)">set_tls_parms</a></span>(<span class='ivar'>@signature</span><span class='comma'>,</span> <span class='id identifier rubyid_priv_key_path'>priv_key_path</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_priv_key'>priv_key</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_priv_key_pass'>priv_key_pass</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cert_chain_path'>cert_chain_path</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cert'>cert</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_verify_peer'>verify_peer</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_if_no_peer_cert'>fail_if_no_peer_cert</span><span class='comma'>,</span> <span class='id identifier rubyid_sni_hostname'>sni_hostname</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cipher_list'>cipher_list</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_ecdh_curve'>ecdh_curve</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dhparam'>dhparam</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_protocols_bitmask'>protocols_bitmask</span>)
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_start_tls'><a href="../EventMachine.html#start_tls-class_method" title="EventMachine.start_tls (method)">start_tls</a></span> <span class='ivar'>@signature</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stop_proxying-instance_method">
  <h3 class='signature '>
    #<strong>stop_proxying</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>A helper method for <a href="../EventMachine.html#disable_proxy-class_method" title="EventMachine.disable_proxy (method)">EventMachine.disable_proxy</a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L235-L237'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='235' data-end='237'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 235</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_stop_proxying'>stop_proxying</span>
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='id identifier rubyid_disable_proxy'><a href="../EventMachine.html#disable_proxy-class_method" title="EventMachine.disable_proxy (method)">disable_proxy</a></span>(<span class='kw'>self</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stream_file_data-instance_method">
  <h3 class='signature '>
    #<strong>stream_file_data</strong>(filename, args = {})  &#x21d2; <a href="Deferrable.html" title="EventMachine::Deferrable (module)">EventMachine::Deferrable</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Open a file on the filesystem and send it to the remote peer. This returns an
object of type <a href="Deferrable.html" title="EventMachine::Deferrable (module)"><code>Deferrable</code></a>. The object&#39;s callbacks will be executed
on the reactor main thread when the file has been completely scheduled for
transmission to the remote peer. Its errbacks will be called in case of an error (such as file-not-found).
This method employs various strategies to achieve the fastest possible performance,
balanced against minimum consumption of memory.</p>

<p>Warning: this feature has an implicit dependency on an outboard extension,
evma_fastfilereader. You must install this extension in order to use <code>#stream_file_data</code>
with files larger than a certain size (currently 8192 bytes).</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>filename</span>
    <span class='type'>(<code>String</code>)</span>
&mdash;    <div class='inline'><p>Local path of the file to stream</p>
</div>
  </li>
  <li>
    <span class='name'>args</span>
    <span class='type'>(<code>Hash</code>)</span>
    <em class='default'>(defaults to: <tt>{}</tt>)</em>
&mdash;    <div class='inline'><p>Options</p>
</div>
  </li>
</ul>
    <p class='tag_title'>Options Hash (<tt>args</tt>):</p>
    <ul class='option'>
        <li>
          <span class='name'>:http_chunks</span>
          <span class='type'>(<code>Boolean</code>)</span>
          <span class='default'> &mdash; default:
              <tt>false</tt>          </span>
            &mdash; <div class='inline'><p>If true, this method will stream the file data in a format
compatible with the HTTP chunked-transfer encoding</p>
</div>        </li>
    </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L748-L750'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='748' data-end='750'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 748</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_stream_file_data'>stream_file_data</span> <span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='op'>=</span>{}
  <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'><a href="FileStreamer.html" title="EventMachine::FileStreamer (class)">FileStreamer</a></span>.<span class='id identifier rubyid_new'><a href="FileStreamer.html#new-class_method" title="EventMachine::FileStreamer.new (method)">new</a></span>( <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span> )
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unbind-instance_method">
  <h3 class='signature '>
    #<strong>unbind</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>called by the framework whenever a connection (either a server or client connection) is closed.
The close can occur because your code intentionally closes it (using <a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a> and <a href="#close_connection_after_writing-instance_method" title="EventMachine::Connection#close_connection_after_writing (method)">#close_connection_after_writing</a>),
because the remote peer closed the connection, or because of a network error.
You may not assume that the network connection is still open and able to send or
receive data when the callback to unbind is made. This is intended only to give
you a chance to clean up associations your code may have made to the connection
object while it was open.</p>

<p>If you want to detect which peer has closed the connection, you can override <a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a> in your protocol handler
and set an @ivar.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'><p>Overriding Connection#close_connection to distinguish connections closed on our side</p>
</div></p>
      <pre class='example code ruby'><code><span class='kw'>class</span> <span class='const'>MyProtocolHandler</span> <span class='op'>&lt;</span> <span class='const'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span><span class='op'>::</span><span class='const'>Connection</span>

  <span class='comment'># ...
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_close_connection'><a href="#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">close_connection</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
    <span class='ivar'>@intentionally_closed_connection</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>super</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
    <span class='kw'>if</span> <span class='ivar'>@intentionally_closed_connection</span>
      <span class='comment'># ...
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># ...
</span>
<span class='kw'>end</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a></li>
          <li><a href="#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a></li>
          <li><a href="../file.GettingStarted.html" title="EventMachine tutorial">EventMachine tutorial</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L210-L211'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='210' data-end='211'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/connection.rb', line 210</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>