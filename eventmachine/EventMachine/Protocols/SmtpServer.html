<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: EventMachine::Protocols::SmtpServer &mdash; EventMachine master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "EventMachine::Protocols::SmtpServer",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>EventMachine master</a> &raquo; 
      <a href='../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../EventMachine.html" title="EventMachine (module)">EventMachine</a> &raquo; 
        <a href="../Protocols.html" title="EventMachine::Protocols (module)">Protocols</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>SmtpServer&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: EventMachine::Protocols::SmtpServer</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="../Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="LineText2.html" title="EventMachine::Protocols::LineText2 (module)"><code>LineText2</code></a>,
          <a href="../Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../Connection.html" title="EventMachine::Connection (class)">EventMachine::Connection</a></span>
        <ul class='fullTree'>
          <li><a href="../../Object.html" title="Object (class)"><code>::Object</code></a></li>
          <li class='next'><a href="../Connection.html" title="EventMachine::Connection (class)">EventMachine::Connection</a></li>
          <li class='next'>EventMachine::Protocols::SmtpServer</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L125'>lib/em/protocols/smtpserver.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    <p>This is a protocol handler for the server side of SMTP.
It&#39;s NOT a complete SMTP server obeying all the semantics of servers conforming to
RFC2821. Rather, it uses overridable method stubs to communicate protocol states
and data to user code. User code is responsible for doing the right things with the
data in order to get complete and correct SMTP server behavior.</p>

<p>Simple SMTP server example:</p>

<p>class EmailServer &lt; EM::P::SmtpServer
   def receive_plain_auth(user, pass)
     true
   end</p>

<p>def get_server_domain
     &quot;mock.smtp.server.local&quot;
   end</p>

<p>def get_server_greeting
     &quot;mock smtp server greets you with impunity&quot;
   end</p>

<p>def receive_sender(sender)
     current.sender = sender
     true
   end</p>

<p>def receive_recipient(recipient)
     current.recipient = recipient
     true
   end</p>

<p>def receive_message
     current.received = true
     current.completed_at = Time.now</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_p'>p</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_received_email'>received_email</span><span class='comma'>,</span> <span class='id identifier rubyid_current'>current</span>]
<span class='ivar'>@current</span> <span class='op'>=</span> <span class='const'>OpenStruct</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="EventMachine::Protocols::SmtpServer.new (method)">new</a></span>
<span class='kw'>true</span></code></pre>

<p>end</p>

<p>def receive_ehlo_domain(domain)
     @ehlo_domain = domain
     true
   end</p>

<p>def receive_data_command
     current.data = &quot;&quot;
     true
   end</p>

<p>def receive_data_chunk(data)
     current.data &lt;&lt; data.join(&quot;\n&quot;)
     true
   end</p>

<p>def receive_transaction
     if @ehlo_domain
       current.ehlo_domain = @ehlo_domain
       @ehlo_domain = nil
     end
     true
   end</p>

<p>def current
     @current ||= OpenStruct.new
   end</p>

<p>def self.start(host = &#39;localhost&#39;, port = 1025)
     require &#39;ostruct&#39;
     @server = EM.start_server host, port, self
   end</p>

<p>def self.stop
     if @server
       EM.stop_server @server
       @server = nil
     end
   end</p>

<p>def self.running?
     !!@server
   end
 end</p>

<p>EM.run{ EmailServer.start }</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='AuthRegex-constant' class='summary_signature'>AuthRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L140-L140'># File 'lib/em/protocols/smtpserver.rb', line 140</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AAUTH\s+</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='DataRegex-constant' class='summary_signature'>DataRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L133-L133'># File 'lib/em/protocols/smtpserver.rb', line 133</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\ADATA</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='EhloRegex-constant' class='summary_signature'>EhloRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L129-L129'># File 'lib/em/protocols/smtpserver.rb', line 129</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AEHLO\s*</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='ExpnRegex-constant' class='summary_signature'>ExpnRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L137-L137'># File 'lib/em/protocols/smtpserver.rb', line 137</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AEXPN\s+</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='HeloRegex-constant' class='summary_signature'>HeloRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L128-L128'># File 'lib/em/protocols/smtpserver.rb', line 128</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AHELO\s*</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='HelpRegex-constant' class='summary_signature'>HelpRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L138-L138'># File 'lib/em/protocols/smtpserver.rb', line 138</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AHELP</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='MailFromRegex-constant' class='summary_signature'>MailFromRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L131-L131'># File 'lib/em/protocols/smtpserver.rb', line 131</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AMAIL FROM:\s*</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='NoopRegex-constant' class='summary_signature'>NoopRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L134-L134'># File 'lib/em/protocols/smtpserver.rb', line 134</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\ANOOP</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='QuitRegex-constant' class='summary_signature'>QuitRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L130-L130'># File 'lib/em/protocols/smtpserver.rb', line 130</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AQUIT</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='RcptToRegex-constant' class='summary_signature'>RcptToRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L132-L132'># File 'lib/em/protocols/smtpserver.rb', line 132</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\ARCPT TO:\s*</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='RsetRegex-constant' class='summary_signature'>RsetRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L135-L135'># File 'lib/em/protocols/smtpserver.rb', line 135</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\ARSET</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='StarttlsRegex-constant' class='summary_signature'>StarttlsRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L139-L139'># File 'lib/em/protocols/smtpserver.rb', line 139</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\ASTARTTLS</span><span class='regexp_end'>/i</span></span></pre>
  </li>
  <li>
    <span id='VrfyRegex-constant' class='summary_signature'>VrfyRegex =</span>
    <br/>
    <a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L136-L136'># File 'lib/em/protocols/smtpserver.rb', line 136</a>    <pre class='code ruby'><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\AVRFY\s+</span><span class='regexp_end'>/i</span></span></pre>
  </li>
</ul>
  <h3 class='inherited'><a href="LineText2.html" title="EventMachine::Protocols::LineText2 (module)"><code>LineText2</code></a> - Included</h3>
  <p  class='inherited'>
    <a href="LineText2.html#MaxBinaryLength-constant" title="EventMachine::Protocols::LineText2::MaxBinaryLength (constant)">MaxBinaryLength</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(*args)  &#x21d2; SmtpServer </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#parms=-class_method" title=".parms= (class method)">.<strong>parms=</strong>(parms = {})  </a>
    </span>
  </li>
</ul>

<h3 class='inherited'><a href="../Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="../Connection.html#new-class_method" title="EventMachine::Connection.new (method)">.new</a></td>
      <td><div class='inline'><p>Override .new so subclasses don&#39;t have to call super and can ignore connection-specific arguments.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="../Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../Connection.html#comm_inactivity_timeout-instance_method" title="EventMachine::Connection#comm_inactivity_timeout (method)">#comm_inactivity_timeout</a></td>
      <td><div class='inline'><p>comm_inactivity_timeout returns the current value (float in seconds) of the inactivity-timeout property of network-connection and datagram-socket objects.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../Connection.html#comm_inactivity_timeout=-instance_method" title="EventMachine::Connection#comm_inactivity_timeout= (method)">#comm_inactivity_timeout=</a></td>
      <td><div class='inline'><p>Allows you to set the inactivity-timeout property for a network connection or datagram socket.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ro' href="../Connection.html#error%3F-instance_method" title="EventMachine::Connection#error? (method)">#error?</a></td>
      <td><div class='inline'><p>Returns true if the connection is in an error state, false otherwise.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../Connection.html#notify_readable=-instance_method" title="EventMachine::Connection#notify_readable= (method)">#notify_readable=</a></td>
      <td><div class='inline'><p>Watches connection for readability.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m rw' href="../Connection.html#notify_readable%3F-instance_method" title="EventMachine::Connection#notify_readable? (method)">#notify_readable?</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../Connection.html#notify_writable=-instance_method" title="EventMachine::Connection#notify_writable= (method)">#notify_writable=</a></td>
      <td><div class='inline'><p>Watches connection for writeability.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../Connection.html#notify_writable%3F-instance_method" title="EventMachine::Connection#notify_writable? (method)">#notify_writable?</a></td>
      <td><div class='inline'><p>Returns true if the connection is being watched for writability.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ro' href="../Connection.html#paused%3F-instance_method" title="EventMachine::Connection#paused? (method)">#paused?</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../Connection.html#pending_connect_timeout-instance_method" title="EventMachine::Connection#pending_connect_timeout (method)">#pending_connect_timeout</a></td>
      <td><div class='inline'><p>The duration after which a TCP connection in the connecting state will fail.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m rw' href="../Connection.html#pending_connect_timeout=-instance_method" title="EventMachine::Connection#pending_connect_timeout= (method)">#pending_connect_timeout=</a></td>
      <td><div class='inline'><p>Sets the duration after which a TCP connection in a connecting state will fail.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m rw nodoc' href="../Connection.html#signature-instance_method" title="EventMachine::Connection#signature (method)">#signature</a>,
        <a class='i_m ro' href="../Connection.html#watch_only%3F-instance_method" title="EventMachine::Connection#watch_only? (method)">#watch_only?</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#connection_ended-instance_method" title="#connection_ended (instance method)">#<strong>connection_ended</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sent when the remote peer has ended the connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_server_domain-instance_method" title="#get_server_domain (instance method)">#<strong>get_server_domain</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The domain name returned in the first line of the response to a successful EHLO or HELO command.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_server_greeting-instance_method" title="#get_server_greeting (instance method)">#<strong>get_server_greeting</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The greeting returned in the initial connection message to the client.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#init_protocol_state-instance_method" title="#init_protocol_state (instance method)">#<strong>init_protocol_state</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#parms=-instance_method" title="#parms= (instance method)">#<strong>parms=</strong>(parms = {})  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#post_init-instance_method" title="#post_init (instance method)">#<strong>post_init</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>In SMTP, the server talks first.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_auth-instance_method" title="#process_auth (instance method)">#<strong>process_auth</strong>(str)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_auth_line-instance_method" title="#process_auth_line (instance method)">#<strong>process_auth_line</strong>(line)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_data-instance_method" title="#process_data (instance method)">#<strong>process_data</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_data_line-instance_method" title="#process_data_line (instance method)">#<strong>process_data_line</strong>(ln)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Send the incoming data to the application one chunk at a time, rather than one line at a time.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_ehlo-instance_method" title="#process_ehlo (instance method)">#<strong>process_ehlo</strong>(domain)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_expn-instance_method" title="#process_expn (instance method)">#<strong>process_expn</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>TODO - implement this properly, the implementation is a stub!</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_helo-instance_method" title="#process_helo (instance method)">#<strong>process_helo</strong>(domain)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_help-instance_method" title="#process_help (instance method)">#<strong>process_help</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>TODO - implement this properly, the implementation is a stub!</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_mail_from-instance_method" title="#process_mail_from (instance method)">#<strong>process_mail_from</strong>(sender)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_noop-instance_method" title="#process_noop (instance method)">#<strong>process_noop</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_quit-instance_method" title="#process_quit (instance method)">#<strong>process_quit</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_rcpt_to-instance_method" title="#process_rcpt_to (instance method)">#<strong>process_rcpt_to</strong>(rcpt)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_rset-instance_method" title="#process_rset (instance method)">#<strong>process_rset</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_starttls-instance_method" title="#process_starttls (instance method)">#<strong>process_starttls</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_unknown-instance_method" title="#process_unknown (instance method)">#<strong>process_unknown</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#process_vrfy-instance_method" title="#process_vrfy (instance method)">#<strong>process_vrfy</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>RFC2821, 3.5.3 Meaning of VRFY or EXPN Success Response:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_data_chunk-instance_method" title="#receive_data_chunk (instance method)">#<strong>receive_data_chunk</strong>(data)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sent when data from the remote peer is available.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_data_command-instance_method" title="#receive_data_command (instance method)">#<strong>receive_data_command</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Called when the remote peer sends the DATA command.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_ehlo_domain-instance_method" title="#receive_ehlo_domain (instance method)">#<strong>receive_ehlo_domain</strong>(domain)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A false response from this user-overridable method will cause a 550 error to be returned to the remote client.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_line-instance_method" title="#receive_line (instance method)">#<strong>receive_line</strong>(ln)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_message-instance_method" title="#receive_message (instance method)">#<strong>receive_message</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sent after a message has been completely received.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_plain_auth-instance_method" title="#receive_plain_auth (instance method)">#<strong>receive_plain_auth</strong>(user, password)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return true or false to indicate that the authentication is acceptable.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_recipient-instance_method" title="#receive_recipient (instance method)">#<strong>receive_recipient</strong>(rcpt)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Receives the argument of a RCPT TO command.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_reset-instance_method" title="#receive_reset (instance method)">#<strong>receive_reset</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sent when the remote peer issues the RSET command.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_sender-instance_method" title="#receive_sender (instance method)">#<strong>receive_sender</strong>(sender)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Receives the argument of the MAIL FROM command.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#receive_transaction-instance_method" title="#receive_transaction (instance method)">#<strong>receive_transaction</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This is called when the protocol state is reset.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reset_protocol_state-instance_method" title="#reset_protocol_state (instance method)">#<strong>reset_protocol_state</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#send_server_greeting-instance_method" title="#send_server_greeting (instance method)">#<strong>send_server_greeting</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unbind-instance_method" title="#unbind (instance method)">#<strong>unbind</strong>  </a>
    </span>
  </li>
</ul>

<h3 class='inherited'><a href="LineText2.html" title="EventMachine::Protocols::LineText2 (module)"><code>LineText2</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="LineText2.html#receive_binary_data-instance_method" title="EventMachine::Protocols::LineText2#receive_binary_data (method)">#receive_binary_data</a></td>
      <td><div class='inline'><p>    S</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="LineText2.html#receive_data-instance_method" title="EventMachine::Protocols::LineText2#receive_data (method)">#receive_data</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="LineText2.html#receive_end_of_binary_data-instance_method" title="EventMachine::Protocols::LineText2#receive_end_of_binary_data (method)">#receive_end_of_binary_data</a></td>
      <td><div class='inline'><p>    S</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="LineText2.html#receive_line-instance_method" title="EventMachine::Protocols::LineText2#receive_line (method)">#receive_line</a></td>
      <td><div class='inline'><p>    S</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="LineText2.html#set_binary_mode-instance_method" title="EventMachine::Protocols::LineText2#set_binary_mode (method)">#set_binary_mode</a></td>
      <td><div class='inline'><p>Alias for #set_text_mode, added for back-compatibility with <a href="LineAndTextProtocol.html" title="EventMachine::Protocols::LineAndTextProtocol (class)"><code>LineAndTextProtocol</code></a>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="LineText2.html#set_delimiter-instance_method" title="EventMachine::Protocols::LineText2#set_delimiter (method)">#set_delimiter</a></td>
      <td><div class='inline'><p>The line delimiter may be a regular expression or a string.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="LineText2.html#set_line_mode-instance_method" title="EventMachine::Protocols::LineText2#set_line_mode (method)">#set_line_mode</a></td>
      <td><div class='inline'><p>Called internally but also exposed to user code, for the case in which processing of binary data creates a need to transition back to line mode.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="LineText2.html#set_text_mode-instance_method" title="EventMachine::Protocols::LineText2#set_text_mode (method)">#set_text_mode</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="LineText2.html#unbind-instance_method" title="EventMachine::Protocols::LineText2#unbind (method)">#unbind</a></td>
      <td><div class='inline'><p>In case of a dropped connection, we&#39;ll send a partial buffer to user code when in sized text mode.</p></div></td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="../Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#associate_callback_target-instance_method" title="EventMachine::Connection#associate_callback_target (method)">#associate_callback_target</a></td>
      <td><div class='inline'><p>conn_associate_callback_target.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a></td>
      <td><div class='inline'><p>EventMachine::Connection#close_connection is called only by user code, and never by the event loop.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#close_connection_after_writing-instance_method" title="EventMachine::Connection#close_connection_after_writing (method)">#close_connection_after_writing</a></td>
      <td><div class='inline'><p>A variant of <a href="../../EventMachine.html#close_connection-instance_method" title="EventMachine#close_connection (method)">EventMachine#close_connection</a>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#connection_completed-instance_method" title="EventMachine::Connection#connection_completed (method)">#connection_completed</a></td>
      <td><div class='inline'><p>Called by the event loop when a remote TCP connection attempt completes successfully.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#detach-instance_method" title="EventMachine::Connection#detach (method)">#detach</a></td>
      <td><div class='inline'><p>Removes given connection from the event loop.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#disable_keepalive-instance_method" title="EventMachine::Connection#disable_keepalive (method)">#disable_keepalive</a></td>
      <td><div class='inline'><p>t_disable_keepalive.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#enable_keepalive-instance_method" title="EventMachine::Connection#enable_keepalive (method)">#enable_keepalive</a></td>
      <td><div class='inline'><p>t_enable_keepalive.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../Connection.html#get_cipher_bits-instance_method" title="EventMachine::Connection#get_cipher_bits (method)">#get_cipher_bits</a>,
        <a class='i_m ' href="../Connection.html#get_cipher_name-instance_method" title="EventMachine::Connection#get_cipher_name (method)">#get_cipher_name</a>,
        <a class='i_m ' href="../Connection.html#get_cipher_protocol-instance_method" title="EventMachine::Connection#get_cipher_protocol (method)">#get_cipher_protocol</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_idle_time-instance_method" title="EventMachine::Connection#get_idle_time (method)">#get_idle_time</a></td>
      <td><div class='inline'><p>The number of seconds since the last send/receive activity on this connection.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_outbound_data_size-instance_method" title="EventMachine::Connection#get_outbound_data_size (method)">#get_outbound_data_size</a></td>
      <td><div class='inline'><p>conn_get_outbound_data_size.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_peer_cert-instance_method" title="EventMachine::Connection#get_peer_cert (method)">#get_peer_cert</a></td>
      <td><div class='inline'><p>If <a href="http://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> is active on the connection, returns the remote <a href="http://en.wikipedia.org/wiki/X.509">X509 certificate</a> as a string, in the popular <a href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM format</a>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_peername-instance_method" title="EventMachine::Connection#get_peername (method)">#get_peername</a></td>
      <td><div class='inline'><p>This method is used with stream-connections to obtain the identity of the remotely-connected peer.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_pid-instance_method" title="EventMachine::Connection#get_pid (method)">#get_pid</a></td>
      <td><div class='inline'><p>Returns the PID (kernel process identifier) of a subprocess associated with this <a href="../Connection.html" title="EventMachine::Connection (class)"><code>Connection</code></a> object.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_proxied_bytes-instance_method" title="EventMachine::Connection#get_proxied_bytes (method)">#get_proxied_bytes</a></td>
      <td><div class='inline'><p>The number of bytes proxied to another connection.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../Connection.html#get_sni_hostname-instance_method" title="EventMachine::Connection#get_sni_hostname (method)">#get_sni_hostname</a>,
        <a class='i_m ' href="../Connection.html#get_sock_opt-instance_method" title="EventMachine::Connection#get_sock_opt (method)">#get_sock_opt</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_sockname-instance_method" title="EventMachine::Connection#get_sockname (method)">#get_sockname</a></td>
      <td><div class='inline'><p>Used with stream-connections to obtain the identity of the local side of the connection.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#get_status-instance_method" title="EventMachine::Connection#get_status (method)">#get_status</a></td>
      <td><div class='inline'><p>Returns a subprocess exit status.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m nodoc' href="../Connection.html#initialize-instance_method" title="EventMachine::Connection#initialize (method)">#initialize</a></td>
      <td><div class='inline'><p>Stubbed initialize so legacy superclasses can safely call super.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m nodoc' href="../Connection.html#original_method-instance_method" title="EventMachine::Connection#original_method (method)">#original_method</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#pause-instance_method" title="EventMachine::Connection#pause (method)">#pause</a></td>
      <td><div class='inline'><p>Pause a connection so that <a href="../../EventMachine.html#send_data-instance_method" title="EventMachine#send_data (method)">EventMachine#send_data</a> and <code>#receive_data</code> events are not fired until <code>#resume</code> is called.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#post_init-instance_method" title="EventMachine::Connection#post_init (method)">#post_init</a></td>
      <td><div class='inline'><p>Called by the event loop immediately after the network connection has been established, and before resumption of the network loop.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#proxy_completed-instance_method" title="EventMachine::Connection#proxy_completed (method)">#proxy_completed</a></td>
      <td><div class='inline'><p>called when the reactor finished proxying all of the requested bytes.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#proxy_incoming_to-instance_method" title="EventMachine::Connection#proxy_incoming_to (method)">#proxy_incoming_to</a></td>
      <td><div class='inline'><p>EventMachine::Connection#proxy_incoming_to is called only by user code.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#proxy_target_unbound-instance_method" title="EventMachine::Connection#proxy_target_unbound (method)">#proxy_target_unbound</a></td>
      <td><div class='inline'><p>Called by the reactor after attempting to relay incoming data to a descriptor (set as a proxy target descriptor with <a href="../../EventMachine.html#enable_proxy-class_method" title="EventMachine.enable_proxy (method)">EventMachine.enable_proxy</a>) that has already been closed.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a></td>
      <td><div class='inline'><p>Called by the event loop whenever data has been received by the network connection.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#reconnect-instance_method" title="EventMachine::Connection#reconnect (method)">#reconnect</a></td>
      <td><div class='inline'><p>Reconnect to a given host/port with the current instance.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#resume-instance_method" title="EventMachine::Connection#resume (method)">#resume</a></td>
      <td><div class='inline'><p>Resume a connection&#39;s <a href="../../EventMachine.html#send_data-instance_method" title="EventMachine#send_data (method)">EventMachine#send_data</a> and <code>#receive_data</code> events.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a></td>
      <td><div class='inline'><p>Call this method to send data to the remote end of the network connection.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#send_datagram-instance_method" title="EventMachine::Connection#send_datagram (method)">#send_datagram</a></td>
      <td><div class='inline'><p>Sends UDP messages.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#send_file_data-instance_method" title="EventMachine::Connection#send_file_data (method)">#send_file_data</a></td>
      <td><div class='inline'><p>Like <a href="../Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">Connection#send_data</a>, this sends data to the remote end of the network connection.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../Connection.html#set_sock_opt-instance_method" title="EventMachine::Connection#set_sock_opt (method)">#set_sock_opt</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">#ssl_handshake_completed</a></td>
      <td><div class='inline'><p>Called by <a href="../../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> when the SSL/TLS handshake has been completed, as a result of calling #start_tls to initiate SSL/TLS on the connection.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#ssl_verify_peer-instance_method" title="EventMachine::Connection#ssl_verify_peer (method)">#ssl_verify_peer</a></td>
      <td><div class='inline'><p>Called by <a href="../../EventMachine.html" title="EventMachine (module)"><code>::EventMachine</code></a> when <code>:verify_peer</code> =&gt; true has been passed to <a href="../../EventMachine.html#start_tls-instance_method" title="EventMachine#start_tls (method)">EventMachine#start_tls</a>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">#start_tls</a></td>
      <td><div class='inline'><p>Call <a href="../../EventMachine.html#start_tls-instance_method" title="EventMachine#start_tls (method)">EventMachine#start_tls</a> at any point to initiate TLS encryption on connected streams.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#stop_proxying-instance_method" title="EventMachine::Connection#stop_proxying (method)">#stop_proxying</a></td>
      <td><div class='inline'><p>A helper method for <a href="../../EventMachine.html#disable_proxy-class_method" title="EventMachine.disable_proxy (method)">EventMachine.disable_proxy</a></p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#stream_file_data-instance_method" title="EventMachine::Connection#stream_file_data (method)">#stream_file_data</a></td>
      <td><div class='inline'><p>Open a file on the filesystem and send it to the remote peer.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="../Connection.html#unbind-instance_method" title="EventMachine::Connection#unbind (method)">#unbind</a></td>
      <td><div class='inline'><p>called by the framework whenever a connection (either a server or client connection) is closed.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(*args)  &#x21d2; <code>SmtpServer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L162-L166'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='162' data-end='166'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 162</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='kw'>super</span>
  <span class='ivar'>@parms</span> <span class='op'>=</span> <span class='cvar'>@@parms</span>
  <span class='id identifier rubyid_init_protocol_state'><a href="#init_protocol_state-instance_method" title="EventMachine::Protocols::SmtpServer#init_protocol_state (method)">init_protocol_state</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="parms=-class_method">
  <h3 class='signature  first'>
    .<strong>parms=</strong>(parms = {})  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L156-L158'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='156' data-end='158'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 156</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_parms='>parms=</span> <span class='id identifier rubyid_parms'>parms</span><span class='op'>=</span>{}
  <span class='cvar'>@@parms</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='id identifier rubyid_parms'>parms</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="connection_ended-instance_method">
  <h3 class='signature  first'>
    #<strong>connection_ended</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sent when the remote peer has ended the connection.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L629-L630'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='629' data-end='630'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 629</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_ended'>connection_ended</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_server_domain-instance_method">
  <h3 class='signature '>
    #<strong>get_server_domain</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>The domain name returned in the first line of the response to a
successful EHLO or HELO command.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L589-L591'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='589' data-end='591'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 589</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_server_domain'>get_server_domain</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ok EventMachine SMTP Server</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_server_greeting-instance_method">
  <h3 class='signature '>
    #<strong>get_server_greeting</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>The greeting returned in the initial connection message to the client.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L584-L586'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='584' data-end='586'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 584</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_server_greeting'>get_server_greeting</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EventMachine SMTP Server</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="init_protocol_state-instance_method">
  <h3 class='signature '>
    #<strong>init_protocol_state</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L278-L280'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='278' data-end='280'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 278</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_init_protocol_state'>init_protocol_state</span>
  <span class='ivar'>@state</span> <span class='op'>||=</span> []
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="parms=-instance_method">
  <h3 class='signature '>
    #<strong>parms=</strong>(parms = {})  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L168-L170'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='168' data-end='170'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 168</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_parms='>parms=</span> <span class='id identifier rubyid_parms'>parms</span><span class='op'>=</span>{}
  <span class='ivar'>@parms</span>.<span class='id identifier rubyid_merge!'>merge!</span>(<span class='id identifier rubyid_parms'>parms</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="post_init-instance_method">
  <h3 class='signature '>
    #<strong>post_init</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>In SMTP, the server talks first. But by a (perhaps flawed) axiom in <a href="../../top-level-namespace.html#EM-constant" title="EM (constant)">EM</a>,</p>

<h1>post_init will execute BEFORE the block passed to #start_server, for any</h1>

<p>given accepted connection. Since in this class we&#39;ll probably be getting
a lot of initialization parameters, we want the guts of post_init to
run AFTER the application has initialized the connection object. So we
use a spawn to schedule the post_init to run later.
It&#39;s a little weird, I admit. A reasonable alternative would be to set
parameters as a class variable and to do that before accepting any connections.</p>

<p>OBSOLETE, now we have @@parms. But the spawn is nice to keep as an illustration.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L183-L187'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='183' data-end='187'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 183</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_post_init'>post_init</span>
  <span class='comment'>#send_data &quot;220 #{get_server_greeting}\r\n&quot; (ORIGINAL)
</span>  <span class='comment'>#(EM.spawn {|x| x.send_data &quot;220 #{x.get_server_greeting}\r\n&quot;}).notify(self)
</span>  (<span class='const'><a href="../../top-level-namespace.html#EM-constant" title="EM (constant)">EM</a></span>.<span class='id identifier rubyid_spawn'><a href="../../EventMachine.html#spawn-class_method" title="EventMachine.spawn (method)">spawn</a></span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span>.<span class='id identifier rubyid_send_server_greeting'><a href="#send_server_greeting-instance_method" title="EventMachine::Protocols::SmtpServer#send_server_greeting (method)">send_server_greeting</a></span>}).<span class='id identifier rubyid_notify'>notify</span>(<span class='kw'>self</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_auth-instance_method">
  <h3 class='signature '>
    #<strong>process_auth</strong>(str)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L348-L364'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='348' data-end='364'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 348</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_auth'>process_auth</span> <span class='id identifier rubyid_str'>str</span>
  <span class='kw'>if</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_auth'>auth</span>)
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>503 auth already issued\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\APLAIN\s?</span><span class='regexp_end'>/i</span></span>
    <span class='kw'>if</span> <span class='backref'>$&#39;</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='comment'># we got a partial response, so let the client know to send the rest
</span>      <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_auth_incomplete'>auth_incomplete</span>
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>334 \r\n</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>else</span>
      <span class='comment'># we got the initial response, so go ahead &amp; process it
</span>      <span class='id identifier rubyid_process_auth_line'><a href="#process_auth_line-instance_method" title="EventMachine::Protocols::SmtpServer#process_auth_line (method)">process_auth_line</a></span>(<span class='backref'>$&#39;</span>)
    <span class='kw'>end</span>
    <span class='comment'>#elsif str =~ /\ALOGIN\s+/i
</span>  <span class='kw'>else</span>
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>504 auth mechanism not available\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_auth_line-instance_method">
  <h3 class='signature '>
    #<strong>process_auth_line</strong>(line)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L366-L387'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='366' data-end='387'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 366</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_auth_line'>process_auth_line</span>(<span class='id identifier rubyid_line'>line</span>)
  <span class='id identifier rubyid_plain'>plain</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span>.<span class='id identifier rubyid_unpack'>unpack</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid__'>_</span><span class='comma'>,</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span><span class='id identifier rubyid_psw'>psw</span> <span class='op'>=</span> <span class='id identifier rubyid_plain'>plain</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\000</span><span class='tstring_end'>&quot;</span></span>)
  
  <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>235 authentication ok\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_auth'>auth</span>
  }
  <span class='id identifier rubyid_failed'>failed</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>535 invalid authentication\r\n</span><span class='tstring_end'>&quot;</span></span>
  }
  <span class='id identifier rubyid_auth'>auth</span> <span class='op'>=</span> <span class='id identifier rubyid_receive_plain_auth'><a href="#receive_plain_auth-instance_method" title="EventMachine::Protocols::SmtpServer#receive_plain_auth (method)">receive_plain_auth</a></span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span><span class='id identifier rubyid_psw'>psw</span>
  
  <span class='kw'>if</span> <span class='id identifier rubyid_auth'>auth</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_callback'>callback</span>)
    <span class='id identifier rubyid_auth'>auth</span>.<span class='id identifier rubyid_callback'>callback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_succeeded'>succeeded</span>)
    <span class='id identifier rubyid_auth'>auth</span>.<span class='id identifier rubyid_errback'>errback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_failed'>failed</span>)
  <span class='kw'>else</span>
    (<span class='id identifier rubyid_auth'>auth</span> <span class='op'>?</span> <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>:</span> <span class='id identifier rubyid_failed'>failed</span>).<span class='id identifier rubyid_call'>call</span>
  <span class='kw'>end</span>
  
  <span class='ivar'>@state</span>.<span class='id identifier rubyid_delete'>delete</span> <span class='symbeg'>:</span><span class='id identifier rubyid_auth_incomplete'>auth_incomplete</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_data-instance_method">
  <h3 class='signature '>
    #<strong>process_data</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L394-L416'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='394' data-end='416'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 394</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_data'>process_data</span>
  <span class='kw'>unless</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rcpt'>rcpt</span>)
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>503 Operation sequence error\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>354 Send it\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_data'>data</span>
      <span class='ivar'>@databuffer</span> <span class='op'>=</span> []
    }
    <span class='id identifier rubyid_failed'>failed</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 Operation failed\r\n</span><span class='tstring_end'>&quot;</span></span>
    }

    <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_receive_data_command'><a href="#receive_data_command-instance_method" title="EventMachine::Protocols::SmtpServer#receive_data_command (method)">receive_data_command</a></span>

    <span class='kw'>if</span> <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_callback'>callback</span>)
      <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_callback'>callback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_succeeded'>succeeded</span>)
      <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_errback'>errback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_failed'>failed</span>)
    <span class='kw'>else</span>
      (<span class='id identifier rubyid_d'>d</span> <span class='op'>?</span> <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>:</span> <span class='id identifier rubyid_failed'>failed</span>).<span class='id identifier rubyid_call'>call</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_data_line-instance_method">
  <h3 class='signature '>
    #<strong>process_data_line</strong>(ln)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Send the incoming data to the application one chunk at a time, rather than
one line at a time. That lets the application be a little more flexible about
storing to disk, etc.
Since we clear the chunk array every time we submit it, the caller needs to be
aware to do things like dup it if he wants to keep it around across calls.</p>

<p>Resets the transaction upon disposition of the incoming message.
RFC5321 says this about the MAIL FROM command:
 &quot;This command tells the SMTP-receiver that a new mail transaction is
  starting and to reset all its state tables and buffers, including any
  recipients or mail data.&quot;</p>

<p>Equivalent behaviour is implemented by resetting after a completed transaction.</p>

<p>User-written code can return a <a href="../Deferrable.html" title="EventMachine::Deferrable (module)"><code>Deferrable</code></a> as a response from receive_message.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L542-L577'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='542' data-end='577'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 542</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_data_line'>process_data_line</span> <span class='id identifier rubyid_ln'>ln</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ln'>ln</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='ivar'>@databuffer</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_receive_data_chunk'><a href="#receive_data_chunk-instance_method" title="EventMachine::Protocols::SmtpServer#receive_data_chunk (method)">receive_data_chunk</a></span> <span class='ivar'>@databuffer</span>
      <span class='ivar'>@databuffer</span>.<span class='id identifier rubyid_clear'>clear</span>
    <span class='kw'>end</span>


    <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 Message accepted\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_reset_protocol_state'><a href="#reset_protocol_state-instance_method" title="EventMachine::Protocols::SmtpServer#reset_protocol_state (method)">reset_protocol_state</a></span>
    }
    <span class='id identifier rubyid_failed'>failed</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 Message rejected\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_reset_protocol_state'><a href="#reset_protocol_state-instance_method" title="EventMachine::Protocols::SmtpServer#reset_protocol_state (method)">reset_protocol_state</a></span>
    }
    <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_receive_message'><a href="#receive_message-instance_method" title="EventMachine::Protocols::SmtpServer#receive_message (method)">receive_message</a></span>

    <span class='kw'>if</span> <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_set_deferred_status'>set_deferred_status</span>)
      <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_callback'>callback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_succeeded'>succeeded</span>)
      <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_errback'>errback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_failed'>failed</span>)
    <span class='kw'>else</span>
      (<span class='id identifier rubyid_d'>d</span> <span class='op'>?</span> <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>:</span> <span class='id identifier rubyid_failed'>failed</span>).<span class='id identifier rubyid_call'>call</span>
    <span class='kw'>end</span>

    <span class='ivar'>@state</span> <span class='op'>-=</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_mail_from'>mail_from</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rcpt'>rcpt</span>]
  <span class='kw'>else</span>
    <span class='comment'># slice off leading . if any
</span>    <span class='id identifier rubyid_ln'>ln</span>.<span class='id identifier rubyid_slice!'>slice!</span>(<span class='int'>0</span><span class='op'>...</span><span class='int'>1</span>) <span class='kw'>if</span> <span class='id identifier rubyid_ln'>ln</span>[<span class='int'>0</span>] <span class='op'>==</span> <span class='CHAR'>?.</span>
    <span class='ivar'>@databuffer</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ln'>ln</span>
    <span class='kw'>if</span> <span class='ivar'>@databuffer</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_chunksize'>chunksize</span>]
      <span class='id identifier rubyid_receive_data_chunk'><a href="#receive_data_chunk-instance_method" title="EventMachine::Protocols::SmtpServer#receive_data_chunk (method)">receive_data_chunk</a></span> <span class='ivar'>@databuffer</span>
      <span class='ivar'>@databuffer</span>.<span class='id identifier rubyid_clear'>clear</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_ehlo-instance_method">
  <h3 class='signature '>
    #<strong>process_ehlo</strong>(domain)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L301-L318'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='301' data-end='318'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 301</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_ehlo'>process_ehlo</span> <span class='id identifier rubyid_domain'>domain</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_receive_ehlo_domain'><a href="#receive_ehlo_domain-instance_method" title="EventMachine::Protocols::SmtpServer#receive_ehlo_domain (method)">receive_ehlo_domain</a></span> <span class='id identifier rubyid_domain'>domain</span>
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_server_domain'><a href="#get_server_domain-instance_method" title="EventMachine::Protocols::SmtpServer#get_server_domain (method)">get_server_domain</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span>]
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250-STARTTLS\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_auth'>auth</span>]
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250-AUTH PLAIN\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250-NO-SOLICITING\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># TODO, size needs to be configurable.
</span>    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 SIZE 20000000\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_reset_protocol_state'><a href="#reset_protocol_state-instance_method" title="EventMachine::Protocols::SmtpServer#reset_protocol_state (method)">reset_protocol_state</a></span>
    <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_ehlo'>ehlo</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 Requested action not taken\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_expn-instance_method">
  <h3 class='signature '>
    #<strong>process_expn</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>TODO - implement this properly, the implementation is a stub!</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L248-L250'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='248' data-end='250'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 248</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_expn'>process_expn</span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>502 Command not implemented\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_helo-instance_method">
  <h3 class='signature '>
    #<strong>process_helo</strong>(domain)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L320-L328'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='320' data-end='328'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 320</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_helo'>process_helo</span> <span class='id identifier rubyid_domain'>domain</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_receive_ehlo_domain'><a href="#receive_ehlo_domain-instance_method" title="EventMachine::Protocols::SmtpServer#receive_ehlo_domain (method)">receive_ehlo_domain</a></span> <span class='id identifier rubyid_domain'>domain</span>.<span class='id identifier rubyid_dup'>dup</span>
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_server_domain'><a href="#get_server_domain-instance_method" title="EventMachine::Protocols::SmtpServer#get_server_domain (method)">get_server_domain</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_reset_protocol_state'><a href="#reset_protocol_state-instance_method" title="EventMachine::Protocols::SmtpServer#reset_protocol_state (method)">reset_protocol_state</a></span>
    <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_ehlo'>ehlo</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 Requested action not taken\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_help-instance_method">
  <h3 class='signature '>
    #<strong>process_help</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>TODO - implement this properly, the implementation is a stub!</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L232-L234'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='232' data-end='234'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 232</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_help'>process_help</span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 Ok, but unimplemented\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_mail_from-instance_method">
  <h3 class='signature '>
    #<strong>process_mail_from</strong>(sender)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L464-L479'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='464' data-end='479'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 464</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_mail_from'>process_mail_from</span> <span class='id identifier rubyid_sender'>sender</span>
  <span class='kw'>if</span> (<span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span>]<span class='op'>==</span><span class='symbeg'>:</span><span class='id identifier rubyid_required'>required</span> <span class='kw'>and</span> <span class='op'>!</span><span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span>))
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 This server requires STARTTLS before MAIL FROM\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> (<span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_auth'>auth</span>]<span class='op'>==</span><span class='symbeg'>:</span><span class='id identifier rubyid_required'>required</span> <span class='kw'>and</span> <span class='op'>!</span><span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_auth'>auth</span>))
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 This server requires authentication before MAIL FROM\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_mail_from'>mail_from</span>)
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>503 MAIL already given\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_receive_sender'><a href="#receive_sender-instance_method" title="EventMachine::Protocols::SmtpServer#receive_sender (method)">receive_sender</a></span> <span class='id identifier rubyid_sender'>sender</span>
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 sender is unacceptable\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 Ok\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_mail_from'>mail_from</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_noop-instance_method">
  <h3 class='signature '>
    #<strong>process_noop</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L335-L337'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='335' data-end='337'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 335</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_noop'>process_noop</span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 Ok\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_quit-instance_method">
  <h3 class='signature '>
    #<strong>process_quit</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L330-L333'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='330' data-end='333'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 330</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_quit'>process_quit</span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>221 Ok\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_close_connection_after_writing'>close_connection_after_writing</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_rcpt_to-instance_method">
  <h3 class='signature '>
    #<strong>process_rcpt_to</strong>(rcpt)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L493-L523'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='493' data-end='523'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 493</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_rcpt_to'>process_rcpt_to</span> <span class='id identifier rubyid_rcpt'>rcpt</span>
  <span class='kw'>unless</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_mail_from'>mail_from</span>)
    <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>503 MAIL is required before RCPT\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 Ok\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rcpt'>rcpt</span> <span class='kw'>unless</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_rcpt'>rcpt</span>)
    }
    <span class='id identifier rubyid_failed'>failed</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>550 recipient is unacceptable\r\n</span><span class='tstring_end'>&quot;</span></span>
    }

    <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_receive_recipient'><a href="#receive_recipient-instance_method" title="EventMachine::Protocols::SmtpServer#receive_recipient (method)">receive_recipient</a></span> <span class='id identifier rubyid_rcpt'>rcpt</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_set_deferred_status'>set_deferred_status</span>)
      <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_callback'>callback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_succeeded'>succeeded</span>)
      <span class='id identifier rubyid_d'>d</span>.<span class='id identifier rubyid_errback'>errback</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_failed'>failed</span>)
    <span class='kw'>else</span>
      (<span class='id identifier rubyid_d'>d</span> <span class='op'>?</span> <span class='id identifier rubyid_succeeded'>succeeded</span> <span class='op'>:</span> <span class='id identifier rubyid_failed'>failed</span>).<span class='id identifier rubyid_call'>call</span>
    <span class='kw'>end</span>

<span class='embdoc_beg'>=begin
</span><span class='embdoc'>  unless receive_recipient rcpt
</span><span class='embdoc'>    send_data &quot;550 recipient is unacceptable\r\n&quot;
</span><span class='embdoc'>  else
</span><span class='embdoc'>    send_data &quot;250 Ok\r\n&quot;
</span><span class='embdoc'>    @state &lt;&lt; :rcpt unless @state.include?(:rcpt)
</span><span class='embdoc'>  end
</span><span class='embdoc_end'>=end
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_rset-instance_method">
  <h3 class='signature '>
    #<strong>process_rset</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L418-L422'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='418' data-end='422'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 418</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_rset'>process_rset</span>
  <span class='id identifier rubyid_reset_protocol_state'><a href="#reset_protocol_state-instance_method" title="EventMachine::Protocols::SmtpServer#reset_protocol_state (method)">reset_protocol_state</a></span>
  <span class='id identifier rubyid_receive_reset'><a href="#receive_reset-instance_method" title="EventMachine::Protocols::SmtpServer#receive_reset (method)">receive_reset</a></span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>250 Ok\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_starttls-instance_method">
  <h3 class='signature '>
    #<strong>process_starttls</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L437-L451'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='437' data-end='451'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 437</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_starttls'>process_starttls</span>
  <span class='kw'>if</span> <span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span>]
    <span class='kw'>if</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span>)
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>503 TLS Already negotiated\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>elsif</span> <span class='op'>!</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_ehlo'>ehlo</span>)
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>503 EHLO required before STARTTLS\r\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>220 Start TLS negotiation\r\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_start_tls'><a href="../../EventMachine.html#start_tls-class_method" title="EventMachine.start_tls (method)">start_tls</a></span>(<span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_starttls_options'>starttls_options</span>] <span class='op'>||</span> {})
      <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_process_unknown'><a href="#process_unknown-instance_method" title="EventMachine::Protocols::SmtpServer#process_unknown (method)">process_unknown</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_unknown-instance_method">
  <h3 class='signature '>
    #<strong>process_unknown</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L339-L341'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='339' data-end='341'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 339</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_unknown'>process_unknown</span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>500 Unknown command\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_vrfy-instance_method">
  <h3 class='signature '>
    #<strong>process_vrfy</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>RFC2821, 3.5.3 Meaning of VRFY or EXPN Success Response:
  A server MUST NOT return a 250 code in response to a VRFY or EXPN
  command unless it has actually verified the address.  In particular,
  a server MUST NOT return 250 if all it has done is to verify that the
  syntax given is valid.  In that case, 502 (Command not implemented)
  or 500 (Syntax error, command unrecognized) SHOULD be returned.</p>

<p>TODO - implement this properly, the implementation is a stub!</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L244-L246'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='244' data-end='246'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 244</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_vrfy'>process_vrfy</span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>502 Command not implemented\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_data_chunk-instance_method">
  <h3 class='signature '>
    #<strong>receive_data_chunk</strong>(data)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sent when data from the remote peer is available. The size can be controlled
by setting the <code>:chunksize</code> parameter. This call can be made multiple times.
The goal is to strike a balance between sending the data to the application one
line at a time, and holding all of a very large message in memory.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L646-L650'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='646' data-end='650'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 646</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_data_chunk'>receive_data_chunk</span> <span class='id identifier rubyid_data'>data</span>
  <span class='ivar'>@smtps_msg_size</span> <span class='op'>||=</span> <span class='int'>0</span>
  <span class='ivar'>@smtps_msg_size</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_join'>join</span>.<span class='id identifier rubyid_length'>length</span>
  <span class='const'>STDERR</span>.<span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@smtps_msg_size</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_data_command-instance_method">
  <h3 class='signature '>
    #<strong>receive_data_command</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Called when the remote peer sends the DATA command.
Returning false will cause us to send a 550 error to the peer.
This can be useful for dealing with problems that arise from processing
the whole set of sender and recipients.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L637-L639'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='637' data-end='639'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 637</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_data_command'>receive_data_command</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_ehlo_domain-instance_method">
  <h3 class='signature '>
    #<strong>receive_ehlo_domain</strong>(domain)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>A false response from this user-overridable method will cause a
550 error to be returned to the remote client.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L596-L598'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='596' data-end='598'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 596</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_ehlo_domain'>receive_ehlo_domain</span> <span class='id identifier rubyid_domain'>domain</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_line-instance_method">
  <h3 class='signature '>
    #<strong>receive_line</strong>(ln)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L193-L229'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='193' data-end='229'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 193</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_line'>receive_line</span> <span class='id identifier rubyid_ln'>ln</span>
  <span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_verbose'>verbose</span>] <span class='kw'>and</span> <span class='gvar'>$&gt;</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;&gt;&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ln'>ln</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>return</span> <span class='id identifier rubyid_process_data_line'><a href="#process_data_line-instance_method" title="EventMachine::Protocols::SmtpServer#process_data_line (method)">process_data_line</a></span>(<span class='id identifier rubyid_ln'>ln</span>) <span class='kw'>if</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_data'>data</span>)
  <span class='kw'>return</span> <span class='id identifier rubyid_process_auth_line'><a href="#process_auth_line-instance_method" title="EventMachine::Protocols::SmtpServer#process_auth_line (method)">process_auth_line</a></span>(<span class='id identifier rubyid_ln'>ln</span>) <span class='kw'>if</span> <span class='ivar'>@state</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_auth_incomplete'>auth_incomplete</span>)

  <span class='kw'>case</span> <span class='id identifier rubyid_ln'>ln</span>
  <span class='kw'>when</span> <span class='const'><a href="#EhloRegex-constant" title="EventMachine::Protocols::SmtpServer::EhloRegex (constant)">EhloRegex</a></span>
    <span class='id identifier rubyid_process_ehlo'><a href="#process_ehlo-instance_method" title="EventMachine::Protocols::SmtpServer#process_ehlo (method)">process_ehlo</a></span> <span class='backref'>$&#39;</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>when</span> <span class='const'><a href="#HeloRegex-constant" title="EventMachine::Protocols::SmtpServer::HeloRegex (constant)">HeloRegex</a></span>
    <span class='id identifier rubyid_process_helo'><a href="#process_helo-instance_method" title="EventMachine::Protocols::SmtpServer#process_helo (method)">process_helo</a></span> <span class='backref'>$&#39;</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>when</span> <span class='const'><a href="#MailFromRegex-constant" title="EventMachine::Protocols::SmtpServer::MailFromRegex (constant)">MailFromRegex</a></span>
    <span class='id identifier rubyid_process_mail_from'><a href="#process_mail_from-instance_method" title="EventMachine::Protocols::SmtpServer#process_mail_from (method)">process_mail_from</a></span> <span class='backref'>$&#39;</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>when</span> <span class='const'><a href="#RcptToRegex-constant" title="EventMachine::Protocols::SmtpServer::RcptToRegex (constant)">RcptToRegex</a></span>
    <span class='id identifier rubyid_process_rcpt_to'><a href="#process_rcpt_to-instance_method" title="EventMachine::Protocols::SmtpServer#process_rcpt_to (method)">process_rcpt_to</a></span> <span class='backref'>$&#39;</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>when</span> <span class='const'><a href="#DataRegex-constant" title="EventMachine::Protocols::SmtpServer::DataRegex (constant)">DataRegex</a></span>
    <span class='id identifier rubyid_process_data'><a href="#process_data-instance_method" title="EventMachine::Protocols::SmtpServer#process_data (method)">process_data</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#RsetRegex-constant" title="EventMachine::Protocols::SmtpServer::RsetRegex (constant)">RsetRegex</a></span>
    <span class='id identifier rubyid_process_rset'><a href="#process_rset-instance_method" title="EventMachine::Protocols::SmtpServer#process_rset (method)">process_rset</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#VrfyRegex-constant" title="EventMachine::Protocols::SmtpServer::VrfyRegex (constant)">VrfyRegex</a></span>
    <span class='id identifier rubyid_process_vrfy'><a href="#process_vrfy-instance_method" title="EventMachine::Protocols::SmtpServer#process_vrfy (method)">process_vrfy</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#ExpnRegex-constant" title="EventMachine::Protocols::SmtpServer::ExpnRegex (constant)">ExpnRegex</a></span>
    <span class='id identifier rubyid_process_expn'><a href="#process_expn-instance_method" title="EventMachine::Protocols::SmtpServer#process_expn (method)">process_expn</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#HelpRegex-constant" title="EventMachine::Protocols::SmtpServer::HelpRegex (constant)">HelpRegex</a></span>
    <span class='id identifier rubyid_process_help'><a href="#process_help-instance_method" title="EventMachine::Protocols::SmtpServer#process_help (method)">process_help</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#NoopRegex-constant" title="EventMachine::Protocols::SmtpServer::NoopRegex (constant)">NoopRegex</a></span>
    <span class='id identifier rubyid_process_noop'><a href="#process_noop-instance_method" title="EventMachine::Protocols::SmtpServer#process_noop (method)">process_noop</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#QuitRegex-constant" title="EventMachine::Protocols::SmtpServer::QuitRegex (constant)">QuitRegex</a></span>
    <span class='id identifier rubyid_process_quit'><a href="#process_quit-instance_method" title="EventMachine::Protocols::SmtpServer#process_quit (method)">process_quit</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#StarttlsRegex-constant" title="EventMachine::Protocols::SmtpServer::StarttlsRegex (constant)">StarttlsRegex</a></span>
    <span class='id identifier rubyid_process_starttls'><a href="#process_starttls-instance_method" title="EventMachine::Protocols::SmtpServer#process_starttls (method)">process_starttls</a></span>
  <span class='kw'>when</span> <span class='const'><a href="#AuthRegex-constant" title="EventMachine::Protocols::SmtpServer::AuthRegex (constant)">AuthRegex</a></span>
    <span class='id identifier rubyid_process_auth'><a href="#process_auth-instance_method" title="EventMachine::Protocols::SmtpServer#process_auth (method)">process_auth</a></span> <span class='backref'>$&#39;</span>.<span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_process_unknown'><a href="#process_unknown-instance_method" title="EventMachine::Protocols::SmtpServer#process_unknown (method)">process_unknown</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_message-instance_method">
  <h3 class='signature '>
    #<strong>receive_message</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sent after a message has been completely received. User code
must return true or false to indicate whether the message has
been accepted for delivery.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L655-L658'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='655' data-end='658'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 655</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_message'>receive_message</span>
  <span class='cvar'>@@parms</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_verbose'>verbose</span>] <span class='kw'>and</span> <span class='gvar'>$&gt;</span>.<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Received complete message</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_plain_auth-instance_method">
  <h3 class='signature '>
    #<strong>receive_plain_auth</strong>(user, password)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Return true or false to indicate that the authentication is acceptable.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L601-L603'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='601' data-end='603'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 601</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_plain_auth'>receive_plain_auth</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_recipient-instance_method">
  <h3 class='signature '>
    #<strong>receive_recipient</strong>(rcpt)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Receives the argument of a RCPT TO command. Can be given multiple
times per transaction. Return false to reject the recipient.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L616-L618'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='616' data-end='618'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 616</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_recipient'>receive_recipient</span> <span class='id identifier rubyid_rcpt'>rcpt</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_reset-instance_method">
  <h3 class='signature '>
    #<strong>receive_reset</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Sent when the remote peer issues the RSET command.
Since RSET is not allowed to fail (according to the protocol),
we ignore any return value from user overrides of this method.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L624-L625'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='624' data-end='625'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 624</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_reset'>receive_reset</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_sender-instance_method">
  <h3 class='signature '>
    #<strong>receive_sender</strong>(sender)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>Receives the argument of the MAIL FROM command. Return false to
indicate to the remote client that the sender is not accepted.
This can only be successfully called once per transaction.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L609-L611'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='609' data-end='611'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 609</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_sender'>receive_sender</span> <span class='id identifier rubyid_sender'>sender</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive_transaction-instance_method">
  <h3 class='signature '>
    #<strong>receive_transaction</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    <p>This is called when the protocol state is reset. It happens
when the remote client calls EHLO/HELO or RSET.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L662-L663'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='662' data-end='663'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 662</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive_transaction'>receive_transaction</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reset_protocol_state-instance_method">
  <h3 class='signature '>
    #<strong>reset_protocol_state</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L271-L277'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='271' data-end='277'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 271</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_protocol_state'>reset_protocol_state</span>
  <span class='id identifier rubyid_init_protocol_state'><a href="#init_protocol_state-instance_method" title="EventMachine::Protocols::SmtpServer#init_protocol_state (method)">init_protocol_state</a></span>
  <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span><span class='ivar'>@state</span> <span class='op'>=</span> <span class='ivar'>@state</span><span class='comma'>,</span>[]
  <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span> <span class='kw'>if</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_starttls'>starttls</span>)
  <span class='ivar'>@state</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_ehlo'>ehlo</span> <span class='kw'>if</span> <span class='id identifier rubyid_s'>s</span>.<span class='id identifier rubyid_include?'>include?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_ehlo'>ehlo</span>)
  <span class='id identifier rubyid_receive_transaction'><a href="#receive_transaction-instance_method" title="EventMachine::Protocols::SmtpServer#receive_transaction (method)">receive_transaction</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_server_greeting-instance_method">
  <h3 class='signature '>
    #<strong>send_server_greeting</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L189-L191'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='189' data-end='191'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 189</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_server_greeting'>send_server_greeting</span>
  <span class='id identifier rubyid_send_data'><a href="../../EventMachine.html#send_data-class_method" title="EventMachine.send_data (method)">send_data</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>220 </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_server_greeting'><a href="#get_server_greeting-instance_method" title="EventMachine::Protocols::SmtpServer#get_server_greeting (method)">get_server_greeting</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unbind-instance_method">
  <h3 class='signature '>
    #<strong>unbind</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/eventmachine/eventmachine/blob/master/lib/em/protocols/smtpserver.rb#L424-L426'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='424' data-end='426'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/em/protocols/smtpserver.rb', line 424</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unbind'>unbind</span>
  <span class='id identifier rubyid_connection_ended'><a href="#connection_ended-instance_method" title="EventMachine::Protocols::SmtpServer#connection_ended (method)">connection_ended</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>